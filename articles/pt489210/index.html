<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ΩüèΩ ü§∏ üßë‚Äçü§ù‚Äçüßë Teste de desempenho de c√≥digo do Linux com exemplos üêÇ ü§ôüèæ üëßüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Quando comecei a aprender Java, uma das primeiras tarefas que tentei resolver foi determinar n√∫meros pares / √≠mpares. Eu conhecia v√°rias maneiras de f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Teste de desempenho de c√≥digo do Linux com exemplos</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/489210/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quando comecei a aprender Java, uma das primeiras tarefas que tentei resolver foi determinar n√∫meros pares / √≠mpares. Eu conhecia v√°rias maneiras de fazer isso, mas decidi procurar o caminho "certo" na Internet. As informa√ß√µes em todos os links encontrados me informavam sobre a √∫nica solu√ß√£o correta do formul√°rio x% 2, para obter o restante da divis√£o. Se o restante for 0, o n√∫mero ser√° par; se o restante for 1, ser√° √≠mpar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desde a √©poca do ZX Spectrum, lembrei-me de outra maneira e ela est√° associada √† representa√ß√£o de n√∫meros no sistema bin√°rio. Qualquer n√∫mero no sistema decimal pode ser escrito como a soma dos poderes de dois. Por exemplo, para um byte, e este √© 8 bits, qualquer n√∫mero no sistema decimal pode ser representado como a soma dos n√∫meros 128 + 64 + 32 + 16 + 8 + 4 + 2 + 1.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta √© apenas uma sequ√™ncia de poderes de dois. Ao converter um n√∫mero no sistema bin√°rio, se precisarmos levar em conta o n√∫mero, na representa√ß√£o bin√°ria ser√° um, se n√£o for necess√°rio, ser√° 0. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
10 = 1010 (8 + 0 + 2 + 0) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
13 = 1101 (8 + 4 + 0 + 1) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
200 = 11001000 (128 + 64 + 0 + 0 + 8 + 0 + 0 + 0)</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode prestar aten√ß√£o imediatamente ao fato de que um n√∫mero √≠mpar pode fornecer apenas uma pot√™ncia zero de dois com um valor de 1; todos os outros poderes de dois ser√£o pares por defini√ß√£o. </font><font style="vertical-align: inherit;">Isso significa automaticamente que, do ponto de vista do sistema de n√∫meros bin√°rios, se quisermos verificar qualquer n√∫mero quanto √† paridade, n√£o precisamos verificar o n√∫mero inteiro, por maior que seja. </font><font style="vertical-align: inherit;">Precisamos verificar apenas o primeiro bit (o mais √† direita). </font><font style="vertical-align: inherit;">Se for 0, ent√£o o n√∫mero √© par, j√° que todos os outros bits fornecem um n√∫mero par e vice-versa, se for um no bit mais √† direita, √© garantido que o n√∫mero seja √≠mpar, porque todos os outros bits fornecem apenas um valor par. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para verificar apenas o bit certo em um n√∫mero, voc√™ pode usar v√°rios m√©todos. </font><font style="vertical-align: inherit;">Um deles √© o bin√°rio AND.</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O bin√°rio AND (AND) funciona pela seguinte regra. Se voc√™ aplicar a qualquer n√∫mero, vamos cham√°-lo de original, l√≥gico E com o n√∫mero 0, ent√£o o resultado dessa opera√ß√£o √© sempre 0. Dessa maneira, voc√™ pode zerar os bits que n√£o precisa. Se voc√™ aplicar ao original 1, obter√° o original. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em um sistema bin√°rio, √© f√°cil escrever isso: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0 AND 0 = 0 (zere o original) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1 AND 0 = 0 (zere o original) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0 AND 1 = 0 (n√£o mude o original) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1 AND 1 = 1 (n√£o mude o original) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A partir daqui, alguns exemplos regras. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se aplicarmos a opera√ß√£o AND de todas as unidades a todos os n√∫meros (todos os bits est√£o ativados), obteremos o mesmo n√∫mero inicial. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se aplicarmos AND de todos os zeros a qualquer n√∫mero (todos os bits est√£o desativados), obtemos 0. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo:</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se aplicarmos AND 0 ao byte 13, obteremos 0. Em decimal, pareceremos 13 AND 0 = 0 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se aplicarmos AND 0 ao byte 200, obteremos 0 ou escreveremos brevemente 200 AND 0 = 0. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O mesmo √© o oposto, aplicar a 13 todos os bits inclu√≠dos, para um byte ser√£o oito unidades e obteremos o original. </font><font style="vertical-align: inherit;">No sistema bin√°rio 00001101 AND 11111111 = 00001101 ou no sistema decimal 13 AND 255 = 13 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para 200, haver√° 11001000 AND 11111111 = 11001000, respectivamente, ou no sistema decimal 200 AND 255 = 200</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verifica√ß√£o bin√°ria</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para verificar o n√∫mero de paridade, precisamos apenas verificar o bit mais √† direita. Se for 0, o n√∫mero ser√° par; se 1, n√£o ser√° par. Sabendo que com AND podemos deixar alguns bits originais, e alguns podemos redefinir, podemos redefinir todos os bits, exceto o mais √† direita. Por exemplo: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
13 no sistema bin√°rio √© 1101. Vamos aplicar AND 0001 a ele (redefinimos todos os bits, o √∫ltimo permanece o original). Em 1101, alteramos todos os bits para 0, exceto o √∫ltimo, e obtemos 0001. Obtivemos apenas o √∫ltimo bit do nosso n√∫mero original. No sistema decimal, ser√° semelhante a 13 AND 1 = 1.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A mesma coisa com o n√∫mero 200, no bin√°rio 11001000. Aplicamos AND 00000001 a ele, de acordo com o mesmo esquema, zeramos todos os bits, deixamos o √∫ltimo como est√°, obtemos 00000000, enquanto os 7 zeros √† esquerda foram redefinidos com o comando AND e os √∫ltimos 0 obtivemos do n√∫mero original. No sistema decimal, parece 200 AND 1 = 0 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim, aplicando o comando AND 1 a qualquer n√∫mero, obtemos 0 ou 1. E se o resultado for 0, o n√∫mero ser√° par. Quando 1, o n√∫mero √© √≠mpar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em Java, o bin√°rio AND √© escrito como &amp;. Assim, 200 &amp; 1 = 0 (par) e 13 &amp; 1 = 1 (√≠mpar). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso implica pelo menos dois m√©todos para determinar n√∫meros pares. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
X% 2 - atrav√©s do restante da divis√£o por dois </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
X e 1 - atrav√©s de AND bin√°rio</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Opera√ß√µes bin√°rias como OR, AND, XOR s√£o processadas pelo processador em um per√≠odo m√≠nimo de tempo. </font><font style="vertical-align: inherit;">Mas a opera√ß√£o de divis√£o √© uma tarefa n√£o trivial e, para execut√°-la, o processador precisa processar muitas instru√ß√µes, essencialmente executar todo o programa. </font><font style="vertical-align: inherit;">No entanto, existem opera√ß√µes bin√°rias de deslocamento √† esquerda e √† direita que permitem, por exemplo, dividir rapidamente um n√∫mero por 2. A quest√£o √© se os compiladores usam essa otimiza√ß√£o e se h√° uma diferen√ßa entre essas duas compara√ß√µes, que de fato fazem o mesmo.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Codifica√ß√£o</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Escreveremos um programa que processar√° 9.000.000.000 de n√∫meros em um ciclo em ordem e determinaremos sua perten√ßa a par / √≠mpar determinando o restante da divis√£o.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OddEvenViaMod</span> </span>{
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span> <span class="hljs-params">(String[] args)</span> </span>{
                <span class="hljs-keyword">long</span> i=<span class="hljs-number">0</span>;
                <span class="hljs-keyword">long</span> odds=<span class="hljs-number">0</span>;
                <span class="hljs-keyword">long</span> evens=<span class="hljs-number">0</span>;
                <span class="hljs-keyword">do</span> {
                <span class="hljs-keyword">if</span> ((i % <span class="hljs-number">2</span>) == <span class="hljs-number">0</span>) {<font></font>
                        evens++;<font></font>
                        }<font></font>
                <span class="hljs-keyword">else</span> {<font></font>
                        odds++;<font></font>
                        }<font></font>
                i++;<font></font>
                } <span class="hljs-keyword">while</span> (i&lt;<span class="hljs-number">9000000000L</span>);<font></font>
                System.out.println(<span class="hljs-string">"Odd "</span> + odds);<font></font>
                System.out.println(<span class="hljs-string">"Even "</span> + evens);<font></font>
        }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E escreveremos exatamente o mesmo, mas literalmente mudamos dois caracteres, verificando a mesma coisa atrav√©s de um bin√°rio AND.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OddEvenViaAnd</span> </span>{
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span> <span class="hljs-params">(String[] args)</span> </span>{
                <span class="hljs-keyword">long</span> i=<span class="hljs-number">0</span>;
                <span class="hljs-keyword">long</span> odds=<span class="hljs-number">0</span>;
                <span class="hljs-keyword">long</span> evens=<span class="hljs-number">0</span>;
                <span class="hljs-keyword">do</span> {
                <span class="hljs-keyword">if</span> ((i &amp; <span class="hljs-number">1</span>) == <span class="hljs-number">0</span>) {<font></font>
                        evens++;<font></font>
                        }<font></font>
                <span class="hljs-keyword">else</span> {<font></font>
                        odds++;<font></font>
                        }<font></font>
                i++;<font></font>
                } <span class="hljs-keyword">while</span> (i&lt;<span class="hljs-number">9000000000L</span>);<font></font>
                System.out.println(<span class="hljs-string">"Odd "</span> + odds);<font></font>
                System.out.println(<span class="hljs-string">"Even "</span> + evens);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, precisamos comparar de alguma forma esses dois programas.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recursos no Linux. </font><font style="vertical-align: inherit;">CPU</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma quantidade enorme de horas foi gasta na cria√ß√£o de qualquer sistema operacional, em particular na distribui√ß√£o justa de recursos entre os programas. </font><font style="vertical-align: inherit;">Por um lado, isso √© bom, pois ao executar dois programas, voc√™ pode ter certeza de que eles funcionar√£o em paralelo, mas por outro lado, quando voc√™ precisa verificar o desempenho de um programa, √© extremamente necess√°rio limitar ou pelo menos reduzir a influ√™ncia externa sobre o programa de outras pessoas. programas e sistema operacional. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A primeira coisa a descobrir √© o processador. </font><font style="vertical-align: inherit;">O SO Linux para cada processo armazena uma m√°scara de bits, que indica quais kernels podem ser usados ‚Äã‚Äãpelo aplicativo e quais n√£o. </font><font style="vertical-align: inherit;">Voc√™ pode visualizar e alterar essa m√°scara com o comando taskset. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, vamos ver o n√∫mero de n√∫cleos no meu processador:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]# grep -c processor /proc/cpuinfo<font></font>
4<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meu computador possui um processador com 4 n√∫cleos. </font><font style="vertical-align: inherit;">Isso √© bom, porque vou alocar um deles para minhas necessidades. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos ver se todos eles est√£o em uso no momento com o comando top:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]# top
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pressione "1" para visualizar informa√ß√µes sobre cada n√∫cleo separadamente:</font></font><br>
<br>
<pre><code class="plaintext hljs">top - 13:44:11 up 1 day, 23:26,  7 users,  load average: 1.48, 2.21, 2.02<font></font>
Tasks: 321 total,   1 running, 320 sleeping,   0 stopped,   0 zombie<font></font>
%Cpu0  :  7.7 us,  6.8 sy,  0.0 ni, 85.5 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st<font></font>
%Cpu1  :  9.2 us,  4.2 sy,  0.0 ni, 86.6 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st<font></font>
%Cpu2  :  7.6 us,  3.4 sy,  0.0 ni, 89.1 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st<font></font>
%Cpu3  :  8.4 us,  4.2 sy,  0.0 ni, 87.4 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st<font></font>
KiB Mem : 16210820 total,   296972 free, 10072092 used,  5841756 buff/cache<font></font>
KiB Swap: 16777212 total, 16777212 free,        0 used.  5480568 avail Mem<font></font>
....<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui vemos que todos os n√∫cleos s√£o usados ‚Äã‚Äãaproximadamente da mesma forma. </font><font style="vertical-align: inherit;">(os indicadores us e sy e id s√£o aproximadamente iguais para cada n√∫cleo). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora vamos tentar ver o mesmo com o comando taskset.</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]# taskset -p 1<font></font>
pid 1's current affinity mask: f<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A m√°scara de bit "F" no sistema hexadecimal significa 15 em decimal ou 1111 em bin√°rio (8 + 4 + 2 + 1). </font><font style="vertical-align: inherit;">Todos os bits est√£o ativados, o que significa que todos os n√∫cleos s√£o usados ‚Äã‚Äãpor um processo com PID 1. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No Linux, quando um processo gera outro com uma chamada de sistema clone, a m√°scara de bit √© copiada do pai no momento da clonagem. </font><font style="vertical-align: inherit;">Isso significa que, se alterarmos essa m√°scara para o nosso processo init (no meu caso, √© systemd), ao iniciar qualquer novo processo atrav√©s do systemd, esse novo processo j√° ser√° iniciado com uma nova m√°scara. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode alterar a m√°scara do processo usando o mesmo comando, listando os n√∫meros de n√∫cleos da CPU que queremos deixar usados ‚Äã‚Äãpara o processo. </font><font style="vertical-align: inherit;">Suponha que desejemos deixar o kernel 0.2.3 para o nosso processo e queremos desativar o kernel 1 para o processo do systemd. </font><font style="vertical-align: inherit;">Para fazer isso, precisamos executar o comando:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]#  taskset -pc 0,2,3 1<font></font>
pid 1's current affinity list: 0-3<font></font>
pid 1's new affinity list: 0,2,3<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verificamos:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]# taskset -p 1<font></font>
pid 1's current affinity mask: d<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A m√°scara mudou para "D" na nota√ß√£o hexadecimal, que √© 13 em decimal e 1101 em bin√°rio (8 + 4 + 0 + 1). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A partir de agora, qualquer processo que ser√° clonado pelo processo systemd ter√° automaticamente uma m√°scara 1101 de uso da CPU, o que significa que o kernel n√∫mero 1 n√£o ser√° usado.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proibimos o uso do kernel em todos os processos</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Impedir que o processo principal do Linux use um √∫nico kernel afetar√° apenas os novos processos criados por esse processo. </font><font style="vertical-align: inherit;">Mas no meu sistema j√° n√£o existe um processo, mas uma multid√£o inteira, como crond, sshd, bash e outros. </font><font style="vertical-align: inherit;">Se eu precisar proibir todos os processos de usar um n√∫cleo, execute o comando taskset para cada processo em execu√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para obter uma lista de todos os processos, usaremos a API que o kernel nos fornece, a saber, o sistema de arquivos / proc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais adiante, analisamos o PID de cada processo em execu√ß√£o e alteramos a m√°scara para ele e todos os threads:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]# cd /proc; for i in `ls -d [0-9]*`; do taskset -a -pc 0,2,3 $i; done<font></font>
pid 1's current affinity list: 0,2,3<font></font>
pid 1's new affinity list: 0,2,3<font></font>
...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como durante a execu√ß√£o do programa, alguns processos podem ter tempo para gerar outros processos, √© melhor executar esse comando v√°rias vezes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verifique o resultado do nosso trabalho com o comando top:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]# top<font></font>
top - 14:20:46 up 2 days, 3 min,  7 users,  load average: 0.19, 0.27, 0.57<font></font>
Tasks: 324 total,   4 running, 320 sleeping,   0 stopped,   0 zombie<font></font>
%Cpu0  :  8.9 us,  7.7 sy,  0.0 ni, 83.4 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st<font></font>
%Cpu1  :  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st<font></font>
%Cpu2  :  9.5 us,  6.0 sy,  0.0 ni, 84.5 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st<font></font>
%Cpu3  :  8.4 us,  6.6 sy,  0.0 ni, 85.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st<font></font>
KiB Mem : 16210820 total,   285724 free, 10142548 used,  5782548 buff/cache<font></font>
KiB Swap: 16777212 total, 16777212 free,        0 used.  5399648 avail Mem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como voc√™ pode ver, a imagem mudou um pouco, agora para o kernel 0.2.3 os par√¢metros m√©dios us, sy, id s√£o os mesmos para n√≥s, e para o kernel 1 nosso consumo principal no espa√ßo do usu√°rio e sys √© 0 e o kernel est√° ocioso a 100% (ocioso 100 ) </font><font style="vertical-align: inherit;">O kernel 1 n√£o √© mais usado por nossos aplicativos e uma porcentagem muito pequena atualmente √© usada pelo kernel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, a tarefa de testar o desempenho √© reduzida para iniciar nosso processo em um n√∫cleo livre.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mem√≥ria</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A mem√≥ria f√≠sica alocada para um processo pode ser facilmente obtida de qualquer processo. </font><font style="vertical-align: inherit;">Esse mecanismo √© chamado de troca. </font><font style="vertical-align: inherit;">Se o Linux tiver um lugar para troca, ele ser√° feito de qualquer maneira. </font><font style="vertical-align: inherit;">A √∫nica maneira de impedir que o sistema operacional tire mem√≥ria do nosso processo, como qualquer outro processo, √© desativar completamente a se√ß√£o de troca, o que faremos:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]$ sudo swapoff -a<font></font>
[user@localhost]$ free -m<font></font>
              total        used        free      shared  buff/cache   available<font></font>
Mem:          15830        7294        1894         360        6641        7746<font></font>
Swap:             0           0           0<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alocamos 1 n√∫cleo do processador, que n√£o √© usado, e tamb√©m removemos a capacidade de trocar mem√≥ria do kernel do Linux. </font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Disco</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para reduzir o impacto do disco no lan√ßamento do nosso processo, crie um disco na mem√≥ria e copie todos os arquivos necess√°rios para esse disco. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Crie um diret√≥rio e monte o sistema de arquivos:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]$ sudo mkdir /mnt/ramdisk;<font></font>
[user@localhost]$ mount -t tmpfs -o size=512m tmpfs /mnt/ramdisk<font></font>
[user@localhost]$ chown user: /mnt/ramdisk<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora precisamos descobrir o que e como planejamos lan√ß√°-lo. </font><font style="vertical-align: inherit;">Para executar nosso programa, primeiro precisamos compilar nosso c√≥digo:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]$ javac OddEvenViaMod.java
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o voc√™ precisa execut√°-lo:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]$ java OddEvenViaMod
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas, no nosso caso, queremos executar o processo no n√∫cleo do processador que n√£o √© usado por nenhum outro processo. </font><font style="vertical-align: inherit;">Portanto, execute-o no conjunto de tarefas:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]# taskset -c 1 time java OddEvenViaMod
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em nossos testes, precisamos medir o tempo, para que nossa linha de lan√ßamento se transforme em</font></font><br>
<br>
<pre><code class="plaintext hljs">taskset -c 1 time java OddEvenViaMod
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O SO Linux suporta v√°rios formatos de arquivos execut√°veis, e o mais comum deles √© o formato ELF. Esse formato de arquivo permite que o sistema operacional n√£o execute seu arquivo, mas execute outro arquivo. √Ä primeira vista, n√£o parece muito l√≥gico e compreens√≠vel. Imagine que eu inicio o jogo Campo Minado, e o jogo Mario come√ßa para mim - parece um v√≠rus. Mas essa √© a l√≥gica. Se o meu programa exigir qualquer biblioteca din√¢mica, por exemplo libc ou qualquer outra, isso significa que o sistema operacional deve primeiro carregar essa biblioteca na mem√≥ria e depois carregar e executar o meu programa. E parece l√≥gico colocar essa funcionalidade no pr√≥prio sistema operacional, mas o sistema operacional funciona em uma √°rea protegida da mem√≥ria e deve conter o m√≠nimo de funcionalidade poss√≠vel e necess√°rio.Portanto, o formato ELF oferece a oportunidade de informar ao sistema operacional que queremos fazer o download de algum outro programa, e esse "outro" programa far√° o download de todas as bibliotecas necess√°rias e do nosso programa e iniciar√° tudo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o, precisamos executar 3 arquivos, este √© o conjunto de tarefas, hora, java. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Confira o primeiro deles:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]$ whereis taskset<font></font>
taskset: /usr/bin/taskset /usr/share/man/man1/taskset.1.gz<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O Bash executar√° o arquivo / usr / bin / taskset, verifique o que est√° dentro:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]$ file /usr/bin/taskset<font></font>
/usr/bin/taskset: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.32, BuildID[sha1]=7a2fd0779f64aa9047faa00f498042f0f0c5dc60, stripped<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este √© o arquivo ELF que escrevi acima. </font><font style="vertical-align: inherit;">No arquivo ELF, al√©m do pr√≥prio programa, existem v√°rios cabe√ßalhos. </font><font style="vertical-align: inherit;">Ao iniciar esse arquivo, o sistema operacional verifica seus cabe√ßalhos e, se o cabe√ßalho "Solicitando int√©rprete de programa" existir no arquivo, o sistema operacional iniciar√° o arquivo a partir desse cabe√ßalho e passar√° o arquivo iniciado inicialmente como argumento. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verifique se este cabe√ßalho existe em nosso arquivo ELF:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]$ readelf -a /usr/bin/taskset  | grep -i interpreter<font></font>
      [Requesting program interpreter: /lib64/ld-linux-x86-64.so.2]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O cabe√ßalho existe, o que significa que, ao iniciar o arquivo / usr / bin / taskset, executamos /lib64/ld-linux-x86-64.so.2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verifique o que √© esse arquivo:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]$ ls -lah /lib64/ld-linux-x86-64.so.2<font></font>
lrwxrwxrwx 1 root root 10 May 21  2019 /lib64/ld-linux-x86-64.so.2 -&gt; ld-2.17.so<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este √© um link sim para o arquivo /lib64/ld-2.17.so. </font><font style="vertical-align: inherit;">Confira:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]$ file /lib64/ld-2.17.so<font></font>
/lib64/ld-2.17.so: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, BuildID[sha1]=a527fe72908703c5972ae384e78d1850d1881ee7, not stripped<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como voc√™ pode ver, esse √© outro arquivo ELF que o sistema operacional executar√°. </font><font style="vertical-align: inherit;">N√≥s olhamos para os cabe√ßalhos:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]$ readelf -a /lib64/ld-2.17.so  | grep -i interpreter<font></font>
[user@localhost]$<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos que esse arquivo ELF n√£o possui esse cabe√ßalho; portanto, o SO executar√° esse arquivo e transferir√° o controle para ele. </font><font style="vertical-align: inherit;">E esse arquivo j√° abrir√° nosso arquivo / usr / bin / taskset, leia a partir da√≠ informa√ß√µes sobre todas as bibliotecas necess√°rias. </font><font style="vertical-align: inherit;">A lista de bibliotecas necess√°rias tamb√©m est√° nos cabe√ßalhos do arquivo ELF. </font><font style="vertical-align: inherit;">Podemos ver esta lista com o comando ldd ou readelf, que √© a mesma coisa:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]$ ldd /usr/bin/taskset<font></font>
	linux-vdso.so.1 =&gt;  (0x00007ffc4c1df000)<font></font>
	libc.so.6 =&gt; /lib64/libc.so.6 (0x00007f4a24c4e000)<font></font>
	/lib64/ld-linux-x86-64.so.2 (0x00007f4a2501b000)<font></font>
<font></font>
[user@localhost]$ readelf -a /usr/bin/taskset  | grep NEEDED<font></font>
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O VDSO √© uma parte da mem√≥ria vinculada que n√£o est√° relacionada √†s bibliotecas; portanto, est√° ausente no arquivo ELF como uma biblioteca necess√°ria. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso deixa claro que o programa /lib64/ld-2.17.so √© respons√°vel por executar todos os programas que o exigem, e todos esses programas com bibliotecas vinculadas dinamicamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se executarmos / usr / bin / taskset, ser√° exatamente o mesmo que executarmos /lib64/ld-2.17.so com o argumento / usr / bin / taskset. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voltamos ao problema da influ√™ncia do disco em nossos testes. </font><font style="vertical-align: inherit;">Agora sabemos que, se queremos carregar nosso programa da mem√≥ria, precisamos copiar n√£o um arquivo, mas v√°rios:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]$ cp /lib64/libc-2.17.so /mnt/ramdisk/<font></font>
[user@localhost]$ cp /lib64/ld-2.17.so /mnt/ramdisk/<font></font>
[user@localhost]$ cp /usr/bin/taskset /mnt/ramdisk/<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fazemos o mesmo com o tempo, cujos requisitos de biblioteca s√£o exatamente os mesmos (j√° copi√°mos ld e libc).</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]$ cp /usr/bin/time /mnt/ramdisk/
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para java, as coisas s√£o um pouco mais complicadas, pois o java requer muitas bibliotecas diferentes que podem ser copiadas por um longo tempo. </font><font style="vertical-align: inherit;">Para simplificar um pouco a minha vida, copiarei o diret√≥rio inteiro do meu java openjdk para um disco na mem√≥ria e criei um link sim. </font><font style="vertical-align: inherit;">Obviamente, os acessos ao disco permanecer√£o nesse caso, mas haver√° menos.</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]$ cp -R /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.222.b10-0.el7_6.x86_64 /mnt/ramdisk/
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Renomeie o diret√≥rio antigo, adicionando o final. Padr√£o a ele</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]$ sudo mv /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.222.b10-0.el7_6.x86_64{,.default}
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E crie um link simb√≥lico:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost]$ sudo ln -s /mnt/ramdisk/java-1.8.0-openjdk-1.8.0.222.b10-0.el7_6.x86_64 /usr/lib/jvm/
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J√° sabemos como executar um arquivo bin√°rio atrav√©s do argumento para o arquivo /lib64/ld-2.17.so, que realmente √© iniciado. </font><font style="vertical-align: inherit;">Mas como fazer com que o programa /lib64/ld-2.17.so carregue bibliotecas carregadas do diret√≥rio especificado? </font><font style="vertical-align: inherit;">man ld para nos ajudar, a partir do qual aprendemos que, se voc√™ declarar a vari√°vel de ambiente LD_LIBRARY_PATH, o programa ld carregar√° as bibliotecas dos diret√≥rios especificados. </font><font style="vertical-align: inherit;">Agora, temos todos os dados para preparar a linha de lan√ßamento do aplicativo Java. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Come√ßamos v√°rias vezes seguidas e verificamos:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost ramdisk]$ export LD_LIBRARY_PATH=/mnt/ramdisk ; /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/taskset -c 1 /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/time /mnt/ramdisk/ld-2.17.so java OddEvenViaMod<font></font>
Odd 4500000000<font></font>
Even 4500000000<font></font>
10.66user 0.01system 0:10.67elapsed 99%CPU (0avgtext+0avgdata 20344maxresident)k<font></font>
0inputs+64outputs (0major+5229minor)pagefaults 0swaps<font></font>
[user@localhost ramdisk]$<font></font>
[user@localhost ramdisk]$ export LD_LIBRARY_PATH=/mnt/ramdisk ; /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/taskset -c 1 /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/time /mnt/ramdisk/ld-2.17.so java OddEvenViaMod<font></font>
Odd 4500000000<font></font>
Even 4500000000<font></font>
10.65user 0.01system 0:10.67elapsed 99%CPU (0avgtext+0avgdata 20348maxresident)k<font></font>
0inputs+64outputs (0major+5229minor)pagefaults 0swaps<font></font>
[user@localhost ramdisk]$<font></font>
[user@localhost ramdisk]$ export LD_LIBRARY_PATH=/mnt/ramdisk ; /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/taskset -c 1 /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/time /mnt/ramdisk/ld-2.17.so java OddEvenViaMod<font></font>
Odd 4500000000<font></font>
Even 4500000000<font></font>
10.66user 0.01system 0:10.68elapsed 99%CPU (0avgtext+0avgdata 20348maxresident)k<font></font>
0inputs+64outputs (0major+5229minor)pagefaults 0swaps<font></font>
[user@localhost ramdisk]$<font></font>
[user@localhost ramdisk]$ export LD_LIBRARY_PATH=/mnt/ramdisk ; /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/taskset -c 1 /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/time /mnt/ramdisk/ld-2.17.so java OddEvenViaMod<font></font>
Odd 4500000000<font></font>
Even 4500000000<font></font>
10.65user 0.01system 0:10.67elapsed 99%CPU (0avgtext+0avgdata 20348maxresident)k<font></font>
0inputs+96outputs (0major+5234minor)pagefaults 0swaps<font></font>
[user@localhost ramdisk]$<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante a execu√ß√£o do programa, podemos executar o top e garantir que o programa seja executado no n√∫cleo da CPU correto.</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost ramdisk]$ top<font></font>
...<font></font>
%Cpu0  : 19.7 us, 11.7 sy,  0.0 ni, 68.6 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st<font></font>
%Cpu1  :100.0 us,  0.0 sy,  0.0 ni,  0.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st<font></font>
%Cpu2  :  9.8 us,  9.1 sy,  0.0 ni, 81.1 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st<font></font>
%Cpu3  : 14.0 us,  9.0 sy,  0.0 ni, 77.1 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 s<font></font>
...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como voc√™ pode ver, os resultados na maioria dos casos s√£o semelhantes. </font><font style="vertical-align: inherit;">Infelizmente, n√£o podemos remover completamente a influ√™ncia do sistema operacional no n√∫cleo da CPU, portanto o resultado ainda depende das tarefas espec√≠ficas dentro do kernel do Linux no momento do lan√ßamento. </font><font style="vertical-align: inherit;">Portanto, √© melhor usar a mediana dos valores de v√°rias partidas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No nosso caso, vemos que o programa java processa 9.000.000.000 com paridade pelo restante da divis√£o em 10.65 segundos em um n√∫cleo de CPU. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos fazer o mesmo teste com o nosso segundo programa, que faz a mesma coisa atrav√©s do AND bin√°rio.</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost ramdisk]$ export LD_LIBRARY_PATH=/mnt/ramdisk ; /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/taskset -c 1 /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/time /mnt/ramdisk/ld-2.17.so java OddEvenViaAnd<font></font>
Odd 4500000000<font></font>
Even 4500000000<font></font>
4.02user 0.00system 0:04.03elapsed 99%CPU (0avgtext+0avgdata 20224maxresident)k<font></font>
0inputs+64outputs (0major+5197minor)pagefaults 0swaps<font></font>
[user@localhost ramdisk]$<font></font>
[user@localhost ramdisk]$ export LD_LIBRARY_PATH=/mnt/ramdisk ; /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/taskset -c 1 /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/time /mnt/ramdisk/ld-2.17.so java OddEvenViaAnd<font></font>
Odd 4500000000<font></font>
Even 4500000000<font></font>
4.01user 0.00system 0:04.03elapsed 99%CPU (0avgtext+0avgdata 20228maxresident)k<font></font>
0inputs+64outputs (0major+5199minor)pagefaults 0swaps<font></font>
[user@localhost ramdisk]$<font></font>
[user@localhost ramdisk]$ export LD_LIBRARY_PATH=/mnt/ramdisk ; /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/taskset -c 1 /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/time /mnt/ramdisk/ld-2.17.so java OddEvenViaAnd<font></font>
Odd 4500000000<font></font>
Even 4500000000<font></font>
4.01user 0.01system 0:04.03elapsed 99%CPU (0avgtext+0avgdata 20224maxresident)k<font></font>
0inputs+64outputs (0major+5198minor)pagefaults 0swaps<font></font>
[user@localhost ramdisk]$<font></font>
[user@localhost ramdisk]$ export LD_LIBRARY_PATH=/mnt/ramdisk ; /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/taskset -c 1 /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/time /mnt/ramdisk/ld-2.17.so java OddEvenViaAnd<font></font>
Odd 4500000000<font></font>
Even 4500000000<font></font>
4.02user 0.00system 0:04.03elapsed 99%CPU (0avgtext+0avgdata 20224maxresident)k<font></font>
0inputs+64outputs (0major+5198minor)pagefaults 0swaps<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora podemos dizer com confian√ßa que a compara√ß√£o da paridade atrav√©s do bin√°rio AND leva 4,02 segundos, o que significa que, comparada √† verifica√ß√£o no restante da divis√£o, ela funciona 2,6 vezes mais r√°pido, pelo menos no openjdk vers√£o 1.8.0.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oracle Java vs Openjdk</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu baixei e jdk java descompactado no site da Oracle para o diret√≥rio /mnt/ramdisk/jdk-13.0.2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compila√ß√£o:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost ramdisk]$ /mnt/ramdisk/jdk-13.0.2/bin/javac OddEvenViaAnd.java
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lan√ßamos:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost ramdisk]$ export LD_LIBRARY_PATH=/mnt/ramdisk ; /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/taskset -c 1 /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/time /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/jdk-13.0.2/bin/java OddEvenViaAnd<font></font>
Odd 4500000000<font></font>
Even 4500000000<font></font>
10.39user 0.01system 0:10.41elapsed 99%CPU (0avgtext+0avgdata 24260maxresident)k<font></font>
0inputs+64outputs (0major+6979minor)pagefaults 0swaps<font></font>
[user@localhost ramdisk]$<font></font>
[user@localhost ramdisk]$ export LD_LIBRARY_PATH=/mnt/ramdisk ; /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/taskset -c 1 /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/time /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/jdk-13.0.2/bin/java OddEvenViaAnd<font></font>
Odd 4500000000<font></font>
Even 4500000000<font></font>
10.40user 0.01system 0:10.42elapsed 99%CPU (0avgtext+0avgdata 24268maxresident)k<font></font>
0inputs+64outputs (0major+6985minor)pagefaults 0swaps<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√≥s compilamos o segundo programa:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost ramdisk]$ /mnt/ramdisk/jdk-13.0.2/bin/javac OddEvenViaMod.java
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lan√ßamos:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost ramdisk]$ export LD_LIBRARY_PATH=/mnt/ramdisk ; /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/taskset -c 1 /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/time /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/jdk-13.0.2/bin/java OddEvenViaMod<font></font>
Odd 4500000000<font></font>
Even 4500000000<font></font>
10.39user 0.01system 0:10.40elapsed 99%CPU (0avgtext+0avgdata 24324maxresident)k<font></font>
0inputs+96outputs (0major+7003minor)pagefaults 0swaps<font></font>
[user@localhost ramdisk]$<font></font>
[user@localhost ramdisk]$ export LD_LIBRARY_PATH=/mnt/ramdisk ; /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/taskset -c 1 /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/time /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/jdk-13.0.2/bin/java OddEvenViaMod<font></font>
Odd 4500000000<font></font>
Even 4500000000<font></font>
10.40user 0.00system 0:10.41elapsed 99%CPU (0avgtext+0avgdata 24316maxresident)k<font></font>
0inputs+64outputs (0major+6992minor)pagefaults 0swaps<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O tempo de execu√ß√£o das mesmas fontes no oracle jdk √© o mesmo para o restante da divis√£o e o bin√°rio AND, que parece normal, mas esse tempo √© igualmente ruim, o que foi mostrado em openjdk no restante da divis√£o.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pit√£o</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos tentar comparar o mesmo em Python. </font><font style="vertical-align: inherit;">Primeiro, a op√ß√£o com o restante da divis√£o por 2:</font></font><br>
<br>
<pre><code class="python hljs">odd=<span class="hljs-number">0</span>
even=<span class="hljs-number">0</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">100000000</span>):
	<span class="hljs-keyword">if</span> i % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<font></font>
		even += <span class="hljs-number">1</span>
	<span class="hljs-keyword">else</span>:<font></font>
		odd += <span class="hljs-number">1</span>
<span class="hljs-keyword">print</span> <span class="hljs-string">"even"</span>, even
<span class="hljs-keyword">print</span> <span class="hljs-string">"odd"</span>, odd
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lan√ßamos:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost ramdisk]$ export LD_LIBRARY_PATH=/mnt/ramdisk ; /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/taskset -c 1 /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/time /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/python2.7 odd_mod.py<font></font>
even 50000000<font></font>
odd 50000000<font></font>
11.69user 0.00system 0:11.69elapsed 99%CPU (0avgtext+0avgdata 4584maxresident)k<font></font>
0inputs+0outputs (0major+1220minor)pagefaults 0swaps<font></font>
[user@localhost ramdisk]$<font></font>
[user@localhost ramdisk]$ export LD_LIBRARY_PATH=/mnt/ramdisk ; /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/taskset -c 1 /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/time /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/python2.7 odd_mod.py<font></font>
even 50000000<font></font>
odd 50000000<font></font>
11.67user 0.00system 0:11.67elapsed 99%CPU (0avgtext+0avgdata 4584maxresident)k<font></font>
0inputs+0outputs (0major+1220minor)pagefaults 0swaps<font></font>
[user@localhost ramdisk]$<font></font>
[user@localhost ramdisk]$ export LD_LIBRARY_PATH=/mnt/ramdisk ; /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/taskset -c 1 /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/time /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/python2.7 odd_mod.py<font></font>
even 50000000<font></font>
odd 50000000<font></font>
11.66user 0.00system 0:11.66elapsed 99%CPU (0avgtext+0avgdata 4584maxresident)k<font></font>
0inputs+0outputs (0major+1220minor)pagefaults 0swaps<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, a mesma coisa com o bin√°rio AND:</font></font><br>
<br>
<pre><code class="python hljs">odd=<span class="hljs-number">0</span>
even=<span class="hljs-number">0</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">100000000</span>):
	<span class="hljs-keyword">if</span> i &amp; <span class="hljs-number">1</span> == <span class="hljs-number">0</span>:<font></font>
		even += <span class="hljs-number">1</span>
	<span class="hljs-keyword">else</span>:<font></font>
		odd += <span class="hljs-number">1</span>
<span class="hljs-keyword">print</span> <span class="hljs-string">"even"</span>, even
<span class="hljs-keyword">print</span> <span class="hljs-string">"odd"</span>, odd
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lan√ßamos:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost ramdisk]$ export LD_LIBRARY_PATH=/mnt/ramdisk ; /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/taskset -c 1 /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/time /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/python2.7 odd_and.py<font></font>
even 50000000<font></font>
odd 50000000<font></font>
10.41user 0.00system 0:10.41elapsed 99%CPU (0avgtext+0avgdata 4588maxresident)k<font></font>
0inputs+0outputs (0major+1221minor)pagefaults 0swaps<font></font>
[user@localhost ramdisk]$<font></font>
[user@localhost ramdisk]$ export LD_LIBRARY_PATH=/mnt/ramdisk ; /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/taskset -c 1 /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/time /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/python2.7 odd_and.py<font></font>
even 50000000<font></font>
odd 50000000<font></font>
10.43user 0.00system 0:10.43elapsed 99%CPU (0avgtext+0avgdata 4588maxresident)k<font></font>
0inputs+0outputs (0major+1222minor)pagefaults 0swaps<font></font>
[user@localhost ramdisk]$<font></font>
[user@localhost ramdisk]$ export LD_LIBRARY_PATH=/mnt/ramdisk ; /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/taskset -c 1 /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/time /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/python2.7 odd_and.py<font></font>
even 50000000<font></font>
odd 50000000<font></font>
10.43user 0.00system 0:10.43elapsed 99%CPU (0avgtext+0avgdata 4584maxresident)k<font></font>
0inputs+0outputs (0major+1222minor)pagefaults 0swaps<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os resultados mostram que AND √© mais r√°pido. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na Internet, j√° foi escrito muitas vezes que as vari√°veis ‚Äã‚Äãglobais em Python s√£o mais lentas. </font><font style="vertical-align: inherit;">Decidi comparar o tempo de execu√ß√£o do √∫ltimo programa com AND e exatamente o mesmo, mas envolvido em uma fun√ß√£o:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span>
	odd=<span class="hljs-number">0</span>
	even=<span class="hljs-number">0</span>
	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">100000000</span>):
		<span class="hljs-keyword">if</span> i &amp; <span class="hljs-number">1</span> == <span class="hljs-number">0</span>:<font></font>
			even += <span class="hljs-number">1</span>
		<span class="hljs-keyword">else</span>:<font></font>
			odd += <span class="hljs-number">1</span>
	<span class="hljs-keyword">print</span> <span class="hljs-string">"even"</span>, even
	<span class="hljs-keyword">print</span> <span class="hljs-string">"odd"</span>, odd<font></font>
<font></font>
main()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Execute na fun√ß√£o:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost ramdisk]$ export LD_LIBRARY_PATH=/mnt/ramdisk ; /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/taskset -c 1 /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/time /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/python2.7 odd_and_func.py<font></font>
even 50000000<font></font>
odd 50000000<font></font>
5.08user 0.00system 0:05.08elapsed 99%CPU (0avgtext+0avgdata 4592maxresident)k<font></font>
0inputs+0outputs (0major+1222minor)pagefaults 0swaps<font></font>
[user@localhost ramdisk]$<font></font>
[user@localhost ramdisk]$ export LD_LIBRARY_PATH=/mnt/ramdisk ; /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/taskset -c 1 /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/time /mnt/ramdisk/ld-2.17.so /mnt/ramdisk/python2.7 odd_and_func.py<font></font>
even 50000000<font></font>
odd 50000000<font></font>
5.08user 0.00system 0:05.09elapsed 99%CPU (0avgtext+0avgdata 4592maxresident)k<font></font>
0inputs+0outputs (0major+1223minor)pagefaults 0swaps<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como voc√™ pode ver, a mesma compara√ß√£o de paridade no Python via AND bin√°rio em uma fun√ß√£o processa 100000000 n√∫meros em um √∫nico n√∫cleo da CPU em ~ 5 segundos, a mesma compara√ß√£o via AND sem uma fun√ß√£o leva ~ 10 segundos, e a compara√ß√£o sem uma fun√ß√£o pelo restante da divis√£o leva ~ 11 segundos </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por que um programa Python em uma fun√ß√£o funciona mais r√°pido do que sem ele j√° foi descrito mais de uma vez e est√° relacionado ao escopo das vari√°veis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O Python tem a capacidade de desmontar um programa em fun√ß√µes internas que o Python usa ao interpretar um programa. </font><font style="vertical-align: inherit;">Vamos ver quais fun√ß√µes o Python usa para a variante com a fun√ß√£o odd_and_func.py:</font></font><br>
<br>
<pre><code class="plaintext hljs">[user@localhost ramdisk]# python<font></font>
Python 2.7.5 (default, Jun 20 2019, 20:27:34)<font></font>
[GCC 4.8.5 20150623 (Red Hat 4.8.5-36)] on linux2<font></font>
Type "help", "copyright", "credits" or "license" for more information.<font></font>
&gt;&gt;&gt; def main():<font></font>
...     odd=0<font></font>
...     even=0<font></font>
...     for i in xrange(100000000):<font></font>
...             if i &amp; 1 == 0:<font></font>
...                     even += 1<font></font>
...             else:<font></font>
...                     odd += 1<font></font>
...     print "even", even<font></font>
...     print "odd", odd<font></font>
...<font></font>
&gt;&gt;&gt; import dis<font></font>
&gt;&gt;&gt; dis.dis(main)<font></font>
  2           0 LOAD_CONST               1 (0)<font></font>
              3 STORE_FAST               0 (odd)<font></font>
<font></font>
  3           6 LOAD_CONST               1 (0)<font></font>
              9 STORE_FAST               1 (even)<font></font>
<font></font>
  4          12 SETUP_LOOP              59 (to 74)<font></font>
             15 LOAD_GLOBAL              0 (xrange)<font></font>
             18 LOAD_CONST               2 (100000000)<font></font>
             21 CALL_FUNCTION            1<font></font>
             24 GET_ITER<font></font>
        &gt;&gt;   25 FOR_ITER                45 (to 73)<font></font>
             28 STORE_FAST               2 (i)<font></font>
<font></font>
  5          31 LOAD_FAST                2 (i)<font></font>
             34 LOAD_CONST               3 (1)<font></font>
             37 BINARY_AND<font></font>
             38 LOAD_CONST               1 (0)<font></font>
             41 COMPARE_OP               2 (==)<font></font>
             44 POP_JUMP_IF_FALSE       60<font></font>
<font></font>
  6          47 LOAD_FAST                1 (even)<font></font>
             50 LOAD_CONST               3 (1)<font></font>
             53 INPLACE_ADD<font></font>
             54 STORE_FAST               1 (even)<font></font>
             57 JUMP_ABSOLUTE           25<font></font>
<font></font>
  8     &gt;&gt;   60 LOAD_FAST                0 (odd)<font></font>
             63 LOAD_CONST               3 (1)<font></font>
             66 INPLACE_ADD<font></font>
             67 STORE_FAST               0 (odd)<font></font>
             70 JUMP_ABSOLUTE           25<font></font>
        &gt;&gt;   73 POP_BLOCK<font></font>
<font></font>
  9     &gt;&gt;   74 LOAD_CONST               4 ('even')<font></font>
             77 PRINT_ITEM<font></font>
             78 LOAD_FAST                1 (even)<font></font>
             81 PRINT_ITEM<font></font>
             82 PRINT_NEWLINE<font></font>
<font></font>
 10          83 LOAD_CONST               5 ('odd')<font></font>
             86 PRINT_ITEM<font></font>
             87 LOAD_FAST                0 (odd)<font></font>
             90 PRINT_ITEM<font></font>
             91 PRINT_NEWLINE<font></font>
             92 LOAD_CONST               0 (None)<font></font>
             95 RETURN_VALUE<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E verifique o mesmo sem usar a fun√ß√£o em nosso c√≥digo:</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt;&gt;&gt; f=open("odd_and.py","r")<font></font>
&gt;&gt;&gt; l=f.read()<font></font>
&gt;&gt;&gt;<font></font>
&gt;&gt;&gt; l<font></font>
'odd=0\neven=0\nfor i in xrange(100000000):\n\tif i &amp; 1 == 0:\n\t\teven += 1\n\telse:\n\t\todd += 1\nprint "even", even\nprint "odd", odd\n'<font></font>
&gt;&gt;&gt; k=compile(l,'l','exec')<font></font>
&gt;&gt;&gt; k<font></font>
&lt;code object &lt;module&gt; at 0x7f2bdf39ecb0, file "l", line 1&gt;<font></font>
&gt;&gt;&gt; dis.dis(k)<font></font>
  1           0 LOAD_CONST               0 (0)<font></font>
              3 STORE_NAME               0 (odd)<font></font>
<font></font>
  2           6 LOAD_CONST               0 (0)<font></font>
              9 STORE_NAME               1 (even)<font></font>
<font></font>
  3          12 SETUP_LOOP              59 (to 74)<font></font>
             15 LOAD_NAME                2 (xrange)<font></font>
             18 LOAD_CONST               1 (100000000)<font></font>
             21 CALL_FUNCTION            1<font></font>
             24 GET_ITER<font></font>
        &gt;&gt;   25 FOR_ITER                45 (to 73)<font></font>
             28 STORE_NAME               3 (i)<font></font>
<font></font>
  4          31 LOAD_NAME                3 (i)<font></font>
             34 LOAD_CONST               2 (1)<font></font>
             37 BINARY_AND<font></font>
             38 LOAD_CONST               0 (0)<font></font>
             41 COMPARE_OP               2 (==)<font></font>
             44 POP_JUMP_IF_FALSE       60<font></font>
<font></font>
  5          47 LOAD_NAME                1 (even)<font></font>
             50 LOAD_CONST               2 (1)<font></font>
             53 INPLACE_ADD<font></font>
             54 STORE_NAME               1 (even)<font></font>
             57 JUMP_ABSOLUTE           25<font></font>
<font></font>
  7     &gt;&gt;   60 LOAD_NAME                0 (odd)<font></font>
             63 LOAD_CONST               2 (1)<font></font>
             66 INPLACE_ADD<font></font>
             67 STORE_NAME               0 (odd)<font></font>
             70 JUMP_ABSOLUTE           25<font></font>
        &gt;&gt;   73 POP_BLOCK<font></font>
<font></font>
  8     &gt;&gt;   74 LOAD_CONST               3 ('even')<font></font>
             77 PRINT_ITEM<font></font>
             78 LOAD_NAME                1 (even)<font></font>
             81 PRINT_ITEM<font></font>
             82 PRINT_NEWLINE<font></font>
<font></font>
  9          83 LOAD_CONST               4 ('odd')<font></font>
             86 PRINT_ITEM<font></font>
             87 LOAD_NAME                0 (odd)<font></font>
             90 PRINT_ITEM<font></font>
             91 PRINT_NEWLINE<font></font>
             92 LOAD_CONST               5 (None)<font></font>
             95 RETURN_VALUE<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como voc√™ pode ver, na variante com a fun√ß√£o declarada, o Python usa fun√ß√µes internas com o postfix FAST, por exemplo, STORE_FAST, LOAD_FAST, e na variante sem a declara√ß√£o da fun√ß√£o, o Python usa as fun√ß√µes internas STORE_NAME e LOAD_NAME. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este artigo tem pouco significado pr√°tico e visa mais entender alguns dos recursos do Linux e dos compiladores. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bom para todos!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt489196/index.html">Fuma√ßa m√°gica: microcontroladores vs. reguladores lineares</a></li>
<li><a href="../pt489198/index.html">Como n√£o se dar um tiro no p√© usando Liquibase</a></li>
<li><a href="../pt489200/index.html">O que as startups est√£o procurando pelo Y Combinator em 2020</a></li>
<li><a href="../pt489204/index.html">Uma an√°lise interna da confiabilidade dos servi√ßos do Facebook</a></li>
<li><a href="../pt489206/index.html">Hist√≥rias de travamento com Patroni ou Como eliminar um cluster do PostgreSQL</a></li>
<li><a href="../pt489212/index.html">1C-Bitrix impede o cancelamento da inscri√ß√£o no boletim informativo pelo requisito de enviar seus dados pessoais</a></li>
<li><a href="../pt489214/index.html">Abordagem moderna para testar a localiza√ß√£o no iOS</a></li>
<li><a href="../pt489218/index.html">√â ing√™nuo. Super: c√≥digo e arquitetura de um jogo simples</a></li>
<li><a href="../pt489226/index.html">M√©todos para otimizar consultas LINQ em C # .NET</a></li>
<li><a href="../pt489228/index.html">Bot de fala no banco - o pior UX de todos os tempos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>