<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ’§ ğŸ•š ğŸ‘©ğŸ½â€ğŸ¤â€ğŸ‘©ğŸ» æœ¬å½“ã«ã‚¹ãƒãƒ¼ãƒˆãªæ¤œç´¢ã‚’è¡Œã†ï¼šã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰ ğŸœï¸ ğŸ¤ â˜£ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ä¼æ¥­æƒ…å ±ã‚·ã‚¹ãƒ†ãƒ ã§æ¤œç´¢ -ã™ã§ã«ã“ã®ãƒ•ãƒ¬ãƒ¼ã‚ºè‡ªä½“ã‹ã‚‰å£ã‹ã‚‰å‡ºã‚‰ã‚Œãªããªã£ã¦ã„ã¾ã™ã€‚1ã¤ã§ã‚‚ã‚ã‚Œã°ã€è‰¯ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã«ã¤ã„ã¦è€ƒãˆã‚‹å¿…è¦ã‚‚ã‚ã‚Šã¾ã›ã‚“ã€‚æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã«ã‚ˆã£ã¦ç”˜ã‚„ã‹ã•ã‚Œã¦è‚²ã£ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ…‹åº¦ã‚’é€†è»¢ã•ã›ã¦ã€é€Ÿãã¦æ­£ç¢ºã§å®Œå…¨ã«ç†è§£ã§ãã‚‹è£½å“ã‚’ä½œã‚‹æ–¹æ³•ã¯ï¼Ÿå°‘æ•°ã®ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆã‚µãƒ¼ãƒ“ã‚¹...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>æœ¬å½“ã«ã‚¹ãƒãƒ¼ãƒˆãªæ¤œç´¢ã‚’è¡Œã†ï¼šã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/directum/blog/460263/"><p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¼æ¥­æƒ…å ±ã‚·ã‚¹ãƒ†ãƒ ã§æ¤œç´¢</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -ã™ã§ã«ã“ã®ãƒ•ãƒ¬ãƒ¼ã‚ºè‡ªä½“ã‹ã‚‰å£ã‹ã‚‰å‡ºã‚‰ã‚Œãªããªã£ã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">1ã¤ã§ã‚‚ã‚ã‚Œã°ã€è‰¯ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã«ã¤ã„ã¦è€ƒãˆã‚‹å¿…è¦ã‚‚ã‚ã‚Šã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã«ã‚ˆã£ã¦ç”˜ã‚„ã‹ã•ã‚Œã¦è‚²ã£ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ…‹åº¦ã‚’é€†è»¢ã•ã›ã¦ã€é€Ÿãã¦æ­£ç¢ºã§å®Œå…¨ã«ç†è§£ã§ãã‚‹è£½å“ã‚’ä½œã‚‹æ–¹æ³•ã¯ï¼Ÿ</font><font style="vertical-align: inherit;">å°‘æ•°ã®ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆã‚µãƒ¼ãƒ“ã‚¹ã§ã‚ã‚‹Elasticsearchã®å„ªã‚ŒãŸéƒ¨åˆ†ã‚’å–å¾—ã—ã€ã“ã®ã‚¬ã‚¤ãƒ‰ã§ç·´ã‚Šä¸Šã’ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Elasticsearchã«åŸºã¥ãå…¨æ–‡æ¤œç´¢ã‚’æ—¢å­˜ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«å›ºå®šã™ã‚‹æ–¹æ³•ã«é–¢ã™ã‚‹è¨˜äº‹ã¯ãŸãã•ã‚“ã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã—ã‹ã—ã€æœ¬å½“ã«ã‚¹ãƒãƒ¼ãƒˆãªæ¤œç´¢ã‚’è¡Œã†æ–¹æ³•ã«ã¤ã„ã¦ã®è¨˜äº‹ã¯æ˜ã‚‰ã‹ã«ååˆ†ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font></font></p><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŒæ™‚ã«ã€ã€Œã‚¹ãƒãƒ¼ãƒˆæ¤œç´¢ã€ã¨ã„ã†ãƒ•ãƒ¬ãƒ¼ã‚ºè‡ªä½“ã¯ã™ã§ã«æµè¡Œèªã«ãªã£ã¦ãŠã‚Šã€ãã®å ´æ‰€ã§ã¯ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ãŒã€ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">ãã‚Œã§ã¯ã€æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ãŒã‚¹ãƒãƒ¼ãƒˆã¨è¦‹ãªã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹ã«ã¯ã©ã†ã™ã‚Œã°ã‚ˆã„ã§ã—ã‚‡ã†ã‹ã€‚</font><font style="vertical-align: inherit;">çµå±€ã€ã“ã‚Œã¯ã€ã“ã®çµæœãŒè¦æ±‚ã®ãƒ†ã‚­ã‚¹ãƒˆã«å®Œå…¨ã«å¯¾å¿œã—ã¦ã„ãªãã¦ã‚‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå®Ÿéš›ã«å¿…è¦ã¨ã™ã‚‹çµæœã‚’æä¾›ã™ã‚‹ã‚‚ã®ã¨ã—ã¦èª¬æ˜ã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">Googleã‚„Yandexãªã©ã®äººæ°—ã®ã‚ã‚‹æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã¯ã•ã‚‰ã«é€²ã‚“ã§ã€å¿…è¦ãªæƒ…å ±ã‚’è¦‹ã¤ã‘ã‚‹ã ã‘ã§ãªãã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è³ªå•ã«ç›´æ¥å›ç­”ã—ã¾ã™ã€‚</font></font></blockquote><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚ã‹ã‚Šã¾ã—ãŸã€æœ€å¾Œã®æ±ºå®šã‚’ã™ãã«ä¸€æƒã™ã‚‹ã“ã¨ã¯ã—ã¾ã›ã‚“ãŒã€</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šå¸¸</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã®å…¨æ–‡æ¤œç´¢ã‚’ã‚ˆã‚Š</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¹ãƒãƒ¼ãƒˆãª</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¤œç´¢ã«è¿‘ã¥ã‘ã‚‹ãŸã‚ã«</font><font style="vertical-align: inherit;">ä½•ãŒã§ãã‚‹</font><font style="vertical-align: inherit;">ã§ã—ã‚‡ã†ã‹ï¼Ÿ</font></font></p><a name="habracut"></a><br>
<h2 id="elementy-intellektualnosti"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çŸ¥æ€§ã®è¦ç´ </font></font></h2><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¹ãƒãƒ¼ãƒˆæ¤œç´¢-ã“ã‚Œã¯ã€é‡ãŒå“è³ªã«å…¥ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã€å¤šãã®å°ã•ãã¦ã‹ãªã‚Šå˜ç´”ãªæ©Ÿèƒ½ãŒé­”æ³•ã®æ„Ÿè¦šã‚’å½¢æˆã§ãã‚‹å ´åˆã«ã¡ã‚‡ã†ã©å½“ã¦ã¯ã¾ã‚Šã¾ã™ã€‚</font></font></p><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ©ãƒ¼ã®ä¿®æ­£-ã‚¿ã‚¤ãƒ—ãƒŸã‚¹ã€ä¸é©åˆ‡ãªãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€ã¾ãŸã¯çµæœãŒç–‘ã‚ã—ã„ã»ã©å°‘ãªã„æ•°ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã‚ã‚‹ãŒã€ã¯ã‚‹ã‹ã«å¤šãã®æƒ…å ±ãŒã‚ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ä¼¼ã¦ã„ã‚‹ã‹ã©ã†ã‹ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¾Œã‚ã«</font></font><del><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç•ªç›®</font></font></del> NLP (natural language processing,   ,   ) â€”    <em><strong>    </strong></em>,                         ?</li>
<li>        .</li>
<li>  â€”    ,      ,  .         , , ,            ?</li>
<li> drilldown â€”        , .</li>
</ul><br>
<h2 id="vvodnaya"></h2><br>
<p> ECM DIRECTUM     .        ,     .</p><br>
<p> â€”               .</p><br>
<h2 id="indeksirovanie"></h2><br>
<blockquote> -  ,   -   .</blockquote><p>  ECM  ,   ,   ,    ;        .<br>
     Elasticsearch    .  ,  ECM      ,           .</p><br>
<h3 id="otobrazhenie-dokumentov-ecm-na-dokumenty-elasticsearch">  ECM   Elasticsearch</h3><br>
<p>   ECM    .  Elasticsearch        nested-,        â€”   ,        ,           (    â€”   ).       ECM    Elasticsearch   ,   .</p><br>
<p>      Elasticsearch    ,     :</p><br>
<ul>
<li>    ,    , â€”     ;</li>
<li>    â€”   ;</li>
<li>  .</li>
</ul><br>
<h3 id="sostav-indeksov"> </h3><br>
<p>,    .           Elasticsearch          -  ,  .     /       .        ,         .</p><br>
<p> â€”        ,      Elasticsearch  2 :</p><br>
<ul>
<li> .       ,   â€”  (    ),   â€”     (   ).             ,      .            .</li>
</ul><br>
<blockquote> â€”   .           .   ,       .<br>
 â€”  ,      ()  .</blockquote><br>
<ul>
<li>  .      ES       ( ,   )       ( ,   ). ,       ,      ,    ,         ,   .</li>
</ul><br>
<p>     ,       , (-     ) â€”      Â«Â» .</p><br>
<p>              .</p><br>
<p>  ,   ,               : - (  -), -, -, -  .. </p><br>
<p>      ,    â€” Elasticsearch   ,     ,     .       ,        ,      ,            .</p><br>
<h3 id="struktura-indeksov"> </h3><br>
<p>      ( multi-fields): default       custom   :</p><br>
<pre><code class="json hljs"><span class="hljs-string">"ru_en_analyzer"</span>: {
    <span class="hljs-attr">"filter"</span>: [
        <span class="hljs-string">"lowercase"</span>,
        <span class="hljs-string">"russian_morphology"</span>,
        <span class="hljs-string">"english_morphology"</span>,
        <span class="hljs-string">"word_delimiter"</span>,
        <span class="hljs-string">"ru_en_stopwords"</span><font></font>
    ],<font></font>
    <span class="hljs-attr">"char_filter"</span>: [
        <span class="hljs-string">"yo_filter"</span><font></font>
    ],<font></font>
    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"custom"</span>,
    <span class="hljs-attr">"tokenizer"</span>: <span class="hljs-string">"standard"</span>}</code></pre><br>
<p>  lowercase  ,   . </p><br>
<p> russian_morphology  english_morphology         .      Elasticsearch       analysis-morphology.  ,           , ,      .</p><br>
<pre><code class="json hljs">POST _analyze<font></font>
{<font></font>
    <span class="hljs-attr">"analyzer"</span>: <span class="hljs-string">"russian"</span>, 
    <span class="hljs-attr">"text"</span>: <span class="hljs-string">"   "</span><font></font>
}<font></font>
&gt;&gt;   </code></pre><br>
<p>:</p><br>
<pre><code class="json hljs">POST _analyze<font></font>
{<font></font>
    <span class="hljs-attr">"analyzer"</span>: <span class="hljs-string">"ru_en_analyzer"</span>, 
    <span class="hljs-attr">"text"</span>: <span class="hljs-string">"   "</span><font></font>
}<font></font>
&gt;&gt;   </code></pre><br>
<p>   word_delimiter. , ,   ,     .   :</p><br>
<pre><code class="json hljs"><span class="hljs-string">"word_delimiter"</span>: {
    <span class="hljs-attr">"catenate_all"</span>: <span class="hljs-string">"true"</span>,
    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"word_delimiter"</span>,
    <span class="hljs-attr">"preserve_original"</span>: <span class="hljs-string">"true"</span>
}</code></pre><br>
<p>yo_filter     E  :</p><br>
<pre><code class="json hljs"><span class="hljs-string">"yo_filter"</span>: {
    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"mapping"</span>,
    <span class="hljs-attr">"mappings"</span>: [
        <span class="hljs-string">" =&gt; "</span>,
        <span class="hljs-string">" =&gt; "</span><font></font>
    ]<font></font>
}</code></pre><br>
<p>ru_en_stopwords    stop â€”   -.</p><br>
<h3 id="process-indeksirovaniya"> </h3><br>
<p>   ECM â€” ,  ,   : .docx, .pdf  ..      ingest-attachment   pipeline:</p><br>
<pre><code class="json hljs">{
    <span class="hljs-attr">"document_version"</span>: {
        <span class="hljs-attr">"processors"</span>: [<font></font>
            {<font></font>
                <span class="hljs-attr">"attachment"</span>: {
                    <span class="hljs-attr">"field"</span>: <span class="hljs-string">"content"</span>,
                    <span class="hljs-attr">"target_field"</span>: <span class="hljs-string">"attachment"</span>,
                    <span class="hljs-attr">"properties"</span>: [ <span class="hljs-string">"content"</span>, <span class="hljs-string">"content_length"</span>, <span class="hljs-string">"content_type"</span>, <span class="hljs-string">"language"</span> ],
                    <span class="hljs-attr">"indexed_chars"</span>: <span class="hljs-number">-1</span>,
                    <span class="hljs-attr">"ignore_failure"</span>: <span class="hljs-literal">true</span><font></font>
                }<font></font>
            },<font></font>
            {<font></font>
                <span class="hljs-attr">"remove"</span>: {
                    <span class="hljs-attr">"field"</span>: <span class="hljs-string">"content"</span>,
                    <span class="hljs-attr">"ignore_failure"</span>: <span class="hljs-literal">true</span><font></font>
                }<font></font>
            },<font></font>
            {<font></font>
                <span class="hljs-attr">"script"</span>: {
                    <span class="hljs-attr">"lang"</span>: <span class="hljs-string">"painless"</span>,
                    <span class="hljs-attr">"params"</span>: {
                        <span class="hljs-attr">"languages"</span>: [<span class="hljs-string">"ru"</span>, <span class="hljs-string">"en"</span> ],
                        <span class="hljs-attr">"language_delimeter"</span>: <span class="hljs-string">"_"</span><font></font>
                    },<font></font>
                    <span class="hljs-attr">"source"</span>: <span class="hljs-string">"..."</span><font></font>
                }<font></font>
            },<font></font>
            {<font></font>
                <span class="hljs-attr">"remove"</span>: {
                    <span class="hljs-attr">"field"</span>: <span class="hljs-string">"attachment"</span>,
                    <span class="hljs-attr">"ignore_failure"</span>: <span class="hljs-literal">true</span><font></font>
                }<font></font>
            }<font></font>
        ]<font></font>
    }<font></font>
}</code></pre><br>
<p>   pipeline â€”     (    )    ,    .    painless-,     , .. -  JSON      .     (  â€”     )      painful.</p><br>
<pre><code class="cs hljs"><span class="hljs-keyword">if</span> (ctx.attachment != <span class="hljs-literal">null</span>)<font></font>
{<font></font>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">params</span>.languages.contains(ctx.attachment.language))<font></font>
        ctx._index = ctx._index + <span class="hljs-keyword">params</span>.language_delimeter + ctx.attachment.language;
    <span class="hljs-keyword">if</span> (ctx.attachment.content != <span class="hljs-literal">null</span>)<font></font>
        ctx.content = ctx.attachment.content;<font></font>
    <span class="hljs-keyword">if</span> (ctx.attachment.content_length != <span class="hljs-literal">null</span>)<font></font>
        ctx.content_length = ctx.attachment.content_length;<font></font>
    <span class="hljs-keyword">if</span> (ctx.attachment.content_type != <span class="hljs-literal">null</span>)<font></font>
        ctx.content_type = ctx.attachment.content_type;<font></font>
    <span class="hljs-keyword">if</span> (ctx.attachment.language != <span class="hljs-literal">null</span>)<font></font>
        ctx.language = ctx.attachment.language; <font></font>
}</code></pre><br>
<p> ,      <em>index_name</em>.       ,       ,    <em>index_name_language</em>.</p><br>
<p>      ,   _source , ..         .</p><br>
<p>       ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Update By Query API</a>  pipeline.  , -,        ECM,  -,      Elasticsearch â€”        ,   .</p><br>
<blockquote>     Elasticsearch  ,        ,     .</blockquote><p>    ,         .    <em></em>      .</p><br>
<h2 id="poisk"></h2><br>
<p>      </p><br>
<p><img src="https://habrastorage.org/webt/ni/l4/xm/nil4xm-qrg7meikrjbd16mt_ziq.png"></p><br>
<h3 id="polnotekst"></h3><br>
<p>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Simple Query String Query</a>:</p><br>
<pre><code class="json hljs"><span class="hljs-string">"simple_query_string"</span>: {
    <span class="hljs-attr">"fields"</span>: [
        <span class="hljs-string">"card.d*.*_text"</span>,
        <span class="hljs-string">"card.d*.*_text.exact"</span>,
        <span class="hljs-string">"card.name^2"</span>,
        <span class="hljs-string">"card.name.exact^2"</span>,
        <span class="hljs-string">"content"</span>,
        <span class="hljs-string">"content.exact"</span><font></font>
    ],<font></font>
    <span class="hljs-attr">"query"</span>: <span class="hljs-string">" "</span>,
    <span class="hljs-attr">"default_operator"</span>: <span class="hljs-string">"or"</span>,
    <span class="hljs-attr">"analyze_wildcard"</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">"minimum_should_match"</span>: <span class="hljs-string">"-35%"</span>,
    <span class="hljs-attr">"quote_field_suffix"</span>: <span class="hljs-string">".exact"</span>
}</code></pre><br>
<p> <em>.exact</em> â€”  ,  <em>default</em> .          .  <code>"default_operator": "or"</code>  <code>"minimum_should_match": "-35%"</code>        35%  .</p><br>
<h3 id="sinonimy"></h3><br>
<p>       ,      â€”         :</p><br>
<pre><code class="json hljs"><span class="hljs-string">"search_analyzer"</span>: {
    <span class="hljs-attr">"filter"</span>: [
        <span class="hljs-string">"lowercase"</span>,
        <span class="hljs-string">"russian_morphology"</span>,
        <span class="hljs-string">"english_morphology"</span>,
        <span class="hljs-string">"synonym_filter"</span>,
        <span class="hljs-string">"word_delimiter"</span>,
        <span class="hljs-string">"ru_en_stopwords"</span><font></font>
    ],<font></font>
    <span class="hljs-attr">"char_filter"</span>: [
        <span class="hljs-string">"yo_filter"</span><font></font>
    ],<font></font>
    <span class="hljs-attr">"tokenizer"</span>: <span class="hljs-string">"standard"</span>
}</code></pre><br>
<pre><code class="json hljs"><span class="hljs-string">"synonym_filter"</span>: {
    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"synonym_graph"</span>,
    <span class="hljs-attr">"synonyms_path"</span>: <span class="hljs-string">"synonyms.txt"</span>
}</code></pre><br>
<h3 id="uchyot-prav"> </h3><br>
<p>         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Bool Query</a>,   :</p><br>
<pre><code class="json hljs"><span class="hljs-string">"bool"</span>: {
    <span class="hljs-attr">"must"</span>: [<font></font>
        {<font></font>
            <span class="hljs-attr">"simple_query_string"</span>: {...}<font></font>
        }<font></font>
    ],<font></font>
    <span class="hljs-attr">"filter"</span>: [<font></font>
        {<font></font>
            <span class="hljs-attr">"terms"</span>: {
                <span class="hljs-attr">"rights"</span>: [           ]<font></font>
            }<font></font>
        }<font></font>
    ]<font></font>
}</code></pre><br>
<p>     ,         ,    .         â€”    .</p><br>
<h3 id="tyuning-relevantnosti"> </h3><br>
<p>  Elasticsearch      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">BM25</a>,     .  ,             :</p><br>
<ul>
<li>    â€”      ,   ,     ;</li>
<li>    â€”  ,  ,    ;</li>
<li><p>    ECM    : ,   . ,    .</p><br>
<p>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Function Score Query</a>:</p><br>
<pre><code class="json hljs"><span class="hljs-string">"function_score"</span>: {
<span class="hljs-attr">"functions"</span>: [<font></font>
    {<font></font>
        <span class="hljs-attr">"gauss"</span>: {
            <span class="hljs-attr">"modified_date"</span>: {
            <span class="hljs-attr">"origin"</span>: <span class="hljs-string">"now"</span>,
            <span class="hljs-attr">"scale"</span>: <span class="hljs-string">"1095d"</span>,
            <span class="hljs-attr">"offset"</span>: <span class="hljs-string">"31d"</span>,
            <span class="hljs-attr">"decay"</span>: <span class="hljs-number">0.5</span><font></font>
            }<font></font>
        }<font></font>
    },<font></font>
    {<font></font>
        <span class="hljs-attr">"field_value_factor"</span>: {
            <span class="hljs-attr">"field"</span>: <span class="hljs-string">"access_count"</span>,
            <span class="hljs-attr">"missing"</span>: <span class="hljs-number">1</span>,
            <span class="hljs-attr">"modifier"</span>: <span class="hljs-string">"log2p"</span><font></font>
        }<font></font>
    },<font></font>
    {<font></font>
        <span class="hljs-attr">"filter"</span>: {
            <span class="hljs-attr">"term"</span>: {
                <span class="hljs-attr">"life_stage_value_id"</span>: {
                    <span class="hljs-attr">"value"</span>: <span class="hljs-string">""</span><font></font>
                }<font></font>
            }<font></font>
        },<font></font>
        <span class="hljs-attr">"weight"</span>: <span class="hljs-number">1.1</span><font></font>
    }<font></font>
],<font></font>
<span class="hljs-attr">"query"</span>: {
    <span class="hljs-attr">"bool"</span>: {...}<font></font>
}<font></font>
}</code></pre><br>
<p> ,   ,             X    Y:</p><br>
</li>
</ul><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a></p><div style="text-align:center;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/wa/wz/td/wawztd9zvlz-fetkplnfrjw8ddy.png"></a></div><p></p><br>
<h3 id="vneshniy-intellekt"> </h3><br>
<p>            <em></em>:      (, ,   ..),  ,     ..</p><br>
<p>      , ,   ,  ,   ..</p><br>
<p>      ECM â€” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">DIRECTUM Ario</a>.</p><br>
<h3 id="process-umnogo-poiska">  </h3><br>
<p>   ,     .</p><br>
<h4 id="ispravlenie-oshibok-polzovatelya">  </h4><br>
<p>         â€”   ,             .      , , -,     :</p><br>
<p><img src="https://habrastorage.org/webt/ek/ow/c5/ekowc5ikjiwx1xe87b5wewhoohm.png"></p><br>
<p> -,       :</p><br>
<p><img src="https://habrastorage.org/webt/ug/dr/tc/ugdrtchejvx024datttkc_zcxxw.png"></p><br>
<p>        ,      . </p><br>
<p>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Phrase Suggester</a>.     â€”       ,  suggest    ,            .  <em></em>  confidence = 0,   suggest       . ,     "<strong></strong>"    : <em>,   <strong></strong>?</em></p><br>
<p>  ,    suggester'  :</p><br>
<pre><code class="json hljs"><span class="hljs-string">"suggest"</span>: {
    <span class="hljs-attr">"content_suggest"</span>: {
        <span class="hljs-attr">"text"</span>: <span class="hljs-string">" "</span>,
        <span class="hljs-attr">"phrase"</span>: {
            <span class="hljs-attr">"collate"</span>: {
                <span class="hljs-attr">"query"</span>: {         {{suggestion}} }<font></font>
            },<font></font>
        }<font></font>
    },<font></font>
    <span class="hljs-string">"check_suggest"</span>: {
        <span class="hljs-attr">"text"</span>: <span class="hljs-string">""</span>,
        <span class="hljs-attr">"phrase"</span>: {
            <span class="hljs-attr">"collate"</span>: {
                <span class="hljs-attr">"query"</span>: {         {{suggestion}} - ({{source_query}}) },
                <span class="hljs-string">"params"</span>: {
                    <span class="hljs-attr">"source_query"</span>: <span class="hljs-string">" "</span><font></font>
                }<font></font>
            },<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br>
<p>   </p><br>
<pre><code class="json hljs"><span class="hljs-string">"confidence"</span>: <span class="hljs-number">0.0</span>,
<span class="hljs-string">"max_errors"</span>: <span class="hljs-number">3.0</span>,
<span class="hljs-string">"size"</span>: <span class="hljs-number">1</span></code></pre><br>
<p>  suggester  ,   ,    â€”   ,      ,     .  ,   - ,      .          ,    ( Hunspell)  . </p><br>
<p>      0 ,          :</p><br>
<p><img src="https://habrastorage.org/webt/up/r3/wx/upr3wxky4mkbeyy3exjocbwzocy.png"></p><br>
<p>           :</p><br>
<p><img src="https://habrastorage.org/webt/qv/ts/4t/qvts4tauspo9yspwy_itbzcdttq.png"></p><br>
<h4 id="klassifikaciya-zaprosov-i-izvlechenie-faktov">    </h4><br>
<p>   ,   DIRECTUM Ario,         .           ,   .       ,     ,             .       ,     . ,  <em><strong>  </strong></em>   <strong></strong>    ,    <strong> </strong> â€”  .   <em><strong>   </strong></em>        .</p><br>
<p>   â€”  ,    ,       .</p><br>
<h4 id="avtodopolnenie-vvoda"> </h4><br>
<p>    ,          .</p><br>
<p><img src="https://habrastorage.org/webt/zc/52/yo/zc52yohihrkkrnny6ekla80-mro.png"></p><br>
<p>      Suggester' â€” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Completion Suggester</a>,      .</p><br>
<h5 id="avtodopolnenie-istoriya-poiskov">:  </h5><br>
<p>  ECM  ,    ,         <del>  </del>   .       -  .  Completion Suggester         ,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Context Suggester</a> â€”              .       ,       .</p><br>
<p>      ,    .            .        ,  , :</p><br>
<pre><code class="json hljs"><span class="hljs-string">"mappings"</span>: {
    <span class="hljs-attr">"document"</span>: {
        <span class="hljs-attr">"properties"</span>: {
            <span class="hljs-attr">"input"</span>: {
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"keyword"</span><font></font>
            },<font></font>
            <span class="hljs-attr">"suggest"</span>: {
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"completion"</span>,
                <span class="hljs-attr">"analyzer"</span>: <span class="hljs-string">"simple"</span>,
                <span class="hljs-attr">"preserve_separators"</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">"preserve_position_increments"</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">"max_input_length"</span>: <span class="hljs-number">50</span>,
                <span class="hljs-attr">"contexts"</span>: [<font></font>
                    {<font></font>
                        <span class="hljs-attr">"name"</span>: <span class="hljs-string">"user"</span>,
                        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"CATEGORY"</span><font></font>
                    }<font></font>
                ]<font></font>
            },<font></font>
            <span class="hljs-attr">"user"</span>: {
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"keyword"</span><font></font>
            }<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br>
<p>                <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Update By Query API</a>     <code>ctx._source.suggest.weight++</code>.</p><br>
<h5 id="avtodopolnenie-dokumenty">: </h5><br>
<p>           .   , ,        ,     .          .  ,     ,     :</p><br>
<p> â€” Completion Suggester    ,        ,  - <code>.01.01   </code>     <em><strong> </strong></em>  .            n-:</p><br>
<pre><code class="json hljs">{
    <span class="hljs-attr">"extension"</span>: <span class="hljs-string">"pdf"</span>,
    <span class="hljs-attr">"name"</span>: <span class="hljs-string">".01.01   "</span>,
    <span class="hljs-attr">"suggest"</span>: [<font></font>
        {<font></font>
            <span class="hljs-attr">"input"</span>: <span class="hljs-string">""</span>,
            <span class="hljs-attr">"weight"</span>: <span class="hljs-number">70</span><font></font>
        },<font></font>
        {<font></font>
            <span class="hljs-attr">"input"</span>: <span class="hljs-string">" "</span>,
            <span class="hljs-attr">"weight"</span>: <span class="hljs-number">80</span><font></font>
        },<font></font>
        {<font></font>
            <span class="hljs-attr">"input"</span>: <span class="hljs-string">"  "</span>,
            <span class="hljs-attr">"weight"</span>: <span class="hljs-number">90</span><font></font>
        },<font></font>
        {<font></font>
            <span class="hljs-attr">"input"</span>: <span class="hljs-string">".01.01   "</span>,
            <span class="hljs-attr">"weight"</span>: <span class="hljs-number">100</span><font></font>
        }<font></font>
    ]<font></font>
}</code></pre><br>
<p>      ,              ,   - . <em></em>.</p><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bi/rc/dv/bircdvzu2hvcblxhrryvauzajf0.png"></div><br>
<p> â€”     ,            ,        .       gauss  field_value_factor,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Function Score Query</a>.</p><br>
<p>   pipeline:</p><br>
<pre><code class="json hljs">{
  <span class="hljs-attr">"dir_public_documents_pipeline"</span>: {
    <span class="hljs-attr">"processors"</span>: [<font></font>
      ...<font></font>
      {<font></font>
        <span class="hljs-attr">"set"</span>: {
            <span class="hljs-attr">"field"</span>: <span class="hljs-string">"terms_array"</span>,
            <span class="hljs-attr">"value"</span>: <span class="hljs-string">"{{name}}"</span><font></font>
        }<font></font>
      },<font></font>
      {<font></font>
        <span class="hljs-attr">"split"</span>: {
            <span class="hljs-attr">"field"</span>: <span class="hljs-string">"terms_array"</span>,
            <span class="hljs-attr">"separator"</span>: <span class="hljs-string">"\\s+|$"</span><font></font>
        }<font></font>
      },<font></font>
      {<font></font>
        <span class="hljs-attr">"script"</span>: {
            <span class="hljs-attr">"source"</span>: <span class="hljs-string">"..."</span><font></font>
        }<font></font>
      }<font></font>
    ]<font></font>
  }<font></font>
} </code></pre><br>
<p>  :</p><br>
<pre><code class="cs hljs">Date modified = <span class="hljs-keyword">new</span> Date(<span class="hljs-number">0</span>);
<span class="hljs-keyword">if</span> (ctx.modified_date != <span class="hljs-literal">null</span>)<font></font>
  modified = <span class="hljs-keyword">new</span> SimpleDateFormat(<span class="hljs-string">'dd.MM.yyyy'</span>).parse(ctx.modified_date);
<span class="hljs-keyword">long</span> dayCount = (System.currentTimeMillis() - modified.getTime())/(<span class="hljs-number">1000</span>*<span class="hljs-number">60</span>*<span class="hljs-number">60</span>*<span class="hljs-number">24</span>);
<span class="hljs-keyword">double</span> score = Math.exp((<span class="hljs-number">-0.7</span>*Math.max(<span class="hljs-number">0</span>, dayCount - <span class="hljs-number">31</span>))/<span class="hljs-number">1095</span>) * Math.log10(ctx.access_count + <span class="hljs-number">2</span>);
<span class="hljs-keyword">int</span> count = ctx.terms_array.length;<font></font>
ctx.suggest = <span class="hljs-keyword">new</span> ArrayList();<font></font>
ctx.suggest.<span class="hljs-keyword">add</span>([
    <span class="hljs-string">'input'</span>: ctx.terms_array[count - <span class="hljs-number">1</span>], 
    <span class="hljs-string">'weight'</span>: Math.round(score * (<span class="hljs-number">255</span> - count + <span class="hljs-number">1</span>))<font></font>
    ]);<font></font>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = count - <span class="hljs-number">2</span>; i &gt;= <span class="hljs-number">0</span> ; --i)<font></font>
{<font></font>
  <span class="hljs-keyword">if</span> (ctx.terms_array[i].trim() != <span class="hljs-string">""</span>)<font></font>
  {<font></font>
    ctx.suggest.<span class="hljs-keyword">add</span>([
      <span class="hljs-string">"input"</span>: ctx.terms_array[i] + <span class="hljs-string">" "</span> + ctx.suggest[ctx.suggest.length - <span class="hljs-number">1</span>].input,
      <span class="hljs-string">"weight"</span>: Math.round(score * (<span class="hljs-number">255</span> - i))]);<font></font>
  }<font></font>
}<font></font>
ctx.<span class="hljs-keyword">remove</span>(<span class="hljs-string">'terms_array'</span>);<font></font>
ctx.<span class="hljs-keyword">remove</span>(<span class="hljs-string">'access_count'</span>);<font></font>
ctx.<span class="hljs-keyword">remove</span>(<span class="hljs-string">'modified_date'</span>);</code></pre><br>
<p>   pipeline  painless  ,       ?      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Reindex API</a>          (   , )    .</p><br>
<p>       ,        .</p><br>
<h3 id="otobrazhenie-rezultatov"> </h3><br>
<h4 id="kategorii"></h4><br>
<p> ,         .     <em> </em>      .</p><br>
<h4 id="fasety"></h4><br>
<p> â€”      ,  ,   ,    .    :</p><br>
<ol>
<li><p>     ,        .   ?</p><br>
</li>
<li><p>           ,       :</p><br>
</li>
</ol><br>
<p><img src="https://habrastorage.org/webt/60/ei/g6/60eig601ltskcwvcesh5zno8crc.png"></p><br>
<ol>
<li>      ,       <em></em>   0       :</li>
</ol><br>
<p><img src="https://habrastorage.org/webt/mu/6u/e-/mu6ue-ybxh3sa9h6ymkj1idn_ti.png"></p><br>
<p>      ,                 .</p><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zd/jt/zu/zdjtzudyw9iei8x-tjarja-a5tm.jpeg"></div><br>
<p>  ,   :</p><br>
<div class="spoiler"><b class="spoiler_title">   </b><div class="spoiler_text"><pre><code class="json hljs">{<font></font>
    ...<font></font>
    <span class="hljs-attr">"post_filter"</span>: {
        <span class="hljs-attr">"bool"</span>: {
            <span class="hljs-attr">"must"</span>: [<font></font>
                {<font></font>
                    <span class="hljs-attr">"terms"</span>: {
                        <span class="hljs-attr">"card.author_value_id"</span>: [
                            <span class="hljs-string">"1951063"</span><font></font>
                        ]<font></font>
                    }<font></font>
                },<font></font>
                {<font></font>
                    <span class="hljs-attr">"terms"</span>: {
                        <span class="hljs-attr">"editor_value_id"</span>: [
                            <span class="hljs-string">"2337706"</span>,
                            <span class="hljs-string">"300643"</span><font></font>
                        ]<font></font>
                    }<font></font>
                }<font></font>
            ]<font></font>
        }<font></font>
    },<font></font>
    <span class="hljs-attr">"query"</span>: {...}
    <span class="hljs-string">"aggs"</span>: {
        <span class="hljs-attr">"card.author_value_id"</span>: {
            <span class="hljs-attr">"filter"</span>: {
                <span class="hljs-attr">"terms"</span>: {
                    <span class="hljs-attr">"editor_value_id"</span>: [
                        <span class="hljs-string">"2337706"</span>,
                        <span class="hljs-string">"300643"</span><font></font>
                    ]<font></font>
                }<font></font>
            },<font></font>
            <span class="hljs-attr">"aggs"</span>: {
                <span class="hljs-attr">"card.author_value_id"</span>: {
                    <span class="hljs-attr">"terms"</span>: {
                        <span class="hljs-attr">"field"</span>: <span class="hljs-string">"card.author_value_id"</span>,
                        <span class="hljs-attr">"size"</span>: <span class="hljs-number">11</span>,
                        <span class="hljs-attr">"exclude"</span>: [
                            <span class="hljs-string">"1951063"</span><font></font>
                        ],<font></font>
                        <span class="hljs-attr">"missing"</span>: <span class="hljs-string">""</span><font></font>
                    }<font></font>
                },<font></font>
                <span class="hljs-attr">"card.author_value_id_selected"</span>: {
                    <span class="hljs-attr">"terms"</span>: {
                        <span class="hljs-attr">"field"</span>: <span class="hljs-string">"card.author_value_id"</span>,
                        <span class="hljs-attr">"size"</span>: <span class="hljs-number">1</span>,
                        <span class="hljs-attr">"include"</span>: [
                        <span class="hljs-string">"1951063"</span><font></font>
                        ],<font></font>
                        <span class="hljs-attr">"missing"</span>: <span class="hljs-string">""</span><font></font>
                    }<font></font>
                }<font></font>
            }<font></font>
        },<font></font>
...<font></font>
        <span class="hljs-attr">"editor_value_id"</span>: {
            <span class="hljs-attr">"filter"</span>: {
                <span class="hljs-attr">"terms"</span>: {
                    <span class="hljs-attr">"card.author_value_id"</span>: [
                        <span class="hljs-string">"1951063"</span><font></font>
                    ]<font></font>
                }<font></font>
            },<font></font>
            <span class="hljs-attr">"aggs"</span>: {
                <span class="hljs-attr">"editor_value_id"</span>: {
                    <span class="hljs-attr">"terms"</span>: {
                        <span class="hljs-attr">"field"</span>: <span class="hljs-string">"editor_value_id"</span>,
                        <span class="hljs-attr">"size"</span>: <span class="hljs-number">11</span>,
                        <span class="hljs-attr">"exclude"</span>: [
                            <span class="hljs-string">"2337706"</span>,
                            <span class="hljs-string">"300643"</span><font></font>
                        ],<font></font>
                        <span class="hljs-attr">"missing"</span>: <span class="hljs-string">""</span><font></font>
                    }<font></font>
                },<font></font>
                <span class="hljs-attr">"editor_value_id_selected"</span>: {
                    <span class="hljs-attr">"terms"</span>: {
                        <span class="hljs-attr">"field"</span>: <span class="hljs-string">"editor_value_id"</span>,
                        <span class="hljs-attr">"size"</span>: <span class="hljs-number">2</span>,
                        <span class="hljs-attr">"include"</span>: [
                            <span class="hljs-string">"2337706"</span>,
                            <span class="hljs-string">"300643"</span><font></font>
                        ],<font></font>
                        <span class="hljs-attr">"missing"</span>: <span class="hljs-string">""</span><font></font>
                    }<font></font>
                }<font></font>
            }<font></font>
        },<font></font>
...<font></font>
  }<font></font>
}</code></pre></div></div><br>
<p>  :</p><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">post_filter</a>               .    .        .</li>
<li>  ,   â€” <em>card.author_value_id</em>  <em>editor_value_id</em>.   :<br>
<ul>
<li>     ,  ;</li>
<li>      â€” <em>  </em>;</li>
<li>     .  -10,   -11 â€”  ,     <strong> </strong>.</li>
</ul></li>
</ul><br>
<h4 id="snippety"></h4><br>
<p>        -, ,         </p><br>
<p><strong></strong>:</p><br>
<p><img src="https://habrastorage.org/webt/ka/_b/ia/ka_biaaygfgbsk2msyfhu-bnkse.png"></p><br>
<p> <strong></strong>:</p><br>
<p><img src="https://habrastorage.org/webt/5i/po/k_/5ipok_qgkc9170ucyidespnnitc.png"></p><br>
<p> ,           ?</p><br>
<p><img src="https://habrastorage.org/webt/-i/7z/g7/-i7zg7dwh7kbs9e9_2yk3fnxc6k.png"></p><br>
<p>        (  ),  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Source filtering</a>:</p><br>
<pre><code class="json hljs">{<font></font>
    ...<font></font>
    <span class="hljs-attr">"_source"</span>: {
        <span class="hljs-attr">"includes"</span>: [
            <span class="hljs-string">"id"</span>,
            <span class="hljs-string">"card.name"</span>,
            <span class="hljs-string">"card.card_type_value_id"</span>,
            <span class="hljs-string">"card.life_stage_value_id"</span>,
            <span class="hljs-string">"extension"</span>,<font></font>
            ...<font></font>
        ]<font></font>
    },<font></font>
    <span class="hljs-attr">"query"</span>: {...}<font></font>
    ...<font></font>
}</code></pre><br>
<p>        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Fast Vector highlighter</a> â€”        ,    â€” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Unified highlighter</a> â€”        :</p><br>
<pre><code class="json hljs"><span class="hljs-string">"highlight"</span>: {
    <span class="hljs-attr">"pre_tags"</span>: [
        <span class="hljs-string">"&lt;strong&gt;"</span><font></font>
    ],<font></font>
    <span class="hljs-attr">"post_tags"</span>: [
        <span class="hljs-string">"&lt;/strong&gt;"</span><font></font>
    ],<font></font>
    <span class="hljs-attr">"encoder"</span>: <span class="hljs-string">"html"</span>,
    <span class="hljs-attr">"fields"</span>: {
        <span class="hljs-attr">"card.name"</span>: {
            <span class="hljs-attr">"number_of_fragments"</span>: <span class="hljs-number">0</span><font></font>
        },<font></font>
        <span class="hljs-attr">"content"</span>: {
            <span class="hljs-attr">"fragment_size"</span>: <span class="hljs-number">300</span>,
            <span class="hljs-attr">"number_of_fragments"</span>: <span class="hljs-number">3</span>,
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"fvh"</span><font></font>
        }<font></font>
    }<font></font>
},</code></pre><br>
<p>    ,      3   300 . ,  Fast Vector highlighter',         .</p><br>
<h3 id="kollaps"></h3><br>
<p>   ECM ,     <em></em>,     Elasticsearch   <em> </em>.  ,             .         .  ,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Field Collapsing</a> â€”    ,       (    post_filter, <em>  â€” </em>).  <em></em>      .</p><br>
<pre><code class="json hljs">{<font></font>
  ...<font></font>
  <span class="hljs-attr">"query"</span>: {...}  <font></font>
  ...<font></font>
  <span class="hljs-string">"collapse"</span>: {
    <span class="hljs-attr">"field"</span>: <span class="hljs-string">"id"</span><font></font>
  }<font></font>
}</code></pre><br>
<p> ,     , ,        ,      .  ,  ,     â€”   <em></em> ,      ,    ,       .</p><br>
<p>.</p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja460253/index.html">éŸ³å£°ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã®ã‚¹ã‚­ãƒ«ã‚’é«˜ã‚ã‚‹10ã®ç†ç”±</a></li>
<li><a href="../ja460255/index.html">Node.jsã®ãƒãƒƒã‚¯ãƒ‰ã‚¢ï¼šç†ç”±ã€ç†ç”±ã€æ–¹æ³•</a></li>
<li><a href="../ja460257/index.html">"ã“ã‚“ã«ã¡ã¯ä¸–ç•Œ" ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«æ·±ãæµ¸ã‚‹</a></li>
<li><a href="../ja460259/index.html">UIãŠã‚ˆã³UXãƒ‡ã‚¶ã‚¤ãƒ³ã¨ã¯ä½•ã§ã™ã‹ï¼Ÿå…±é€šç‚¹ã¨ç›¸é•ç‚¹ã¯ä½•ã§ã™ã‹ï¼Ÿ</a></li>
<li><a href="../ja460261/index.html">ã‚¢ãƒã‚¾ãƒ³ï¼š25å¹´é–“ã®eã‚³ãƒãƒ¼ã‚¹ã®æˆåŠŸ</a></li>
<li><a href="../ja460265/index.html">Xcodeãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œæˆã™ã‚‹</a></li>
<li><a href="../ja460273/index.html">æœ€å°ã®Apple Payã§ã®æ‰¿èª</a></li>
<li><a href="../ja460275/index.html">å®Œç’§ãªã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ãŒå¿…è¦ãªã®ã¯ãªãœã§ã™ã‹</a></li>
<li><a href="../ja460279/index.html">100å„„å¥‘ç´„ï¼šå›½é˜²ç·çœã®ã‚¯ãƒ©ã‚¦ãƒ‰ã‚’èª°ãŒæ‰±ã†ã‹</a></li>
<li><a href="../ja460281/index.html">UXãƒ©ã‚¤ã‚¿ãƒ¼ãŒè£½å“ã®æ”¹å–„ã«ã©ã®ã‚ˆã†ã«å½¹ç«‹ã¤ã‹</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>