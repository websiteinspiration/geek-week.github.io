<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòÆ ‚ùé üêû En-t√™te HTTP et contr√¥le du navigateur Web üì¶ üóæ üë©‚ÄçüöÄ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il existe une technique totalement incomparable qui vous permet de contr√¥ler les performances d'un projet Web. Elle consiste √† introduire dans le proc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>En-t√™te HTTP et contr√¥le du navigateur Web</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/490624/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il existe une technique totalement incomparable qui vous permet de contr√¥ler les performances d'un projet Web. Elle consiste √† introduire dans le processus de d√©veloppement des m√©canismes dont les r√©sultats sont clairement visibles. Ces m√©canismes sont con√ßus pour toujours rappeler au programmeur l'importance des performances. Il y a quelque chose dans ce contexte que j'aime beaucoup. Il s'agit de l'en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> t√™te HTTP </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">Feature-Policy</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">
Ce titre est une fonctionnalit√© relativement nouvelle qui permet √† un d√©veloppeur d'activer et de d√©sactiver certaines fonctionnalit√©s du navigateur lors de la navigation sur son site. </font><font style="vertical-align: inherit;">
Par exemple, vous pouvez indiquer au navigateur qu'il ne doit pas autoriser l'utilisation de l'API de g√©olocalisation en lui passant l'en-t√™te suivant:</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/_a/mh/zz/_amhzzcwmae7goctptz7hobpnwa.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="plaintext hljs">Feature-Policy: geolocation 'none'</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'utilisation d'un en-t√™te </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pr√©sente de nombreux avantages en termes de s√©curit√© et de performances. </font><font style="vertical-align: inherit;">Mais j'aime maintenant particuli√®rement comment </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vous pouvez l'utiliser pour rendre plus visibles les probl√®mes de performances des sites Web qui sont g√©n√©ralement faciles √† ignorer. </font><font style="vertical-align: inherit;">Cela peut √™tre compar√© √† quelque chose comme "linting performance". </font><font style="vertical-align: inherit;">En particulier, nous parlons d'identifier les probl√®mes avec les images utilis√©es dans les projets Web.</font></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Politique d'images surdimensionn√©es</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si l'image est transmise au navigateur dans un format qu'il prend en charge, une telle image sera affich√©e. Il s'agit d'un comportement de navigateur standard. Le navigateur, essayant d'aider ceux qui consultent la page, redimensionne √©galement automatiquement ces images. Par cons√©quent, ils ont l'air bien m√™me s'ils sont repr√©sent√©s par d'√©normes fichiers graphiques. Par cons√©quent, si vous utilisez des images plus grandes que les tailles requises par la page, cela est, √† premi√®re vue, invisible. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Politique</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">directive</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font><code>oversized-images</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indique au navigateur qu'il ne doit pas autoriser l'utilisation d'images dont la taille d√©passe, d'un nombre de fois sp√©cifi√©, la taille de leurs conteneurs. </font><font style="vertical-align: inherit;">L'image, conform√©ment √† la restriction standard, ne peut pas d√©passer 2 fois le conteneur. </font><font style="vertical-align: inherit;">Mais cette valeur, si n√©cessaire, peut √™tre red√©finie. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, si le navigateur re√ßoit l'en-t√™te suivant, il ne vous permettra pas d'afficher des images prises √† partir de n'importe quelles sources (c'est r√©gl√© gr√¢ce </font></font><code>none</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), dont les dimensions sont plus de 2 fois la taille de leurs conteneurs (en largeur ou en hauteur).</font></font><br>
<br>
<pre><code class="plaintext hljs">Feature-Policy: oversized-images 'none';</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous avez besoin de plus de flexibilit√©, vous pouvez indiquer au navigateur qu'il ne doit pas afficher d'images qui sont plus de 3 fois plus grandes que les conteneurs:</font></font><br>
<br>
<pre><code class="plaintext hljs">Feature-Policy: oversized-images *(3) 'none';</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans tous les cas, si l'image ne correspond pas aux limites sp√©cifi√©es, un talon sera affich√© √† la place de l'image et un message d'erreur sera envoy√© √† la console.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c98/1e3/169/c981e3169d9219c226c13236f198c222.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si le site utilise la politique d'images surdimensionn√©es, de grandes images seront t√©l√©charg√©es, mais un talon s'affichera √† la place et un message d'erreur s'affichera dans la console.</font></font></font></i><br>
 <br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Images non optimis√©es</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre probl√®me courant avec les graphiques est l'utilisation d'images non optimis√©es. Tr√®s souvent, vous pouvez rencontrer des images qui n'ont pas √©t√© correctement compress√©es. Cependant, leur taille peut √™tre s√©lectionn√©e correctement. Ainsi, aux fichiers contenant des photos, lors de la prise de vue et de leur cr√©ation, de nombreuses m√©tadonn√©es inutiles peuvent √™tre ajout√©es, qui restent souvent dans les fichiers lorsqu'elles sont utilis√©es dans les navigateurs. Un exemple particuli√®rement ennuyeux de cela est les images, dont les m√©tadonn√©es contiennent leurs propres miniatures pour l'aper√ßu. Plusieurs fois, j'ai vu comment la vignette int√©gr√©e √† l'image (dont les concepteurs et d√©veloppeurs ne savaient m√™me pas la pr√©sence) ¬´pesait¬ª plus que l'image elle-m√™me!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entre autres choses, vous pouvez ici rappeler la compression d'image habituelle, prise en charge par de nombreux formats, qui vous permet d'atteindre l'√©quilibre parfait entre la qualit√© de l'image et la taille du fichier. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">politiques d'images non </font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">optimis√©es avec perte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et d' </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">images non </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">optimis√©es sans perte indiquent</font></a><font style="vertical-align: inherit;"> au navigateur qu'il correspond √† la taille du fichier et √† la taille de l'image en pixels.</font></font><br>
<br>
<pre><code class="plaintext hljs">Feature-Policy: unoptimized-lossy-images 'none';<font></font>
Feature-Policy: unoptimized-lossless-images 'none';</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si le nombre d'octets par pixel (octet par pixel, BPP) est trop √©lev√©, le navigateur affichera un talon √† la place de l'image et affichera un message d'erreur dans la console.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/347/215/e57/347215e574f0574312eff1d6737b8d9e.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'application de strat√©gies non optimis√©es * entra√Æne l'affichage d'un stub au lieu d'images inappropri√©es - tout comme l'utilisation de la strat√©gie d'images surdimensionn√©es, le</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
niveau BPP recommand√© pour les images compress√©es avec perte est de 0,5 et 1 pour les images compress√©es sans perte. De plus, lors de l'analyse des images, une l√©g√®re d√©viation de leur taille totale par rapport √† ces niveaux est autoris√©e. Or, cet √©cart pour les images compress√©es avec perte est de 1 Ko, pour les images compress√©es sans perte - 10 Ko.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, supposons que nous ayons une image JPEG de 200x200 pixels. JPEG est un format de compression d'image avec perte, ce qui donne un niveau BPP recommand√© de 0,5. Dans le m√™me temps, la taille totale de l'image peut d√©passer la taille recommand√©e de seulement 1 Ko. Pour savoir quelle taille une image similaire devrait convenir √† un navigateur, vous devez multiplier les dimensions des c√¥t√©s de l'image en pixels par l'autre et par BPP, puis ajouter l'√©cart autoris√© √† ce qui se passe. </font></font><br>
<br>
<code>(200 x 200 x .5) + 1024 = 21,024</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">octet, ou </font></font><code>20.5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ko </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si l'image est compress√©e sans perte, un √©cart par rapport √† la taille ¬´id√©ale¬ª de 10 Ko est autoris√©, tandis que le BPP d'une telle image sera de 1. Sinon, les calculs sont exactement les m√™mes: </font></font><br>
<br>
<code>(200 x 200 x 1) + 10,240 = 50,240</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">octet ou </font></font><code>49.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ko</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'ampleur de l'√©cart autoris√© est susceptible de changer √† l'avenir. </font><font style="vertical-align: inherit;">En fait, bien que Blink, par d√©faut, utilise cet indicateur pour des images compress√©es sans perte, √©gal √† 10 Ko, des exp√©riences sont d√©j√† en cours avec une politique </font></font><code>unoptimized-lossless-images-strict</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui modifie cet indicateur, le ramenant au niveau de 1 Ko.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√©dia non sp√©cifi√©</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le nouveau est l'ancien bien oubli√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pendant longtemps, l'utilisation des attributs d'image </font></font><code>height</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et a </font></font><code>width</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√©t√© plus ou moins courante. Sans ces attributs, le navigateur ne savait pas combien d'espace l'image devait occuper jusqu'au moment o√π l'image a √©t√© charg√©e. Cela a entra√Æn√© des changements dans les mises en page. La page a √©t√© affich√©e, puis, une fois l'image arriv√©e, son contenu a chang√©. Le navigateur a de nouveau d√ª recomposer la mise en page afin d'allouer de l'espace √† l'image. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque le moment est venu de disposer de mises en page dans lesquelles les tailles d'image devaient √™tre redimensionn√©es de mani√®re flexible √† l'aide de CSS, la pr√©sence ou l'absence de ces attributs ne jouait plus un r√¥le particulier. En cons√©quence, beaucoup ont simplement cess√© d'utiliser ces attributs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais gr√¢ce √† </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">des travaux r√©cents</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">initi√© par Jen Simmons, Firefox et Chrome peut calculer le rapport d'aspect des images en fonction de leurs attributs </font></font><code>height</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>width</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Lorsque cette approche est combin√©e avec les styles appliqu√©s aux images, il s'av√®re que les navigateurs peuvent r√©server de l'espace pour les images lors du passage initial de la mise en page. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">strat√©gie de m√©dia non dimensionn√©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indique au navigateur que tous les √©l√©ments multim√©dias doivent avoir des attributs qui sp√©cifient les tailles de ces √©l√©ments. S'il n'y a pas de tels attributs, le navigateur doit utiliser les valeurs par d√©faut. En fait, tout est un peu plus compliqu√©, mais l'essentiel est que si l'image n'a pas les attributs appropri√©s, le navigateur utilise la valeur de </font></font><code>300x150</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pixel </font><font style="vertical-align: inherit;">standard </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="plaintext hljs">Feature-Policy: unsized-media 'none';</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque cette strat√©gie est appliqu√©e, les images seront affich√©es, mais si leur taille n'est pas sp√©cifi√©e en HTML, le d√©veloppeur remarquera rapidement que les images sont affich√©es dans la taille par d√©faut. Et, comme d'habitude, un message d'erreur sera envoy√© √† la console.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a4b/b8a/4c5/a4bb8a4c52a7267ef162a8a8244c0f9a.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'application de la politique relative aux m√©dias non dimensionn√©s conduit au fait que les images et les vid√©os sans les attributs de hauteur et de largeur sont affich√©es, mais le navigateur d√©finit leur taille √† 300x150 pixels.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Probablement, il convient de mentionner une fonctionnalit√© qui m'a d'abord sembl√© inhabituelle. </font><font style="vertical-align: inherit;">Elle se montre lorsqu'elle partage des politiques</font></font><code>unsized-media</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et</font></font><code>oversized-images</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dans cette situation, il ne faut pas s'√©tonner de l'apparition de plus qu'avant, du nombre de messages sur des images trop grandes. </font><font style="vertical-align: inherit;">Le fait est qu'en raison de l'application de la politique, le</font></font><code>unsized-media</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">navigateur redimensionne les images qui n'ont pas d'attributs</font></font><code>height</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et</font></font><code>width</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jusqu'√†</font></font><code>300x150</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pixels. </font><font style="vertical-align: inherit;">Apr√®s quoi, c'est cette taille que le navigateur utilise comme point de r√©f√©rence pour d√©terminer si l'image correspond √† son conteneur.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attirer l'attention sur des probl√®mes moins visibles</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les politiques li√©es √† l'image, j'aime le fait qu'elles, dans le processus de d√©veloppement de projets, permettent de rendre visible ce qui est habituellement cach√©. En cons√©quence, le d√©veloppeur apprend qu'il n'a pas pris soin d'optimiser les images, ou qu'il a oubli√© de d√©finir leurs attributs </font></font><code>height</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>width</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Toutes ces erreurs se refl√®tent imm√©diatement dans l'apparence des pages. En fait, le principal avantage de l'utilisation des politiques ci-dessus est qu'elles permettent au d√©veloppeur de trouver rapidement des probl√®mes avec les images. Alors que la politique</font></font><code>unsized-media</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peut entra√Æner une diminution du nombre de situations dans lesquelles des ¬´changements¬ª de mise en page se produisent, l'utilisation d'autres politiques n'emp√™che pas le chargement d'images inappropri√©es. Par cons√©quent, le seul point fort de l'application de ces politiques est qu'elles attirent l'attention des d√©veloppeurs sur les probl√®mes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe plusieurs autres politiques qui peuvent √™tre utiles en termes d'analyse des pages pour l'impact de quelque chose sur leurs performances. C'est l√† que les politiques comme </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sync-script</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> viennent √† l'esprit </font><font style="vertical-align: inherit;">(cette politique bloque l'ex√©cution des scripts synchrones), </font></font><code>sync-xhr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(bloque les requ√™tes AJAX synchrones) et </font></font><code>document-write</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(bloque les appels </font></font><code>document.write</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ces politiques sont d'excellents outils pour contr√¥ler certains aspects des performances des pages, mais elles ne fournissent pas aux d√©veloppeurs les m√™mes commentaires notables que la plupart des politiques ci-dessus fournissent sous la forme d'images manquantes. Bien s√ªr, si la page a un script synchrone, sans lequel il n'est pas affich√©, ce n'est pas facile √† manquer (et ces pages ne sont pas si difficiles √† trouver). Mais ces politiques indiquent g√©n√©ralement des erreurs sous la forme de messages affich√©s sur la console. Et pour √™tre honn√™te, je soup√ßonne que la plupart des d√©veloppeurs ne pr√™tent pas beaucoup d'attention √† la console (je pense que nous devrions tous faire plus attention √† la console). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais, n√©anmoins, nous pouvons rendre les erreurs d√©tect√©es par les politiques "invisibles" beaucoup plus visibles en utilisant l'API</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReportingObserver</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour surveiller les violations et afficher les notifications pertinentes sur la page. </font><font style="vertical-align: inherit;">Ces notifications peuvent √™tre tr√®s visibles.</font></font><br>
<br>
<pre><code class="plaintext hljs">let reportingAlerts = document.createElement('ul');<font></font>
&nbsp;&nbsp;reportingAlerts.setAttribute('id','reportingAlerts');<font></font>
&nbsp;&nbsp;document.body.appendChild(reportingAlerts);<font></font>
<font></font>
const alertBox = document.getElementById('reportingAlerts');<font></font>
<font></font>
new ReportingObserver((reports, observer) =&gt; {<font></font>
&nbsp;&nbsp;let fragment = document.createDocumentFragment();<font></font>
&nbsp;&nbsp;<font></font>
&nbsp;&nbsp;Object.keys(reports).forEach(function(item) {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;let li = document.createElement('li');<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;li.textContent = reports[item].body.message + ': ' + reports[item].body.featureId;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;fragment.appendChild(li);<font></font>
&nbsp;&nbsp;});<font></font>
&nbsp;&nbsp;<font></font>
&nbsp;&nbsp;alertBox.appendChild(fragment)<font></font>
}, {types: ['feature-policy-violation'], buffered: true}).observe();</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai esquiss√© </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un exemple</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans CodePen </font><font style="vertical-align: inherit;">de ce √† quoi cela pourrait ressembler.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2bd/c18/c8a/2bdc18c8a9bb20db1f18a9e095be4b8e.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un exemple de la fa√ßon dont vous pouvez afficher les notifications des violations de strat√©gie sp√©cifi√©es par l'en-t√™te Feature-Policy. </font><font style="vertical-align: inherit;">Ces notifications sont con√ßues pour une sortie dans l'environnement de d√©veloppement ou lorsque le projet est pr√©par√© pour une sortie en production.</font></font></font></i><br>
 <br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moins d'utilisation de l'en-t√™te Feature-Policy</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le gros inconv√©nient de l'utilisation de l'en-t√™te </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est sa prise en charge par les navigateurs. </font><font style="vertical-align: inherit;">Apparemment, il n'est d√©sormais pris en charge que par les navigateurs bas√©s sur Blink (Opera, Edge, Chrome, Samsung). </font><font style="vertical-align: inherit;">Les navigateurs Firefox et Safari prennent en charge l'attribut </font></font><code>allow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour les √©l√©ments </font></font><code>iframe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mais m√™me l√† o√π il est </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pris en charge, pour garantir l'int√©grit√© de la plupart des strat√©gies, vous devez activer l'indicateur </font></font><code>Experimental Web Platform features</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(vous pouvez le trouver √† l'adresse </font></font><code>about:flags</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">).</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment j'utilise l'en-t√™te de strat√©gie de fonctionnalit√©</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce moins du titre </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, qui est mentionn√© ci-dessus, pour moi personnellement n'est pas un probl√®me particulier. Je pr√©f√®re utiliser les politiques d√©finies par cet en-t√™te comme v√©rificateur de page bas√© sur un navigateur. Par cons√©quent, je n'ai pas besoin de m'efforcer de postuler </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en production ou de m'assurer que les politiques fonctionnent pour tous mes utilisateurs. Ils ne sont n√©cessaires que par moi, ainsi que par ceux qui d√©veloppent le site. Dans tous les cas, j'utilise Chrome comme navigateur principal dans le processus de d√©veloppement. Par cons√©quent, garantir les performances </font></font><code>Feature-Police</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans mon environnement de travail consiste √† activer l'indicateur appropri√©. Apr√®s cela, les politiciens travaillent sans aucune intervention suppl√©mentaire de ma part. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai trouv√© que la fa√ßon la plus simple d'utiliser l'en-t√™te est </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec une extension de navigateur</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ModHeader</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Cette extension vous permet de d√©finir vos propres en-t√™tes qui sont transmis aux pages lors de leur affichage.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9c9/ec2/33b/9c9ec233b6a3913a5e584335ac43a344.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'extension ModHeader vous permet de configurer les options d'en-t√™te Feature-Policy. </font><font style="vertical-align: inherit;">Ils peuvent √™tre activ√©s et d√©sactiv√©s, si vous le souhaitez</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
. J'ai trois ensembles de valeurs d'en-t√™te</font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que j'utilise p√©riodiquement:</font></font><br>
<br>
<ul>
<li><code>oversized-images 'none'; unoptimized-lossy-images 'none'; unoptimized-lossless-images 'none';</code></li>
<li><code>unsized-media 'none'; oversized-images 'none'; unoptimized-lossy-images 'none'; unoptimized-lossless-images 'none';</code></li>
<li><code>script-sync 'none'; unsized-media 'none'; oversized-images 'none'; unoptimized-lossy-images 'none'; unoptimized-lossless-images 'none';</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je garde souvent le premier allum√©. Il est tr√®s excitant de parcourir les pages Web auxquelles s'appliquent les politiques qui y sont utilis√©es. Il est effrayant de voir la taille de certaines images. Il y a beaucoup de choses sur le web moderne qui pourraient √™tre am√©lior√©es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, la politique est tr√®s souvent d√©clench√©e sur les pages </font></font><code>unsized-media</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(et je p√®che aussi), donc son utilisation pendant le travail normal sur Internet est g√™nante. C'est pourquoi je l'ai mis en √©vidence dans une politique distincte, que je peux activer et d√©sactiver. Il en va de m√™me pour les politiques </font></font><code>sync-scripts</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dont l'application "casse" de nombreux sites.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Certaines des √©quipes avec lesquelles j'ai travaill√© ont commenc√© √† utiliser les politiques que j'ai d√©crites pendant le d√©veloppement. </font><font style="vertical-align: inherit;">Cela leur permet de pr√™ter rapidement attention aux probl√®mes auparavant invisibles. </font><font style="vertical-align: inherit;">Bien s√ªr, je recommande d'inclure toutes les politiques </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans l'environnement de d√©veloppement, ce qui vous permet d'identifier rapidement et de corriger les erreurs.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sommaire</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'esp√®re que le support </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">appara√Ætra, par cons√©quent, non seulement dans Chrome. </font><font style="vertical-align: inherit;">Bien que ce soit mon navigateur principal, je dois √©galement utiliser d'autres navigateurs. </font><font style="vertical-align: inherit;">Il serait utile qu'ils soutiennent </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mais ici, cependant, nous voyons cette situation rare o√π m√™me le soutien exp√©rimental d'une certaine opportunit√© est suffisant pour qu'elle soit r√©ellement b√©n√©fique. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les probl√®mes de performances subtils sont √©galement des probl√®mes. </font><font style="vertical-align: inherit;">Et la possibilit√© de rendre ces probl√®mes plus visibles est l'une des meilleures m√©thodes qu'un d√©veloppeur peut utiliser pour les identifier et les r√©soudre. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chers lecteurs! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Envisagez-vous d'utiliser l'en-t√™te Feature-Policy pour identifier les probl√®mes discrets dans les projets Web?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr490612/index.html">Approche fonctionnelle des transactions sur Scala ou √©crivez votre propre monade utile</a></li>
<li><a href="../fr490616/index.html">Le condens√© de mati√®res fra√Æches du monde du front-end de la derni√®re semaine n ¬∞ 404 (24 f√©vrier - 1er mars 2020)</a></li>
<li><a href="../fr490618/index.html">Goroutine Stack Buffers</a></li>
<li><a href="../fr490620/index.html">Quand j'entends les mots "restaur√© le r√©seau neuronal", je grimpe pour v√©rifier les sauvegardes</a></li>
<li><a href="../fr490622/index.html">Lutte contre les fuites de m√©moire dans les applications Web</a></li>
<li><a href="../fr490626/index.html">Un guide complet des attributs data- * HTML</a></li>
<li><a href="../fr490628/index.html">Que faire lorsque CSS bloque l'analyse des pages?</a></li>
<li><a href="../fr490630/index.html">Chargement de tableaux NumPy √† partir du disque: comparaison de memmap () et Zarr / HDF5</a></li>
<li><a href="../fr490634/index.html">√âv√©nements num√©riques √† Moscou du 2 au 8 mars</a></li>
<li><a href="../fr490636/index.html">√âv√©nements num√©riques √† Saint-P√©tersbourg du 2 au 8 mars</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>