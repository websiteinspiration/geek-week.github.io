<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëºüèª üíÉüèΩ üíÖüèø Gesti√≥n de paquetes con m√≥dulos Go: una gu√≠a pragm√°tica üë© ü§üüèø üàöÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola a todos. En previsi√≥n del comienzo del curso para desarrolladores de Golang, hemos preparado otra traducci√≥n interesante para usted.
 
 
 Los m√≥d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Gesti√≥n de paquetes con m√≥dulos Go: una gu√≠a pragm√°tica</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/503918/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hola a todos. </font><font style="vertical-align: inherit;">En previsi√≥n del comienzo del curso para </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desarrolladores de Golang, hemos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> preparado otra traducci√≥n interesante para usted.</font></font></b></i><br>
<br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los m√≥dulos son una forma de lidiar con las dependencias en Go. Inicialmente presentados como un experimento, se supone que los m√≥dulos deben introducirse en el campo como un nuevo est√°ndar para administrar paquetes desde la versi√≥n 1.13. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considero que este tema es bastante inusual para principiantes que vienen de otros idiomas, por lo que decid√≠ recopilar algunas ideas y consejos aqu√≠ para ayudar a otros como yo a tener una idea de la administraci√≥n de paquetes en Go. Comenzaremos con una introducci√≥n general y luego pasaremos a los aspectos menos obvios, incluido el uso de la carpeta del proveedor, el uso de m√≥dulos con Docker en desarrollo, dependencias de herramientas, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si ya est√° familiarizado con los m√≥dulos Go y conoce el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wiki</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, como el dorso de tu mano, este art√≠culo probablemente no te sea muy √∫til. </font><font style="vertical-align: inherit;">Pero por lo dem√°s, sin embargo, puede ahorrar varias horas de prueba y error. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, si est√°s en camino, s√∫bete y disfruta del viaje.</font></font><a name="habracut"></a><br>
<br>
<img src="https://habrastorage.org/webt/tr/d9/eq/trd9eqcuki5uwi4w5b2gexcp8q4.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inicio r√°pido</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si el control de versiones ya est√° integrado en su proyecto, simplemente puede ejecutar</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> mod init</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O especifique la ruta al m√≥dulo manualmente. </font><font style="vertical-align: inherit;">Esto es algo as√≠ como un nombre, URL y ruta de importaci√≥n para su paquete:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> mod init github.com/you/hello</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esto crear√° un archivo </font></font><code>go.mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que tambi√©n define los requisitos del proyecto y lochit dependiendo de su versi√≥n correcta (como una analog√≠a para usted, es como </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, y se </font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">combina en un solo archivo):</font></font><br>
<br>
<pre><code class="go hljs">module github.com/you/hello
<span class="hljs-keyword">go</span> <span class="hljs-number">1.12</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ejecute </font></font><code>go get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para agregar una nueva dependencia a su proyecto: tenga en </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cuenta que aunque no puede especificar un rango de versiones con go get, lo que define aqu√≠ no es una versi√≥n espec√≠fica, sino una versi√≥n m√≠nima. </font><font style="vertical-align: inherit;">Como veremos m√°s adelante, hay una manera de actualizar correctamente las dependencias seg√∫n semver.</font></font></i><br>
<br>
<pre><code class="go hljs"># use Git tags
<span class="hljs-keyword">go</span> get github.com/<span class="hljs-keyword">go</span>-chi/chi@v4<span class="hljs-number">.0</span><span class="hljs-number">.1</span><font></font>
# or Git branch name<font></font>
<span class="hljs-keyword">go</span> get github.com/<span class="hljs-keyword">go</span>-chi/chi@master<font></font>
# or Git commit hash<font></font>
<span class="hljs-keyword">go</span> get github.com/<span class="hljs-keyword">go</span>-chi/chi@<span class="hljs-number">08</span>c92af</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora nuestro archivo es el </font></font><code>go.mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">siguiente:</font></font><br>
<br>
<pre><code class="go hljs">module github.com/you/hello
<span class="hljs-keyword">go</span> <span class="hljs-number">1.12</span>
require github.com/<span class="hljs-keyword">go</span>-chi/chi v4<span class="hljs-number">.0</span><span class="hljs-number">.2</span>+incompatible <span class="hljs-comment">// indirect</span></code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El sufijo se </font></font><code>+incompatible</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">agrega a todos los paquetes que a√∫n no est√°n configurados para los m√≥dulos Go o que infringen sus reglas de control de versiones. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como no hemos importado este paquete en ning√∫n lugar de nuestro proyecto, se marc√≥ como </font></font><code>// indirect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Podemos ordenar esto con el siguiente comando:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> mod tidy</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dependiendo del estado actual de su repositorio, eliminar√° un m√≥dulo no utilizado o eliminar√° un comentario </font></font><code>// indirect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si alguna dependencia por s√≠ misma no tiene </font></font><code>go.mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(por ejemplo, a√∫n no est√° configurada para m√≥dulos), entonces todas sus dependencias se escribir√°n en el archivo padre </font></font><code>go.mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(como opci√≥n, su archivo </font></font><code>go.mod)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">junto con un comentario </font></font><code>// indirect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para indicar que no son de importaci√≥n directa En su</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
plan global, el objetivo </font></font><code>go mod tidy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tambi√©n es agregar las dependencias necesarias para otras combinaciones de SO, arquitecturas y etiquetas de compilaci√≥n. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aseg√∫rese de ejecutarlo antes de cada lanzamiento.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Tambi√©n aseg√∫rese de crear un archivo despu√©s de agregar la dependencia</font></font><code>go.sum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Puede pensar que este es un archivo de bloqueo. </font><font style="vertical-align: inherit;">Pero, de hecho, </font></font><code>go.mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ya proporciona suficiente informaci√≥n para compilaciones 100% reproducibles. </font><font style="vertical-align: inherit;">El archivo </font></font><code>go.sum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se crea con fines de verificaci√≥n: contiene las sumas de verificaci√≥n criptogr√°ficas esperadas del contenido de las versiones individuales del m√≥dulo. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En parte porque no es </font></font><code>go.sum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un archivo de bloqueo, guarda las sumas de verificaci√≥n escritas para la versi√≥n del m√≥dulo, incluso despu√©s de dejar de usar este m√≥dulo. </font><font style="vertical-align: inherit;">Esto le permite verificar las sumas de verificaci√≥n si reanuda su uso m√°s tarde, lo que proporciona seguridad adicional.</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/_5/j8/vi/_5j8vigrklvhkwaucssmy7zaf88.png"><br>
<blockquote><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mkcert acaba de migrar a los m√≥dulos (con proveedor / para compatibilidad con versiones anteriores) y todo sali√≥ sin problemas </font></font></i> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/FiloSottile/mkcert/commit/26ac5f35395fb9cba3805faf1a5a04d260271291</font></font></a><br>
<br>
<pre><code class="go hljs">$ GO111MODULE=on go1<span class="hljs-number">.11</span>rc1 mod init<font></font>
$ GO111MODULE=on go1<span class="hljs-number">.11</span>rc1 mod vendor<font></font>
$ git add <span class="hljs-keyword">go</span>.mod <span class="hljs-keyword">go</span>.sum vendor<font></font>
$ git rm Gopkg.lock Gopkg.toml Makefile</code></pre><br>
<img src="https://habrastorage.org/webt/kt/ch/ro/ktchrocah4xszqqrfkqtug3qzty.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preguntas frecuentes: ¬øDeber√≠a comprometerme </font></font><code>go.sum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en git? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A: definitivamente s√≠. </font><font style="vertical-align: inherit;">Con √©l, los propietarios de sus fuentes no necesitan confiar en otros repositorios de GitHub y propietarios de rutas de importaci√≥n personalizadas. </font><font style="vertical-align: inherit;">Ya en camino a nosotros, algo mejor, pero por ahora este es el mismo modelo que los hashes en los archivos de bloqueo.</font></font></i></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los comandos </font></font><code>go build</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>go test</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cargar√°n autom√°ticamente todas las dependencias que faltan, aunque puede hacerlo expl√≠citamente con la ayuda de </font></font><code>go mod download</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rellenar previamente cach√©s locales que pueden ser √∫tiles para CI. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por defecto, todos nuestros paquetes de todos los proyectos se cargan en el directorio </font></font><code>$GOPATH/pkg/mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Discutiremos esto con m√°s detalle m√°s adelante.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Actualizaci√≥n de versiones de paquetes</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede usar </font></font><code>go get -u</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cualquiera </font></font><code>go get -u=patch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para actualizar las dependencias a la √∫ltima versi√≥n menor o parche, respectivamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero no puede actualizar a versiones principales como esa. </font><font style="vertical-align: inherit;">El c√≥digo incluido en los m√≥dulos Go debe cumplir t√©cnicamente con las siguientes reglas:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Match semver (ejemplo, etiqueta VCS v1.2.3).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si el m√≥dulo es la versi√≥n v2 o superior, la versi√≥n principal del m√≥dulo debe incluirse tanto </font></font><code>/vN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">al final de la ruta del m√≥dulo utilizada en el archivo </font></font><code>go.mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">como en la ruta de importaci√≥n del paquete:</font></font></li>
</ul><br>
<pre><code class="go hljs"><span class="hljs-keyword">import</span> <span class="hljs-string">"github.com/you/hello/v2"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aparentemente, esto se hace para que se puedan importar diferentes versiones de paquetes en un ensamblaje (consulte </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el problema de dependencia del diamante</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En pocas palabras, Go espera que seas muy cuidadoso al presentar versiones principales.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sustituci√≥n de m√≥dulos importados</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede especificar el m√≥dulo necesario para su propia bifurcaci√≥n o incluso la ruta local al archivo utilizando la directiva </font></font><code>replace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> mod edit -replace github.com/<span class="hljs-keyword">go</span>-chi/chi=./packages/chi</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Resultado:</font></font><br>
<br>
<pre><code class="go hljs">module github.com/you/hello
<span class="hljs-keyword">go</span> <span class="hljs-number">1.12</span>
require github.com/<span class="hljs-keyword">go</span>-chi/chi v4<span class="hljs-number">.0</span><span class="hljs-number">.2</span>+incompatible<font></font>
replace github.com/<span class="hljs-keyword">go</span>-chi/chi =&gt; ./packages/chi</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede eliminar la l√≠nea manualmente o ejecutar:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> mod edit -dropreplace github.com/<span class="hljs-keyword">go</span>-chi/chi</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gesti√≥n de dependencias del proyecto </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hist√≥ricamente, todo el c√≥digo de Go se almacenaba en un mono-repositorio gigante, porque as√≠ es como Google organiza su base de c√≥digo, y esto afecta el dise√±o del lenguaje. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los m√≥dulos Go son una desviaci√≥n de este enfoque. Ya no necesita mantener todos sus proyectos </font></font><code>$GOPATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sin embargo, t√©cnicamente todas sus dependencias descargadas todav√≠a est√°n ubicadas </font></font><code>$GOPATH/pkg/mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Si usa contenedores Docker para el desarrollo local, esto puede ser un problema, ya que las dependencias se almacenan fuera del proyecto. Por defecto, simplemente no son visibles en su IDE. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ye/2c/_o/ye2c_o9jcsodsrhdekb4djz7lve.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esto generalmente no es un problema para otros idiomas, pero esto es lo que encontr√© por primera vez al trabajar con la base de c√≥digo Go. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afortunadamente, hay varias formas (indocumentadas) de resolver este problema.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opci√≥n 1. Instale GOPATH dentro del directorio de su proyecto.</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A primera vista, esto puede parecer contradictorio, pero </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si ejecuta Go desde un contenedor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , puede anular GOPATH para que apunte al directorio del proyecto para que los paquetes sean accesibles desde el host:</font></font><br>
<br>
<pre><code class="go hljs">version: <span class="hljs-string">'3.7'</span><font></font>
<font></font>
services:<font></font>
  app:<font></font>
    command: tail -f /dev/null<font></font>
    image: golang:<span class="hljs-number">1.12</span><span class="hljs-number">.6</span>-stretch<font></font>
    environment:<font></font>
      #        - /code/.<span class="hljs-keyword">go</span>/pkg/mod<font></font>
      - GOPATH=/code/.<span class="hljs-keyword">go</span><font></font>
    ports:<font></font>
      - <span class="hljs-number">8000</span>:<span class="hljs-number">8000</span><font></font>
    volumes:<font></font>
      - ./:/code:cached<font></font>
    working_dir: /code</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los IDE populares deber√≠an poder instalar GOPATH en el nivel del proyecto (espacio de trabajo): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_t/jz/d_/_tjzd_trva2fekp6vmt5ewc_xke.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
el √∫nico inconveniente de este enfoque es la falta de interacci√≥n con el tiempo de ejecuci√≥n de Go en la computadora host. </font><font style="vertical-align: inherit;">Debe ejecutar todos los comandos Go dentro del contenedor.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opci√≥n 2: vender sus dependencias</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Otra forma es copiar las dependencias de su proyecto en una carpeta </font></font><code>vendor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> mod vendor</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Debe notarse de inmediato: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NO permitimos que</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Go cargue directamente materiales a la carpeta del proveedor: esto no es posible con los m√≥dulos. </font><font style="vertical-align: inherit;">Simplemente copiamos los paquetes ya descargados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s, si desata sus dependencias, como en el ejemplo anterior, borre </font></font><code>$GOPATH/pkg/mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y luego intente agregar varias dependencias nuevas a su proyecto, ver√° lo siguiente:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Go reconstruir√° el cach√© de descarga para todos los paquetes de software </font></font><code>$GOPATH/pkg/mod/cache</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todos los m√≥dulos cargados se copiar√°n a </font></font><code>$GOPATH/pkg/mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y finalmente, Go copiar√° estos m√≥dulos a una </font></font><code>vendor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">carpeta, eliminando ejemplos, pruebas y algunos otros archivos de los que no depende directamente.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s, hay muchas cosas que faltan en esta carpeta de proveedor reci√©n creada: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rj/w-/lt/rjw-ltm1y1s8jwia34bfars6ngw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
un archivo t√≠pico de Docker Compose tiene este aspecto (tenga en cuenta los enlaces de volumen):</font></font><br>
<br>
<pre><code class="go hljs">version: <span class="hljs-string">'3.7'</span><font></font>
<font></font>
services:<font></font>
  app:<font></font>
    command: tail -f /dev/null<font></font>
    image: golang:<span class="hljs-number">1.12</span><span class="hljs-number">.6</span>-stretch<font></font>
    ports:<font></font>
      - <span class="hljs-number">8000</span>:<span class="hljs-number">8000</span><font></font>
    volumes:<font></font>
     #    <span class="hljs-keyword">go</span>,           <font></font>
      - modules:/<span class="hljs-keyword">go</span>/pkg/mod/cache<font></font>
      - ./:/code:cached<font></font>
    working_dir: /code <font></font>
<font></font>
volumes:<font></font>
  modules:<font></font>
    driver: local</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tenga en cuenta que NO hago c√≥mics con esta carpeta del proveedor en el sistema de control de versiones o no la voy a usar en producci√≥n. </font><font style="vertical-align: inherit;">Este es un script de desarrollo estrictamente local, que generalmente se puede encontrar en otros idiomas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sin embargo, cuando leo los </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comentarios de algunos mantenedores de Go</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y algunas ofertas relacionadas con la venta parcial (?), Tengo la impresi√≥n de que esta funci√≥n originalmente no estaba destinada a este caso de usuario. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uno de los </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comentaristas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en reddit me ayud√≥ a arrojar algo de luz sobre esto:</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por lo general, las personas venden sus dependencias por razones como el deseo de tener ensamblajes ajustados sin acceso a la red, as√≠ como la disponibilidad de una copia de las dependencias preparadas en caso de falla de github o la desaparici√≥n del repositorio, y la posibilidad de una auditor√≠a m√°s f√°cil de los cambios en las dependencias utilizando herramientas est√°ndar de VCS, etc. .</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
S√≠, no parece nada del hecho de que yo podr√≠a estar interesado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De acuerdo con el comando Ir, puede habilitar f√°cilmente la venta mediante la configuraci√≥n de una variable de entorno </font></font><code>GOFLAGS=-mod=vendor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. No recomiendo hacer esto. El uso de indicadores simplemente se romper√° </font></font><code>go get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sin proporcionar ning√∫n otro beneficio a su flujo de trabajo diario: de </font></font><br>
<br>
<img src="https://habrastorage.org/webt/df/ul/uw/dfuluwbr13eacullfzphguhrbeo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
hecho, el √∫nico lugar que necesita para habilitar la venta es su IDE:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jv/x2/pz/jvx2pzgtrx5wcfmlum4s5hheorw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de algunas pruebas y errores, se me ocurri√≥ el siguiente procedimiento para agregar dependencias de proveedores en este enfoque.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paso 1. Requisito</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede requerir una dependencia con </font></font><code>go get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> get github.com/rs/zerolog@v1<span class="hljs-number">.14</span><span class="hljs-number">.3</span></code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paso 2. Importar</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego imp√≥rtelo en alg√∫n lugar de su c√≥digo:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">import</span> (<font></font>
   _ <span class="hljs-string">"github.com/rs/zerolog"</span>
)</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paso 3. Venta</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Finalmente, vuelve a abrir tus dependencias:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> mod vendor</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hay una </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propuesta pendiente</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para permitir que el proveedor go mod acepte ciertas plantillas de m√≥dulos que pueden (o no) resolver algunos de los problemas asociados con este flujo de trabajo. </font></font><br>
<br>
<code>go mod vendor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ya requiere autom√°ticamente las importaciones perdidas, por lo que el </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paso 1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es opcional en este flujo de trabajo (si no desea especificar restricciones de versi√≥n). Sin embargo, sin el paso 2, no recoger√° el paquete descargado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este enfoque funciona mejor con el sistema host, pero es bastante confuso cuando se trata de editar sus dependencias.</font></font><br>
<br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Personalmente, creo que redefinir GOPATH es un enfoque m√°s limpio, ya que no sacrifica la funcionalidad </font></font><code>go get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Sin embargo, quer√≠a mostrar ambas estrategias, porque la carpeta del proveedor puede ser m√°s familiar para las personas que vienen de otros lenguajes, como PHP, Ruby, Javascript, etc. Como puede ver en el fraude descrito en este art√≠culo, este No es una opci√≥n particularmente buena para ir.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dependencias de herramientas</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es posible que necesitemos instalar algunas herramientas basadas en Go que no se importan, sino que se usan como parte del entorno de desarrollo del proyecto. </font><font style="vertical-align: inherit;">Un ejemplo simple de dicha herramienta es </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CompileDaemon</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que puede monitorear su c√≥digo en busca de cambios y reiniciar su aplicaci√≥n. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> enfoque </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">oficialmente recomendado</font></a><font style="vertical-align: inherit;"> es agregar un </font></font><code>tools.go</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">archivo (el nombre no importa) con el siguiente contenido:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-comment">// +build tools</span>
<span class="hljs-keyword">package</span> tools
<span class="hljs-keyword">import</span> (<font></font>
_ <span class="hljs-string">"github.com/githubnemo/CompileDaemon"</span>
)</code></pre><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La limitaci√≥n </font></font><code>// +build tools</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">evita que sus ensamblajes regulares realmente importen su herramienta.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La expresi√≥n de importaci√≥n permite que los comandos go escriban con precisi√≥n la informaci√≥n de la versi√≥n de sus herramientas en </font></font><code>go.mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">su </font><font style="vertical-align: inherit;">archivo de </font><font style="vertical-align: inherit;">m√≥dulo.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces eso es todo. </font><font style="vertical-align: inherit;">Espero que no est√©s tan confundido como yo cuando comenc√© a usar los m√≥dulos Go. </font><font style="vertical-align: inherit;">Puede visitar el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wiki</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">Go Modules</font></a><font style="vertical-align: inherit;"> para obtener m√°s detalles.</font></font><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S√∫bete al curso.</font></font></a><br>
<br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es503904/index.html">El mundo yn mundos, o las matem√°ticas para las humanidades.</a></li>
<li><a href="../es503906/index.html">LabVIEW NXG - Tipos de datos simples y coerci√≥n de tipos</a></li>
<li><a href="../es503908/index.html">Llamar a bibliotecas compartidas desde Similink</a></li>
<li><a href="../es503910/index.html">Experimentos en personas que han ido a "udalenka"</a></li>
<li><a href="../es503916/index.html">Aprender a comerciar en el intercambio. Primera parte: configurar un entorno de prueba</a></li>
<li><a href="../es503920/index.html">C√≥mo probamos los sistemas de micr√≥fonos en STM32: la experiencia de los desarrolladores de dispositivos Yandex</a></li>
<li><a href="../es503922/index.html">¬øPor qu√© la UE erradica las paredes de las galletas?</a></li>
<li><a href="../es503924/index.html">Descripci√≥n general del esc√°ner 3D intraoral Medit i500</a></li>
<li><a href="../es503926/index.html">Qui√©n es qui√©n en el ecosistema de pagos 2020. Parte 2</a></li>
<li><a href="../es503928/index.html">Aerosol VS riego: ¬øcu√°l es mejor y hay alguna diferencia?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>