<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèø‚Äçü§ù‚Äçüë©üèæ „äóÔ∏è üê† Authentification - CUSTOM SETUP / AWS Amplify + React Native üë®üèæ‚Äçüåæ üà∫ ‚ÜïÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'un des sujets les plus demand√©s parmi les abonn√©s de ma cha√Æne Dimka Reaktivny est l'authentification et l'autorisation dans l'application React Nat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Authentification - CUSTOM SETUP / AWS Amplify + React Native</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/504344/"><p><img src="https://habrastorage.org/getpro/habr/post_images/406/65e/0e9/40665e0e973bdd2a10416e9113667856.png" alt="cognito"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'un des sujets les plus demand√©s parmi les abonn√©s de ma cha√Æne </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dimka Reaktivny</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est l'authentification et l'autorisation dans l'application React Native. </font><font style="vertical-align: inherit;">Par cons√©quent, j'ai d√©cid√© de r√©soudre ce probl√®me avec un longrid s√©par√© et avant de commencer le codage, il est n√©cessaire de traiter de la d√©finition de l'authentification / autorisation.</font></font></p><a name="habracut"></a><br>
<h2 id="autentifikaciya"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Authentification</font></font></h2><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c'est une v√©rification de la correspondance du sujet et de celui pour qui il essaie de se faire passer √† l'aide de quelques informations uniques (empreintes digitales, couleur de l'iris, voix, etc.), dans le cas le plus simple - √† l'aide du mail et du mot de passe.</font></font></p><br>
<h2 id="avtorizaciya"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S'identifier</font></font></h2><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">il s'agit d'un contr√¥le et d'une d√©termination de l'autorit√© pour effectuer certaines actions conform√©ment √† l'authentification effectu√©e pr√©c√©demment</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A la fin de cet article, nous r√©aliserons cette application mobile:</font></font></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/0bb/0db/ae4/0bb0dbae460bb468dca68cf1955f2ee7.png" alt="cognito"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'authentification fait partie int√©grante de presque toutes les applications. </font><font style="vertical-align: inherit;">Savoir qui est l'utilisateur, l'identifiant unique de l'utilisateur, les autorisations dont il dispose et s'il est connect√©, permet √† votre application d'afficher les vues correctes et de renvoyer les donn√©es correctes pour l'utilisateur actuellement connect√©.</font></font></p><br>
<p>      ,    ,     ,     ,    .      ,  OAUTH ( ), MFA ( )  TOTP (    ).</p><br>
<p>           .             ,        .  ,      ,   Auth0, Okta  Amazon Cognito,      .</p><br>
<p>    ,         React Native   Amazon Cognito  AWS Amplify.</p><br>
<h2 id="amazon-cognito">Amazon Cognito</h2><br>
<p>      AWS. Cognito      ,   ,  ,      . Cognito    ,          ,   Facebook, Google  Amazon.</p><br>
<p>Cognito     :     .</p><br>
<h2 id="user-pools">User Pools</h2><br>
<p>     ,           .    .   ,    ,    ,    .   ‚Äî  ,    ,       ,    ,       .</p><br>
<h2 id="identity-pools">Identity pools</h2><br>
<p>     ,    ,       AWS. ,       -,        API.        .     ,         Cognito   Facebook  Google.</p><br>
<p>,    Amazon Cognito     .</p><br>
<p>     Amazon Cognito.     ,    ,         AWS.</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/92a/a49/ac8/92aa49ac8b44cab68794e7ae562306c1.png" alt="cognito"></p><br>
<ol>
<li><p>                   .</p><br>
</li>
<li><p>          AWS   .</p><br>
</li>
<li><p>,          AWS      AWS,   Amazon S3  DynamoDB.</p><br>
</li>
</ol><br>
<p>Cognito User Pools              ,   , :</p><br>
<ul>
<li> </li>
<li>   </li>
<li> </li>
<li>  </li>
<li>  </li>
<li>  MFA</li>
<li> Amazon Cognito  AWS Amplify</li>
</ul><br>
<p>AWS Amplify  Amazon Cognito  .         Amazon Cognito      AWS Amplify.     CLI,      (, signUp, signIn  signOut)   JavaScript     Amplify JavaScript.</p><br>
<p>Amplify       ,              ,  React, React Native, Vue  Angular.</p><br>
<h2 id="vy-sprosite-i-skolko-zhe-eto-vse-stoit">       ?</h2><br>
<h4 id="platite-tolko-za-to-chem-polzuetes-nikakih-minimalnyh-platezhey">   ,  .   .</h4><br>
<p> Amazon Cognito Identity    ,          (MAU). MAU ‚Äî  ,           : , ,     .             .</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/e70/069/e27/e70069e27d465ab06839eed77ac06c60.png" alt="cognito"></p><br>
<p>CODING TIME ‚Äç‚Äç</p><br>
<p>  AWS Amplify: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Telegram</a></p><br>
<h1 id="chast-i"> I</h1><br>
<p> o    UI    AWS Amplify,        .</p><br>
<p>        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">GitHub</a>.</p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/a85/330/557/a85330557d5a036dd7641c8dcaa8d8a8.gif" alt="AWS Amplify"></a></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/308/34a/22a/30834a22ac5c4b8f15a03eaf1a4bf1de.png" alt="Cognito"></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/942/0e0/a51/9420e0a51c7b345d8fa5d5e29d760ea0.png" alt="√âtape01"></p><br>
<h2 id="sozdaem-novyy-proekt-">   Ô∏è</h2><br>
<pre><code class="bash hljs">react-native init auth</code></pre><br>
<p>  </p><br>
<p>iOS</p><br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> auth &amp;&amp; react-native run-ios</code></pre><br>
<p>Android</p><br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> auth &amp;&amp; react-native run-android</code></pre><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/631/e00/e86/631e00e866d9fc3d76c43b97781ae3b4.png" alt="√âtape 02"></p><br>
<h2 id="podklyuchaem-ikonki"> </h2><br>
<p>     AWS Amplify,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"></a> .<br>
  .</p><br>
<p>  App.js</p><br>
<pre><code class="plaintext hljs">import Icon from 'react-native-vector-icons/FontAwesome5'<font></font>
<font></font>
const App = () =&gt; {<font></font>
  return (<font></font>
    &lt;&gt;<font></font>
      &lt;Icon name="comments" size={30} color="#900" /&gt;<font></font>
    &lt;/&gt;<font></font>
  )<font></font>
}</code></pre><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/9eb/aa1/4a1/9ebaa14a1b87631ab663427182eb87cd.png" alt="√âtape03"></p><br>
<h2 id="registriruem-svoy-aws-account">  AWS account</h2><br>
<p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"></a>       5 .</p><br>
<h4 id="vnimanie">!!!</h4><br>
<p>  ,     1$ </p><br>
<p>     Amplify Command Line Interface (CLI)</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/af4/70f/d98/af470fd981fa96a00da9992a9a7e6924.png" alt="√âtape 04"></p><br>
<h2 id="inicializaciya-aws-amplify-v-proekt-react-native"> AWS Amplify   React Native</h2><br>
<p>    React Native   AWS Amplify </p><br>
<pre><code class="bash hljs">amplify init</code></pre><br>
<p>  :</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/991/4b9/b2a/9914b9b2ad986b066c0c7996337a3f67.png" alt="amplifier init"></p><br>
<p>  </p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/d23/840/9a4/d238409a47778024c1f12cd93691c3ab.png" alt="√âtape05"></p><br>
<h2 id="podklyuchaem-plagin-autentifikacii">  </h2><br>
<p>,     ,     ,             .</p><br>
<p></p><br>
<pre><code class="bash hljs">amplify add auth</code></pre><br>
<p>  .    .     auth     ampify/backend/auth</p><br>
<h4 id="vybiraem-profil-kotoryy-my-hotim-ispolzovat-default-enter-i-kak-polzovateli-budut-vhodit-v-sistemu-emailza-sms-spisyvayut-dengi"> ,    . default. Enter       . Email( SMS  ).</h4><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/ff3/add/83f/ff3add83ff4ab1194c6ff8f9401b06bb.png" alt="amplifier init"></p><br>
<p>    </p><br>
<pre><code class="bash hljs">amplify push</code></pre><br>
<p>All resources are updated in the cloud</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/34b/ec2/c86/34bec2c860805fdf4daca2f36ec985fe.png" alt="√âtape06"></p><br>
<h2 id="podklyuchaem-aws-amplify-v-proekt-react-native-"> AWS Amplify   React Native Ô∏è</h2><br>
<p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"></a> ,      :</p><br>
<pre><code class="bash hljs">yarn add aws-amplify @aws-amplify/core aws-amplify-react-native amazon-cognito-identity-js @react-native-community/netinfo</code></pre><br>
<p>      ios   </p><br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> ios &amp;&amp; pod install &amp;&amp; <span class="hljs-built_in">cd</span> ..</code></pre><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/ae8/966/d5e/ae8966d5e8590e6dbb72da5c187d859d.png" alt="√âtape 07"></p><br>
<h2 id="redaktiruem-strukturu-proekta">  </h2><br>
<p>  /src     App.js,    index.js</p><br>
<p>   /auth/index.js    .</p><br>
<pre><code class="plaintext hljs">import { AppRegistry, YellowBox } from 'react-native'<font></font>
import App from './src'<font></font>
import { name as appName } from './app.json'<font></font>
<font></font>
YellowBox.ignoreWarnings([<font></font>
  'Warning: AsyncStorage',  <font></font>
  'Warning: componentWillReceiveProps',<font></font>
  'RCTRootView cancelTouches',<font></font>
  'not authenticated',<font></font>
  'Sending `onAnimatedValueUpdate`'<font></font>
])<font></font>
<font></font>
//window.LOG_LEVEL = 'DEBUG'<font></font>
<font></font>
AppRegistry.registerComponent(appName, () =&gt; App)</code></pre><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/9c9/355/eab/9c9355eabb59b5a4c4f36b4336c5febd.png" alt="√âtape 08"></p><br>
<h2 id="minimalnaya-konfiguraciya-proekta-i-modul-authenticator">     Authenticator</h2><br>
<p>Amplify.configure ‚Äî  </p><br>
<p>Authenticator ‚Äî  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">AWS Amplify Authentication</a>  API-      ,      .</p><br>
<pre><code class="plaintext hljs">import React from 'react'<font></font>
import {StatusBar} from 'react-native'<font></font>
import Amplify from '@aws-amplify/core'<font></font>
import {Authenticator} from 'aws-amplify-react-native'<font></font>
import awsconfig from '../aws-exports'<font></font>
<font></font>
Amplify.configure({<font></font>
  ...awsconfig,<font></font>
  Analytics: {<font></font>
    disabled: true,<font></font>
  },<font></font>
})<font></font>
<font></font>
const App = () =&gt; {<font></font>
  return (<font></font>
    &lt;&gt;<font></font>
      &lt;StatusBar barStyle="dark-content" /&gt;<font></font>
      &lt;Authenticator usernameAttributes="email" /&gt;<font></font>
    &lt;/&gt;<font></font>
  )<font></font>
}<font></font>
<font></font>
export default App</code></pre><br>
<p> ,    UI  :</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/cb4/2b1/d66/cb42b1d66b77c5721e1d204bedc1a03d.png" alt="Cognito"></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/560/ec1/171/560ec1171f5bc79a6dde22f0f344cb58.png" alt="√âtape 09"></p><br>
<h2 id="pravim-inputy-v-appjs">   App.js</h2><br>
<p>   signUpConfig</p><br>
<pre><code class="plaintext hljs">const signUpConfig = {<font></font>
  hideAllDefaults: true,<font></font>
  signUpFields: [<font></font>
    {<font></font>
      label: 'Email',<font></font>
      key: 'email',<font></font>
      required: true,<font></font>
      displayOrder: 1,<font></font>
      type: 'string',<font></font>
    },<font></font>
    {<font></font>
      label: 'Password',<font></font>
      key: 'password',<font></font>
      required: true,<font></font>
      displayOrder: 2,<font></font>
      type: 'password',<font></font>
    },<font></font>
  ],<font></font>
}<font></font>
<font></font>
&lt;Authenticator<font></font>
   usernameAttributes="email"<font></font>
   signUpConfig={signUpConfig}<font></font>
/&gt;</code></pre><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/df8/22a/e04/df822ae04334378b0b39d6bd70bf2513.png" alt="√âtape 10"></p><br>
<h2 id="menyaem-temu-ui">  UI</h2><br>
<p>      /src/components/index.js  </p><br>
<pre><code class="plaintext hljs">export * from './AmplifyTheme'</code></pre><br>
<p>     /src/components/AmplifyTheme/index.js   </p><br>
<pre><code class="plaintext hljs">import { StyleSheet } from 'react-native'<font></font>
<font></font>
export const deepSquidInk = '#152939'<font></font>
export const linkUnderlayColor = '#FFF'<font></font>
export const errorIconColor = '#30d0fe'<font></font>
<font></font>
const AmplifyTheme = StyleSheet.create({<font></font>
  container: {<font></font>
    flex: 1,<font></font>
    flexDirection: 'column',<font></font>
    alignItems: 'center',<font></font>
    justifyContent: 'space-around',<font></font>
    paddingTop: 20,<font></font>
    width: '100%',<font></font>
    backgroundColor: '#FFF'<font></font>
  },<font></font>
  section: {<font></font>
    flex: 1,<font></font>
    width: '100%',<font></font>
    padding: 30<font></font>
  },<font></font>
  sectionHeader: {<font></font>
    width: '100%',<font></font>
    marginBottom: 32<font></font>
  },<font></font>
  sectionHeaderText: {<font></font>
    color: deepSquidInk,<font></font>
    fontSize: 20,<font></font>
    fontWeight: '500'<font></font>
  },<font></font>
  sectionFooter: {<font></font>
    width: '100%',<font></font>
    padding: 10,<font></font>
    flexDirection: 'row',<font></font>
    justifyContent: 'space-between',<font></font>
    marginTop: 15,<font></font>
    marginBottom: 20<font></font>
  },<font></font>
  sectionFooterLink: {<font></font>
    fontSize: 14,<font></font>
    color: '#30d0fe',<font></font>
    alignItems: 'baseline',<font></font>
    textAlign: 'center'<font></font>
  },<font></font>
  navBar: {<font></font>
    marginTop: 35,<font></font>
    padding: 15,<font></font>
    flexDirection: 'row',<font></font>
    justifyContent: 'flex-end',<font></font>
    alignItems: 'center'<font></font>
  },<font></font>
  navButton: {<font></font>
    marginLeft: 12,<font></font>
    borderRadius: 4<font></font>
  },<font></font>
  cell: {<font></font>
    flex: 1,<font></font>
    width: '50%'<font></font>
  },<font></font>
  errorRow: {<font></font>
    flexDirection: 'row',<font></font>
    justifyContent: 'center'<font></font>
  },<font></font>
  errorRowText: {<font></font>
    marginLeft: 10<font></font>
  },<font></font>
  photo: {<font></font>
    width: '100%'<font></font>
  },<font></font>
  album: {<font></font>
    width: '100%'<font></font>
  },<font></font>
  button: {<font></font>
    backgroundColor: '#30d0fe',<font></font>
    alignItems: 'center',<font></font>
    padding: 16<font></font>
  },<font></font>
  buttonDisabled: {<font></font>
    backgroundColor: '#85E4FF',<font></font>
    alignItems: 'center',<font></font>
    padding: 16<font></font>
  },<font></font>
  buttonText: {<font></font>
    color: '#fff',<font></font>
    fontSize: 14,<font></font>
    fontWeight: '600'<font></font>
  },<font></font>
  formField: {<font></font>
    marginBottom: 22<font></font>
  },<font></font>
  input: {<font></font>
    padding: 16,<font></font>
    borderWidth: 1,<font></font>
    borderRadius: 3,<font></font>
    borderColor: '#C4C4C4'<font></font>
  },<font></font>
  inputLabel: {<font></font>
    marginBottom: 8<font></font>
  },<font></font>
  phoneContainer: {<font></font>
    display: 'flex',<font></font>
    flexDirection: 'row',<font></font>
    alignItems: 'center'<font></font>
  },<font></font>
  phoneInput: {<font></font>
    flex: 2,<font></font>
    padding: 16,<font></font>
    borderWidth: 1,<font></font>
    borderRadius: 3,<font></font>
    borderColor: '#C4C4C4'<font></font>
  },<font></font>
  picker: {<font></font>
    flex: 1,<font></font>
    height: 44<font></font>
  },<font></font>
  pickerItem: {<font></font>
    height: 44<font></font>
  }<font></font>
})<font></font>
<font></font>
export { AmplifyTheme }</code></pre><br>
<p>     Authenticator src/index.js</p><br>
<pre><code class="plaintext hljs">import {AmplifyTheme} from './components'<font></font>
<font></font>
&lt;Authenticator<font></font>
  usernameAttributes="email"<font></font>
  signUpConfig={signUpConfig}<font></font>
  theme={AmplifyTheme}<font></font>
/&gt;</code></pre><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/517/b5d/e5c/517b5de5c8e725435ea10c86dfbaad27.png" alt="Amplifytheme"></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/81f/03c/c4c/81f03cc4cf1c819f35f562367e6975d1.png" alt="√âtape 11"></p><br>
<h2 id="podklyuchaem-lokalizaciyu"> </h2><br>
<p>     </p><br>
<p>   /src/components/index.js</p><br>
<pre><code class="plaintext hljs">export * from './Localei18n'</code></pre><br>
<p>C   /src/components/Localei18n/index.js  </p><br>
<pre><code class="plaintext hljs">import { NativeModules, Platform } from 'react-native'<font></font>
import { I18n } from '@aws-amplify/core'<font></font>
<font></font>
let langRegionLocale = 'en_US'<font></font>
<font></font>
// If we have an Android phone<font></font>
if (Platform.OS === 'android') {<font></font>
  langRegionLocale = NativeModules.I18nManager.localeIdentifier || ''<font></font>
} else if (Platform.OS === 'ios') {<font></font>
  langRegionLocale = NativeModules.SettingsManager.settings.AppleLocale || ''<font></font>
}<font></font>
<font></font>
const authScreenLabels = {<font></font>
  en: {<font></font>
    'Sign Up': 'Create new account',<font></font>
    'Sign Up Account': 'Create a new account'<font></font>
  },<font></font>
  ru: {<font></font>
    'Sign Up': ' ',<font></font>
    'Forgot Password': ' ?',<font></font>
    'Sign In Account': '  ',<font></font>
    'Enter your email': ' email',<font></font>
    'Enter your password': ' ',<font></font>
    Password: '',<font></font>
    'Sign In': '',<font></font>
    'Please Sign In / Sign Up': ' /  ',<font></font>
    'Sign in to your account': '   ',<font></font>
    'Create a new account': 'C  ',<font></font>
    'Confirm a Code': ' ',<font></font>
    'Confirm Sign Up': ' ',<font></font>
    'Resend code': '  ',<font></font>
    'Back to Sign In': '  ',<font></font>
    Confirm: '',<font></font>
    'Confirmation Code': ' ',<font></font>
    'Sign Out': ''<font></font>
  }<font></font>
}<font></font>
<font></font>
// "en_US" -&gt; "en", "es_CL" -&gt; "es", etc<font></font>
const languageLocale = langRegionLocale.substring(0, 2)<font></font>
I18n.setLanguage(languageLocale)<font></font>
I18n.putVocabularies(authScreenLabels)<font></font>
<font></font>
const Localei18n = () =&gt; null<font></font>
<font></font>
export { Localei18n }</code></pre><br>
<p>   Localei18n  src/index.js</p><br>
<pre><code class="plaintext hljs">import {<font></font>
   AmplifyTheme,<font></font>
   Localei18n<font></font>
} from './components'<font></font>
<font></font>
&lt;Localei18n /&gt;<font></font>
&lt;Authenticator<font></font>
  usernameAttributes="email"<font></font>
  signUpConfig={signUpConfig}<font></font>
  theme={AmplifyTheme}<font></font>
/&gt;</code></pre><br>
<p> ,  ,     .         </p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/7a9/2dc/012/7a92dc0124f6ed4c2ffa5f9b66373277.png" alt="Localei18n"></p><br>
<h2 id="done">Done</h2><br>
<h1 id="chast-ii"> II</h1><br>
<p>-  UI  Amplify     UX    </p><br>
<p>-  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"> </a> Amplify :</p><br>
<blockquote>Data is stored unencrypted when using standard storage adapters (localStorage in the browser and AsyncStorage on React Native). Amplify gives you the option to use your own storage object to persist data. With this, you could write a thin wrapper around libraries like:<br>
react-native-keychain<br>
react-native-secure-storage<br>
Expo‚Äôs secure store</blockquote><p> ,        ,         ,         .</p><br>
<p>        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">GitHub</a>.</p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/a85/330/557/a85330557d5a036dd7641c8dcaa8d8a8.gif" alt="AWS Amplify"></a></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/942/0e0/a51/9420e0a51c7b345d8fa5d5e29d760ea0.png" alt="√âtape01"></p><br>
<h2 id="ui-kit">UI Kit</h2><br>
<p>    UI Kit,          .</p><br>
<p>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"></a> .</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/631/e00/e86/631e00e866d9fc3d76c43b97781ae3b4.png" alt="√âtape 02"></p><br>
<h2 id="navigaciya-react-navigation"> react-navigation</h2><br>
<p>  react-navigation 5,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"></a> (    ):</p><br>
<pre><code class="bash hljs">yarn add react-native-reanimated react-native-gesture-handler react-native-screens react-native-safe-area-context @react-native-community/masked-view @react-navigation/stack</code></pre><br>
<p>   iOS</p><br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> ios &amp;&amp; pod install &amp;&amp; <span class="hljs-built_in">cd</span> ..</code></pre><br>
<p>       iOS  Android,      -   .</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/9eb/aa1/4a1/9ebaa14a1b87631ab663427182eb87cd.png" alt="√âtape03"></p><br>
<h2 id="react-native-keychain">react-native-keychain</h2><br>
<p>  react-native-keychain ‚Äî     react-native-keychain  React Native.</p><br>
<pre><code class="bash hljs">yarn add react-native-keychain</code></pre><br>
<p>   iOS</p><br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> ios &amp;&amp; pod install &amp;&amp; <span class="hljs-built_in">cd</span> ..</code></pre><br>
<p> ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"> </a>:</p><br>
<blockquote>    AWS Amplify      Amazon Cognito .      .  ,   IdToken  AccessToken,   localStorage     AsyncStorage  React Native.             Amplify   ,           .</blockquote><p>  src/index.js</p><br>
<pre><code class="plaintext hljs">import React from 'react'<font></font>
import Amplify from '@aws-amplify/core'<font></font>
import * as Keychain from 'react-native-keychain'<font></font>
import { ThemeProvider, DarkTheme, LightTheme } from 'react-native-unicorn-uikit'<font></font>
import { useColorScheme } from 'react-native-appearance'<font></font>
import AppNavigator from './AppNavigator'<font></font>
import awsconfig from '../aws-exports'<font></font>
<font></font>
const MEMORY_KEY_PREFIX = '@MyStorage:'<font></font>
let dataMemory = {}<font></font>
<font></font>
class MyStorage {<font></font>
  static syncPromise = null<font></font>
<font></font>
  static setItem(key, value) {<font></font>
    Keychain.setGenericPassword(MEMORY_KEY_PREFIX + key, value)<font></font>
    dataMemory[key] = value<font></font>
    return dataMemory[key]<font></font>
  }<font></font>
<font></font>
  static getItem(key) {<font></font>
    return Object.prototype.hasOwnProperty.call(dataMemory, key) ? dataMemory[key] : undefined<font></font>
  }<font></font>
<font></font>
  static removeItem(key) {<font></font>
    Keychain.resetGenericPassword()<font></font>
    return delete dataMemory[key]<font></font>
  }<font></font>
<font></font>
  static clear() {<font></font>
    dataMemory = {}<font></font>
    return dataMemory<font></font>
  }<font></font>
}<font></font>
<font></font>
Amplify.configure({<font></font>
  ...awsconfig,<font></font>
  Analytics: {<font></font>
    disabled: false<font></font>
  },<font></font>
  storage: MyStorage<font></font>
})<font></font>
<font></font>
const App = () =&gt; {<font></font>
  const scheme = useColorScheme()<font></font>
  return (<font></font>
    &lt;&gt;<font></font>
      &lt;ThemeProvider theme={scheme === 'dark' ? DarkTheme : LightTheme}&gt;<font></font>
        &lt;AppNavigator /&gt;<font></font>
      &lt;/ThemeProvider&gt;<font></font>
    &lt;/&gt;<font></font>
  )<font></font>
}<font></font>
<font></font>
export default App</code></pre><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/af4/70f/d98/af470fd981fa96a00da9992a9a7e6924.png" alt="√âtape 04"></p><br>
<h2 id="konstanty"></h2><br>
<p>       ,           src/constants.js</p><br>
<pre><code class="plaintext hljs">import { Dimensions } from 'react-native'<font></font>
<font></font>
export const BG = '#0B0B0B'<font></font>
export const PINK = '#F20AF5'<font></font>
export const PURPLE = '#7A1374'<font></font>
export const BLUE = '#00FFFF'<font></font>
export const GREEN = '#2E7767'<font></font>
export const RED = '#FC2847'<font></font>
export const LABEL_COLOR = BLUE<font></font>
export const INPUT_COLOR = PINK<font></font>
export const ERROR_COLOR = RED<font></font>
export const HELP_COLOR = '#999999'<font></font>
export const BORDER_COLOR = BLUE<font></font>
export const DISABLED_COLOR = '#777777'<font></font>
export const DISABLED_BACKGROUND_COLOR = '#eeeeee'<font></font>
<font></font>
export const win = Dimensions.get('window')<font></font>
export const W = win.width<font></font>
export const H = win.height<font></font>
<font></font>
export const Device = {<font></font>
  // eslint-disable-next-line<font></font>
  select(variants) {<font></font>
    if (W &gt;= 300 &amp;&amp; W &lt;= 314) return variants.mobile300 || {}<font></font>
    if (W &gt;= 315 &amp;&amp; W &lt;= 341) return variants.iphone5 || {}<font></font>
    if (W &gt;= 342 &amp;&amp; W &lt;= 359) return variants.mobile342 || {}<font></font>
    if (W &gt;= 360 &amp;&amp; W &lt;= 374) return variants.mi5 || {}<font></font>
    if (W &gt;= 375 &amp;&amp; W &lt;= 399) return variants.iphone678 || {}<font></font>
    if (W &gt;= 400 &amp;&amp; W &lt;= 409) return variants.mobile400 || {}<font></font>
    if (W &gt;= 410 &amp;&amp; W &lt;= 414) return variants.googlePixel || {}<font></font>
    if (W &gt;= 415 &amp;&amp; W &lt;= 434) return variants.mobile415 || {}<font></font>
    if (W &gt;= 435 &amp;&amp; W &lt;= 480) return variants.redmiNote5 || {}<font></font>
  }<font></font>
}<font></font>
<font></font>
export const goBack = navigation =&gt; () =&gt; navigation.goBack()<font></font>
<font></font>
export const onScreen = (screen, navigation, obj) =&gt; () =&gt; {<font></font>
  navigation.navigate(screen, obj)<font></font>
}<font></font>
<font></font>
export const goHome = navigation =&gt; () =&gt; navigation.popToTop()()</code></pre><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/d23/840/9a4/d238409a47778024c1f12cd93691c3ab.png" alt="√âtape05"></p><br>
<h2 id="appnavigator">AppNavigator</h2><br>
<p>         src/AppNavigator.js</p><br>
<pre><code class="plaintext hljs">import * as React from 'react'<font></font>
import { createStackNavigator } from '@react-navigation/stack'<font></font>
import { Hello } from './screens/Authenticator'<font></font>
<font></font>
const Stack = createStackNavigator()<font></font>
<font></font>
const AppNavigator = () =&gt; {   <font></font>
  return (<font></font>
    &lt;Stack.Navigator<font></font>
      screenOptions={{<font></font>
        headerShown: false<font></font>
      }}<font></font>
      initialRouteName="HELLO"<font></font>
    &gt;<font></font>
      &lt;Stack.Screen name="HELLO" component={Hello} /&gt;<font></font>
    &lt;/Stack.Navigator&gt;<font></font>
  )<font></font>
}<font></font>
<font></font>
export default AppNavigator</code></pre><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/34b/ec2/c86/34bec2c860805fdf4daca2f36ec985fe.png" alt="√âtape06"></p><br>
<h2 id="hello-screen">Hello screen</h2><br>
<p>       src/screens/Authenticator/index.js</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/942/35a/76b/94235a76b21bd666faad2a2be9dbace2.png" alt="Bonjour √©cran"></p><br>
<p>      </p><br>
<pre><code class="plaintext hljs">export * from './Hello'</code></pre><br>
<p>   src/screens/Authenticator/Hello/index.js</p><br>
<p>  useEffect       ,    true     User,    false    .</p><br>
<pre><code class="plaintext hljs">import React, { useEffect, useState } from 'react'<font></font>
import { Auth } from 'aws-amplify'<font></font>
import * as Keychain from 'react-native-keychain'<font></font>
import { AppContainer, Button, Space, H6 } from 'react-native-unicorn-uikit'<font></font>
import { onScreen } from '../../../constants'<font></font>
<font></font>
const Hello = ({ navigation }) =&gt; {<font></font>
  const [loading, setLoading] = useState(false)<font></font>
  useEffect(() =&gt; {<font></font>
    setLoading(true)<font></font>
    const key = async () =&gt; {<font></font>
      try {<font></font>
        const credentials = await Keychain.getInternetCredentials('auth')<font></font>
<font></font>
        if (credentials) {<font></font>
          const { username, password } = credentials<font></font>
          const user = await Auth.signIn(username, password)<font></font>
          setLoading(false)<font></font>
          user &amp;&amp; onScreen('USER', navigation)()<font></font>
        } else {<font></font>
          setLoading(false)<font></font>
        }<font></font>
      } catch (err) {<font></font>
        console.log('error', err) // eslint-disable-line<font></font>
        setLoading(false)<font></font>
      }<font></font>
    }<font></font>
    key()<font></font>
  }, []) // eslint-disable-line<font></font>
  return (<font></font>
    &lt;AppContainer loading={loading}&gt;<font></font>
      &lt;Space height={200} /&gt;<font></font>
      &lt;Button title="Sign In" onPress={onScreen('SIGN_IN', navigation)} /&gt;<font></font>
      &lt;Space height={10} /&gt;<font></font>
      &lt;H6 title="or" textStyle={{ alignSelf: 'center' }} /&gt;<font></font>
      &lt;Space height={15} /&gt;<font></font>
      &lt;Button title="Sign Up" onPress={onScreen('SIGN_UP', navigation)} /&gt;<font></font>
    &lt;/AppContainer&gt;<font></font>
  )<font></font>
}<font></font>
<font></font>
export { Hello }</code></pre><br>
<p>     .</p><br>
<br>
<h2 id="signup-screen">SignUp screen</h2><br>
<p>   SIGN_UP src/screens/Authenticator/SignUp/index.js,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Auth.signUp</a></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/ae8/966/d5e/ae8966d5e8590e6dbb72da5c187d859d.png" alt="S'inscrire"></p><br>
<pre><code class="plaintext hljs">import React, { useState } from 'react'<font></font>
import { Auth } from 'aws-amplify'<font></font>
import * as Keychain from 'react-native-keychain'<font></font>
import { Formik } from 'formik'<font></font>
import * as Yup from 'yup'<font></font>
import { AppContainer, Space, Button, Input, TextError } from 'react-native-unicorn-uikit'<font></font>
import { onScreen, goBack } from '../../../constants'<font></font>
<font></font>
const SignUp = ({ navigation }) =&gt; {<font></font>
  const [loading, setLoading] = useState(false)<font></font>
  const [error, setError] = useState('')<font></font>
<font></font>
  const _onPress = async (values) =&gt; {<font></font>
    const { email, password, passwordConfirmation } = values<font></font>
    if (password !== passwordConfirmation) {<font></font>
      setError('Passwords do not match!')<font></font>
    } else {<font></font>
      setLoading(true)<font></font>
      setError('')<font></font>
      try {<font></font>
        const user = await Auth.signUp(email, password)<font></font>
        await Keychain.setInternetCredentials('auth', email, password)<font></font>
        user &amp;&amp; onScreen('CONFIRM_SIGN_UP', navigation, { email, password })()<font></font>
        setLoading(false)<font></font>
      } catch (err) {<font></font>
        setLoading(false)<font></font>
        if (err.code === 'UserNotConfirmedException') {<font></font>
          setError('Account not verified yet')<font></font>
        } else if (err.code === 'PasswordResetRequiredException') {<font></font>
          setError('Existing user found. Please reset your password')<font></font>
        } else if (err.code === 'NotAuthorizedException') {<font></font>
          setError('Forgot Password?')<font></font>
        } else if (err.code === 'UserNotFoundException') {<font></font>
          setError('User does not exist!')<font></font>
        } else {<font></font>
          setError(err.code)<font></font>
        }<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
<font></font>
  return (<font></font>
    &lt;&gt;<font></font>
      &lt;AppContainer onPress={goBack(navigation)} title="Sign Up" loading={loading}&gt;<font></font>
        &lt;Space height={80} /&gt;<font></font>
        &lt;Formik<font></font>
          initialValues={{ email: '', password: '', passwordConfirmation: '' }}<font></font>
          onSubmit={(values) =&gt; _onPress(values)}<font></font>
          validationSchema={Yup.object().shape({<font></font>
            email: Yup.string().email().required(),<font></font>
            password: Yup.string().min(6).required(),<font></font>
            passwordConfirmation: Yup.string().min(6).required()<font></font>
          })}<font></font>
        &gt;<font></font>
          {({ values, handleChange, errors, setFieldTouched, touched, isValid, handleSubmit }) =&gt; (<font></font>
            &lt;&gt;<font></font>
              &lt;Input<font></font>
                name="email"<font></font>
                value={values.email}<font></font>
                onChangeText={handleChange('email')}<font></font>
                onBlur={() =&gt; setFieldTouched('email')}<font></font>
                placeholder="E-mail"<font></font>
                touched={touched}<font></font>
                errors={errors}<font></font>
                autoCapitalize="none"<font></font>
              /&gt;<font></font>
              &lt;Input<font></font>
                name="password"<font></font>
                value={values.password}<font></font>
                onChangeText={handleChange('password')}<font></font>
                onBlur={() =&gt; setFieldTouched('password')}<font></font>
                placeholder="Password"<font></font>
                touched={touched}<font></font>
                errors={errors}<font></font>
                secureTextEntry<font></font>
              /&gt;<font></font>
              &lt;Input<font></font>
                name="passwordConfirmation"<font></font>
                value={values.passwordConfirmation}<font></font>
                onChangeText={handleChange('passwordConfirmation')}<font></font>
                onBlur={() =&gt; setFieldTouched('passwordConfirmation')}<font></font>
                placeholder="Password confirm"<font></font>
                touched={touched}<font></font>
                errors={errors}<font></font>
                secureTextEntry<font></font>
              /&gt;<font></font>
              &lt;Space height={30} /&gt;<font></font>
              {error !== '' &amp;&amp; &lt;TextError title={error} textStyle={{ alignSelf: 'center' }} /&gt;}<font></font>
              &lt;Button title="Sign Up" disabled={!isValid} onPress={handleSubmit} formik /&gt;<font></font>
            &lt;/&gt;<font></font>
          )}<font></font>
        &lt;/Formik&gt;<font></font>
      &lt;/AppContainer&gt;<font></font>
    &lt;/&gt;<font></font>
  )<font></font>
}<font></font>
<font></font>
export { SignUp }</code></pre><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/9c9/355/eab/9c9355eabb59b5a4c4f36b4336c5febd.png" alt="√âtape 08"></p><br>
<h2 id="confirmsignup-screen">ConfirmSignUp screen</h2><br>
<p>    ,        ,    .     CONFIRM_SIGN_UP src/screens/Authenticator/ConfirmSignUp/index.js</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/a51/873/7a5/a518737a5a9f8845da5a9e320f9589c2.png" alt="ConfirmSignUp"></p><br>
<pre><code class="plaintext hljs">import React, { useState } from 'react'<font></font>
import { Auth } from 'aws-amplify'<font></font>
import { Formik } from 'formik'<font></font>
import * as Yup from 'yup'<font></font>
import { AppContainer, Button, Space, ButtonLink, TextError, Input } from 'react-native-unicorn-uikit'<font></font>
import { onScreen, goBack } from '../../../constants'<font></font>
<font></font>
const ConfirmSignUp = ({ route, navigation }) =&gt; {<font></font>
  const [loading, setLoading] = useState(false)<font></font>
  const [error, setError] = useState('')<font></font>
<font></font>
  const _onPress = async (values) =&gt; {<font></font>
    setLoading(true)<font></font>
    setError('')<font></font>
    try {<font></font>
      const { code } = values<font></font>
      const { email, password } = route.params<font></font>
      await Auth.confirmSignUp(email, code, { forceAliasCreation: true })<font></font>
      const user = await Auth.signIn(email, password)<font></font>
      user &amp;&amp; onScreen('USER', navigation)()<font></font>
      setLoading(false)<font></font>
    } catch (err) {<font></font>
      setLoading(false)<font></font>
      setError(err.message)<font></font>
      if (err.code === 'UserNotConfirmedException') {<font></font>
        setError('Account not verified yet')<font></font>
      } else if (err.code === 'PasswordResetRequiredException') {<font></font>
        setError('Existing user found. Please reset your password')<font></font>
      } else if (err.code === 'NotAuthorizedException') {<font></font>
        setError('Forgot Password?')<font></font>
      } else if (err.code === 'UserNotFoundException') {<font></font>
        setError('User does not exist!')<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
<font></font>
  const _onResend = async () =&gt; {<font></font>
    try {<font></font>
      const { email } = route.params<font></font>
      await Auth.resendSignUp(email)<font></font>
    } catch (err) {<font></font>
      setError(err.message)<font></font>
    }<font></font>
  }<font></font>
<font></font>
  return (<font></font>
    &lt;&gt;<font></font>
      &lt;AppContainer title="Confirmation" onPress={goBack(navigation)} loading={loading}&gt;<font></font>
        &lt;Formik<font></font>
          initialValues={{ code: '' }}<font></font>
          onSubmit={(values) =&gt; _onPress(values)}<font></font>
          validationSchema={Yup.object().shape({<font></font>
            code: Yup.string().min(6).required()<font></font>
          })}<font></font>
        &gt;<font></font>
          {({ values, handleChange, errors, setFieldTouched, touched, isValid, handleSubmit }) =&gt; (<font></font>
            &lt;&gt;<font></font>
              &lt;Space height={180} /&gt;<font></font>
              &lt;Input<font></font>
                name="code"<font></font>
                value={values.code}<font></font>
                onChangeText={handleChange('code')}<font></font>
                onBlur={() =&gt; setFieldTouched('code')}<font></font>
                placeholder="Insert code"<font></font>
                touched={touched}<font></font>
                errors={errors}<font></font>
              /&gt;<font></font>
              &lt;ButtonLink title="Resend code?" onPress={_onResend} textStyle={{ alignSelf: 'center' }} /&gt;<font></font>
              {error !== 'Forgot Password?' &amp;&amp; &lt;TextError title={error} /&gt;}<font></font>
              &lt;Button title="Confirm" disabled={!isValid} onPress={handleSubmit} formik /&gt;<font></font>
              &lt;Space height={50} /&gt;<font></font>
            &lt;/&gt;<font></font>
          )}<font></font>
        &lt;/Formik&gt;<font></font>
      &lt;/AppContainer&gt;<font></font>
    &lt;/&gt;<font></font>
  )<font></font>
}<font></font>
<font></font>
export { ConfirmSignUp }</code></pre><br>
<h2 id="resendsignup">ResendSignUp</h2><br>
<p>   ,         .     Resend code?    Auth.resendSignUp(userInfo.email)<br>
    </p><br>
<pre><code class="plaintext hljs">Auth.confirmSignUp(email, code, { forceAliasCreation: true })</code></pre><br>
<p>   </p><br>
<pre><code class="plaintext hljs">Auth.signIn(email, password)</code></pre><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/560/ec1/171/560ec1171f5bc79a6dde22f0f344cb58.png" alt="√âtape 09"></p><br>
<h2 id="user-screen">User screen</h2><br>
<p>      USER,    c        src/screens/Authenticator/User/index.js</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/cd9/6c3/76b/cd96c376bb368293f22d215627c466ac.png" alt="√âcran utilisateur"></p><br>
<pre><code class="plaintext hljs">import React, { useState, useEffect } from 'react'<font></font>
import { Auth } from 'aws-amplify'<font></font>
import * as Keychain from 'react-native-keychain'<font></font>
import { AppContainer, Button } from 'react-native-unicorn-uikit'<font></font>
import { goHome } from '../../../constants'<font></font>
<font></font>
const User = ({ navigation }) =&gt; {<font></font>
  const [loading, setLoading] = useState(false)<font></font>
  const [error, setError] = useState('')<font></font>
<font></font>
  useEffect(() =&gt; {<font></font>
    const checkUser = async () =&gt; {<font></font>
      await Auth.currentAuthenticatedUser()<font></font>
    }<font></font>
    checkUser()<font></font>
  })<font></font>
<font></font>
  const _onPress = async () =&gt; {<font></font>
    setLoading(true)<font></font>
    try {<font></font>
      await Auth.signOut()<font></font>
      await Keychain.resetInternetCredentials('auth')<font></font>
      goHome(navigation)()<font></font>
    } catch (err) {<font></font>
      setError(err.message)<font></font>
    }<font></font>
  }<font></font>
<font></font>
  return (<font></font>
    &lt;AppContainer message={error} loading={loading}&gt;<font></font>
      &lt;Button title="Sign Out" onPress={_onPress} /&gt;<font></font>
    &lt;/AppContainer&gt;<font></font>
  )<font></font>
}<font></font>
<font></font>
export { User }</code></pre><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/df8/22a/e04/df822ae04334378b0b39d6bd70bf2513.png" alt="√âtape 10"></p><br>
<h2 id="signin-screen">SignIn screen</h2><br>
<p> ,   ,            .      SIGN_IN src/screens/Authenticator/SignIn/index.js</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/603/4f5/702/6034f57024d57d86448d22469e8ac0be.png" alt="√âcran de connexion"></p><br>
<pre><code class="plaintext hljs">import React, { useState } from 'react'<font></font>
import { Auth } from 'aws-amplify'<font></font>
import * as Keychain from 'react-native-keychain'<font></font>
import { Formik } from 'formik'<font></font>
import * as Yup from 'yup'<font></font>
import { AppContainer, Button, Space, ButtonLink, TextError, Input } from 'react-native-unicorn-uikit'<font></font>
import { onScreen, goBack } from '../../../constants'<font></font>
<font></font>
const SignIn = ({ navigation }) =&gt; {<font></font>
  const [userInfo, setUserInfo] = useState('')<font></font>
  const [loading, setLoading] = useState(false)<font></font>
  const [error, setError] = useState('')<font></font>
<font></font>
  const _onPress = async (values) =&gt; {<font></font>
    setLoading(true)<font></font>
    setError('')<font></font>
    try {<font></font>
      const { email, password } = values<font></font>
      const user = await Auth.signIn(email, password)<font></font>
      await Keychain.setInternetCredentials('auth', email, password)<font></font>
      user &amp;&amp; onScreen('USER', navigation)()<font></font>
      setLoading(false)<font></font>
    } catch (err) {<font></font>
      setLoading(false)<font></font>
      if (err.code === 'UserNotConfirmedException') {<font></font>
        setError('Account not verified yet')<font></font>
      } else if (err.code === 'PasswordResetRequiredException') {<font></font>
        setError('Existing user found. Please reset your password')<font></font>
      } else if (err.code === 'NotAuthorizedException') {<font></font>
        setError('Forgot Password?')<font></font>
      } else if (err.code === 'UserNotFoundException') {<font></font>
        setError('User does not exist!')<font></font>
      } else {<font></font>
        setError(err.code)<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
<font></font>
  return (<font></font>
    &lt;&gt;<font></font>
      &lt;AppContainer onPress={goBack(navigation)} title="Sign In" loading={loading}&gt;<font></font>
        &lt;Space height={140} /&gt;<font></font>
        &lt;Formik<font></font>
          initialValues={{ email: '', password: '' }}<font></font>
          onSubmit={(values) =&gt; _onPress(values) &amp;&amp; setUserInfo(values.email)}<font></font>
          validationSchema={Yup.object().shape({<font></font>
            email: Yup.string().email().required(),<font></font>
            password: Yup.string().min(6).required()<font></font>
          })}<font></font>
        &gt;<font></font>
          {({ values, handleChange, errors, setFieldTouched, touched, isValid, handleSubmit }) =&gt; (<font></font>
            &lt;&gt;<font></font>
              &lt;Input<font></font>
                name="email"<font></font>
                value={values.email}<font></font>
                onChangeText={handleChange('email')}<font></font>
                onBlur={() =&gt; setFieldTouched('email')}<font></font>
                placeholder="E-mail"<font></font>
                touched={touched}<font></font>
                errors={errors}<font></font>
                autoCapitalize="none"<font></font>
              /&gt;<font></font>
              &lt;Input<font></font>
                name="password"<font></font>
                value={values.password}<font></font>
                onChangeText={handleChange('password')}<font></font>
                onBlur={() =&gt; setFieldTouched('password')}<font></font>
                placeholder="Password"<font></font>
                touched={touched}<font></font>
                errors={errors}<font></font>
                secureTextEntry<font></font>
              /&gt;<font></font>
              {error !== 'Forgot Password?' &amp;&amp; &lt;TextError title={error} textStyle={{ alignSelf: 'center' }} /&gt;}<font></font>
              {error === 'Forgot Password?' &amp;&amp; (<font></font>
                &lt;ButtonLink<font></font>
                  title={error}<font></font>
                  onPress={onScreen('FORGOT', navigation, userInfo)}<font></font>
                  textStyle={{ alignSelf: 'center' }}<font></font>
                /&gt;<font></font>
              )}<font></font>
              &lt;Space height={30} /&gt;<font></font>
              &lt;Button title="Sign In" disabled={!isValid} onPress={handleSubmit} formik /&gt;<font></font>
            &lt;/&gt;<font></font>
          )}<font></font>
        &lt;/Formik&gt;<font></font>
      &lt;/AppContainer&gt;<font></font>
    &lt;/&gt;<font></font>
  )<font></font>
}<font></font>
<font></font>
export { SignIn }</code></pre><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/81f/03c/c4c/81f03cc4cf1c819f35f562367e6975d1.png" alt="√âtape 11"></p><br>
<h2 id="forgot-password-screen">Forgot password screen</h2><br>
<p>  ,      USER,     ,         ,     Forgot Password?    .</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/39c/556/be6/39c556be682081bc220a4ae25c147e0a.png" alt="Mot de passe oubli√©"></p><br>
<p>     FORGOT src/screens/Authenticator/Forgot/index.js</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/ec3/e63/053/ec3e630535201998be068fad593bb650.png" alt="Mot de passe oubli√©"></p><br>
<pre><code class="plaintext hljs">import React, { useState } from 'react'<font></font>
import { Auth } from 'aws-amplify'<font></font>
import { Formik } from 'formik'<font></font>
import * as Yup from 'yup'<font></font>
import { AppContainer, Button, Input } from 'react-native-unicorn-uikit'<font></font>
import { onScreen, goBack } from '../../../constants'<font></font>
<font></font>
const Forgot = ({ route, navigation }) =&gt; {<font></font>
  const [loading, setLoading] = useState(false)<font></font>
  const [error, setError] = useState('')<font></font>
<font></font>
  const _onPress = async (values) =&gt; {<font></font>
    setLoading(true)<font></font>
    try {<font></font>
      const { email } = values<font></font>
      const user = await Auth.forgotPassword(email)<font></font>
      user &amp;&amp; onScreen('FORGOT_PASSWORD_SUBMIT', navigation, email)()<font></font>
      setLoading(false)<font></font>
    } catch (err) {<font></font>
      setError(error)<font></font>
    }<font></font>
  }<font></font>
<font></font>
  return (<font></font>
    &lt;&gt;<font></font>
      &lt;AppContainer title="Forgot" onPress={goBack(navigation)} loading={loading}&gt;<font></font>
        &lt;Formik<font></font>
          initialValues={{ email: route.params }}<font></font>
          onSubmit={(values) =&gt; _onPress(values)}<font></font>
          validationSchema={Yup.object().shape({<font></font>
            email: Yup.string().email().required()<font></font>
          })}<font></font>
        &gt;<font></font>
          {({ values, handleChange, errors, setFieldTouched, touched, isValid, handleSubmit }) =&gt; (<font></font>
            &lt;&gt;<font></font>
              &lt;Input<font></font>
                name="email"<font></font>
                value={values.email}<font></font>
                onChangeText={handleChange('email')}<font></font>
                onBlur={() =&gt; setFieldTouched('email')}<font></font>
                placeholder="E-mail"<font></font>
                touched={touched}<font></font>
                errors={errors}<font></font>
                autoCapitalize="none"<font></font>
              /&gt;<font></font>
              &lt;Button title="Confirm" disabled={!isValid} onPress={handleSubmit} formik /&gt;<font></font>
            &lt;/&gt;<font></font>
          )}<font></font>
        &lt;/Formik&gt;<font></font>
      &lt;/AppContainer&gt;<font></font>
    &lt;/&gt;<font></font>
  )<font></font>
}<font></font>
<font></font>
export { Forgot }</code></pre><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/3a2/be6/a51/3a2be6a514a1193ffc38111740b16e3a.png" alt="√âtape12"></p><br>
<h2 id="forgot-password-submit">Forgot Password Submit</h2><br>
<p>  e-mail,    Auth.forgotPassword(email)   ,    ,      FORGOT_PASSWORD_SUBMIT src/screens/Authenticator/ForgotPassSubmit/index.js</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/3b3/32a/335/3b332a33583377b95f9454b26f912259.png" alt="ForgotPassSubmit"></p><br>
<pre><code class="plaintext hljs">import React, { useState } from 'react'<font></font>
import { Platform } from 'react-native'<font></font>
import { Auth } from 'aws-amplify'<font></font>
import * as Keychain from 'react-native-keychain'<font></font>
import { Formik } from 'formik'<font></font>
import * as Yup from 'yup'<font></font>
import { AppContainer, Button, Space, Input, TextError } from 'react-native-unicorn-uikit'<font></font>
import { onScreen, goBack } from '../../../constants'<font></font>
<font></font>
const ForgotPassSubmit = ({ route, navigation }) =&gt; {<font></font>
  const [loading, setLoading] = useState(false)<font></font>
  const [error, setError] = useState('')<font></font>
<font></font>
  const _onPress = async (values) =&gt; {<font></font>
    setLoading(true)<font></font>
    try {<font></font>
      const { email, code, password } = values<font></font>
      await Auth.forgotPasswordSubmit(email, code, password)<font></font>
      await Keychain.setInternetCredentials('auth', email, password)<font></font>
      onScreen('USER', navigation)()<font></font>
      setLoading(false)<font></font>
    } catch (err) {<font></font>
      setLoading(false)<font></font>
      setError(err.message)<font></font>
    }<font></font>
  }<font></font>
<font></font>
  return (<font></font>
    &lt;&gt;<font></font>
      &lt;AppContainer title="Confirmation" onPress={goBack(navigation)} loading={loading}&gt;<font></font>
        &lt;Space height={Platform.OS === 'ios' ? 20 : 150} /&gt;<font></font>
        &lt;Formik<font></font>
          initialValues={{ email: route.params, code: '', password: '', passwordConfirmation: '' }}<font></font>
          onSubmit={(values) =&gt; _onPress(values)}<font></font>
          validationSchema={Yup.object().shape({<font></font>
            email: Yup.string().email().required(),<font></font>
            code: Yup.string().min(6).required(),<font></font>
            password: Yup.string().min(6).required(),<font></font>
            passwordConfirmation: Yup.string().min(6).required()<font></font>
          })}<font></font>
        &gt;<font></font>
          {({ values, handleChange, errors, setFieldTouched, touched, isValid, handleSubmit }) =&gt; (<font></font>
            &lt;&gt;<font></font>
              &lt;Input<font></font>
                name="email"<font></font>
                value={values.email}<font></font>
                onChangeText={handleChange('email')}<font></font>
                onBlur={() =&gt; setFieldTouched('email')}<font></font>
                placeholder="E-mail"<font></font>
                touched={touched}<font></font>
                errors={errors}<font></font>
                autoCapitalize="none"<font></font>
              /&gt;<font></font>
              &lt;Input<font></font>
                name="code"<font></font>
                value={values.code}<font></font>
                onChangeText={handleChange('code')}<font></font>
                onBlur={() =&gt; setFieldTouched('code')}<font></font>
                placeholder="Code"<font></font>
                touched={touched}<font></font>
                errors={errors}<font></font>
              /&gt;<font></font>
              &lt;Input<font></font>
                name="password"<font></font>
                value={values.password}<font></font>
                onChangeText={handleChange('password')}<font></font>
                onBlur={() =&gt; setFieldTouched('password')}<font></font>
                placeholder="Password"<font></font>
                touched={touched}<font></font>
                errors={errors}<font></font>
                secureTextEntry<font></font>
              /&gt;<font></font>
              &lt;Input<font></font>
                name="passwordConfirmation"<font></font>
                value={values.passwordConfirmation}<font></font>
                onChangeText={handleChange('passwordConfirmation')}<font></font>
                onBlur={() =&gt; setFieldTouched('passwordConfirmation')}<font></font>
                placeholder="Password confirm"<font></font>
                touched={touched}<font></font>
                errors={errors}<font></font>
                secureTextEntry<font></font>
              /&gt;<font></font>
              {error !== '' &amp;&amp; &lt;TextError title={error} textStyle={{ alignSelf: 'center' }} /&gt;}<font></font>
              &lt;Space height={30} /&gt;<font></font>
              &lt;Button title="Confirm" disabled={!isValid} onPress={handleSubmit} formik /&gt;<font></font>
            &lt;/&gt;<font></font>
          )}<font></font>
        &lt;/Formik&gt;<font></font>
      &lt;/AppContainer&gt;<font></font>
    &lt;/&gt;<font></font>
  )<font></font>
}<font></font>
<font></font>
export { ForgotPassSubmit }</code></pre><br>
<p>   ,   ,     ,     </p><br>
<pre><code class="plaintext hljs">Auth.forgotPasswordSubmit(email, code, password)</code></pre><br>
<p>      USER.</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/e0a/e7c/f83/e0ae7cf835073155c02c00d537d335fd.png" alt="√âtape 13"></p><br>
<h2 id="svyazyvanie-ekranov"> </h2><br>
<p>     src/screens/Authenticator/index.js</p><br>
<pre><code class="plaintext hljs">export * from './Hello'<font></font>
export * from './User'<font></font>
export * from './SignIn'<font></font>
export * from './SignUp'<font></font>
export * from './Forgot'<font></font>
export * from './ForgotPassSubmit'<font></font>
export * from './ConfirmSignUp'</code></pre><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/f21/101/ea7/f21101ea74d3f57f1691aacb625d707a.png" alt="√âtape 14"></p><br>
<h2 id="udpate-appnavigator">Udpate AppNavigator</h2><br>
<p>   :</p><br>
<pre><code class="plaintext hljs">import * as React from 'react'<font></font>
import { createStackNavigator } from '@react-navigation/stack'<font></font>
import { Hello, SignUp, SignIn, ConfirmSignUp, User, Forgot, ForgotPassSubmit } from './screens/Authenticator'<font></font>
<font></font>
const Stack = createStackNavigator()<font></font>
<font></font>
const AppNavigator = () =&gt; {<font></font>
  return (<font></font>
    &lt;Stack.Navigator<font></font>
      screenOptions={{<font></font>
        headerShown: false<font></font>
      }}<font></font>
      initialRouteName="HELLO"<font></font>
    &gt;<font></font>
      &lt;Stack.Screen name="HELLO" component={Hello} /&gt;<font></font>
      &lt;Stack.Screen name="SIGN_UP" component={SignUp} /&gt;<font></font>
      &lt;Stack.Screen name="SIGN_IN" component={SignIn} /&gt;<font></font>
      &lt;Stack.Screen name="FORGOT" component={Forgot} /&gt;<font></font>
      &lt;Stack.Screen name="FORGOT_PASSWORD_SUBMIT" component={ForgotPassSubmit} /&gt;<font></font>
      &lt;Stack.Screen name="CONFIRM_SIGN_UP" component={ConfirmSignUp} /&gt;<font></font>
      &lt;Stack.Screen name="USER" component={User} /&gt;<font></font>
    &lt;/Stack.Navigator&gt;<font></font>
  )<font></font>
}<font></font>
<font></font>
export default AppNavigator</code></pre><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/e7a/ab6/a44/e7aab6a44c55db24e7571c547fe90434.png" alt="√âtape15"></p><br>
<h2 id="clean-up">Clean Up</h2><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puisque nous utilisons un th√®me personnalis√©, nous supprimons les composants AmplifyTheme et Localei18n</font></font></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/8f1/aed/fbf/8f1aedfbf2e71d312601354edb707715.png" alt="√âtape 16"></p><br>
<h2 id="debug"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©boguer</font></font></h2><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Afin de comprendre ce qui se passe avec les jetons dans votre application, ajoutez √† la racine /index.js</font></font></p><br>
<pre><code class="plaintext hljs">window.LOG_LEVEL = 'DEBUG'</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous lan√ßons l'application et obtenons une authentification personnalis√©e.</font></font></p><br>
<h2 id="done-1"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Termin√©</font></font></h2><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour continuer la rubrique, consultez l'article </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DataStore - CRUD (Cr√©er Lecture Mettre √† jour Supprimer)</font></font></a></p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/00c/16d/925/00c16d925fd0bca08a5442812fa02fbf.png" alt="Devenez m√©c√®ne!"></a></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr504314/index.html">Impl√©mentation des commandes Docker Pull et Docker Push sans client Docker via des requ√™tes HTTP</a></li>
<li><a href="../fr504320/index.html">Code de ligne unique ou validation Nethermind √† l'aide de PVS-Studio C # pour Linux</a></li>
<li><a href="../fr504326/index.html">Evgeny Dikiy: ¬´Localement, l'Antarctique a √©t√© le moins sali, mais la pollution mondiale est tr√®s visible ici¬ª</a></li>
<li><a href="../fr504328/index.html">Cours de vote √©lectronique √† la Douma de Moscou 2019</a></li>
<li><a href="../fr504334/index.html">–ù–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –≤—ã –∑–Ω–∞–µ—Ç–µ JavaScript?</a></li>
<li><a href="../fr504348/index.html">Monowheel: ce qui se passe pendant l'entra√Ænement et comment acc√©l√©rer ce processus</a></li>
<li><a href="../fr504352/index.html">Dix entreprises que Figma a aid√© √† atteindre de nouveaux r√©sultats de conception et plus encore</a></li>
<li><a href="../fr504354/index.html">R√©duisez la taille du mod√®le ML sans inscription ni SMS</a></li>
<li><a href="../fr504356/index.html">PHP 8 en huit morceaux de code</a></li>
<li><a href="../fr504358/index.html">PuppetConf 2016. Kubernetes pour les administrateurs syst√®me. Partie 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>