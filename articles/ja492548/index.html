<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✌🏽 🤼 🍠 Unity Machine Learning：MOエージェントに壁を飛び越えるように教える ✍🏼 🖥️ ⚔️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="生のピクセルトレーニングでの強化学習（RL）の最初の使用からOpen AI Roboristsのトレーニングまで、過去数年間で強化学習（RL）に大きな進歩があり、さらなる進歩のためにますます高度な環境が必要です。団結が来る。
 
 Unity ML-Agentsツールは、Unityゲームエンジンの新...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Unity Machine Learning：MOエージェントに壁を飛び越えるように教える</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pixonic/blog/492548/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生のピクセルトレーニングでの強化学習（RL）の最初の使用からOpen AI Roboristsのトレーニングまで、過去数年間で強化学習（RL）に大きな進歩があり、さらなる進歩のためにますます高度な環境が必要です。団結が来る。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unity ML-Agentsツールは、Unityゲームエンジンの新しいプラグインであり、MOエージェントをトレーニングするための環境コンストラクターとしてUnityを使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unity ML-Agents Toolkitは、サッカーからウォーキング、壁からのジャンプ、AI犬のトレーニングからスティックのプレイまで、エージェントのトレーニングにさまざまな条件を提供します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、Unity MOエージェントがどのように機能するかを見て、これらのエージェントの1つが壁を飛び越えるように教えます。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/9c6/5ad/bdb/9c65adbdbb38b939262c10e5ac728dde.gif" alt="画像"><br>
<br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unity ML-Agentsとは何ですか？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unity ML-Agentsは、Unityゲームエンジンの新しいプラグインであり、エージェントをトレーニングするための既成の環境を作成または使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プラグインは3つのコンポーネントで構成されています</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zo/mx/m_/zomxm_3g9svsej0iarjpw1vbnta.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。最初の</font><font style="vertical-align: inherit;">コンポーネント</font><font style="vertical-align: inherit;">-Unityのシーンと環境要素を含む</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">学習環境</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Learning Environment</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2つ目は、</font><font style="vertical-align: inherit;">RLアルゴリズム（PPO-近位ポリシー最適化やSAC-Soft Actor-Criticなど）を含む</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python API</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">このAPIを使用して、トレーニング、テストなどを開始します。これは、3番目のコンポーネントで</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ある外部コミュニケーター</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を通じて学習環境に接続され</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">学習環境の構成</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トレーニングコンポーネントはさまざまな要素で構成されています</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/hy/1u/pt/hy1upt9en2esnt-amk-iipklmn4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。最初のエージェントは舞台俳優です。</font><font style="vertical-align: inherit;">「脳」と呼ばれるコンポーネントを最適化することによってトレーニングするのは彼です。そこでは、可能な各状態で実行する必要があるアクションが記録されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3番目の要素であるアカデミーは、エージェントとその意思決定プロセスを管理し、Python APIからのリクエストを処理します。</font><font style="vertical-align: inherit;">その役割をよりよく理解するために、RLプロセスを思い出してみましょう。</font><font style="vertical-align: inherit;">これは、次のように機能するサイクルとして表すことができ</font></font><br>
<br>
<img src="https://habrastorage.org/webt/5y/ge/ef/5ygeefzasafou6bkwggdnaq7ows.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ます。エージェントがプラットフォーマーの遊び方を学ぶ必要があるとします。</font><font style="vertical-align: inherit;">この場合のRLプロセスは次のようになります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エージェントは</font><font style="vertical-align: inherit;">環境から</font><font style="vertical-align: inherit;">状態</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></sub></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を受け取り</font><font style="vertical-align: inherit;">ます-これがゲームの最初のフレームになります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状態</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0に</font></font></sub></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基づいて</font><i><sub><font style="vertical-align: inherit;">、</font></sub></i><font style="vertical-align: inherit;">エージェントはアクション</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></sub></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">実行</font><font style="vertical-align: inherit;">し、右にシフトします。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">環境は新しい状態</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1になり</font></font></sub></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エージェントは</font><font style="vertical-align: inherit;">死んでいないことに対して</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1の</font></font></sub></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">報酬</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">受け取ります</font><font style="vertical-align: inherit;">（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正の報酬</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> +1）。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このRLサイクルは、状態、アクション、および報酬のシーケンスを形成します。</font><font style="vertical-align: inherit;">エージェントの目標は、予想される総報酬を最大化することです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qm/mr/ml/qmmrmlkz7urj8cywqpsg1ejajve.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、アカデミーはエージェントに指示を送信し、エージェントの実行に同期を提供します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">観察の収集;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定められた指示に従った行動の選択;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アクションの実行。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステップ数に到達した場合、または目標に到達した場合はリセットします。</font></font></li>
</ul><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちはエージェントに壁を飛び越えるように教えます</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unityエージェントの動作がわかったので、壁を飛び越えるようにトレーニングします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トレーニング済みのモデルは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHubから</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ダウンロードすることもできます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">壁跳び学習環境</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この環境の目標は、エージェントに緑のタイルにたどり着くことを教えることです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の3つのケースを検討してください</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。1.壁がなく、エージェントはタイルに到達する必要があるだけです。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/17a/8fd/da8/17a8fdda8bbe767f64a34d8d05fd9be9.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2.エージェントは、緑のタイルに到達するためにジャンプする方法を学ぶ必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/d2c/149/0d0/d2c1490d0b90c4fdefb8eb4922f446b2.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3.最も困難なケース：エージェントがジャンプするには壁が高すぎるため、最初に白いブロックにジャンプする必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/458/175/9b6/4581759b653a175597054fcf60a0050e.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
壁の高さに応じて、エージェントに2つの行動シナリオを教えます。</font></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">壁がない場合、または壁の高さが低い場合の</font><i><font style="vertical-align: inherit;">SmallWallJump</font></i><font style="vertical-align: inherit;">。</font></font></li>
<li><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高い壁の場合は</font><i><font style="vertical-align: inherit;">BigWallJump</font></i><font style="vertical-align: inherit;">。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
報酬システムは次のようになります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rt/lo/hm/rtlohmnturcucyikrnhfsadztgi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの観察では、通常のフレームを使用していませんが、14個のレイキャストを使用しています。それぞれが4つのオブジェクトを検出できます。</font><font style="vertical-align: inherit;">この場合、レイカストは、オブジェクトを通過するかどうかを判断できるレーザービームとして認識されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プログラムではグローバルエージェントの役職も使用します。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/a06/0fc/fa2/a060fcfa26e80154ef988d76dc9b8f05.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの空間では4つのオプションが可能です</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ni/g6/zs/nig6zskfzterisy_hskg3k-rsnk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。目標は</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、平均報酬が0.8の</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グリーンタイルを達成すること</font><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それでは始めましょう！</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UnitySDK</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクトを開き</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例の中から、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WallJump</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シーンを見つけて開く必要があります</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、ステージには多くのエージェントがおり、それぞれが同じプレハブから取得され、すべて同じ「頭脳」を持っています。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/bad/195/820/bad195820da3e5b2c74309e9f44e9935.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
従来のディープレインフォースメントラーニングの場合と同様に、ゲームのいくつかのインスタンス（128の並列環境など）を起動した後、エージェントをコピーして貼り付けるだけで、さまざまな状態にできます。また、エージェントを最初からトレーニングしたいので、まずエージェントから「頭脳」を取り除く必要があります。これを行うには、prefabsフォルダーに移動してPrefabを開きます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、プレハブ階層で、エージェントを選択して設定に移動する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Behavior Parametersで、モデルを削除する必要があります。複数のGPUを使用できる場合は、CPUからの推論デバイスをGPUとして使用できます。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/d0d/bdb/6ec/d0dbdb6ec05655b6fecdf675d629d126.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
壁ジャンプエージェントコンポーネントでは、壁のないケース、および低い壁と高い壁の脳を削除する必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/618/e81/c8c/618e81c8c3c0cb15ae5fbca791c33c8c.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、エージェントのトレーニングを最初から開始できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初のトレーニングでは、2つの動作シナリオ（SmallWallJumpとBigWallJump）のトレーニングステップの総数を変更するだけです。したがって、30万ステップで目標を達成できます。これを行うには、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">config / trainer config.yamlで</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、SmallWallJumpおよびBigWallJumpケースのmax_stepsを3e5 </font><i><font style="vertical-align: inherit;">に</font></i><font style="vertical-align: inherit;">変更します。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/b80/bbb/1b2/b80bbb1b21f0f9e445fa8d2583c39d52.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エージェントをトレーニングするために、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PPO</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（近位ポリシー最適化）</font><font style="vertical-align: inherit;">を使用します</font><font style="vertical-align: inherit;">。このアルゴリズムには、環境との対話とそれを使用して意思決定ポリシーを更新する経験の蓄積が含まれます。更新後、以前のイベントは破棄され、後続のデータ収集は、更新されたポリシーの条件に基づいてすでに実行されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、最初にPython APIを使用して、外部コミュニケーターを呼び出して、アカデミーにエージェントを起動するように指示する必要があります。これを行うには、ml-agents-masterが配置されているターミナルを開いて入力します。</font></font><br>
<br>
<code>mlagents-learn config/trainer_config.yaml — run-id=”WallJump_FirstTrain” — train</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このコマンドでは、Unityシーンを開始するように求められます。これを行うには、エディターの上部にある►を押します。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/212/874/4fb/2128744fb143fec6308d95938e0383f7.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のコマンドを使用して、Tensorboardでエージェントのトレーニングを監視できます。</font></font><br>
<br>
<code>tensorboard — logdir=summaries</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トレーニングが終了したら、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ml-agents-master / modelsに</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">含まれている保存済みのモデルファイル</font><i><font style="vertical-align: inherit;">をUnitySDK / Assets / ML-Agents / examples / WallJump / TFModels</font></i><font style="vertical-align: inherit;">に移動する必要があります</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">次に、Unityエディターを再度開き、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WallJump</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シーンを選択し</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ここで、完成した</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WallJumpArea</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オブジェクトを開きます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、エージェントを選択し、その動作パラメーターで</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SmallWallJump.nn</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><font style="vertical-align: inherit;">をモデルプレースホルダーに</font><font style="vertical-align: inherit;">ドラッグします</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/d0d/bdb/6ec/d0dbdb6ec05655b6fecdf675d629d126.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また移動：</font></font><br>
<br>
<ol>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SmallWallJump.nn</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（No Wall Brainプレースホルダー）。</font></font></li>
<li><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Small Wall Brainプレースホルダーの</font><i><font style="vertical-align: inherit;">SmallWallJump.nn</font></i><font style="vertical-align: inherit;">。</font></font></li>
<li><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No Wall Brainプレースホルダーの</font><i><font style="vertical-align: inherit;">BigWallJump.nn</font></i><font style="vertical-align: inherit;">。</font></font></li>
</ol><br>
<img src="https://habrastorage.org/getpro/habr/post_images/618/e81/c8c/618e81c8c3c0cb15ae5fbca791c33c8c.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、エディターの上部にある►ボタンを押すと完了です。</font><font style="vertical-align: inherit;">これで、エージェントトレーニング構成アルゴリズムが完了しました。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/9c6/5ad/bdb/9c65adbdbb38b939262c10e5ac728dde.gif" alt="画像"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実験時間</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
学ぶための最良の方法は、常に何か新しいものを持って来ることを試みることです。</font><font style="vertical-align: inherit;">これで良い結果が得られたので、いくつかの仮説を立ててテストしてみましょう。</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">割引係数を0.95に引き下げる</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
だから私たちはそれを知っています：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ガンマが大きいほど、割引率は低くなります。</font><font style="vertical-align: inherit;">つまり、エージェントは長期的な報酬に対してより関心があります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一方、ガンマが小さいほど、割引率は高くなります。</font><font style="vertical-align: inherit;">この場合、エージェントの優先順位は短期補償です。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この実験の考え方は、色域を0.99から0.95に減らして割引を増やした場合、短期的な報酬がエージェントの優先事項となり、エージェントが最適な行動ポリシーにすばやくアプローチできるようになる可能性があるということです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/u_/cm/hv/u_cmhvpc0dk-npolzz49loxofiq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
興味深いことに、低い壁を飛び越えた場合、エージェントは同じ結果を目指します。</font><font style="vertical-align: inherit;">これは、このケースが非常に単純であるという事実で説明できます。エージェントは緑のタイルに移動し、必要に応じて、正面に壁がある場合はジャンプする必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yc/ic/tt/ycicttb0mkwxmwn5c1ghgm2iiiu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一方、ビッグウォールジャンプの場合、エージェントは短期的な報酬を重視するため、壁を飛び越えるために白いブロックに登る必要があることを理解していないため、これはさらにうまくいきません。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ニューラルネットワークの複雑さの増加</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に、ニューラルネットワークの複雑さが増すと、エージェントがよりスマートになるかどうかを仮定します。</font><font style="vertical-align: inherit;">これを行うには、非表示レベルのサイズを256から512に増やし</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ます。この場合、新しいエージェントは最初のエージェントよりもうまく機能しません。</font><font style="vertical-align: inherit;">これは、ネットワークの複雑さを増すことは意味をなさないことを意味します。そうしないと、学習時間が増加するからです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zo/g7/qm/zog7qm1uemu7l7taqc5uuwlqauw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それで、壁を飛び越えるようにエージェントを訓練しました、そしてそれは今日のすべてです。</font><font style="vertical-align: inherit;">結果を比較するために、トレーニング済みモデルを</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここから</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ダウンロードできることを思い出して</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ください</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/af6/f00/ce3/af6f00ce3784c60469522296276d2651.gif" alt="画像"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja492530/index.html">UIKit開発者向けのUIKitおよびSwiftUIアプリケーションでの結合ベースのMVVM</a></li>
<li><a href="../ja492534/index.html">それで、モスクワに本当のハリケーンがあるかどうか？2020年3月13日の事件を熱く追求して分析</a></li>
<li><a href="../ja492538/index.html">Wrike TechClub：配信インフラストラクチャ-プロセスとツール（DevOps + QAA）。英語の論文</a></li>
<li><a href="../ja492540/index.html">ゲーム「ちょっと待って！」Arduinoで</a></li>
<li><a href="../ja492546/index.html">Niktoを使用して任意のサイトの脆弱性をチェックする</a></li>
<li><a href="../ja492552/index.html">バルセロナで検疫に住み、働く方法</a></li>
<li><a href="../ja492558/index.html">こんにちは、COVID19です。コロナウイルスはスマートフォンの表面に住んでいますか？</a></li>
<li><a href="../ja492560/index.html">GPUの単純なハッシュテーブル</a></li>
<li><a href="../ja492562/index.html">検疫プログラムにおける3つの有用なApache Ignite Webセミナー</a></li>
<li><a href="../ja492566/index.html">貪欲なクリック検索アルゴリズムとグラフ頂点の部分的な列挙の組み合わせの分析</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>