<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚭 🌚 👨‍👨‍👧‍👧 How to tidy up the history of your commits in Git 👨🏿‍🏫 😈 🚸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We are publishing a translation of the article we found on hackernoon.com. Its author, Thiago Miranda, writes on how to make working with Git more con...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>How to tidy up the history of your commits in Git</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/plarium/blog/495328/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We are publishing a translation of the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> we found on hackernoon.com. </font><font style="vertical-align: inherit;">Its author, Thiago Miranda, writes on how to make working with Git more convenient and efficient.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8d/te/0l/8dte0lg4fpm97opp8yw1gnciofu.png"><a name="habracut"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">About some extremely useful commands in Git</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For the last month I have been doing pair programming and created several hundred commits in Git. </font><font style="vertical-align: inherit;">In the article, I will share the most important of what I learned during this time: I will talk about working with the history of commits, about successful techniques and how to implement them using a dozen teams.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. What is the story in Git?</font></font></h4><br>
<img src="https://habrastorage.org/webt/w0/dp/hx/w0dphxq581mzm3p2fnn98h6txw0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An accurate register of all commits containing changes made to files. </font><font style="vertical-align: inherit;">In it, you can track specific changes and the time they were made, or compare the current version with the previous one. </font><font style="vertical-align: inherit;">Where to see the story? </font><font style="vertical-align: inherit;">Enter the command through Git Bash:</font></font><br>
<br>
<pre><code class="bash hljs">git <span class="hljs-built_in">log</span> --oneline</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you have too many commits, you can switch from one comment to another using the arrow keys or the Page Up / Page Down keys - just like in any other file. </font><font style="vertical-align: inherit;">To exit, press the hot key (q).</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. About comments on commits</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Do not write meaningless comments, they should be concise and not requiring explanation. </font><font style="vertical-align: inherit;">Their task is to indicate what changes you have made to the code and what they affect.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How not to: "Fixed index.html"</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to: "Improved the speed of the navigation bar"</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's see what this is for. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imagine that you are working on such a large-scale project that most of the specialists employed in it do not even know. </font><font style="vertical-align: inherit;">You develop a new feature, test it on your equipment, and everything works fine. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But after a push everything suddenly stops working, and the first thing you check is the changes made during the development of this feature. </font><font style="vertical-align: inherit;">In the Git log, you find a lot of commits with comments in the "fixed" style. </font><font style="vertical-align: inherit;">Imagine how much time you have to spend on finding the right one!</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Always make commits</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Commits, commits, and again commits. </font><font style="vertical-align: inherit;">Finished the function - add a commit, improved the style of a block element - add a commit and so on. </font><font style="vertical-align: inherit;">Ideally, you should send a commit with every change. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perhaps you are thinking: why are there so many commits? </font><font style="vertical-align: inherit;">The main reason is that your new functionality may conflict with someone else’s code, but if you always commit small changes, finding and fixing them will be easier. </font><font style="vertical-align: inherit;">This saves you time by tracking dozens or hundreds of lines modified in the same commit.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Correct the last comment on the commit</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What if, after adding a small commit to your local repository, you want to correct the typo or make a comment on the commit in more detail? </font><font style="vertical-align: inherit;">Making changes is fairly simple with the command:</font></font><br>
<br>
<pre><code class="bash hljs">git commit -m “correct message” --amend</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Please note: if you have already started committing to a remote repository, this command is better not to use. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
See </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">official documentation for</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> details </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Combine the last X commits into one</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Situation: sending a commit to a new feature, you understand that you need one more small change, make minimal changes and commit again ... As a result, 5 commits are about the same thing. </font><font style="vertical-align: inherit;">It happened? </font><font style="vertical-align: inherit;">Such commits are knocked out of the general view of your story in Git, but if you want, they can be easily fixed using the command:</font></font><br>
<br>
<pre><code class="bash hljs">git reset HEAD~3</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The HEAD ~ 3 command rolls back 3 top commits, including the most recent one. </font><font style="vertical-align: inherit;">In this example, your last three commits will be deleted from the log, but the changes in the code will remain in place. </font><font style="vertical-align: inherit;">Now it's time to see what code you need to commit, for this we enter the command:</font></font><br>
<br>
<pre><code class="bash hljs">git stage --diff</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You will see that all the changes to the commits that you removed from the history are now indexed, so you can commit them again, this time in one go. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Note that HEAD usually refers to the last commit you added. </font><font style="vertical-align: inherit;">If you are not sure, check the Git log. </font><font style="vertical-align: inherit;">If your last commit was frozen (not the most common case), the HEAD ~ 1 command will erase all the commits from the frozen branch. </font><font style="vertical-align: inherit;">To learn more, see the documentation.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. Delete the last commit with changes</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Be careful, as this method will erase all changes without the ability to roll back. </font><font style="vertical-align: inherit;">It is usually used after experimenting with code if their result does not meet expectations. </font><font style="vertical-align: inherit;">I recommend that you first try in the sandbox repository.</font></font><br>
<br>
<pre><code class="bash hljs">git reset –-hard HEAD~1</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now your last commit has been deleted, as well as all the relevant changes in the code.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7. Clear your commit history</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The most efficient way to clear the commit history is to use the rebase command. </font><font style="vertical-align: inherit;">Be careful: you can delete a commit by accidentally pressing the wrong key. </font><font style="vertical-align: inherit;">So, let's run rebase interactively (-i flag) with the command:</font></font><br>
<br>
<pre><code class="bash hljs">git rebase -i HEAD~5</code></pre><br>
<img src="https://habrastorage.org/webt/sm/nj/kn/smnjknlxxntacniqh4iruwpmtne.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As soon as you enter it, you will see a list of the last 5 commits (HEAD ~ 5) inside the terminal. All commits are sorted by date, i.e. the top one will be the newest (this list is opened using Vim, the default Git text editor that allows editing text files inside the terminal). And here is a brief instruction with several useful commands. In most cases, you will need the squash and reword commands. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Replacing the pick command with the squash command will remove this commit from the log, and all changes in the code will be grouped with the last commit highlighted by the pick command. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you want to adjust the comment, you can replace the pick command with the reword command and rewrite the comment.</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now you can go to the next window, where you need to write one comment for the group of commits that you are going to glue using squash. </font><font style="vertical-align: inherit;">To continue, press ESC and enter:</font></font><br>
<br>
<pre><code class="bash hljs">:wq!</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A colon is </font></font><code>(:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">needed to indicate that you want to transmit the command, </font></font><code>(w)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to write (save) the changes, </font></font><code>(q)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to exit, and </font></font><code>(!)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to execute the command. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Please note that each commit group will receive your comment. </font><font style="vertical-align: inherit;">The result can be checked in the Git log. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If for some reason you leave this window without completing the operation, you can return at any time with the command:</font></font><br>
<br>
<pre><code class="bash hljs">git rebase --edit</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you want to leave the window without saving the changes, press the ESC key and enter:</font></font><br>
<br>
<pre><code class="bash hljs">:q!</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vim will receive a command to close the file without saving.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8. Manage indexing</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usually, you should send commits to a single file or to a group of related files. </font><font style="vertical-align: inherit;">But then how to quickly make changes during indexing? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Say you have 3 files, and only 2 of them need to be committed. </font><font style="vertical-align: inherit;">In this case, you can try the following command:</font></font><br>
<br>
<pre><code class="bash hljs">git add .</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now delete the file that you do not need from indexing:</font></font><br>
<br>
<pre><code class="bash hljs">git reset -- Readme.txt</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And check the result:</font></font><br>
<br>
<pre><code class="bash hljs">git status</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Add all files from some extension, for example CSS:</font></font><br>
<br>
<pre><code class="bash hljs">git add *.css</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Added everything by mistake? </font><font style="vertical-align: inherit;">Then clear the index using the command:</font></font><br>
<br>
<pre><code class="bash hljs">git reset --</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you need more complex operations, you can add files to the index using the dialog mode:</font></font><br>
<br>
<pre><code class="bash hljs">git add -i</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First, select an option by entering the appropriate number, for example (3), to roll back your actions. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By selecting an option, you can enter a list of files that you want to remove from indexing, one after another. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When done, press (Enter). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Files are added in the same way. </font><font style="vertical-align: inherit;">Using option (4) add an untracked file. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To exit, enter the </font></font><code>(q)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">options menu.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9. Conclusion</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The main thing to do before pushing to a remote repository, and especially before merging your branch, is to make sure that you tidy up the commit history. </font><font style="vertical-align: inherit;">Once you push everything into a remote repository, nothing can be fixed. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Want to learn more about pair programming and get started remotely? </font><font style="vertical-align: inherit;">Check out </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microverse.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en495312/index.html">Perimeter security - the future is now</a></li>
<li><a href="../en495314/index.html">How to filter misinformation if it comes from official sources?</a></li>
<li><a href="../en495316/index.html">Rules of life of the Habr Quarantine Career team</a></li>
<li><a href="../en495324/index.html">Writing a random stock generator of Mosbirzhe in JavaScript</a></li>
<li><a href="../en495326/index.html">How did we do the core of Alfa-Bank's investment business based on Tarantool</a></li>
<li><a href="../en495330/index.html">Deserved popularity in numbers</a></li>
<li><a href="../en495332/index.html">Quartet 9: Allegro | TypeScript</a></li>
<li><a href="../en495336/index.html">Discord as a corporate messenger and not only</a></li>
<li><a href="../en495338/index.html">Best practices and guidelines for launching containers and Kubernetes in production environments</a></li>
<li><a href="../en495340/index.html">How to change the work of an administrator in a restaurant for a good job in IT</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>