<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛷 🏡 🔭 Sinkronisasi waktu Linux: NTP, Chrony, dan systemd-timesyncd 🤴🏾 🧑🏼 🕡</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kebanyakan orang melacak waktu. Kami bangun tepat waktu untuk melakukan ritual pagi dan pergi bekerja, istirahat untuk makan siang, memenuhi tenggat w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Sinkronisasi waktu Linux: NTP, Chrony, dan systemd-timesyncd</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vdsina/blog/505314/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/m-/ts/k3/m-tsk33gxcmkrlh4yuqdaxl4ytk.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kebanyakan orang melacak waktu. </font><font style="vertical-align: inherit;">Kami bangun tepat waktu untuk melakukan ritual pagi dan pergi bekerja, istirahat untuk makan siang, memenuhi tenggat waktu proyek, merayakan ulang tahun dan liburan, naik pesawat, dan sebagainya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain itu: beberapa dari kita terobsesi dengan waktu. </font><font style="vertical-align: inherit;">Arloji saya ditenagai oleh energi matahari dan menerima waktu yang tepat dari Institut Nasional Standar dan Teknologi ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NIST</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) di Fort Collins, Colorado melalui </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WWVB Longwave Radio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Sinyal waktu disinkronkan dengan jam atom, juga terletak di Fort Collins. </font><font style="vertical-align: inherit;">Fitbit saya menyinkronkan dengan telepon saya, yang menyinkronkan dengan server </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NTP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang pada akhirnya menyinkronkan dengan jam atom.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perangkat juga melacak waktu</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada banyak alasan mengapa perangkat dan komputer kita membutuhkan waktu yang akurat. Misalnya, di perbankan, pasar saham, dan perusahaan keuangan lainnya, transaksi harus dilakukan dalam urutan yang tepat, dan urutan waktu yang akurat sangat penting untuk ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ponsel, tablet, mobil, sistem GPS, dan komputer kami memerlukan pengaturan waktu dan tanggal yang tepat. Saya ingin jam di desktop komputer saya menunjukkan waktu yang tepat. Saya ingin kalender lokal saya memiliki pengingat pada waktu yang tepat. Waktu yang tepat juga memastikan bahwa pekerjaan cron dan systemd dimulai pada waktu yang tepat.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tanggal dan waktu juga penting untuk pencatatan, sehingga sedikit lebih mudah untuk menemukan log tertentu berdasarkan tanggal dan waktu. </font><font style="vertical-align: inherit;">Misalnya, saya pernah bekerja di DevOps (mereka tidak menyebutnya demikian pada waktu itu) dan mengatur sistem email di North Carolina. </font><font style="vertical-align: inherit;">Kami biasa memproses lebih dari 20 juta email sehari. </font><font style="vertical-align: inherit;">Melacak email melalui serangkaian server atau menentukan urutan kejadian yang tepat menggunakan file log pada host yang tersebar secara geografis bisa jauh lebih mudah jika komputer disinkronkan tepat waktu.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suatu kali - berjam-jam</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tuan rumah Linux harus menyadari bahwa ada waktu sistem dan waktu RTC. RTC (Real Time Clock) adalah nama yang agak aneh dan tidak terlalu akurat untuk jam perangkat keras. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jam perangkat keras berjalan terus menerus bahkan ketika komputer dimatikan menggunakan baterai pada motherboard sistem. Fungsi utama RTC adalah untuk menyimpan waktu ketika koneksi ke server waktu tidak tersedia. Pada hari-hari ketika tidak mungkin untuk terhubung ke server waktu melalui Internet, setiap komputer harus memiliki jam internal yang akurat. Sistem operasi harus mengakses RTC pada saat boot, dan pengguna harus secara manual mengatur waktu sistem menggunakan antarmuka konfigurasi BIOS perangkat keras untuk memastikan itu benar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jam tangan perangkat keras tidak memahami konsep zona waktu; </font><font style="vertical-align: inherit;">RTC hanya menyimpan waktu, bukan zona waktu atau offset dari UTC (Waktu Universal Terkoordinasi, yang juga dikenal sebagai GMT atau Greenwich Mean Time). </font><font style="vertical-align: inherit;">Anda dapat menginstal RTC menggunakan alat ini, yang akan saya bahas nanti dalam artikel ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Waktu sistem adalah waktu yang ditampilkan oleh OS pada jam GUI di desktop Anda, dalam output dari perintah tanggal, di cap waktu log. </font><font style="vertical-align: inherit;">Ini juga berlaku untuk file waktu dibuat, diubah, dan dibuka. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Halaman </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">manual rtc</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> memiliki deskripsi lengkap tentang RTC dan jam sistem.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apa yang dimiliki NTP?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Komputer di seluruh dunia menggunakan NTP (Network Time Protocol) untuk menyinkronkan waktu mereka dengan jam referensi standar melalui Internet menggunakan hierarki server NTP. Server waktu utama terletak di level 1, dan mereka terhubung langsung ke berbagai layanan waktu nasional di level 0 melalui satelit, radio atau bahkan modem melalui saluran telepon. Layanan waktu pada level 0 dapat berupa jam atom, penerima radio yang disetel ke sinyal yang ditransmisikan oleh jam atom, atau penerima GPS menggunakan sinyal jam presisi tinggi yang ditransmisikan oleh satelit GPS.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada sebagian besar server referensi, beberapa ribu server strata 2 NTP publik terbuka, yang tersedia untuk semua orang. </font><font style="vertical-align: inherit;">Banyak organisasi dan pengguna (termasuk saya) dengan sejumlah besar host yang memerlukan server NTP lebih memilih untuk menginstal server waktu mereka sendiri, sehingga hanya satu host lokal yang mengalamatkan strata 2 atau 3. Kemudian mereka mengkonfigurasi node yang tersisa di jaringan untuk menggunakan server waktu lokal . </font><font style="vertical-align: inherit;">Dalam kasus jaringan rumah saya, ini adalah server level 3.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Berbagai implementasi NTP </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Implementasi awal NTP adalah ntpd. Kemudian dua yang lebih baru bergabung dengannya, chronyd dan systemd-timesyncd. Ketiganya menyinkronkan waktu host lokal dengan server waktu NTP. Layanan systemd-timesyncd tidak dapat diandalkan seperti chronyd, tetapi ini cukup untuk sebagian besar tujuan. Jika RTC tidak disinkronkan, secara bertahap dapat menyesuaikan waktu sistem untuk menyinkronkan dengan server NTP ketika waktu sistem lokal sedikit bergeser. Layanan systemd-timesync tidak dapat digunakan sebagai server waktu. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chrony</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah implementasi NTP yang berisi dua program: daemon chronyd dan antarmuka baris perintah yang disebut chronyc. Chrony memiliki beberapa fitur yang dalam banyak kasus tidak tergantikan:</font></font><br>
<br>
<ul>
<li>Chrony       ,    ntpd.       ,    .</li>
<li>     , ,           ,      -   ,       .</li>
<li>    ,        .</li>
<li>    .</li>
<li>    Chrony    .             .</li>
<li>Chrony       .          .</li>
<li>Chrony     NTP-.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekali lagi: NTP adalah protokol yang dapat diimplementasikan pada host Linux menggunakan Chrony atau systemd-timesyncd. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Paket RPM NTP, Chrony, dan systemd-timesyncd tersedia dalam repositori Fedora standar. </font><font style="vertical-align: inherit;">RPM systemd-udev adalah event manager kernel yang diinstal secara default di Fedora tetapi tidak diperlukan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat menginstal ketiganya dan beralih di antara mereka, tetapi ini akan membuat sakit kepala tambahan. </font><font style="vertical-align: inherit;">Jadi lebih baik tidak melakukannya. </font><font style="vertical-align: inherit;">Rilis Fedora, CentOS, dan RHEL saat ini telah bermigrasi ke Chrony sebagai implementasi standar, dan mereka juga memiliki systemd-timesyncd. </font><font style="vertical-align: inherit;">Saya percaya bahwa Chrony bekerja dengan baik, menyediakan antarmuka yang lebih baik daripada layanan NTP, memberikan lebih banyak informasi dan meningkatkan kontrol, yang tentunya akan dinikmati oleh administrator sistem.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menonaktifkan Layanan NTP </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tuan rumah Anda mungkin sudah menjalankan layanan NTP. </font><font style="vertical-align: inherit;">Jika demikian, Anda harus menonaktifkannya sebelum beralih ke yang lain. </font><font style="vertical-align: inherit;">Saya menjalankan chronyd, jadi saya menggunakan perintah berikut untuk menghentikan dan menonaktifkannya. </font><font style="vertical-align: inherit;">Jalankan perintah yang sesuai untuk sembarang daemon NTP yang Anda gunakan di host Anda:</font></font><br>
<br>
<pre><code class="bash hljs">[root@testvm1 ~]<span class="hljs-comment"># systemctl disable chronyd ; systemctl stop chronyd</span><font></font>
Removed /etc/systemd/system/multi-user.target.wants/chronyd.service.<font></font>
[root@testvm1 ~]<span class="hljs-comment">#</span></code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verifikasi bahwa layanan dihentikan dan dinonaktifkan:</font></font><br>
<br>
<pre><code class="bash hljs">[root@testvm1 ~]<span class="hljs-comment"># systemctl status chronyd</span><font></font>
● chronyd.service - NTP client/server<font></font>
     Loaded: loaded (/usr/lib/systemd/system/chronyd.service; disabled; vendor preset: enabled)<font></font>
     Active: inactive (dead)<font></font>
       Docs: man:chronyd(8)<font></font>
             man:chrony.conf(5)<font></font>
[root@testvm1 ~]<span class="hljs-comment">#</span></code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Periksa status sebelum peluncuran</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Status sinkronisasi jam sistem memungkinkan Anda menentukan apakah layanan NTP sedang berjalan. </font><font style="vertical-align: inherit;">Karena Anda belum memulai NTP, perintah timesync-status akan mengisyaratkan hal ini:</font></font><br>
<br>
<pre><code class="bash hljs">[root@testvm1 ~]<span class="hljs-comment"># timedatectl timesync-status</span>
Failed to query server: Could not activate remote peer.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Permintaan status langsung memberikan informasi penting. </font><font style="vertical-align: inherit;">Misalnya, perintah timedatectl tanpa argumen atau parameter menjalankan sub-perintah status default:</font></font><br>
<br>
<pre><code class="bash hljs">[root@testvm1 ~]<span class="hljs-comment"># timedatectl status</span><font></font>
           Local time: Fri 2020-05-15 08:43:10 EDT  <font></font>
           Universal time: Fri 2020-05-15 12:43:10 UTC  <font></font>
                 RTC time: Fri 2020-05-15 08:43:08      <font></font>
                Time zone: America/New_York (EDT, -0400)<font></font>
System clock synchronized: no                          <font></font>
              NTP service: inactive                    <font></font>
          RTC <span class="hljs-keyword">in</span> <span class="hljs-built_in">local</span> TZ: yes                    <font></font>
<font></font>
Warning: The system is configured to <span class="hljs-built_in">read</span> the RTC time <span class="hljs-keyword">in</span> the <span class="hljs-built_in">local</span> time zone.<font></font>
         This mode cannot be fully supported. It will create various problems<font></font>
         with time zone changes and daylight saving time adjustments. The RTC<font></font>
         time is never updated, it relies on external facilities to maintain it.<font></font>
         If at all possible, use RTC <span class="hljs-keyword">in</span> UTC by calling
         <span class="hljs-string">'timedatectl set-local-rtc 0'</span>.<font></font>
[root@testvm1 ~]<span class="hljs-comment">#</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi Anda mendapatkan waktu lokal untuk host Anda, waktu UTC dan waktu RTC. Dalam hal ini, waktu sistem diatur ke zona waktu America / New_York (TZ), RTC diatur ke waktu di zona waktu lokal, dan layanan NTP tidak aktif. Waktu RTC mulai sedikit menyimpang dari waktu sistem. Ini normal untuk sistem yang jamnya belum disinkronkan. Jumlah offset pada host tergantung pada waktu yang berlalu sejak sinkronisasi sistem terakhir.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami juga menerima peringatan tentang penggunaan waktu lokal untuk RTC - ini berlaku untuk perubahan dalam zona waktu dan pengaturan waktu musim panas. </font><font style="vertical-align: inherit;">Jika komputer dimatikan pada saat diperlukan untuk melakukan perubahan, waktu RTC tidak akan berubah. </font><font style="vertical-align: inherit;">Tetapi untuk server atau host lain yang bekerja sepanjang waktu, ini bukan masalah sama sekali. </font><font style="vertical-align: inherit;">Selain itu, layanan apa pun yang menyediakan sinkronisasi waktu NTP akan menyesuaikan waktu host pada tahap awal startup, sehingga setelah startup selesai, waktu akan menjadi benar lagi.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengaturan zona waktu</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Biasanya Anda menentukan zona waktu selama prosedur instalasi, dan Anda tidak punya tugas untuk mengubahnya di masa mendatang. Namun, ada saatnya Anda perlu mengubah zona waktu. Ada beberapa alat yang bisa membantu. Linux menggunakan file zona waktu untuk menentukan zona waktu lokal host. File-file ini terletak di </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">direktori / usr / share / zoneinfo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Secara default, untuk zona waktu saya, sistem menulis ini: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ etc / localtime -&gt; ../usr/share/zoneinfo/America/New_York</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Tetapi Anda tidak perlu tahu seluk-beluk seperti itu untuk mengubah zona waktu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hal utama adalah mengetahui nama resmi zona waktu untuk lokasi Anda dan tim yang sesuai. Katakanlah Anda ingin mengubah zona waktu ke Los Angeles:</font></font><br>
<br>
<pre><code class="bash hljs">
[root@testvm2 ~]<span class="hljs-comment"># timedatectl list-timezones | column</span><font></font>
&lt;SNIP&gt;<font></font>
America/La_Paz                  Europe/Budapest<font></font>
America/Lima                    Europe/Chisinau<font></font>
America/Los_Angeles             Europe/Copenhagen<font></font>
America/Maceio                  Europe/Dublin<font></font>
America/Managua                 Europe/Gibraltar<font></font>
America/Manaus                  Europe/Helsinki<font></font>
&lt;SNIP&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang Anda dapat mengatur zona waktu. </font><font style="vertical-align: inherit;">Saya menggunakan perintah tanggal untuk memeriksa perubahan, tetapi Anda juga dapat menggunakan timedatectl:</font></font><br>
<br>
<pre><code class="bash hljs">[root@testvm2 ~]<span class="hljs-comment"># date</span><font></font>
Tue 19 May 2020 04:47:49 PM EDT<font></font>
[root@testvm2 ~]<span class="hljs-comment"># timedatectl set-timezone America/Los_Angeles</span>
[root@testvm2 ~]<span class="hljs-comment"># date</span><font></font>
Tue 19 May 2020 01:48:23 PM PDT<font></font>
[root@testvm2 ~]<span class="hljs-comment">#</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang Anda dapat mengubah zona waktu host Anda menjadi waktu lokal.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">systemd-timesyncd</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daemon systemd timesync menyediakan implementasi NTP yang mudah dikelola dalam konteks systemd. </font><font style="vertical-align: inherit;">Ini diinstal secara default di Fedora dan Ubuntu. </font><font style="vertical-align: inherit;">Namun, ini dimulai secara default hanya di Ubuntu. </font><font style="vertical-align: inherit;">Saya tidak yakin tentang distribusi lainnya. </font><font style="vertical-align: inherit;">Anda dapat memeriksa sendiri:</font></font><br>
<br>
<pre><code class="bash hljs">[root@testvm1 ~]<span class="hljs-comment"># systemctl status systemd-timesyncd</span></code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurasi systemd-timesyncd</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
File konfigurasi untuk systemd-timesyncd adalah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/systemd/timesyncd.conf</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ini adalah file sederhana dengan lebih sedikit opsi yang disertakan daripada dalam layanan NTP dan chronyd yang lama. </font><font style="vertical-align: inherit;">Berikut adalah isi file ini (tanpa perubahan lebih lanjut) di mesin virtual Fedora saya:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment">#  This file is part of systemd.</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment">#  systemd is free software; you can redistribute it and/or modify it</span>
<span class="hljs-comment">#  under the terms of the GNU Lesser General Public License as published by</span>
<span class="hljs-comment">#  the Free Software Foundation; either version 2.1 of the License, or</span>
<span class="hljs-comment">#  (at your option) any later version.</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Entries in this file show the compile time defaults.</span>
<span class="hljs-comment"># You can change settings by editing this file.</span>
<span class="hljs-comment"># Defaults can be restored by simply deleting this file.</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># See timesyncd.conf(5) for details.</span><font></font>
<font></font>
[Time]<font></font>
<span class="hljs-comment">#NTP=</span>
<span class="hljs-comment">#FallbackNTP=0.fedora.pool.ntp.org 1.fedora.pool.ntp.org 2.fedora.pool.ntp.org 3.fedora.pool.ntp.org</span>
<span class="hljs-comment">#RootDistanceMaxSec=5</span>
<span class="hljs-comment">#PollIntervalMinSec=32</span>
<span class="hljs-comment">#PollIntervalMaxSec=2048</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Satu-satunya bagian yang dikandungnya, terlepas dari komentar, adalah [Waktu]. </font><font style="vertical-align: inherit;">Semua baris lainnya dikomentari. </font><font style="vertical-align: inherit;">Ini adalah nilai default, mereka tidak perlu diubah (kecuali jika Anda punya alasan untuk ini). </font><font style="vertical-align: inherit;">Jika Anda tidak memiliki server waktu NTP yang ditentukan di baris NTP =, Fedora menggunakan server waktu cadangan Fedora secara default. </font><font style="vertical-align: inherit;">Saya biasanya menambahkan server waktu saya:</font></font><br>
<br>
<pre><code class="bash hljs">NTP=myntpserver</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Luncurkan timesync</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat memulai dan mengaktifkan systemd-timesyncd aktif seperti ini:</font></font><br>
<br>
<pre><code class="bash hljs">[root@testvm2 ~]<span class="hljs-comment"># systemctl enable systemd-timesyncd.service</span><font></font>
Created symlink /etc/systemd/system/dbus-org.freedesktop.timesync1.service → /usr/lib/systemd/system/systemd-timesyncd.service.<font></font>
Created symlink /etc/systemd/system/sysinit.target.wants/systemd-timesyncd.service → /usr/lib/systemd/system/systemd-timesyncd.service.<font></font>
[root@testvm2 ~]<span class="hljs-comment"># systemctl start systemd-timesyncd.service</span>
[root@testvm2 ~]<span class="hljs-comment">#</span></code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pemasangan Jam Perangkat Keras</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Begini situasinya setelah menjalankan timesyncd:</font></font><br>
<br>
<pre><code class="bash hljs">[root@testvm2 systemd]<span class="hljs-comment"># timedatectl</span><font></font>
               Local time: Sat 2020-05-16 14:34:54 EDT  <font></font>
           Universal time: Sat 2020-05-16 18:34:54 UTC  <font></font>
                 RTC time: Sat 2020-05-16 14:34:53      <font></font>
                Time zone: America/New_York (EDT, -0400)<font></font>
System clock synchronized: yes                          <font></font>
              NTP service: active                      <font></font>
          RTC <span class="hljs-keyword">in</span> <span class="hljs-built_in">local</span> TZ: no    </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada awalnya, perbedaan antara RTC dan waktu lokal (EDT) tidak melebihi satu detik, dan perbedaan meningkat beberapa detik selama beberapa hari berikutnya. Karena tidak ada konsep zona waktu di RTC, perintah timedatectl harus melakukan perbandingan untuk menentukan zona waktu yang diinginkan. Jika RTC tidak sama persis dengan waktu setempat, maka itu tidak cocok dengan zona waktu setempat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mencari informasi lebih lanjut, saya memeriksa status systemd-timesync dan menemukan ini:</font></font><br>
<br>
<pre><code class="bash hljs">[root@testvm2 systemd]<span class="hljs-comment"># systemctl status systemd-timesyncd.service</span><font></font>
● systemd-timesyncd.service - Network Time Synchronization<font></font>
     Loaded: loaded (/usr/lib/systemd/system/systemd-timesyncd.service; enabled; vendor preset: disabled)<font></font>
     Active: active (running) since Sat 2020-05-16 13:56:53 EDT; 18h ago<font></font>
       Docs: man:systemd-timesyncd.service(8)<font></font>
   Main PID: 822 (systemd-timesyn)<font></font>
     Status: <span class="hljs-string">"Initial synchronization to time server 163.237.218.19:123 (2.fedora.pool.ntp.org)."</span>
      Tasks: 2 (<span class="hljs-built_in">limit</span>: 10365)<font></font>
     Memory: 2.8M<font></font>
        CPU: 476ms<font></font>
     CGroup: /system.slice/systemd-timesyncd.service<font></font>
             └─822 /usr/lib/systemd/systemd-timesyncd<font></font>
<font></font>
May 16 09:57:24 testvm2.both.org systemd[1]: Starting Network Time Synchronization...<font></font>
May 16 09:57:24 testvm2.both.org systemd-timesyncd[822]: System clock time <span class="hljs-built_in">unset</span> or jumped backwards, restoring from recorded timestamp: Sat 2020-05-16 13:56:53 EDT<font></font>
May 16 13:56:53 testvm2.both.org systemd[1]: Started Network Time Synchronization.<font></font>
May 16 13:57:56 testvm2.both.org systemd-timesyncd[822]: Initial synchronization to time server 163.237.218.19:123 (2.fedora.pool.ntp.org).<font></font>
[root@testvm2 systemd]<span class="hljs-comment">#</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perhatikan pesan log, yang mengatakan bahwa waktu sistem tidak diatur atau diatur ulang. </font><font style="vertical-align: inherit;">Layanan Timesync menetapkan waktu sistem berdasarkan cap waktu. </font><font style="vertical-align: inherit;">Stempel waktu dikelola oleh daemon timesync dan dibuat pada setiap sinkronisasi yang berhasil. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perintah timedatectl tidak dapat mengambil nilai jam perangkat keras dari jam sistem. </font><font style="vertical-align: inherit;">Dia dapat mengatur waktu dan tanggal hanya dari nilai yang dimasukkan pada baris perintah. </font><font style="vertical-align: inherit;">Anda dapat mengatur RTC ke nilai yang sama dengan waktu sistem menggunakan perintah jam:</font></font><br>
<br>
<pre><code class="bash hljs">[root@testvm2 ~]<span class="hljs-comment"># /sbin/hwclock --systohc --localtime</span>
[root@testvm2 ~]<span class="hljs-comment"># timedatectl</span><font></font>
               Local time: Mon 2020-05-18 13:56:46 EDT  <font></font>
           Universal time: Mon 2020-05-18 17:56:46 UTC  <font></font>
                 RTC time: Mon 2020-05-18 13:56:46      <font></font>
                Time zone: America/New_York (EDT, -0400)<font></font>
System clock synchronized: yes                          <font></font>
              NTP service: active                      <font></font>
          RTC <span class="hljs-keyword">in</span> <span class="hljs-built_in">local</span> TZ: yes</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Opsi --localtime menunjukkan bahwa jam perangkat keras menunjukkan waktu setempat, bukan UTC.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengapa Anda membutuhkan RTC?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setiap implementasi NTP akan mengatur jam sistem saat startup. </font><font style="vertical-align: inherit;">Lalu mengapa RTC? </font><font style="vertical-align: inherit;">Ini tidak sepenuhnya benar: ini hanya akan terjadi jika Anda memiliki koneksi jaringan ke server waktu. </font><font style="vertical-align: inherit;">Namun, banyak sistem tidak memiliki akses konstan ke koneksi jaringan, sehingga jam perangkat keras berguna untuk Linux untuk mengatur waktu sistem berdasarkan pada mereka. </font><font style="vertical-align: inherit;">Ini lebih baik daripada mengatur waktu secara manual, meskipun mungkin menyimpang dari waktu nyata.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesimpulan</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Artikel ini membahas beberapa alat untuk mengelola tanggal, waktu, dan zona waktu. Alat systemd-timesyncd menyediakan klien NTP yang dapat menyinkronkan waktu pada host lokal dengan server NTP. Namun, systemd-timesyncd tidak menyediakan layanan server, jadi jika Anda memerlukan server NTP di jaringan Anda, Anda harus menggunakan sesuatu yang lain - misalnya, Chrony, agar berfungsi sebagai server. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya lebih suka memiliki implementasi tunggal untuk layanan apa pun di jaringan saya, jadi saya menggunakan Chrony. Jika Anda tidak memerlukan server NTP lokal atau jika Anda tidak keberatan menggunakan Chrony sebagai server dan systemd-timesyncd sebagai klien SNTP. Lagi pula, tidak perlu menggunakan fitur tambahan Chrony sebagai klien, jika Anda puas dengan fungsionalitas systemd-timesyncd.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Satu lagi catatan: Anda tidak diharuskan menggunakan alat systemd untuk mengimplementasikan NTP. </font><font style="vertical-align: inherit;">Anda dapat menggunakan versi lama ntpd, Chrony, atau implementasi NTP lainnya. </font><font style="vertical-align: inherit;">Bagaimanapun, systemd terdiri dari sejumlah besar layanan; </font><font style="vertical-align: inherit;">banyak dari mereka adalah opsional, sehingga Anda dapat mematikannya dan menggunakan sesuatu yang lain sebagai gantinya. </font><font style="vertical-align: inherit;">Ini bukan monster monolitik besar. </font><font style="vertical-align: inherit;">Anda mungkin tidak suka systemd atau bagian dari itu, tetapi Anda harus membuat keputusan berdasarkan informasi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya suka implementasi NTP di systemd, tapi saya lebih suka Chrony karena lebih sesuai dengan kebutuhan saya. </font><font style="vertical-align: inherit;">Ini Linux, sayang -)</font></font><br>
<br>
<hr><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sebagai iklan</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VDSina menawarkan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">server untuk tugas apa pun</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , banyak pilihan sistem operasi untuk instalasi otomatis, dimungkinkan untuk menginstal OS apa pun dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ISO</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sendiri </font><font style="vertical-align: inherit;">, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">panel kontrol yang</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nyaman </font><font style="vertical-align: inherit;">dengan desainnya sendiri dan pembayaran harian. </font><font style="vertical-align: inherit;">Ingatlah bahwa kita memiliki server abadi yang pasti abadi;)</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/9fa/cf4/a34/9facf4a348ef01048b4eb5e16ae66daa.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id505298/index.html">Penerbangan Crew Dragon dalam foto dan video</a></li>
<li><a href="../id505300/index.html">Industri minyak untuk insinyur, programmer, matematikawan dan massa pekerja, bagian 1</a></li>
<li><a href="../id505302/index.html">10 tips desain sirkuit</a></li>
<li><a href="../id505306/index.html">Dari game hingga proyek e-commerce. Mengubah program Technopark selama dua tahun</a></li>
<li><a href="../id505310/index.html">Yang membedakan perusahaan berteknologi maju dan bagaimana techlide dapat membantu tim Anda tumbuh</a></li>
<li><a href="../id505322/index.html">Dispatcher masa depan: bagaimana perannya dalam perusahaan jasa akan berubah?</a></li>
<li><a href="../id505330/index.html">Cara tidak membuat cryptocurrency dari awal dalam 3 tahun</a></li>
<li><a href="../id505336/index.html">Bagaimana cara: Manet atau Monet? Jaringan saraf merespons</a></li>
<li><a href="../id505340/index.html">Karyawan Walmart mencoba membuktikan bahwa anti-pencurian AI tidak berfungsi</a></li>
<li><a href="../id505342/index.html">Injeksi ketergantungan dan prinsip inversi ketergantungan TIDAK SATU DAN SAMA</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>