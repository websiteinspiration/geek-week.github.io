<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ñ ü§∂üèø üå∑ Windows vs Sysmon üêò ‚öæÔ∏è üåÇ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lors de la derni√®re conf√©rence ZeroNights, au cours d'une communication informelle avec nos coll√®gues du syst√®me de surveillance, on nous a pos√© une q...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Windows vs Sysmon</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/489050/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/yy/x6/_z/yyx6_zfwsrw0m-c8zx_yr5bimqs.jpeg"></div><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lors de la derni√®re conf√©rence ZeroNights, au cours d'une communication informelle avec nos coll√®gues du syst√®me de surveillance, on nous a pos√© une question simple √† premi√®re vue - il √©tait largement admis que Sysmon devrait √™tre utilis√© pour surveiller enti√®rement le point final avec le syst√®me d'exploitation Windows, est-ce le cas? </font><font style="vertical-align: inherit;">Et si oui, pour quelles raisons sp√©cifiques (bonjour Seryozha!)? </font><font style="vertical-align: inherit;">Nous n'avons pas pu trouver de r√©ponse compl√®te sans ambigu√Øt√© dans notre bagage de connaissances ou une comparaison correspondante sur Internet, donc, tout d'abord pour nous-m√™mes, mais non des moindres, afin qu'√† l'avenir une telle source provienne encore de la communaut√©, nous avons d√©cid√© d'explorer ce sujet et comparer les √©v√©nements face √† face Windows et Sysmon. </font><font style="vertical-align: inherit;">Comme le dit le proverbe, "1 ... 2 ... 3 ... Combattez!".</font></font><a name="habracut"></a></p><br>
<a name="stage1"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">introduction</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout sp√©cialiste dans le domaine de la s√©curit√© de l'information est contraint de travailler dans un certain cadre. Par exemple, dans un budget limit√©, la s√©curit√©, √† de rares exceptions pr√®s, n'est pas le principal moyen pour une organisation de r√©aliser un profit ou d'exercer d'autres fonctions au sein de son c≈ìur de m√©tier. Par cons√©quent, dans des conditions de ressources limit√©es que l'organisation poss√®de, seule une petite partie d'entre elles est souvent allou√©e au secteur de la s√©curit√© afin de maintenir cette orientation au niveau minimum suffisant (conform√©ment √† certaines exigences). M√™me avec des ressources illimit√©es, il y aura toujours d'autres restrictions qui ne permettront pas d'amener le niveau de s√©curit√© √† l'absolu. Ce sont les vuln√©rabilit√©s notoires du jour z√©ro ou normal (gestion sans fin des correctifs), et la course aux armements constante des pirates et des agents de s√©curit√©,et le dynamisme du d√©veloppement de l'infrastructure informatique, et bien plus encore.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cette optique, plus que jamais, la question de la hi√©rarchisation des moyens et m√©thodes de protection est urgente, y compris dans le sens du suivi. Dans ce domaine, selon les statistiques fond√©es sur les donn√©es de la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MITRE ATT &amp; CK</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> matrice </font><font style="vertical-align: inherit;">, que nous avons d√©j√† </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√©crit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> la derni√®re fois, les priorit√©s sont les </font><font style="vertical-align: inherit;">suivantes comme: premi√®re place inconditionnelle est prise par une telle </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">source d'√©v√©nements de s√©curit√©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comme param√®tres.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hr/9p/it/hr9piteihbc4qv4qgsff55qu2iq.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette source m√®ne au nombre de techniques matricielles qui peuvent √™tre identifi√©es en fonction des √©v√©nements enregistr√©s sur elle. Le syst√®me d'exploitation le plus courant pour les points de terminaison reste Microsoft Windows. La collecte exacte de ses journaux dans la plupart des infrastructures d'entreprise donnera le meilleur r√©sultat dans le rapport de tous les types de co√ªts √† la couverture des p√©riph√©riques r√©seau et √† la couverture des techniques malveillantes. Ceci est confirm√© par les statistiques des m√™mes auteurs. Les places 1 √† 3, 5, 7, 8, 10 et la partie 4 occupent uniquement ces soi-disant √©v√©nements de base.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gh/7q/7o/gh7q7otidvmpw_ibo6fqnaxmsuw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais, comme dans la c√©l√®bre blague, il y a une mise en garde. Ces derni√®res ann√©es, il est devenu largement admis que les journaux Windows doivent √™tre compl√©t√©s, sinon remplac√©s, par des √©v√©nements Sysmon - ils disent qu'ils sont plus complets, meilleurs, plus adapt√©s en tant qu'outil de surveillance du point de vue de la s√©curit√© des informations. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, cette approche r√©pond en quelque sorte au concept de minimalisme. Chaque produit logiciel que vous essayez d'ajouter au v√¥tre ou qui vous est donn√© volontairement par un client d'entreprise repr√©sente une augmentation de la zone d'attaque, des co√ªts d'administration et de mise √† jour et des points de d√©faillance. Et souvent - et juste avant la mise en ≈ìuvre de votre syst√®me de surveillance, tandis que votre approche passe l'approbation.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sysmon a √©t√© d√©velopp√© par des sp√©cialistes de Microsoft, et r√©cemment absorb√© par cette soci√©t√©, ce qui donne un certain niveau de confiance de la part des TI. De plus, les journaux sont √©crits sous la forme d'un journal .evtx, qui vous permet de les collecter et de les traiter √† l'aide des m√™mes outils et m√©thodes que les journaux Windows classiques.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Faites imm√©diatement une r√©serve que l'article s'est av√©r√© √™tre volumineux, bien que nous ayons essay√© de dupliquer et de compresser le mat√©riel de mani√®re minimale. Le lecteur, bien s√ªr, peut dire, en se r√©f√©rant √† cette blague sur L√©nine: "Mais il aurait pu r√©duire ...". Ou que "la publication pourrait √™tre divis√©e en deux ou trois parties pour une meilleure lisibilit√©". Mais il nous a sembl√© que malgr√© le volume du mat√©riel pr√©par√©, nous devons apporter une r√©ponse compl√®te √† la question de nos coll√®gues de la boutique, et la recherche serait plus pratique. Ainsi, afin de ne rien perdre, nous vous recommandons de lire l'article 1 fois compl√®tement, peut-√™tre de prendre des notes pour vous-m√™me et de ne revenir ensuite qu'√† des groupes sp√©cifiques d'√©v√©nements et de vous y plonger en d√©tail.</font></font><br>
<br>
<a name="stage2"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour plus de commodit√©, nous ajoutons une table des mati√®res: </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introduction </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Table des mati√®res </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Format de comparaison </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cr√©ation d'un processus </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connexions r√©seau </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fin d'un processus </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T√©l√©chargement d'un pilote </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acc√®s √† un processus </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cr√©ation d'un fichier </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Actions de registre </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration WMI </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Requ√™tes DNS </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">√âv√©nements </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sysmon uniques </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âv√©nements de filtrage </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autres fournisseurs d'√©v√©nements de base gratuits </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sortie g√©n√©rale</font></font></a><br>
<br>
<a name="stage3"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Format de comparaison</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pourquoi et ce qui a √©t√© compar√©, cela semble clair. Et comment cela a-t-il √©t√© fait et pourquoi exactement? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons d√©cid√© de faire une comparaison sous forme de tableau pour chacun des groupes d'√©v√©nements qui refl√®tent une certaine activit√© dans le syst√®me. Par exemple, les √©v√©nements avec ID (ID d'√©v√©nement, EID) 12, 13 et 14 dans Sysmon, refl√©tant l'activit√© avec le registre, ne sont m√™me pas filtr√©s s√©par√©ment, bien qu'ils parlent de diff√©rentes actions atomiques. Par la m√™me logique, le reste du regroupement a √©t√© fait. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ces groupes ne comprenaient que des √©v√©nements similaires. Par exemple, un √©v√©nement analogue √† l'√©v√©nement Sysmon EID 6 est l'√©v√©nement Windows EID 6. Parall√®lement, il existe au moins 219 et 7036 √©v√©nements Windows concernant le chargement des pilotes. Mais ils surviennent en cas d'√©chec. Ceux. ne portent pas la m√™me charge s√©mantique et, si n√©cessaire, peuvent compl√©ter les √©v√©nements de Sysmon ou Windows, selon ce que nous avons d√©cid√© de collecter.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les groupes d'√©v√©nements refl√©t√©s dans le tableau, les champs informatifs (que nous utilisons √† des fins de surveillance) contenus dans les √©v√©nements sont pr√©sent√©s sous forme de cha√Ænes. Pour chacun de ces champs, son nom est indiqu√©. Pour Windows, 2 options sont possibles, pour les vues xml et magazine (qui aurait pens√© qu'elles correspondraient?) Si elles diff√®rent plus que par les espaces. Cela se fait parce que le nom du champ qui tombera dans le syst√®me de surveillance peut d√©pendre de la m√©thode de collecte. Les lignes contiennent √©galement des donn√©es d'√©v√©nement (afin de comprendre leur format) et un commentaire (si √† notre avis cela est requis). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les champs ayant la m√™me charge s√©mantique pour les deux sources sont combin√©s sur une seule ligne. En l'absence d'un champ avec une charge s√©mantique similaire pour l'une des sources, des tirets ("-") sont indiqu√©s dans les champs qui lui correspondent.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les lignes contenant des informations sur une entit√© particuli√®re, par exemple, le sujet effectuant l'action, sont combin√©es en un groupe s√©mantique. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La comparaison a √©t√© effectu√©e pour les versions de Windows Kernel 6.3 (Windows 2012R2) et 10.0 (Windows 10, 2016, 2019). Les versions ant√©rieures n'ont pas √©t√© prises en compte, car bien qu'elles soient encore tr√®s r√©pandues, elles disparaissent progressivement. Si les √©v√©nements pour les diff√©rentes versions du noyau ne diff√©raient pas, les colonnes ont √©t√© combin√©es en une seule pour r√©duire la duplication. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le taux √©tant √† temps plein, les colonnes sont organis√©es dans l'ordre suivant du centre vers les bords: donn√©es, nom de champ, commentaire. Cela rend la comparaison plus visuelle. Pour la s√©paration visuelle des colonnes en fonction des sources auxquelles elles se r√©f√®rent, des couleurs sont utilis√©es.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unique √† Sysmon EID (car dans ce cas, il s'agit d'un outil compl√©mentaire, l'enregistrement des journaux du syst√®me d'exploitation est inclus dans les fonctionnalit√©s de base du syst√®me d'exploitation) sont donn√©s dans une section distincte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La section avec le tableau indique les param√®tres de GPO qui doivent √™tre d√©finis pour activer l'enregistrement dans le journal des √©v√©nements de groupe, comme </font><font style="vertical-align: inherit;">le nombre d'options d'audit possibles est g√©n√©ralement assez important. </font><font style="vertical-align: inherit;">Pour Sysmon, ces param√®tres ne sont pas affich√©s, car </font><font style="vertical-align: inherit;">tous sont contenus dans un seul fichier de configuration.</font></font><br>
<br>
<a name="stage4"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cr√©ation de processus</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Paradoxalement, ils ont d√©cid√© de recommencer depuis le d√©but. Et puis ils n'√©taient pas non plus originaux et sont all√©s dans l'ordre - en augmentant EID Sysmon. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La journalisation des donn√©es d'√©v√©nement dans Windows est activ√©e comme suit: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Configuration de l'ordinateur - Strat√©gies - Param√®tres Windows - Param√®tres de s√©curit√© - Configuration avanc√©e de la strat√©gie d'audit - Strat√©gies d'audit - Suivi d√©taill√© - Cr√©ation du processus d'audit - Le succ√®s permet la journalisation de l'√©v√©nement lui-m√™me; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Configuration informatique - Strat√©gies - Mod√®les d'administration - Syst√®me - Cr√©ation de processus d'audit - Inclure la ligne de commande dans les √©v√©nements de cr√©ation de processus - ajoute la ligne de commande du processus d√©marr√© √† l'√©v√©nement, ce qui permet souvent de distinguer un d√©marrage l√©gitime d'un d√©marrage ill√©gitime. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La comparaison dans le format d√©crit ci-dessus est pr√©sent√©e dans le tableau suivant.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/rs/dw/nm/rsdwnmsmgurjif--9gck7phggee.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ci-apr√®s, tous les tableaux sont repr√©sent√©s par des images et sont cliquables. Depuis, tout d'abord, nous n'avons pas trouv√© un bon moyen de transf√©rer des tableaux vers Markdown ou HTML tout en pr√©servant la largeur de colonne ou la c√©sure selon la version existante dans Excel. Et deuxi√®mement, leur contenu n'est pas tr√®s utile pour l'indexation, sauf pour les commentaires. La composition des champs abord√©s dans cet article et le format de donn√©es avec lequel vous devrez travailler si ces sources d'√©v√©nements sont utilis√©es sont beaucoup plus pr√©cieux dans les tableaux.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consid√©rez-le dans l'ordre, mais pas ligne par ligne - chacun fera une telle analyse d√©taill√©e pour lui-m√™me. </font><font style="vertical-align: inherit;">Dans cette section et ci-dessous, nous ne nous attarderons que sur les informations rencontr√©es pour la premi√®re fois. </font><font style="vertical-align: inherit;">Commencez imm√©diatement avec un exemple de ce comportement. </font><font style="vertical-align: inherit;">Les champs de la section Syst√®me sont pr√©sents dans chaque √©v√©nement qui tombe dans le journal, quelle que soit la source - Sysmon ou Windows. </font><font style="vertical-align: inherit;">Ils contiennent des informations g√©n√©rales:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le nom du fournisseur d'√©v√©nements.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EID</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Heure √† laquelle l'√©v√©nement a √©t√© enregistr√©.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le nom du magazine d'o√π nous avons obtenu cet √©v√©nement.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H√¥te sur lequel l'√©v√©nement s'est produit.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le nom du fournisseur et le journal apr√®s la connexion ne sont g√©n√©ralement pas utilis√©s par l'analyste. Mais ils permettent de comprendre o√π et qui √©crit les journaux, ce qui est important si le processus de collecte n'a pas encore commenc√©. L'heure, l'h√¥te et l'EID sont les balises principales par lesquelles le filtrage principal des √©v√©nements est effectu√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En outre, parmi les champs que je voudrais particuli√®rement noter - le GUID pour la session utilisateur et les processus enfant et parent n'existe que dans les journaux Sysmon. Et √† la m√™me tirelire, par bizarreries - l'ID de processus (nouveau et parent) dans les √©v√©nements Windows est √©crit en hexad√©cimal, bien qu'il soit affich√© en notation d√©cimale dans le m√™me gestionnaire de t√¢ches. Comme le dit le proverbe, d√©bogage heureux ("-veux d'am√©liorer? -Github") ...</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La ligne de commande lors du d√©marrage d'un processus dans des √©v√©nements Windows a un format diff√©rent selon l'utilitaire utilis√© pour le d√©marrer. Mais √† Sysmon, les auteurs voulaient et pouvaient - le format ne d√©pend pas d'autres entr√©es. Je ne vais pas en juger les raisons, mais les cr√©ateurs de contenu SIEM n'√©criront pas merci √† Microsoft √† ce sujet, c'est s√ªr. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La principale caract√©ristique distinctive de Sysmon pour cela, ainsi que pour d'autres √©v√©nements qui contiennent ce champ, j'appellerais le hachage du fichier ex√©cutable. Le format de hachage est s√©lectionn√© dans la configuration Sysmon.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encore une fois, parmi les bonus Sysmon int√©ressants suppl√©mentaires - le champ Nom de la r√®gle. </font><font style="vertical-align: inherit;">Il s'agit en fait d'une balise qui est pratique pour marquer certains filtres dans le fichier de configuration, puis l'utiliser lors de l'analyse des √©v√©nements. </font><font style="vertical-align: inherit;">Par exemple, nous pouvons dire que le d√©but du processus X fait r√©f√©rence √† la tactique Y ou √† la technique Z. Cette approche est int√©ressante √† la fois du point de vue de l'analyste et du point de vue du d√©veloppeur de contenu SIEM ou Sysmon - elle nous permet de comprendre la raison pour laquelle nous avons d√©cid√© de collecter cet √©v√©nement.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sysmon est bien meilleur pour corriger ce groupe d'√©v√©nements:</font></font><br>
<br>
<ul>
<li> GUID       ,          , ,     ,      ID         (    ).  , ,           .         .    ID           , , SIEM,         .  GUID,  ‚Äî  .</li>
<li>  ‚Äî                 ‚Äî  ,            ,    .    ‚Äî  Sysmon    ,      SIEM ( ).   -    ‚Äî   ,        .    ,   SIEM     .   , ,  IBM QRadar. , -     .   , ,     ‚Äî  Windows  ,    ,    .</li>
<li>  Rule Name    .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'applicabilit√© des champs uniques restants, celle des √©v√©nements Windows, celle des √©v√©nements Sysmon, joue un r√¥le, comme on dit en anglais, au cas par cas. </font><font style="vertical-align: inherit;">Par cons√©quent, pour d√©cider du choix d'un journal particulier, ou en g√©n√©ral de les combiner, il faut √©galement au cas par cas.</font></font></li>
</ul><a name="stage5"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les connexions de r√©seau</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enregistrement de ces √©v√©nements sur Windows: Configuration de l'ordinateur - Strat√©gies - Param√®tres Windows - Param√®tres de s√©curit√© - Configuration avanc√©e de la strat√©gie d'audit - Strat√©gies d'audit - Acc√®s aux objets - Connexion √† la plateforme de filtrage d'audit</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pourquoi avez-vous d√©cid√© de vous concentrer sur les √©v√©nements de la plateforme de filtrage Windows (WFP) et non sur le pare-feu Windows? La r√©ponse est simple. D'apr√®s notre pratique, les points d'extr√©mit√© sous forme d'antivirus sont d√©j√† sur les h√¥tes de toute fa√ßon. Bien qu'ils ne soient pas con√ßus pour surveiller les √©v√©nements de base du syst√®me (c'est pourquoi ils ne conviennent pas √† nos fins), n√©anmoins, dans les r√©alit√©s modernes, ils incluent toujours un pare-feu h√¥te. Pour cette raison, pour √©viter la duplication, le pare-feu Windows est g√©n√©ralement simplement annul√©. En cons√©quence, personne n'√©crit au colonel ... WFP, bien qu'il puisse filtrer le trafic, nous ne l'utilisons qu'√† des fins de surveillance. Par cons√©quent, la duplication est absente.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/nq/59/ba/nq59banogevpo2koyntusv8dtfo.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le tableau montre que si nous essayons de nous fier aux √©v√©nements Windows, l'√©chographie utilisateur et le nom de domaine complet des h√¥tes en interaction devront √™tre restaur√©s par enrichissement d'√©v√©nement. Bien que, si vous y r√©fl√©chissez, il est plus important pour nous de savoir quel processus a √©tabli la connexion, et non quel utilisateur. Par exemple, le malware va √† son centre C&amp;C. Quoi qu'il en soit, nous voulons savoir qui a commenc√© le processus ou cr√©er un incident en sachant que le bloc-notes ne va pas sur Internet lui-m√™me (c'est-√†-dire sur la base des informations disponibles dans l'√©v√©nement).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et avec le FQDN, c'est encore plus simple - tous les syst√®mes modernes incluent le composant CMDB comme fonctionnalit√© de base ou suppl√©mentaire. </font><font style="vertical-align: inherit;">Et sinon, cela vaut vraiment la peine de s'approvisionner avec une solution tierce. </font><font style="vertical-align: inherit;">Conna√Ætre votre infrastructure est la base de la s√©curit√© de l'information en g√©n√©ral. </font><font style="vertical-align: inherit;">Les informations sont donc disponibles soit par enrichissement, soit par le biais d'une carte d'actif, ce qui permettra son utilisation en corr√©lation. </font><font style="vertical-align: inherit;">L'essentiel est, si possible, de ne pas oublier de connecter les logs DHCP pour que les informations soient √† jour. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tous les autres champs uniques ne sont pas aussi importants, par exemple:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ports c√©l√®bres. </font><font style="vertical-align: inherit;">On ne s'appuierait pas sur ce champ - ce n'est pas en vain qu'il existe des moyens de d√©tecter des anomalies de trafic lorsque, par exemple, le tunnel ssh passe par le port 80 plut√¥t que HTTP.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direction du trafic. </font><font style="vertical-align: inherit;">Connaissant l'ID d'h√¥te (IP ou FQDN) et la source \ destination de la connexion, vous pouvez facilement calculer la direction.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et dans ce cas, Sysmon gagne, mais de mani√®re moins significative - GUID, FQDN, User offrent une commodit√© qui est tout √† fait possible √† atteindre en utilisant SIEM ou des solutions tierces. </font><font style="vertical-align: inherit;">N√©anmoins, de petits efforts ne signifient pas z√©ro.</font></font><br>
<a name="stage6"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ach√®vement du processus</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En g√©n√©ral, l'√©v√©nement, comme d√©j√† mentionn√© ci-dessus, n'est pas tr√®s souvent utilis√©, mais ...</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/lq/0e/x0/lq0ex02swhhs39noycfzb1m2wog.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si cela est n√©cessaire, il y a une nette victoire du c√¥t√© de Windows. </font><font style="vertical-align: inherit;">Nous ajoutons uniquement comment activer la journalisation et allons directement aux conclusions. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configuration de l'ordinateur - Strat√©gies - Param√®tres Windows - Param√®tres de s√©curit√© - Configuration de strat√©gie d'audit avanc√©e - Strat√©gies d'audit - Suivi d√©taill√© - Arr√™t du processus d'audit - Succ√®s</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce cas, l'avantage de la journalisation native du syst√®me d'exploitation est obtenu par:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Affiche l'utilisateur qui a termin√© le processus.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La pr√©sence de code de sortie, qui peut parler de l'ach√®vement r√©gulier du processus, ainsi que des erreurs.</font></font></li>
</ul><a name="stage7"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T√©l√©chargement du pilote</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cet √©v√©nement Windows, contrairement aux autres, est activ√© par d√©faut et entre dans le journal syst√®me. </font><font style="vertical-align: inherit;">Il n'y a pas beaucoup de champs informatifs dans ces √©v√©nements.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/a3/hd/4k/a3hd4kpimlddce6uu5az5mzn_dw.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et encore une fois, imm√©diatement aux conclusions.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce groupe, les √©v√©nements Sysmon fournissent √† l'analyste des informations beaucoup plus utiles. </font><font style="vertical-align: inherit;">Par exemple, selon les √©v√©nements Windows, il n'est m√™me pas clair quel fichier de pilote a √©t√© utilis√©. </font><font style="vertical-align: inherit;">Par cons√©quent, dans ce groupe de Windows dans des √©trangers explicites.</font></font><br>
<a name="stage8"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acc√®s au processus</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous ne classerions pas ce groupe d'√©v√©nements comme √©l√©mentaire, mais plut√¥t comme un niveau l√©g√®rement avanc√©. D'un point de vue s√©curitaire, l'√©v√©nement peut √™tre d'un grand int√©r√™t. Il existe de nombreuses </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fa√ßons dont un</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> processus malveillant peut am√©liorer votre ¬´petit¬ª l√©gitime. Bien s√ªr, pas pour des raisons d'altruisme, mais pour des actions malveillantes. Et les √©v√©nements √† l'√©tude nous aideront √† d√©couvrir de nombreuses options pour une telle cr√©ativit√©. Ces journaux sont activ√©s dans Configuration ordinateur - Strat√©gies - Param√®tres Windows - Param√®tres de s√©curit√© - Configuration de strat√©gie d'audit avanc√©e - Strat√©gies d'audit - Acc√®s aux objets - Objet noyau d'audit - Succ√®s</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/g5/3x/xm/g53xxmsrxfjnuq5dy-hxfatsq2g.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows pr√©sente deux avantages. Tout d'abord, le mappage de l'utilisateur √† partir duquel le processus source fonctionne. Comme nous l'avons not√© ci-dessus, l'avantage est g√©n√©ralement n√©gligeable. Et, deuxi√®mement, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HandleID</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et les droits d'acc√®s. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si l'int√©r√™t pour les droits d'acc√®s est clair, alors HandleID n'est utile que pour rechercher des √©v√©nements associ√©s. Il est n√©cessaire pour organiser l'interaction utilisateur √† travers des processus avec des objets OS - les m√™mes processus (leurs threads), fichiers, etc. Par cons√©quent, des √©v√©nements suppl√©mentaires peuvent montrer comment, en cons√©quence, √† qui il a √©t√© √©mis et quand le descripteur d'acc√®s requis a √©t√© r√©voqu√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En touchant pour la premi√®re fois les sujets des objets et des poign√©es, ainsi que la journalisation des actions avec eux, il est important de noter deux choses.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, pour enregistrer les √©tapes suppl√©mentaires ci-dessus, il est important d'activer des param√®tres de strat√©gie d'audit suppl√©mentaires, en particulier Configuration ordinateur - Polcies - Param√®tres Windows - Param√®tres de s√©curit√© - Configuration avanc√©e de la strat√©gie d'audit - Strat√©gies d'audit - Acc√®s aux objets - Manipulation de la poign√©e d'audit - Succ√®s. Il convient de rappeler que le volume de ces √©v√©nements peut √™tre tr√®s important. Le traitement est √©mis √† la r√©ception d'une demande, respectivement, refl√®te les droits revendiqu√©s. Mais pourquoi ne peut-on pas attendre le m√™me volume d'√©v√©nements directement de l'audit d'acc√®s aux objets?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En effet, deuxi√®mement, il est n√©cessaire d'activer SACL sur l'objet qui est pr√©vu pour √™tre contr√¥l√©. En fait, il s'agit d'une liste similaire √† la liste des droits d'acc√®s DACL, qui d√©termine si le sujet ou l'objet cr√©√© avec son jeton recevra le succ√®s ou l'√©chec lors de la tentative d'acc√®s √† l'objet. Mais la SACL d√©termine approximativement sous la m√™me forme non pas les droits d'interagir avec l'objet, mais si des √©v√©nements de s√©curit√© seront g√©n√©r√©s lors de la demande et de l'exercice de certains droits. Ces √©v√©nements incluront les droits d'acc√®s non d√©j√† demand√©s, mais r√©ellement utilis√©s.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cons√©quence, nous obtenons un filtre qui vous permet de consigner uniquement l'acc√®s aux objets qui sont essentiels pour nous et uniquement les types d'acc√®s qui sont importants pour nous. Mais en retour, nous devons attacher une SACL directement √† chacun de ces objets ou indiquer que la SACL est h√©rit√©e de l'objet parent. Bien s√ªr, cela peut √™tre automatis√© par diff√©rentes m√©thodes. Mais le maintien de la configuration de tels outils d'automatisation ne sera probablement pas pratique. Contrairement √† une simple liste Sysmon, qui peut √©galement inclure des caract√®res g√©n√©riques, bien que particuliers. Nous parlerons du filtrage dans Sysmon dans une section s√©par√©e. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Heureusement, pour les objets de type, un processus SACL existe d√©j√† par d√©faut pour le noyau version 6.3 et sup√©rieur. Si quelqu'un peut sp√©cifier un moyen de recevoir ce SACL (recommandations de cet </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous avons √©chou√©), il sera int√©ressant d'entendre / discuter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Du c√¥t√© Sysmon, en plus des GUID et des noms de r√®gles d√©j√† discut√©s, il existe plusieurs champs plus int√©ressants. </font><font style="vertical-align: inherit;">Tout d'abord, le PID du processus cible. </font><font style="vertical-align: inherit;">Il vous permettra de surveiller l'activit√© ult√©rieure de l'objet infect√©, car il peut y avoir plusieurs instances d'un m√™me fichier ex√©cutable. </font><font style="vertical-align: inherit;">Deuxi√®mement, le champ CallTrace, qui capture les actions de la source d'√©v√©nements dans la cible. </font><font style="vertical-align: inherit;">Regardez cela et r√©alisez que ¬´tour de passe-passe et pas de fraude¬ª ne sont pas que des mots. </font><font style="vertical-align: inherit;">D'un autre c√¥t√©, une telle analyse d√©taill√©e est d√©j√† le destin de la m√©decine l√©gale. </font><font style="vertical-align: inherit;">Et quiconque a un m√©decin l√©giste d√©di√© n'est probablement pas au d√©but de la construction d'un syst√®me de surveillance.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce groupe, les √©v√©nements diff√®rent dans un assez grand nombre de champs. </font><font style="vertical-align: inherit;">Mais si dans les √©v√©nements Windows, ces informations offrent tr√®s probablement la commodit√© de l'analyse initiale, alors Sysmon capture des donn√©es uniques qui sont difficiles √† obtenir d'une autre mani√®re. </font><font style="vertical-align: inherit;">Par cons√©quent, l'avantage reste avec Sysmon.</font></font><br>
<a name="stage9"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cr√©ation de fichiers</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette cat√©gorie est incluse dans Windows comme suit: Configuration de l'ordinateur - Polcies - Param√®tres Windows - Param√®tres de s√©curit√© - Configuration de strat√©gie d'audit avanc√©e - Strat√©gies d'audit - Acc√®s aux objets - Syst√®me de fichiers d'audit - Succ√®s</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/wu/qp/wy/wuqpwygxyngiqa8db58gvoenmiu.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme le montre le tableau, tous les avantages et inconv√©nients de ce groupe sont similaires √† ceux d√©j√† d√©crits ci-dessus. Y compris les avantages et les inconv√©nients de SACL (pour les fichiers et les dossiers pour tous les utilisateurs (Tout le monde), comprend Propri√©t√©s - S√©curit√© - Avanc√© - Audit - Ajouter - Tout le monde - Succ√®s - √âcrire (pour les fichiers) ou Modifier (pour un r√©pertoire)). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez √©galement d√©finir SACL sur les fichiers de mani√®re globale en le d√©finissant dans Configuration ordinateur - Strat√©gies - Param√®tres Windows - Param√®tres de s√©curit√© - Configuration de strat√©gie d'audit avanc√©e - Strat√©gies d'audit - Acc√®s aux objets - Audit d'acc√®s global aux objets - Syst√®me de fichiers. Mais le nombre d'√©v√©nements, notamment avec les fichiers temporaires, augmentera proportionnellement au volume des op√©rations. Je ne dirais pas que c'est une approche efficace, elle n'est possible que pour une petite partie des op√©rations.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je voudrais noter les bizarreries de journalisation qui commencent ici. </font><font style="vertical-align: inherit;">Pour ce groupe ne fixe √©v√©nements Windows lorsqu'un fichier est cr√©√© par Powershell, par exemple, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le Nouveau-Point C: \ ForTest \ test.t</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dans le m√™me temps, la m√™me action s'affiche parfaitement dans les journaux Sysmon.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce groupe d'√©v√©nements est mieux enregistr√© √† l'aide de Sysmon.</font></font><br>
<a name="stage10"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Actions de registre</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jusqu'√† pr√©sent, en parlant du groupe, nous n'avons inclus qu'un seul √©v√©nement. </font><font style="vertical-align: inherit;">Cette tendance va changer ici.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/kl/wm/b0/klwmb01kl6o_14omabn-qdhjh-c.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La journalisation de ces √©v√©nements est configur√©e comme suit: Configuration de l'ordinateur - Polcies - Param√®tres Windows - Param√®tres de s√©curit√© - Configuration de strat√©gie d'audit avanc√©e - Strat√©gies d'audit - Acc√®s aux objets - Registre d'audit - Succ√®s. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La SACL pour tous les utilisateurs (tout le monde) est d√©finie comme suit: regedit.exe - branche du registre - Autorisations - Avanc√© - Audit - Tout le monde - Succ√®s - Autorisations avanc√©es - Contr√¥le total ou valeur d√©finie, Cr√©er une sous-cl√©, Cr√©er un lien, Supprimer, √âcrire DAC. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez √©galement d√©finir SACL sur les fichiers de mani√®re globale en le d√©finissant dans Configuration ordinateur - Strat√©gies - Param√®tres Windows - Param√®tres de s√©curit√© - Configuration avanc√©e de la strat√©gie d'audit - Strat√©gies d'audit - Acc√®s aux objets - Audit global de l'acc√®s aux objets - Registre. Les inconv√©nients de l'approche sont similaires aux m√™mes op√©rations sur les fichiers.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Concentrez-vous imm√©diatement sur les limites. </font><font style="vertical-align: inherit;">Pour Sysmon, toutes les op√©rations (cr√©er, modifier, supprimer) avec des √©v√©nements value ou key raise (sauf pour renommer value). </font><font style="vertical-align: inherit;">Pour les fen√™tres:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Toutes les op√©rations avec valeur d√©clenchent des √©v√©nements. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La cr√©ation d'une cl√© ne d√©clenche pas d'√©v√©nements. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Renommer la cl√© d√©clenche uniquement l'√©v√©nement Access, le nouveau nom de la cl√© n'est pas affich√©; </font><font style="vertical-align: inherit;">les droits demand√©s sp√©cifi√©s dans l'√©v√©nement n'ont pas de correspondance intuitivement non ambigu√´ avec l'op√©ration. </font><font style="vertical-align: inherit;">Ainsi, l'op√©ration de changement de nom ne peut √™tre d√©termin√©e que par la m√©thode d'exception - il n'y a pas d'√©v√©nement de suppression 4660 avec ce HandleID.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La suppression de la cl√© d√©clenche l'√©v√©nement 4663 suivi de 4660.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus des champs abord√©s dans les sections pr√©c√©dentes, il est important de noter que les √©v√©nements Windows contiennent des donn√©es anciennes et nouvelles de noms et de valeurs de cl√© et de valeur, qui pendant l'enqu√™te peuvent aider √† comprendre le motif de l'attaquant. </font><font style="vertical-align: inherit;">Surtout si les valeurs initiales ne sont pas standard ou typiques et que la configuration, y compris les donn√©es de registre de la machine faisant l'objet de l'enqu√™te, n'est stock√©e nulle part en dehors de l'h√¥te.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme nous pouvons le voir, il existe des restrictions plus strictes sur la journalisation de Windows. </font><font style="vertical-align: inherit;">Et pour corriger certains faits, une ¬´corr√©lation¬ª est n√©cessaire, quoique la plus simple. </font><font style="vertical-align: inherit;">Cependant, il est capable de fournir une plus grande quantit√© d'informations vraiment utiles. </font><font style="vertical-align: inherit;">Il est difficile de privil√©gier l'un des participants pour ce groupe d'√©v√©nements.</font></font><br>
<a name="stage11"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration WMI</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous passons √† l'avant-dernier groupe d'√©v√©nements. Ce sont des √©v√©nements WMI. Un attaquant peut cr√©er un filtre (filter) qui re√ßoit tous les √©v√©nements concernant un changement d'√©tat du syst√®me, dans notre exemple, un changement d'√©tat d'un service. Et pour effectuer certaines actions en fonction des √©v√©nements re√ßus de ce filtre, cr√©er un consommateur. Dans notre cas, il s'agit d'une entr√©e dans le fichier journal. Ensuite, il doit connecter la sortie du filtre √† l'entr√©e du consommateur, cr√©ant une liaison entre le filtre et le consommateur. Il en r√©sultera un syst√®me qui fonctionne dans des conditions donn√©es. Souvent utilis√© pour les tactiques de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">persistance</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . C'est pr√©cis√©ment dans l'ordre d√©crit que les √©v√©nements 19-21 Sysmon sont enregistr√©s.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est important de comprendre que la cr√©ation d'un filtre ou d'un consommateur en soi ne constitue pas une menace, mais peut bien s√ªr faire partie d'une attaque. De plus, pour une activit√© malveillante, un filtre existant, un consommateur ou les deux peuvent √™tre utilis√©s. Ici, c'est comme avec un couteau, ou, plus pr√®s du sujet de la ressource, avec des messagers chiffr√©s. La question n'est pas dans l'outil, mais dans son utilisation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Examinons de plus pr√®s le tableau.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/f9/bo/br/f9bobr7pus2gf7lnaxgoxcirosq.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un point important √† noter tout d'abord - l'√©v√©nement 5861 est g√©n√©r√© dans le journal sp√©cifi√© uniquement sur le fait de la cr√©ation ou de la modification ult√©rieure (y compris en termes de filtre et de consommateur) du bundle. Cela, d'une part, facilite le suivi des activit√©s pr√©tendument malveillantes (aucune corr√©lation entre deux ou trois √©v√©nements n'est n√©cessaire) si non seulement un groupe est cr√©√© en son sein. Et d'autre part, nous manquons l'heure de d√©but de cette activit√© si le filtre ou le consommateur est cr√©√© pr√©cis√©ment dans le cadre de celui-ci et √† l'avance.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Est-ce critique? Cas par cas. Si nous commen√ßons √† d√©rouler la s√©quence d'un incident et √† voir qu'un filtre ou consommateur atypique et soi-disant malveillant a √©t√© cr√©√© il y a deux ans, nous nous rendons imm√©diatement compte que les attaquants sont chez nous depuis plus de deux ans. Et des traces de l'attaque doivent √™tre recherch√©es au moins √† cette profondeur. A quelle fr√©quence ceci se passe-t-il? Telle est la question principale. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais si des modifications sont apport√©es au filtre ou au consommateur du bundle existant, nous verrons l'image enti√®re en un seul √©v√©nement. Alors que Sysmon ne refl√©tera que les modifications (cet objet) qui ont √©t√© apport√©es.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entre autres diff√©rences: dans les √©v√©nements Sysmon, les donn√©es sont refl√©t√©es sous une forme plus structur√©e et dans un format plus pratique. Par exemple, au lieu du SID dans un format atypique, la connexion de l'utilisateur est imm√©diatement pr√©sent√©e. Mais les donn√©es sont un peu moins. C'est peut-√™tre essentiel pour votre cas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous concluons avec des restrictions. Premi√®rement, malgr√© le fait que ce journal soit pr√©sent depuis Windows 2012 (noyau 6.2), nous n'avons pas pu obtenir ces √©v√©nements m√™me pour le noyau 6.3 (2012R2), qui est √©tudi√© dans l'article. Cela est peut-√™tre d√ª √† l'absence de correctifs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deuxi√®mement, selon l'auteur de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ce</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">articles, le filtre des √©v√©nements du minuteur n'est pas fix√© par Sysmon. </font><font style="vertical-align: inherit;">Il serait possible de ne pas prendre un mot, mais de v√©rifier. </font><font style="vertical-align: inherit;">De plus, la version de Sysmon est ancienne. </font><font style="vertical-align: inherit;">Mais ici, un pr√©c√©dent est important - il n'y a pas quelques types de filtres et de consommateurs WMI. </font><font style="vertical-align: inherit;">√Ä partir d'une telle √©tude, compl√©t√©e par des d√©tails, un article s√©par√© pourrait √™tre r√©dig√©. </font><font style="vertical-align: inherit;">Testez simplement les types cibles pour comprendre exactement ce qu'ils seront enregistr√©s.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce cas, nous sommes plus √† l'aise avec l'utilisation des √©v√©nements Windows. </font><font style="vertical-align: inherit;">Du point de vue de la commodit√©: plus de donn√©es, il n'y a pas besoin de corr√©lation primaire. </font><font style="vertical-align: inherit;">Donc, du point de vue de la fixation d'objectifs - il fixe la cr√©ation d'un m√©canisme (bas√© sur des pi√®ces nouvelles, modifi√©es ou existantes), et non ses pi√®ces individuelles.</font></font><br>
<a name="stage12"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Requ√™tes DNS</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous passons donc au groupe final √† comparer, mais encore loin de la conclusion de notre article. </font><font style="vertical-align: inherit;">Ce type et l'ensemble d'√©v√©nements correspondant sont r√©cents non seulement par l'apparence de notre article, mais aussi par l'ajout de Sysmon √† la bo√Æte √† outils. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au cours des derni√®res ann√©es, le sujet de l'utilisation du DNS √† d'autres fins, par exemple pour recevoir des commandes de C&amp;C ou voler des informations via ce canal, est devenu populaire. </font><font style="vertical-align: inherit;">Probablement pas par lui-m√™me - nous renverrions les histoires sur une telle utilisation des canaux ICMP et DNS √† z√©ro. </font><font style="vertical-align: inherit;">√Ä cette √©poque, des √©tudiants familiers √©taient sophistiqu√©s dans l'encapsulation du trafic de jouets afin d'atteindre les serveurs de jeux convoit√©s du r√©seau de l'institut via les seuls canaux autoris√©s (bonjour, Zhenya</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tumbochko</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">!). Cela a permis de passer le temps √† ennuyer ou √† ma√Ætriser rapidement leurs laboratoires. Et ce n'√©tait gu√®re leur id√©e. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais il n'y a pas si longtemps, un concept tel que DoH a √©t√© ajout√© √† ce canal de fuite, ce qui a compliqu√© la d√©tection du trafic DNS suspect au niveau du r√©seau. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ou peut-√™tre que c'√©tait juste un stratag√®me de marketing - pour en vendre un nouveau, qui est aussi un ancien bien oubli√©. Ou le d√©but de l'occurrence g√©n√©ralis√©e de ces canaux dans une activit√© malveillante d√©tectable. Nous n'avons pas approfondi cette question, pr√™ts √† r√©colter des c√©r√©ales - tout √† coup l'un des lecteurs d√©cide de laisser tomber un peu de sagesse dans les commentaires. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, plus pr√®s du point. Activez l'Observateur d'√©v√©nements - Journaux des applications et des services - Microsoft - Windows - √âv√©nements du client DNS - Op√©rationnel - Menu contextuel - Activer le journal.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/4o/oz/9m/4ooz9mm2kjdsagzhnxcymt5_mpq.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout comme d√©j√† discut√©. En ce qui concerne les informations sur le sujet, nous pr√™tons attention √† l'indication explicite de l'image du fichier ex√©cutable qui a ex√©cut√© la requ√™te dans l'√©v√©nement Sysmon. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous parlons de l'objet - il y a beaucoup plus d'informations dans les journaux Windows. Mais il existe plusieurs ¬´mais¬ª importants. Premi√®rement, l'information est r√©partie sur plusieurs √©v√©nements avec toutes les cons√©quences.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deuxi√®mement, les informations sont pr√©sent√©es de mani√®re non intuitive. </font><font style="vertical-align: inherit;">Pour d√©chiffrer la plupart des connaissances, il faut savoir comment les champs du package sont form√©s et avoir la capacit√© de retransformer ces donn√©es en faits qui facilitent la d√©cision de l'analyste. </font><font style="vertical-align: inherit;">On peut dire qu'en fait, l'analyste n'obtient pas en vain un salaire et pourquoi ne pas s'asseoir et le comprendre. </font><font style="vertical-align: inherit;">Oui c'est vrai. </font><font style="vertical-align: inherit;">Mais permettez-moi de vous rappeler que nous parlons d'une petite √©quipe sans sp√©cialistes √† profil √©troit, devant laquelle il n'y a pas de fin aux t√¢ches de s√©curit√© de l'information. </font><font style="vertical-align: inherit;">Et si pour chaque √©v√©nement analys√© par le SIEM, une telle t√¢che lui incombe, il ne les rattrapera pas dans quelques ann√©es.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour ce groupe, le vainqueur est difficile √† d√©terminer. </font><font style="vertical-align: inherit;">Sysmon propose une version laconique, √† partir de laquelle vous pouvez facilement extraire une bonne partie des informations utiles. </font><font style="vertical-align: inherit;">Windows propose une option avanc√©e. </font><font style="vertical-align: inherit;">Reste √† le "coudre", √† en traiter le contenu et √† se demander s'il √©tait temps d'introduire NTA?</font></font><br>
<a name="stage13"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âv√©nements Sysmon uniques</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons attribu√© les √©l√©ments suivants aux √©v√©nements uniques de Sysmon:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EID 4, 16. Bien qu'il puisse √™tre suivi via les journaux Windows, ils ne nous renseignent que sur les √©v√©nements dans Sysmon lui-m√™me. </font><font style="vertical-align: inherit;">Par cons√©quent, en son absence, ils n'ont aucun sens.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EID 2 - EID 4663 pourrait √™tre consid√©r√© comme un analogue. Mais m√™me en tenant compte des listes de droits d'acc√®s qui y sont fournies, l'√©v√©nement n'est pas aussi granulaire que EID2, et il n'est pas enrichi √† un tel √©tat avec d'autres √©v√©nements Windows.</font></font></li>
<li>EID 7-9, 17 ‚Äî   .      ETW.  ,   ,      .</li>
<li>EID 15 ‚Äî   ,    ETW.       ,      ‚Äî .</li>
<li>EID 18 ‚Äî      (named pipes)       . , -,   .  -,      ,        .       ETW.</li>
</ul><a name="stage14"></a><br>
<h1> </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe trois options pour filtrer les √©v√©nements c√¥t√© source. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le premier est disponible uniquement pour les √©v√©nements Windows et uniquement pour surveiller l'acc√®s et les op√©rations avec les objets. Impl√©ment√© √† l'aide de SACL. L'un des inconv√©nients de cette approche est la complexit√© des param√®tres granulaires (par exemple, vous ne pouvez pas uniquement surveiller les fichiers existants ou cr√©√©s avec l'extension .exe). Parmi les avantages figure la possibilit√© de limiter la liste des utilisateurs pour lesquels des op√©rations avec l'objet sont enregistr√©es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le second est disponible pour les √©v√©nements Windows et les √©v√©nements Sysmon: en utilisant Xpath, en tenant compte des restrictions impos√©es par le grand Microsoft. √âtant donn√© que la m√©thode est disponible pour les deux sources, la description d√©passe le cadre de cet article. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et le troisi√®me est la configuration Sysmon. Il existe de nombreuses options:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âmulation g√©n√©rique - contient (tout | tout), exclut (tout | tout), se termine par, commence par. </font><font style="vertical-align: inherit;">L'utilisation de contains | exludes all vous permet d'√©muler des expressions comme "C: \ Windows \ *. Exe".</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Correspondance exacte - est, n'est pas, l'image.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arithm√©tique - moins que, plus que.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il convient de noter qu'un tel filtrage n'est pas disponible pour tous les champs. </font><font style="vertical-align: inherit;">Par exemple, vous ne pouvez pas mettre sur liste blanche les hachages de logiciels standard, la cr√©ation de processus pour lesquels nous ne sommes pas int√©ress√©s. </font><font style="vertical-align: inherit;">Un exemple de notre exp√©rience - le processus l√©gitime git.exe a cr√©√© des dizaines de milliers d'√©v√©nements de d√©marrage par jour sur les h√¥tes de nos d√©veloppeurs. </font><font style="vertical-align: inherit;">Peut-√™tre, sp√©cifiquement dans ce cas, son comportement pourrait √™tre resserr√©, r√©duisant ainsi cet arbre d'√©v√©nements. </font><font style="vertical-align: inherit;">Mais exclure les fichiers ex√©cutables par nom d'image n'est pas une bonne id√©e. </font><font style="vertical-align: inherit;">Eh bien, peut-√™tre seulement un antivirus avec auto-d√©fense activ√©e.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sysmon est √©galement sur la voie d'un filtrage sophistiqu√© en combinant les conditions de diff√©rents domaines. </font><font style="vertical-align: inherit;">Vous ne pouvez cr√©er qu'un seul groupe de r√®gles pour chaque EID combin√© par des relations ET, et un seul avec des relations OU. </font><font style="vertical-align: inherit;">En cons√©quence, les conditions du formulaire (A et B) ou (C et D) ne peuvent plus √™tre √©crites. </font><font style="vertical-align: inherit;">Selon le flux filtr√©, ce fait peut ne pas donner d'avantage significatif, mais aussi donner un r√©sultat tangible.</font></font><br>
<a name="stage15"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autres fournisseurs d'√©v√©nements de base gratuits</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cette section, tout d'abord, je voudrais parler du m√©canisme </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ETW</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Event Trace for Windows). Les journaux int√©gr√©s Windows et Sysmon consignent les √©v√©nements √† l'aide de ce m√©canisme. En fait, pour chaque action du syst√®me, nous pouvons obtenir un √©v√©nement. La fa√ßon la plus simple de consulter le volume potentiel de ces √©v√©nements consiste √† activer l'option Observateur d'√©v√©nements - Afficher - Afficher les journaux d'analyse et de d√©bogage. Pour que les √©v√©nements ne remplissent pas imm√©diatement votre syst√®me, chaque journal est activ√© s√©par√©ment dans son menu contextuel. Vous regardez cette bont√© et vous posez involontairement une question - pourquoi avons-nous besoin de Sysmon avec un tel volume d'√©v√©nements divers?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le fait est que, premi√®rement, ces journaux √©taient √† l'origine destin√©s au d√©bogage et non √† des fins de s√©curit√©. Par cons√©quent, leur collection centralis√©e n'est pas fournie. En particulier, vous ne trouverez nulle part le nom de domaine complet de l'h√¥te sur lequel ils ont √©t√© cr√©√©s. La question, bien s√ªr, peut √™tre r√©solue par des utilitaires tiers de petite √† grande taille, des scripts aux services de journalisation √† part enti√®re. Mais vous devez vous rappeler qu'il s'agit d'un logiciel suppl√©mentaire dans une grande entreprise et, par cons√©quent, d'une t√¢che distincte. Permettez-moi de vous rappeler que dans l'introduction, nous sommes partis du principe du minimalisme dans l'activit√© suppl√©mentaire pour l'installation de logiciels.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et deuxi√®mement, ces journaux rapportent tellement de d√©tails sur chaque √©ternuement qu'ils doivent √©galement s√©lectionner les informations bit par bit. Les entr√©es de journal sont vraiment atomiques et n√©cessiteront une corr√©lation ou un enrichissement pr√©alable pour que l'analyste fonctionne de mani√®re productive. Apr√®s tout, un programmeur qui d√©bogue sa cr√©ation en utilisant ces √©v√©nements sait comment tout devrait fonctionner. Et un agent de s√©curit√©, en particulier d'un profil large, pense √† des niveaux d'abstraction beaucoup plus √©lev√©s. Oui, en plus, il recherche une activit√© ill√©gitime inconnue. Une telle d√©claration du probl√®me conduit √† un module logiciel suppl√©mentaire qui effectuera le pr√©traitement. Cela compliquera encore notre concept.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien que nous n'ayons pas √©t√© loin de nous connecter avec Windows, nous n'oublierons pas de mentionner WMI. Cet outil capture essentiellement les changements d'√©tat sans afficher leur source. √Ä titre d'exemple d'exception, le chargement d'une dll: affiche le module dll lui-m√™me et le processus qui le charge. Mais pour des raisons de s√©curit√©, cet √©v√©nement n√©cessite √©galement un enrichissement, car c'est l√† que ses informations sont √©puis√©es. En g√©n√©ral, l'absence de poisson et le cancer sont des poissons. Mais l'outil ne peut √™tre utilis√© qu'en suppl√©ment. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une autre option populaire, mais non abord√©e dans l'article, est l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">osquery.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Les deux principales raisons pour lesquelles nous n'avons pas envisag√© cette solution ici sont la faible fr√©quence des mises √† jour des produits (moins en termes de s√©curit√© et de fonctionnalit√©) et l'utilisation accrue des ressources syst√®me par rapport aux autres options (une base de donn√©es compl√®te est incluse). </font><font style="vertical-align: inherit;">Vraisemblablement, la solution est bien adapt√©e aux serveurs pour lesquels elle a √©t√© d√©velopp√©e. </font><font style="vertical-align: inherit;">Mais pour les postes de travail, √©ventuellement avec du mat√©riel obsol√®te - √† peine.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
R√©cemment, plusieurs autres outils sont apparus qui ne sont pas aussi r√©pandus que ceux consid√©r√©s. </font><font style="vertical-align: inherit;">Il s'agit notamment de Velociraptor et SilkETW. </font><font style="vertical-align: inherit;">Ils n'inventent pas un v√©lo et travaillent √©galement au-dessus de la norme Windows - ETW. </font><font style="vertical-align: inherit;">Compte tenu du volume de mat√©riel d√©j√† cit√©, il a √©t√© d√©cid√© de s√©parer ces outils dans une publication distincte (dans la mesure o√π le temps et les efforts sont disponibles, ainsi qu'un sentiment de demande).</font></font><br>
<a name="stage16"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion g√©n√©rale</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au cours de la comparaison, il a √©t√© montr√© que les √©v√©nements Sysmon qui ont des analogues surpassent g√©n√©ralement les √©v√©nements Windows dans leurs caract√©ristiques fonctionnelles. </font><font style="vertical-align: inherit;">Certains √©v√©nements Sysmon n'ont tout simplement pas d'alternative. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, n'oubliez pas que, premi√®rement, la solution doit √™tre choisie en fonction de vos t√¢ches. </font><font style="vertical-align: inherit;">Si vous √™tes en train de construire un syst√®me de surveillance et que la premi√®re ann√©e, vous pr√©voyez de mettre en ≈ìuvre des m√©thodes de d√©tection de sept √† dix incidents, comme l'a laiss√© Gartner, alors vous devriez avoir suffisamment d'√©v√©nements Windows. </font><font style="vertical-align: inherit;">Et peut-√™tre bien plus d'un an.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deuxi√®mement, le syst√®me de journalisation des √©v√©nements Windows est √©galement constamment mis √† jour et au cours de la r√©daction de cet article, des EID Windows tels que 4798 et 4799 sont apparus. Il est √©galement possible que l'ensemble de champs soit compl√©t√©. Ainsi, cette comparaison, bien que la plus compl√®te, bas√©e sur les informations que nous poss√©dons, n'est pas grav√©e dans la pierre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et troisi√®mement, Sysmon est toujours un outil externe, ce qui comporte un certain nombre de risques. Par exemple, nous avons eu des cas o√π l'enregistrement de chaque EID a √©t√© interrompu sans indiquer de raison. Dans ce cas, l'enregistrement d'autres √©v√©nements √©tait comme d'habitude. Des coll√®gues plus √©minents affirment que le probl√®me √©tait li√© √† des fuites de m√©moire dans la version 10.41. Mais la version 10.42, dans laquelle ce probl√®me est ferm√© en tout ou en partie (avec le changelog de Sysmon, tout n'est pas si </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√©taill√©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), n'a pas r√©solu nos probl√®mes dans cette direction. </font><font style="vertical-align: inherit;">Seul le composant de d√©sinstallation-installation est utile. </font><font style="vertical-align: inherit;">Toute s√©curit√© et bonne journ√©e! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Merci √† Timur</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zinint</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour vous aider √† pr√©parer la publication. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Il s'av√®re tr√®s difficile de maintenir un journal des modifications normal ou d'ajouter de nouvelles fonctionnalit√©s √† la description principale, comme nous l'avons d√©couvert (merci, Oncle Dim</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">shudv</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), un camion avec des nishtyaks retourn√© dans notre rue il y a d√©j√† </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9 mois</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ... R√©sum√©: dans Sysmon vous pouvez faire (A et B) ou (C et D), seulement chut ...</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr489040/index.html">Contact Center AI: un tiers dans une conversation est tr√®s bien</a></li>
<li><a href="../fr489042/index.html">Grande r√©ouverture de la boutique: chargement de donn√©es dans Android √† l'aide de coroutine</a></li>
<li><a href="../fr489044/index.html">Physique du texte. Partie 1. Symboles</a></li>
<li><a href="../fr489046/index.html">GAZ66 Monster Truck sans conducteur 1/16</a></li>
<li><a href="../fr489048/index.html">La journalisation et le suivi des requ√™tes sont les meilleures pratiques. Rapport Yandex</a></li>
<li><a href="../fr489058/index.html">Ensembles de r√©seaux de neurones avec PyTorch et Sklearn</a></li>
<li><a href="../fr489060/index.html">Analyse: quelle est la diff√©rence entre les investissements √† haut risque et les investissements √† faible risque</a></li>
<li><a href="../fr489062/index.html">Incroyable performances parall√®les d'E / S Apache Parquet en Python</a></li>
<li><a href="../fr489068/index.html">Immortalit√© num√©rique - une approche d'ing√©nierie</a></li>
<li><a href="../fr489070/index.html">Il vous en co√ªtera 354 paires de chaussettes. Une s√©lection de cadeaux pour le 23 f√©vrier</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>