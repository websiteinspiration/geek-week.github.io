<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🈵 👨🏻‍🏭 🕺🏻 Androidのcronを操作し、デバイスの起動時に自動実行するシェルスクリプトを追加する 🖼️ 👨‍👦‍👦 🕧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="モバイルデバイスには長い機能が長いため、自動化タスクを簡単にモバイルデバイスに転送できます。そして、可能な限り、それらを実行するためにcronも同様に優れています。しかし、「通常の」Linuxシステムでcronに少し時間がかかる場合、Androidデバイスは、それを構成するために、より複雑な作業を必...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Androidのcronを操作し、デバイスの起動時に自動実行するシェルスクリプトを追加する</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468337/"><img src="https://habrastorage.org/webt/t2/ia/uo/t2iauogb45suwvzulewv9wbktr8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モバイルデバイスには長い機能が長いため、自動化タスクを簡単にモバイルデバイスに転送できます。</font><font style="vertical-align: inherit;">そして、可能な限り、それらを実行するためにcronも同様に優れています。</font><font style="vertical-align: inherit;">しかし、「通常の」Linuxシステムでcronに少し時間がかかる場合、Androidデバイスは、それを構成するために、より複雑な作業を必要とします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自動化のトピックに興味があり、デバイスが起動した直後にシェルスクリプトを起動したい場合は、タイマーで開始することもできます-猫へようこそ！</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">序文</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私はAndroid向けのモバイルデバイスの自動化に取り組んでいます。また、自動スクリプトの実行中に、同じデバイスがテストに使用されている場合でも、多くの予期しない状況が発生します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最も一般的な問題：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0。自動化スクリプトが</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
期待どおりに</font><font style="vertical-align: inherit;">動作しない</font><font style="vertical-align: inherit;">1.モバイルアプリケーションが自動的にアンロードされる</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2.電話が自動的に再起動する</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3.モバイルアプリケーションが再起動後に自動的に起動しない</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4. Wi-Fiモジュールがランダムに切断され、ネットワークが見つからない、接続されないネットワークに</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5.モバイルネットワークが突然消えた</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6.電話がスリープモードになった</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7.プロキシがドロップしたか、サーバー自体またはサーバーが奇妙な答えを返した</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このため、常にデバイスを監視し、これらの予期しない状況に対処する必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/93/fb/-1/93fb-1wjpwjs3tcpvv4jzg9b2zw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、「正しい」スクリプトを含むcronを使用すると、ソフトウェアの障害を追跡し、自動化スクリプトを復元または再実行できるという結論に達しました。</font><font style="vertical-align: inherit;">しかし結局のところ、AndroidにはLinuxカーネルが含まれていますが、私が対処しなければならない特別なニュアンスがあります。</font><font style="vertical-align: inherit;">それでは、セットアップを始めましょう！</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cronセットアップ</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">環境をカスタマイズする</font></font></h3><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">USBワイヤーを使用してシェルからデバイスにアクセスするには、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adb</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">インストール</font><font style="vertical-align: inherit;">します。</font></font></li>
<li><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">開発者向け</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のセクションを開き</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">これを行うには、[ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">電話について]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セクションに移動</font><font style="vertical-align: inherit;">し、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ビルド番号</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または同様の</font><font style="vertical-align: inherit;">項目</font><font style="vertical-align: inherit;">を数回クリックします</font><font style="vertical-align: inherit;">。</font></font></li>
<li>   <b> </b>   .             .</li>
<li> <b>root</b>   .    —  <b>SuperSu</b>, <b>Magisk</b>  <b>Kingroot</b>.   4pda    root'   .  ,  root'  .</li>
<li> <b>BusyBox</b> (    4pda, ),         cron-.</li>
</ol><br>
<h3>  </h3><br>
<ol>
<li>     <b>adb shell</b> ( adb        ,    .</li>
<li><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">su</font></b><font style="vertical-align: inherit;">コマンドでrootモードに移動します</font></font><b><font style="vertical-align: inherit;"></font></b></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cronプログラムの存在を確認し、</font><b><font style="vertical-align: inherit;">crond -h</font></b><font style="vertical-align: inherit;">コマンドを使用して設定を確認します</font></font><b><font style="vertical-align: inherit;"></font></b></li>
</ol><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実行結果</font></font></b><div class="spoiler_text"><pre><code class="bash hljs">crond: invalid option -- h<font></font>
BusyBox v1.29.2-Stericson (2018-08-12 11:19:12 EDT) multi-call binary.<font></font>
<font></font>
Usage: crond -fbS -l N -d N -L LOGFILE -c DIR<font></font>
<font></font>
	-f	Foreground<font></font>
	-b	Background (default)<font></font>
	-S	Log to syslog (default)<font></font>
	-l N	Set <span class="hljs-built_in">log</span> level. Most verbose 0, default 8<font></font>
	-d N	Set <span class="hljs-built_in">log</span> level, <span class="hljs-built_in">log</span> to stderr<font></font>
	-L FILE	Log to FILE<font></font>
	-c DIR	Cron dir. Default:/var/spool/cron/crontabs</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後の行からわかるように、デフォルトの指示は</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ var / spool / cron / crontabs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクトリに保存する必要があります</font><font style="vertical-align: inherit;">。これは自動的に作成されず、コマンドを実行すると</font></font><pre><code class="bash hljs">crond -b</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> そして、プロセスが開始されたかどうかを確認します </font></font><pre><code class="bash hljs">ps | grep crond</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、それはそこにないかもしれません、なぜなら </font><font style="vertical-align: inherit;">彼は指示を得ることができませんでした。</font><font style="vertical-align: inherit;">コマンドを実行してみましょう</font></font><pre><code class="bash hljs">crond -b -fd0</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">理由は何ですか。</font><font style="vertical-align: inherit;">おそらく次のようなエラーが発生します：</font></font><br>
<code>crond: can't change directory to '/var/spool/cron/crontabs': No such file or directory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">この場合、これは正常です。</font><font style="vertical-align: inherit;">将来的には、私たち自身がcrontab実行可能ファイルへのパスを示すようになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4.シンプルなcrontabファイルを作成します。</font></font><br>
<br>
<pre><code class="bash hljs">mkdir /data/crontab
<span class="hljs-built_in">echo</span> <span class="hljs-string">"*/1 * * * * echo 'text' &gt;&gt; /sdcard/test.txt"</span> &gt; /data/crontab/root</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今、私たちは毎分ワードを追加することがタスクを持っている</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テキストを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">する</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/sdcard/test.txt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><b><font style="vertical-align: inherit;">。</font></b></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ファイル名を指定して実行：</font></font><pre><code class="bash hljs">crond -b -fd0 -c /data/crontab</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 次のログを取得します。</font></font><br>
<br>
<pre><code class="bash hljs">crond: crond (busybox 1.29.2-Stericson) started, <span class="hljs-built_in">log</span> level 0<font></font>
crond: ignoring file <span class="hljs-string">'root'</span> (no such user)<font></font>
...</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、これは少し意外です</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。whoamiコマンド</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を実行する</font><font style="vertical-align: inherit;">と、結果として</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">root</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が返されるため</font><font style="vertical-align: inherit;">です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5. crondが尋ねるので、rootユーザーを追加します。</font></font><br>
<br>
<pre><code class="bash hljs">mount -o remount,rw /system;
<span class="hljs-built_in">echo</span> <span class="hljs-string">"root:x:0:0::/system/etc/crontabs:/system/bin/sh"</span> &gt;&gt; /system/etc/passwd;<font></font>
mount -o remount,ro /system;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このファイルがないため、Androidシステムではまったく関係ないことに気付きました。</font><font style="vertical-align: inherit;">crontabファイルを保存する場所がわかっている場合は、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ system / etc / crontabsの</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行</font><font style="vertical-align: inherit;">を必要な</font><font style="vertical-align: inherit;">行に置き換えることができ</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">コマンドを再実行してください</font></font><br>
<br>
<pre><code class="bash hljs">crond -b -fd0 -c /data/crontab</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、以下を取得します。</font></font><br>
<br>
<pre><code class="bash hljs">crond: user:root entry:*/1 * * * * <span class="hljs-built_in">echo</span> <span class="hljs-string">'text'</span> &gt;&gt; /sdcard/test.txt<font></font>
111111111111111111111111111111111111111111111111111111111111<font></font>
111111111111111111111111<font></font>
11111111111111111111111111111111<font></font>
111111111111<font></font>
1111111<font></font>
crond: wakeup dt=16<font></font>
crond: file root:<font></font>
crond:  line <span class="hljs-built_in">echo</span> <span class="hljs-string">'text'</span> &gt;&gt; /sdcard/test.txt<font></font>
crond:  job: 0 <span class="hljs-built_in">echo</span> <span class="hljs-string">'text'</span> &gt;&gt; /sdcard/test.txt<font></font>
crond: can<span class="hljs-string">'t change directory to '</span>/system/etc/crontabs<span class="hljs-string">'
crond: can'</span>t change directory to <span class="hljs-string">'/var/spool/cron'</span>: No such file or directory<font></font>
crond: USER root pid 12849 cmd <span class="hljs-built_in">echo</span> <span class="hljs-string">'text'</span> &gt;&gt; /sdcard/test.txt</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ログによると、タスクはcrondに登録されていましたが、私の場合、ファイルは作成されませんでした。</font><font style="vertical-align: inherit;">問題は非常に簡単に解決できます：</font></font><br>
<br>
<pre><code class="bash hljs">mkdir -p /system/etc/crontabs</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さて、彼はそこにディレクトリが存在することを望んでいます。</font><font style="vertical-align: inherit;">もう一度始めてみます。</font></font><br>
<br>
<pre><code class="bash hljs">crond: user:root entry:*/1 * * * * <span class="hljs-built_in">echo</span> <span class="hljs-string">'text'</span> &gt;&gt; /sdcard/test.txt<font></font>
111111111111111111111111111111111111111111111111111111111111<font></font>
111111111111111111111111<font></font>
11111111111111111111111111111111<font></font>
111111111111<font></font>
1111111<font></font>
crond: wakeup dt=12<font></font>
crond: file root:<font></font>
crond:  line <span class="hljs-built_in">echo</span> <span class="hljs-string">'text'</span> &gt;&gt; /sdcard/test.txt<font></font>
crond:  job: 0 <span class="hljs-built_in">echo</span> <span class="hljs-string">'text'</span> &gt;&gt; /sdcard/test.txt<font></font>
crond: child running /system/bin/sh<font></font>
crond: USER root pid 13033 cmd <span class="hljs-built_in">echo</span> <span class="hljs-string">'text'</span> &gt;&gt; /sdcard/test.txt</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エラーはなくなり、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">crond：child running / system / bin / shという行が表示されました</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">最後に、cronは無事に完成しました。次のパートに進んでください。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シェルスクリプトの自動読み込み</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Linuxシステムには</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">init.d</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクトリがあり、システムが</font><font style="vertical-align: inherit;">起動した直後に自動起動します。このパスを試してみましょう！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1.このディレクトリがデバイスに存在するかどうかを確認します（これは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/init.d</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/system/etc/init.dです</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -これはマウントされたパーティションと同じです）。</font><font style="vertical-align: inherit;">私の場合、そうではありません。</font><font style="vertical-align: inherit;">さて、それから作成します：</font></font><br>
<br>
<pre><code class="bash hljs">mount -o remount,rw /system<font></font>
mkdir /system/etc/init.d<font></font>
chmod 0755 /system/etc/init.d<font></font>
mount -o remount,ro /system</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここにいくつかの簡単なスクリプトを追加します。例えば：</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">echo</span> <span class="hljs-string">"echo 'Init.d is working !!!' &gt;&gt; /sdcard/init_test.log"</span> &gt; /system/etc/init.d/90my_script<font></font>
chmod 777 /system/etc/init.d/90my_script</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デバイスを再起動し、奇跡が起こったかどうかを確認します...残念ながら、ファイルが表示されませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらにシステムを調べ、起動後にスクリプトを実行できるinitファイルを探します。デバイスの</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/init.rc</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">にファイルがあり</font><b><font style="vertical-align: inherit;">まし</font></b><font style="vertical-align: inherit;">た</font><font style="vertical-align: inherit;">。さて、それを変更してデバイスを再起動してみましょう：</font></font><br>
<br>
<pre><code class="bash hljs">mount -o remount,rw /
<span class="hljs-built_in">echo</span> <span class="hljs-string">"echo 'Init.d is working !!!' &gt;&gt; /sdcard/init_test.log"</span> &gt;&gt; /init.rc<font></font>
mount -o remount,ro /<font></font>
reboot</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、ファイルは再度作成されませんでした。</font><font style="vertical-align: inherit;">ファイル</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/init.rc</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を見に行った</font><b><font style="vertical-align: inherit;">ところ</font></b><font style="vertical-align: inherit;">、レコードが消え、ファイルは変更されていないように見えました。</font><font style="vertical-align: inherit;">作成日はかなり奇妙です（私の場合、70年1月1日05:00:00）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは理解を続けており、このファイルは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">boot.img</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">保存されており</font><font style="vertical-align: inherit;">、そのたびに</font><font style="vertical-align: inherit;">このファイルが</font><font style="vertical-align: inherit;">取得されることが</font><font style="vertical-align: inherit;">わかりまし</font><font style="vertical-align: inherit;">た。</font><font style="vertical-align: inherit;">そして、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">init.rc</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルの機能を変更</font><font style="vertical-align: inherit;">するには、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべてを行う必要があります</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、この問題の解決に役立つ簡単な方法があります。</font><font style="vertical-align: inherit;">この方法では、次のシェルスクリプトを使用できます（たとえば、Ryuinfernoのおかげです）。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シェルスクリプト</font></font></b><div class="spoiler_text"><pre><code class="bash hljs"><span class="hljs-meta">#!/system/bin/sh</span>
<span class="hljs-comment">#Script to enable init.d by Ryuinferno @ XDA</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-title">error_msg</span></span>(){
<span class="hljs-built_in">echo</span> <span class="hljs-string">"You do not need this mod..."</span><font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"If you are reapplying, please delete these files if present:"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"/system/bin/sysinit"</span><font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"/system/etc/install-recovery.sh"</span><font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"/system/etc/install-recovery-2.sh"</span><font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"And run again..."</span><font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"If init.d is still not working, read the FAQ part in my thread..."</span><font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Aborting..."</span><font></font>
mount -o remount,ro -t auto /system<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Ryuinferno @ XDA"</span>
<span class="hljs-built_in">exit</span> 1<font></font>
}<font></font>
<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Init.d Enabler by Ryuinferno @ XDA"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span><font></font>
sleep 1<font></font>
<font></font>
id=`id`; <font></font>
id=`<span class="hljs-built_in">echo</span> <span class="hljs-variable">${id#*=}</span>`; <font></font>
id=`<span class="hljs-built_in">echo</span> <span class="hljs-variable">${id%%\(*}</span>`; <font></font>
id=`<span class="hljs-built_in">echo</span> <span class="hljs-variable">${id%% *}</span>`
<span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$id</span>"</span> != <span class="hljs-string">"0"</span> ] &amp;&amp; [ <span class="hljs-string">"<span class="hljs-variable">$id</span>"</span> != <span class="hljs-string">"root"</span> ]; <span class="hljs-keyword">then</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"Script NOT running as root!"</span><font></font>
	sleep 1<font></font>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"Superuser access not granted!"</span><font></font>
	sleep 1<font></font>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"Please type 'su' first before running this script..."</span>
	<span class="hljs-built_in">exit</span> 1
<span class="hljs-keyword">else</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"Hello Supaa User! :P"</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span><font></font>
	sleep 1<font></font>
<span class="hljs-keyword">fi</span><font></font>
<font></font>
<span class="hljs-keyword">if</span> [ ! <span class="hljs-string">"'which busybox'"</span> ]; <span class="hljs-keyword">then</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"busybox NOT INSTALLED!"</span><font></font>
	sleep 1<font></font>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"Please install busybox first!"</span>
	<span class="hljs-built_in">exit</span> 1
<span class="hljs-keyword">else</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"busybox found!"</span><font></font>
	sleep 1<font></font>
<span class="hljs-keyword">fi</span><font></font>
<font></font>
bbb=0<font></font>
<font></font>
<span class="hljs-keyword">if</span> [ ! <span class="hljs-string">"`which grep`"</span> ]; <span class="hljs-keyword">then</span> <font></font>
	bbb=1<font></font>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"grep applet NOT FOUND!"</span><font></font>
	sleep 1<font></font>
	<span class="hljs-keyword">else</span> 
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"Awesome! grep found! :D"</span><font></font>
	sleep 1<font></font>
<span class="hljs-keyword">fi</span><font></font>
<font></font>
<span class="hljs-keyword">if</span> [ ! <span class="hljs-string">"`which run-parts`"</span> ]; <span class="hljs-keyword">then</span> <font></font>
	bbb=1<font></font>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"run-parts applet NOT FOUND!"</span><font></font>
	sleep 1<font></font>
	<span class="hljs-keyword">else</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"Good! run-parts found! :)"</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span><font></font>
	sleep 1<font></font>
<span class="hljs-keyword">fi</span><font></font>
<font></font>
<span class="hljs-keyword">if</span> [ <span class="hljs-variable">$bbb</span> -eq 1 ] ; <span class="hljs-keyword">then</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"Required applets are NOT FOUND!"</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span><font></font>
	sleep 1<font></font>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"Please reinstall busybox!"</span>
	<span class="hljs-built_in">exit</span> 1
<span class="hljs-keyword">fi</span><font></font>
<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Great! Let's proceed..."</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span><font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Press enter to continue..."</span>
<span class="hljs-built_in">read</span> enterKey<font></font>
<font></font>
clear<font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Mounting system as rewritable..."</span><font></font>
mount -o remount,rw -t auto /system<font></font>
<font></font>
sleep 1 <font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Removing old sysinit file"</span><font></font>
rm /system/bin/sysinit<font></font>
<font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Checking for the presence of sysinit in /system/bin..."</span><font></font>
sleep 1<font></font>
<span class="hljs-keyword">if</span> [ -e /system/bin/sysinit ]; <span class="hljs-keyword">then</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"sysinit found..."</span>
	<span class="hljs-keyword">if</span> [ -z <span class="hljs-string">"`cat /system/bin/sysinit | grep "</span>init.d<span class="hljs-string">"`"</span> ]; <span class="hljs-keyword">then</span>
		<span class="hljs-built_in">echo</span> <span class="hljs-string">"Adding lines to sysinit..."</span>
		<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/bin/sysinit
		<span class="hljs-built_in">echo</span> <span class="hljs-string">"# init.d support"</span> &gt;&gt; /system/bin/sysinit
		<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/bin/sysinit
		<span class="hljs-built_in">echo</span> <span class="hljs-string">"export PATH=/sbin:/system/sbin:/system/bin:/system/xbin"</span> &gt;&gt; /system/bin/sysinit
		<span class="hljs-built_in">echo</span> <span class="hljs-string">"run-parts /system/etc/init.d"</span> &gt;&gt; /system/bin/sysinit 
		<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/bin/sysinit
	<span class="hljs-keyword">else</span>
		<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>
		<span class="hljs-built_in">echo</span> <span class="hljs-string">"Your sysinit should already be running the scripts in init.d folder at boot..."</span><font></font>
		error_msg<font></font>
	<span class="hljs-keyword">fi</span>
<span class="hljs-keyword">else</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"sysinit not found, creating file..."</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"#!/system/bin/sh"</span> &gt; /system/bin/sysinit
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"# init.d support"</span> &gt;&gt; /system/bin/sysinit
	<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/bin/sysinit
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"export PATH=/sbin:/system/sbin:/system/bin:/system/xbin"</span> &gt;&gt; /system/bin/sysinit
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"run-parts /system/etc/init.d"</span> &gt;&gt; /system/bin/sysinit 
	<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/bin/sysinit
<span class="hljs-keyword">fi</span><font></font>
<font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Setting correct permissions and ownership for sysinit..."</span><font></font>
chmod 755 /system/bin/sysinit<font></font>
chown 0.2000 /system/bin/sysinit<font></font>
<font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Checking for the presence of install-recovery.sh..."</span><font></font>
sleep 1<font></font>
<span class="hljs-keyword">if</span> [ -f /system/etc/install-recovery.sh ] &amp;&amp; [ -z <span class="hljs-string">"`cat /system/etc/install-recovery.sh | grep "</span>daemon<span class="hljs-string">"`"</span> ]; <span class="hljs-keyword">then</span>
	<span class="hljs-keyword">if</span> [ ! -z <span class="hljs-string">"`cat /system/etc/install-recovery.sh | grep "</span>init.d<span class="hljs-string">"`"</span> ];<span class="hljs-keyword">then</span>
		<span class="hljs-built_in">echo</span> <span class="hljs-string">"Your install-recovery.sh seems to be already modified for init.d..."</span><font></font>
		error_msg<font></font>
	<span class="hljs-keyword">fi</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"install-recovery.sh found, renaming it as install-recovery-2.sh..."</span><font></font>
	mv /system/etc/install-recovery.sh /system/etc/install-recovery-2.sh<font></font>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"Recreating install-recovery.sh..."</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"#!/system/bin/sh"</span> &gt; /system/etc/install-recovery.sh
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"# init.d support"</span> &gt;&gt; /system/etc/install-recovery.sh
	<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/etc/install-recovery.sh
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"/system/bin/sysinit"</span> &gt;&gt; /system/etc/install-recovery.sh
	<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/etc/install-recovery.sh
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"# excecuting extra commands"</span> &gt;&gt; /system/etc/install-recovery.sh
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"/system/etc/install-recovery-2.sh"</span> &gt;&gt; /system/etc/install-recovery.sh
	<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/etc/install-recovery.sh
<span class="hljs-keyword">elif</span> [ -f /system/etc/install-recovery.sh ] &amp;&amp; [ ! -z <span class="hljs-string">"`cat /system/etc/install-recovery.sh | grep "</span>daemon<span class="hljs-string">"`"</span> ]; <span class="hljs-keyword">then</span>
	<span class="hljs-keyword">if</span> [ -f /system/etc/install-recovery-2.sh ] &amp;&amp; [ ! -z <span class="hljs-string">"`cat /system/etc/install-recovery-2.sh | grep "</span>init.d<span class="hljs-string">"`"</span> ];<span class="hljs-keyword">then</span>
		<span class="hljs-built_in">echo</span> <span class="hljs-string">"Your install-recovery-2.sh seems to be already modified for init.d..."</span><font></font>
		error_msg<font></font>
	<span class="hljs-keyword">fi</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"install-recovery.sh is used for superuser, using install-recovery-2.sh instead..."</span>
	<span class="hljs-keyword">if</span> [ -f /system/etc/install-recovery-2.sh ]; <span class="hljs-keyword">then</span>
		<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/etc/install-recovery-2.sh
		<span class="hljs-built_in">echo</span> <span class="hljs-string">"# init.d support"</span> &gt;&gt; /system/etc/install-recovery-2.sh
		<span class="hljs-built_in">echo</span> <span class="hljs-string">"/system/bin/sysinit"</span> &gt;&gt; /system/etc/install-recovery-2.sh
		<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/etc/install-recovery-2.sh
	<span class="hljs-keyword">else</span>
		<span class="hljs-built_in">echo</span> <span class="hljs-string">"#!/system/bin/sh"</span> &gt; /system/etc/install-recovery-2.sh
		<span class="hljs-built_in">echo</span> <span class="hljs-string">"# init.d support"</span> &gt;&gt; /system/etc/install-recovery-2.sh
		<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/etc/install-recovery-2.sh
		<span class="hljs-built_in">echo</span> <span class="hljs-string">"/system/bin/sysinit"</span> &gt;&gt; /system/etc/install-recovery-2.sh
		<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/etc/install-recovery-2.sh
	<span class="hljs-keyword">fi</span>
	<span class="hljs-keyword">if</span> [ -z <span class="hljs-string">"`cat /system/etc/install-recovery.sh | grep "</span>install-recovery-2.sh<span class="hljs-string">"`"</span> ]; <span class="hljs-keyword">then</span>
		<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/etc/install-recovery.sh
		<span class="hljs-built_in">echo</span> <span class="hljs-string">"# extra commands"</span> &gt;&gt; /system/etc/install-recovery.sh
		<span class="hljs-built_in">echo</span> <span class="hljs-string">"/system/etc/install-recovery-2.sh"</span> &gt;&gt; /system/etc/install-recovery.sh
		<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/etc/install-recovery.sh
	<span class="hljs-keyword">fi</span>
<span class="hljs-keyword">else</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"install-recovery.sh not found, creating it..."</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"#!/system/bin/sh"</span> &gt; /system/etc/install-recovery.sh
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"# init.d support"</span> &gt;&gt; /system/etc/install-recovery.sh
	<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/etc/install-recovery.sh
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"/system/bin/sysinit"</span> &gt;&gt; /system/etc/install-recovery.sh
	<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/etc/install-recovery.sh
<span class="hljs-keyword">fi</span><font></font>
<font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Setting the correct permissions and ownership for install-recovery.sh..."</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Also for install-recovery-2.sh if it exists..."</span><font></font>
chmod 755 /system/etc/install-recovery.sh<font></font>
chown 0.0 /system/etc/install-recovery.sh<font></font>
<span class="hljs-keyword">if</span> [ -f /system/etc/install-recovery-2.sh ]; <span class="hljs-keyword">then</span><font></font>
	chmod 755 /system/etc/install-recovery-2.sh<font></font>
	chown 0.0 /system/etc/install-recovery-2.sh<font></font>
<span class="hljs-keyword">fi</span><font></font>
<font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Checking for the presence of the init.d folder..."</span><font></font>
sleep 1<font></font>
<span class="hljs-keyword">if</span> [ -d /system/etc/init.d ]; <span class="hljs-keyword">then</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"init.d folder found..."</span>
<span class="hljs-keyword">else</span> 
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"init.d folder not found, creating the folder..."</span><font></font>
	mkdir /system/etc/init.d<font></font>
<span class="hljs-keyword">fi</span><font></font>
<font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Creating basic init.d scripts..."</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"#!/system/bin/sh"</span> &gt; /system/etc/init.d/08setperm
<span class="hljs-built_in">echo</span> <span class="hljs-string">"#set correct permissions to /system/etc/init.d folder"</span> &gt;&gt; /system/etc/init.d/08setperm
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/etc/init.d/08setperm
<span class="hljs-built_in">echo</span> <span class="hljs-string">"mount -o remount,rw -t auto /system"</span> &gt;&gt; /system/etc/init.d/08setperm
<span class="hljs-built_in">echo</span> <span class="hljs-string">"chmod -R 777 /system/etc/init.d"</span> &gt;&gt; /system/etc/init.d/08setperm
<span class="hljs-built_in">echo</span> <span class="hljs-string">"mount -o remount,ro -t auto /system"</span> &gt;&gt; /system/etc/init.d/08setperm
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/etc/init.d/08setperm<font></font>
<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"#!/system/bin/sh"</span> &gt; /system/etc/init.d/00test
<span class="hljs-built_in">echo</span> <span class="hljs-string">"#init.d test"</span> &gt;&gt; /system/etc/init.d/00test
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/etc/init.d/00test
<span class="hljs-built_in">echo</span> <span class="hljs-string">"if [ -f /data/Test.log ]; then"</span> &gt;&gt; /system/etc/init.d/00test
<span class="hljs-built_in">echo</span> <span class="hljs-string">"rm /data/Test.log"</span> &gt;&gt; /system/etc/init.d/00test
<span class="hljs-built_in">echo</span> <span class="hljs-string">"fi"</span> &gt;&gt; /system/etc/init.d/00test
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/etc/init.d/00test
<span class="hljs-built_in">echo</span> <span class="hljs-string">'echo "Init.d is working !!!" &gt;&gt; /data/Test.log'</span> &gt;&gt; /system/etc/init.d/00test
<span class="hljs-built_in">echo</span> <span class="hljs-string">'echo "excecuted on $(date +"%d-%m-%Y %r" )" &gt;&gt; /data/Test.log'</span> &gt;&gt; /system/etc/init.d/00test
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/etc/init.d/00test<font></font>
<font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Creating permissive SELinux script..."</span><font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"#!/system/bin/sh"</span> &gt;&gt; /system/etc/init.d/01permissive
<span class="hljs-built_in">echo</span> <span class="hljs-string">"#Init.d Permissive SELinux"</span> &gt;&gt; /system/etc/init.d/01permissive
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/etc/init.d/01permissive
<span class="hljs-built_in">echo</span> <span class="hljs-string">"busybox mount -o remount,rw -t auto /system"</span> &gt;&gt; /system/etc/init.d/01permissive
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/etc/init.d/01permissive
<span class="hljs-built_in">echo</span> <span class="hljs-string">"setenforce 0"</span> &gt;&gt; /system/etc/init.d/01permissive
<span class="hljs-built_in">echo</span> <span class="hljs-string">"SELINUX=permissive"</span> &gt;&gt; /system/etc/init.d/01permissive
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> &gt;&gt; /system/etc/init.d/01permissive<font></font>
<font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Setting correct permissions and ownership for init.d folder and scipts..."</span><font></font>
chmod 777 /system/etc/init.d<font></font>
chmod 777 /system/etc/init.d/08setperm<font></font>
chmod 777 /system/etc/init.d/00test<font></font>
chmod 777 /system/etc/init.d/01permissive<font></font>
chown 0.0 /system/etc/init.d<font></font>
chown 0.0 /system/etc/init.d/08setperm<font></font>
chown 0.0 /system/etc/init.d/00test<font></font>
chown 0.0 /system/etc/init.d/01permissive<font></font>
<font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Mounting system as read-only..."</span><font></font>
mount -o remount,ro -t auto /system<font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Done!!!"</span><font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Please reboot at least twice before checking /data..."</span><font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"If init.d is working, you will see a Test.log in /data..."</span><font></font>
sleep 1<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Enjoy!!! =)"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Ryuinferno @ XDA 2013"</span>
<span class="hljs-built_in">exit</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スクリプトを始めましょう！</font><font style="vertical-align: inherit;">私の場合、init.shと呼ばれます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1.モバイルデバイスのSDカードにファイルをダウンロードします。</font></font><br>
<pre><code class="bash hljs">adb push /tmp/init.sh /sdcard</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2.モバイルデバイスのメモリにコピーし、必要な権限を設定します。</font></font><br>
<pre><code class="bash hljs">adb shell<font></font>
su<font></font>
cp /sdcard/init.sh /data/init.sh<font></font>
chmod 777 /data/init.sh</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3.実行のために実行します。</font></font><br>
<pre><code class="bash hljs">/data/init.sh</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
表示されるログに注意してください。</font><font style="vertical-align: inherit;">これが私のログです：</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実行ログ</font></font></b><div class="spoiler_text"><pre><code class="bash hljs">Init.d Enabler by Ryuinferno @ XDA<font></font>
<font></font>
Hello Supaa User! :P<font></font>
<font></font>
busybox found!<font></font>
Awesome! grep found! :D<font></font>
Good! run-parts found! :)<font></font>
<font></font>
Great! Let<span class="hljs-string">'s proceed...

Press enter to continue...
Mounting system as rewritable...
Removing old sysinit file
rm: /system/bin/sysinit: No such file or directory

Checking for the presence of sysinit in /system/bin...
sysinit not found, creating file...
Setting correct permissions and ownership for sysinit...

Checking for the presence of install-recovery.sh...
install-recovery.sh not found, creating it...
Setting the correct permissions and ownership for install-recovery.sh...
Also for install-recovery-2.sh if it exists...

Checking for the presence of the init.d folder...
init.d folder found...

Creating basic init.d scripts...
Creating permissive SELinux script...
Setting correct permissions and ownership for init.d folder and scipts...

Mounting system as read-only...

Done!!!
Please reboot at least twice before checking /data...
If init.d is working, you will see a Test.log in /data...

Enjoy!!! =)
Ryuinferno @ XDA 2013</span></code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ログからわかるように、エラーは発生していません。デバイスを再起動してください。</font><font style="vertical-align: inherit;">多分誰かがすでに働いていて、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/data/Test.log</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルを見つけることができたかもしれ</font><font style="vertical-align: inherit;">ませんが、私はそれを持っていません。</font><b><font style="vertical-align: inherit;">lsコマンド</font></b><font style="vertical-align: inherit;">を使用して</font><font style="vertical-align: inherit;">、ディレクトリ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/system/etc/init.d</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">確認し</font><font style="vertical-align: inherit;">ます。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="bash hljs">00test<font></font>
01permissive<font></font>
08setperm</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、タスクは正常に作成されています。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">boot.img</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を変更する必要があるかもしれませんが</font><font style="vertical-align: inherit;">、最初に確認してみましょう</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここで、</font><b><font style="vertical-align: inherit;">install-recovery.sh</font></b><font style="vertical-align: inherit;">ファイル</font><font style="vertical-align: inherit;">は次のコマンドで</font></font><br>
<br>
<pre><code class="bash hljs">
find / -name <span class="hljs-string">"install-recovery.sh"</span><font></font>
...<font></font>
/system/bin/install-recovery.sh<font></font>
/system/etc/install-recovery.sh<font></font>
...</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、異なる場所にある2つのファイルがあります。</font><font style="vertical-align: inherit;">作成日から、スクリプトが</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/system/etc/install-recovery.sh</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクトリにファイルを作成したことがわかりますが、</font><font style="vertical-align: inherit;">場合によっては、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ system / etcに</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作成する必要があります</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ファイルの名前をbinに変更して、etcからファイルをコピーしてみましょう。</font></font><br>
<br>
<pre><code class="bash hljs">mount -o remount,rw /system<font></font>
mv /install-recovery.sh /system/bin/install-recovery2.sh<font></font>
cp /install-recovery.sh /system/bin/</code></pre><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：両方のファイルのセキュリティコンテキストが一致する必要があることに注意してください。</font><font style="vertical-align: inherit;">また、コピー中に突然道に迷った場合（理論的にはそうではないはずですが）、（たとえば、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chcon</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーティリティを使用して</font><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">復元する必要があります</font><font style="vertical-align: inherit;">。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ls -lZ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用して完全なファイル情報を表示します</font><font style="vertical-align: inherit;">。</font></font><br>
<pre><code class="bash hljs">ls -lZ /system/etc/install-recovery.sh
<span class="hljs-comment">#</span><font></font>
-rwxr-xr-x root     root              u:object_r:system_file:s0 install-recovery.sh<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u：object_r：system_file：s0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はセキュリティコンテキストです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、再びデバイスを再起動します...そして、ついに、ついに、待望の成功！</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/data/Test.log</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><b><font style="vertical-align: inherit;">が表示され</font></b><font style="vertical-align: inherit;">ました！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてが機能したら、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ system</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font><b><font style="vertical-align: inherit;">etc</font></b><font style="vertical-align: inherit;"> / </font><b><font style="vertical-align: inherit;">init.d</font></b><font style="vertical-align: inherit;">に移動し</font><font style="vertical-align: inherit;">てシェルスクリプトを作成します。</font><font style="vertical-align: inherit;">その中で、crondを実行して実行します。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">echo</span> <span class="hljs-string">"#!/system/bin/sh
crond -b -L /sdcard/error.log -c /data/crontab"</span> &gt; /system/etc/init.d/99cronstart<font></font>
chmod 777 /system/etc/init.d/99cronstart<font></font>
reboot</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ダウンロード後、crondが起動しているかどうかを確認します。</font></font><br>
<br>
<pre><code class="bash hljs">ps | grep crond<font></font>
root      414   1     9532   236   hrtimer_na 000dcf90 S crond</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、すでにそれを終了することもできますが、少し待って、ファイルにレコードがあったかどうかを確認してみましょう... </font><font style="vertical-align: inherit;">実際、このプロセスはスーパーユーザーから起動する必要があります。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">99cronstart</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルのスクリプトを変更します</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">echo</span> <span class="hljs-string">"#!/system/bin/sh
/su/bin/su -c crond -b -L /sdcard/error.log -c /data/crontab"</span> &gt; /system/etc/init.d/99cronstart<font></font>
reboot</code></pre><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：おそらくあなたの場合、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">su</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は別のパスを持っている</font><font style="vertical-align: inherit;">でしょう、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それからsu</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンド</font><b><font style="vertical-align: inherit;">を</font></b><font style="vertical-align: inherit;">使っ</font><font style="vertical-align: inherit;">てパスをあなたのものに置き換えてください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現在、Androidデバイスはcronタスクをサポートしており、自動起動用のシェルスクリプトが含まれている場合があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして最後に、プロセスにない場合にアプリケーションを実行し、アプリケーションを起動する前にメイン画面に何があったかに関する情報を保存するスクリプト：</font></font><br>
<br>
<pre><code class="bash hljs">proc=$(ps | grep <span class="hljs-string">"com.test.app"</span>)
<span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$proc</span>"</span> == <span class="hljs-string">""</span> ]; <span class="hljs-keyword">then</span><font></font>
    dumpsys window | grep CurrentFocus &gt; /sdcard/current_focus.dump<font></font>
    sleep 1<font></font>
    am start -n com.test.app/com.test.app.activities.MainActivity<font></font>
<span class="hljs-keyword">fi</span>
</code></pre></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja468321/index.html">私は燃え尽き症候群を生き延びた、またはハムスターを車輪で止める方法</a></li>
<li><a href="../ja468323/index.html">どのような騒音が集中してリラックスするのに役立ち、また重大事故で難聴を防止するか</a></li>
<li><a href="../ja468327/index.html">ギャップ-（グリッドのように）Flexboxのパディングの明るい未来</a></li>
<li><a href="../ja468331/index.html">スティーブン・ウルフラムの人生の瞬間-Mathematica、ウルフラムの作成者|アルファ、新しい種類の科学など</a></li>
<li><a href="../ja468333/index.html">Visual Studioを使用してexeファイルをデバッグおよびプロファイルする方法</a></li>
<li><a href="../ja468339/index.html">Visual Studio App Centerのダークテーマの紹介</a></li>
<li><a href="../ja468341/index.html">Windowsターミナル上のAzure Cloud Shell</a></li>
<li><a href="../ja468343/index.html">ジェフ・ベゾス：「地球のために宇宙へ行く」</a></li>
<li><a href="../ja468345/index.html">GitHubがCI / CDとアーティファクト管理で触手を開始</a></li>
<li><a href="../ja468347/index.html">MetricKit。iOSアプリケーションのパフォーマンス分析</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>