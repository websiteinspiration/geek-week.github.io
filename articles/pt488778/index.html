<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßòüèø ‚ÅâÔ∏è üèÇüèæ Estruturas de dados: uma lista que pode fazer tudo * üëàüèø ü¶ì üç±</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="* Por tudo, quero dizer a execu√ß√£o relativamente r√°pida de opera√ß√µes em um √∫nico elemento de uma matriz. 
 
 As estruturas de dados que implementam a ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Estruturas de dados: uma lista que pode fazer tudo *</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/488778/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* Por tudo, quero dizer a execu√ß√£o relativamente r√°pida de opera√ß√µes em um √∫nico elemento de uma matriz. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As estruturas de dados que implementam a lista est√£o completas. </font><font style="vertical-align: inherit;">Todo mundo tem suas pr√≥prias vantagens e desvantagens. </font><font style="vertical-align: inherit;">Por exemplo, no mundo Java - dependendo das opera√ß√µes necess√°rias - voc√™ pode usar:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">add (obj), get (obj), set (index, obj): um conjunto b√°sico de quase todas as listas, por exemplo, ArrayList. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">add (index, obj): estruturas semelhantes a √°rvores, por exemplo, TreeList de apache common-collections. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remove (index): o mesmo que acima. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cont√©m (obj), indexOf (obj): voc√™ pode usar v√°rios ArrayList e HashMap. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remove (obj): ... Acho dif√≠cil responder. </font><font style="vertical-align: inherit;">Em alguns casos, voc√™ pode conviver com um LinkedHashSet. </font><font style="vertical-align: inherit;">√â resolvido trivialmente na presen√ßa dos dois pontos anteriores, mas que estruturas podem ambas rapidamente?</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando eu precisava de uma estrutura com adi√ß√£o r√°pida (obj), get (index), remove (index) e indexOf (obj), o google n√£o dava uma resposta. N√£o encontrei nenhum exemplo de c√≥digo ou descri√ß√£o de tais estruturas. Talvez eu n√£o estivesse olhando para l√°, tive que inventar eu mesma. Mas se algu√©m soltar o link nos coment√°rios, eu aprecio muito. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Talvez algu√©m tenha percebido que voc√™ pode usar um TreeList, que pode inserir / remover itens rapidamente no meio da lista e adicionar um HashMap do objeto ao √≠ndice no TreeList para execu√ß√£o r√°pida de indexOf (obj). E ser√° uma decis√£o simples, elegante, mas incorreta. Afinal, ao adicionar ao meio ou remover do meio, ser√° necess√°rio recalcular os √≠ndices, em m√©dia, para metade dos elementos. Isso degradar√° o desempenho para O (n).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A seguir, falarei sobre uma estrutura de dados que pode fazer todas as op√ß√µes acima. Que executa qualquer opera√ß√£o em um elemento no tempo O (log (n)). Bem, quase - pois o logaritmo √© realizado no caso em que todos os objetos da lista s√£o diferentes. Se a lista contiver os mesmos objetos, √© poss√≠vel reduzir o desempenho at√© O (log (n) ^ 2).</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avisarei imediatamente que n√£o pintarei o c√≥digo aqui. </font><font style="vertical-align: inherit;">Pode ser bastante complicado para o artigo. </font><font style="vertical-align: inherit;">Mas √©, escrito em Java. </font><font style="vertical-align: inherit;">Baseado na classe TreeList do apache common-collections. </font><font style="vertical-align: inherit;">A solicita√ß√£o pull j√° existe, mas no momento da reda√ß√£o, o artigo ainda n√£o foi lan√ßado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, n√£o descreverei algoritmos conhecidos. </font><font style="vertical-align: inherit;">Por exemplo, algoritmos de balanceamento de √°rvore. </font><font style="vertical-align: inherit;">Para a maioria, pode ser suficiente tomar como certo o fato de que a √°rvore pode ser mantida equilibrada. </font><font style="vertical-align: inherit;">Isso n√£o afeta o entendimento da id√©ia geral. </font><font style="vertical-align: inherit;">Quem quer saber mais pode encontrar facilmente informa√ß√µes. </font><font style="vertical-align: inherit;">Mas vou falar brevemente sobre algumas coisas b√°sicas, porque sem o conhecimento do b√°sico, muitos elementos-chave n√£o podem ser entendidos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os links estar√£o no final.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por que isso √© necess√°rio?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na verdade, n√£o √© t√£o f√°cil criar situa√ß√µes em que tudo √© necess√°rio diretamente da lista. </font><font style="vertical-align: inherit;">√â improv√°vel que isso seja algum tipo de estrutura super necess√°ria, caso contr√°rio todos saberiam sobre isso. </font><font style="vertical-align: inherit;">No entanto, alguns exemplos em que essa lista pode ser √∫til podem ser dados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Reconhe√ßo que muitos dos exemplos s√£o absurdos. </font><font style="vertical-align: inherit;">Tudo ou quase tudo pode ser resolvido de outra maneira.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Armazenamento em cache e compacta√ß√£o</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Minha tarefa inicial, por causa da qual comecei a pesquisar o assunto. </font><font style="vertical-align: inherit;">Jogou com compacta√ß√£o de dados espec√≠ficos e precisava de uma lista para o cache do objeto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A id√©ia √© a seguinte: ao processar outro objeto, procuramos na lista. </font><font style="vertical-align: inherit;">Se n√£o encontrado, salve o objeto e adicione-o ao topo da lista. </font><font style="vertical-align: inherit;">Se encontrado, pegamos seu √≠ndice na lista e, em vez do objeto, salvamos apenas seu √≠ndice, ap√≥s o qual movemos o objeto para o topo da lista. </font><font style="vertical-align: inherit;">Assim, os objetos que ocorrem geralmente recebem √≠ndices pequenos e os objetos que ocorrem apenas uma vez acabam sendo movidos para o final da lista e exclu√≠dos.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Virar</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se, em vez da fila FIFO usual, para algumas tarefas, uma estrutura semelhante for usada, as seguintes opera√ß√µes poder√£o ser realizadas:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Responda √† pergunta: quantas tarefas est√£o na fila antes desta tarefa. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remova as tarefas da fila. </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â como em um supermercado. </font><font style="vertical-align: inherit;">Se voc√™ veio para uma barra de chocolate, mas v√™ que a linha est√° se movendo lentamente, talvez a barra de chocolate n√£o seja t√£o necess√°ria? </font><font style="vertical-align: inherit;">:)</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tabela de pontua√ß√£o</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suponha que queremos armazenar o tempo durante o qual os jogadores completam um n√≠vel em um jogo. </font><font style="vertical-align: inherit;">Existem muitos jogadores e todos eles competem, tentando mostrar o tempo m√≠nimo. </font><font style="vertical-align: inherit;">Os dados do jogador podem ser colocados em uma matriz e classificados por tempo. </font><font style="vertical-align: inherit;">Usando essa estrutura, voc√™ pode:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mova os jogadores para o topo da lista se eles apresentarem melhores resultados do que antes. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remova os jogadores da lista, por exemplo, no caso de uma proibi√ß√£o de trapa√ßa. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mostre a cada jogador onde ele est√°. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mostrar a tabela de registros p√°gina por p√°gina. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mostre uma tabela esparsa em locais, por exemplo, hor√°rio 1, 2, 3, 5, 10, 20, 50, 100, 1000, 10000 locais. </font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estrutura de dados</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A estrutura √© baseada em uma √°rvore com uma chave impl√≠cita. </font><font style="vertical-align: inherit;">√â nessa abordagem, por exemplo, que TreeList nas cole√ß√µes comuns do apache se baseia. </font><font style="vertical-align: inherit;">Para seguir em frente, voc√™ precisa entender como essa estrutura funciona.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Årvore de chaves impl√≠cita</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma √°rvore consiste em n√≥s (n√≥s). </font><font style="vertical-align: inherit;">Cada n√≥ cont√©m um link para um objeto que √© armazenado no n√≥ e 2 links para outros n√≥s: esquerdo e direito. </font><font style="vertical-align: inherit;">O n√≥ superior √© chamado n√≥ raiz. </font><font style="vertical-align: inherit;">No caso mais simples, o n√≥ se parece com isso:</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span>&lt;<span class="hljs-type">T</span>&gt; </span>{<font></font>
  obj: T<font></font>
  left: Node&lt;T&gt;<font></font>
  right: Node&lt;T&gt;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na √°rvore bin√°ria cl√°ssica de cada n√≥ na sub√°rvore esquerda, todos os objetos s√£o menores que no n√≥ atual e no direito - grande. </font><font style="vertical-align: inherit;">Por exemplo:</font></font><br>
<br>
<pre><code class="plaintext hljs">                             [ element: 25 ]<font></font>
                           /                 \<font></font>
                          /                   \<font></font>
          [ element: 14 ]                       [ element: 45 ]<font></font>
           /          \                           /          \<font></font>
          /            \                         /            \<font></font>
[ element: 10 ]    [ element: 22 ]     [ element: 27 ]    [ element: 90 ]<font></font>
                    /          \                            /<font></font>
                   /            \                          /<font></font>
            [ element: 17 ] [ element: 23 ]         [ element: 80 ] </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas, para nosso prop√≥sito, essa √°rvore n√£o √© adequada. N√£o precisamos armazenar objetos classificados, mas precisamos ter acesso a eles por √≠ndice, como em uma matriz. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como posso colocar uma matriz em uma √°rvore? Vamos selecionar um elemento com o √≠ndice i no meio da matriz. Coloque o i-√©simo elemento da matriz no n√≥ raiz. 2 sub√°rvores saem do n√≥ raiz. Na sub√°rvore esquerda, colocamos metade da matriz com √≠ndice &lt;i, e na direita, com √≠ndice&gt; i. Como fazer isso? Da mesma forma: selecionamos um elemento do meio em um sub-arranjo, colocamos esse elemento em um n√≥, obtemos mais 2 sub-arranjos menores. E assim, at√© colocarmos todos os elementos da matriz nos n√≥s da √°rvore. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, uma matriz com os elementos ["q", "w", "e", "r", "t", "y", "u"] pode ter a seguinte apar√™ncia:</font></font><br>
<br>
<pre><code class="plaintext hljs">                            [el: r,  size: 7]<font></font>
                           /        :        \<font></font>
                          /         :         \<font></font>
         [el: w, size: 3]           :           [el: y, size: 3]<font></font>
           /     :    \             :             /    :     \<font></font>
          /      :     \            :            /     :      \<font></font>
[el: q, size: 1] : [el: e, size: 1] : [el: t, size: 1] : [el: u, size: 1]<font></font>
        :        :         :        :         :        :         :<font></font>
        :        :         :        :         :        :         :<font></font>
       [q]      [w]       [e]      [r]       [t]      [y]       [u]<font></font>
<font></font>
Index:  0        1         2        3         4        5         6</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O elemento do meio na matriz "r", n√≥s o colocamos no n√≥ raiz. Duas sub-matrizes ["q", "w", "e"] e ["t", "y", "u"] s√£o colocadas nas sub√°rvores esquerda e direita. Para isso, os elementos centrais s√£o selecionados a partir das sub-matrizes, no nosso caso, s√£o "w" e "y" e se enquadram nos n√≥s do pr√≥ximo n√≠vel. E assim por diante </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No nosso caso, a √°rvore √© equilibrada, a profundidade de todas as sub√°rvores √© a mesma. Mas isso n√£o precisa ser assim. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na figura acima, cada n√≥, al√©m do elemento e links para os n√≥s esquerdo e direito, cont√©m o n√∫mero de elementos de toda a sub√°rvore. Esta informa√ß√£o deve ser atualizada corretamente quando a √°rvore for alterada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos ver como encontrar, por exemplo, um elemento com √≠ndice = 4 nessa √°rvore.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Iniciamos o rastreamento a partir do n√≥ raiz (raiz, no nosso caso, com o elemento "r"). Temos tr√™s op√ß√µes: j√° estamos no n√≥ direito, o n√≥ direito √† esquerda, o n√≥ direito √† direita. Para entender onde procurar o elemento desejado, voc√™ precisa comparar o tamanho da sub√°rvore esquerda (no nosso caso left.size = 3) e o √≠ndice atual (no nosso caso 4). Se esses 2 n√∫meros forem iguais, encontramos o n√≥ necess√°rio e o elemento desejado. Se o tamanho da sub√°rvore esquerda for maior, o n√≥ necess√°rio na sub√°rvore esquerda. Se for menor, ser√° necess√°rio procurar na sub√°rvore direita, mas reduzir o √≠ndice desejado: index = index - left.size - 1. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como no nosso caso left.size &lt;index, estamos procurando na sub√°rvore direita o elemento com o novo √≠ndice 4 - 3 - 1 = 0. Mova para o n√≥ com o elemento "y".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, fazemos a mesma coisa que fizemos no n√≥ raiz. Compare left.size e index. Desde 1&gt; 0, olhamos na sub√°rvore esquerda, movemos para o n√≥ com o elemento "t". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√£o h√° sub√°rvore esquerda neste n√≥ e seu tamanho √© 0. index = left.size, o que significa que encontramos um n√≥ com o √≠ndice 4 e podemos obter o elemento necess√°rio "t" a partir dele. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No pseudo-c√≥digo, √© algo parecido com isto:</font></font><br>
<br>
<pre><code class="kotlin hljs">function <span class="hljs-keyword">get</span>(node: Node&lt;T&gt;, index: int): T {
  <span class="hljs-keyword">val</span> leftSize: int = (node.left == <span class="hljs-literal">null</span>) ? <span class="hljs-number">0</span> : node.left.size;
  <span class="hljs-keyword">if</span> (leftSize == index) {
    <span class="hljs-keyword">return</span> node.obj;<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (leftSize &gt; index) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">get</span>(node.left, index);<font></font>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">get</span>(node.right, index ‚Äî leftSize ‚Äî <span class="hljs-number">1</span>);<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentei descrever o princ√≠pio principal de como colocar uma matriz em uma √°rvore. </font><font style="vertical-align: inherit;">Essa estrutura funciona, √© claro, mais lentamente que a matriz cl√°ssica, para O (log (n)) versus O (1). </font><font style="vertical-align: inherit;">Mas tem uma vantagem importante: adicionar um elemento ao meio ou remover do meio tamb√©m funciona para O (log (n)) versus O (n) para a matriz. </font><font style="vertical-align: inherit;">Obviamente, desde que a √°rvore esteja mais ou menos equilibrada. </font><font style="vertical-align: inherit;">Existem muitos algoritmos para manter uma √°rvore de maneira quase equilibrada. </font><font style="vertical-align: inherit;">Por exemplo, √°rvore vermelho-preta, √°rvore AVL, √°rvore cartesiana. </font><font style="vertical-align: inherit;">N√£o anotarei os detalhes do balanceamento da √°rvore, qualquer algoritmo √© adequado para n√≥s. </font><font style="vertical-align: inherit;">Vamos apenas assumir que a √°rvore √© equilibrada em m√©dia e sua profundidade m√°xima n√£o √© muito diferente da m√≠nima.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Otimiza√ß√£o leve</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A abordagem descrita acima, com a verifica√ß√£o do tamanho da √°rvore √† esquerda, √© conveniente para a percep√ß√£o, mas pode ser feita com um pouco mais de efici√™ncia. Para n√£o olhar para a sub√°rvore esquerda a cada vez, em vez do tamanho da √°rvore, √© poss√≠vel armazenar no n√≥ sua posi√ß√£o em rela√ß√£o √† posi√ß√£o do n√≥ pai. O n√≥ raiz armazena uma posi√ß√£o absoluta que corresponde ao tamanho da sub√°rvore esquerda.</font></font><br>
<br>
<pre><code class="plaintext hljs">                             [el: r, pos: 3]<font></font>
                           /        :        \<font></font>
                          /         :         \<font></font>
         [el: w, pos: -2]           :           [el: y, pos: +2]<font></font>
           /     :    \             :             /    :     \<font></font>
          /      :     \            :            /     :      \<font></font>
[el: q, pos: -1] : [el: e, pos: +1] : [el: t, pos: -1] : [el: u, pos: +1]<font></font>
        :        :         :        :         :        :         :<font></font>
        :        :         :        :         :        :         :<font></font>
       [q]      [w]       [e]      [r]       [t]      [y]       [u]<font></font>
<font></font>
Index:  0        1         2        3         4        5         6</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, o n√≥ raiz "r" tem a posi√ß√£o 3. O n√≥ "w" tem a posi√ß√£o -2 em rela√ß√£o ao n√≥ pai ou a posi√ß√£o absoluta 3 + (-2) = 1. Da mesma forma, voc√™ pode descer mais um n√≠vel, por exemplo, o n√≥ "e" tem a posi√ß√£o 3 + (-2) + (+1) = 2. Ou seja, </font><font style="vertical-align: inherit;">O √≠ndice do n√≥ √© a soma das posi√ß√µes da raiz da √°rvore at√© esse n√≥. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essa otimiza√ß√£o, al√©m de uma pesquisa mais r√°pida por um item da lista, fornecer√° uma pesquisa mais r√°pida e f√°cil para o √≠ndice no n√≥. </font><font style="vertical-align: inherit;">Mas, √© claro, atualizar corretamente a posi√ß√£o ao mudar a √°rvore se tornou um pouco mais dif√≠cil.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adicionar indexa√ß√£o</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim, na √°rvore, podemos pegar um elemento por √≠ndice, alterar seu valor, adicionar elementos ao meio e excluir. Basicamente, precisamos apenas adicionar uma pesquisa r√°pida de √≠ndice por valor, indexOf (obj). Em seguida, cont√©m (obj) e remove (obj) ser√£o resolvidos trivialmente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas primeiro, vamos simplificar um pouco a tarefa. Vamos criar uma estrutura que armazene apenas elementos √∫nicos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para procurar algo rapidamente, eles geralmente usam uma tabela. No mundo Java, as tabelas s√£o chamadas de Mapa, com duas implementa√ß√µes principais: HashMap e TreeMap. A chave da tabela ser√° um link para o objeto e o valor ser√° um link para seu n√≥:</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IndexedTreeListSet</span>&lt;<span class="hljs-type">T</span>&gt; </span>{<font></font>
  root: Node&lt;T&gt;<font></font>
  indexMap: Map&lt;T, Node&lt;T&gt;&gt;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essa. a estrutura consiste em duas partes: a pr√≥pria √°rvore de lista e a tabela com links para objetos e n√≥s desta √°rvore. Ao atualizar a √°rvore, a tabela tamb√©m deve ser atualizada. N√£o vou descrever o processo em detalhes. Intuitivamente, deve ser compreens√≠vel: adicione um n√≥ - coloque-o na tabela, exclua-o - exclua-o da tabela. Na pr√°tica, h√° nuances no balanceamento da √°rvore: o algoritmo deve alterar os links entre os n√≥s e n√£o mover objetos entre os n√≥s. Caso contr√°rio, voc√™ precisar√° fazer muitas atualiza√ß√µes na tabela e o desempenho diminuir√°. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ok, vamos assumir que podemos encontrar rapidamente o n√≥ pelo elemento que ele cont√©m. E da√≠? Precisamos encontrar seu √≠ndice, mas isso ainda n√£o pode ser feito. Mas podemos complicar a classe do n√≥ para que ela contenha n√£o apenas links para os n√≥s esquerdo e direito, mas tamb√©m para seu pai:</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span>&lt;<span class="hljs-type">T</span>&gt; </span>{<font></font>
  obj: T<font></font>
  left: Node&lt;T&gt;<font></font>
  right: Node&lt;T&gt;<font></font>
  parent: Node&lt;T&gt;<font></font>
  pos: int<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviamente, atualizar a √°rvore √© um pouco mais complicado, porque agora precisamos atualizar cuidadosamente o link para o pai. Mas agora, conhecendo o n√≥, podemos subir na √°rvore e calcular o √≠ndice de qualquer n√≥. Se usamos a otimiza√ß√£o do cap√≠tulo anterior, precisamos apenas calcular a soma das posi√ß√µes do n√≥ atual at√© a raiz. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para uma lista que cont√©m elementos exclusivos, o problema pode ser considerado resolvido.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â verdade que temos um pequeno problema. </font><font style="vertical-align: inherit;">Suponha que chamamos set (index, obj). </font><font style="vertical-align: inherit;">Podemos facilmente substituir um elemento em um n√≥ por outro, mas apenas se ainda n√£o houver um novo elemento na lista. </font><font style="vertical-align: inherit;">E se sim, o que devo fazer? </font><font style="vertical-align: inherit;">Retire o excesso de item da posi√ß√£o antiga e coloque um novo? </font><font style="vertical-align: inherit;">Ou vice-versa, primeiro adicione e exclua? </font><font style="vertical-align: inherit;">O resultado pode ser diferente. </font><font style="vertical-align: inherit;">E voc√™ n√£o pode fazer nada ou lan√ßar uma exce√ß√£o. </font><font style="vertical-align: inherit;">N√£o h√° solu√ß√£o perfeita. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A classifica√ß√£o por m√©todos padr√£o dessa lista, provavelmente, tamb√©m n√£o funcionar√°. </font><font style="vertical-align: inherit;">Afinal, o algoritmo de classifica√ß√£o n√£o saber√° sobre a necessidade de exclusividade de objetos e criar√° duplicatas ao mover itens na lista.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Removemos a singularidade</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ok, complicando ainda mais as coisas, vamos manter os mesmos objetos. Obviamente, voc√™ precisa fazer algo com a mesa. A primeira id√©ia para armazenar uma lista de n√≥s nela n√£o parece muito boa: com um aumento no tamanho da lista, o desempenho se deteriorar√°. At√© O (n) se todos os itens da lista forem iguais. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o vamos tentar armazenar uma √°rvore classificada de n√≥s em uma tabela em vez de em uma lista. Classificado por posi√ß√£o na lista.</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IndexedTreeList</span>&lt;<span class="hljs-type">T</span>&gt; </span>{<font></font>
  root: Node&lt;T&gt;<font></font>
  indexMap: Map&lt;T, TreeSet&lt;Node&lt;T&gt;&gt;&gt;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, a inser√ß√£o / exclus√£o de / para o TreeSet &lt;N√≥&gt; de tamanho m ocorrer√° durante as compara√ß√µes de log (m) das posi√ß√µes dos n√≥s e cada compara√ß√£o ocorrer√° durante o tempo de log (n). A complexidade final da inser√ß√£o ou exclus√£o em uma estrutura semelhante ocorrer√° em O (log (n) * (1 + log (m))), onde n √© o n√∫mero total de elementos na lista e m √© o n√∫mero de elementos na lista igual ao inserido / exclu√≠do. No pior caso, quando todos os elementos s√£o iguais, obtemos a complexidade O (log (n) ^ 2).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um leitor atento provavelmente contestar√°: mas e a imutabilidade? </font><font style="vertical-align: inherit;">Afinal, n√£o podemos alterar objetos se forem chaves de tabela? </font><font style="vertical-align: inherit;">Em geral, √©. </font><font style="vertical-align: inherit;">No entanto, para uma √°rvore que armazena objetos classificados em chaves, al√©m das regras padr√£o para compara√ß√µes, √© suficiente preservar o invariante: se a &lt;b, essa propriedade n√£o deve mudar com o tempo. </font><font style="vertical-align: inherit;">Este √© apenas o nosso caso: se a posi√ß√£o de um n√≥ for menor que a posi√ß√£o de outro n√≥, essa propriedade ser√° preservada, independentemente de quantos n√≥s foram adicionados ou exclu√≠dos entre eles.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√â poss√≠vel tornar a estrutura persistente?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Resposta curta: n√£o, √© imposs√≠vel. </font><font style="vertical-align: inherit;">Devido √† bioconectividade da √°rvore, da raiz √†s folhas e costas, temos todos os n√≥s da √°rvore conectados a cada um. </font><font style="vertical-align: inherit;">A persist√™ncia n√£o pode ser feita dessa maneira; voc√™ precisa recriar toda a estrutura com qualquer altera√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas tenho um entendimento de como implementar uma estrutura persistente para casos em que n√£o precisamos inserir elementos no meio da lista. </font><font style="vertical-align: inherit;">Voc√™ pode adicionar elementos ao come√ßo ou ao fim e excluir do meio. </font><font style="vertical-align: inherit;">As demais propriedades s√£o as mesmas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ estiver interessado, tentarei escrever um artigo sobre essa estrutura. </font><font style="vertical-align: inherit;">Talvez eu at√© o implemente em Java, Kotlin ou Scala. </font><font style="vertical-align: inherit;">Mas, muito provavelmente, n√£o ser√° em breve.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alguns recursos de implementa√ß√£o</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui, quero descrever alguns recursos que tive que enfrentar. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sobre uma das otimiza√ß√µes sobre o armazenamento da posi√ß√£o do n√≥ na lista, escrevi acima. Aqui se manifesta a for√ßa do c√≥digo-fonte aberto: peguei o c√≥digo TreeList pronto e n√£o mergulhei nos detalhes da √°rvore AVL, rota√ß√µes de n√≥s, atualiza√ß√µes de posi√ß√£o etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outro recurso herdado do TreeList s√£o os links para as sub√°rvores nas folhas das √°rvores. Cada n√≥ armazena leftIsPrevious e rightIsNext. Essas vari√°veis ‚Äã‚Äãindicam a presen√ßa ou aus√™ncia de uma sub√°rvore esquerda / direita. Se n√£o houver sub√°rvore, em esquerda / direita, em vez de um link para a sub√°rvore, ser√° armazenado um link para o n√≥ que corresponde ao elemento anterior ou ao pr√≥ximo. No nosso exemplo, ["q", "w", "e", "r", "t", "y", "u"] o n√≥ "e" √© frondoso, n√£o possui sub√°rvores. Assim, leftIsPrevious e rightIsNext s√£o verdadeiros, e esquerda e direita apontam para os n√≥s "w" e "r", respectivamente. Essa abordagem ajuda a percorrer a lista mais rapidamente. E isso interfere na programa√ß√£o de novos recursos :)</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um pouco sobre como trabalhar com o objeto de tabela ‚Üí n√≥. Idealmente, voc√™ precisa colocar um elemento na tabela uma vez ao adicion√°-lo √† estrutura e exclu√≠-lo uma vez ao excluir da estrutura. Na pr√°tica, n√£o consegui isso. Quando voc√™ adiciona um item, ele √© adicionado √† tabela, tudo est√° como deveria. No entanto, quando voc√™ exclui um item, o algoritmo de balanceamento √†s vezes move itens entre os n√≥s. O resultado s√£o duas exclus√µes e um registro na tabela em vez de uma exclus√£o. Isso pode ser corrigido se voc√™ remover a otimiza√ß√£o de leftIsPrevious e rightIsNext. E at√© obtenha um pequeno ganho de desempenho, e n√£o apenas durante a remo√ß√£o. Em alguns testes, o aumento foi de 10 a 20%. Mas a velocidade da itera√ß√£o cai significativamente, 1,5-2,5 vezes nos meus testes. Decidi deixar a otimiza√ß√£o por enquanto.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em Java, os principais tipos de tabelas s√£o HashMap e TreeMap. Para uma tabela, um objeto ‚Üí um n√≥ usa o HashMap por padr√£o. No entanto, voc√™ pode usar o TreeMap com um comparador espec√≠fico de tarefas. Nesse caso, indexOf (obj) e remove (obj) procurar√£o / excluir√£o o objeto que √© igual ao objeto especificado, de acordo com o c√≥digo do Comparador. Por exemplo, armazenamos uma lista de usu√°rios e o comparador compara os usu√°rios apenas pelo nome. Em seguida, podemos responder √† pergunta ‚ÄúQuais posi√ß√µes da lista s√£o usu√°rios com o nome 'Napole√£o?'‚Äù. Ou remova todos os Napole√µes da lista :). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A estrutura n√£o suporta nulo. Voc√™ pode consert√°-lo, mas n√£o h√° a sensa√ß√£o de que seja necess√°rio.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quanto ao fato de a estrutura ‚Äúsaber tudo‚Äù, eu, √© claro, era um pouco enganadora. </font><font style="vertical-align: inherit;">Obviamente, ao trabalhar com elementos √∫nicos, tudo est√° bem e sob certas condi√ß√µes, mesmo para o logaritmo. </font><font style="vertical-align: inherit;">No entanto, ela n√£o sabe algumas coisas que outras estruturas podem. </font><font style="vertical-align: inherit;">Por exemplo, uma √°rvore cartesiana com uma chave impl√≠cita, havia artigos sobre ela no hub </font><font style="vertical-align: inherit;">Ele n√£o sabe como fazer indexOf rapidamente, mas sabe como criar uma sublist e concatenar duas listas em uma para o logaritmo (em m√©dia, n√£o garantido), al√©m de poder ser persistente.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atua√ß√£o</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em Java, o desempenho √© geralmente medido usando a estrutura jmh. </font><font style="vertical-align: inherit;">Os testes foram conduzidos no MacBook Pro de 2017 sob Java11. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comparei o desempenho do ArrayList padr√£o, TreeList do apache common-collections e minhas duas classes IndexedTreeList e IndexedTreeListSet em v√°rios cen√°rios. </font><font style="vertical-align: inherit;">Em cada cen√°rio, foram executadas 1000 opera√ß√µes do mesmo tipo, portanto o resultado deve ser multiplicado por 1000.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√≥digo sob o spoiler</font></font></b><div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-meta">@Fork(1)</span>
<span class="hljs-meta">@Warmup(iterations = 3)</span>
<span class="hljs-meta">@Measurement(iterations = 5)</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PerformanceCompare</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Map&lt;String, Class&gt; CLASSES = Stream.of(TreeList.class, IndexedTreeListSet.class, IndexedTreeList.class,<font></font>
            ArrayList.class)<font></font>
            .collect(Collectors.toMap(c -&gt; c.getSimpleName(), c -&gt; c));<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> ITERATIONS = <span class="hljs-number">1000</span>;<font></font>
<font></font>
    <span class="hljs-meta">@State(Scope.Benchmark)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Plan</span> </span>{<font></font>
<font></font>
        <span class="hljs-meta">@Param({"10", "100", "1000", "10000", "100000", "1000000"/*, "10000000"*/})</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> size;<font></font>
<font></font>
        <span class="hljs-meta">@Param({"ArrayList", "TreeList", "IndexedTreeList", "IndexedTreeListSet"})</span>
        <span class="hljs-keyword">public</span> String className;<font></font>
<font></font>
        <span class="hljs-keyword">private</span> Random random;
        <span class="hljs-keyword">private</span> List&lt;Integer&gt; list;<font></font>
<font></font>
        <span class="hljs-meta">@Setup</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IllegalAccessException, InstantiationException </span>{<font></font>
            random = <span class="hljs-keyword">new</span> Random();<font></font>
            list = (List&lt;Integer&gt;) CLASSES.get(className).newInstance();<font></font>
<font></font>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; size; i++) {<font></font>
                list.add(i);<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
<font></font>
<font></font>
    <span class="hljs-meta">@Benchmark</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">indexOfKnown</span><span class="hljs-params">(Plan plan, Blackhole blackhole)</span> </span>{<font></font>
        List&lt;Integer&gt; list = plan.list;<font></font>
        Random random = plan.random;<font></font>
        <span class="hljs-keyword">int</span> value = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; ITERATIONS; i++) {<font></font>
            value = list.indexOf(random.nextInt(plan.size));<font></font>
        }<font></font>
        blackhole.consume(value);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@Benchmark</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">indexOfUnknown</span><span class="hljs-params">(Plan plan, Blackhole blackhole)</span> </span>{<font></font>
        List&lt;Integer&gt; list = plan.list;<font></font>
        Random random = plan.random;<font></font>
        <span class="hljs-keyword">int</span> value = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; ITERATIONS; i++) {<font></font>
            value += list.indexOf(random.nextInt());<font></font>
        }<font></font>
        blackhole.consume(value);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@Benchmark</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addRemoveRandom</span><span class="hljs-params">(Plan plan, Blackhole blackhole)</span> </span>{<font></font>
        List&lt;Integer&gt; list = plan.list;<font></font>
        Random random = plan.random;<font></font>
        <span class="hljs-keyword">int</span> value = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; ITERATIONS; i++) {<font></font>
            list.add(random.nextInt(list.size() + <span class="hljs-number">1</span>), random.nextInt());<font></font>
            value += list.remove(random.nextInt(list.size()));<font></font>
        }<font></font>
        blackhole.consume(value);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@Benchmark</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">get</span><span class="hljs-params">(Plan plan, Blackhole blackhole)</span> </span>{<font></font>
        List&lt;Integer&gt; list = plan.list;<font></font>
        Random random = plan.random;<font></font>
        <span class="hljs-keyword">int</span> value = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; ITERATIONS; i++) {<font></font>
            value += list.get(random.nextInt(list.size()));<font></font>
        }<font></font>
        blackhole.consume(value);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@Timeout(time = 1, timeUnit = TimeUnit.MILLISECONDS)</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> RunnerException </span>{<font></font>
        Options opt = <span class="hljs-keyword">new</span> OptionsBuilder()<font></font>
                .include(PerformanceCompare.class.getSimpleName())<font></font>
                .forks(<span class="hljs-number">1</span>)
<span class="hljs-comment">//                .jvmArgs("-Xms2048m", "-Xmx2048m", "-XX:MaxDirectMemorySize=512M")</span><font></font>
                .build();<font></font>
<font></font>
        <span class="hljs-keyword">new</span> Runner(opt).run();<font></font>
    }<font></font>
}</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para come√ßar, comparei a velocidade de obter um item aleat√≥rio de uma lista. </font><font style="vertical-align: inherit;">Avisarei imediatamente que neste teste a sobrecarga √© muito significativa. </font><font style="vertical-align: inherit;">Os resultados que se aproximam de 100.000 * 1.000 opera√ß√µes por segundo est√£o gravemente distorcidos.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obter resultado do teste</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">PerformanceCompare.get                       ArrayList       10  thrpt    5  79865.412 ¬± 10145.202  ops/s<font></font>
PerformanceCompare.get                       ArrayList      100  thrpt    5  81862.243 ¬±   983.727  ops/s<font></font>
PerformanceCompare.get                       ArrayList     1000  thrpt    5  81033.507 ¬±  4540.206  ops/s<font></font>
PerformanceCompare.get                       ArrayList    10000  thrpt    5  64096.123 ¬±  1430.361  ops/s<font></font>
PerformanceCompare.get                       ArrayList   100000  thrpt    5  41289.491 ¬± 11286.114  ops/s<font></font>
PerformanceCompare.get                       ArrayList  1000000  thrpt    5   8598.944 ¬±  2048.461  ops/s<font></font>
PerformanceCompare.get                        TreeList       10  thrpt    5  33912.275 ¬±  3754.284  ops/s<font></font>
PerformanceCompare.get                        TreeList      100  thrpt    5  21346.854 ¬±   863.588  ops/s<font></font>
PerformanceCompare.get                        TreeList     1000  thrpt    5  14808.414 ¬±   508.098  ops/s<font></font>
PerformanceCompare.get                        TreeList    10000  thrpt    5   8679.384 ¬±   109.250  ops/s<font></font>
PerformanceCompare.get                        TreeList   100000  thrpt    5   4605.998 ¬±  1028.945  ops/s<font></font>
PerformanceCompare.get                        TreeList  1000000  thrpt    5   2241.381 ¬±   768.147  ops/s<font></font>
PerformanceCompare.get                 IndexedTreeList       10  thrpt    5  34054.357 ¬±  3682.829  ops/s<font></font>
PerformanceCompare.get                 IndexedTreeList      100  thrpt    5  21934.002 ¬±  2339.947  ops/s<font></font>
PerformanceCompare.get                 IndexedTreeList     1000  thrpt    5  14626.691 ¬±   369.893  ops/s<font></font>
PerformanceCompare.get                 IndexedTreeList    10000  thrpt    5   7386.863 ¬±   342.150  ops/s<font></font>
PerformanceCompare.get                 IndexedTreeList   100000  thrpt    5   4562.126 ¬±   352.772  ops/s<font></font>
PerformanceCompare.get                 IndexedTreeList  1000000  thrpt    5   2105.718 ¬±   702.064  ops/s<font></font>
PerformanceCompare.get              IndexedTreeListSet       10  thrpt    5  33317.503 ¬±  2307.829  ops/s<font></font>
PerformanceCompare.get              IndexedTreeListSet      100  thrpt    5  21247.440 ¬±  1253.386  ops/s<font></font>
PerformanceCompare.get              IndexedTreeListSet     1000  thrpt    5  14665.557 ¬±   487.833  ops/s<font></font>
PerformanceCompare.get              IndexedTreeListSet    10000  thrpt    5   7667.214 ¬±    80.093  ops/s<font></font>
PerformanceCompare.get              IndexedTreeListSet   100000  thrpt    5   3454.023 ¬±    82.994  ops/s<font></font>
PerformanceCompare.get              IndexedTreeListSet  1000000  thrpt    5   1768.701 ¬±    35.878  ops/s<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui, curiosamente, o maior interesse √© o ArrayList padr√£o. Teoricamente, a velocidade de sair dela deve ser constante e n√£o depender do n√∫mero de elementos. Na pr√°tica, o desempenho primeiro realiza cerca de 90.000 * 1000 opera√ß√µes por segundo (lembre-se da sobrecarga), mas com um comprimento de lista de v√°rios milhares de itens, ele come√ßa a cair. Isso ocorre devido √† falta cada vez mais frequente de cache: o cache do processador n√£o possui os dados necess√°rios e, cada vez mais, voc√™ precisa buscar dados na RAM. Com um milh√£o de elementos, a velocidade do teste √© 10 vezes menor, mas, na pr√°tica, o rebaixamento do desempenho √© ainda maior.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TreeList, IndexedTreeList e IndexedTreeListSet esperam resultados semelhantes. </font><font style="vertical-align: inherit;">Esperado muito mais lento que ArrayList. </font><font style="vertical-align: inherit;">Mesmo com um pequeno n√∫mero de elementos, o TreeList √© v√°rias vezes mais lento que o ArrayList, embora o teste mostre a diferen√ßa apenas 2 vezes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O pr√≥ximo teste √© addRemoveRandom. </font><font style="vertical-align: inherit;">Aqui, em cada teste, insiro um elemento em uma posi√ß√£o aleat√≥ria e removo um elemento de uma posi√ß√£o aleat√≥ria.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Resultado do teste AddRemoveRandom</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">PerformanceCompare.addRemoveRandom           ArrayList       10  thrpt    5  12440.764 ¬±   485.642  ops/s<font></font>
PerformanceCompare.addRemoveRandom           ArrayList      100  thrpt    5   9880.123 ¬±   464.014  ops/s<font></font>
PerformanceCompare.addRemoveRandom           ArrayList     1000  thrpt    5   5288.905 ¬±  1219.055  ops/s<font></font>
PerformanceCompare.addRemoveRandom           ArrayList    10000  thrpt    5   1024.942 ¬±   179.366  ops/s<font></font>
PerformanceCompare.addRemoveRandom           ArrayList   100000  thrpt    5     91.219 ¬±    25.380  ops/s<font></font>
PerformanceCompare.addRemoveRandom           ArrayList  1000000  thrpt    5      5.499 ¬±     0.400  ops/s<font></font>
PerformanceCompare.addRemoveRandom            TreeList       10  thrpt    5   6242.607 ¬±   350.290  ops/s<font></font>
PerformanceCompare.addRemoveRandom            TreeList      100  thrpt    5   3117.945 ¬±   116.066  ops/s<font></font>
PerformanceCompare.addRemoveRandom            TreeList     1000  thrpt    5   1829.778 ¬±    80.516  ops/s<font></font>
PerformanceCompare.addRemoveRandom            TreeList    10000  thrpt    5   1230.077 ¬±    53.381  ops/s<font></font>
PerformanceCompare.addRemoveRandom            TreeList   100000  thrpt    5    443.571 ¬±    69.207  ops/s<font></font>
PerformanceCompare.addRemoveRandom            TreeList  1000000  thrpt    5    308.963 ¬±    84.077  ops/s<font></font>
PerformanceCompare.addRemoveRandom     IndexedTreeList       10  thrpt    5   3556.511 ¬±   144.596  ops/s<font></font>
PerformanceCompare.addRemoveRandom     IndexedTreeList      100  thrpt    5   2120.777 ¬±    83.848  ops/s<font></font>
PerformanceCompare.addRemoveRandom     IndexedTreeList     1000  thrpt    5   1211.112 ¬±    92.288  ops/s<font></font>
PerformanceCompare.addRemoveRandom     IndexedTreeList    10000  thrpt    5    789.458 ¬±    19.450  ops/s<font></font>
PerformanceCompare.addRemoveRandom     IndexedTreeList   100000  thrpt    5    302.989 ¬±    40.030  ops/s<font></font>
PerformanceCompare.addRemoveRandom     IndexedTreeList  1000000  thrpt    5    178.822 ¬±    92.853  ops/s<font></font>
PerformanceCompare.addRemoveRandom  IndexedTreeListSet       10  thrpt    5   4138.007 ¬±   119.943  ops/s<font></font>
PerformanceCompare.addRemoveRandom  IndexedTreeListSet      100  thrpt    5   2435.803 ¬±    20.276  ops/s<font></font>
PerformanceCompare.addRemoveRandom  IndexedTreeListSet     1000  thrpt    5   1445.054 ¬±   276.909  ops/s<font></font>
PerformanceCompare.addRemoveRandom  IndexedTreeListSet    10000  thrpt    5    972.256 ¬±    19.987  ops/s<font></font>
PerformanceCompare.addRemoveRandom  IndexedTreeListSet   100000  thrpt    5    366.608 ¬±    94.487  ops/s<font></font>
PerformanceCompare.addRemoveRandom  IndexedTreeListSet  1000000  thrpt    5    227.677 ¬±    48.276  ops/s<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pode-se supor que ArrayList √© mais r√°pido em pequenas listas. </font><font style="vertical-align: inherit;">No entanto, o fato de ele vencer neste teste em listas de at√© 10.000 elementos parece interessante. </font><font style="vertical-align: inherit;">Aparentemente, o System.arrayCopy est√° muito bem otimizado e usa todos os recursos dos processadores modernos. </font><font style="vertical-align: inherit;">A partir de 10.000 itens, estruturas de dados especializadas est√£o come√ßando a ganhar. </font><font style="vertical-align: inherit;">Com 1.000.000 de elementos, a diferen√ßa de velocidade √© de 30 a 50 vezes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Espera-se que IndexedTreeList e IndexedTreeListSet sejam mais lentos que TreeList. </font><font style="vertical-align: inherit;">Cerca de 1,5 - 2 vezes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os 2 testes restantes indexOfKnown e indexOfUnknown devem apenas demonstrar o principal recurso dessa estrutura. </font><font style="vertical-align: inherit;">A diferen√ßa entre os testes √© que, em um caso, estamos procurando um elemento que est√° na lista e, no outro, estamos procurando um elemento que n√£o est√° na lista.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Resultado do teste indexOfKnown e indexOfUnknown</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">PerformanceCompare.indexOfKnown              ArrayList       10  thrpt    5  41424.356 ¬±   549.047  ops/s<font></font>
PerformanceCompare.indexOfKnown              ArrayList      100  thrpt    5  17216.477 ¬±  1444.744  ops/s<font></font>
PerformanceCompare.indexOfKnown              ArrayList     1000  thrpt    5   2296.306 ¬±    76.372  ops/s<font></font>
PerformanceCompare.indexOfKnown              ArrayList    10000  thrpt    5    233.863 ¬±    26.926  ops/s<font></font>
PerformanceCompare.indexOfKnown              ArrayList   100000  thrpt    5     23.208 ¬±     2.776  ops/s<font></font>
PerformanceCompare.indexOfKnown              ArrayList  1000000  thrpt    5      0.919 ¬±     0.455  ops/s<font></font>
PerformanceCompare.indexOfKnown               TreeList       10  thrpt    5  26740.708 ¬±  1323.125  ops/s<font></font>
PerformanceCompare.indexOfKnown               TreeList      100  thrpt    5   5670.923 ¬±    99.638  ops/s<font></font>
PerformanceCompare.indexOfKnown               TreeList     1000  thrpt    5    745.408 ¬±    26.827  ops/s<font></font>
PerformanceCompare.indexOfKnown               TreeList    10000  thrpt    5     52.288 ¬±     1.362  ops/s<font></font>
PerformanceCompare.indexOfKnown               TreeList   100000  thrpt    5      4.224 ¬±     0.855  ops/s<font></font>
PerformanceCompare.indexOfKnown               TreeList  1000000  thrpt    5      0.193 ¬±     0.052  ops/s<font></font>
PerformanceCompare.indexOfKnown        IndexedTreeList       10  thrpt    5  34485.128 ¬±  1582.703  ops/s<font></font>
PerformanceCompare.indexOfKnown        IndexedTreeList      100  thrpt    5  29209.412 ¬±  1544.268  ops/s<font></font>
PerformanceCompare.indexOfKnown        IndexedTreeList     1000  thrpt    5  21139.584 ¬±  1442.867  ops/s<font></font>
PerformanceCompare.indexOfKnown        IndexedTreeList    10000  thrpt    5  12544.306 ¬±   312.097  ops/s<font></font>
PerformanceCompare.indexOfKnown        IndexedTreeList   100000  thrpt    5   3538.201 ¬±   272.537  ops/s<font></font>
PerformanceCompare.indexOfKnown        IndexedTreeList  1000000  thrpt    5   1420.119 ¬±   538.476  ops/s<font></font>
PerformanceCompare.indexOfKnown     IndexedTreeListSet       10  thrpt    5  39201.995 ¬±  1887.065  ops/s<font></font>
PerformanceCompare.indexOfKnown     IndexedTreeListSet      100  thrpt    5  34204.112 ¬±  1122.517  ops/s<font></font>
PerformanceCompare.indexOfKnown     IndexedTreeListSet     1000  thrpt    5  25374.557 ¬±  1596.746  ops/s<font></font>
PerformanceCompare.indexOfKnown     IndexedTreeListSet    10000  thrpt    5  14291.317 ¬±   391.180  ops/s<font></font>
PerformanceCompare.indexOfKnown     IndexedTreeListSet   100000  thrpt    5   4215.898 ¬±   283.680  ops/s<font></font>
PerformanceCompare.indexOfKnown     IndexedTreeListSet  1000000  thrpt    5   1729.100 ¬±  1260.815  ops/s<font></font>
PerformanceCompare.indexOfUnknown            ArrayList       10  thrpt    5  59053.313 ¬±  1845.665  ops/s<font></font>
PerformanceCompare.indexOfUnknown            ArrayList      100  thrpt    5  10867.572 ¬±   142.823  ops/s<font></font>
PerformanceCompare.indexOfUnknown            ArrayList     1000  thrpt    5   1186.583 ¬±    28.003  ops/s<font></font>
PerformanceCompare.indexOfUnknown            ArrayList    10000  thrpt    5    120.953 ¬±     4.146  ops/s<font></font>
PerformanceCompare.indexOfUnknown            ArrayList   100000  thrpt    5     11.936 ¬±     0.320  ops/s<font></font>
PerformanceCompare.indexOfUnknown            ArrayList  1000000  thrpt    5      0.566 ¬±     0.335  ops/s<font></font>
PerformanceCompare.indexOfUnknown             TreeList       10  thrpt    5  28134.237 ¬±  2291.670  ops/s<font></font>
PerformanceCompare.indexOfUnknown             TreeList      100  thrpt    5   3153.930 ¬±   158.734  ops/s<font></font>
PerformanceCompare.indexOfUnknown             TreeList     1000  thrpt    5    322.383 ¬±    44.245  ops/s<font></font>
PerformanceCompare.indexOfUnknown             TreeList    10000  thrpt    5     25.674 ¬±     1.787  ops/s<font></font>
PerformanceCompare.indexOfUnknown             TreeList   100000  thrpt    5      1.867 ¬±     0.291  ops/s<font></font>
PerformanceCompare.indexOfUnknown             TreeList  1000000  thrpt    5      0.093 ¬±     0.008  ops/s<font></font>
PerformanceCompare.indexOfUnknown      IndexedTreeList       10  thrpt    5  66625.126 ¬±  5232.668  ops/s<font></font>
PerformanceCompare.indexOfUnknown      IndexedTreeList      100  thrpt    5  70038.055 ¬±  5803.848  ops/s<font></font>
PerformanceCompare.indexOfUnknown      IndexedTreeList     1000  thrpt    5  63240.467 ¬±   885.956  ops/s<font></font>
PerformanceCompare.indexOfUnknown      IndexedTreeList    10000  thrpt    5  54731.988 ¬±  3950.150  ops/s<font></font>
PerformanceCompare.indexOfUnknown      IndexedTreeList   100000  thrpt    5  22049.476 ¬±   821.924  ops/s<font></font>
PerformanceCompare.indexOfUnknown      IndexedTreeList  1000000  thrpt    5   9459.862 ¬±   804.738  ops/s<font></font>
PerformanceCompare.indexOfUnknown   IndexedTreeListSet       10  thrpt    5  70274.968 ¬± 15830.355  ops/s<font></font>
PerformanceCompare.indexOfUnknown   IndexedTreeListSet      100  thrpt    5  71017.685 ¬±  6920.447  ops/s<font></font>
PerformanceCompare.indexOfUnknown   IndexedTreeListSet     1000  thrpt    5  66405.960 ¬±  1127.231  ops/s<font></font>
PerformanceCompare.indexOfUnknown   IndexedTreeListSet    10000  thrpt    5  57983.963 ¬±  3276.142  ops/s<font></font>
PerformanceCompare.indexOfUnknown   IndexedTreeListSet   100000  thrpt    5  41277.110 ¬±  9919.893  ops/s<font></font>
PerformanceCompare.indexOfUnknown   IndexedTreeListSet  1000000  thrpt    5   9840.185 ¬±  2159.352  ops/s<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui, ArrayList e TreeList quase n√£o t√™m surpresas. Com o aumento do tamanho, a velocidade diminui quase linearmente. Espera-se que a pesquisa de um item de uma n√£o-lista seja 2 vezes mais lenta que a pesquisa de um item da lista, porque voc√™ precisa percorrer toda a matriz em vez da metade, em m√©dia. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas IndexedTreeList e IndexedTreeListSet aqui mostram o bom resultado esperado. Essas estruturas de dados mostram uma velocidade de execu√ß√£o indexOf compar√°vel a ArrayList, mesmo com 10 elementos. Com 1000 elementos, essas estruturas s√£o 10 vezes mais r√°pidas, com 1.000.000 mais r√°pidas 1000 vezes. Ao pesquisar por um item que n√£o esteja na lista, espera-se que ele d√™ uma velocidade melhor do que ao procurar por um item da lista.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O que mais √© interessante prestar aten√ß√£o √© a subsid√™ncia de desempenho de IndexedTreeList e IndexedTreeListSet no teste indexOfUnknown. </font><font style="vertical-align: inherit;">Aqui a situa√ß√£o √© semelhante √† do teste com ArrayList.get. </font><font style="vertical-align: inherit;">Teoricamente, n√£o dever√≠amos ter conseguido uma queda no desempenho, mas, na pr√°tica, devido √† falta de cache, conseguimos, al√©m disso, significativamente.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em vez de uma conclus√£o</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainda n√£o sei se a estrutura proposta tem uma novidade ou n√£o. Por um lado, a id√©ia n√£o √© complicada se voc√™ souber como a √°rvore funciona por uma chave impl√≠cita. Por outro lado, n√£o vi uma descri√ß√£o de uma estrutura com essas propriedades. E, nesse caso, faz sentido tornar a estrutura mais famosa; pode ser √∫til para algu√©m. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas mesmo que essa seja outra bicicleta, tentei torn√°-la √∫til. Uma solicita√ß√£o de recebimento em cole√ß√µes comuns foi criada, mas no momento da reda√ß√£o deste artigo ainda n√£o foi lan√ßado. Sabendo o qu√£o lentamente tudo pode acontecer em c√≥digo aberto, n√£o ficarei surpreso se o processo se arrastar por meses.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um pouco surpreso com o resultado da compara√ß√£o do desempenho de ArrayList e TreeList. </font><font style="vertical-align: inherit;">Os testes mostraram que o TreeList n√£o faz sentido usar at√© 10.000 elementos no tamanho da lista. </font><font style="vertical-align: inherit;">Seria interessante tentar a √°rvore b em vez de uma √°rvore bin√°ria. </font><font style="vertical-align: inherit;">Essa estrutura deve usar a mem√≥ria com mais cuidado e, provavelmente, trabalhar mais rapidamente. </font><font style="vertical-align: inherit;">E para isso voc√™ pode adaptar a ideia com a indexa√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De qualquer forma, √© divertido ter um instrumento no arsenal que pode (quase) fazer tudo com complexidade previs√≠vel.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Refer√™ncias</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Projeto de </font></font><br>
</a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solicita√ß√£o de recebimento </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">original </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">no apache common-collections </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ticket em Jira</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt488758/index.html">Confer√™ncia DEFCON 27. Reconhecimento de fraudes na Internet</a></li>
<li><a href="../pt488762/index.html">Programa√ß√£o ass√≠ncrona elegante com promessas</a></li>
<li><a href="../pt488766/index.html">Arte e Tecnologia: Universidade de Massachusetts em Lowell</a></li>
<li><a href="../pt488768/index.html">Inferno sangrento, ou Como jurar em ingl√™s ser confundido com uma pessoa culta</a></li>
<li><a href="../pt488776/index.html">Aprimoramentos de acessibilidade no Visual Studio 2019 para Mac</a></li>
<li><a href="../pt488780/index.html">Mozilla perdeu na guerra dos navegadores, mas ainda acredita que poderia salvar a Internet</a></li>
<li><a href="../pt488782/index.html">Como voc√™ gosta dessa op√ß√£o de gerenciamento de depend√™ncias no Python?</a></li>
<li><a href="../pt488784/index.html">Comercializa√ß√£o de melhorias de software livre sob licen√ßas Copyleft</a></li>
<li><a href="../pt488786/index.html">Qu√£o detalhada deve ser uma hist√≥ria de usu√°rio?</a></li>
<li><a href="../pt488792/index.html">Monitorando a disponibilidade do site na R√∫ssia no joelho</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>