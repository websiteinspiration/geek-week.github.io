<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçüíª ü§ôüèª üë¶üèº Tolles Tutorial zur Verarbeitung von Python-Sportdaten üî¥ üöµüèΩ ü§Ωüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In den letzten Jahren in meiner Freizeit habe ich Triathlon gespielt. Dieser Sport ist in vielen L√§ndern der Welt sehr beliebt, insbesondere in den US...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Tolles Tutorial zur Verarbeitung von Python-Sportdaten</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500162/"><img src="https://habrastorage.org/webt/wd/xv/ft/wdxvftc1pifrlchwt7ddj8dxtos.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In den letzten Jahren in meiner Freizeit habe ich Triathlon gespielt. Dieser Sport ist in vielen L√§ndern der Welt sehr beliebt, insbesondere in den USA, Australien und Europa. Derzeit gewinnt es in Russland und den GUS-L√§ndern rasch an Popularit√§t. Es geht darum, Amateure einzubeziehen, keine Profis. Im Gegensatz zum morgendlichen Schwimmen im Pool, Radfahren und Joggen beinhaltet der Triathlon die Teilnahme an Wettk√§mpfen und die systematische Vorbereitung darauf, auch ohne ein Profi zu sein. Sicherlich gibt es unter Ihren Freunden bereits mindestens einen ‚ÄûEisenmann‚Äú oder jemanden, der vorhat, einer zu werden. Massivit√§t, eine Vielzahl von Entfernungen und Bedingungen, drei Sportarten in einer - all dies hat das Potenzial, eine gro√üe Datenmenge zu bilden. Jedes Jahr finden weltweit mehrere hundert Triathlon-Wettbewerbe statt, an denen mehrere hunderttausend Menschen teilnehmen.Die Wettbewerbe werden von mehreren Veranstaltern durchgef√ºhrt. Jeder von ihnen ver√∂ffentlicht die Ergebnisse nat√ºrlich f√ºr sich. Aber f√ºr Athleten aus Russland und einigen GUS-L√§ndern ist das Team</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tristats.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sammelt alle Ergebnisse an einem Ort - auf seiner gleichnamigen Website. Dies macht es sehr bequem, nach Ergebnissen zu suchen, sowohl nach Ihren als auch nach Ihren Freunden und Rivalen oder sogar nach Ihren Idolen. F√ºr mich gab es aber auch die M√∂glichkeit, eine Vielzahl von Ergebnissen programmatisch zu analysieren. Auf trilife ver√∂ffentlichte Ergebnisse: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lesen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies war mein erstes Projekt dieser Art, da ich erst vor kurzem im Prinzip mit der Datenanalyse und der Verwendung von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python begonnen habe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Daher m√∂chte ich Sie √ºber die technische Umsetzung dieser Arbeit informieren, zumal dabei verschiedene Nuancen aufgetaucht sind, die manchmal einen besonderen Ansatz erfordern. </font><font style="vertical-align: inherit;">Es geht um Verschrotten, Parsen, Casting von Typen und Formaten, Wiederherstellen unvollst√§ndiger Daten, Erstellen einer repr√§sentativen Stichprobe, Visualisierung, Vektorisierung und sogar paralleles Rechnen.</font></font><br>
<a name="habracut"></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Lautst√§rke stellte sich als gro√ü heraus, so dass ich alles in f√ºnf Teile zerlegte, damit ich die Informationen dosieren und mich daran erinnern konnte, wo ich nach der Pause anfangen sollte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bevor Sie fortfahren, ist es besser, zuerst meinen Artikel mit den Ergebnissen der Studie zu lesen, da hier im Wesentlichen die K√ºche f√ºr ihre Erstellung beschrieben wurde. </font><font style="vertical-align: inherit;">Es dauert 10-15 Minuten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hast du gelesen? </font><font style="vertical-align: inherit;">Dann lass uns gehen!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teil 1. Scraping und Parsing</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gegeben: Website </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tristats.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Es gibt zwei Arten von Tabellen, die uns interessieren. Dies ist eigentlich eine √úbersichtstabelle aller Rennen und ein Protokoll der Ergebnisse der einzelnen Rennen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vp/m5/do/vpm5dopzyltw9iwcwdddcff2osw.png"><br>
<br>
<img src="https://habrastorage.org/webt/yf/ez/ve/yfezve61_ds1wsaiguh5tjpwd2m.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Hauptaufgabe bestand darin, diese Daten programmgesteuert abzurufen und zur weiteren Verarbeitung zu speichern. So kam es, dass ich zu dieser Zeit noch keine Erfahrung mit Webtechnologien hatte und daher nicht sofort wusste, wie das geht. Ich habe dementsprechend mit dem begonnen, was ich wusste - schauen Sie sich den Seitencode an. Dies kann mit der rechten Maustaste oder der Taste </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F12 erfolgen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/43/wc/ex/43wcexjx3j9qfvjla_dubcsjgl0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Men√º in Chrome enth√§lt zwei Optionen: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seitencode anzeigen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code anzeigen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Nicht die offensichtlichste Trennung. Nat√ºrlich geben sie unterschiedliche Ergebnisse. Derjenige, der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">den Code anzeigt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, es ist genau das gleiche wie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F12</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - die direkt textuelle </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTML-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Darstellung dessen, was im Browser angezeigt wird, ist elementweise. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vv/ow/wb/vvowwbmi5fdawtjbocfjo5zztm4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anzeigen des Seitencodes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gibt wiederum den Quellcode der Seite an. Auch </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTML</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , aber es gibt dort keine Daten, nur die Namen der JS-Skripte, die sie entladen. Okay. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/o4/k7/d5/o4k7d5k8zuu66hp43vegbix9hoc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt m√ºssen wir verstehen, wie man Python verwendet, um den Code jeder Seite als separate Textdatei zu speichern. Ich versuche das:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> requests<font></font>
<font></font>
r = requests.get(url=<span class="hljs-string">'http://tristats.ru/'</span>)<font></font>
print(r.content)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und ich bekomme ... den Quellcode. Aber ich brauche das Ergebnis seiner Ausf√ºhrung. Nachdem ich studiert, gesucht und nachgefragt hatte, stellte ich fest, dass ich ein Tool zur Automatisierung von Browseraktionen brauchte, zum Beispiel </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selen</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ich habe es gesagt. Und auch </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ChromeDriver</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> f√ºr die Arbeit mit </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Chrome</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dann habe ich es wie folgt benutzt:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver
<span class="hljs-keyword">from</span> selenium.webdriver.chrome.service <span class="hljs-keyword">import</span> Service<font></font>
<font></font>
service = Service(<span class="hljs-string">r'C:\ChromeDriver\chromedriver.exe'</span>)<font></font>
service.start()<font></font>
driver = webdriver.Remote(service.service_url)<font></font>
driver.get(<span class="hljs-string">'http://www.tristats.ru/'</span>)<font></font>
print(driver.page_source)<font></font>
driver.quit()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Code √∂ffnet ein Browserfenster und √∂ffnet eine Seite mit der angegebenen URL. Als Ergebnis erhalten wir </font><font style="vertical-align: inherit;">bereits </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTML-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Code mit den gew√ºnschten Daten. Aber es gibt einen Haken. Das Ergebnis sind nur 100 Einsendungen und die Gesamtzahl der Rennen betr√§gt fast 2000. Wie? Tatsache ist, dass zun√§chst nur die ersten 100 Eintr√§ge im Browser angezeigt werden und nur dann, wenn Sie zum Ende der Seite scrollen, die n√§chsten 100 geladen werden und so weiter. Daher ist es notwendig, das Scrollen programmgesteuert zu implementieren. Verwenden Sie dazu den folgenden Befehl:</font></font><br>
<br>
<pre><code class="python hljs">driver.execute_script(<span class="hljs-string">"window.scrollTo(0, document.body.scrollHeight);"</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und bei jedem Bildlauf pr√ºfen wir, ob sich der Code der geladenen Seite ge√§ndert hat oder nicht. </font><font style="vertical-align: inherit;">Wenn es sich nicht ge√§ndert hat, √ºberpr√ºfen wir mehrmals die Zuverl√§ssigkeit, z. B. 10, dann wird die gesamte Seite geladen und Sie k√∂nnen anhalten. </font><font style="vertical-align: inherit;">Zwischen den Schriftrollen setzen wir das Zeitlimit auf eine Sekunde, damit die Seite Zeit zum Laden hat. </font><font style="vertical-align: inherit;">(Auch wenn sie keine Zeit hat, haben wir eine Reserve - weitere neun Sekunden) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und der vollst√§ndige Code sieht folgenderma√üen aus:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver
<span class="hljs-keyword">from</span> selenium.webdriver.chrome.service <span class="hljs-keyword">import</span> Service
<span class="hljs-keyword">import</span> time<font></font>
<font></font>
service = Service(<span class="hljs-string">r'C:\ChromeDriver\chromedriver.exe'</span>)<font></font>
service.start()<font></font>
driver = webdriver.Remote(service.service_url)<font></font>
driver.get(<span class="hljs-string">'http://www.tristats.ru/'</span>)<font></font>
prev_html = <span class="hljs-string">''</span>
scroll_attempt = <span class="hljs-number">0</span><font></font>
<font></font>
<span class="hljs-keyword">while</span> scroll_attempt &lt; <span class="hljs-number">10</span>:<font></font>
    driver.execute_script(<span class="hljs-string">"window.scrollTo(0, document.body.scrollHeight);"</span>)<font></font>
    time.sleep(<span class="hljs-number">1</span>)<font></font>
<font></font>
    <span class="hljs-keyword">if</span> prev_html == driver.page_source:<font></font>
        scroll_attempt += <span class="hljs-number">1</span>
    <span class="hljs-keyword">else</span>:<font></font>
        prev_html = driver.page_source<font></font>
        scroll_attempt = <span class="hljs-number">0</span> <font></font>
<font></font>
<span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\summary.txt'</span>, <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> f:<font></font>
    f.write(prev_html)<font></font>
<font></font>
driver.quit()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben also eine </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTML-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Datei mit einer √úbersichtstabelle aller Rennen. </font><font style="vertical-align: inherit;">M√ºssen es analysieren. </font><font style="vertical-align: inherit;">Verwenden Sie dazu die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lxml-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bibliothek </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> lxml <span class="hljs-keyword">import</span> html
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zuerst finden wir alle Zeilen der Tabelle. </font><font style="vertical-align: inherit;">Um das Vorzeichen einer Zeichenfolge zu bestimmen, sehen Sie sich einfach die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTML-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Datei in einem Texteditor an. </font><i><font style="vertical-align: inherit;">Dies</font></i></font><br>
<br>
<img src="https://habrastorage.org/webt/b2/j6/_8/b2j6_8isg6smzxbgkojrppfwif4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
kann beispielsweise </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"tr ng-repeat = 'r in RaceData' class = 'ng-scope'"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder ein Fragment sein, das in keinem Tag mehr gefunden werden kann.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\summary.txt'</span>, <span class="hljs-string">'r'</span>) <span class="hljs-keyword">as</span> f:<font></font>
    sum_html = f.read()<font></font>
<font></font>
tree = html.fromstring(sum_html)<font></font>
rows = tree.findall(<span class="hljs-string">".//*[@ng-repeat='r in racesData']"</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann starten wir den </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pandas-Datenrahmen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und jedes Element jeder Zeile der Tabelle wird in diesen Datenrahmen geschrieben.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<font></font>
<font></font>
rs = pd.DataFrame(columns=[<span class="hljs-string">'date'</span>,<span class="hljs-string">'name'</span>,<span class="hljs-string">'link'</span>,<span class="hljs-string">'males'</span>,<span class="hljs-string">'females'</span>,<span class="hljs-string">'rus'</span>,<span class="hljs-string">'total'</span>], index=range(len(rows))) <span class="hljs-comment">#rs ‚Äì races summary</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um herauszufinden, wo jedes einzelne Element versteckt ist, m√ºssen Sie nur den </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTML-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Code eines der Elemente unserer </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeilen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im selben Texteditor anzeigen.</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">ng-repeat</span>=<span class="hljs-string">"r in racesData"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ng-scope"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ng-binding"</span>&gt;</span>2015-04-26<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/Images/flags/24/USA.png"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flag"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/rus/result/ironman/texas/half/2015"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"_self"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ng-binding"</span>&gt;</span>Ironman Texas 70.3 2015<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/rus/result/ironman/texas/half/2015?sex=F"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"_self"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ng-binding"</span>&gt;</span>605<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-venus fa-lg"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"color:Pink"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><font></font>
      /<font></font>
      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/rus/result/ironman/texas/half/2015?sex=M"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"_self"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ng-binding"</span>&gt;</span>1539<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-mars fa-lg"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"color:LightBlue"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ng-binding"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/Images/flags/24/rus.png"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flag"</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- ngIf: r.CountryCount == 0 --&gt;</span>
      <span class="hljs-comment">&lt;!-- ngIf: r.CountryCount &gt; 0 --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">ng-if</span>=<span class="hljs-string">"r.CountryCount &gt; 0"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/rus/result/ironman/texas/half/2015?country=rus"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"_self"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ng-binding ng-scope"</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- end ngIf: r.CountryCount &gt; 0 --&gt;</span><font></font>
      / 2144<font></font>
  <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der einfachste Weg zur Hardcode-Navigation f√ºr Kinder ist, dass es nicht viele von ihnen gibt. </font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(rows)):<font></font>
    rs.loc[i,<span class="hljs-string">'date'</span>] = rows[i].getchildren()[<span class="hljs-number">0</span>].text.strip()<font></font>
    rs.loc[i,<span class="hljs-string">'name'</span>] = rows[i].getchildren()[<span class="hljs-number">1</span>].getchildren()[<span class="hljs-number">1</span>].text.strip()<font></font>
    rs.loc[i,<span class="hljs-string">'link'</span>] = rows[i].getchildren()[<span class="hljs-number">1</span>].getchildren()[<span class="hljs-number">1</span>].attrib[<span class="hljs-string">'href'</span>].strip()<font></font>
    rs.loc[i,<span class="hljs-string">'males'</span>] = rows[i].getchildren()[<span class="hljs-number">2</span>].getchildren()[<span class="hljs-number">2</span>].text.strip()<font></font>
    rs.loc[i,<span class="hljs-string">'females'</span>] = rows[i].getchildren()[<span class="hljs-number">2</span>].getchildren()[<span class="hljs-number">0</span>].text.strip()<font></font>
    rs.loc[i,<span class="hljs-string">'rus'</span>] = rows[i].getchildren()[<span class="hljs-number">3</span>].getchildren()[<span class="hljs-number">3</span>].text.strip()<font></font>
    rs.loc[i,<span class="hljs-string">'total'</span>] = rows[i].getchildren()[<span class="hljs-number">3</span>].text_content().split(<span class="hljs-string">'/'</span>)[<span class="hljs-number">1</span>].strip()
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist das Ergebnis: </font><font style="vertical-align: inherit;">
Speichern Sie diesen Datenrahmen in einer Datei. </font><font style="vertical-align: inherit;">Ich benutze </font><i><font style="vertical-align: inherit;">Gurke</font></i><font style="vertical-align: inherit;"> , aber es k√∂nnte </font><i><font style="vertical-align: inherit;">CSV</font></i><font style="vertical-align: inherit;"> oder etwas anderes sein.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>date</th>
<th>event</th>
<th>link</th>
<th>males</th>
<th>females</th>
<th>rus</th>
<th>total</th>
</tr>
<tr>
<td>0</td>
<td>2020-07-02</td>
<td>Ironman Dubai Duathlon 70.3 2020</td>
<td>/rus/result/ironman/dubai-duathlon/half/2020</td>
<td>835</td>
<td>215</td>
<td>65</td>
<td>1050</td>
</tr>
<tr>
<td>1</td>
<td>2020-02-07</td>
<td>Ironman Dubai 70.3 2020</td>
<td>/rus/result/ironman/dubai/half/2020</td>
<td>638</td>
<td>132</td>
<td>55</td>
<td>770</td>
</tr>
<tr>
<td>2</td>
<td>2020-01-29</td>
<td>Israman Half 2020</td>
<td>/rus/result/israman/israman/half/2020</td>
<td>670</td>
<td>126</td>
<td>4</td>
<td>796</td>
</tr>
<tr>
<td>3</td>
<td>2019-12-08</td>
<td>Ironman Indian Wells La Quinta 70.3 2019</td>
<td>/rus/result/ironman/indian-wells-la-quinta/hal...</td>
<td>1590</td>
<td>593</td>
<td>6</td>
<td>2183</td>
</tr>
<tr>
<td>4</td>
<td>2019-12-07</td>
<td>Ironman Taupo 70.3 2019</td>
<td>/rus/result/ironman/taupo/half/2019</td>
<td>767</td>
<td>420</td>
<td>3</td>
<td>1187</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td>1917</td>
<td>1994-07-02</td>
<td>ITU European Championship Eichstatt Olympic 1994</td>
<td>/rus/result/itu/european-championship-eichstat...</td>
<td>61</td>
<td>0</td>
<td>2</td>
<td>61</td>
</tr>
<tr>
<td>1918</td>
<td>1993-09-04</td>
<td>Challenge Almere-Amsterdam Long 1993</td>
<td>/rus/result/challenge/almere-amsterdam/full/1993</td>
<td>795</td>
<td>32</td>
<td>1</td>
<td>827</td>
</tr>
<tr>
<td>1919</td>
<td>1993-07-04</td>
<td>ITU European Cup Echternach Olympic 1993</td>
<td>/rus/result/itu/european-cup-echternach/olympi...</td>
<td>60</td>
<td>0</td>
<td>2</td>
<td>60</td>
</tr>
<tr>
<td>1920</td>
<td>1992-09-12</td>
<td>ITU World Championship Huntsville Olympic 1992</td>
<td>/rus/result/itu/world-championship-huntsville/...</td>
<td>317</td>
<td>0</td>
<td>3</td>
<td>317</td>
</tr>
<tr>
<td>1921</td>
<td>1990-09-15</td>
<td>ITU World Championship Orlando Olympic 1990</td>
<td>/rus/result/itu/world-championship-orlando/oly...</td>
<td>286</td>
<td>0</td>
<td>5</td>
<td>28</td>
</tr>
</tbody></table></div></code><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> pickle <span class="hljs-keyword">as</span> pkl<font></font>
<font></font>
<span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\summary.pkl'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:<font></font>
    pkl.dump(df,f)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zu diesem Zeitpunkt sind alle Daten vom Typ einer Zeichenfolge. </font><font style="vertical-align: inherit;">Wir werden sp√§ter konvertieren. </font><font style="vertical-align: inherit;">Das Wichtigste, was wir jetzt brauchen, sind Links. </font><font style="vertical-align: inherit;">Wir werden sie zum Scraping von Protokollen aller Rassen verwenden. </font><font style="vertical-align: inherit;">Wir machen es nach dem Bild und der √Ñhnlichkeit, wie es f√ºr den Pivot-Tisch gemacht wurde. </font><font style="vertical-align: inherit;">Im Zyklus f√ºr alle Rennen f√ºr jedes Rennen √∂ffnen wir die Seite als Referenz, scrollen und erhalten den Seitencode. </font><font style="vertical-align: inherit;">In der √úbersichtstabelle finden Sie Informationen zur Gesamtzahl der Teilnehmer am Rennen - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insgesamt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir werden es verwenden, um zu verstehen, bis zu welchem ‚Äã‚ÄãPunkt Sie weiter scrollen m√ºssen. Zu diesem Zweck ermitteln wir beim Scraping jeder Seite direkt die Anzahl der Datens√§tze in der Tabelle und vergleichen sie mit dem erwarteten Gesamtwert. Sobald es gleich ist, haben wir bis zum Ende gescrollt und Sie k√∂nnen mit dem n√§chsten Rennen fortfahren. Wir haben auch eine Zeit√ºberschreitung von 60 Sekunden eingestellt. A√ü w√§hrend dieser Zeit, wir kommen nicht zur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Summe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , gehen zum n√§chsten Rennen. Der Seitencode wird in einer Datei gespeichert. Wir speichern die Dateien aller Rennen in einem Ordner und benennen sie nach dem Namen der Rennen, dh nach dem Wert in der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ereignisspalte</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in der √úbersichtstabelle. Um einen Namenskonflikt zu vermeiden, m√ºssen alle Rassen unterschiedliche Namen in der Pivot-Tabelle haben. √úberpr√ºfen Sie dies:</font></font><br>
<br>
<pre><code class="python hljs">df[df.duplicated(subset = <span class="hljs-string">'event'</span>, keep=<span class="hljs-literal">False</span>)]
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>date</th>
<th>event</th>
<th>link</th>
<th>males</th>
<th>females</th>
<th>rus</th>
<th>total</th>
</tr>
<tr>
<td>450</td>
<td>2018-07-15</td>
<td>A1  Sprint 2018</td>
<td>/rus/result/a1/cc/sprint/2018-07-15</td>
<td>43</td>
<td>15</td>
<td>47</td>
<td>58</td>
</tr>
<tr>
<td>483</td>
<td>2018-06-23</td>
<td>A1  Sprint 2018</td>
<td>/rus/result/a1/cc/sprint/2018-06-23</td>
<td>61</td>
<td>15</td>
<td>76</td>
<td>76</td>
</tr>
<tr>
<td>670</td>
<td>2017-07-30</td>
<td>3Grom  Olympic 2017</td>
<td>/rus/result/3grom//olympic/2017-07-30</td>
<td>249</td>
<td>44</td>
<td>293</td>
<td>293</td>
</tr>
<tr>
<td>752</td>
<td>2017-06-11</td>
<td>3Grom  Olympic 2017</td>
<td>/rus/result/3grom//olympic/2017-06-11</td>
<td>251</td>
<td>28</td>
<td>279</td>
<td>279</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nun, in der √úbersichtstabelle gibt es Wiederholungen, au√üerdem die Daten und die Anzahl der Teilnehmer ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√§nner, Frauen, Rus, Total</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), und die Links sind unterschiedlich. </font><font style="vertical-align: inherit;">Sie m√ºssen diese Protokolle √ºberpr√ºfen, es gibt nur wenige, damit Sie dies manuell tun k√∂nnen. </font><font style="vertical-align: inherit;">Jetzt sind alle Namen eindeutig, wir starten einen gro√üen Bergbauzyklus:</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/a8/v7/n8/a8v7n8qoxbzobftxcm0knnvks6m.png"><br>
<br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>date</th>
<th>event</th>
<th>link</th>
<th>males</th>
<th>females</th>
<th>rus</th>
<th>total</th>
</tr>
<tr>
<td>450</td>
<td>2018-07-15</td>
<td>A1  Sprint <u>7</u> 2018</td>
<td>/rus/result/a1/cc/sprint/2018-07-15</td>
<td>43</td>
<td>15</td>
<td>47</td>
<td>58</td>
</tr>
<tr>
<td>483</td>
<td>2018-06-23</td>
<td>A1  Sprint <u>6</u> 2018</td>
<td>/rus/result/a1/cc/sprint/2018-06-23</td>
<td>61</td>
<td>15</td>
<td>76</td>
<td>76</td>
</tr>
<tr>
<td>670</td>
<td>2017-07-30</td>
<td>3Grom  Olympic <u>7</u> 2017</td>
<td>/rus/result/3grom//olympic/2017-07-30</td>
<td>249</td>
<td>44</td>
<td>293</td>
<td>293</td>
</tr>
<tr>
<td>752</td>
<td>2017-06-11</td>
<td>3Grom  Olympic <u>6</u> 2017</td>
<td>/rus/result/3grom//olympic/2017-06-11</td>
<td>251</td>
<td>28</td>
<td>279</td>
<td>27</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">service.start()<font></font>
driver = webdriver.Remote(service.service_url)<font></font>
timeout = <span class="hljs-number">60</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> index, row <span class="hljs-keyword">in</span> df.iterrows():
    <span class="hljs-keyword">try</span>:<font></font>
        driver.get(<span class="hljs-string">'http://www.tristats.ru'</span> + row[<span class="hljs-string">'link'</span>])     <font></font>
        start = time.time()<font></font>
<font></font>
        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<font></font>
            driver.execute_script(<span class="hljs-string">"window.scrollTo(0, document.body.scrollHeight);"</span>)<font></font>
            time.sleep(<span class="hljs-number">1</span>)<font></font>
            race_html = driver.page_source<font></font>
            tree = html.fromstring(race_html)<font></font>
            race_rows = tree.findall(<span class="hljs-string">".//*[@ng-repeat='r in resultsData']"</span>)<font></font>
<font></font>
            <span class="hljs-keyword">if</span> len(race_rows) == int(row[<span class="hljs-string">'total'</span>]):
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">if</span> time.time() - start &gt; timeout:<font></font>
                print(<span class="hljs-string">'timeout'</span>)
                <span class="hljs-keyword">break</span><font></font>
<font></font>
        <span class="hljs-keyword">with</span> open(os.path.join(<span class="hljs-string">r'D:\tri\races'</span>, row[<span class="hljs-string">'event'</span>] +  <span class="hljs-string">'.txt'</span>), <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> f:<font></font>
            f.write(race_html)<font></font>
<font></font>
    <span class="hljs-keyword">except</span>:<font></font>
        traceback.print_exc()<font></font>
<font></font>
    time.sleep(<span class="hljs-number">1</span>)<font></font>
    <font></font>
driver.quit()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist ein langer Prozess. </font><font style="vertical-align: inherit;">Aber wenn alles eingerichtet ist und sich dieser schwere Mechanismus dreht und nacheinander Datendateien hinzuf√ºgt, entsteht ein Gef√ºhl angenehmer Aufregung. </font><font style="vertical-align: inherit;">Pro Minute werden nur etwa drei Protokolle sehr langsam geladen. </font><font style="vertical-align: inherit;">Links f√ºr die Nacht drehen. </font><font style="vertical-align: inherit;">Es dauerte ungef√§hr 10 Stunden. </font><font style="vertical-align: inherit;">Am Morgen wurden die meisten Protokolle hochgeladen. </font><font style="vertical-align: inherit;">Wie es normalerweise bei der Arbeit mit einem Netzwerk der Fall ist, schlagen einige fehl. </font><font style="vertical-align: inherit;">Fuhr schnell mit einem zweiten Versuch fort.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/un/wi/el/unwielrqjzt6u6otf8sbwwjbq8q.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben also 1.922 Dateien mit einer Gesamtkapazit√§t von fast 3 GB. Cool! Das Handling von fast 300 Rennen endete jedoch mit einer Auszeit. Was ist da los? Bei selektiver √úberpr√ºfung stellt sich heraus, dass der Gesamtwert aus der Pivot-Tabelle und die Anzahl der von uns √ºberpr√ºften Eintr√§ge im Rennprotokoll m√∂glicherweise nicht √ºbereinstimmen. Das ist traurig, weil nicht klar ist, was der Grund f√ºr diese Diskrepanz ist. Entweder liegt dies an der Tatsache, dass nicht jeder fertig wird, oder an einem Fehler in der Datenbank. Im Allgemeinen ist das erste Signal der Datenunvollkommenheit. In jedem Fall √ºberpr√ºfen wir diejenigen, bei denen die Anzahl der Eintr√§ge 100 oder 0 betr√§gt. Dies sind die verd√§chtigsten Kandidaten. Es waren acht von ihnen. Laden Sie sie erneut unter Kontrolle herunter. √úbrigens gibt es in zwei von ihnen tats√§chlich 100 Eintr√§ge.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun, wir haben alle Daten. </font><font style="vertical-align: inherit;">Wir gehen zum Parsen √ºber. </font><font style="vertical-align: inherit;">Wieder werden wir in einem Zyklus jedes Rennen durchlaufen, die Datei lesen und den Inhalt in einem </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pandas DataFrame speichern</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Wir werden diese Datenrahmen zu einem </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diktat</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kombinieren </font><font style="vertical-align: inherit;">, in dem die Namen der Rennen die Schl√ºssel sind - das hei√üt, die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ereigniswerte</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aus der Pivot-Tabelle oder die Namen der Dateien mit dem </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTML-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Code </font><font style="vertical-align: inherit;">der </font><i><font style="vertical-align: inherit;">Rennseiten</font></i><font style="vertical-align: inherit;"> stimmen √ºberein.</font></font><br>
<br>
<pre><code class="python hljs">rd = {} <span class="hljs-comment">#rd ‚Äì race details</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> rs[<span class="hljs-string">'event'</span>]:<font></font>
    place = []<font></font>
    ... sex = [], name=..., country, group, place_in_group, swim, t1, bike, t2, run<font></font>
    result = []<font></font>
<font></font>
    <span class="hljs-keyword">with</span> open(os.path.join(<span class="hljs-string">r'D:\tri\races'</span>, e + <span class="hljs-string">'.txt'</span>), <span class="hljs-string">'r'</span>)<font></font>
        race_html = f.read()<font></font>
<font></font>
    tree = html.fromstring(race_html)<font></font>
    rows = tree.findall(<span class="hljs-string">".//*[@ng-repeat='r in resultsData']"</span>)<font></font>
<font></font>
    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(len(rows)):<font></font>
        row = rows[j]<font></font>
        parts = row.text_content().split(<span class="hljs-string">'\n'</span>)<font></font>
        parts = [r.strip() <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> parts <span class="hljs-keyword">if</span> r.strip() != <span class="hljs-string">''</span>]<font></font>
        place.append(parts[<span class="hljs-number">0</span>])<font></font>
<font></font>
        <span class="hljs-keyword">if</span> len([a <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> row.findall(<span class="hljs-string">'.//i'</span>)]) &gt; <span class="hljs-number">0</span>:<font></font>
            sex.append([a <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> row.findall(<span class="hljs-string">'.//i'</span>)][<span class="hljs-number">0</span>].attrib[<span class="hljs-string">'ng-if'</span>][<span class="hljs-number">10</span>:<span class="hljs-number">-1</span>])
        <span class="hljs-keyword">else</span>:<font></font>
            sex.append(<span class="hljs-string">''</span>)<font></font>
<font></font>
        name.append(parts[<span class="hljs-number">1</span>])<font></font>
<font></font>
        <span class="hljs-keyword">if</span> len(parts) &gt; <span class="hljs-number">10</span>:<font></font>
            country.append(parts[<span class="hljs-number">2</span>].strip())         <font></font>
            k=<span class="hljs-number">0</span>
        <span class="hljs-keyword">else</span>:<font></font>
            country.append(<span class="hljs-string">''</span>)<font></font>
            k=<span class="hljs-number">1</span><font></font>
<font></font>
        group.append(parts[<span class="hljs-number">3</span>-k])<font></font>
        ... place_in_group.append(...), swim.append ..., t1, bike, t2, run<font></font>
        result.append(parts[<span class="hljs-number">10</span>-k])<font></font>
<font></font>
    race = pd.DataFrame()<font></font>
    race[<span class="hljs-string">'place'</span>] = place<font></font>
    ... race[<span class="hljs-string">'sex'</span>] = sex, race[<span class="hljs-string">'name'</span>] = ..., <span class="hljs-string">'country'</span>, <span class="hljs-string">'group'</span>, <span class="hljs-string">'place_in_group'</span>, <span class="hljs-string">'swim'</span>, <span class="hljs-string">' t1'</span>, <span class="hljs-string">'bike'</span>, <span class="hljs-string">'t2'</span>, <span class="hljs-string">'run'</span>
    race[<span class="hljs-string">'result'</span>] = result<font></font>
<font></font>
    rd[e] = race<font></font>
<font></font>
<span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\details.pkl'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:<font></font>
    pkl.dump(rd,f)<font></font>
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>place in group</th>
<th>swim</th>
<th>t1</th>
<th>bike</th>
<th>t2</th>
<th>run</th>
<th>result</th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td>Reed, Tim</td>
<td>AUS</td>
<td>MPRO</td>
<td>1</td>
<td>24:34</td>
<td>1:07</td>
<td>2:13:46</td>
<td>1:49</td>
<td>1:23:17</td>
<td>4:04:33</td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td>Van Berkel, Tim</td>
<td>AUS</td>
<td>MPRO</td>
<td>2</td>
<td>24:34</td>
<td>1:05</td>
<td>2:13:47</td>
<td>1:53</td>
<td>1:27:17</td>
<td>4:08:36</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td>Baldwin, Nicholas</td>
<td>SEY</td>
<td>MPRO</td>
<td>3</td>
<td>26:31</td>
<td>0:59</td>
<td>2:14:06</td>
<td>1:54</td>
<td>1:25:36</td>
<td>4:09:06</td>
</tr>
<tr>
<td>3</td>
<td>4</td>
<td>M</td>
<td>Polizzi, Alexander</td>
<td>AUS</td>
<td>MPRO</td>
<td>4</td>
<td>23:21</td>
<td>1:12</td>
<td>2:14:53</td>
<td>1:54</td>
<td>1:31:16</td>
<td>4:12:36</td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>M</td>
<td>Chang, Chia-Hao</td>
<td>TWN</td>
<td>M18-24</td>
<td>1</td>
<td>25:18</td>
<td>1:34</td>
<td>2:23:38</td>
<td>2:13</td>
<td>1:29:01</td>
<td>4:21:44</td>
</tr>
<tr>
<td>5</td>
<td>6</td>
<td>M</td>
<td>Rondy, Guillaume</td>
<td>FRA</td>
<td>M35-39</td>
<td>1</td>
<td>27:51</td>
<td>1:26</td>
<td>2:21:53</td>
<td>2:29</td>
<td>1:35:19</td>
<td>4:28:58</td>
</tr>
<tr>
<td>6</td>
<td>7</td>
<td>F</td>
<td>Steffen, Caroline</td>
<td>SUI</td>
<td>FPRO</td>
<td>1</td>
<td>26:52</td>
<td>1:01</td>
<td>2:24:54</td>
<td>2:10</td>
<td>1:34:17</td>
<td>4:29:14</td>
</tr>
<tr>
<td>7</td>
<td>8</td>
<td>M</td>
<td>Betten, Sam</td>
<td>AUS</td>
<td>MPRO</td>
<td>5</td>
<td>23:30</td>
<td>1:26</td>
<td>2:18:24</td>
<td>1:57</td>
<td>1:45:07</td>
<td>4:30:24</td>
</tr>
<tr>
<td>8</td>
<td>9</td>
<td>M</td>
<td>Gallot, Simon</td>
<td>FRA</td>
<td>M30-34</td>
<td>1</td>
<td>27:50</td>
<td>1:33</td>
<td>2:20:15</td>
<td>2:13</td>
<td>1:45:22</td>
<td>4:37:13</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td>524</td>
<td>525</td>
<td>M</td>
<td>Santos, Alfredo</td>
<td>PHI</td>
<td>M65-69</td>
<td>2</td>
<td>50:42</td>
<td>4:23</td>
<td>3:52:10</td>
<td>10:32</td>
<td>3:36:11</td>
<td>8:33:58</td>
</tr>
<tr>
<td>525</td>
<td>526</td>
<td>F</td>
<td>Escober, Eula</td>
<td>PHI</td>
<td>F18-24</td>
<td>5</td>
<td>47:07</td>
<td>3:50</td>
<td>4:43:44</td>
<td>3:41</td>
<td>2:59:45</td>
<td>8:38:07</td>
</tr>
<tr>
<td>526</td>
<td>527</td>
<td>M</td>
<td>Belen, Virgilio Jr.</td>
<td>PHI</td>
<td>M45-49</td>
<td>76</td>
<td>47:05</td>
<td>5:49</td>
<td>3:48:18</td>
<td>11:21</td>
<td>3:46:06</td>
<td>8:38:39</td>
</tr>
<tr>
<td>527</td>
<td>528</td>
<td>M</td>
<td>Kunimoto, Kilhak</td>
<td>GUM</td>
<td>M70-74</td>
<td>2</td>
<td>40:32</td>
<td>2:50</td>
<td>3:53:37</td>
<td>6:45</td>
<td>4:01:36</td>
<td>8:45:20</td>
</tr>
<tr>
<td>528</td>
<td>529</td>
<td>M</td>
<td>Sumicad, Siegfred</td>
<td>PHI</td>
<td>M50-54</td>
<td>54</td>
<td>59:10</td>
<td>4:38</td>
<td>4:11:55</td>
<td>6:35</td>
<td>3:23:45</td>
<td>8:46:03</td>
</tr>
<tr>
<td>529</td>
<td>530</td>
<td>M</td>
<td>Gomez, Paul</td>
<td>PHI</td>
<td>M45-49</td>
<td>77</td>
<td>50:02</td>
<td>6:29</td>
<td>4:07:58</td>
<td>7:24</td>
<td>3:41:41</td>
<td>8:53:34</td>
</tr>
<tr>
<td>530</td>
<td>531</td>
<td>M</td>
<td>Ramos, John Raymund</td>
<td>PHI</td>
<td>M25-29</td>
<td>26</td>
<td>43:44</td>
<td>3:04</td>
<td>4:21:13</td>
<td>5:56</td>
<td>3:45:10</td>
<td>8:59:07</td>
</tr>
<tr>
<td>531</td>
<td>532</td>
<td>F</td>
<td>De Guzman, Clouie Anne</td>
<td>PHI</td>
<td>F30-34</td>
<td>9</td>
<td>52:29</td>
<td>3:16</td>
<td>4:03:02</td>
<td>7:01</td>
<td>3:56:39</td>
<td>9:02:27</td>
</tr>
<tr>
<td>532</td>
<td>533</td>
<td>F</td>
<td>Samson, Maria Dolores</td>
<td>PHI</td>
<td>F45-49</td>
<td>17</td>
<td>48:56</td>
<td>4:21</td>
<td>4:16:34</td>
<td>6:26</td>
<td>3:47:06</td>
<td>9:03:23</td>
</tr>
<tr>
<td>533</td>
<td>534</td>
<td>M</td>
<td>Salazar, Richard</td>
<td>PHI</td>
<td>M40-44</td>
<td>107</td>
<td>42:19</td>
<td>4:02</td>
<td>4:30:36</td>
<td>6:39</td>
<td>3:39:51</td>
<td>9:03:27</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neben der Tabelle mit den Ergebnissen der Teilnehmer enth√§lt die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTML-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Datei jedes Rennens auch Datum, Name und Ort des Wettbewerbs. </font><font style="vertical-align: inherit;">Das Datum und der Name befinden sich bereits in der Pivot-Tabelle, es gibt jedoch keinen Speicherort. </font><font style="vertical-align: inherit;">Wir lesen diese Informationen aus </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTML-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dateien und f√ºgen sie einer neuen Spalte in der Pivot-Tabelle hinzu.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> index, row <span class="hljs-keyword">in</span> rs.iterrows():<font></font>
    e = row[<span class="hljs-string">'event'</span>]       
    <span class="hljs-keyword">with</span> open(os.path.join(<span class="hljs-string">r'D:\tri\races'</span>, e + <span class="hljs-string">'.txt'</span>), <span class="hljs-string">'r'</span>) <span class="hljs-keyword">as</span> f:<font></font>
        race_html = f.read()<font></font>
<font></font>
    tree = html.fromstring(race_html)<font></font>
    header_elem = [tb <span class="hljs-keyword">for</span> tb <span class="hljs-keyword">in</span> tree.findall(<span class="hljs-string">'.//tbody'</span>) <span class="hljs-keyword">if</span> tb.getchildren()[<span class="hljs-number">0</span>].getchildren()[<span class="hljs-number">0</span>].text == <span class="hljs-string">''</span>][<span class="hljs-number">0</span>]<font></font>
    location = header_elem.getchildren()[<span class="hljs-number">1</span>].getchildren()[<span class="hljs-number">1</span>].text.strip()<font></font>
    rs.loc[index, <span class="hljs-string">'loc'</span>] = location
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th>date</th>
<th><u>loc</u></th>
<th>male</th>
<th>female</th>
<th>rus</th>
<th>total</th>
<th>link</th>
</tr>
<tr>
<td>0</td>
<td>Ironman Dubai Duathlon 70.3 2020</td>
<td>2020-07-02</td>
<td><u>Dubai, United Arab Emirates</u></td>
<td>835</td>
<td>215</td>
<td>65</td>
<td>1050</td>
<td>...</td>
</tr>
<tr>
<td>1</td>
<td>Ironman Dubai 70.3 2020</td>
<td>2020-02-07</td>
<td><u>Dubai, United Arab Emirates</u></td>
<td>638</td>
<td>132</td>
<td>55</td>
<td>770</td>
<td>...</td>
</tr>
<tr>
<td>2</td>
<td>Israman Half 2020</td>
<td>2020-01-29</td>
<td><u>Israel, Eilat</u></td>
<td>670</td>
<td>126</td>
<td>4</td>
<td>796</td>
<td>...</td>
</tr>
<tr>
<td>3</td>
<td>Ironman Indian Wells La Quinta 70.3 2019</td>
<td>2019-12-08</td>
<td><u>Indian Wells/La Quinta, California, USA</u></td>
<td>1590</td>
<td>593</td>
<td>6</td>
<td>2183</td>
<td>...</td>
</tr>
<tr>
<td>4</td>
<td>Ironman Taupo 70.3 2019</td>
<td>2019-12-07</td>
<td><u>New Zealand</u></td>
<td>767</td>
<td>420</td>
<td>3</td>
<td>1187</td>
<td>...</td>
</tr>
<tr>
<td>5</td>
<td>Ironman Bahrain 70.3 2019</td>
<td>2019-12-07</td>
<td><u>Manama, Bahrain</u></td>
<td>858</td>
<td>214</td>
<td>38</td>
<td>1072</td>
<td>...</td>
</tr>
<tr>
<td>6</td>
<td>Ironman Western Australia 2019</td>
<td>2019-12-01</td>
<td><u>Busselton, Western Australia</u></td>
<td>940</td>
<td>229</td>
<td>1</td>
<td>1169</td>
<td>...</td>
</tr>
<tr>
<td>7</td>
<td>Ironman Mar del Plata 2019</td>
<td>2019-12-01</td>
<td><u>Mar del Plata, Argentina</u></td>
<td>506</td>
<td>66</td>
<td>3</td>
<td>572</td>
<td>...</td>
</tr>
<tr>
<td>8</td>
<td>Ironman Cozumel 2019</td>
<td>2019-11-24</td>
<td><u>Cozumel, Mexico</u></td>
<td>1158</td>
<td>395</td>
<td>12</td>
<td>1553</td>
<td>...</td>
</tr>
<tr>
<td>9</td>
<td>Ironman Arizona 2019</td>
<td>2019-11-24</td>
<td><u>Tempe, Arizona, USA</u></td>
<td>1697</td>
<td>633</td>
<td>3</td>
<td>2330</td>
<td>...</td>
</tr>
<tr>
<td>10</td>
<td>Ironman Xiamen 70.3 2019</td>
<td>2019-11-10</td>
<td><u>Xiamen, China</u></td>
<td>897</td>
<td>170</td>
<td>14</td>
<td>1067</td>
<td>...</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speichern. </font><font style="vertical-align: inherit;">In eine neue Datei.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\summary1.pkl'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:<font></font>
    pkl.dump(df,f)<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teil 2. Geben Sie Casting und Formatierung ein</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also haben wir alle Daten heruntergeladen und in die Datenrahmen eingef√ºgt. </font><font style="vertical-align: inherit;">Alle Werte sind jedoch vom Typ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dies gilt f√ºr das Datum, die Ergebnisse, den Ort und alle anderen Parameter. </font><font style="vertical-align: inherit;">Alle Parameter m√ºssen in die entsprechenden Typen konvertiert werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beginnen wir mit der Pivot-Tabelle.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th>date</th>
<th><u>loc</u></th>
<th>male</th>
<th>female</th>
<th>rus</th>
<th>total</th>
<th>link</th>
</tr>
<tr>
<td>0</td>
<td>Ironman Dubai Duathlon 70.3 2020</td>
<td>2020-07-02</td>
<td><u>Dubai, United Arab Emirates</u></td>
<td>835</td>
<td>215</td>
<td>65</td>
<td>1050</td>
<td>...</td>
</tr>
<tr>
<td>1</td>
<td>Ironman Dubai 70.3 2020</td>
<td>2020-02-07</td>
<td><u>Dubai, United Arab Emirates</u></td>
<td>638</td>
<td>132</td>
<td>55</td>
<td>770</td>
<td>...</td>
</tr>
<tr>
<td>2</td>
<td>Israman Half 2020</td>
<td>2020-01-29</td>
<td><u>Israel, Eilat</u></td>
<td>670</td>
<td>126</td>
<td>4</td>
<td>796</td>
<td>...</td>
</tr>
<tr>
<td>3</td>
<td>Ironman Indian Wells La Quinta 70.3 2019</td>
<td>2019-12-08</td>
<td><u>Indian Wells/La Quinta, California, USA</u></td>
<td>1590</td>
<td>593</td>
<td>6</td>
<td>2183</td>
<td>...</td>
</tr>
<tr>
<td>4</td>
<td>Ironman Taupo 70.3 2019</td>
<td>2019-12-07</td>
<td><u>New Zealand</u></td>
<td>767</td>
<td>420</td>
<td>3</td>
<td>1187</td>
<td>...</td>
</tr>
<tr>
<td>5</td>
<td>Ironman Bahrain 70.3 2019</td>
<td>2019-12-07</td>
<td><u>Manama, Bahrain</u></td>
<td>858</td>
<td>214</td>
<td>38</td>
<td>1072</td>
<td>...</td>
</tr>
<tr>
<td>6</td>
<td>Ironman Western Australia 2019</td>
<td>2019-12-01</td>
<td><u>Busselton, Western Australia</u></td>
<td>940</td>
<td>229</td>
<td>1</td>
<td>1169</td>
<td>...</td>
</tr>
<tr>
<td>7</td>
<td>Ironman Mar del Plata 2019</td>
<td>2019-12-01</td>
<td><u>Mar del Plata, Argentina</u></td>
<td>506</td>
<td>66</td>
<td>3</td>
<td>572</td>
<td>...</td>
</tr>
<tr>
<td>8</td>
<td>Ironman Cozumel 2019</td>
<td>2019-11-24</td>
<td><u>Cozumel, Mexico</u></td>
<td>1158</td>
<td>395</td>
<td>12</td>
<td>1553</td>
<td>...</td>
</tr>
<tr>
<td>9</td>
<td>Ironman Arizona 2019</td>
<td>2019-11-24</td>
<td><u>Tempe, Arizona, USA</u></td>
<td>1697</td>
<td>633</td>
<td>3</td>
<td>2330</td>
<td>...</td>
</tr>
<tr>
<td>10</td>
<td>Ironman Xiamen 70.3 2019</td>
<td>2019-11-10</td>
<td><u>Xiamen, China</u></td>
<td>897</td>
<td>170</td>
<td>14</td>
<td>1067</td>
<td>...</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
<td><u>...</u></td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody></table></div></code><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datum (und Uhrzeit</font></font></h3><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ereignis</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Ort </font><font style="vertical-align: inherit;">und </font><i><font style="vertical-align: inherit;">Link</font></i><font style="vertical-align: inherit;"> bleiben </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unver√§ndert</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><i><font style="vertical-align: inherit;">Datum</font></i><font style="vertical-align: inherit;"> Konvertit </font><i><font style="vertical-align: inherit;">Pandas datetime</font></i><font style="vertical-align: inherit;"> wie folgt:</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">rs[<span class="hljs-string">'date'</span>] = pd.to_datetime(rs[<span class="hljs-string">'date'</span>])
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Rest wird in einen ganzzahligen Typ umgewandelt:</font></font><br>
<br>
<pre><code class="python hljs">cols = [<span class="hljs-string">'males'</span>, <span class="hljs-string">'females'</span>, <span class="hljs-string">'rus'</span>, <span class="hljs-string">'total'</span>]<font></font>
rs[cols] = rs[cols].astype(int)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alles verlief reibungslos, es traten keine Fehler auf. </font><font style="vertical-align: inherit;">Also alles in Ordnung - speichern:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\summary2.pkl'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:<font></font>
    pkl.dump(rs, f)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt Rennen Datenrahmen. </font><font style="vertical-align: inherit;">Da alle Rennen bequemer und schneller auf einmal und nicht einzeln verarbeitet werden k√∂nnen, werden sie </font><font style="vertical-align: inherit;">mithilfe der </font><i><font style="vertical-align: inherit;">concat-</font></i><font style="vertical-align: inherit;"> Methode </font><font style="vertical-align: inherit;">in einem gro√üen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ar-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Datenrahmen </font><font style="vertical-align: inherit;">(kurz f√ºr </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">alle Datens√§tze</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) zusammengefasst </font><font style="vertical-align: inherit;">.</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar = pd.concat(rd) 
</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> enth√§lt 1.416.365 Eintr√§ge. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Konvertieren Sie nun place und place in group in einen ganzzahligen Wert.</font></font><br>
<br>
<pre><code class="python hljs">ar[[<span class="hljs-string">'place'</span>, <span class="hljs-string">'place in group'</span>]] = ar[[<span class="hljs-string">'place'</span>, <span class="hljs-string">'place in group'</span>]].astype(int))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als n√§chstes verarbeiten wir die Spalten mit tempor√§ren Werten. </font><font style="vertical-align: inherit;">Wir werden sie in der Art </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Timedelta</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pandas </font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">gie√üen</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Damit die Konvertierung jedoch erfolgreich ist, m√ºssen Sie die Daten ordnungsgem√§√ü vorbereiten. </font><font style="vertical-align: inherit;">Sie k√∂nnen sehen, dass einige Werte, die weniger als eine Stunde betragen, ohne Angabe des Tippes vergehen. </font><font style="vertical-align: inherit;">M√ºssen Sie es hinzuf√ºgen.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>place in group</th>
<th><u>swim</u></th>
<th><u>t1</u></th>
<th>bike</th>
<th><u>t2</u></th>
<th>run</th>
<th>result</th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td>Dejan Patrcevic</td>
<td>CRO</td>
<td>M40-44</td>
<td>1</td>
<td><u>29:03</u></td>
<td><u>2:50</u></td>
<td>2:09:17</td>
<td><u>1:37</u></td>
<td>1:22:06</td>
<td>4:04:51</td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td>Lukas Krpec</td>
<td>CZE</td>
<td>M35-39</td>
<td>1</td>
<td><u>29:00</u></td>
<td><u>2:40</u></td>
<td>2:07:01</td>
<td><u>1:48</u></td>
<td>1:25:48</td>
<td>4:06:15</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td>Marin Koceic</td>
<td>CRO</td>
<td>M40-44</td>
<td>2</td>
<td><u>27:34</u></td>
<td><u>2:09</u></td>
<td>2:12:13</td>
<td><u>1:30</u></td>
<td>1:27:19</td>
<td>4:10:44</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> [<span class="hljs-string">'swim'</span>, <span class="hljs-string">'t1'</span>, <span class="hljs-string">'bike'</span>, <span class="hljs-string">'t2'</span>, <span class="hljs-string">'run'</span>, <span class="hljs-string">'result'</span>]:<font></font>
    strlen = ar[col].str.len()<font></font>
    ar.loc[strlen==<span class="hljs-number">5</span>, col] = <span class="hljs-string">'0:'</span> + ar.loc[strlen==<span class="hljs-number">5</span>, col]<font></font>
    ar.loc[strlen==<span class="hljs-number">4</span>, col] = <span class="hljs-string">'0:0'</span> + ar.loc[strlen==<span class="hljs-number">4</span>, col]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt sehen die verbleibenden Zeichenfolgen </font><i><font style="vertical-align: inherit;">folgenderma√üen aus</font></i><font style="vertical-align: inherit;"> : In </font><i><font style="vertical-align: inherit;">Timedelta</font></i><font style="vertical-align: inherit;"> konvertieren </font><font style="vertical-align: inherit;">:</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>place in group</th>
<th><u>swim</u></th>
<th><u>t1</u></th>
<th>bike</th>
<th><u>t2</u></th>
<th>run</th>
<th>result</th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td>Dejan Patrcevic</td>
<td>CRO</td>
<td>M40-44</td>
<td>1</td>
<td><u>0:29:03</u></td>
<td><u>0:02:50</u></td>
<td>2:09:17</td>
<td><u>0:01:37</u></td>
<td>1:22:06</td>
<td>4:04:51</td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td>Lukas Krpec</td>
<td>CZE</td>
<td>M35-39</td>
<td>1</td>
<td><u>0:29:00</u></td>
<td><u>0:02:40</u></td>
<td>2:07:01</td>
<td><u>0:01:48</u></td>
<td>1:25:48</td>
<td>4:06:15</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td>Marin Koceic</td>
<td>CRO</td>
<td>M40-44</td>
<td>2</td>
<td><u>0:27:34</u></td>
<td><u>0:02:09</u></td>
<td>2:12:13</td>
<td><u>0:01:30</u></td>
<td>1:27:19</td>
<td>4:10:44</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> [<span class="hljs-string">'swim'</span>, <span class="hljs-string">'t1'</span>, <span class="hljs-string">'bike'</span>, <span class="hljs-string">'t2'</span>, <span class="hljs-string">'run'</span>, <span class="hljs-string">'result'</span>]:<font></font>
    ar[col] = pd.to_timedelta(ar[col])<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fu√üboden</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mach weiter. </font><font style="vertical-align: inherit;">√úberpr√ºfen Sie, ob in der Spalte </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geschlecht</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nur die Werte von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F angegeben sind</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'sex'</span>].unique() 
</code></pre><br>
<code><b>Out:</b> ['M', 'F', '']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tats√§chlich gibt es immer noch eine leere Zeichenfolge, dh das Geschlecht ist nicht angegeben. </font><font style="vertical-align: inherit;">Mal sehen, wie viele solcher F√§lle:</font></font><br>
<br>
<pre><code class="python hljs">len(ar[ar[<span class="hljs-string">'sex'</span>] == <span class="hljs-string">''</span>]) 
</code></pre><br>
<code><b>Out:</b> 2538<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nicht so viel ist gut. </font><font style="vertical-align: inherit;">In Zukunft werden wir versuchen, diesen Wert weiter zu reduzieren. </font><font style="vertical-align: inherit;">Lassen Sie in der Zwischenzeit die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geschlechtsspalte</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in Form von Linien. </font><font style="vertical-align: inherit;">Wir werden das Ergebnis speichern, bevor wir zu ernsthafteren und riskanteren Transformationen √ºbergehen. </font><font style="vertical-align: inherit;">Um die Kontinuit√§t zwischen den Dateien aufrechtzuerhalten, transformieren wir den kombinierten </font><font style="vertical-align: inherit;">Datenrahmen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zur√ºck in das W√∂rterbuch der Datenrahmen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> ar.index.get_level_values(<span class="hljs-number">0</span>).unique():<font></font>
    rd[event] = ar.loc[event]<font></font>
<font></font>
<span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\details1.pkl'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:<font></font>
    pkl.dump(rd,f)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√úbrigens verringerten sich die Dateigr√∂√üen aufgrund der Konvertierung der Typen einiger Spalten von 367 KB auf 295 KB f√ºr die Pivot-Tabelle und von 251 MB auf 168 MB f√ºr Rennprotokolle. </font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Landesvorwahl</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt schauen wir uns das Land an.</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'country'</span>].unique()
</code></pre><br>
<code><b>Out:</b> ['CRO', 'CZE', 'SLO', 'SRB', 'BUL', 'SVK', 'SWE', 'BIH', 'POL', 'MK', 'ROU', 'GRE', 'FRA', 'HUN', 'NOR', 'AUT', 'MNE', 'GBR', 'RUS', 'UAE', 'USA', 'GER', 'URU', 'CRC', 'ITA', 'DEN', 'TUR', 'SUI', 'MEX', 'BLR', 'EST', 'NED', 'AUS', 'BGI', 'BEL', 'ESP', 'POR', 'UKR', 'CAN', 'IRL', 'JPN', 'HKG', 'JEY', 'SGP', 'BRA', 'QAT', 'LUX', 'RSA', 'NZL', 'LAT', 'PHI', 'KSA', 'SEY', 'MAS', 'OMA', 'ARG', 'ECU', 'THA', 'JOR', 'BRN', 'CIV', 'FIN', 'IRN', 'BER', 'LBA', 'KUW', 'LTU', 'SRI', 'HON', 'INA', 'LBN', 'PAN', 'EGY', 'MLT', 'WAL', 'ISL', 'CYP', 'DOM', 'IND', 'VIE', 'MRI', 'AZE', 'MLD', 'LIE', 'VEN', 'ALG', 'SYR', 'MAR', 'KZK', 'PER', 'COL', 'IRQ', 'PAK', 'CZK', 'KAZ', 'CHN', 'NEP', 'ISR', 'MKD', 'FRO', 'BAN', 'ARU', 'CPV', 'ALB', 'BIZ', 'TPE', 'KGZ', 'BNN', 'CUB', 'SNG', 'VTN', 'THI', 'PRG', 'KOR', 'RE', 'TW', 'VN', 'MOL', 'FRE', 'AND', 'MDV', 'GUA', 'MON', 'ARM', 'F.I.TRI.', 'BAHREIN', 'SUECIA', 'REPUBLICA CHECA', 'BRASIL', 'CHI', 'MDA', 'TUN', 'NDL', 'Danish(Dane)', 'Welsh', 'Austrian', 'Unknown', 'AFG', 'Argentinean', 'Pitcairn', 'South African', 'Greenland', 'ESTADOS UNIDOS', 'LUXEMBURGO', 'SUDAFRICA', 'NUEVA ZELANDA', 'RUMANIA', 'PM', 'BAH', 'LTV', 'ESA', 'LAB', 'GIB', 'GUT', 'SAR', 'ita', 'aut', 'ger', 'esp', 'gbr', 'hun', 'den', 'usa', 'sui', 'slo', 'cze', 'svk', 'fra', 'fin', 'isr', 'irn', 'irl', 'bel', 'ned', 'sco', 'pol', 'SMR', 'mex', 'STEEL T BG', 'KINO MANA', 'IVB', 'TCH', 'SCO', 'KEN', 'BAS', 'ZIM', 'Joe', 'PUR', 'SWZ', 'Mark', 'WLS', 'MYA', 'BOT', 'REU', 'NAM', 'NCL', 'BOL', 'GGY', 'ISV', 'TWN', 'GUM', 'FIJ', 'COK', 'NGR', 'IRI', 'GAB', 'ANT', 'GEO', 'COG', 'sue', 'SUD', 'BAR', 'CAY', 'BO', 'VE', 'AX', 'MD', 'PAR', 'UM', 'SEN', 'NIG', 'RWA', 'YEM', 'PLE', 'GHA', 'ITU', 'UZB', 'MGL', 'MAC', 'DMA', 'TAH', 'TTO', 'AHO', 'JAM', 'SKN', 'GRN', 'PRK', 'NFK', 'SOL', 'Sandy', 'SAM', 'PNG', 'SGS', 'Suchy, Jorg', 'SOG', 'GEQ', 'BVT', 'DJI', 'CHA', 'ANG', 'YUG', 'IOT', 'HAI', 'SJM', 'CUW', 'BHU', 'ERI', 'FLK', 'HMD', 'GUF', 'ESH', 'sandy', 'UMI', 'selsmark, 'Alise', 'Eddie', '31/3, Colin', 'CC', '', '', '', '', '', ' ', '', '', '', '-', '', 'GRL', 'UGA', 'VAT', 'ETH', 'ASA', 'PYF', 'ATA', 'ALA', 'MTQ', 'ZZ', 'CXR', 'AIA', 'TJK', 'GUY', 'KR', 'PF', 'BN', 'MO', 'LA', 'CAM', 'NCA', 'ZAM', 'MAD', 'TOG', 'VIR', 'ATF', 'VAN', 'SLE', 'GLP', 'SCG', 'LAO', 'IMN', 'BUR', 'IR', 'SY', 'CMR', 'GBS', 'SUR', 'MOZ', 'BLM', 'MSR', 'CAF', 'BEN', 'COD', 'CCK', 'TUV', 'TGA', 'GI', 'XKX', 'NRU', 'NC', 'LBR', 'TAN', 'VIN', 'SSD', 'GP', 'PS', 'IM', 'JE', '', 'MLI', 'FSM', 'LCA', 'GMB', 'MHL', 'NH', 'FL', 'CT', 'UT', 'AQ', 'Korea', 'Taiwan', 'NewCaledonia', 'Czech Republic', 'PLW', 'BRU', 'RUN', 'NIU', 'KIR', 'SOM', 'TKM', 'SPM', 'BDI', 'COM', 'TCA', 'SHN', 'DO2', 'DCF', 'PCN', 'MNP', 'MYT', 'SXM', 'MAF', 'GUI', 'AN', 'Slovak republic', 'Channel Islands', 'Reunion', 'Wales', 'Scotland', 'ica', 'WLF', 'D', 'F', 'I', 'B', 'L', 'E', 'A', 'S', 'N', 'H', 'R', 'NU', 'BES', 'Bavaria', 'TLS', 'J', 'TKL', 'Tirol"', 'P', '?????', 'EU', 'ES-IB', 'ES-CT', '', 'SOO', 'LZE', '', '', '', '', '', '']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
412 eindeutige Werte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Grunds√§tzlich wird ein Land durch einen dreistelligen Buchstabencode in Gro√übuchstaben angegeben. </font><font style="vertical-align: inherit;">Aber anscheinend nicht immer. </font><font style="vertical-align: inherit;">Tats√§chlich gibt es eine internationale Norm </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ISO 3166</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , in der f√ºr alle L√§nder, auch f√ºr diejenigen, die nicht mehr existieren, die entsprechenden dreistelligen und zweistelligen Codes vorgeschrieben sind. </font><font style="vertical-align: inherit;">F√ºr </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python befindet sich</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> eine der Implementierungen dieses Standards im </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pycountry-</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Paket </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">So funktioniert das:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> pycountry <span class="hljs-keyword">as</span> pyco<font></font>
<font></font>
pyco.countries.get(alpha_3 = <span class="hljs-string">'RUS'</span>)
</code></pre><br>
<code><b>Out:</b> Country(alpha_2='RU', alpha_3='RUS', name='Russian Federation', numeric='643')<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher werden wir alle dreistelligen Codes √ºberpr√ºfen, die zu Gro√übuchstaben f√ºhren und eine Antwort in </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L√§ndern.get (...)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">historischem_Land.get (...) geben</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs">valid_a3 = [c <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> ar[<span class="hljs-string">'country'</span>].unique() <span class="hljs-keyword">if</span> pyco.countries.get(alpha_3 = c.upper()) != <span class="hljs-literal">None</span> <span class="hljs-keyword">or</span> pyco.historic_countries.get(alpha_3 = c.upper()) != <span class="hljs-literal">None</span>])
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gab 190 von 412 von ihnen, das hei√üt weniger als die H√§lfte. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr den restlichen 222 (wir ihre Liste bezeichnen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tofix</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), werden wir </font><i><font style="vertical-align: inherit;">einen erstellen </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fix</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> passenden W√∂rterbuch </font><font style="vertical-align: inherit;">, in dem der Schl√ºssel wird der urspr√ºngliche Name, und den Wert ist ein dreistelliger Code gem√§√ü der ISO - </font><font style="vertical-align: inherit;">Norm.</font></font><br>
<br>
<pre><code class="python hljs">tofix = list(set(ar[<span class="hljs-string">'country'</span>].unique()) - set(valid_a3))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√úberpr√ºfen Sie zun√§chst die zweistelligen Codes mit </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pycountry.countries.get (alpha_2 = ...)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , was zu Gro√übuchstaben f√ºhrt:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> icc <span class="hljs-keyword">in</span> tofix: <span class="hljs-comment">#icc -invalid country code</span>
    <span class="hljs-keyword">if</span> pyco.countries.get(alpha_2 = icc.upper()) != <span class="hljs-literal">None</span>:<font></font>
        fix[icc] = pyco.countries.get(alpha_2 = icc.upper()).alpha_3<font></font>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">if</span> pyco.historic_countries.get(alpha_2 = icc.upper()) != <span class="hljs-literal">None</span>:<font></font>
            fix[icc] = pyco.historic_countries.get(alpha_2 = icc.upper()).alpha_3<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann die vollst√§ndigen Namen durch </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pycountry.countries.get (name = ...), pycountry.countries.get (common_name = ...)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und f√ºhren sie zur Form </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str.title ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> icc <span class="hljs-keyword">in</span> tofix:
    <span class="hljs-keyword">if</span> pyco.countries.get(common_name = icc.title()) != <span class="hljs-literal">None</span>:<font></font>
        fix[icc] = pyco.countries.get(common_name = icc.title()).alpha_3<font></font>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">if</span> pyco.countries.get(name = icc.title()) != <span class="hljs-literal">None</span>:<font></font>
            fix[icc] = pyco.countries.get(name = icc.title()).alpha_3<font></font>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">if</span> pyco.historic_countries.get(name = icc.title()) != <span class="hljs-literal">None</span>:<font></font>
                fix[icc] = pyco.historic_countries.get(name = icc.title()).alpha_3<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher reduzieren wir die Anzahl der nicht erkannten Werte auf 190. Immer noch ziemlich viel: </font><font style="vertical-align: inherit;">
Sie werden feststellen, dass es unter ihnen immer noch viele dreistellige Codes gibt, aber dies ist keine ISO. </font><font style="vertical-align: inherit;">Was dann? </font><font style="vertical-align: inherit;">Es stellt sich heraus, dass es einen anderen Standard gibt - </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Olympia</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Leider ist seine Implementierung nicht in Pycountry enthalten und Sie m√ºssen nach etwas anderem suchen. </font><font style="vertical-align: inherit;">Die L√∂sung wurde in Form einer </font><i><font style="vertical-align: inherit;">CSV-</font></i><font style="vertical-align: inherit;"> Datei auf </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">datahub.io gefunden</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Platzieren Sie den Inhalt dieser Datei in einem </font><i><font style="vertical-align: inherit;">Pandas DataFrame</font></i><font style="vertical-align: inherit;"> namens </font><i><font style="vertical-align: inherit;">cdf</font></i><font style="vertical-align: inherit;"> . </font><i><font style="vertical-align: inherit;">ioc</font></i><font style="vertical-align: inherit;"> - Internationales Olympisches Komitee (IOC)</font></font><br>
<code>['URU', '', 'PAR', 'SUECIA', 'KUW', 'South African', '', 'Austrian', 'ISV', 'H', 'SCO', 'ES-CT', ', 'GUI', 'BOT', 'SEY', 'BIZ', 'LAB', 'PUR', ' ', 'Scotland', '', '', 'TCH', 'TGA', 'UT', 'BAH', 'GEQ', 'NEP', 'TAH', 'ica', 'FRE', 'E', 'TOG', 'MYA', '', 'Danish (Dane)', 'SAM', 'TPE', 'MON', 'ger', 'Unknown', 'sui', 'R', 'SUI', 'A', 'GRN', 'KZK', 'Wales', '', 'GBS', 'ESA', 'Bavaria', 'Czech Republic', '31/3, Colin', 'SOL', 'SKN', '', 'MGL', 'XKX', 'WLS', 'MOL', 'FIJ', 'CAY', 'ES-IB', 'BER', 'PLE', 'MRI', 'B', 'KSA', '', '', 'LAT', 'GRE', 'ARU', '', 'THI', 'NGR', 'MAD', 'SOG', 'MLD', '?????', 'AHO', 'sco', 'UAE', 'RUMANIA', 'CRO', 'RSA', 'NUEVA ZELANDA', 'KINO MANA', 'PHI', 'sue', 'Tirol"', 'IRI', 'POR', 'CZK', 'SAR', 'D', 'BRASIL', 'DCF', 'HAI', 'ned', 'N', 'BAHREIN', 'VTN', 'EU', 'CAM', 'Mark', 'BUL', 'Welsh', 'VIN', 'HON', 'ESTADOS UNIDOS', 'I', 'GUA', 'OMA', 'CRC', 'PRG', 'NIG', 'BHU', 'Joe', 'GER', 'RUN', 'ALG', '', 'Channel Islands', 'Reunion', 'REPUBLICA CHECA', 'slo', 'ANG', 'NewCaledonia', 'GUT', 'VIE', 'ASA', 'BAR', 'SRI', 'L', '', 'J', 'BAS', 'LUXEMBURGO', 'S', 'CHI', 'SNG', 'BNN', 'den', 'F.I.TRI.', 'STEEL T BG', 'NCA', 'Slovak republic', 'MAS', 'LZE', '-', 'F', 'BRU', '', 'LBA', 'NDL', 'DEN', 'IVB', 'BAN', 'Sandy', 'ZAM', 'sandy', 'Korea', 'SOO', 'BGI', '', 'LTV', 'selsmark, Alise', 'TAN', 'NED', '', 'Suchy, Jorg', 'SLO', 'SUDAFRICA', 'ZIM', 'Eddie', 'INA', '', 'SUD', 'VAN', 'FL', 'P', 'ITU', 'ZZ', 'Argentinean', 'CHA', 'DO2', 'WAL']<br>
</code><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>official name</th>
<th>short name</th>
<th>iso2</th>
<th><u>iso3</u></th>
<th><u>ioc</u></th>
</tr>
<tr>
<td>0</td>
<td>NaN</td>
<td>Taiwan</td>
<td>TW</td>
<td><u>TWN</u></td>
<td><u>TPE</u></td>
</tr>
<tr>
<td>1</td>
<td>Afghanistan</td>
<td>Afghanistan</td>
<td>AF</td>
<td><u>AFG</u></td>
<td><u>AFG</u></td>
</tr>
<tr>
<td>2</td>
<td>Albania</td>
<td>Albania</td>
<td>AL</td>
<td><u>ALB</u></td>
<td><u>ALB</u></td>
</tr>
<tr>
<td>3</td>
<td>Algeria</td>
<td>Algeria</td>
<td>DZ</td>
<td><u>DZA</u></td>
<td><u>ALG</u></td>
</tr>
<tr>
<td>4</td>
<td>American Samoa</td>
<td>American Samoa</td>
<td>AS</td>
<td><u>ASM</u></td>
<td><u>ASA</u></td>
</tr>
<tr>
<td>5</td>
<td>Andorra</td>
<td>Andorra</td>
<td>AD</td>
<td><u>AND</u></td>
<td><u>AND</u></td>
</tr>
<tr>
<td>6</td>
<td>Angola</td>
<td>Angola</td>
<td>AO</td>
<td><u>AGO</u></td>
<td><u>ANG</u></td>
</tr>
<tr>
<td>7</td>
<td>Anguilla</td>
<td>Anguilla</td>
<td>AI</td>
<td><u>AIA</u></td>
<td><u>AIA</u></td>
</tr>
<tr>
<td>8</td>
<td>Antarctica</td>
<td>Antarctica</td>
<td>AQ</td>
<td><u>ATA</u></td>
<td><u>NaN</u></td>
</tr>
<tr>
<td>9</td>
<td>Antigua and Barbuda</td>
<td>Antigua &amp; Barbuda</td>
<td>AG</td>
<td><u>ATG</u></td>
<td><u>ANT</u></td>
</tr>
<tr>
<td>10</td>
<td>Argentina</td>
<td>Argentina</td>
<td>AR</td>
<td><u>ARG</u></td>
<td><u>ARG</u></td>
</tr>
</tbody></table></div></code><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">len(([x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> tofix <span class="hljs-keyword">if</span> x.upper() <span class="hljs-keyword">in</span> list(cdf[<span class="hljs-string">'ioc'</span>])]))
</code></pre><br>
<code><b>Out:</b> 82<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unter den dreistelligen Codes von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tofix wurden</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 82 entsprechende </font><i><font style="vertical-align: inherit;">IOCs</font></i><font style="vertical-align: inherit;"> gefunden. </font><font style="vertical-align: inherit;">F√ºgen Sie sie unserem passenden W√∂rterbuch hinzu.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> icc <span class="hljs-keyword">in</span> tofix:
    <span class="hljs-keyword">if</span> icc.upper() <span class="hljs-keyword">in</span> list(cdf[<span class="hljs-string">'ioc'</span>]):<font></font>
        ind = cdf[cdf[<span class="hljs-string">'ioc'</span>] == icc.upper()].index[<span class="hljs-number">0</span>]<font></font>
        fix[icc] = cdf.loc[ind, <span class="hljs-string">'iso3'</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
108 Rohwerte √ºbrig. </font><font style="vertical-align: inherit;">Sie werden manuell beendet und wenden sich manchmal an Google, um Hilfe zu erhalten. </font><font style="vertical-align: inherit;">
Aber selbst die manuelle Steuerung l√∂st das Problem nicht vollst√§ndig. </font><font style="vertical-align: inherit;">Es bleiben 49 Werte √ºbrig, die bereits nicht zu interpretieren sind. </font><font style="vertical-align: inherit;">Die meisten dieser Werte sind wahrscheinlich nur Datenfehler.</font></font><br>
<code>{'BGI': 'BRB', 'WAL': 'GBR', 'MLD': 'MDA', 'KZK': 'KAZ', 'CZK': 'CZE', 'BNN': 'BEN', 'SNG': 'SGP', 'VTN': 'VNM', 'THI': 'THA', 'PRG': 'PRT', 'MOL': 'MDA', 'FRE': 'FRA', 'F.I.TRI.': 'ITA', 'BAHREIN': 'BHR', 'SUECIA': 'SWE', 'REPUBLICA CHECA': 'CZE', 'BRASIL': 'BRA', 'NDL': 'NLD', 'Danish (Dane)': 'DNK', 'Welsh': 'GBR', 'Austrian': 'AUT', 'Argentinean': 'ARG', 'South African': 'ZAF', 'ESTADOS UNIDOS': 'USA', 'LUXEMBURGO': 'LUX', 'SUDAFRICA': 'ZAF', 'NUEVA ZELANDA': 'NZL', 'RUMANIA': 'ROU', 'sco': 'GBR', 'SCO': 'GBR', 'WLS': 'GBR', '': 'IND', '': 'IRL', '': 'ARM', '': 'BGR', '': 'SRB', ' ': 'BLR', '': 'GBR', '': 'FRA', '': 'HND', '-': 'CRI', '': 'AZE', 'Korea': 'KOR', 'NewCaledonia': 'FRA', 'Czech Republic': 'CZE', 'Slovak republic': 'SVK', 'Channel Islands': 'FRA', 'Reunion': 'FRA', 'Wales': 'GBR', 'Scotland': 'GBR', 'Bavaria': 'DEU', 'Tirol"': 'AUT', '': 'KGZ', '': 'BLR', '': 'BLR', '': 'BLR', '': 'RUS', '': 'BLR', '': 'RUS'}<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">unfixed = [x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> tofix <span class="hljs-keyword">if</span> x <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> fix.keys()]
</code></pre><br>
<code><b>Out:</b> ['', 'H', 'ES-CT', 'LAB', 'TCH', 'UT', 'TAH', 'ica', 'E', 'Unknown', 'R', 'A', '31/3, Colin', 'XKX', 'ES-IB','B','SOG','?????','KINO MANA','sue','SAR','D', 'DCF', 'N', 'EU', 'Mark', 'I', 'Joe', 'RUN', 'GUT', 'L', 'J', 'BAS', 'S', 'STEEL T BG', 'LZE', 'F', 'Sandy', 'DO2', 'sandy', 'SOO', 'LTV', 'selsmark, Alise', 'Suchy, Jorg' 'Eddie', 'FL', 'P', 'ITU', 'ZZ']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Schl√ºssel haben eine leere Zeichenfolge im passenden W√∂rterbuch.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> cc <span class="hljs-keyword">in</span> unfixed:<font></font>
    fix[cc] = <span class="hljs-string">''</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schlie√ülich f√ºgen wir den passenden W√∂rterbuchcodes hinzu, die g√ºltig, aber in Kleinbuchstaben geschrieben sind.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> cc <span class="hljs-keyword">in</span> valid_a3:
    <span class="hljs-keyword">if</span> cc.upper() != cc:<font></font>
        fix[cc] = cc.upper()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt ist es Zeit, die gefundenen Ersetzungen anzuwenden. </font><font style="vertical-align: inherit;">Um die anf√§nglichen Daten f√ºr einen weiteren Vergleich zu speichern, kopieren Sie die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L√§nderspalte</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in das </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Land "raw"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Anschlie√üend korrigieren wir mithilfe des erstellten √ºbereinstimmenden W√∂rterbuchs die </font><font style="vertical-align: inherit;">Werte </font><font style="vertical-align: inherit;">in der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L√§nderspalte</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die nicht der ISO entsprechen.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> cc <span class="hljs-keyword">in</span> fix:<font></font>
    ind = ar[ar[<span class="hljs-string">'country'</span>] == cc].index<font></font>
    ar.loc[ind,<span class="hljs-string">'country'</span>] = fix[cc]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier kann man nat√ºrlich nicht auf Vektorisierung verzichten, die Tabelle hat fast eineinhalb Millionen Zeilen. </font><font style="vertical-align: inherit;">Aber laut W√∂rterbuch machen wir einen Zyklus, aber wie sonst? </font><font style="vertical-align: inherit;">√úberpr√ºfen Sie, wie viele Datens√§tze ge√§ndert wurden:</font></font><br>
<br>
<pre><code class="python hljs">len(ar[ar[<span class="hljs-string">'country'</span>] != ar[<span class="hljs-string">'country raw'</span>]])
</code></pre><br>
<code><b>Out:</b> 315955<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
das sind mehr als 20% der Gesamtmenge. </font></font><br>
<br>
<pre><code class="python hljs">ar[ar[<span class="hljs-string">'country'</span>] != ar[<span class="hljs-string">'country raw'</span>]].sample(<span class="hljs-number">10</span>)
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th><u>country</u></th>
<th>group</th>
<th>place in group</th>
<th>...</th>
<th><u>country raw</u></th>
</tr>
<tr>
<td>285</td>
<td>286</td>
<td>M</td>
<td>Albaek, Mads Orla</td>
<td><u>DNK</u></td>
<td>M30-34</td>
<td>63</td>
<td>...</td>
<td><u>DEN</u></td>
</tr>
<tr>
<td>1288</td>
<td>1289</td>
<td>M</td>
<td>Benthien, Andreas</td>
<td><u>DEU</u></td>
<td>M40-44</td>
<td>198</td>
<td>...</td>
<td><u>GER</u></td>
</tr>
<tr>
<td>490</td>
<td>491</td>
<td>M</td>
<td>Lontok, Joselito</td>
<td><u>PHL</u></td>
<td>M50-54</td>
<td>18</td>
<td>...</td>
<td><u>PHI</u></td>
</tr>
<tr>
<td>145</td>
<td>146</td>
<td>M</td>
<td>Mathiasen, Keld</td>
<td><u>DNK</u></td>
<td>M45-49</td>
<td>16</td>
<td>...</td>
<td><u>DEN</u></td>
</tr>
<tr>
<td>445</td>
<td>446</td>
<td>M</td>
<td>Palm, Francois</td>
<td><u>ZAF</u></td>
<td>M25-29</td>
<td>48</td>
<td>...</td>
<td><u>RSA</u></td>
</tr>
<tr>
<td>152</td>
<td>153</td>
<td>M</td>
<td>Muller, Johannes</td>
<td><u>DEU</u></td>
<td>M35-39</td>
<td>19</td>
<td>...</td>
<td><u>GER</u></td>
</tr>
<tr>
<td>764</td>
<td>765</td>
<td>F</td>
<td>Woscher Sylvia</td>
<td><u>DEU</u></td>
<td>F55-59</td>
<td>8</td>
<td>...</td>
<td><u>GER</u></td>
</tr>
<tr>
<td>2182</td>
<td>2183</td>
<td>M</td>
<td>Kojellis, Holger</td>
<td><u>DEU</u></td>
<td>M40-44</td>
<td>258</td>
<td>...</td>
<td><u>GER</u></td>
</tr>
<tr>
<td>1293</td>
<td>1294</td>
<td>M</td>
<td>Zweer, Waldemar</td>
<td><u>DEU</u></td>
<td>M25-29</td>
<td>117</td>
<td>...</td>
<td><u>GER</u></td>
</tr>
<tr>
<td>747</td>
<td>748</td>
<td>M</td>
<td>Petersen, Mathias</td>
<td><u>DNK</u></td>
<td>M25-29</td>
<td>79</td>
<td>...</td>
<td><u>DE</u></td>
</tr>
</tbody></table></div></code><br>
<pre><code class="python hljs">len(ar[ar[<span class="hljs-string">'country'</span>] == <span class="hljs-string">''</span>])
</code></pre><br>
<code><b>Out:</b> 3221<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist die Anzahl der Datens√§tze ohne Land oder mit einem informellen Land. </font><font style="vertical-align: inherit;">Die Anzahl der einzelnen L√§nder ist von 412 auf 250 gesunken. Hier sind sie: </font><font style="vertical-align: inherit;">
Jetzt gibt es keine Abweichungen mehr. </font><i><font style="vertical-align: inherit;">Wir speichern das</font></i><font style="vertical-align: inherit;"> Ergebnis in einer neuen Datei </font><i><font style="vertical-align: inherit;">details2.pkl</font></i><font style="vertical-align: inherit;"> , nachdem </font><i><font style="vertical-align: inherit;">wir</font></i><font style="vertical-align: inherit;"> den kombinierten Datenrahmen wie zuvor wieder in ein W√∂rterbuch mit Datenrahmen konvertiert haben.</font></font><br>
<code>['', 'ABW', 'AFG', 'AGO', 'AIA', 'ALA', 'ALB', 'AND', 'ANT', 'ARE', 'ARG', 'ARM', 'ASM', 'ATA', 'ATF', 'AUS', 'AUT', 'AZE', 'BDI', 'BEL', 'BEN', 'BES', 'BGD', 'BGR', 'BHR', 'BHS', 'BIH', 'BLM', 'BLR', 'BLZ', 'BMU', 'BOL', 'BRA', 'BRB', 'BRN', 'BTN', 'BUR', 'BVT', 'BWA', 'CAF', 'CAN', 'CCK', 'CHE', 'CHL', 'CHN', 'CIV', 'CMR', 'COD', 'COG', 'COK', 'COL', 'COM', 'CPV', 'CRI', 'CTE', 'CUB', 'CUW', 'CXR', 'CYM', 'CYP', 'CZE', 'DEU', 'DJI', 'DMA', 'DNK', 'DOM', 'DZA', 'ECU', 'EGY', 'ERI', 'ESH', 'ESP', 'EST', 'ETH', 'FIN', 'FJI', 'FLK', 'FRA', 'FRO', 'FSM', 'GAB', 'GBR', 'GEO', 'GGY', 'GHA', 'GIB', 'GIN', 'GLP', 'GMB', 'GNB', 'GNQ', 'GRC', 'GRD', 'GRL', 'GTM', 'GUF', 'GUM', 'GUY', 'HKG', 'HMD', 'HND', 'HRV', 'HTI', 'HUN', 'IDN', 'IMN', 'IND', 'IOT', 'IRL', 'IRN', 'IRQ', 'ISL', 'ISR', 'ITA', 'JAM', 'JEY', 'JOR', 'JPN', 'KAZ', 'KEN', 'KGZ', 'KHM', 'KIR', 'KNA', 'KOR', 'KWT', 'LAO', 'LBN', 'LBR', 'LBY', 'LCA', 'LIE', 'LKA', 'LTU', 'LUX', 'LVA', 'MAC', 'MAF', 'MAR', 'MCO', 'MDA', 'MDG', 'MDV', 'MEX', 'MHL', 'MKD', 'MLI', 'MLT', 'MMR', 'MNE', 'MNG', 'MNP', 'MOZ', 'MSR', 'MTQ', 'MUS', 'MYS', 'MYT', 'NAM', 'NCL', 'NER', 'NFK', 'NGA', 'NHB', 'NIC', 'NIU', 'NLD', 'NOR', 'NPL', 'NRU', 'NZL', 'OMN', 'PAK', 'PAN', 'PCN', 'PER', 'PHL', 'PLW', 'PNG', 'POL', 'PRI', 'PRK', 'PRT', 'PRY', 'PSE', 'PYF', 'QAT', 'REU', 'ROU', 'RUS', 'RWA', 'SAU', 'SCG', 'SDN', 'SEN', 'SGP', 'SGS', 'SHN', 'SJM', 'SLB', 'SLE', 'SLV', 'SMR', 'SOM', 'SPM', 'SRB', 'SSD', 'SUR', 'SVK', 'SVN', 'SWE', 'SWZ', 'SXM', 'SYC', 'SYR', 'TCA', 'TCD', 'TGO', 'THA', 'TJK', 'TKL', 'TKM', 'TLS', 'TON', 'TTO', 'TUN', 'TUR', 'TUV', 'TWN', 'TZA', 'UGA', 'UKR', 'UMI', 'URY', 'USA', 'UZB', 'VAT', 'VCT', 'VEN', 'VGB', 'VIR', 'VNM', 'VUT', 'WLF', 'WSM', 'YEM', 'YUG', 'ZAF', 'ZMB', 'ZWE']<br>
</code><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Standort</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Denken Sie nun daran, dass die Erw√§hnung von L√§ndern auch in der Pivot-Tabelle in der Spalte </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">loc enthalten ist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Es muss auch zu einem Standard-Look gebracht werden. Hier ist eine etwas andere Geschichte: Weder ISO- noch Olympia-Codes sind sichtbar. Alles wird in einer ziemlich freien Form beschrieben. Die Stadt, das Land und andere Komponenten der Adresse werden mit einem Komma und in zuf√§lliger Reihenfolge aufgelistet. Irgendwo an erster Stelle, irgendwo an letzter Stelle. pycountry wird hier nicht helfen. Und es gibt viele Rekorde - f√ºr das Rennen 1922 525 einzigartige Orte (in seiner urspr√ºnglichen Form). </font><font style="vertical-align: inherit;">
Aber hier wurde ein geeignetes Werkzeug gefunden. Dies ist </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Geopy</font></a><font style="vertical-align: inherit;"> , n√§mlich der </font><i><font style="vertical-align: inherit;">Geolocator Nominatim</font></i><font style="vertical-align: inherit;"> . Es funktioniert so:</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th>date</th>
<th><u>loc</u></th>
<th>males</th>
<th>females</th>
<th>rus</th>
<th>total</th>
<th>link</th>
</tr>
<tr>
<td>0</td>
<td>Ironman Dubai Duathlon 70.3 2020</td>
<td>2020-07-02</td>
<td><u>Dubai, United Arab Emirates</u></td>
<td>835</td>
<td>215</td>
<td>65</td>
<td>1050</td>
<td>‚Ä¶</td>
</tr>
<tr>
<td>1</td>
<td>Ironman Dubai 70.3 2020</td>
<td>2020-02-07</td>
<td><u>Dubai, United Arab Emirates</u></td>
<td>638</td>
<td>132</td>
<td>55</td>
<td>770</td>
<td>‚Ä¶</td>
</tr>
<tr>
<td>2</td>
<td>Israman Half 2020</td>
<td>2020-01-29</td>
<td><u>Israel, Eilat</u></td>
<td>670</td>
<td>126</td>
<td>4</td>
<td>796</td>
<td>‚Ä¶</td>
</tr>
<tr>
<td>3</td>
<td>Ironman Indian Wells La Quinta 70.3 2019</td>
<td>2019-12-08</td>
<td><u>Indian Wells/La Quinta, California, USA</u></td>
<td>1590</td>
<td>593</td>
<td>6</td>
<td>2183</td>
<td>‚Ä¶</td>
</tr>
<tr>
<td>4</td>
<td>Ironman Taupo 70.3 2019</td>
<td>2019-12-07</td>
<td><u>New Zealand</u></td>
<td>767</td>
<td>420</td>
<td>3</td>
<td>1187</td>
<td>‚Ä¶</td>
</tr>
<tr>
<td>5</td>
<td>Ironman Bahrain 70.3 2019</td>
<td>2019-12-07</td>
<td><u>Manama, Bahrain</u></td>
<td>858</td>
<td>214</td>
<td>38</td>
<td>1072</td>
<td>‚Ä¶</td>
</tr>
<tr>
<td>6</td>
<td>Ironman Western Australia 2019</td>
<td>2019-12-01</td>
<td><u>Busselton, Western Australia</u></td>
<td>940</td>
<td>229</td>
<td>1</td>
<td>1169</td>
<td>‚Ä¶</td>
</tr>
<tr>
<td>7</td>
<td>Ironman Mar del Plata 2019</td>
<td>2019-12-01</td>
<td><u>Mar del Plata, Argentina</u></td>
<td>506</td>
<td>66</td>
<td>3</td>
<td>572</td>
<td>‚Ä¶</td>
</tr>
<tr>
<td>8</td>
<td>Ironman Cozumel 2019</td>
<td>2019-11-24</td>
<td><u>Cozumel, Mexico</u></td>
<td>1158</td>
<td>395</td>
<td>12</td>
<td>1553</td>
<td>‚Ä¶</td>
</tr>
<tr>
<td>9</td>
<td>Ironman Arizona 2019</td>
<td>2019-11-24</td>
<td><u>Tempe, Arizona, USA</u></td>
<td>1697</td>
<td>633</td>
<td>3</td>
<td>2330</td>
<td>‚Ä¶</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> geopy.geocoders <span class="hljs-keyword">import</span> Nominatim<font></font>
<font></font>
geolocator = Nominatim(user_agent=<span class="hljs-string">'triathlon results researcher'</span>)<font></font>
geolocator.geocode(<span class="hljs-string">' , , '</span>, language=<span class="hljs-string">'en'</span>)
</code></pre><br>
<code><b>Out:</b> Location( ,  ‚Äì  ,  , Altaysky District, Altai Krai, Siberian Federal District, Russia, (51.78897945, 85.73956296106752, 0.0))<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf Anfrage gibt es in zuf√§lliger Form eine strukturierte Antwortadresse und Koordinaten. Wenn Sie die Sprache wie hier einstellen - Englisch, was es kann - wird √ºbersetzt. Zun√§chst ben√∂tigen wir den Standardnamen des Landes f√ºr die sp√§tere √úbersetzung in den ISO-Code. Es nimmt nur den letzten Platz in der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adresseigenschaft ein</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Da </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geolocator</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> jedes Mal eine Anfrage an den Server sendet, ist dieser Vorgang nicht schnell und dauert 500 Minuten f√ºr 500 Datens√§tze. Au√üerdem kommt es vor, dass die Antwort nicht kommt. In diesem Fall hilft manchmal eine zweite Anfrage. In meiner ersten Antwort kamen nicht zu 130 Anfragen. Die meisten von ihnen wurden mit zwei Wiederholungsversuchen verarbeitet. 34 Namen wurden jedoch auch bei mehreren weiteren Versuchen nicht verarbeitet. Hier sind sie:</font></font><br>
<code>['Tongyeong, Korea, Korea, South', 'Constanta, Mamaia, Romania, Romania', 'Weihai, China, China', '. ,  .', 'Odaiba Marin Park, Tokyo, Japan, Japan', 'Sweden, Smaland, Kalmar', 'Cholpon-Ata city, Resort Center "Kapriz", Kyrgyzstan', 'Luxembourg, Region Moselle, Moselle', 'Chita Peninsula, Japan', 'Kraichgau Region, Germany', 'Jintang, Chengdu, Sichuan Province, China, China', 'Madrid, Spain, Spain', 'North American Pro Championship, St. George, Utah, USA', 'Milan Idroscalo Linate, Italy', 'Dexing, Jiangxi Province, China, China', 'Mooloolaba, Australia, Australia', 'Nathan Benderson Park (NBP), 5851 Nathan Benderson Circle, Sarasota, FL 34235., United States', 'Strathclyde Country Park, North Lanarkshire, Glasgow, Great Britain', 'Quijing, China', 'United States of America , Hawaii, Kohala Coast', 'Buffalo City, East London, South Africa', 'Spain, Vall de Cardener', ', .    ', 'Asian TriClub Championship, Hefei, China', 'Taizhou, Jiangsu Province, China, China', ', ,  ¬´¬ª', 'Buffalo, Gallagher Beach, Furhmann Blvd, United States', 'North American Pro Championship | St. George, Utah, USA', 'Weihai, Shandong, China, China', 'Tarzo - Revine Lago, Italy', 'Lausanee, Switzerland', 'Queenstown, New Zealand, New Zealand', 'Makuhari, Japan, Japan', 'Szombathlely, Hungary']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist zu sehen, dass in vielen L√§ndern das Land doppelt erw√§hnt wird, und dies st√∂rt tats√§chlich. </font><font style="vertical-align: inherit;">Im Allgemeinen musste ich diese verbleibenden Namen manuell verarbeiten und Standardadressen wurden f√ºr alle erhalten. </font><font style="vertical-align: inherit;">Au√üerdem habe ich aus diesen Adressen ein Land ausgew√§hlt und dieses Land in eine neue Spalte in der Pivot-Tabelle geschrieben. </font><font style="vertical-align: inherit;">Da die Arbeit mit </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geopy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , wie gesagt, </font><font style="vertical-align: inherit;">nicht schnell ist, habe ich beschlossen, die Standortkoordinaten - L√§ngen- und Breitengrad - sofort zu speichern. </font><font style="vertical-align: inherit;">Sie werden sp√§ter zur Visualisierung auf der Karte n√ºtzlich sein. </font><font style="vertical-align: inherit;">Danach </font><i><font style="vertical-align: inherit;">suchte Alpha_3</font></i><font style="vertical-align: inherit;"> mit </font><i><font style="vertical-align: inherit;">pyco.countries.get (name = '...')</font></i><font style="vertical-align: inherit;"> nach dem Land nach Namen und wies ihm einen dreistelligen Code zu.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th>date</th>
<th>loc</th>
<th><u>country</u></th>
<th><u>latitude</u></th>
<th><u>longitude</u></th>
<th>...</th>
</tr>
<tr>
<td>0</td>
<td>Ironman Dubai Duathlon 70.3 2020</td>
<td>2020-07-02</td>
<td>Dubai, United Arab Emirates</td>
<td><u>United Arab Emirates</u></td>
<td><u>25.0657</u></td>
<td><u>55.1713</u></td>
<td>...</td>
</tr>
<tr>
<td>1</td>
<td>Ironman Dubai 70.3 2020</td>
<td>2020-02-07</td>
<td>Dubai, United Arab Emirates</td>
<td><u>United Arab Emirates</u></td>
<td><u>25.0657</u></td>
<td><u>55.1713</u></td>
<td>...</td>
</tr>
<tr>
<td>2</td>
<td>Israman Half 2020</td>
<td>2020-01-29</td>
<td>Israel, Eilat</td>
<td><u>Israel</u></td>
<td><u>29.5569</u></td>
<td><u>34.9498</u></td>
<td>...</td>
</tr>
<tr>
<td>3</td>
<td>Ironman Indian Wells La Quinta 70.3 2019</td>
<td>2019-12-08</td>
<td>Indian Wells/La Quinta, California, USA</td>
<td><u>United States of America</u></td>
<td><u>33.7238</u></td>
<td><u>-116.305</u></td>
<td>...</td>
</tr>
<tr>
<td>4</td>
<td>Ironman Taupo 70.3 2019</td>
<td>2019-12-07</td>
<td>New Zealand</td>
<td><u>New Zealand</u></td>
<td><u>-41.5001</u></td>
<td><u>172.834</u></td>
<td>...</td>
</tr>
<tr>
<td>5</td>
<td>Ironman Bahrain 70.3 2019</td>
<td>2019-12-07</td>
<td>Manama, Bahrain</td>
<td><u>Bahrain</u></td>
<td><u>26.2235</u></td>
<td><u>50.5822</u></td>
<td>...</td>
</tr>
<tr>
<td>6</td>
<td>Ironman Western Australia 2019</td>
<td>2019-12-01</td>
<td>Busselton, Western Australia</td>
<td><u>Australia</u></td>
<td><u>-33.6445</u></td>
<td><u>115.349</u></td>
<td>...</td>
</tr>
<tr>
<td>7</td>
<td>Ironman Mar del Plata 2019</td>
<td>2019-12-01</td>
<td>Mar del Plata, Argentina</td>
<td><u>Argentina</u></td>
<td><u>-37.9977</u></td>
<td><u>-57.5483</u></td>
<td>...</td>
</tr>
<tr>
<td>8</td>
<td>Ironman Cozumel 2019</td>
<td>2019-11-24</td>
<td>Cozumel, Mexico</td>
<td><u>Mexico</u></td>
<td><u>20.4318</u></td>
<td><u>-86.9203</u></td>
<td>...</td>
</tr>
<tr>
<td>9</td>
<td>Ironman Arizona 2019</td>
<td>2019-11-24</td>
<td>Tempe, Arizona, USA</td>
<td><u>United States of America</u></td>
<td><u>33.4255</u></td>
<td><u>-111.94</u></td>
<td>...</td>
</tr>
<tr>
<td>10</td>
<td>Ironman Xiamen 70.3 2019</td>
<td>2019-11-10</td>
<td>Xiamen, China</td>
<td><u>China</u></td>
<td><u>24.4758</u></td>
<td><u>118.075</u></td>
<td>...</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th>date</th>
<th>loc</th>
<th><u>country</u></th>
<th>latitude</th>
<th>longitude</th>
<th>...</th>
</tr>
<tr>
<td>0</td>
<td>Ironman Dubai Duathlon 70.3 2020</td>
<td>2020-07-02</td>
<td>Dubai, United Arab Emirates</td>
<td><u>ARE</u></td>
<td>25.0657</td>
<td>55.1713</td>
<td>...</td>
</tr>
<tr>
<td>1</td>
<td>Ironman Dubai 70.3 2020</td>
<td>2020-02-07</td>
<td>Dubai, United Arab Emirates</td>
<td><u>ARE</u></td>
<td>25.0657</td>
<td>55.1713</td>
<td>...</td>
</tr>
<tr>
<td>2</td>
<td>Israman Half 2020</td>
<td>2020-01-29</td>
<td>Israel, Eilat</td>
<td><u>ISR</u></td>
<td>29.5569</td>
<td>34.9498</td>
<td>...</td>
</tr>
<tr>
<td>3</td>
<td>Ironman Indian Wells La Quinta 70.3 2019</td>
<td>2019-12-08</td>
<td>Indian Wells/La Quinta, California, USA</td>
<td><u>USA</u></td>
<td>33.7238</td>
<td>-116.305</td>
<td>...</td>
</tr>
<tr>
<td>4</td>
<td>Ironman Taupo 70.3 2019</td>
<td>2019-12-07</td>
<td>New Zealand</td>
<td><u>NZL</u></td>
<td>-41.5001</td>
<td>172.834</td>
<td>...</td>
</tr>
<tr>
<td>5</td>
<td>Ironman Bahrain 70.3 2019</td>
<td>2019-12-07</td>
<td>Manama, Bahrain</td>
<td><u>BHR</u></td>
<td>26.2235</td>
<td>50.5822</td>
<td>...</td>
</tr>
<tr>
<td>6</td>
<td>Ironman Western Australia 2019</td>
<td>2019-12-01</td>
<td>Busselton, Western Australia</td>
<td><u>AUS</u></td>
<td>-33.6445</td>
<td>115.349</td>
<td>...</td>
</tr>
<tr>
<td>7</td>
<td>Ironman Mar del Plata 2019</td>
<td>2019-12-01</td>
<td>Mar del Plata, Argentina</td>
<td><u>ARG</u></td>
<td>-37.9977</td>
<td>-57.5483</td>
<td>...</td>
</tr>
<tr>
<td>8</td>
<td>Ironman Cozumel 2019</td>
<td>2019-11-24</td>
<td>Cozumel, Mexico</td>
<td><u>MEX</u></td>
<td>20.4318</td>
<td>-86.9203</td>
<td>...</td>
</tr>
<tr>
<td>9</td>
<td>Ironman Arizona 2019</td>
<td>2019-11-24</td>
<td>Tempe, Arizona, USA</td>
<td><u>USA</u></td>
<td>33.4255</td>
<td>-111.94</td>
<td>...</td>
</tr>
<tr>
<td>10</td>
<td>Ironman Xiamen 70.3 2019</td>
<td>2019-11-10</td>
<td>Xiamen, China</td>
<td><u>CHN</u></td>
<td>24.4758</td>
<td>118.075</td>
<td>...</td>
</tr>
</tbody></table></div></code><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entfernung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine weitere wichtige Aktion, die am Pivot-Tisch ausgef√ºhrt werden muss, ist die Bestimmung der Distanz f√ºr jedes Rennen. Dies ist f√ºr uns n√ºtzlich, um zuk√ºnftige Geschwindigkeiten zu berechnen. Beim Triathlon gibt es vier Hauptdistanzen - Sprint, Olympia, Halbeisen und Eisen. Sie k√∂nnen sehen, dass in den Namen der Rennen normalerweise ein Hinweis auf die Entfernung angegeben ist - dies sind </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sprint</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Olympic</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Half</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Full</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Words </font><font style="vertical-align: inherit;">. Dar√ºber hinaus haben verschiedene Organisatoren ihre eigenen Entfernungsbezeichnungen. Die H√§lfte von Ironman wird zum Beispiel als </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">70,3 bezeichnet</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - durch die Anzahl der Meilen in der Ferne, die olympische - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5150</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> durch die Anzahl der Kilometer (51,5), und das Eisen kann als </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">voll bezeichnet werden</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder im Allgemeinen als Mangel an Erkl√§rung - zum Beispiel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ironman Arizona 2019</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ironman - er ist Eisen! </font><font style="vertical-align: inherit;">In der Herausforderung wird die Eisenentfernung als </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und die Halbeisenentfernung als </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mittel bezeichnet</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Unser russischer IronStar bedeutet voll wie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">226</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und halb so </font><font style="vertical-align: inherit;">gro√ü </font><font style="vertical-align: inherit;">wie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">113</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font><font style="vertical-align: inherit;">gemessen </font><font style="vertical-align: inherit;">an der Anzahl der Kilometer, aber normalerweise </font><i><font style="vertical-align: inherit;">sind</font></i><font style="vertical-align: inherit;"> auch </font><font style="vertical-align: inherit;">die W√∂rter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Full</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Half</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vorhanden. </font><font style="vertical-align: inherit;">Wenden Sie nun all dieses Wissen an und markieren Sie alle Rassen gem√§√ü den in den Namen enthaltenen Schl√ºsselw√∂rtern.</font></font><br>
<br>
<pre><code class="python hljs">sprints = rs.loc[[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> rs.index <span class="hljs-keyword">if</span> <span class="hljs-string">'sprint'</span> <span class="hljs-keyword">in</span> rs.loc[i, <span class="hljs-string">'event'</span>].lower()]]<font></font>
olympics1 = rs.loc[[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> rs.index <span class="hljs-keyword">if</span> <span class="hljs-string">'olympic'</span> <span class="hljs-keyword">in</span> rs.loc[i, <span class="hljs-string">'event'</span>].lower()]]<font></font>
olympics2 = rs.loc[[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> rs.index <span class="hljs-keyword">if</span> <span class="hljs-string">'5150'</span> <span class="hljs-keyword">in</span> rs.loc[i, <span class="hljs-string">'event'</span>].lower()]]<font></font>
olympics = pd.concat([olympics1, olympics2])<font></font>
<span class="hljs-comment">#‚Ä¶   </span><font></font>
<font></font>
rsd = pd.concat([sprints, olympics, halfs, fulls]) <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rsd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> stellte sich heraus, dass es 1 925 Rekorde gab, </font><i><font style="vertical-align: inherit;">dh</font></i><font style="vertical-align: inherit;"> drei mehr als die Gesamtzahl der Rennen, so dass einige unter zwei Kriterien fielen. </font><font style="vertical-align: inherit;">Schauen wir sie uns an:</font></font><br>
<br>
<pre><code class="python hljs">rsd[rsd.duplicated(keep=<span class="hljs-literal">False</span>)][<span class="hljs-string">'event'</span>].sort_index()
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th><u>event</u></th>
<th>date</th>
<th>loc</th>
<th>country</th>
<th>latitude</th>
<th>longitude</th>
<th>...</th>
</tr>
<tr>
<td>38</td>
<td><u>Temiradam 113 Half 2019</u></td>
<td>2019-09-22</td>
<td>, </td>
<td>KAZ</td>
<td>43.6521</td>
<td>51.158</td>
<td>...</td>
</tr>
<tr>
<td>38</td>
<td><u>Temiradam 113 Half 2019</u></td>
<td>2019-09-22</td>
<td>, </td>
<td>KAZ</td>
<td>43.6521</td>
<td>51.158</td>
<td>...</td>
</tr>
<tr>
<td>65</td>
<td><u>Triway Olympic Sprint 2019</u></td>
<td>2019-09-08</td>
<td>, --</td>
<td>RUS</td>
<td>47.2214</td>
<td>39.7114</td>
<td>...</td>
</tr>
<tr>
<td>65</td>
<td><u>Triway Olympic Sprint 2019</u></td>
<td>2019-09-08</td>
<td>, --</td>
<td>RUS</td>
<td>47.2214</td>
<td>39.7114</td>
<td>...</td>
</tr>
<tr>
<td>82</td>
<td><u>Ironman Dun Laoghaire Full Swim 70.3 2019</u></td>
<td>2019-08-25</td>
<td>Ireland, Dun Laoghaire</td>
<td>IRL</td>
<td>53.2923</td>
<td>-6.13601</td>
<td>...</td>
</tr>
<tr>
<td>82</td>
<td><u>Ironman Dun Laoghaire Full Swim 70.3 2019</u></td>
<td>2019-08-25</td>
<td>Ireland, Dun Laoghaire</td>
<td>IRL</td>
<td>53.2923</td>
<td>-6.13601</td>
<td>...</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tats√§chlich ist es. </font><font style="vertical-align: inherit;">Im ersten Paar im Namen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Temiradam 113 Half 2019</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> werden sowohl </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Half</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> als auch </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">113 erw√§hnt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dies ist jedoch kein Widerspruch, beide wurden als H√§lften identifiziert. </font><font style="vertical-align: inherit;">Als n√§chstes kommt der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Triway Olympic Sprint 2019</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Hier kann man wirklich verwirrt sein - es gibt </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Olympia</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sprint</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Sie k√∂nnen es herausfinden, indem Sie sich das Protokoll mit den Ergebnissen des Rennens ansehen. </font><font style="vertical-align: inherit;">Die beste Zeit ist 1:09. </font><font style="vertical-align: inherit;">Das ist also ein Sprint. </font><font style="vertical-align: inherit;">L√∂schen Sie diesen Eintrag aus der olympischen Liste.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>place in group</th>
<th>swim</th>
<th>t1</th>
<th>bike</th>
<th>t2</th>
<th>run</th>
<th><u>result</u></th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td> </td>
<td>RUS</td>
<td>M</td>
<td>1</td>
<td>00:12:21</td>
<td>00:00:31</td>
<td>00:34:13</td>
<td>00:00:25</td>
<td>00:21:49</td>
<td><u>01:09:19</u></td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td> </td>
<td>RUS</td>
<td>M</td>
<td>2</td>
<td>00:12:21</td>
<td>00:00:28</td>
<td>00:34:15</td>
<td>00:00:26</td>
<td>00:23:07</td>
<td><u>01:10:38</u></td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td> </td>
<td>RUS</td>
<td>M</td>
<td>3</td>
<td>00:14:20</td>
<td>00:00:37</td>
<td>00:35:48</td>
<td>00:00:34</td>
<td>00:22:16</td>
<td><u>01:13:35</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">olympics.drop(<span class="hljs-number">65</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden dasselbe mit dem sich kreuzenden </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ironman Dun Laoghaire Full Swim 70.3 2019</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tun. </font><font style="vertical-align: inherit;">Hier ist die beste Zeit 4:00. </font><font style="vertical-align: inherit;">Dies ist typisch f√ºr die H√§lfte. </font><font style="vertical-align: inherit;">L√∂schen Sie den Datensatz mit dem Index 85 aus den </font><i><font style="vertical-align: inherit;">vollst√§ndigen Werten</font></i><font style="vertical-align: inherit;"> .</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>place in group</th>
<th>swim</th>
<th>t1</th>
<th>bike</th>
<th>t2</th>
<th>run</th>
<th><u>result</u></th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td>Brownlee, Alistair</td>
<td>GBR</td>
<td>MPRO</td>
<td>1</td>
<td>00:23:19</td>
<td>00:02:18</td>
<td>02:21:19</td>
<td>00:01:55</td>
<td>01:11:42</td>
<td><u>04:00:33</u></td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td>Smales, Elliot</td>
<td>GBR</td>
<td>MPRO</td>
<td>2</td>
<td>00:24:47</td>
<td>00:02:09</td>
<td>02:29:26</td>
<td>00:01:48</td>
<td>01:12:47</td>
<td><u>04:10:57</u></td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td>Bowden, Adam</td>
<td>GBR</td>
<td>MPRO</td>
<td>3</td>
<td>00:23:24</td>
<td>00:02:18</td>
<td>02:32:09</td>
<td>00:02:06</td>
<td>01:13:49</td>
<td><u>04:13:46</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">fulls.drop(<span class="hljs-number">85</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt schreiben wir die Entfernungsinformationen in den Hauptdatenrahmen und sehen, was passiert ist:</font></font><br>
<br>
<pre><code class="python hljs">rs[<span class="hljs-string">'dist'</span>] = <span class="hljs-string">''</span><font></font>
<font></font>
rs.loc[sprints.index,<span class="hljs-string">'dist'</span>] = <span class="hljs-string">'sprint'</span>
rs.loc[olympics.index,<span class="hljs-string">'dist'</span>] = <span class="hljs-string">'olympic'</span>
rs.loc[halfs.index,<span class="hljs-string">'dist'</span>] = <span class="hljs-string">'half'</span>
rs.loc[fulls.index,<span class="hljs-string">'dist'</span>] = <span class="hljs-string">'full'</span><font></font>
<font></font>
rs.sample(<span class="hljs-number">10</span>)
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th><u>group</u></th>
<th>place in group</th>
<th>...</th>
<th>country raw</th>
<th><u>group raw</u></th>
</tr>
<tr>
<td>...</td>
<td>566</td>
<td>M</td>
<td>Vladimir Kozar</td>
<td>SVK</td>
<td><u>M40-44</u></td>
<td>8</td>
<td>...</td>
<td>SVK</td>
<td><u>MOpen 40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>8</td>
<td>M</td>
<td>HANNES COOL</td>
<td>BEL</td>
<td><u>MPRO</u></td>
<td>11</td>
<td>...</td>
<td>BEL</td>
<td><u>MPRO M</u></td>
</tr>
<tr>
<td>...</td>
<td>445</td>
<td>F</td>
<td>Ileana Sodani</td>
<td>USA</td>
<td><u>F45-49</u></td>
<td>4</td>
<td>...</td>
<td>USA</td>
<td><u>F45-49 F</u></td>
</tr>
<tr>
<td>...</td>
<td>227</td>
<td>F</td>
<td>JARLINSKA Bozena</td>
<td>POL</td>
<td><u>F45-49</u></td>
<td>2</td>
<td>...</td>
<td>POL</td>
<td><u>FK45-49</u></td>
</tr>
<tr>
<td>...</td>
<td>440</td>
<td>F</td>
<td>Celine Orrigoni</td>
<td>FRA</td>
<td><u>F40-44</u></td>
<td>6</td>
<td>...</td>
<td>FRA</td>
<td><u>F40-44 F</u></td>
</tr>
<tr>
<td>...</td>
<td>325</td>
<td>M</td>
<td>Vladimir Eckert</td>
<td>SVK</td>
<td><u>M40-44</u></td>
<td>6</td>
<td>...</td>
<td>SVK</td>
<td><u>MOpen 40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>139</td>
<td>F</td>
<td>ATRASZKIEWICZ Magda</td>
<td>POL</td>
<td><u>F40-44</u></td>
<td>2</td>
<td>...</td>
<td>POL</td>
<td><u>FK40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>18</td>
<td>M</td>
<td>Marijn de Jonge</td>
<td>NLD</td>
<td><u>MPRO</u></td>
<td>18</td>
<td>...</td>
<td>NED</td>
<td><u>Mpro</u></td>
</tr>
<tr>
<td>...</td>
<td>574</td>
<td>M</td>
<td>Luca Andalo</td>
<td>ITA</td>
<td><u>M40-44</u></td>
<td>9</td>
<td>...</td>
<td>ITA</td>
<td><u>MOpen 40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>67</td>
<td>M</td>
<td>URBANKIEWICZ Aleksandra</td>
<td>POL</td>
<td><u>M35-39</u></td>
<td>1</td>
<td>...</td>
<td>POL</td>
<td><u>MK35-39</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stellen Sie sicher, dass keine ungedeckten Eintr√§ge vorhanden sind:</font></font><br>
<br>
<pre><code class="python hljs">len(rs[rs[<span class="hljs-string">'dist'</span>] == <span class="hljs-string">''</span>])
</code></pre><br>
<code><b>Out:</b> 0<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und schauen Sie sich unsere problematischen, mehrdeutigen an:</font></font><br>
<br>
<pre><code class="python hljs">rs.loc[[<span class="hljs-number">38</span>,<span class="hljs-number">65</span>,<span class="hljs-number">82</span>],[<span class="hljs-string">'event'</span>,<span class="hljs-string">'dist'</span>]]
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th><u>dist</u></th>
</tr>
<tr>
<td>38</td>
<td>Temiradam 113 Half 2019</td>
<td><u>half</u></td>
</tr>
<tr>
<td>65</td>
<td>Triway Olympic Sprint 2019</td>
<td><u>sprint</u></td>
</tr>
<tr>
<td>82</td>
<td>Ironman Dun Laoghaire Full Swim 70.3 2019</td>
<td><u>half</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alles ist gut. </font><font style="vertical-align: inherit;">In einer neuen Datei speichern:</font></font><br>
<br>
<pre><code class="python hljs">pkl.dump(rs, open(<span class="hljs-string">r'D:\tri\summary5.pkl'</span>, <span class="hljs-string">'wb'</span>))
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Altersgruppen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun zur√ºck zu den Rennprotokollen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben bereits Geschlecht, Land und Ergebnisse des Teilnehmers analysiert und auf eine Standardform gebracht. </font><font style="vertical-align: inherit;">Es blieben jedoch zwei weitere Spalten √ºbrig - die Gruppe und tats√§chlich der Name selbst. </font><font style="vertical-align: inherit;">Beginnen wir mit den Gruppen. </font><font style="vertical-align: inherit;">Beim Triathlon ist es √ºblich, die Teilnehmer nach Altersgruppen zu unterteilen. </font><font style="vertical-align: inherit;">Oft f√§llt auch eine Gruppe von Fachleuten auf. </font><font style="vertical-align: inherit;">Tats√§chlich ist der Versatz in jeder dieser Gruppen separat - die ersten drei Pl√§tze in jeder Gruppe werden vergeben. </font><font style="vertical-align: inherit;">In Gruppen wird die Qualifikation f√ºr Meisterschaften ausgew√§hlt, zum Beispiel auf Konu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kombinieren Sie alle Datens√§tze und sehen Sie, welche Gruppen im Allgemeinen existieren.</font></font><br>
<br>
<pre><code class="python hljs">rd = pkl.load(open(<span class="hljs-string">r'D:\tri\details2.pkl'</span>, <span class="hljs-string">'rb'</span>))<font></font>
ar = pd.concat(rd)<font></font>
ar[<span class="hljs-string">'group'</span>].unique()
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es stellte sich heraus, dass es eine gro√üe Anzahl von Gruppen gab - 581. Hundert zuf√§llig ausgew√§hlte Gruppen sehen folgenderma√üen aus: Mal </font><font style="vertical-align: inherit;">
sehen, welche von ihnen die zahlreichsten sind:</font></font><br>
<code>['MSenior', 'FAmat.', 'M20', 'M65-59', 'F25-29', 'F18-22', 'M75-59', 'MPro', 'F24', 'MCORP M', 'F21-30', 'MSenior 4', 'M40-50', 'FAWAD', 'M16-29', 'MK40-49', 'F65-70', 'F65-70', 'M12-15', 'MK18-29', 'M50up', 'FSEMIFINAL 2 PRO', 'F16', 'MWhite', 'MOpen 25-29', 'F', 'MPT TRI-2', 'M16-24', 'FQUALIFIER 1 PRO', 'F15-17', 'FSEMIFINAL 2 JUNIOR', 'FOpen 60-64', 'M75-80', 'F60-69', 'FJUNIOR A', 'F17-18', 'FAWAD BLIND', 'M75-79', 'M18-29', 'MJUN19-23', 'M60-up', 'M70', 'MPTS5', 'F35-40', "M'S PT1", 'M50-54', 'F65-69', 'F17-20', 'MP4', 'M16-29', 'F18up', 'MJU', 'MPT4', 'MPT TRI-3', 'MU24-39', 'MK35-39', 'F18-20', "M'S", 'F50-55', 'M75-80', 'MXTRI', 'F40-45', 'MJUNIOR B', 'F15', 'F18-19', 'M20-29', 'MAWAD PC4', 'M30-37', 'F21-30', 'Mpro', 'MSEMIFINAL 1 JUNIOR', 'M25-34', 'MAmat.', 'FAWAD PC5', 'FA', 'F50-60', 'FSenior 1', 'M80-84', 'FK45-49', 'F75-79', 'M&lt;23', 'MPTS3', 'M70-75', 'M50-60', 'FQUALIFIER 3 PRO', 'M9', 'F31-40', 'MJUN16-19', 'F18-19', 'M PARA', 'F35-44', 'MParaathlete', 'F18-34', 'FA', 'FAWAD PC2', 'FAll Ages', 'M PARA', 'F31-40', 'MM85', 'M25-39']<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'group'</span>].value_counts()[:<span class="hljs-number">30</span>]
</code></pre><br>
<code><b>Out:</b><br>
M40-44 199157<br>
M35-39 183738<br>
M45-49 166796<br>
M30-34 154732<br>
M50-54 107307<br>
M25-29 88980<br>
M55-59 50659<br>
F40-44 48036<br>
F35-39 47414<br>
F30-34 45838<br>
F45-49 39618<br>
MPRO 38445<br>
F25-29 31718<br>
F50-54 26253<br>
M18-24 24534<br>
FPRO 23810<br>
M60-64 20773<br>
M 12799<br>
F55-59 12470<br>
M65-69 8039<br>
F18-24 7772<br>
MJUNIOR 6605<br>
F60-64 5067<br>
M20-24 4580<br>
FJUNIOR 4105<br>
M30-39 3964<br>
M40-49 3319<br>
F 3306<br>
M70-74 3072<br>
F20-24 2522<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie k√∂nnen sehen, dass dies Gruppen von f√ºnf Jahren sind, getrennt f√ºr M√§nner und getrennt f√ºr Frauen, sowie Berufsgruppen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MPRO</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FPRO</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unser Standard wird also sein:</font></font><br>
<br>
<pre><code class="python hljs">ag = [<span class="hljs-string">'MPRO'</span>, <span class="hljs-string">'M18-24'</span>, <span class="hljs-string">'M25-29'</span>, <span class="hljs-string">'M30-34'</span>, <span class="hljs-string">'M35-39'</span>, <span class="hljs-string">'M40-44'</span>, <span class="hljs-string">'M45-49'</span>, <span class="hljs-string">'M50-54'</span>, <span class="hljs-string">'M55-59'</span>, <span class="hljs-string">'M60-64'</span>,  <span class="hljs-string">'M65-69'</span>, <span class="hljs-string">'M70-74'</span>, <span class="hljs-string">'M75-79'</span>, <span class="hljs-string">'M80-84'</span>, <span class="hljs-string">'M85-90'</span>, <span class="hljs-string">'FPRO'</span>, <span class="hljs-string">'F18-24'</span>, <span class="hljs-string">'F25-29'</span>, <span class="hljs-string">'F30-34'</span>, <span class="hljs-string">'F35-39'</span>, <span class="hljs-string">'F40-44'</span>,   <span class="hljs-string">'F45-49'</span>, <span class="hljs-string">'F50-54'</span>, <span class="hljs-string">'F55-59'</span>, <span class="hljs-string">'F60-64'</span>, <span class="hljs-string">'F65-69'</span>, <span class="hljs-string">'F70-74'</span>, <span class="hljs-string">'F75-79'</span>, <span class="hljs-string">'F80-84'</span>, <span class="hljs-string">'F85-90'</span>]
<span class="hljs-comment">#ag ‚Äì age group</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieses Set deckt fast 95% aller Finisher ab. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nat√ºrlich k√∂nnen wir nicht alle Gruppen auf diesen Standard bringen. </font><font style="vertical-align: inherit;">Aber wir suchen nach denen, die ihnen √§hnlich sind und geben zumindest einen Teil davon. </font><font style="vertical-align: inherit;">Zuerst bringen wir die Gro√übuchstaben und entfernen die Leerzeichen. </font><font style="vertical-align: inherit;">Folgendes ist passiert: </font><font style="vertical-align: inherit;">
Konvertieren Sie sie in unsere Standard-Modelle.</font></font><br>
<code>['F25-29F', 'F30-34F', 'F30-34-34', 'F35-39F', 'F40-44F', 'F45-49F', 'F50-54F', 'F55-59F', 'FAG:FPRO', 'FK30-34', 'FK35-39', 'FK40-44', 'FK45-49', 'FOPEN50-54', 'FOPEN60-64', 'MAG:MPRO', 'MK30-34', 'MK30-39', 'MK35-39', 'MK40-44', 'MK40-49', 'MK50-59', 'M40-44', 'MM85-89', 'MOPEN25-29', 'MOPEN30-34', 'MOPEN35-39', 'MOPEN40-44', 'MOPEN45-49', 'MOPEN50-54', 'MOPEN70-74', 'MPRO:', 'MPROM', 'M0-44"']<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">fix = { <span class="hljs-string">'F25-29F'</span>: <span class="hljs-string">'F25-29'</span>, <span class="hljs-string">'F30-34F'</span> : <span class="hljs-string">'F30-34'</span>, <span class="hljs-string">'F30-34-34'</span>: <span class="hljs-string">'F30-34'</span>, <span class="hljs-string">'F35-39F'</span>: <span class="hljs-string">'F35-39'</span>, <span class="hljs-string">'F40-44F'</span>: <span class="hljs-string">'F40-44'</span>, <span class="hljs-string">'F45-49F'</span>: <span class="hljs-string">'F45-49'</span>, <span class="hljs-string">'F50-54F'</span>: <span class="hljs-string">'F50-54'</span>, <span class="hljs-string">'F55-59F'</span>: <span class="hljs-string">'F55-59'</span>, <span class="hljs-string">'FAG:FPRO'</span>: <span class="hljs-string">'FPRO'</span>, <span class="hljs-string">'FK30-34'</span>: <span class="hljs-string">'F30-34'</span>,      <span class="hljs-string">'FK35-39'</span>: <span class="hljs-string">'F35-39'</span>, <span class="hljs-string">'FK40-44'</span>: <span class="hljs-string">'F40-44'</span>, <span class="hljs-string">'FK45-49'</span>: <span class="hljs-string">'F45-49'</span>, <span class="hljs-string">'FOPEN50-54'</span>: <span class="hljs-string">'F50-54'</span>, <span class="hljs-string">'FOPEN60-64'</span>: <span class="hljs-string">'F60-64'</span>, <span class="hljs-string">'MAG:MPRO'</span>: <span class="hljs-string">'MPRO'</span>, <span class="hljs-string">'MK30-34'</span>: <span class="hljs-string">'M30-34'</span>, <span class="hljs-string">'MK30-39'</span>: <span class="hljs-string">'M30-39'</span>, <span class="hljs-string">'MK35-39'</span>: <span class="hljs-string">'M35-39'</span>, <span class="hljs-string">'MK40-44'</span>: <span class="hljs-string">'M40-44'</span>, <span class="hljs-string">'MK40-49'</span>: <span class="hljs-string">'M40-49'</span>, <span class="hljs-string">'MK50-59'</span>: <span class="hljs-string">'M50-59'</span>, <span class="hljs-string">'M40-44'</span>: <span class="hljs-string">'M40-44'</span>, <span class="hljs-string">'MM85-89'</span>: <span class="hljs-string">'M85-89'</span>, <span class="hljs-string">'MOPEN25-29'</span>: <span class="hljs-string">'M25-29'</span>, <span class="hljs-string">'MOPEN30-34'</span>: <span class="hljs-string">'M30-34'</span>, <span class="hljs-string">'MOPEN35-39'</span>: <span class="hljs-string">'M35-39'</span>, <span class="hljs-string">'MOPEN40-44'</span>: <span class="hljs-string">'M40-44'</span>, <span class="hljs-string">'MOPEN45-49'</span>: <span class="hljs-string">'M45-49'</span>, <span class="hljs-string">'MOPEN50-54'</span>: <span class="hljs-string">'M50-54'</span>, <span class="hljs-string">'MOPEN70-74'</span>: <span class="hljs-string">'M70- 74'</span>, <span class="hljs-string">'MPRO:'</span> :<span class="hljs-string">'MPRO'</span>, <span class="hljs-string">'MPROM'</span>: <span class="hljs-string">'MPRO'</span>, <span class="hljs-string">'M0-44"'</span> : <span class="hljs-string">'M40-44'</span>}
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt wenden wir unsere Transformation auf den Hauptdatenrahmen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ar an</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , speichern jedoch zuerst die urspr√ºnglichen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gruppenwerte</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in der neuen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rohgruppe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> der </font><i><font style="vertical-align: inherit;">Gruppe</font></i><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'group raw'</span>] = ar[<span class="hljs-string">'group'</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gruppenspalte</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> belassen </font><font style="vertical-align: inherit;">wir nur die Werte, die unserem Standard entsprechen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt k√∂nnen wir unsere Bem√ºhungen w√ºrdigen:</font></font><br>
<br>
<pre><code class="python hljs">len(ar[(ar[<span class="hljs-string">'group'</span>] != ar[<span class="hljs-string">'group raw'</span>])&amp;(ar[<span class="hljs-string">'group'</span>]!=<span class="hljs-string">''</span>)])
</code></pre><br>
<code><b>Out:</b> 273<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nur ein bisschen auf dem Niveau von eineinhalb Millionen. </font><font style="vertical-align: inherit;">Aber Sie werden es nicht wissen, bis Sie es versuchen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ausgew√§hlte 10 sehen folgenderma√üen aus: </font><font style="vertical-align: inherit;">Speichern Sie die neue Version des Datenrahmens, nachdem Sie ihn wieder in das </font><i><font style="vertical-align: inherit;">dritte</font></i><font style="vertical-align: inherit;"> W√∂rterbuch konvertiert haben </font><font style="vertical-align: inherit;">.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th><u>group</u></th>
<th>place in group</th>
<th>...</th>
<th>country raw</th>
<th><u>group raw</u></th>
</tr>
<tr>
<td>...</td>
<td>566</td>
<td>M</td>
<td>Vladimir Kozar</td>
<td>SVK</td>
<td><u>M40-44</u></td>
<td>8</td>
<td>...</td>
<td>SVK</td>
<td><u>MOpen 40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>8</td>
<td>M</td>
<td>HANNES COOL</td>
<td>BEL</td>
<td><u>MPRO</u></td>
<td>11</td>
<td>...</td>
<td>BEL</td>
<td><u>MPRO M</u></td>
</tr>
<tr>
<td>...</td>
<td>445</td>
<td>F</td>
<td>Ileana Sodani</td>
<td>USA</td>
<td><u>F45-49</u></td>
<td>4</td>
<td>...</td>
<td>USA</td>
<td><u>F45-49 F</u></td>
</tr>
<tr>
<td>...</td>
<td>227</td>
<td>F</td>
<td>JARLINSKA Bozena</td>
<td>POL</td>
<td><u>F45-49</u></td>
<td>2</td>
<td>...</td>
<td>POL</td>
<td><u>FK45-49</u></td>
</tr>
<tr>
<td>...</td>
<td>440</td>
<td>F</td>
<td>Celine Orrigoni</td>
<td>FRA</td>
<td><u>F40-44</u></td>
<td>6</td>
<td>...</td>
<td>FRA</td>
<td><u>F40-44 F</u></td>
</tr>
<tr>
<td>...</td>
<td>325</td>
<td>M</td>
<td>Vladimir Eckert</td>
<td>SVK</td>
<td><u>M40-44</u></td>
<td>6</td>
<td>...</td>
<td>SVK</td>
<td><u>MOpen 40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>139</td>
<td>F</td>
<td>ATRASZKIEWICZ Magda</td>
<td>POL</td>
<td><u>F40-44</u></td>
<td>2</td>
<td>...</td>
<td>POL</td>
<td><u>FK40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>18</td>
<td>M</td>
<td>Marijn de Jonge</td>
<td>NLD</td>
<td><u>MPRO</u></td>
<td>18</td>
<td>...</td>
<td>NED</td>
<td><u>Mpro</u></td>
</tr>
<tr>
<td>...</td>
<td>574</td>
<td>M</td>
<td>Luca Andalo</td>
<td>ITA</td>
<td><u>M40-44</u></td>
<td>9</td>
<td>...</td>
<td>ITA</td>
<td><u>MOpen 40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>67</td>
<td>M</td>
<td>URBANKIEWICZ Aleksandra</td>
<td>POL</td>
<td><u>M35-39</u></td>
<td>1</td>
<td>...</td>
<td>POL</td>
<td><u>MK35-39</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">pkl.dump(rd, open(<span class="hljs-string">r'D:\tri\details3.pkl'</span>, <span class="hljs-string">'wb'</span>))</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Name</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun k√ºmmern wir uns um die Namen. </font><font style="vertical-align: inherit;">Sehen wir uns selektiv 100 Namen aus verschiedenen Rassen an:</font></font><br>
<br>
<pre><code class="python hljs">list(ar[<span class="hljs-string">'name'</span>].sample(<span class="hljs-number">100</span>))
</code></pre><br>
<code><b>Out: </b>['Case, Christine', 'Van der westhuizen, Wouter', 'Grace, Scott', 'Sader, Markus', 'Schuller, Gunnar', 'Juul-Andersen, Jeppe', 'Nelson, Matthew', '  ', 'Westman, Pehr', 'Becker, Christoph', 'Bolton, Jarrad', 'Coto, Ricardo', 'Davies, Luke', 'Daniltchev, Alexandre', 'Escobar Labastida, Emmanuelle', 'Idzikowski, Jacek', 'Fairaislova Iveta', 'Fisher, Kulani', 'Didenko, Viktor', 'Osborne, Jane', 'Kadralinov, Zhalgas', 'Perkins, Chad', 'Caddell, Martha', 'Lynaire PARISH', 'Busing, Lynn', 'Nikitin, Evgeny', 'ANSON MONZON, ROBERTO', 'Kaub, Bernd', 'Bank, Morten', 'Kennedy, Ian', 'Kahl, Stephen', 'Vossough, Andreas', 'Gale, Karen', 'Mullally, Kristin', 'Alex FRASER', 'Dierkes, Manuela', 'Gillett, David', 'Green, Erica', 'Cunnew, Elliott', 'Sukk, Gaspar', 'Markina Veronika', 'Thomas KVARICS', 'Wu, Lewen', 'Van Enk, W.J.J', 'Escobar, Rosario', 'Healey, Pat', 'Scheef, Heike', 'Ancheta, Marlon', 'Heck, Andreas', 'Vargas Iii, Raul', 'Seferoglou, Maria', 'chris GUZMAN', 'Casey, Timothy', 'Olshanikov Konstantin', 'Rasmus Nerrand', 'Lehmann Bence', 'Amacker, Kirby', 'Parks, Chris', 'Tom, Troy', 'Karlsson, Ulf', 'Halfkann, Dorothee', 'Szabo, Gergely', 'Antipov Mikhail', 'Von Alvensleben, Alvo', 'Gruber, Peter', 'Leblanc, Jean-Philippe', 'Bouchard, Jean-Francois', 'Marchiotto MASSIMO', 'Green, Molly', 'Alder, Christoph', 'Morris, Huw', 'Deceur, Marc', 'Queenan, Derek', 'Krause, Carolin', 'Cockings, Antony', 'Ziehmer Chris', 'Stiene, John', 'Chmet Daniela', 'Chris RIORDAN', 'Wintle, Mel', ' ', 'GASPARINI CHRISTIAN', 'Westbrook, Christohper', 'Martens, Wim', 'Papson, Chris', 'Burdess, Shaun', 'Proctor, Shane', 'Cruzinha, Pedro', 'Hamard, Jacques', 'Petersen, Brett', 'Sahyoun, Sebastien', "O'Connell, Keith", 'Symoshenko, Zhan', 'Luternauer, Jan', 'Coronado, Basil', 'Smith, Alex', 'Dittberner, Felix', 'N?sman, Henrik', 'King, Malisa', 'PUHLMANN Andre']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alles ist schwierig. Es gibt eine Vielzahl von Optionen f√ºr Eintr√§ge: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vorname Nachname, Nachname Vorname, Nachname, Vorname, Nachname, Vorname</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usw. Das hei√üt, eine andere Reihenfolge, ein anderes Register, irgendwo gibt es ein Trennzeichen - ein Komma. Es gibt auch viele Protokolle, in denen Kyrillisch verwendet wird. Es gibt auch keine Einheitlichkeit, und solche Formate k√∂nnen gefunden werden: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Nachname Vorname", "Vorname Nachname", "Vorname Zweiter Vorname Nachname", "Nachname Vorname Zweiter Vorname"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Obwohl in der Tat der zweite Vorname auch in der lateinischen Schreibweise gefunden wird. Und hier tritt √ºbrigens ein weiteres Problem auf - die Transliteration. Es sollte auch beachtet werden, dass selbst wenn es keinen zweiten Vornamen gibt, der Datensatz m√∂glicherweise nicht auf zwei W√∂rter beschr√§nkt ist. Beispielsweise besteht f√ºr Hispanics der Name plus Nachname normalerweise aus drei oder vier W√∂rtern. Die Holl√§nder haben das Pr√§fix Van, die Chinesen und Koreaner haben auch zusammengesetzte Namen, die normalerweise aus drei W√∂rtern bestehen. Im Allgemeinen m√ºssen Sie diesen gesamten Rebus irgendwie entwirren und auf das Maximum standardisieren. Innerhalb eines Rennens ist das Namensformat in der Regel f√ºr alle gleich, aber auch hier gibt es Fehler, die wir jedoch nicht behandeln werden. Beginnen wir mit dem Speichern der vorhandenen Werte im neuen Spaltennamen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">raw</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'name raw'</span>] = ar[<span class="hljs-string">'name'</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die √ºberwiegende Mehrheit der Protokolle ist in Latein, daher m√∂chte ich als erstes transliterieren. </font><font style="vertical-align: inherit;">Mal sehen, welche Zeichen im Namen des Teilnehmers enthalten sein k√∂nnen.</font></font><br>
<br>
<pre><code class="python hljs">set( <span class="hljs-string">''</span>.join(ar[<span class="hljs-string">'name'</span>].unique()))
</code></pre><br>
<code><b>Out: </b>[' ', '!', '"', '#', '&amp;', "'", '(', ')', '*', '+', ',', '-', '.', '/', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', ':', ';', '&gt;', '?', '@', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', '[', '\\', ']', '^', '_', '`', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', '|', '\x7f', '\xa0', '¬§', '¬¶', '¬ß', '', '¬´', '\xad', '', '¬∞', '¬±', '¬µ', '¬∂', '¬∑', '¬ª', '', '–Ü', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '—î', '—ñ', '—û', '‚Äì', '‚Äî', '‚Äò', '‚Äô', '‚Äö', '‚Äú', '‚Äù', '‚Äû', '‚Ä†', '‚Ä°', '‚Ä¶', '‚Ä∞', '‚Ä∫', '']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was gibt es nur! </font><font style="vertical-align: inherit;">Zus√§tzlich zu den tats√§chlichen Buchstaben und Leerzeichen gibt es noch eine Reihe verschiedener ausgefallener Charaktere. </font><font style="vertical-align: inherit;">Von diesen k√∂nnen der Punkt '.', Der Bindestrich '-' und der Apostroph '' 'als g√ºltig angesehen werden, dh nicht versehentlich vorhanden sein. </font><font style="vertical-align: inherit;">Au√üerdem wurde festgestellt, dass in vielen deutschen und norwegischen Vor- und Nachnamen ein Fragezeichen "?" </font><font style="vertical-align: inherit;">Sie ersetzen anscheinend die Zeichen aus dem erweiterten lateinischen Alphabet - '?', 'A', 'o', 'u' ,? </font><font style="vertical-align: inherit;">und andere. Hier einige Beispiele: Das </font><font style="vertical-align: inherit;">
Komma ist, obwohl es sehr h√§ufig vorkommt, nur ein Trennzeichen, das bei bestimmten Rassen verwendet wird, sodass es auch in die Kategorie der inakzeptablen f√§llt. </font><font style="vertical-align: inherit;">Zahlen sollten auch nicht in Namen erscheinen.</font></font><br>
<code>Pierre-Alexandre Petit, Jean-louis Lafontaine, Faris Al-Sultan, Jean-Francois Evrard, Paul O'Mahony, Aidan O'Farrell, John O'Neill, Nick D'Alton, Ward D'Hulster, Hans P.J. Cami, Luis E. Benavides, Maximo Jr. Rueda, Prof. Dr. Tim-Nicolas Korf, Dr. Boris Scharlowsk, Eberhard Gro?mann, Magdalena Wei?, Gro?er Axel, Meyer-Szary Krystian, Morten Halkj?r, RASMUSSEN S?ren Balle<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">bs = [s <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> symbols <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> (s.isalpha() <span class="hljs-keyword">or</span> s <span class="hljs-keyword">in</span> <span class="hljs-string">" . - ' ? ,"</span>)] <span class="hljs-comment">#bs ‚Äì bad symbols</span><font></font>
<font></font>
bs<font></font>
</code></pre><br>
<code><b>Out: </b>['!', '"', '#', '&amp;', '(', ')', '*', '+', '/', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', ':', ';', '&gt;', '@', '[', '\\', ']', '^', '_', '`', '|', '\x7f', '\xa0', '¬§', '¬¶', '¬ß', '', '¬´', '\xad', '', '¬∞', '¬±', '¬∂', '¬∑', '¬ª', '‚Äì', '‚Äî', '‚Äò', '‚Äô', '‚Äö', '‚Äú', '‚Äù', '‚Äû', '‚Ä†', '‚Ä°', '‚Ä¶', '‚Ä∞', '‚Ä∫', '']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden alle diese Zeichen vor√ºbergehend entfernen, um herauszufinden, wie viele Eintr√§ge vorhanden sind:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> bs:<font></font>
    ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.replace(s, <span class="hljs-string">''</span>)<font></font>
<font></font>
corr = ar[ar[<span class="hljs-string">'name'</span>] != ar[<span class="hljs-string">'name raw'</span>]]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt 2.184 solcher Datens√§tze, das sind nur 0,15% der Gesamtzahl - sehr wenige. </font><font style="vertical-align: inherit;">Schauen wir uns 100 davon an:</font></font><br>
<br>
<pre><code class="python hljs">list(corr[<span class="hljs-string">'name raw'</span>].sample(<span class="hljs-number">100</span>))
</code></pre><br>
<code><b>Out:</b> ['Scha¬∂ffl, Ga?nter', 'Howard, Brian &amp;', 'Chapiewski, Guilherme (Gc)', 'Derkach 1svd_mail_ru', 'Parker H1 Lauren', 'Leal le?n, Yaneri', 'TencA, David', 'Cortas La?pez, Alejandro', 'Strid, Bja¬∂rn', '(Crutchfield) Horan, Katie', 'Vigneron, Jean-Michel.Vigneron@gmail.Com', '\xa0', 'Telahr, J‚Ä†rgen', 'St‚Äùrmer, Melanie', 'Nagai B1 Keiji', 'Rinc?n, Mariano', 'Arkalaki, Angela (Evangelia)', 'Barbaro B1 Bonin Anna G:Charlotte', 'Ra?esch, Ja¬∂rg', "CAVAZZI NICCOLO\\'", 'D‚Äûnzel, Thomas', 'Ziska, Steffen (Gerhard)', 'Kobilica B1 Alen', 'Mittelholcz, Bala', 'Jimanez Aguilar, Juan Antonio', 'Achenza H1 Giovanni', 'Reppe H2 Christiane', 'Filipovic B2 Lazar', 'Machuca Ka?hnel, Ruban Alejandro', 'Gellert (Silberprinz), Christian', 'Smith (Guide), Matt', 'Lenatz H1 Benjamin', 'Da¬∂llinger, Christian', 'Mc Carthy B1 Patrick Donnacha G:Bryan', 'Fa¬∂llmer, Chris', 'Warner (Rivera), Lisa', 'Wang, Ruijia (Ray)', 'Mc Carthy B1 Donnacha', 'Jones, Nige (Paddy)', 'Sch‚Äùler, Christoph', '\xa0', 'Holthaus, Adelhard (Allard)', 'Mi;Arro, Ana', 'Dr: Koch Stefan', '\xa0', '\xa0', 'Ziska, Steffen (Gerhard)', 'Albarraca\xadn Gonza?lez, Juan Francisco', 'Ha¬∂fling, Imke', 'Johnston, Eddie (Edwin)', 'Mulcahy, Bob (James)', 'Gottschalk, Bj‚Äùrn', '\xa0', 'Gretsch H2 Kendall', 'Scorse, Christopher (Chris)', 'Kiel‚Äöbasa, Pawel', 'Kalan, Magnus', 'Roderick "eric" SIMBULAN', 'Russell;, Mark', 'ROPES AND GRAY TEAM 3', 'Andrade, H?¬¶CTOR DANIEL', 'Landmann H2 Joshua', 'Reyes Rodra\xadguez, Aithami', 'Ziska, Steffen (Gerhard)', 'Ziska, Steffen (Gerhard)', 'Heuza, Pierre', 'Snyder B1 Riley Brad G:Colin', 'Feldmann, Ja¬∂rg', 'Beveridge H1 Nic', 'FAGES`, perrine', 'Frank", Dieter', 'Saarema¬§el, Indrek', 'Betancort Morales, Arida‚Äìy', 'Ridderberg, Marie_Louise', '\xa0', 'Ka¬∂nig, Johannes', 'W Van(der Klugt', 'Ziska, Steffen (Gerhard)', 'Johnson, Nick26', 'Heinz JOHNER03', 'Ga¬∂rg, Andra', 'Maruo B2 Atsuko', 'Moral Pedrero H1 Eva Maria', '\xa0', 'MATUS SANTIAGO Osc1r', 'Stenbrink, Bja¬∂rn', 'Wangkhan, Sm1.Thaworn', 'Pullerits, Ta¬∂nu', 'Clausner, 8588294149', 'Castro Miranda, Josa Ignacio', 'La¬∂fgren, Pontuz', 'Brown, Jann ( Janine )', 'Ziska, Steffen (Gerhard)', 'Koay, Sa¬∂ren', 'Ba¬∂hm, Heiko', 'Oleksiuk B2 Vita', 'G Van(de Grift', 'Scha¬∂neborn, Guido', 'Mandez, A?lvaro', 'Garca\xada Fla?rez, Daniel']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach langem Nachforschen wurde beschlossen, alle alphabetischen Zeichen sowie ein Leerzeichen, einen Bindestrich, einen Apostroph und ein Fragezeichen durch ein Komma, einen Punkt und ein Symbol '\ xa0' zu ersetzen und alle anderen Zeichen durch eine leere Zeichenfolge zu ersetzen. das hei√üt, einfach l√∂schen.</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name raw'</span>]<font></font>
<font></font>
<span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> symbols:
    <span class="hljs-keyword">if</span> s.isalpha() <span class="hljs-keyword">or</span> s <span class="hljs-keyword">in</span> <span class="hljs-string">" - ? '"</span>:        
        <span class="hljs-keyword">continue</span>        
    <span class="hljs-keyword">if</span> s <span class="hljs-keyword">in</span> <span class="hljs-string">".,\xa0"</span>:<font></font>
        ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.replace(s, <span class="hljs-string">' '</span>)       
    <span class="hljs-keyword">else</span>:<font></font>
        ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.replace(s, <span class="hljs-string">''</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann entfernen Sie zus√§tzliche Leerzeichen:</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.split().str.join(<span class="hljs-string">' '</span>)<font></font>
ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.strip() <span class="hljs-comment">#   </span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lass uns nachsehen, was passiert ist:</font></font><br>
<br>
<pre><code class="python hljs">ar.loc[corr.index].sample(<span class="hljs-number">10</span>)
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th><u>name</u></th>
<th>country</th>
<th>...</th>
<th><u>name raw</u></th>
</tr>
<tr>
<td>63</td>
<td>64</td>
<td>M</td>
<td><u>Curzillat B MARANO Annouck GJulie</u></td>
<td>FRA</td>
<td>...</td>
<td><u>Curzillat B1 MARANO Annouck G:Julie</u></td>
</tr>
<tr>
<td>425</td>
<td>426</td>
<td>M</td>
<td><u>Naranjo Quintero Cndido</u></td>
<td>ESP</td>
<td>...</td>
<td><u>Naranjo Quintero, C‚Ä°ndido</u></td>
</tr>
<tr>
<td>1347</td>
<td>1348</td>
<td>F</td>
<td><u>Chang Margaret Peggy</u></td>
<td>USA</td>
<td>...</td>
<td><u>Chang, Margaret (Peggy)</u></td>
</tr>
<tr>
<td>790</td>
<td>791</td>
<td>M</td>
<td><u>Gonzalez Ruben</u></td>
<td>PRI</td>
<td>...</td>
<td><u>Gonzalez`, Ruben</u></td>
</tr>
<tr>
<td>1562</td>
<td>1563</td>
<td>M</td>
<td><u>Garcia Hernandez Elias</u></td>
<td>MEX</td>
<td>...</td>
<td><u>Garcia Hernandez/, Elias</u></td>
</tr>
<tr>
<td>50</td>
<td>51</td>
<td>M</td>
<td><u>Reppe H Christiane</u></td>
<td>DEU</td>
<td>...</td>
<td><u>Reppe H2 Christiane</u></td>
</tr>
<tr>
<td>528</td>
<td>529</td>
<td>M</td>
<td><u>Ho Shihken</u></td>
<td>TWN</td>
<td>...</td>
<td><u>Ho, Shih‚Äîken</u></td>
</tr>
<tr>
<td>819</td>
<td>820</td>
<td>M</td>
<td><u>Elmously A R Abdelrahman</u></td>
<td>EGY</td>
<td>...</td>
<td><u>Elmously, A.R. (Abdelrahman)</u></td>
</tr>
<tr>
<td>249</td>
<td>250</td>
<td>F</td>
<td><u>boyer Isabelle</u></td>
<td>THA</td>
<td>...</td>
<td><u>`boyer, Isabelle</u></td>
</tr>
<tr>
<td>744</td>
<td>745</td>
<td>M</td>
<td><u>Garcaa Morales Pedro Luciano</u></td>
<td>ESP</td>
<td>...</td>
<td><u>Garca¬¨a Morales, Pedro Luciano</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es wurde auch festgestellt, dass es Namen gibt, die ausschlie√ülich aus Fragezeichen bestehen.</font></font><br>
<br>
<pre><code class="python hljs">qmon = ar[(ar[<span class="hljs-string">'name'</span>].str.replace(<span class="hljs-string">'?'</span>, <span class="hljs-string">''</span>).str.strip() == <span class="hljs-string">''</span>)&amp;(ar[<span class="hljs-string">'name'</span>]!=<span class="hljs-string">''</span>)] <span class="hljs-comment">#qmon ‚Äì question mark only names</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt 3.429 davon. Es sieht ungef√§hr so ‚Äã‚Äãaus: </font><font style="vertical-align: inherit;">Unser Ziel, Namen auf den gleichen Standard zu bringen, ist es, dass dieselben Namen gleich aussehen, aber auf unterschiedliche Weise unterschiedlich sind. </font><font style="vertical-align: inherit;">Bei Namen, die nur aus Fragezeichen bestehen, unterscheiden sie sich nur in der Anzahl der Zeichen. Dies gibt jedoch nicht die volle Sicherheit, dass Namen mit derselben Nummer wirklich gleich sind. </font><font style="vertical-align: inherit;">Daher ersetzen wir sie alle durch eine leere Zeichenfolge und werden in Zukunft nicht mehr ber√ºcksichtigt.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th><u>name</u></th>
<th>country</th>
<th>group</th>
<th>place in group</th>
<th>...</th>
<th>country raw</th>
<th>group raw</th>
<th><u>name raw</u></th>
</tr>
<tr>
<td>818</td>
<td>819</td>
<td>M</td>
<td><u>???? ???</u></td>
<td>JPN</td>
<td>M45-49</td>
<td>177</td>
<td>...</td>
<td>JPN</td>
<td>M45-49</td>
<td><u>????, ???</u></td>
</tr>
<tr>
<td>1101</td>
<td>1102</td>
<td>M</td>
<td><u>?? ??</u></td>
<td>JPN</td>
<td>M50-54</td>
<td>159</td>
<td>...</td>
<td>JPN</td>
<td>M50-54</td>
<td><u>??, ??</u></td>
</tr>
<tr>
<td>162</td>
<td>163</td>
<td>M</td>
<td><u>? ??</u></td>
<td>CHN</td>
<td>M30-34</td>
<td>22</td>
<td>...</td>
<td>CHN</td>
<td>M30-34</td>
<td><u>?, ??</u></td>
</tr>
<tr>
<td>1271</td>
<td>1272</td>
<td>F</td>
<td><u>???? ????</u></td>
<td>JPN</td>
<td>F50-54</td>
<td>15</td>
<td>...</td>
<td>JPN</td>
<td>F50-54</td>
<td><u>????, ????</u></td>
</tr>
<tr>
<td>552</td>
<td>553</td>
<td>M</td>
<td><u>??? ??</u></td>
<td>JPN</td>
<td>M25-29</td>
<td>30</td>
<td>...</td>
<td>JPN</td>
<td>M25-29</td>
<td><u>???, ??</u></td>
</tr>
<tr>
<td>423</td>
<td>424</td>
<td>M</td>
<td><u>??? ????</u></td>
<td>JPN</td>
<td>M55-59</td>
<td>24</td>
<td>...</td>
<td>JPN</td>
<td>M55-59</td>
<td><u>???, ????</u></td>
</tr>
<tr>
<td>936</td>
<td>937</td>
<td>F</td>
<td><u>?? ??</u></td>
<td>JPN</td>
<td>F50-54</td>
<td>7</td>
<td>...</td>
<td>JPN</td>
<td>F50-54</td>
<td><u>??, ??</u></td>
</tr>
<tr>
<td>244</td>
<td>245</td>
<td>M</td>
<td><u>? ??</u></td>
<td>KOR</td>
<td>M50-54</td>
<td>30</td>
<td>...</td>
<td>KOR</td>
<td>M50-54</td>
<td><u>?, ??</u></td>
</tr>
<tr>
<td>627</td>
<td>628</td>
<td>M</td>
<td><u>? ?</u></td>
<td>CHN</td>
<td>M40-44</td>
<td>94</td>
<td>...</td>
<td>CHN</td>
<td>M40-44</td>
<td><u>?, ?</u></td>
</tr>
<tr>
<td>194</td>
<td>195</td>
<td>M</td>
<td><u>?????? ?????</u></td>
<td>RUS</td>
<td></td>
<td>188</td>
<td>...</td>
<td>RUS</td>
<td>M</td>
<td><u>?????? ?????</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar.loc[qmon.index, <span class="hljs-string">'name'</span>] = <span class="hljs-string">''</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Gesamtzahl der Eintr√§ge, bei denen der Name die leere Zeichenfolge ist, betr√§gt 3.454. Nicht so sehr - wir werden √ºberleben. </font><font style="vertical-align: inherit;">Nachdem wir unn√∂tige Zeichen entfernt haben, k√∂nnen wir mit der Transliteration fortfahren. </font><font style="vertical-align: inherit;">Um dies zu tun, bringen Sie zuerst alles in Kleinbuchstaben, um nicht doppelt zu arbeiten.</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.lower()
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie als N√§chstes ein W√∂rterbuch:</font></font><br>
<br>
<pre><code class="python hljs">trans = {<span class="hljs-string">''</span>:<span class="hljs-string">'a'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'b'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'v'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'g'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'d'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'e'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'e'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'zh'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'z'</span>,  <span class="hljs-string">''</span>:<span class="hljs-string">'i'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'y'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'k'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'l'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'m'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'n'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'o'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'p'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'r'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'s'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'t'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'u'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'f'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'kh'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'ts'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'ch'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'sh'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'shch'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">''</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'y'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">''</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'e'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'yu'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'ya'</span>, <span class="hljs-string">'—î'</span>:<span class="hljs-string">'e'</span>, <span class="hljs-string">'—ñ'</span>: <span class="hljs-string">'i'</span>,<span class="hljs-string">'—û'</span>:<span class="hljs-string">'w'</span>,<span class="hljs-string">'¬µ'</span>:<span class="hljs-string">'m'</span>}
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es enthielt auch Buchstaben aus dem sogenannten erweiterten kyrillischen Alphabet - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'—î', '—ñ', '—û'</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die in den belarussischen und ukrainischen Sprachen verwendet werden, sowie den griechischen Buchstaben </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'¬µ'</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Wenden Sie die Transformation an:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> trans:<font></font>
    ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.replace(s, trans[s])
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aus dem funktionierenden Kleinbuchstaben √ºbersetzen wir nun alles in das vertraute Format, wobei der Vor- und Nachname mit einem Gro√übuchstaben beginnt:</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.title()
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lass uns nachsehen, was passiert ist.</font></font><br>
<br>
<pre><code class="python hljs">ar[ar[<span class="hljs-string">'name raw'</span>].str.lower().str[<span class="hljs-number">0</span>].isin(trans.keys())].sample(<span class="hljs-number">10</span>)
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th><u>name</u></th>
<th>...</th>
<th>country raw</th>
<th>name raw</th>
</tr>
<tr>
<td>99</td>
<td>100</td>
<td>M</td>
<td><u>Nikolay Golovkin</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>95</td>
<td>96</td>
<td>M</td>
<td><u>Maksim Vasilevich Chubakov</u></td>
<td>...</td>
<td>RUS</td>
<td>  </td>
</tr>
<tr>
<td>325</td>
<td>326</td>
<td>F</td>
<td><u>Ganieva Aygul</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>661</td>
<td>662</td>
<td>M</td>
<td><u>Maksut Nizamutdinov</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>356</td>
<td>357</td>
<td>F</td>
<td><u>Kolobanova Svetlana</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>117</td>
<td>118</td>
<td>M</td>
<td><u>Guskov Vladislav</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>351</td>
<td>352</td>
<td>M</td>
<td><u>Kolesnikov Dmitriy</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>92</td>
<td>93</td>
<td>M</td>
<td><u>Kuznetsov Oleg</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>50</td>
<td>51</td>
<td>M</td>
<td><u>Khoraykin Maksim</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>6</td>
<td>7</td>
<td>M</td>
<td><u>Brylev Aleksey</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√úberpr√ºfen Sie abschlie√üend die eindeutigen Zeichen:</font></font><br>
<br>
<pre><code class="python hljs">set( <span class="hljs-string">''</span>.join(ar[<span class="hljs-string">'name'</span>].unique()))
</code></pre><br>
<code><b>Out:</b> [' ', "'", '-', '?', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J','K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alles ist richtig. </font><font style="vertical-align: inherit;">Infolgedessen betrafen die Korrekturen 1.253.882 oder 89% der Datens√§tze. Die Anzahl der eindeutigen Namen verringerte sich von 660.207 auf 599.186, dh um 61.000 oder fast 10%. </font><font style="vertical-align: inherit;">Beeindruckend! </font><font style="vertical-align: inherit;">Speichern Sie in einer neuen Datei, nachdem Sie die Vereinigung der ar-Datens√§tze wieder in das </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rd-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Protokollw√∂rterbuch √ºbersetzt haben </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="python hljs">pkl.dump(rd, open(<span class="hljs-string">r'D:\tri\details4.pkl'</span>, <span class="hljs-string">'wb'</span>))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt m√ºssen wir die Ordnung wiederherstellen. Das hei√üt, dass alle Datens√§tze wie folgt aussehen w√ºrden: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vorname Nachname</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nachname Vorname</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Welches ist zu bestimmen. Zwar enthalten einige Protokolle neben Vor- und Nachnamen auch Zweitnamen. Und es kann vorkommen, dass dieselbe Person in verschiedenen Protokollen unterschiedlich geschrieben ist - irgendwo mit einem zweiten Vornamen, irgendwo ohne. Dies beeintr√§chtigt seine Identifizierung. Versuchen Sie daher, den zweiten Vornamen zu entfernen. Patronymie f√ºr M√§nner hat normalerweise die Endung </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"hiv"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und f√ºr Frauen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"vna"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Es gibt jedoch Ausnahmen. Zum Beispiel - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ilyich, Ilyinichna, Nikitich, Nikitichna</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Es stimmt, es gibt nur sehr wenige solcher Ausnahmen. Wie bereits erw√§hnt, kann das Format von Namen innerhalb eines Protokolls als permanent angesehen werden. Um Patronymie loszuwerden, m√ºssen Sie daher die Rasse finden, in der sie vorhanden sind. Dazu finden die Gesamtzahl der Fragmente </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Äûvich‚Äú</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Äûvna‚Äú</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in der Spalte </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Name</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und vergleichen Sie sie mit der Gesamtzahl der Eintr√§ge in jedem Protokoll. Wenn diese Zahlen nahe beieinander liegen, gibt es einen zweiten Vornamen, andernfalls nicht. Es ist unvern√ºnftig, nach einem strengen Spiel zu suchen, weil Selbst bei Rennen, bei denen beispielsweise Zweitnamen aufgezeichnet werden, k√∂nnen Ausl√§nder teilnehmen, und sie werden ohne ihn aufgezeichnet. Es kommt auch vor, dass der Teilnehmer seinen zweiten Vornamen vergessen hat oder nicht angeben wollte. Andererseits gibt es auch Nachnamen, die auf "vich" enden, viele davon in Belarus und anderen L√§ndern mit den Sprachen der slawischen Gruppe. Au√üerdem haben wir Transliteration durchgef√ºhrt. Es war m√∂glich, diese Analyse vor der Transliteration durchzuf√ºhren, aber dann besteht die M√∂glichkeit, dass ein Protokoll √ºbersehen wird, in dem es Vornamen gibt, das jedoch zun√§chst bereits in lateinischer Sprache vorliegt. Also ist alles in Ordnung. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden also nach allen Protokollen suchen, in denen die Anzahl der Fragmente </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"vich"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"vna"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in der Spalte angegeben ist</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Name macht</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mehr als 50% der Gesamtzahl der Eintr√§ge im Protokoll aus.</font></font><br>
<br>
<pre><code class="python hljs">wp = {} <span class="hljs-comment">#wp ‚Äì with patronymic </span><font></font>
<font></font>
<span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> rd:<font></font>
    nvich = (<span class="hljs-string">''</span>.join(rd[e][<span class="hljs-string">'name'</span>])).count(<span class="hljs-string">'vich'</span>) <font></font>
    nvna = (<span class="hljs-string">''</span>.join(rd[e][<span class="hljs-string">'name'</span>])).count(<span class="hljs-string">'vna'</span>)
    <span class="hljs-keyword">if</span> nvich + nvna &gt; <span class="hljs-number">0.5</span>*len(rd[e]):<font></font>
        wp[e] = rd[e]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt 29 solcher Protokolle. Eines davon ist: </font><font style="vertical-align: inherit;">Und es ist interessant, dass wenn sich anstelle von 50% 20% oder umgekehrt 70% nehmen, sich das Ergebnis nicht √§ndert, es das gleiche 29 gibt. Also haben wir die richtige Wahl getroffen. </font><font style="vertical-align: inherit;">Dementsprechend weniger als 20% - die Auswirkung von Nachnamen, mehr als 70% - die Auswirkung einzelner Datens√§tze ohne Zweitnamen. </font><font style="vertical-align: inherit;">Nachdem das Land mit Hilfe eines Pivot-Tisches √ºberpr√ºft worden war, stellte sich heraus, dass 25 von ihnen in Russland und 4 in Abchasien waren. </font><font style="vertical-align: inherit;">
Weitermachen. </font><font style="vertical-align: inherit;">Wir werden nur Datens√§tze mit drei Komponenten verarbeiten, dh solchen, bei denen (vermutlich) ein Nachname, ein Name oder ein zweiter Vorname vorhanden ist.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>...</th>
<th>name raw</th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td>Yaroslav <u>Stanislavovich</u> Pavlishchev</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td>Vladimir <u>Vasilevich</u> Perezhigin</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td>Vladislav <u>Evgenevich</u> Litvinchuk</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>3</td>
<td>4</td>
<td>M</td>
<td>Sergey <u>Gennadevich</u> Gavrilenko</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>M</td>
<td>Ivan <u>Markovich</u> Markin</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>5</td>
<td>6</td>
<td>M</td>
<td>Nikolay <u>Evgenevich</u> Sokolov</td>
<td>RUS</td>
<td>...</td>
<td>Nikolay Evgenevich Sokolov</td>
</tr>
<tr>
<td>6</td>
<td>7</td>
<td>M</td>
<td>Aram <u>Pavlovich</u> Kukhtiev</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>7</td>
<td>8</td>
<td>M</td>
<td>Andrey <u>Anatolevich</u> Andreev</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>8</td>
<td>9</td>
<td>M</td>
<td>Denis <u>Valerevich</u> Bulgakov</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>9</td>
<td>10</td>
<td>M</td>
<td>Aleksandr <u>Ivanovich</u> Kuts</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">sum_n3w = <span class="hljs-number">0</span> <span class="hljs-comment"># sum name of 3 words</span>
sum_nnot3w = <span class="hljs-number">0</span> <span class="hljs-comment"># sum name not of 3 words</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> wp: <font></font>
    sum_n3w += len([n <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> wp[e][<span class="hljs-string">'name'</span>] <span class="hljs-keyword">if</span> len(n.split()) == <span class="hljs-number">3</span>])<font></font>
    sum_nnot3w += len(wp[e]) - n3w<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Mehrheit dieser Aufzeichnungen liegt bei 86%. </font><font style="vertical-align: inherit;">Nun diejenigen, in denen die drei Komponenten in die Spalten </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">name0, name1, name2 unterteilt sind</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> wp:<font></font>
    ind3 = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> rd[e].index <span class="hljs-keyword">if</span> len(rd[e].loc[i,<span class="hljs-string">'name'</span>].split()) == <span class="hljs-number">3</span>]<font></font>
    rd[e][<span class="hljs-string">'name0'</span>] = <span class="hljs-string">''</span>
    rd[e][<span class="hljs-string">'name1'</span>] = <span class="hljs-string">''</span>
    rd[e][<span class="hljs-string">'name2'</span>] = <span class="hljs-string">''</span>
    rd[e].loc[ind3, <span class="hljs-string">'name0'</span>] = rd[e].loc[ind3,<span class="hljs-string">'name'</span>].str.split().str[<span class="hljs-number">0</span>]<font></font>
    rd[e].loc[ind3, <span class="hljs-string">'name1'</span>] = rd[e].loc[ind3,<span class="hljs-string">'name'</span>].str.split().str[<span class="hljs-number">1</span>]<font></font>
    rd[e].loc[ind3, <span class="hljs-string">'name2'</span>] = rd[e].loc[ind3,<span class="hljs-string">'name'</span>].str.split().str[<span class="hljs-number">2</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So sieht eines der Protokolle aus: </font><font style="vertical-align: inherit;">Insbesondere hier ist klar, dass die Aufzeichnung der beiden Komponenten nicht verarbeitet wurde. </font><font style="vertical-align: inherit;">Jetzt m√ºssen Sie f√ºr jedes Protokoll bestimmen, welche Spalte einen zweiten Vornamen hat. </font><font style="vertical-align: inherit;">Es gibt nur zwei </font><i><font style="vertical-align: inherit;">Optionen</font></i><font style="vertical-align: inherit;"> - </font><i><font style="vertical-align: inherit;">Name1, Name2</font></i><font style="vertical-align: inherit;"> , da dies nicht an erster Stelle stehen kann. </font><font style="vertical-align: inherit;">Einmal festgelegt, werden wir einen neuen Namen bereits ohne ihn sammeln.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>name</th>
<th><u>name0</u></th>
<th><u>name1</u></th>
<th><u>name2</u></th>
<th>...</th>
<th>name raw</th>
</tr>
<tr>
<td>0</td>
<td>Lekomtsev Denis Nikolaevich</td>
<td><u>Lekomtsev</u></td>
<td><u>Denis</u></td>
<td><u>Nikolaevich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>1</td>
<td>Ivanov Andrey Aleksandrovich</td>
<td><u>Ivanov</u></td>
<td><u>Andrey</u></td>
<td><u>Aleksandrovich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>2</td>
<td>Ivanov Evgeniy Vasilevich</td>
<td><u>Ivanov</u></td>
<td><u>Evgeniy</u></td>
<td><u>Vasilevich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>3</td>
<td>Setepov Vladislav</td>
<td></td>
<td></td>
<td></td>
<td>...</td>
<td> </td>
</tr>
<tr>
<td>4</td>
<td>Mishanin Sergey Yurevich</td>
<td><u>Mishanin</u></td>
<td><u>Sergey</u></td>
<td><u>Yurevich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>5</td>
<td>Baranov Andrey Aleksandrovich</td>
<td><u>Baranov</u></td>
<td><u>Andrey</u></td>
<td><u>Aleksandrovich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>6</td>
<td>Nakaryakov Dmitriy Valerevich</td>
<td><u>Nakaryakov</u></td>
<td><u>Dmitriy</u></td>
<td><u>Valerevich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>7</td>
<td>Tretyakov Dmitriy Valentinovich</td>
<td><u>Tretyakov</u></td>
<td><u>Dmitriy</u></td>
<td><u>Valentinovich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>8</td>
<td>Kuznetsov Stanislav Vladimirovich</td>
<td><u>Kuznetsov</u></td>
<td><u>Stanislav</u></td>
<td><u>Vladimirovich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>9</td>
<td>Dubrovin Maksim Sergeevich</td>
<td><u>Dubrovin</u></td>
<td><u>Maksim</u></td>
<td><u>Sergeevich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>10</td>
<td>Karpov Anatoliy Sergeevich</td>
<td><u>Karpov</u></td>
<td><u>Anatoliy</u></td>
<td><u>Sergeevich</u></td>
<td>...</td>
<td>  </td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> wp:    <font></font>
    n1=(<span class="hljs-string">''</span>.join(rd[e][<span class="hljs-string">'name1'</span>])).count(<span class="hljs-string">'vich'</span>)+(<span class="hljs-string">''</span>.join(rd[e][<span class="hljs-string">'name1'</span>])).count(<span class="hljs-string">'vna'</span>)<font></font>
    n2=(<span class="hljs-string">''</span>.join(rd[e][<span class="hljs-string">'name2'</span>])).count(<span class="hljs-string">'vich'</span>)+(<span class="hljs-string">''</span>.join(rd[e][<span class="hljs-string">'name2'</span>])).count(<span class="hljs-string">'vna'</span>)<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (n1 &gt; n2):<font></font>
        rd[e][<span class="hljs-string">'new name'</span>] = rd[e][<span class="hljs-string">'name0'</span>] + <span class="hljs-string">' '</span> + rd[e][<span class="hljs-string">'name2'</span>]
    <span class="hljs-keyword">else</span>:<font></font>
        rd[e][<span class="hljs-string">'new name'</span>] = rd[e][<span class="hljs-string">'name0'</span>] + <span class="hljs-string">' '</span> + rd[e][<span class="hljs-string">'name1'</span>]
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>name</th>
<th>name0</th>
<th>name1</th>
<th>name2</th>
<th><u>new name</u></th>
<th>name raw</th>
</tr>
<tr>
<td>0</td>
<td>Gorik Pavel Vladimirovich</td>
<td>Gorik</td>
<td>Pavel</td>
<td>Vladimirovich</td>
<td><u>Gorik Pavel</u></td>
<td>  </td>
</tr>
<tr>
<td>1</td>
<td>Korobov Oleg Anatolevich</td>
<td>Korobov</td>
<td>Oleg</td>
<td>Anatolevich</td>
<td><u>Korobov Oleg</u></td>
<td>  </td>
</tr>
<tr>
<td>2</td>
<td>Pavlishchev Yaroslav Stanislavovich</td>
<td>Pavlishchev</td>
<td>Yaroslav</td>
<td>Stanislavovich</td>
<td><u>Pavlishchev Yaroslav</u></td>
<td>  </td>
</tr>
<tr>
<td>3</td>
<td>Fedorov Nikolay Nikolaevich</td>
<td>Fedorov</td>
<td>Nikolay</td>
<td>Nikolaevich</td>
<td><u>Fedorov Nikolay</u></td>
<td>  </td>
</tr>
<tr>
<td>4</td>
<td>Medvedev Andrey Aleksandrovich</td>
<td>Medvedev</td>
<td>Andrey</td>
<td>Aleksandrovich</td>
<td><u>Medvedev Andrey</u></td>
<td>  </td>
</tr>
<tr>
<td>5</td>
<td>Popov Sergey Eduardovich</td>
<td>Popov</td>
<td>Sergey</td>
<td>Eduardovich</td>
<td><u>Popov Sergey</u></td>
<td>  </td>
</tr>
<tr>
<td>6</td>
<td>Dumchev Andrey Viktorovich</td>
<td>Dumchev</td>
<td>Andrey</td>
<td>Viktorovich</td>
<td><u>Dumchev Andrey</u></td>
<td>  </td>
</tr>
<tr>
<td>7</td>
<td>Trusov Mikhail Vladimirovich</td>
<td>Trusov</td>
<td>Mikhail</td>
<td>Vladimirovich</td>
<td><u>Trusov Mikhail</u></td>
<td>  </td>
</tr>
<tr>
<td>8</td>
<td>Demichev Yuriy Anatolevich</td>
<td>Demichev</td>
<td>Yuriy</td>
<td>Anatolevich</td>
<td><u>Demichev Yuriy</u></td>
<td>  </td>
</tr>
<tr>
<td>9</td>
<td>Pushkin Boris Sergeevich</td>
<td>Pushkin</td>
<td>Boris</td>
<td>Sergeevich</td>
<td><u>Pushkin Boris</u></td>
<td>  </td>
</tr>
<tr>
<td>10</td>
<td>Lando Aleksandr Borisovich</td>
<td>Lando</td>
<td>Aleksandr</td>
<td>Borisovich</td>
<td><u>Lando Aleksandr</u></td>
<td>  </td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nun vorsichtig den neuen Namen der Hauptspalte zuweisen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Namen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , wo er nicht leer ist, und l√∂schen Sie </font><font style="vertical-align: inherit;">die Hilfsspalten.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> wp:<font></font>
    ind = rd[e][rd[e][<span class="hljs-string">'new name'</span>].str.strip() != <span class="hljs-string">''</span>].index<font></font>
    rd[e].loc[ind, <span class="hljs-string">'name'</span>] = rd[e].loc[ind, <span class="hljs-string">'new name'</span>]<font></font>
    rd[e] = rd[e].drop(columns = [<span class="hljs-string">'name0'</span>,<span class="hljs-string">'name1'</span>,<span class="hljs-string">'name2'</span>,<span class="hljs-string">'new name'</span>])
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th><u>name</u></th>
<th>country</th>
<th>...</th>
<th>name raw</th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td><u>Yaroslav Pavlishchev</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td><u>Vladimir Perezhigin</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td><u>Vladislav Litvinchuk</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>3</td>
<td>4</td>
<td>M</td>
<td><u>Sergey Gavrilenko</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>M</td>
<td><u>Ivan Markin</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>5</td>
<td>6</td>
<td>M</td>
<td><u>Nikolay Sokolov</u></td>
<td>RUS</td>
<td>...</td>
<td>Nikolay Evgenevich Sokolov</td>
</tr>
<tr>
<td>6</td>
<td>7</td>
<td>M</td>
<td><u>Aram Kukhtiev</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>7</td>
<td>8</td>
<td>M</td>
<td><u>Andrey Andreev</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>8</td>
<td>9</td>
<td>M</td>
<td><u>Denis Bulgakov</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>9</td>
<td>10</td>
<td>M</td>
<td><u>Aleksandr Kuts</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>10</td>
<td>11</td>
<td>M</td>
<td><u>Aleksandr Lando</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das ist also alles. </font><font style="vertical-align: inherit;">Wir haben 2.035 Eintr√§ge bearbeitet. </font><font style="vertical-align: inherit;">Nicht schlecht. </font><font style="vertical-align: inherit;">Gerettet.</font></font><br>
<br>
<pre><code class="python hljs">pkl.dump(rd, open(<span class="hljs-string">r'D:\tri\details5.pkl'</span>, <span class="hljs-string">'wb'</span>))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt m√ºssen Sie die Namen in die gleiche Reihenfolge bringen. </font><font style="vertical-align: inherit;">Das hei√üt, es ist erforderlich, dass in allen Protokollen der Name zuerst gefolgt vom Nachnamen oder umgekehrt - zuerst der Nachname, dann der Vorname, auch in allen Protokollen. </font><font style="vertical-align: inherit;">Kommt darauf an was mehr, jetzt werden wir es herausfinden. </font><font style="vertical-align: inherit;">Die Situation wird etwas kompliziert durch die Tatsache, dass der vollst√§ndige Name aus mehr als zwei W√∂rtern bestehen kann, selbst nachdem wir den zweiten Vornamen entfernt haben.</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'nwin'</span>] = ar[<span class="hljs-string">'name'</span>].str.count(<span class="hljs-string">' '</span>) + <span class="hljs-number">1</span> <span class="hljs-comment"># nwin ‚Äì number of words in name</span>
ar.loc[ar[<span class="hljs-string">'name'</span>] == <span class="hljs-string">''</span>,<span class="hljs-string">'nwin'</span>] = <span class="hljs-number">0</span>
<span class="hljs-number">100</span>*ar[<span class="hljs-string">'nwin'</span>].value_counts()/len(ar)
</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anzahl der W√∂rter in einem Namen Anzahl der Datens√§tze Anteil der Datens√§tze (%) </font><font style="vertical-align: inherit;">Nat√ºrlich besteht die √ºberwiegende Mehrheit (91%) aus zwei W√∂rtern - nur einem Namen und einem Nachnamen. </font><font style="vertical-align: inherit;">Es gibt aber auch sehr viele Eintr√§ge mit drei und vier W√∂rtern. </font><font style="vertical-align: inherit;">Schauen wir uns die Nationalit√§t solcher Aufzeichnungen an:</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>   </th>
<th> </th>
<th>  (%)</th>
</tr>
<tr>
<td>2</td>
<td>1285270</td>
<td>90.74426</td>
</tr>
<tr>
<td>3</td>
<td>102220</td>
<td>7.217066</td>
</tr>
<tr>
<td>4</td>
<td>22420</td>
<td>1.582925</td>
</tr>
<tr>
<td>0</td>
<td>3454</td>
<td>0.243864</td>
</tr>
<tr>
<td>5</td>
<td>2385</td>
<td>0.168389</td>
</tr>
<tr>
<td>6</td>
<td>469</td>
<td>0.033113</td>
</tr>
<tr>
<td>1</td>
<td>80</td>
<td>0.005648</td>
</tr>
<tr>
<td>7</td>
<td>57</td>
<td>0.004024</td>
</tr>
<tr>
<td>8</td>
<td>5</td>
<td>0.000353</td>
</tr>
<tr>
<td>10</td>
<td>4</td>
<td>0.000282</td>
</tr>
<tr>
<td>9</td>
<td>1</td>
<td>0.000071</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar[ar[<span class="hljs-string">'nwin'</span>] &gt;= <span class="hljs-number">3</span>][<span class="hljs-string">'country'</span>].value_counts()[:<span class="hljs-number">12</span>]
</code></pre><br>
<code><b>Out: </b><br>
ESP 28435<br>
MEX 10561<br>
USA 7608<br>
DNK 7178<br>
BRA 6321<br>
NLD 5748<br>
DEU 4310<br>
PHL 3941<br>
ZAF 3862<br>
ITA 3691<br>
BEL 3596<br>
FRA 3323<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun, an erster Stelle steht Spanien, an zweiter Stelle - Mexiko, ein hispanisches Land, weiter als die Vereinigten Staaten, wo es auch historisch viele Hispanics gibt. Brasilien und die Philippinen sind ebenfalls spanische (und portugiesische) Namen. D√§nemark, die Niederlande, Deutschland, S√ºdafrika, Italien, Belgien und Frankreich sind eine andere Sache. Manchmal kommt dem Nachnamen einfach eine Art Pr√§fix vor, daher gibt es mehr als zwei W√∂rter. In all diesen F√§llen besteht der Name jedoch normalerweise aus einem Wort und der Nachname aus zwei, drei. Nat√ºrlich gibt es Ausnahmen von dieser Regel, aber wir werden sie nicht mehr verarbeiten. Zun√§chst m√ºssen Sie f√ºr jedes Protokoll bestimmen, welche Art von Reihenfolge es gibt: Name-Nachname oder umgekehrt. Wie kann man das machen? Die folgende Idee kam mir: Erstens ist die Vielfalt der Nachnamen normalerweise viel gr√∂√üer als die Vielfalt der Namen. Dies sollte auch im Rahmen eines Protokolls der Fall sein. Zweitens,Die L√§nge des Namens ist normalerweise kleiner als die L√§nge des Nachnamens (auch bei nicht zusammengesetzten Nachnamen). Wir werden eine Kombination dieser Kriterien verwenden, um die vorl√§ufige Bestellung zu bestimmen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
W√§hlen Sie das erste und das letzte Wort im vollst√§ndigen Namen aus:</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'new name'</span>] = ar[<span class="hljs-string">'name'</span>]<font></font>
ind = ar[ar[<span class="hljs-string">'nwin'</span>] &lt; <span class="hljs-number">2</span>].index<font></font>
ar.loc[ind, <span class="hljs-string">'new name'</span>] = <span class="hljs-string">'. .'</span> <span class="hljs-comment">#  ,   str.split()   </span>
ar[<span class="hljs-string">'wfin'</span>] = ar[<span class="hljs-string">'new name'</span>].str.split().str[<span class="hljs-number">0</span>] <span class="hljs-comment">#fwin  ‚Äì first word in name</span>
ar[<span class="hljs-string">'lwin'</span>] = ar[<span class="hljs-string">'new name'</span>].str.split().str[<span class="hljs-number">-1</span>]<span class="hljs-comment">#lfin ‚Äì last word in name</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Konvertieren Sie den kombinierten </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ar- </font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">Datenrahmen</font></i><font style="vertical-align: inherit;"> zur√ºck in das </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rd-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> W√∂rterbuch, </font><font style="vertical-align: inherit;">sodass die neuen Spalten </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nwin, ns0, ns</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in den </font><i><font style="vertical-align: inherit;">Datenrahmen</font></i><font style="vertical-align: inherit;"> jedes Rennens fallen. </font><font style="vertical-align: inherit;">Als n√§chstes bestimmen wir die Anzahl der Protokolle mit der Reihenfolge </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄûVorname Nachname‚Äú</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und die Anzahl der Protokolle mit der umgekehrten Reihenfolge gem√§√ü unserem Kriterium. </font><font style="vertical-align: inherit;">Wir werden nur Eintr√§ge betrachten, bei denen der vollst√§ndige Name aus zwei W√∂rtern besteht. </font><font style="vertical-align: inherit;">Speichern Sie gleichzeitig den Namen (Vornamen) in einer neuen Spalte:</font></font><br>
<br>
<pre><code class="python hljs">name_surname = {}<font></font>
surname_name = {}<font></font>
<font></font>
<span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> rd:<font></font>
    d = rd[e][rd[e][<span class="hljs-string">'nwin'</span>] == <span class="hljs-number">2</span>]<font></font>
<font></font>
    <span class="hljs-keyword">if</span> len(d[<span class="hljs-string">'fwin'</span>].unique()) &lt; len(d[<span class="hljs-string">'lwin'</span>].unique()) <span class="hljs-keyword">and</span> len(<span class="hljs-string">''</span>.join(d[<span class="hljs-string">'fwin'</span>])) &lt; len(<span class="hljs-string">''</span>.join(d[<span class="hljs-string">'lwin'</span>])):<font></font>
        name_surname[e] = d<font></font>
        rd[e][<span class="hljs-string">'first name'</span>] = rd[e][<span class="hljs-string">'fwin'</span>]<font></font>
<font></font>
    <span class="hljs-keyword">if</span> len(d[<span class="hljs-string">'fwin'</span>].unique()) &gt; len(d[<span class="hljs-string">'lwin'</span>].unique()) <span class="hljs-keyword">and</span> len(<span class="hljs-string">''</span>.join(d[<span class="hljs-string">'fwin'</span>])) &gt; len(<span class="hljs-string">''</span>.join(d[<span class="hljs-string">'lwin'</span>])):<font></font>
        surname_name[e] = d<font></font>
        rd[e][<span class="hljs-string">'first name'</span>] = rd[e][<span class="hljs-string">'lwin'</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es stellte sich Folgendes heraus: die Reihenfolge </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vorname Nachname</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 244 Protokolle, die Reihenfolge </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nachname Vorname</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 1.508 Protokolle. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dementsprechend werden wir zu dem Format f√ºhren, das √ºblicher ist. </font><font style="vertical-align: inherit;">Es stellte sich heraus, dass die Summe geringer war als der Gesamtbetrag, da wir gleichzeitig und mit strikter Ungleichheit die Erf√ºllung von zwei Kriterien √ºberpr√ºft haben. </font><font style="vertical-align: inherit;">Es gibt Protokolle, in denen nur eines der Kriterien erf√ºllt ist oder vielleicht, aber es ist unwahrscheinlich, dass Gleichheit auftritt. </font><font style="vertical-align: inherit;">Dies ist jedoch v√∂llig unwichtig, da das Format definiert ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unter der Annahme, dass wir die Reihenfolge mit ausreichend hoher Genauigkeit bestimmt haben, ohne zu vergessen, dass sie nicht 100% genau ist, werden wir diese Informationen verwenden. </font><font style="vertical-align: inherit;">Suchen Sie die beliebtesten Namen in der Spalte mit den </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vornamen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs">vc = ar[<span class="hljs-string">'first name'</span>].value_counts()
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nehmen Sie diejenigen, die sich mehr als hundert Mal getroffen haben:</font></font><br>
<br>
<pre><code class="python hljs">pfn=vc[vc&gt;<span class="hljs-number">100</span>] <span class="hljs-comment">#pfn ‚Äì popular first names</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gab 1.673 von ihnen. Hier sind die ersten hundert von ihnen, in absteigender Reihenfolge der Beliebtheit angeordnet: </font><font style="vertical-align: inherit;">
Anhand dieser Liste werden wir nun alle Protokolle durchgehen und vergleichen, wo es mehr √úbereinstimmungen gibt - im ersten Wort des Namens oder im letzten. Wir werden nur Namen mit zwei W√∂rtern betrachten. Wenn es mehr √úbereinstimmungen mit dem letzten Wort gibt, ist die Reihenfolge korrekt, wenn mit dem ersten das Gegenteil der Fall ist. Und hier sind wir sicherer, das hei√üt, Sie k√∂nnen dieses Wissen nutzen, und wir werden mit jedem Durchgang eine Liste der Namen ihres n√§chsten Protokolls zur anf√§nglichen Liste der popul√§ren Namen hinzuf√ºgen. Wir sortieren die Protokolle nach der H√§ufigkeit des Auftretens von Namen aus der Anfangsliste vor, um zuf√§llige Fehler zu vermeiden, und erstellen eine umfangreichere Liste f√ºr die Protokolle, bei denen es nur wenige √úbereinstimmungen gibt und die gegen Ende des Zyklus verarbeitet werden.</font></font><br>
<code>['Michael', 'David', 'Thomas', 'John', 'Daniel', 'Mark', 'Peter', 'Paul', 'Christian', 'Robert', 'Martin', 'James', 'Andrew', 'Chris', 'Richard', 'Andreas', 'Matthew', 'Brian', 'Patrick', 'Scott', 'Kevin', 'Stefan', 'Jason', 'Eric', 'Christopher', 'Alexander', 'Simon', 'Mike', 'Tim', 'Frank', 'Stephen', 'Steve', 'Andrea', 'Jonathan', 'Markus', 'Marco', 'Adam', 'Ryan', 'Jan', 'Tom', 'Marc', 'Carlos', 'Jennifer', 'Matt', 'Steven', 'Jeff', 'Sergey', 'William', 'Aleksandr', 'Sarah', 'Alex', 'Jose', 'Andrey', 'Benjamin', 'Sebastian', 'Ian', 'Anthony', 'Ben', 'Oliver', 'Antonio', 'Ivan', 'Sean', 'Manuel', 'Matthias', 'Nicolas', 'Dan', 'Craig', 'Dmitriy', 'Laura', 'Luis', 'Lisa', 'Kim', 'Anna', 'Nick', 'Rob', 'Maria', 'Greg', 'Aleksey', 'Javier', 'Michelle', 'Andre', 'Mario', 'Joseph', 'Christoph', 'Justin', 'Jim', 'Gary', 'Erik', 'Andy', 'Joe', 'Alberto', 'Roberto', 'Jens', 'Tobias', 'Lee', 'Nicholas', 'Dave', 'Tony', 'Olivier', 'Philippe']<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">sbpn = pd.DataFrame(columns = [<span class="hljs-string">'event'</span>, <span class="hljs-string">'num pop names'</span>], index=range(len(rd))) <span class="hljs-comment"># sbpn - sorted by popular names</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(rd)):<font></font>
    e = list(rd.keys())[i]<font></font>
    sbpn.loc[i, <span class="hljs-string">'event'</span>] = e<font></font>
    sbpn.loc[i, <span class="hljs-string">'num pop names'</span>] = len(set(pfn).intersection(rd[e][<span class="hljs-string">'first name'</span>]))<font></font>
<font></font>
sbnp=sbnp.sort_values(by = <span class="hljs-string">'num pop names'</span>,ascending=<span class="hljs-literal">False</span>)<font></font>
sbnp = sbnp.reset_index(drop=<span class="hljs-literal">True</span>) 
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th>num pop names</th>
</tr>
<tr>
<td>0</td>
<td>Ironman World Championship 70.3 2016</td>
<td>811</td>
</tr>
<tr>
<td>1</td>
<td>Ironman World Championship 2019</td>
<td>781</td>
</tr>
<tr>
<td>2</td>
<td>Ironman World Championship 70.3 2015</td>
<td>778</td>
</tr>
<tr>
<td>3</td>
<td>Ironman Mallorca 70.3 2014</td>
<td>776</td>
</tr>
<tr>
<td>4</td>
<td>Ironman World Championship 2018</td>
<td>766</td>
</tr>
<tr>
<td>5</td>
<td>Challenge Roth Long 2019</td>
<td>759</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td>1917</td>
<td>Challenge Gran Canaria Olympic 2019</td>
<td>0</td>
</tr>
<tr>
<td>1918</td>
<td>Challenge Gran Canaria Middle 2017</td>
<td>0</td>
</tr>
<tr>
<td>1919</td>
<td>Challenge Forte Village-Sardinia Sprint 2017</td>
<td>0</td>
</tr>
<tr>
<td>1920</td>
<td>ITU European Cup Kuopio Sprint 2007</td>
<td>0</td>
</tr>
<tr>
<td>1921</td>
<td>ITU World Cup Madeira Olympic 2002</td>
<td>0</td>
</tr>
</tbody></table></div></code><br>
<br>
<pre><code class="python hljs">tofix = []<font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(rd)):<font></font>
    e = sbpn.loc[i, <span class="hljs-string">'event'</span>]<font></font>
<font></font>
    <span class="hljs-keyword">if</span> len(set(list(rd[e][<span class="hljs-string">'fwin'</span>])).intersection(pfn)) &gt; len(set(list(rd[e][<span class="hljs-string">'lwin'</span>])).intersection(pfn)):<font></font>
        tofix.append(e)<font></font>
        pfn = list(set(pfn + list(rd[e][<span class="hljs-string">'fwin'</span>])))
    <span class="hljs-keyword">else</span>:<font></font>
        pfn = list(set(pfn + list(rd[e][<span class="hljs-string">'lwin'</span>])))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gab 235 Protokolle. Das ist ungef√§hr das Gleiche wie in erster N√§herung (244). Um sicherzugehen, habe ich mir die ersten drei Datens√§tze von jedem selektiv angesehen und sichergestellt, dass alles korrekt war. Pr√ºfen Sie </font><font style="vertical-align: inherit;">auch , </font><font style="vertical-align: inherit;">dass die erste Stufe der Sortier gab 36 falsche Eintr√§ge aus der Klasse </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Namen Nachnamen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und 2 falsch aus Class </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Namen Namen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ich habe mir die ersten drei Platten von jeder angesehen, tats√§chlich hat die zweite Stufe perfekt funktioniert. Nun m√ºssen tats√§chlich die Protokolle repariert werden, bei denen die falsche Reihenfolge gefunden wird:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> tofix:<font></font>
    ind = rd[e][rd[e][<span class="hljs-string">'nwin'</span>] &gt; <span class="hljs-number">1</span>].index<font></font>
    rd[e].loc[ind,<span class="hljs-string">'name'</span>] = rd[e].loc[ind,<span class="hljs-string">'name'</span>].str.split(n=<span class="hljs-number">1</span>).str[<span class="hljs-number">1</span>] + <span class="hljs-string">' '</span> +                   rd[e].loc[ind,<span class="hljs-string">'name'</span>].str.split(n=<span class="hljs-number">1</span>).str[<span class="hljs-number">0</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier in der Aufteilung haben wir die Anzahl der Teile mit dem Parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n begrenzt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Die Logik lautet wie folgt: Ein Name ist ein Wort, das erste in einem vollst√§ndigen Namen. </font><font style="vertical-align: inherit;">Alles andere ist ein Nachname (kann aus mehreren W√∂rtern bestehen). </font><font style="vertical-align: inherit;">Tauschen Sie sie einfach aus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt werden unn√∂tige Spalten entfernt und gespeichert:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> rd:<font></font>
    rd[e] = rd[e].drop(columns = [<span class="hljs-string">'new name'</span>, <span class="hljs-string">'first name'</span>, <span class="hljs-string">'fwin'</span>,<span class="hljs-string">'lwin'</span>, <span class="hljs-string">'nwin'</span>])<font></font>
<font></font>
pkl.dump(rd, open(<span class="hljs-string">r'D:\tri\details6.pkl'</span>, <span class="hljs-string">'wb'</span>))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√úberpr√ºfen Sie das Ergebnis. </font><font style="vertical-align: inherit;">Ein zuf√§lliges Dutzend fester Datens√§tze: </font><font style="vertical-align: inherit;">Insgesamt wurden 108.000 Datens√§tze repariert. </font><font style="vertical-align: inherit;">Die Anzahl der eindeutigen vollst√§ndigen Namen verringerte sich von 598 auf 547 Tausend. </font><font style="vertical-align: inherit;">Fein! </font><font style="vertical-align: inherit;">Mit der Formatierung fertig.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th><u>name</u></th>
<th>country</th>
<th>group</th>
<th>...</th>
<th><u>name raw</u></th>
</tr>
<tr>
<td>188</td>
<td>189</td>
<td>M</td>
<td><u>Azhel Dmitriy</u></td>
<td>BLR</td>
<td></td>
<td>...</td>
<td><u> </u></td>
</tr>
<tr>
<td>96</td>
<td>97</td>
<td>M</td>
<td><u>Bostina Cristian</u></td>
<td>ROU</td>
<td></td>
<td>...</td>
<td><u>Cristian Bostina</u></td>
</tr>
<tr>
<td>1757</td>
<td>1758</td>
<td>M</td>
<td><u>Lowe Jonathan</u></td>
<td>AUS</td>
<td>M30-34</td>
<td>...</td>
<td><u>Jonathan LOWE</u></td>
</tr>
<tr>
<td>599</td>
<td>600</td>
<td>M</td>
<td><u>Baerwald Manuel</u></td>
<td>DEU</td>
<td></td>
<td>...</td>
<td><u>Manuel BAERWALD</u></td>
</tr>
<tr>
<td>657</td>
<td>658</td>
<td>M</td>
<td><u>Krumdieck Ralf</u></td>
<td>DEU</td>
<td></td>
<td>...</td>
<td><u>Ralf KRUMDIECK</u></td>
</tr>
<tr>
<td>354</td>
<td>355</td>
<td>F</td>
<td><u>Knapp Samantha</u></td>
<td>USA</td>
<td>F30-34</td>
<td>...</td>
<td><u>Samantha Knapp</u></td>
</tr>
<tr>
<td>375</td>
<td>376</td>
<td>M</td>
<td><u>Rintalaulaja Mika</u></td>
<td>FIN</td>
<td>M40-44</td>
<td>...</td>
<td><u>Mika Rintalaulaja</u></td>
</tr>
<tr>
<td>1304</td>
<td>1305</td>
<td>M</td>
<td><u>Dee Jim</u></td>
<td>USA</td>
<td>M50-54</td>
<td>...</td>
<td><u>Jim DEE</u></td>
</tr>
<tr>
<td>178</td>
<td>179</td>
<td>M</td>
<td><u>Halibert Greg</u></td>
<td>FRA</td>
<td></td>
<td>...</td>
<td><u>GREG HALIBERT</u></td>
</tr>
<tr>
<td>2740</td>
<td>2741</td>
<td>F</td>
<td><u>Comia Marissa</u></td>
<td>USA</td>
<td>F45-49</td>
<td>...</td>
<td><u>Marissa COMIA</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teil 3. Wiederherstellung unvollst√§ndiger Daten</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fahren Sie nun mit der Wiederherstellung der fehlenden Daten fort. </font><font style="vertical-align: inherit;">Und es gibt solche.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Land</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beginnen wir mit dem Land. </font><font style="vertical-align: inherit;">Finden Sie alle Datens√§tze, in denen das Land nicht angegeben ist:</font></font><br>
<br>
<pre><code class="python hljs">arnc = ar[ar[<span class="hljs-string">'country'</span>] == <span class="hljs-string">''</span>] <span class="hljs-comment">#arnc ‚Äì all records with no country</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt 3.221 von ihnen. Hier sind 10 zuf√§llige:</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th><u>country</u></th>
<th>group</th>
<th>...</th>
<th>country raw</th>
</tr>
<tr>
<td>...</td>
<td>1633</td>
<td>M</td>
<td>Guerrero Pla Angel</td>
<td></td>
<td>M30-34</td>
<td>...</td>
<td>E</td>
</tr>
<tr>
<td>...</td>
<td>258</td>
<td>M</td>
<td>Bellm Mathias</td>
<td></td>
<td>M35-39</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>655</td>
<td>M</td>
<td>Moratto Alessio</td>
<td></td>
<td>M40-44</td>
<td>...</td>
<td>I</td>
</tr>
<tr>
<td>...</td>
<td>1317</td>
<td>M</td>
<td>Solari Jean-Jacques</td>
<td></td>
<td>M50-54</td>
<td>...</td>
<td>TAH</td>
</tr>
<tr>
<td>...</td>
<td>1311</td>
<td>F</td>
<td>Duranel Isabelle</td>
<td></td>
<td>F40-44</td>
<td>...</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>1012</td>
<td>M</td>
<td>Endler Maximilian</td>
<td></td>
<td>M40-44</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>284</td>
<td>M</td>
<td>Schreiner Jorg</td>
<td></td>
<td>M40-44</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>14</td>
<td>M</td>
<td>Butturini Jacopo</td>
<td></td>
<td></td>
<td>...</td>
<td>ITU</td>
</tr>
<tr>
<td>...</td>
<td>204</td>
<td>M</td>
<td>Lindner Thomas</td>
<td></td>
<td>M40-44</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>1168</td>
<td>M</td>
<td>Gramke Peter</td>
<td></td>
<td>M45-49</td>
<td>...</td>
<td>D</td>
</tr>
</tbody></table></div></code><br>
<br>
<pre><code class="python hljs">nnc = arnc[<span class="hljs-string">'name'</span>].unique() <span class="hljs-comment">#nnc - names with no country</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Anzahl der eindeutigen Namen unter Datens√§tzen ohne Land betr√§gt 3 051. Mal sehen, ob diese Anzahl reduziert werden kann. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tatsache ist, dass sich die Leute beim Triathlon selten auf nur ein Rennen beschr√§nken, sondern in der Regel regelm√§√üig, mehrmals pro Saison, von Jahr zu Jahr an Wettbewerben teilnehmen und st√§ndig trainieren. </font><font style="vertical-align: inherit;">Daher gibt es f√ºr viele Namen in den Daten h√∂chstwahrscheinlich mehr als einen Datensatz. </font><font style="vertical-align: inherit;">Versuchen Sie zum Wiederherstellen von Informationen √ºber das Land, Datens√§tze mit demselben Namen unter den Datens√§tzen zu finden, in denen das Land angegeben ist.</font></font><br>
<br>
<pre><code class="python hljs">arwc = ar[ar[<span class="hljs-string">'country'</span>] != <span class="hljs-string">''</span>] <span class="hljs-comment">#arwc ‚Äì all records with country</span>
nwc = arwc[<span class="hljs-string">'name'</span>].unique() <span class="hljs-comment">#nwc ‚Äì names with country</span>
tofix = set(nnc).intersection(nwc)</code></pre><br>
<code><b>Out:</b> ['Kleber-Schad Ute Cathrin', 'Sellner Peter', 'Pfeiffer Christian', 'Scholl Thomas', 'Petersohn Sandra', 'Marchand Kurt', 'Janneck Britta', 'Angheben Riccardo', 'Thiele Yvonne', 'Kie?Wetter Martin', 'Schymik Gerhard', 'Clark Donald', 'Berod Brigitte', 'Theile Markus', 'Giuliattini Burbui Margherita', 'Wehrum Alexander', 'Kenny Oisin', 'Schwieger Peter', 'Grosse Bianca', 'Schafter Carsten', 'Breck Dirk', 'Mautes Christoph', 'Herrmann Andreas', 'Gilbert Kai', 'Steger Peter', 'Jirouskova Jana', 'Jehrke Michael', 'Valentine David', 'Reis Michael', 'Wanka Michael', 'Schomburg Jonas', 'Giehl Caprice', 'Zinser Carsten', 'Schumann Marcus', 'Magoni Livio', 'Lauden Yann', 'Mayer Dieter', 'Krisa Stefan', 'Haberecht Bernd', 'Schneider Achim', 'Gibanel Curto Antonio', 'Miranda Antonio', 'Juarez Pedro', 'Prelle Gerrit', 'Wuste Kay', 'Bullock Graeme', 'Hahner Martin', 'Kahl Maik', 'Schubnell Frank', 'Hastenteufel Marco', ‚Ä¶]<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gab 2.236 von ihnen, das sind fast drei Viertel. </font><font style="vertical-align: inherit;">Jetzt m√ºssen Sie f√ºr jeden Namen aus dieser Liste das Land anhand der Datens√§tze bestimmen, in denen es sich befindet. </font><font style="vertical-align: inherit;">Es kommt jedoch vor, dass derselbe Name in mehreren Datens√§tzen und in verschiedenen L√§ndern vorkommt. </font><font style="vertical-align: inherit;">Dies ist entweder der Namensvetter oder vielleicht die Person, die sich bewegt hat. </font><font style="vertical-align: inherit;">Deshalb verarbeiten wir zuerst diejenigen, bei denen alles einzigartig ist.</font></font><br>
<br>
<pre><code class="python hljs">fix = {}<font></font>
<font></font>
<span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> tofix:<font></font>
    nr = arwc[arwc[<span class="hljs-string">'name'</span>] == n] <font></font>
	<font></font>
    <span class="hljs-keyword">if</span> len(nr[<span class="hljs-string">'country'</span>].unique()) == <span class="hljs-number">1</span>:<font></font>
        fix[n] = nr[<span class="hljs-string">'country'</span>].iloc[<span class="hljs-number">0</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In einer Schleife gemacht. </font><font style="vertical-align: inherit;">Aber ehrlich gesagt klappt es schon lange - ungef√§hr drei Minuten. </font><font style="vertical-align: inherit;">Wenn es eine Gr√∂√üenordnung mehr Eintr√§ge g√§be, m√ºssten Sie wahrscheinlich eine Vektorimplementierung entwickeln. </font><font style="vertical-align: inherit;">Es gab 2.013 Eintr√§ge oder 90% des Potenzials. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namen, f√ºr die verschiedene L√§nder in unterschiedlichen Datens√§tzen vorkommen k√∂nnen, beziehen sich auf das Land, das am h√§ufigsten vorkommt.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">if</span> n <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> fix:<font></font>
    nr = arwc[arwc[<span class="hljs-string">'name'</span>] == n]<font></font>
    vc = nr[<span class="hljs-string">'country'</span>].value_counts()    <font></font>
	<font></font>
    <span class="hljs-keyword">if</span> vc[<span class="hljs-number">0</span>] &gt; vc[<span class="hljs-number">1</span>]:<font></font>
        fix[n] = vc.index[<span class="hljs-number">0</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So wurden √úbereinstimmungen f√ºr 2.208 Namen oder 99% aller potenziellen Namen gefunden. </font><font style="vertical-align: inherit;">
Wir wenden diese Entsprechungen an:</font></font><br>
<code>{'Kleber-Schad Ute Cathrin': 'DEU', 'Sellner Peter': 'AUT', 'Pfeiffer Christian': 'AUT', 'Scholl Thomas': 'DEU', 'Petersohn Sandra': 'DEU', 'Marchand Kurt': 'BEL', 'Janneck Britta': 'DEU', 'Angheben Riccardo': 'ITA', 'Thiele Yvonne': 'DEU', 'Kie?Wetter Martin': 'DEU', 'Clark Donald': 'GBR', 'Berod Brigitte': 'FRA', 'Theile Markus': 'DEU', 'Giuliattini Burbui Margherita': 'ITA', 'Wehrum Alexander': 'DEU', 'Kenny Oisin': 'IRL', 'Schwieger Peter': 'DEU', 'Schafter Carsten': 'DEU', 'Breck Dirk': 'DEU', 'Mautes Christoph': 'DEU', 'Herrmann Andreas': 'DEU', 'Gilbert Kai': 'DEU', 'Steger Peter': 'AUT', 'Jirouskova Jana': 'CZE', 'Jehrke Michael': 'DEU', 'Wanka Michael': 'DEU', 'Giehl Caprice': 'DEU', 'Zinser Carsten': 'DEU', 'Schumann Marcus': 'DEU', 'Magoni Livio': 'ITA', 'Lauden Yann': 'FRA', 'Mayer Dieter': 'DEU', 'Krisa Stefan': 'DEU', 'Haberecht Bernd': 'DEU', 'Schneider Achim': 'DEU', 'Gibanel Curto Antonio': 'ESP', 'Juarez Pedro': 'ESP', 'Prelle Gerrit': 'DEU', 'Wuste Kay': 'DEU', 'Bullock Graeme': 'GBR', 'Hahner Martin': 'DEU', 'Kahl Maik': 'DEU', 'Schubnell Frank': 'DEU', 'Hastenteufel Marco': 'DEU', 'Tedde Roberto': 'ITA', 'Minervini Domenico': 'ITA', 'Respondek Markus': 'DEU', 'Kramer Arne': 'DEU', 'Schreck Alex': 'DEU', 'Bichler Matthias': 'DEU', ‚Ä¶}<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> fix:<font></font>
    ind = arnc[arnc[<span class="hljs-string">'name'</span>] == n].index<font></font>
    ar.loc[ind, <span class="hljs-string">'country'</span>] = fix[n]</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th><u>country</u></th>
<th>group</th>
<th>...</th>
<th>country raw</th>
</tr>
<tr>
<td>...</td>
<td>1633</td>
<td>M</td>
<td>Guerrero Pla Angel</td>
<td><u>ESP</u></td>
<td>M30-34</td>
<td>...</td>
<td>E</td>
</tr>
<tr>
<td>...</td>
<td>258</td>
<td>M</td>
<td>Bellm Mathias</td>
<td><u>DEU</u></td>
<td>M35-39</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>655</td>
<td>M</td>
<td>Moratto Alessio</td>
<td><u>ITA</u></td>
<td>M40-44</td>
<td>...</td>
<td>I</td>
</tr>
<tr>
<td>...</td>
<td>1317</td>
<td>M</td>
<td>Solari Jean-Jacques</td>
<td><u>PYF</u></td>
<td>M50-54</td>
<td>...</td>
<td>TAH</td>
</tr>
<tr>
<td>...</td>
<td>1311</td>
<td>F</td>
<td>Duranel Isabelle</td>
<td><u>FRA</u></td>
<td>F40-44</td>
<td>...</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>1012</td>
<td>M</td>
<td>Endler Maximilian</td>
<td><u>DEU</u></td>
<td>M40-44</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>284</td>
<td>M</td>
<td>Schreiner Jorg</td>
<td><u>DEU</u></td>
<td>M40-44</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>14</td>
<td>M</td>
<td>Butturini Jacopo</td>
<td><u>HRV</u></td>
<td></td>
<td>...</td>
<td>ITU</td>
</tr>
<tr>
<td>...</td>
<td>204</td>
<td>M</td>
<td>Lindner Thomas</td>
<td><u>DEU</u></td>
<td>M40-44</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>1168</td>
<td>M</td>
<td>Gramke Peter</td>
<td><u>DEU</u></td>
<td>M45-49</td>
<td>...</td>
<td>D</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nach unseren Korrekturen verringerte sich die Anzahl der Datens√§tze ohne Land auf 909, dh mehr als dreimal. </font><font style="vertical-align: inherit;">Obwohl die Gesamtzahl von 2.208 vor dem Hintergrund von eineinhalb Millionen nicht so gro√ü ist, ist es immer noch sch√∂n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au√üerdem √ºbersetzen wir wie √ºblich den kombinierten </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datenrahmen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wieder in das </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dritte</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> W√∂rterbuch </font><font style="vertical-align: inherit;">und speichern ihn.</font></font><br>
<br>
<pre><code class="python hljs">pkl.dump(rd, open(<span class="hljs-string">r'D:\tri\details7.pkl'</span>, <span class="hljs-string">'wb'</span>))
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fu√üboden</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie in den L√§ndern gibt es Aufzeichnungen, in denen das Geschlecht des Teilnehmers nicht angegeben ist. </font></font><br>
<br>
<pre><code class="python hljs">ar[ar[<span class="hljs-string">'sex'</span>] == <span class="hljs-string">''</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt 2.538 von ihnen. Relativ wenige, aber wir werden wieder versuchen, noch weniger zu machen. </font><font style="vertical-align: inherit;">Speichern Sie die urspr√ºnglichen Werte in einer neuen Spalte.</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'sex raw'</span>] =ar[<span class="hljs-string">'sex'</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Gegensatz zu L√§ndern, in denen wir Informationen namentlich aus anderen Protokollen abgerufen haben, ist hier alles etwas komplizierter. </font><font style="vertical-align: inherit;">Tatsache ist, dass die Daten voller Fehler sind und es viele Namen (insgesamt 2 101) gibt, die mit Markierungen beider Geschlechter gefunden werden.</font></font><br>
<br>
<pre><code class="python hljs">arws = ar[(ar[<span class="hljs-string">'sex'</span>] != <span class="hljs-string">''</span>)&amp;(ar[<span class="hljs-string">'name'</span>] != <span class="hljs-string">''</span>)] <span class="hljs-comment">#arws ‚Äì all records with sex</span>
snds = arws[arws.duplicated(subset=<span class="hljs-string">'name'</span>,keep=<span class="hljs-literal">False</span>)]<span class="hljs-comment">#snds‚Äìsingle name different sex</span>
snds = snds.drop_duplicates(subset=[<span class="hljs-string">'name'</span>,<span class="hljs-string">'sex'</span>], keep = <span class="hljs-string">'first'</span>)<font></font>
snds = snds.sort_values(by=<span class="hljs-string">'name'</span>)<font></font>
snds = snds[snds.duplicated(subset = <span class="hljs-string">'name'</span>, keep=<span class="hljs-literal">False</span>)]<font></font>
<font></font>
snds</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th><u>sex</u></th>
<th><u>name</u></th>
<th>country</th>
<th><u>group</u></th>
<th>...</th>
<th>country raw</th>
<th>group raw</th>
<th>sex raw</th>
</tr>
<tr>
<td>...</td>
<td>428</td>
<td><u>F</u></td>
<td><u>Aagaard Ida</u></td>
<td>NOR</td>
<td><u>F40-44</u></td>
<td>...</td>
<td>NOR</td>
<td>F40-44</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>718</td>
<td><u>M</u></td>
<td><u>Aagaard Ida</u></td>
<td>NOR</td>
<td><u>M40-44</u></td>
<td>...</td>
<td>NOR</td>
<td>M40-44</td>
<td>M</td>
</tr>
<tr>
<td></td>
<td>740</td>
<td><u>M</u></td>
<td><u>Aarekol Tove Aase</u></td>
<td>NOR</td>
<td><u>M50-54</u></td>
<td>...</td>
<td>NOR</td>
<td>M50-54</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>520</td>
<td><u>F</u></td>
<td><u>Aarekol Tove Aase</u></td>
<td>NOR</td>
<td><u>F50-54</u></td>
<td>...</td>
<td>NOR</td>
<td>F50-54</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>665</td>
<td><u>F</u></td>
<td><u>Aaroy Torunn</u></td>
<td>NOR</td>
<td><u>F40-44</u></td>
<td>...</td>
<td>NOR</td>
<td>F40-44</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>1591</td>
<td><u>M</u></td>
<td><u>Aaroy Torunn</u></td>
<td>NOR</td>
<td><u>M40-44</u></td>
<td>...</td>
<td>NOR</td>
<td>M40-44</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>70</td>
<td><u>M</u></td>
<td><u>Aberg Cobo Dolores</u></td>
<td>ARG</td>
<td><u>FPRO</u></td>
<td>...</td>
<td>ARG</td>
<td>FPRO</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>1258</td>
<td><u>F</u></td>
<td><u>Aberg Cobo Dolores</u></td>
<td>ARG</td>
<td><u>F30-34</u></td>
<td>...</td>
<td>ARG</td>
<td>F30-34</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>1909</td>
<td><u>F</u></td>
<td><u>Aboulfaida Zineb</u></td>
<td>MAR</td>
<td><u>F35-39</u></td>
<td>...</td>
<td>MAR</td>
<td>F35-39</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>340</td>
<td><u>M</u></td>
<td><u>Aboulfaida Zineb</u></td>
<td>MAR</td>
<td><u>M35-39</u></td>
<td>...</td>
<td>MAR</td>
<td>M35-39</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>63</td>
<td><u>F</u></td>
<td><u>Abram Felicity</u></td>
<td>AUS</td>
<td><u>FPRO</u></td>
<td>...</td>
<td>AUS</td>
<td>FPRO</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>38</td>
<td><u>M</u></td>
<td><u>Abram Felicity</u></td>
<td>AUS</td>
<td><u>FJUNIOR</u></td>
<td>...</td>
<td>AUS</td>
<td>FJUNIOR</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>134</td>
<td><u>M</u></td>
<td><u>Abramowski Jannicke</u></td>
<td>DEU</td>
<td><u>FPRO</u></td>
<td>...</td>
<td>GER</td>
<td>FPRO</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>323</td>
<td><u>F</u></td>
<td><u>Abramowski Jannicke</u></td>
<td>DEU</td>
<td><u>F25-29</u></td>
<td>...</td>
<td>GER</td>
<td>F25-29</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>21</td>
<td><u>M</u></td>
<td><u>Abrosimova Anastasia</u></td>
<td>RUS</td>
<td><u>FPRO</u></td>
<td>...</td>
<td>RUS</td>
<td>FPRO</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>177</td>
<td><u>F</u></td>
<td><u>Abrosimova Anastasia</u></td>
<td>RUS</td>
<td><u>FPRO</u></td>
<td>...</td>
<td>RUS</td>
<td>FPRO</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>188</td>
<td><u>M</u></td>
<td><u>Abysova Irina</u></td>
<td>RUS</td>
<td><u>FPRO</u></td>
<td>...</td>
<td>RUS</td>
<td>FPRO</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>60</td>
<td><u>F</u></td>
<td><u>Abysova Irina</u></td>
<td>RUS</td>
<td><u>FPRO</u></td>
<td>...</td>
<td>RUS</td>
<td>FPRO</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>312</td>
<td><u>M</u></td>
<td><u>Acaron Fabiola</u></td>
<td>PRI</td>
<td><u>FJUNIOR</u></td>
<td>...</td>
<td>PUR</td>
<td>FJUNIOR</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>294</td>
<td><u>F</u></td>
<td><u>Acaron Fabiola</u></td>
<td>PRI</td>
<td><u>F45-49</u></td>
<td>...</td>
<td>PUR</td>
<td>F45-49</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>1500</td>
<td><u>M</u></td>
<td><u>Achampong Benjamin</u></td>
<td>GBR</td>
<td><u>M35-39</u></td>
<td>...</td>
<td>GBR</td>
<td>M35-39</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>749</td>
<td><u>F</u></td>
<td><u>Achampong Benjamin</u></td>
<td>GBR</td>
<td><u>M35-39</u></td>
<td>...</td>
<td>GBR</td>
<td>M35-39</td>
<td>F</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ja, im Prinzip gibt es unisex (oder androgyne) Namen, dh solche, mit denen sowohl Jungen als auch M√§dchen benannt werden. Und f√ºr asiatische Sportler ist es im Allgemeinen schwierig, das Geschlecht anhand des Namens zu bestimmen - vielleicht habe ich einfach nicht genug Wissen. Es ist jedoch kaum zu glauben, dass der Name Irina oder Anastasia einem Mann geh√∂rte und Benjamin eine Frau genannt wurde. Dar√ºber hinaus habe ich irgendwann festgestellt, dass es eine gro√üe Anzahl von Protokollen gibt, in denen alle Teilnehmer mit einem Geschlecht gekennzeichnet sind.</font></font><br>
<br>
<pre><code class="python hljs">rss = [rd[e] <span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> rd <span class="hljs-keyword">if</span> len(rd[e][rd[e][<span class="hljs-string">'sex'</span>] != <span class="hljs-string">''</span>][<span class="hljs-string">'sex'</span>].unique()) == <span class="hljs-number">1</span>] <span class="hljs-comment">#rss ‚Äì races with single sex</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt 633 von ihnen. Es scheint, dass dies durchaus m√∂glich ist, nur ein Protokoll separat f√ºr Frauen, separat f√ºr M√§nner. Tatsache ist jedoch, dass fast alle diese Protokolle Altersgruppen beider Geschlechter enthalten (m√§nnliche Altersgruppen beginnen mit dem Buchstaben </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , weiblich - mit dem Buchstaben </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Beispiel: Der </font><font style="vertical-align: inherit;">Name der Altersgruppe beginnt voraussichtlich mit dem Buchstaben </font><i><font style="vertical-align: inherit;">M</font></i><font style="vertical-align: inherit;"> f√ºr M√§nner und dem Buchstaben </font><i><font style="vertical-align: inherit;">F</font></i><font style="vertical-align: inherit;"> f√ºr Frauen. In den beiden vorherigen Beispielen trotz der Fehler in der Spalte </font><i><font style="vertical-align: inherit;">Geschlecht</font></i></font><br>
<br>
<code>'ITU World Cup Tiszaujvaros Olympic 2002'<br>
<div class="scrollable-table"><table>
<tbody><tr>
<th>place</th>
<th><u>sex</u></th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>...</th>
<th>country raw</th>
<th><u>group raw</u></th>
<th>name raw</th>
</tr>
<tr>
<td>76</td>
<td><u>M</u></td>
<td>Dederko Ewa</td>
<td>POL</td>
<td>FPRO</td>
<td>...</td>
<td>POL</td>
<td><u>FPRO</u></td>
<td>Dederko Ewa</td>
</tr>
<tr>
<td>84</td>
<td><u>M</u></td>
<td>Chenevier Giunia</td>
<td>ITA</td>
<td>FPRO</td>
<td>...</td>
<td>ITA</td>
<td><u>FPRO</u></td>
<td>Chenevier Giunia</td>
</tr>
<tr>
<td>36</td>
<td><u>M</u></td>
<td>O'Grady Graham</td>
<td>NZL</td>
<td>MPRO</td>
<td>...</td>
<td>NZL</td>
<td><u>MPRO</u></td>
<td>O'Grady Graham</td>
</tr>
<tr>
<td>23</td>
<td><u>M</u></td>
<td>Danek Michal</td>
<td>CZE</td>
<td>MPRO</td>
<td>...</td>
<td>CZE</td>
<td><u>MPRO</u></td>
<td>Danek Michal</td>
</tr>
<tr>
<td>74</td>
<td><u>M</u></td>
<td>Peon Carole</td>
<td>FRA</td>
<td>FPRO</td>
<td>...</td>
<td>FRA</td>
<td><u>FPRO</u></td>
<td>Peon Carole</td>
</tr>
<tr>
<td>48</td>
<td><u>M</u></td>
<td>Hechenblaickner Daniel</td>
<td>AUT</td>
<td>MPRO</td>
<td>...</td>
<td>AUT</td>
<td><u>MPRO</u></td>
<td>Hechenblaickner Daniel</td>
</tr>
<tr>
<td>70</td>
<td><u>M</u></td>
<td>Blatchford Liz</td>
<td>GBR</td>
<td>FPRO</td>
<td>...</td>
<td>GBR</td>
<td><u>FPRO</u></td>
<td>Blatchford Liz</td>
</tr>
<tr>
<td>1</td>
<td><u>M</u></td>
<td>Walton Craig</td>
<td>AUS</td>
<td>MPRO</td>
<td>...</td>
<td>AUS</td>
<td><u>MPRO</u></td>
<td>Walton Craig</td>
</tr>
<tr>
<td>20</td>
<td><u>M</u></td>
<td>Hobor Peter</td>
<td>HUN</td>
<td>MPRO</td>
<td>...</td>
<td>HUN</td>
<td><u>MPRO</u></td>
<td>Hobor Peter</td>
</tr>
<tr>
<td>56</td>
<td><u>M</u></td>
<td>Kaldau Szabolcs</td>
<td>HUN</td>
<td>MPRO</td>
<td>...</td>
<td>HUN</td>
<td><u>MPRO</u></td>
<td>Kaldau Szabolcs</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Name der Gruppe schien das Geschlecht des Mitglieds immer noch richtig zu beschreiben. </font><font style="vertical-align: inherit;">Anhand mehrerer Beispielbeispiele gehen wir davon aus, dass die Gruppe korrekt angegeben ist und das Geschlecht m√∂glicherweise falsch angegeben ist. </font><font style="vertical-align: inherit;">Suchen Sie alle Eintr√§ge, bei denen der erste Buchstabe im Gruppennamen nicht mit dem Geschlecht √ºbereinstimmt. </font><font style="vertical-align: inherit;">Wir werden den urspr√ºnglichen Namen der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gruppengruppe roh nehmen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , da w√§hrend der Standardisierung viele Datens√§tze ohne Gruppe belassen wurden, aber jetzt nur noch den ersten Buchstaben ben√∂tigen, sodass der Standard nicht wichtig ist.</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'grflc'</span>] = ar[<span class="hljs-string">'group raw'</span>].str.upper().str[<span class="hljs-number">0</span>] <span class="hljs-comment">#grflc ‚Äì group raw first letter capital</span>
grncs = ar[(ar[<span class="hljs-string">'grflc'</span>].isin([<span class="hljs-string">'M'</span>,<span class="hljs-string">'F'</span>]))&amp;(ar[<span class="hljs-string">'sex'</span>]!=ar[<span class="hljs-string">'grflc'</span>])] <span class="hljs-comment">#grncs ‚Äì group raw not consistent with sex</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt 26 161 solcher Aufzeichnungen. </font><font style="vertical-align: inherit;">Korrigieren wir das Geschlecht entsprechend dem Namen der Altersgruppe:</font></font><br>
<br>
<pre><code class="python hljs">ar.loc[grncs.index, <span class="hljs-string">'sex'</span>] = grncs[<span class="hljs-string">'grflc'</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen wir uns das Ergebnis an: </font><font style="vertical-align: inherit;">Gut. </font><font style="vertical-align: inherit;">Wie viele Datens√§tze sind jetzt ohne Geschlecht?</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th><u>sex</u></th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>...</th>
<th>country raw</th>
<th><u>group raw</u></th>
<th><u>sex raw</u></th>
<th>grflc</th>
</tr>
<tr>
<td>...</td>
<td>59</td>
<td><u>F</u></td>
<td>Ueda Ai</td>
<td>JPN</td>
<td>FPRO</td>
<td>...</td>
<td>JPN</td>
<td><u>FPRO</u></td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>50</td>
<td><u>F</u></td>
<td>Zemanova Lenka</td>
<td>CZE</td>
<td>FPRO</td>
<td>...</td>
<td>CZE</td>
<td><u>FPRO</u></td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>83</td>
<td><u>F</u></td>
<td>Spearing Kyleigh</td>
<td>USA</td>
<td>FPRO</td>
<td>...</td>
<td>USA</td>
<td><u>FPRO</u></td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>63</td>
<td><u>F</u></td>
<td>Abysova Irina</td>
<td>RUS</td>
<td>FPRO</td>
<td>...</td>
<td>RUS</td>
<td><u>FPRO</u></td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>57</td>
<td><u>F</u></td>
<td>Knapp Anja</td>
<td>DEU</td>
<td>FPRO</td>
<td>...</td>
<td>GER</td>
<td><u>FPRO</u></td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>68</td>
<td><u>M</u></td>
<td>Matthews Andrew</td>
<td>GBR</td>
<td>M30-34</td>
<td>...</td>
<td>GBR</td>
<td><u>M30-34</u></td>
<td><u>F</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>46</td>
<td><u>F</u></td>
<td>Rappaport Summer</td>
<td>USA</td>
<td>FPRO</td>
<td>...</td>
<td>USA</td>
<td><u>FPRO</u></td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>60</td>
<td><u>F</u></td>
<td>Reid Aileen</td>
<td>IRL</td>
<td>FPRO</td>
<td>...</td>
<td>IRL</td>
<td><u>FPRO</u></td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>142</td>
<td><u>F</u></td>
<td>Mcdowall Edwina</td>
<td>GBR</td>
<td>F45-49</td>
<td>...</td>
<td>GBR</td>
<td><u>F45-49</u></td>
<td></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>141</td>
<td><u>M</u></td>
<td>O'Bray Luke</td>
<td>GBR</td>
<td>M30-34</td>
<td>...</td>
<td>GBR</td>
<td><u>M30-34</u></td>
<td></td>
<td>M</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar[(ar[<span class="hljs-string">'sex'</span>] == <span class="hljs-string">''</span>)&amp;(ar[<span class="hljs-string">'name'</span>] != <span class="hljs-string">''</span>)]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es stellt sich genau eins heraus! </font><font style="vertical-align: inherit;">
Nun, die Gruppe ist nicht wirklich angegeben, aber anscheinend ist dies eine Frau. Emily ist ein weiblicher Name, au√üerdem ist diese Teilnehmerin (oder ihr Namensvetter) ein Jahr zuvor fertig geworden, und in diesem Protokoll sind Geschlecht und Gruppe angegeben. </font><font style="vertical-align: inherit;">
Hier manuell wiederherstellen * und weitermachen.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th><u>sex</u></th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>...</th>
<th>country raw</th>
<th><u>group raw</u></th>
<th><u>sex raw</u></th>
<th>grflc</th>
</tr>
<tr>
<td>London Triathlon Olympic 2019</td>
<td>672</td>
<td></td>
<td>Stather Emily</td>
<td>GBR</td>
<td></td>
<td>...</td>
<td>GBR</td>
<td><u>unknown</u></td>
<td></td>
<td>U</td>
</tr>
</tbody></table></div></code><br><font style="vertical-align: inherit;"></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th><u>sex</u></th>
<th>name</th>
<th>country</th>
<th><u>group</u></th>
<th>...</th>
<th>country raw</th>
<th>group raw</th>
<th><u>sex raw</u></th>
<th>grflc</th>
</tr>
<tr>
<td>Ironman Staffordshire 70.3 2018</td>
<td>1859</td>
<td><u>F</u></td>
<td>Stather Emily</td>
<td>GBR</td>
<td><u>F40-44</u></td>
<td>...</td>
<td>GBR</td>
<td>F40-44</td>
<td><u>F</u></td>
<td>F</td>
</tr>
</tbody></table></div></code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar.loc[arns.index, <span class="hljs-string">'sex'</span>] = <span class="hljs-string">'F'</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt sind alle Aufzeichnungen nach Geschlecht. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* Im Allgemeinen ist es nat√ºrlich falsch, dies zu tun. Wenn sich bei wiederholten Durchl√§ufen etwas in der Kette √§ndert, z. B. bei der Namenskonvertierung, gibt es m√∂glicherweise mehr als einen Datensatz ohne Geschlecht, und nicht alle sind weiblich. Es tritt ein Fehler auf. Daher m√ºssen Sie entweder eine umfangreiche Logik einf√ºgen, um in anderen Protokollen nach einem Teilnehmer mit demselben Namen und Geschlecht zu suchen, z. B. um ein Land wiederherzustellen, und um es zu testen, oder um diese Logik nicht unn√∂tig zu komplizieren, eine √úberpr√ºfung hinzuzuf√ºgen, dass nur ein Datensatz gefunden wird und der Name ist so und so, andernfalls wird eine Ausnahme ausgel√∂st, die den gesamten Laptop stoppt. Sie k√∂nnen eine Abweichung vom Plan feststellen und eingreifen.</font></font></i><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">if</span> len(arns) == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> arns[<span class="hljs-string">'name'</span>].iloc[<span class="hljs-number">0</span>] == <span class="hljs-string">'Stather Emily'</span>:<font></font>
    ar.loc[arns.index, <span class="hljs-string">'sex'</span>] = <span class="hljs-string">'F'</span>
<span class="hljs-keyword">else</span>:
    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">'Different scenario!'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es scheint, dass sich dies beruhigen kann. </font><font style="vertical-align: inherit;">Tatsache ist jedoch, dass Korrekturen auf der Annahme beruhen, dass die Gruppe korrekt angegeben ist. </font><font style="vertical-align: inherit;">Und tats√§chlich ist es so. </font><font style="vertical-align: inherit;">Fast immer. </font><font style="vertical-align: inherit;">Fast. </font><font style="vertical-align: inherit;">Trotzdem wurden versehentlich mehrere Inkonsistenzen festgestellt. Lassen Sie uns nun versuchen, alle zu ermitteln, gut oder so weit wie m√∂glich. </font><font style="vertical-align: inherit;">Wie bereits erw√§hnt, war es im ersten Beispiel genau die Tatsache, dass das Geschlecht aufgrund seiner eigenen Vorstellungen √ºber m√§nnliche und weibliche Namen, die uns bewachten, nicht dem Namen entsprach. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Finden Sie alle Namen in den m√§nnlichen und weiblichen Aufzeichnungen. </font><font style="vertical-align: inherit;">Hier wird der Name als Name verstanden und nicht als vollst√§ndiger Name, dh ohne Nachnamen, was auf Englisch als </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vorname bezeichnet wird</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'fn'</span>] = ar[<span class="hljs-string">'name'</span>].str.split().str[<span class="hljs-number">-1</span>] <span class="hljs-comment">#fn ‚Äì first name</span>
mfn = list(ar[ar[<span class="hljs-string">'sex'</span>] == <span class="hljs-string">'M'</span>][<span class="hljs-string">'fn'</span>].unique()) <span class="hljs-comment">#mfn ‚Äì male first names</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Insgesamt sind 32.508 m√§nnliche Namen aufgef√ºhrt. </font><font style="vertical-align: inherit;">Hier sind die 50 beliebtesten:</font></font><br>
<code>['Michael', 'David', 'Thomas', 'John', 'Daniel', 'Mark', 'Peter', 'Paul', 'Christian', 'Robert', 'Martin', 'James', 'Andrew', 'Chris', 'Richard', 'Andreas', 'Matthew', 'Brian', 'Kevin', 'Patrick', 'Scott', 'Stefan', 'Jason', 'Eric', 'Alexander', 'Christopher', 'Simon', 'Mike', 'Tim', 'Frank', 'Stephen', 'Steve', 'Jonathan', 'Marco', 'Markus', 'Adam', 'Ryan', 'Tom', 'Jan', 'Marc', 'Carlos', 'Matt', 'Steven', 'Jeff', 'Sergey', 'William', 'Aleksandr', 'Andrey', 'Benjamin', 'Jose']<br>
</code><br>
<br>
<pre><code class="python hljs">ffn = list(ar[ar[<span class="hljs-string">'sex'</span>] == <span class="hljs-string">'F'</span>][<span class="hljs-string">'fn'</span>].unique()) <span class="hljs-comment">#ffn ‚Äì female first names</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Weniger Frauen - 14 423. Am beliebtesten: </font><font style="vertical-align: inherit;">
Gut, es scheint logisch auszusehen. </font><font style="vertical-align: inherit;">Mal sehen, ob es Kreuzungen gibt.</font></font><br>
<code>['Jennifer', 'Sarah', 'Laura', 'Lisa', 'Anna', 'Michelle', 'Maria', 'Andrea', 'Nicole', 'Jessica', 'Julie', 'Elizabeth', 'Stephanie', 'Karen', 'Christine', 'Amy', 'Rebecca', 'Susan', 'Rachel', 'Anne', 'Heather', 'Kelly', 'Barbara', 'Claudia', 'Amanda', 'Sandra', 'Julia', 'Lauren', 'Melissa', 'Emma', 'Sara', 'Katie', 'Melanie', 'Kim', 'Caroline', 'Erin', 'Kate', 'Linda', 'Mary', 'Alexandra', 'Christina', 'Emily', 'Angela', 'Catherine', 'Claire', 'Elena', 'Patricia', 'Charlotte', 'Megan', 'Daniela']<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">mffn = set(mfn).intersection(ffn) <span class="hljs-comment">#mffn ‚Äì male-female first names</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt. </font><font style="vertical-align: inherit;">Und es gibt 2.811 von ihnen. Schauen wir sie uns genauer an. </font><font style="vertical-align: inherit;">Zun√§chst finden wir heraus, wie viele Datens√§tze diese Namen haben:</font></font><br>
<br>
<pre><code class="python hljs">armfn = ar[ar[<span class="hljs-string">'fn'</span>].isin(mffn)] <span class="hljs-comment">#armfn ‚Äì all records with male-female names</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt 725 562. Das ist die H√§lfte! </font><font style="vertical-align: inherit;">Das ist erstaunlich! </font><font style="vertical-align: inherit;">Es gibt fast 37.000 eindeutige Namen, aber die H√§lfte der Datens√§tze hat insgesamt 2.800. Mal sehen, welche Namen am beliebtesten sind. </font><font style="vertical-align: inherit;">Erstellen Sie dazu einen neuen Datenrahmen, in dem diese Namen Indizes sind:</font></font><br>
<br>
<pre><code class="python hljs">df = pd.DataFrame(armfn[<span class="hljs-string">'fn'</span>].value_counts())<font></font>
df = df.rename(columns={<span class="hljs-string">'fn'</span>:<span class="hljs-string">'total'</span>})
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir berechnen, wie viele m√§nnliche und weibliche Datens√§tze mit jedem von ihnen.</font></font><br>
<br>
<pre><code class="python hljs">df[<span class="hljs-string">'M'</span>] = armfn[armfn[<span class="hljs-string">'sex'</span>] == <span class="hljs-string">'M'</span>][<span class="hljs-string">'fn'</span>].value_counts()<font></font>
df[<span class="hljs-string">'F'</span>] = armfn[armfn[<span class="hljs-string">'sex'</span>] == <span class="hljs-string">'F'</span>][<span class="hljs-string">'fn'</span>].value_counts()
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>total</th>
<th>M</th>
<th>F</th>
</tr>
<tr>
<td>Michael</td>
<td>20648</td>
<td>20638</td>
<td>10</td>
</tr>
<tr>
<td>David</td>
<td>18493</td>
<td>18485</td>
<td>8</td>
</tr>
<tr>
<td>Thomas</td>
<td>12746</td>
<td>12740</td>
<td>6</td>
</tr>
<tr>
<td>John</td>
<td>11634</td>
<td>11632</td>
<td>2</td>
</tr>
<tr>
<td>Daniel</td>
<td>11045</td>
<td>11041</td>
<td>4</td>
</tr>
<tr>
<td>Mark</td>
<td>10968</td>
<td>10965</td>
<td>3</td>
</tr>
<tr>
<td>Peter</td>
<td>10692</td>
<td>10691</td>
<td>1</td>
</tr>
<tr>
<td>Paul</td>
<td>9616</td>
<td>9614</td>
<td>2</td>
</tr>
<tr>
<td>Christian</td>
<td>8863</td>
<td>8859</td>
<td>4</td>
</tr>
<tr>
<td>Robert</td>
<td>8666</td>
<td>8664</td>
<td>2</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Also ... es sieht verd√§chtig aus. </font><font style="vertical-align: inherit;">Soweit ich wei√ü, sind alle diese Namen m√§nnlich. </font><font style="vertical-align: inherit;">Aber mit jedem von ihnen gibt es eine kleine Anzahl weiblicher Aufzeichnungen. </font><font style="vertical-align: inherit;">Dies sind wahrscheinlich Datenfehler. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen wir uns die weiblichen Namen an.</font></font><br>
<br>
<pre><code class="python hljs">df.sort_values(by = <span class="hljs-string">'F'</span>, ascending=<span class="hljs-literal">False</span>)
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>total</th>
<th>M</th>
<th>F</th>
</tr>
<tr>
<td>Jennifer</td>
<td>3652</td>
<td>3</td>
<td>3649</td>
</tr>
<tr>
<td>Sarah</td>
<td>3288</td>
<td>4</td>
<td>3284</td>
</tr>
<tr>
<td>Laura</td>
<td>2636</td>
<td>3</td>
<td>2633</td>
</tr>
<tr>
<td>Lisa</td>
<td>2618</td>
<td>2</td>
<td>2616</td>
</tr>
<tr>
<td>Anna</td>
<td>2563</td>
<td>10</td>
<td>2553</td>
</tr>
<tr>
<td>Michelle</td>
<td>2373</td>
<td>1</td>
<td>2372</td>
</tr>
<tr>
<td>Maria</td>
<td>2555</td>
<td>386</td>
<td>2169</td>
</tr>
<tr>
<td>Andrea</td>
<td>4323</td>
<td>2235</td>
<td>2088</td>
</tr>
<tr>
<td>Nicole</td>
<td>2025</td>
<td>6</td>
<td>2019</td>
</tr>
<tr>
<td>Julie</td>
<td>1938</td>
<td>2</td>
<td>1936</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das selbe. Fast. Heben Sie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andrea hervor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , was in der Tat ein androgyner Name ist und </font><font style="vertical-align: inherit;">aus irgendeinem Grund </font><font style="vertical-align: inherit;">etwas weniger als </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maria</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vergessen Sie nicht, dass wir Daten von Menschen aus sehr unterschiedlichen L√§ndern auf der ganzen Welt recherchieren. In verschiedenen Kulturen kann der gleiche Name auf v√∂llig unterschiedliche Weise verwendet werden. Hier ist ein Beispiel. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Karen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist einer der beliebtesten weiblichen Namen aus unserer Liste, aber auf der anderen Seite gibt es den Namen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Karen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , der auf die gleiche Weise in Transliteration geschrieben wird, aber ausschlie√ülich von M√§nnern getragen wird. Gl√ºcklicherweise gibt es ein Paket, das all diese Weltweisheit enth√§lt. Es hei√üt </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gender-Guesser</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es funktioniert so:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> gender_guesser.detector <span class="hljs-keyword">as</span> gg<font></font>
<font></font>
d = gg.Detector()<font></font>
d.get_gender(<span class="hljs-string">u'Oleg'</span>)</code></pre><br>
<code><b>Out:</b> 'male'<br>
</code><br>
<br>
<pre><code class="python hljs">d.get_gender(<span class="hljs-string">u'Evgeniya'</span>)
</code></pre><br>
<code><b>Out:</b> 'female'<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alles ist in Ordnung. </font><font style="vertical-align: inherit;">Aber wenn Sie den Namen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andrea</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √ºberpr√ºfen </font><font style="vertical-align: inherit;">, dann gibt er auch </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">weiblich aus</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , was nicht ganz richtig ist. </font><font style="vertical-align: inherit;">Es stimmt, es gibt einen Ausweg. </font><font style="vertical-align: inherit;">Wenn Sie sich die Eigenschaft </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">names</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> des </font><font style="vertical-align: inherit;">Detektors </font><font style="vertical-align: inherit;">ansehen </font><font style="vertical-align: inherit;">, wird dort die gesamte Mehrdeutigkeit sichtbar.</font></font><br>
<br>
<pre><code class="python hljs">d.names[<span class="hljs-string">'Andrea'</span>]
</code></pre><br>
<code><b>Out: </b>{'female': ' 4 4 3 4788 64 579 34 1 7 ',<br>
 'mostly_female': '5 6 7 ',<br>
 'male': ' 7 '}<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ja, das hei√üt, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_gender</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bietet Ihnen nur die wahrscheinlichste Option, aber in Wirklichkeit kann es viel komplizierter sein. </font><font style="vertical-align: inherit;">√úberpr√ºfen Sie andere Namen:</font></font><br>
<br>
<pre><code class="python hljs">d.names[<span class="hljs-string">'Maria'</span>]
</code></pre><br>
<code><b>Out:</b> {'female': '686 6 A 85986 A BA 3B98A75457 6 ',<br>
 'mostly_female': ' BBC A 678A9 '}<br>
</code><br>
<br>
<pre><code class="python hljs">d.names[<span class="hljs-string">'Oleg'</span>]
</code></pre><br>
<code><b>Out:</b> {'male': ' 6 2 99894737 3 '}<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das hei√üt, die Liste der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Namen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> f√ºr jeden Namen entspricht einem oder mehreren Schl√ºssel-Wert-Paaren, wobei der Schl√ºssel - es ist Geschlecht: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m√§nnlich, WEIBLICH, meistens m√§nnlich, meistens weiblich, andy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , und der Wert - die Liste der Werte des entsprechenden Landes: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,2,3 ... .. 9ABC</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Die L√§nder sind:</font></font><br>
<br>
<pre><code class="python hljs">d.COUNTRIES</code></pre><br>
<code><b>Out:</b> ['great_britain', 'ireland', 'usa', 'italy', 'malta', 'portugal', 'spain', 'france', 'belgium', 'luxembourg', 'the_netherlands', 'east_frisia', 'germany', 'austria', 'swiss', 'iceland', 'denmark', 'norway', 'sweden', 'finland', 'estonia', 'latvia', 'lithuania', 'poland', 'czech_republic', 'slovakia', 'hungary', 'romania', 'bulgaria', 'bosniaand', 'croatia', 'kosovo', 'macedonia', 'montenegro', 'serbia', 'slovenia', 'albania', 'greece', 'russia', 'belarus', 'moldova', 'ukraine', 'armenia', 'azerbaijan', 'georgia', 'the_stans', 'turkey', 'arabia', 'israel', 'china', 'india', 'japan', 'korea', 'vietnam', 'other_countries']<br>
</code> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe nicht ganz verstanden, was die alphanumerischen Bedeutungen oder ihre Abwesenheit in der Liste konkret bedeuten. </font><font style="vertical-align: inherit;">Dies war jedoch nicht wichtig, da ich mich darauf beschr√§nkte, nur die Namen zu verwenden, die eine eindeutige Interpretation haben. </font><font style="vertical-align: inherit;">Das hei√üt, f√ºr die es nur ein Schl√ºssel-Wert-Paar gibt und der Schl√ºssel entweder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m√§nnlich</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">weiblich ist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Schreiben Sie f√ºr jeden Namen aus unserem Datenrahmen die Interpretation des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gender-Guesser</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs">df[<span class="hljs-string">'sex from gg'</span>] = <span class="hljs-string">''</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> df.index:
    <span class="hljs-keyword">if</span> n <span class="hljs-keyword">in</span> list(d.names.keys()):<font></font>
        options = list(d.names[n].keys())<font></font>
        <span class="hljs-keyword">if</span> len(options) == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> options[<span class="hljs-number">0</span>] == <span class="hljs-string">'male'</span>:<font></font>
            df.loc[n, <span class="hljs-string">'sex from gg'</span>] = <span class="hljs-string">'M'</span>
        <span class="hljs-keyword">if</span> len(options) == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> options[<span class="hljs-number">0</span>] == <span class="hljs-string">'female'</span>:<font></font>
            df.loc[n, <span class="hljs-string">'sex from gg'</span>] = <span class="hljs-string">'F'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es stellte sich heraus, 1.150 Namen. </font><font style="vertical-align: inherit;">Hier sind die beliebtesten, die bereits oben besprochen wurden: </font><font style="vertical-align: inherit;">Nun, nicht schlecht. </font><font style="vertical-align: inherit;">Wenden Sie diese Logik nun auf alle Datens√§tze an.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>total</th>
<th>M</th>
<th>F</th>
<th>sex from gg</th>
</tr>
<tr>
<td>Michael</td>
<td>20648</td>
<td>20638</td>
<td>10</td>
<td>M</td>
</tr>
<tr>
<td>David</td>
<td>18493</td>
<td>18485</td>
<td>8</td>
<td>M</td>
</tr>
<tr>
<td>Thomas</td>
<td>12746</td>
<td>12740</td>
<td>6</td>
<td>M</td>
</tr>
<tr>
<td>John</td>
<td>11634</td>
<td>11632</td>
<td>2</td>
<td>M</td>
</tr>
<tr>
<td>Daniel</td>
<td>11045</td>
<td>11041</td>
<td>4</td>
<td>M</td>
</tr>
<tr>
<td>Mark</td>
<td>10968</td>
<td>10965</td>
<td>3</td>
<td>M</td>
</tr>
<tr>
<td>Peter</td>
<td>10692</td>
<td>10691</td>
<td>1</td>
<td>M</td>
</tr>
<tr>
<td>Paul</td>
<td>9616</td>
<td>9614</td>
<td>2</td>
<td>M</td>
</tr>
<tr>
<td>Christian</td>
<td>8863</td>
<td>8859</td>
<td>4</td>
<td></td>
</tr>
<tr>
<td>Robert</td>
<td>8666</td>
<td>8664</td>
<td>2</td>
<td>M</td>
</tr>
</tbody></table></div></code><br>
 <code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>total</th>
<th>M</th>
<th>F</th>
<th>sex from gg</th>
</tr>
<tr>
<td>Jennifer</td>
<td>3652</td>
<td>3</td>
<td>3649</td>
<td>F</td>
</tr>
<tr>
<td>Sarah</td>
<td>3288</td>
<td>4</td>
<td>3284</td>
<td>F</td>
</tr>
<tr>
<td>Laura</td>
<td>2636</td>
<td>3</td>
<td>2633</td>
<td>F</td>
</tr>
<tr>
<td>Lisa</td>
<td>2618</td>
<td>2</td>
<td>2616</td>
<td>F</td>
</tr>
<tr>
<td>Anna</td>
<td>2563</td>
<td>10</td>
<td>2553</td>
<td>F</td>
</tr>
<tr>
<td>Michelle</td>
<td>2373</td>
<td>1</td>
<td>2372</td>
<td>F</td>
</tr>
<tr>
<td>Maria</td>
<td>2555</td>
<td>386</td>
<td>2169</td>
<td></td>
</tr>
<tr>
<td>Andrea</td>
<td>4323</td>
<td>2235</td>
<td>2088</td>
<td></td>
</tr>
<tr>
<td>Nicole</td>
<td>2025</td>
<td>6</td>
<td>2019</td>
<td>F</td>
</tr>
<tr>
<td>Julie</td>
<td>1938</td>
<td>2</td>
<td>1936</td>
<td></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">all_names = ar[<span class="hljs-string">'fn'</span>].unique()<font></font>
<font></font>
male_names = []<font></font>
female_names = []<font></font>
<font></font>
<span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> all_names:
    <span class="hljs-keyword">if</span> n <span class="hljs-keyword">in</span> list(d.names.keys()):<font></font>
        options = list(d.names[n].keys())<font></font>
        <span class="hljs-keyword">if</span> len(options) == <span class="hljs-number">1</span>:
            <span class="hljs-keyword">if</span> options[<span class="hljs-number">0</span>] == <span class="hljs-string">'male'</span>:<font></font>
                male_names.append(n)<font></font>
            <span class="hljs-keyword">if</span> options[<span class="hljs-number">0</span>] == <span class="hljs-string">'female'</span>:<font></font>
                female_names.append(n)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gefunden 7 091 m√§nnliche Namen und 5 054 weibliche. </font><font style="vertical-align: inherit;">Wenden Sie die Transformation an:</font></font><br>
<br>
<pre><code class="python hljs">tofixm = ar[ar[<span class="hljs-string">'fn'</span>].isin(male_names)]<font></font>
ar.loc[tofixm.index, <span class="hljs-string">'sex'</span>] = <span class="hljs-string">'M'</span>
tofixf = ar[ar[<span class="hljs-string">'fn'</span>].isin(female_names)]<font></font>
ar.loc[tofixf.index, <span class="hljs-string">'sex'</span>] = <span class="hljs-string">'F'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir schauen uns das Ergebnis an:</font></font><br>
<br>
<pre><code class="python hljs">ar[ar[<span class="hljs-string">'sex'</span>]!=ar[<span class="hljs-string">'sex raw'</span>]]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
30.352 Eintr√§ge korrigiert (zusammen mit der Korrektur durch den Namen der Gruppe). </font><font style="vertical-align: inherit;">Wie √ºblich 10 zuf√§llige: Nachdem </font><font style="vertical-align: inherit;">wir sicher sind, dass wir das Geschlecht korrekt identifiziert haben, werden wir auch Standardgruppen in Einklang bringen. </font><font style="vertical-align: inherit;">Mal sehen, wo sie nicht √ºbereinstimmen:</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th><u>sex</u></th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>...</th>
<th>country raw</th>
<th>group raw</th>
<th><u>sex raw</u></th>
<th>grflc</th>
</tr>
<tr>
<td>...</td>
<td>37</td>
<td><u>F</u></td>
<td>Pilz Christiane</td>
<td>DEU</td>
<td>FPRO</td>
<td>...</td>
<td>GER</td>
<td>FPRO</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>92</td>
<td><u>F</u></td>
<td>Brault Sarah-Anne</td>
<td>CAN</td>
<td>FPRO</td>
<td>...</td>
<td>CAN</td>
<td>FPRO</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>96</td>
<td><u>F</u></td>
<td>Murphy Susanna</td>
<td>IRL</td>
<td>FPRO</td>
<td>...</td>
<td>IRL</td>
<td>FPRO</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>105</td>
<td><u>F</u></td>
<td>Spoelder Romy</td>
<td>NLD</td>
<td></td>
<td>...</td>
<td>NED</td>
<td>FJUNIOR</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>424</td>
<td><u>M</u></td>
<td>Watson Tom</td>
<td>GBR</td>
<td>M40-44</td>
<td>...</td>
<td>GBR</td>
<td>M40-44</td>
<td><u>F</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>81</td>
<td><u>F</u></td>
<td>Morel Charlotte</td>
<td>FRA</td>
<td></td>
<td>...</td>
<td>FRA</td>
<td>FJUNIOR</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>65</td>
<td><u>F</u></td>
<td>Selekhova Olga</td>
<td>RUS</td>
<td></td>
<td>...</td>
<td>RUS</td>
<td>FU23</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>166</td>
<td><u>F</u></td>
<td>Keat Rebekah</td>
<td>AUS</td>
<td></td>
<td>...</td>
<td>AUS</td>
<td>FJUNIOR</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>119</td>
<td><u>F</u></td>
<td>Eim Nina</td>
<td>DEU</td>
<td></td>
<td>...</td>
<td>GER</td>
<td>FQUAL‚Ä¶</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>73</td>
<td><u>F</u></td>
<td>Sukhoruchenkova Evgenia</td>
<td>RUS</td>
<td>FPRO</td>
<td>...</td>
<td>RUS</td>
<td>FPRO</td>
<td><u>M</u></td>
<td>F</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'gfl'</span>] = ar[<span class="hljs-string">'group'</span>].str[<span class="hljs-number">0</span>]<font></font>
gncws = ar[(ar[<span class="hljs-string">'sex'</span>] != ar[<span class="hljs-string">'gfl'</span>]) &amp; (ar[<span class="hljs-string">'group'</span>]!=<span class="hljs-string">''</span>)]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4.248 Eintr√§ge. </font><font style="vertical-align: inherit;">Ersetzen Sie den ersten Buchstaben:</font></font><br>
<br>
<pre><code class="python hljs">ar.loc[gncws.index, <span class="hljs-string">'group'</span>] = ar.loc[gncws.index, <span class="hljs-string">'sex'</span>] + ar.loc[gncws.index, <span class="hljs-string">'group'</span>].str[<span class="hljs-number">1</span>:].index, <span class="hljs-string">'sex'</span>]
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th><u>sex</u></th>
<th>name</th>
<th>country</th>
<th><u>group</u></th>
<th>...</th>
<th>country raw</th>
<th><u>group raw</u></th>
<th>sex raw</th>
</tr>
<tr>
<td>...</td>
<td>803</td>
<td><u>F</u></td>
<td>Kenney Joelle</td>
<td>USA</td>
<td><u>F35-39</u></td>
<td>...</td>
<td>USA</td>
<td><u>M35-39</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>1432</td>
<td><u>M</u></td>
<td>Holmberg Henriette Gorm</td>
<td>DNK</td>
<td><u>M45-49</u></td>
<td>...</td>
<td>DEN</td>
<td><u>F45-49</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>503</td>
<td><u>M</u></td>
<td>Tai Oy Leen</td>
<td>MYS</td>
<td><u>M40-44</u></td>
<td>...</td>
<td>MAS</td>
<td><u>F40-44</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>236</td>
<td><u>F</u></td>
<td>Dissanayake Aruna</td>
<td>LKA</td>
<td><u>F25-29</u></td>
<td>...</td>
<td>SRI</td>
<td><u>M25-29</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>1349</td>
<td><u>F</u></td>
<td>Delos Reyes Joshua Rafaelle</td>
<td>PHL</td>
<td><u>F18-24</u></td>
<td>...</td>
<td>PHI</td>
<td><u>M18-24</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>543</td>
<td><u>F</u></td>
<td>Vandekendelaere Janique</td>
<td>BEL</td>
<td><u>F50-54</u></td>
<td>...</td>
<td>BEL</td>
<td><u>M50-54</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>1029</td>
<td><u>M</u></td>
<td>Provost Shaun</td>
<td>USA</td>
<td><u>M25-29</u></td>
<td>...</td>
<td>USA</td>
<td><u>F25-29</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>303</td>
<td><u>F</u></td>
<td>Torrens Vadell Macia</td>
<td>ESP</td>
<td><u>F30-34</u></td>
<td>...</td>
<td>ESP</td>
<td><u>M30-34</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>1338</td>
<td><u>F</u></td>
<td>Suarez Renan</td>
<td>BOL</td>
<td><u>F35-39</u></td>
<td>...</td>
<td>BOL</td>
<td><u>M35-39</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>502</td>
<td><u>F</u></td>
<td>Everlo Linda</td>
<td>NLD</td>
<td><u>F30-34</u></td>
<td>...</td>
<td>NED</td>
<td><u>M30-34</u></td>
<td>M</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wahrscheinlich haben sich die Korrekturen irgendwo als falsch herausgestellt, aber jeder denkt fr√ºh, dass er mehr Gutes als Schaden angerichtet hat. </font><font style="vertical-align: inherit;">F√ºr die Statistik ist dies wichtig. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das war's mit der Wiederherstellung des Sex. </font><font style="vertical-align: inherit;">Wir l√∂schen die Arbeitsspalten, √ºbersetzen in das W√∂rterbuch und speichern.</font></font><br>
<br>
<pre><code class="python hljs">pkl.dump(rd, open(<span class="hljs-string">r'D:\tri\details8.pkl'</span>, <span class="hljs-string">'wb'</span>))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das ist alles mit der Wiederherstellung unvollst√§ndiger Daten.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bulletin Update</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die √úbersichtstabelle muss noch mit aktualisierten Daten zur Anzahl der M√§nner und Frauen usw. aktualisiert werden. </font></font><br>
<br>
<pre><code class="python hljs">rs[<span class="hljs-string">'total raw'</span>] = rs[<span class="hljs-string">'total'</span>]<font></font>
rs[<span class="hljs-string">'males raw'</span>] = rs[<span class="hljs-string">'males'</span>]<font></font>
rs[<span class="hljs-string">'females raw'</span>] = rs[<span class="hljs-string">'females'</span>]<font></font>
rs[<span class="hljs-string">'rus raw'</span>] = rs[<span class="hljs-string">'rus'</span>]<font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> rs.index:<font></font>
    e = rs.loc[i,<span class="hljs-string">'event'</span>]<font></font>
    rs.loc[i,<span class="hljs-string">'total'</span>] = len(rd[e])<font></font>
    rs.loc[i,<span class="hljs-string">'males'</span>] = len(rd[e][rd[e][<span class="hljs-string">'sex'</span>] == <span class="hljs-string">'M'</span>])<font></font>
    rs.loc[i,<span class="hljs-string">'females'</span>] = len(rd[e][rd[e][<span class="hljs-string">'sex'</span>] == <span class="hljs-string">'F'</span>])<font></font>
    rs.loc[i,<span class="hljs-string">'rus'</span>] = len(rd[e][rd[e][<span class="hljs-string">'country'</span>] == <span class="hljs-string">'RUS'</span>])<font></font>
<font></font>
len(rs[rs[<span class="hljs-string">'total'</span>] != rs[<span class="hljs-string">'total raw'</span>]])</code></pre><br>
<code><b>Out:</b> 288<br>
</code><br>
<br>
<pre><code class="python hljs">len(rs[rs[<span class="hljs-string">'males'</span>] != rs[<span class="hljs-string">'males raw'</span>]])
</code></pre><br>
<code><b>Out:</b>962<br>
</code><br>
<br>
<pre><code class="python hljs">len(rs[rs[<span class="hljs-string">'females'</span>] != rs[<span class="hljs-string">'females raw'</span>]])
</code></pre><br>
<code><b>Out:</b> 836<br>
</code><br>
<br>
<pre><code class="python hljs">len(rs[rs[<span class="hljs-string">'rus'</span>] != rs[<span class="hljs-string">'rus raw'</span>]])
</code></pre><br>
<code><b>Out:</b> 8<br>
</code><br>
<br>
<pre><code class="python hljs">pkl.dump(rs, open(<span class="hljs-string">r'D:\tri\summary6.pkl'</span>, <span class="hljs-string">'wb'</span>))
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teil 4. Probenahme</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt ist der Triathlon sehr beliebt. </font><font style="vertical-align: inherit;">W√§hrend der Saison gibt es viele offene Wettk√§mpfe, an denen eine gro√üe Anzahl von Athleten, haupts√§chlich Amateure, teilnehmen. </font><font style="vertical-align: inherit;">Das war aber nicht immer so. </font><font style="vertical-align: inherit;">Unsere Daten enthalten seit 1990 Aufzeichnungen. </font><font style="vertical-align: inherit;">Beim Durchbl√§ttern von tristats.ru habe ich festgestellt, dass es in den letzten Jahren viel mehr Rennen gibt und in den ersten nur sehr wenige. </font><font style="vertical-align: inherit;">Aber jetzt, da unsere Daten vorbereitet wurden, k√∂nnen Sie sie genauer betrachten.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zehn Jahre</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Z√§hlen Sie die Anzahl der Rennen und Finisher pro Jahr:</font></font><br>
<br>
<pre><code class="python hljs">rs[<span class="hljs-string">'year'</span>] = pd.DatetimeIndex(rs[<span class="hljs-string">'date'</span>]).year<font></font>
years = range(rs[<span class="hljs-string">'year'</span>].min(),rs[<span class="hljs-string">'year'</span>].max())<font></font>
rsy = pd.DataFrame(columns = [<span class="hljs-string">'races'</span>, <span class="hljs-string">'finishers'</span>, <span class="hljs-string">'rus'</span>, <span class="hljs-string">'RUS'</span>], index = years) <span class="hljs-comment">#rsy ‚Äì races summary by year</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> rsy.index:<font></font>
    rsy.loc[y,<span class="hljs-string">'races'</span>] = len(rs[rs[<span class="hljs-string">'year'</span>] == y])<font></font>
    rsy.loc[y,<span class="hljs-string">'finishers'</span>] = sum(rs[rs[<span class="hljs-string">'year'</span>] == y][<span class="hljs-string">'total'</span>])<font></font>
    rsy.loc[y,<span class="hljs-string">'rus'</span>] =  sum(rs[rs[<span class="hljs-string">'year'</span>] == y][<span class="hljs-string">'rus'</span>])<font></font>
    rsy.loc[y,<span class="hljs-string">'RUS'</span>] = len(rs[(rs[<span class="hljs-string">'year'</span>] == y)&amp;(rs[<span class="hljs-string">'country'</span>] == <span class="hljs-string">'RUS'</span>)])
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>year</th>
<th>races</th>
<th>finishers</th>
<th>rus</th>
<th>RUS</th>
</tr>
<tr>
<td>1990</td>
<td>1</td>
<td>286</td>
<td>5</td>
<td>0</td>
</tr>
<tr>
<td>1991</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>1992</td>
<td>1</td>
<td>317</td>
<td>3</td>
<td>0</td>
</tr>
<tr>
<td>1993</td>
<td>2</td>
<td>887</td>
<td>3</td>
<td>0</td>
</tr>
<tr>
<td>1994</td>
<td>2</td>
<td>128</td>
<td>3</td>
<td>0</td>
</tr>
<tr>
<td>1995</td>
<td>3</td>
<td>731</td>
<td>7</td>
<td>0</td>
</tr>
<tr>
<td>1996</td>
<td>3</td>
<td>776</td>
<td>6</td>
<td>0</td>
</tr>
<tr>
<td>1997</td>
<td>3</td>
<td>403</td>
<td>11</td>
<td>0</td>
</tr>
<tr>
<td>1998</td>
<td>4</td>
<td>583</td>
<td>21</td>
<td>0</td>
</tr>
<tr>
<td>1999</td>
<td>10</td>
<td>1106</td>
<td>26</td>
<td>0</td>
</tr>
<tr>
<td>2000</td>
<td>10</td>
<td>1231</td>
<td>29</td>
<td>0</td>
</tr>
<tr>
<td>2001</td>
<td>11</td>
<td>1992</td>
<td>32</td>
<td>0</td>
</tr>
<tr>
<td>2002</td>
<td>21</td>
<td>2249</td>
<td>100</td>
<td>0</td>
</tr>
<tr>
<td>2003</td>
<td>30</td>
<td>3152</td>
<td>158</td>
<td>0</td>
</tr>
<tr>
<td>2004</td>
<td>19</td>
<td>5488</td>
<td>128</td>
<td>1</td>
</tr>
<tr>
<td>2005</td>
<td>16</td>
<td>3024</td>
<td>244</td>
<td>1</td>
</tr>
<tr>
<td>2006</td>
<td>29</td>
<td>6210</td>
<td>369</td>
<td>1</td>
</tr>
<tr>
<td>2007</td>
<td>44</td>
<td>12153</td>
<td>444</td>
<td>1</td>
</tr>
<tr>
<td>2008</td>
<td>43</td>
<td>13830</td>
<td>369</td>
<td>1</td>
</tr>
<tr>
<td>2009</td>
<td>49</td>
<td>27047</td>
<td>478</td>
<td>1</td>
</tr>
<tr>
<td>2010</td>
<td>47</td>
<td>26528</td>
<td>366</td>
<td>1</td>
</tr>
<tr>
<td>2011</td>
<td>77</td>
<td>45412</td>
<td>848</td>
<td>5</td>
</tr>
<tr>
<td>2012</td>
<td>96</td>
<td>75590</td>
<td>1055</td>
<td>4</td>
</tr>
<tr>
<td>2013</td>
<td>98</td>
<td>86617</td>
<td>2165</td>
<td>9</td>
</tr>
<tr>
<td>2014</td>
<td>135</td>
<td>138018</td>
<td>3188</td>
<td>11</td>
</tr>
<tr>
<td>2015</td>
<td>164</td>
<td>172375</td>
<td>4846</td>
<td>15</td>
</tr>
<tr>
<td>2016</td>
<td>192</td>
<td>178630</td>
<td>7541</td>
<td>27</td>
</tr>
<tr>
<td>2017</td>
<td>238</td>
<td>185473</td>
<td>8825</td>
<td>42</td>
</tr>
<tr>
<td>2018</td>
<td>278</td>
<td>203031</td>
<td>10954</td>
<td>54</td>
</tr>
<tr>
<td>2019</td>
<td>293</td>
<td>220901</td>
<td>13354</td>
<td>59</td>
</tr>
</tbody></table></div></code><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RUS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Rennen in Russland. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rus</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Finisher aus Russland. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So sieht es auf einem Diagramm aus:</font></font><br>
<img src="https://habrastorage.org/webt/nx/yg/4s/nxyg4syvd0x-0f16nxl1ucvhyma.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist ersichtlich, dass die Anzahl der Rennen und Teilnehmer zu Beginn und am Ende des Zeitraums einfach nicht vergleichbar ist. Ein deutlicher Anstieg der Gesamtzahl der Rennen beginnt im Jahr 2011, w√§hrend die Anzahl der Starts in Russland ebenfalls zunimmt. Dar√ºber hinaus ist bereits 2009 ein Anstieg der Teilnehmerzahl zu beobachten. Dies kann auf ein erh√∂htes Interesse der Teilnehmer hinweisen, dh auf eine erh√∂hte Nachfrage, wonach zwei Jahre sp√§ter das Angebot, dh die Anzahl der Starts, zunahm. Vergessen Sie jedoch nicht, dass die Daten m√∂glicherweise nicht vollst√§ndig sind und einige und m√∂glicherweise viele Rennen fehlen. Einschlie√ülich aufgrund der Tatsache, dass das Projekt zur Erfassung dieser Daten erst im Jahr 2010 begann, was auch den bedeutenden Sprung in der Grafik in diesem Moment erkl√§ren kann. Daher habe ich mich zur weiteren Analyse entschlossen, die letzten 10 Jahre zu nehmen. Dies ist eine ziemlich lange Zeit,Um Trends √ºber mehrere Jahre hinweg zu verfolgen, obwohl sie kurz genug sind, um nicht dorthin zu gelangen, haupts√§chlich professionelle Wettbewerbe aus den 90er und fr√ºhen 2000er Jahren.</font></font><br>
<br>
<pre><code class="python hljs">rs = rs[(rs[<span class="hljs-string">'year'</span>]&gt;=<span class="hljs-number">2010</span>)&amp;(rs[<span class="hljs-string">'year'</span>]&lt;= <span class="hljs-number">2019</span>)]
</code></pre><br>
<img src="https://habrastorage.org/webt/ck/p4/qf/ckp4qfjucrjhl7kvu-0fyv_ilbc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im ausgew√§hlten Zeitraum fielen √ºbrigens 84% ‚Äã‚Äãder Rennen und 94% der Finisher.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amateur startet</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die √ºberwiegende Mehrheit der Teilnehmer an den ausgew√§hlten Starts sind Amateursportler, sodass gute Statistiken von ihnen erhalten werden k√∂nnen. Ehrlich gesagt war dies f√ºr mich von gr√∂√ütem Interesse, da ich selbst an solchen Starts teilnehme, aber im Level ist es sehr weit von den Olympiasiegern entfernt. Im ausgew√§hlten Zeitraum fanden nat√ºrlich auch professionelle Wettbewerbe statt. Um die Indikatoren f√ºr Amateur- und Profirennen nicht zu mischen, wurde beschlossen, letztere nicht mehr zu ber√ºcksichtigen. Wie identifiziere ich sie? Nach Geschwindigkeit. Wir berechnen sie. In einer der ersten Phasen der Datenaufbereitung haben wir bereits festgestellt, welche Art von Distanz bei jedem Rennen vorhanden ist - Sprint, Olympia, Halb, Eisen. F√ºr jeden von ihnen ist der Kilometerstand der Etappen klar definiert - Schwimmen, Radfahren und Laufen. Dies sind 0,75 + 20 + 5 f√ºr den Sprint, 1,5 + 40 + 10 f√ºr die Olympischen Spiele, 1,9 + 90 + 21,1 f√ºr die H√§lfte und 3.8 + 180 + 42,2 f√ºr Eisen. Nat√ºrlich k√∂nnen die realen Zahlen f√ºr jeden Typ von Rennen zu Rennen bedingt bis zu einem Prozent variieren, aber es gibt keine Informationen dar√ºber, daher gehen wir davon aus, dass alles korrekt war.</font></font><br>
<br>
<pre><code class="python hljs">rs[<span class="hljs-string">'km'</span>] = <span class="hljs-string">''</span><font></font>
<font></font>
rs.loc[rs[<span class="hljs-string">'dist'</span>] == <span class="hljs-string">'sprint'</span>, <span class="hljs-string">'km'</span>] = <span class="hljs-number">0.75</span>+<span class="hljs-number">20</span>+<span class="hljs-number">5</span>
rs.loc[rs[<span class="hljs-string">'dist'</span>] == <span class="hljs-string">'olympic'</span>, <span class="hljs-string">'km'</span>] = <span class="hljs-number">1.5</span>+<span class="hljs-number">40</span>+<span class="hljs-number">10</span>
rs.loc[rs[<span class="hljs-string">'dist'</span>] == <span class="hljs-string">'half'</span>, <span class="hljs-string">'km'</span>] = <span class="hljs-number">1.9</span>+<span class="hljs-number">90</span>+<span class="hljs-number">21.1</span>
rs.loc[rs[<span class="hljs-string">'dist'</span>] == <span class="hljs-string">'full'</span>, <span class="hljs-string">'km'</span>] = <span class="hljs-number">3.8</span>+<span class="hljs-number">180</span>+<span class="hljs-number">42.2</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir berechnen die Durchschnitts- und H√∂chstgeschwindigkeit f√ºr jedes Rennen. </font><font style="vertical-align: inherit;">Das Maximum bezieht sich hier auf die Durchschnittsgeschwindigkeit des Athleten, der den ersten Platz gewonnen hat.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> index, row <span class="hljs-keyword">in</span> rs.iterrows():<font></font>
    e = row[<span class="hljs-string">'event'</span>]<font></font>
    rd[e][<span class="hljs-string">'th'</span>] = pd.TimedeltaIndex(rd[e][<span class="hljs-string">'result'</span>]).seconds/<span class="hljs-number">3600</span>
    rd[e][<span class="hljs-string">'v'</span>] = rs.loc[i, <span class="hljs-string">'km'</span>] / rd[e][<span class="hljs-string">'th'</span>]<font></font>
<font></font>
<span class="hljs-keyword">for</span> index, row <span class="hljs-keyword">in</span> rs.iterrows():<font></font>
    e = row[<span class="hljs-string">'event'</span>]<font></font>
    rs.loc[index,<span class="hljs-string">'vmax'</span>] = rd[e][<span class="hljs-string">'v'</span>].max()<font></font>
    rs.loc[index,<span class="hljs-string">'vavg'</span>] = rd[e][<span class="hljs-string">'v'</span>].mean()
</code></pre><br>
<img src="https://habrastorage.org/webt/81/6k/pe/816kpel94nzs-hsp9dphfdhtq3g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun, Sie k√∂nnen sehen, dass der Gro√üteil der Geschwindigkeiten in Haufen zwischen etwa 15 km / h und 30 km / h gesammelt wird, aber es gibt eine bestimmte Anzahl vollst√§ndig "kosmischer" Werte. </font><font style="vertical-align: inherit;">Sortieren Sie nach Durchschnittsgeschwindigkeit und sehen Sie, wie viele davon:</font></font><br>
<br>
<pre><code class="python hljs">rs = rs.sort_values(by=<span class="hljs-string">'vavg'</span>)
</code></pre><br>
<img src="https://habrastorage.org/webt/aa/wi/ws/aawiwsx0kcmhzyq3y3ezcm_fy0o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier haben wir die Skala ge√§ndert und k√∂nnen den Bereich genauer absch√§tzen. Bei Durchschnittsgeschwindigkeiten liegt sie zwischen 17 km / h und 27 km / h, bei H√∂chstgeschwindigkeiten zwischen 18 km / h und 32 km / h. Au√üerdem gibt es ‚ÄûSchw√§nze‚Äú mit sehr niedrigen und sehr hohen Durchschnittsgeschwindigkeiten. Niedrige Geschwindigkeiten entsprechen h√∂chstwahrscheinlich extremen Wettk√§mpfen wie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Norseman</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , und hohe </font><font style="vertical-align: inherit;">Geschwindigkeiten </font><font style="vertical-align: inherit;">k√∂nnen im Fall eines abgebrochenen Schwimmens auftreten, bei dem anstelle eines Sprints ein Supersprint stattfand oder einfach fehlerhafte Daten. Ein weiterer wichtiger Punkt ist der sanfte Schritt im </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1200-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bereich </font><font style="vertical-align: inherit;">entlang der </font><i><font style="vertical-align: inherit;">X-</font></i><font style="vertical-align: inherit;"> Achse</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und h√∂here Werte der Durchschnittsgeschwindigkeit danach. </font><font style="vertical-align: inherit;">Dort sehen Sie einen deutlich geringeren Unterschied zwischen Durchschnitts- und H√∂chstgeschwindigkeit als in den ersten zwei Dritteln des Diagramms. </font><font style="vertical-align: inherit;">Anscheinend ist dies ein professioneller Wettbewerb. </font><font style="vertical-align: inherit;">Um sie klarer zu unterscheiden, berechnen wir das Verh√§ltnis von H√∂chstgeschwindigkeit zu Durchschnitt. </font><font style="vertical-align: inherit;">Bei professionellen Wettbewerben, bei denen es keine zuf√§lligen Personen gibt und alle Teilnehmer eine sehr hohe k√∂rperliche Fitness haben, sollte dieses Verh√§ltnis minimal sein.</font></font><br>
<br>
<pre><code class="python hljs">rs[<span class="hljs-string">'vmdbva'</span>] = rs[<span class="hljs-string">'vmax'</span>]/rs[<span class="hljs-string">'vavg'</span>] <span class="hljs-comment">#vmdbva - v max divided by v avg</span>
rs = rs.sort_values(by=<span class="hljs-string">'vmdbva'</span>)
</code></pre><br>
<img src="https://habrastorage.org/webt/li/cv/pr/licvprwpcx3zlws5pjufo0dxhcm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In dieser Grafik f√§llt das erste Quartal sehr deutlich auf: Das Verh√§ltnis von H√∂chstgeschwindigkeit zu Durchschnitt ist klein, hohe Durchschnittsgeschwindigkeit, eine kleine Anzahl von Teilnehmern. </font><font style="vertical-align: inherit;">Dies ist ein professioneller Wettbewerb. </font><font style="vertical-align: inherit;">Der Schritt auf der gr√ºnen Kurve liegt irgendwo bei 1,2. </font><font style="vertical-align: inherit;">Wir werden in unserer Stichprobe nur Datens√§tze mit einem Verh√§ltniswert gr√∂√üer als 1,2 belassen.</font></font><br>
<br>
<pre><code class="python hljs">rs = rs[rs[<span class="hljs-string">'vmdbva'</span>] &gt; <span class="hljs-number">1.2</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir entfernen auch Datens√§tze mit atypisch niedrigen und hohen Geschwindigkeiten. </font><font style="vertical-align: inherit;">In </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was sind die Triathlon-Weltrekorde f√ºr jede Distanz? </font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ver√∂ffentlichte Rekordzeiten f√ºr das √úberqueren verschiedener Entfernungen f√ºr 2019. </font><font style="vertical-align: inherit;">Wenn Sie sie mit mittlerer Geschwindigkeit z√§hlen, k√∂nnen Sie sehen, dass sie selbst f√ºr die schnellsten nicht h√∂her als 33 km / h sein kann. </font><font style="vertical-align: inherit;">Daher werden wir die Protokolle ber√ºcksichtigen, bei denen die Durchschnittsgeschwindigkeiten h√∂her und ung√ºltig sind, und sie aus der Betrachtung entfernen.</font></font><br>
<br>
<pre><code class="python hljs">rs = rs[(rs[<span class="hljs-string">'vavg'</span>] &gt; <span class="hljs-number">17</span>)&amp;(rs[<span class="hljs-string">'vmax'</span>] &lt; <span class="hljs-number">33</span>)]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Folgendes bleibt: </font></font><br>
<img src="https://habrastorage.org/webt/t1/dk/_p/t1dk_pixaznwxlfsunkxpx5yfum.png"><br>
<img src="https://habrastorage.org/webt/qk/9u/4a/qk9u4anxmpnwehsdhckfn64ucvw.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt sieht alles ziemlich homogen aus und wirft keine Fragen auf. </font><font style="vertical-align: inherit;">Infolge all dieser Auswahl haben wir 777 der Protokolle von 1922 oder 40% verloren. </font><font style="vertical-align: inherit;">Gleichzeitig ging die Gesamtzahl der Finisher nicht so stark zur√ºck - nur um 13%. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es sind also noch 1.145 Rennen mit 1.231.772 Finishern √ºbrig. </font><font style="vertical-align: inherit;">Diese Probe wurde zum Material f√ºr meine Analyse und Visualisierung.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teil 5. Analyse und Visualisierung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In dieser Arbeit waren die eigentliche Analyse und Visualisierung die einfachsten Teile. </font><font style="vertical-align: inherit;">Die Spitze des Eisbergs, dessen Unterwasserteil nur die Aufbereitung der Daten war. </font><font style="vertical-align: inherit;">Die Analyse war in der Tat eine einfache arithmetische Operation f√ºr die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pandas-Reihe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Berechnung von Durchschnittswerten, Filterung - all dies wird von den elementaren </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pandas-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Werkzeugen durchgef√ºhrt, </font><font style="vertical-align: inherit;">und der obige Code enth√§lt viele Beispiele. </font><font style="vertical-align: inherit;">Die Visualisierung erfolgte wiederum haupts√§chlich mit der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Standard-Matplotlib</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Gebrauchte </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Handlung, Bar, Kuchen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">An einigen Stellen musste ich jedoch bei Datumsangaben und Piktogrammen an den Signaturen der Achsen basteln, aber dies ist hier nicht eine detaillierte Beschreibung. </font><font style="vertical-align: inherit;">Das einzige, wor√ºber man sprechen sollte, ist die Pr√§sentation von Geodaten. </font><font style="vertical-align: inherit;">Zumindest ist es nicht</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matplotlib</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geodaten</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr jedes Rennen haben wir Informationen √ºber den Austragungsort. </font><font style="vertical-align: inherit;">Zu Beginn haben </font><font style="vertical-align: inherit;">wir </font><font style="vertical-align: inherit;">mithilfe von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geopy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> die Koordinaten f√ºr jeden Standort berechnet. </font><font style="vertical-align: inherit;">Viele Rennen finden j√§hrlich am selben Ort statt. </font><font style="vertical-align: inherit;">
Ein sehr praktisches Werkzeug zum Rendern von Geodaten in </font><i><font style="vertical-align: inherit;">Python</font></i><font style="vertical-align: inherit;"> ist </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><i><font style="vertical-align: inherit;">Folium</font></i></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">So funktioniert das:</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th>date</th>
<th>country</th>
<th><u>latitude</u></th>
<th><u>longitude</u></th>
<th>loc</th>
<th>‚Ä¶</th>
</tr>
<tr>
<td>0</td>
<td>Ironman Indian Wells La Quinta 70.3 2019</td>
<td>2019-12-08</td>
<td>USA</td>
<td><u>33.7238</u></td>
<td><u>-116.305</u></td>
<td>Indian Wells/La Quinta, California, USA</td>
<td>‚Ä¶</td>
</tr>
<tr>
<td>1</td>
<td>Ironman Taupo 70.3 2019</td>
<td>2019-12-07</td>
<td>NZL</td>
<td><u>-41.5001</u></td>
<td><u>172.834</u></td>
<td>New Zealand</td>
<td>‚Ä¶</td>
</tr>
<tr>
<td>2</td>
<td>Ironman Western Australia 2019</td>
<td>2019-12-01</td>
<td>AUS</td>
<td><u>-33.6445</u></td>
<td><u>115.349</u></td>
<td>Busselton, Western Australia</td>
<td>‚Ä¶</td>
</tr>
<tr>
<td>3</td>
<td>Ironman Mar del Plata 2019</td>
<td>2019-12-01</td>
<td>ARG</td>
<td><u>-37.9977</u></td>
<td><u>-57.5483</u></td>
<td>Mar del Plata, Argentina</td>
<td>‚Ä¶</td>
</tr>
<tr>
<td>4</td>
<td>Ironman Cozumel 2019</td>
<td>2019-11-24</td>
<td>MEX</td>
<td><u>20.4318</u></td>
<td><u>-86.9203</u></td>
<td>Cozumel, Mexico</td>
<td>‚Ä¶</td>
</tr>
<tr>
<td>5</td>
<td>Ironman Arizona 2019</td>
<td>2019-11-24</td>
<td>USA</td>
<td><u>33.4255</u></td>
<td><u>-111.94</u></td>
<td>Tempe, Arizona, USA</td>
<td>‚Ä¶</td>
</tr>
<tr>
<td>6</td>
<td>Ironman Xiamen 70.3 2019</td>
<td>2019-11-10</td>
<td>CHN</td>
<td><u>24.4758</u></td>
<td><u>118.075</u></td>
<td>Xiamen, China</td>
<td>‚Ä¶</td>
</tr>
<tr>
<td>7</td>
<td>Ironman Turkey 70.3 2019</td>
<td>2019-11-03</td>
<td>TUR</td>
<td><u>36.8633</u></td>
<td><u>31.0578</u></td>
<td>Belek, Antalya, Turkey</td>
<td>‚Ä¶</td>
</tr>
<tr>
<td>8</td>
<td>Ironman Florida 2019</td>
<td>2019-11-02</td>
<td>USA</td>
<td><u>30.1766</u></td>
<td><u>-85.8055</u></td>
<td>Panama City Beach, Florida, USA</td>
<td>‚Ä¶</td>
</tr>
<tr>
<td>9</td>
<td>Ironman Marrakech 70.3 2019</td>
<td>2019-10-27</td>
<td>MAR</td>
<td><u>31.6258</u></td>
<td><u>-7.98916</u></td>
<td>Marrakech, Morocco</td>
<td>‚Ä¶</td>
</tr>
<tr>
<td>10</td>
<td>Ironman Waco 70.3 2019</td>
<td>2019-10-27</td>
<td>USA</td>
<td><u>31.5493</u></td>
<td><u>-97.1467</u></td>
<td>Waco, Texas, USA</td>
<td>‚Ä¶</td>
</tr>
</tbody></table></div></code><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><i><font style="vertical-align: inherit;"></font></i></a><font style="vertical-align: inherit;"></font><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> folium<font></font>
<font></font>
m = folium.Map() <font></font>
folium.Marker([<span class="hljs-string">'55.7522200'</span>, <span class="hljs-string">'37.6155600'</span>], popup=<span class="hljs-string">''</span>).add_to(m)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und wir erhalten eine interaktive Karte direkt im Jupiter-Laptop. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jc/hp/fs/jchpfspvaahnnbvwtgwx2wqkppu.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun zu unseren Daten. </font><font style="vertical-align: inherit;">Zun√§chst beginnen wir eine neue Spalte mit einer Kombination unserer Koordinaten:</font></font><br>
<br>
<pre><code class="python hljs">rs[<span class="hljs-string">'coords'</span>] = rs[<span class="hljs-string">'latitude'</span>].astype(str) + <span class="hljs-string">', '</span> + rs[<span class="hljs-string">'longitude'</span>].astype(str)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die einzigartigen Koordinaten </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Koordinaten</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sind 291. Und die einzigartigen Orte </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">loc</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sind 324, was bedeutet , </font><font style="vertical-align: inherit;">dass einige Namen geringf√ºgig voneinander verschieden sind, w√§hrend zur gleichen Zeit , die </font><font style="vertical-align: inherit;">sie auf den gleichen Punkt entsprechen. </font><font style="vertical-align: inherit;">Es ist nicht be√§ngstigend, wir werden die Einzigartigkeit durch </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Koordinaten betrachten</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Wir berechnen, wie viele Ereignisse √ºber die gesamte Zeit an jedem Ort vergangen sind (mit eindeutigen Koordinaten):</font></font><br>
<br>
<pre><code class="python hljs">vc = rs[<span class="hljs-string">'coords'</span>].value_counts()<font></font>
<font></font>
vc</code></pre><br>
<code><b>Out:</b><br>
43.7009358, 7.2683912 22<br>
43.5854823, 39.723109 20<br>
29.03970805, -13.636291 16<br>
47.3723941, 8.5423328 16<br>
59.3110918, 24.420907 15<br>
51.0834196, 10.4234469 15<br>
54.7585694, 38.8818137 14<br>
20.4317585, -86.9202745 13<br>
52.3727598, 4.8936041 12<br>
41.6132925, 2.6576102 12<br>
... ...<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie nun eine Karte und f√ºgen Sie Markierungen in Form von Kreisen hinzu, deren Radius von der Anzahl der Ereignisse am Standort abh√§ngt. </font><font style="vertical-align: inherit;">F√ºgen Sie den Markierungen Markierungen mit Standortnamen hinzu.</font></font><br>
<br>
<pre><code class="python hljs">m = folium.Map(location=[<span class="hljs-number">25</span>,<span class="hljs-number">10</span>], zoom_start=<span class="hljs-number">2</span>)<font></font>
<font></font>
<span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> rs[<span class="hljs-string">'coords'</span>].unique():<font></font>
    row = [r[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> rs.iterrows() <span class="hljs-keyword">if</span> r[<span class="hljs-number">1</span>][<span class="hljs-string">'coords'</span>] == c][<span class="hljs-number">0</span>]    <font></font>
    folium.Circle([row[<span class="hljs-string">'latitude'</span>], row[<span class="hljs-string">'longitude'</span>]], <font></font>
					popup=(row[<span class="hljs-string">'location'</span>]+<span class="hljs-string">'\n('</span>+str(vc[c])+<span class="hljs-string">' races)'</span>), <font></font>
					radius = <span class="hljs-number">10000</span>*int(vc[c]), <font></font>
					color=<span class="hljs-string">'darkorange'</span>, <font></font>
					fill=<span class="hljs-literal">True</span>, <font></font>
					stroke=<span class="hljs-literal">True</span>, <font></font>
					weight=<span class="hljs-number">1</span>).add_to(m)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erledigt. </font><font style="vertical-align: inherit;">Sie k√∂nnen das Ergebnis sehen:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ch/d4/gj/chd4gj0qbyjrzyjikpmslgesw0i.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teilnehmer Fortschritt</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zus√§tzlich zur Anleitung war die Arbeit an einem weiteren Zeitplan nicht trivial. Dies ist das neueste Fortschrittsdiagramm der Teilnehmer. Hier ist es: </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/rf/ca/jq/rfcajquw4qluhsw9wuhicbgk7rm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie es uns analysieren, gleichzeitig werde ich den Code zum Rendern als Beispiel f√ºr die Verwendung von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matplotlib geben</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs">fig = plt.figure()<font></font>
fig.set_size_inches(<span class="hljs-number">10</span>, <span class="hljs-number">6</span>)<font></font>
<font></font>
ax = fig.add_axes([<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>])<font></font>
<font></font>
b = ax.bar(exp,numrecs, color = <span class="hljs-string">'navajowhite'</span>)<font></font>
<font></font>
ax1 = ax.twinx()<font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(exp_samp)):<font></font>
    ax1.plot(exp_samp[i], vproc_samp[i], <span class="hljs-string">'.'</span>)<font></font>
	<font></font>
p, = ax1.plot(exp, vpm, <span class="hljs-string">'o-'</span>,markersize=<span class="hljs-number">8</span>, linewidth=<span class="hljs-number">2</span>, color=<span class="hljs-string">'C0'</span>)<font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(exp)):
    <span class="hljs-keyword">if</span> i &lt; len(exp)<span class="hljs-number">-1</span> <span class="hljs-keyword">and</span> (vpm[i] &lt; vpm[i+<span class="hljs-number">1</span>]):<font></font>
        ax1.text(x = exp[i]+<span class="hljs-number">0.1</span>, y = vpm[i]<span class="hljs-number">-0.2</span>, s = <span class="hljs-string">'{0:3.1f}%'</span>.format(vpm[i]),size=<span class="hljs-number">12</span>)
    <span class="hljs-keyword">else</span>:<font></font>
        ax1.text(x = exp[i]+<span class="hljs-number">0.1</span>, y = vpm[i]+<span class="hljs-number">0.1</span>, s = <span class="hljs-string">'{0:3.1f}%'</span>.format(vpm[i]),size=<span class="hljs-number">12</span>)<font></font>
<font></font>
ax.legend((b,p), (<span class="hljs-string">' '</span>, <span class="hljs-string">''</span>),loc=<span class="hljs-string">'center right'</span>)<font></font>
ax.set_xlabel(<span class="hljs-string">'   '</span>)<font></font>
ax.set_ylabel(<span class="hljs-string">''</span>)<font></font>
ax1.set_ylabel(<span class="hljs-string">'%     '</span>)<font></font>
ax.set_xticks(np.arange(<span class="hljs-number">1</span>, <span class="hljs-number">11</span>, step=<span class="hljs-number">1</span>))<font></font>
ax.set_yticks(np.arange(<span class="hljs-number">0</span>, <span class="hljs-number">230000</span>, step=<span class="hljs-number">25000</span>))<font></font>
ax1.set_ylim(<span class="hljs-number">97.5</span>,<span class="hljs-number">103.5</span>)<font></font>
ax.yaxis.set_label_position(<span class="hljs-string">"right"</span>)<font></font>
ax.yaxis.tick_right()<font></font>
ax1.yaxis.set_label_position(<span class="hljs-string">"left"</span>)<font></font>
ax1.yaxis.tick_left()      <font></font>
<font></font>
plt.show()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun dar√ºber, wie die Daten f√ºr ihn berechnet wurden. </font><font style="vertical-align: inherit;">Zun√§chst mussten Sie die Namen der Teilnehmer ausw√§hlen, die mindestens zwei Rennen und in verschiedenen Kalenderjahren abgeschlossen haben und gleichzeitig keine Profis sind. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºllen Sie zun√§chst f√ºr jedes Protokoll eine neue Spalte mit dem Namen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datum aus</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , in der das Datum des Rennens angegeben ist. </font><font style="vertical-align: inherit;">Wir werden auch ein Jahr ab diesem Zeitpunkt ben√∂tigen, werden wir die S√§ule machen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jahr</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Da wir die Geschwindigkeit jedes Athleten im Verh√§ltnis zur Durchschnittsgeschwindigkeit im Rennen analysieren werden, berechnen wir diese Geschwindigkeit sofort in der neuen Spalte </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vproc</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - die Geschwindigkeit als Prozentsatz des Durchschnitts.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> index, row <span class="hljs-keyword">in</span> rs.iterrows():<font></font>
    e = row[<span class="hljs-string">'event'</span>]<font></font>
    rd[e][<span class="hljs-string">'date'</span>] = row[<span class="hljs-string">'date'</span>]<font></font>
    rd[e][<span class="hljs-string">'year'</span>] = row[<span class="hljs-string">'year'</span>]<font></font>
    rd[e][<span class="hljs-string">'vproc'</span>] = <span class="hljs-number">100</span> * rd[e][<span class="hljs-string">'v'</span>] / rd[e][<span class="hljs-string">'v'</span>].mean()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So sehen die Protokolle jetzt aus: </font><font style="vertical-align: inherit;">
Kombinieren Sie als N√§chstes alle Protokolle in einem einzigen Datenrahmen.</font></font><br>
<code>'   Sprint 2019'</code><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>...</th>
<th>th</th>
<th>v</th>
<th><u>date</u></th>
<th><u>year</u></th>
<th><u>vproc</u></th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td>Shalev Aleksey</td>
<td>RUS</td>
<td>...</td>
<td>1.161944</td>
<td>22.161128</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>130.666668</u></td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td>Nikolaev Artem</td>
<td>RUS</td>
<td>...</td>
<td>1.228611</td>
<td>20.958625</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>123.576458</u></td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td>Kuchierskiy Aleksandr</td>
<td>RUS</td>
<td>...</td>
<td>1.255556</td>
<td>20.508850</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>120.924485</u></td>
</tr>
<tr>
<td>3</td>
<td>4</td>
<td>F</td>
<td>Korchagina Mariya</td>
<td>RUS</td>
<td>...</td>
<td>1.297222</td>
<td>19.850107</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>117.040401</u></td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>M</td>
<td>Solodov Ivan</td>
<td>RUS</td>
<td>...</td>
<td>1.298056</td>
<td>19.837364</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>116.965263</u></td>
</tr>
<tr>
<td>5</td>
<td>6</td>
<td>M</td>
<td>Bukin Sergey</td>
<td>RUS</td>
<td>...</td>
<td>1.300278</td>
<td>19.803461</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>116.765365</u></td>
</tr>
<tr>
<td>6</td>
<td>7</td>
<td>M</td>
<td>Lavrentev Dmitriy</td>
<td>RUS</td>
<td>...</td>
<td>1.300278</td>
<td>19.803461</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>116.765365</u></td>
</tr>
<tr>
<td>7</td>
<td>8</td>
<td>M</td>
<td>Dolgov Petr</td>
<td>RUS</td>
<td>...</td>
<td>1.321667</td>
<td>19.482976</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>114.875719</u></td>
</tr>
<tr>
<td>8</td>
<td>9</td>
<td>M</td>
<td>Bezruchenko Mikhailn</td>
<td>RUS</td>
<td>...</td>
<td>1.345000</td>
<td>19.144981</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>112.882832</u></td>
</tr>
<tr>
<td>9</td>
<td>10</td>
<td>M</td>
<td>Ryazantsev Dmitriy</td>
<td>RUS</td>
<td>...</td>
<td>1.359444</td>
<td>18.941561</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>111.683423</u></td>
</tr>
<tr>
<td>10</td>
<td>11</td>
<td>M</td>
<td>Ibragimov Ramil</td>
<td>RUS</td>
<td>...</td>
<td>1.376389</td>
<td>18.708375</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>110.308511</u></td>
</tr>
</tbody></table></div></code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar = pd.concat(rd)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr jeden Teilnehmer hinterlassen wir in jedem Kalenderjahr nur einen Eintrag:</font></font><br>
<br>
<pre><code class="python hljs">ar1 = ar.drop_duplicates(subset = [<span class="hljs-string">'name'</span>,<span class="hljs-string">'year'</span>], keep=<span class="hljs-string">'first'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als n√§chstes finden wir aus allen eindeutigen Namen dieser Eintr√§ge diejenigen, die mindestens zweimal vorkommen:</font></font><br>
<br>
<pre><code class="python hljs">nvc = ar1[<span class="hljs-string">'name'</span>].value_counts()<font></font>
names = list(nvc[nvc &gt; <span class="hljs-number">1</span>].index)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt 219.890 von ihnen. Entfernen wir die Namen von Profisportlern aus dieser Liste:</font></font><br>
<br>
<pre><code class="python hljs">pro_names = ar[ar[<span class="hljs-string">'group'</span>].isin([<span class="hljs-string">'MPRO'</span>,<span class="hljs-string">'FPRO'</span>])][<span class="hljs-string">'name'</span>].unique()<font></font>
names = list(set(names) - set(pro_names))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sowie die Namen der Athleten, die vor 2010 mit dem Auftritt begonnen haben. </font><font style="vertical-align: inherit;">Laden Sie dazu die Daten hoch, die vor der Stichprobe in den letzten 10 Jahren gespeichert wurden. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F√ºgen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sie sie in die </font><i><font style="vertical-align: inherit;">Objekte rsa</font></i><font style="vertical-align: inherit;"> ( </font><i><font style="vertical-align: inherit;">Rassen√ºbersicht</font></i><font style="vertical-align: inherit;"> alle) und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rda</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font><i><font style="vertical-align: inherit;">Renndetails</font></i><font style="vertical-align: inherit;"> alle) ein.</font></font><br>
<br>
<pre><code class="python hljs">rdo = {} <font></font>
<font></font>
<span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> rda:    
    <span class="hljs-keyword">if</span> rsa[rsa[<span class="hljs-string">'event'</span>] == e][<span class="hljs-string">'year'</span>].iloc[<span class="hljs-number">0</span>] &lt; <span class="hljs-number">2010</span>:<font></font>
        rdo[e] = rda[e]<font></font>
<font></font>
aro = pd.concat(rdo)<font></font>
old_names = aro[<span class="hljs-string">'name'</span>].unique()<font></font>
names = list(set(names) - set(old_names))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und schlie√ülich finden wir Namen, die mehr als einmal am selben Tag vorkommen. </font><font style="vertical-align: inherit;">Daher minimieren wir das Vorhandensein vollst√§ndiger Namensvetter in unserer Stichprobe.</font></font><br>
<br>
<pre><code class="python hljs">namesakes = ar[ar.duplicated(subset = [<span class="hljs-string">'name'</span>,<span class="hljs-string">'date'</span>], keep = <span class="hljs-literal">False</span>)][<span class="hljs-string">'name'</span>].unique()<font></font>
names = list(set(names) - set(namesakes))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es sind also noch 198.075 Namen √ºbrig. </font><font style="vertical-align: inherit;">Aus dem gesamten Datensatz w√§hlen wir nur die Datens√§tze mit den gefundenen Namen aus:</font></font><br>
<br>
<pre><code class="python hljs">ars = ar[ar[<span class="hljs-string">'name'</span>].isin(names)] <span class="hljs-comment">#ars ‚Äì all recrds selected</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt m√ºssen Sie f√ºr jeden Rekord bestimmen, welchem ‚Äã‚ÄãJahr in der Karriere des Athleten er entspricht - dem ersten, zweiten, dritten oder zehnten. </font><font style="vertical-align: inherit;">Wir machen eine Schleife mit allen Namen und berechnen.</font></font><br>
<br>
<pre><code class="python hljs">ars[<span class="hljs-string">'exp'</span>] = <span class="hljs-string">''</span> <span class="hljs-comment">#exp ‚Äì experience, counted in years of racing, starts from 1.</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> names:    <font></font>
    ind = ars[ars[<span class="hljs-string">'name'</span>] == n].index <font></font>
    yos = ars.loc[ind, <span class="hljs-string">'year'</span>].min() <span class="hljs-comment">#yos ‚Äì year of start</span>
    ars.loc[ind, <span class="hljs-string">'exp'</span>] = ars.loc[ind, <span class="hljs-string">'year'</span>] - yos + <span class="hljs-number">1</span> 
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist ein Beispiel daf√ºr, was passiert ist: </font><font style="vertical-align: inherit;">
Anscheinend sind die Namensvetter immer noch geblieben. </font><font style="vertical-align: inherit;">Dies wird erwartet, ist aber nicht be√§ngstigend, da wir alles mitteln werden und es nicht so viele geben sollte. </font><font style="vertical-align: inherit;">Als n√§chstes erstellen wir Arrays f√ºr das Diagramm:</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>‚Ä¶</th>
<th>th</th>
<th>v</th>
<th>date</th>
<th><u>year</u></th>
<th>vproc</th>
<th><u>exp</u></th>
</tr>
<tr>
<td>‚Ä¶</td>
<td>633</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>RUS</td>
<td>M40-44</td>
<td>‚Ä¶</td>
<td>5.356111</td>
<td>21.097397</td>
<td>2014-08-31</td>
<td><u>2014</u></td>
<td>106.036879</td>
<td><u>1</u></td>
</tr>
<tr>
<td>‚Ä¶</td>
<td>302</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>RUS</td>
<td>M40-44</td>
<td>‚Ä¶</td>
<td>11.236389</td>
<td>20.113223</td>
<td>2015-08-30</td>
<td><u>2015</u></td>
<td>108.231254</td>
<td><u>2</u></td>
</tr>
<tr>
<td>‚Ä¶</td>
<td>522</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>RUS</td>
<td>M40-44</td>
<td>‚Ä¶</td>
<td>10.402778</td>
<td>21.724967</td>
<td>2016-07-17</td>
<td><u>2016</u></td>
<td>111.265107</td>
<td><u>3</u></td>
</tr>
<tr>
<td>‚Ä¶</td>
<td>25</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>RUS</td>
<td>M40-44</td>
<td>‚Ä¶</td>
<td>10.910833</td>
<td>20.713358</td>
<td>2017-09-23</td>
<td><u>2017</u></td>
<td>112.953644</td>
<td><u>4</u></td>
</tr>
<tr>
<td>‚Ä¶</td>
<td>23</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>RUS</td>
<td>M40-44</td>
<td>‚Ä¶</td>
<td>4.700000</td>
<td>24.042553</td>
<td>2017-06-03</td>
<td><u>2017</u></td>
<td>120.565211</td>
<td><u>4</u></td>
</tr>
<tr>
<td>‚Ä¶</td>
<td>42</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>RUS</td>
<td>M40-44</td>
<td>‚Ä¶</td>
<td>4.599167</td>
<td>24.569668</td>
<td>2018-06-17</td>
<td><u>2018</u></td>
<td>124.579862</td>
<td><u>5</u></td>
</tr>
<tr>
<td>‚Ä¶</td>
<td>90</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>NOR</td>
<td></td>
<td>‚Ä¶</td>
<td>14.069167</td>
<td>16.063496</td>
<td>2018-08-04</td>
<td><u>2018</u></td>
<td>100.001834</td>
<td><u>5</u></td>
</tr>
<tr>
<td>‚Ä¶</td>
<td>86</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>RUS</td>
<td>M45-49</td>
<td>‚Ä¶</td>
<td>9.820556</td>
<td>23.012955</td>
<td>2019-08-03</td>
<td><u>2019</u></td>
<td>118.375766</td>
<td><u>6</u></td>
</tr>
</tbody></table></div></code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">exp = [] <font></font>
vpm = [] <span class="hljs-comment">#vpm ‚Äì v proc mean</span>
numrecs = [] <span class="hljs-comment">#number of records</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(ars[<span class="hljs-string">'exp'</span>].min(), ars[<span class="hljs-string">'exp'</span>].max() + <span class="hljs-number">1</span>): <font></font>
    exp.append(x)<font></font>
    vpm.append(ars[ars[<span class="hljs-string">'exp'</span>] == x][<span class="hljs-string">'vproc'</span>].mean())<font></font>
    numrecs.append(len(ars[ars[<span class="hljs-string">'exp'</span>] == x]))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das war's, es gibt eine Basis: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/c4/_p/u6/c4_pu61ixkiscputxq1qhfm84eg.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um es nun mit Punkten zu dekorieren, die bestimmten Ergebnissen entsprechen, werden wir 1000 zuf√§llige Namen ausw√§hlen und Arrays mit den Ergebnissen f√ºr sie erstellen.</font></font><br>
<br>
<pre><code class="python hljs">names_samp = random.sample(names,<span class="hljs-number">1000</span>)<font></font>
ars_samp = ars[ars[<span class="hljs-string">'name'</span>].isin(names_samp)]<font></font>
<font></font>
ars_samp = ars_samp.reset_index(drop = <span class="hljs-literal">True</span>)<font></font>
exp_samp = []<font></font>
vproc_samp = []<font></font>
<font></font>
<span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> names_samp:<font></font>
    nr = ars_samp[ars_samp[<span class="hljs-string">'name'</span>] == n]<font></font>
    nr = nr.sort_values(<span class="hljs-string">'exp'</span>)<font></font>
    exp_samp.append(list(nr[<span class="hljs-string">'exp'</span>]))<font></font>
    vproc_samp.append(list(nr[<span class="hljs-string">'vproc'</span>]))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºgen Sie eine Schleife hinzu, um Diagramme aus dieser Zufallsstichprobe zu erstellen.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(exp_samp)):<font></font>
    ax1.plot(exp_samp[i], vproc_samp[i], <span class="hljs-string">'.'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt ist alles fertig: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uj/0h/ee/uj0hee9v0tujesawdjz41fmfp0u.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen ist es nicht schwierig. Es gibt jedoch ein Problem. Um die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exp-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Erfahrung </font><font style="vertical-align: inherit;">in einem Zyklus </font><font style="vertical-align: inherit;">zu berechnen, </font><i><font style="vertical-align: inherit;">ben√∂tigen</font></i><font style="vertical-align: inherit;"> alle Namen, die fast 200.000 sind, acht Stunden. Ich musste den Algorithmus f√ºr kleine Stichproben debuggen und dann die Berechnung f√ºr die Nacht ausf√ºhren. Im Prinzip kann dies einmal durchgef√ºhrt werden. Wenn Sie jedoch einen Fehler finden oder etwas √§ndern m√∂chten und ihn erneut nachz√§hlen m√ºssen, beginnt er sich zu belasten. Als ich am Abend einen Bericht ver√∂ffentlichen wollte, stellte sich heraus, dass es wieder notwendig war, alles noch einmal zu erz√§hlen. Das Warten bis zum Morgen war nicht Teil meiner Pl√§ne, und ich suchte nach einer M√∂glichkeit, die Berechnung zu beschleunigen. Beschlossen zu parallelisieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe irgendwo einen Weg gefunden, dies mit </font><i><font style="vertical-align: inherit;">Multiprocessing</font></i><font style="vertical-align: inherit;"> zu tun</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Um unter Windows arbeiten zu k√∂nnen, mussten wir die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hauptlogik</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> jeder parallelen Aufgabe in einer separaten </font><font style="vertical-align: inherit;">Datei </font><i><font style="vertical-align: inherit;">worker.py ablegen</font></i><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> pickle <span class="hljs-keyword">as</span> pkl<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">worker</span>(<span class="hljs-params">args</span>):</span>
    names = args[<span class="hljs-number">0</span>]<font></font>
    ars=args[<span class="hljs-number">1</span>]<font></font>
    num=args[<span class="hljs-number">2</span>]<font></font>
    ars = ars.sort_values(by=<span class="hljs-string">'name'</span>)<font></font>
    ars = ars.reset_index(drop=<span class="hljs-literal">True</span>)  <font></font>
<font></font>
    <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> names:   <font></font>
        ind = ars[ars[<span class="hljs-string">'name'</span>] == n].index <font></font>
        yos = ars.loc[ind, <span class="hljs-string">'year'</span>].min()<font></font>
        ars.loc[ind, <span class="hljs-string">'exp'</span>] = ars.loc[ind, <span class="hljs-string">'year'</span>] - yos + <span class="hljs-number">1</span>                      <font></font>
<font></font>
    <span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\par\prog'</span> + str(num) + <span class="hljs-string">'.pkl'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:<font></font>
        pkl.dump(ars,f)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Verfahren auf einen Teil der Namen √ºbertragen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Namen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , datafreyma Teil </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nur mit diesen Namen und die Seriennummer der parallelen Aufgaben - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">num</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Berechnungen werden in den Datenrahmen geschrieben und am Ende wird der Datenrahmen in die Datei geschrieben. </font><font style="vertical-align: inherit;">In dem Laptop, der diesen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Worker</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aufruft </font><font style="vertical-align: inherit;">, bereiten wir die Argumente entsprechend vor:</font></font><br>
<br>
<pre><code class="python hljs">num_proc = <span class="hljs-number">8</span> <span class="hljs-comment">#number of processors</span><font></font>
args = []<font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(num_proc):<font></font>
    step = int(len(names_samp)/num_proc) + <span class="hljs-number">1</span>
    names_i = names_samp[i*step:min((i+<span class="hljs-number">1</span>)*step, len(names_samp))]<font></font>
    ars_i = ars[ars[<span class="hljs-string">'name'</span>].isin(names_i)]<font></font>
    args.append([names_i, ars_i, i])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir beginnen mit dem parallelen Rechnen:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> Pool
<span class="hljs-keyword">import</span> workers<font></font>
<font></font>
<span class="hljs-keyword">if</span> __name__ ==  <span class="hljs-string">'__main__'</span>:     <font></font>
    p=Pool(processes = num_proc)<font></font>
    p.map(workers.worker,args)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und am Ende lesen wir die Ergebnisse aus den Dateien und sammeln die Teile wieder im gesamten Datenrahmen:</font></font><br>
<br>
<pre><code class="python hljs">ars=pd.DataFrame(columns = ars.columns)<font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(num_proc):
    <span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\par\prog'</span>+str(i)+<span class="hljs-string">'.pkl'</span>, <span class="hljs-string">'rb'</span>) <span class="hljs-keyword">as</span> f:    <font></font>
        arsi = pkl.load(f)<font></font>
        print(len(arsi))<font></font>
        ars = pd.concat([ars, arsi])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Somit war es m√∂glich, eine Beschleunigung von 40 zu erhalten und anstelle von 8 Stunden die Berechnung in 11 Minuten abzuschlie√üen und an diesem Abend einen Bericht zu ver√∂ffentlichen. Gleichzeitig habe ich gelernt, wie man in </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> parallelisiert </font><font style="vertical-align: inherit;">. Ich denke, das wird n√ºtzlich sein. Hier stellte sich heraus, dass die Beschleunigung mehr als das Achtfache der Anzahl der Kerne betrug, da f√ºr jede Aufgabe ein kleiner Datenrahmen verwendet wurde, was die Suche beschleunigt. Im Prinzip k√∂nnten sequentielle Berechnungen auf diese Weise beschleunigt werden, aber die Frage ist, wie raten Sie? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich konnte mich jedoch nicht beruhigen und dachte auch nach der Ver√∂ffentlichung st√§ndig dar√ºber nach, wie die Berechnung mithilfe der Vektorisierung durchgef√ºhrt werden sollte, dh Operationen an ganzen Spalten des </font><i><font style="vertical-align: inherit;">Datenrahmens</font></i><font style="vertical-align: inherit;"> der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pandas-Serie</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Solche Berechnungen sind selbst auf einem Supercluster um eine Gr√∂√üenordnung schneller als alle parallelisierten Zyklen. </font><font style="vertical-align: inherit;">Und kam mit. </font><font style="vertical-align: inherit;">Es stellt sich heraus, dass es f√ºr jeden Namen im Gegenteil notwendig ist, das Jahr des Beginns einer Karriere zu finden - f√ºr jedes Jahr die Teilnehmer zu finden, die damit begonnen haben. </font><font style="vertical-align: inherit;">Dazu m√ºssen Sie zun√§chst alle Namen f√ºr das erste Jahr aus unserer Stichprobe ermitteln, dies ist 2010. Dementsprechend verarbeiten wir alle Datens√§tze mit diesen Namen in diesem Jahr. </font><font style="vertical-align: inherit;">Als n√§chstes nehmen wir das n√§chste Jahr - 2011. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auch in diesem Jahr finden wir wieder alle Namen mit Eintr√§gen, aber wir nehmen nur unverarbeitete Namen von ihnen, dh diejenigen, die 2010 nicht erf√ºllt wurden und 2011 mit ihnen verarbeitet werden. </font><font style="vertical-align: inherit;">Und so weiter f√ºr den Rest des Jahres. </font><font style="vertical-align: inherit;">Der gleiche Zyklus, aber nicht zweihunderttausend Iterationen, sondern insgesamt neun.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> range(ars[<span class="hljs-string">'year'</span>].min(),ars[<span class="hljs-string">'year'</span>].max()):<font></font>
    arsynp = ars[(ars[<span class="hljs-string">'exp'</span>] == <span class="hljs-string">''</span>) &amp; (ars[<span class="hljs-string">'year'</span>] == y)] <span class="hljs-comment">#arsynp - all records selected for year not processed</span>
    namesy = arsynp[<span class="hljs-string">'name'</span>].unique()<font></font>
    ind = ars[ars[<span class="hljs-string">'name'</span>].isin(namesy)].index<font></font>
    ars.loc[ind, <span class="hljs-string">'exp'</span>] = ars.loc[ind,<span class="hljs-string">'year'</span>] - y + <span class="hljs-number">1</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Zyklus dauert nur wenige Sekunden. </font><font style="vertical-align: inherit;">Und der Code erwies sich als viel pr√§gnanter.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun, endlich ist eine Menge Arbeit erledigt. F√ºr mich war dies tats√§chlich das erste Projekt dieser Art. Als ich es nahm, war das Hauptziel, die Verwendung von Python und seinen Bibliotheken zu √ºben. Diese Aufgabe ist mehr als abgeschlossen. Und die Ergebnisse selbst waren durchaus vorzeigbar. Welche Schlussfolgerungen habe ich nach Abschluss f√ºr mich gezogen? </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erstens:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Daten sind unvollst√§ndig. Dies gilt wahrscheinlich f√ºr fast jede Analyseaufgabe. Selbst wenn sie vollst√§ndig strukturiert sind und dies h√§ufig anders geschieht, m√ºssen Sie darauf vorbereitet sein, sie zu basteln, bevor Sie mit der Berechnung der Merkmale und der Suche nach Trends beginnen - Fehler, Ausrei√üer, Abweichungen von Standards usw. finden. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zweitens:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jede Aufgabe hat eine L√∂sung. Dies ist eher ein Slogan, aber oft ist es so. Es ist nur so, dass diese L√∂sung m√∂glicherweise nicht so offensichtlich ist und nicht in den Daten selbst liegt, sondern sozusagen au√üerhalb des Rahmens. Als Beispiel - die Verarbeitung der Namen der oben beschriebenen Teilnehmer oder das Scraping der Website. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drittens:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dom√§nenwissen ist entscheidend. Dies erm√∂glicht es, die Daten besser vorzubereiten, offensichtlich ung√ºltige oder nicht standardm√§√üige Daten zu entfernen, Interpretationsfehler zu vermeiden, Informationen zu verwenden, die nicht in den Daten enthalten sind, z. B. Entfernungen in diesem Projekt, die Ergebnisse in der in der Community akzeptierten Form darzustellen und dumme, falsche Schlussfolgerungen zu vermeiden. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Viertens:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python arbeiten</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es gibt eine Vielzahl von Werkzeugen. Manchmal scheint es wert zu sein, √ºber etwas nachzudenken, man beginnt zu suchen - es existiert bereits. Das ist einfach toll! Vielen Dank an die Macher f√ºr diesen Beitrag, insbesondere f√ºr die Werkzeuge, die sich hier als </font><font style="vertical-align: inherit;">n√ºtzlich erwiesen </font><font style="vertical-align: inherit;">haben: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zum Schaben, Pycountry zur Bestimmung des L√§ndercodes gem√§√ü ISO-Standard, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L√§ndercodes (Datahub)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> f√ºr olympische Codes, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geopy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zur Bestimmung der Koordinaten an der Adresse, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Folium</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - zur Visualisierung von Geodaten, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gender-Guesser</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - zur Analyse von Namen, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Multiprocessing</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - f√ºr Parallel Computing, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Matplotlib</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Numpy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und nat√ºrlich </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pandas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ohne sie gibt es </font><i><font style="vertical-align: inherit;">keinen Ort</font></i><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">an den man gehen kann.</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F√ºnftens:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Vektorisierung ist unser Alles. Es ist √§u√üerst wichtig, die eingebauten </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pandas-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tools verwenden zu k√∂nnen </font><font style="vertical-align: inherit;">, es ist sehr effektiv. Ich nehme an, in den meisten F√§llen, wenn die Anzahl der Datens√§tze ab Zehntausenden gemessen wird, wird diese F√§higkeit einfach notwendig. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sechste:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Umgang mit Daten ist eine schlechte Idee. Es muss versucht werden, manuelle Eingriffe so gering wie m√∂glich zu halten. Erstens wird nicht skaliert, dh wenn sich die Datenmenge mehrmals erh√∂ht, erh√∂ht sich die Zeit f√ºr die manuelle Verarbeitung auf inakzeptable Werte, und zweitens wird die Wiederholbarkeit schlecht sein. Sie werden etwas vergessen und irgendwo einen Fehler machen . Alles ist nur programmatisch, wenn etwas vom allgemeinen Standard f√ºr eine Softwarel√∂sung abweicht, ist es in Ordnung, Sie k√∂nnen einen Teil der Daten opfern, es wird immer noch mehr Pluspunkte geben. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Siebte:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Code muss funktionsf√§hig bleiben. Es scheint, dass es offensichtlicher sein k√∂nnte! Wenn es um Code f√ºr den eigenen Gebrauch geht, dessen Zweck darin besteht, die Ergebnisse dieses Codes zu ver√∂ffentlichen, ist hier nicht alles so streng. Ich habe in Jupiter Notebooks gearbeitet, und diese Umgebung muss meiner Meinung nach keine integralen Softwareprodukte erstellen. Es ist f√ºr den zeilenweisen, st√ºckweisen Start konfiguriert. Dies hat seine Vorteile - es ist schnell: Entwicklung, Debugging und Ausf√ºhrung gleichzeitig. Aber oft besteht die Versuchung darin, nur eine Zeile zu bearbeiten und schnell ein neues Ergebnis zu erhalten, anstatt </font><i><font style="vertical-align: inherit;">def zu</font></i><font style="vertical-align: inherit;"> duplizieren oder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einzuwickeln</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Nat√ºrlich sollte eine solche Versuchung vermieden werden. Es ist notwendig, nach einem guten Code zu streben, auch ‚Äûf√ºr sich selbst‚Äú, zumindest weil der Start selbst f√ºr eine Analysearbeit viele Male durchgef√ºhrt wird und sich die Investition von Zeit am Anfang sicherlich in Zukunft auszahlen wird. Und Sie k√∂nnen Tests auch auf Laptops in Form von √úberpr√ºfungen kritischer Parameter und Ausl√∂sen von Ausnahmen hinzuf√ºgen - dies ist sehr n√ºtzlich. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Achte:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sparen Sie √∂fter. Bei jedem Schritt habe ich eine neue Version der Datei gespeichert. Insgesamt stellte sich heraus, dass sie ungef√§hr 10 waren. Dies ist praktisch, da es bei der Erkennung eines Fehlers hilfreich ist, schnell festzustellen, in welchem ‚Äã‚ÄãStadium er aufgetreten ist. Au√üerdem habe ich die Quelldaten in den als </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">roh</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gekennzeichneten Spalten gespeichert. Auf </font><font style="vertical-align: inherit;">diese Weise k√∂nnen Sie das Ergebnis schnell √ºberpr√ºfen und die Diskrepanz feststellen. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neunte:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es ist notwendig, den Zeitaufwand und das Ergebnis zu messen. An einigen Stellen habe ich sehr lange gebraucht, um Daten wiederherzustellen, die einen Bruchteil eines Prozentsatzes der Gesamtmenge ausmachen. Tats√§chlich machte das keinen Sinn, man musste sie einfach wegwerfen, und das ist alles. Und ich w√ºrde es tun, wenn es ein kommerzielles Projekt w√§re, kein Autotraining. Dies w√ºrde es Ihnen erm√∂glichen, das Ergebnis viel schneller zu erhalten. Hier funktioniert das Pareto-Prinzip - 80% des Ergebnisses werden in 20% der F√§lle erzielt. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und der Letzte:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Arbeit an solchen Projekten erweitert den Horizont erheblich. </font><font style="vertical-align: inherit;">Bereitwillig lernen Sie etwas Neues - zum Beispiel die Namen fremder L√§nder - wie die Pitcairn-Inseln, dass der ISO-Code f√ºr die Schweiz CHE ist, aus dem lateinischen ‚ÄûConfoederatio Helvetica‚Äú, was der spanische Name eigentlich √ºber den Triathlon selbst ist - Aufzeichnungen, ihre Besitzer, Orte von Rassen, Geschichte von Ereignissen und so weiter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vielleicht genug. </font><font style="vertical-align: inherit;">Das ist alles. </font><font style="vertical-align: inherit;">Vielen Dank an alle, die bis zum Ende gelesen haben!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de500150/index.html">ROS und Neural Grid Beggar Robot</a></li>
<li><a href="../de500152/index.html">Wie ich POS-Terminal und FR IKKM-Touch in 1C: Enterprise integriert habe</a></li>
<li><a href="../de500154/index.html">Vertrauliches maschinelles Lernen. PySyft-Bibliothek</a></li>
<li><a href="../de500158/index.html">SwiftUI-Interaktion mit Redux</a></li>
<li><a href="../de500160/index.html">Visuelle Elemente</a></li>
<li><a href="../de500164/index.html">Tutor: Berufskosten</a></li>
<li><a href="../de500170/index.html">Netzwerksimulator-Tutorial ns-3. Kapitel 6</a></li>
<li><a href="../de500178/index.html">√úbersetzung von Andrew Un's Buch, Leidenschaft f√ºr maschinelles Lernen, Kapitel 38 und 39</a></li>
<li><a href="../de500184/index.html">David O'Brien (Xirus): Metriken! Metriken! Metriken! Teil 2</a></li>
<li><a href="../de500186/index.html">HackTheBox. Exemplarische Vorgehensweise von OpenAdmin. RCE in OpenNetAdmin und GTFOBins in Nano</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>