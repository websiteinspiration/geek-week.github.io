<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👈🏽 🚩 🦎 メトリックを支援するuWSGI。Yandexレポート 🎍 👌🏽 👨🏻‍🎨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="先日、モスクワPythonミートアップ＃66が開催されました-コミュニティは言語を拡張し、さまざまな環境に適応させる関連ツールについて議論を続けています。会議を含め、私の報告は発言されました。私の名前はネイルです。Yandex.Connectをやっています。 私が用意したのはuWSGIについての話で...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>メトリックを支援するuWSGI。Yandexレポート</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/462697/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">先日、モスクワPythonミートアップ＃66が開催されました-コミュニティは言語を拡張し、さまざまな環境に適応させる関連ツールについて議論を続けています。会議を含め、私の報告は発言されました。私の名前はネイルです。Yandex.Connectをやっています。</font><font style="vertical-align: inherit;">
私が用意したのはuWSGIについての話です。これは多機能のWebアプリケーションサーバーであり、すべての最新のアプリケーションにはメトリックが付属しています。 uWSGIの機能がメトリックの収集にどのように役立つかを示してみました。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/oh/bd/zt/ohbdztka-hxtbhnhb8gz2g1ohmc.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a name="habracut"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-みなさん、こんにちは。Yandexの壁にあなたを歓迎します。たくさんの人が私のレポートや他のレポートを見に来てくれて、とても多くの人がPythonに興味を持って住んでいるのは素晴らしいことです。私の報告は何ですか？これは「メトリックを支援するuWSGI」と呼ばれます。私自身について少しお話します。私は過去6年間Pythonを使用してきました。私はYandex.Connectチームで働いています。サードパーティのユーザー、つまりすべての人のために内部で開発されたYandexサービスを提供するビジネスプラットフォームを書いています。 Yandexが開発した製品は、個人や組織を問わず、独自の目的で使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
指標、これらの指標を取得する方法、チームuWSGIで指標を取得するツールとしてどのように使用するか、それがどのように役立つかについて説明します。次に、最適化について少し説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メトリックスについて一言。ご存知のように、最新のアプリケーションの開発はテストなしでは不可能です。誰かがテストなしでアプリケーションを開発するのは奇妙です。同時に、メトリックなしでは最新のアプリケーションの操作は不可能であるように思えます。私たちのアプリケーションは生物です。人は、圧力、心拍数などのいくつかの測定基準を取得できます。アプリケーションには、関心があり、観察したい指標もあります。気分が悪いときにこれらの重要な測定基準を通常取る人とは異なり、アプリケーションの場合はいつでも測定できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gm/3s/oi/gm3soikaaai-tmfoi6mf7_u3waq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
なぜメトリックスを撮影するのですか？ちなみに、メトリクスを使うのは誰ですか？私のレポートの後に、より多くの手があり、人々が興味を持って指標を収集し始めることを望みます、彼らはこれが必要かつ有用であることを理解します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
では、なぜメトリックが必要なのでしょうか。まず、システムで何が起こっているかを確認し、システムのいくつかの規範的な指標を強調表示し、アプリケーションのプロセスでこれらの指標を超えるかどうかを理解します。エラー数の増加など、システムの異常な動作を確認したり、システムの問題点をユーザーの前に理解したり、ユーザーではなく監視システムからインシデントに関するメッセージを受信したりできます。メトリックに基づいて、アラートをセットアップし、SMS、手紙、電話を好きなように受け取ることができます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sw/1a/ru/sw1arunikx2d6u7ngqaiofuqfvo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
原則として、メトリックとは何ですか？これらはいくつかの数値であり、おそらく単調に増加するカウンターです。たとえば、リクエストの数。時間で変化するいくつかの単位値は増加または減少します。例は、キュー内のタスクの数です。またはヒストグラム-いくつかの間隔に分類される値、いわゆるバスケット。原則として、この時間関連データを読み取り、どの時間間隔でいくつの値が適合するかを見つけるのは便利です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ba/in/dk/baindkmahmhfz9-wq20ahlm4oyg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
どのような指標を取ることができますか？私はウェブアプリケーションの開発に焦点を当てます。たとえば、リクエストの数、エンドポイント、エンドポイントの応答時間、関連サービスの応答コードを、それらに移動してマイクロサービスアーキテクチャがあれば、撮影できます。キャッシュを使用すると、ミスキャッシュまたはヒットキャッシュがいかに効率的であるか、両方のサードパーティサーバー、たとえばデータベースの応答時間の分布を理解できます。ただし、メトリックを表示するには、どういうわけかそれらを収集する必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/4f/x3/9a/4fx39auteviuwx9dfiefacsjz_q.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それらをどのように収集できますか？いくつかのオプションがあります。最初のオプション、プッシュ方式についてお話ししたいと思います。それは何で構成されていますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーからリクエストを受け取ったとします。ローカルでは、アプリケーションを使用して、ある種の、通常はプッシュエージェントをインストールします。 Dockerがあり、その中にアプリケーションがあり、pushエージェントがまだ並行しているとしましょう。プッシュエージェントは、メトリック値をローカルで私たちから受信し、何らかの方法でそれらをバッファリングし、バッチを作成して、メトリックストレージシステムに送信します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プッシュスキームを使用する利点は何ですか？アプリケーションからメトリックシステムに直接いくつかのメトリックを送信できますが、同時に、メトリックを収集するために、なんらかのネットワークの相互作用、レイテンシ、オーバーヘッドが発生します。ローカルプッシュクライアントの場合、これは平準化されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/n5/ff/o7/n5ffo732rxl3styovoxwmjnffim.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別のオプションはプル方式です。プルスキームを使用すると、同じシナリオになります。ユーザーからのリクエストが来て、なんとか家に置いておく。そして、特定の頻度-1秒に1回、1分に1回-それはあなたに合っている-メトリック収集システムは、アプリケーションの特別なエンドポイントに到達し、これらのインジケーターを受け取ります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ob/xy/88/obxy88kzj0owhgydp-kr02gisx0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別のオプションはログです。私たちは皆、ログを書いてどこかに送ります。これらのログを取得し、どういうわけかそれらを処理し、ログに基づいてメトリックを取得することを妨げるものは何もありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、ユーザーのリクエストの事実をログに書き込み、ログをホップホップでカウントします。典型的な例はELK（Elasticsearch、Logstash、Kibana）です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qb/r1/ji/qbr1ji36v03ahocy3_hj5wy7ihs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
どのように機能しますか？ Yandexには、独自のインフラストラクチャ、独自のメトリック収集システムがあります。彼女は、プル方式を実装するハンドルの標準化された応答を期待しています。さらに、アプリケーションを起動する内部クラウドがあります。そして、これらすべてが単一のシステムに統合されています。クラウドにアップロードするときは、「このペンに移動してメトリックを取得する」と示します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/p7/ug/ls/p7uglskaraaguno_ngqnemhmbgc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下は、メトリック収集システムが想定しているプル方式の応答例です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
チーム内では、より適切な方法を選択し、最適なオプションを選択するためのいくつかの基準を強調することにしました。効率とは、測定システムにアクションの事実の反映をどれだけ迅速に反映できるかです。依存関係-追加のツールをインストールする必要があるか、メトリックを取得するためにインフラストラクチャを何らかの方法で構成する必要があるかどうか。そして、汎用性-この方法がさまざまなタイプのアプリケーションにどのように適しているか。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/h2/ao/s4/h2aos4jq6iboqpi9ze3254om0rs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それが最終的に得たものです。ただし、効率性と汎用性の基準によると、プッシュ方式が優先されます。しかし、私たちはWebアプリケーションを開発しており、クラウドにはこのタスクを処理するための既製のインフラストラクチャがすでにあるので、自分用にプル方式を選択することにしました。彼女について話します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プルスキームに何かを与えるためには、どこかにそれを事前に集約し、保存する必要があります。私たちの監視システムは5秒ごとにプルハンドルに入ります。どこに保存できますか？ローカルのメモリまたはサードパーティのストレージ。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pa/ft/sb/paftsbyryl5ojm43di6mhwrxge4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ローカルに保存する場合、原則として、これは1つのプロセスの場合に適しています。そして、私たちのuWSGIでは、いくつかのプロセスを並行して実行しています。または、ある種の共有ストレージを使用することもできます。 「共有ストレージ」という言葉で何が思い浮かびますか？これは、ある種のRedis、Memcached、リレーショナルデータベースまたは非リレーショナルデータベース、あるいはファイルです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ms/um/fb/msumfb5j3za1j6b7qxrklpnvww8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
uWSGIについて。それをほとんどまたはほとんど使用しない人に思い出させてください：uWSGIは、あなたの下でPythonアプリケーションを実行できるようにするアプリケーションWebサーバーです。インターフェース、uWSGIプロトコルを実装します。このプロトコルは、興味のあるPEP 333で説明されています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vg/ke/yy/vgkeyyiamyh4dfcbclpg-rhi17m.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、最高のYandex.Tankソリューションを選択するのにも役立ちます。これは負荷テストツールであり、さまざまな負荷プロファイルを使用してアプリケーションをシェル化し、美しいグラフィックを構築できます。または、好みに応じてコンソールで機能します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vl/79/jq/vl79jqtqnv8hgqvjeqhetqdzhpi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実験。合成テスト用の合成アプリケーションを作成し、タンクでそれを砲撃します。 uWSGIアプリケーションは、10人のワーカーと単純に競合します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nk/ui/s4/nkuis4s4fgzpkj7tmvlchyn0dr4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
こちらがFlaskアプリです。アプリケーションが実行するペイロードは、空のループをエミュレートします。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sc/d5/qt/scd5qtepls29c1u46xknxbcwfxm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yandex.Tankがこれらのグラフの1つを提供します。彼は何を示していますか？応答時間のパーセンタイル。斜線は成長しているRPSであり、ヒストグラムはそのような負荷の下でWebサーバーが適合するパーセンタイルです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このオプションを参考にして、メトリックを格納するためのさまざまなオプションがパフォーマンスにどのように影響するかを見ていきます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/9d/j2/x_/9dj2x_mwlyb7ovl-e9y24nkey1c.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最も簡単なオプションは、PostgreSQLを使用することです。私たちはPostgreSQLを使用しているため、PostgreSQLを使用しています。準備ができているものを使いましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PostgreSQLに、カウンターをインクリメントするラベルがあるとします。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_7/zx/ja/_7zxjarhpil1cwhzw2q-b1j48rg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すでに少量のRPSで、パフォーマンスの大幅な低下が見られます。単に巨大だと言えます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ox/c7/tm/oxc7tm1_kizqnqdli6rkzunqeau.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のオプションはRedisです。しかし、ここではよりスマートにしています。ローカルにインストールして、ネットワーク経由ではなく、Unixソケット経由でアクセスします。また、カウンターを増やします。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/6k/zv/wv/6kzvwvil-aitqzp2rdys3ggjz5e.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
出力で応答時間のヒストグラムを取得します。ここでは状況は良くなっていますが、ある時点で棚にぶつかり、生産性が向上しなくなりました。このオプションの方が最適と思われますが、さらに改善したいと考えています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ts/xs/m7/tsxsm7cnr7qsk0-aydibqnsmobg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、本当の組み合わせであるuWSGIが役立ちます。多くの異なるモジュールがあります。サブプロセス、キャッシュフレームワーク、cron、メトリックサブシステム、アラートシステムを実行するためのラバ。 「サブシステムメトリックシステム」-有望に聞こえます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xt/rd/ip/xtrdipfn_v0kmanjjipkuc2fd_w.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
彼女はある種のメトリックを追加する方法、カウンターを増やす方法、カウンターを減らす方法、乗算する方法、除算する方法を知っています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
唯一のメトリックサブシステムは、それに組み込まれたメトリックを正確に提供することができません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これがなぜ私たちにとって重要なのですか？前に見たように、統計を特定の形式で提供するためのハンドルがあり、いくつかのワーカーが実行されています。どのワーカーがリクエストを受信するかはわかりませんが、すべての指標を返すためには、名前のようなレジストリを作成し、プロセス間でなんらかの方法でそれをスクランブルする必要があります。これは大したことなので、避けたいです。他に何がありますか？</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tu/st/ir/tustir9lyytiuq5noxzeosk7uyq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、キャッシュサブシステム。そして、ここに表示されます。彼はほぼ同じことを実行でき、キャッシュに格納されているキーの名前を指定することもできます。これが必要です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/4l/le/um/4lleum60xf9n635wiue31dvaptk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
キャッシュサブシステムは、uWSGIに組み込まれたキャッシュです。高速でスレッドセーフなモジュール。通常のキーと値のストレージです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gf/a3/w4/gfa3w4hje0atgnlctpzdr6n1hcg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、これはキャッシュなので、よく知られている2番目の問題があります。変数に名前を付ける方法とキャッシュを無効にする方法は？ここでは、デフォルトのキャッシュ設定を見てみましょう。キーの長さに制限があります。私たちの場合、これはメトリックの名前です。デフォルトは2048バイトです。そして、必要に応じて設定を増やすことができます。デフォルトで格納される要素の数は65,536です。この値はすべての人にとって十分なものであるようです。アプリケーションからそのような数のメトリックを収集することはほとんどありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、デフォルトのttlは0です。つまり、保存されたキャッシュの値は時間で無効化されません。したがって、それらをキャッシュから取得して、メトリックシステムに送信できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nb/q8/zu/nbq8zuosdcqk0rss824oiweqifc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでも、オプションはuWSGIボックスを使用するアプリケーションです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/v6/ri/fb/v6rifbjrax-igqz5bfpn2m5powu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアプリケーションをシェル化した結果を次に示します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qs/dg/0-/qsdg0-_dj_bqttsbdoewg5rcps8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メトリクスなしの結果、uWSGIを使用している場合、ストレッチしてもほぼ同じように見えます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lw/xp/xz/lwxpxzc2jf-hyfnx4fcysnfmrfi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、uWSGIの場合、メトリックのない「バニラ」バージョンと比較してパフォーマンスの5％しか失われません。他のオプションにはかなり重要なドローダウンがあるため、観客の投票の結果として、uWSGIが勝利します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xw/sg/hf/xwsghfrlb5z8kwt_kzv4mgvxjhe.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これをどのように適用しましたか？小さなライブラリ、uWSGIのラッパーを作成しました。たとえば、ライブラリのインスタンスをインストールし、ここでは例としてメトリック「データベースクエリ時間」を追加します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jh/k2/qa/jhk2qajtaazyhqvckbyi63r8iiy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
キャッシュの動作を監視することにも関心があります。クライアントmemcacheのメソッドを再定義するだけで、データの受信時間、ロード時間、およびキャッシュヒットとキャッシュミスの数を節約できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/6r/cy/v7/6rcyv7zh51cjphtabkfhwwgjui4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ライブラリ内でこれをどのように行うのですか？</font><font style="vertical-align: inherit;">値を出荷するには、キャッシュに格納されているキーの名前を取得し、それらを実行して、目的の形式でエンドポイントに渡すだけです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/3g/ts/y-/3gtsy-g-qfq9ro1h71j_pjkhtk0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、グラフが表示されます。この場合は、読み取りと書き込みのキャッシュアクセス時間の99パーセンタイルです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ho/fg/td/hofgtdq1ewg1qoqabjpid3ukpds.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
または、オプションとして、APIへのサードパーティサービスリクエストの数。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dk/ba/zw/dkbazwujnh0sq9uf2uyj6wmgy_o.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
失敗と成功の両方の物語があります。</font><font style="vertical-align: inherit;">メトリックを追加するようになり、パフォーマンスが低下しました。</font><font style="vertical-align: inherit;">指標自体が私たちを助けました。</font><font style="vertical-align: inherit;">メトリックを収集すると、何かが間違っていることがわかります。</font><font style="vertical-align: inherit;">したがって、1週間、1か月、6か月にわたって蓄積したメトリックを遡及的に確認することもお勧めします。</font><font style="vertical-align: inherit;">また、アプリケーションがどの指標にどの傾向を示しているかを確認してください。</font><font style="vertical-align: inherit;">メトリックの計算に頼り始めたことに気づきました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/if/k_/uc/ifk_ucasa_eegw5jangcb-oudwm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロファイリングは私たちを助けました。ここにフレームグラフが表示されます。これは、プロセス中に特定の関数の呼び出しが何回行われたかを視覚的に示します。この呼び出しは、時間内で最大の貢献をしました。ピクルスを使った最初のバージョンではあまりうまくいかないことに気づきました。私たちの図書館の中で、彼女は酸洗いにかなりの時間を費やしました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kd/xn/nm/kdxnnm1oaklpbbsdoiw48yljkc8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは酸洗いを拒否し、cashe incに転送し、すべてを測定しました、それはより速くなりました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fp/v_/qe/fpv_qetjlbsj1dcgt4wo2z3xr2q.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しい実装では、ほとんどの時間を酸洗いではなくキャッシュの操作に費やしています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ju/x2/cs/jux2cs4k52ekeeqalcaeltpawkc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
なぜ私はあなたにこれを言っているのですか？</font><font style="vertical-align: inherit;">指標の収集、指標の確認、指標の絞り込みを開始することをお勧めします。</font><font style="vertical-align: inherit;">可能なメトリック収集オプションを選択するときは、オプションを比較して、どちらが最適かを確認してください。</font><font style="vertical-align: inherit;">そしてもちろん、プロファイリングは優れています。</font><font style="vertical-align: inherit;">何かがおかしいとわかった場合、何かが遅くなっています-プロファイル。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ありがとうございます！</font><font style="vertical-align: inherit;">私が約束したように、参照：</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yandex.Tank</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rustで書かれた</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">py-spy</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロファイリングユーティリティ</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uWSGIの使用に関するAlexander Koshelevの</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">報告</font></a><font style="vertical-align: inherit;">。</font></font></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja462685/index.html">PSKOV静的サイトジェネレーターの例を使用して耐久性のあるアプリケーションに向かう途中</a></li>
<li><a href="../ja462687/index.html">ISPsystemの新しいホスティングコントロールパネル：確認方法</a></li>
<li><a href="../ja462689/index.html">DISKOBALL：HDDスロー競技、8月23日、モスクワ</a></li>
<li><a href="../ja462691/index.html">Zimbraの使用時にADからLDAPに移行する方法</a></li>
<li><a href="../ja462695/index.html">WebComponentsとしてのマテリアル</a></li>
<li><a href="../ja462699/index.html">サービスメッシュ、「データプレーン」、「コントロールプレーン」（サービスメッシュデータプレーンとコントロールプレーン）</a></li>
<li><a href="../ja462701/index.html">AVRマイクロコントローラー用のアセンブラーコードジェネレーターライブラリ。パート2</a></li>
<li><a href="../ja462703/index.html">スマートフォンから制御されるロシアの「最も安い」回転式改札口</a></li>
<li><a href="../ja462705/index.html">ReactJSアプリケーションの上位5つのバグ</a></li>
<li><a href="../ja462707/index.html">Kubernetesで実行されているアプリケーションの開発者向けのツール</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>