<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌞 📽️ 👨🏻‍🏫 IPv6 - você está fazendo errado ✳️ 🃏 🆕</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Existem muitos conceitos errados e mitos sobre o IPv6. Freqüentemente, os provedores de hospedagem não entendem como usá-lo e pensam em abordagens des...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>IPv6 - você está fazendo errado</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vdsina/blog/488406/"><img src="https://habrastorage.org/webt/gg/-1/kx/gg-1kxivqjrehg1_oidyoqkphos.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem muitos conceitos errados e mitos sobre o IPv6. Freqüentemente, os provedores de hospedagem não entendem como usá-lo e pensam em abordagens desatualizadas do mundo do IPv4. Por exemplo, tendo octillions de endereços IPv6, o hoster vende endereços para clientes individualmente, em vez de alocar uma rede / 64 de pleno direito, conforme segue as recomendações. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Acontece que os hosters atribuem endereços IPv6 a diferentes clientes na mesma rede / 64. Ao mesmo tempo, serviços grandes, como o Google, percebem todos os endereços dentro do intervalo / 64 como um cliente. Como resultado, os clientes podem sofrer devido às atividades de um colega de banda.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A disponibilidade de endereços IPv6 permite atribuir endereços externos completos a recursos internos, como contêineres ou clientes VPN. </font><font style="vertical-align: inherit;">Para fazer isso, o host deve fornecer ao cliente uma rede roteada separada. </font><font style="vertical-align: inherit;">Infelizmente, quase ninguém pode fazer isso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste artigo, analisaremos os principais erros no uso de provedores IPv6.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">História: RFC 3177</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Em 2001, as recomendações sobre a alocação de endereços recomendadas (desculpe a tautologia, isso é importante) para destacar:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ 48 em geral</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ 64 se atrás dela uma e apenas uma sub-rede</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ 128 se um e apenas um dispositivo</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O documento ofensivo RFC 2119, que governa a aplicação de vários níveis de cumprimento obrigatório de instruções, define “recomendado” da seguinte forma: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As palavras “Deveriam” ou “Recomendado” significam que pode haver razões razoáveis ​​em determinadas circunstâncias para não agir dessa maneira, no entanto, a escolha de uma linha de comportamento diferente deve ser uma decisão equilibrada, tomada com total entendimento das consequências. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Talvez ninguém tenha entendido completamente as consequências naquele momento, talvez “certas circunstâncias” não tenham sido definidas, mas, de um jeito ou de outro, todos seguiram as recomendações.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em geral, no momento da redação do documento, o tráfego IPv6 era extremamente raro e era encontrado, em grande parte, em institutos e redes pessoais de entusiastas curiosos. </font><font style="vertical-align: inherit;">Alguns problemas reais começaram a se acumular e analisar, mas levou muito tempo. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O repensar começou em 2005. </font><font style="vertical-align: inherit;">Por fim, essas recomendações foram descontinuadas em 2011.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consciência do problema: RFC 6177</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A nova política de endereçamento afirma explicitamente que / 48 é apenas um desejo, não um requisito. Nenhuma indicação de números específicos é fornecida, no entanto, é indicado que / 64 ou menos funciona em condições normais. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A principal lógica em recomendar o tamanho da emissão do bloco / 48 ao consumidor final buscava três objetivos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, o espaço de endereço atribuído deve ser suficiente para fins do consumidor e facilmente extensível, sem agachamento com barra. Sim, é exatamente o que diz, apenas na versão em inglês - salte pelos bastidores. Um dos motivos importantes para mudar para o IPv6 é alterar o tamanho do destino existente de "endereço único" para "várias sub-redes".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em segundo lugar, a mudança de provedor deveria ter sido realizada com um mínimo de problemas. </font><font style="vertical-align: inherit;">Se você pode salvar o antigo esquema de endereço de sub-rede ao mudar para um novo espaço de endereço, isso economizará muito trabalho.Em </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
terceiro lugar, a alocação do bloco / 48 deve cobrir o aumento nas necessidades do espaço de endereço de um consumidor em desenvolvimento. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Embora todas essas condições tenham sido cumpridas, tornou-se evidente que a recomendação / 48 era, para dizer o mínimo, redundante.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pin / 64 como unidades de emissão</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Além da ordem de distribuição, havia outros pontos. </font><font style="vertical-align: inherit;">Acontece que muitos recursos do IPv6 não funcionam se o prefixo da rede não for / 64. </font><font style="vertical-align: inherit;">Ou seja, eles não funcionam:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ND (descoberta de vizinhos)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descoberta segura de vizinhos (SEND)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">algumas partes do IPv6 móvel</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Multihoming de sites por intermediação IPv6</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muitas coisinhas diferentes</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um fator adicional foi o fato de muitas das tecnologias projetadas dependerem exatamente desse prefixo de rede. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Não apenas a ameaça de quebrar o novo padrão foi a razão para escrever novas recomendações. </font><font style="vertical-align: inherit;">Duas opiniões de validade duvidosa também foram muito populares. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, muitos dispositivos implementam o roteamento IPv6 programaticamente, com muletas e bicicletas e, portanto, não estão prontos para uma transição completa para ele. </font><font style="vertical-align: inherit;">Um possível aumento no atraso devido a isso pode aumentar muitas vezes, se não uma ordem de magnitude. </font><font style="vertical-align: inherit;">A definição padrão da sub-rede / 64 reduziria bastante esses atrasos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Segundo, mudar para um novo padrão é sempre um problema para o suporte técnico e os administradores de sistema. </font><font style="vertical-align: inherit;">Um único prefixo / 64 deveria reduzir essa dor a um valor aceitável.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A situação nas frentes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como já aconteceu no início de 2001, a recomendação / 64 é percebida por muitos grandes players da Internet como um padrão. Por um lado, é bom, por outro lado, não é tão bom. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para muitos sistemas de classificação, por exemplo, para reconhecimento de spam, todos os endereços de um bloco serão considerados pertencentes a um remetente de spam. Em teoria, isso deve facilitar a vida do usuário, de fato, exatamente o oposto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Freqüentemente, os provedores não se preocupam com coisas como aprender sobre práticas comuns. Os endereços podem ser emitidos de acordo com qualquer princípio, pelo menos mesmo de acordo com o horóscopo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem vários problemas típicos, e todos eles decorrem da violação das recomendações do fornecedor, por um lado, e da estrita adesão a elas por outras organizações, por outro.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A emissão de endereços de um bloco para vários usuários pode levar ao fato de que todos serão considerados como um usuário real, por exemplo, máquinas na rede da organização. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se várias pessoas deste bloco começarem a procurar gatos ao mesmo tempo, o Google poderá decidir que essa botnet enviará solicitações de fraude de pesquisa ou outras coisas não muito boas. Do ponto de vista dele, esse é apenas um usuário. O resultado lógico é um captcha cada vez mais complicado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta, como você sabe, é a resposta mais inofensiva a uma fraude hipotética.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A situação inversa é a emissão para um usuário de endereços de diferentes blocos. </font><font style="vertical-align: inherit;">Se os usuários desses blocos caírem na lista negra de alguém, os endereços de um usuário honesto cairão com eles. </font><font style="vertical-align: inherit;">História particularmente interessante: alguns de seus endereços foram banidos por uma rede de publicidade, alguns foram banidos por outra. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Além disso, outras surpresas desagradáveis ​​são possíveis. </font><font style="vertical-align: inherit;">Por exemplo, você recebeu o bloco / 64 para uso, mas este é um bloco dinâmico como endereço dinâmico - hoje 2001: DA8: 1D01: FA13 :: / 64, amanhã 2001: DA8: 1D01: FC15 :: / 64. </font><font style="vertical-align: inherit;">Novas aventuras todos os dias! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Há uma chance considerável de encontrar várias combinações desses problemas e outros ancinhos fantasiosamente curvados no apêndice.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Emitir IPv6 do nosso servidor</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se tivermos quintilhões de endereços IP, por que não dar endereços IP reais, por exemplo, para clientes VPN, para que eles acessem a Internet sem NAT e possam aceitar conexões de entrada do mundo. </font><font style="vertical-align: inherit;">Parece ótimo, mas na prática não é tão fácil. </font><font style="vertical-align: inherit;">Isso exigirá uma rede IPv6 separada, roteada </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">através do</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> endereço IP atribuído à interface do servidor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suponha que um servidor tenha um endereço atribuído </font></font><code>2a01:baba::c0fee:dead/64</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, e os clientes VPN precisarão de uma rede separada, </font></font><code>2a01:baba:fafa:0f0f::/64</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">como roteada pelo endereço </font></font><code>2a01:baba::c0fee:dead/64</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Infelizmente, muito poucos provedores de hospedagem têm as ferramentas para emitir essas redes para os clientes, e é por isso que você precisa usar muletas como o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ND Proxy</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusão</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ler as recomendações da IETF não é a atividade mais interessante, mas é extremamente útil. </font><font style="vertical-align: inherit;">Preenchê-los com longas noites de inverno claramente não vale a pena, mas também deixar de ler seções importantes para você também é indesejável. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao escolher um provedor, verifique se ele compartilha esse ponto de vista. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você deve entender que a abordagem incorreta para a alocação de endereços não prejudica o provedor e, para a maioria dos contratos, ela não pode ser a base da compensação. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, isso pode ser um fator-chave para você, embora você ainda não suspeite.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/9fa/cf4/a34/9facf4a348ef01048b4eb5e16ae66daa.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt488386/index.html">Casos para aplicar ferramentas de análise de anomalias de rede: ataques através de plug-ins de navegador</a></li>
<li><a href="../pt488388/index.html">Autenticação básica de login e HTTP novamente</a></li>
<li><a href="../pt488390/index.html">Como fazer amigos do Telegram bot com o OpenId Connect</a></li>
<li><a href="../pt488392/index.html">Imagens prontas para produção para k8s</a></li>
<li><a href="../pt488404/index.html">Jogos que vale a pena esperar em 2020</a></li>
<li><a href="../pt488408/index.html">Gateway IoT Ethernet-RS485 STM32</a></li>
<li><a href="../pt488410/index.html">7 lições que aprendi em dez anos em desenvolvimento</a></li>
<li><a href="../pt488412/index.html">Criando um bot do Discord com base no discord.js</a></li>
<li><a href="../pt488416/index.html">SLAE - Exame de especialista em montagem do Security Linux</a></li>
<li><a href="../pt488418/index.html">Autenticação da API REST com Spring Security e MongoDB</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>