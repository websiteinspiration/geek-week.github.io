<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•å ü§±üèø üë®üèº‚Äçüåæ En lugar de 100 lanzamientos de aplicaciones, una prueba autom√°tica o c√≥mo salvar a un ingeniero de control de calidad 20 a√±os de vida ü§æüèæ üë®üèΩ‚Äçüè´ ü§ΩüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola a todos, mi nombre es Evgeny Demidenko. Durante los √∫ltimos a√±os, he estado desarrollando un sistema automatizado de prueba de juegos en Pixonic....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>En lugar de 100 lanzamientos de aplicaciones, una prueba autom√°tica o c√≥mo salvar a un ingeniero de control de calidad 20 a√±os de vida</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pixonic/blog/503704/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hola a todos, mi nombre es Evgeny Demidenko. Durante los √∫ltimos a√±os, he estado desarrollando un sistema automatizado de prueba de juegos en Pixonic. Hoy quer√≠a compartir nuestra experiencia en el desarrollo, soporte y uso de dicho sistema en el proyecto War Robots. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para empezar, descubriremos qu√© estamos automatizando con este sistema. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En primer lugar, estas son las pruebas de regresi√≥n de la interfaz de usuario, las pruebas del juego central y la automatizaci√≥n de los puntos de referencia. Los tres sistemas en su conjunto permiten reducir la carga del departamento de control de calidad antes de los lanzamientos, tener m√°s confianza en la refactorizaci√≥n a gran escala y profunda, y mantener constantemente una evaluaci√≥n general del rendimiento de la aplicaci√≥n, as√≠ como de sus partes individuales. Otro punto que quiero se√±alar es la automatizaci√≥n de la rutina, por ejemplo, la prueba de cualquier hip√≥tesis.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/x-/p8/li/x-p8lisenhooudwb_qghpki8oew.gif" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dar√© algunos n√∫meros. Ahora se han escrito m√°s de 600 pruebas de IU y alrededor de 100 pruebas de n√∫cleo para War Robots. Solo en este proyecto, realizamos alrededor de un mill√≥n de lanzamientos de nuestros scripts de prueba, cada uno de los cuales tom√≥ aproximadamente 80 segundos. Si verificamos estos escenarios manualmente, hubi√©ramos pasado al menos cinco minutos cada uno. Adem√°s, lanzamos m√°s de 700 mil puntos de referencia. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De las plataformas, usamos Android e iOS, solo 12 dispositivos en el parque. Dos programadores participan en el desarrollo y soporte del sistema, y ‚Äã‚Äãun ingeniero de control de calidad est√° escribiendo y analizando pruebas.</font></font><br>
<br>
<a name="habracut"></a><br>
<img src="https://habrastorage.org/webt/uf/yw/0w/ufyw0wcb6rt75dkydnmcqfg2zly.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/yt/x1/9g/ytx19guugufvzvniufmworpua6e.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cuanto a la pila de software, utilizamos NUnit en nuestra base de datos, pero no para pruebas unitarias, sino para pruebas de integraci√≥n y sistema. </font><font style="vertical-align: inherit;">Para el juego central y las pruebas de verificaci√≥n de compilaci√≥n, utilizamos la soluci√≥n incorporada de Unity: Unity Test Tools. </font><font style="vertical-align: inherit;">Para escribir y analizar informes despu√©s de estas pruebas, se utiliza el Informe de prueba Allure de Yandex, as√≠ como </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TeamCity</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , como un sistema de integraci√≥n continua para la creaci√≥n de aplicaciones, la implementaci√≥n del servidor y las pruebas de ejecuci√≥n. </font><font style="vertical-align: inherit;">Utilizamos el repositorio Nexus y la base de datos PostgreSQL para almacenar nuestros artefactos.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/u6/3q/mo/u63qmozjx0tp1pcl6ym9ykqnrwa.jpeg"><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øC√≥mo se crean, analizan y ejecutan pruebas?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Supongamos que queremos escribir una prueba simple que en la ventana de configuraci√≥n del juego verificar√° el icono para encender y apagar el sonido. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, escribimos una prueba y la enviamos a una rama espec√≠fica en nuestro repositorio de prueba. Elegimos las pruebas que queremos ejecutar, elegimos una compilaci√≥n para ejecutar, o tal vez una confirmaci√≥n espec√≠fica, en la que se ensamblar√° la compilaci√≥n. Ahora ejecute la prueba, espere un momento y obtenga el resultado. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yh/lh/zh/yhlhzh-ks_cwipqs8r0rz6sgcdk.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/58/g2/vc/58g2vcabu81mbxprwuoalnf9p34.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este caso, se lanzaron 575 pruebas, de las cuales el 97% tuvieron √©xito. Nos llev√≥ unas tres horas completar todas las pruebas. A modo de comparaci√≥n, las mismas pruebas, si se realizan manualmente, tomar√≠an al menos 50 horas de operaci√≥n continua. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, ¬øqu√© pas√≥ con el 3% de las pruebas que fallaron? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abrimos una prueba espec√≠fica y vemos un mensaje de que ocurri√≥ un error al hacer coincidir las capturas de pantalla.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sk/ae/tl/skaetlvcp3-ivmp5aqkzhmolbac.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego abrimos la captura de pantalla, que en ese momento estaba en el dispositivo, y vemos que las zonas que no corresponden al original est√°n marcadas con p√≠xeles rojos. </font><font style="vertical-align: inherit;">A modo de comparaci√≥n, le damos. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/am/h2/vn/amh2vnpzgkyhqtkrfsnski3y1sy.png"><br>
<br>
<img src="https://habrastorage.org/webt/s3/7o/zl/s37ozlopkihi4vpcpwrbslws05i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturalmente, despu√©s de esto, el ingeniero de control de calidad debe corregir el error de que el comportamiento de la compilaci√≥n no corresponde al documento de dise√±o del juego, o actualizar las capturas de pantalla originales, porque el documento de dise√±o del juego ha cambiado, y ahora estos elementos no estar√°n en el juego.</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se ve genial. </font><font style="vertical-align: inherit;">¬øPor qu√© es todo esto necesario?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hace alg√∫n tiempo, en el proyecto War Robots, necesit√°bamos hacer una peque√±a refactorizaci√≥n. </font><font style="vertical-align: inherit;">Consisti√≥ en reescribir algunas piezas de c√≥digo para disparar armas, en particular, ametralladoras.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante las pruebas, encontramos un matiz interesante: la tasa de ametralladoras depend√≠a directamente del FPS. Tal error no ser√≠a realista de detectar durante las pruebas manuales: en primer lugar, debido a las caracter√≠sticas del c√°lculo de da√±os de la red en el proyecto, y en segundo lugar, debido al hecho de que la aplicaci√≥n War Robots est√° bastante bien optimizada y en ese momento se ejecut√≥ dispositivos con aproximadamente el mismo FPS - 30 cuadros / s. Por supuesto, hubo peque√±as desviaciones, pero no fueron suficientes para notar un aumento en el da√±o por disparar armas durante las pruebas manuales. Luego nos preguntamos: ¬øcu√°ntos errores todav√≠a tenemos y cu√°ntos pueden aparecer durante la refactorizaci√≥n?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como no quer√≠amos reducir la cantidad de pruebas, sino aumentarla, ya que hab√≠amos planeado actualizaciones importantes y un aumento en la cantidad de contenido, no quer√≠amos crecer horizontalmente y aumentar la cantidad de empleados del departamento de control de calidad. </font><font style="vertical-align: inherit;">En cambio, planeamos un crecimiento vertical con una reducci√≥n en la rutina de los empleados actuales y facilitando sus vidas durante las pruebas de integraci√≥n de contenido nuevo.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sh/yf/_w/shyf_wvrx43ugfrojh0q57lozoa.jpeg"><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øQu√© herramientas utilizamos?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando comenzamos a automatizar las pruebas, en primer lugar, prestamos atenci√≥n a las Herramientas de prueba de integraci√≥n de Unity, que estaban integradas en ese momento en Unity. Escribimos varias IU y pruebas centrales en √©l, terminamos la refactorizaci√≥n que comenzamos antes y quedamos satisfechos con ella, porque la soluci√≥n ya funcion√≥, lo que significa que nuestras suposiciones eran correctas, y tuvimos que seguir adelante. Lo √∫nico negativo de esta soluci√≥n, pero muy significativo para nosotros, fue que las pruebas no pod√≠an ejecutarse en dispositivos m√≥viles.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, se nos ocurri√≥ la idea de usar el marco de Appium. Esta es una bifurcaci√≥n de otro marco de prueba conocido: Selenium. A su vez, es quiz√°s el marco m√°s famoso para probar aplicaciones web, cuyo concepto principal es trabajar con elementos de la interfaz de usuario, obtener sus coordenadas y organizar la entrada en estos elementos de la interfaz de usuario. Appium adopt√≥ este concepto y, adem√°s de los controladores web existentes en Selenium, tambi√©n agreg√≥ controladores iOS y Android: usan marcos de prueba nativos para cada una de estas plataformas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como no hay elementos de interfaz de usuario nativos en Unity, y solo hay un elemento de interfaz de usuario en el que se representa la imagen, tuve que agregar adem√°s del Appium UnityDriver, que le permite trabajar con la jerarqu√≠a de escenas, obtener objetos de escena y mucho m√°s.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En ese momento, un ingeniero de control de calidad ya hab√≠a aparecido en el proyecto, las cosas comenzaron a fluir, el n√∫mero de escenarios de prueba comenz√≥ a crecer significativamente, lo que gradualmente automatizamos. Comenzamos a lanzarlos en dispositivos y, en general, nuestro trabajo ya ten√≠a el aspecto que quer√≠amos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el futuro, adem√°s de las pruebas de IU, comenzaron a aparecer pruebas centrales y otras herramientas basadas en nuestro sistema, como resultado de lo cual nos encontramos con el rendimiento y la calidad del trabajo en varios dispositivos, agregamos soporte para varios dispositivos m√°s, pruebas paralelas y tambi√©n abandonamos Appium en beneficio de su propio marco. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lv/mn/sv/lvmnsvmwhtnp3ewe2mpofdem-e4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El √∫nico problema que qued√≥ con nosotros, y a√∫n lo es, fue la jerarqu√≠a de la interfaz de usuario. Porque si una jerarqu√≠a cambia en una escena debido a la refactorizaci√≥n de la interfaz de usuario o al trabajo en la escena, esto debe ser compatible con las pruebas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de las siguientes innovaciones y revisiones, la arquitectura de todo el sistema comenz√≥ a verse de la siguiente manera. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yu/52/ho/yu52hohx3nmookj9vajusrl7uyg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tomamos la compilaci√≥n de War Robots, tomamos nuestras pruebas, que est√°n en un repositorio separado, agregamos algunos par√°metros para ejecutar all√≠ que nos permiten configurar el lanzamiento de las pruebas en cada caso, y lo enviamos todo al agente TeamCity en una PC remota. El agente TeamCity lanza nuestras pruebas, les pasa los par√°metros de compilaci√≥n y lanzamiento de "Robots", despu√©s de lo cual las pruebas comienzan a funcionar y se "comunican" de forma independiente con los dispositivos que est√°n conectados al agente TeamCity por cable: poner compilaciones en ellos, ejecutarlos, ejecutar ciertos scripts, eliminar compilaciones, reinicia la aplicaci√≥n, etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dado que las pruebas y la aplicaci√≥n en s√≠ se ejecutan en dispositivos f√≠sicamente diferentes, en un tel√©fono m√≥vil y Mac mini, tuvimos que implementar la comunicaci√≥n entre nuestro marco, War Robots API y Unity API. </font><font style="vertical-align: inherit;">Hemos agregado un peque√±o servidor UDP a la aplicaci√≥n, que recibe comandos del marco y se comunica con la aplicaci√≥n API y Unity a trav√©s de controladores. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sq/rt/qf/sqrtqfu4f-swgarbf1zgsysocea.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La tarea principal de nuestro marco es organizar el trabajo de las pruebas: la preparaci√≥n, finalizaci√≥n y gesti√≥n correcta de los dispositivos. </font><font style="vertical-align: inherit;">En particular, la paralelizaci√≥n para acelerar el trabajo, la elecci√≥n correcta de dispositivos y capturas de pantalla, la comunicaci√≥n con la compilaci√≥n. </font><font style="vertical-align: inherit;">Despu√©s de completar las pruebas, nuestro marco debe guardar todos los artefactos generados y generar un informe.</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consejos para elegir dispositivos</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por separado, quiero prestar atenci√≥n a la elecci√≥n de los dispositivos para las pruebas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se debe prestar considerable atenci√≥n a los centros. Si desea ejecutar puntos de referencia en sus dispositivos, especialmente si son dispositivos Android, se quedar√°n sin energ√≠a. Los concentradores deben proporcionar la potencia necesaria para los dispositivos utilizados. Hay otra caracter√≠stica muy sutil: algunos concentradores tienen energ√≠a activa, y esta energ√≠a se apaga despu√©s de sobretensiones, despu√©s de lo cual se enciende solo presionando f√≠sicamente un bot√≥n. Tenemos tales centros, y esto es muy inconveniente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si desea ejecutar pruebas de IU de regresi√≥n y l√≥gica de prueba en dispositivos, no tome dispositivos diferentes. </font><font style="vertical-align: inherit;">Tome los mismos dispositivos, mejor los m√°s productivos que pueda pagar, porque de esta manera ahorrar√° tiempo en los frenos del dispositivo, la conveniencia de trabajar con ellos y el comportamiento de la aplicaci√≥n en todos los dispositivos ser√° el mismo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Otro problema es el uso de granjas en la nube. </font><font style="vertical-align: inherit;">Todav√≠a no los usamos, aunque hemos realizado una investigaci√≥n sobre ellos: cu√°les son, cu√°nto cuestan y c√≥mo realizar nuestras pruebas en ellos, pero hasta ahora tenemos suficiente de nuestro parque de dispositivos interno para cubrir nuestras solicitudes.</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informe de prueba</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Una vez que se completan las pruebas, generamos un informe atractivo, que incluye todos los artefactos que se crearon durante nuestra prueba. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El principal "caballo de batalla" para analizar lo que sucedi√≥ e identificar las causas del accidente durante la prueba son los registros. En primer lugar, los recopilamos de nuestro marco, que nos informa sobre el estado del gui√≥n y lo que sucedi√≥ en este gui√≥n. Dividimos los registros en el sistema (m√°s detallado) y el registro de QA (m√°s compacto y conveniente para el an√°lisis). Tambi√©n recopilamos registros del sistema de dispositivos (por ejemplo, logcat) y registros de una aplicaci√≥n de Unity.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante la ca√≠da de las pruebas, tambi√©n tomamos una captura de pantalla para comprender lo que estaba sucediendo en los dispositivos en el momento de la ca√≠da, grabar un video para comprender lo que sucedi√≥ antes del accidente e intentar recopilar la m√°xima informaci√≥n sobre el estado del dispositivo, como los pings de nuestros servidores e informaci√≥n en ifconfig para entender si el dispositivo tiene una IP. </font><font style="vertical-align: inherit;">Sin embargo, se sorprender√° si inicia la aplicaci√≥n manualmente 50 veces, todo estar√° bien con ella, pero si la ejecuta 50 mil veces en modo autom√°tico, encontrar√° que Internet en el dispositivo puede perderse, y no estar√° claro durante la prueba, si hubo una conexi√≥n antes y despu√©s de la ca√≠da. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n recopilamos una lista de procesos, energ√≠a de la bater√≠a, temperatura y, en general, todo lo que podemos alcanzar.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/du/vk/o3/duvko3ve8ep_2fsl2wcm5m129wk.jpeg"><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øCu√°les son buenas capturas de pantalla y videos?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hace alg√∫n tiempo, nuestro ingeniero de control de calidad sugiri√≥, adem√°s de tomar capturas de pantalla en oto√±o, en ciertos lugares de las pruebas para comparar estas capturas de pantalla con las plantillas que se encuentran en nuestro repositorio. Por lo tanto, propuso ahorrar tiempo en la cantidad de ejecuciones de prueba y reducir el tama√±o de la base del c√≥digo. Es decir, con una prueba podr√≠amos verificar la l√≥gica y la parte visual. Desde el punto de vista del concepto de prueba unitaria, esto no es muy correcto, porque en una prueba no deber√≠amos probar varias hip√≥tesis. Pero este es un paso deliberado: sabemos c√≥mo analizar todo esto correctamente, por lo que nos aventuramos a agregar una funcionalidad similar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En primer lugar, pensamos en agregar bibliotecas para que coincidan con las capturas de pantalla, pero nos dimos cuenta de que usar im√°genes con diferentes resoluciones no es muy confiable, por lo que nos detuvimos en dispositivos con la misma resoluci√≥n y simplemente comparamos las im√°genes con un cierto umbral p√≠xel por p√≠xel.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mk/er/0l/mker0lc9w32qaca97jmykzsdae8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un efecto muy interesante del uso de la coincidencia de capturas de pantalla es que si alg√∫n proceso es dif√≠cil de automatizar, lo automatizaremos hasta donde resulta, y luego simplemente miramos las capturas de pantalla manualmente. Esto es exactamente lo que hicimos con la localizaci√≥n de prueba. Recibimos una solicitud para probar la localizaci√≥n de nuestras aplicaciones, por lo que comenzamos a buscar bibliotecas que permitieran el reconocimiento de texto, pero nos dimos cuenta de que era poco confiable y, como resultado, escribimos varios scripts que "recorren" diferentes pantallas y causan diferentes ventanas emergentes. ups, y en este momento se crean capturas de pantalla. Antes de comenzar tal script, cambiamos la configuraci√≥n regional en el dispositivo, ejecutamos la secuencia de comandos, tomamos capturas de pantalla, cambiamos la configuraci√≥n regional nuevamente y ejecutamos la secuencia de comandos nuevamente. Por lo tanto, todas las pruebas se realizan de noche,para que por la ma√±ana el ingeniero de control de calidad pueda ver 500 capturas de pantalla y analizar de inmediato si hay problemas con la localizaci√≥n en alguna parte. S√≠, las capturas de pantalla a√∫n deben ser vistas, pero esto es mucho m√°s r√°pido que pasar manualmente por todas las pantallas del dispositivo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A veces, las capturas de pantalla y los registros no son suficientes: algo extra√±o comienza a suceder en los dispositivos, pero como est√°n ubicados de forma remota, no puede ir y evaluar lo que sucedi√≥ all√≠. </font><font style="vertical-align: inherit;">Adem√°s, a veces no est√° claro qu√© sucedi√≥ literalmente unos momentos antes de que cayera la prueba. </font><font style="vertical-align: inherit;">Por lo tanto, agregamos una grabaci√≥n de video desde el dispositivo, que comienza con el inicio de la prueba y se guarda solo en caso de una ca√≠da. </font><font style="vertical-align: inherit;">Con la ayuda de tales videos, es muy conveniente rastrear bloqueos y bloqueos de aplicaciones.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tv/yi/jk/tvyijk8fgyl3_sgkyykx4tdjc2g.jpeg"><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øQu√© m√°s puede hacer nuestro sistema?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hace alg√∫n tiempo, del departamento de pruebas de control de calidad, recibimos una solicitud para desarrollar una herramienta para recopilar m√©tricas durante las pruebas de juego manuales. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øPara qu√© sirve? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esto es necesario para que los ingenieros de control de calidad, despu√©s de una prueba de reproducci√≥n manual, puedan analizar adicionalmente el comportamiento de FPS y el consumo de memoria en la aplicaci√≥n, mirando simult√°neamente capturas de pantalla y videos que reflejen lo que estaba sucediendo en este dispositivo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El sistema desarrollado por nosotros funcion√≥ de la siguiente manera. El ingeniero de control de calidad lanz√≥ War Robots en el dispositivo, activ√≥ el registro de la sesi√≥n de playbench, nuestro an√°logo del gamebench, jug√≥ la prueba de juego, luego hizo clic en "finalizar la sesi√≥n de playbench", el informe generado se guard√≥ en el repositorio, despu√©s de lo cual el ingeniero con los datos para esta prueba de prueba pudo llegar a su trabajo m√°quinas y ver el informe: cu√°les fueron los inconvenientes en FPS, qu√© consumo de memoria, qu√© estaba sucediendo en el dispositivo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n automatizamos el lanzamiento de puntos de referencia en el proyecto War Robots, esencialmente simplemente envolviendo los puntos de referencia existentes en un lanzamiento autom√°tico. El resultado de los puntos de referencia suele ser un d√≠gito. En nuestro caso, este suele ser el FPS promedio por punto de referencia. Adem√°s del lanzamiento autom√°tico, decidimos agregar otra sesi√≥n de playbench y, por lo tanto, recibimos no solo una figura espec√≠fica, c√≥mo funcionaba el punto de referencia, sino tambi√©n informaci√≥n gracias a la cual podemos analizar lo que sucedi√≥ con el punto de referencia en ese momento.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n debemos mencionar la prueba de solicitud de extracci√≥n. </font><font style="vertical-align: inherit;">Esta vez fue m√°s para ayudar al equipo de desarrollo del cliente, en lugar de los ingenieros de control de calidad. </font><font style="vertical-align: inherit;">Ejecutamos la llamada prueba de verificaci√≥n de compilaci√≥n para cada solicitud de extracci√≥n. </font><font style="vertical-align: inherit;">Puede ejecutarlos tanto en dispositivos como en el editor de Unity para acelerar el trabajo de verificaci√≥n de la l√≥gica. </font><font style="vertical-align: inherit;">Tambi√©n ejecutamos un conjunto de pruebas centrales en ramas separadas, donde se lleva a cabo una especie de redise√±o de algunos elementos o refactorizaci√≥n de c√≥digo.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/6x/xj/t8/6xxjt8np3nxlfacdadgagz-qxry.jpeg"><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y otras caracter√≠sticas √∫tiles.</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al final, quiero hacer hincapi√© en algunos casos interesantes que hemos conocido en los √∫ltimos a√±os. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uno de los casos m√°s interesantes que apareci√≥ recientemente con nosotros son los puntos de referencia durante las peleas con bots.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para el nuevo proyecto, Pixonic Dino Squad desarroll√≥ un sistema en el que el ingeniero de control de calidad pod√≠a jugar una prueba de juego con bots, para no esperar a sus colegas, sino para probar algunas hip√≥tesis. Nuestro ingeniero de control de calidad, a su vez, pidi√≥ agregar la capacidad no solo de jugar con bots, sino tambi√©n para que los bots puedan jugar entre ellos. Por lo tanto, simplemente iniciamos la aplicaci√≥n, y en este momento el bot comienza a jugar con otros bots. Al mismo tiempo, toda la interacci√≥n es en red, con servidores reales, en lugar de jugadores que juegan una computadora. Todo esto est√° envuelto en puntos de referencia y una sesi√≥n de playbench con disparadores para comenzar de noche. Por lo tanto, en la noche comenzamos varias batallas entre bots y bots, en este momento se escriben FPS y consumo de memoria, se toman capturas de pantalla y se graban videos. Por la ma√±ana, el ingeniero de control de calidad viene y puede ver,qu√© pruebas de juego se llevaron a cabo y qu√© pas√≥ con ellas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n vale la pena comprobar si hay fugas de textura. </font><font style="vertical-align: inherit;">Este es un tipo de suban√°lisis del uso de memoria, pero aqu√≠ verificamos principalmente el uso, por ejemplo, de texturas de garaje en la batalla. </font><font style="vertical-align: inherit;">En consecuencia, en la batalla no deber√≠a haber atlas que se usan en el garaje, y cuando salimos de la batalla, las texturas que se usaron en la batalla no deber√≠an permanecer en la memoria. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un efecto secundario interesante de nuestro sistema es que casi desde el comienzo de su uso, rastreamos el tiempo de carga de la aplicaci√≥n. </font><font style="vertical-align: inherit;">En el caso de War Robots, esta vez no es fuerte, pero est√° en constante crecimiento, porque se est√° agregando nuevo contenido y la calidad de este contenido est√° mejorando, pero podemos mantener este par√°metro bajo control y estar siempre conscientes de su tama√±o.</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En lugar de una conclusi√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al final, me gustar√≠a llamar la atenci√≥n sobre los problemas que tenemos que conocemos y que nos gustar√≠a resolver en primer lugar. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/s3/8o/ow/s38oowcmbceqawngd_udbsvt3eq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El primero y m√°s doloroso son los cambios en la IU. Dado que trabajamos con la caja negra, no incorporamos nada en la aplicaci√≥n War Robots, excepto nuestro servidor, es decir, probamos todo de la misma manera que lo har√≠a un ingeniero de control de calidad. Pero de alguna manera necesitamos acceder a los elementos de la escena. Y los encontramos a lo largo del camino absoluto. Por lo tanto, cuando algo cambia en el escenario, especialmente en un alto nivel de jerarqu√≠a, tenemos que apoyar estos cambios en una gran cantidad de pruebas. Desafortunadamente, no podemos hacer nada al respecto en este momento. Por supuesto, hay algunas soluciones, pero traen sus problemas adicionales.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El segundo gran problema es la infraestructura. Como dije, si ejecuta su aplicaci√≥n 50 veces con sus manos, no notar√° la mayor√≠a de los problemas que saldr√°n a la luz si ejecuta su aplicaci√≥n 50 mil veces. Esos problemas que pueden resolverse f√°cilmente en modo manual, por ejemplo, reinstalar compilaciones o reiniciar Internet, resultar√°n ser una verdadera molestia en la automatizaci√≥n, porque todos estos problemas deben manejarse correctamente, aparecer un mensaje de error y siempre que puedan ocurrir. En particular, tenemos que determinar por qu√© cayeron las pruebas: debido a un mal funcionamiento de la l√≥gica o alg√∫n tipo de problema de infraestructura, o por cualquier otra raz√≥n. Hay muchos problemas con los dispositivos de gama baja: no tienen compilaciones, Internet se cae, los dispositivos se congelan, se bloquean, no se encienden, se descargan r√°pidamente, etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n me gustar√≠a interactuar con interfaces de usuario nativas, pero hasta ahora no tenemos esa oportunidad. </font><font style="vertical-align: inherit;">Sabemos c√≥mo hacer esto, pero la presencia de otras solicitudes de funcionalidad no nos permite llegar a esto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y personalmente, mi deseo es cumplir con los est√°ndares que existen en la industria, pero esto tambi√©n est√° en los planes para el futuro, tal vez incluso este a√±o.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es503690/index.html">Mejores pr√°cticas de Kubernetes. Actualizaci√≥n del cl√∫ster de tiempo de inactividad cero de Kubernetes</a></li>
<li><a href="../es503696/index.html">Gears of war: cuando las computadoras anal√≥gicas mec√°nicas gobernaban el mar</a></li>
<li><a href="../es503698/index.html">Contabilidad remota: como beneficio comercial</a></li>
<li><a href="../es503700/index.html">Crear formularios de reacci√≥n en 2020</a></li>
<li><a href="../es503702/index.html">Uso de datos sin procesar en Google Analytics en la pr√°ctica</a></li>
<li><a href="../es503706/index.html">¬øPor qu√© se necesitan estas reglas clim√°ticas molestas para lanzar y aterrizar cohetes?</a></li>
<li><a href="../es503710/index.html">PyDoma [PyData Moscow Meetup # 12]: 26 de mayo de 2020</a></li>
<li><a href="../es503712/index.html">Estado y rendimiento de las soluciones de almacenamiento persistente de Kubernetes</a></li>
<li><a href="../es503716/index.html">¬øNecesitas nubes en el espacio?</a></li>
<li><a href="../es503718/index.html">Abogado robot, aplicaci√≥n de recolecci√≥n de basura y mucho m√°s: el hackathon de tubo en l√≠nea con pizza en l√≠nea conquista la crisis</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>