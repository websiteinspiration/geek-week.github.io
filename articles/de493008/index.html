<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ»â€âš•ï¸ ğŸ‘¨ğŸ½â€ğŸ”¬ ğŸš Informationen zum 1C-Servercluster ğŸ•µğŸ¾ â™»ï¸ ğŸ˜€</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ein Cluster ist eine Art paralleles 
 oder verteiltes System, das: 
 1. aus mehreren miteinander verbundenen 
 Computern besteht; 
 2. Als einzelne, 
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Informationen zum 1C-Servercluster</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/1c/blog/493008/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Cluster ist eine Art paralleles </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
oder verteiltes System, das: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. aus mehreren miteinander verbundenen </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Computern besteht; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Als einzelne, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
einheitliche Computerressource verwendet </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gregory F. Pfister, â€Auf der Suche nach Clusternâ€œ. </font></font></a></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gegeben:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es gibt eine GeschÃ¤ftsanwendung (z. B. ein ERP-System), mit der Tausende (mÃ¶glicherweise Zehntausende) Benutzer gleichzeitig arbeiten. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es ist notwendig:</font></font></b><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Machen Sie die Anwendung skalierbar, sodass es mit zunehmender Anzahl von Benutzern aufgrund der Zunahme der Hardwareressourcen mÃ¶glich ist, die erforderliche Anwendungsleistung bereitzustellen.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Machen Sie die Anwendung resistent gegen Ausfall von Systemkomponenten (sowohl Software als auch Hardware), Verbindungsverlust zwischen Komponenten und andere mÃ¶gliche Probleme.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verwenden Sie die Systemressourcen so effizient wie mÃ¶glich und bieten Sie die gewÃ¼nschte Anwendungsleistung.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vereinfachen Sie die Bereitstellung und Verwaltung des Systems.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um diese Probleme zu lÃ¶sen, verwenden wir die Clusterarchitektur in der 1C: Enterprise-Plattform. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben das gewÃ¼nschte Ergebnis nicht sofort erreicht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Artikel werden wir darÃ¼ber sprechen, welche Art von Clustern es gibt, wie wir den fÃ¼r uns geeigneten Clustertyp ausgewÃ¤hlt haben und wie sich unser Cluster von Version zu Version entwickelt hat und welche AnsÃ¤tze es uns ermÃ¶glichten, schlieÃŸlich ein System zu erstellen, das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zehntausende </font></font></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">von</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gleichzeitigen Benutzern bedient.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0g/mo/rq/0gmorqiise6fvaouym5mwpabl7y.png" alt="Bild"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Gregory Pfister, der Autor des Epigraphs zu diesem Artikel, in seinem Buch â€Auf der Suche nach Clusternâ€œ schrieb, wurde der Cluster nicht von einem bestimmten Hersteller von Hardware oder Software erfunden, sondern von Kunden, denen die Leistung eines Computers fehlte oder die Redundanz benÃ¶tigten. </font><font style="vertical-align: inherit;">Dies geschah laut Pfister bereits in den 60er Jahren des letzten Jahrhunderts. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unterscheiden Sie traditionell die folgenden Haupttypen von Clustern:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Failover-Cluster (HA, HochverfÃ¼gbarkeitscluster)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lastausgleichscluster (LBC)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Computercluster (High Performance Computing Cluster, HPC)</font></font></li>
<li>   (grid)      ,              .   grid-      ,    .  grid-    HPC-,      .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um unsere Probleme zu lÃ¶sen (BestÃ¤ndigkeit gegen Ausfall von Systemkomponenten und effizienter Einsatz von Ressourcen), mussten wir die FunktionalitÃ¤t eines ausfallsicheren Clusters und eines Clusters mit Lastausgleich kombinieren. </font><font style="vertical-align: inherit;">Wir sind nicht sofort zu dieser Entscheidung gekommen, sondern haben sie schrittweise weiterentwickelt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FÃ¼r diejenigen, die nicht auf dem neuesten Stand sind, werde ich kurz erlÃ¤utern, wie 1C-GeschÃ¤ftsanwendungen angeordnet sind. </font><font style="vertical-align: inherit;">Hierbei handelt es sich um Anwendungen, die in einer </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fachorientierten Sprache verfasst</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und fÃ¼r die Automatisierung von BuchhaltungsgeschÃ¤ftsaufgaben "geschÃ¤rft" wurden. </font><font style="vertical-align: inherit;">Um Anwendungen auszufÃ¼hren, die in dieser Sprache geschrieben sind, muss eine Laufzeit der 1C: Enterprise-Plattform auf dem Computer installiert sein.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1C: Enterprise 8.0</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die erste Version des 1C-Anwendungsservers (noch kein Cluster) wurde in Plattformversion 8.0 verÃ¶ffentlicht. Zuvor arbeitete 1C in der Client-Server-Version, die Daten wurden in einer Datei DBMS oder MS SQL gespeichert und die GeschÃ¤ftslogik arbeitete ausschlieÃŸlich auf dem Client. In Version 8.0 wurde auf die dreistufige Architektur "Client - Anwendungsserver - DBMS" umgestellt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Server 1C in Plattform 8.0 war </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COM +</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Server, der Anwendungscode in 1C ausfÃ¼hren kann. </font><font style="vertical-align: inherit;">Durch die Verwendung von COM + konnten wir einen vorgefertigten Transport durchfÃ¼hren, sodass Clientanwendungen Ã¼ber das Netzwerk mit dem Server kommunizieren konnten. </font><font style="vertical-align: inherit;">Viele Dinge in der Architektur sowohl der Client-Server-Interaktion als auch der Anwendungsobjekte, die dem 1C-Entwickler zur VerfÃ¼gung stehen, wurden unter BerÃ¼cksichtigung der Verwendung von COM + entwickelt. </font><font style="vertical-align: inherit;">Zu diesem Zeitpunkt war keine Fehlertoleranz in die Architektur integriert, und ein Serverabsturz fÃ¼hrte dazu, dass alle Clients heruntergefahren wurden. </font><font style="vertical-align: inherit;">Wenn die Serveranwendung abstÃ¼rzte, hob COM + sie auf, als der erste Client darauf zugegriffen hatte, und die Clients begannen ihre Arbeit von Anfang an - von der Verbindung zum Server. </font><font style="vertical-align: inherit;">Zu diesem Zeitpunkt wurden alle Kunden von einem Prozess bedient.</font></font><br>
<img src="https://habrastorage.org/webt/fg/oo/en/fgooenmx-pqv5tuizcfcvbvbaqg.png" alt="Bild"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1C: Enterprise 8.1</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der nÃ¤chsten Version wollten wir:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bieten Sie unseren Kunden Fehlertoleranz, damit UnfÃ¤lle und Fehler einiger Benutzer nicht zu UnfÃ¤llen und Fehlern anderer Benutzer fÃ¼hren. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Befreien Sie sich von der COM + -Technologie. </font><font style="vertical-align: inherit;">COM + funktionierte nur unter Windows, und zu diesem Zeitpunkt wurde die MÃ¶glichkeit, unter Linux zu arbeiten, bereits relevant.</font></font></li>
</ul> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gleichzeitig wollten wir keine neue Version der Plattform von Grund auf neu entwickeln - dies wÃ¤re zu ressourcenintensiv. </font><font style="vertical-align: inherit;">Wir wollten unsere Errungenschaften maximal nutzen und die KompatibilitÃ¤t mit Anwendungen gewÃ¤hrleisten, die fÃ¼r Version 8.0 entwickelt wurden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Version 8.1 erschien also der erste Cluster. </font><font style="vertical-align: inherit;">Wir haben unser Protokoll fÃ¼r Remoteprozeduraufrufe (zusÃ¤tzlich zu TCP) implementiert, das anscheinend fÃ¼r den Endverbraucher-Client fast wie COM + aussah (d. H. Wir mussten den fÃ¼r Client-Server-Aufrufe verantwortlichen Code praktisch nicht neu schreiben). </font><font style="vertical-align: inherit;">Gleichzeitig haben wir den in der C ++ - Plattform implementierten Server unabhÃ¤ngig gemacht und kÃ¶nnen sowohl unter Windows als auch unter Linux arbeiten.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die monolithische Serverversion 8.0 wurde durch drei Arten von Prozessen ersetzt - einen Arbeitsprozess, der Clients bedient, und zwei Dienstprozesse, die den Betrieb des Clusters unterstÃ¼tzen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rphost ist ein Workflow, der Kunden bedient und Anwendungscode ausfÃ¼hrt. </font><font style="vertical-align: inherit;">Ein Cluster kann mehr als einen Workflow haben, verschiedene Workflows kÃ¶nnen auf verschiedenen physischen Servern ausgefÃ¼hrt werden - aufgrund dieser Skalierbarkeit wird erreicht.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ragent - ein Server-Agent-Prozess, der alle anderen Prozesstypen startet, sowie eine fÃ¼hrende Liste von Clustern auf diesem Server.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rmngr ist ein Cluster-Manager, der den Betrieb des gesamten Clusters steuert (der Anwendungscode funktioniert jedoch nicht darauf). </font></font></li>
</ul><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unter dem Schnitt befindet sich das Operationsdiagramm dieser drei Prozesse im Cluster.</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/mn/yh/tc/mnyhtcaf9zf3_nqddsbfq4xgpsg.png" alt="image"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WÃ¤hrend der Sitzung arbeitete der Client mit einem Workflow. Der Ausfall des Workflows bedeutete fÃ¼r alle Clients, denen dieser Prozess diente. Die Sitzung wurde abnormal beendet. </font><font style="vertical-align: inherit;">Die Ã¼brigen Kunden arbeiteten weiter.</font></font><br>
<img src="https://habrastorage.org/webt/wm/tm/mc/wmtmmcct7xd6v2ecl6vi7nlx5dk.png" alt="Bild"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1C: Enterprise 8.2</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Version 8.2 wollten wir, dass 1C-Anwendungen nicht nur im nativen (ausfÃ¼hrbaren) Client, sondern auch im </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Browser ausgefÃ¼hrt werden kÃ¶nnen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ohne den Anwendungscode zu Ã¤ndern). </font><font style="vertical-align: inherit;">Insbesondere in dieser Hinsicht bestand die Aufgabe darin, den aktuellen Status der Anwendung von der aktuellen Verbindung mit dem rphost-Workflow zu entkoppeln und zustandslos zu machen. </font><font style="vertical-align: inherit;">Als Ergebnis entstand das Konzept einer Sitzung und von Sitzungsdaten, die auÃŸerhalb des Workflows gespeichert werden mussten (weil sie zustandslos waren). </font><font style="vertical-align: inherit;">Es wurde ein Sitzungsdatendienst entwickelt, der Sitzungsinformationen speichert und zwischenspeichert. </font><font style="vertical-align: inherit;">Es wurden auch andere Dienste angezeigt - ein Dienst fÃ¼r verwaltete Transaktionssperren, ein Volltextsuchdienst usw. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Version fÃ¼hrte auch einige wichtige Innovationen ein - verbesserte Fehlertoleranz, Lastausgleich und ein Cluster-Redundanzmechanismus.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fehlertoleranz</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da der Arbeitsprozess zustandslos wurde und alle fÃ¼r die Arbeit erforderlichen Daten auÃŸerhalb der aktuellen Client-Workflow-Verbindung gespeichert wurden, wechselte der Client im Falle eines Workflow-Absturzes beim nÃ¤chsten Zugriff auf den Server zu einem anderen "Live" -Workflow. In den meisten FÃ¤llen war ein solcher Wechsel fÃ¼r den Client unsichtbar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Mechanismus funktioniert so. Wenn der Aufruf des Clients an den Workflow aus irgendeinem Grund nicht bis zum Ende abgeschlossen werden konnte, kann der Client-Teil nach einem Anruffehler diesen Aufruf wiederholen, indem die Verbindung zu demselben oder einem anderen Workflow wiederhergestellt wird. Sie kÃ¶nnen einen Anruf jedoch nicht immer wiederholen. Wiederholen des Anrufs bedeutet, dass wir den Anruf an den Server gesendet haben, aber das Ergebnis nicht erhalten haben. Wir versuchen, den Anruf zu wiederholen, wÃ¤hrend wir den zweiten Anruf tÃ¤tigen. Wir bewerten, was das Ergebnis des vorherigen Anrufs auf dem Server war (Informationen dazu sind auf dem Server in den Sitzungsdaten gespeichert), denn wenn der Anruf Zeit hatte, dort zu "erben" (SchlieÃŸen Sie die Transaktion, speichern Sie die Sitzungsdaten usw.) - es ist einfach unmÃ¶glich, es zu wiederholen, es fÃ¼hrt zu Dateninkonsistenzen. Wenn der Anruf nicht wiederholt werden kann, erhÃ¤lt der Client eine Nachricht Ã¼ber einen nicht behebbaren Fehler.und die Client-Anwendung muss neu gestartet werden. Wenn Sie es nicht geschafft haben, den Anruf zu "erben" (und dies ist die hÃ¤ufigste Situation, da viele Anrufe keine Daten Ã¤ndern, z. B. Berichte, Anzeigen von Daten in einem Formular usw., und diejenigen, die Daten Ã¤ndern, keine Transaktion haben oder bis eine Ã„nderung der Sitzungsdaten an den Manager gesendet wurde (es gibt keine Spur des Anrufs), kann dies ohne das Risiko einer Dateninkonsistenz wiederholt werden. Wenn der Workflow abgestÃ¼rzt ist oder eine Netzwerkverbindung unterbrochen wurde, wird ein solcher Aufruf wiederholt, und diese â€Katastropheâ€œ fÃ¼r die Clientanwendung tritt vÃ¶llig unbemerkt auf.Diese Ã„nderungsdaten - bis die Transaktion festgeschrieben wird oder bis die Ã„nderung der Sitzungsdaten an den Manager gesendet wird - es gibt keine Spur des Anrufs) - kÃ¶nnen ohne das Risiko einer Dateninkonsistenz wiederholt werden. Wenn der Workflow abgestÃ¼rzt ist oder eine Netzwerkverbindung unterbrochen wurde, wird ein solcher Aufruf wiederholt, und diese â€Katastropheâ€œ fÃ¼r die Clientanwendung tritt vÃ¶llig unbemerkt auf.Diese Ã„nderungsdaten - bis die Transaktion festgeschrieben oder die Ã„nderung der Sitzungsdaten an den Manager gesendet wird (es gibt keine Spur des Anrufs) - kÃ¶nnen ohne das Risiko einer Dateninkonsistenz wiederholt werden. Wenn der Workflow abgestÃ¼rzt ist oder eine Netzwerkverbindung unterbrochen wurde, wird ein solcher Aufruf wiederholt, und diese â€Katastropheâ€œ fÃ¼r die Clientanwendung tritt vÃ¶llig unbemerkt auf.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lastverteilung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In unserem Fall hat der Lastausgleich folgende Aufgabe: Ein neuer Client betritt das System (oder ein bereits arbeitender Client fÃ¼hrt einen weiteren Anruf durch). </font><font style="vertical-align: inherit;">Wir mÃ¼ssen auswÃ¤hlen, an welchen Server und an welchen Workflow der Anruf des Clients gesendet werden soll, um dem Client maximale Geschwindigkeit zu bieten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist eine Standardaufgabe fÃ¼r einen Cluster mit Lastenausgleich. </font><font style="vertical-align: inherit;">Es gibt verschiedene typische Algorithmen zum LÃ¶sen, zum Beispiel:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Round-Robin ()</a> â€“    ,      ,   â€“    . .    .           .    ,          Â«Â» .           (   )    .</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Weighted Round Robin</a> â€“  Round-Robin:          ,    Ì    .</li>
<li>Least Connections:     ,       .</li>
<li>Least Response Time:       :    ,    .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FÃ¼r unseren Cluster haben wir einen Algorithmus gewÃ¤hlt, der im Wesentlichen nahe an der geringsten Antwortzeit liegt. Wir haben einen Mechanismus, der Statistiken Ã¼ber die Leistung von Workflows auf allen Servern im Cluster sammelt. Es fÃ¼hrt einen Referenzaufruf fÃ¼r jeden Serverprozess im Cluster durch. Der Referenzaufruf umfasst eine Teilmenge der Funktionen des Festplattensubsystems, des Speichers und des Prozessors und bewertet, wie schnell ein solcher Aufruf erfolgt. Das Ergebnis dieser Messungen, gemittelt Ã¼ber die letzten 10 Minuten, ist ein Kriterium - welcher Server im Cluster ist der produktivste und bevorzugte, um in einem bestimmten Zeitraum Clientverbindungen an ihn zu senden. Client-Anfragen werden so verteilt, dass der produktivste Server besser geladen wird - laden Sie denjenigen, der GlÃ¼ck hat.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Anfrage vom neuen Client ist derzeit an den produktivsten Server gerichtet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine Anforderung von einem vorhandenen Client wird in den meisten FÃ¤llen an diesen Server und an den Workflow gerichtet, an den die vorherige Anforderung gerichtet war. </font><font style="vertical-align: inherit;">Ein umfangreicher Datensatz auf dem Server ist einem funktionierenden Client zugeordnet. Die Ãœbertragung zwischen Prozessen (und vor allem zwischen Servern) ist recht teuer (obwohl wir dies auch tun kÃ¶nnen). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine Anforderung von einem vorhandenen Client wird in zwei FÃ¤llen an einen anderen Workflow Ã¼bertragen:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es gibt keinen Prozess mehr: Der Workflow, mit dem der Client zuvor interagiert hat, ist nicht mehr verfÃ¼gbar (der Prozess ist abgebrochen, der Server ist nicht mehr verfÃ¼gbar usw.).</font></font></li>
<li>   :     ,            ,     ,   ,              .         ,  ,     â€“             .    â€“      (..   ).</li>
</ol><br>
<br>
<h3> </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben uns entschlossen, die Ausfallsicherheit des Clusters zu erhÃ¶hen, indem wir auf das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aktiv / Passiv-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schema zurÃ¼ckgegriffen haben </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Es bestand die MÃ¶glichkeit, zwei Cluster zu konfigurieren - Working und Reserve. </font><font style="vertical-align: inherit;">Wenn der primÃ¤re Cluster nicht verfÃ¼gbar ist (Netzwerkprobleme oder beispielsweise geplante Wartung), werden Clientaufrufe an den Sicherungscluster umgeleitet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieses Design war jedoch ziemlich schwierig zu konfigurieren. </font><font style="vertical-align: inherit;">Der Administrator musste zwei Servergruppen manuell zu Clustern zusammenstellen und konfigurieren. </font><font style="vertical-align: inherit;">Manchmal haben Administratoren Fehler gemacht, indem sie widersprÃ¼chliche Einstellungen vorgenommen haben </font><font style="vertical-align: inherit;">Es gab keinen zentralen Mechanismus zum ÃœberprÃ¼fen der Einstellungen. </font><font style="vertical-align: inherit;">Dieser Ansatz erhÃ¶hte jedoch die Fehlertoleranz des Systems.</font></font><br>
<img src="https://habrastorage.org/webt/ik/k7/06/ikk7062chdd8qtpk0kzvfncq7vu.png" alt="Bild"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1C: Enterprise 8.3</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Version 8.3 haben wir den serverseitigen Code, der fÃ¼r die Fehlertoleranz verantwortlich ist, grundlegend neu geschrieben. Wir haben beschlossen, das Aktiv / Passiv-Cluster-Schema aufgrund der KomplexitÃ¤t seiner Konfiguration aufzugeben. Es ist nur noch ein fehlertoleranter Cluster im System vorhanden, der aus einer beliebigen Anzahl von Servern besteht. Dies entspricht eher dem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aktiv / Aktiv-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schema, </font><font style="vertical-align: inherit;">bei dem Anforderungen fÃ¼r einen ausgefallenen Knoten auf die verbleibenden Arbeitsknoten verteilt werden. Aus diesem Grund ist der Cluster einfacher zu konfigurieren. Eine Reihe von VorgÃ¤ngen, die die Fehlertoleranz erhÃ¶hen und den Lastausgleich verbessern, wurden automatisiert. Von den wichtigen Innovationen:</font></font><br>
<br>
<ul>
<li>   Â« Â»: , ,               .                ,           Â«Â»          .</li>
<li>     ,  ,            .</li>
<li>  ,     ,     ,   ,   ,    :</li>
</ul><br>
<img src="https://habrastorage.org/webt/o7/aw/pz/o7awpzltn3jxnderotcyf_wbahm.png" alt="Bild"><br>
<br>
<img src="https://habrastorage.org/webt/v5/kc/rj/v5kcrjv3ldm96l3ovj1seqobrga.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Hauptidee dieser Entwicklungen besteht darin, die Arbeit des Administrators zu vereinfachen und ihm zu ermÃ¶glichen, den Cluster auf der ihm vertrauten Ebene auf Serverebene zu konfigurieren, ohne darunter zu fallen, und den Grad der â€manuellen Steuerungâ€œ der Clusterarbeit zu minimieren, wodurch der Cluster Mechanismen zur LÃ¶sung der meisten Arbeitsaufgaben und mÃ¶glichen Probleme erhÃ¤lt. auf Autopilot. "</font></font><br>
<br>
<img src="https://habrastorage.org/webt/da/9i/zy/da9izy3cj4wlf80nr8s35tqnp3e.png" alt="Bild"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drei Glieder der Fehlertoleranz</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie wissen, kÃ¶nnen Probleme auftreten, wenn sich die Komponenten des Systems gegenseitig verursachen, selbst wenn die Komponenten des Systems separat zuverlÃ¤ssig sind. </font><font style="vertical-align: inherit;">Wir wollten die Anzahl der fÃ¼r die Systemleistung kritischen Stellen minimieren. </font><font style="vertical-align: inherit;">Eine wichtige zusÃ¤tzliche Ãœberlegung war die Minimierung von Ã„nderungen der angewandten Mechanismen in der Plattform und der Ausschluss von Ã„nderungen der angewandten LÃ¶sungen. </font><font style="vertical-align: inherit;">In Version 8.3 gab es 3 Links zur GewÃ¤hrleistung der Fehlertoleranz â€an den Gelenkenâ€œ:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kb/1g/s1/kb1gs1mfus_rsminiyizg4t5dma.png" alt="Bild"><br>
<ol>
<li>  ,   HTTP(S),  -.   -     -.    ,   HTTP  -,    (     HTTP)    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">libcurl</a>    . </li>
<li>  ,                     .</li>
<li>  -   .       1,   -     .    -            .       ,         .           ,     â€“    .    -         (,     ,   ,         ) â€“          .</li>
<li>     ,    rmngr.    20 (    ) â€”   ,     ..                .     1:          .</li>
</ol><br>
<br>
<h2> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dank des Fehlertoleranzmechanismus kÃ¶nnen auf der 1C: Enterprise-Plattform erstellte Anwendungen verschiedene Arten von AusfÃ¤llen von Produktionsservern im Cluster erfolgreich Ã¼berstehen, wÃ¤hrend die meisten Clients weiterhin ohne Neustart arbeiten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt Situationen, in denen wir den Anruf nicht wiederholen kÃ¶nnen oder ein Serverabsturz die Plattform zu einem sehr unglÃ¼cklichen Zeitpunkt erfasst, z. B. mitten in einer Transaktion, und es nicht klar ist, was mit ihnen zu tun ist. Wir versuchen, ein statistisch gutes Client-Ãœberleben sicherzustellen, wenn Server in den Cluster fallen. In der Regel betrÃ¤gt der durchschnittliche Verlust von Clients aufgrund eines Serverausfalls einige Prozent. In diesem Fall kÃ¶nnen alle "verlorenen" Clients nach dem Neustart der Clientanwendung im Cluster weiterarbeiten.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die ZuverlÃ¤ssigkeit des 1C-Serverclusters in Version 8.3 hat erheblich zugenommen. </font><font style="vertical-align: inherit;">Es ist seit langem nicht ungewÃ¶hnlich, 1C-Produkte einzufÃ¼hren, bei denen die Anzahl der gleichzeitig arbeitenden Benutzer mehrere Tausend erreicht. </font><font style="vertical-align: inherit;">Es gibt Implementierungen, bei denen sowohl 5.000 als auch 10.000 Benutzer gleichzeitig arbeiten - beispielsweise die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EinfÃ¼hrung in Beeline</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , bei der die Anwendung 1C: Trade Management alle Beeline-Verkaufsstellen in Russland bedient, oder die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementierung von Business Lines im Frachtunternehmen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hier dient die Anwendung, die von den Entwicklern der IT-Abteilung von Business Lines auf der 1C: Enterprise-Plattform unabhÃ¤ngig erstellt wurde, dem gesamten Zyklus des Frachttransports. </font><font style="vertical-align: inherit;">Unsere internen Clusterlasttests simulieren den gleichzeitigen Betrieb von bis zu 20.000 Benutzern.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AbschlieÃŸend mÃ¶chte ich kurz auflisten, was in unserem Cluster noch nÃ¼tzlich ist (die Liste ist unvollstÃ¤ndig):</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a>,         . ,             ,   .</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  </a> â€“ ,   ,   ,   (      â€“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a>, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   </a>  ..)      . ,   ,      (, )     ,   ERP, ,           ERP.</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  </a> â€“ ,     (,  ,    ..).  ,  ,    ,     ,   ,        .</li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de492994/index.html">Was ist neu in TestMace Teil 1. Cloud-Synchronisierung, aktualisierte BenutzeroberflÃ¤che und mehr</a></li>
<li><a href="../de492996/index.html">Benutzerdefinierte Datumsformate in Go</a></li>
<li><a href="../de492998/index.html">Wie wir verwirrt waren, freiberuflich fÃ¼r ein Rechenzentrum zu arbeiten und was daraus wurde</a></li>
<li><a href="../de493000/index.html">Methoden zum Umgang mit Legacy-Code am Beispiel von GitLab</a></li>
<li><a href="../de493002/index.html">350 Menschen aus der Ferne: wie es war</a></li>
<li><a href="../de493010/index.html">Wie Quarkus imperative und reaktive Programmierung kombiniert</a></li>
<li><a href="../de493012/index.html">Luft, Relais, Kabel aus dem Fenster: Wie man einem monopolistischen Anbieter in einem Business Center nicht begegnet</a></li>
<li><a href="../de493014/index.html">Interview mit Vyacheslav Utochkin, Direktor fÃ¼r Bildungsentwicklungsprogramme an der Higher School of Economics, der Higher School of Economics und der Higher School of Economics; 20 Fragen zu Gamedev</a></li>
<li><a href="../de493016/index.html">Die Ãœberschrift "Artikel fÃ¼r Sie lesen." Januar - Februar 2020</a></li>
<li><a href="../de493018/index.html">Der Entwickler schÃ¤tzte die KomplexitÃ¤t moderner Browser</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>