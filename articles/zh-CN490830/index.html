<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👲🏾 👈🏻 ✍️ Zimbra Collaboration Suite开源版中的密码管理 📎 🧒🏿 👃</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="密码管理一直是与信息系统安全运行相关的最重要问题之一。安全地存储和快速更改多个帐户的密码的能力，用户安全地重置忘记的密码的能力以及安全地重置管理员密码的能力-所有这些功能与我们前面提到的密码安全策略一样重要。在本文中，我们将研究如何在Zimbra OSE中实现这些功能。
 
 
 
 更改用户
 
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Zimbra Collaboration Suite开源版中的密码管理</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/zimbra/blog/490830/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">密码管理一直是与信息系统安全运行相关的最重要问题之一。安全地存储和快速更改多个帐户的密码的能力，用户安全地重置忘记的密码的能力以及安全地重置管理员密码的能力-所有这些功能</font><font style="vertical-align: inherit;">与我们前面提到</font><font style="vertical-align: inherit;">的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">密码安全策略一样</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要</font><font style="vertical-align: inherit;">。在本文中，我们将研究如何在Zimbra OSE中实现这些功能。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/op/xi/ie/opxiieyaijocgswpkt2td6f4-u0.png"><a name="habracut"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更改用户</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
密码</font><b><font style="vertical-align: inherit;">和全局管理员</font></b><font style="vertical-align: inherit;">密码</font><b><font style="vertical-align: inherit;">全局管理员</font></b><font style="vertical-align: inherit;">密码是在Zimbra OSE的安装过程中设置的，随后可以在Web客户端设置中进行更改。创建帐户时，最初会设置用户密码，但是，管理员可以在用户首次登录Web客户端时启用强制密码更改，以使用户不会忘记设置自己的密码。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果用户忘记了密码，Zimbra OSE提供了密码恢复功能。如果管理员启用了此功能，则该功能允许用户指定一个临时确认代码将进入的备份邮箱。使用此一次性代码，用户可以访问Zimbra OSE Web客户端并更改其密码。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，如果管理员突然忘记了其帐户的密码，并且由于该原因而无法登录Web客户端以更改密码，则可以使用</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setPassword</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font><font style="vertical-align: inherit;">或仅&nbsp; </font><font style="vertical-align: inherit;">在命令行上</font><font style="vertical-align: inherit;">使用&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sp</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。例如，使用命令&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zmprov sp admin@company.ru qwerty</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;，您可以将管理员密码更改为qwerty，而无需登录到Zimbra OSE Web客户端。可以使用同一命令来更改任何其他用户的密码。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
还要注意，管理员没有选择查看用户密码的选项。此限制是由于Zimbra OSE原则上不会以明文形式存储用户密码。相反，Zimbra OSE仅存储加盐的密码散列，并且在尝试登录时将用户输入的密码的哈希值与LDAP服务器中存储的内容进行比较。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过AD进行身份验证期间更改密码</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
如果使用AD对用户进行身份验证，则密码也不会存储在服务器上。取而代之的是，Zimbra OSE只是将用户输入传递给AD，并接收有关此帐户是否已通过身份验证的响应。而且，由于所有帐户信息都存储在另一台服务器上，因此在使用外部AD时，通常建议在Zimbra OSE Web客户端中禁用自更改密码功能。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，有一种方法可以将通过AD的用户身份验证与独立更改用户密码的能力结合在一起。</font><font style="vertical-align: inherit;">这可以通过名为</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Active Directory更改密码</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的扩展来完成&nbsp; </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它更改了Zimbra OSE Web客户端中密码更改按钮的功能，以便更改AD中的密码。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该扩展程序非常易于安装，其工作方式如下：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户单击密码更改按钮</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">输入密码</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">扩展名定义用户DN</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索外部AD服务器</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过安全连接更改帐户密码</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用以下命令将扩展安装在命令行上：</font></font><br>
&nbsp;<blockquote>&nbsp;mkdir -p /opt/zimbra/lib/ext/adpassword<br>
&nbsp; wget&nbsp;https://github.com/Zimbra-Community/ADPassword/raw/master/out/artifacts/ADPassword_jar/ADPassword.jar&nbsp;-O /opt/zimbra/lib/ext/adpassword/adPassword.jar<br>
&nbsp; su zimbra<br>
&nbsp; zmprov md domain.ext zimbraAuthLdapBindDn "%u@company.ru"<br>
&nbsp; zmprov md domain.ext zimbraAuthLdapSearchBase «CN=Users,DC=DOMAIN,DC=EXT»<br>
&nbsp; zmprov md domain.ext zimbraAuthLdapSearchBindDn «CN=serviceAccount,CN=Users,DC=DOMAIN,DC=EXT»<br>
&nbsp; zmprov md domain.ext zimbraAuthLdapSearchBindPassword "*********"<br>
&nbsp; zmprov md domain.ext zimbraAuthLdapSearchFilter "(samaccountname=%u)"<br>
&nbsp; zmprov md domain.ext zimbraAuthLdapURL «ldaps://ad.company.ru:636»<br>
&nbsp; zmprov md domain.ext zimbraExternalGroupLdapSearchBase «CN=Users,DC=DOMAIN,DC=EXT»<br>
&nbsp; zmprov md domain.ext zimbraExternalGroupLdapSearchFilter "(samaccountname=%u)"<br>
&nbsp; zmprov md domain.ext zimbraAuthMech «ad»<br>
&nbsp; zmprov md domain.ext zimbraAuthMechAdmin «ad»<br>
&nbsp; zmprov md domain.ext zimbraPasswordChangeListener ADPassword<br>
&nbsp; zmprov gd domain.ext | grep -i ldap | grep -v Gal<br>
&nbsp; zmprov gd domain.ext | grep -i zimbraPasswordChangeListener<br>
&nbsp; zmprov md domain.ext zimbraAuthFallbackToLocal FALSE<br>
&nbsp; zmcontrol restart</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
另外，如果您的Zimbra OSE和Active Directory服务器使用不同的SSL证书，则应将AD证书添加到Zimbra OSE服务器上的受信任列表中。如果两个信息系统使用相同的证书，则可以跳过此步骤。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，安装此扩展后，即使使用AD进行身份验证，您的用户也可以直接在Zimbra OSE Web客户端中更改其密码。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">批量密码重置</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在很多情况下，您可能需要为大量Zimbra OSE用户快速重置密码。如果用户数量足够多，则手动重置密码将花费大量时间，这在紧急情况下可能根本不可接受。脚本可以帮助优化此任务，该脚本可以自动重置单个域和整个邮件服务器的用户密码。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例如，重置company.ru域的所有用户的密码。为此，登录服务器并运行命令&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zmprov -l gaa company.ru&gt; /tmp/domainusers.txt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。执行此命令后，将创建文本文件</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">domainusers.txt。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其中将列出我们指定的域的所有用户。</font><font style="vertical-align: inherit;">如果未在此命令中指定域，则该服务器上的所有帐户都将被写入文本文件。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
之后，您可以从接收到的文本文件中删除所有系统帐户，例如galsync或垃圾邮件，以及那些不会重置密码的用户。</font><font style="vertical-align: inherit;">文件准备好后，您可以运行以下脚本：</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于我在`cat / tmp / domainusers.txt`中; </font><font style="vertical-align: inherit;">do newpass =“ Z1mBr @`openssl rand -base64 12`0a” &amp;&amp; / opt / zimbra / bin / zmprov sp $ i $ newpass &amp;&amp; echo $ i $ newpass &gt;&gt; newlogin.txt &amp;&amp; echo $ i &amp;&amp;睡眠5s; </font><font style="vertical-align: inherit;">做完了</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该脚本的结果将是</font><font style="vertical-align: inherit;">带有新帐户密码</font><font style="vertical-align: inherit;">的</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">newlogin.txt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件</font><font style="vertical-align: inherit;">。我们建议您尽快将其保存在安全的地方，然后从服务器中删除此文件。之后，您可以通知用户其新密码，以便他们可以继续在Zimbra OSE中工作。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">移动设备的单独密码</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在为Zimbra OSE安装Zextras扩展套件之后，另一个有趣的功能是从移动设备进入邮箱的单独密码。换句话说，将使用移动设备上的帐户为该帐户创建一个额外的密码，通过该帐户可以将其设备与邮箱同步，但无法登录到Zimbra OSE Web客户端。此功能可以显着提高在办公室外使用电子邮件的安全性，因为移动设备可能会受到损害甚至被盗，而且移动密码功能将有助于防止真实帐户密码落入攻击者的手中。</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/FLGYFkXLMZU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为移动设备创建密码非常简单。</font><font style="vertical-align: inherit;">可以在管理控制台中使用Zextras插件，也可以在命令行上完成此操作。</font><font style="vertical-align: inherit;">因此，例如，使用命令&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zxsuite mobile setAccountMobilePassword manager@company.ru Z1mBr @，</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您将为用户manager@company.ru提供密码Z1mBr @。</font><font style="vertical-align: inherit;">使用命令&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zxsuite mobile getAccountMobilePassword manager@company.ru，</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以看到用户manager@company.ru的移动密码；使用命令</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zxsuite mobile unsetAccountMobilePassword manager@company.ru，</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以从指定用户中完全删除移动密码。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
有关Zextras Suite的所有问题，您可以通过电子邮件katerina@zextras.com与Zextras公司Ekaterina Triandafilidi的代表联系。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN490820/index.html">一站式服务所有哈伯</a></li>
<li><a href="../zh-CN490822/index.html">DEF CON 2019-2020破解汽车的最佳材料</a></li>
<li><a href="../zh-CN490824/index.html">Java开发人员眼中的PostgreSQL索引运行状况</a></li>
<li><a href="../zh-CN490826/index.html">生产效率之源</a></li>
<li><a href="../zh-CN490828/index.html">从头开始在Unity中创建类rogue</a></li>
<li><a href="../zh-CN490832/index.html">鞋标：当我们投入流通时，有200万种标码“ 1C” +“诚实标志”</a></li>
<li><a href="../zh-CN490836/index.html">如何打开评论而不被垃圾邮件淹没</a></li>
<li><a href="../zh-CN490838/index.html">WiFi 6在这里：市场提供什么以及我们为什么需要这种技术</a></li>
<li><a href="../zh-CN490840/index.html">资源规划。第4.1部分。在制定资源计划之前</a></li>
<li><a href="../zh-CN490842/index.html">图片中的GPT-2（变形金刚语言模型的可视化）</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>