<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåÑ üë∞ ü¶Ü About backups in Proxmox VE üëÅÔ∏è üÉè ü§∂</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the article ‚ÄúThe Magic of Virtualization: An Introductory Course in Proxmox VE‚Äù, we successfully installed a hypervisor on the server, connected th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>About backups in Proxmox VE</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/selectel/blog/486194/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/wt/vx/xu/wtvxxuyee73gugficymc7t4x0zm.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the article </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúThe Magic of Virtualization: An Introductory Course in Proxmox VE‚Äù,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> we successfully installed a hypervisor on the server, connected the storage to it, took care of basic security and even created the first virtual machine. Now we‚Äôll look at how to implement the most basic tasks that you have to perform in order to always be able to restore the services in case of failure. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Established Proxmox tools allow you to not only back up data, but also create sets of pre-configured images of operating systems for quick deployment. This not only helps if necessary to create a new server for any service in a few seconds, but also reduces downtime to a minimum.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will not talk about the need to create backups, since this is obvious and has long been an axiom. </font><font style="vertical-align: inherit;">Let us dwell on some unobvious things and features.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First, consider how the data is saved during the backup procedure.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Backup algorithms</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To begin with, Proxmox has a good staffing toolkit for creating backups of virtual machines. </font><font style="vertical-align: inherit;">It allows you to easily save all the data of the virtual machine and supports two compression mechanisms, as well as three methods for creating these copies. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let us first examine the compression mechanisms:</font></font><br>
<br>
<ol>
<li><b> LZO</b>.     ,     90- .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> </a> (  Proxmox  lzop).        . ,   ,     ,        .</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compressing the GZIP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Using this algorithm, the backup will be compressed on the fly with the GNU Zip utility, which uses the powerful Deflate algorithm created by </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phil Katz</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The main emphasis is on maximum data compression, which reduces the disk space occupied by backups. </font><font style="vertical-align: inherit;">The main difference from LZO is that the compression / decompression procedures take a fairly large amount of time.</font></font></li>
</ol><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Archiving Modes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Proxmox offers three backup methods for the system administrator to choose from. </font><font style="vertical-align: inherit;">Using them, you can solve the required problem by determining the priority between the need for downtime and the reliability of the backup:</font></font><br>
<br>
<ol>
<li><b> Snapshot ()</b>.       Live backup,          .       VM,       ‚Äî    -         .  ,   ,      .     ,     ,    .</li>
<li><b> Suspend ()</b>.    ¬´¬ª  ,     .     ,        ,     . ,        ,    /  ,      . ,       .              .</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stop mode</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The most reliable backup method, but requiring a complete shutdown of the virtual machine. </font><font style="vertical-align: inherit;">A command is sent to shutdown normally, after stopping, a backup is performed and then a command is issued to turn on the virtual machine. </font><font style="vertical-align: inherit;">The number of errors with this approach is minimal and most often reduced to zero. </font><font style="vertical-align: inherit;">Backups created in this way almost always deploy correctly.</font></font></li>
</ol><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perform backup procedure</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To back up:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We pass to the necessary virtual machine.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reservation</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> item </font><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Click the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reserve Now</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> button </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">A window will open in which you can select the options for the future backup.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/et/gn/fu/etgnfuz7yjw9dohf4ktcvphtxry.png"></div><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As the storage we indicate the one that we connected </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in the previous part</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After selecting the parameters, click the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Backup</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> button </font><font style="vertical-align: inherit;">and wait until the backup is created. </font><font style="vertical-align: inherit;">This will be indicated by the inscription </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TASK OK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/u-/8i/pc/u-8ipc1amu1z51u4ibgh9tjxs-o.png"></div><br>
</li>
</ol><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now created archives with backups of virtual machines will be available for download from the server. </font><font style="vertical-align: inherit;">The simplest and most common way of copying is SFTP. </font><font style="vertical-align: inherit;">To do this, use the popular Cross-platform FTP client FileZilla, which can work using the SFTP protocol.</font></font><br>
<br>
<ol>
<li>  <b></b>  IP-   ,   <b> </b>  root,   <b></b> ‚Äî ,     ,    <b></b>  ¬´22¬ª (   ,     SSH-).</li>
<li>  <b> </b> ,      ,        ,   .</li>
<li>   <b>/mnt/storage</b>.         ¬´dump¬ª.    :<ul>
<li><b>vzdump-qemu-_--.vma.gz</b>     GZIP;</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vzdump-qemu-machine_number-date-time.vma.lzo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> if the LZO method is selected.</font></font></li>
</ul></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is recommended that you download backups immediately from the server and save them in a safe place, for example, in our cloud storage. </font><font style="vertical-align: inherit;">If you unzip a file with the resolution vma, the utility of the same name that comes bundled with Proxmox, then files with the extensions </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">raw</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conf</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fw</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will be inside </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">These files contain the following:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">raw</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - disk image;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conf</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - VM configuration;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fw</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - firewall settings.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Restore from backup</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consider the situation when the virtual machine was accidentally deleted and its emergency recovery from the backup is required:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Open the storage on which the backup lies.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Go to the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Content</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tab </font><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select the desired copy and click the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Restore</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> button </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bg/ou/ts/bgoutsyb4clkt_qx4xy88avgtqq.png"></div><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We specify the target storage and the ID that will be assigned to the machine after the process is completed.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Click the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Restore</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> button </font><font style="vertical-align: inherit;">.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Once recovery is complete, the VM will appear in the list of available.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Virtual machine cloning</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, suppose a company needs to make changes to a critical service. </font><font style="vertical-align: inherit;">Such a change is implemented by making many changes to the configuration files. </font><font style="vertical-align: inherit;">The result is unpredictable and any error can cause a service failure. </font><font style="vertical-align: inherit;">To prevent such an experiment from affecting a running server, it is recommended that you clone the virtual machine.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The cloning mechanism will create an exact copy of the virtual server with which it is permissible to make any changes without affecting the operation of the main service. Then, if the changes are successfully applied, the new VM starts up and the old one shuts down. There is a feature in this process that should always be remembered. On the cloned machine, the IP address will be exactly the same as the source VM, that is, when it starts, there will be an address conflict.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will tell you how to avoid such a situation. Immediately before performing the cloning, you should make changes to the network configuration. To do this, you need to temporarily change the IP address, but do not restart the network service. After cloning on the main machine, you should return the settings back, and on the cloned machine, specify any other IP address. Thus, we get two copies of the same server at different addresses. This will quickly introduce a new service. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If this service is a web server, then you just need to change the A-record of your DNS provider, after which client requests for this domain name will already be sent to the address of the cloned virtual machine.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By the way, Selectel provides all its customers with the service of placing any number of domains on NS servers for free. </font><font style="vertical-align: inherit;">Records management is carried out both using our control panel, and using a special API. </font><font style="vertical-align: inherit;">Read more about this </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in our knowledge base</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloning a VM in Proxmox is a very simple task. </font><font style="vertical-align: inherit;">To perform it, you must perform the following steps:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Go to the car we need.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Choose from the menu </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">More</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> click </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the Clone</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the window that opens, fill in the Name parameter.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3n/on/wn/3nonwng-06gxpllialr7u_9ck2m.png"></div></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clone by pressing the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clone</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> button </font><font style="vertical-align: inherit;">.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This tool allows you to make a copy of a virtual machine not only on the local server. </font><font style="vertical-align: inherit;">If several virtualization servers are combined into a cluster, then using this tool you can immediately move the created copy to the desired physical server. </font><font style="vertical-align: inherit;">A useful function is the choice of disk storage ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Target Storage</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> parameter </font><font style="vertical-align: inherit;">), which is very convenient when moving a virtual machine from one physical medium to another.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Virtual Drive Formats</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will tell you more about the drive formats used in Proxmox:</font></font><br>
<br>
<ol>
<li><b>RAW</b>.     .       ¬´  ¬ª    .    ,       mount   linux-.      ¬´¬ª ,        .<br>
<br>
     ,        ,             RAW (        ).</li>
<li><b>QEMU image format (qcow2)</b>. ,       .    ,             . ,    40  ,      2 ,         VM.        .<br>
<br>
       :        ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  nbd</a>,     <b>qemu-nbd</b>,            .       ,   ,       .<br>
<br>
 ,    -      ,           .        ,     RAW.</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VMware image format (vmdk)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">This format is native to the VMware vSphere hypervisor and has been included with Proxmox for compatibility. </font><font style="vertical-align: inherit;">It allows you to migrate a VMware virtual machine to the Proxmox infrastructure. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using vmdk on an ongoing basis is not recommended, this format is the slowest in Proxmox, so it is suitable only for migration, no more. </font><font style="vertical-align: inherit;">Probably in the foreseeable future this shortcoming will be eliminated.</font></font></li>
</ol><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Work with disk images</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Included with Proxmox is a very convenient utility called </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qemu-img</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">One of its functions is to convert images of virtual disks. </font><font style="vertical-align: inherit;">To use it, just open the hypervisor console and run the command in the format:</font></font><br>
<br>
<pre><code class="plaintext hljs">qemu-img convert -f vmdk test.vmdk -O qcow2 test.qcow2</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the above example, the vmdk image of the VMware virtual drive called </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">test</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will be converted to </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qcow2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> format </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">This is a very useful command when you need to correct a mistake in the initial format selection. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thanks to the same command, you can force the desired image using the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">create</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> argument </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">qemu-img create -f raw test.raw 40G</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Such a command will create a test image in </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAW</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> format </font><font style="vertical-align: inherit;">, 40 GB in size. </font><font style="vertical-align: inherit;">Now it is suitable for connecting to any of the virtual machines.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Resize a virtual disk</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In conclusion, we will show how to increase the size of a disk image if, for some reason, the space on it is no longer enough. </font><font style="vertical-align: inherit;">To do this, use the resize argument:</font></font><br>
<br>
<pre><code class="plaintext hljs">qemu-img resize -f raw test.raw 80G</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now our image has become the size of 80 GB. </font><font style="vertical-align: inherit;">You can view detailed information about the image using the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">info</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> argument </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">qemu-img info test.raw</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Do not forget that the image extension itself will not increase the size of the partition automatically - it will simply add the available free space. </font><font style="vertical-align: inherit;">To enlarge the section, use the command:</font></font><br>
<br>
<pre><code class="plaintext hljs">resize2fs /dev/sda1</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
where </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ dev / sda1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the desired partition.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Automate backups</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using the manual method of creating backups is a very time-consuming task and takes a lot of time. </font><font style="vertical-align: inherit;">Therefore, Proxmox VE includes a tool for automatic scheduled backups. </font><font style="vertical-align: inherit;">Consider how to do this:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Using the web interface of the hypervisor, open the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datacenter</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> item </font><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reservation</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> item </font><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Click the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Add</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> button </font><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We set the parameters for the scheduler.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/5d/a0/tu/5da0tunglle5mwsvudggbwjyuhc.png"></div><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Check the box </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enable</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Save the changes using the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Create</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> button </font><font style="vertical-align: inherit;">.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now the scheduler will automatically start the backup program at the exact specified time, based on the specified schedule.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We considered regular methods of backup and recovery of virtual machines. Their use allows you to save all the data without any problems and urgently restore them in case of emergency. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Of course, this is not the only possible way to save important data. There are many tools, for example, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Duplicity</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , with which you can create full and incremental copies of the contents of virtual servers based on Linux.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When performing backup procedures, you should always consider that they are actively loading the disk subsystem. </font><font style="vertical-align: inherit;">In this regard, it is recommended to perform these procedures at times of minimum load in order to avoid delays when performing I / O operations inside the machines. </font><font style="vertical-align: inherit;">You can monitor the status of disk operation delays directly from the web interface of the hypervisor (IO delay parameter).</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/en486194/">https://habr.com/ru/post/en486194/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en486184/index.html">How to use search effectively</a></li>
<li><a href="../en486186/index.html">Catastrophic Cloud: How It Works</a></li>
<li><a href="../en486188/index.html">Introducing PostgreSQL wal-g backup system</a></li>
<li><a href="../en486190/index.html">Our experience in developing a CSI driver in Kubernetes for Yandex.Cloud</a></li>
<li><a href="../en486192/index.html">Cyber ‚Äã‚Äãfraudsters hack mobile operators to get to phone numbers of subscribers</a></li>
<li><a href="../en486198/index.html">Talking is hard. Essays on Communicating with Non-Programmers</a></li>
<li><a href="../en486200/index.html">Docker Tips: Clean Your Machine From Junk</a></li>
<li><a href="../en486202/index.html">Alpine collects Docker builds under Python 50 times slower, and images 2 times heavier</a></li>
<li><a href="../en486204/index.html">Profession: System Administrator</a></li>
<li><a href="../en486206/index.html">What types of fraud have I encountered in freelance and outsourcing</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>