<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåó ‚óªÔ∏è üßëüèΩ Transfer√™ncia de din√¢mica molecular para CUDA. Parte I: O B√°sico üîû üë©üèª‚Äç‚öïÔ∏è üå°Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O objetivo deste artigo √© levantar as quest√µes de paralelizar o c√≥digo de um programa para modelagem num√©rica usando o m√©todo de din√¢mica molecular (M...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Transfer√™ncia de din√¢mica molecular para CUDA. Parte I: O B√°sico</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/508396/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O objetivo deste artigo √© levantar as quest√µes de paralelizar o c√≥digo de um programa para modelagem num√©rica usando o m√©todo de din√¢mica molecular (MD) usando a tecnologia CUDA. Por que isso √© necess√°rio, uma vez que j√° existem pacotes de software MD, incluindo aqueles que funcionam com o CUDA? O fato √© que estou desenvolvendo meu pr√≥prio conceito de um "campo de for√ßa n√£o constante", que n√£o √© implementado nos programas de MD existentes. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Remanejar o c√≥digo de outra pessoa para essas necessidades √© uma tarefa bastante ingrata, por isso decidi transferir meu c√≥digo sequencial j√° escrito e, ao mesmo tempo, compartilhar algumas id√©ias. Al√©m disso, esta √© uma resposta ao coment√°rio que geralmente pisca aqui em artigos da CUDA como </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">este</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o, o que √© din√¢mica molecular? </font><font style="vertical-align: inherit;">No Habr√© j√° existem v√°rios posts sobre esse assunto, por exemplo, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Resumidamente, o MD √© um m√©todo que permite simular o movimento de muitas part√≠culas (incluindo √°tomos, √≠ons, mol√©culas) e calcular as propriedades coletivas do sistema, dependendo desse movimento. </font><font style="vertical-align: inherit;">Como funciona? </font><font style="vertical-align: inherit;">Suponhamos que, para um conjunto de N part√≠culas, sejam dadas algumas coordenadas, velocidades, massas e (mais importante!) Leis de intera√ß√£o entre elas. </font><font style="vertical-align: inherit;">Mudamos as coordenadas de acordo com as velocidades. </font><font style="vertical-align: inherit;">Com base nas leis da intera√ß√£o, calculamos as for√ßas que atuam entre as part√≠culas. </font><font style="vertical-align: inherit;">Desde que conhecemos for√ßa e massa, sabemos acelera√ß√£o. </font><font style="vertical-align: inherit;">Ajustamos a velocidade levando em considera√ß√£o a acelera√ß√£o. </font><font style="vertical-align: inherit;">E, novamente, passamos a alterar as coordenadas. </font><font style="vertical-align: inherit;">Ent√£o repetimos milhares de vezes at√© </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">voc√™ se cansar</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> N√£o temos estat√≠sticas suficientes.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<img src="https://habrastorage.org/getpro/habr/post_images/d14/4f3/4f0/d144f34f09888282c2118202bc8d201a.jpg" alt="imagem">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em aplica√ß√µes reais, a sequ√™ncia de c√°lculos da ‚Äúcoordenada - velocidade - for√ßa‚Äù √© um pouco mais complicada, com base na expans√£o em uma s√©rie de fun√ß√µes da coordenada de part√≠culas. O mais comum √© o algoritmo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Velocity Verlet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . O pseudoc√≥digo do programa MD baseado no integrador Verlet √© o seguinte:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs">init_md;
<span class="hljs-keyword">int</span> iStep = <span class="hljs-number">0</span>;
<span class="hljs-keyword">while</span> (iStep &lt; nStep)<font></font>
{<font></font>
    reset_quantities;<font></font>
    clear_cell_list;<font></font>
    verlet_1stage;<font></font>
    forces_calculation;<font></font>
    verlet_2stage;<font></font>
    temp_scale;<font></font>
    termostat;<font></font>
    some_output;<font></font>
    iStep++;<font></font>
}<font></font>
final_md; <font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O loop principal do programa executa um n√∫mero de vezes especificado pelo usu√°rio ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nStep</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Uma itera√ß√£o desse loop √© chamada de etapa do tempo, ou simplesmente uma etapa de tempo. As fun√ß√µes </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INIT_MD</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reset_quantites</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">some_output</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">final_md</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o ser√£o consideradas, elas l√™em informa√ß√µes de entrada, valores zerados, produzem os dados, alocam e liberam mem√≥ria, etc. Do ponto de vista da produ√ß√£o de informa√ß√µes, a din√¢mica molecular √© ideal para c√°lculos em uma placa de v√≠deo: a maioria dos c√°lculos n√£o precisa ser descarregada. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fun√ß√µes </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verlet_1stage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verlet_2stage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">temp_scale</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">termostato</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relacionam-se ao integrador de equa√ß√µes de movimento e temperatura. </font><font style="vertical-align: inherit;">A fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forces_calculation</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> calcula as for√ßas que atuam entre as part√≠culas e a fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">clear_cell_list</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> refere-se √† t√©cnica de acelerar c√°lculos (mais sobre isso mais adiante). </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considere todos esses grupos de fun√ß√µes.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 Integra√ß√£o de equa√ß√µes de movimento</font></font></h2>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A ess√™ncia do primeiro est√°gio do algoritmo Verlet pode ser expressa pelas seguintes f√≥rmulas:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>X</mi><mo>=</mo><mi>X</mi><mo>+</mo><mi>V</mi><mi>d</mi><mi>t</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mi>d</mi><msup><mi>t</mi><mn>2</mn></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.568ex" height="5.134ex" viewBox="0 -1455.1 9716.9 2210.6" role="img" focusable="false" style="vertical-align: -1.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-58" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-3D" x="1130" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-58" x="2186" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-2B" x="3261" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-56" x="4262" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-64" x="5031" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-74" x="5555" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-2B" x="6138" y="0"></use><g transform="translate(6917,0)"><g transform="translate(342,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-46" x="124" y="676"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-6D" x="60" y="-686"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-64" x="8377" y="0"></use><g transform="translate(8901,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-32" x="511" y="583"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>X</mi><mo>=</mo><mi>X</mi><mo>+</mo><mi>V</mi><mi>d</mi><mi>t</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mi>d</mi><msup><mi>t</mi><mn>2</mn></msup></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1">X = X + Vdt + \frac{F}{m}dt^2</script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>V</mi><mo>=</mo><mi>V</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mo>.</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.928ex" height="5.134ex" viewBox="0 -1455.1 6858 2210.6" role="img" focusable="false" style="vertical-align: -1.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-56" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-3D" x="1047" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-56" x="2103" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-2B" x="3095" y="0"></use><g transform="translate(3873,0)"><g transform="translate(342,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-46" x="124" y="676"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(5334,0)"><g transform="translate(120,0)"><rect stroke="none" width="1005" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-74" x="523" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-32" x="252" y="-686"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-2E" x="6579" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>V</mi><mo>=</mo><mi>V</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mo>.</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2">V = V + \frac{F}{m}\frac{dt}{2}. </script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Segundo:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>V</mi><mo>=</mo><mi>V</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mo>,</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.928ex" height="5.134ex" viewBox="0 -1455.1 6858 2210.6" role="img" focusable="false" style="vertical-align: -1.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-56" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-3D" x="1047" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-56" x="2103" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-2B" x="3095" y="0"></use><g transform="translate(3873,0)"><g transform="translate(342,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-46" x="124" y="676"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(5334,0)"><g transform="translate(120,0)"><rect stroke="none" width="1005" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-74" x="523" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-32" x="252" y="-686"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-2C" x="6579" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>V</mi><mo>=</mo><mi>V</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mo>,</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3">V = V + \frac{F}{m}\frac{dt}{2},</script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
onde X √© a coordenada da part√≠cula, V √© a sua velocidade, F √© a for√ßa que atua sobre ela, m √© a sua massa e dt √© o intervalo de tempo. </font><font style="vertical-align: inherit;">Tudo isso se aplica a todas as part√≠culas e, naturalmente, ocorre em 3 dimens√µes, portanto:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">verlet_1stage</span><span class="hljs-params">(<span class="hljs-keyword">int</span> atPerBlock, <span class="hljs-keyword">int</span> atPerThread, cudaMD *md)</span>
</span>{
  <span class="hljs-keyword">int</span> i, t
  <span class="hljs-keyword">float</span> charge;
  <span class="hljs-keyword">float</span> engElecField = <span class="hljs-number">0.0</span>;		<span class="hljs-comment">//     </span>
  __shared__ <span class="hljs-keyword">float</span> shEngElField;	<span class="hljs-comment">// shared   </span><font></font>
<font></font>
  <span class="hljs-comment">//    shared </span>
    <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
        shEngElField = <span class="hljs-number">0</span>;<font></font>
    __syncthreads();<font></font>
<font></font>
  <span class="hljs-comment">//   ,     </span>
 <span class="hljs-keyword">int</span> id0 = blockIdx.x * atPerBlock + threadIdx.x * atPerThread;
 <span class="hljs-keyword">int</span> N = min(id0 + atPerThread, md-&gt;nAt);<font></font>
<font></font>
  <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
  {<font></font>
<font></font>
     t = md-&gt;types[i];<font></font>
     charge = md-&gt;specs[t].charge;<font></font>
<font></font>
     <span class="hljs-comment">//  v = v + f/m * 0.5 dt</span><font></font>
     md-&gt;vls[i].x += md-&gt;rMasshdT[i] * md-&gt;frs[i].x;<font></font>
     md-&gt;vls[i].y += md-&gt;rMasshdT[i] * md-&gt;frs[i].y;<font></font>
     md-&gt;vls[i].z += md-&gt;rMasshdT[i] * md-&gt;frs[i].z;<font></font>
<font></font>
     <span class="hljs-comment">// x = x + v * dt</span><font></font>
     md-&gt;xyz[i].x += md-&gt;vls[i].x * md-&gt;tSt;<font></font>
     md-&gt;xyz[i].y += md-&gt;vls[i].y * md-&gt;tSt;<font></font>
     md-&gt;xyz[i].z += md-&gt;vls[i].z * md-&gt;tSt;<font></font>
<font></font>
     put_periodic(&amp;md-&gt;xyz[i], md-&gt;vls[i], md-&gt;masses[i], md-&gt;types[i], md);<font></font>
<font></font>
     keep_in_cell(i, md-&gt;xyz[i], md);<font></font>
<font></font>
     <span class="hljs-comment">//   </span>
     engElecField += charge * md-&gt;xyz[i].x * md-&gt;elecField.x; <span class="hljs-comment">// Eng = q * x * dU/dx</span><font></font>
  }<font></font>
<font></font>
  <span class="hljs-comment">//     shared ‚Ä¶</span><font></font>
  atomicAdd(&amp;shEngElField, engElecField);<font></font>
   __syncthreads();<font></font>
<font></font>
  <span class="hljs-comment">//..    </span>
  <span class="hljs-keyword">if</span> (!threadIdx.x)   <span class="hljs-comment">// 0th thread</span><font></font>
  {<font></font>
      atomicAdd(&amp;md-&gt;engElecField, shEngElField);<font></font>
  }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os par√¢metros de entrada </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atPerBlock</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atPerTherad</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> s√£o iguais ao n√∫mero de part√≠culas (√°tomos) processadas por um bloco e fluxo, respectivamente. </font><font style="vertical-align: inherit;">Como o n√∫mero de √°tomos nesses c√°lculos geralmente √© constante, essas vari√°veis ‚Äã‚Äãpodem ser calculadas de uma vez por todas em algum lugar da fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">init_md</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">O par√¢metro </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">md</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do </font><font style="vertical-align: inherit;">tipo * cudaMD √© um link para a estrutura, que cont√©m links para todas as vari√°veis ‚Äã‚Äãnecess√°rias para o c√°lculo, como:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nAt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© o n√∫mero de part√≠culas;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xyz</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - uma matriz de coordenadas do tipo float3;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vls</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - uma matriz de velocidades do tipo float3 (3 componentes do vetor);</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">frs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - conjunto de for√ßas (tamb√©m 3 componentes do vetor);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a matriz </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rMasshdT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> armazena </font><b><font style="vertical-align: inherit;">imediatamente</font></b><font style="vertical-align: inherit;"> a express√£o 0,5 * dt * m para cada part√≠cula;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tipos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - uma matriz de tipos de part√≠culas, porque os √°tomos podem ser diferentes;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A matriz de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">especifica√ß√µes</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> armazena propriedades de part√≠culas, massa, carga, etc. </font><font style="vertical-align: inherit;">Para obter as propriedades da i-√©sima part√≠cula, voc√™ precisa inverter a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">especifica√ß√£o</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do formul√°rio </font><b><font style="vertical-align: inherit;">[types [i]]</font></b><font style="vertical-align: inherit;"> .</font></font></li>
</ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Combinei tudo isso em uma estrutura para n√£o passar um monte de par√¢metros para a fun√ß√£o. </font><font style="vertical-align: inherit;">Talvez essa n√£o seja a melhor solu√ß√£o? </font><font style="vertical-align: inherit;">Talvez valesse a pena declarar-lhes vari√°veis ‚Äã‚Äãglobais? </font><font style="vertical-align: inherit;">N√£o no sentido em que est√£o na mem√≥ria global, mas no fato de serem vis√≠veis em todas as fun√ß√µes do programa. </font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Discutiremos a </font><font style="vertical-align: inherit;">fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">keep_in_cell</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> na se√ß√£o para acelerar c√°lculos, e a fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">put_periodic</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> coloca uma part√≠cula em um volume simulado (caixa) se ela sair dela (como em um pacman, como √© apropriado)</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ousar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em seu post sobre MD). </font><font style="vertical-align: inherit;">Bem, como a fun√ß√£o descrita executa uma atualiza√ß√£o das coordenadas das part√≠culas, faz sentido calcular todas as energias que dependem apenas das coordenadas, por exemplo, a energia das part√≠culas em um campo externo, se houver. </font><font style="vertical-align: inherit;">A seguir, de acordo com uma observa√ß√£o v√°lida</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avdx</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Removi a fun√ß√£o do c√≥digo, removi o </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zeramento de</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vari√°veis ‚Äã‚Äãcomo </font><b><font style="vertical-align: inherit;">md-&gt; engElecField</font></b><font style="vertical-align: inherit;"> e </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">md-&gt; engKin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , a fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reset_quantites</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> agora est√° selecionada para esses fins </font><font style="vertical-align: inherit;">. A pergunta sobre a fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verlet_1stage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© a </font><font style="vertical-align: inherit;">seguinte: </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">algumas vari√°veis ‚Äã‚Äã(coordenadas, velocidades etc.) s√£o usadas v√°rias vezes e √© aconselh√°vel descarreg√°-las primeiro em uma mem√≥ria mais r√°pida? Ou o compilador √© capaz de otimizar essas coisas?</font></font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
A fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">put_periodic</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> faz com que uma part√≠cula que voe para fora das bordas da regi√£o simulada (caixa) apare√ßa do outro lado (condi√ß√µes de contorno peri√≥dicas):</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">put_periodic</span><span class="hljs-params">(float3&amp; xyz, float3 vel, <span class="hljs-keyword">float</span> mass, <span class="hljs-keyword">int</span> type, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">if</span> (xyz.x &lt; <span class="hljs-number">0</span>)<font></font>
   {<font></font>
      xyz.x += md-&gt;leng.x;<font></font>
<font></font>
      atomicAdd(&amp;md-&gt;specAcBoxNeg[type].x, <span class="hljs-number">1</span>); <font></font>
      atomicAdd(&amp;md-&gt;negMom.x, mass * (-vel.x)); <font></font>
   }<font></font>
   <span class="hljs-keyword">else</span>
     <span class="hljs-keyword">if</span> (xyz.x &gt;= md-&gt;leng.x)<font></font>
     {<font></font>
        xyz.x -= md-&gt;leng.x;<font></font>
<font></font>
        atomicAdd(&amp;md-&gt;specAcBoxPos[type].x, <span class="hljs-number">1</span>);<font></font>
        atomicAdd(&amp;md-&gt;posMom.x, mass * vel.x);<font></font>
     }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A fun√ß√£o funciona para uma caixa com a geometria de uma caixa retangular. </font><font style="vertical-align: inherit;">O c√≥digo √© para medir x, o restante das medi√ß√µes √© completamente semelhante. </font><font style="vertical-align: inherit;">Os </font><b><font style="vertical-align: inherit;">campos </font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">leng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">revLeng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> s√£o o tamanho da caixa na dimens√£o correspondente e seu valor inverso. </font><font style="vertical-align: inherit;">Em geral, para retornar uma part√≠cula ao boxe, voc√™ pode prescindir de operadores condicionais:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs">xyz.x -= <span class="hljs-built_in">floor</span>(xyz.x * md-&gt;revLeng.x) * md-&gt;leng.x;</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usei operadores condicionais na vers√£o serial, porque tinha que contar o n√∫mero de part√≠culas que passavam pelo limite da caixa e o momento total dessas part√≠culas (a press√£o pode ser expressa a partir dele). </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esses contadores tamb√©m est√£o inclu√≠dos no c√≥digo acima, talvez para o CUDA voc√™ precise pensar em como ficar sem o if</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A segunda parte do integrador de velocidade Verlet:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">verlet_2stage</span><span class="hljs-params">(<span class="hljs-keyword">int</span> atPerBlock, <span class="hljs-keyword">int</span> atPerThread, cudaMD *md)</span>
</span>{
  <span class="hljs-keyword">int</span> i;
  <span class="hljs-keyword">float</span> kinE = <span class="hljs-number">0.0</span>;		<span class="hljs-comment">//  </span>
  __shared__ <span class="hljs-keyword">float</span> shKinE;	<span class="hljs-comment">// shared </span><font></font>
<font></font>
 <span class="hljs-keyword">int</span> id0 = blockIdx.x * atPerBlock + threadIdx.x * atPerThread;
 <span class="hljs-keyword">int</span> N = min(id0 + atPerThread, md-&gt;nAt);<font></font>
<font></font>
  <span class="hljs-comment">//     shared </span>
 <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
        shKinE = <span class="hljs-number">0.0</span>;<font></font>
  __syncthreads();<font></font>
<font></font>
<font></font>
  <span class="hljs-comment">// v = v + f/m * 0.5 dt</span>
  <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
  {<font></font>
    md-&gt;vls[i].x += md-&gt;rMasshdT[i] * md-&gt;frs[i].x;<font></font>
    md-&gt;vls[i].y += md-&gt;rMasshdT[i] * md-&gt;frs[i].y;<font></font>
    md-&gt;vls[i].z += md-&gt;rMasshdT[i] * md-&gt;frs[i].z;<font></font>
<font></font>
    <span class="hljs-comment">//  mv2</span><font></font>
    kinE += (md-&gt;vls[i].x * md-&gt;vls[i].x + md-&gt;vls[i].y  * md-&gt;vls[i].y + md-&gt;vls[i].z * md-&gt;vls[i].z) * md-&gt;masses[i];<font></font>
  }<font></font>
<font></font>
  <span class="hljs-comment">//      shared memory...</span>
  atomicAdd(&amp;shKinE, <span class="hljs-number">0.5</span> * kinE);   <span class="hljs-comment">// kinE = mv2/2</span><font></font>
  __syncthreads();<font></font>
  <span class="hljs-comment">//...   global memory</span>
  <span class="hljs-keyword">if</span> (!threadIdx.x)<font></font>
     atomicAdd(&amp;md-&gt;engKin, shKinE);<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O c√≥digo de estrutura √© completamente semelhante √† primeira parte do integrador. Atualizamos as velocidades de cada part√≠cula, resumimos a energia cin√©tica. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fun√ß√µes ‚Äútemperatura‚Äù </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">temp_scale</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">termostato</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Os sistemas moleculares diferem dos mec√¢nicos por terem o conceito de temperatura. MD herdou a defini√ß√£o de temperatura da </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">teoria molecular-cin√©tica</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , em que a temperatura √© um valor proporcional √† energia </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">cin√©tica</font></a><font style="vertical-align: inherit;"> m√©dia das part√≠culas (h√° raz√µes para acreditar que isso √© uma fal√°cia). Para manter a temperatura desejada nesses termos, voc√™ pode simplesmente escalar as velocidades das part√≠culas, como faz a fun√ß√£o temp_scale:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">temp_scale</span><span class="hljs-params">(<span class="hljs-keyword">int</span> atPerBlock, <span class="hljs-keyword">int</span> atPerThread, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">float</span> k;
   <span class="hljs-keyword">int</span> i;
   <span class="hljs-keyword">int</span> id0 = blockIdx.x * atPerBlock + threadIdx.x * atPerThread;
   <span class="hljs-keyword">int</span> N = min(id0 + atPerThread, md-&gt;nAt);<font></font>
<font></font>
   k = <span class="hljs-built_in">sqrt</span>(md-&gt;teKin / md-&gt;engKin);
   <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; N; i++)<font></font>
   {<font></font>
      md-&gt;vls[i].x *= k;<font></font>
      md-&gt;vls[i].y *= k;<font></font>
      md-&gt;vls[i].z *= k;<font></font>
   }<font></font>
<font></font>
   <span class="hljs-keyword">if</span> (!blockIdx.x)
    <span class="hljs-keyword">if</span> (!threadIdx.x)<font></font>
     {<font></font>
        md-&gt;engKin = md-&gt;teKin;<font></font>
     }<font></font>
} <font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O campo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">teKin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cont√©m a energia cin√©tica alvo, √© proporcional √† temperatura definida pelo usu√°rio. A fun√ß√£o simplesmente multiplica todos os componentes dos vetores de velocidade por k e, em seguida, um fluxo define a energia cin√©tica igual ao valor fornecido. </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqui, a vari√°vel </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k √©</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> definida em cada thread, embora seja poss√≠vel defini-la em uma (uma vez que √© a mesma) para n√£o fazer trabalhos desnecess√°rios, principalmente porque a raiz quadrada est√° envolvida.</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Essa escala de temperatura primitiva √© geralmente usada nos est√°gios preliminares da simula√ß√£o (per√≠odo de equil√≠brio) com uma frequ√™ncia de v√°rias etapas. </font><font style="vertical-align: inherit;">Algoritmos de manuten√ß√£o da temperatura mais sofisticados (termostatos) simulam colis√µes de part√≠culas com algum reservat√≥rio de uma determinada temperatura, o mais popular √© o termostato </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nose-Hoover</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">tstat_nose</span><span class="hljs-params">(<span class="hljs-keyword">int</span> atPerBlock, <span class="hljs-keyword">int</span> atPerThread, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">int</span> i;<font></font>
<font></font>
<span class="hljs-comment">//          </span>
<span class="hljs-comment">//   if (!blockIdx.x)</span>
<span class="hljs-comment">//     if (!threadIdx.x)   </span>
<span class="hljs-comment">//        md-&gt;chit += md-&gt;tSt * (md-&gt;engKin - md-&gt;teKin) * md-&gt;rQmass;</span>
<span class="hljs-comment">//   __synctreads();</span><font></font>
<font></font>
   <span class="hljs-keyword">float</span> scale = <span class="hljs-number">1.0</span> - md-&gt;tSt * md-&gt;chit;<font></font>
<font></font>
   <span class="hljs-keyword">int</span> id0 = blockIdx.x * atPerBlock + threadIdx.x * atPerThread;
   <span class="hljs-keyword">int</span> N = min(id0 + atPerThread, md-&gt;nAt);<font></font>
<font></font>
   <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
   {<font></font>
       md-&gt;vls[i].x *= scale;<font></font>
       md-&gt;vls[i].y *= scale;<font></font>
       md-&gt;vls[i].z *= scale;<font></font>
   }<font></font>
<font></font>
   <span class="hljs-keyword">if</span> (!blockIdx.x)
     <span class="hljs-keyword">if</span> (!threadIdx.x)   <font></font>
     {<font></font>
        md-&gt;engKin = md-&gt;engKin * scale * scale;<font></font>
        md-&gt;consInt += md-&gt;tSt * md-&gt;chit * md-&gt;qMassTau2;<font></font>
        md-&gt;chit += md-&gt;tSt * (md-&gt;engKin - md-&gt;teKin) * md-&gt;rQmass; <font></font>
     }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A diferen√ßa da fun√ß√£o anterior est√° apenas em uma defini√ß√£o mais complexa do fator de corre√ß√£o. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para resumir esse grupo de fun√ß√µes. </font><font style="vertical-align: inherit;">Todos eles s√£o perfeitamente paralelizados, n√£o apenas porque executam exatamente as mesmas a√ß√µes para todas as part√≠culas, mas tamb√©m porque n√£o exigem refer√™ncias cruzadas. </font><font style="vertical-align: inherit;">O fluxo, processando matrizes com o √≠ndice i, n√£o acessa o √≠ndice j, n√£o h√° conflito de acesso aos mesmos dados.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 C√°lculo de for√ßas e lista de c√©lulas</font></font></h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nos sistemas moleculares, a principal fonte de for√ßas que atua sobre a part√≠cula (exceto os campos externos j√° mencionados) s√£o outras part√≠culas. </font><font style="vertical-align: inherit;">O c√°lculo dessas for√ßas √© a parte mais complexa, demorada e amb√≠gua do MD. </font><font style="vertical-align: inherit;">Uma das aproxima√ß√µes mais simples √© que todas as intera√ß√µes no sistema s√£o a soma das intera√ß√µes entre cada par de part√≠culas (aproxima√ß√£o por pares). </font><font style="vertical-align: inherit;">Para esses prop√≥sitos, um potencial de par √© introduzido - uma depend√™ncia funcional da energia potencial de intera√ß√£o de duas part√≠culas na dist√¢ncia entre elas. </font><font style="vertical-align: inherit;">Os potenciais de pares mais famosos: o potencial de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lennard-Jones</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ou "6-12"), </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buckingham</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e Born-Mayer-Huggins. </font><font style="vertical-align: inherit;">Por exemplo, darei as express√µes anal√≠ticas dos dois primeiros:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>U</mi><mo>=</mo><mn>4</mn><mi>&amp;#x03F5;</mi><mo stretchy=&quot;false&quot;>(</mo><mfrac><msup><mi>&amp;#x03C3;</mi><mn>6</mn></msup><msup><mi>r</mi><mn>6</mn></msup></mfrac><mo>&amp;#x2212;</mo><mfrac><msup><mi>&amp;#x03C3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>12</mn></mrow></msup><msup><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>12</mn></mrow></msup></mfrac><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.901ex" height="5.634ex" viewBox="0 -1616.6 8137.9 2425.9" role="img" focusable="false" style="vertical-align: -1.88ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-55" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-3D" x="1045" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-34" x="2101" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-3F5" x="2602" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-28" x="3008" y="0"></use><g transform="translate(3398,0)"><g transform="translate(120,0)"><rect stroke="none" width="1146" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-3C3" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-36" x="810" y="513"></use></g><g transform="translate(120,-736)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-36" x="638" y="408"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-2212" x="5007" y="0"></use><g transform="translate(5785,0)"><g transform="translate(342,0)"><rect stroke="none" width="1500" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-3C3" x="0" y="0"></use><g transform="translate(572,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-32" x="500" y="0"></use></g></g><g transform="translate(120,-736)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,288)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-32" x="500" y="0"></use></g></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-29" x="7748" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>U</mi><mo>=</mo><mn>4</mn><mi>œµ</mi><mo stretchy="false">(</mo><mfrac><msup><mi>œÉ</mi><mn>6</mn></msup><msup><mi>r</mi><mn>6</mn></msup></mfrac><mo>‚àí</mo><mfrac><msup><mi>œÉ</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msup><msup><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msup></mfrac><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4">U=4\epsilon(\frac{\sigma^6}{r^6}-\frac{\sigma^{12}}{r^{12}})</script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>U</mi><mo>=</mo><mi>A</mi><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><mfrac><mi>r</mi><mi>&amp;#x03C1;</mi></mfrac><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mfrac><mi>C</mi><msup><mi>r</mi><mn>6</mn></msup></mfrac><mo>,</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.645ex" height="5.634ex" viewBox="0 -1455.1 9750.1 2425.9" role="img" focusable="false" style="vertical-align: -2.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-55" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-3D" x="1045" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-41" x="2101" y="0"></use><g transform="translate(3018,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-65"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-78" x="444" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-70" x="973" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-28" x="4548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-2212" x="4937" y="0"></use><g transform="translate(5716,0)"><g transform="translate(120,0)"><rect stroke="none" width="637" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-72" x="93" y="676"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-3C1" x="60" y="-686"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-29" x="6593" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-2212" x="7205" y="0"></use><g transform="translate(7983,0)"><g transform="translate(342,0)"><rect stroke="none" width="1025" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-43" x="132" y="676"></use><g transform="translate(60,-736)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-36" x="638" y="408"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhD2peG9bekVU9jhwvXA4gHS8au8g#MJMAIN-2C" x="9471" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>U</mi><mo>=</mo><mi>A</mi><mi>exp</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mo>‚àí</mo><mfrac><mi>r</mi><mi>œÅ</mi></mfrac><mo stretchy="false">)</mo><mo>‚àí</mo><mfrac><mi>C</mi><msup><mi>r</mi><mn>6</mn></msup></mfrac><mo>,</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-5">U=A\exp(-\frac{r}{\rho})-\frac{C}{r^6},</script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
onde U √© a energia potencial de um par de part√≠culas, r √© a dist√¢ncia entre as part√≠culas e todas as outras letras s√£o par√¢metros que dependem apenas do tipo de part√≠culas em intera√ß√£o e s√£o definidas no est√°gio de inicializa√ß√£o. Por√©m, mais do que energia, estamos interessados ‚Äã‚Äãnas for√ßas de intera√ß√£o entre essas part√≠culas. As for√ßas s√£o triviais, atrav√©s da derivada do potencial do par, para as quais tamb√©m √© f√°cil obter uma express√£o anal√≠tica e costurar no programa. E, como a for√ßa de a√ß√£o √© igual √† for√ßa da rea√ß√£o, obtemos imediatamente as for√ßas que agem nas duas part√≠culas, pseudoc√≥digo:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs">U = <span class="hljs-number">0</span>;
<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; N; i++)
	<span class="hljs-keyword">for</span> (j = i + <span class="hljs-number">1</span>; j &lt; N<span class="hljs-number">-1</span>; j++)<font></font>
	{<font></font>
		dx = x[i] ‚Äì x[j];<font></font>
		dy = y[i] ‚Äì y[j];<font></font>
		dz = z[i] ‚Äì z[j];<font></font>
		r = <span class="hljs-built_in">sqrt</span>(dx*dx + dy*dy + dz*dz);<font></font>
		U += pair_pot(r, types[i], types[j]);<font></font>
		F = force(r, types[i], types[j])<font></font>
		fx[i] = F * dx;<font></font>
		fx[j] = -F * dx;<font></font>
		fy[i] = F * dy;<font></font>
		fy[j] = -F * dy;<font></font>
		fz[i] = F * dz;<font></font>
		fz[j] = -F * dz;<font></font>
<font></font>
	}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O c√≥digo √© simples: encontramos a dist√¢ncia entre as part√≠culas, substitu√≠-la na fun√ß√£o pelo potencial do par e na fun√ß√£o pela for√ßa (ambas dependem dos tipos de part√≠culas em intera√ß√£o) e calculamos as proje√ß√µes das for√ßas. O ciclo √© realizado N (N-1) / 2 vezes, onde N √© o n√∫mero de part√≠culas. Para pelo menos reduzir de alguma forma o n√∫mero de c√°lculos, podemos tirar vantagem do fato de que o valor desses potenciais diminui rapidamente com a dist√¢ncia. Em dist√¢ncias maiores que 6-8 angstroms, o potencial n√£o pode ser calculado, ser√° quase zero. Adicionando a condi√ß√£o para verificar a dist√¢ncia (ou melhor, seu quadrado), reduziremos o n√∫mero de c√°lculos, mas n√£o o n√∫mero de itera√ß√µes do ciclo. Para sistemas grandes, a maioria das verifica√ß√µes dar√° falso. As t√©cnicas a seguir podem reduzir o n√∫mero de verifica√ß√µes descartando parte dos pares com uma grande dist√¢ncia interat√¥mica conhecida.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem dois m√©todos principais para reduzir o n√∫mero de pesquisas por pares de part√≠culas: uma lista de vizinhos (tamb√©m conhecida como </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lista Verlet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) e uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lista de c√©lulas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(lista de c√©lulas). No primeiro, para cada part√≠cula, lembramos de seus vizinhos que est√£o dentro do raio do potencial. A lista de vizinhos precisa ser atualizada com alguma periodicidade anteriormente desconhecida, que √© a desvantagem do m√©todo. Portanto, vamos nos debru√ßar sobre a lista de c√©lulas, cuja ess√™ncia √© dividir o volume simulado (caixa) em (sub) c√©lulas. Inicialmente, o tamanho da c√©lula foi escolhido para ser maior ou igual ao raio de corte. Ent√£o √© suficiente separar os pares de part√≠culas dentro de cada c√©lula e entre c√©lulas adjacentes. O tamanho da c√©lula pode ser diferente, o principal √© determinar quais pares de c√©lulas voc√™ precisa verificar. De fato, esta √© uma tentativa de descrever a esfera em cubos. Tradicionalmente, para implementar uma lista de c√©lulas em c√≥digo seq√ºencial, duas matrizes s√£o introduzidas, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">head</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">list</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">O tamanho da primeira √© igual ao n√∫mero de c√©lulas, a segunda ao n√∫mero de part√≠culas. </font><font style="vertical-align: inherit;">O primeiro armazena o √≠ndice de uma das part√≠culas em uma determinada c√©lula, os √≠ndices da segunda correspondem aos √≠ndices das part√≠culas e o conte√∫do corresponde ao √≠ndice da pr√≥xima part√≠cula na c√©lula (-1, se n√£o houver mais part√≠culas na c√©lula), a ilustra√ß√£o √© fornecida abaixo. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<img src="https://habrastorage.org/webt/tu/bw/hu/tubwhuvbci2oc2uxlupu3nt4zsc.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O pseudoc√≥digo para percorrer essa lista dentro de uma c√©lula com o √≠ndice cell_index:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs">i = head[cell_index];
<span class="hljs-keyword">while</span> (i &gt;= <span class="hljs-number">0</span>)<font></font>
{<font></font>
      j = <span class="hljs-built_in">list</span>[i];
      <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>)<font></font>
      {<font></font>
              i-j;<font></font>
           j = <span class="hljs-built_in">list</span>[j];<font></font>
      }<font></font>
i = <span class="hljs-built_in">list</span>[i]; <font></font>
}	<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora vamos tentar implementar uma lista de c√©lulas no CUDA. </font><font style="vertical-align: inherit;">Na aproxima√ß√£o zero, simplesmente distribu√≠mos um intervalo de c√©lulas para cada fluxo, caso contr√°rio, deixando um c√≥digo seq√ºencial para enumerar pares de part√≠culas dentro da c√©lula e pares envolvendo part√≠culas de c√©lulas vizinhas. </font><font style="vertical-align: inherit;">Para cada c√©lula, uma matriz de c√©lulas vizinhas </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lstHNeig [iC] [jC]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e o n√∫mero desses vizinhos, uma matriz </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nHeadNeig [],</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> deve ser definida </font><font style="vertical-align: inherit;">:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">cell_list0</span><span class="hljs-params">(<span class="hljs-keyword">int</span> cellPerBlock, <span class="hljs-keyword">int</span> cellPerThread, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">int</span> iC, jC;	<span class="hljs-comment">//  </span>
   <span class="hljs-keyword">int</span> i, j;	<span class="hljs-comment">//  </span><font></font>
<font></font>
   <span class="hljs-keyword">int</span> id0 = blockIdx.x * cellPerBlock + threadId.x * cellPerThread;
   <span class="hljs-keyword">int</span> N = min(id0 + cellPerThread, md-&gt;nCell);<font></font>
<font></font>
   <span class="hljs-comment">//   </span>
   <span class="hljs-keyword">for</span> (iC = id0; iC &lt; N; iC++)<font></font>
   {<font></font>
      i = md-&gt;chead[iC];<font></font>
<font></font>
      <span class="hljs-keyword">while</span> (i &gt;= <span class="hljs-number">0</span>)<font></font>
      {<font></font>
         <span class="hljs-comment">//    </span><font></font>
         j = md-&gt;clist[i]; 	<font></font>
         <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>)<font></font>
         {<font></font>
               i-j;<font></font>
            j = md-&gt;clist[j];  <font></font>
         }<font></font>
<font></font>
         <span class="hljs-comment">//    </span>
         <span class="hljs-keyword">for</span> (jC = <span class="hljs-number">0</span>; jC &lt; md-&gt;nHeadNeig[iC]; jC++)<font></font>
         {<font></font>
            j = md-&gt;chead[md-&gt;lstHNeig[iC][jC]];<font></font>
            <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>)<font></font>
            {<font></font>
                  i-j;    <font></font>
               j = md-&gt;clist[j];<font></font>
            }<font></font>
         }<font></font>
         i = md-&gt;clist[i];<font></font>
      } <font></font>
   }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na minha opini√£o, essa implementa√ß√£o n√£o revela totalmente o potencial de uma placa de v√≠deo, uma vez que um √∫nico fluxo processa uma c√©lula, que, em regra, √© significativamente menor que o n√∫mero de part√≠culas. Em segundo lugar, dentro da fun√ß√£o de processar um par de part√≠culas, √© poss√≠vel trabalhar apenas atrav√©s de opera√ß√µes at√¥micas. Vamos tentar paralelizar mais fortemente a tarefa, deixar que cada thread processe um par de c√©lulas vizinhas (acreditamos que uma lista desses pares j√° tenha sido criada):</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">cell_list1</span><span class="hljs-params">(<span class="hljs-keyword">int</span> pairPerBlock, <span class="hljs-keyword">int</span> pairPerThread, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">int</span> iP, iC, jC;	<span class="hljs-comment">//     </span>
   <span class="hljs-keyword">int</span> i, j;		<span class="hljs-comment">//  </span><font></font>
<font></font>
   <span class="hljs-keyword">int</span> id0 = blockIdx.x * pairPerBlock + threadId.x * pairPerThread;
   <span class="hljs-keyword">int</span> N = min(id0 + cellPerThread, md-&gt;nCell);<font></font>
<font></font>
   <span class="hljs-keyword">for</span> (iP = id0; iC &lt; N; iP++)<font></font>
   {<font></font>
      iC = md-&gt;cellPairs[iP].x;<font></font>
      jC = md-&gt;cellPairs[iP].y;<font></font>
      i = md-&gt;chead[iC];<font></font>
<font></font>
      <span class="hljs-keyword">while</span> (i &gt;= <span class="hljs-number">0</span>)<font></font>
      {<font></font>
         j = md-&gt;chead[jC];<font></font>
         <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>)<font></font>
         {<font></font>
                i-j;<font></font>
             j = md-&gt;clist[j];<font></font>
         }<font></font>
         i = md-&gt;clist[i];<font></font>
      } <font></font>
   }<font></font>
} <font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A matriz </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellPairs []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cont√©m o n√∫mero de pares de c√©lulas vizinhas (.x √© a primeira c√©lula do par, .y √© a segunda). O c√≥digo √© mais simples e elegante, mas aqui o processamento de pares de part√≠culas dentro de uma c√©lula desaparece, para o qual uma fun√ß√£o separada deve ser escrita. H√° outro problema: a organiza√ß√£o da lista de c√©lulas e seu rastreamento s√£o ineficientes para a computa√ß√£o paralela, porque, para obter o √≠ndice da pr√≥xima part√≠cula na c√©lula, voc√™ precisa executar todas as anteriores. Vamos tentar criar c√≥digo e estrutura de dados mais eficientes para que algumas c√©lulas possam ser processadas por v√°rios threads ao mesmo tempo. Agora deixe a lista de c√©lulas ser armazenada em uma </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c√©lula de</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> matriz bidimensional </font><b><font style="vertical-align: inherit;">[] []</font></b><font style="vertical-align: inherit;"> , onde o primeiro √≠ndice define o n√∫mero da c√©lula e o segundo - o n√∫mero at√¥mico dentro da c√©lula. Tamb√©m guardo o n√∫mero de part√≠culas em uma c√©lula no elemento zero da matriz:</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c√©lula [i] [0]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o valor da </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c√©lula [i] [j + 1]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© igual ao √≠ndice geral da part√≠cula na mem√≥ria global. √â verdade que tal implementa√ß√£o requer conhecer o n√∫mero m√°ximo de part√≠culas em uma c√©lula e ocupar√° mais mem√≥ria. Tamb√©m dividiremos nossa tarefa em duas subtarefas. A primeira fun√ß√£o calcular√° a intera√ß√£o em pares de c√©lulas separados (por exemplo, com √≠ndices 0-1, 2-3, 4-5 etc.) e dentro das c√©lulas:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">cell_list2a</span><span class="hljs-params">(cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">int</span> iP, iC, iCA, iCB, step, step1; 
   <span class="hljs-keyword">int</span> i, j, id0, id1, N, N1, deltId;
   <span class="hljs-keyword">int</span> id;
   <span class="hljs-keyword">int</span> nA, nB, nOwn;  
   <span class="hljs-keyword">int</span> ex = <span class="hljs-number">0</span>;		<span class="hljs-comment">//   </span><font></font>
<font></font>
   <span class="hljs-comment">//  --        </span>
   __shared__ <span class="hljs-keyword">float</span> engVdW, engCoul;
   <span class="hljs-keyword">float</span> eVdW = <span class="hljs-number">0.0</span>;
   <span class="hljs-keyword">float</span> eCoul = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
<span class="hljs-comment">//   shared </span>
  <span class="hljs-keyword">extern</span> __shared__ <span class="hljs-keyword">int</span> shMem[];      
  <span class="hljs-keyword">int</span>* sAids = shMem;		<span class="hljs-comment">//     1 (   )</span>
  <span class="hljs-keyword">int</span>* sAtypes = (<span class="hljs-keyword">int</span>*)&amp;sAids[md-&gt;maxAtPerCell]; <span class="hljs-comment">//     </span>
  float3* sAxyz = (float3*)&amp;sAtypes[md-&gt;maxAtPerCell]; <span class="hljs-comment">//     </span>
  float3* sAfrs = (float3*)&amp;sAxyz[md-&gt;maxAtPerCell]; <span class="hljs-comment">//      </span>
   <span class="hljs-comment">//     2 (B)</span>
  <span class="hljs-keyword">int</span>* sBids = (<span class="hljs-keyword">int</span>*)&amp;sAfrs[md-&gt;maxAtPerCell];
  <span class="hljs-keyword">int</span>* sBtypes = (<span class="hljs-keyword">int</span>*)&amp;sBids[md-&gt;maxAtPerCell];<font></font>
  float3* sBxyz = (float3*)&amp;sBtypes[md-&gt;maxAtPerCell];<font></font>
  float3* sBfrs = (float3*)&amp;sBxyz[md-&gt;maxAtPerCell];<font></font>
<font></font>
   <span class="hljs-comment">//   ,    </span><font></font>
   float3 *sXyz;<font></font>
   float3 *sFrs;<font></font>
   <span class="hljs-keyword">int</span> *sTypes;
   <span class="hljs-keyword">int</span> *sIds;<font></font>
<font></font>
   <span class="hljs-comment">//       </span>
   iCA = md-&gt;cellPairs[blockIdx.x].x;  <span class="hljs-comment">//   </span>
   iCB = md-&gt;cellPairs[blockIdx.x].y;  <span class="hljs-comment">//   B</span><font></font>
<font></font>
   <span class="hljs-comment">//    -- </span>
  <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        engVdW = <span class="hljs-number">0.0</span>;<font></font>
        engCoul = <span class="hljs-number">0.0</span>;<font></font>
    }<font></font>
<font></font>
   <span class="hljs-comment">//      shared_memory</span>
   <span class="hljs-keyword">if</span> (threadIdx.x &lt; blockDim.x / <span class="hljs-number">2</span>) <span class="hljs-comment">//!       A,  -   B. ,     </span><font></font>
     {<font></font>
        iC = iCA;<font></font>
        sXyz = sAxyz;<font></font>
        sFrs = sAfrs;<font></font>
        sTypes = sAtypes;<font></font>
        sIds = sAids;<font></font>
        deltId = <span class="hljs-number">0</span>;<font></font>
     }<font></font>
   <span class="hljs-keyword">else</span><font></font>
     {<font></font>
        iC = iCB;<font></font>
        sXyz = sBxyz;<font></font>
        sFrs = sBfrs;<font></font>
        sTypes = sBtypes;<font></font>
        sIds = sBids;<font></font>
        deltId = blockDim.x / <span class="hljs-number">2</span>;<font></font>
     }<font></font>
<font></font>
   <span class="hljs-comment">//        </span>
   nA = md-&gt;cells[iCA][<span class="hljs-number">0</span>];<font></font>
   nB = md-&gt;cells[iCB][<span class="hljs-number">0</span>];<font></font>
   nOwn = md-&gt;cells[iC][<span class="hljs-number">0</span>]; <span class="hljs-comment">// nA  nB</span><font></font>
<font></font>
   <span class="hljs-comment">//   ,     </span>
  step = ceilf(<span class="hljs-number">2</span> * (<span class="hljs-keyword">double</span>)nOwn / (<span class="hljs-keyword">double</span>)blockDim.x);<font></font>
   id0 = (threadIdx.x - deltId) * step;<font></font>
   N = min(id0 + step, nOwn);<font></font>
   <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
   {<font></font>
      id = md-&gt;cells[iC][i+<span class="hljs-number">1</span>];<font></font>
      sIds[i] = id;		<span class="hljs-comment">//   </span>
      sXyz[i] = md-&gt;xyz[id];	<span class="hljs-comment">//  </span>
      sFrs[i] = make_float3(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>);    <span class="hljs-comment">//  </span><font></font>
   sTypes[i] = md-&gt;types[id];<font></font>
   }<font></font>
   __syncthreads();<font></font>
<font></font>
   <span class="hljs-comment">//      </span>
   <span class="hljs-comment">//        i=0  j=1,    j     </span>
   i = <span class="hljs-number">0</span>;<font></font>
   j = threadIdx.x ‚Äì deltId + <span class="hljs-number">1</span>;<font></font>
   step1 = blockDim.x / <span class="hljs-number">2</span>;
   <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<font></font>
   {<font></font>
      <span class="hljs-keyword">while</span> (j &gt;= nOwn)<font></font>
      {<font></font>
          i++;<font></font>
          <span class="hljs-keyword">if</span> (i &gt;= nOwn<span class="hljs-number">-1</span>)<font></font>
          {<font></font>
              ex = <span class="hljs-number">1</span>;
              <span class="hljs-keyword">break</span>;<font></font>
          }<font></font>
          j = i + <span class="hljs-number">1</span> + j - nOwn;<font></font>
      }<font></font>
      <span class="hljs-keyword">if</span> (ex) <span class="hljs-keyword">break</span>;<font></font>
      pair_in_cell(sXyz[i], @sFrs[i], sTypes[i], sXyz[j], @sFrs[j], sTypes[j], md, eVdW, eCoul);<font></font>
      j = j + step1;<font></font>
   }<font></font>
<font></font>
   <span class="hljs-comment">//       </span><font></font>
   step1 = ceilf(nA / blockDim.x);<font></font>
   id1 = threadIdx.x * step1;<font></font>
   N1 = min(id1 + step1, nA);<font></font>
   <span class="hljs-keyword">for</span> (i = id1; i &lt; N1; i++)
     <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; nB; j++)<font></font>
       pair_between_cell(sAxyz[i], &amp;sAfrs[i], sAtypes[i], sBxyz[j], &amp;sBfrs[j], sBtypes[j], md-&gt;cellShifts[blockId.x], md, eVdW, eCoul);<font></font>
<font></font>
   __syncthreads();<font></font>
<font></font>
   <span class="hljs-comment">//     global memory</span>
   <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
       md-&gt;frs[sIds[i]] = sFrs[i];<font></font>
<font></font>
   <span class="hljs-comment">//     </span><font></font>
   atomicAdd(&amp;engCoul, eCoul);<font></font>
   atomicAdd(&amp;engVdw, eVdW);<font></font>
   __syncthreads();<font></font>
<font></font>
   <span class="hljs-comment">//     global memory</span>
   <span class="hljs-keyword">if</span> (!threadIdx.x) <font></font>
   {<font></font>
      atomicAdd(&amp;md-&gt;engCoul, engCoul);  <font></font>
      atomicAdd(&amp;md-&gt;engVdW, engVdW);<font></font>
   }<font></font>
}<font></font>
 </code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vari√°veis ‚Äã‚Äãno formato </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">float3PerCell</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> s√£o o produto do n√∫mero m√°ximo de part√≠culas em uma c√©lula pelo tamanho do tipo float3. Faz sentido calcul√°-los uma vez durante a inicializa√ß√£o do sistema. Os </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pair_in_cell</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fun√ß√µes pair_between_cell</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> calcular as interac√ß√µes entre part√≠culas nas c√©lulas mesmos e diferentes, respectivamente. Como par√¢metros, eles obt√™m as coordenadas das part√≠culas, seus tipos e ponteiros onde escrever for√ßas. Par√¢metros para </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pair_between_cell</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tamb√©m incluem a magnitude dos turnos, para levar em considera√ß√£o as condi√ß√µes peri√≥dicas dos limites. Os c√≥digos para essas fun√ß√µes ser√£o fornecidos abaixo. Para classificar os pares de part√≠culas dentro da c√©lula, eu queria seguir o caminho padr√£o - dividir o n√∫mero de pares em intervalos iguais e dar um intervalo a cada fluxo. No entanto, para obter os √≠ndices de part√≠culas ij pelo n√∫mero do par, criei a equa√ß√£o quadr√°tica e decidi faz√™-lo de maneira diferente: o primeiro thread processa um par de part√≠culas com os √≠ndices 0-1, o segundo - 0-2, etc. Depois de processar o par ij, o fluxo vai para o par i- (j + N), onde N √© o n√∫mero de fluxos no bloco e, se ultrapassa o limite do intervalo, aumenta o √≠ndice da primeira part√≠cula no par, veja o diagrama:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<img src="https://habrastorage.org/webt/fv/-h/qa/fv-hqah4yeuzhpa9jbidswkmse8.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A enumera√ß√£o de pares entre c√©lulas diferentes √© a seguinte: todos os fluxos recebem seu intervalo de √≠ndices de part√≠culas da c√©lula A e calculam as intera√ß√µes entre essas part√≠culas e todas as part√≠culas na c√©lula B. A segunda fun√ß√£o calcula as intera√ß√µes em todos os pares restantes:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">cell_list2b</span><span class="hljs-params">(cudaMD* md)</span>
</span>{
    <span class="hljs-keyword">int</span> iPair, iC, iCA, iCB, step, step1; 
    <span class="hljs-keyword">int</span> i, j, id0, id1, N, N1, deltId;    
    <span class="hljs-keyword">int</span> id;
    <span class="hljs-keyword">int</span> nA, nB, nOwn; <font></font>
<font></font>
    __shared__ <span class="hljs-keyword">float</span> engVdW, engCoul;
    <span class="hljs-keyword">float</span> eVdW = <span class="hljs-number">0.0</span>;
    <span class="hljs-keyword">float</span> eCoul = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
    <span class="hljs-keyword">extern</span> __shared__ <span class="hljs-keyword">int</span> shMem[];      <span class="hljs-comment">// declaration of shared memory</span>
    <span class="hljs-keyword">int</span>* sAids = shMem;
    <span class="hljs-keyword">int</span>* sAtypes = (<span class="hljs-keyword">int</span>*)&amp;sAids[md-&gt;maxAtPerCell];<font></font>
    float3* sAxyz = (float3*)&amp;sAtypes[md-&gt;maxAtPerCell];<font></font>
    float3* sAfrs = (float3*)&amp;sAxyz[md-&gt;maxAtPerCell];<font></font>
    <span class="hljs-keyword">int</span>* sBids = (<span class="hljs-keyword">int</span>*)&amp;sAfrs[md-&gt;maxAtPerCell];
    <span class="hljs-keyword">int</span>* sBtypes = (<span class="hljs-keyword">int</span>*)&amp;sBids[md-&gt;maxAtPerCell];<font></font>
    float3* sBxyz = (float3*)&amp;sBtypes[md-&gt;maxAtPerCell];<font></font>
    float3* sBfrs = (float3*)&amp;sBxyz[md-&gt;maxAtPerCell];<font></font>
<font></font>
    float3* sXyz;<font></font>
    float3* sFrs;  <font></font>
    <span class="hljs-keyword">int</span>* sTypes;
    <span class="hljs-keyword">int</span>* sIds;<font></font>
<font></font>
    iPair = blockIdx.x + md-&gt;nPair1;<font></font>
    <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        engVdW = <span class="hljs-number">0.0</span>;<font></font>
        engCoul = <span class="hljs-number">0.0</span>;<font></font>
    }<font></font>
    __syncthreads();<font></font>
<font></font>
    iCA = md-&gt;cellPairs[iPair].x; <font></font>
    iCB = md-&gt;cellPairs[iPair].y;<font></font>
    nA = md-&gt;cells[iCA][<span class="hljs-number">0</span>];<font></font>
    nB = md-&gt;cells[iCB][<span class="hljs-number">0</span>];<font></font>
    <font></font>
    <span class="hljs-comment">//    ,        </span>
    <span class="hljs-keyword">if</span> (!nA)
       <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (!nB)
        <span class="hljs-keyword">return</span>;<font></font>
<font></font>
    <span class="hljs-comment">//      shared_memory</span>
    <span class="hljs-keyword">if</span> (threadIdx.x &lt; blockDim.x / <span class="hljs-number">2</span>)<font></font>
    {<font></font>
        iC = iCA;<font></font>
        sXyz = sAxyz;<font></font>
        sFrs = sAfrs;<font></font>
        sTypes = sAtypes;<font></font>
        sIds = sAids;<font></font>
        deltId = <span class="hljs-number">0</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
        iC = iCB;<font></font>
        sXyz = sBxyz;<font></font>
        sFrs = sBfrs;<font></font>
        sTypes = sBtypes;<font></font>
        sIds = sBids;<font></font>
        deltId = blockDim.x / <span class="hljs-number">2</span>;<font></font>
    }<font></font>
    nOwn = md-&gt;cells[iC][<span class="hljs-number">0</span>]; <span class="hljs-comment">// nA or nB</span><font></font>
<font></font>
    step = ceilf(<span class="hljs-number">2</span> * (<span class="hljs-keyword">double</span>)nOwn / (<span class="hljs-keyword">double</span>)blockDim.x);<font></font>
    id0 = (threadIdx.x - deltId) * step;<font></font>
    N = min(id0 + step, nOwn);<font></font>
    <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
    {<font></font>
        id = md-&gt;cells[iC][i + <span class="hljs-number">1</span>];<font></font>
        sIds[i] = id;     <font></font>
        sXyz[i] = md-&gt;xyz[id];    <font></font>
        sFrs[i] = make_float3(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>);    <font></font>
        sTypes[i] = md-&gt;types[id];<font></font>
    }<font></font>
    __syncthreads();<font></font>
<font></font>
    <span class="hljs-comment">//       </span>
    step1 = ceilf((<span class="hljs-keyword">double</span>)nA / (<span class="hljs-keyword">double</span>)blockDim.x);<font></font>
    id1 = threadIdx.x * step1;<font></font>
    N1 = min(id1 + step1, nA);<font></font>
    <span class="hljs-keyword">for</span> (i = id1; i &lt; N1; i++)
        <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; nB; j++)<font></font>
        {<font></font>
            pair_between_cell1(sAxyz[i], &amp;sAfrs[i], sAtypes[i], sBxyz[j], &amp;sBfrs[j], sBtypes[j], md-&gt;cellShifts[iPair], md, eVdW, eCoul);<font></font>
<font></font>
        }<font></font>
    __syncthreads();<font></font>
<font></font>
   <span class="hljs-comment">//     global memory</span>
    <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
    {<font></font>
        atomicAdd(&amp;(md-&gt;frs[sIds[i]].x), sFrs[i].x);<font></font>
        atomicAdd(&amp;(md-&gt;frs[sIds[i]].y), sFrs[i].y);<font></font>
        atomicAdd(&amp;(md-&gt;frs[sIds[i]].z), sFrs[i].z);<font></font>
    }<font></font>
<font></font>
    atomicAdd(&amp;engCoul, eCoul);<font></font>
    atomicAdd(&amp;engVdW, eVdW);<font></font>
    __syncthreads();<font></font>
 <font></font>
    <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        atomicAdd(&amp;md-&gt;engCoul1, engCoul);<font></font>
        atomicAdd(&amp;md-&gt;engVdW, engVdW);<font></font>
    }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O c√≥digo √© quase semelhante √† fun√ß√£o anterior, apenas os pares restantes agora s√£o processados ‚Äã‚Äã(o √≠ndice do par √© alterado por </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">md-&gt; nPair1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), a intera√ß√£o √© calculada apenas entre o par de c√©lulas (j√° contadas dentro das c√©lulas) e, ao copiar para a mem√≥ria global, usamos atomicAdd para resumir os resultados e n√£o sobrescrever eles. </font><font style="vertical-align: inherit;">Agora trago as fun√ß√µes restantes:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">keep_in_cell</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index, float3 xyz, cudaMD* md)</span>
<span class="hljs-comment">//  index    xyz  cell list</span>
</span>{
    <span class="hljs-comment">//   </span>
    <span class="hljs-keyword">int</span> c = <span class="hljs-built_in">floor</span>((<span class="hljs-keyword">double</span>)xyz.x / (<span class="hljs-keyword">double</span>)md-&gt;cSize.x) * md-&gt;cnYZ + <span class="hljs-built_in">floor</span>((<span class="hljs-keyword">double</span>)xyz.y / (<span class="hljs-keyword">double</span>)md-&gt;cSize.y) * md-&gt;cNumber.z + <span class="hljs-built_in">floor</span>((<span class="hljs-keyword">double</span>)xyz.z / (<span class="hljs-keyword">double</span>)md-&gt;cSize.z);<font></font>
<font></font>
    <span class="hljs-keyword">int</span> j = atomicAdd(&amp;(md-&gt;cells[c][<span class="hljs-number">0</span>]), <span class="hljs-number">1</span>);<font></font>
    md-&gt;cells[c][j + <span class="hljs-number">1</span>] = index;<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com base nas coordenadas, calculamos o √≠ndice da c√©lula onde essa part√≠cula entra. Aumentamos o contador de part√≠culas nesta c√©lula. Escrevemos o √≠ndice de part√≠culas em uma nova c√©lula. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cSize</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© o tamanho da c√©lula, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cnYZ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© o produto do n√∫mero de c√©lulas nas medi√ß√µes Y e Z. </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pode valer a pena n√£o calcular o √≠ndice da c√©lula, mas armazen√°-las como uma matriz tridimensional na mem√≥ria de textura, usando √≠ndices no formato [x / md-&gt; cSize.x ] Isso dar√° um aumento de desempenho?</font></font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Fun√ß√µes que calculam intera√ß√µes:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">pair_in_cell</span><span class="hljs-params">(float3 xyzA, float3* fxyzA, <span class="hljs-keyword">int</span> typeA, float3 xyzB, float3* fxyzB, <span class="hljs-keyword">int</span> typeB, cudaMD* md, <span class="hljs-keyword">float</span>&amp; engVdw, <span class="hljs-keyword">float</span>&amp; engCoul)</span>
</span>{
    <span class="hljs-keyword">float</span> r, r2, f;
    <span class="hljs-keyword">float</span> dx, dy, dz;<font></font>
    cudaVdW* vdw = <span class="hljs-literal">NULL</span>;<font></font>
<font></font>
    dx = xyzA.x - xyzB.x; <font></font>
    dy = xyzA.y - xyzB.y;<font></font>
    dz = xyzA.z - xyzB.z;<font></font>
    r2 = dx * dx + dy * dy + dz * dz;<font></font>
<font></font>
    <span class="hljs-comment">//if (r2 &lt;= sim-&gt;r2Max)    </span>
    <span class="hljs-comment">//{</span>
    r = <span class="hljs-number">0.0</span>;<font></font>
    f = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
    <span class="hljs-comment">//  </span><font></font>
    f += real_ewald(r2, r, md-&gt;chProd[typeA][typeB], md-&gt;alpha, engCoul);<font></font>
<font></font>
    <span class="hljs-comment">// -- </span><font></font>
    vdw = md-&gt;vdws[typeA][typeB];<font></font>
    <span class="hljs-keyword">if</span> (vdw != <span class="hljs-literal">NULL</span>)
        <span class="hljs-comment">//if (r2 &lt;= vdw-&gt;r2cut)   //!      </span><font></font>
            f += vdw-&gt;feng_r(r2, r, vdw, engVdw);<font></font>
<font></font>
    <span class="hljs-comment">//      atomic,        </span><font></font>
    atomicAdd(&amp;(fxyzA-&gt;x), f * dx);<font></font>
    atomicAdd(&amp;(fxyzB-&gt;x), -f * dx);<font></font>
    atomicAdd(&amp;(fxyzA-&gt;y), f * dy);<font></font>
    atomicAdd(&amp;(fxyzB-&gt;y), -f * dy);<font></font>
    atomicAdd(&amp;(fxyzA-&gt;z), f * dz);<font></font>
    atomicAdd(&amp;(fxyzB-&gt;z), -f * dz);<font></font>
    <span class="hljs-comment">//}</span><font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Calculamos a dist√¢ncia entre as part√≠culas, substituindo-a primeiro na fun√ß√£o Coulomb e depois na intera√ß√£o van der Waals. Se o tamanho da c√©lula for escolhido para que sua diagonal n√£o exceda o intervalo do tipo mais curto de intera√ß√£o, as verifica√ß√µes de dist√¢ncia poder√£o ser removidas (eu especificamente as deixei comentadas no c√≥digo). Observo que aqui eu calculo o quadrado da dist√¢ncia ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), e a dist√¢ncia ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) em si √© calculada na fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">real_ewald</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . A </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matriz chProd [i] [j]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> armazena o produto das cargas dos tipos correspondentes de part√≠culas. Talvez tamb√©m deva ser colocado na mem√≥ria de textura. A estrutura vdw armazena par√¢metros potenciais emparelhados e um ponteiro de fun√ß√£o ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">feng_r</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) para calcular a intera√ß√£o van der Waals. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fun√ß√£o para calcular intera√ß√µes entre duas c√©lulas diferentes:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">pair_between_cell1</span><span class="hljs-params">(float3 xyzA, float3* fxyzA, <span class="hljs-keyword">int</span> typeA, float3 xyzB, float3* fxyzB, <span class="hljs-keyword">int</span> typeB, float3 shift, cudaMD* md, <span class="hljs-keyword">float</span>&amp; engVdw, <span class="hljs-keyword">float</span>&amp; engCoul)</span>
</span>{
    <span class="hljs-keyword">float</span> r, r2, f;
    <span class="hljs-keyword">float</span> dx, dy, dz;<font></font>
    cudaVdW* vdw;<font></font>
<font></font>
    dx = xyzA.x - xyzB.x - shift.x;<font></font>
    dy = xyzA.y - xyzB.y - shift.y;<font></font>
    dz = xyzA.z - xyzB.z - shift.z;<font></font>
    r2 = dx * dx + dy * dy + dz * dz;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (r2 &lt;= md-&gt;r2Real)<font></font>
    {<font></font>
        r = <span class="hljs-number">0.0</span>;<font></font>
        f = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
        f += real_ewald(r2, r, md-&gt;chProd[typeA][typeB], md-&gt;alpha, engCoul); <font></font>
<font></font>
        vdw = md-&gt;vdws[typeA][typeB];<font></font>
        <span class="hljs-keyword">if</span> (vdw != <span class="hljs-literal">NULL</span>)
            <span class="hljs-keyword">if</span> (r2 &lt;= vdw-&gt;r2cut)   <font></font>
                f += vdw-&gt;feng_r(r2, r, vdw, engVdw);<font></font>
<font></font>
<font></font>
        fxyzA-&gt;x += f * dx;<font></font>
        atomicAdd(&amp;(fxyzB-&gt;x), -f * dx);<font></font>
        fxyzA-&gt;y += f * dy;<font></font>
        atomicAdd(&amp;(fxyzB-&gt;y), -f * dy);<font></font>
        fxyzA-&gt;z += f * dz;<font></font>
        atomicAdd(&amp;(fxyzB-&gt;z), -f * dz);<font></font>
    }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O c√≥digo √© quase id√™ntico √† fun√ß√£o anterior, h√° uma corre√ß√£o na diferen√ßa de coordenadas para levar em conta condi√ß√µes peri√≥dicas de contorno, as verifica√ß√µes de dist√¢ncia n√£o s√£o comentadas e, como lembramos das fun√ß√µes do grupo de fun√ß√µes </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">n√£o h√° necessidade de aplicar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atomicAdd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √† c√©lula A, porque as part√≠culas nele s√£o processadas independentemente. </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Observo que, dependendo da dist√¢ncia entre c√©lulas espec√≠ficas de um par, voc√™ pode omitir algumas verifica√ß√µes e c√°lculos de dist√¢ncia. </font><font style="vertical-align: inherit;">Para fazer isso, voc√™ pode escrever vers√µes ligeiramente diferentes desta fun√ß√£o. </font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tamb√©m dou fun√ß√µes que calculam as for√ßas e energias dos potenciais de pares para o potencial de Lennard-Jones e Buckingham:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">float</span> <span class="hljs-title">cu_fe_lj</span><span class="hljs-params">(<span class="hljs-keyword">float</span> r2, cudaVdW* vdw, <span class="hljs-keyword">float</span>&amp; eng)</span>
<span class="hljs-comment">// U = 4e[(s/r)^12 - (s/r)^6]</span>
</span>{
    <span class="hljs-keyword">float</span> r2i = <span class="hljs-number">1.0</span> / r2;
    <span class="hljs-keyword">float</span> sr2 = vdw-&gt;p1 * r2i;
    <span class="hljs-keyword">float</span> sr6 = sr2 * sr2 * sr2;<font></font>
<font></font>
    eng += vdw-&gt;p0 * sr6 * (sr6 - <span class="hljs-number">1.0</span>);
    <span class="hljs-keyword">return</span> vdw-&gt;p2 * r2i * sr6 * (<span class="hljs-number">2.0</span> * sr6 - <span class="hljs-number">1.0</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function">__device__ <span class="hljs-keyword">float</span> <span class="hljs-title">cu_fer_buck</span><span class="hljs-params">(<span class="hljs-keyword">float</span> r2, <span class="hljs-keyword">float</span>&amp; r, cudaVdW* vdw, <span class="hljs-keyword">float</span>&amp; eng)</span>
<span class="hljs-comment">// U = A exp(-r/ro) - C/r^6</span>
</span>{
    <span class="hljs-keyword">float</span> r2i = <span class="hljs-number">1.0</span> / r2;
    <span class="hljs-keyword">float</span> r4i = r2i * r2i;
    <span class="hljs-keyword">if</span> (r == <span class="hljs-number">0.0</span>)    <span class="hljs-comment">//  r , </span>
        r = <span class="hljs-built_in">sqrt</span>(r2);<font></font>
<font></font>
    eng += vdw-&gt;p0 * <span class="hljs-built_in">exp</span>(-r / vdw-&gt;p1) - vdw-&gt;p2 * r4i * r2i;
    <span class="hljs-keyword">return</span> vdw-&gt;p0 * <span class="hljs-built_in">exp</span>(-r / vdw-&gt;p1) / r / vdw-&gt;p1 - <span class="hljs-number">6.0</span> * vdw-&gt;p2 * r4i * r4i;<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As fun√ß√µes retornam a for√ßa (que deve ser multiplicada pela proje√ß√£o do vetor de dist√¢ncia) e adicionam energia √† vari√°vel </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Um ponteiro para uma dessas fun√ß√µes √© armazenado na estrutura cudaVdW. </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De um modo geral, para obter trajet√≥rias de movimento, a energia n√£o pode ser calculada, √© necess√°ria para diferentes estat√≠sticas. Se removermos as express√µes de energia dessas fun√ß√µes, √© prov√°vel que os c√°lculos sejam acelerados. E voc√™ pode fazer isso: uma vez, algumas etapas para chamar a fun√ß√£o completa e o resto do tempo - apenas um anal√≥gico reduzido.</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Parte da intera√ß√£o Coulomb √© calculada pela fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">real_ewald</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">float</span> <span class="hljs-title">real_ewald</span><span class="hljs-params">(<span class="hljs-keyword">float</span> r2, <span class="hljs-keyword">float</span>&amp; r, <span class="hljs-keyword">float</span> chprd, <span class="hljs-keyword">float</span> alpha, <span class="hljs-keyword">float</span>&amp; eng)</span>
</span>{
    <span class="hljs-keyword">float</span> ar; 
    <span class="hljs-keyword">float</span> erfcar;
    <span class="hljs-keyword">float</span> kqq = chprd * d_Fcoul_scale; <span class="hljs-comment">// q[i]*q[j]*1/4pie0;</span><font></font>
<font></font>
    r = <span class="hljs-built_in">sqrt</span>(r2);<font></font>
    ar = alpha * r;<font></font>
    erfcar = erfc(ar);<font></font>
<font></font>
    eng += kqq * erfcar / r;<font></font>
    <span class="hljs-keyword">return</span> kqq / r / r2 * (erfcar + <span class="hljs-number">2</span> * ar / d_sqrtpi * <span class="hljs-built_in">exp</span>(-ar * ar));<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso difere da lei familiar de Coulomb, mas mais sobre isso em um artigo separado. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Testar com um exemplo real mostrou que existem muito poucas part√≠culas em um par de c√©lulas para carregar todos os fluxos alocados ao bloco. Uma otimiza√ß√£o adicional das fun√ß√µes </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© processar v√°rios pares ao mesmo tempo em um bloco. At√© agora, escrevi apenas a vers√£o mais simples, em que os fluxos s√£o simplesmente divididos em v√°rios pares de c√©lulas, ou seja, um bloco processa n√£o um par, mas digamos 4: 0-1, 1-2, 3-4, 5-6. Voc√™ pode notar que, nesse caso, carregar os dados na mem√≥ria compartilhada pode, ao mesmo tempo, processar os pares 0-2, 0-3, 0-4, etc. No entanto, isso requer truques adicionais na fase de prepara√ß√£o dos dados, que ainda n√£o foram analisados. Al√©m disso, se na fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se voc√™ carregar pares com uma c√©lula comum (por exemplo, o mesmo 0-2, 0-3, 0-4 etc.), poder√° reduzir o n√∫mero de acessos √† mem√≥ria global, copiando os dados da c√©lula 0 apenas uma vez. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para verificar se tudo funciona corretamente na minha implementa√ß√£o de algoritmos de lista de c√©lulas, tamb√©m escrevi uma fun√ß√£o que calcula intera√ß√µes de maneira ing√™nua, simplesmente classificando todos os pares:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">all_pair</span><span class="hljs-params">(cudaMD* md)</span>
</span>{
    <span class="hljs-keyword">int</span> i, j;
    <span class="hljs-keyword">int</span> step = blockDim.x * gridDim.x;
    <span class="hljs-keyword">int</span> ex = <span class="hljs-number">0</span>;  <span class="hljs-comment">// exit flag</span>
    <span class="hljs-keyword">int</span> nAt = md-&gt;nAt;<font></font>
<font></font>
    i = <span class="hljs-number">0</span>;<font></font>
    j = blockIdx.x * blockDim.x + threadIdx.x + <span class="hljs-number">1</span>;
    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<font></font>
    {<font></font>
        <span class="hljs-keyword">while</span> (j &gt;= nAt)<font></font>
        {<font></font>
            i++;<font></font>
            <span class="hljs-keyword">if</span> (i &gt;= nAt - <span class="hljs-number">1</span>)<font></font>
            {<font></font>
                ex = <span class="hljs-number">1</span>;
                <span class="hljs-keyword">break</span>;<font></font>
            }<font></font>
            j = i + <span class="hljs-number">1</span> + j - nAt;<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (ex) <span class="hljs-keyword">break</span>;<font></font>
        global_pair(i, j, iStep, md);<font></font>
        j = j + step;<font></font>
    }<font></font>
} <font></font>
<font></font>
<span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">global_pair</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j, cudaMD* md)</span>
</span>{
    <span class="hljs-keyword">float</span> r, r2, f;
    <span class="hljs-keyword">float</span> engCoul = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">float</span> engVdw = <span class="hljs-number">0</span>;<font></font>
    cudaVdW* vdw;<font></font>
    <span class="hljs-keyword">int</span> ti, tj;<font></font>
<font></font>
    <span class="hljs-keyword">float</span> dx = md-&gt;xyz[i].x - md-&gt;xyz[j].x;
    <span class="hljs-keyword">float</span> dy = md-&gt;xyz[i].y - md-&gt;xyz[j].y;
    <span class="hljs-keyword">float</span> dz = md-&gt;xyz[i].z - md-&gt;xyz[j].z;<font></font>
<font></font>
    <span class="hljs-comment">//   </span>
    <span class="hljs-keyword">if</span> (dx &gt; md-&gt;halfLeng.x)<font></font>
        dx -= md-&gt;leng.x;<font></font>
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">if</span> (dx &lt; -md-&gt;halfLeng.x)<font></font>
            dx += md-&gt;leng.x;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (dy &gt; md-&gt;halfLeng.y)<font></font>
        dy -= md-&gt;leng.y;<font></font>
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">if</span> (dy &lt; -md-&gt;halfLeng.y)<font></font>
            dy += md-&gt;leng.y;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (dz &gt; md-&gt;halfLeng.z)<font></font>
        dz -= md-&gt;leng.z;<font></font>
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">if</span> (dz &lt; -md-&gt;halfLeng.z)<font></font>
            dz += md-&gt;leng.z;<font></font>
<font></font>
    r2 = dx * dx + dy * dy + dz * dz;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (r2 &lt;= md-&gt;r2Real)    <font></font>
    {<font></font>
        r = <span class="hljs-number">0.0</span>;<font></font>
        f = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
        ti = md-&gt;types[i];<font></font>
        tj = md-&gt;types[j];<font></font>
<font></font>
        f += real_ewald(r2, r, md-&gt;chProd[ti][tj], md-&gt;alpha, engCoul);<font></font>
<font></font>
        vdw = md-&gt;vdws[ti][tj];<font></font>
        <span class="hljs-keyword">if</span> (vdw != <span class="hljs-literal">NULL</span>)
            <span class="hljs-keyword">if</span> (r2 &lt;= vdw-&gt;r2cut)   <font></font>
                f += vdw-&gt;feng_r(r2, r, vdw, engVdw); <font></font>
<font></font>
        dx *= f;<font></font>
        dy *= f;<font></font>
        dz *= f;<font></font>
<font></font>
        atomicAdd(&amp;(md-&gt;frs[i].x), dx);<font></font>
        atomicAdd(&amp;(md-&gt;frs[j].x), -dx);<font></font>
        atomicAdd(&amp;(md-&gt;frs[i].y), dy);<font></font>
        atomicAdd(&amp;(md-&gt;frs[j].y), -dy);<font></font>
        atomicAdd(&amp;(md-&gt;frs[i].z), dz);<font></font>
        atomicAdd(&amp;(md-&gt;frs[j].z), -dz);<font></font>
<font></font>
        atomicAdd(&amp;(md-&gt;engCoul1), engCoul);<font></font>
        atomicAdd(&amp;(md-&gt;engVdW), engVdw);<font></font>
<font></font>
    }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os resultados dos c√°lculos coincidiram. </font><font style="vertical-align: inherit;">√â verdade que, aparentemente, devido a diferentes seq√º√™ncias de arredondamento, as coordenadas das part√≠culas na terceira casa decimal podem variar do in√≠cio ao in√≠cio. </font><font style="vertical-align: inherit;">Observo que em um sistema de cerca de 1.400 part√≠culas e um raio de corte de 6 angstroms, as fun√ß√µes </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> perdem cerca de duas vezes o tempo de execu√ß√£o para uma enumera√ß√£o simples. </font><font style="vertical-align: inherit;">Ao processar v√°rios blocos (8 e 16) ao mesmo tempo em um bloco, as velocidades s√£o comparadas e podem at√© estar um pouco √† frente da fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">all_pair</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">No entanto, isso deve ser altamente dependente do tamanho do sistema. </font><font style="vertical-align: inherit;">√Ä medida que o n√∫mero de √°tomos aumenta, a velocidade dos algoritmos da lista de c√©lulas aumenta linearmente e a enumera√ß√£o simples quadraticamente. </font><font style="vertical-align: inherit;">Al√©m disso, a lista de c√©lulas √© muito eficaz na modelagem de sistemas descarregados (grandes dist√¢ncias entre part√≠culas), por exemplo, gases</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclus√£o</font></font></h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Concluindo este artigo, terei prazer em responder a quaisquer perguntas e coment√°rios, especialmente sobre o aumento da produtividade. </font><font style="vertical-align: inherit;">Os momentos mais disputados no decorrer da narra√ß√£o que notei em vermelho. </font><font style="vertical-align: inherit;">Como a transfer√™ncia do restante das din√¢micas funcionais moleculares ainda deve ser feita, pretendo continuar o ciclo desses artigos:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Soma de Ewald.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intera√ß√£o intramolecular.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lacuna e forma√ß√£o de liga√ß√µes.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transfer√™ncia eletr√¥nica.</font></font></li>
</ol>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da literatura sobre MD, posso recomendar o livro </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daan Frenkel e Berend Smit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entendendo a Simula√ß√£o Molecular: Dos Algoritmos √†s Aplica√ß√µes</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simula√ß√£o Computacional de L√≠quidos, de</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> autoria de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MP Allen, DJ Tildesley</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Pela primeira vez, at√© onde eu sei, h√° uma tradu√ß√£o para o russo. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agrade√ßo tamb√©m a Pavel Kudinov</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pavel_kudinov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">por seu coment√°rio pedindo " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">escrever c√≥digo GPGPU t√£o simples e direto quanto um martelo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">,</font></a><font style="vertical-align: inherit;"> lendo o que finalmente passei a agir, o que resultou neste artigo.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD</font></font></h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27/06/2020. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obrigado a comentar</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avdx</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> removeu o zeramento de par√¢metros globais das fun√ß√µes e definiu o intervalo de part√≠culas emitidas para o fluxo de uma maneira diferente.</font></font></div>
      
    </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt508380/index.html">Automa√ß√£o de expedi√ß√£o de mercadorias na China</a></li>
<li><a href="../pt508384/index.html">Como familiarizar o desenvolvedor com os valores da sua empresa sem recorrer √† viol√™ncia</a></li>
<li><a href="../pt508390/index.html">VR ao treinar funcion√°rios. Os verdadeiros pr√≥s e contras</a></li>
<li><a href="../pt508392/index.html">Financiamento da Guerra Civil (EUA vs. EUA)</a></li>
<li><a href="../pt508394/index.html">Como os calouros do HSE de S√£o Petersburgo escreveram um cliente de torrent, um analisador de c√≥digo, um editor de fotos e n√£o apenas no semestre</a></li>
<li><a href="../pt508398/index.html">Tr√™s maneiras para um programador: especialista, l√≠der, fundador</a></li>
<li><a href="../pt508400/index.html">Como um "cidad√£o ativo" acostuma as pessoas ao phishing</a></li>
<li><a href="../pt508402/index.html">Como a arquitetura HiCampus simplifica as redes de campus</a></li>
<li><a href="../pt508404/index.html">Batalha AI vs. AI: fraude e conte√∫do falso</a></li>
<li><a href="../pt508408/index.html">Antiv√≠rus m√≥veis n√£o funcionam</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>