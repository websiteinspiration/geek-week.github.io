<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕧 👉🏿 🎣 機能RTC M41T56 💀 👨🏾‍🏭 👩🏼‍🎨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="M41T56は、人気のDS1307のアナログであるリアルタイムクロックチップです。そして、マイクロ回路のピン配置も同じですが、それらには大きな違いがあります。
 
 簡単な説明
 IICバスの動作については説明しません。両方のチップのアドレスが0xd0であることに注意してください。時間とともに動作す...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>機能RTC M41T56</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457796/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M41T56は、人気のDS1307のアナログであるリアルタイムクロックチップです。</font><font style="vertical-align: inherit;">そして、マイクロ回路のピン配置も同じですが、それらには大きな違いがあります。</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">簡単な説明</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IICバスの動作については説明しません。両方のチップのアドレスが0xd0であることに注意してください。</font><font style="vertical-align: inherit;">時間とともに動作するように、マイクロ回路には7つのアカウントレジスタと制御レジスタが含まれています。</font><font style="vertical-align: inherit;">アカウントレジスタには2進10進形式の数値が含まれていますが、一部のビットには特別な意味があります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レジスター</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
xxx-ビットの値が定義されていません。</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th rowspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数</font></font></th>
<th rowspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インデックス</font></font></th>
<th colspan="8"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ビット</font></font></th>
<th rowspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能な値</font></font></th>
</tr>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">３</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">秒</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x00</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ST</font></font></td>
<td colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数十秒</font></font></td>
<td colspan="4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">秒の単位</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0〜59</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x01</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xxx</font></font></td>
<td colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数十分</font></font></td>
<td colspan="4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分単位</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0〜59</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">時計</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x02</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セブ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SB</font></font></td>
<td colspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数十時間</font></font></td>
<td colspan="4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">時間単位</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0〜23</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">日</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x03</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xxx</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xxx</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xxx</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xxx</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xxx</font></font></td>
<td colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">曜日</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1-7</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">月の日</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x04</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xxx</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xxx</font></font></td>
<td colspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数十日</font></font></td>
<td colspan="4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">日の単位</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1-（28 | 29 | 30 | 31）</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">月</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x05</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xxx</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xxx</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xxx</font></font></td>
<td colspan="1"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デ</font></font></td>
<td colspan="4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">月の単位</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1〜12</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">年</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x06</font></font></td>
<td colspan="4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数十年</font></font></td>
<td colspan="4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">年間の単位</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0〜99</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">制御レジスタ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x07</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アウト</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FT</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></td>
<td colspan="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">補正量</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></td>
</tr>
</tbody></table></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ビット</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
x-スイッチを入れた後、ビットの状態は任意です。</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ビット</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リセット後</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解説</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ST</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バツ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このビットに1を書き込むと、ジェネレータは停止します</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CEB</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バツ</font></font></td>
<td rowspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CEB（世紀有効ビット）ビットが設定されている場合、新しい世紀に到達すると、CB（世紀ビット）ビットは値を反対に変更します。</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CB</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バツ</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アウト</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td rowspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OUT（OUTput level）ビットとFT（Frequency Test）ビットがゼロの場合、FT / OUTピンはグランドに押されています。</font><font style="vertical-align: inherit;">FT = 1の場合、FT / OUTピンは512 Hzで、OUTビットは関係ありません。</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FT</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バツ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RTCストローク校正マーク。</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
違いは、クロックレジスタのビット7、6、および5の割り当てから始まります。</font><font style="vertical-align: inherit;">M41T56では、ビット7および6は新世紀への移行を示すために使用され、ビット5および4は数十時間をカウントするために使用されます。</font><font style="vertical-align: inherit;">また、時間のカウントはモード24でのみ可能で、AM / PMモードは使用できません。</font><font style="vertical-align: inherit;">DS1307では、ビット7は使用されません。ビット6のゼロは、カウントモード24が使用されることを示します。この場合、ビット5と4には数十時間が含まれます。</font><font style="vertical-align: inherit;">ビット6が1の場合、ビット5はAM / PMフラグになり、ビット4は数十時間になります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要な違いは、単語訂正ストロークを含む制御レジスタにあります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コース修正</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
M41T56を使用すると、-62〜+124 ppmの範囲の水晶振動子の誤差を補正できます。これにより、偏差が1か月あたり±5秒以下になります。</font><font style="vertical-align: inherit;">補償には、制御レジスタの最下位6ビットが責任を負います。</font><font style="vertical-align: inherit;">ビット4〜0には補正値の符号なし整数が含まれ、ビット5は補正方向を設定します。</font><font style="vertical-align: inherit;">ビット5にゼロが含まれている場合、ストロークは2.034 ppmの増分で減速します。それ以外の場合、RTCは4.068 ppmの増分で加速します。</font><font style="vertical-align: inherit;">これは不便なので、ppmから補正ワードに、またはその逆に変換するための簡単な関数をいくつかスケッチしました。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/*        . */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MASK_CALIBR             ((1 &lt;&lt; 4) | (1 &lt;&lt; 3) | (1 &lt;&lt; 2) | (1 &lt;&lt; 1) | (1 &lt;&lt; 0))</span>
<span class="hljs-comment">/*        . */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MASK_CALIBR_SIGN        (1 &lt;&lt; 5)</span><font></font>
<font></font>
<span class="hljs-comment">/**
 *    .
 * @param caliber    RTC.
 * @return    ppm.
 */</span>
<span class="hljs-function"><span class="hljs-keyword">int8_t</span> <span class="hljs-title">caliber_to_ppm</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> caliber)</span>
</span>{
        <span class="hljs-keyword">int8_t</span> result = caliber &amp; MASK_CALIBR;<font></font>
<font></font>
        result = (<span class="hljs-keyword">uint8_t</span>) result * <span class="hljs-number">2</span>;
        <span class="hljs-keyword">if</span> ((caliber &amp; MASK_CALIBR_SIGN) != <span class="hljs-number">0</span>) {<font></font>
                result = -result;<font></font>
        } <span class="hljs-keyword">else</span> {<font></font>
                result = (<span class="hljs-keyword">uint8_t</span>) result * <span class="hljs-number">2</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> result;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/**
 *   .
 * @param ppm    ppm.
 * @return    RTC.
 */</span>
<span class="hljs-function"><span class="hljs-keyword">uint8_t</span> <span class="hljs-title">ppm_to_caliber</span><span class="hljs-params">(<span class="hljs-keyword">int8_t</span> ppm)</span>
</span>{
        <span class="hljs-keyword">uint8_t</span> result;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (ppm &lt; <span class="hljs-number">0</span>) {<font></font>
                result = (<span class="hljs-keyword">uint8_t</span>) (-ppm + <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>;<font></font>
                result |= MASK_CALIBR_SIGN;<font></font>
        } <span class="hljs-keyword">else</span> {<font></font>
                result = (<span class="hljs-keyword">uint8_t</span>) (ppm + <span class="hljs-number">2</span>) / <span class="hljs-number">4</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> result;<font></font>
}<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">故障検出</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DS1307もM41T56も生成エラーを検出できませんが、電源投入時に一部のビットが特定の状態になることを保証します。</font><font style="vertical-align: inherit;">M41T56は、コントロールレジスタで有効にすると10xxxxxxになります。</font><font style="vertical-align: inherit;">プログラムのクラッシュを追跡するには、次のアルゴリズムを使用できます。</font><font style="vertical-align: inherit;">マイクロコントローラーがオンになっているときに、RTC制御レジスターに10xxxxxxが含まれている場合、電源障害が発生したため、上位ビットが10でないレジスタに値を書き込む必要があります。最も簡単なことは、ビット7と6がゼロに等しい補正ワードを書き込むことです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文献</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ファクト</font></a><font style="vertical-align: inherit;">シート</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M41T56</font></font></a></li>
<li><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">DS1307データ</font></a><font style="vertical-align: inherit;">シート</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja457776/index.html">性能の低い鉱山が翼で待っています：パート2</a></li>
<li><a href="../ja457784/index.html">カスタムアイトラッカーキャリブレーション</a></li>
<li><a href="../ja457786/index.html">Anet A8 Plusを更新しました。大きくて金属</a></li>
<li><a href="../ja457790/index.html">BuratinoPhone携帯電話</a></li>
<li><a href="../ja457794/index.html">共積分関係の対称性</a></li>
<li><a href="../ja457798/index.html">オープンソースファンドの活動-最近のOpenStackおよびLinux Foundationプロジェクトについて</a></li>
<li><a href="../ja457800/index.html">サイバー犯罪者によって積極的に悪用されるMacOS Mojaveの重大な脆弱性</a></li>
<li><a href="../ja457804/index.html">ListenIt-記事の音声バージョンを自動的に作成するためのGoogle Chrome拡張機能</a></li>
<li><a href="../ja457808/index.html">サーマルイメージャーSeek Thermal Compact</a></li>
<li><a href="../ja457810/index.html">ソフトウェア工学アプローチ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>