<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕰️ ⚱️ 🛌🏿 ティーポットからのAndroid Camera2 API、パート3。UDPを介したメディアコーデックとストリーミングビデオ 🕐 👩‍⚖️ 🚁</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="したがって、Camera2 APIを使用して写真を撮影し、ビデオを記録することで、私たちは理解したようです。Androidデバイスから外部から苦しむ受信者にビデオストリームを転送する方法を学ぶだけです。以前にも繰り返し言われているように、究極の目標はロボットの知性化です。その上にスマートフォンを置き...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ティーポットからのAndroid Camera2 API、パート3。UDPを介したメディアコーデックとストリーミングビデオ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/473036/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">したがって、Camera2 APIを使用して写真を撮影し、ビデオを記録することで、私たちは理解したようです。</font><font style="vertical-align: inherit;">Androidデバイスから外部から苦しむ受信者にビデオストリームを転送する方法を学ぶだけです。</font><font style="vertical-align: inherit;">以前にも繰り返し言われているように、究極の目標はロボットの知性化です。その上にスマートフォンを置き、いわば猿を人に変えます。</font><font style="vertical-align: inherit;">Media Codecがこれを助けてくれます。</font><font style="vertical-align: inherit;">そしてもちろん、新しいCamera2 API。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/sa/tl/mf/satlmfdhbe-ow-gywoc5-tuxupe.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
猫の下で誰が気にかけてください。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロボットシステムを使用したプロジェクトの詳細については、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こちらをご覧ください</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。ただし、今の</font><font style="vertical-align: inherit;">ところ、プロジェクト</font><font style="vertical-align: inherit;">（または</font><font style="vertical-align: inherit;">、プロジェクトに</font><font style="vertical-align: inherit;">接続されているAndroidスマートフォン）からパーソナル電子コンピューターに直接ビデオをストリーミングします。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これには何が必要ですか？</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご存知のように、スマートフォンの画面から別の場所にビデオストリームを転送するには、まずそのストリーム（ストリーム）を適切な縮小フォーマット（フレームごとに送信するには厚すぎるため）に変換し、タイムスタンプ（タイムスタンプ）を設定してバイナリ形式で受信者に送信する必要があります。逆デコード操作を実行します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Android 4.3のリリース日から2013年以降Media Codecクラスが処理してきたのは、まさにこれらの低レベルのブラックケースです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ci/oz/xq/ciozxqlqwq8hecadsrkn0-8me6m.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もう1つのことは、今日とは異なり、以前のビデオエンコーディングのアプローチはそれほど単純ではなかったことです。カメラから写真を撮るには、たくさんの</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">不思議なコード</font></a><font style="vertical-align: inherit;">を使わなければなりませんでした</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヤクートのシャーマンの呪文のように、唯一の不正確さはアプリケーションの完全な崩壊につながる可能性があります。これに以前のCamera APIを追加します。既製のコールバックの代わりに、異なる同期ペンを自分で書く必要があり、このレッスンは、気の弱い人向けではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして最も重要なのは、動作している</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コード</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を遠くから見て</font><font style="vertical-align: inherit;">、すべてが一般的な用語で明確に思われることです。プロジェクトに部分的に転送し始めます-なぜそれが注がれているのかは明らかではありません。しかし、詳細を理解するのが難しいため、修正することは不可能です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
はい、そして</font><font style="vertical-align: inherit;">何とか安心して</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非推奨の</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">固体から</font><font style="vertical-align: inherit;">。要するに、</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
混乱は幸いにも、ゆっくりと機転が利くGoogleビルダーのために、</font><b><font style="vertical-align: inherit;">Surfaceの</font></b><font style="vertical-align: inherit;">魔法の概念を導入しました</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用すると、低レベルの詳細を回避できます。</font><font style="vertical-align: inherit;">素人として私がどのようなコストで何を開発者が失うかを理解することは困難ですが、今やほぼ文字通り言うことができます：「Android、カメラからのビデオが表示されるこのSurfaceを、何も変更せずにそのままエンコードしてください送信してください。」</font><font style="vertical-align: inherit;">そして最も驚くべきことはそれが機能することです。</font><font style="vertical-align: inherit;">また、新しいCamera2 APIを使用すると、プログラム自体がデータを送信するタイミングを認識し、新しいコールバックが表示されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
だから今ビデオをエンコードする-ちょうど唾を吐きます。</font><font style="vertical-align: inherit;">どうしましょう。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">最初の記事</font></a></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
からコードを取得し、</font><font style="vertical-align: inherit;">いつものように、ボタンとカメラの初期化を除いて</font><font style="vertical-align: inherit;">、コードから</font><font style="vertical-align: inherit;">すべてを捨てます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリのレイアウトから始めましょう。</font></font></b><div class="spoiler_text"><pre><code class="java hljs">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"utf-8"</span>?&gt;<font></font>
&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    xmlns:app=<span class="hljs-string">"http://schemas.android.com/apk/res-auto"</span>
    xmlns:tools=<span class="hljs-string">"http://schemas.android.com/tools"</span>
    android:layout_width=<span class="hljs-string">"match_parent"</span>
    android:layout_height=<span class="hljs-string">"match_parent"</span>
    tools:context=<span class="hljs-string">".MainActivity"</span>&gt;<font></font>
<font></font>
    &lt;TextureView<font></font>
        android:id=<span class="hljs-string">"@+id/textureView"</span>
        android:layout_width=<span class="hljs-string">"356dp"</span>
        android:layout_height=<span class="hljs-string">"410dp"</span>
        android:layout_marginTop=<span class="hljs-string">"32dp"</span>
        app:layout_constraintEnd_toEndOf=<span class="hljs-string">"parent"</span>
        app:layout_constraintHorizontal_bias=<span class="hljs-string">"0.49"</span>
        app:layout_constraintStart_toStartOf=<span class="hljs-string">"parent"</span>
        app:layout_constraintTop_toTopOf=<span class="hljs-string">"parent"</span> /&gt;<font></font>
<font></font>
    &lt;LinearLayout<font></font>
        android:layout_width=<span class="hljs-string">"292dp"</span>
        android:layout_height=<span class="hljs-string">"145dp"</span>
        android:layout_marginStart=<span class="hljs-string">"16dp"</span>
        android:orientation=<span class="hljs-string">"vertical"</span>
        app:layout_constraintBottom_toBottomOf=<span class="hljs-string">"parent"</span>
        app:layout_constraintEnd_toEndOf=<span class="hljs-string">"parent"</span>
        app:layout_constraintStart_toStartOf=<span class="hljs-string">"parent"</span>
        app:layout_constraintTop_toBottomOf=<span class="hljs-string">"@+id/textureView"</span>
        app:layout_constraintVertical_bias=<span class="hljs-string">"0.537"</span>&gt;<font></font>
<font></font>
        &lt;Button<font></font>
            android:id=<span class="hljs-string">"@+id/button1"</span>
            android:layout_width=<span class="hljs-string">"match_parent"</span>
            android:layout_height=<span class="hljs-string">"wrap_content"</span>
            android:text=<span class="hljs-string">"   "</span> /&gt;<font></font>
<font></font>
        &lt;Button<font></font>
            android:id=<span class="hljs-string">"@+id/button2"</span>
            android:layout_width=<span class="hljs-string">"match_parent"</span>
            android:layout_height=<span class="hljs-string">"wrap_content"</span>
            android:text=<span class="hljs-string">" "</span> /&gt;<font></font>
<font></font>
        &lt;Button<font></font>
            android:id=<span class="hljs-string">"@+id/button3"</span>
            android:layout_width=<span class="hljs-string">"match_parent"</span>
            android:layout_height=<span class="hljs-string">"wrap_content"</span>
            android:text=<span class="hljs-string">" "</span> /&gt;<font></font>
    &lt;/LinearLayout&gt;<font></font>
<font></font>
<font></font>
&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;<font></font>
<font></font>
</code></pre><br>
</div></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そして、メディアコーデックのフックで終わります</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前回の投稿では、カメラからの画像をSurfaceに表示し、MediaRecorderを使用してビデオから書き込みました。</font><font style="vertical-align: inherit;">これを行うには、Surfaceリストで両方のコンポーネントを指定するだけです。</font></font><br>
<br>
<pre><code class="java hljs">(Arrays.asList(surface, mMediaRecorder.getSurface()).
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでも同じですが、mMediaRecorderの代わりに指定します。</font></font><br>
<br>
<pre><code class="java hljs">(Arrays.asList(surface, mEncoderSurface),
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のようになります。</font></font><br>
<br>
<pre><code class="java hljs">   <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">startCameraPreviewSession</span><span class="hljs-params">()</span> </span>{<font></font>
            SurfaceTexture texture = mImageView.getSurfaceTexture();<font></font>
            texture.setDefaultBufferSize(<span class="hljs-number">320</span>, <span class="hljs-number">240</span>);<font></font>
            surface = <span class="hljs-keyword">new</span> Surface(texture);<font></font>
<font></font>
<font></font>
            <span class="hljs-keyword">try</span> {<font></font>
<font></font>
                mPreviewBuilder = mCameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_PREVIEW);<font></font>
                mPreviewBuilder.addTarget(surface);<font></font>
                mPreviewBuilder.addTarget(mEncoderSurface);<font></font>
<font></font>
<font></font>
                mCameraDevice.createCaptureSession(Arrays.asList(surface, mEncoderSurface),<font></font>
<font></font>
                        <span class="hljs-keyword">new</span> CameraCaptureSession.StateCallback() {<font></font>
<font></font>
                            <span class="hljs-meta">@Override</span>
                            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onConfigured</span><span class="hljs-params">(CameraCaptureSession session)</span> </span>{<font></font>
                                mSession = session;<font></font>
<font></font>
                                <span class="hljs-keyword">try</span> {<font></font>
                                    mSession.setRepeatingRequest(mPreviewBuilder.build(), <span class="hljs-keyword">null</span>, mBackgroundHandler);<font></font>
                                } <span class="hljs-keyword">catch</span> (CameraAccessException e) {<font></font>
                                    e.printStackTrace();<font></font>
                                }<font></font>
                            }<font></font>
<font></font>
                            <span class="hljs-meta">@Override</span>
                            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onConfigureFailed</span><span class="hljs-params">(CameraCaptureSession session)</span> </span>{<font></font>
                            }<font></font>
                        }, mBackgroundHandler);<font></font>
            } <span class="hljs-keyword">catch</span> (CameraAccessException e) {<font></font>
                e.printStackTrace();<font></font>
            }<font></font>
<font></font>
        }<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mEncoderSurfaceとは何ですか？</font><font style="vertical-align: inherit;">これは、Media Codecが動作するのと同じSurfaceです。</font><font style="vertical-align: inherit;">手始めに、両方ともほぼこの方法で初期化する必要があります。</font></font><br>
<br>
<pre><code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUpMediaCodec</span><span class="hljs-params">()</span> </span>{<font></font>
<font></font>
<font></font>
<font></font>
        <span class="hljs-keyword">try</span> {<font></font>
            mCodec = MediaCodec.createEncoderByType(<span class="hljs-string">"video/avc"</span>); <span class="hljs-comment">// H264 </span><font></font>
<font></font>
        } <span class="hljs-keyword">catch</span> (Exception e) {<font></font>
            Log.i(LOG_TAG, <span class="hljs-string">"  "</span>);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">int</span> width = <span class="hljs-number">320</span>; <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">int</span> height = <span class="hljs-number">240</span>; <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">int</span> colorFormat = MediaCodecInfo.CodecCapabilities.COLOR_FormatSurface; <span class="hljs-comment">//   </span>
        <span class="hljs-keyword">int</span> videoBitrate = <span class="hljs-number">500000</span>; <span class="hljs-comment">//    bps (  )</span>
        <span class="hljs-keyword">int</span> videoFramePerSecond = <span class="hljs-number">20</span>; <span class="hljs-comment">// FPS</span>
        <span class="hljs-keyword">int</span> iframeInterval = <span class="hljs-number">2</span>; <span class="hljs-comment">// I-Frame   </span><font></font>
<font></font>
        MediaFormat format = MediaFormat.createVideoFormat(<span class="hljs-string">"video/avc"</span>, width, height);<font></font>
        format.setInteger(MediaFormat.KEY_COLOR_FORMAT, colorFormat);<font></font>
        format.setInteger(MediaFormat.KEY_BIT_RATE, videoBitrate);<font></font>
        format.setInteger(MediaFormat.KEY_FRAME_RATE, videoFramePerSecond);<font></font>
        format.setInteger(MediaFormat.KEY_I_FRAME_INTERVAL, iframeInterval);<font></font>
<font></font>
<font></font>
        mCodec.configure(format, <span class="hljs-keyword">null</span>, <span class="hljs-keyword">null</span>, MediaCodec.CONFIGURE_FLAG_ENCODE); <span class="hljs-comment">//    </span>
        mEncoderSurface = mCodec.createInputSurface(); <span class="hljs-comment">//  Surface </span><font></font>
<font></font>
        mCodec.setCallback(<span class="hljs-keyword">new</span> EncoderCallback());<font></font>
        mCodec.start(); <span class="hljs-comment">//  </span>
        Log.i(LOG_TAG, <span class="hljs-string">" "</span>);<font></font>
<font></font>
    }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、1つのコールバックを登録するだけです。</font><font style="vertical-align: inherit;">Media Codecが次のブロードキャストの次のデータの準備ができていると突然感じたとき、彼はそれについて彼に通知します。</font></font><br>
<br>
<pre><code class="java hljs">    <span class="hljs-keyword">private</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EncoderCallback</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">MediaCodec</span>.<span class="hljs-title">Callback</span> </span>{<font></font>
<font></font>
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onInputBufferAvailable</span><span class="hljs-params">(MediaCodec codec, <span class="hljs-keyword">int</span> index)</span> </span>{<font></font>
<font></font>
        }<font></font>
<font></font>
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onOutputBufferAvailable</span><span class="hljs-params">(MediaCodec codec, <span class="hljs-keyword">int</span> index, MediaCodec.BufferInfo info)</span> </span>{<font></font>
<font></font>
<font></font>
            outPutByteBuffer = mCodec.getOutputBuffer(index);<font></font>
            <span class="hljs-keyword">byte</span>[] outDate = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[info.size];<font></font>
            outPutByteBuffer.get(outDate);<font></font>
<font></font>
<font></font>
         <font></font>
            Log.i(LOG_TAG, <span class="hljs-string">" outDate.length : "</span> + outDate.length);<font></font>
   <font></font>
<font></font>
            mCodec.releaseOutputBuffer(index, <span class="hljs-keyword">false</span>);<font></font>
<font></font>
<font></font>
        }<font></font>
<font></font>
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onError</span><span class="hljs-params">(MediaCodec codec, MediaCodec.CodecException e)</span> </span>{<font></font>
            Log.i(LOG_TAG, <span class="hljs-string">"Error: "</span> + e);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onOutputFormatChanged</span><span class="hljs-params">(MediaCodec codec, MediaFormat format)</span> </span>{<font></font>
            Log.i(LOG_TAG, <span class="hljs-string">"encoder output format changed: "</span> + format);<font></font>
        }<font></font>
    }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
outDateバイト配列は本当の宝物です。</font><font style="vertical-align: inherit;">これには、エンコード済みのH264ビデオストリームの既製の部分が含まれています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここにそれらは... </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lh/pe/kz/lhpekzdgk-z95gpos8493tdgdqi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ネットワーク経由での送信には大きすぎるものもありますが、システムが必要に応じてそれ自体を切り取って受信者に送信するものはありません。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、それが非常に怖い場合は、そのような破片を押し込むことによって、自分を細断することができます。</font></font><br>
<pre><code class="java hljs"> <span class="hljs-keyword">int</span> count =<span class="hljs-number">0</span>;<font></font>
<font></font>
            <span class="hljs-keyword">int</span> temp =outDate.length ;<font></font>
<font></font>
            <span class="hljs-keyword">do</span> {<span class="hljs-comment">//   </span><font></font>
<font></font>
                <span class="hljs-keyword">byte</span>[] ds;<font></font>
<font></font>
                temp = temp-<span class="hljs-number">1024</span>;<font></font>
<font></font>
                <span class="hljs-keyword">if</span>(temp&gt;=<span class="hljs-number">0</span>)<font></font>
                { ds = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[<span class="hljs-number">1024</span>];}
                <span class="hljs-keyword">else</span>
                { ds = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[temp+<span class="hljs-number">1024</span>];}<font></font>
<font></font>
<font></font>
                <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i =<span class="hljs-number">0</span>;i&lt;ds.length;i++)<font></font>
                {<font></font>
                    ds[i]=outDate[i+<span class="hljs-number">1024</span>*count];<font></font>
<font></font>
                }<font></font>
<font></font>
                count=count+<span class="hljs-number">1</span>;<font></font>
<font></font>
<font></font>
              <font></font>
            }<font></font>
            <span class="hljs-keyword">while</span> (temp&gt;=<span class="hljs-number">0</span>);<font></font>
<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし今のところ、バッファ内のデータが実際にH264ビデオストリームであることを直接確認する必要があります。</font><font style="vertical-align: inherit;">したがって、それらをファイルに送信しましょう：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
セットアップに書き込みます。</font></font><br>
<br>
<pre><code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUpMediaCodec</span><span class="hljs-params">()</span> </span>{<font></font>
<font></font>
 File mFile = <span class="hljs-keyword">new</span> File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DCIM), <span class="hljs-string">"test3.h264"</span>);<font></font>
<font></font>
        <span class="hljs-keyword">try</span> {<font></font>
            outputStream = <span class="hljs-keyword">new</span> BufferedOutputStream(<span class="hljs-keyword">new</span> FileOutputStream(mFile));<font></font>
            Log.i(<span class="hljs-string">"Encoder"</span>, <span class="hljs-string">"outputStream initialized"</span>);<font></font>
        } <span class="hljs-keyword">catch</span> (Exception e) {<font></font>
            e.printStackTrace();<font></font>
        }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、コールバックではどこにバッファがあります：</font></font><br>
<br>
<pre><code class="java hljs">
     <span class="hljs-keyword">try</span> {<font></font>
                <font></font>
                outputStream.write(outDate, <span class="hljs-number">0</span>, outDate.length);<span class="hljs-comment">//    </span>
            } <span class="hljs-keyword">catch</span> (IOException e) {
                <span class="hljs-comment">// TODO Auto-generated catch block</span><font></font>
                e.printStackTrace();<font></font>
            }<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーションを開き、ボタン「カメラとストリームをオンにする」を押します。自動的に録音が始まります。少し待ってストップボタンを押します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
保存されたファイルは、形式がMP4ではないため、通常は失われませんが、VLCプレーヤーで開いたり、オンラインコンバージョンを使用してオンラインで変換したりすると</font><font style="vertical-align: inherit;">、正しい方向に</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">進ん</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">でいることを確認できます。確かに、画像は横向きですが、修正可能です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般に、記録、写真撮影、またはストリーミングのイベントごとに、当然、毎回新しいセッションを開いて、古いセッションを閉じることをお勧めします。</font><font style="vertical-align: inherit;">つまり、最初にカメラをオンにして、ベアプレビューを起動します。</font><font style="vertical-align: inherit;">次に、写真を撮る必要がある場合は、プレビューを閉じてプレビューを開きますが、イメージリーダーは固定されています。</font><font style="vertical-align: inherit;">ビデオ録画に切り替える場合は、現在のセッションを閉じ、プレビューとメディアレコーダーを接続してセッションを開始します。</font><font style="vertical-align: inherit;">コードの可視性が損なわれないようにするために、これはしませんでしたが、自分にとってより便利な方法を決めるのはあなた次第です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、これがコード全体です。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BasicMediaCodec</font></font></b><div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-keyword">package</span> com.example.basicmediacodec;<font></font>
<font></font>
<span class="hljs-keyword">import</span> androidx.annotation.RequiresApi;
<span class="hljs-keyword">import</span> androidx.appcompat.app.AppCompatActivity;
<span class="hljs-keyword">import</span> androidx.core.content.ContextCompat;<font></font>
<font></font>
<span class="hljs-keyword">import</span> android.Manifest;
<span class="hljs-keyword">import</span> android.content.Context;
<span class="hljs-keyword">import</span> android.content.pm.ActivityInfo;
<span class="hljs-keyword">import</span> android.content.pm.PackageManager;<font></font>
<font></font>
<span class="hljs-keyword">import</span> android.graphics.SurfaceTexture;
<span class="hljs-keyword">import</span> android.hardware.camera2.CameraAccessException;
<span class="hljs-keyword">import</span> android.hardware.camera2.CameraCaptureSession;
<span class="hljs-keyword">import</span> android.hardware.camera2.CameraDevice;
<span class="hljs-keyword">import</span> android.hardware.camera2.CameraManager;
<span class="hljs-keyword">import</span> android.hardware.camera2.CaptureRequest;<font></font>
<font></font>
<font></font>
<span class="hljs-keyword">import</span> android.media.MediaCodec;
<span class="hljs-keyword">import</span> android.media.MediaCodecInfo;
<span class="hljs-keyword">import</span> android.media.MediaFormat;
<span class="hljs-keyword">import</span> android.os.Build;
<span class="hljs-keyword">import</span> android.os.Bundle;<font></font>
<font></font>
<span class="hljs-keyword">import</span> android.os.Environment;
<span class="hljs-keyword">import</span> android.os.Handler;
<span class="hljs-keyword">import</span> android.os.HandlerThread;
<span class="hljs-keyword">import</span> android.os.StrictMode;
<span class="hljs-keyword">import</span> android.util.Log;
<span class="hljs-keyword">import</span> android.view.Surface;
<span class="hljs-keyword">import</span> android.view.TextureView;
<span class="hljs-keyword">import</span> android.view.View;
<span class="hljs-keyword">import</span> android.widget.Button;
<span class="hljs-keyword">import</span> android.widget.Toast;<font></font>
<font></font>
<font></font>
<span class="hljs-keyword">import</span> java.io.BufferedOutputStream;
<span class="hljs-keyword">import</span> java.io.File;
<span class="hljs-keyword">import</span> java.io.FileOutputStream;
<span class="hljs-keyword">import</span> java.io.IOException;
<span class="hljs-keyword">import</span> java.nio.ByteBuffer;
<span class="hljs-keyword">import</span> java.util.Arrays;<font></font>
<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AppCompatActivity</span> </span>{<font></font>
<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String LOG_TAG = <span class="hljs-string">"myLogs"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Surface surface = <span class="hljs-keyword">null</span>;<font></font>
<font></font>
    CameraService[] myCameras = <span class="hljs-keyword">null</span>;<font></font>
<font></font>
    <span class="hljs-keyword">private</span> CameraManager mCameraManager = <span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> CAMERA1 = <span class="hljs-number">0</span>;<font></font>
<font></font>
<font></font>
    <span class="hljs-keyword">private</span> Button mButtonOpenCamera1 = <span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">private</span> Button mButtonStreamVideo = <span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">private</span> Button mButtonTStopStreamVideo = <span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> TextureView mImageView = <span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">private</span> HandlerThread mBackgroundThread;
    <span class="hljs-keyword">private</span> Handler mBackgroundHandler = <span class="hljs-keyword">null</span>;<font></font>
<font></font>
    <span class="hljs-keyword">private</span> MediaCodec mCodec = <span class="hljs-keyword">null</span>; <span class="hljs-comment">// </span>
    Surface mEncoderSurface; <span class="hljs-comment">// Surface     </span><font></font>
    BufferedOutputStream outputStream;<font></font>
    ByteBuffer outPutByteBuffer;<font></font>
<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">startBackgroundThread</span><span class="hljs-params">()</span> </span>{<font></font>
        mBackgroundThread = <span class="hljs-keyword">new</span> HandlerThread(<span class="hljs-string">"CameraBackground"</span>);<font></font>
        mBackgroundThread.start();<font></font>
        mBackgroundHandler = <span class="hljs-keyword">new</span> Handler(mBackgroundThread.getLooper());<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">stopBackgroundThread</span><span class="hljs-params">()</span> </span>{<font></font>
        mBackgroundThread.quitSafely();<font></font>
        <span class="hljs-keyword">try</span> {<font></font>
            mBackgroundThread.join();<font></font>
            mBackgroundThread = <span class="hljs-keyword">null</span>;<font></font>
            mBackgroundHandler = <span class="hljs-keyword">null</span>;<font></font>
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {<font></font>
            e.printStackTrace();<font></font>
        }<font></font>
    }<font></font>
<font></font>
<font></font>
    <span class="hljs-meta">@RequiresApi(api = Build.VERSION_CODES.M)</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> </span>{<font></font>
<font></font>
<font></font>
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState);<font></font>
<font></font>
     <font></font>
        setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);<font></font>
<font></font>
        setContentView(R.layout.activity_main);<font></font>
<font></font>
<font></font>
        Log.d(LOG_TAG, <span class="hljs-string">" "</span>);
        <span class="hljs-keyword">if</span> (checkSelfPermission(Manifest.permission.CAMERA) != PackageManager.PERMISSION_GRANTED<font></font>
                ||<font></font>
                (ContextCompat.checkSelfPermission(MainActivity.<span class="hljs-keyword">this</span>, Manifest.permission.WRITE_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED)<font></font>
        ) {<font></font>
            requestPermissions(<span class="hljs-keyword">new</span> String[]{Manifest.permission.CAMERA, Manifest.permission.WRITE_EXTERNAL_STORAGE}, <span class="hljs-number">1</span>);<font></font>
        }<font></font>
<font></font>
<font></font>
        mButtonOpenCamera1 = findViewById(R.id.button1);<font></font>
        mButtonStreamVideo = findViewById(R.id.button2);<font></font>
        mButtonTStopStreamVideo = findViewById(R.id.button3);<font></font>
        mImageView = findViewById(R.id.textureView);<font></font>
<font></font>
        mButtonOpenCamera1.setOnClickListener(<span class="hljs-keyword">new</span> View.OnClickListener() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onClick</span><span class="hljs-params">(View v)</span> </span>{<font></font>
<font></font>
<font></font>
                setUpMediaCodec();<span class="hljs-comment">//   </span><font></font>
<font></font>
                <span class="hljs-keyword">if</span> (myCameras[CAMERA1] != <span class="hljs-keyword">null</span>) {<span class="hljs-comment">//  </span>
                    <span class="hljs-keyword">if</span> (!myCameras[CAMERA1].isOpen()) myCameras[CAMERA1].openCamera();<font></font>
                }<font></font>
<font></font>
<font></font>
            }<font></font>
        });<font></font>
<font></font>
        mButtonStreamVideo.setOnClickListener(<span class="hljs-keyword">new</span> View.OnClickListener() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onClick</span><span class="hljs-params">(View v)</span> </span>{<font></font>
<font></font>
                {<font></font>
                      <span class="hljs-comment">//    </span><font></font>
<font></font>
                }<font></font>
<font></font>
               }<font></font>
        });<font></font>
<font></font>
<font></font>
        mButtonTStopStreamVideo.setOnClickListener(<span class="hljs-keyword">new</span> View.OnClickListener() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onClick</span><span class="hljs-params">(View v)</span> </span>{<font></font>
<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (mCodec != <span class="hljs-keyword">null</span>) {<font></font>
<font></font>
                    Toast.makeText(MainActivity.<span class="hljs-keyword">this</span>, <span class="hljs-string">"  "</span>, Toast.LENGTH_SHORT).show();<font></font>
                    myCameras[CAMERA1].stopStreamingVideo();<font></font>
                }<font></font>
<font></font>
<font></font>
            }<font></font>
        });<font></font>
<font></font>
<font></font>
        mCameraManager = (CameraManager) getSystemService(Context.CAMERA_SERVICE);<font></font>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">//     </span><font></font>
<font></font>
            myCameras = <span class="hljs-keyword">new</span> CameraService[mCameraManager.getCameraIdList().length];<font></font>
<font></font>
            <span class="hljs-keyword">for</span> (String cameraID : mCameraManager.getCameraIdList()) {<font></font>
                Log.i(LOG_TAG, <span class="hljs-string">"cameraID: "</span> + cameraID);
                <span class="hljs-keyword">int</span> id = Integer.parseInt(cameraID);
                <span class="hljs-comment">//    </span>
                myCameras[id] = <span class="hljs-keyword">new</span> CameraService(mCameraManager, cameraID);<font></font>
<font></font>
            }<font></font>
        } <span class="hljs-keyword">catch</span> (CameraAccessException e) {<font></font>
            Log.e(LOG_TAG, e.getMessage());<font></font>
            e.printStackTrace();<font></font>
        }<font></font>
<font></font>
    }<font></font>
<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CameraService</span> </span>{<font></font>
<font></font>
<font></font>
        <span class="hljs-keyword">private</span> String mCameraID;
        <span class="hljs-keyword">private</span> CameraDevice mCameraDevice = <span class="hljs-keyword">null</span>;
        <span class="hljs-keyword">private</span> CameraCaptureSession mSession;
        <span class="hljs-keyword">private</span> CaptureRequest.Builder mPreviewBuilder;<font></font>
<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CameraService</span><span class="hljs-params">(CameraManager cameraManager, String cameraID)</span> </span>{<font></font>
<font></font>
            mCameraManager = cameraManager;<font></font>
            mCameraID = cameraID;<font></font>
<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">private</span> CameraDevice.StateCallback mCameraCallback = <span class="hljs-keyword">new</span> CameraDevice.StateCallback() {<font></font>
<font></font>
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onOpened</span><span class="hljs-params">(CameraDevice camera)</span> </span>{<font></font>
                mCameraDevice = camera;<font></font>
                Log.i(LOG_TAG, <span class="hljs-string">"Open camera  with id:"</span> + mCameraDevice.getId());<font></font>
<font></font>
                startCameraPreviewSession();<font></font>
            }<font></font>
<font></font>
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onDisconnected</span><span class="hljs-params">(CameraDevice camera)</span> </span>{<font></font>
                mCameraDevice.close();<font></font>
<font></font>
                Log.i(LOG_TAG, <span class="hljs-string">"disconnect camera  with id:"</span> + mCameraDevice.getId());<font></font>
                mCameraDevice = <span class="hljs-keyword">null</span>;<font></font>
            }<font></font>
<font></font>
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onError</span><span class="hljs-params">(CameraDevice camera, <span class="hljs-keyword">int</span> error)</span> </span>{<font></font>
                Log.i(LOG_TAG, <span class="hljs-string">"error! camera id:"</span> + camera.getId() + <span class="hljs-string">" error:"</span> + error);<font></font>
            }<font></font>
        };<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">startCameraPreviewSession</span><span class="hljs-params">()</span> </span>{<font></font>
            SurfaceTexture texture = mImageView.getSurfaceTexture();<font></font>
            texture.setDefaultBufferSize(<span class="hljs-number">320</span>, <span class="hljs-number">240</span>);<font></font>
            surface = <span class="hljs-keyword">new</span> Surface(texture);<font></font>
<font></font>
<font></font>
            <span class="hljs-keyword">try</span> {<font></font>
<font></font>
                mPreviewBuilder = mCameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_PREVIEW);<font></font>
                mPreviewBuilder.addTarget(surface);<font></font>
                mPreviewBuilder.addTarget(mEncoderSurface);<font></font>
<font></font>
<font></font>
                mCameraDevice.createCaptureSession(Arrays.asList(surface, mEncoderSurface),<font></font>
<font></font>
                        <span class="hljs-keyword">new</span> CameraCaptureSession.StateCallback() {<font></font>
<font></font>
                            <span class="hljs-meta">@Override</span>
                            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onConfigured</span><span class="hljs-params">(CameraCaptureSession session)</span> </span>{<font></font>
                                mSession = session;<font></font>
<font></font>
                                <span class="hljs-keyword">try</span> {<font></font>
                                    mSession.setRepeatingRequest(mPreviewBuilder.build(), <span class="hljs-keyword">null</span>, mBackgroundHandler);<font></font>
                                } <span class="hljs-keyword">catch</span> (CameraAccessException e) {<font></font>
                                    e.printStackTrace();<font></font>
                                }<font></font>
                            }<font></font>
<font></font>
                            <span class="hljs-meta">@Override</span>
                            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onConfigureFailed</span><span class="hljs-params">(CameraCaptureSession session)</span> </span>{<font></font>
                            }<font></font>
                        }, mBackgroundHandler);<font></font>
            } <span class="hljs-keyword">catch</span> (CameraAccessException e) {<font></font>
                e.printStackTrace();<font></font>
            }<font></font>
<font></font>
        }<font></font>
<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isOpen</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">if</span> (mCameraDevice == <span class="hljs-keyword">null</span>) {
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<font></font>
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<font></font>
            }<font></font>
        }<font></font>
<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">openCamera</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">try</span> {<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (checkSelfPermission(Manifest.permission.CAMERA) == PackageManager.PERMISSION_GRANTED) {<font></font>
<font></font>
                    mCameraManager.openCamera(mCameraID, mCameraCallback, mBackgroundHandler);<font></font>
<font></font>
                }<font></font>
<font></font>
            } <span class="hljs-keyword">catch</span> (CameraAccessException e) {<font></font>
                Log.i(LOG_TAG, e.getMessage());<font></font>
<font></font>
            }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">closeCamera</span><span class="hljs-params">()</span> </span>{<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (mCameraDevice != <span class="hljs-keyword">null</span>) {<font></font>
                mCameraDevice.close();<font></font>
                mCameraDevice = <span class="hljs-keyword">null</span>;<font></font>
            }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">stopStreamingVideo</span><span class="hljs-params">()</span> </span>{<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (mCameraDevice != <span class="hljs-keyword">null</span> &amp; mCodec != <span class="hljs-keyword">null</span>) {<font></font>
<font></font>
                <span class="hljs-keyword">try</span> {<font></font>
                    mSession.stopRepeating();<font></font>
                    mSession.abortCaptures();<font></font>
                } <span class="hljs-keyword">catch</span> (CameraAccessException e) {<font></font>
                    e.printStackTrace();<font></font>
                }<font></font>
<font></font>
                mCodec.stop();<font></font>
                mCodec.release();<font></font>
                mEncoderSurface.release();<font></font>
                closeCamera();<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUpMediaCodec</span><span class="hljs-params">()</span> </span>{<font></font>
<font></font>
<font></font>
        File mFile = <span class="hljs-keyword">new</span> File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DCIM), <span class="hljs-string">"test3.h264"</span>);<font></font>
<font></font>
        <span class="hljs-keyword">try</span> {<font></font>
            outputStream = <span class="hljs-keyword">new</span> BufferedOutputStream(<span class="hljs-keyword">new</span> FileOutputStream(mFile));<font></font>
            Log.i(<span class="hljs-string">"Encoder"</span>, <span class="hljs-string">"outputStream initialized"</span>);<font></font>
        } <span class="hljs-keyword">catch</span> (Exception e) {<font></font>
            e.printStackTrace();<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">try</span> {<font></font>
            mCodec = MediaCodec.createEncoderByType(<span class="hljs-string">"video/avc"</span>); <span class="hljs-comment">// H264 </span><font></font>
<font></font>
        } <span class="hljs-keyword">catch</span> (Exception e) {<font></font>
            Log.i(LOG_TAG, <span class="hljs-string">"  "</span>);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">int</span> width = <span class="hljs-number">320</span>; <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">int</span> height = <span class="hljs-number">240</span>; <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">int</span> colorFormat = MediaCodecInfo.CodecCapabilities.COLOR_FormatSurface; <span class="hljs-comment">//   </span>
        <span class="hljs-keyword">int</span> videoBitrate = <span class="hljs-number">500000</span>; <span class="hljs-comment">//    bps (  )</span>
        <span class="hljs-keyword">int</span> videoFramePerSecond = <span class="hljs-number">20</span>; <span class="hljs-comment">// FPS</span>
        <span class="hljs-keyword">int</span> iframeInterval = <span class="hljs-number">3</span>; <span class="hljs-comment">// I-Frame   </span><font></font>
<font></font>
        MediaFormat format = MediaFormat.createVideoFormat(<span class="hljs-string">"video/avc"</span>, width, height);<font></font>
        format.setInteger(MediaFormat.KEY_COLOR_FORMAT, colorFormat);<font></font>
        format.setInteger(MediaFormat.KEY_BIT_RATE, videoBitrate);<font></font>
        format.setInteger(MediaFormat.KEY_FRAME_RATE, videoFramePerSecond);<font></font>
        format.setInteger(MediaFormat.KEY_I_FRAME_INTERVAL, iframeInterval);<font></font>
<font></font>
<font></font>
        mCodec.configure(format, <span class="hljs-keyword">null</span>, <span class="hljs-keyword">null</span>, MediaCodec.CONFIGURE_FLAG_ENCODE); <span class="hljs-comment">//    </span>
        mEncoderSurface = mCodec.createInputSurface(); <span class="hljs-comment">//  Surface </span><font></font>
<font></font>
        mCodec.setCallback(<span class="hljs-keyword">new</span> EncoderCallback());<font></font>
        mCodec.start(); <span class="hljs-comment">//  </span>
        Log.i(LOG_TAG, <span class="hljs-string">" "</span>);<font></font>
<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EncoderCallback</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">MediaCodec</span>.<span class="hljs-title">Callback</span> </span>{<font></font>
<font></font>
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onInputBufferAvailable</span><span class="hljs-params">(MediaCodec codec, <span class="hljs-keyword">int</span> index)</span> </span>{<font></font>
<font></font>
        }<font></font>
<font></font>
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onOutputBufferAvailable</span><span class="hljs-params">(MediaCodec codec, <span class="hljs-keyword">int</span> index, MediaCodec.BufferInfo info)</span> </span>{<font></font>
<font></font>
<font></font>
            outPutByteBuffer = mCodec.getOutputBuffer(index);<font></font>
            <span class="hljs-keyword">byte</span>[] outDate = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[info.size];<font></font>
            outPutByteBuffer.get(outDate);<font></font>
<font></font>
<font></font>
            <span class="hljs-keyword">try</span> {<font></font>
                Log.i(LOG_TAG, <span class="hljs-string">" outDate.length : "</span> + outDate.length);<font></font>
                outputStream.write(outDate, <span class="hljs-number">0</span>, outDate.length);<span class="hljs-comment">//    </span>
            } <span class="hljs-keyword">catch</span> (IOException e) {
                <span class="hljs-comment">// TODO Auto-generated catch block</span><font></font>
                e.printStackTrace();<font></font>
            }<font></font>
<font></font>
            mCodec.releaseOutputBuffer(index, <span class="hljs-keyword">false</span>);<font></font>
<font></font>
<font></font>
        }<font></font>
<font></font>
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onError</span><span class="hljs-params">(MediaCodec codec, MediaCodec.CodecException e)</span> </span>{<font></font>
            Log.i(LOG_TAG, <span class="hljs-string">"Error: "</span> + e);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onOutputFormatChanged</span><span class="hljs-params">(MediaCodec codec, MediaFormat format)</span> </span>{<font></font>
            Log.i(LOG_TAG, <span class="hljs-string">"encoder output format changed: "</span> + format);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onPause</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">if</span> (myCameras[CAMERA1].isOpen()) {<font></font>
            myCameras[CAMERA1].closeCamera();<font></font>
        }<font></font>
<font></font>
        stopBackgroundThread();<font></font>
        <span class="hljs-keyword">super</span>.onPause();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onResume</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">super</span>.onResume();<font></font>
        startBackgroundThread();<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、マニフェストの権限についても忘れないでください。</font></font><br>
<br>
<pre><code class="java hljs"> &lt;uses-permission android:name=<span class="hljs-string">"android.permission.CAMERA"</span> /&gt;<font></font>
 &lt;uses-permission android:name=<span class="hljs-string">"android.permission.INTERNET"</span>/&gt;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、Media Codecが機能していることを確認しました。</font><font style="vertical-align: inherit;">しかし、それを使用してビデオをファイルに書き込むことは、どういうわけか無気力です。</font><font style="vertical-align: inherit;">メディアレコーダーはこのタスクをより適切に処理でき、サウンドを追加します。</font><font style="vertical-align: inherit;">したがって、ファイル部分を再度破棄し、udpプロトコルを使用してビデオをネットワークにストリーミングするためのコードブロックを追加します。</font><font style="vertical-align: inherit;">とてもシンプルです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、UDPサーバーを初期化します。</font></font><br>
<br>
<pre><code class="java hljs">  DatagramSocket udpSocket;<font></font>
    String ip_address = <span class="hljs-string">"192.168.1.84"</span>; <span class="hljs-comment">//     </span><font></font>
    InetAddress address; <font></font>
    <span class="hljs-keyword">int</span> port = <span class="hljs-number">40002</span>;  <span class="hljs-comment">// ,     </span><font></font>
<font></font>
……..<font></font>
<font></font>
  <font></font>
<font></font>
                <span class="hljs-keyword">try</span> {<font></font>
                    udpSocket = <span class="hljs-keyword">new</span> DatagramSocket();<font></font>
<font></font>
                    Log.i(LOG_TAG, <span class="hljs-string">"   udp "</span>);<font></font>
<font></font>
                } <span class="hljs-keyword">catch</span> (<font></font>
                        SocketException e) {<font></font>
                    Log.i(LOG_TAG, <span class="hljs-string">"   udp "</span>);<font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">try</span> {<font></font>
                    address = InetAddress.getByName(ip_address);<font></font>
                    Log.i(LOG_TAG, <span class="hljs-string">"   "</span>);<font></font>
                } <span class="hljs-keyword">catch</span> (Exception e) {<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、ファイルのストリームにレディネスデータを送信した同じコールバックで、データグラムの形式でデータをホームネットワークに送信します（みんなにそれが欲しいと思いますか？）</font></font><br>
<br>
<pre><code class="java hljs">  <span class="hljs-keyword">try</span> {<font></font>
                DatagramPacket packet = <span class="hljs-keyword">new</span> DatagramPacket(outDate, outDate.length, address, port);<font></font>
                udpSocket.send(packet);<font></font>
            } <span class="hljs-keyword">catch</span> (IOException e) {<font></font>
                Log.i(LOG_TAG, <span class="hljs-string">"   UDP "</span>);<font></font>
            }<font></font>
<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それだけですか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
思われるかもしれませんが、違います。</font><font style="vertical-align: inherit;">アプリケーションは起動時に明るくなります。</font><font style="vertical-align: inherit;">ご覧のとおり、システムは、メインストリームであらゆる種類のデータグラムパケットを送信することを好みません。</font><font style="vertical-align: inherit;">しかし、パニックの理由はありません。</font><font style="vertical-align: inherit;">まず、メインスレッドにいるにもかかわらず、非同期的に、つまりコールバックをトリガーします。</font><font style="vertical-align: inherit;">次に、udpパケットの送信は同じ非同期プロセスです。</font><font style="vertical-align: inherit;">パケットを送信するのは良いことだとオペレーティングシステムに伝えるだけですが、この件では完全にパケットに依存します。</font><font style="vertical-align: inherit;">したがって、Androidが反抗しないように、プログラムの最初に次の2行を追加します。</font></font><br>
<br>
<pre><code class="java hljs"> StrictMode.ThreadPolicy policy = <span class="hljs-keyword">new</span> StrictMode.ThreadPolicy.Builder().permitAll().build();<font></font>
        StrictMode.setThreadPolicy(policy);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般的に、次の小さな</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エレガントな</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デモプログラム</font><font style="vertical-align: inherit;">が作成され</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">package</span> com.example.basicmediacodec;<font></font>
<font></font>
<font></font>
<span class="hljs-keyword">import</span> androidx.annotation.RequiresApi;
<span class="hljs-keyword">import</span> androidx.appcompat.app.AppCompatActivity;
<span class="hljs-keyword">import</span> androidx.core.content.ContextCompat;<font></font>
<font></font>
<span class="hljs-keyword">import</span> android.Manifest;
<span class="hljs-keyword">import</span> android.content.Context;
<span class="hljs-keyword">import</span> android.content.pm.ActivityInfo;
<span class="hljs-keyword">import</span> android.content.pm.PackageManager;<font></font>
<font></font>
<span class="hljs-keyword">import</span> android.graphics.SurfaceTexture;
<span class="hljs-keyword">import</span> android.hardware.camera2.CameraAccessException;
<span class="hljs-keyword">import</span> android.hardware.camera2.CameraCaptureSession;
<span class="hljs-keyword">import</span> android.hardware.camera2.CameraDevice;
<span class="hljs-keyword">import</span> android.hardware.camera2.CameraManager;
<span class="hljs-keyword">import</span> android.hardware.camera2.CaptureRequest;<font></font>
<font></font>
<font></font>
<span class="hljs-keyword">import</span> android.media.MediaCodec;
<span class="hljs-keyword">import</span> android.media.MediaCodecInfo;
<span class="hljs-keyword">import</span> android.media.MediaFormat;
<span class="hljs-keyword">import</span> android.os.Build;
<span class="hljs-keyword">import</span> android.os.Bundle;<font></font>
<font></font>
<font></font>
<span class="hljs-keyword">import</span> android.os.Handler;
<span class="hljs-keyword">import</span> android.os.HandlerThread;
<span class="hljs-keyword">import</span> android.os.StrictMode;
<span class="hljs-keyword">import</span> android.util.Log;
<span class="hljs-keyword">import</span> android.view.Surface;
<span class="hljs-keyword">import</span> android.view.TextureView;
<span class="hljs-keyword">import</span> android.view.View;
<span class="hljs-keyword">import</span> android.widget.Button;
<span class="hljs-keyword">import</span> android.widget.Toast;<font></font>
<font></font>
<font></font>
<span class="hljs-keyword">import</span> java.io.BufferedOutputStream;<font></font>
<font></font>
<font></font>
<span class="hljs-keyword">import</span> java.io.IOException;
<span class="hljs-keyword">import</span> java.net.DatagramPacket;
<span class="hljs-keyword">import</span> java.net.DatagramSocket;
<span class="hljs-keyword">import</span> java.net.InetAddress;
<span class="hljs-keyword">import</span> java.net.SocketException;
<span class="hljs-keyword">import</span> java.nio.ByteBuffer;
<span class="hljs-keyword">import</span> java.util.Arrays;<font></font>
<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AppCompatActivity</span> </span>{<font></font>
<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String LOG_TAG = <span class="hljs-string">"myLogs"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Surface surface = <span class="hljs-keyword">null</span>;<font></font>
<font></font>
    CameraService[] myCameras = <span class="hljs-keyword">null</span>;<font></font>
<font></font>
    <span class="hljs-keyword">private</span> CameraManager mCameraManager = <span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> CAMERA1 = <span class="hljs-number">0</span>;<font></font>
<font></font>
    <span class="hljs-keyword">private</span> Button mButtonOpenCamera1 = <span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">private</span> Button mButtonStreamVideo = <span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">private</span> Button mButtonTStopStreamVideo = <span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> TextureView mImageView = <span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">private</span> HandlerThread mBackgroundThread;
    <span class="hljs-keyword">private</span> Handler mBackgroundHandler = <span class="hljs-keyword">null</span>;<font></font>
<font></font>
    <span class="hljs-keyword">private</span> MediaCodec mCodec = <span class="hljs-keyword">null</span>; <span class="hljs-comment">// </span>
    Surface mEncoderSurface; <span class="hljs-comment">// Surface     </span><font></font>
    BufferedOutputStream outputStream;<font></font>
    ByteBuffer outPutByteBuffer;<font></font>
    DatagramSocket udpSocket;<font></font>
    String ip_address = <span class="hljs-string">"192.168.1.84"</span>;<font></font>
    InetAddress address;<font></font>
    <span class="hljs-keyword">int</span> port = <span class="hljs-number">40002</span>;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">startBackgroundThread</span><span class="hljs-params">()</span> </span>{<font></font>
        mBackgroundThread = <span class="hljs-keyword">new</span> HandlerThread(<span class="hljs-string">"CameraBackground"</span>);<font></font>
        mBackgroundThread.start();<font></font>
        mBackgroundHandler = <span class="hljs-keyword">new</span> Handler(mBackgroundThread.getLooper());<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">stopBackgroundThread</span><span class="hljs-params">()</span> </span>{<font></font>
        mBackgroundThread.quitSafely();<font></font>
        <span class="hljs-keyword">try</span> {<font></font>
            mBackgroundThread.join();<font></font>
            mBackgroundThread = <span class="hljs-keyword">null</span>;<font></font>
            mBackgroundHandler = <span class="hljs-keyword">null</span>;<font></font>
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {<font></font>
            e.printStackTrace();<font></font>
        }<font></font>
    }<font></font>
<font></font>
<font></font>
    <span class="hljs-meta">@RequiresApi(api = Build.VERSION_CODES.M)</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> </span>{<font></font>
<font></font>
<font></font>
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState);<font></font>
<font></font>
        StrictMode.ThreadPolicy policy = <span class="hljs-keyword">new</span> StrictMode.ThreadPolicy.Builder().permitAll().build();<font></font>
        StrictMode.setThreadPolicy(policy);<font></font>
        setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);<font></font>
<font></font>
        setContentView(R.layout.activity_main);<font></font>
<font></font>
<font></font>
        Log.d(LOG_TAG, <span class="hljs-string">" "</span>);
        <span class="hljs-keyword">if</span> (checkSelfPermission(Manifest.permission.CAMERA) != PackageManager.PERMISSION_GRANTED<font></font>
                ||<font></font>
                (ContextCompat.checkSelfPermission(MainActivity.<span class="hljs-keyword">this</span>, Manifest.permission.WRITE_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED)<font></font>
        ) {<font></font>
            requestPermissions(<span class="hljs-keyword">new</span> String[]{Manifest.permission.CAMERA, Manifest.permission.WRITE_EXTERNAL_STORAGE}, <span class="hljs-number">1</span>);<font></font>
        }<font></font>
<font></font>
        mButtonOpenCamera1 = findViewById(R.id.button1);<font></font>
        mButtonStreamVideo = findViewById(R.id.button2);<font></font>
        mButtonTStopStreamVideo = findViewById(R.id.button3);<font></font>
        mImageView = findViewById(R.id.textureView);<font></font>
<font></font>
        mButtonOpenCamera1.setOnClickListener(<span class="hljs-keyword">new</span> View.OnClickListener() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onClick</span><span class="hljs-params">(View v)</span> </span>{<font></font>
<font></font>
          <font></font>
                setUpMediaCodec();<span class="hljs-comment">//   </span><font></font>
<font></font>
                <span class="hljs-keyword">if</span> (myCameras[CAMERA1] != <span class="hljs-keyword">null</span>) {<span class="hljs-comment">//  </span>
                    <span class="hljs-keyword">if</span> (!myCameras[CAMERA1].isOpen()) myCameras[CAMERA1].openCamera();<font></font>
                }<font></font>
            }<font></font>
        });<font></font>
<font></font>
        mButtonStreamVideo.setOnClickListener(<span class="hljs-keyword">new</span> View.OnClickListener() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onClick</span><span class="hljs-params">(View v)</span> </span>{<font></font>
<font></font>
                {<font></font>
                      <span class="hljs-comment">//    </span><font></font>
<font></font>
                }<font></font>
               }<font></font>
        });<font></font>
<font></font>
<font></font>
        mButtonTStopStreamVideo.setOnClickListener(<span class="hljs-keyword">new</span> View.OnClickListener() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onClick</span><span class="hljs-params">(View v)</span> </span>{<font></font>
<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (mCodec != <span class="hljs-keyword">null</span>) {<font></font>
<font></font>
                    Toast.makeText(MainActivity.<span class="hljs-keyword">this</span>, <span class="hljs-string">"  "</span>, Toast.LENGTH_SHORT).show();<font></font>
                    myCameras[CAMERA1].stopStreamingVideo();<font></font>
                }<font></font>
            }<font></font>
        });<font></font>
<font></font>
      <span class="hljs-keyword">try</span> {<font></font>
                    udpSocket = <span class="hljs-keyword">new</span> DatagramSocket();<font></font>
<font></font>
                    Log.i(LOG_TAG, <span class="hljs-string">"   udp "</span>);<font></font>
<font></font>
                } <span class="hljs-keyword">catch</span> (<font></font>
                        SocketException e) {<font></font>
                    Log.i(LOG_TAG, <span class="hljs-string">"   udp "</span>);<font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">try</span> {<font></font>
                    address = InetAddress.getByName(ip_address);<font></font>
                    Log.i(LOG_TAG, <span class="hljs-string">"   "</span>);<font></font>
                } <span class="hljs-keyword">catch</span> (Exception e) {<font></font>
<font></font>
<font></font>
                }<font></font>
<font></font>
<font></font>
<font></font>
        mCameraManager = (CameraManager) getSystemService(Context.CAMERA_SERVICE);<font></font>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">//     </span><font></font>
<font></font>
            myCameras = <span class="hljs-keyword">new</span> CameraService[mCameraManager.getCameraIdList().length];<font></font>
<font></font>
            <span class="hljs-keyword">for</span> (String cameraID : mCameraManager.getCameraIdList()) {<font></font>
                Log.i(LOG_TAG, <span class="hljs-string">"cameraID: "</span> + cameraID);
                <span class="hljs-keyword">int</span> id = Integer.parseInt(cameraID);
                <span class="hljs-comment">//    </span>
                myCameras[id] = <span class="hljs-keyword">new</span> CameraService(mCameraManager, cameraID);<font></font>
<font></font>
            }<font></font>
        } <span class="hljs-keyword">catch</span> (CameraAccessException e) {<font></font>
            Log.e(LOG_TAG, e.getMessage());<font></font>
            e.printStackTrace();<font></font>
        }<font></font>
<font></font>
    }<font></font>
<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CameraService</span> </span>{<font></font>
<font></font>
<font></font>
        <span class="hljs-keyword">private</span> String mCameraID;
        <span class="hljs-keyword">private</span> CameraDevice mCameraDevice = <span class="hljs-keyword">null</span>;
        <span class="hljs-keyword">private</span> CameraCaptureSession mSession;
        <span class="hljs-keyword">private</span> CaptureRequest.Builder mPreviewBuilder;<font></font>
<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CameraService</span><span class="hljs-params">(CameraManager cameraManager, String cameraID)</span> </span>{<font></font>
<font></font>
            mCameraManager = cameraManager;<font></font>
            mCameraID = cameraID;<font></font>
<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">private</span> CameraDevice.StateCallback mCameraCallback = <span class="hljs-keyword">new</span> CameraDevice.StateCallback() {<font></font>
<font></font>
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onOpened</span><span class="hljs-params">(CameraDevice camera)</span> </span>{<font></font>
                mCameraDevice = camera;<font></font>
                Log.i(LOG_TAG, <span class="hljs-string">"Open camera  with id:"</span> + mCameraDevice.getId());<font></font>
<font></font>
                startCameraPreviewSession();<font></font>
            }<font></font>
<font></font>
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onDisconnected</span><span class="hljs-params">(CameraDevice camera)</span> </span>{<font></font>
                mCameraDevice.close();<font></font>
<font></font>
                Log.i(LOG_TAG, <span class="hljs-string">"disconnect camera  with id:"</span> + mCameraDevice.getId());<font></font>
                mCameraDevice = <span class="hljs-keyword">null</span>;<font></font>
            }<font></font>
<font></font>
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onError</span><span class="hljs-params">(CameraDevice camera, <span class="hljs-keyword">int</span> error)</span> </span>{<font></font>
                Log.i(LOG_TAG, <span class="hljs-string">"error! camera id:"</span> + camera.getId() + <span class="hljs-string">" error:"</span> + error);<font></font>
            }<font></font>
        };<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">startCameraPreviewSession</span><span class="hljs-params">()</span> </span>{<font></font>
            SurfaceTexture texture = mImageView.getSurfaceTexture();<font></font>
            texture.setDefaultBufferSize(<span class="hljs-number">320</span>, <span class="hljs-number">240</span>);<font></font>
            surface = <span class="hljs-keyword">new</span> Surface(texture);<font></font>
<font></font>
<font></font>
            <span class="hljs-keyword">try</span> {<font></font>
<font></font>
                mPreviewBuilder = mCameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_PREVIEW);<font></font>
                mPreviewBuilder.addTarget(surface);<font></font>
                mPreviewBuilder.addTarget(mEncoderSurface);<font></font>
<font></font>
<font></font>
                mCameraDevice.createCaptureSession(Arrays.asList(surface, mEncoderSurface),<font></font>
<font></font>
                        <span class="hljs-keyword">new</span> CameraCaptureSession.StateCallback() {<font></font>
<font></font>
                            <span class="hljs-meta">@Override</span>
                            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onConfigured</span><span class="hljs-params">(CameraCaptureSession session)</span> </span>{<font></font>
                                mSession = session;<font></font>
<font></font>
                                <span class="hljs-keyword">try</span> {<font></font>
                                    mSession.setRepeatingRequest(mPreviewBuilder.build(), <span class="hljs-keyword">null</span>, mBackgroundHandler);<font></font>
                                } <span class="hljs-keyword">catch</span> (CameraAccessException e) {<font></font>
                                    e.printStackTrace();<font></font>
                                }<font></font>
                            }<font></font>
<font></font>
                            <span class="hljs-meta">@Override</span>
                            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onConfigureFailed</span><span class="hljs-params">(CameraCaptureSession session)</span> </span>{<font></font>
                            }<font></font>
                        }, mBackgroundHandler);<font></font>
            } <span class="hljs-keyword">catch</span> (CameraAccessException e) {<font></font>
                e.printStackTrace();<font></font>
            }<font></font>
<font></font>
        }<font></font>
<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isOpen</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">if</span> (mCameraDevice == <span class="hljs-keyword">null</span>) {
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<font></font>
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<font></font>
            }<font></font>
        }<font></font>
<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">openCamera</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">try</span> {<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (checkSelfPermission(Manifest.permission.CAMERA) == PackageManager.PERMISSION_GRANTED) {<font></font>
<font></font>
                    mCameraManager.openCamera(mCameraID, mCameraCallback, mBackgroundHandler);<font></font>
<font></font>
                }<font></font>
<font></font>
            } <span class="hljs-keyword">catch</span> (CameraAccessException e) {<font></font>
                Log.i(LOG_TAG, e.getMessage());<font></font>
<font></font>
            }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">closeCamera</span><span class="hljs-params">()</span> </span>{<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (mCameraDevice != <span class="hljs-keyword">null</span>) {<font></font>
                mCameraDevice.close();<font></font>
                mCameraDevice = <span class="hljs-keyword">null</span>;<font></font>
            }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">stopStreamingVideo</span><span class="hljs-params">()</span> </span>{<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (mCameraDevice != <span class="hljs-keyword">null</span> &amp; mCodec != <span class="hljs-keyword">null</span>) {<font></font>
<font></font>
                <span class="hljs-keyword">try</span> {<font></font>
                    mSession.stopRepeating();<font></font>
                    mSession.abortCaptures();<font></font>
                } <span class="hljs-keyword">catch</span> (CameraAccessException e) {<font></font>
                    e.printStackTrace();<font></font>
                }<font></font>
<font></font>
                mCodec.stop();<font></font>
                mCodec.release();<font></font>
                mEncoderSurface.release();<font></font>
                closeCamera();<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUpMediaCodec</span><span class="hljs-params">()</span> </span>{<font></font>
<font></font>
<font></font>
<font></font>
<font></font>
        <span class="hljs-keyword">try</span> {<font></font>
            mCodec = MediaCodec.createEncoderByType(<span class="hljs-string">"video/avc"</span>); <span class="hljs-comment">// H264 </span><font></font>
<font></font>
        } <span class="hljs-keyword">catch</span> (Exception e) {<font></font>
            Log.i(LOG_TAG, <span class="hljs-string">"  "</span>);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">int</span> width = <span class="hljs-number">320</span>; <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">int</span> height = <span class="hljs-number">240</span>; <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">int</span> colorFormat = MediaCodecInfo.CodecCapabilities.COLOR_FormatSurface; <span class="hljs-comment">//   </span>
        <span class="hljs-keyword">int</span> videoBitrate = <span class="hljs-number">500000</span>; <span class="hljs-comment">//    bps (  )</span>
        <span class="hljs-keyword">int</span> videoFramePerSecond = <span class="hljs-number">20</span>; <span class="hljs-comment">// FPS</span>
        <span class="hljs-keyword">int</span> iframeInterval = <span class="hljs-number">3</span>; <span class="hljs-comment">// I-Frame   </span><font></font>
<font></font>
        MediaFormat format = MediaFormat.createVideoFormat(<span class="hljs-string">"video/avc"</span>, width, height);<font></font>
        format.setInteger(MediaFormat.KEY_COLOR_FORMAT, colorFormat);<font></font>
        format.setInteger(MediaFormat.KEY_BIT_RATE, videoBitrate);<font></font>
        format.setInteger(MediaFormat.KEY_FRAME_RATE, videoFramePerSecond);<font></font>
        format.setInteger(MediaFormat.KEY_I_FRAME_INTERVAL, iframeInterval);<font></font>
<font></font>
<font></font>
        mCodec.configure(format, <span class="hljs-keyword">null</span>, <span class="hljs-keyword">null</span>, MediaCodec.CONFIGURE_FLAG_ENCODE); <span class="hljs-comment">//    </span>
        mEncoderSurface = mCodec.createInputSurface(); <span class="hljs-comment">//  Surface </span><font></font>
<font></font>
        mCodec.setCallback(<span class="hljs-keyword">new</span> EncoderCallback());<font></font>
        mCodec.start(); <span class="hljs-comment">//  </span>
        Log.i(LOG_TAG, <span class="hljs-string">" "</span>);<font></font>
<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EncoderCallback</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">MediaCodec</span>.<span class="hljs-title">Callback</span> </span>{<font></font>
<font></font>
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onInputBufferAvailable</span><span class="hljs-params">(MediaCodec codec, <span class="hljs-keyword">int</span> index)</span> </span>{<font></font>
<font></font>
        }<font></font>
<font></font>
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onOutputBufferAvailable</span><span class="hljs-params">(MediaCodec codec, <span class="hljs-keyword">int</span> index, MediaCodec.BufferInfo info)</span> </span>{<font></font>
<font></font>
<font></font>
            outPutByteBuffer = mCodec.getOutputBuffer(index);<font></font>
            <span class="hljs-keyword">byte</span>[] outDate = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[info.size];<font></font>
            outPutByteBuffer.get(outDate);<font></font>
<font></font>
            <span class="hljs-keyword">try</span> {<font></font>
                DatagramPacket packet = <span class="hljs-keyword">new</span> DatagramPacket(outDate, outDate.length, address, port);<font></font>
                udpSocket.send(packet);<font></font>
            } <span class="hljs-keyword">catch</span> (IOException e) {<font></font>
                Log.i(LOG_TAG, <span class="hljs-string">"   UDP "</span>);<font></font>
            }<font></font>
<font></font>
<font></font>
            mCodec.releaseOutputBuffer(index, <span class="hljs-keyword">false</span>);<font></font>
<font></font>
<font></font>
        }<font></font>
<font></font>
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onError</span><span class="hljs-params">(MediaCodec codec, MediaCodec.CodecException e)</span> </span>{<font></font>
            Log.i(LOG_TAG, <span class="hljs-string">"Error: "</span> + e);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onOutputFormatChanged</span><span class="hljs-params">(MediaCodec codec, MediaFormat format)</span> </span>{<font></font>
            Log.i(LOG_TAG, <span class="hljs-string">"encoder output format changed: "</span> + format);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onPause</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">if</span> (myCameras[CAMERA1].isOpen()) {<font></font>
            myCameras[CAMERA1].closeCamera();<font></font>
        }<font></font>
<font></font>
        stopBackgroundThread();<font></font>
        <span class="hljs-keyword">super</span>.onPause();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onResume</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">super</span>.onResume();<font></font>
        startBackgroundThread();<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他の人のやり方はわかりませんが、私のRed Note 7では、正しいアドレスでダウンロードされたキロバイト数を確認することもできます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/9x/3q/gz/9x3qgzrctdcevzw5ym5zi6imgq8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、十分なネットワーク帯域幅でそのようなudpソケットを破壊することもできます。</font><font style="vertical-align: inherit;">主なことは、アドレスがどこにあるかということです。</font><font style="vertical-align: inherit;">放送されます。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次に、コンピュータで目的のアドレスを探しましょう</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのコンピュータープログラムが、追加情報なしで単一のudpチャネルを介してH264ビデオストリームを吸収および消化できるわけではないことを言わなければなりません。</font><font style="vertical-align: inherit;">しかし、一部はそうかもしれません。</font><font style="vertical-align: inherit;">これは、たとえば、非常によく知られている</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VLC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メディア</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">プレーヤー</font></a><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">これはとてもクールなことなので、その機能を説明し始めると、その記事から1冊の本を手に入れることができます。</font><font style="vertical-align: inherit;">確かにあなたはそれを持っています。</font><font style="vertical-align: inherit;">そうでない場合は、それを着てください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、そのためのコマンドの説明から判断すると、udpパケットはこのプレーヤーをダイジェストできます。</font></font><br>
<br>
<pre><code class="java hljs">URL syntax:<font></font>
<font></font>
  file:<span class="hljs-comment">///path/file              Plain media file</span>
  http:<span class="hljs-comment">//host[:port]/file        HTTP URL</span>
  ftp:<span class="hljs-comment">//host[:port]/file         FTP URL</span>
  mms:<span class="hljs-comment">//host[:port]/file         MMS URL</span>
  screen:<span class="hljs-comment">//                      Screen capture</span>
  dvd:<span class="hljs-comment">//[device]                 DVD device</span>
  vcd:<span class="hljs-comment">//[device]                 VCD device</span>
  cdda:<span class="hljs-comment">//[device]                Audio CD device</span>
  udp:<span class="hljs-comment">//[[&lt;source address&gt;]@[&lt;bind address&gt;][:&lt;bind port&gt;]]</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、これらすべての送信元アドレスとバインドアドレスは、理論的には必要ありません。</font><font style="vertical-align: inherit;">リスニングポートのみが必要です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7-/kw/pi/7-kwpik08ayqmgvd2rta1sqjtae.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、もちろん、このポートが待機することを許可することを忘れてはなりません（Malvar）</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ix/9r/sj/ix9rsjovph-xzqgmosv_kgu-in4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
が、Windowsではリソースモニターから印刷画面を作成できないことをご存知ですか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
または、ファイアウォールを完全に無効にすることもできます（お勧めしません）</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、これらの問題を克服して、アドレスを指定してVLCプレーヤーを起動し、空白の画面をお楽しみください。</font><font style="vertical-align: inherit;">ビデオなし。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">どうして？ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、このように。</font><font style="vertical-align: inherit;">VLC 3.08 Vetinariの最新バージョンをお使いですか？</font><font style="vertical-align: inherit;">それだけです。このバージョンのudpでは、非推奨であると宣言されており、さらにはめちゃくちゃです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、プレーヤーの開発者の論理は明確です。</font><font style="vertical-align: inherit;">最近、ベアUDPチャネルを使用する必要がある人はほとんどいません：</font></font><br>
<br>
<ul>
<li>      .                 ,    .       .</li>
<li>   </li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、当然のことながら、当然、RTPなどの高レベルのプロトコルを使用します。つまり、指先で-（とにかく）udpを使用するサーバーを作成すると同時に、ビデオをストリーミングするクライアントと制御情報を交換します。その帯域幅とは何か、データのキャッシュを増減する必要があるか、どの画像の詳細が現在最適であるかなど。繰り返しになりますが、音も時々必要です。そして、彼はビデオとの同期を必要としています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Odnoklassnikiの人たちは</font><font style="vertical-align: inherit;">、ストリーミング用の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロトコル</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">提出</font></a><font style="vertical-align: inherit;">する必要さえありました</font><font style="vertical-align: inherit;">。もちろん、彼らの仕事ははるかに重要です。猫と一緒に世界中の何千万人もの主婦にビデオを送ることです。そこでは1つのudpチャネルを管理しません。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、AndroidでRTPサーバーを作成するのはちょっと悲しいことです。おそらく、既製で無料のものも見つけることができますが、今のところエンティティを複雑にしないようにしましょう。 udpストリーミングがまだ機能するバージョンのVLCプレーヤーを使用してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、ここから</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VLC 2.2.6 Umbrella</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
を</font><font style="vertical-align: inherit;">ダウンロードします</font><font style="vertical-align: inherit;">。必要に応じて、古い（つまり、新しいVLC）の代わりに、またはその横にインストールします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
再び起動して、空白の画面が表示されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはすべて、H264コーデックの使用を設定しなかったためです。したがって、VLCは、ファイルを処理している場合、コーデックを自動的に選択できます（最初の設定では、自動選択が指定されていました）。しかし、それらは単一のチャネルを介してバイトストリームをスローし、VLCがサポートする数十のコーデックがあります。どの方法を適用すればよいのでしょうか。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、コーデックを強制的にインストールします。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jq/f5/er/jqf5ercz20oa2hxzlbeqmokqgbs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして今、私たちは「ライブ」ビデオの放送を楽しんでいます。</font><font style="vertical-align: inherit;">唯一のことは、それが何らかの理由で横になっていることですが、これはビデオプレーヤーの設定ですでに簡単に修正されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、あなたはこのキーでコマンドラインからプレーヤーを開始することができます：</font></font><br>
<br>
<pre><code class="java hljs">C:\Program Files\VideoLAN\VLC\vlc udp:<span class="hljs-comment">//@:40002   --demux h264 --video-filter=transform --transform-type=90</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、それはそれ自身をデコードして向きを変えます。</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/IbN9eh1uyv4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ストリーミングは機能します。</font><font style="vertical-align: inherit;">ロボットを制御するために、コンピューター上のアプリケーションのJAVAウィンドウに統合するだけです。</font><font style="vertical-align: inherit;">これについては、最後の部分ですぐに対処します。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja473026/index.html">Om-yum-yumとデータ検証</a></li>
<li><a href="../ja473028/index.html">ロシアではヨーロッパから放射性廃棄物を輸入し始めましたか？並べ替え</a></li>
<li><a href="../ja473030/index.html">潜在的な「悪質な」ボットを計算し、IPでブロックします</a></li>
<li><a href="../ja473032/index.html">「希望は悪い戦略です。」2月3〜5日にモスクワでSREが集中</a></li>
<li><a href="../ja473034/index.html">ティムリッドの座り方</a></li>
<li><a href="../ja473038/index.html">8ビットのモールス信号</a></li>
<li><a href="../ja473042/index.html">Djangoの長所と短所</a></li>
<li><a href="../ja473044/index.html">App Storeでアプリケーションの効果的なスクリーンショットを作成する方法</a></li>
<li><a href="../ja473046/index.html">波、風、意志力：デルの頑丈なタブレットがロシア人が国際的なレガッタを獲得するのをどのように支援するか</a></li>
<li><a href="../ja473050/index.html">AMDは、Intelに新しいCPUモデルだけでなく古いCPUモデルの価格も引き下げるように強いています。これは別の価格戦争の始まりです</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>