<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏾‍🍳 👩‍❤️‍👩 🧑🏿‍🤝‍🧑🏾 Organisieren von Bereitstellungen in vielen k8s-Umgebungen mithilfe der Helmdatei ↪️ 🖐🏼 🍚</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Helmdatei - ein Wrapper für das Ruder , mit dem Sie viele Helmfreigaben an einem Ort beschreiben, ihre Diagramme für mehrere Umgebungen parametrisiere...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Organisieren von Bereitstellungen in vielen k8s-Umgebungen mithilfe der Helmdatei</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/491108/"><p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Helmdatei</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ein Wrapper für das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ruder</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mit dem Sie viele Helmfreigaben an einem Ort beschreiben, ihre Diagramme für mehrere Umgebungen parametrisieren und auch die Reihenfolge ihrer Bereitstellung festlegen können.</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie können über helmfile selbst und Beispiele für seine Verwendung in der lesen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">readme</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Best Practices Guide</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir werden uns mit nicht offensichtlichen Möglichkeiten vertraut machen, Veröffentlichungen in der Helmdatei zu beschreiben</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Angenommen, wir haben eine Reihe von Helmdiagrammen (z. B. Postgres und eine Art Backend-Anwendung) und mehrere Umgebungen (mehrere Kubernetes-Cluster, mehrere Namespace'ov oder mehrere von beiden). </font><font style="vertical-align: inherit;">Wir nehmen Helmdatei, lesen die Dokumentation und beginnen, unsere Umgebungen und Releases zu beschreiben:</font></font></p><br>
<pre><code class="plaintext hljs">    .<font></font>
    ├── envs<font></font>
    │&nbsp;&nbsp; ├── devel<font></font>
    │&nbsp;&nbsp; │&nbsp;&nbsp; └── values<font></font>
    │&nbsp;&nbsp; │&nbsp;&nbsp;     ├── backend.yaml<font></font>
    │&nbsp;&nbsp; │&nbsp;&nbsp;     └── postgres.yaml<font></font>
    │&nbsp;&nbsp; └── production<font></font>
    │&nbsp;&nbsp;     └── values<font></font>
    │&nbsp;&nbsp;         ├── backend.yaml<font></font>
    │&nbsp;&nbsp;         └── postgres.yaml<font></font>
    └── helmfile.yaml</code></pre><a name="habracut"></a><br>
<h4 id="helmfileyaml"><strong><code>helmfile.yaml</code></strong></h4><br>
<pre><code class="plaintext hljs">environments:<font></font>
  devel:<font></font>
  production:<font></font>
<font></font>
releases:<font></font>
  - name: postgres<font></font>
    labels:<font></font>
      app: postgres<font></font>
    wait: true<font></font>
    chart: stable/postgresql<font></font>
    version: 8.4.0<font></font>
    values:<font></font>
      - envs/{{ .Environment.Name }}/values/postgres.yaml<font></font>
  - name: backend<font></font>
    labels:<font></font>
      app: backend<font></font>
    wait: true<font></font>
    chart: private-helm-repo/backend<font></font>
    version: 1.0.5<font></font>
    needs:<font></font>
      - postgres<font></font>
    values:<font></font>
      - envs/{{ .Environment.Name }}/values/backend.yaml</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir haben zwei Umgebungen: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entwicklung</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Produktion</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - jede hat ihre eigenen Werte für Helm-Release-Charts. </font><font style="vertical-align: inherit;">Wir werden sie wie folgt bereitstellen:</font></font></p><br>
<pre><code class="plaintext hljs">helmfile -n &lt;namespace&gt; -e &lt;env&gt; apply</code></pre><br>
<h2 id="raznye-versii-helm-chartov-v-raznyh-okruzheniyah"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verschiedene Versionen von Helmkarten in verschiedenen Umgebungen</font></font></h2><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was ist, wenn wir verschiedene Versionen des Backends in verschiedenen Umgebungen einführen müssen? </font><font style="vertical-align: inherit;">Wie parametriere ich die Release-Version? </font><font style="vertical-align: inherit;">Umgebungswerte verfügbar durch</font></font><code>{{ .Values }}</code></p><br>
<h4 id="helmfileyaml-1"><strong><code>helmfile.yaml</code></strong></h4><br>
<pre><code class="diff hljs">environments:<font></font>
  devel:<font></font>
<span class="hljs-addition">+   values:</span>
<span class="hljs-addition">+   - charts:</span>
<span class="hljs-addition">+       versions:</span>
<span class="hljs-addition">+         backend: 1.1.0</span><font></font>
  production:<font></font>
<span class="hljs-addition">+   values:</span>
<span class="hljs-addition">+   - charts:</span>
<span class="hljs-addition">+       versions:</span>
<span class="hljs-addition">+         backend: 1.0.5</span><font></font>
...<font></font>
  - name: backend<font></font>
    labels:<font></font>
      app: backend<font></font>
    wait: true<font></font>
    chart: private-helm-repo/backend<font></font>
<span class="hljs-deletion">-   version: 1.0.5</span>
<span class="hljs-addition">+   version: {{ .Values.charts.versions.backend }}</span>
...</code></pre><br>
<h2 id="raznyy-nabor-prilozheniy-v-raznyh-okruzheniyah"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine andere Reihe von Anwendungen in verschiedenen Umgebungen</font></font></h2><br>
<p>,        <code>production</code>  postgres,    ,        k8s          postgres?         (labels)</p><br>
<pre><code class="plaintext hljs">helmfile -n &lt;namespace&gt; -e devel apply<font></font>
helmfile -n &lt;namespace&gt; -e production -l app=backend apply</code></pre><br>
<p> ,     ,          ,     .  ?       ,         ""   ,  </p><br>
<pre><code class="diff hljs">    .<font></font>
    ├── envs<font></font>
    │&nbsp;&nbsp; ├── devel<font></font>
    │&nbsp;&nbsp; │&nbsp;&nbsp; └── values<font></font>
    │&nbsp;&nbsp; │&nbsp;&nbsp;     ├── backend.yaml<font></font>
    │&nbsp;&nbsp; │&nbsp;&nbsp;     └── postgres.yaml<font></font>
    │&nbsp;&nbsp; └── production<font></font>
    │&nbsp;&nbsp;     └── values<font></font>
    │&nbsp;&nbsp;         ├── backend.yaml<font></font>
    │&nbsp;&nbsp;         └── postgres.yaml<font></font>
<span class="hljs-addition">+   ├── releases</span>
<span class="hljs-addition">+   │&nbsp;&nbsp; ├── backend.yaml</span>
<span class="hljs-addition">+   │&nbsp;&nbsp; └── postgres.yaml</span><font></font>
    └── helmfile.yaml<font></font>
</code></pre><br>
<h4 id="helmfileyaml-2"><strong><code>helmfile.yaml</code></strong></h4><br>
<pre><code class="diff hljs"><font></font>
  environments:<font></font>
    devel:<font></font>
      values:<font></font>
      - charts:<font></font>
          versions:<font></font>
            backend: 1.1.0<font></font>
      - apps:<font></font>
        - postgres<font></font>
        - backend<font></font>
<font></font>
    production:<font></font>
      values:<font></font>
      - charts:<font></font>
          versions:<font></font>
            backend: 1.0.5<font></font>
      - apps:<font></font>
        - backend<font></font>
<font></font>
<span class="hljs-deletion">- releases:</span>
<span class="hljs-deletion">-    - name: postgres</span>
<span class="hljs-deletion">-      labels:</span>
<span class="hljs-deletion">-        app: postgres</span>
<span class="hljs-deletion">-      wait: true</span>
<span class="hljs-deletion">-      chart: stable/postgresql</span>
<span class="hljs-deletion">-      version: 8.4.0</span>
<span class="hljs-deletion">-      values:</span>
<span class="hljs-deletion">-        - envs/{{ .Environment.Name }}/values/postgres.yaml</span>
<span class="hljs-deletion">-    - name: backend</span>
<span class="hljs-deletion">-      labels:</span>
<span class="hljs-deletion">-        app: backend</span>
<span class="hljs-deletion">-      wait: true</span>
<span class="hljs-deletion">-      chart: private-helm-repo/backend</span>
<span class="hljs-deletion">-     version: {{ .Values.charts.versions.backend }}</span>
<span class="hljs-deletion">-     needs:</span>
<span class="hljs-deletion">-       - postgres</span>
<span class="hljs-deletion">-     values:</span>
<span class="hljs-deletion">-       - envs/{{ .Environment.Name }}/values/backend.yaml</span>
<span class="hljs-addition">+ ---</span>
<span class="hljs-addition">+ bases:</span>
<span class="hljs-addition">+ {{- range .Values.apps }}</span>
<span class="hljs-addition">+   - releases/{{ . }}.yaml</span>
<span class="hljs-addition">+ {{- end }}</span></code></pre><br>
<h4 id="releasespostgresyaml"><strong><code>releases/postgres.yaml</code></strong></h4><br>
<pre><code class="plaintext hljs">releases:<font></font>
  - name: postgres<font></font>
    labels:<font></font>
      app: postgres<font></font>
    wait: true<font></font>
    chart: stable/postgresql<font></font>
    version: 8.4.0<font></font>
    values:<font></font>
      - envs/{{ .Environment.Name }}/values/postgres.yaml</code></pre><br>
<h4 id="releasesbackendyaml"><strong><code>releases/backend.yaml</code></strong></h4><br>
<pre><code class="plaintext hljs">releases:<font></font>
  - name: backend<font></font>
    labels:<font></font>
      app: backend<font></font>
    wait: true<font></font>
    chart: private-helm-repo/backend<font></font>
    version: {{ .Values.charts.versions.backend }}<font></font>
    needs:<font></font>
      - postgres<font></font>
    values:<font></font>
      - envs/{{ .Environment.Name }}/values/backend.yaml</code></pre><br>
<hr><br>
<p><strong></strong></p><br>
<p>  <code>bases:</code>    yaml  <code>---</code>,     releases (  ,  helmDefaults)   environments</p><br>
<hr><br>
<p>    postgres       production.  !</p><br>
<h2 id="pereopredelyaemye-globalnye-znacheniya-dlya-relizov">    </h2><br>
<p>, ,         helm ,        ,   , ,     <code>affinity</code>,      -   ,    .</p><br>
<p>          2   values:    ,      ,      ,        .</p><br>
<pre><code class="diff hljs">    .<font></font>
    ├── envs<font></font>
<span class="hljs-addition">+   │&nbsp;&nbsp; ├── default</span>
<span class="hljs-addition">+   │&nbsp;&nbsp; │&nbsp;&nbsp; └── values</span>
<span class="hljs-addition">+   │&nbsp;&nbsp; │&nbsp;&nbsp;     ├── backend.yaml</span>
<span class="hljs-addition">+   │&nbsp;&nbsp; │&nbsp;&nbsp;     └── postgres.yaml</span><font></font>
    │&nbsp;&nbsp; ├── devel<font></font>
    │&nbsp;&nbsp; │&nbsp;&nbsp; └── values<font></font>
    │&nbsp;&nbsp; │&nbsp;&nbsp;     ├── backend.yaml<font></font>
    │&nbsp;&nbsp; │&nbsp;&nbsp;     └── postgres.yaml<font></font>
    │&nbsp;&nbsp; └── production<font></font>
    │&nbsp;&nbsp;     └── values<font></font>
    │&nbsp;&nbsp;         ├── backend.yaml<font></font>
    │&nbsp;&nbsp;         └── postgres.yaml<font></font>
    ├── releases<font></font>
    │&nbsp;&nbsp; ├── backend.yaml<font></font>
    │&nbsp;&nbsp; └── postgres.yaml<font></font>
    └── helmfile.yaml</code></pre><br>
<h4 id="releasesbackendyaml-1"><strong><code>releases/backend.yaml</code></strong></h4><br>
<pre><code class="diff hljs">releases:<font></font>
  - name: backend<font></font>
    labels:<font></font>
      app: backend<font></font>
    wait: true<font></font>
    chart: private-helm-repo/backend<font></font>
    version: {{ .Values.charts.versions.backend }}<font></font>
    needs:<font></font>
      - postgres<font></font>
    values:<font></font>
<span class="hljs-addition">+     - envs/default/values/backend.yaml</span>
      - envs/{{ .Environment.Name }}/values/backend.yaml</code></pre><br>
<h4 id="envsdefaultvaluesbackendyaml"><strong><code>envs/default/values/backend.yaml</code></strong></h4><br>
<pre><code class="plaintext hljs">affinity:<font></font>
  podAntiAffinity:<font></font>
    preferredDuringSchedulingIgnoredDuringExecution:<font></font>
    - weight: 1<font></font>
      podAffinityTerm:<font></font>
        labelSelector:<font></font>
          matchExpressions:<font></font>
          - key: app.kubernetes.io/name<font></font>
            operator: In<font></font>
            values:<font></font>
            - backend<font></font>
        topologyKey: "kubernetes.io/hostname"</code></pre><br>
<h2 id="opredelenie-globalnyh-znacheniy-dlya-helm-chartov-vseh-relizov-na-urovne-okruzheniya">    helm      </h2><br>
<p>,        ingress —         <code>hosts:</code>,         ,                 ?      values,    ,     <code>.gotmpl</code>,  helmfile ,      .</p><br>
<pre><code class="diff hljs">    .<font></font>
    ├── envs<font></font>
    │&nbsp;&nbsp; ├── default<font></font>
    │&nbsp;&nbsp; │&nbsp;&nbsp; └── values<font></font>
<span class="hljs-deletion">-   │&nbsp;&nbsp; │&nbsp;&nbsp;     ├── backend.yaml</span>
<span class="hljs-deletion">-   │&nbsp;&nbsp; │&nbsp;&nbsp;     ├── postgres.yaml</span>
<span class="hljs-addition">+   │&nbsp;&nbsp; │&nbsp;&nbsp;     ├── backend.yaml.gotmpl</span>
<span class="hljs-addition">+   │&nbsp;&nbsp; │&nbsp;&nbsp;     └── postgres.yaml.gotmpl</span><font></font>
    │&nbsp;&nbsp; ├── devel<font></font>
    │&nbsp;&nbsp; │&nbsp;&nbsp; └── values<font></font>
    │&nbsp;&nbsp; │&nbsp;&nbsp;     ├── backend.yaml<font></font>
    │&nbsp;&nbsp; │&nbsp;&nbsp;     └── postgres.yaml<font></font>
    │&nbsp;&nbsp; └── production<font></font>
    │&nbsp;&nbsp;     └── values<font></font>
    │&nbsp;&nbsp;         ├── backend.yaml<font></font>
    │&nbsp;&nbsp;         └── postgres.yaml<font></font>
    ├── releases<font></font>
    │&nbsp;&nbsp; ├── backend.yaml<font></font>
    │&nbsp;&nbsp; └── postgres.yaml<font></font>
    └── helmfile.yaml</code></pre><br>
<h4 id="helmfileyaml-3"><strong><code>helmfile.yaml</code></strong></h4><br>
<pre><code class="diff hljs">  environments:<font></font>
    devel:<font></font>
      values:<font></font>
      - charts:<font></font>
          versions:<font></font>
            backend: 1.1.0<font></font>
      - apps:<font></font>
        - postgres<font></font>
        - backend<font></font>
<span class="hljs-addition">+     - global:</span>
<span class="hljs-addition">+         ingressDomain: k8s.devel.domain</span><font></font>
<font></font>
    production:<font></font>
      values:<font></font>
      - charts:<font></font>
          versions:<font></font>
            backend: 1.0.5<font></font>
      - apps:<font></font>
        - backend<font></font>
<span class="hljs-addition">+     - global:</span>
<span class="hljs-addition">+         ingressDomain: production.domain</span><font></font>
  ---<font></font>
  bases:<font></font>
  {{- range .Values.apps }}<font></font>
    - releases/{{ . }}.yaml<font></font>
  {{- end }}</code></pre><br>
<h4 id="envsdefaultvaluesbackendyamlgotmpl"><strong><code>envs/default/values/backend.yaml.gotmpl</code></strong></h4><br>
<pre><code class="plaintext hljs">ingress:<font></font>
  enabled: true<font></font>
  paths:<font></font>
    - /api<font></font>
  hosts:<font></font>
    - {{ .Values.global.ingressDomain }}</code></pre><br>
<h4 id="envsdefaultvaluespostgresyamlgotmpl"><strong><code>envs/default/values/postgres.yaml.gotmpl</code></strong></h4><br>
<pre><code class="plaintext hljs">ingress:<font></font>
  enabled: true<font></font>
  paths:<font></font>
    - /<font></font>
  hosts:<font></font>
    - postgres.{{ .Values.global.ingressDomain }}</code></pre><br>
<hr><br>
<p><strong></strong></p><br>
<p>,  ingress   postgres —    ,               ,      -      ingress</p><br>
<hr><br>
<h2 id="podstanovka-sekretov-secrets-iz-znacheniy-okruzheniya">  (secrets)   </h2><br>
<p>           <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">helm secrets</a> .  ,        secrets,       ,       default.yaml.gotmpl ,     ,    .  ,        ,          .</p><br>
<pre><code class="diff hljs">    .<font></font>
    ├── envs<font></font>
    │&nbsp;&nbsp; ├── default<font></font>
    │&nbsp;&nbsp; │&nbsp;&nbsp; └── values<font></font>
    │&nbsp;&nbsp; │&nbsp;&nbsp;     ├── backend.yaml<font></font>
    │&nbsp;&nbsp; │&nbsp;&nbsp;     └── postgres.yaml<font></font>
    │&nbsp;&nbsp; ├── devel<font></font>
    │&nbsp;&nbsp; │&nbsp;&nbsp; ├── values<font></font>
    │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── backend.yaml<font></font>
    │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; └── postgres.yaml<font></font>
<span class="hljs-addition">+   │&nbsp;&nbsp; │&nbsp;&nbsp; └── secrets.yaml</span><font></font>
    │&nbsp;&nbsp; └── production<font></font>
    │&nbsp;&nbsp;     ├── values<font></font>
    │&nbsp;&nbsp;     │&nbsp;&nbsp; ├── backend.yaml<font></font>
    │&nbsp;&nbsp;     │&nbsp;&nbsp; └── postgres.yaml<font></font>
<span class="hljs-addition">+   │&nbsp;&nbsp;     └── secrets.yaml</span><font></font>
    ├── releases<font></font>
    │&nbsp;&nbsp; ├── backend.yaml<font></font>
    │&nbsp;&nbsp; └── postgres.yaml<font></font>
    └── helmfile.yaml</code></pre><br>
<h4 id="helmfileyaml-4"><strong><code>helmfile.yaml</code></strong></h4><br>
<pre><code class="diff hljs">  environments:<font></font>
    devel:<font></font>
      values:<font></font>
      - charts:<font></font>
          versions:<font></font>
            backend: 1.1.0<font></font>
      - apps:<font></font>
        - postgres<font></font>
        - backend<font></font>
      - global:<font></font>
          ingressDomain: k8s.devel.domain<font></font>
<span class="hljs-addition">+     secrets:</span>
<span class="hljs-addition">+       - envs/devel/secrets.yaml</span><font></font>
<font></font>
    production:<font></font>
      values:<font></font>
      - charts:<font></font>
          versions:<font></font>
            backend: 1.0.5<font></font>
      - apps:<font></font>
        - backend<font></font>
      - global:<font></font>
          ingressDomain: production.domain<font></font>
<span class="hljs-addition">+     secrets:</span>
<span class="hljs-addition">+       - envs/production/secrets.yaml</span><font></font>
  ---<font></font>
  bases:<font></font>
  {{- range .Values.apps }}<font></font>
    - releases/{{ . }}.yaml<font></font>
  {{- end }}</code></pre><br>
<h4 id="envsdevelsecretsyaml"><strong><code>envs/devel/secrets.yaml</code></strong></h4><br>
<pre><code class="plaintext hljs">secrets:<font></font>
    elastic:<font></font>
        password: ENC[AES256_GCM,data:hjCB,iv:Z1P6/6xBJgJoKLJ0UUVfqZ80o4L84jvZfM+uH9gBelc=,tag:dGqQlCZnLdRAGoJSj63rBQ==,type:int]<font></font>
...</code></pre><br>
<h4 id="envsproductionsecretsyaml"><strong><code>envs/production/secrets.yaml</code></strong></h4><br>
<pre><code class="plaintext hljs">secrets:<font></font>
    elastic:<font></font>
        password: ENC[AES256_GCM,data:ZB/VpTFk8f0=,iv:EA//oT1Cb5wNFigTDOz3nA80qD9UwTjK5cpUwLnEXjs=,tag:hMdIUaqLRA8zuFBd82bz6A==,type:str]<font></font>
...</code></pre><br>
<h4 id="envsdefaultvaluesbackendyamlgotmpl-1"><strong><code>envs/default/values/backend.yaml.gotmpl</code></strong></h4><br>
<pre><code class="plaintext hljs">elasticsearch:<font></font>
  host: elasticsearch<font></font>
  port: 9200<font></font>
  password: {{ .Values | getOrNil "secrets.elastic.password" | default "password" }}</code></pre><br>
<h4 id="envsdevelvaluesbackendyaml"><strong><code>envs/devel/values/backend.yaml</code></strong></h4><br>
<pre><code class="plaintext hljs">elasticsearch:<font></font>
  host: elastic-0.devel.domain</code></pre><br>
<h4 id="envsproductionvaluesbackendyaml"><strong><code>envs/production/values/backend.yaml</code></strong></h4><br>
<pre><code class="plaintext hljs">elasticsearch:<font></font>
  host: elastic-0.production.domain</code></pre><br>
<hr><br>
<p><strong></strong></p><br>
<p>, <code>getOrNil</code> —    go   helmfile, ,   <code>.Values.secrets</code>   ,   ,        <code>default</code>   -</p><br>
<hr><br>
<h2 id="zaklyuchenie"></h2><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die beschriebenen Dinge scheinen ziemlich offensichtlich zu sein, aber die Informationen zu einer praktischen Bereitstellungsbeschreibung in mehreren Umgebungen mit Helmdatei sind sehr knapp, und ich liebe IaC (Infrastructure-as-Code) und möchte eine klare Beschreibung des Bereitstellungsstatus haben.</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abschließend möchte ich hinzufügen, dass die Variablen für die Standardumgebung wiederum durch die Betriebssystemumgebungsvariablen eines Läufers parametrisiert werden können, von dem aus die Bereitstellung gestartet wird, und somit dynamische Umgebungen erhalten</font></font></p><br>
<h4 id="helmfileyaml-5"><strong><code>helmfile.yaml</code></strong></h4><br>
<pre><code class="plaintext hljs">environments:<font></font>
  default:<font></font>
    values:<font></font>
    - global:<font></font>
        clusterDomain: {{ env "CLUSTER_DOMAIN" | default "cluster.local" }}<font></font>
        ingressDomain: {{ env "INGRESS_DOMAIN" }}</code></pre></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de491094/index.html">Installation von Firebird 3 unter modernen Linux-Versionen: CentOS8 und Ubuntu 19</a></li>
<li><a href="../de491100/index.html">Auf Wanhao 5S druckten sie eine Puppe mit der Größe einer Person</a></li>
<li><a href="../de491102/index.html">Wie man einen Service entwickelt, wenn es harte Konkurrenten gibt</a></li>
<li><a href="../de491104/index.html">Wie ich einen Hardwarefehler auf meinem Lenovo MiiX 2 10 Tablet gefunden habe</a></li>
<li><a href="../de491106/index.html">Warum benötigen Sie möglicherweise eine halbsynchrone Replikation?</a></li>
<li><a href="../de491110/index.html">Konvertieren Sie RTF in XML in C #</a></li>
<li><a href="../de491112/index.html">Der Weg zur Unschuld im Netzwerk - Cisco DNA</a></li>
<li><a href="../de491114/index.html">Kluger Umzug oder wie man ein Unternehmen für die Arbeit auswählt und es nicht bereut</a></li>
<li><a href="../de491116/index.html">Moderne Identifikationsstandards: OAuth 2.0, OpenID Connect, WebAuthn</a></li>
<li><a href="../de491118/index.html">Entwicklerherz: Devkits der 5. Konsolengeneration (Teil 1)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>