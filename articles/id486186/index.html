<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤²ğŸ½ ğŸ‘ğŸ¾ ğŸ™ğŸ¾ Catastrophic Cloud: Bagaimana Cara Kerjanya ğŸ¤±ğŸ¼ ğŸ‡ ğŸ‘©ğŸ¾â€ğŸŒ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo, Habr! 
 
 Setelah liburan Tahun Baru, kami memulai kembali cloud yang tahan bencana berdasarkan dua situs. Hari ini kami akan memberi tahu Anda ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Catastrophic Cloud: Bagaimana Cara Kerjanya</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataline/blog/486186/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Halo, Habr! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah liburan Tahun Baru, kami memulai kembali cloud yang tahan bencana berdasarkan dua situs. </font><font style="vertical-align: inherit;">Hari ini kami akan memberi tahu Anda cara kerjanya dan menunjukkan apa yang terjadi pada mesin virtual klien ketika masing-masing elemen kluster gagal dan seluruh situs jatuh (spoiler - semuanya baik-baik saja dengan mereka). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/no/xs/p9/noxsp98upzfesoanpuhefetyilq.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penyimpanan cloud tahan bencana di situs OST.</font></font></i><a name="habracut"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apa yang ada di dalam</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di bawah kap cluster adalah server Cisco UCS dengan hyperware VMware ESXi, dua sistem penyimpanan INFINIDAT InfiniBox F2240, peralatan jaringan Nexus Nexus, serta sakelar Brocade SAN. </font><font style="vertical-align: inherit;">Cluster ditempatkan dalam dua situs - OST dan NORD, yaitu, di setiap pusat data satu set peralatan yang identik. </font><font style="vertical-align: inherit;">Sebenarnya, ini membuatnya menjadi bencana. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam satu platform, elemen-elemen utama juga digandakan (host, switch SAN, kartu jaringan). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dua situs dihubungkan oleh jalur serat optik khusus, juga disediakan. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beberapa kata tentang penyimpanan. </font><font style="vertical-align: inherit;">Cloud tahan bencana pertama yang kami bangun di NetApp. </font><font style="vertical-align: inherit;">INFINIDAT dipilih di sini, dan inilah alasannya:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opsi replikasi aktif-aktif. </font><font style="vertical-align: inherit;">Ini memungkinkan mesin virtual untuk tetap beroperasi bahkan jika salah satu sistem penyimpanan benar-benar gagal. </font><font style="vertical-align: inherit;">Saya akan memberi tahu Anda lebih banyak tentang replikasi nanti.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tiga pengontrol disk untuk meningkatkan ketahanan sistem. </font><font style="vertical-align: inherit;">Biasanya ada dua.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solusi siap. </font><font style="vertical-align: inherit;">Rak yang sudah dirakit mendatangi kami, yang hanya perlu dihubungkan ke jaringan dan dikonfigurasi.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dukungan teknis yang penuh perhatian. </font><font style="vertical-align: inherit;">Insinyur INFINIDAT secara konstan menganalisis log dan peristiwa sistem penyimpanan, menginstal versi baru di firmware, dan membantu dengan konfigurasi.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berikut beberapa foto dari pembongkaran:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ro/r1/9i/ror19i6ohplap3nzivyq9dxqaog.png"><br>
<br>
<img src="https://habrastorage.org/webt/rg/zm/of/rgzmofi67yaghzz7fziewaka3fw.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bagaimana cara kerjanya</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Awan sudah tangguh dalam dirinya sendiri. Ini melindungi klien dari kegagalan perangkat keras dan perangkat lunak tunggal. Catastrophic akan membantu melindungi terhadap kegagalan massal dalam situs yang sama: misalnya, kegagalan sistem penyimpanan (atau gugus SDS, yang sering terjadi :)), kesalahan massal di jaringan penyimpanan, dan lainnya. Nah dan yang paling penting: awan seperti itu menyelamatkan ketika seluruh situs menjadi tidak dapat diakses karena kebakaran, pemadaman, penangkapan perampok, </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pendaratan alien.</font></font></s><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dalam semua kasus ini, mesin virtual klien terus berjalan, dan inilah sebabnya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skema cluster dirancang sedemikian rupa sehingga setiap host ESXi dengan mesin virtual klien dapat mengakses salah satu dari dua sistem penyimpanan. Jika penyimpanan di situs OST gagal, maka mesin virtual akan terus bekerja: host tempat mereka bekerja akan mengakses penyimpanan di NORD untuk data. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vu/pq/0u/vupq0uycl3yelwrujymst8jqpke.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini adalah bagaimana diagram koneksi di cluster terlihat.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ini dimungkinkan karena fakta bahwa Inter-Switch Link dikonfigurasikan antara pabrik-pabrik SAN dari dua situs: switch Fabric A OST SAN terhubung ke switch Fabric A NORD SAN, mirip dengan switch SAN Fabric B.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nah, agar semua seluk-beluk pabrik SAN ini masuk akal, replikasi Aktif-Aktif dikonfigurasikan antara dua sistem penyimpanan: informasi ditulis hampir bersamaan ke sistem penyimpanan lokal dan jarak jauh, RPO = 0. Ternyata pada satu SHD data asli disimpan, di sisi lain - replika mereka. Data direplikasi pada tingkat volume penyimpanan, dan data VM (disk-nya, file konfigurasi, file swap, dll.) Sudah tersimpan di dalamnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Host ESXi melihat volume primer dan replikanya sebagai perangkat penyimpanan tunggal. Ada 24 jalur dari host ESXi ke setiap perangkat disk:</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
12 jalur menghubungkannya dengan penyimpanan lokal (jalur optimal), dan 12 jalur lainnya - dengan remote (jalur tidak optimal). Dalam situasi normal, ESXi mengakses data pada penyimpanan lokal menggunakan jalur "optimal". Jika sistem penyimpanan ini gagal, ESXi kehilangan jalur optimalnya dan beralih ke jalur â€œtidak optimalâ€. Begini tampilannya di diagram. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tl/zu/rp/tlzurpwt1mspwdpbjeb53ydas4i.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Skema gugus tahan bencana.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Semua jaringan klien dibuat di kedua situs melalui pabrik jaringan yang sama. Provider Edge (PE) berjalan di setiap situs, di mana jaringan klien diakhiri. PEs digabungkan menjadi satu cluster. Jika PE gagal di satu situs, semua lalu lintas dialihkan ke situs kedua. Berkat ini, mesin virtual dari situs tanpa PE tetap tersedia melalui jaringan untuk klien.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita lihat apa yang akan terjadi pada mesin virtual klien jika terjadi berbagai kegagalan. </font><font style="vertical-align: inherit;">Mari kita mulai dengan opsi paling ringan dan akhiri dengan yang paling serius - kegagalan seluruh situs. </font><font style="vertical-align: inherit;">Dalam contoh, situs utama adalah OST, dan cadangan, dengan replika data, adalah NORD.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apa yang terjadi pada mesin virtual klien jika ... </font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gagal Tautan Replikasi.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Replikasi antara sistem penyimpanan dua situs berhenti. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ESXi hanya akan bekerja dengan perangkat disk lokal (di sepanjang jalur optimal). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mesin virtual terus bekerja. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xd/1u/rs/xd1urscyrw5ldefaecvzg2sxsbg.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ada celah ISL (Inter-Switch Link).</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kasusnya tidak mungkin. Kecuali beberapa ekskavator gila menggali beberapa rute optik sekaligus, yang melewati rute independen dan dibawa ke lokasi melalui input yang berbeda. Tapi bagaimanapun juga. Dalam hal ini, host ESXi kehilangan setengah dari jalurnya dan hanya dapat mengakses penyimpanan lokal mereka. Replika dikumpulkan, tetapi tuan rumah tidak akan dapat mengaksesnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mesin virtual bekerja secara normal. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/eh/pg/p2/ehpgp21qksqs333elaz_px8hohs.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menolak sakelar SAN di salah satu situs.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Host ESXi kehilangan beberapa jalur penyimpanannya. Dalam hal ini, host di situs tempat sakelar gagal hanya akan bekerja melalui HBA mereka sendiri. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada saat yang sama, mesin virtual terus bekerja secara normal. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vz/_1/0w/vz_10wdyjuu3yp9flx0-kyiog9w.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semua SAN beralih pada salah satu situs gagal.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Katakanlah bencana seperti itu terjadi di situs OST. Dalam hal ini, host ESXi di situs ini akan kehilangan semua jalur ke perangkat disk mereka. Mekanisme VMware vSphere HA standar mulai digunakan: mekanisme ini akan memulai kembali semua mesin virtual platform OST di NORD setelah maksimal 140 detik. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mesin virtual yang berjalan di host situs NORD bekerja secara normal. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yg/le/w8/yglew89bonr-aubz9dw85jxbnb0.gif"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menolak host ESXi di satu situs.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di sini mekanisme HA vSphere berfungsi lagi: mesin virtual dari host yang gagal dihidupkan ulang pada host lain - di situs yang sama atau jauh. Waktu restart mesin virtual hingga 1 menit. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika semua host ESXi dari platform OST gagal, tidak ada opsi: VM restart pada yang lain. Waktu restart adalah sama. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ij/ri/no/ijrino56s-akqtzivujr3en3ejy.gif"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menolak penyimpanan di situs yang sama.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Katakanlah sistem penyimpanan ditolak di situs OST. Kemudian host OST ESXi beralih untuk bekerja dengan replika penyimpanan di NORD. Setelah sistem penyimpanan yang gagal kembali ke sistem, replikasi paksa terjadi, host OST ESXi akan kembali menghubungi sistem penyimpanan lokal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mesin virtual telah bekerja selama ini. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ng/gk/vy/nggkvy-lk3dbjs-zfop2racir3u.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gagal salah satu situs.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam hal ini, semua mesin virtual akan memulai kembali di situs cadangan melalui mekanisme HA vSphere. Waktu mulai ulang VM - 140 detik. Dalam hal ini, semua pengaturan jaringan mesin virtual akan disimpan, dan itu tetap tersedia untuk klien melalui jaringan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk me-restart mesin di situs cadangan tanpa masalah, setiap situs hanya setengah penuh. Bagian kedua adalah cadangan jika semua mesin virtual dipindahkan dari situs kedua yang terluka. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oa/hg/hr/oahghrsypij8je-zwym7trlj0-g.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Awan tahan bencana berdasarkan dua pusat data melindungi dari kegagalan tersebut.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kesenangan ini tidak murah, karena, selain sumber daya utama, Anda memerlukan cadangan di situs kedua. </font><font style="vertical-align: inherit;">Oleh karena itu, mereka menempatkan layanan yang penting bagi bisnis dalam awan seperti itu, downtime panjang yang menimbulkan kerugian finansial dan reputasi yang besar, atau jika persyaratan toleransi bencana dibebankan pada sistem informasi dari regulator atau peraturan internal perusahaan. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sumber:</font></font></b><br>
<br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.infinidat.com/sites/default/files/resource-pdfs/DS-INFBOX-190331-US_0.pdf</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">support.infinidat.com/hc/en-us/articles/207057109-InfiniBox-best-practices-guides</font></font></a></li>
</ol></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id486186/">https://habr.com/ru/post/id486186/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi487582/index.html">à¤•à¥‹à¤ˆ à¤¦à¥‡à¤µà¤¤à¤¾ à¤¬à¤°à¥à¤¤à¤¨ à¤¨à¤¹à¥€à¤‚ à¤œà¤²à¤¾à¤¤à¥‡</a></li>
<li><a href="../id486176/index.html">Memo Korespondensi Email Perusahaan</a></li>
<li><a href="../id486178/index.html">Berita FOSS No. 1 - ulasan berita sumber terbuka dan gratis untuk 27 Januari - 2 Februari 2020</a></li>
<li><a href="../id486180/index.html">Kiat dan sumber untuk membuat aplikasi tanpa server</a></li>
<li><a href="../id486184/index.html">Cara menggunakan pencarian secara efektif</a></li>
<li><a href="../id486188/index.html">Memperkenalkan sistem cadangan PostgreSQL wal-g</a></li>
<li><a href="../id486190/index.html">Pengalaman kami dalam mengembangkan driver CSI di Kubernetes untuk Yandex.Cloud</a></li>
<li><a href="../id486192/index.html">Penipu dunia maya meretas operator seluler untuk mendapatkan nomor telepon pelanggan</a></li>
<li><a href="../id486194/index.html">Tentang cadangan di Proxmox VE</a></li>
<li><a href="../id486198/index.html">Berbicara itu sulit. Esai tentang Berkomunikasi dengan Non-Programmer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>