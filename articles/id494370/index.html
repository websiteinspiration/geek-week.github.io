<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕵🏾 🍅 🐩 Arsitektur Bersih melalui mata pengembang Python 🕺🏾 🕵🏽 🤽🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo! Nama saya Eugene, saya adalah pengembang Python. Selama satu setengah tahun terakhir, tim kami mulai secara aktif menerapkan prinsip Arsitektur ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Arsitektur Bersih melalui mata pengembang Python</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/exness/blog/494370/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Halo! Nama saya Eugene, saya adalah pengembang Python. Selama satu setengah tahun terakhir, tim kami mulai secara aktif menerapkan prinsip Arsitektur Bersih, menjauh dari model MVC klasik. Dan hari ini saya akan berbicara tentang bagaimana kita sampai pada ini, apa yang diberikannya kepada kita, dan mengapa transfer langsung pendekatan dari PL lain tidak selalu merupakan solusi yang baik.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/t_/hs/tl/t_hstlzmkevavrg4y8tazjdfu4c.png"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Python telah menjadi alat pengembangan utama saya selama lebih dari tujuh tahun sekarang. Ketika mereka bertanya kepada saya apa yang paling saya sukai darinya, saya menjawab bahwa ini adalah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">keterbacaannya yang luar biasa</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Kenalan pertama dimulai dengan membaca buku </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Programming a Collective Mind"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Saya tertarik pada algoritma yang dijelaskan di dalamnya, tetapi semua contohnya dalam bahasa yang belum saya kenal saat itu. Ini tidak biasa (Python belum menjadi arus utama dalam pembelajaran mesin), daftar sering ditulis dalam pseudo-code atau menggunakan diagram. Tapi setelah pengantar singkat ke bahasa, saya menghargai keringkasannya: semuanya </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mudah dan jelas, tidak ada yang berlebihan dan mengganggu, hanya inti dari proses yang dijelaskan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Kelebihan utama dari ini adalah desain bahasa yang menakjubkan, gula sintaksis yang sangat intuitif. </font><font style="vertical-align: inherit;">Ekspresi ini selalu dihargai di masyarakat. </font><font style="vertical-align: inherit;">Apa itu " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">impor ini</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ", harus ada di halaman pertama buku teks apa pun: sepertinya pengawas yang tak terlihat, terus-menerus mengevaluasi tindakan Anda. </font><font style="vertical-align: inherit;">Di forum, layak pemula untuk menggunakan entah bagaimana </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CamelCase</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dalam nama variabel dalam daftar, jadi segera sudut diskusi bergeser ke arah idiom kode yang diusulkan dengan referensi ke PEP8.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengejar keanggunan plus dinamisme bahasa yang kuat telah menciptakan banyak perpustakaan dengan API yang benar-benar menyenangkan.&nbsp;</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meskipun demikian, Python, walaupun kuat, hanyalah alat yang memungkinkan Anda untuk menulis kode yang mendokumentasikan diri sendiri, tetapi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak menjamin hal ini</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , juga kepatuhan PEP8. </font><font style="vertical-align: inherit;">Ketika toko online kami yang tampaknya sederhana di Django mulai menghasilkan uang dan, sebagai hasilnya, memompa fitur, pada satu titik kami menyadari bahwa itu tidak begitu sederhana, dan bahkan membuat perubahan mendasar memerlukan lebih banyak usaha, dan yang paling penting, tren </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ini berkembang. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apa yang terjadi dan ketika semuanya salah?</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kode salah</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode buruk bukan salah satu yang tidak mengikuti PEP8 atau tidak memenuhi persyaratan kompleksitas siklomatik. </font><font style="vertical-align: inherit;">Pertama-tama, kode salah adalah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dependensi yang tidak terkontrol</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang mengarah pada fakta bahwa perubahan di satu tempat program menyebabkan perubahan yang tidak terduga di bagian lain. </font><font style="vertical-align: inherit;">Kami kehilangan kendali atas kode, memperluas fungsionalitas memerlukan studi rinci dari proyek. </font><font style="vertical-align: inherit;">Kode tersebut kehilangan fleksibilitasnya dan, seolah-olah, menolak melakukan perubahan, sementara program itu sendiri menjadi "rapuh".&nbsp;</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arsitektur bersih</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Arsitektur aplikasi yang dipilih harus menghindari masalah ini, dan kami bukan orang pertama yang menemukan ini: telah ada diskusi di komunitas Java tentang membuat desain aplikasi yang optimal untuk waktu yang lama. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kembali pada tahun 2000, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Robert Martin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (juga dikenal sebagai Paman Bob) dalam artikelnya " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prinsip Desain dan Desain</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " menyatukan lima prinsip untuk merancang aplikasi OOP di bawah akronim </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SOLID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Prinsip-prinsip ini telah diterima dengan baik oleh masyarakat dan telah jauh melampaui ekosistem Jawa. Namun demikian, mereka sangat abstrak. Kemudian ada beberapa upaya untuk mengembangkan desain aplikasi umum berdasarkan prinsip SOLID. Ini termasuk: "Arsitektur heksagonal", "Port dan adaptor", "Arsitektur Bulbous" dan mereka semua memiliki banyak kesamaan, meskipun detail implementasi yang berbeda. Dan pada 2012, sebuah artikel diterbitkan oleh Robert Martin yang sama, di mana ia mengusulkan versinya sendiri yang disebut " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arsitektur Bersih</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/c32/3a9/769/c323a9769c90f4e28a17e1d5c05ab160.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menurut Paman Bob, arsitektur terutama adalah " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">batas dan hambatan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ", perlu untuk memahami dengan jelas kebutuhan dan membatasi antarmuka perangkat lunak agar tidak kehilangan kendali atas aplikasi. Untuk melakukan ini, program </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ini dibagi menjadi beberapa lapisan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Beralih dari satu lapisan ke lapisan lain, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hanya data yang</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dapat ditransfer </font><font style="vertical-align: inherit;">(struktur sederhana dan </font><font style="vertical-align: inherit;">objek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DTO</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dapat bertindak sebagai data </font><font style="vertical-align: inherit;">) - ini adalah aturan batas. </font><font style="vertical-align: inherit;">Ungkapan lain yang paling sering dikutip bahwa " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aplikasi harus berteriak</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " berarti bahwa hal utama dalam aplikasi bukanlah kerangka kerja yang digunakan atau teknologi penyimpanan data, tetapi apa yang sebenarnya dilakukan aplikasi ini, fungsi apa yang dijalankannya - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">logika bisnis dari</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aplikasi tersebut . </font><font style="vertical-align: inherit;">Oleh karena itu, lapisan tidak memiliki struktur linier, tetapi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memiliki hierarki</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Karenanya dua aturan lagi:</font></font><br>
 <br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aturan prioritas untuk lapisan dalam</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - itu adalah lapisan dalam yang menentukan antarmuka di mana ia akan berinteraksi dengan dunia luar;</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketergantungan aturan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Ketergantungan harus diarahkan dari lapisan dalam ke luar.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aturan terakhir cukup tidak lazim di dunia Python. </font><font style="vertical-align: inherit;">Untuk menerapkan skenario logika bisnis yang rumit, Anda selalu perlu mengakses layanan eksternal (misalnya, basis data), tetapi untuk menghindari ketergantungan ini, lapisan logika bisnis </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itu sendiri harus menyatakan antarmuka</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> yang dengannya ia akan berinteraksi dengan dunia luar. </font><font style="vertical-align: inherit;">Teknik ini disebut " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dependensi inversi</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " (huruf D dalam SOLID) dan banyak digunakan dalam bahasa dengan pengetikan statis. </font><font style="vertical-align: inherit;">Menurut Robert Martin, ini adalah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">keunggulan utama yang datang dengan OOP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tiga aturan ini adalah inti dari Arsitektur Bersih:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aturan lintas batas;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aturan ketergantungan;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aturan prioritas lapisan dalam.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Keuntungan dari pendekatan ini meliputi:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kemudahan pengujian</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - lapisan terisolasi, masing-masing, mereka dapat diuji tanpa monyet-patching, Anda dapat mengatur pelapisan untuk lapisan yang berbeda, tergantung pada tingkat kepentingannya;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kemudahan mengubah aturan bisnis</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , karena semuanya dikumpulkan di satu tempat, tidak tersebar di proyek dan tidak dicampur dengan kode tingkat rendah;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Independensi dari agen eksternal</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : kehadiran abstraksi antara logika bisnis dan dunia luar dalam kasus tertentu memungkinkan Anda untuk mengubah sumber eksternal tanpa mempengaruhi lapisan internal. </font><font style="vertical-align: inherit;">Ini berfungsi jika Anda belum mengikat logika bisnis dengan fitur spesifik agen eksternal, misalnya, transaksi basis data;</font></font></li>
<li><b> </b>,   ,     ,      .</li>
</ul><br>
<blockquote>     ,    .           .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a>,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a>.     «<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> Clean Architecture</a>».<br>
</blockquote><br>
<h2>  Python</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini adalah teori, contoh penerapan praktis dapat ditemukan dalam artikel asli, laporan dan buku Robert Martin. Mereka mengandalkan beberapa pola desain umum dari dunia Java: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adaptor, Gateway, Interactor, Fasade, Repository, DTO</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dll. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nah, bagaimana dengan Python? Seperti yang saya katakan, laconicism dihargai di komunitas Python. Apa yang telah berakar pada orang lain jauh dari kenyataan bahwa ia akan berakar bersama kami. Pertama kali saya beralih ke topik ini tiga tahun lalu, maka tidak ada banyak materi tentang topik menggunakan Arsitektur Bersih dengan Python, tetapi tautan pertama di Google adalah </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proyek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Leonardo Giordani: penulis menjelaskan secara terperinci proses pembuatan API untuk situs pencarian properti menggunakan metode TDD, menerapkan Arsitektur Bersih.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sayangnya, terlepas dari penjelasan yang cermat dan mengikuti semua kanon Paman Bob, contoh ini agak </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menakutkan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
API proyek terdiri dari satu metode - mendapatkan daftar dengan filter yang tersedia. Saya berpikir bahwa bahkan untuk pengembang pemula, kode untuk proyek semacam itu akan mengambil tidak lebih dari 15 baris. Tetapi dalam kasus ini, ia mengambil enam paket. Anda dapat merujuk ke tata letak yang tidak sepenuhnya berhasil, dan ini benar, tetapi dalam hal apa pun, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sulit bagi seseorang untuk menjelaskan efektivitas pendekatan ini</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , merujuk pada proyek ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada masalah yang lebih serius, jika Anda tidak membaca artikel dan segera mulai mempelajari proyek, maka itu cukup sulit untuk dipahami. Pertimbangkan penerapan logika bisnis:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> rentomatic.response_objects <span class="hljs-keyword">import</span> response_objects <span class="hljs-keyword">as</span> res<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RoomListUseCase</span>(<span class="hljs-params">object</span>):</span>
&nbsp;&nbsp;&nbsp;<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, repo</span>):</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.repo = repo<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">execute</span>(<span class="hljs-params">self, request_object</span>):</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> request_object:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> res.ResponseFailure.build_from_invalid_request_object(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request_object)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">try</span>:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rooms = self.repo.list(filters=request_object.filters)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> res.ResponseSuccess(rooms)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> exc:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> res.ResponseFailure.build_system_error(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"{}: {}"</span>.format(exc.__class__.__name__, <span class="hljs-string">"{}"</span>.format(exc)))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kelas RoomListUseCase yang mengimplementasikan logika bisnis (tidak terlalu mirip dengan logika bisnis, kan?) Dari proyek diinisialisasi oleh objek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Tapi apa itu </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? Tentu saja, dari konteksnya, kita dapat memahami bahwa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mengimplementasikan templat Repositori untuk mengakses data, jika kita melihat isi RoomListUseCase, kita memahami bahwa itu harus memiliki satu metode daftar, input yang merupakan daftar filter, yang tidak jelas pada output, Anda perlu melihat di ResponseSuccess. Dan jika skenarionya lebih kompleks, dengan beberapa akses ke sumber data? Ternyata untuk memahami apa itu repo, Anda </font><b><font style="vertical-align: inherit;">hanya</font></b><font style="vertical-align: inherit;"> bisa </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">merujuk pada implementasinya</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Tapi di mana dia berada? Itu terletak pada modul terpisah, yang sama sekali tidak terkait dengan RoomListUseCase. Jadi, untuk memahami apa yang terjadi, Anda perlu naik ke level atas (level framework) dan melihat apa yang diumpankan ke input kelas ketika membuat objek. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda mungkin berpikir bahwa saya mencantumkan kerugian dari pengetikan dinamis, tetapi ini tidak sepenuhnya benar. Ini adalah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pengetikan dinamis yang memungkinkan Anda menulis kode yang ekspresif dan ringkas</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Analogi dengan layanan microser muncul di pikiran, ketika kita memotong monolith menjadi layanan microser, desain mengambil kekakuan tambahan, karena apa pun dapat dilakukan di dalam layanan mikro (PL, kerangka kerja, arsitektur), tetapi harus sesuai dengan antarmuka yang dinyatakan. Jadi di sini: ketika kami membagi proyek kami menjadi beberapa lapisan,</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hubungan antara lapisan harus konsisten dengan kontrak</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sementara di dalam lapisan, kontrak bersifat opsional. Jika tidak, Anda harus menyimpan konteks yang cukup besar di kepala Anda. Ingat, saya mengatakan bahwa masalah dengan kode buruk adalah dependensi, dan karenanya, tanpa antarmuka yang eksplisit, kami kembali meluncur ke tempat kami ingin pergi - dengan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak adanya hubungan sebab akibat yang jelas</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<blockquote>    <i>repo</i>     RoomListUseCase,    execute — <b>   </b>.       -    ,   ,     .     -        . ,   ,    ,  <i>repo</i>   .</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secara umum, pada waktu itu saya meninggalkan Arsitektur Bersih dalam proyek baru, sekali lagi menerapkan MVC klasik. Tetapi, setelah mengisi kumpulan kerucut berikutnya, ia kembali ke ide ini setahun kemudian, ketika, akhirnya, kami mulai meluncurkan layanan dengan Python 3.5+. Seperti yang Anda tahu, dia membawa </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">anotasi tipe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kelas data</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Dua alat deskripsi antarmuka yang kuat. Berdasarkan pada mereka, saya membuat sketsa prototipe layanan, dan hasilnya sudah jauh lebih baik: lapisan berhenti berhamburan, terlepas dari kenyataan bahwa masih ada banyak kode, terutama ketika mengintegrasikan dengan kerangka kerja. Tetapi itu sudah cukup untuk mulai menerapkan pendekatan ini dalam proyek-proyek kecil. Secara bertahap, kerangka kerja mulai muncul yang berfokus pada penggunaan maksimum anotasi tipe: apistar (sekarang starlette), moltenframework. Bundel pydantic / FastAPI sekarang umum, dan integrasi dengan kerangka kerja seperti itu menjadi lebih mudah. Beginilah contoh dari restomatic / services.py di atas:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> Optional, List
<span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Room</span>(<span class="hljs-params">BaseModel</span>):</span><font></font>
&nbsp;&nbsp;&nbsp;code: str<font></font>
&nbsp;&nbsp;&nbsp;size: int<font></font>
&nbsp;&nbsp;&nbsp;price: int<font></font>
&nbsp;&nbsp;&nbsp;latitude: float<font></font>
&nbsp;&nbsp;&nbsp;longitude: float<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RoomFilter</span>(<span class="hljs-params">BaseModel</span>):</span>
&nbsp;&nbsp;&nbsp;code: Optional[str] = <span class="hljs-literal">None</span>
&nbsp;&nbsp;&nbsp;price_min: Optional[int] = <span class="hljs-literal">None</span>
&nbsp;&nbsp;&nbsp;price_max: Optional[int] = <span class="hljs-literal">None</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RoomStorage</span>:</span>
&nbsp;&nbsp;&nbsp;<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_rooms</span>(<span class="hljs-params">self, filters: RoomFilter</span>) -&gt; List[Room]:</span> ...<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RoomListUseCase</span>:</span>
&nbsp;&nbsp;&nbsp;<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, repo: RoomStorage</span>):</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.repo = repo<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">show_rooms</span>(<span class="hljs-params">self, filters: RoomFilter</span>) -&gt; List[Room]:</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rooms = self.repo.get_rooms(filters=filters)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> rooms</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RoomListUseCase - kelas yang mengimplementasikan logika bisnis proyek. Anda seharusnya tidak memperhatikan fakta bahwa semua metode show_rooms tidak memanggil ke RoomStorage (saya tidak datang dengan contoh ini). Dalam kehidupan nyata, bisa juga ada perhitungan diskon, peringkat daftar berdasarkan iklan, dll. Namun, modul ini mandiri. Jika kita ingin menggunakan skenario ini di proyek lain, kita harus mengimplementasikan RoomStorage. Dan apa yang dibutuhkan untuk ini terlihat jelas langsung dari modul. Berbeda dengan contoh sebelumnya, lapisan seperti </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itu swasembada</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan ketika mengubahnya tidak perlu mengingat seluruh konteks. Dari dependensi non-sistemik hanya pydantic, mengapa, itu akan menjadi jelas dalam plug-in dari framework. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tidak ada ketergantungan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, cara lain untuk meningkatkan keterbacaan kode, bukan konteks tambahan, bahkan pengembang pemula akan dapat memahami apa yang dilakukan modul ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skenario logika bisnis tidak harus berupa kelas, di bawah ini adalah contoh skenario serupa dalam bentuk fungsi:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">rool_list_use_case</span>(<span class="hljs-params">filters: RoomFilter, repo: RoomStorage</span>) -&gt; List[Room]:</span><font></font>
&nbsp;&nbsp;&nbsp;rooms = repo.get_rooms(filters=filters)<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> rooms</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan inilah koneksi ke framework:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> List
<span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI, Depends
<span class="hljs-keyword">from</span> rentomatic <span class="hljs-keyword">import</span> services, adapters<font></font>
app = FastAPI()<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_use_case</span>() -&gt; services.RoomListUseCase:</span>
&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> services.RoomListUseCase(adapters.MemoryStorage())<font></font>
<font></font>
<span class="hljs-meta">@app.post("/rooms", response_model=List[services.Room])</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">rooms</span>(<span class="hljs-params">filters: services.RoomFilter, use_case=Depends(<span class="hljs-params">get_use_case</span>)</span>):</span>
&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> use_case.show_rooms(filters)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menggunakan fungsi get_use_case, FastAPI mengimplementasikan pola </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dependency Injection</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Kita tidak perlu khawatir tentang serialisasi data, semua pekerjaan dilakukan oleh FastAPI bersamaan dengan pydantic. Sayangnya, data tidak selalu format logika bisnis yang cocok untuk siaran langsung di restoran &lt;dan, sebaliknya, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">logika bisnis tidak tahu dari mana datanya - dengan garis miring, badan permintaan, cookie, dll</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dalam hal ini, isi fungsi ruangan akan memiliki konversi tertentu dari data input dan output, tetapi dalam kebanyakan kasus, jika kita bekerja dengan API, fungsi proxy yang mudah seperti itu sudah cukup.&nbsp;</font></font><br>
<br>
<blockquote> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a>   , ,    ,    RoomStorage.  ,     15 ,     ,      ,         .</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya sengaja tidak memisahkan lapisan logika bisnis, seperti yang disarankan oleh model Arsitektur Bersih kanonik. </font><font style="vertical-align: inherit;">Kelas Kamar seharusnya berada di lapisan wilayah domain Entitas yang mewakili wilayah domain, tetapi untuk contoh ini tidak perlu untuk ini. </font><font style="vertical-align: inherit;">Dari menggabungkan lapisan Entity dan UseCase, proyek tidak berhenti menjadi implementasi Arsitektur Bersih. </font><font style="vertical-align: inherit;">Robert Martin sendiri telah berulang kali mengatakan bahwa </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jumlah lapisan dapat bervariasi</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> baik ke atas maupun ke bawah. </font><font style="vertical-align: inherit;">Pada saat yang sama, proyek memenuhi kriteria utama Arsitektur Bersih:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aturan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> penyeberangan perbatasan: model pydantic, yang pada dasarnya adalah DTO, </font><b><font style="vertical-align: inherit;">lintas batas</font></b><font style="vertical-align: inherit;"> ;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aturan Ketergantungan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : lapisan logika bisnis tidak tergantung pada lapisan lain;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aturan prioritas untuk lapisan dalam</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : itu adalah lapisan logika bisnis yang mendefinisikan antarmuka (RoomStorage), di mana logika bisnis berinteraksi dengan dunia luar.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hari ini, beberapa proyek tim kami, diimplementasikan menggunakan pendekatan yang dijelaskan, sedang mengerjakan prod. </font><font style="vertical-align: inherit;">Saya mencoba mengatur bahkan layanan terkecil dengan cara ini. </font><font style="vertical-align: inherit;">Ini melatih dengan baik - pertanyaan yang belum pernah saya pikirkan sebelumnya. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Misalnya, apa logika bisnis di sini? </font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini jauh dari selalu jelas, misalnya, jika Anda menulis semacam proxy. </font><font style="vertical-align: inherit;">Poin penting lainnya adalah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">belajar berpikir secara berbeda.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ketika kita mendapatkan tugas, kita biasanya mulai berpikir tentang kerangka kerja, layanan yang digunakan, tentang apakah akan ada kebutuhan untuk garis di sini, di mana lebih baik untuk menyimpan data ini, yang bisa di-cache. Dalam pendekatan yang mendikte Arsitektur Bersih, pertama-tama kita harus mengimplementasikan logika bisnis dan baru kemudian beralih ke mengimplementasikan interaksi dengan infrastruktur, karena, menurut Robert Martin, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tugas utama arsitektur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah menunda momen ketika koneksi dengan Lapisan infrastruktur akan menjadi bagian integral dari aplikasi Anda.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secara umum, saya melihat prospek yang menguntungkan untuk menggunakan Arsitektur Bersih dengan Python. </font><font style="vertical-align: inherit;">Tetapi bentuknya, kemungkinan besar, akan sangat berbeda dari bagaimana itu diterima di PL lain. </font><font style="vertical-align: inherit;">Selama beberapa tahun terakhir, saya telah melihat peningkatan minat yang signifikan dalam topik arsitektur di masyarakat. </font><font style="vertical-align: inherit;">Jadi, pada PyCon terakhir ada beberapa laporan tentang penggunaan DDD, dan orang-orang dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">laboratorium kering</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> harus dicatat secara terpisah </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Di perusahaan kami, banyak tim sudah menerapkan pendekatan yang dijelaskan pada tingkat tertentu. </font><font style="vertical-align: inherit;">Kita semua melakukan hal yang sama, kita telah tumbuh, proyek kita telah berkembang, komunitas Python harus bekerja dengan ini, mendefinisikan gaya dan bahasa umum yang, misalnya, pernah menjadi untuk semua Django.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id494350/index.html">Intisari Acara Online Maret dan April</a></li>
<li><a href="../id494354/index.html">Pengetahuan dan kondisi</a></li>
<li><a href="../id494356/index.html">Tutorial Linux Newbie Aircrack-ng</a></li>
<li><a href="../id494364/index.html">GDPR: Persetujuan untuk pemrosesan data pribadi</a></li>
<li><a href="../id494366/index.html">Mitaps online untuk seluruh minggu, mulai dari 27 Maret (untuk back, mobile, QA, PM, dan semuanya)</a></li>
<li><a href="../id494372/index.html">Perangkat Lunak Verifikasi Semua-Rusia - Tampilan Dalam</a></li>
<li><a href="../id494374/index.html">Bus listrik dan baterainya: apa itu lithium titanate? (Bagian 1)</a></li>
<li><a href="../id494376/index.html">Buffer Kedalaman Hirarkis</a></li>
<li><a href="../id494380/index.html">Pengantar Manajemen Produk Strategis</a></li>
<li><a href="../id494384/index.html">Survei fungsional</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>