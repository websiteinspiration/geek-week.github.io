<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥦 😪 🎨 まず第一に真実、またはデータベースシステムに基づいてシステムを設計する必要がある理由 😷 👨‍💼 👩‍🎤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="こんにちは、ハブル！データベースレベルを含め
 
 、JavaとSpringのトピックを引き続き探求します。今日、私たちは、大規模なアプリケーションを設計するとき、これがJavaコードではなくデータベース構造である理由について読むことを提案します。これは、これがどのように行われるか、およびこのルール...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>まず第一に真実、またはデータベースシステムに基づいてシステムを設計する必要がある理由</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/498816/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こんにちは、ハブル！</font><font style="vertical-align: inherit;">データベースレベルを含め</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Java</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Springの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トピックを引き続き探求し</font><font style="vertical-align: inherit;">ます。今日、私たちは、大規模なアプリケーションを設計するとき、これがJavaコードではなくデータベース構造である理由について読むことを提案します。これは、これがどのように行われるか、およびこのルールの例外が何であるかについて決定的な意味を持つ必要があります。</font></font><br>
<a name="habracut"></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このやや遅れた記事では、ほとんどすべての場合において、アプリケーションのデータモデルは「データベースに基づいて」設計されるべきであり、「Javaの機能に基づいて」（または使用する別のクライアント言語に基づいて）設計されるべきではないと私が信じる理由を説明します。</font><font style="vertical-align: inherit;">2番目のアプローチを選択すると、プロジェクトが成長し始めるとすぐに、苦痛と苦痛の長い旅に乗り出します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事は</font><font style="vertical-align: inherit;">、Stack Overflow </font><font style="vertical-align: inherit;">に関する</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1つの質問に</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基づいてい</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
セクション</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ r / java</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ r / programming</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">でのredditに関する興味深いディスカッション</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コード生成</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
jOOQに精通しているユーザーが、jOOQを使用する際にソースコードの生成に大きく依存しているという事実に憤慨しているユーザー層が非常に少ないことに驚いています。誰もがあなたが適切だと思うようにjOOQを使用することを気にしませんし、コード生成を使用するように強制しません。しかし、デフォルトでは（マニュアルで説明されているように）、jOOQの操作は次のように行われます。（継承された）データベーススキーマから始め、jOOQコードジェネレーターでリバースエンジニアリングして、テーブルを表す一連のクラスを取得します。これらのテーブルにタイプセーフなクエリを書き込みます。</font></font><br>
<br>
<pre><code class="java hljs">	<span class="hljs-keyword">for</span> (Record2&lt;String, String&gt; record : DSL.using(configuration)
<span class="hljs-comment">//   ^^^^^^^^^^^^^^^^^^^^^^^      </span>
<span class="hljs-comment">//     ,    </span>
<span class="hljs-comment">//   SELECT </span><font></font>
 <font></font>
       .select(ACTOR.FIRST_NAME, ACTOR.LAST_NAME)<font></font>
<span class="hljs-comment">//           vvvvv ^^^^^^^^^^^^  ^^^^^^^^^^^^^^^  </span><font></font>
       .from(ACTOR)<font></font>
       .orderBy(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)) {
    <span class="hljs-comment">// ...</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードは、アセンブリの外部で手動で、または各アセンブリで手動で生成されます。</font><font style="vertical-align: inherit;">たとえば</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Flywayデータベースの移行</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">直後に、このような再生成</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">が行われる場合があります</font></a><font style="vertical-align: inherit;">。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">これは、手動または自動で行うこともできます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソースコード生成</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さまざまな哲学、長所、短所が、このようなコード生成へのアプローチ（手動および自動）に関連付けられていますが、この記事では詳しく説明しません。しかし、一般に、生成されたコードの要点は、システムの内部または外部のいずれかで、当然のことと考える「真実」をJavaで再現できることです。ある意味で、バイトコード、マシンコード、またはその他の種類のソースベースのコードを生成するコンパイラは同じことを行います。特定の理由に関係なく、別の言語で「真実」の表現を取得します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのようなコードジェネレータはたくさんあります。たとえば、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XJCはXSDまたはWSDLファイルに基づいてJavaコードを生成できます</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。原則は常に同じです：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いくつかの真実（内部または外部）があります-たとえば、仕様、データモデルなど。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この真実をプログラミング言語でローカルに表現する必要があります。</font></font></li>
</ul> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、そのような表現を生成することはほとんどの場合にお勧めです-冗長性を避けるためです。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タイププロバイダーと注釈処理</font></font></h4> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注：jOOQのコード生成に対するもう1つのより近代的で具体的なアプローチ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、F＃で実装されている形式で</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の型プロバイダーの使用に関連付けられています</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">この場合、コードはコンパイラーによって、実際にはコンパイル段階で生成されます。</font><font style="vertical-align: inherit;">ソースの形では、そのようなコードは原則として存在しません。</font><font style="vertical-align: inherit;">Javaにはそれほどエレガントではありませんが、同様のツールがあります</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これらは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lombokの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ような注釈プロセッサです</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ある意味で、最初のケースと同じことがここで発生しますが、次の点が異なります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生成されたコードは表示されません（おそらく、この状況はそれほど嫌悪感のない人に思われますか？）</font></font></li>
<li>  ,    ,  , «»    .     Lombok,   “”.      ,        .</li>
</ul><br>
<h4>     ?</h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
手動または自動でコード生成を開始する方がよいというトリッキーな質問に加えて、コード生成はまったく必要ないと考えている人がいることにも触れなければなりません。私が最も頻繁に遭遇したこの観点の理論的根拠は、その場合、アセンブリパイプラインを構成することが難しいということです。はい、本当に難しいです。追加のインフラストラクチャコストがあります。特定の製品（jOOQ、JAXB、Hibernateなど）を使い始めたばかりの場合、API自体の学習に費やしたい作業環境をセットアップし、そこから価値を引き出すには時間がかかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ジェネレーターのデバイスの理解に関連するオーバーヘッドが大きすぎる場合、APIはコードジェネレーターの使いやすさについて実際に少し作業を行いました（そして将来的には、ユーザー構成が複雑になることが判明しました）。使いやすさは、このようなAPIの最優先事項です。しかし、これはコード生成に対する唯一の議論です。それ以外の場合、内部または外部の真実のローカル表現を記述することは完全に完全に手動です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの人は、これらすべてを行う時間がないと言います。スーパープロダクトの期限があります。いつか組立ラインをブラッシングして、間に合います。私はそれらに答えます：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sd/ah/5v/sdah5v4nuslp0dylmjlrvcu0qfu.png"><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Original</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alan O'Rourke、Audience Stack </font></font></a> <br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しかし、Hibernate / JPAでは「Java」用のコードを書くのはとても簡単です。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
本当に。</font><font style="vertical-align: inherit;">Hibernateとそのユーザーにとって、これは祝福と呪いの両方です。</font><font style="vertical-align: inherit;">Hibernateでは、次のようにいくつかのエンティティを記述するだけです。</font></font><br>
<br>
<pre><code class="java hljs">	<span class="hljs-meta">@Entity</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Book</span> </span>{
  <span class="hljs-meta">@Id</span>
  <span class="hljs-keyword">int</span> id;<font></font>
  String title;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、ほとんどすべての準備が整いました。</font><font style="vertical-align: inherit;">Hibernateの運命は、SQLの「方言」のDDLでこのエンティティがどのように定義されるかについての複雑な「詳細」を生成することです。</font></font><br>
<br>
<pre><code class="sql hljs">	<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> book (
  <span class="hljs-keyword">id</span> <span class="hljs-built_in">INTEGER</span> PRIMARY <span class="hljs-keyword">KEY</span> <span class="hljs-keyword">GENERATED</span> <span class="hljs-keyword">ALWAYS</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">IDENTITY</span>,<font></font>
  title <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">50</span>),<font></font>
 <font></font>
  <span class="hljs-keyword">CONSTRAINT</span> pk_book PRIMARY <span class="hljs-keyword">KEY</span> (<span class="hljs-keyword">id</span>)<font></font>
);<font></font>
 <font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> i_book_title <span class="hljs-keyword">ON</span> book (title);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...そして、アプリケーションの駆動を開始します。</font><font style="vertical-align: inherit;">すぐに始めて、さまざまなことを試す素晴らしい機会です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、許可します。</font><font style="vertical-align: inherit;">騙してた。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hibernateは本当にこの名前付きの主キーの定義を適用しますか？</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HibernateはTITLEにインデックスを作成しますか？</font><font style="vertical-align: inherit;">「私たちは彼が必要になることを確信しています。」</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hibernateはこのキーをアイデンティティー仕様で正確に識別できるようにしますか？</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
おそらく違います。</font><font style="vertical-align: inherit;">プロジェクトを最初から開発している場合は、必要な注釈を追加したらすぐに、古いデータベースを削除して新しいデータベースを生成するのが常に便利です。</font><font style="vertical-align: inherit;">したがって、Bookエンティティは最終的に次の形式になります。</font></font><br>
<br>
<pre><code class="java hljs">	<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "book", indexes = {
  @Index(name = "i_book_title", columnList = "title")
})</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Book</span> </span>{
  <span class="hljs-meta">@Id</span>
  <span class="hljs-meta">@GeneratedValue(strategy = IDENTITY)</span>
  <span class="hljs-keyword">int</span> id;<font></font>
  String title;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
涼しい。</font><font style="vertical-align: inherit;">再生成します。</font><font style="vertical-align: inherit;">この場合も、最初は非常に簡単です。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しかし、あなたはそれを支払う必要があります</font></font></h4> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
遅かれ早かれ、生産に入る必要があります。そのとき、そのようなモデルは機能しなくなります。理由：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
本番環境では、必要に応じて、古いデータベースを破棄して最初からやり直すことができなくなります。データベースはレガシーデータベースになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今後は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、たとえばFlywayを使用</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">して</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">DDL移行スクリプト</font></a><font style="vertical-align: inherit;">を作成する必要があり</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。そしてあなたの実体はどうなりますか？それらを手動で調整して（したがって、ワークロードを2倍にする）、またはHibernateにそれらを再生成するように命令することができます（この方法で生成されたものが期待に応える可能性はどれほど素晴らしいですか？）とにかく失う。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、本番環境に入るとすぐに、ホットパッチが必要になります。</font><font style="vertical-align: inherit;">そして、それらは非常に迅速に生産に投入される必要があります。</font><font style="vertical-align: inherit;">移行のためのスムーズなコンベアを本番用に準備して整理していないので、すべてを乱暴に修正しています。</font><font style="vertical-align: inherit;">そして、あなたはすべてを正しく行う時間がありません。</font><font style="vertical-align: inherit;">そして、誰もが常に責任があるが、あなたは責任がないので、Hibernateを叱る... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その代わり、最初からすべてが完全に異なる方法で行われる可能性があります。</font><font style="vertical-align: inherit;">たとえば、自転車に丸い車輪を付けます。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初にデータベース</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データベースのスキーマの真の「真実」とそれに対する「主権」は、データベースの内部にあります。</font><font style="vertical-align: inherit;">スキームはデータベース自体でのみ定義され、他の場所では定義されていません。各クライアントはこのスキームのコピーを持っているため、スキームとその整合性に準拠するように強制し、情報が格納されているデータベースで直接実行することをお勧めします。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これも昔からの知恵です。</font><font style="vertical-align: inherit;">主キーと一意キーは適切です。</font><font style="vertical-align: inherit;">外部キーは良いです。</font><font style="vertical-align: inherit;">制限をチェックすることは良いことです。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は良いです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、これだけではありません。</font><font style="vertical-align: inherit;">たとえば、Oracleを使用する場合、おそらく次のように指定する必要があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テーブルはどのテーブルスペースにありますか？ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そのPCTFREE値は何ですか？ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シーケンス内のキャッシュのサイズは何ですか（識別子の後ろ）</font></font></li>
</ul> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
おそらく、これらすべてが小規模なシステムでは重要ではありませんが、「ビッグデータ」の領域への移行を待つ必要はありません。前述のように、サプライヤによって提供されるデータストレージの最適化の恩恵を受けることは可能であり、はるかに早い時期に可能になります。</font><font style="vertical-align: inherit;">私が見たORM（jOOQを含む）はどれも、データベースで使用する可能性があるDDLオプションの完全なセットへのアクセスを提供していません。</font><font style="vertical-align: inherit;">ORMは、DDLの作成に役立ついくつかのツールを提供します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、結局のところ、適切に設計された回路は手動でDDLで記述されています。</font><font style="vertical-align: inherit;">生成されたDDLはすべて、その近似値にすぎません。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クライアントモデルはどうですか？</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のように、クライアントでは、データベーススキーマのコピーであるクライアントビューが必要になります。言うまでもなく、このクライアントビューは実際のモデルと同期する必要があります。これを達成するための最良の方法は何ですか？コードジェネレーターの使用。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのデータベースは、SQLを通じてメタ情報を提供します。データベースからSQLの異なる方言ですべてのテーブルを取得する方法は次のとおりです。</font></font><br>
<br>
<pre><code class="sql hljs">	<span class="hljs-comment">-- H2, HSQLDB, MySQL, PostgreSQL, SQL Server</span>
<span class="hljs-keyword">SELECT</span> table_schema, table_name
<span class="hljs-keyword">FROM</span> information_schema.tables<font></font>
 <font></font>
<span class="hljs-comment">-- DB2</span>
<span class="hljs-keyword">SELECT</span> tabschema, tabname
<span class="hljs-keyword">FROM</span> syscat.tables<font></font>
 <font></font>
<span class="hljs-comment">-- Oracle</span>
<span class="hljs-keyword">SELECT</span> owner, table_name
<span class="hljs-keyword">FROM</span> all_tables<font></font>
 <font></font>
<span class="hljs-comment">-- SQLite</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">name</span>
<span class="hljs-keyword">FROM</span> sqlite_master<font></font>
 <font></font>
<span class="hljs-comment">-- Teradata</span>
<span class="hljs-keyword">SELECT</span> databasename, tablename
<span class="hljs-keyword">FROM</span> dbc.tables
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのクエリ（または、表現、マテリアライズド表現、テーブル値を持つ関数も考慮する必要があるかどうかに応じて、同様のクエリ）は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>DatabaseMetaData.getTables()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、JDBCから</font><font style="vertical-align: inherit;">の呼び出し</font><font style="vertical-align: inherit;">またはjOOQメタモジュールを使用して実行されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようなクエリの結果から、クライアントで使用されているテクノロジに関係なく、データベースモデルのクライアントビューを生成することは比較的簡単です。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JDBCまたはSpringを使用する場合は、文字列定数のセットを作成できます </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JPAを使用する場合、エンティティ自体を生成できます </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jOOQを使用する場合、jOOQメタモデルを生成できます</font></font></li>
</ul> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クライアントAPI（jOOQやJPAなど）が提供する機能の数に応じて、生成されたメタモデルは本当にリッチで完全なものになります。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たとえば</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">テーブル間の外部キーの関係について生成されたメタ情報に依存する、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">jOOQ 3.11</font></a><font style="vertical-align: inherit;">に</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">現れた</font></a><font style="vertical-align: inherit;">暗黙的な結合の可能性を考えてみましょう</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、データベースをインクリメントすると、自動的にクライアントコードが更新されます。</font><font style="vertical-align: inherit;">想像してみてください：</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> book <span class="hljs-keyword">RENAME</span> <span class="hljs-keyword">COLUMN</span> title <span class="hljs-keyword">TO</span> book_title;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この仕事を2度行いますか？</font><font style="vertical-align: inherit;">どんな場合にも。</font><font style="vertical-align: inherit;">DDLを修正し、アセンブリパイプラインで実行して、更新されたエンティティを取得します。</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "book", indexes = {
 
  //    ?
  @Index(name = "i_book_title", columnList = "book_title")
})</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Book</span> </span>{
  <span class="hljs-meta">@Id</span>
  <span class="hljs-meta">@GeneratedValue(strategy = IDENTITY)</span>
  <span class="hljs-keyword">int</span> id;<font></font>
 <font></font>
  <span class="hljs-meta">@Column("book_title")</span><font></font>
  String bookTitle;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
または、更新されたjOOQクラス。</font><font style="vertical-align: inherit;">ほとんどのDDL変更は、構文だけでなくセマンティクスにも影響します。</font><font style="vertical-align: inherit;">したがって、データベースの増分によってどのコードが影響を受ける（または影響を受ける可能性がある）かをコンパイル済みコードで確認すると便利です。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">唯一の真実</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用するテクノロジーに関係なく、サブシステムの唯一の真実の源であるモデルは常に1つあります。少なくとも、「真実」がどこにでもどこにでもあるという、企業の混乱を避けるために努力する必要があります。</font><font style="vertical-align: inherit;">すべてがはるかに単純になる可能性があります。</font><font style="vertical-align: inherit;">XMLファイルを他のシステムと交換するだけの場合は、XSDを使用してください。</font><font style="vertical-align: inherit;">XML形式のjOOQからのINFORMATION_SCHEMAメタモデルを見て</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ください</font></a><font style="vertical-align: inherit;">：</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">https</font></a><font style="vertical-align: inherit;"> ://www.jooq.org/xsd/jooq-meta-3.10.0.xsd</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XSDはよく理解されている</font></font></li>
<li>XSD     XML         </li>
<li>XSD        </li>
<li>XSD     Java   XJC</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後のポイントは重要です。</font><font style="vertical-align: inherit;">XMLメッセージを使用して外部システムと通信する場合、メッセージの有効性を確認する必要があります。</font><font style="vertical-align: inherit;">これは、JAXB、XJC、およびXSDで非常に簡単に実現できます。</font><font style="vertical-align: inherit;">メッセージをJavaオブジェクトの形式で作成する「Javaファースト」の設計に近づくと、メッセージが何らかの形でXMLに明確に表示され、別のシステムに送信するために送信される可能性があることを期待するのはまったく正気ではありません。</font><font style="vertical-align: inherit;">この方法で生成されたXMLは品質が非常に低く、文書化されておらず、開発が困難です。</font><font style="vertical-align: inherit;">そのようなインターフェースでのサービス品質（SLA）のレベルについて合意があった場合は、すぐにそれを台無しにします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
正直なところ、それはAPIからJSONまで常に発生していることですが、それはまた別の話です。次回は誓います...</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データベース：同じことです</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データベースを操作する場合、原則として類似していることを理解しています。基地はデータを所有しており、スキームを管理する必要があります。単一の真の情報源を更新するには、回路に加えられた変更をDDLに直接実装する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ソースの更新が発生すると、すべてのクライアントがモデルのコピーも更新する必要があります。一部のクライアントは、jOOQおよびHibernateまたはJDBCを使用して（または一度にすべて）Javaで作成できます。他のクライアントはPerlで書くことができ（幸運を祈る必要はあります）、他のクライアントはC＃で書くことができます。それはどうでもいい事です。メインモデルはデータベースにあります。通常品質が低いORMを使用して生成されたモデルは、十分に文書化されておらず、開発が困難です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、間違えないでください。</font><font style="vertical-align: inherit;">最初から間違いをしないでください。</font><font style="vertical-align: inherit;">データベースから作業します。</font><font style="vertical-align: inherit;">自動化できるデプロイメントパイプラインを構築します。</font><font style="vertical-align: inherit;">コードジェネレーターをオンにすると、データベースモデルをコピーしてクライアントにダンプするのが簡単になります。</font><font style="vertical-align: inherit;">コードジェネレーターについて心配する必要はありません。</font><font style="vertical-align: inherit;">彼らは良いです。</font><font style="vertical-align: inherit;">それらを使用すると、より生産的になります。</font><font style="vertical-align: inherit;">最初から少し時間をかけて構成するだけで済みます。そうすれば、プロジェクトの履歴を形成する生産性が何年も向上します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それまでは、よろしくお願いします。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
明確にするために：この記事では、データベースのモデルの下でシステム全体（つまり、サブジェクトエリア、ビジネスロジックなど）を曲げる必要があるとは決して主張していません。</font><font style="vertical-align: inherit;">この記事では、データベースと対話するクライアントコードは、データベースモデルに基づいて動作する必要があるため、「ファーストクラス」ステータスのデータベースモデルが再現されないようにしなければなりません。</font><font style="vertical-align: inherit;">このロジックは通常、クライアント上のデータアクセスのレベルにあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一部の場所にまだ保存されている2層アーキテクチャでは、そのようなシステムモデルが唯一の可能なモデルである場合があります。</font><font style="vertical-align: inherit;">ただし、ほとんどのシステムでは、データアクセスのレベルは、データベースモデルをカプセル化する「サブシステム」のようです。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例外</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ルールには例外があり、データベースのプライマシーとソースコードの生成を伴うアプローチは不適切な場合があることはすでに述べました。</font><font style="vertical-align: inherit;">そのような例外がいくつかあります（おそらく他にもあります）。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回路が不明で、開いている必要がある場合。</font><font style="vertical-align: inherit;">たとえば、あなたはユーザーがスキームをナビゲートするのを助けるツールのプロバイダーです。</font><font style="vertical-align: inherit;">ふew </font><font style="vertical-align: inherit;">コード生成はありません。</font><font style="vertical-align: inherit;">しかし、それでも-データベースは何よりも重要です。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特定の問題を解決するために回路をオンザフライで生成する必要がある場合。</font><font style="vertical-align: inherit;">この例は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エンティティ属性値</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パターンの少し空想的なバージョンのよう</font><font style="vertical-align: inherit;">です。つまり、明確に定義されたスキーマが実際にはありません。</font><font style="vertical-align: inherit;">この場合、RDBMSが適切かどうかを確認することはほとんど不可能です。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例外は本質的に例外的です。</font><font style="vertical-align: inherit;">RDBMSの使用を伴うほとんどの場合、スキームは事前に知られており、RDBMS内にあり、「真実」の唯一のソースであり、すべての顧客はそれから派生したコピーを取得する必要があります。</font><font style="vertical-align: inherit;">理想的には、コードジェネレーターを使用する必要があります。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja498798/index.html">JetBrainsで学習と学習を続ける</a></li>
<li><a href="../ja498800/index.html">OpenCVとディープラーニングでDobbleをプレイするようにコンピューターに教えた方法</a></li>
<li><a href="../ja498808/index.html">KubernetesのYAMLサポートを備えたVim</a></li>
<li><a href="../ja498810/index.html">元の（いいえ）コントローラーでレトロコンソールを実行したとき</a></li>
<li><a href="../ja498814/index.html">あなたは社会保障に関する理論的な質問に失敗し、彼らはあなたに終止符を打った。これは正常です？//私たちは運命にある＃3</a></li>
<li><a href="../ja498820/index.html">.NETとCに関するさらにトリッキーな質問＃</a></li>
<li><a href="../ja498822/index.html">4人用のアーケードマシンをゼロから開発および作成</a></li>
<li><a href="../ja498826/index.html">SILとSalesforce</a></li>
<li><a href="../ja498828/index.html">食塩とタンパク質がインプラントの生存率をどのように高めるか</a></li>
<li><a href="../ja498830/index.html">ハッシュ+キャッシュ：ストリーム処理の最適化</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>