<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ˜ âœŒğŸ¼ ğŸ•´ğŸ¼ ç´ æ™´ã‚‰ã—ã„ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã€volã€‚2.ç·´ç¿’ ğŸ¤›ğŸ¼ ğŸ ğŸ³ï¸â€ğŸŒˆ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ã“ã“ã§ã¯ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã®ç†è«–ã«é–¢ã™ã‚‹æœ€åˆã®è¨˜äº‹ã‚’èª­ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚
 

ã“ã®éƒ¨åˆ†ã§ã¯ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ä½œæˆä¸­ã«ç™ºç”Ÿã—ãŸå•é¡Œã¨ã€ãã‚Œã‚‰ã‚’è§£æ±ºã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚
 
 ä½•ã«ã¤ã„ã¦è©±ã—ã¾ã™ã‹ï¼Ÿ
 

- å®Ÿç”¨çš„ãªéƒ¨åˆ† ãƒãƒ«ãƒãƒšãƒ¼ã‚¸UI ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®DI ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´ 
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ç´ æ™´ã‚‰ã—ã„ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã€volã€‚2.ç·´ç¿’</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/hh/blog/463611/"><p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã“</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§ã¯ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã®ç†è«–ã«é–¢ã™ã‚‹æœ€åˆã®è¨˜äº‹ã‚’èª­ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã®éƒ¨åˆ†ã§ã¯ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ä½œæˆä¸­ã«ç™ºç”Ÿã—ãŸå•é¡Œã¨ã€ãã‚Œã‚‰ã‚’è§£æ±ºã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚</font></font><br>
<img src="https://habrastorage.org/webt/db/cn/c-/dbcnc-m5gfz68a0hpvnt2qjdcgw.png" alt="ç”»åƒ"></p><a name="habracut"></a><br>
<h1 id="o-chem-budu-govorit"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½•ã«ã¤ã„ã¦è©±ã—ã¾ã™ã‹ï¼Ÿ</font></font></h1><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®Ÿç”¨çš„ãªéƒ¨åˆ†</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒãƒ«ãƒãƒšãƒ¼ã‚¸UI</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®DI</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´</font></font></li>
</ul></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¬¡ã¯ã©ã†ã™ã‚‹ï¼Ÿ</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŠ©è¨€</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚ˆãã‚ã‚‹è³ªå•</font></font></li>
</ul></li>
</ul><br>
<h2 id="mnogostranichnyy-ui"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒãƒ«ãƒãƒšãƒ¼ã‚¸UI</font></font></h2><br>
<p>       UI.        ,  .        ,       .       application-,      . </p><br>
<p>        ,     ,   . , Wizard-.</p><br>
<p><img src="https://habrastorage.org/webt/hd/jw/wf/hdjwwfojlb6w7gj_sacdswi802g.png" alt="ç”»åƒ"></p><br>
<p>    UI    ,   - .    IDEA   ,   <em>WizardDialog</em>. </p><br>
<p><img src="https://habrastorage.org/webt/tl/gr/6z/tlgr6ztp3yro6-yyyqyhjsd55ky.png" alt="ç”»åƒ"></p><br>
<p> -   ,       wizard-,     (Previous, Next, Finish, etc).  WizardDialog-   <em>WizardModel</em>,     WizardStep-.  <em>WizardStep</em>    . </p><br>
<p>        :</p><br>
<div class="spoiler"><b class="spoiler_title">WizardDialog</b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyWizardDialog</span></span>(<font></font>
    model: MyWizardModel,<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> onFinishButtonClickedListener: (MyWizardModel) -&gt; <span class="hljs-built_in">Unit</span> 
): WizardDialog&lt;MyWizardModel&gt;(<span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>, model) {<font></font>
<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onWizardGoalAchieved</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onWizardGoalAchieved()<font></font>
        onFinishButtonClickedListener.invoke(myModel)<font></font>
    }<font></font>
<font></font>
} </code></pre></div></div><br>
<p>   <em>WizardDialog</em>,    <em>WizardModel</em>.      callback (<em>onWizardGoalAchieved</em>),   ,    wizard       â€œFinishâ€.<br>
 ,          <em>WizardModel</em>.  ,   ,       wizard-,     <em>WizardModel</em>. </p><br>
<div class="spoiler"><b class="spoiler_title">WizardModel</b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyWizardModel</span>: <span class="hljs-type">WizardModel</span></span>(<span class="hljs-string">"Title for my wizard"</span>) {<font></font>
<font></font>
    <span class="hljs-keyword">init</span> {
        <span class="hljs-keyword">this</span>.add(MyWizardStep1())
        <span class="hljs-keyword">this</span>.add(MyWizardStep2())
        <span class="hljs-keyword">this</span>.add(MyWizardStep3())<font></font>
    }<font></font>
<font></font>
}</code></pre></div></div><br>
<p>   :    <em>WizardModel</em>      <em>add</em>     <em>WizardStep</em>-.</p><br>
<div class="spoiler"><b class="spoiler_title">WizardStep</b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyWizardStep1</span>: <span class="hljs-type">WizardStep</span>&lt;<span class="hljs-type">MyWizardModel</span>&gt;</span>() {<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> contentPanel: JPanel<font></font>
<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">prepare</span><span class="hljs-params">(state: <span class="hljs-type">WizardNavigationState</span>?)</span></span>: JComponent {
        <span class="hljs-keyword">return</span> contentPanel<font></font>
    }<font></font>
<font></font>
}</code></pre></div></div><br>
<p><em>WizardStep</em>-   :    <em>WizardStep</em>,    -, , ,   prepare,       . </p><br>
<p>      .    ,  ,     - :</p><br>
<p><img src="https://habrastorage.org/webt/as/6d/mc/as6dmcznqssdt7zwhdz7ndebuv8.png" alt="ç”»åƒ"></p><br>
<p>    ,     Android   ,   Clean Architecture, MVP       Activity.       ,     ,       .</p><br>
<h3 id="vyvod"></h3><br>
<p>    UI,  <em>WizardDialog</em> â€“  .</p><br>
<p>    â€“ DI  .</p><br>
<h2 id="di-v-plaginah">DI  </h2><br>
<p>    Dependency Injection  ?<br>
  â€“    .</p><br>
<p> ,    -   ?  â€“    ,   â€“  , .<br>
,  .<br>
   ,     ,       .  DI   . </p><br>
<p>,   , â€“   DI    ,    .    event bus-, logger-   .</p><br>
<p>  ,      DI- (Spring, Dagger, etc),  IntelliJ IDEA    DI-,       ,     : <em>Application</em>, <em>Project</em>  <em>Module</em>.</p><br>
<p><img src="https://habrastorage.org/webt/ix/kh/dk/ixkhdkerqkc0sapkdvgj5qsg_44.png" alt="ç”»åƒ"></p><br>
<p>       ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><em>Component</em></a>.          .  <em>ApplicationComponent</em>       <em>Application</em>,  <em>ProjectComponent</em>   <em>Project</em>,   .</p><br>
<p>  ,   DI-?</p><br>
<p>-,  ,         â€“ , ,   <em>ApplicationComponent</em>,  <em>ProjectComponent</em>,  <em>ModuleComponent</em>.          ,    .  , ,  <em>ProjectComponent</em>      <em>Project</em>. </p><br>
<div class="spoiler"><b class="spoiler_title"> -</b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAppComponent</span></span>(
    <span class="hljs-keyword">val</span> application: Application,
    <span class="hljs-keyword">val</span> anotherApplicationComponent: AnotherAppComponent<font></font>
): ApplicationComponent<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyProjectComponent</span></span>(
    <span class="hljs-keyword">val</span> project: Project,
    <span class="hljs-keyword">val</span> anotherProjectComponent: AnotherProjectComponent,
    <span class="hljs-keyword">val</span> myAppComponent: MyAppComponent<font></font>
): ProjectComponent<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyModuleComponent</span></span>(
    <span class="hljs-keyword">val</span> module: Module,
    <span class="hljs-keyword">val</span> anotherModuleComponent: AnotherModuleComponent,
    <span class="hljs-keyword">val</span> myProjectComponent: MyProjectComponent,
    <span class="hljs-keyword">val</span> myAppComponent: MyAppComponent<font></font>
): ModuleComponent</code></pre></div></div><br>
<p>-,           .  , ,  <em>ProjectComponent</em>     <em>ProjectComponent</em>  <em>ApplicationComponent</em>.          "" . </p><br>
<p>  IDEA ,       ,          . </p><br>
<p> ,    , â€“     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><em>plugin.xml</em></a>.       Component- (, <em>ApplicationComponent</em>), IDEA       plugin.xml. </p><br>
<div class="spoiler"><b class="spoiler_title">   plugin.xml</b><div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">idea-plugin</span>&gt;</span><font></font>
<font></font>
    ...<font></font>
    <span class="hljs-tag">&lt;<span class="hljs-name">project-components</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">component</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">interface-class</span>&gt;</span><font></font>
                com.experiment.MyProjectComponent<font></font>
            <span class="hljs-tag">&lt;/<span class="hljs-name">interface-class</span>&gt;</span><font></font>
<font></font>
            <span class="hljs-tag">&lt;<span class="hljs-name">implementation-class</span>&gt;</span><font></font>
                com.experiments.MyProjectComponentImpl<font></font>
            <span class="hljs-tag">&lt;/<span class="hljs-name">implementation-class</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">project-components</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;/<span class="hljs-name">idea-plugin</span>&gt;</span></code></pre></div></div><br>
<p>  ?    <em>&lt;project-component&gt;</em> (<em>&lt;application-component&gt;</em>, <em>&lt;module-component&gt;</em> â€“    ).     <em>,     : <em>&lt;interface-class&gt;</em>,      ,  <em>&lt;implementation-class&gt;</em>,    .          ,    ,      <em>&lt;implementation-class&gt;</em>. </em><br>
</p><p> ,   , â€“     ,   <em>ApplicationComponent</em>    <em>Application</em>, <em>ProjectComponent</em> â€“  <em>Project</em>  .. </p><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">val</span> myAppComponent = application.getComponent(MyAppComponent::<span class="hljs-keyword">class</span>.java) <font></font>
<font></font>
<span class="hljs-keyword">val</span> myProjectComponent = project.getComponent(MyProjectComponent::<span class="hljs-keyword">class</span>.java) <font></font>
<font></font>
<span class="hljs-keyword">val</span> myModuleComponent = module.getComponent(MyModuleComponent::<span class="hljs-keyword">class</span>.java) </code></pre></div></div><br>
<h3 id="vyvody"></h3><br>
<ol>
<li> IDEA  DI- â€“     :  Dagger,  Spring. , ,  .</li>
<li>   DI      ,    .</li>
</ol><br>
<p>    â€“  . </p><br>
<h2 id="generaciya-koda"> </h2><br>
<p>,  -        ?  ,     ,    : , , .           ,        . </p><br>
<h3 id="shablony"></h3><br>
<p>      ?  .         ,      . </p><br>
<div class="spoiler"><b class="spoiler_title">  build.gradle </b><div class="spoiler_text"><pre><code class="java hljs">apply plugin: <span class="hljs-string">'com.android.library'</span><font></font>
<font></font>
&lt;<span class="hljs-keyword">if</span> (isKotlinProject) {<font></font>
    apply plugin: <span class="hljs-string">'kotlin-android'</span>
    apply plugin: <span class="hljs-string">'kotlin-kapt'</span><font></font>
<font></font>
    &lt;<span class="hljs-keyword">if</span> (isModuleWithUI) {<font></font>
        apply plugin: <span class="hljs-string">'kotlin-android-extensions'</span><font></font>
    }&gt;<font></font>
}&gt;<font></font>
<font></font>
...<font></font>
android {<font></font>
    ...<font></font>
    &lt;<span class="hljs-keyword">if</span> (isMoxyEnabled) {<font></font>
        kapt {<font></font>
         arguments {<font></font>
             arg(<span class="hljs-string">"moxyReflectorPackage"</span>, <span class="hljs-string">'&lt;include var="packageName"&gt;'</span>)<font></font>
         }<font></font>
        }<font></font>
    }&gt;<font></font>
    ...<font></font>
}<font></font>
<font></font>
...<font></font>
dependencies {<font></font>
    <span class="hljs-function">compileOnly <span class="hljs-title">project</span><span class="hljs-params">(<span class="hljs-string">':common'</span>)</span>
    compileOnly <span class="hljs-title">project</span><span class="hljs-params">(<span class="hljs-string">':core-utils'</span>)</span>

    &lt;<span class="hljs-title">for</span> <span class="hljs-params">(moduleName in enabledModules)</span> </span>{
        <span class="hljs-function">compileOnly <span class="hljs-title">project</span><span class="hljs-params">(<span class="hljs-string">'&lt;include var="moduleName"&gt;'</span>)</span>
    }&gt;
    ...
}</span></code></pre></div></div><br>
<p>:         .  :   -    UI,     Gradle- <em>kotlin-android-extensions</em>. </p><br>
<div class="spoiler"><b class="spoiler_title">  </b><div class="spoiler_text"><pre><code class="java hljs">&lt;<span class="hljs-keyword">if</span> (isKotlinProject) {<font></font>
    apply plugin: <span class="hljs-string">'kotlin-android'</span>
    apply plugin: <span class="hljs-string">'kotlin-kapt'</span><font></font>
<font></font>
    &lt;<span class="hljs-keyword">if</span> (isModuleWithUI) {<font></font>
        apply plugin: <span class="hljs-string">'kotlin-android-extensions'</span><font></font>
    }&gt;<font></font>
}&gt;</code></pre></div></div><br>
<p> ,   , â€“      . ,    kapt  Moxy,         annotation processor-.</p><br>
<div class="spoiler"><b class="spoiler_title">    </b><div class="spoiler_text"><pre><code class="java hljs">kapt {<font></font>
    arguments {<font></font>
        arg(<span class="hljs-string">"moxyReflectorPackage"</span>, <span class="hljs-string">'&lt;include var="packageName"&gt;'</span>)<font></font>
    }<font></font>
}</code></pre></div></div><br>
<p>  ,   , â€“     .  ,     ,       ?             .</p><br>
<div class="spoiler"><b class="spoiler_title">   </b><div class="spoiler_text"><pre><code class="java hljs">&lt;<span class="hljs-keyword">for</span> (moduleName in enabledModules) {
    <span class="hljs-function">compileOnly <span class="hljs-title">project</span><span class="hljs-params">(<span class="hljs-string">'&lt;include var="moduleName"&gt;'</span>)</span>
}&gt;</span></code></pre></div></div><br>
<p> ,       :</p><br>
<ul>
<li>  </li>
<li>   </li>
<li>    </li>
</ul><br>
<h3 id="generatory-koda"> </h3><br>
<p>     ? , ,     .  , ,   Uber-:   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   </a> (    ).   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a>,       .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>.   ,     .</p><br>
<p>  â€“    IDEA   <em>FileTemplateManager</em>,       .        â€“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Velocity</a>,        Java-  .  , <em>FileTemplateManager</em>      ,   Java  XML.       Groovy-, Kotlin, Proguard    .</p><br>
<p>  â€¦ <em>FreeMarker</em>.       <em>FreeMarker</em>,     â€“      . </p><br>
<p>  ,   <em>FreeMarker</em>  ? -,   .     <em>/templates</em>   <em>/resources</em>          â€“ ,   .. </p><br>
<p><img src="https://habrastorage.org/webt/gk/ww/fe/gkwwfelyl443hdze6vd6a99ecmw.png" alt="ç”»åƒ"></p><br>
<p>        FreeMarker.    Gradle,     . </p><br>
<div class="spoiler"><b class="spoiler_title">    FreeMarker</b><div class="spoiler_text"><pre><code class="java hljs">dependencies {<font></font>
    ...<font></font>
    compile <span class="hljs-string">'org.freemarker:freemarker:2.3.28'</span>
}</code></pre></div></div><br>
<p>   FreeMarker   .       â€“  , ,  ,    . </p><br>
<div class="spoiler"><b class="spoiler_title"> FreeMarker</b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TemplatesFactory</span></span>(<span class="hljs-keyword">val</span> project: Project) : ProjectComponent {<font></font>
<font></font>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> freeMarkerConfig <span class="hljs-keyword">by</span> lazy {<font></font>
      Configuration(Configuration.VERSION_2_3_28).apply {<font></font>
          setClassForTemplateLoading(<font></font>
              TemplatesFactory::<span class="hljs-keyword">class</span>.java, 
              <span class="hljs-string">"/templates"</span>            <font></font>
          )<font></font>
<font></font>
          defaultEncoding = Charsets.UTF_8.name()<font></font>
          templateExceptionHandler = TemplateExceptionHandler.RETHROW_HANDLER<font></font>
          logTemplateExceptions = <span class="hljs-literal">false</span>
          wrapUncheckedExceptions = <span class="hljs-literal">true</span><font></font>
      }<font></font>
  }<font></font>
<font></font>
...</code></pre></div></div><br>
<p>     <em>FreeMarker</em>.               <em>FileWriter</em>        . </p><br>
<div class="spoiler"><b class="spoiler_title">   FileWriter</b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TemplatesFactory</span></span>(<span class="hljs-keyword">val</span> project: Project) : ProjectComponent {<font></font>
...<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">generate</span><span class="hljs-params">(
    pathToFile: <span class="hljs-type">String</span>, 
    templateFileName: <span class="hljs-type">String</span>, 
    <span class="hljs-keyword">data</span>: <span class="hljs-type">Map</span>&lt;<span class="hljs-type">String</span>, Any&gt;
  )</span></span> {
      <span class="hljs-keyword">val</span> template = freeMarkerConfig.getTemplate(templateFileName)<font></font>
<font></font>
      FileWriter(pathToFile, <span class="hljs-literal">false</span>).use { writer -&gt;<font></font>
          template.process(<span class="hljs-keyword">data</span>, writer)<font></font>
      }<font></font>
  }<font></font>
<font></font>
}</code></pre></div></div><br>
<p>    ,  .     ,   PSI   IDEA,    .         PSI (,  FileWriter),  IDEA   ,   -        .     ,   IDEA     . </p><br>
<p> â€“  ,  ,   PSI.</p><br>
<h3 id="sozdaem-psi-strukturu-dlya-faylov"> PSI-  </h3><br>
<p>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">PsiDirectory</a>.        extension- <em>guessProjectDir</em>  <em>toPsiDirectory</em>:</p><br>
<div class="spoiler"><b class="spoiler_title"> PsiDirectory </b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">val</span> projectPsiDirectory = project.guessProjectDir()?.toPsiDirectory(project)</code></pre></div></div><br>
<p>         <em>PsiDirectory</em> <em>findSubdirectory</em>,    <em>createSubdirectory</em>.</p><br>
<div class="spoiler"><b class="spoiler_title">   PsiDirectory</b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">val</span> coreModuleDir = projectPsiDirectory.findSubdirectory(<span class="hljs-string">"core"</span>)
<span class="hljs-keyword">val</span> newModulePsiDir = coreModuleDir.createSubdirectory(config.mainParams.moduleName)</code></pre></div></div><br>
<p>     <em>Map</em>-,         <em>PsiDirectory</em>  ,          .</p><br>
<div class="spoiler"><b class="spoiler_title"> Map-  </b><div class="spoiler_text"><p>return mutableMapOf&lt;String, PsiDirectory?&gt;().apply {<br>
this["root"] = modulePsiDir<br>
this["src"]= modulePsiDir.createSubdirectory("src")<br>
this["main"] = this["src"]?.createSubdirectory("main")<br>
this["java"] = this["main"]?.createSubdirectory("java")<br>
this["res"] = this["main"]?.createSubdirectory("res")</p><br>
<pre><code class="plaintext hljs">//   PsiDirectory   package name:<font></font>
// ru.hh.feature_worknear â†’ ru / hh / feature_worknear<font></font>
createPackageNameFolder(config) <font></font>
<font></font>
// data<font></font>
this["data"] = this["package"]?.createSubdirectory("data")<font></font>
<font></font>
// ...</code></pre><br>
<p>}</p></div></div><br>
<p> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">PsiFile</a>-    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">PsiFileFactory</a>.      ,   <em>createFileFromText</em>.      :  (String fileName),  (String text)   (FileType fileType) output-.       :    ,    FreeMarker-.    <em>FileType</em>?    ?</p><br>
<h3 id="filetype">FileType</h3><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><em>FileType</em></a> â€“   ,   .  â€œâ€     FileType-: JavaFileType  XmlFileType,   Java-  XML-.   :     <em>build.gradle</em> ,  <em>Kotlin</em>-,  <em>Proguard</em>,  <em>.gitignore</em>, ?! </p><br>
<p>-,    <em>FileType</em>-     ,   - . GroovyFileType    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Groovy-</a>, KotlinFileType â€“  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Kotlin-</a>, Proguard â€“  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Android-</a>.</p><br>
<p>       ?   <em>gradle-intellij-plugin</em>.    build.gradle     intellij,,      â€“ <em>plugins</em>.        ,     . </p><br>
<div class="spoiler"><b class="spoiler_title">    </b><div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-comment">// build.gradle </span><font></font>
<font></font>
intellij {<font></font>
    â€¦<font></font>
    plugins = [<span class="hljs-string">'android'</span>, <span class="hljs-string">'Groovy'</span>, <span class="hljs-string">'kotlin'</span>]<font></font>
}</code></pre></div></div><br>
<p>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  JetBrains</a>.    IDEA  (  Groovy, Kotlin  Android)      IDEA.             JetBrains,     <em>Plugin XML ID</em>,    (,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> Docker-</a>).      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  GitHub-</a>. </p><br>
<p>-,       <em>plugin.xml</em>.      <em>.</em><br>
</p><div class="spoiler"><b class="spoiler_title">   plugin.xml</b><div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">idea-plugin</span>&gt;</span><font></font>
<font></font>
    ...<font></font>
<font></font>
    <span class="hljs-tag">&lt;<span class="hljs-name">depends</span>&gt;</span>org.jetbrains.android<span class="hljs-tag">&lt;/<span class="hljs-name">depends</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">depends</span>&gt;</span>org.jetbrains.kotlin<span class="hljs-tag">&lt;/<span class="hljs-name">depends</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">depends</span>&gt;</span>org.intellij.groovy<span class="hljs-tag">&lt;/<span class="hljs-name">depends</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;/<span class="hljs-name">idea-plugin</span>&gt;</span></code></pre></div></div><br>
<p> ,   ,       ,     .</p><br>
<p> ,        ?            .     ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><em>Language</em></a>.           (   â€“ <strong>"ru.hh.plugins.Ignore"</strong>). </p><br>
<div class="spoiler"><b class="spoiler_title">   GitIgnore-</b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IgnoreLanguage</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">constructor</span></span>() <font></font>
    : Language(<span class="hljs-string">"ru.hh.plugins.Ignore"</span>, <span class="hljs-string">"ignore"</span>, <span class="hljs-literal">null</span>), <font></font>
      InjectableLanguage {<font></font>
<font></font>
    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {
        <span class="hljs-keyword">val</span> INSTANCE = IgnoreLanguage()<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getDisplayName</span><span class="hljs-params">()</span></span>: String {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Ignore() (<span class="hljs-variable">$id</span>)"</span><font></font>
    }<font></font>
}</code></pre></div></div><br>
<p>  :        . -         .  ,    .</p><br>
<p> ,     ,    <em>Language</em>, â€“  <em>FileType</em>.    <em>LanguageFileType</em>,     ,   ,     . .       <em>FileType</em>.</p><br>
<div class="spoiler"><b class="spoiler_title">  FileType  .gitignore</b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IgnoreFileType</span></span>(language: Language) : LanguageFileType(language) {<font></font>
<font></font>
    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {
        <span class="hljs-keyword">val</span> INSTANCE = IgnoreFileType(IgnoreLanguage.INSTANCE)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getName</span><span class="hljs-params">()</span></span>: String = <span class="hljs-string">"gitignore file"</span><font></font>
<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getDescription</span><span class="hljs-params">()</span></span>: String = <span class="hljs-string">"gitignore files"</span><font></font>
<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getDefaultExtension</span><span class="hljs-params">()</span></span>: String = <span class="hljs-string">"gitignore"</span><font></font>
<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getIcon</span><span class="hljs-params">()</span></span>: Icon? = <span class="hljs-literal">null</span><font></font>
<font></font>
}<font></font>
</code></pre></div></div><br>
<h3 id="zavershaem-sozdanie-fayla">  </h3><br>
<p>       <em>FileType</em>-,        <em>TemplateData</em> â€“         ,      .      -,  <em>output</em>-,      ,  <em>FileType</em> , , <em>PsiDirectory</em>,     . </p><br>
<div class="spoiler"><b class="spoiler_title">TemplateData</b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">data</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TemplateData</span></span>(
    <span class="hljs-keyword">val</span> templateFileName: String,
    <span class="hljs-keyword">val</span> outputFileName: String,
    <span class="hljs-keyword">val</span> outputFileType: FileType,
    <span class="hljs-keyword">val</span> outputFilePsiDirectory: PsiDirectory?<font></font>
)</code></pre></div></div><br>
<p>   <em>FreeMarker</em>- â€“    -,   <em>StringWriter</em>  ,  <em>PsiFileFactory</em>  <em>PsiFile</em>     .      . </p><br>
<div class="spoiler"><b class="spoiler_title"> PsiFile   </b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">createFromTemplate</span><span class="hljs-params">(<span class="hljs-keyword">data</span>: <span class="hljs-type">FileTemplateData</span>, properties: <span class="hljs-type">Map</span>&lt;<span class="hljs-type">String</span>, Any&gt;)</span></span>: PsiFile {
    <span class="hljs-keyword">val</span> template = freeMarkerConfig.getTemplate(<span class="hljs-keyword">data</span>.templateFileName)<font></font>
<font></font>
    <span class="hljs-keyword">val</span> text = StringWriter().use { writer -&gt;<font></font>
        template.process(properties, writer)<font></font>
        writer.buffer.toString()<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">return</span> psiFileFactory.createFileFromText(<span class="hljs-keyword">data</span>.outputFileName, <span class="hljs-keyword">data</span>.outputFileType, text)<font></font>
}</code></pre></div></div><br>
<p>  PSI- ,  IDEA,     ,   .     : ,    Git ,     ,       :         Git?</p><br>
<h3 id="vyvody-pro-generaciyu-koda">   </h3><br>
<ul>
<li>    FreeMarker-.  .</li>
<li>     PSI-,     .</li>
<li>       PsiFileFactory,   -  FileType-.</li>
</ul><br>
<p>     ,     â€“   .</p><br>
<h2 id="modifikaciya-koda"> </h2><br>
<p>         â€“ ,        ,    <em>FreeMarker</em>-.    <em>FreeMarker</em>-   â€“    . </p><br>
<p>  -   ,    ,     â€”  <em>settings.gradle</em> . </p><br>
<h3 id="modifikaciya-settingsgradle"> settings.gradle</h3><br>
<p>,    :        ,        :</p><br>
<div class="spoiler"><b class="spoiler_title">   </b><div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-comment">// settings.gradle</span><font></font>
<font></font>
include <span class="hljs-string">':analytics
project('</span>:analytics<span class="hljs-string">').projectDir = new File(settingsDir, '</span>core/framework-metrics/analytics)<font></font>
<font></font>
...<font></font>
<font></font>
include <span class="hljs-string">':feature-worknear'</span>
project(<span class="hljs-string">':feature-worknear'</span>).projectDir = <span class="hljs-keyword">new</span> File(settingsDir, <span class="hljs-string">'feature/feature-worknear'</span>)</code></pre></div></div><br>
<p>    ,      PSI-,    ,  <del> </del>  .   ,   ,       ,    .  -    ,   <em>java.io.File</em>.       ,   <em>java.io.File</em>,     <em>extension</em>-       .   , IDEA   . </p><br>
<div class="spoiler"><b class="spoiler_title">   settings.gradle </b><div class="spoiler_text"><p>val projectBaseDirPath = project.basePath ?: return<br>
val settingsPathFile = projectBaseDirPath + "/settings.gradle"</p><br>
<p>val settingsFile = File(settingsPathFile)</p><br>
<p>settingsFile.appendText("include ':$moduleName'")<br>
settingsFile.appendText(<br>
"project(':$moduleName').projectDir = new File(settingsDir, '$folderPath')"<br>
)</p></div></div><br>
<p>   , ,   PSI- â€“  .</p><br>
<h3 id="donastroyka-kapt-a-dlya-toothpick"> kapt-  Toothpick</h3><br>
<p>  :  application-  <em>build.gradle</em> ,    â€“  annotation-.           . </p><br>
<div class="spoiler"><b class="spoiler_title">-?..</b><div class="spoiler_text"><p><img src="https://habrastorage.org/webt/jt/hv/1b/jthv1bxuiigvexnvwnrvzs41wh8.png" alt="image"></p></div></div><br>
<p>  â€“   <em>PsiElement</em>,       .      <em>PsiFile</em>-,   <em>build.gradle</em>  application-.      ,     .</p><br>
<div class="spoiler"><b class="spoiler_title">   </b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">val</span> appModule = ModuleManager.getInstance(project)<font></font>
                     .modules.toList()<font></font>
                     .first { it.name == <span class="hljs-string">"headhunter-applicant"</span> }</code></pre></div></div><br>
<p>     <em>FilenameIndex</em>   <em>PsiFile</em>   ,       .</p><br>
<div class="spoiler"><b class="spoiler_title"> PsiFile  </b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">val</span> buildGradlePsiFile = FilenameIndex.getFilesByName(<font></font>
                             appModule.project, <font></font>
                             <span class="hljs-string">"build.gradle"</span>, <font></font>
                             appModule.moduleContentScope<font></font>
                         ).first() </code></pre></div></div><br>
<p>     PsiFile,     PsiElement-.   ,      â€“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">PSI Viewer</a>.     IDEA  ,    PSI-  .</p><br>
<p><img src="https://habrastorage.org/webt/sd/nl/ac/sdnlac9nrqcqqt14wtrhohr9pf8.png" alt="ç”»åƒ"></p><br>
<p>   -  (, build.gradle)        ,      PSI-   .</p><br>
<p><img src="https://habrastorage.org/webt/gt/et/xo/gtetxo8_4hbk0gzzfty7p_zmawu.png" alt="ç”»åƒ"></p><br>
<p>   â€“   ,        <em>PsiFile</em>-.</p><br>
<p>   .   <em>PsiFile</em>.            .</p><br>
<div class="spoiler"><b class="spoiler_title">  PsiElement</b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">val</span> toothpickRegistryPsiElement = buildGradlePsiFile.originalFile<font></font>
    .collectDescendantsOfType&lt;GrAssignmentExpression&gt;()<font></font>
    .firstOrNull { it.text.startsWith(<span class="hljs-string">"arguments"</span>) }<font></font>
    ?.lastChild<font></font>
    ?.children?.firstOrNull { it.text.startsWith(<span class="hljs-string">"toothpick_registry_children_package_names"</span>) }<font></font>
    ?.collectDescendantsOfType&lt;GrListOrMap&gt;()<font></font>
    ?.first()<font></font>
    ?: <span class="hljs-keyword">return</span></code></pre></div></div><br>
<p><del> ?..</del>   ?          PSI-.        <em>GrAssignmentExpression</em>,   ,    <em>arguments = [ â€¦ ]</em>.      ,      <em>toothpick_registry_children_package_names = [...]</em>,       Groovy-.</p><br>
<p>   <em>PsiElement</em>,   .            .      . </p><br>
<p>    PSI- ,       <em>PsiElementFactory</em>   ,    .  Java-?    Java-.   Groovy?  <em>GroovyPsiElementFactory</em>.   . </p><br>
<p> <em>PsiElementFactory</em>       .       Groovy  Kotlin ,        . </p><br>
<div class="spoiler"><b class="spoiler_title"> PsiElement  package name</b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">val</span> factory = GroovyPsiElementFactory.getInstance(buildGradlePsiFile.project)<font></font>
<font></font>
<span class="hljs-keyword">val</span> packageName = config.mainParams.packageName
<span class="hljs-keyword">val</span> newArgumentItem = factory.createStringLiteralForReference(packageName)</code></pre></div></div><br>
<p>        <em>PsiElement</em>.</p><br>
<div class="spoiler"><b class="spoiler_title">   Map-</b><div class="spoiler_text"><pre><code class="kotlin hljs">targetPsiElement.add(newArgumentItem)</code></pre></div></div><br>
<h3 id="donastroyka-kapt-a-dlya-moxy-v-application-module"> kapt-  Moxy  application </h3><br>
<p>   -,    , â€“  kapt-  Moxy  application .  :          <em>@RegisterMoxyReflectorPackages</em>.</p><br>
<div class="spoiler"><b class="spoiler_title">-?</b><div class="spoiler_text"><p><img src="https://habrastorage.org/webt/us/17/in/us17inlvgteb4k9pmegkurtl7y8.png" alt="image"></p></div></div><br>
<p>        ,  :  <em>PsiFile</em>,  <em>PsiElement</em>,  â€¦      ,         <em>PsiElement</em>-.</p><br>
<p>    :  ,    <em>@RegisterMoxyReflectorPackages</em>,       <em>value</em>  ,          .</p><br>
<p>   ,       . ,     <em>PsiManager</em>,   <em>PsiClass</em>  .</p><br>
<div class="spoiler"><b class="spoiler_title"> PsiClass  @RegisterMoxyReflectorPackages</b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">val</span> appModule = ModuleManager.getInstance(project)<font></font>
                     .modules.toList()<font></font>
                     .first { it.name == <span class="hljs-string">"headhunter-applicant"</span> }<font></font>
<font></font>
<span class="hljs-keyword">val</span> psiManager = PsiManager.getInstance(appModule.project)<font></font>
<font></font>
<span class="hljs-keyword">val</span> annotationPsiClass = ClassUtil.findPsiClass(<font></font>
    psiManager,<font></font>
    <span class="hljs-string">"com.arellomobile.mvp.RegisterMoxyReflectorPackages"</span>
) ?: <span class="hljs-keyword">return</span></code></pre></div></div><br>
<p>    <em>AnnotatedMembersSearch</em>   ,      .</p><br>
<div class="spoiler"><b class="spoiler_title"> ,  </b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">val</span> annotatedPsiClass = AnnotatedMembersSearch.search(<font></font>
        annotationPsiClass,<font></font>
        appModule.moduleContentScope<font></font>
    ).findAll()<font></font>
    ?.firstOrNull() ?: <span class="hljs-keyword">return</span></code></pre></div></div><br>
<p> ,  <em>PsiElement</em>  ,        value.     ,      .</p><br>
<div class="spoiler"><b class="spoiler_title">      </b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">val</span> annotationPsiElement = (annotatedPsiClass<font></font>
    .annotations<font></font>
    .first() <span class="hljs-keyword">as</span> KtLightAnnotationForSourceEntry<font></font>
).kotlinOrigin<font></font>
<font></font>
<span class="hljs-keyword">val</span> packagesPsiElements = annotationPsiElement<font></font>
    .collectDescendantsOfType&lt;KtValueArgumentList&gt;()<font></font>
    .first()<font></font>
    .collectDescendantsOfType&lt;KtValueArgument&gt;()<font></font>
<font></font>
<span class="hljs-keyword">val</span> updatedPackagesList = packagesPsiElements<font></font>
                            .mapTo(mutableListOf()) { it.text }<font></font>
                            .apply { <span class="hljs-keyword">this</span> += <span class="hljs-string">"\"<span class="hljs-subst">${config.packageName}</span>\""</span> }<font></font>
<font></font>
<span class="hljs-keyword">val</span> newAnnotationValue = updatedPackagesList.joinToString(separator = <span class="hljs-string">",\n"</span>)</code></pre></div></div><br>
<p>  <em>KtPsiFactory</em>   <em>PsiElement</em> â€“          .</p><br>
<div class="spoiler"><b class="spoiler_title">      </b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">val</span> kotlinPsiFactory = KtPsiFactory(project)
<span class="hljs-keyword">val</span> newAnnotationPsiElement = kotlinPsiFactory.createAnnotationEntry(
    <span class="hljs-string">"@RegisterMoxyReflectorPackages(\n<span class="hljs-variable">$newAnnotationValue</span>\n)"</span><font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">val</span> replaced = annotationPsiElement.replace(newAnnotationPsiElement)</code></pre></div></div><br>
<p> .</p><br>
<p>    ?    code style.  ,      IDEA    : CodeStyleManager.</p><br>
<div class="spoiler"><b class="spoiler_title"> code style</b><div class="spoiler_text"><pre><code class="kotlin hljs">CodeStyleManager.getInstance(module.project).reformat(replacedElement)</code></pre></div></div><br>
<p>   -  ,     .</p><br>
<h3 id="vyvody-1"></h3><br>
<ul>
<li>    ,      PSI-,      . </li>
<li>,  PSI     ,    ,    PsiElement-. </li>
</ul><br>
<h1 id="chto-delat-dalshe">  ?</h1><br>
<p>  . </p><br>
<ul>
<li>     â€“    ,       .</li>
<li>      .       .   :            .</li>
<li>    ?      .  , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   IDEA</a>   ,   .       ,        . â€”   -  ,    GitHub  .  ,    ,  .</li>
<li>   -   â€“    IntelliJ IDEA   .  ,   <em>Util</em>  <em>Manager</em> ,  ,    ,    .</li>
<li>  :     .  ,  <em>runIde</em>,     IDEA,   .   ,           hh.ru,       .</li>
</ul><br>
<p>  . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a>,  ,   â€“ . </p><br>
<h2 id="faq">FAQ</h2><br>
<ul>
<li>      ?</li>
</ul><br>
<p>      ,       .      ,   2  3 .</p><br>
<ul>
<li>      IDEA   ,   -  ?</li>
</ul><br>
<p>,    IDEA   IDEA SDK ,   deprecated,   ,  .   SDK-   ,   ,     . </p><br>
<ul>
<li>        ?</li>
</ul><br>
<p>   â€“    gitignore .   -   . </p><br>
<ul>
<li>         ?</li>
</ul><br>
<p>     Android Studio  Mac OS,    Ubuntu,   . ,     Windows,    .</p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja463599/index.html">ã€Œã“ã‚Œã¯æ‚ªå¤¢ã§ã™ã€ï¼šå®‡å®™é£›è¡Œå£«ã¯ã€ãƒãƒªã‚¦ãƒƒãƒ‰ãŒå®‡å®™ã«é–¢ã™ã‚‹æ˜ ç”»ã‚’æ’®å½±ã™ã‚‹ã¨ãã«çŠ¯ã™é–“é•ã„ã«ã¤ã„ã¦æ„è¦‹ã‚’å…±æœ‰ã—ã¾ã™</a></li>
<li><a href="../ja463601/index.html">Javaã§ã®å€‹åˆ¥ã®ãƒ¡ã‚½ãƒƒãƒ‰ãƒ­ã‚®ãƒ³ã‚°/ logback</a></li>
<li><a href="../ja463605/index.html">æŠ€è¡“çš„ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹-æ·±å®‡å®™ã‹ã‚‰</a></li>
<li><a href="../ja463607/index.html">Reactã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¨ãƒ•ãƒƒã‚¯ã‚’å‚™ãˆãŸReduxçµ„ã¿è¾¼ã¿ä»£æ›¿</a></li>
<li><a href="../ja463609/index.html">Directum Clubã®æ¨å¥¨ã‚·ã‚¹ãƒ†ãƒ ã€‚ãƒ‘ãƒ¼ãƒˆ1ã€å…±åŒ</a></li>
<li><a href="../ja463613/index.html">Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã¯ã€é€šå¸¸ã®Dockerfileã‚’ä½¿ç”¨ã—ã¦werfã§ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™</a></li>
<li><a href="../ja463617/index.html">ãƒ¢ãƒã‚¤ãƒ«MMOã®ãƒ†ã‚¹ãƒˆã®æ©Ÿèƒ½</a></li>
<li><a href="../ja463619/index.html">ãƒªãƒ¢ãƒ¼ãƒˆã§ã®ä½œæ¥­ï¼šç§ãŸã¡ã®çµŒé¨“</a></li>
<li><a href="../ja463623/index.html">ç§ãŸã¡ã¯ãƒ†ã‚¹ãƒˆã®ã‚¸ãƒ£ãƒ³ã‚°ãƒ«ã‹ã‚‰é¸ã°ã‚Œã¾ã—ãŸï¼šãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ã‹ã‚‰ãƒ†ã‚¹ãƒˆã¸ã®çŸ­ã„é“ã‚’æ§‹ç¯‰ã—ã¦ã„ã¾ã™</a></li>
<li><a href="../ja463625/index.html">Flowmon Networksã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ç›£è¦–ã¨ç•°å¸¸ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã®æ¤œå‡º</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>