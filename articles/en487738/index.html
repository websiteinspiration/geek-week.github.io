<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõ¨ üë©üèΩ‚Äçüîß ü§µüèª Schema animation in SCADA üéº ‚úçüèø üßôüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When creating HMI, quite often the task is to construct a mapping of a complex circuit of related elements. This can be branched pipeline schemes, ele...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Schema animation in SCADA</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/487738/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When creating HMI, quite often the task is to construct a mapping of a complex circuit of related elements. </font><font style="vertical-align: inherit;">This can be branched pipeline schemes, electricity, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can, of course, limit yourself to displaying key elements (gate valves, circuit breakers), but the larger the circuit, the more difficult it is to compose a complete picture and ensure the correct action of the operator. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/js/86/tr/js86trkeud1o6qilw9cdjckia8s.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This article describes the coloring of elements of such schemes, describes the solution method for Simatic WinCC v7 and its implementation in Simargl SCADA. </font><font style="vertical-align: inherit;">If you don‚Äôt have to work with WinCC, then you can look right at the end of the article - there is a curious video.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For a more visual representation of why all this is necessary, we take a small simple scheme.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zm/7-/rm/zm7-rmshnfpa9zuahdxt6m_mdfo.png" alt="image"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now imagine what will happen if there is an operation. </font><font style="vertical-align: inherit;">How long does it take to track a product‚Äôs path through a pipeline system? </font><font style="vertical-align: inherit;">We arm ourselves with a stopwatch.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ready? </font><font style="vertical-align: inherit;">Go!</font></font></b><div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/iq/l8/jt/iql8jtcvyifvukrjviudd-s4mxu.png" alt="image"></div><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
According to my observations, it takes 10 - 15 seconds. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And now recall that (suddenly) operations can be several at the same time. </font><font style="vertical-align: inherit;">This ‚Äúslightly‚Äù complicates the task. </font><font style="vertical-align: inherit;">Ready to test yourself again?</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Go!</font></font></b><div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/-d/zl/oh/-dzloh6cxb2zcwpqzpdiwlolmm0.png" alt="image"></div><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Translating into a decent language the words of my colleague: ‚ÄúThat's an opportunity! While you track the second route, you will forget about the first one very much. What a wonderful and convenient scheme! ‚Äù </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But the scheme is really simple - it doesn‚Äôt even have readings of instruments and various signatures (a special hello to fans to draw ‚Äúthree-dimensional‚Äù pipes). In practice, things can be worse. I have met with significantly larger schemes (more than 400 valves). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What can an operator do on such a mimic? In the best case, slowly open the gate valves along the route and hope that he was not mistaken. But what if switching needs to be done quickly and the cost of the error is high?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The way out of this situation is obvious - it is necessary to color the lines along the route, and it is advisable to do this before the control action. </font><font style="vertical-align: inherit;">Oddly enough, I did not see a ready-made solution out of the box, even with expensive SCADA packages. </font><font style="vertical-align: inherit;">An attempt to manually tint for each line threatens to delay the setup almost to infinity.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solution for WinCC v7</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I solved such a problem based on WinCC v7. Unfortunately, under the terms of the contract, I have no right to lay out a ready-made solution, but I can describe a possible solution. Suddenly someone will be helpful. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I‚Äôll note right away that this will be about the WinCC version 7 product family, since there is the opportunity to use VBA. It is necessary to warn, everything described below is more likely a hack, is used from hopelessness and is not suitable in all cases. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I will continue the discussion in terms of pipes and valves, although, of course, everything will be the same for power supply schemes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mentally divide the scheme into sections so that on each side there is only one input / output. Those. if an outlet is cut into the pipe, three sections will have to be made: before the branch, then the branch itself.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To create a diagram, you will have to use two types of standard graphic objects: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Connector (for drawing lines) and Circle (for creating control points of the diagram). Connector is necessary because it allows you to determine which objects in the circuit is connected, in contrast to the usual line. The standard Circle should be redone in CustomObject - this will avoid confusion when sorting elements of the mnemonic scheme and give convenient names to the properties. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Part of the control points will correspond to the joints of pipelines, and part - to the gate valves. For the latter, we select any unused property and assign a VBS-action, where we create a constant and assign it a string value with the name of the valve:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/4a/4a/6s/4a4a6sqjj2s_tn7vq-o87itgkhk.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, we write a script on VBA that will go through all the screen elements and for each Connector create a list of indirectly connected latches, allowing you to ultimately create VBS text for the BorderColor property. This can be achieved due to the fact that Connector has two properties - TopConnectedObjectName and BottomConnectedObjectName, available in VBA. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The result of this script will look something like this: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2j/sg/io/2jsgiom-vpl8c5vahyyd3nsutro.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D1 and D2 - arrays with the names of the valves; TubeColor - a function that returns the color and line style depending on the state of the valves. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An important point: when writing a VBS script to an element, you must also change the triggers. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the TubeColor function, it will be necessary to set all the coloring rules depending on the technological situation. Of course, TubeColor needs to be rendered in the Global script.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then the struggle will begin for performance, optimization of VBS, etc., since WinCC hardly transfers large mnemonic diagrams. </font><font style="vertical-align: inherit;">But we must pay tribute to colleagues from Siemens, the speed of VBS has increased significantly, if I'm not mistaken, from version 7.3, which greatly simplified the life of developers of applied projects.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description of implementation in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simargl SCADA</font></font></a></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To draw animated schemes, Simargl SCADA includes two widgets: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SPipeScene - a scene for drawing lines and setting coloring rules; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SPipe - to specify nodal points and display changes in the state of field equipment. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In fact, the process boils down to simply placing the nodal points of the circuit, binding properties to tag values, and placing widgets on top of the scene that display the status of the equipment. </font><font style="vertical-align: inherit;">It all looks something like this:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is curious that to create the actual circuit, it was not necessary to write code at all. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can get the demo version of Simargl SCADA, the documentation and the project sources from the video from the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">facebook page</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en487720/index.html">On competitive corutinism (using reactive programming as an example)</a></li>
<li><a href="../en487724/index.html">BlazingPizza: Blazor app from start to finish. Part 2. Add a component</a></li>
<li><a href="../en487728/index.html">@Pythonetc compilation, January 2020</a></li>
<li><a href="../en487730/index.html">Natural Language Processing. Results 2019 and trends for 2020</a></li>
<li><a href="../en487734/index.html">Speeding up Entity Framework Core</a></li>
<li><a href="../en487740/index.html">Assembling a portable magnetometer</a></li>
<li><a href="../en487742/index.html">Arbitrage Trading (Bellman-Ford Algorithm)</a></li>
<li><a href="../en487744/index.html">FARO Introduces FOCUS S 70 Laser 3D Scanner</a></li>
<li><a href="../en487746/index.html">Eternal</a></li>
<li><a href="../en487748/index.html">$ 3 hardware encryption key - is this possible?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>