<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍⚕️ 🛶 🗻 BlessRNGまたはRNGの正直さをチェック 🖼️ 💦 🔕</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="gamedevでは、ランダムな家に何かを結び付ける必要があることがよくあります。Unityにはこのための独自のRandomがあり、それと並行してSystem.Randomが存在します。むかしむかし、プロジェクトの1つでは、両方が異なるように機能する可能性があるように見えました（ただし、均一なディスト...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>BlessRNGまたはRNGの正直さをチェック</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/playgendary/blog/473880/"><img src="https://habrastorage.org/webt/l7/la/vl/l7lavlbtdajd-exhq5l43oeur6i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gamedevでは、ランダムな家に何かを結び付ける必要があることがよくあります。Unityにはこのための独自のRandomがあり、それと並行してSystem.Randomが存在します。</font><font style="vertical-align: inherit;">むかしむかし、プロジェクトの1つでは、両方が異なるように機能する可能性があるように見えました（ただし、均一なディストリビューションが必要です）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、詳細には触れませんでした。System.Randomへの移行ですべての問題が修正されれば十分でした。</font><font style="vertical-align: inherit;">次に、RNGの「偏り」または予測可能なRNGの程度と、どちらを選択するかについて、より詳細に理解して小規模な調査を行うことにしました。</font><font style="vertical-align: inherit;">さらに、私は彼らの「正直さ」について相反する意見をよく耳にします。実際の結果が述べられた結果とどのように関連しているかを理解してみましょう。</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">簡単な教育プログラムまたはRNGは実際にはPRNGです</font></font></h2><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すでに乱数ジェネレータに慣れている場合は、すぐに「テスト」セクションに進むことができます。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
乱数（MF）は、エントロピーのソースであるランダム（カオス）プロセスを使用して生成された一連の数字です。つまり、これはそのようなシーケンスであり、その要素は数学的な法則によって接続されていません。因果関係はありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ミッドレンジを作成するものは、乱数ジェネレーター（RNG）と呼ばれます。すべてが基本的なように思えますが、理論から実践に移る場合、そのようなシーケンスを生成するためのソフトウェアアルゴリズムの実際の実装はそれほど単純ではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その理由は、現代の家庭用電化製品に非常にランダム性がないことです。それがなければ、乱数はランダムではなくなり、それらのジェネレータは意図的に決定された引数の通常の関数に変わります。 IT分野の多くの専門分野では、これは深刻な問題です（たとえば、暗号化など）。残りの部分では、完全に受け入れられる解決策があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
真の乱数ではなく、可能な限りそれらに近い、いわゆる疑似乱数（PSN）を返すアルゴリズムを作成する必要があります。この場合のアルゴリズムは、疑似乱数ジェネレーター（PRNG）と呼ばれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PRNGを作成するためのいくつかのオプションがありますが、すべてについて、以下が関連します。</font></font><br>
<br>
<ol>
<li>  .<br>
<br>
   ,        .      ( )    (seed, random seed).    seed         .</li>
<li> .<br>
<br>
   ,     seed      .  ,    ,   seed (  ,   ,   )       .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、PRNGを特徴付ける確率分布（PRNGが生成する数値と確率）を知る必要もあります。ほとんどの場合、これは正規分布または均一分布です。</font></font><br>
<img src="https://habrastorage.org/webt/f7/2x/j9/f72xj9mz2s52w-ahiwp5uiuqzs0.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正規分布（左）と均一分布（右）</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
24面の正直なサイコロがあるとします。投げると、ユニットから落ちる確率は1/24になります（他の数字から落ちる確率も同様です）。たくさん投げて結果を記録すると、すべての顔がほぼ同じ頻度で脱落することがわかります。実際、このサイコロは均一な分布を持つRNGと見なすことができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、もしあなたがこれらの骨の10個をすぐに投げて、合計ポイントを数えたら？彼女の均一性は維持されますか？番号。ほとんどの場合、金額は125ポイント、つまり平均値に近くなります。その結果、スローする前でも、大まかに将来の結果を見積もることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その理由は、ポイントの平均量を取得するには、組み合わせの数が最も多いためです。それから離れれば離れるほど、組み合わせが少なくなり、損失の可能性も低くなります。このデータを視覚化すると、遠くから鐘の形に似たものになります。したがって、ある程度のストレッチがあれば、10ボーンのシステムを正規分布のRNGと呼ぶことができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別の例、すでに飛行機の中でのみ-ターゲット射撃。シューターは、グラフに表示される1組の数値（x、y）を生成するRNGです。</font></font><br>
<img src="https://habrastorage.org/webt/hs/o8/t3/hso8t3u11xkoyrp2slwjo4jvpic.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
左側のオプションが実生活に近いことに同意します-これは正規分布のRNGです。ただし、暗い空に星を散乱させる必要がある場合は、RNGを均一な分布で使用して得られる正しいオプションの方が適しています。一般に、タスクに応じてジェネレータを選択します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、PSPシーケンスのエントロピーについて説明します。たとえば、このような起動シーケンスがある</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
89、93、33、32、82、21、4、42、11、8、60、95、53、30、42、19、34、35、62、23、44 、38、74、36、52、18、58、79、65、45、99、90、82、20、41、13、88、76、82、24、5、54、72、19、80、2 、74、36、71、9 ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一見、これらの数値はどれくらいランダムですか？分布を確認することから始めましょう。</font></font><br>
<img src="https://habrastorage.org/webt/pg/6h/nw/pg6hnwtyc2v9e8xx2-zurotlnsq.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユニフォームに近いように見えますが、2つの数値のシーケンスを読み取り、それらを平面上の座標として解釈すると、次の</font></font><br>
<img src="https://habrastorage.org/webt/vd/3_/y2/vd3_y2eijwkjq47tbjsut-els-y.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ようになります。パターンがはっきりと見えるようになります。また、シーケンス内のデータは特定の方法で順序付けられている（つまり、エントロピーが低い）ため、非常に「バイアス」が発生する可能性があります。少なくとも、このようなPRNGは平面上の座標を生成するのにはあまり適していません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別のシーケンス：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
42、72、17、0、30、0、15、9、47、19、35、86、40、54、97、42、69、19、20、88、4、3、67、27 、42、56、17、14、20、40、80、97、1、31、69、13、88、89、76、9、4、85、17、88、70、10、42、98、96 、53、... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここではすべてが平面でも問題ないようです：</font></font><br>
<img src="https://habrastorage.org/webt/ou/kh/ec/oukhecshx_b1qwjmt73micdukry.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ボリュームを見てみましょう（</font><font style="vertical-align: inherit;">それぞれ</font><font style="vertical-align: inherit;">3つの数値を読み取ります）：</font></font><br>
<img src="https://habrastorage.org/webt/ly/sy/08/lysy08ezn_tfyljmvlgjygp_xks.gif"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして再びパターン。</font><font style="vertical-align: inherit;">4次元での視覚化の構築は機能しません。</font><font style="vertical-align: inherit;">しかし、パターンはこの次元と大きな次元の両方に存在する可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同じ暗号化では、最も厳しい要件がPRNGに課されるため、そのような状況は断固として受け入れられません。</font><font style="vertical-align: inherit;">したがって、その品質を評価するために、特別なアルゴリズムが開発されましたが、これについてはここでは触れません。</font><font style="vertical-align: inherit;">トピックは広範囲にわたり、別の記事を利用します。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テスト中</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
確かなことがわからない場合は、どうすればよいでしょうか。</font><font style="vertical-align: inherit;">あなたがそれが許可する信号機がわからない場合、道路を横断することは価値がありますか？</font><font style="vertical-align: inherit;">結果は異なる場合があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unityの悪名高いランダム性についても同じことが言えます。</font><font style="vertical-align: inherit;">まあ、ドキュメンテーションが必要な詳細を明らかにしているが、記事の冒頭で述べられた話は、望ましい詳細の欠如のために起こった場合。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、ツールがどのように機能するかを知らなければ、それを正しく適用することはできません。</font><font style="vertical-align: inherit;">一般的に、少なくとも配布を犠牲にして最終的に確認するために、実験をチェックして実施する時が来ました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ソリューションはシンプルで効果的でした-統計を収集し、客観的なデータを取得して結果を確認することです。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">研究対象</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unityで乱数を生成するにはいくつかの方法があります—私たちは5つをテストしました。 </font></font><br>
<br>
<ol>
<li>System.Random.Next().    (integer)    .</li>
<li>System.Random.NextDouble().     (double)    [0; 1).</li>
<li>UnityEngine.Random.Range().     (float)    .</li>
<li>UnityEngine.Random.value.     (float)    [0; 1).</li>
<li>Unity.Mathematics.Random.NextFloat().    Unity.Mathematics.     (float)    .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ドキュメントのほぼすべての場所で、UnityEngine.Random.value（分布が指定されていないが、UnityEngine.Random.Range（）と同様に均一であることが期待された）とUnity.Mathematics.Random.NextFloat（）（を除いて）基本はxorshiftアルゴリズムです。つまり、再び均一な分布を待つ必要があります）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デフォルトでは、ドキュメントで期待されているものが、期待される結果のために取得されました。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法論</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
提示された各メソッドで乱数のシーケンスを生成し、さらに処理するために結果を保存する小さなアプリケーションを作成しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各シーケンスの長さは100,000の数値です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
乱数の範囲は[0、100）です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データは、いくつかのターゲットプラットフォームから収集されました。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
-Unity v2018.3.14f1、エディターモード、Mono、.NET Standard 2.0</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">macOS </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
-Unity v2018.3.14f1、エディターモード、Mono、.NET Standard 2.0 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
-Unity v5.6.4p4、エディターモード、Mono、.NET Standard 2.0</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Android </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
-Unity v2018.3.14f1、デバイス上でビルド、Mono、.NET Standard 2.0</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iOS </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
-Unity v2018.3.14f1、デバイスにビルド、il2cpp、.NET Standard 2.0</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実装</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
乱数を生成する方法はいくつかあります。</font><font style="vertical-align: inherit;">それらのそれぞれに対して、個別のラッパークラスを作成します。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">値の範囲を設定する機能[min / max）。</font><font style="vertical-align: inherit;">コンストラクターによって設定されます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ミッドレンジを返すメソッド。</font><font style="vertical-align: inherit;">タイプとして、より一般的なフロートを選択します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果をマークするための生成方法の名前。</font><font style="vertical-align: inherit;">便宜上、完全なクラス名+ミッドレンジの生成に使用されたメソッドの名前を値として返します。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、IRandomGeneratorインターフェイスによって表される抽象化を宣言します。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">namespace</span> <span class="hljs-title">RandomDistribution</span><font></font>
{<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">IRandomGenerator</span><font></font>
    {<font></font>
        <span class="hljs-keyword">string</span> Name { <span class="hljs-keyword">get</span>; }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">Generate</span>(<span class="hljs-params"></span>)</span>;<font></font>
    }<font></font>
}</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Random.Next（）の実装</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このメソッドを使用すると、値の範囲を指定できますが、整数が返されるため、floatが必要です。</font><font style="vertical-align: inherit;">単に整数を浮動小数点数として解釈するか、値の範囲を数桁拡大して、中域が生成されるたびにそれらを補正することができます。</font><font style="vertical-align: inherit;">与えられた精度で固定小数点のようなものになります。</font><font style="vertical-align: inherit;">実際の浮動小数点値に近いため、このオプションを使用します。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">using</span> System;<font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">RandomDistribution</span><font></font>
{<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">SystemIntegerRandomGenerator</span> : <span class="hljs-title">IRandomGenerator</span><font></font>
    {<font></font>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> DefaultFactor = <span class="hljs-number">100000</span>;<font></font>
        <font></font>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> Random _generator = <span class="hljs-keyword">new</span> Random();
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">int</span> _min;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">int</span> _max;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">int</span> _factor;<font></font>
<font></font>
<font></font>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> Name =&gt; <span class="hljs-string">"System.Random.Next()"</span>;<font></font>
<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">SystemIntegerRandomGenerator</span>(<span class="hljs-params"><span class="hljs-keyword">float</span> min, <span class="hljs-keyword">float</span> max, <span class="hljs-keyword">int</span> factor = DefaultFactor</span>)</span><font></font>
        {<font></font>
            _min = (<span class="hljs-keyword">int</span>)min * factor;<font></font>
            _max = (<span class="hljs-keyword">int</span>)max * factor;<font></font>
            _factor = factor;<font></font>
        }<font></font>
<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">float</span> <span class="hljs-title">Generate</span>(<span class="hljs-params"></span>)</span> =&gt; (<span class="hljs-keyword">float</span>)_generator.Next(_min, _max) / _factor;<font></font>
    }<font></font>
}</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Random.NextDouble（）の実装</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで値の固定範囲[0; </font><font style="vertical-align: inherit;">1）。</font><font style="vertical-align: inherit;">これをコンストラクタで指定されたものに投影するには、単純な算術演算X *（max-min）+ minを使用します。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">using</span> System;<font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">RandomDistribution</span><font></font>
{<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">SystemDoubleRandomGenerator</span> : <span class="hljs-title">IRandomGenerator</span><font></font>
    {<font></font>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> Random _generator = <span class="hljs-keyword">new</span> Random();
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">double</span> _factor;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">float</span> _min;<font></font>
<font></font>
<font></font>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> Name =&gt; <span class="hljs-string">"System.Random.NextDouble()"</span>;<font></font>
<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">SystemDoubleRandomGenerator</span>(<span class="hljs-params"><span class="hljs-keyword">float</span> min, <span class="hljs-keyword">float</span> max</span>)</span><font></font>
        {<font></font>
            _factor = max - min;<font></font>
            _min = min;<font></font>
        }<font></font>
<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">float</span> <span class="hljs-title">Generate</span>(<span class="hljs-params"></span>)</span> =&gt; (<span class="hljs-keyword">float</span>)(_generator.NextDouble() * _factor) + _min;<font></font>
    }<font></font>
}</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UnityEngine.Random.Range（）の実装</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UnityEngine.Random静的クラスのこのメソッドを使用すると、値の範囲を指定して、float型の中範囲を返すことができます。</font><font style="vertical-align: inherit;">追加の変換は必要ありません。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">using</span> UnityEngine;<font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">RandomDistribution</span><font></font>
{<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">UnityRandomRangeGenerator</span> : <span class="hljs-title">IRandomGenerator</span><font></font>
    {<font></font>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">float</span> _min;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">float</span> _max;<font></font>
<font></font>
<font></font>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> Name =&gt; <span class="hljs-string">"UnityEngine.Random.Range()"</span>;<font></font>
<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">UnityRandomRangeGenerator</span>(<span class="hljs-params"><span class="hljs-keyword">float</span> min, <span class="hljs-keyword">float</span> max</span>)</span><font></font>
        {<font></font>
            _min = min;<font></font>
            _max = max;<font></font>
        }<font></font>
<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">float</span> <span class="hljs-title">Generate</span>(<span class="hljs-params"></span>)</span> =&gt; Random.Range(_min, _max);<font></font>
    }<font></font>
}</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UnityEngine.Random.valueの実装</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
静的クラスUnityEngine.Randomのvalueプロパティは、値の固定範囲からタイプfloatの中範囲を返します[0; </font><font style="vertical-align: inherit;">1）。</font><font style="vertical-align: inherit;">System.Random.NextDouble（）を実装するときと同じ方法で、指定した範囲に投影します。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">using</span> UnityEngine;<font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">RandomDistribution</span><font></font>
{<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">UnityRandomValueGenerator</span> : <span class="hljs-title">IRandomGenerator</span><font></font>
    {<font></font>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">float</span> _factor;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">float</span> _min;<font></font>
<font></font>
<font></font>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> Name =&gt; <span class="hljs-string">"UnityEngine.Random.value"</span>;<font></font>
<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">UnityRandomValueGenerator</span>(<span class="hljs-params"><span class="hljs-keyword">float</span> min, <span class="hljs-keyword">float</span> max</span>)</span><font></font>
        {<font></font>
            _factor = max - min;<font></font>
            _min = min;<font></font>
        }<font></font>
<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">float</span> <span class="hljs-title">Generate</span>(<span class="hljs-params"></span>)</span> =&gt; (<span class="hljs-keyword">float</span>)(Random.<span class="hljs-keyword">value</span> * _factor) + _min;<font></font>
    }<font></font>
}</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unity.Mathematics.Random.NextFloat（）の実装</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unity.Mathematics.RandomクラスのNextFloat（）メソッドは、float型の中範囲を返し、値の範囲を指定できます。</font><font style="vertical-align: inherit;">唯一のニュアンスは、Unity.Mathematics.Randomの各インスタンスをシードで初期化する必要があることです。これにより、シーケンスの繰り返しの生成を回避できます。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">using</span> Unity.Mathematics;<font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">RandomDistribution</span><font></font>
{<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">UnityMathematicsRandomValueGenerator</span> : <span class="hljs-title">IRandomGenerator</span><font></font>
    {<font></font>
        <span class="hljs-keyword">private</span> Random _generator;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">float</span> _min;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">float</span> _max;<font></font>
<font></font>
<font></font>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> Name =&gt; <span class="hljs-string">"Unity.Mathematics.Random.NextFloat()"</span>;<font></font>
<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">UnityMathematicsRandomValueGenerator</span>(<span class="hljs-params"><span class="hljs-keyword">float</span> min, <span class="hljs-keyword">float</span> max</span>)</span><font></font>
        {<font></font>
            _min = min;<font></font>
            _max = max;<font></font>
            _generator = <span class="hljs-keyword">new</span> Random();<font></font>
            _generator.InitState(<span class="hljs-keyword">unchecked</span>((<span class="hljs-keyword">uint</span>)System.DateTime.Now.Ticks));<font></font>
        }<font></font>
<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">float</span> <span class="hljs-title">Generate</span>(<span class="hljs-params"></span>)</span> =&gt; _generator.NextFloat(_min, _max);<font></font>
    }<font></font>
}</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MainControllerの実装</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
いくつかのIRandomGenerator実装が準備されています。</font><font style="vertical-align: inherit;">次に、シーケンスを生成し、処理のために結果のデータセットを保存する必要があります。</font><font style="vertical-align: inherit;">これを行うには、Unityでシーンを作成し、小さなスクリプトMainControllerを作成します。これにより、必要なすべての作業が実行され、同時にUIとの対話が行われます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データセットのサイズと中程度の値の範囲を設定し、調整済みですぐに使用できるジェネレーターの配列を返すメソッドも取得します。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">namespace</span> <span class="hljs-title">RandomDistribution</span><font></font>
{<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MainController</span> : <span class="hljs-title">MonoBehaviour</span><font></font>
    {<font></font>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> DefaultDatasetSize = <span class="hljs-number">100000</span>;<font></font>
<font></font>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">float</span> MinValue = <span class="hljs-number">0f</span>;
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">float</span> MaxValue = <span class="hljs-number">100f</span>;<font></font>
<font></font>
        ...<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">private</span> IRandomGenerator[] <span class="hljs-title">CreateRandomGenerators</span>(<span class="hljs-params"></span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> IRandomGenerator[]<font></font>
            {<font></font>
                <span class="hljs-keyword">new</span> SystemIntegerRandomGenerator(MinValue, MaxValue),
                <span class="hljs-keyword">new</span> SystemDoubleRandomGenerator(MinValue, MaxValue),
                <span class="hljs-keyword">new</span> UnityRandomRangeGenerator(MinValue, MaxValue),
                <span class="hljs-keyword">new</span> UnityRandomValueGenerator(MinValue, MaxValue),
                <span class="hljs-keyword">new</span> UnityMathematicsRandomValueGenerator(MinValue, MaxValue)<font></font>
            };<font></font>
        }<font></font>
<font></font>
        ...<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして今、データセットを形成しています。</font><font style="vertical-align: inherit;">この場合、データ生成はテキストストリーム（csv形式）での結果の記録と組み合わされます。</font><font style="vertical-align: inherit;">各IRandomGeneratorの値を格納するために、独自の個別の列が割り当てられ、最初の行にはジェネレーターの名前が含まれています。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">namespace</span> <span class="hljs-title">RandomDistribution</span><font></font>
{<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MainController</span> : <span class="hljs-title">MonoBehaviour</span><font></font>
    {<font></font>
        ...<font></font>
		<font></font>
        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">GenerateCsvDataSet</span>(<span class="hljs-params">TextWriter writer, <span class="hljs-keyword">int</span> dataSetSize, <span class="hljs-keyword">params</span> IRandomGenerator[] generators</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> separator = <span class="hljs-string">','</span>;
            <span class="hljs-keyword">int</span> lastIdx = generators.Length - <span class="hljs-number">1</span>;<font></font>
<font></font>
            <span class="hljs-comment">// write header</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= lastIdx; j++)<font></font>
            {<font></font>
                writer.Write(generators[j].Name);<font></font>
                <span class="hljs-keyword">if</span> (j != lastIdx)<font></font>
                    writer.Write(separator);<font></font>
            }<font></font>
            writer.WriteLine();<font></font>
<font></font>
            <span class="hljs-comment">// write data</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= dataSetSize; i++)<font></font>
            {<font></font>
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= lastIdx; j++)<font></font>
                {<font></font>
                    writer.Write(generators[j].Generate());<font></font>
                    <span class="hljs-keyword">if</span> (j != lastIdx)<font></font>
                        writer.Write(separator);<font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (i != dataSetSize)<font></font>
                    writer.WriteLine();<font></font>
            }<font></font>
        }<font></font>
<font></font>
        ...<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GenerateCsvDataSetメソッドを呼び出して結果をファイルに保存するか、ネットワークを介してエンドデバイスから受信サーバーにデータをすぐに転送するために残ります。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">namespace</span> <span class="hljs-title">RandomDistribution</span><font></font>
{<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MainController</span> : <span class="hljs-title">MonoBehaviour</span><font></font>
    {<font></font>
        ...<font></font>
		<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">GenerateCsvDataSet</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> path, <span class="hljs-keyword">int</span> dataSetSize, <span class="hljs-keyword">params</span> IRandomGenerator[] generators</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> writer = File.CreateText(path))<font></font>
            {<font></font>
                GenerateCsvDataSet(writer, dataSetSize, generators);<font></font>
            }<font></font>
        }<font></font>
<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-title">GenerateCsvDataSet</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> dataSetSize, <span class="hljs-keyword">params</span> IRandomGenerator[] generators</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">using</span> (StringWriter writer = <span class="hljs-keyword">new</span> StringWriter(CultureInfo.InvariantCulture))<font></font>
            {<font></font>
                GenerateCsvDataSet(writer, dataSetSize, generators);<font></font>
                <span class="hljs-keyword">return</span> writer.ToString();<font></font>
            }<font></font>
        }<font></font>
<font></font>
        ...<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロジェクトの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソース</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードは</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">GitLabにあり</font></a><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
奇跡は起こらなかった。</font><font style="vertical-align: inherit;">彼らが期待したとおり、彼らはそれを手に入れました-すべての場合において、陰謀のヒントのない均一な分布。</font><font style="vertical-align: inherit;">プラットフォームに個別のグラフィックスを適用する意味はわかりません。それらはすべてほぼ同じ結果を示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現実は：</font></font><br>
<img src="https://habrastorage.org/webt/yr/cb/io/yrcbio95sz22zrzhszi1syge7o8.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5つの生成方法すべてからの平面上のシーケンスの</font></font><br>
<img src="https://habrastorage.org/webt/zk/0s/lf/zk0slfejixlez-fp2x9prd19u_c.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
視覚化</font><font style="vertical-align: inherit;">：</font><font style="vertical-align: inherit;">3Dでの視覚化。</font><font style="vertical-align: inherit;">同じコンテンツの束を生成しないように、System.Random.Next（）の結果のみを残します。</font></font><br>
<img src="https://habrastorage.org/webt/ao/pw/ud/aopwud2ll4sjvtcpj69p-v8or8s.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
はじめにUnityEngine.Randomの正規分布について語られた話は繰り返されませんでした。最初はエラーがあったか、それ以来、エンジンに何か変更がありました。</font><font style="vertical-align: inherit;">しかし、今は確信しています。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja473862/index.html">新しいNetologyコース-ディープラーニング：機械学習</a></li>
<li><a href="../ja473864/index.html">機能テストに基づくOpenAPI仕様の生成</a></li>
<li><a href="../ja473868/index.html">私たちは中国のチップnovatek NT78820を見ます</a></li>
<li><a href="../ja473872/index.html">Java開発者インタビュー準備計画</a></li>
<li><a href="../ja473874/index.html">11月のITイベントのダイジェスト（パート1）</a></li>
<li><a href="../ja473882/index.html">機能依存関係の概要</a></li>
<li><a href="../ja473884/index.html">Googleアナリティクスのカスタムパラメータの例を使用して、ネストされた構造のデータをGoogle BigQueryからアンロードする方法</a></li>
<li><a href="../ja473886/index.html">公開鍵標準に基づく暗号ワークステーション。ASN1構造を解析および表示するための関数</a></li>
<li><a href="../ja473888/index.html">OpenStreetMap No. 483の世界からのお知らせ（10/15/2019-10/21/2019）</a></li>
<li><a href="../ja473890/index.html">カリプソ作戦：新しいAPTグループが世界中の政府機関を攻撃</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>