<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍤 🗜️ 🧝🏽 Charity Cloud：移行ガイド 📺 🚟 👨🏼‍🎨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="少し前まで、Mail.Ruクラウドソリューション（MCS）とWelcome Mail.RuサービスがCloud for Charity Foundationsプロジェクトを立ち上げました。これにより、非営利組織はMCSクラウドプラットフォームリソースを無料で入手できます。Arithmetic of ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Charity Cloud：移行ガイド</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/461155/"><img src="https://habrastorage.org/webt/z_/wc/we/z_wcwe5eqwz8ndq8g4jsdakds_q.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
少し前まで、Mail.Ruクラウドソリューション（MCS）とWelcome Mail.Ruサービスが</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloud for Charity Foundations</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクト</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">を</font></a><font style="vertical-align: inherit;">立ち上げ</font><font style="vertical-align: inherit;">ました。これにより、非営利組織はMCSクラウドプラットフォームリソースを無料で入手できます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arithmetic of Good</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">チャリティー財団</font><font style="vertical-align: inherit;">はプロジェクトに参加し、MCSに基づいてインフラストラクチャの一部を正常に展開しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
検証後、NPOはMCSから仮想電源を受け取ることができますが、さらに調整するには特定の資格が必要です。</font><font style="vertical-align: inherit;">この記事では、無料のSSL証明書を使用して、メインファンドのウェブサイトといくつかのサブドメインを運用するためにUbuntu Linuxベースのサーバーをセットアップするための具体的な手順を説明します。</font><font style="vertical-align: inherit;">多くの人にとって、これは簡単なガイドになりますが、私たちの経験が他の非営利組織に役立つだけでなく、役立つことを願っています。</font></font><br>
<a name="habracut"></a><br>
<blockquote><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参考</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：MCSから何を取得できますか？</font><font style="vertical-align: inherit;">4 CPU、32 GB RAM、1 TB HDD、Ubuntu Linux OS、500 GBオブジェクトストレージ。</font></font></blockquote><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステップ1：仮想サーバーを起動する</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すぐにビジネスに取り掛かり、個人のMCSアカウントで仮想サーバー（別名「インスタンス」）を作成しましょう。</font><font style="vertical-align: inherit;">アプリケーションストアで、既製のLAMPスタックを選択してインストールする必要があります。これは、ほとんどのWebサイトの起動に必要なサーバーソフトウェア（LAMP = Linux、Apache、MySQL、PHP）の複雑なものです。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b5d/93d/178/b5d93d1782388ebd587829d84a008aa5.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0eb/ed2/9ab/0ebed29ab326affe50d91d5202d38754.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/662/781/dd9/662781dd94c321c69c9387d1007f744e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サーバーの適切な構成を選択し、新しいSSHキーを作成します。</font><font style="vertical-align: inherit;">[インストール]ボタンをクリックした後、サーバーとLAMPスタックのインストールが開始されます。しばらく時間がかかります。</font><font style="vertical-align: inherit;">また、システムは秘密鍵をコンピューターにダウンロードして、コンソールから仮想マシンを制御し、保存することも提案します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーションをインストールしたら、すぐにファイアウォールを構成しましょう。これは個人アカウントでも行われます。「クラウドコンピューティング-&gt;仮想マシン」セクションに移動し、「ファイアウォールの構成」項目を選択します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9b9/2f1/b65/9b92f1b65d57f871e3c02c8d21852982.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ポート80および9997を介した着信トラフィックの許可を追加する必要があります。</font><font style="vertical-align: inherit;">これは、SSL証明書をインストールしてphpMyAdminを操作するために将来必要になります。</font><font style="vertical-align: inherit;">最終的に、ルールセットは次のようになります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b88/a71/623/b88a7162366be236441488f4f5e3539d.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、SSHプロトコルを使用してコマンドラインからサーバーに接続できます。</font><font style="vertical-align: inherit;">これを行うには、次のコマンドを入力して、コンピューターのSSHキーとサーバーの外部IPアドレスをポイントします（「仮想マシン」セクションにあります）。</font></font><br>
<br>
<pre><code class="bash hljs">$ ssh -i ////key.pem ubuntu@&lt;ip_&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サーバーへの最初の接続時に、サーバーに現在のすべての更新をインストールして再起動することをお勧めします。</font><font style="vertical-align: inherit;">これを行うには、次のコマンドを実行します。</font></font><br>
<br>
<pre><code class="plaintext hljs">$ sudo apt-get update</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
システムはアップデートのリストを受け取り、このコマンドを使用してインストールし、指示に従います。</font></font><br>
 <br>
<pre><code class="plaintext hljs">$ sudo apt-get upgrade</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アップデートをインストールした後、サーバーを再起動します。</font></font><br>
<br>
<pre><code class="plaintext hljs">$ sudo reboot</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステップ2：仮想ホストを構成する</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くのNGOは、同時に複数のドメインまたはサブドメインを含める必要があります（たとえば、メインサイトとプロモーションキャンペーンのいくつかのランディングページなど）。</font><font style="vertical-align: inherit;">これはすべて、複数の仮想ホストを作成することにより、単一のサーバーで便利にホストできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、訪問者に表示されるサイトのディレクトリ構造を作成する必要があります。</font><font style="vertical-align: inherit;">いくつかのディレクトリを作成しましょう：</font></font><br>
<br>
<pre><code class="plaintext hljs">$ sudo mkdir -p /var/www/a-dobra.ru/public_html</code></pre><br>
<pre><code class="plaintext hljs">$ sudo mkdir -p /var/www/promo.a-dobra.ru/public_html</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現在のユーザーの所有者を示します。</font></font><br>
<br>
<pre><code class="plaintext hljs">$ sudo chown -R $USER:$USER /var/www/a-dobra.ru/public_html</code></pre><br>
<pre><code class="plaintext hljs">$ sudo chown -R $USER:$USER /var/www/promo.a-dobra.ru/public_html</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
変数に</font></font><code>$USER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、現在ログインしているユーザー名が含まれます（デフォルトでは、これはuserです</font></font><code>ubuntu</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">現在のユーザーは、コンテンツを格納するpublic_htmlディレクトリを所有しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、共有Webディレクトリ、それに含まれるすべてのファイルとフォルダへの読み取りアクセスが許可されるように、アクセス許可を少し編集する必要もあります。</font><font style="vertical-align: inherit;">これは、サイトページが正しく表示されるために必要です。</font></font><br>
<br>
<pre><code class="plaintext hljs">$ sudo chmod -R 755 /var/www</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、Webサーバーにコンテンツを表示するために必要な権限が付与されているはずです。</font><font style="vertical-align: inherit;">さらに、ユーザーは必要なディレクトリにコンテンツを作成できるようになりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ var / www / htmlディレクトリに既にindex.phpファイルがあります。それを新しいディレクトリにコピーしましょう-これが今のところコンテンツです：</font></font><br>
<br>
<pre><code class="plaintext hljs">$ cp /var/www/html/index.php /var/www/a-dobra.ru/public_html/index.php</code></pre><br>
<pre><code class="plaintext hljs">$ cp /var/www/html/index.php /var/www/promo.a-dobra.ru/public_html/index.php</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、ユーザーがサイトにアクセスできることを確認する必要があります。</font><font style="vertical-align: inherit;">これを行うには、まず、仮想ホストファイルを構成します。これにより、Apache Webサーバーが異なるドメインへの要求にどの程度正確に応答するかが決まります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デフォルトでは、Apacheには仮想ホストファイル000-default.confがあり、これを開始点として使用できます。</font><font style="vertical-align: inherit;">これをコピーして、ドメインごとに仮想ホストファイルを作成します。</font><font style="vertical-align: inherit;">1つのドメインから始めて、構成し、別のドメインにコピーして、必要な編集を再度行います。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ubuntuのデフォルト設定では、各仮想ホストファイルに* .conf拡張子が必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初のドメインのファイルをコピーすることから始めましょう：</font></font><br>
<br>
<pre><code class="plaintext hljs">$ sudo cp /etc/apache2/sites-available/000-default.conf /etc/apache2/sites-available/a-dobra.ru.conf</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
root権限でエディタで新しいファイルを開きます。</font></font><br>
<br>
<pre><code class="plaintext hljs">$ sudo nano /etc/apache2/sites-available/a-dobra.ru.conf</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のように編集したデータ、指定ポート80、のためのあなたのデータ</font></font><code>ServerAdmin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>ServerName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>ServerAlias</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルを保存して、あなたのサイトのルートディレクトリへのパス、（Ctrlキー+ X、Yなど）：</font></font><br>
<br>
<pre><code class="bash hljs">&lt;VirtualHost *:80&gt;<font></font>
 <font></font>
    ServerAdmin e.valuisky@a-dobra.ru<font></font>
    ServerName a-dobra.ru<font></font>
    ServerAlias www.a-dobra.ru<font></font>
 <font></font>
    DocumentRoot /var/www/a-dobra.ru/public_html<font></font>
    ErrorLog <span class="hljs-variable">${APACHE_LOG_DIR}</span>/error.log<font></font>
    CustomLog <span class="hljs-variable">${APACHE_LOG_DIR}</span>/access.log combined<font></font>
 <font></font>
    &lt;Directory /var/www/a-dobra.ru/public_html&gt;<font></font>
        Options -Indexes +FollowSymLinks +MultiViews<font></font>
        AllowOverride All<font></font>
        Require all granted<font></font>
    &lt;/Directory&gt;<font></font>
 <font></font>
    &lt;FilesMatch \.php$&gt;<font></font>
        SetHandler <span class="hljs-string">"proxy:unix:/var/run/php/php7.2-fpm.sock|fcgi://localhost/"</span><font></font>
    &lt;/FilesMatch&gt;<font></font>
 <font></font>
&lt;/VirtualHost&gt;</code></pre><br>
<code>ServerName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プライマリドメインを設定します。これは、仮想ホストの名前と一致する必要があります。</font><font style="vertical-align: inherit;">これはドメイン名である必要があります。</font><font style="vertical-align: inherit;">2番目</font></font><code>ServerAlias</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、プライマリドメインであるかのように解釈する必要がある他の名前を定義します。</font><font style="vertical-align: inherit;">これは、wwwなど、追加のドメイン名を使用する場合に便利です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この構成を別のホストにコピーし、類推して編集します。</font></font><br>
<br>
<pre><code class="plaintext hljs">$ sudo cp /etc/apache2/sites-available/a-dobra.ru.conf /etc/apache2/sites-available/promo.a-dobra.ru.conf</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あなたはあなたのウェブサイトのためのディレクトリと仮想ホストをいくつでも作成することができます！</font><font style="vertical-align: inherit;">仮想ホストファイルを作成したので、それらを含める必要があります。</font><font style="vertical-align: inherit;">a2ensiteユーティリティを使用して、次のように各サイトを有効にできます。</font></font><br>
<br>
<pre><code class="plaintext hljs">$ sudo a2ensite a-dobra.ru.conf</code></pre><br>
<pre><code class="plaintext hljs">$ sudo a2ensite promo.a-dobra.ru.conf </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デフォルトでは、ポート80はLAMPで閉じられており、SSL証明書をインストールするために将来必要になります。</font><font style="vertical-align: inherit;">したがって、ports.confファイルをすぐに編集して、Apacheを再起動します。</font></font><br>
<br>
<pre><code class="plaintext hljs">$ sudo nano /etc/apache2/ports.conf</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しい行を追加し、次のようにファイルを保存します。 </font></font><br>
<br>
<pre><code class="plaintext hljs">Listen 80<font></font>
Listen 443<font></font>
Listen 9997</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
設定が完了したら、すべての変更を有効にするためにApacheを再起動する必要があります。</font></font><br>
<br>
<pre><code class="plaintext hljs">$ sudo systemctl reload apache2</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステップ3：ドメイン名を設定する </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、新しいサーバーを指すDNSレコードを追加する必要があります。</font><font style="vertical-align: inherit;">ドメインを管理するために、Arithmetic of Good Foundationはdns-master.ruサービスを使用しています。これを例として示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メインドメインのAレコード設定は通常、次のように示されます（記号</font></font><code>@</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/22c/823/c72/22c823c7228723207e222f6c63918d2f.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サブドメインのAレコードは通常、次のように示されます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6fb/964/276/6fb964276c962e380244c77f92ba31a4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IPアドレスは、先ほど作成したLinuxサーバーのアドレスです。</font><font style="vertical-align: inherit;">指定できるTTL =3600。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しばらくすると、既にサイトにアクセスできますが、これまでのところのみ</font></font><code>http://</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">次のステップでは、サポートを追加し</font></font><code>https://</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステップ4：無料のSSL証明書を構成する</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メインサイトとすべてのサブドメインについて、Let's Encryptの無料のSSL証明書を取得できます。</font><font style="vertical-align: inherit;">また、自動更新を構成することもでき、非常に便利です。</font><font style="vertical-align: inherit;">SSL証明書を取得するには、サーバーにCertbotをインストールします。</font></font><br>
<br>
<pre><code class="plaintext hljs">$ sudo add-apt-repository ppa:certbot/certbot</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
を使用してApache用のCertbotパッケージをインストールします</font></font><code>apt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="plaintext hljs">$ sudo apt install python-certbot-apache </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Certbotが使用できるようになりました。次のコマンドを実行します。</font></font><br>
<br>
<pre><code class="plaintext hljs">$ sudo certbot --apache -d a-dobra.ru -d www.a-dobra.ru -d promo.a-dobra.ru</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 このコマンドはcertbotを実行します。キー</font></font><code>-d</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、証明書が発行されるドメイン名を決定します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
certbotを初めて実行する場合は、電子メールアドレスを入力して利用規約に同意するように求められます。その後、certbotはLet's Encryptサーバーに接続し、証明書を要求したドメインを実際に制御していることを確認します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてがうまくいくと、certbotはHTTPS構成をどのように構成するかを尋ねます。</font></font><br>
<br>
<pre><code class="plaintext hljs">Please choose whether or not to redirect HTTP traffic to HTTPS, removing HTTP access.<font></font>
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<font></font>
1: No redirect - Make no further changes to the webserver configuration.<font></font>
2: Redirect - Make all requests redirect to secure HTTPS access. Choose this for<font></font>
new sites, or if you're confident your site works on HTTPS. You can undo this<font></font>
change by editing your web server's configuration.<font></font>
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<font></font>
Select the appropriate number [1-2] then [enter] (press 'c' to cancel):</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オプション2を選択してEnterキーを押すことをお勧めします。</font><font style="vertical-align: inherit;">設定が更新され、変更を適用するためにApacheが再起動されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで証明書がアップロードされ、インストールされ、機能します。</font><font style="vertical-align: inherit;">https：//を使用してサイトをリロードしてみてください。ブラウザにセキュリティアイコンが表示されます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSL Labs Server Testを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用して</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">サーバーをテスト</font></a><font style="vertical-align: inherit;">すると、評価はAに</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
なります。Let's Encrypt証明書は90日間のみ有効ですが、先ほどインストールしたcertbotパッケージは証明書を自動的に更新します。</font><font style="vertical-align: inherit;">アップグレードプロセスをテストするために、ドライランcertbotを実行できます。</font></font><br>
<br>
<pre><code class="plaintext hljs">$ sudo certbot renew --dry-run </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 このコマンドの結果としてエラーが表示されなければ、すべてが機能します。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステップ5：MySQLおよびphpMyAdminへのアクセス</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くのウェブサイトはデータベースを使用しています。</font><font style="vertical-align: inherit;">データベースを管理するためのphpMyAdminツールは、すでにサーバーにインストールされています。</font><font style="vertical-align: inherit;">アクセスするには、次のようにブラウザのリンクをクリックします。</font></font><br>
<br>
<pre><code class="plaintext hljs">https://&lt;ip- &gt;:9997</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ルートアクセスのパスワードは、個人のMCSアカウント（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://mcs.mail.ru/app/services/marketplace/apps/</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">で取得できます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">初めてログインするときにrootパスワードを変更することを忘れないでください！</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステップ6：SFTP経由のファイルアップロードを構成する</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開発者がSFTPを介してWebサイトのファイルをアップロードすると便利です。</font><font style="vertical-align: inherit;">これを行うには、新しいユーザーを作成し、彼にウェブマスターと呼びます：</font></font><br>
<br>
<pre><code class="plaintext hljs">$ sudo adduser webmaster</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
システムはパスワードを設定し、他のデータを入力するように要求します。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ウェブサイトのディレクトリの所有者を変更します。</font></font><br>
<br>
<pre><code class="plaintext hljs">$ sudo chown -R webmaster:webmaster /var/www/a-dobra.ru/public_html</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、SSH構成を変更して、新しいユーザーがSSHターミナルではなくSFTPにのみアクセスできるようにします。 </font></font><br>
<br>
<pre><code class="plaintext hljs">$ sudo nano /etc/ssh/sshd_config</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
構成ファイルを最後までスクロールして、次のブロックを追加します。</font></font><br>
<br>
<pre><code class="plaintext hljs">Match User webmaster<font></font>
ForceCommand internal-sftp<font></font>
PasswordAuthentication yes<font></font>
ChrootDirectory /var/www/a-dobra.ru<font></font>
PermitTunnel no<font></font>
AllowAgentForwarding no<font></font>
AllowTcpForwarding no<font></font>
X11Forwarding no</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファイルを保存してサービスをリロードします。</font></font><br>
<br>
<pre><code class="plaintext hljs">$ sudo systemctl restart sshd</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、FileZillaなど、SFTPの任意のクライアントを介してサーバーに接続できます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">合計</font></font></h2><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これで、同じサーバー上に新しいディレクトリを作成し、Webサイトの仮想ホストを構成する方法がわかりました。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必要なSSL証明書を簡単に作成できます。これは無料で、自動的に更新されます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使い慣れたphpMyAdminを使用して、MySQLデータベースを簡単に操作できます。 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいSFTPアカウントの作成と権限の設定には、それほどの労力は必要ありません。</font><font style="vertical-align: inherit;">このようなアカウントは、サードパーティのWeb開発者やサイト管理者に転送できます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">システムを定期的に更新することを忘れないでください。また、バックアップを作成することをお勧めします。MCSでは、ワンクリックでシステム全体の「スナップショット」を取得し、必要に応じて画像全体を起動できます。 </font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
役立つリソース：</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">//www.digitalocean.com/community/tutorials/apache-ubuntu-14-04-lts-ru </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://www.digitalocean.com/community/tutorials/apache-let -s-encrypt-ubuntu-18-04-en </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://www.digitalocean.com/community/tutorials/how-to-enable-sftp-without-shell-access-on-ubuntu-18-04</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ちなみに、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こちら</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちの財団がMCSクラウドに基づく孤児のオンライン教育のためのプラットフォームをどのように立ち上げたかを、VCで読むことができます。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja461145/index.html">チームがリードすべきこと：役割、責任、スキル</a></li>
<li><a href="../ja461147/index.html">PowerPointでキーを組み合わせて64時間を節約する方法</a></li>
<li><a href="../ja461149/index.html">Kubernetesへの完璧なMongoDB移行</a></li>
<li><a href="../ja461151/index.html">アイデアから生産まで-IoTプロジェクトの開発</a></li>
<li><a href="../ja461153/index.html">フレームワークとしてのWebComponents、コンポーネントの相互作用</a></li>
<li><a href="../ja461157/index.html">フィードバックアシスタントが提供するもの-バグレポーターに代わる開発プラットフォーム</a></li>
<li><a href="../ja461159/index.html">Ivideon Bridge：レガシーCCTVシステムをクラウドに接続する方法</a></li>
<li><a href="../ja461161/index.html">Android設定の委任</a></li>
<li><a href="../ja461163/index.html">誕生日のパラドックスと電子署名の脆弱性とは何が関連していますか？</a></li>
<li><a href="../ja461165/index.html">生体測定が近づいています</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>