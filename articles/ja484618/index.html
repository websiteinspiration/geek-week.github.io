<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>☠️ 👧🏾 🐛 Angular 9とIvy：遅延コンポーネント読み込み 👧🏾 🧛🏽 🧔🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Angularでの遅延コンポーネント読み込み？たぶん、Angularルーターを使用した遅延読み込みモジュールについて話しているのでしょうか？いいえ、コンポーネントについて話しています。Angularの現在のバージョンでは、遅延モジュール読み込みのみがサポートされています。しかし、Ivyは開発者にコン...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Angular 9とIvy：遅延コンポーネント読み込み</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/484618/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Angularでの遅延コンポーネント読み込み？</font><font style="vertical-align: inherit;">たぶん、Angularルーターを使用した遅延読み込みモジュールについて話しているのでしょうか？</font><font style="vertical-align: inherit;">いいえ、コンポーネントについて話しています。</font><font style="vertical-align: inherit;">Angularの現在のバージョンでは、遅延モジュール読み込みのみがサポートされています。</font><font style="vertical-align: inherit;">しかし、Ivyは開発者にコンポーネントを扱う新しい機会を与えます。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/ox/8d/ub/ox8dubshhrdlijoson4_gyjtarw.png"></a><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これまでに使用した遅延負荷：ルート</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
遅延読み込みは優れたメカニズムです。 Angularでは、遅延ローディングをサポートするルートを宣言することにより、ほとんど何もせずにこのメカニズムを使用できます。これは、</font><font style="vertical-align: inherit;">これを示すAngular </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメントの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> routes: Routes = [<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="hljs-attr">path</span>: <span class="hljs-string">'customer-list'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">loadChildren</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./customers/customers.module'</span>).then(<span class="hljs-function"><span class="hljs-params">m</span> =&gt;</span> m.CustomersModule) }<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;];</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のコードのおかげで、の個別のフラグメントが作成され</font></font><code>customers.module</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ユーザーがルートをナビゲートするとロードされます</font></font><code>customer-list</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、プロジェクトのメインバンドルのサイズを縮小し、アプリケーションの初期ロードを高速化する非常に優れた方法です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、それにもかかわらず、遅延読み込みをより正確に制御できるようになればいいのではないでしょうか。</font><font style="vertical-align: inherit;">たとえば、個別のコンポーネントの遅延読み込みを整理できるとしたらどうでしょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これまで、これは不可能でした。</font><font style="vertical-align: inherit;">しかし、アイビーの登場ですべてが変わった。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アイビーと「産地」のコンセプト</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モジュールは、すべてのAngularアプリケーションの基本概念と基本構成要素です。モジュールは、コンポーネント、ディレクティブ、パイプ、サービスを宣言します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最新のAngularアプリケーションはモジュールなしでは存在できません。これの1つの理由は、ViewEngineが必要なすべてのメタデータをモジュールに追加するという事実です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一方、アイビーは別のアプローチをとります。 Ivyでは、コンポーネントはモジュールなしで存在できます。これは、地域性の概念のおかげで可能です。その本質は、すべてのメタデータがコンポーネントに対してローカルであることです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ivyを使用して生成されたes2015バンドルを分析してこれを説明しましょう。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/02b/775/370/02b7753703a0599491c3f9076527168f.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ivyを使用して生成されたEs2015-bundle</font></font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（コンポーネントコード）</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
セクションで</font></font><code>Component code</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、Ivyシステムがコンポーネントコードを保存したことがわかります。ここで特別なことは何もありません。しかし、Ivyはコードにいくつかのメタデータを追加します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図では、最初のメタデータが</font></font><code>Component factory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（コンポーネントファクトリ）</font><font style="vertical-align: inherit;">として示されてい</font><font style="vertical-align: inherit;">ます。ファクトリーはコンポーネントをインスタンス化する方法を知っています。</font></font><code>Component metadata</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（コンポーネントメタデータ）</font><font style="vertical-align: inherit;">セクションで、</font><font style="vertical-align: inherit;">Ivy</font><font style="vertical-align: inherit;">は</font></font><code>type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">およびの</font><font style="vertical-align: inherit;">ような追加の属性</font></font><code>selectors</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、つまりプログラムの実行中にコンポーネントが必要とするすべてのものを配置します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ivyがここに機能を追加することは言及する価値があります</font></font><code>template</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><code>Compiled version of your template</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（テンプレートのコンパイル済みバージョン）</font><font style="vertical-align: inherit;">セクションに示されてい</font><font style="vertical-align: inherit;">ます。この興味深い事実について詳しく説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
関数</font></font><code>template</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTMLコードのコンパイル済みバージョンです。</font><font style="vertical-align: inherit;">彼女はIvyの指示に従ってDOMを作成します。</font><font style="vertical-align: inherit;">これは、ViewEngineの動作とは異なります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ViewEngineシステムはコードを受け取り、それをバイパスします。</font><font style="vertical-align: inherit;">それを使用すると、Angularがコードを実行します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、Ivyが使用するアプローチでは、Angularコマンドを呼び出すコンポーネントがすべてを制御します。</font><font style="vertical-align: inherit;">この変更により、コンポーネントが独立して存在できるようになり、ツリーシェイクアルゴリズムをAngularベースコードに適用できるようになります。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">遅延コンポーネント読み込みの実際の例</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
遅延コンポーネント読み込みが可能であることがわかったので、実際の例で考えてみましょう。つまり、ユーザーに質問と回答オプションを尋ねるクイズアプリケーションを作成します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーションは、都市の画像と、この都市の名前を選択する必要があるオプションを表示します。ユーザーが対応するボタンをクリックしてオプションを選択するとすぐに、このボタンはすぐに変化し、正解か不正解かを示します。ボタンの背景が緑色に変わったら、答えが正しかったことを意味します。背景が赤に変わったら、答えが間違っていたことを意味します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現在の質問に対する回答を受け取ると、プログラムは次の質問を表示します。これがどのように見えるかです。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2fc/768/ece/2fc768ecebd5c52399030c0d2dc47c66.gif"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クイズアプリケーションのデモ</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
プログラムがユーザーに尋ねる質問は、コンポーネントによって提示されます</font></font><code>QuizCardComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">遅延コンポーネント読み込みの概念</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、遅延コンポーネント読み込みの一般的な考え方を説明しましょう</font></font><code>QuizCardComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4ab/45a/b2b/4ab45ab2b677ce0d886d2f26a5645edb.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QuizCardComponentコンポーネントを使用するプロセス</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ユーザーがボタンをクリックしてクイズを開始した後、</font><i><font color="#999999"><font style="vertical-align: inherit;">コンポーネント</font></font></i></font><code>Start quiz</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の遅延読み込みを開始します。</font><font style="vertical-align: inherit;">コンポーネントが自由に使用できるようになったら、コンテナーに配置します。</font><font style="vertical-align: inherit;">通常のコンポーネントのイベントに反応するのと同じ方法</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
で、</font></font><code>questionAnsvered</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「遅延」コンポーネントのイベントに反応します。</font><font style="vertical-align: inherit;">つまり、イベントの発生後、次の質問のカードが画面に表示されます。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コード分​​析</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンポーネントの遅延読み込み中に何が起こるかを理解するために</font></font><code>QuizCardComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、質問のプロパティを表示</font><font style="vertical-align: inherit;">する簡略バージョンから始め</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、Angular Materialコンポーネントを使用してこのコンポーネントを拡張します。</font><font style="vertical-align: inherit;">そして最後に、コンポーネントによって生成されたイベントに対する反応を調整します。</font><font style="vertical-align: inherit;">次のテンプレートを持つ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンポーネントの簡易バージョンの遅延読み込みを整理してみましょう</font></font><code>QuizCardComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Here's the question<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span>Image: <span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span> {{ question.image }}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span>Possible selections: <span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span> {{ question.possibleSelections.toString() }}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span>Correct answer: <span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span> {{ question.correctAnswer }}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初のステップは、コンテナー要素を作成することです。</font><font style="vertical-align: inherit;">これを行うには、などの実際の要素を使用するか</font></font><code>&lt;div&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、または-に頼ること</font></font><code>ng-container</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ができます。これにより、追加のレベルのHTMLコードは必要ありません。</font><font style="vertical-align: inherit;">これは、「遅延」コンポーネントを配置したコンテナ要素の宣言のようになります。</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mat-toolbar</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"primary"</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>City quiz<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mat-toolbar</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">button</span> *<span class="hljs-attr">ngIf</span>=<span class="hljs-string">"!quizStarted"</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">mat-raised-button</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"primary"</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">class</span>=<span class="hljs-string">"start-quiz-button"</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="hljs-attr">click</span>)=<span class="hljs-string">"startQuiz()"</span>&gt;</span>Start quiz<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">ng-container</span> #<span class="hljs-attr">quizContainer</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"quiz-card-container"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ng-container</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンポーネントでは、コンテナにアクセスする必要があります。</font><font style="vertical-align: inherit;">これを行うには、アノテーションを使用して、</font></font><code>@ViewChild</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">読みたいものを彼女に知らせます</font></font><code>ViewContainerRef</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angular 9では</font></font><code>static</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、アノテーション</font><font style="vertical-align: inherit;">のプロパティ</font><font style="vertical-align: inherit;">は</font></font><code>@ViewChild</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デフォルトで次のように</font><font style="vertical-align: inherit;">設定さ</font><font style="vertical-align: inherit;">れ</font><font style="vertical-align: inherit;">ていることに注意してください</font></font><code>false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="javascript hljs">@ViewChild(<span class="hljs-string">'quizContainer'</span>, {<span class="hljs-attr">read</span>: ViewContainerRef}) quizContainer: ViewContainerRef;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、「遅延」コンポーネントを追加するコンテナーができました。</font><font style="vertical-align: inherit;">次に、我々は必要</font></font><code>ComponentFactoryResolver</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>Injector</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">どちらも、依存性注入の方法論に頼ることで取得できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エンティティ</font></font><code>ComponentFactoryResolver</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、コンポーネントと</font></font><code>ComponentFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンポーネントのインスタンス化に使用できる</font><font style="vertical-align: inherit;">自動生成されたクラス間の関係を確立する単純なレジストリ</font><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">constructor</span>(private quizservice: QuizService,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private cfr: ComponentFactoryResolver,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private injector: Injector) {<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、目標を達成するために必要なものがすべて揃いました。メソッドのコンテンツに取り組み</font></font><code>startQuiz</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、コンポーネントの遅延読み込みを整理します。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> {QuizCardComponent} = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./quiz-card/quiz-card.component'</span>);
<span class="hljs-keyword">const</span> quizCardFactory = <span class="hljs-keyword">this</span>.cfr.resolveComponentFactory(QuizCardComponent);
<span class="hljs-keyword">const</span> {instance} = <span class="hljs-keyword">this</span>.quizContainer.createComponent(quizCardFactory, <span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span>.injector);<font></font>
instance.question = <span class="hljs-keyword">this</span>.quizservice.getNextQuestion();</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ECMAScriptコマンド</font></font><code>import</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用して、</font><font style="vertical-align: inherit;">遅延読み込みを整理</font><font style="vertical-align: inherit;">できます</font></font><code>QuizCardComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 import式はpromiseを返します。デザイン</font></font><code>async/await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">またはハンドラーの</font><font style="vertical-align: inherit;">いずれかを使用して作業でき</font></font><code>.then</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。 promiseを解決した後、構造化を使用してコンポーネントのインスタンスを作成します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最近では、下位互換性を使用する必要があります</font></font><code>ComponentFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。将来、コンポーネントを直接操作できるようになるため、対応する行は必要ありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
工場</font></font><code>ComponentFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は私たちに与え</font></font><code>componentRef</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。私たちは、合格</font></font><code>componentRef</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>Injector</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド</font></font><code>createComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテナ。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このメソッド</font></font><code>createComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font><code>ComponentRef</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、コンポーネントインスタンスが含まれている場所を</font><font style="vertical-align: inherit;">返します</font><font style="vertical-align: inherit;">。</font></font><code>instance</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンポーネントの転送に</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">します</font></font><code>@Input</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-プロパティ。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
将来的には、これらすべてはおそらくAngularメソッドを使用して行うことができ</font></font><code>renderComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">この方法はまだ実験段階です。</font><font style="vertical-align: inherit;">ただし、通常のAngularメソッドに変わる可能性が非常に高くなります。</font><font style="vertical-align: inherit;">このトピックに関する役立つ資料を</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下に示し</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンポーネントの遅延読み込みを整理するために必要なのはこれだけです。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2d4/2bd/4bc/2d42bd4bc38ee01c427c94286e060cbb.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">遅延コンポーネントの読み込み</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ボタンを押すと</font></font><code>Start quiz</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、遅延コンポーネントの読み込みが始まります。</font></font><code>Network</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">開発者ツールの</font><font style="vertical-align: inherit;">タブを開くと、</font><font style="vertical-align: inherit;">ファイルで表されたコードの一部を遅延ロードするプロセスを確認できます</font></font><code>quiz-card-quiz-card-component.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">コンポーネントをロードして処理した後、ユーザーには質問カードが表示されます。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンポーネント拡張</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これでコンポーネントをロードしています</font></font><code>QuizCardComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">とても良いです。</font><font style="vertical-align: inherit;">しかし、私たちのアプリケーションはまだ特に機能的ではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angular Materialの機能とコンポーネントを追加してこれを修正しましょう：</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mat-card</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"quiz-card"</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">mat-card-header</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">mat-card-avatar</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"quiz-header-image"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">mat-card-title</span>&gt;</span>Which city is this?<span class="hljs-tag">&lt;/<span class="hljs-name">mat-card-title</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">mat-card-subtitle</span>&gt;</span>Click on the correct answer below<span class="hljs-tag">&lt;/<span class="hljs-name">mat-card-subtitle</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">mat-card-header</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"image"</span> <span class="hljs-attr">mat-card-image</span> [<span class="hljs-attr">src</span>]=<span class="hljs-string">"'assets/' + question.image"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"Photo of a Shiba Inu"</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">mat-card-actions</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"answer-section"</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">button</span> [<span class="hljs-attr">disabled</span>]=<span class="hljs-string">"answeredCorrectly !== undefined"</span> *<span class="hljs-attr">ngFor</span>=<span class="hljs-string">"let selection of question.possibleSelections"</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">mat-stroked-button</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"primary"</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="hljs-attr">ngClass</span>]=<span class="hljs-string">"{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'correct': answeredCorrectly &amp;&amp; selection === question.correctAnswer,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'wrong': answeredCorrectly === false &amp;&amp; selection === question.correctAnswer
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}"</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="hljs-attr">click</span>)=<span class="hljs-string">"answer(selection)"</span>&gt;</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{selection}}<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">mat-card-actions</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mat-card</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンポーネントには美しいマテリアルコンポーネントがいくつか含まれています。</font><font style="vertical-align: inherit;">対応するモジュールはどうですか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、それらをに追加できます</font></font><code>AppModule</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">しかし、これはこれらのモジュールが「貪欲」モードでロードされることを意味します。</font><font style="vertical-align: inherit;">そして、これは良い考えではありません。</font><font style="vertical-align: inherit;">さらに、プロジェクトアセンブリは失敗し、次のメッセージが表示されます。</font></font><br>
<br>
<pre><code class="javascript hljs">ERROR <span class="hljs-keyword">in</span> src/app/quiz-card/quiz-card.component.html:<span class="hljs-number">9</span>:<span class="hljs-number">1</span> - error TS<span class="hljs-number">-998001</span>: <span class="hljs-string">'mat-card'</span> is not a known element:
<span class="hljs-number">1.</span> If <span class="hljs-string">'mat-card'</span> is an Angular component, then verify that it is part <span class="hljs-keyword">of</span> <span class="hljs-keyword">this</span> <span class="hljs-built_in">module</span>.
<span class="hljs-number">2.</span> If <span class="hljs-string">'mat-card'</span> is a Web Component then add <span class="hljs-string">'CUSTOM_ELEMENTS_SCHEMA'</span> to the <span class="hljs-string">'@NgModule.schemas'</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">this</span> component to suppress <span class="hljs-keyword">this</span> message.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何をすべきか？</font><font style="vertical-align: inherit;">おそらくすでに理解しているように、この問題は完全に解決可能です。</font><font style="vertical-align: inherit;">これはモジュールを使用して行うことができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、今回は以前とは少し異なる方法で使用します。</font></font><code>QuizCardComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ファイル内の</font></font><code>quizcard.component.ts</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">同じファイルに小さなモジュールを追加</font><font style="vertical-align: inherit;">します</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="javascript hljs">@NgModule({
&nbsp;&nbsp;<span class="hljs-attr">declarations</span>: [QuizCardComponent],
&nbsp;&nbsp;<span class="hljs-attr">imports</span>: [CommonModule, MatCardModule, MatButtonModule]<font></font>
})<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">QuizCardModule</span> </span>{<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
表現はございませんのでご了承ください</font></font><code>export</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このモジュール仕様は、遅延モードでロードされたコンポーネントにのみ属します。その結果、モジュールで宣言されている唯一のコンポーネントはになります</font></font><code>QuizCardComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。このセクション</font></font><code>import</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">では、コンポーネントに必要なモジュールのみをインポートします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいモジュールはエクスポートしないので、貪欲モードでロードされたモジュールはインポートできません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーションを再起動し、をクリックしたときの動作を確認します</font></font><code> Start quiz</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bc5/4bf/c60/bc54bfc6057cc6707e4f01a5bf871de9.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変更されたアプリケーションの分析</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Great！コンポーネントは</font></font><code>QuizCardComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">遅延モードでロードされ、に追加され</font></font><code>ViewContainer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。それとともに、必要なすべての依存関係がロードされます。</font><font style="vertical-align: inherit;">対応するnpmモジュールによって提供される</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ツールを使用して、アプリケーションバンドルを分析し</font></font><code>webpack-bundle-analyze</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。 Webpackによって生成されたファイルのコンテンツを視覚化し、結果のスキームを調べることができます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d2a/a5a/2aa/d2aa5a2aae380755aca3872db6d068f9.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーションバンドルの分析</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メイン</font><i><font color="#999999"><font style="vertical-align: inherit;">アプリケーションバンドルの</font></font></i><font style="vertical-align: inherit;">サイズは約260 Kbです。一緒にコンポーネントをダウンロードした場合</font></font><code>QuizCardComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ダウンロードしたデータのサイズは約270 KBになります。メインバンドルのサイズを10 Kb削減し、レイジーモードでコンポーネントを1つだけロードできたことがわかります。良い結果です！</font><font style="vertical-align: inherit;">アセンブリ後</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
のコード</font></font><code>QuizCardComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は別のファイルに移動します。このファイルの内容を分析すると、コードだけでなく、</font></font><code>QuizCardComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このコンポーネントで使用されているMaterialモジュールもあることがわかります。</font><font style="vertical-align: inherit;">andを</font><font style="vertical-align: inherit;">使用し</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ていても</font><font style="vertical-align: inherit;">、コードを含む完成したファイルに入るだけです</font><font style="vertical-align: inherit;">。この理由は、我々が使用していることである</font><font style="vertical-align: inherit;">として</font><font style="vertical-align: inherit;">、ボタンを表示し、</font></font><code>QuizCardComponent</code><font style="vertical-align: inherit;"></font><code>MatButtonModule</code><font style="vertical-align: inherit;"></font><code>MatCardModule</code><font style="vertical-align: inherit;"></font><code>MatCardModule</code><font style="vertical-align: inherit;"></font><code>MatButtonModule</code><font style="vertical-align: inherit;"></font><code>AppModule</code><font style="vertical-align: inherit;"></font><code>Start quiz</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">その結果、対応するコードはバンドルの別のフラグメントに分類されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、遅延ダウンロードが整理されました</font></font><code>QuizCardComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このコンポーネントは、マテリアルスタイルでデザインされたカードを表示します。カードには、画像、質問、回答オプション付きのボタンが含まれています。</font><font style="vertical-align: inherit;">これらのボタンのいずれかをクリックするとどうなりますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ボタンは、正解か不正解かによって、押すと緑または赤になります。</font><font style="vertical-align: inherit;">他に何が起こっているのですか？</font><font style="vertical-align: inherit;">何もない。</font><font style="vertical-align: inherit;">そして、ある質問に答えた後、別の質問のカードが表示される必要があります。</font><font style="vertical-align: inherit;">修理する。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">イベント処理</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
レイジーモードでロードされたコンポーネントのイベントに応答するメカニズムがまだ設定されていないため、回答ボタンをクリックしても、アプリケーションは新しい質問カードを表示しません。</font><font style="vertical-align: inherit;">コンポーネントがを</font></font><code>QuizCardComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用してイベントを生成する</font><font style="vertical-align: inherit;">ことはすでに知っています</font></font><code>EventEmitter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">クラスの定義を見ると、</font></font><code>EventEmitter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それが相続人であることがわかります</font></font><code>Subject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> declare <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EventEmitter</span>&lt;<span class="hljs-title">T</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">any</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">Subject</span>&lt;<span class="hljs-title">T</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、</font><font style="vertical-align: inherit;">新たなイベントに対するシステムの反応を設定できる</font></font><code>EventEmitter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法が</font></font><code>subscribe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あることを</font><font style="vertical-align: inherit;">意味し</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<pre><code class="javascript hljs">instance.questionAnswered.pipe(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;takeUntil(instance.destroy$)<font></font>
).subscribe(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">this</span>.showNewQuestion());</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、ストリームをサブスクライブし</font><font style="vertical-align: inherit;">、ロジックを実行する</font></font><code>questionAnswered</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド</font></font><code>showNextQuestion</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">呼び出します</font></font><code>lazyLoadQuizCard</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">async</span> showNewQuestion() {
&nbsp;&nbsp;<span class="hljs-keyword">this</span>.lazyLoadQuizCard();<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この設計は</font></font><code>takeUntil(instance.destroy$)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、コンポーネントが破棄された後に実行されるサブスクリプションをクリアするために必要です。</font></font><code>ngOnDestroy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンポーネントのライフサイクル</font><font style="vertical-align: inherit;">フックが呼び出さ</font></font><code>QuizCardComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">れる</font></font><code>destroy$</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>next</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、and </font><font style="vertical-align: inherit;">で呼び出されます</font></font><code>complete</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンポーネントはすでにロードされているため、システムは追加のHTTPリクエストを実行しません。</font><font style="vertical-align: inherit;">すでに持っているコードフラグメントのコンテンツを使用して、新しいコンポーネントを作成し、それをコンテナに配置します。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンポーネントのライフサイクルフック</font></font></font></h2><br><font style="vertical-align: inherit;"></font><code>QuizCardComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レイジーローディング技術を使用</font><font style="vertical-align: inherit;">
してコンポーネント</font><font style="vertical-align: inherit;">を操作する</font><font style="vertical-align: inherit;">と、ほとんどすべてのコンポーネントのライフサイクルフックが自動的に呼び出され</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">しかし、1つのフックだけでは十分ではありません。</font><font style="vertical-align: inherit;">どれが分かりますか？</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ceb/4f7/b2a/ceb4f7b2a34bbed6ced31f69713e4f68.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンポーネントのライフサイクル</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
フックこれは重要なフック</font></font><code>ngOnChanges</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">私たち自身がコンポーネントインスタンスの入力プロパティを更新するので、ライフサイクルフックの呼び出しも担当します</font></font><code>ngOnChanges</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">コンポーネントインスタンスの</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フックを呼び出すには</font></font><code>ngOnChanges</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、オブジェクトを自分で作成する必要があります</font></font><code>SimpleChange</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="javascript hljs">(instance <span class="hljs-keyword">as</span> any).ngOnChanges({
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">question</span>: <span class="hljs-keyword">new</span> SimpleChange(<span class="hljs-literal">null</span>, instance.question, <span class="hljs-literal">true</span>)<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
手動で</font></font><code>ngOnChanges</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンポーネントインスタンスを</font><font style="vertical-align: inherit;">呼び出し、</font><font style="vertical-align: inherit;">オブジェクトをそれに渡します</font></font><code>SimpleChange</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このオブジェクトは、変更が最初であること、以前の値が等しい</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こと、現在の値が質問であることを示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すごい！</font><font style="vertical-align: inherit;">コンポーネントにサードパーティのモジュールをロードし、それによって生成されたイベントに応答し、コンポーネントのライフサイクルに必要なフックの呼び出しを設定しました。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これは、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちがここで作業していた完成したプロジェクトのソースコードです。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">概要</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
遅延コンポーネント読み込みは、Angular開発者にアプリケーションのパフォーマンスを最適化する大きな機会を与えます。</font><font style="vertical-align: inherit;">彼が自由に使えるのは、遅延モードでロードされたマテリアルの構成を非常に微調整するためのツールです。</font><font style="vertical-align: inherit;">以前は、レイジーモードでルートのみを読み込むことができた場合、そのような精度はありませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
残念ながら、コンポーネントでサードパーティのモジュールを使用する場合は、モジュールも処理する必要があります。</font><font style="vertical-align: inherit;">ただし、これは将来変更される可能性があることを覚えておく価値があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ivyエンジンは、コンポーネントが独立して存在できるおかげで、ローカリティの概念を導入しました。</font><font style="vertical-align: inherit;">この変更は、Angularの将来の基盤です。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">読者の皆様！</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Angularプロジェクトで遅延コンポーネント読み込みテクニックを使用する予定はありますか？</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja484606/index.html">マイクロソフトは2030年までにマイナスの炭素排出量に完全に切り替えます</a></li>
<li><a href="../ja484610/index.html">さよならクリーンコード</a></li>
<li><a href="../ja484612/index.html">プロジェクトのビルド時間を最適化する</a></li>
<li><a href="../ja484614/index.html">安全なGoアプリケーションを開発するための6つの推奨事項</a></li>
<li><a href="../ja484616/index.html">Node.jsサービスのパフォーマンス最適化の経験から学んだ6つの教訓</a></li>
<li><a href="../ja484620/index.html">Omega Red Emulator用の新しいPS1グラフィックレンダラー</a></li>
<li><a href="../ja484624/index.html">インターバル断食-時間を正確に計算する方法</a></li>
<li><a href="../ja484628/index.html">ウィキペディア/グーグルの検閲の例としてのエリック・チャラメラ</a></li>
<li><a href="../ja484630/index.html">CES 2020：驚きの時</a></li>
<li><a href="../ja484636/index.html">モーターを制御する最も経済的な方法-周波数変換器</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>