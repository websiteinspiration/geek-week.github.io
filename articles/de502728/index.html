<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍⚖️ ❕ 🤪 Interessante Tricks und SSH-Tricks 😓 🖖 👃🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Einige Tipps zur effizienten Verwendung von SSH. Sprechen wir darüber, wie:
 
 

- Verwenden Sie die Zwei-Faktor-Authentifizierung für SSH-Verbindunge...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Interessante Tricks und SSH-Tricks</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502728/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einige Tipps zur effizienten Verwendung von SSH. </font><font style="vertical-align: inherit;">Sprechen wir darüber, wie:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verwenden Sie die Zwei-Faktor-Authentifizierung für SSH-Verbindungen</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es ist sicher, "Schlüsselweiterleitung" (Agentenweiterleitung) zu verwenden.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beenden Sie eine blockierte SSH-Sitzung.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lassen Sie das Terminal beim Verlassen oder Trennen offen.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teilen Sie das Remote-Terminal mit einem Freund (ohne Zoom!).</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/ib/ip/2b/ibip2baduhanlunu57eepm5ff3w.jpeg" alt="Bild"><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSH-Multi-Faktor-Authentifizierung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt fünf Möglichkeiten, einen zweiten Faktor für die Authentifizierung in SSH hinzuzufügen:</font></font><br>
<br>
<ol>
<li> <b> OpenSSH</b>     ( ). <br>
<br>
  2020   OpenSSH    FIDO U2F (Universal Second Factor).    ,   .<br>
<br>
          ,             8.2   .       <b><code>ssh -V</code></b>,      <b><code>nc [servername] 22</code></b>.<br>
<br>
       — <b><code>ecdsa-sk</code></b>  <b><code>ed25519-sk</code></b> (   ).             <b><code>$ ssh-keygen -t ecdsa-sk -f ~/.ssh/id_ecdsa_sk</code></b>.       ,    U2F .    U2F       ,   .<br>
<br>
          . OpenSSH        -sk-«» .        U2F .  ,       .      <b><code>$ ssh-keygen -t ecdsa-sk -O resident -f ~/.ssh/id_ecdsa_sk</code></b>.       ,        <b><code> $ ssh-add -K</code></b>.       .</li>
<li> <b> PIV+PKCS11  Yubikey.</b>      ,      SSH-,      .  Yubikey  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"> U2F+SSH with PIV/PKCS11</a>.     ,     FIDO U2F.   ,  .</li>
<li> <b> ssh- <code>yubikey-agent.</code></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Filippo Valsorda</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">SSH-  Yubikeys</a>.         .</li>
<li> <b> Touch ID  <code>sekey</code>.</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Sekey</a> —  SSH-    ,       secure enclave  MacOS       Touch ID.</li>
<li> <b> Single Sign On SSH.</b>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"></a>  .  Single Sign On SSH   ,          ,    .</li>
</ol><br>
<br>
<h2>    (agent forwarding)</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durch das Weiterleiten eines Schlüssels in SSH erhält der Remote-Host Zugriff auf Ihren lokalen SSH-Agenten. Wenn Ihr SSH-Client die Schlüsselweiterleitung verwendet (normalerweise durch die Option aktiviert </font></font><b><code>ssh -A</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), befinden sich zwei Kanäle in der Verbindung - Ihre interaktive Sitzung und der Schlüsselweiterleitungskanal. Der lokale SSH-Agent erstellt einen IPC-Socket, der über diesen Kanal eine Verbindung zum Remote-Host herstellt. Das ist gefährlich, weil Ein Benutzer mit Root-Rechten auf einem Remote-Host hat Zugriff auf Ihren lokalen SSH-Agenten und kann diesen möglicherweise verwenden, um in Ihrem Namen auf Netzwerkressourcen zuzugreifen. Mit dem Standard-SSH-Agenten, der mit OpenSSH geliefert wird, wissen Sie nie, was passiert ist. Wenn Sie jedoch einen U2F-Schlüssel (oder </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekey</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) verwenden, können Sie alle Versuche zur Verwendung Ihres SSH-Agenten stoppen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trotz dieser Einschränkung ist die regelmäßige Verwendung der Schlüsselweiterleitung durchaus akzeptabel. </font><font style="vertical-align: inherit;">Verwenden Sie diese Methode nicht für alle Ihre Verbindungen. </font><font style="vertical-align: inherit;">Verwenden Sie es nur, wenn Sie sicher sind, dass es in bestimmten Situationen benötigt wird.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beenden einer hängenden SSH-Sitzung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SSH-Sitzungen frieren häufig aufgrund von Netzwerkausfällen, Kontrollverlust durch ein ausführbares Programm oder einer der Terminalsteuerungssequenzen ein, die die Tastatureingabe blockieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier sind einige Möglichkeiten, um aus einer blockierten Sitzung herauszukommen:</font></font><br>
<br>
<ol>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Automatisches Beenden, wenn das Netzwerk unterbrochen wird. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In Ihrer SSH-Konfiguration müssen </font></font><code><b>.ssh/config</b></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie Folgendes hinzufügen: </font><font style="vertical-align: inherit;">Die Verbindung wird überprüft, indem jede </font><font style="vertical-align: inherit;">Sekunde </font><font style="vertical-align: inherit;">Echoanforderungen an den Remote-Host gesendet werden </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Wenn mehr als </font><font style="vertical-align: inherit;">solche Anfragen unbeantwortet bleiben, schließt SSH die Verbindung.</font></font><br>
<br>
<code><b>ServerAliveInterval 5<br>
ServerAliveCountMax 1<br>
</b></code><br>
<br>
<code><b>ssh</b></code><font style="vertical-align: inherit;"></font><code><b>ServerAliveInterval</b></code><font style="vertical-align: inherit;"></font><code><b>ServerAliveCountMax</b></code><font style="vertical-align: inherit;"></font></li>
<li><b> .</b> <code><b>ssh</b></code>   <code><b>~</b></code>     .  <code><b>~.</b></code>        (       ).<br>
<br>
 <code><b>~?</b></code>   ,      .       ,      <code><b>~</b></code> ,    .</li>
</ol><br>
<b>  ?</b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Als das Internet erfunden wurde, waren Computer nicht besonders mobil. Wenn Sie an einem Laptop arbeiten und zwischen IPv4-WLAN-Netzwerken wechseln, ändert sich Ihre IP-Adresse. Da SSH auf einer TCP-Verbindung basiert und TCP-Verbindungen von Verbindungspunkten mit festen IP-Adressen abhängen, geht Ihre SSH-Verbindung jedes Mal verloren, wenn Sie eine Verbindung zu einem anderen Netzwerk herstellen. Wenn sich Ihre IP-Adresse ändert, dauert es einige Zeit, bis der Netzwerkstapel feststellt, dass die Verbindung unterbrochen wurde. Eine TCP-Verbindung bedeutet nicht, dass eine der Parteien bei Netzwerkproblemen schnell heruntergefahren wird. Daher wird versucht, das Senden der Daten für einige Zeit erneut zu versuchen. In Ihrem Terminal bleibt die Sitzung hängen. IPv6 fügt Funktionen hinzu, mit denen Geräte ihre IP-Adresse beim Wechseln zwischen Netzwerken beibehalten können.Eines Tages wird dies kein Problem mehr sein.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So lassen Sie ein Terminal auf einem Remote-Host offen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt zwei Möglichkeiten, eine Sitzung zu speichern, wenn Sie zwischen Netzwerken wechseln oder die Verbindung für eine Weile trennen möchten:</font></font><br>
<br>
<ol>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verwenden Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mosh</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eternal Terminal</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Wenn Sie wirklich eine Verbindung benötigen, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die nicht abstürzt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , auch wenn Sie zwischen Netzwerken wechseln, verwenden Sie die Mosh - Mobile Shell. </font><font style="vertical-align: inherit;">Mosh ist eine sichere Shell, die SSH zum Initialisieren einer Sitzung (Handshake) verwendet und anschließend auf ihren eigenen verschlüsselten Kanal wechselt. </font><font style="vertical-align: inherit;">Dieser Kanal ist sehr stabil. </font><font style="vertical-align: inherit;">Es kann verschiedene Situationen bewältigen, einschließlich Unterbrechungen des Internets, Ändern der IP-Adresse Ihres Laptops, große Verzögerungen bei der Übertragung über das Netzwerk und andere. </font><font style="vertical-align: inherit;">Dank der Magie von UDP und dem von Mosh verwendeten Synchronisationsprotokoll.</font></font><br>
<br>
  Mosh       ,          60000–61000   UDP     .     mosh user@server  .<br>
<br>
Mosh        ,          SSH,      -    .          ,        . SSH        ,  ,  Mosh             .</li>
<li><b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">tmux</a>.</b>      ,           ,    tmux.   SSH- ,      <code><b>tmux attach</b></code>,     <code><b>tmux</b></code>.        —    ,      macOS       .<br>
<br>
  tmux   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Byobu</a> — ,        . Byobu    Ubuntu      macOS    Homebrew.</li>
</ol><br>
<br>
<h2>     </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie ein komplexes Problem mit Servern lösen, möchte ich eine SSH-Sitzung mit einer anderen Person teilen, die sich an einem anderen Ort befindet. </font><font style="vertical-align: inherit;">tmux ist das beste Tool zum Teilen von Terminals. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie müssen also Folgendes tun:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stellen Sie sicher, dass es </font></font><code><b>tmux</b></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auf Ihrem Server in DMZ installiert </font><font style="vertical-align: inherit;">ist </font><font style="vertical-align: inherit;">(oder wo Sie eine Verbindung herstellen möchten).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie müssen beide über SSH </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit demselben Konto</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> eine Verbindung zum Server herstellen </font><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einer von Ihnen muss ausgeführt werden </font></font><code><b>tmux</b></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, um eine </font></font><code><b>tmux</b></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sitzung </font><font style="vertical-align: inherit;">zu erstellen </font><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein anderer muss den Befehl ausführen </font></font><code><b>tmux attach</b></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voila! </font><font style="vertical-align: inherit;">Sie haben das Terminal freigegeben.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie mehr Feinabstimmung von Mehrbenutzersitzungen benötigen, verwenden Sie tmate, diesen Zweig, </font></font><code><b>tmux</b></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit dem Sie gemeinsam genutzte Sitzungen noch einfacher gestalten können. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Übersetzt von Andrey Zinchenko, Leiter der Rexoft Analytics-Abteilung</font></font></b></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de502716/index.html">Sie können Ihren Heimcomputer nicht freigeben? Machen Sie eins aus zwei</a></li>
<li><a href="../de502718/index.html">Das Talking Head-Projekt oder die Geschichte der Entwicklung von Software für einen Telepräsenzroboter</a></li>
<li><a href="../de502720/index.html">Testen von Trends für 2020</a></li>
<li><a href="../de502722/index.html">Silicon Valley auf Russisch. Wie # ITX5 in Innopolis funktioniert</a></li>
<li><a href="../de502726/index.html">WebRTC Erstellen einer Anwendung mit Blackjack- und Videoanrufen</a></li>
<li><a href="../de502730/index.html">Was wissen Industriedesigner über die Geräte, die Sie täglich verwenden? Oder 50 Jahre Transformation einer Computermaus</a></li>
<li><a href="../de502732/index.html">Buch "So testen Sie bei Google" - kostenlose elektronische Version</a></li>
<li><a href="../de502734/index.html">Bestätige besser grep</a></li>
<li><a href="../de502740/index.html">Wie desinfiziert man Flugzeuge im Zeitalter von Covid-19?</a></li>
<li><a href="../de502742/index.html">Wir laden Sie zu DINS DevOps EVENING (online) ein: der Entwicklung von Prometheus und Zabbix und der Verarbeitung von Nginx-Protokollen in ClickHouse</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>