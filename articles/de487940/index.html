<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📑 👨🏿‍🔧 👩🏻‍✈️ Reproduzierbares Rechnen in R. Wie trenne ich Code und Daten? 🚣🏽 ✍🏻 👩🏻‍💻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sehr oft sind regelmäßige Berechnungen und die Erstellung eines konsolidierten Berichts über autarke Daten erforderlich. Jene. nach Daten, die als Dat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Reproduzierbares Rechnen in R. Wie trenne ich Code und Daten?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/487940/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sehr oft sind regelmäßige Berechnungen und die Erstellung eines konsolidierten Berichts über autarke Daten erforderlich. </font><font style="vertical-align: inherit;">Jene. </font><font style="vertical-align: inherit;">nach Daten, die als Dateien gespeichert sind. </font><font style="vertical-align: inherit;">Dies können Daten sein, die aus Open Source, verschiedenen Dokumenten und Excel-Tabellen, Downloads von Unternehmenssystemen gesammelt wurden. </font><font style="vertical-align: inherit;">Rohdaten können mehrere Megabyte oder mehrere Gigabyte aufnehmen. </font><font style="vertical-align: inherit;">Daten können entpersönlicht sein oder vertrauliche Informationen enthalten. </font><font style="vertical-align: inherit;">In dem Fall, in dem der Berechnungscode im Repository abgelegt wird und die Arbeit von mehr als einer Person auf mehr als einem Computer ausgeführt wird, tritt das Problem auf, die Konsistenz des Codes und der Daten aufrechtzuerhalten. </font><font style="vertical-align: inherit;">Gleichzeitig ist es weiterhin erforderlich, die Einhaltung unterschiedlicher Zugriffsrechte auf den Code und die Daten sicherzustellen. </font><font style="vertical-align: inherit;">Was zu tun ist?</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es ist eine Fortsetzung </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">früherer Veröffentlichungen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></p><a name="habracut"></a><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RStudio entwickelt derzeit aktiv ein Paket </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><code>pins</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, um dieses Problem zu lösen. </font><font style="vertical-align: inherit;">Leider sind die verwendeten Backend-Lösungen in der Weite unseres Landes etwas unpopulär und teuer. </font><font style="vertical-align: inherit;">AWS, Azure, Google Cloud ... für jeden, den Sie bezahlen müssen, für Speicher und Datenverkehr. </font><font style="vertical-align: inherit;">AWS4 </font></font><code>pins</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unterstützt die </font><font style="vertical-align: inherit;">Authentifizierung </font><font style="vertical-align: inherit;">noch nicht, daher steht die Yandex-Cloud ebenfalls am Rande, obwohl sie nicht kostenlos ist.</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auf der anderen Seite sind Analystenteams, die an bestimmten Aufgaben arbeiten, normalerweise klein (nicht mehr als 5-10 Personen). </font><font style="vertical-align: inherit;">Viele verwenden Google Drive, One Drive usw. in einem kostenpflichtigen oder kostenlosen Format. </font><font style="vertical-align: inherit;">Warum nicht bereits erworbene Ressourcen nutzen? </font><font style="vertical-align: inherit;">Unten finden Sie einen der möglichen Workflows.</font></font></p><br>
<h1 id="obschiy-plan"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gesamtplan</font></font></h1><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Berechnungen sollten lokal auf der Maschine durchgeführt werden. Dies bedeutet, dass die Maschine über eine tatsächliche Kopie aller für die Berechnungen erforderlichen Daten verfügen muss.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Code muss unter Versionskontrolle stehen. </font><font style="vertical-align: inherit;">Daten sollten in keiner Weise dorthin gelangen (potenzielles Volumen und Vertraulichkeit). </font><font style="vertical-align: inherit;">Wir speichern das Datenreplikat entweder in einem separaten Ordner im Projekt (einschließlich in </font></font><code>.gitignore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) oder in einem externen Verzeichnis relativ zum Projekt.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Datenmaster wird von Google Drive gespeichert. </font><font style="vertical-align: inherit;">Wir platzieren die Rechte für den Zugriff auf Verzeichnisse darin.</font></font></li>
</ol><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es bleibt der Fall für kleine. </font><font style="vertical-align: inherit;">Es ist erforderlich, die Synchronisierungsfunktion des lokalen Datenreplikats mit der Cloud zu implementieren. </font><font style="vertical-align: inherit;">Die Autorisierung und Authentifizierung erfolgt durch Google.</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unten ist der Code.</font></font></p><br>
<pre><code class="python hljs">library(googledrive)<font></font>
library(memoise)<font></font>
<span class="hljs-comment">#    google disk</span><font></font>
drive_user()<font></font>
updateGdCache(here::here(<span class="hljs-string">"data/"</span>), cloud_folder = <span class="hljs-string">"XXX___jZnIW3jdkbdxK0iazx7t63Dc"</span>)</code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Funktion zur Cache-Synchronisation</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">updateGdCache &lt;- function(local_folder, cloud_folder){<font></font>
  #     <font></font>
  cache_fname &lt;- "gdrive_sig.Rds"<font></font>
  # 0.  memoise     <font></font>
  getGdriveFolder &lt;- memoise(function(gdrive_folder){<font></font>
    drive_ls(as_id(gdrive_folder), recursive = FALSE)<font></font>
  })<font></font>
<font></font>
  # 1.        <font></font>
  cloud_gdrive_sig &lt;- purrr::possibly(getGdriveFolder, NULL)(cloud_folder)<font></font>
  #          ,     <font></font>
  if(is.null(cloud_gdrive_sig)) {<font></font>
    message("Some Google Drive issues happened. Can't update cache")<font></font>
    return()<font></font>
  }<font></font>
  # 2.       <font></font>
  fdir &lt;- if(fs::is_dir(local_folder)) local_folder else fs::path_dir(local_folder)<font></font>
<font></font>
  # 3.       <font></font>
  local_files &lt;- fs::dir_ls(fdir, recurse = FALSE) %&gt;%<font></font>
    fs::path_file()<font></font>
<font></font>
  # 4.        <font></font>
  local_gdrive_sig &lt;- purrr::possibly(readRDS, NULL, quiet = TRUE)(fs::path(fdir, cache_fname))<font></font>
  if(is.null(local_gdrive_sig)){<font></font>
    #    ,   ,     <font></font>
    #  ,   <font></font>
    local_gdrive_sig &lt;- cloud_gdrive_sig %&gt;%<font></font>
      dplyr::filter(row_number() == -1)<font></font>
  }<font></font>
  #         <font></font>
  local_gdrive_sig &lt;- local_gdrive_sig %&gt;%<font></font>
    dplyr::filter(name %in% local_files)<font></font>
<font></font>
  # 5.      ,    ,   <font></font>
  #  ,       <font></font>
  reconcile_tbl &lt;- cloud_gdrive_sig %&gt;%<font></font>
    dplyr::rename(drive_resource_cloud = drive_resource) %&gt;%<font></font>
    dplyr::left_join(local_gdrive_sig, by = c("name", "id")) %&gt;%<font></font>
    tidyr::hoist(drive_resource_cloud, cloud_modified_time = "modifiedTime") %&gt;%<font></font>
    tidyr::hoist(drive_resource, local_modified_time = "modifiedTime") %&gt;%<font></font>
    # TODO:   ,       <font></font>
    #       = NA<font></font>
    dplyr::mutate(not_in_sync = is.na(local_modified_time) | cloud_modified_time != local_modified_time)<font></font>
<font></font>
  # 6.    <font></font>
  syncFile &lt;- function(fpath, id){<font></font>
    res &lt;- purrr::possibly(drive_download, otherwise = NULL)(as_id(id), path = fpath, overwrite = TRUE, verbose = TRUE)<font></font>
    ifelse(is.null(res), FALSE, TRUE)<font></font>
  }<font></font>
  #  ,        ,   <font></font>
  sync_gdrive_sig &lt;- reconcile_tbl %&gt;%<font></font>
    dplyr::filter(not_in_sync == TRUE) %&gt;%<font></font>
    dplyr::mutate(fpath = fs::path(fdir, name)) %&gt;%<font></font>
    dplyr::mutate(sync_status = purrr::map2_lgl(fpath, id, syncFile)) %&gt;%<font></font>
    dplyr::select(name, id, sync_status)<font></font>
<font></font>
  # 7.      ,   <font></font>
  #   <font></font>
  cloud_gdrive_sig %&gt;%<font></font>
    #   <font></font>
    dplyr::anti_join(dplyr::filter(sync_gdrive_sig, sync_status == FALSE), by = c("name", "id")) %&gt;%<font></font>
    saveRDS(fs::path(fdir, cache_fname))<font></font>
}</code></pre></div></div><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geben Sie die Ordner-ID in Google Drive als Pfad an. Sie können sie aus der Adressleiste des Browsers entnehmen. </font><font style="vertical-align: inherit;">Die Kennung bleibt auch dann unverändert, wenn der Ordner auf dem Laufwerk verschoben wird.</font></font></p><br>
<p><img src="https://habrastorage.org/webt/5b/fw/dl/5bfwdlta_xomy0p94rktyeppirk.png"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einfach, kompakt, bequem und kostenlos.</font></font></p><br>
<h1 id="para-zamechaniy"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einige Kommentare</font></font></h1><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es gibt Probleme mit der Codierung für die </font></font><code>gargle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Version 0.4.0. </font><font style="vertical-align: inherit;">Es ist notwendig, die Dev-Version zu laden. </font><font style="vertical-align: inherit;">Weitere Details </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es gibt Probleme mit der Autorisierung auf RStudio Server </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Autorisierung von RStudio Server # 79 {Closed} nicht möglich"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , aber Ideen für eine Problemumgehung finden Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ol><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vorherige Veröffentlichung - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Programmierung und Weihnachtsbaum, können sie kombiniert werden?" </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></p></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de487926/index.html">Auf der Suche nach Sportunterricht</a></li>
<li><a href="../de487930/index.html">Vorlesungsabend möchte ich gamedev</a></li>
<li><a href="../de487932/index.html">Ideale normale Karten für Unity (und andere Programme)</a></li>
<li><a href="../de487934/index.html">Wie wir unseren DNS-Server mit GO-Tools optimiert haben</a></li>
<li><a href="../de487938/index.html">Einführung von effector-dom anhand der Beispielaufgabenliste</a></li>
<li><a href="../de487944/index.html">Maschinelles Lernen im Energiesektor oder nicht nur jeder kann morgen zuschauen</a></li>
<li><a href="../de487948/index.html">Zwei-Faktor-Authentifizierung in OpenVPN mit Telegramm-Bot</a></li>
<li><a href="../en486014/index.html">SLAC Tour: US Department of Energy National Accelerator Laboratory at Stanford</a></li>
<li><a href="../en486018/index.html">Session Survey Results</a></li>
<li><a href="../en486024/index.html">Really simple graphics in R for science and journalism</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>