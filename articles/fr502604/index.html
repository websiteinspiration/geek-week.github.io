<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïµüèø üèπ ‚òîÔ∏è Une introduction √† TLS pour Patrik Patrick (Partie 1) üì´ üë®‚Äç‚ù§Ô∏è‚Äçüë® üë©üèø‚Äçüç≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Comme vous le savez peut-√™tre d√©j√†, voici Patrick. Il est une √©toile de mer, ce qui signifie qu'il est possible, sans l'insulter, de dire que ses main...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Une introduction √† TLS pour Patrik Patrick (Partie 1)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/plesk/blog/502604/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comme vous le savez peut-√™tre d√©j√†, voici Patrick. Il est une √©toile de mer, ce qui signifie qu'il est possible, sans l'insulter, de dire que ses mains poussent d'un endroit. Patrick est √©galement tr√®s pratique et oublie imm√©diatement tout ce dont il n'a pas besoin - mais s'il a besoin de quelque chose, il veut le savoir (parce qu'il en a besoin!). Spoiler: ici Patrick essaie de faire une poign√©e de main TLS. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/di/aa/64/diaa64cwcj8dktjvcv-4ba6wtbg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cet article est √©crit pour Patrick et des gens comme lui. Elle est n√©e d'une pr√©sentation pr√©sent√©e pour la premi√®re fois lors de notre formation interne Plesk TechTalk, o√π des employ√©s sous une forme accessible partagent des informations sur des technologies, des processus et des solutions int√©ressants. Par cons√©quent, les images de cet article ressembleront √† des diapositives :) L'auteur du texte original du rapport est le responsable du programme Plesk </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ruslan Kosolapov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En r√®gle g√©n√©rale, tout le mat√©riel TLS couvre un petit aspect, mais pas la grande image. </font><font style="vertical-align: inherit;">Ce n'est pas tr√®s pratique et Patrick a mal √† la t√™te. </font><font style="vertical-align: inherit;">Ici, tout sera diff√©rent: bref, applicable ¬´au quotidien¬ª et le plus exhaustivement possible.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qu'est-ce que TLS et pourquoi est-ce pour Patrick</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TLS (Transport Layer Security) est un protocole de protection de la couche transport. Il est n√©cessaire pour que personne ne puisse "vous √©couter" et trouver des informations importantes (le plus souvent des mots de passe, si l'on parle de travailler sur le r√©seau). Et aussi pour se prot√©ger de la falsification et de la modification du trafic lors de la transmission. C'est dans ces deux choses que r√©side le but de TLS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour plus de clart√©, consid√©rons la n√©gociation TLS comme un appel √† Patrick SpongeBob. Pendant un appel, quelqu'un peut √©couter la conversation (se tenir √† c√¥t√© de Patrick ou s'allumer au milieu de la ligne), et g√©n√©ralement le Bob l'√©ponge peut ne pas √™tre √† l'autre bout - tous ces probl√®mes sont pertinents. Et pour les r√©soudre, Patrick veut utiliser TLS. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En bref, la poign√©e de main de niveau sup√©rieur ressemble √† ceci: </font></font></b><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Patrick:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Je veux utiliser TLS, les versions de chiffrement sont telles ou telles.</font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spongebob:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ok, utilisons des versions chiffr√©es telles ou telles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s cela, SpongeBob envoie le certificat, Patrick le v√©rifie, dit que tout va bien, la cl√© de session est termin√©e (il y en a deux, mais cela n'a pas d'importance). Pourquoi utiliser une cl√© de session plut√¥t qu'un cryptage asym√©trique - car c'est plus rapide. Apr√®s cela, ils commencent √† parler une langue incompr√©hensible pour le d√©chiffrement. Ainsi, tout est prot√©g√©. </font></font><br>
<img src="https://habrastorage.org/webt/na/xj/yu/naxjyufzfjvlcazi16qsmlf5muq.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout semble simple. Comment cela fonctionne sur le mat√©riel n'est pas si important pour nous. Mais si vous commencez √† penser - et Patrick commence √† penser! - cela soul√®ve la question de savoir comment convenir g√©n√©ralement que nous utiliserons TLS? Apr√®s tout, il n'y avait pas de TLS, mais il n'y avait que des protocoles ordinaires - SMTP, HTTP. Comment dire ce qui est n√©cessaire sur TLS? Et ici, dans notre industrie, tout est comme d'habitude - il y a plusieurs fa√ßons!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au d√©but, ils voulaient utiliser un port sp√©cifique, ce qui impliquerait l'utilisation de TLS dessus. </font><font style="vertical-align: inherit;">Quels en sont les inconv√©nients? </font><font style="vertical-align: inherit;">Et pourquoi alors la m√©thode explicite (explicite) pour d√©marrer une session TLS est-elle apparue? </font><font style="vertical-align: inherit;">Il existe plusieurs raisons:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous avez besoin de beaucoup de ports - et les ports sont une chose que vous ne voulez pas d√©penser. </font><font style="vertical-align: inherit;">Parce que plus il y en a, plus il est difficile de configurer le pare-feu.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Le serveur peut ignorer cela - il s'est connect√© au port 443, et il n'y a pas de TLS, seulement HTTP sans HTTPS.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Avant l'√©tablissement de la connexion, vous ne pouvez pas savoir si le serveur TLS est pris en charge ou non.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout cela a conduit √† l'√©mergence d'une m√©thode explicite - lorsque nous nous connectons √† un port standard, puis mettons √† niveau notre session vers TLS. </font><font style="vertical-align: inherit;">Pour diff√©rents services, le protocole a des commandes diff√©rentes, par exemple, pour SMTP, il existe une commande distincte au niveau du protocole SMTP - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STARTTLS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">HTTP a aussi une telle blague, elle s'appelle </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Upgrade: TLS / 1.0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Au niveau du protocole, il est plus facile de comprendre si un serveur TLS est pris en charge ou non. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Laissez-nous nous attarder un peu plus sur les diff√©rents types de connexions et comment les choses sont avec TLS pour eux.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se connecter: HTTP</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout serait facile s'il n'y avait pas, comme toujours, de nuances. Dans le cas de HTTP, les exigences de s√©curit√© croissantes fournissent une √©volution constante du processus de travail avec TLS. Au d√©but, il y avait une redirection vers HTTPS, et cela se faisait simplement dans l'en-t√™te. Cela a laiss√© une faille pour les vuln√©rabilit√©s, alors Google a propos√© HSTS (HTTP Strict Transport Security). Il s'agit d'un tel en-t√™te dans la r√©ponse HTTP qui indique au navigateur: ¬´n'oubliez pas que lorsque vous arrivez sur ce domaine, allez directement en HTTPS, m√™me si la personne vous a dit d'aller sur HTTP¬ª. Ainsi, il n'y a pas de redirection et tout se passe beaucoup plus s√ªr. En outre, Google a une autre initiative: vous pouvez laisser une demande afin que votre site soit ajout√© √† la liste de Google Chrome ¬´Toujours utiliser HTTPS¬ª, quelles que soient les rubriques. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bri√®vement:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> HSTS r√©sout la redirection des vuln√©rabilit√©s HTTP vers HTTPS, donc presque tous les navigateurs prennent en charge HSTS, ce qui est bien.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connect: exotique (nouvelles versions de HTTP et pas seulement)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En HTTP / 2, les choses vont bien avec TLS: il est toujours utilis√© (comme les navigateurs sont maintenant faits). </font><font style="vertical-align: inherit;">De plus, TLS dans HTTP / 2 doit √™tre r√©cent - c'est-√†-dire avoir la version 1.2+. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tr√®s probablement, Google vendra tr√®s bient√¥t l'utilisation r√©pandue de HTTP / 3, maintenant il est adopt√© par la norme IANA. </font><font style="vertical-align: inherit;">L'histoire de son apparition et de son d√©veloppement est assez d√©routante; </font><font style="vertical-align: inherit;">La principale chose √† retenir de Patrick:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> HTTP / 3 est toujours TLS 1.3+.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTP / 3 est bas√© sur QUIC - c'est un tel protocole sur UDP, qui, selon Google, est meilleur que TCP. </font><font style="vertical-align: inherit;">En fait, avant que le nom HTTP / 3 ne soit finalement approuv√©, le protocole s'appelait HTTP sur QUIC.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe encore un protocole SCTP int√©ressant, utilis√© principalement dans les t√©l√©communications. </font><font style="vertical-align: inherit;">Au-dessus, TLS et DTLS sont utilis√©s (c'est un TLS pour UDP). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En bref:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans 2 ans, QUIC (c'est-√†-dire HTTP / 3) sera utilis√© partout, mais maintenant il devrait d√©j√† y avoir HTTP / 2 partout, mais en r√©alit√© il n'est pas partout.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se connecter: Mail</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De nombreux clients pensent qu'il devrait y avoir TLS sur le 587e port, mais il y a aussi des nuances ici: quelqu'un attend TLS par d√©faut et quelqu'un attend une demande </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STARTTLS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> explicite </font><font style="vertical-align: inherit;">du client. Pour cette raison, diverses combinaisons de serveur de messagerie et de client de messagerie provoquent parfois des effets ind√©sirables. Par exemple, un client entre dans le port 587, s'attendant √† ce qu'il y ait TLS, en m√™me temps, le serveur attend que le client demande explicitement </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STARTTLS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . N'ayant rien re√ßu, le client revient au port 25. Le r√©sultat est un commutateur silencieux vers une connexion SMTP non s√©curis√©e. Lors des tests et du d√©veloppement, il convient de se souvenir de ces effets des combinaisons client-serveur. Autodiscaver a diff√©rentes options pour sp√©cifier TLS: comment il doit √™tre, ce qui est attendu et ce qu'il faut faire. De nombreux clients de messagerie comprennent ces choses. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bri√®vement:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec la prise en charge TLS dans les serveurs de messagerie et les clients de messagerie, tout va bien en g√©n√©ral, mais dans des cas particuliers, il peut y avoir des probl√®mes et les extensions TLS ne sont pas tr√®s bien prises en charge.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se connecter: FTP</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On ne peut pas dire grand-chose ici. </font><font style="vertical-align: inherit;">Le principal probl√®me est SNI (c'est lorsque diff√©rents domaines sont sur la m√™me IP). </font><font style="vertical-align: inherit;">Au niveau FTP, le nom de domaine n'est pas transf√©r√©. </font><font style="vertical-align: inherit;">Dans une version explicite, cela ne peut pas fonctionner, car il n'y a nulle part o√π l'√©crire. </font><font style="vertical-align: inherit;">Il existe plusieurs options de solution - certaines le proposent, d'autres donc, une solution g√©n√©rale n'a pas encore √©t√© adopt√©e, il n'y a pas de norme. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En bref: il</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> existe une sorte de prise en charge TLS pour FTP (FTPS, SFTP - un analogue de FTP impl√©ment√© via SSH), mais certains aspects ne sont pas couverts en raison des limites techniques de FTP lui-m√™me.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prise de contact TLS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, maintenant nous savons comment initier la communication en utilisant TLS dans diff√©rentes connexions, et Patrick a pu communiquer son d√©sir √† SpongeBob. </font><font style="vertical-align: inherit;">Une fois qu'ils ont convenu d'utiliser TLS, la prise de contact TLS est produite. </font><font style="vertical-align: inherit;">Son r√©sultat devrait √™tre un accord entre le client et le serveur sur la fa√ßon dont ils chiffrent tout cela. </font><font style="vertical-align: inherit;">De plus, le client doit s'assurer que le serveur est bien celui qui est n√©cessaire. </font><font style="vertical-align: inherit;">Parfois, le serveur v√©rifie √©galement le client (mais beaucoup moins souvent).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chiffres et versions</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme d√©j√† mentionn√©, la premi√®re √©tape consiste √† choisir quelle version de TLS et quels chiffres seront utilis√©s pour le chiffrement. </font><font style="vertical-align: inherit;">Typiquement, le chiffrement ressemble √† ceci: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7j/bc/ne/7jbcnel13ieehyi6h6ibu9gi7r4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La suite de chiffrement est dans le registre IANA, et dans le protocole TLS sous forme binaire est seulement son ID. </font><font style="vertical-align: inherit;">Comme vous pouvez le voir sur la figure, voici non seulement (et pas seulement) le chiffrement, mais aussi son mode de fonctionnement et d'autres d√©tails n√©cessaires √† la prise de contact TLS. </font><font style="vertical-align: inherit;">Patrick n'a pas besoin d'entrer dans les d√©tails. </font><font style="vertical-align: inherit;">Tout ce qui est important √† ce stade est de se rappeler que ces lettres sont bonnes (et les autres sont mauvaises):</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> DHE</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ECDhe</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> AES128</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> AES256</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> RSA</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ecdsa</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cbc</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Gcm</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA256</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA383</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CHACHA20</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> POLY1308</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Image pour se souvenir de bons chiffres: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5o/oz/us/5oozuswdmgo1dmropfliew8ee3w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
s'il est difficile de s'en souvenir, il existe de bons services qui peuvent vous en parler, par exemple, un service de Mozilla </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ssl-config.mozilla.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/im/06/g0/im06g0jqgsdkw3kbie0c3lzfjcq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez imm√©diatement voir o√π et comment il est pris en charge - c'est ce que les gars de Mozilla essaient de suivre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un d√©tail int√©ressant: le client transf√®re les chiffres par ordre de priorit√© en fonction de leurs pr√©f√©rences, mais le serveur est laiss√© √† la d√©cision - il s√©lectionne le chiffre qui semble √™tre le meilleur dans la liste des clients pris en charge. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les deux c√¥t√©s indiquent √©galement la version maximale prise en charge du protocole - dans ce cas, Patrick est plus avanc√© que SpongeBob.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En fait un certificat</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec la r√©ponse ¬´Faisons comme √ßa¬ª, le serveur envoie son ou ses certificats - il peut y en avoir beaucoup. </font></font><br>
<img src="https://habrastorage.org/webt/ay/9m/p-/ay9mp-c7akdltxlnomatwwq1zdq.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qu'est-ce qu'un certificat? Il s'agit d'une relation d'information (sujet) - le plus souvent c'est le nom d'un domaine ou d'une organisation - et d'une cl√© publique (cl√© publique). Autrement dit, le certificat dit: ¬´Mec, ma cl√© publique est comme √ßa. Maintenant, avec son aide, nous nous mettrons d'accord sur les cl√©s de session. ¬ª De plus, avec son aide, vous pouvez v√©rifier la signature des certificats ou autre chose. Autrement dit, il serait possible d'utiliser non pas des certificats, mais des registres o√π cette relation est indiqu√©e. Et en fait, les pas dans cette direction se poursuivent, car le m√©canisme de l'autorit√© de certification n'est pas tr√®s bon, il n'y a tout simplement rien d'autre.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, le certificat est la structure de ¬´Sujet: Cl√© publique¬ª plus la signature de cet ishyuer (l'√©metteur en translitt√©ration en russe semble affreux, mais le synonyme le plus proche ici n'est pas tr√®s proche dans le contexte de l '¬´√©metteur¬ª) auquel ce certificat a √©t√© d√©livr√©. Ish√ºyer poss√®de √©galement un certificat et la connexion de quelqu'un avec quelque chose. Vous pouvez v√©rifier l'exactitude du certificat en prenant la cl√© publique de l'ishyuere et en v√©rifiant la signature. En cons√©quence, rien ne peut √™tre truqu√© ici. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Passons en revue le certificat et voyons quels probl√®mes il pourrait avoir. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/14/gt/ox/14gtoxx4czgwthkckj2vjyjfnbi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Premi√®rement, le num√©ro de s√©rie n'implique l'unicit√© que dans les limites de l'ishyuere, bien que certains logiciels consid√®rent qu'il est unique dans tout l'univers. Heureusement, le plus souvent, c'est vraiment compl√®tement unique.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le certificat indique √©galement quels algorithmes sont utilis√©s pour le chiffrement et la signature: RSA ou ECDSA, c'est-√†-dire quelle cryptographie utiliser pour travailler avec cette cl√© publique. La principale diff√©rence entre RSA et ECDSA est que le principe math√©matique de ECDSA est bas√© sur des courbes elliptiques, et RSA est simplement des nombres naturels, il est donc plus lent et d'√©normes bits de cl√©s sont utilis√©s (3-4 mille) pour √©viter qu'il ne soit fissur√© . Et pour ECDSA, une cl√© de 300 bits est suffisante et cela fonctionne plus rapidement. Par cons√©quent, beaucoup passent √† ECDSA - la poign√©e de main elle-m√™me est lourde et je veux la r√©duire. L'ECDSA peut √™tre demand√© lors de la d√©livrance d'un certificat, et si le prospecteur le soutient, il le fera pour vous. Mais la signature du certificat d√©pend de la cl√© priv√©e dont il dispose actuellement, et non de la question de savoir si vous avez demand√© ECDSA ou RSA.Par cons√©quent, les navigateurs peuvent montrer que l'un est dans la signature et l'autre dans la cl√© publique, et il n'est pas n√©cessaire d'avoir peur si la signature n'est pas ECDSA.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment obtenir un certificat?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En bref - comme ceci: </font></font><br>
<img src="https://habrastorage.org/webt/th/7f/f1/th7ff1g-1g54v0t-_genzf3rc3u.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Patrick dit √† l'autorit√© de certification: J'ai besoin d'un certificat. </font><font style="vertical-align: inherit;">Cette personne (ou organisation) v√©rifie si c'est Patrick. </font><font style="vertical-align: inherit;">Les ch√®ques peuvent √™tre tr√®s diff√©rents. </font><font style="vertical-align: inherit;">Bien s√ªr, Patrick en tant que client peut ne pas avoir de certificat, mais si le serveur n'a pas de certificat, il n'y aura pas de TLS. </font><font style="vertical-align: inherit;">Il est v√©rifi√© si tout est correctement indiqu√© dans la demande de certificat, si Patrick est r√©ellement propri√©taire du sujet pour lequel il demande un certificat. </font><font style="vertical-align: inherit;">Cela se fait par des centres d'autorit√© de certification sup√©rieurs - des personnes conditionnelles que tout le monde croit. </font><font style="vertical-align: inherit;">Pour √©mettre un certificat, vous devez √©tablir un CSR (demande de signature de certificat, demande de certificat).</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z1/mi/dk/z1midktpy8soeqqaz_xah-w0sn8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est aussi une structure, qui est assez difficile √† travailler, car il y a peu de services qui vous permettent de tout d√©finir, sp√©cifier, v√©rifier et tout voir. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Au total, nous g√©n√©rons une paire de cl√© publique: cl√© priv√©e, mais nous ne donnons que le public, et masquons le priv√©. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ensuite, nous g√©n√©rons une demande de signature de certificat et la signons avec notre cl√© priv√©e. </font><font style="vertical-align: inherit;">Nous envoyons tout cela √† l'autorit√© de certification et celle-ci d√©marre la v√©rification. </font><font style="vertical-align: inherit;">Cela peut √™tre diff√©rent, pour les certificats particuli√®rement int√©ressants, il existe des proc√©dures sp√©ciales difficiles, mais nous nous attarderons sur le cas g√©n√©ral.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CAA RR</font></font></h2><br>
<img src="https://habrastorage.org/webt/pg/rh/lw/pgrhlwwd8la4_perxzg4zawlyjy.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a un tel probl√®me que les gens que tout le monde croit ne sont parfois pas tr√®s bons. L'une des raisons pour lesquelles Symantec fait partie de DigiCert est qu'il (Symantec) a √©mis des certificats sans demander aux propri√©taires de domaine. Vous ne pouvez pas faire cela, c'√©tait insultant pour tout le monde, mais surtout pour Symantec lui-m√™me, car vous deviez vendre votre entreprise. Pour rendre le serveur moins d√©pendant de ces camarades sans scrupules, il existe une chose comme CAA RR - un enregistrement dans DNS, o√π il indique √† qui le propri√©taire permet d'√©mettre des certificats pour son domaine. Cette fonctionnalit√© est √©galement dans Plesk, elle est peu utilis√©e jusqu'√† pr√©sent, √† peu pr√®s comme DNSSec, mais n√©anmoins. Toutes les autorit√©s de certification ont accept√© de v√©rifier cette entr√©e et si elle indique que cette autorit√© de certification ne peut pas √™tre d√©livr√©e, elle indiquera: "vous n'avez pas r√©ussi la validation, c'est √©crit dans le CAA RR,que je ne peux pas √©crire un certificat pour vous "- et que je ne l'√©crirai pas. S'il n'y a pas d'entr√©e, vous pouvez. Maintenant, Google pousse l'initiative afin que les clients v√©rifient la conformit√© du certificat qu'ils ont re√ßu avec les enregistrements RR CAA. Le d√©bat est toujours en cours.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, CAA RR √† partir du moment o√π nous avons √©tendu leur prise en charge dans Plesk en indiquant les m√©thodes de validation (c'est-√†-dire, vous pouvez √©galement indiquer ici par quelle m√©thode vous validez que ce domaine est le v√¥tre) et l'URI du compte (Uniform Resource Identifier). </font><font style="vertical-align: inherit;">Populaire aupr√®s des utilisateurs, Plesk Let's Encrypt prend d√©j√† en charge tout cela (bravo!). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout cela fonctionne pour tout type de certificat, et puisque nous parlerons des diff√©rences plus tard, il est temps de parler plus en d√©tail des types.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Types de certificats</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y en a trois:</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Validation de domaine</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le sujet est un domaine, c'est-√†-dire que nous ne le v√©rifions ici. </font><font style="vertical-align: inherit;">Auparavant, lorsqu'il n'y avait pas de validateurs automatiques, la validation se faisait principalement par e-mail via le service Whois. </font><font style="vertical-align: inherit;">Cela a √©t√© consid√©r√© comme une raison suffisante de croire que vous √™tes le propri√©taire de ce domaine. </font><font style="vertical-align: inherit;">Puis ils ont pens√© √† v√©rifier via DNS - ils vous ont √©crit par e-mail: ¬´et ajoutez tel ou tel enregistrement au DNS¬ª. </font><font style="vertical-align: inherit;">Plus tard, des m√©thodes automatiques sont apparues (nous parlerons un peu plus loin d'ACME).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Validation de l'organisation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le champ ¬´sujet¬ª, en plus du nom de domaine, le nom de l'organisation est √©galement indiqu√©. </font><font style="vertical-align: inherit;">Le contr√¥le consiste √† valider si le domaine appartient √† cette organisation et si la personne qui est venue pour le certificat y travaille. </font><font style="vertical-align: inherit;">Comment cela se fait: ils recherchent des organisations sur les registres, appellent, demandent que quelque chose soit fait (le t√©l√©phone s'est av√©r√© √™tre correct, la bonne personne a r√©pondu, ce qui signifie que tout va probablement bien).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Validation √©tendue</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Identique √† OV, seulement plus frais. Tout est tr√®s r√©glement√© ici - un document de 40 pages dans l'esprit de "au paragraphe 5.6.8 devrait √™tre le suivant: ...", etc. Beaucoup de choses sont v√©rifi√©es - le pays, le d√©partement (si indiqu√© dans la demande), et parfois une personne sp√©ciale quitte m√™me pour voir avec ses yeux. Quelle est la diff√©rence pratique? Presque tous les navigateurs ont cess√© de faire la distinction entre OV et DV, ce qui est mauvais, car dans ce cas, le nom de l'organisation n'est pas affich√©. En cons√©quence, personne ne se soucie de cr√©er un domaine aliepxress.ru, de dessiner la m√™me page et de voler des cartes de cr√©dit. Et il sera absolument l√©gitime de cr√©er un tel domaine et d'obtenir un certificat DV dessus.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exemple avec EV - le nom de l'organisation est visible ici, donc si quelqu'un vole quelque chose, l'utilisateur saura que c'√©tait Valve Corp corporation, et l'enregistrement de la soci√©t√© est un peu plus difficile que le domaine (plus de contr√¥les). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6p/kp/kc/6pkpkccn848gjwl1osfx_yc0gjy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, tout va au point o√π EV cessera d'√™tre diff√©rent, sur les appareils mobiles, il n'est plus visible et vous devez appuyer sur un bouton s√©par√©, et dans Safari aussi. </font><font style="vertical-align: inherit;">Google Chrome tient toujours (UPD - plus maintenant! J'ai d√ª faire un √©cran √† partir d'IE). </font><font style="vertical-align: inherit;">L'argumentation de ceux qui ne montrent pas: ¬´si vous √™tes inquiet, cliquez et regardez¬ª, mais personne ne presse naturellement.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obtention d'un certificat: automatisation</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parlons maintenant de la r√©ception automatis√©e des certificats DV. </font><font style="vertical-align: inherit;">Pour plus de clart√©, voyons comment fonctionne notre syst√®me Let's Encrypt pr√©f√©r√©. </font><font style="vertical-align: inherit;">Il a g√©n√©ralement une bonne documentation, si quelqu'un est int√©ress√©, et m√™me en russe.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ACM√â</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ACME (Automatic Certificate Management Environment) est un protocole con√ßu pour automatiser et standardiser le processus d'obtention d'un certificat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment ACME prouve-t-il que vous √™tes propri√©taire d'un domaine? </font><font style="vertical-align: inherit;">Vous dites: Je veux un certificat et indiquez le type de validation automatique - par exemple, ACME HTTP-01. </font><font style="vertical-align: inherit;">Let's Encrypt vous demande de mettre les donn√©es dans un fichier, et si vous pouviez mettre les fichiers sur votre domaine (et Let's Encrypt pourrait les r√©cup√©rer √† partir de l√† via HTTP), vous en √™tes probablement le propri√©taire. </font><font style="vertical-align: inherit;">Maintenant, cette approche est critiqu√©e, y compris par Google, car elle ne prot√®ge pas contre le phishing. </font><font style="vertical-align: inherit;">Autrement dit, avec une validation manuelle, le domaine aliepxress.ru est susceptible de susciter des soup√ßons, mais Let's Encrypt lui-m√™me ne sait pas jusqu'√† pr√©sent comment (ou il peut, mais mal).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©fi DNS</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus d'ACME, il existe √©galement un d√©fi DNS. </font><font style="vertical-align: inherit;">Par exemple, ils vous disent: entrez un enregistrement txt dans votre zone DNS, mettez-y les donn√©es. </font><font style="vertical-align: inherit;">Il existe d'autres moyens, mais pas communs, et l'un a √©t√© annul√©, car il s'est r√©v√©l√© vuln√©rable. </font><font style="vertical-align: inherit;">Ce que nous avons dans Plesk: les certificats g√©n√©riques (qui ne peuvent √™tre √©mis que par challenge DNS) ne fonctionnent pas pour beaucoup de gens, car tr√®s souvent Plesk ne g√®re pas les zones DNS du domaine et l'extension </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's Encrypt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ne peut pas automatiser la cr√©ation d'un enregistrement dans la zone DNS .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encore deux mots sur Let's Encrypt</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un aspect important de l'utilisation des certificats Let's Encrypt est les limites. </font><font style="vertical-align: inherit;">En cas de doute (ou soup√ßon qu'ils ont √©t√© atteints), il est pr√©f√©rable de suivre le lien: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">letsencrypt.org/docs/rate-limits</font></font></a><br>
<img src="https://habrastorage.org/webt/c0/lx/5g/c0lx5gabymsjx5fzdqfvn1lk-ku.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parfois, ils sont mis √† jour. </font><font style="vertical-align: inherit;">Il y a des limites non √©videntes que les gens oublient: le plus souvent, √† en juger par les demandes de support, ils sont confront√©s √† une limite de 100 noms de domaine dans le certificat. </font><font style="vertical-align: inherit;">Let's Encrypt a √©galement un serveur de transfert et il y a plus de limites, mais ces certificats sont consid√©r√©s comme non fiables et pour le navigateur, ils sont similaires √† l'auto-signature. </font><font style="vertical-align: inherit;">Dans la pratique, avec une limite de 100 noms, ils nous parviennent rarement (malgr√© le fait que les sites sur Plesk ont ‚Äã‚Äãun total de 1 300 000 certificats Let's Encrypt). </font><font style="vertical-align: inherit;">La m√©diane, selon nos statistiques, est de 20 noms par certificat. </font><font style="vertical-align: inherit;">Donc, si quelque chose ne fonctionne pas, regardez - peut-√™tre que la limite est atteinte. </font><font style="vertical-align: inherit;">Let's Encrypt a un bon rapport d'erreurs, et vous pouvez g√©n√©ralement comprendre ce qui s'est pass√©.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et apr√®s?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, une fois le certificat re√ßu, le serveur transmet les donn√©es de cl√© de session - c'est ce qui sera utilis√© pour le chiffrement. </font><font style="vertical-align: inherit;">Si le serveur consid√®re qu'il est n√©cessaire d'authentifier le client (par exemple, l'acc√®s n'est ouvert qu'√† un certain cercle de personnes), il peut demander: le client, qui √™tes-vous? </font><font style="vertical-align: inherit;">Et puis le client devra envoyer son certificat. </font><font style="vertical-align: inherit;">Apr√®s avoir re√ßu le message </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ServerHelloDone, le</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> client se rend compte qu'il est temps de v√©rifier les certificats et de travailler avec les cl√©s. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout ce dont nous avons parl√©, avant que TLS 1.3 passe par un canal ouvert, et tout le monde peut voir toutes ces choses. </font><font style="vertical-align: inherit;">Il existe plusieurs attaques int√©ressantes que vous pouvez lire sur vous-m√™me. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la deuxi√®me </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s√©rie</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de l'article, nous apprendrons comment le client v√©rifie le certificat.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr502588/index.html">L'histoire incroyable de PowerPoint</a></li>
<li><a href="../fr502592/index.html">N√©omorphisme utilisant SwiftUI. Partie 1</a></li>
<li><a href="../fr502594/index.html">7 raisons pour lesquelles les projets Web ne sont pas interrompus et comment y faire face</a></li>
<li><a href="../fr502596/index.html">Cours √©ducatifs de quarantaine gratuits: conception</a></li>
<li><a href="../fr502598/index.html">Semaine de s√©curit√© 21: vuln√©rabilit√© du service d'impression Windows</a></li>
<li><a href="../fr502608/index.html">Comment nous avons lanc√© le march√© des applications dans le service SaaS</a></li>
<li><a href="../fr502614/index.html">Meilleures pratiques Kubernetes. D√©finition de requ√™tes et de limites de ressources</a></li>
<li><a href="../fr502620/index.html">Comptabilit√© mon√©taire</a></li>
<li><a href="../fr502624/index.html">Comment fonctionnent-ils sur Facebook? Valeurs et embauche dans une entreprise</a></li>
<li><a href="../fr502626/index.html">Captures d'√©cran iOS automatiques √† l'aide de XCTestplan et Xcode 11</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>