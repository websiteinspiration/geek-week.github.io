<!doctype html>
<html class="no-js" lang="hi">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯТз ЁЯР┐я╕П ЁЯСиЁЯП┐тАНЁЯОд PyDERASN: рдЬреИрд╕рд╛ рдХрд┐ рдореИрдВрдиреЗ рдмрдбрд╝рд╛-рдбреЗрдЯрд╛ рд╕рдорд░реНрдерди рдЬреЛрдбрд╝рд╛ рд╣реИ ЁЯХ┤ЁЯП╛ ЁЯХб ЁЯСйЁЯП┐тАНтЬИя╕П</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдореИрдВ PyDERASN рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдВрддрд┐рдо рд▓реЗрдЦ рдЬрд╛рд░реА рд░рдЦрддрд╛ рд╣реВрдВ - Python рдореЗрдВ рдореБрдлреНрдд ASN.1 DER / CER / BER рдХреЛрдбреЗрдХред рдкрд┐рдЫрд▓реЗ рдПрдХ рд╕рд╛рд▓ рдореЗрдВ, рдЗрд╕рдХреЗ рд▓реЗрдЦрди рдХреЗ рдмрд╛рдж рд╕реЗ, рд╕рднреА рдЫреЛрдЯреА рдЪреАрдЬреЛрдВ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>PyDERASN: рдЬреИрд╕рд╛ рдХрд┐ рдореИрдВрдиреЗ рдмрдбрд╝рд╛-рдбреЗрдЯрд╛ рд╕рдорд░реНрдерди рдЬреЛрдбрд╝рд╛ рд╣реИ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/498014/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореИрдВ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyDERASN рдХреЗ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдмрд╛рд░реЗ рдореЗрдВ рдЕрдВрддрд┐рдо рд▓реЗрдЦ рдЬрд╛рд░реА рд░рдЦрддрд╛ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рд╣реВрдВ</font></a><font style="vertical-align: inherit;"> - </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">Python</font></a><font style="vertical-align: inherit;"> рдореЗрдВ рдореБрдлреНрдд ASN.1 DER / CER / BER рдХреЛрдбреЗрдХред </font><font style="vertical-align: inherit;">рдкрд┐рдЫрд▓реЗ рдПрдХ рд╕рд╛рд▓ рдореЗрдВ, рдЗрд╕рдХреЗ рд▓реЗрдЦрди рдХреЗ рдмрд╛рдж рд╕реЗ, рд╕рднреА рдЫреЛрдЯреА рдЪреАрдЬреЛрдВ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЫреЛрдЯреЗ рд╕реБрдзрд╛рд░ рдФрд░ рдЗрд╕рд╕реЗ рднреА рдЕрдзрд┐рдХ рдХрдареЛрд░ рдбреЗрдЯрд╛ рд╕рддреНрдпрд╛рдкрди (рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ рдпрд╣ рдореЗрд░реЗ рд▓рд┐рдП рдЬреНрдЮрд╛рдд рдореБрдлреНрдд рдХреЛрдбреЗрдХреНрд╕ рдХрд╛ рд╕рдмрд╕реЗ рдХрдареЛрд░ рдерд╛), рдЗрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рдмрдбрд╝реА рдорд╛рддреНрд░рд╛ рдореЗрдВ рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рджрд┐рдЦрд╛рдИ рджреА рд╣реИ - рдирд╣реАрдВ рд░реИрдо рдореЗрдВ рд░реЗрдВрдЧрдирд╛ред </font><font style="vertical-align: inherit;">рдореИрдВ рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдВред</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/241/bae/4fc/241bae4fcfb5d7f0c3a605bf5f3211cb.png" alt="ASN.1 рдмреНрд░рд╛рдЙрдЬрд╝рд░"></div><a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдорд╕реНрдпрд╛рдПрдВ / рдХрд╛рд░реНрдп</font></font></h2><br>
<ul>
<li><strong> CRL</strong>:<br>
,      (CA)         X.509 .    ,    CRL (certificate revocation list). CRL  CACert.org,  8.72 MiB,   PyDERASN-  Python 3.6      (    <em>asn1crypto</em>  <em>pyasn1</em>   ).      416 .  .    ,           .  .<br>
</li>
<li><strong> CMS</strong>:<br>
CMS (Cryptographic Message Syntax)    <br>
// . ,<br>
<em>SignedData</em>     ,   ,<br>
  ,   - <em>EnvelopedData</em> <br>
 .<br>
<br>
                 CMS. , CMS   detached data,     - ,         .  10 GiB    20 GiB   :       10 GiB      . .<br>
</li>
</ul><br>
<h2> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ ASN.1 рд╡рд╕реНрддреБрдПрдВ рд╕рдВрд╕рд╛рдзрди рдЧрд╣рди рд╣реЛ рд╕рдХрддреА рд╣реИрдВ, рдмрд╣реБрдд рд╕рд╛рд░реЗ рдореЗрдореЛрд░реА рд╕реНрдкреЗрд╕ рд▓реЗ рд╕рдХрддреА рд╣реИрдВ? рдХреЗрд╡рд▓ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЗ рдЕрдиреБрдХреНрд░рдо</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЗ рд╕реЗрдЯ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрдИ рддрд░рд╣ рдХреА рдЪреАрдЬ (CACert.org рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рд▓рд╛рдЦреЛрдВ) рдпреБрдХреНрдд, рдФрд░ рдХреЗ рд╕рднреА рдкреНрд░рдХрд╛рд░ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* рддрд╛рд░</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (рджреВрд╕рд░реА рд╕рдорд╕реНрдпрд╛ рдкреИрджрд╛ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдорд╛рдорд▓реЗ рдореЗрдВ)ред рдЪреВрдВрдХрд┐ рдкреНрд░реЛрдЧреНрд░рд╛рдорд░ рдХреЗ рдЧреБрдгреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдЖрд▓рд╕реНрдп (рд▓реИрд░реА рд╡реЙрд▓ рдХреЗ рдЕрдиреБрд╕рд╛рд░) рд╣реИ, рд╣рдо рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛрдб рдореЗрдВ рдиреНрдпреВрдирддрдо рдкрд░рд┐рд╡рд░реНрддрди рдХреЗ рд╕рд╛рде рд╕рдВрд╕рд╛рдзрди рдЦрдкрдд рдХреА рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЛ рджреВрд░ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВрдЧреЗред </font></font><br>
<br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* STRING рдХреА</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд╕реНрддреБрдПрдВ, рдХреЛрдбреЗрдХ рдХреЗ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╕реЗ, рд▓рдЧрднрдЧ рдПрдХ рджреВрд╕рд░реЗ рд╕реЗ рднрд┐рдиреНрди рдирд╣реАрдВ рд╣реЛрддреА рд╣реИрдВ рдФрд░ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╡рд░реНрдЧ рджреНрд╡рд╛рд░рд╛ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рд▓рд╛рдЧреВ рдХреА рдЬрд╛рддреА рд╣реИрдВред </font><font style="vertical-align: inherit;">DER </font><font style="vertical-align: inherit;">рдореЗрдВ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OCTET STRING</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ </font><font style="vertical-align: inherit;">рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдХреНрдпрд╛ рд╣реИ </font><font style="vertical-align: inherit;">?</font></font><br>
<br>
<pre><code class="plaintext hljs">return tag + len_encode(len(value)) + value
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬрд╛рд╣рд┐рд░ рд╣реИ, </font><font style="vertical-align: inherit;">рдЗрд╕ рд╕рдордп </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реИрд▓реНрдпреВ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд░реИрдо рдореЗрдВ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рдПрдХ рдмрд╛рдЗрдЯреНрд╕ рдЬреИрд╕реА рд╡рд╕реНрддреБ рд╣реЛрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдЬрд┐рд╕рд╕реЗ рдЖрдк рд▓рдВрдмрд╛рдИ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВред </font></font><br>
<br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЗрдореЛрд░реАрд╡реНрдпреВ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЗрди рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЛ рд╕рдВрддреБрд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдФрд░ рдлрд┐рд░ рднреА </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memoryview</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mmap</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд┐ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА 20 рдЫрдорд╛рд╣реА рдореЗрдВ рд╕реАрдПрдордПрд╕ рдбреЗрдЯрд╛рдмреЗрд╕ рдкреНрд░рддрд┐рдпрд╛рдВ рдХреЗ рд▓рд┐рдП GiB 10 GiB рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рд╕реНрдореГрддрд┐ рдореЗрдВ рдХрдо рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐рд╕реА рднреА рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рдкрд░: рдпрд╣ рдореВрд▓реНрдп рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OCTET STRING</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд░реЛрдВ (рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* STRING</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд░реЛрдВ) </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЗрдореЛрд░реАрд╡реНрдпреВ рдХреЗ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдорд╛рди </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕реЗ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, PyDERASN рдХрд╛ рдПрдХ рд╕рд╣рд╛рдпрдХ рдХрд╛рд░реНрдп рд╣реИ:</font></font><br>
<br>
<pre><code class="plaintext hljs">from pyderasn import file_mmaped<font></font>
with open("dump.sql.zst", "rb") as fd:<font></font>
    ... = OctetString(file_mmaped(fd))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрджрд┐ рд╣рдо рднрд╛рд░реА рдорд╛рддреНрд░рд╛ рдореЗрдВ рдбреЗрдЯрд╛ рдХреЛ рдбреАрдХреЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЗрдореЛрд░реАрд╡реНрдпреВ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЛ рдбрд┐рдХреЛрдб рдХреЗ рд▓рд┐рдП </font><em><font style="vertical-align: inherit;">рднреА</font></em><font style="vertical-align: inherit;"> рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="plaintext hljs">from pyderasn import file_mmaped<font></font>
with open("dump.sql.zst", "rb") as fd:<font></font>
    obj = Schema.decode(file_mmaped(fd))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* STRING рдХреЛ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЖрдВрд╢рд┐рдХ рд░реВрдк рд╕реЗ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛рдПред </font><font style="vertical-align: inherit;">рдПрдХ рд╡рд┐рд╢рд╛рд▓ CRL рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд╛рдкрд╕ред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреА рд╕рдВрд░рдЪрдирд╛ рдХреНрдпрд╛ рд╣реИ?</font></font><br>
<br>
<pre><code class="plaintext hljs">CertificateList SEQUENCE<font></font>
. tbsCertList: TBSCertList SEQUENCE<font></font>
. . version: Version INTEGER v2 (01) OPTIONAL<font></font>
. . signature: AlgorithmIdentifier SEQUENCE<font></font>
. . issuer: Name CHOICE rdnSequence<font></font>
. . thisUpdate: Time CHOICE utcTime<font></font>
. . nextUpdate: Time CHOICE utcTime OPTIONAL<font></font>
. . revokedCertificates: RevokedCertificates SEQUENCE OF OPTIONAL<font></font>
. . . 0: RevokedCertificate SEQUENCE<font></font>
. . . . userCertificate: CertificateSerialNumber INTEGER 17 (11)<font></font>
. . . . revocationDate: Time CHOICE utcTime UTCTime 2003-04-01T14:25:08<font></font>
. . . 1: RevokedCertificate SEQUENCE<font></font>
. . . . userCertificate: CertificateSerialNumber INTEGER 20 (14)<font></font>
. . . . revocationDate: Time CHOICE utcTime UTCTime 2002-10-01T02:18:01<font></font>
<font></font>
                                 [...]<font></font>
<font></font>
. . . 415753: RevokedCertificate SEQUENCE<font></font>
. . . . userCertificate: CertificateSerialNumber INTEGER 1341859 (14:79:A3)<font></font>
. . . . revocationDate: Time CHOICE utcTime UTCTime 2020-02-08T06:51:56<font></font>
. . . 415754: RevokedCertificate SEQUENCE<font></font>
. . . . userCertificate: CertificateSerialNumber INTEGER 1341860 (14:79:A4)<font></font>
. . . . revocationDate: Time CHOICE utcTime UTCTime 2020-02-08T06:53:01<font></font>
. . . 415755: RevokedCertificate SEQUENCE<font></font>
. . . . userCertificate: CertificateSerialNumber INTEGER 1341861 (14:79:A5)<font></font>
. . . . revocationDate: Time CHOICE utcTime UTCTime 2020-02-08T07:25:06<font></font>
. signatureAlgorithm: AlgorithmIdentifier SEQUENCE<font></font>
. signatureValue: BIT STRING 4096 bits<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЫреЛрдЯреЗ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RevchedCertificate</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдВрд░рдЪрдирд╛рдУрдВ </font><font style="vertical-align: inherit;">рдХреА рдПрдХ рд▓рдВрдмреА рд╕реВрдЪреА </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдХреЗрд╡рд▓ рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдХрд╛ рд╕реАрд░рд┐рдпрд▓ рдирдВрдмрд░ рдФрд░ рдЗрд╕рдХреЗ рдирд┐рд░рд╕рди рдХрд╛ рд╕рдордп рд╣реЛрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдбреАрдИрдЖрд░ рдХреЛрдбрд┐рдВрдЧ рдХреНрдпрд╛ рд╣реИ?</font></font><br>
<br>
<pre><code class="plaintext hljs">value = b"".join(revCert.encode() for revCert in revCerts)<font></font>
return tag + len_encode(len(value)) + value<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рд╕реВрдЪреА рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдЕрд▓рдЧ-рдЕрд▓рдЧ рддрддреНрд╡ рдХреЗ рдбреАрдИрдЖрд░ рдЕрднреНрдпрд╛рд╡реЗрджрди рдХрд╛ рд╕рд┐рд░реНрдл рдирд┐рд╖реНрдХрд░реНрд╖ред </font><font style="vertical-align: inherit;">рдХреНрдпрд╛ рд╣рдореЗрдВ рдХреЗрд╡рд▓ рдбреАрдИрдЖрд░ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХреЗ 15 рдмрд╛рдЗрдЯреНрд╕ рдореЗрдВ рдХреНрд░рдордмрджреНрдз рд╣реЛрдиреЗ рдХреЗ рджреМрд░рд╛рди рдЗрди рд╕рднреА рд╕реИрдХрдбрд╝реЛрдВ рд╣рдЬрд╛рд░реЛрдВ рд╡рд╕реНрддреБрдУрдВ рдХреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? </font><font style="vertical-align: inherit;">рдмреЗрд╢рдХ рдирд╣реАрдВред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рд╣рдо рдПрдХ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ / рдЬрдирд░реЗрдЯрд░ рдХреЗ рд╕рд╛рде рд╡рд╕реНрддреБрдУрдВ рдХреА рд╕реВрдЪреА рдХреЛ рдмрджрд▓рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ, CRL рдХрд╛ рдирд┐рд░реНрдорд╛рдг DBMS рдХреЗ рдбреЗрдЯрд╛ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реЛрдЧрд╛:</font></font><br>
<br>
<pre><code class="plaintext hljs">def revCertsGenerator(...):<font></font>
    for row in db.cursor:<font></font>
        yield RevokedCertificate((<font></font>
            ("userCertificate", CertificateSerialNumber(row.serial)),<font></font>
            ("revocationDate", Time(("utcTime", UTCTime(row.revdate)))),<font></font>
        ))<font></font>
<font></font>
crl["tbsCertList"]["revokedCertificates"] = revCertsGenerator()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рдЗрд╕ рддрд░рд╣ рдХреА CRL рдмрдирд╛рддреЗ рд╕рдордп рд╣рдо рдореЗрдореЛрд░реА рдХрд╛ рдЙрдкрднреЛрдЧ рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ - рд╣рдореЗрдВ рдХреЗрд╡рд▓ рдЗрд╕рдХреЗ рдбреАрдИрдЖрд░ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЬрдЧрд╣ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ: рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдо рджрд╕рд┐рдпреЛрдВ рдореЗрдЧрд╛рдмрд╛рдЗрдЯреНрд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░ рд░рд╣реЗ рд╣реИрдВ (рдЬреИрд╕рд╛ рдХрд┐ RevCCertificate рд╡рд╕реНрддреБрдУрдВ рдХреА рдЖрдзреА-рдЧреАрдЧрд╛рдмрд╛рдЗрдЯ рд╕реВрдЪреА рдХреЗ рд╡рд┐рдкрд░реАрдд рд╣реИ)ред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рд╡рд╣рд╛рдБ рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ рдЕрдВрддрд░ рд╣реЛрддрд╛ рд╣реИ: </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЗ рдЕрдиреБрдХреНрд░рдо</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЗ рд╕реЗрдЯ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЖрдХрд╛рд░ рдХреА рдЬрд╛рдВрдЪ </font><font style="vertical-align: inherit;">рдПрдХ рдореВрд▓реНрдп рдмрддрд╛рдП рдХреЗ рдкрд▓ рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ рдХреЗ рдмрд╛рдж рд╣реА рдЗрдЯрд░реЗрдЯрд░ рд╕рдорд╛рдкреНрдд рд╣реЛ рд░рд╣рд╛ рд╣реИ, рдФрд░ рдирд╣реАрдВред</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DER рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рдХреЛрдбрд┐рдВрдЧ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдЕрд╕рдВрднрд╡ рд╣реИред рдЖрдЦрд┐рд░рдХрд╛рд░, рдпрд╣ рдбреАрдИрдЖрд░ рд╣реИ - рд╕рднреА рдЯреАрдПрд▓рд╡реА (рдЯреИрдЧ + рд▓рдВрдмрд╛рдИ + рдореВрд▓реНрдп) рддрддреНрд╡реЛрдВ рдХреА рд▓рдВрдмрд╛рдИ рдкрд╣рд▓реЗ рд╕реЗ рдЬреНрдЮрд╛рдд рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд▓реЗрдХрд┐рди рдореИрдВ рдЗрддрдирд╛ рдЪрд╛рд╣реВрдВрдЧрд╛! рдЖрдЦрд┐рд░рдХрд╛рд░, рд╣рдореЗрдВ рдЕрднреА рднреА рдбреЗрдЯрд╛рдмреЗрд╕ рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдХреЗ рдбреАрдИрдЖрд░ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 10 рдЬреАрдИрдмреА рдореЗрдореЛрд░реА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ: </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрдЪреНрдЪрд╛ = рд╕реЗрдореА.рдПрдирдХреЛрдб ()</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ! рдЖрджрд░реНрд╢ рд░реВрдк рд╕реЗ, рдореИрдВ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓реЗрдЦрдХ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЛ рдмрддрд╛рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдВ </font><font style="vertical-align: inherit;">рдЬрд╣рд╛рдВ рдзрд╛рд░рд╛рд╡рд╛рд╣рд┐рдХ рд░реВрдк рд╕реЗ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рд▓рд┐рдЦрд╛ рдЬрд╛рдПрдЧрд╛ред рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдлрд╝рд╛рдЗрд▓ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░реЗрдВ, рд▓рдВрдмрд╛рдИ рдХреЗ рд╕реНрдерд╛рди рдкрд░ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдкреНрд▓реЗрд╕рд╣реЛрд▓реНрдбрд░ рдЫреЛрдбрд╝ рджреЗрдВ рдФрд░ рдлрд┐рд░ рдЙрдиреНрд╣реЗрдВ рдЦреЛрдЬ рдХрд░ рднрд░реЗрдВ? рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рд▓рдВрдмрд╛рдИ рдХреА рд▓рдВрдмрд╛рдИ (рдХреНрд░рдорд╢рдГ рдФрд░ рдкреНрд▓реЗрд╕рд╣реЛрд▓реНрдбрд░) рднреА рдкрд╣рд▓реЗ рд╕реЗ рдЬреНрдЮрд╛рдд рдирд╣реАрдВ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PyDERASN рдХреЛ рджреЛ-рдкрд╛рд╕ рдбреАрдИрдЖрд░ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдорд┐рд▓реА рд╣реИред рдкрд╣рд▓реЗ рдкрд╛рд╕ рдореЗрдВ, рд╡рд╕реНрддреБрдУрдВ рдХреА рд▓рдВрдмрд╛рдИ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬреНрдЮрд╛рди рдПрдХрддреНрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдПрдХ рдЕрд╕реНрдерд╛рдпреА рд╕реНрдерд┐рддрд┐ рдмрдирддреА рд╣реИред рджреВрд╕рд░рд╛ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рд╣реИ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓реЗрдЦрдХ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рдбреАрдИрдЖрд░ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ </font><font style="vertical-align: inherit;">, рд▓рдВрдмрд╛рдИ рдХреЗ рдЬреНрдЮрд╛рди рдХреЗ рдХрд╛рд░рдг рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕рдВрднрд╡ рд╣реИред рдЗрд╕ рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╕рд░рд▓ рдирд┐рдХрд▓рд╛, рдмрд╕ ASN.1 рдЖрдзрд╛рд░ рдкреНрд░рдХрд╛рд░реЛрдВ рдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдореЗрдВ рджреЛ-рдкрд╛рд╕ рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдПрдХ рд╕рд╛ рдЬреЛрдбрд╝ рджрд┐рдпрд╛ рдЧрдпрд╛ред рдЪреВрдВрдХрд┐ рд╡рд╕реНрддреБрдУрдВ рдХрд╛ рдЯреНрд░рд╛рд╡реЗрд▓рд░ рдХрдбрд╝рд╛рдИ рд╕реЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╣реЛрддрд╛ рд╣реИ (рдбреА - рдкреНрд░рддрд┐рд╖реНрдард┐рдд!), рдлрд┐рд░, рдЖрд╡рд╢реНрдпрдХ рд▓рдВрдмрд╛рдИ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рд╕рд░рд▓ рд╕реВрдЪреА рдмрдирд╛рдП рд░рдЦреА рдЬрд╛рддреА рд╣реИ, рдЬрд┐рд╕рдХреЗ рд░реВрдк рдореЗрдВ, рд╡рд╕реНрддреБрдУрдВ рдХреЗ рдкреВрд░реЗ рдкреЗрдбрд╝ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд▓рдВрдмрд╛рдИ рдорд╛рди рдЬреЛрдбрд╝реЗ рдЬрд╛рддреЗ рд╣реИрдВред рдХреБрдЫ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП, рд▓рдВрдмрд╛рдИ рддрдп рдХреА рдЧрдИ рд╣реИред рдХреБрдЫ рдХреЗ рд▓рд┐рдП, рдпрд╣ рдХреЗрд╡рд▓ рдПрдХ рдЙрдЪреНрдЪ рдХрдВрдЯреЗрдирд░ ( </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SEQUENCE</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SEQUENCE OF</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET OF</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EXPLICIT TAG</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">рдХреЛ рд░рд┐рдкреЛрд░реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ </font><font style="vertical-align: inherit;">ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рджреЛ рдирд┐рд░рд╕реНрдд рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреА рд╕реВрдЪреА рдХреЗ рд▓рд┐рдП рд▓рдВрдмрд╛рдИ рдХреА рд╕реНрдерд┐рддрд┐ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реИ:</font></font><br>
<br>
<pre><code class="plaintext hljs">revCert = RevokedCertificate((<font></font>
    ("userCertificate", CertificateSerialNumber(123)),<font></font>
    ("revocationDate", Time(("utcTime", UTCTime(datetime.utcnow())))),<font></font>
))<font></font>
revs = RevokedCertificates([revCert, revCert])<font></font>
<font></font>
(42, [40, 18, 18])<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░реАрд╡реЙрдХреНрдб рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ рд╕рдВрдкреВрд░реНрдг рд╕реВрдЪреА рдХреЗ </font><font style="vertical-align: inherit;">рд▓рд┐рдП рдХреЗрд╡рд▓ рдорд╛рди рдХреА рд▓рдВрдмрд╛рдИ рдЬрд╛рдирдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред рд░рд╛рдЬреНрдп рдореЗрдВ рдкреВрд░реНрдгрд╛рдВрдХ рдФрд░ рдПрдиреНрдХреЛрдб рдХрд┐рдП рдЧрдП рд╕рдордп рдХреА рд▓рдВрдмрд╛рдИ (рдбреАрдИрдЖрд░ рдореЗрдВ рдпрд╣ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рд▓рдВрдмрд╛рдИ рд╣реИ) рдХреЛ рдЕрдирд╛рд╡рд╢реНрдпрдХ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдирддреАрдЬрддрди, рд╣рдорд╛рд░реЗ CACert.org CRL рдХреЗ рд▓рд┐рдП, рдЗрд╕ рддрд░рд╣ рдХреА рд╕реВрдЪреА рдореЗрдВ 3.5 MiB рд╕реЗ рдереЛрдбрд╝рд╛ рдЕрдзрд┐рдХ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИ, рдФрд░ рд╡рд┐рд╢рд╛рд▓ рд╕реАрдПрдордПрд╕ рдХреЗ рд▓рд┐рдП, рдЬрд┐рд╕рдореЗрдВ рд▓рдЧрднрдЧ рд╕рднреА рд╡рдЬрди рдбреЗрдЯрд╛рдмреЗрд╕ рдХреА рдПрдХ рдкреНрд░рддрд┐ рдХреЗ рд╕рд╛рде рдПрдХ рдПрдХрд▓ рдХреНрд╖реЗрддреНрд░ рдкрд░ рдкрдбрд╝рддрд╛ рд╣реИ, рдЗрд╕рдореЗрдВ рд▓рдЧрднрдЧ 0.5 KiB рд▓рдЧрддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рджреЛ рдХреЙрд▓ рджреНрд╡рд╛рд░рд╛ рджреЛ-рдкрд╛рд╕ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="plaintext hljs">fulllen, state = obj.encode1st()<font></font>
with open("result", "wb") as fd:<font></font>
    obj.encode2nd(fd.write, iter(state))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкрд╣рд▓рд╛ рдкрд╛рд╕ рдбреЗрдЯрд╛ рдХреА рдкреВрд░реА рд▓рдВрдмрд╛рдИ рдХреА рднреА рд░рд┐рдкреЛрд░реНрдЯ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдореБрдХреНрдд рд╕реНрдерд╛рди рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдпрд╛ рдЗрд╕реЗ рдХреБрдЫ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреЙрдЬрд╝рд┐рдХреНрд╕_рдлреНрд▓реЛрдХреЗрдЯ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЙрд▓ </font><font style="vertical-align: inherit;">рджреНрд╡рд╛рд░рд╛ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣реЗрд▓реНрдкрд░ рдлрд╝рдВрдХреНрд╢рди </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдиреНрдХреЛрдб 2рдкрд╛рд╕ (obj)</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ </font><em><font style="vertical-align: inherit;">,</font></em><font style="vertical-align: inherit;"> рдЖрдк рдореЗрдореЛрд░реА рдореЗрдВ рджреЛ-рдкрд╛рд╕ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдкреНрд░рджрд░реНрд╢рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдХрд┐рд╕ рд▓рд┐рдП? рдпрд╣ рдореЗрдореЛрд░реА рдЦрдкрдд рдореЗрдВ рдХрд╛рдлреА рдЕрдзрд┐рдХ рдХрд┐рдлрд╛рдпрддреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ CACert.org CRL рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, 416k + рдЫреЛрдЯреА рдмрд╛рдЗрдирд░реА рд▓рд╛рдЗрдиреЛрдВ рдХреЛ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b ""</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реЗ рдЬреЛрдбрд╝рдХрд░ рд╕реНрдЯреЛрд░ рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ </font><font style="vertical-align: inherit;">ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рдкреНрд░реЛрд╕реЗрд╕рд░ рд╕рдордп рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╕рднреА рд╡рд╕реНрддреБрдУрдВ рдХреЛ рджреЛ рдмрд╛рд░ рдЪрд▓рдирд╛ рд╣реЛрдЧрд╛ред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╣рдо рдбреАрдИрдЖрд░ рдореЗрдВ рдордирдорд╛рдиреЗ рдврдВрдЧ рд╕реЗ рдмрдбрд╝реЗ CMS рдХреЛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рд░реВрдк рд╕реЗ рдмрд┐рдирд╛ рдореЗрдореЛрд░реА рдХрд╛ рдЙрдкрднреЛрдЧ рдХрд┐рдПред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рд╕реАрдЖрд░рдПрд▓ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдордиреЗ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рдирд┐рд░рд╕реНрддреАрдХрд░рдг рдЬрдирд░реЗрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛, рдЬреЛ рдкрд╣рд▓реЗ рдкрд╛рд╕ рдХреЗ рдЕрдВрдд рдХреЗ рдмрд╛рдж рдмрд╛рд╣рд░ рдирд┐рдХрд▓ рдЬрд╛рдПрдЧрд╛ред </font><font style="vertical-align: inherit;">рдХреНрдпрд╛ рдХрд░реЗрдВ? </font><font style="vertical-align: inherit;">рдмрд╕ рдЗрд╕реЗ рдлрд┐рд░ рд╕реЗ рдкреБрдирд░реНрдирд┐рдорд┐рдд рдХрд░реЗрдВ!</font></font><br>
<br>
<pre><code class="plaintext hljs">_, state = crl.encode1st()<font></font>
crl["tbsCertList"]["revokedCertificates"] = revCertsGenerator()<font></font>
crl.encode2nd(writer, iter(state))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдмреЗрд╢рдХ, рд╣рдо </font><font style="vertical-align: inherit;">рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд░рдиреЗ рдХреЗ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд▓рд┐рдП </font><strong><font style="vertical-align: inherit;">рдмрд╛рдзреНрдп рд╣реИрдВ</font></strong><font style="vertical-align: inherit;"> рдХрд┐ рдкреБрдирд░рд╛рд╡реГрддреНрдд рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдмрд┐рд▓реНрдХреБрд▓ рд╡реИрд╕рд╛ рд╣реА рд╣реЛрдЧрд╛, рдЕрдиреНрдпрдерд╛ рд╣рдореЗрдВ рдПрдХ рдЯреВрдЯрд╛ рд╣реБрдЖ рдбреАрдИрдЖрд░ рдорд┐рд▓реЗрдЧрд╛ред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдбреЗрдЯрд╛ DBMS рдХрд░реНрд╕рд░ рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">REPEATABLE READ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд▓реЗрди-рджреЗрди рдЕрд▓рдЧрд╛рд╡ рд╕реНрддрд░ рдФрд░ рдЫрдБрдЯрд╛рдИ рдХреЗ </font><font style="vertical-align: inherit;">рдмрд╛рд░реЗ рдореЗрдВ рдордд рднреВрд▓рдирд╛ </font><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕реНрдЯреНрд░реАрдо рдПрдиреНрдХреЛрдбрд┐рдВрдЧ: CER</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рдЬрд╛рдирддреЗ рд╣реИрдВ, рдбреАрдИрдЖрд░ (рдкреНрд░рддрд┐рд╖реНрдард┐рдд рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдирд┐рдпрдо) рдмреАрдИрдЖрд░ (рдмреБрдирд┐рдпрд╛рджреА рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдирд┐рдпрдореЛрдВ) рдХрд╛ рдПрдХ рд╕рдмрд╕реЗрдЯ рд╣реИ рдЬреЛ рдПрдХ рдФрд░ рдХреЗрд╡рд▓ рдПрдХ рд╣реА рддрд░реАрдХреЗ рд╕реЗ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдирд┐рдпрдореЛрдВ рдХреЛ рд╕рдЦреНрддреА рд╕реЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдЗрд╕реЗ рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлрд┐рдХ рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рд▓реЗрдХрд┐рди рдмреАрдИрдЖрд░: рд╕реАрдИрдЖрд░ (рдХреИрдиреЛрдирд┐рдХрд▓ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдирд┐рдпрдо) рдХрд╛ рдПрдХ рдФрд░ рдЙрд▓реНрд▓реЗрдЦрдиреАрдп рдЙрдкрд╕рдореБрдЪреНрдЪрдп рд╣реИред рдбреАрдИрдЖрд░ рдХреА рддрд░рд╣, рдЗрд╕рдореЗрдВ рдбреЗрдЯрд╛ рдХрд╛ рдХреЗрд╡рд▓ рдПрдХ рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рд╣реИред рд╕реАрдИрдЖрд░ рдХрдИ рд╡рд┐рд╡рд░рдгреЛрдВ рдореЗрдВ рдбреАрдИрдЖрд░ рд╕реЗ рдЕрд▓рдЧ рд╣реИ, рд▓реЗрдХрд┐рди рд╡реЗ рдЖрдкрдХреЛ рдбреЗрдЯрд╛ рдХрд╛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рд╕реАрдИрдЖрд░ рдбреАрдИрдЖрд░ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЛрдХрдкреНрд░рд┐рдп рдирд╣реАрдВ рд╣реБрдЖред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрддрдиреЗ рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░ (рдЬреИрд╕реЗ SET рдореЗрдВ рдЯреИрдЧ рдХреЛ рдЫрд╛рдБрдЯрдирд╛) рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддреЗ рд╣реБрдП, CER рдХреЗ DER рд╕реЗ рджреЛ рдореВрд▓рднреВрдд рдЕрдВрддрд░ рд╣реИрдВ:</font></font><br>
<br>
<ul>
<li>    (constructed,  )  indefinite  (<em>LENINDEF</em>   PyDERASN).  ,  <em>SEQUENCE</em>/<em>SET</em>, <em>SEQUENCE OF</em>/<em>SET OF</em>, <em>EXPLICIT TAG</em>-  :<br>
<br>
<pre><code class="plaintext hljs">TAG_CONSTRUCTED || LEN(VALUE) || VALUE
</code></pre><br>
 <em>LENINDEF</em> (0x80)  EOC ( ,  )   :<br>
<br>
<pre><code class="plaintext hljs">TAG_CONSTRUCTED || 80 || VALUE || 00 00
</code></pre><br>
</li>
<li><em>*STRING</em>-,    1000-,  chunk-  1000-. ,      ,   DER. , 512          DER:<br>
<br>
<pre><code class="plaintext hljs">TAG_PRIMITIVE || LEN(512) || 512B
</code></pre><br>
 2048  :<br>
<br>
<pre><code class="plaintext hljs">TAG_CONSTRUCTED || 80 ||<font></font>
    TAG_PRIMITIVE || LEN(1000) || 1000B ||<font></font>
    TAG_PRIMITIVE || LEN(1000) || 1000B ||<font></font>
    TAG_PRIMITIVE || LEN(48) || 48B || 00 00<font></font>
</code></pre></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рд╕рдм (рдкреНрд▓рд╕ рдХреБрдЫ рдЫреЛрдЯреА рдЪреАрдЬреЗрдВ) рдХрд┐рд╕реА рднреА рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рдПрдирдХреЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ (1000 рдмрд╛рдЗрдЯреНрд╕ рдХреЗ рд╕рд╛рде рдмрдлрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдмрдлрд░) рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЗрд╕реА рддрд░рд╣, рдЖрдк </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mmap</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдпреЛрдВ рдХрд╛ </font><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред CER рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдмрд╕ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.encode_cer (рд▓реЗрдЦрдХ)</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд┐рдзрд┐ </font><font style="vertical-align: inherit;">рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, PyDERASN рдбрд┐рдХреЛрдбрд┐рдВрдЧ рдХреЗ рджреМрд░рд╛рди рдЕрднреА рддрдХ CER рдХреА рд╡реИрдзрддрд╛ рдХреЛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдбреЗрдЯрд╛ рдХреЛ BER рдХреЗ рд░реВрдк рдореЗрдВ рдбреАрдХреЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CMS рдорд╛рдирдХ, рд╡реИрд╕реЗ, BER (рджреЛрдиреЛрдВ DER рдФрд░ CER, рд╕реНрд╡рдЪрд╛рд▓рд┐рдд, BER рд╣реИрдВ) рдореЗрдВ рдХреЛрдбрд┐рдВрдЧ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдЗрд╕рд▓рд┐рдП, рд╣рдо рдбреЗрдЯрд╛рдмреЗрд╕ рдХреА рдЕрдкрдиреА рд╡рд┐рд╢рд╛рд▓ рдкреНрд░рддрд┐ рдХреЛ рджреЛ-рдкрд╛рд╕ рдбреАрдИрдЖрд░ рдХреЗ рдмрд┐рдирд╛ рд╕реАрдИрдЖрд░ рд╕реАрдПрдордПрд╕ рдореЗрдВ рд╕рдВрд▓рдЧреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдБрдХрд┐</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╛рдЗрдирдбреИрдЯрд╛ рдХреЗ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд▓рд┐рдП </font><font style="vertical-align: inherit;">рдбреАрдИрдЖрд░ рдореЗрдВ рдПрдирдХреЛрдбреЗрдб </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯреЗрдб рдПрд▓реАрдореЗрдВрдЯреНрд╕</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рддрддреНрд╡ </font><em><font style="vertical-align: inherit;">рд╣реЛрдирд╛</font></em><font style="vertical-align: inherit;"> рдЖрд╡рд╢реНрдпрдХ рд╣реИ </font><font style="vertical-align: inherit;">, рдЬреИрд╕рд╛ рдХрд┐ X.509 </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рдорд╛рдг рдкрддреНрд░ред </font><font style="vertical-align: inherit;">PyDERASN рдЖрдкрдХреЛ рджрд┐рдП рдЧрдП рд╕рдВрд░рдЪрдирд╛рдУрдВ рдореЗрдВ DER рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЛ рдХреЗрд╡рд▓ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der_lied = True</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд┐рд╢реЗрд╖рддрд╛ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝рдХрд░ рдмрд╛рдзреНрдп рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдЯреНрд░реАрдо рдбрд┐рдХреЛрдбрд┐рдВрдЧ: рдИрд╡рдЬрди рдореЛрдб</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдордиреЗ рд╕рд╛рдВрдХреЗрддрд┐рдХ рд╢рдмреНрджреЛрдВ рдореЗрдВ рдмрджрд▓рдирд╛ рд╕реАрдЦ рд▓рд┐рдпрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдХреЗрд╡рд▓ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mmap</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдбрд┐рдХреЛрдбрд┐рдВрдЧ рдореЗрдВ рдорджрдж рдХрд░реЗрдЧрд╛ </font><font style="vertical-align: inherit;">ред рдПрдХ "рд╡рд╛рд╕реНрддрд╡рд┐рдХ" рд╕реНрдЯреНрд░реАрдо рдбрд┐рдХреЛрдбрд░, рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ "рдореБрдЭреЗ рдЕрдзрд┐рдХ рдбреЗрдЯрд╛ рджреЗрдВ", "рдпрд╣рд╛рдВ рдЖрдк рд╣реИрдВ" рдХреЗ рд░реВрдк рдореЗрдВ knobs рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдХрд┐рд╕реА рдкреНрд░рдХрд╛рд░ рдХрд╛ рд░рд╛рдЬреНрдп - PyDERASN рдХреЗ рдПрдХ рдХрдЯреНрдЯрд░рдкрдВрдереА рдкрд░рд┐рд╡рд░реНрддрди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред рдФрд░, рд╡реНрдпрдХреНрддрд┐рдЧрдд рд░реВрдк рд╕реЗ, рдореИрдВ рдпрд╣ рдирд╣реАрдВ рджреЗрдЦрддрд╛ рдХрд┐ рдпрд╣ рд╡рд░реНрддрдорд╛рди рд╕рдорд╛рдзрд╛рди рд╕реЗ рдЕрдзрд┐рдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реЛрдЧрд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ рд╡рд░реНрддрдорд╛рди рд╕рдорд╛рдзрд╛рди рдЕрддреНрдпрдВрдд рд╕рд░рд▓ рд╣реИред рдбрд┐рдХреЛрдбрд┐рдВрдЧ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, рд╣рдорд╛рд░реЗ рд╣рд╛рде рдореЗрдВ рд╣рдорд╛рд░реЗ рд╣рд╛рдереЛрдВ рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рдбрд┐рдХреЛрдбреЗрдб рдЖрджрд┐рдо рд╡рд╕реНрддреБрдПрдВ рд╣реЛрддреА рд╣реИрдВ, рдЙрдирдореЗрдВ рд╕реЗ рдмреЗрд╣рддрд░ рдШрдЯрдХреЛрдВ (рдирд┐рд░реНрдорд┐рдд), рдЬрд┐рдирдореЗрдВ рд╕реЗ рдЕрдиреНрдп рдШрдЯрдХ, рдЖрджрд┐ рдХреЛ рдЗрдХрдЯреНрдард╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ ... рд╣рдо рд╡рд╕реНрддреБрдУрдВ рдХреЛ рд╕рдВрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдЪрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдФрд░, рдмрд╣реБрдд рдКрдкрд░ рддрдХ рдкрд╣реБрдВрдЪрддреЗ рд╣реИрдВ рд╣рдореЗрдВ рдПрдХ рдмрдбрд╝реА рд╡рд╕реНрддреБ рджреЛред рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ </font><strong><font style="vertical-align: inherit;">рдбрд┐рдХреЛрдб рдХрд┐рдП</font></strong><font style="vertical-align: inherit;"> рдЧрдП "рддреБрд░рдВрдд рдмрд╛рд╣рд░" рдХреНрдпреЛрдВ рдирд╣реАрдВ</font></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд╕реНрддреБрдУрдВ, рдЬреИрд╕реЗ рд╣реА рд╡реЗ рд╣рдорд╛рд░реЗ рд╣рд╛рдереЛрдВ рдкрд░ рджрд┐рдЦрд╛рдИ рджреЗрддреЗ рд╣реИрдВ? </font><font style="vertical-align: inherit;">рдпрд╣реА рд╣реИ, рдПрдХ рдЕрдВрддрд┐рдо рд╡рд╕реНрддреБ рдирд╣реАрдВ рд▓реМрдЯрдирд╛, рд▓реЗрдХрд┐рди рдПрдХ рдЬрдирд░реЗрдЯрд░ рдЬреЛ рдХрдИ рдбрд┐рдХреЛрдб рдХрд┐рдП рдЧрдП рдСрдмреНрдЬреЗрдХреНрдЯ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, PyDERASN рдореЗрдВ рдЕрдм рд╕рднреА рдбрд┐рдХреЛрдбрд┐рдВрдЧ рд╡рд┐рдзрд┐рдпрд╛рдБ рдРрд╕реЗ "рдИрд╡реЗрдВрдЯ" (рдИрд╡реЗрдВрдЯ рдЬрдирд░реЗрд╢рди, рдЗрд╡рдЬрди) рдХреЗ рдЬрдирдХ рдмрди рдЧрдП рд╣реИрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрджрд┐ рд╣рдо рдЕрдкрдиреЗ рд╡рд┐рд╢рд╛рд▓ CACert.org CRL рдХреЗ рдИрд╡рдЬрди-рдбрд┐рдХреЛрдбрд┐рдВрдЧ рдореЛрдб рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд┐рддреНрд░ рджреЗрдЦреЗрдВрдЧреЗ:</font></font><br>
<br>
<pre><code class="plaintext hljs">$ python -m pyderasn --schema tests.test_crl:CertificateList --evgen revoke.crl<font></font>
[][T,L,  V len]<font></font>
     10   [1,1,      1]   . . version: Version INTEGER v2 (01) OPTIONAL<font></font>
     15   [1,1,      9]   . . . algorithm: OBJECT IDENTIFIER 1.2.840.113549.1.1.13<font></font>
     26   [0,0,      2]   . . . parameters: [UNIV 5] ANY OPTIONAL<font></font>
     13   [1,1,     13]   . . signature: AlgorithmIdentifier SEQUENCE<font></font>
     34   [1,1,      3]   . . . . . . type: AttributeType OBJECT IDENTIFIER 2.5.4.10<font></font>
     39   [0,0,      9]   . . . . . . value: [UNIV 19] AttributeValue ANY<font></font>
     32   [1,1,     14]   . . . . . 0: AttributeTypeAndValue SEQUENCE<font></font>
     30   [1,1,     16]   . . . . 0: RelativeDistinguishedName SET OF<font></font>
<font></font>
                                 [...]<font></font>
<font></font>
    188   [1,1,      1]   . . . . userCertificate: CertificateSerialNumber INTEGER 17 (11)<font></font>
    191   [1,1,     13]   . . . . . utcTime: UTCTime UTCTime 2003-04-01T14:25:08<font></font>
    191   [0,0,     15]   . . . . revocationDate: Time CHOICE utcTime<font></font>
    191   [1,1,     13]   . . . . . utcTime: UTCTime UTCTime 2003-04-01T14:25:08<font></font>
    186   [1,1,     18]   . . . 0: RevokedCertificate SEQUENCE<font></font>
    208   [1,1,      1]   . . . . userCertificate: CertificateSerialNumber INTEGER 20 (14)<font></font>
    211   [1,1,     13]   . . . . . utcTime: UTCTime UTCTime 2002-10-01T02:18:01<font></font>
    211   [0,0,     15]   . . . . revocationDate: Time CHOICE utcTime<font></font>
    206   [1,1,     18]   . . . 1: RevokedCertificate SEQUENCE<font></font>
<font></font>
                                 [...]<font></font>
<font></font>
9144992   [0,0,     15]   . . . . revocationDate: Time CHOICE utcTime<font></font>
9144985   [1,1,     20]   . . . 415755: RevokedCertificate SEQUENCE<font></font>
    181   [1,4,9144821]   . . revokedCertificates: RevokedCertificates SEQUENCE OF OPTIONAL<font></font>
      5   [1,4,9144997]   . tbsCertList: TBSCertList SEQUENCE<font></font>
9145009   [1,1,      9]   . . algorithm: OBJECT IDENTIFIER 1.2.840.113549.1.1.13<font></font>
9145020   [0,0,      2]   . . parameters: [UNIV 5] ANY OPTIONAL<font></font>
9145007   [1,1,     13]   . signatureAlgorithm: AlgorithmIdentifier SEQUENCE<font></font>
9145022   [1,3,    513]   . signatureValue: BIT STRING 4096 bits<font></font>
      0   [1,4,9145534]  CertificateList SEQUENCE<font></font>
</code></pre><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбрд┐рдХреЛрдбрд┐рдВрдЧ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ, рд╣рдордиреЗ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ </font></font></em> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SEQUENCE</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЯреИрдЧ, рдбреЗрдЯрд╛ рдХреА рд▓рдВрдмрд╛рдИ </font><font style="vertical-align: inherit;">рджреЗрдЦреА </font><font style="vertical-align: inherit;">, рд▓реЗрдХрд┐рди рд╡рд╕реНрддреБ рдЕрднреА рддрдХ рдЬреНрдЮрд╛рдд рдирд╣реАрдВ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдЗрд╕реЗ рдЕрдВрдд рддрдХ рдбрд┐рдХреЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЕрднреА рддрдХ рд╣рдо рдХреЗрд╡рд▓ рдЗрд╕ рдкрд░ рдХрд╛рдо рдХрд░рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд╣реИрдВред</font></font></li>
<li>    <em>SEQUENCE</em>:  <em>version</em>,     <em>INTEGER</em>.   .   ,      . ( <strong>10</strong>)</li>
<li>   <em>signature</em>,  <em>SEQUENCE</em>-   : <em>algorithm</em>  <em>parameters</em>.   <em>OBJECT IDENTIFIER</em>  <em>ANY</em>     . ( <strong>15</strong>, <strong>26</strong>)</li>
<li>   ,  ,   <em>signature</em> <em>SEQUENCE</em>    ,    ,    :  . ( <strong>13</strong>)</li>
<li>,   <em>RevokedCertificate</em>        . ( <strong>186</strong>, <strong>206</strong>,  ..)</li>
<li> <em>tbsCertList</em>       . ( <strong>5</strong>)</li>
<li> <em>CertificateList</em>,   <em>SEQUENCE</em>,  ,        ,         . ( <strong>0</strong>)</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдмреЗрд╢рдХ, рд╕рднреА </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* STRING</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ рд╕реВрдЪрд┐рдпрд╛рдБ ( </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* OF</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЕрд░реНрде рдирд╣реАрдВ рд░рдЦрддреА рд╣реИрдВред </font><font style="vertical-align: inherit;">DER рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.offset</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.vlen рдХреЛ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП </font><em><font style="vertical-align: inherit;">,</font></em><font style="vertical-align: inherit;"> рдЖрдк рдПрдХ рдлрд╝рд╛рдЗрд▓ (рдореЗрдореЛрд░реА рдХрд╛ рдПрдХ рдЯреБрдХрдбрд╝рд╛?) рд╕реЗ рдПрдХ рдкрдВрдХреНрддрд┐ рдХрд╛ рдореВрд▓реНрдп рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╕рднреА рдШрдЯрдирд╛рдУрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╕рдордп рдЕрдиреБрдХреНрд░рдо рд╡рд╕реНрддреБрдУрдВ рдХреЛ рдПрдХрддреНрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЖрдкрдХреЛ рдЖрд╡рд╢реНрдпрдХрддрд╛рдиреБрд╕рд╛рд░ рдПрдХрддреНрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбрд┐рдХреЛрдбреЗрдб рдкрде рдФрд░ evgen_mode_upto</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХреИрд╕реЗ рд╕рдордЭреЗрдВ рдХрд┐ рдХрд┐рд╕ рддрд░рд╣ рдХреА рд╡рд╕реНрддреБ, рдХрд┐рд╕ </font><font style="vertical-align: inherit;">рддрд░рд╣ рдХрд╛ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INTEGER</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╣реИ? </font><font style="vertical-align: inherit;">рдкреНрд░рддреНрдпреЗрдХ рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рдЕрдкрдирд╛ рддрдерд╛рдХрдерд┐рдд рдбрд┐рдХреЛрдб рдкрде рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рд╕рдВрд░рдЪрдирд╛ рдореЗрдВ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╡рд╕реНрддреБ рдХреА рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкрд╣рдЪрд╛рди рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, CACert.org CRL рдбрд┐рдХреЛрдб рдкрде рдШрдЯрдирд╛рдУрдВ рдХреЗ рд▓рд┐рдП:</font></font><br>
<br>
<pre><code class="plaintext hljs">tbsCertList:version<font></font>
tbsCertList:signature:algorithm<font></font>
tbsCertList:signature:parameters<font></font>
tbsCertList:signature<font></font>
tbsCertList:issuer:rdnSequence:0:0:type<font></font>
                                 [...]<font></font>
tbsCertList:issuer:rdnSequence<font></font>
tbsCertList:issuer<font></font>
                                 [...]<font></font>
tbsCertList:revokedCertificates:0:userCertificate<font></font>
tbsCertList:revokedCertificates:0:revocationDate:utcTime<font></font>
tbsCertList:revokedCertificates:0:revocationDate<font></font>
tbsCertList:revokedCertificates:0<font></font>
tbsCertList:revokedCertificates:1:userCertificate<font></font>
tbsCertList:revokedCertificates:1:revocationDate:utcTime<font></font>
tbsCertList:revokedCertificates:1:revocationDate<font></font>
tbsCertList:revokedCertificates:1<font></font>
                                 [...]<font></font>
tbsCertList:revokedCertificates:415755:userCertificate<font></font>
tbsCertList:revokedCertificates:415755:revocationDate:utcTime<font></font>
tbsCertList:revokedCertificates:415755:revocationDate<font></font>
tbsCertList:revokedCertificates:415755<font></font>
tbsCertList:revokedCertificates<font></font>
tbsCertList<font></font>
signatureAlgorithm:algorithm<font></font>
signatureAlgorithm:parameters<font></font>
signatureAlgorithm<font></font>
signatureValue<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рддрд░рд╣ рд╕реЗ рд╣рдо рдЗрд╕ CRL рд╕реЗ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдирд┐рд░рд╕реНрддреАрдХрд░рдг рдХреНрд░рдорд╛рдВрдХ рдХреА рд╕реВрдЪреА рдХреЛ рдкреНрд░рд┐рдВрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="plaintext hljs">raw = file_mmaped(open("....crl", "rb"))<font></font>
for decode_path, obj, tail in CertificateList().decode_evgen(raw):<font></font>
    if (len(decode_path) == 5) and (decode_path[-1] == "userCertificate"):<font></font>
        print(int(obj))<font></font>
</code></pre><br><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RevokedCertificate</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рд╕рдВрд░рдЪрдирд╛ </font><font style="vertical-align: inherit;">рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╕рд╣рд┐рдд рдмрд╣реБрдд рд╕рд╛рд░реА рдЬрд╛рдирдХрд╛рд░реА рд╣реЛ рд╕рдХрддреА рд╣реИред </font><font style="vertical-align: inherit;">рд╡рд┐рд╢реБрджреНрдз рд░реВрдк рд╕реЗ рддрдХрдиреАрдХреА рд░реВрдк рд╕реЗ, рд╣рдо Evgen рдореЛрдб рдореЗрдВ рд░рджреНрдж рдХрд░ рджрд┐рдпрд╛ рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рднреА рдбреЗрдЯрд╛ рдорд┐рд▓рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпреЛрдЧ рдХреЗ рдПрдХ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдШрдЯрдирд╛рдУрдВ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">revokedCertificates</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рддрддреНрд╡ </font><em><font style="vertical-align: inherit;">рд╣реИ</font></em><font style="vertical-align: inherit;"> рдмрд╣реБрдд рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдирд╣реАрдВред </font><font style="vertical-align: inherit;">рдЪреВрдВрдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдЕрдВрддрд┐рдо </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RevokedCertificate</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ, рдЕрдзрд┐рдХ рд╕реНрдерд╛рди рдирд╣реАрдВ рд▓реЗрдЧрд╛, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдмрд╣реБрдд рдЕрдЪреНрдЫрд╛ рд╣реЛрдЧрд╛ рдХрд┐ рд╕рднреА рд╡рд╕реНрддреБрдПрдВ, рд╕рднреА рд╡рд╕реНрддреБрдПрдВ рдШрдЯрдирд╛рдУрдВ рдореЗрдВ рдЗрддрдиреА рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ "рдХреНрд░рдордмрджреНрдз" рди рд╣реЛрдВред </font><font style="vertical-align: inherit;">PyDERASN рд╕реВрдЪреА рдХреЛ рдбрд┐рдХреЛрдбрд┐рдВрдЧ рдкрде рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕ рдкрд░ evgen рдореЛрдб рдЕрдХреНрд╖рдо рд╣реИред </font><font style="vertical-align: inherit;">рддреЛ рд╣рдо рдбрд┐рдХреЛрдб рдкрде ( </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"tbsCertList", "рдирд┐рд░рд╕реНрдд рдкреНрд░рдорд╛рдгрдкрддреНрд░")</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реВрдЪреА рдореЗрдВ </font><font style="vertical-align: inherit;">рд╕реЗ рдХреЛрдИ рднреА рддрддреНрд╡ рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font><em><font style="vertical-align: inherit;">,</font></em><font style="vertical-align: inherit;"> рдЬрд┐рд╕ рдкрд░ рд╣рдо рдкреВрд░реНрдг </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RevokedCertificate</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд╕реНрддреБ </font><font style="vertical-align: inherit;">рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">for decode_path, obj, _ in CertificateList().decode_evgen(raw, ctx={<font></font>
    "evgen_mode_upto": (<font></font>
        (("tbsCertList", "revokedCertificates", any), True),<font></font>
    ),<font></font>
}):<font></font>
    if (len(decode_path) == 3) and (decode_path[1] == "revokedCertificates"):<font></font>
        print(int(obj["userCertificate"]))<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдХрд▓ рддрд╛рд░: agg_octet_string</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╣рдореЗрдВ рдХрд┐рд╕реА рднреА рдЖрдХрд╛рд░ рдХреА рд╡рд╕реНрддреБрдУрдВ рдХреЛ рдбрд┐рдХреЛрдб рдХрд░рдиреЗ рдореЗрдВ рдХреЛрдИ рд╕рдорд╕реНрдпрд╛ рдирд╣реАрдВ рд╣реИред рдбреЗрдЯрд╛рдмреЗрд╕ рдХреА рдПрдХ рдкреНрд░рддрд┐ рдХреЗ рд╕рд╛рде рдПрдХ рдбреАрдИрдЖрд░-рдПрдиреНрдХреЛрдбреЗрдб рд╕реАрдПрдордПрд╕ рдХреЛ рдбрд┐рдХреЛрдб рдХрд░рдиреЗ рдореЗрдВ рдХреЛрдИ рд╕рдорд╕реНрдпрд╛ рдирд╣реАрдВ рд╣реИ: рд╣рдо рдПрдХ рдШрдЯрдирд╛ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдбрд┐рдХреЛрдб рдорд╛рд░реНрдЧ рдкрд░ рд╕реАрдПрдордПрд╕ рдореЗрдВ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд / рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдбреЗрдЯрд╛ рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдСрдлрд╕реЗрдЯ + рд╡реАрдПрд▓рдПрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рддреЗ рд╣реИрдВред рд▓реЗрдХрд┐рди рдХреНрдпрд╛ рд╣реЛрдЧрд╛ рдпрджрд┐ CMS CER рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдерд╛? рддрдм рдСрдлрд╕реЗрдЯ + vlen рдорджрдж рдирд╣реАрдВ рдХрд░реЗрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ рд╣рдорд╛рд░реЗ рд╕рднреА 10 GiBs 1000 рдмрд╛рдЗрдЯреНрд╕ рдХреЗ рдЯреБрдХрдбрд╝реЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рд╣реИрдВ, рдЬрд┐рд╕рдХреЗ рдмреАрдЪ DER рд╣реИрдбрд░ рджреНрд╡рд╛рд░рд╛ред рд▓реЗрдХрд┐рди рдХреНрдпрд╛ рд╣реЛрдЧрд╛ рдЕрдЧрд░ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ BER рд╣реИ рдЬрд┐рд╕рдореЗрдВ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* STRINGs</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдШреЛрдВрд╕рд▓рд╛ </font><font style="vertical-align: inherit;">рдХреБрдЫ рднреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ?</font></font><br>
<br>
<pre><code class="plaintext hljs">SOME STRING[CONSTRUCTED]<font></font>
    OCTET STRING[CONSTRUCTED]<font></font>
        OCTET STRING[PRIMITIVE]<font></font>
            DATA CHUNK<font></font>
        OCTET STRING[PRIMITIVE]<font></font>
            DATA CHUNK<font></font>
        OCTET STRING[PRIMITIVE]<font></font>
            DATA CHUNK<font></font>
    OCTET STRING[PRIMITIVE]<font></font>
        DATA CHUNK<font></font>
    OCTET STRING[CONSTRUCTED]<font></font>
        OCTET STRING[PRIMITIVE]<font></font>
            DATA CHUNK<font></font>
        OCTET STRING[PRIMITIVE]<font></font>
            DATA CHUNK<font></font>
    OCTET STRING[CONSTRUCTED]<font></font>
        OCTET STRING[CONSTRUCTED]<font></font>
            OCTET STRING[PRIMITIVE]<font></font>
                DATA CHUNK<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬрдм рдЗрд╡рд╛рдЬреЗрди рдореЛрдб рдореЗрдВ рдбрд┐рдХреЛрдбрд┐рдВрдЧ рд╣реЛрддреА рд╣реИ, рддреЛ рдкреНрд░рддреНрдпреЗрдХ рдЯреБрдХрдбрд╝реЗ рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ рд╕рдВрдмрдВрдзрд┐рдд рдШрдЯрдирд╛ рдорд┐рд▓рддреА рд╣реИ рдФрд░ рдпрд╣ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдЖрджрд┐рдо (рдирд┐рд░реНрдорд╛рдг рдирд╣реАрдВ) </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрдХрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ </font><font style="vertical-align: inherit;">, рдЬрд╣рд╛рдВ рдИрд╡реЗрдВрдЯ + рдСрдлрд╕реЗрдЯ рдореЗрдВ рдбреЗрдЯрд╛ рдХреЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЯреБрдХрдбрд╝реЗ рд╣реЛрддреЗ рд╣реИрдВред PyDERASN рдХрд╛ рдПрдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╕рд╣рд╛рдпрдХ </font><font style="vertical-align: inherit;">рдХрд╛рд░реНрдп рд╣реИ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">agg_octet_string</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬреЛ рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдЙрд╕рдХреЗ рд▓рд┐рдП рдПрдХ рдИрд╡реЗрдВрдЯ рдЬрдирд░реЗрдЯрд░ рдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ, рдбрд┐рдХреЛрдб рдкрде "рдиреАрдЪреЗ" рдЬрд┐рд╕рдореЗрдВ рд╕реЗ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ, рдмрд╛рдЗрдирд░реА рдбреЗрдЯрд╛ (рдпрд╛ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЗрдореЛрд░реАрд╡реНрдпреВ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) рдФрд░ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓реЗрдЦрдХ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЛ рдПрдХрддреНрд░ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ </font><font style="vertical-align: inherit;">- рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдЬрд┐рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдбреЗрдЯрд╛ рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдЯреБрдХрдбрд╝реЗ рдХреЗ рд╕рд╛рде рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рд╣рдо SHA512 рд╣реИрд╢ рдХреА рдЧрдгрдирд╛ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕реА рд╕рдордп </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">encapContentInfo.eContent</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CMS </font><font style="vertical-align: inherit;">рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдмрдЪрд╛ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">? </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╛рдордЧреНрд░реА</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдлрд╝реАрд▓реНрдб </font><font style="vertical-align: inherit;">рдХрд╛ рд╕реНрдерд╛рди рдвреВрдВрдвреЗрдВ </font><font style="vertical-align: inherit;">(рдЬрд┐рд╕рдореЗрдВ </font><em><font style="vertical-align: inherit;">SignedData</font></em><font style="vertical-align: inherit;"> рд╕реНрдерд┐рдд рд╣реЛрдЧрд╛</font></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), рдФрд░ рдлрд┐рд░ рдЗрд╕рдХреА CER рд╕рд╛рдордЧреНрд░реА рдХреЛ рдбреАрдХреЛрдб рдХрд░реЗрдВ, рд╕рд╛рде рд╣реА рд╕рд╛рде FS рдФрд░ рд╣реИрд╢рд┐рдВрдЧ рдХреЛ рд▓рд┐рдЦреЗрдВ:</font></font><br>
<br>
<pre><code class="plaintext hljs">fdIn = open("data.p7m", "rb")<font></font>
raw = file_mmaped(fdIn)<font></font>
for decode_path, obj, _ in ContentInfo().decode_evgen(raw, ctx={"bered": True}):<font></font>
    if decode_path == ("content",):<font></font>
        content = obj<font></font>
        break<font></font>
hasher_state = sha512()<font></font>
fdOut = open("dump.sql.zst", "wb")<font></font>
def hash_n_save(data):<font></font>
    write_full(fdOut, data)<font></font>
    hasher_state.update(data)<font></font>
    return len(data)<font></font>
evgens = SignedData().decode_evgen(<font></font>
    raw[content.offset:],<font></font>
    offset=content.offset,<font></font>
    ctx={"bered": True},<font></font>
)<font></font>
agg_octet_string(evgens, ("encapContentInfo", "eContent"), raw, hash_n_save)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣рд╛рдВ, рдПрдХ рдФрд░ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">write_full</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпреВрдЯрд┐рд▓рд┐рдЯреА рдХрд╛ </font><em><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ</font></em><font style="vertical-align: inherit;"> , рдЬреЛ </font><font style="vertical-align: inherit;">рддрдм рддрдХ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓реЗрдЦрдХ рдХреЛ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">рдЬрдм рддрдХ рдХрд┐ рд╕рднреА рдбреЗрдЯрд╛ рдирд╣реАрдВ рд▓рд┐рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рдХрд┐рд╕реА рдлрд╛рдЗрд▓ рдореЗрдВ рд▓рд┐рдЦрддреЗ рд╕рдордп, рдУрдПрд╕ рдХреЛ рд╕рднреА рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ рдФрд░ рдЖрдкрдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд▓рд┐рдЦреЗ рдЬрд╛рдиреЗ рддрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЬрд╛рд░реА рд░рдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET OF рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реНрдиреЗрд╣реА рдЬреЛрдбрд╝реЗ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╡рд┐рд╢реБрджреНрдз рд░реВрдк рд╕реЗ рддрдХрдиреАрдХреА рд░реВрдк рд╕реЗ, </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET OF</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЛ DER рдФрд░ CER рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдореЗрдВ рдордХреНрдЦреА рдкрд░ рдПрдирдХреЛрдб рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╕рднреА рддрддреНрд╡реЛрдВ рдХреЗ рдПрдиреНрдХреЛрдбреЗрдб рд░рд┐рдкреНрд▓реЗрд╕рдореЗрдВрдЯ рдХреЛ рдЫрд╛рдВрдЯрдирд╛ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдВ рди рддреЛ рд╕реАрдИрдЖрд░ рдФрд░ рди рд╣реА рджреЛ-рдкрд╛рд╕ рдбреАрдИрдЖрд░ рдорджрдж рдХрд░реЗрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП рдЖрдзреБрдирд┐рдХ ASN.1 рдорд╛рдирдХ рджреЛрдиреЛрдВ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (DER рдореЗрдВ рд╕рдорд╛рди рдЫрдВрдЯрд╛рдИ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛) рдФрд░ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET рдХреЗ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЙрдкрдпреЛрдЧ рдХреА рдЕрдиреБрд╢рдВрд╕рд╛ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ рд▓реЗрдЦ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдпрд╣ рддрд╕реНрд╡реАрд░ рдХреНрдпрд╛ рд╣реИ?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ PyDERASN рдореЗрдВ рдерд╛ рдХрд┐ рдПрдХ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡, рд╕рд░рд▓ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASN.1 рдмреНрд░рд╛рдЙрдЬрд╝рд░ рджрд┐рдЦрд╛рдИ рджрд┐рдпрд╛</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдЬрд┐рд╕рдиреЗ рдореБрдЭреЗ рд╡реНрдпрдХреНрддрд┐рдЧрдд рд░реВрдк рд╕реЗ рдЬрдЯрд┐рд▓ рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╣реИрдВрдбрд▓рд░ рд▓рд┐рдЦрдиреЗ рдореЗрдВ рдХрдИ рдмрд╛рд░ рдорджрдж рдХреАред </font><font style="vertical-align: inherit;">рдЖрдкрдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдбрд┐рдХреЛрдбреЗрдб рд╕рдВрд░рдЪрдирд╛ рдХреЗ рдЪрд╛рд░реЛрдВ рдУрд░ рдЪрд▓рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдкреНрд░рддреНрдпреЗрдХ рд╡рд╕реНрддреБ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкреВрд░реНрдг рд╡рд┐рд╡рд░рдг рджрд┐рдЦрд╛рддреЗ рд╣реБрдП, рдмрд╛рдЗрдирд░реА рдбреЗрдЯрд╛ рдореЗрдВ рдЗрд╕рдХрд╛ рд╕реНрдерд╛рди, рдбрд┐рдХреЛрдб рдкрдеред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХрд┐рд╕реА рднреА рдЖрдЗрдЯрдо рдХреЛ рдПрдХ рдЕрд▓рдЧ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдмрдЪрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдпрд╛ рд╕реАрдПрдордПрд╕ рд╕реАрдПрдордПрд╕ рдореЗрдВ рд╢рд╛рдорд┐рд▓ред </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд░реНрдЧреЗрдИ </font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорддрд╡реЗрд╡</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">рд╕рд┐рдлрд░рдкрдВрдХ</font></a><font style="vertical-align: inherit;"> , рдкрд╛рдпрдерди / рдЧреЛ-рдбреЗрд╡рд▓рдкрд░ </font><font style="vertical-align: inherit;">, </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">рдПрдлрдПрд╕рдпреВрдИ рдХреЗ</font></a><font style="vertical-align: inherit;"> рдореБрдЦреНрдп рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ "рд╡реИрдЬреНрдЮрд╛рдирд┐рдХ рдФрд░ рддрдХрдиреАрдХреА рдХреЗрдВрджреНрд░" рдПрдЯрд▓рд╕ "ред</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi498000/index.html">рдЪреАрдЬреЗрдВ рдореИрдВ рдЕрдкрдиреЗ рдЦреЗрд▓ рдХреЛ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЬрд╛рдирдирд╛ рдЪрд╛рд╣реВрдВрдЧрд╛</a></li>
<li><a href="../hi498002/index.html">Z3 рдХреЗ рд▓рд┐рдП рдкреЙрдХреЗрдЯ рдЧрд╛рдЗрдб</a></li>
<li><a href="../hi498004/index.html">рдПрдХ рдбреЙрдХрдЯрд░ рдХрдВрдЯреЗрдирд░ рдореЗрдВ рд╡рд░реНрдХрд╕реНрдЯреЗрд╢рди</a></li>
<li><a href="../hi498006/index.html">рдкреЗрдЯреЗрдВрдЯ рдЕрдЯреЙрд░реНрдиреА рдЪреБрдирдирд╛</a></li>
<li><a href="../hi498012/index.html">рдХреЗрдореВ рдХреЗ рд╕рд╛рде рдбреЛрдХрд░ рдореЗрдВ рдорд┐рдХрд░реЛрдЯрд┐рдХ рд░рд╛рдЙрдЯрд░рдУрдПрд╕</a></li>
<li><a href="../hi498018/index.html">Microservice рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдореЗрдВ рдСрди-рд▓рд╛рдЗрди рд╡рд┐рд╢реНрд▓реЗрд╖рдг: рдорджрдж рдФрд░ рд╕реБрдЭрд╛рд╡ FDW FD ╨╕ рдкреЛрд╕реНрдЯ рдкреЛрд╕реНрдЯ ╠╢╨┐╠╢╤А╠╢╨╛╠╢╤Б╠╢╤В╠╢╨╕╠╢╤В ╨╕╤Мes</a></li>
<li><a href="../hi498020/index.html">рддреЗрдЬреА рд╕реЗ рдмрдврд╝рддреЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рджреГрд╢реНрдп рдореВрд▓реНрдпрд╛рдВрдХрди рдХреЗ рд▓рд┐рдП рд▓рд╛рдЧреВ рдПрдХ рд╕рдВрдХреЗрддрдХ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ</a></li>
<li><a href="../hi498022/index.html">рдореЛрдмрд╛рдЗрд▓ # 341 рдбреЗрд╡рд▓рдкрд░ рдХреЗ рд▓рд┐рдП рджрд┐рд▓рдЪрд╕реНрдк рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдкрд╛рдЪрди (13 рдЕрдкреНрд░реИрд▓ 19 рдХреЛ)</a></li>
<li><a href="../hi498024/index.html">рд╣реМрджрд┐рдиреА рдФрд░ рдЕрдЬрдЧрд░ рдХреЗ рд╕рд╛рде рдорд╛рдЙрд╕ рдХреЗ рдПрдХ рдХреНрд▓рд┐рдХ рдХреЗ рд╕рд╛рде рд╢рд╣рд░реЛрдВ рдХрд╛ рдирд┐рд░реНрдорд╛рдг</a></li>
<li><a href="../hi498026/index.html">FOSS News No. 12 - 13-19 рдЕрдкреНрд░реИрд▓, 2020 рдХреЗ рд▓рд┐рдП рд╕реНрд╡рддрдВрддреНрд░ рдФрд░ рдореБрдХреНрдд рд╕реНрд░реЛрдд рд╕рдорд╛рдЪрд╛рд░ рдХреА рд╕рдореАрдХреНрд╖рд╛</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>