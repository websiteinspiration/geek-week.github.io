<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍞 😖 ♋️ 純粋なソリューションアーキテクチャ、Mobを使用しないテスト、およびこれまでの経緯 👩🏾‍🚒 🤰🏿 👛</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="読者の皆さん、こんにちは！この記事では、プロジェクトのアーキテクチャについてお話ししたいと思います。プロジェクトの結果は、満足のいくものではなかったため、ローンチ時に4回リファクタリングしました。一般的なアプローチのデメリットについて説明し、自分のアプローチを紹介します。
 

私はこれが私の最初の...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>純粋なソリューションアーキテクチャ、Mobを使用しないテスト、およびこれまでの経緯</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459394/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">読者の皆さん、こんにちは！</font><font style="vertical-align: inherit;">この記事では、プロジェクトのアーキテクチャについてお話ししたいと思います。プロジェクトの結果は、満足のいくものではなかったため、ローンチ時に4回リファクタリングしました。</font><font style="vertical-align: inherit;">一般的なアプローチのデメリットについて説明し、自分のアプローチを紹介します。</font></font></p><a name="habracut"></a><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私はこれが私の最初の記事であることをすぐに言いたいです、私は私のように何をすべきかを言っているのではありません-そうです。</font><font style="vertical-align: inherit;">私は自分が何をしたかを示し、どのようにして最終結果に到達したかを伝えたい、そして最も重要なことは、他の人の意見を得ることです。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私はいくつかのキャンペーンで働いていて、私が違った方法でやっていたであろうすべてのことをたくさん見ました。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たとえば、Nレイヤーアーキテクチャがよく見られます。データ（DA）を操作するためのレイヤーがあり、DAおよびおそらく他のサービスを使用して機能するビジネスロジック（BL）を備えたレイヤーがあり、ビューレイヤー\ APIもあります。要求が受信され、BLを使用して処理されます。</font><font style="vertical-align: inherit;">便利なようですが、コードを見ると次のような状況になっています。</font></font></p><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[DA]複雑なクエリであっても、プル\書き込み\変更データ-OK</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[BL] 80％が1つのメソッドを呼び出し、上記の結果をロールしている-なぜこの空のレイヤーなのか？</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[表示] 80％が1 BLメソッドを呼び出し、上記の結果をロールします-なぜこの空のレイヤーですか？</font></font></li>
</ul><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さらに、インターフェースをラップして後でロックしてテストできるようにするのもおしゃれです-すごい、すごい！</font></font></p><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">なぜ濡れるの？</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さて、テストの期間中の副作用をカットします。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">つまり、私たちは副作用なしで抗議しますが、それらを使って本当ですか？</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...</font></font></li>
</ul><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これは、このアーキテクチャでは嫌いだった基本的なものです。「ユーザーのいいねをリストする」のような問題を解決するのは大きなプロセスですが、実際にはデータベースへの1つのリクエストと、場合によってはマッピングも行われます。</font></font></p><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サンプル溶液</font></font></b><div class="spoiler_text"><p>1) [DA]    DA<br>
2) [BL]   DA<br>
3) [View]   BA,  </p><br>
<p>   ,         interface,        ,    .</p></div></div><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">他の場所では、CQRSアプローチによるAPI実装を見ました。</font></font></p><br>
<p>   , 1  — 1 .                   ,     ,   .  \, , ,  .      ,        .</p><br>
<p>    ,           </p><br>
<h2 id="i-nakonec-k-moemu-proektu">    </h2><br>
<p>  ,      ,       " ",       ,   ,   ,        ,     .       DDD   ,  : " ,   F#!".</p><br>
<p>    F#      -   C#   .   :</p><br>
<ul>
<li>  C#,  </li>
<li> F# ,   — .</li>
</ul><br>
<p>       F#   ,        C#.     ,  BL      DA,     ,   <strong> </strong>.</p><br>
<p> F# ,     ,   C#    ,    -.</p><br>
<p>     C#   .</p><br>
<p>     :</p><br>
<ol>
<li>API</li>
<li>Core</li>
<li>Services</li>
<li>Tests</li>
</ol><br>
<p>     C# 8,  nullable refence type,   .<br>
   ,    .</p><br>
<p><strong>API </strong><br>
1)  ,   + , </p><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><p><img src="https://habrastorage.org/getpro/habr/post_images/1ba/e1f/fdf/1bae1ffdfd889b06d323d50d58904459.png" alt="image"></p></div></div><br>
<p>2)    Core  Services</p><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><p><img src="https://habrastorage.org/getpro/habr/post_images/a9f/01f/606/a9f01f6067340c60ca2e07e3e1321fbf.png" alt="image"></p><br>
<p>   ,  ,       .<br>
  <br>
1)  <br>
2) ,    —     .<br>
3) .</p></div></div><br>
<p>3) ,  <br>
4)   ( +  )</p><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><p>       ,    exception handler</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/574/7f6/c44/5747f6c44498d03e6c94958b3b500f8b.png" alt="image"></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/a74/5c4/4ab/a745c44ab83c307d92fdaa82b339bd55.png" alt="image"></p><br>
<p> ,    ,    ,        ,  ,            .</p><br>
<p>   AppError.Bug      .</p><br>
<p>   CallBack   ,    userId   ,         ID     - ,    ,      CRITICAL,     ,   ,    .</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/625/ecf/ce5/625ecfce5eb5570993443f65eb4b7006.png" alt="image"></p></div></div><br>
<p><strong>Core,  </strong></p><br>
<p>    ,  BL          .          ,   ,        .          ,       .</p><br>
<p>    ,    ,    ,       BL.</p><br>
<p>1)   </p><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><p><img src="https://habrastorage.org/getpro/habr/post_images/729/ec2/7d4/729ec27d4e71e4f050d6c404f2c25c5c.png" alt="image"><br>
<img src="https://habrastorage.org/getpro/habr/post_images/d49/b15/f17/d49b15f17eb75d63a61486db99f9ceab.png" alt="image"></p><br>
<p>         ,      .</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/3ef/4a6/634/3ef4a663438981f8ab3d326e2289e1c7.png" alt="image"><br>
<img src="https://habrastorage.org/getpro/habr/post_images/296/e9c/220/296e9c220a1b41407b5901d7789b317e.png" alt="image"></p></div></div><br>
<p>        .</p><br>
<p>  ,    ,       .            ""       .       ?</p><br>
<p>1) \ .           ,   ,  \        .   ,          ,          -  .      enum    ,         ,    .</p><br>
<p>2)    FirstOrDefault(s=&gt; s.Currency == currency)    null</p><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><p><img src="https://habrastorage.org/getpro/habr/post_images/254/d7d/7d5/254d7d7d580592114c8ab62a6bd028de.png" alt="image"></p><br>
<p>    ,      null,    indexer          .</p></div></div><br>
<h2 id="services">Services</h2><br>
<p>          .<br>
     MongoDB      ,      .</p><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><p> <br>
<img src="https://habrastorage.org/getpro/habr/post_images/259/453/270/2594532705f07b698d6b6d29c19eb4ef.png" alt="image"></p><br>
<p>       ,          .          +   , : "   id       10"</p><br>
<p>    C# 8.</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/579/237/bc6/579237bc61fdb0e58342ff73300b0def.png" alt="image"></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/221/449/d5e/221449d5ea5fb587e3d8cf2aea980f0a.png" alt="image"></p><br>
<p>   ,    User,   Null,     User?     ,     null.</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/441/28c/503/44128c503d8af4762f5bc7fea812f0b3.png" alt="image"></p><br>
<p>   User     .</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/665/8c6/4b9/6658c64b9cb10ea08fbfae84447e6c48.png" alt="image"></p><br>
<p>     ,   try catch        " "    ,         .   API   try catch,     exception handler.</p><br>
<p>      Exception   Update.<br>
         .<br>
<img src="https://habrastorage.org/getpro/habr/post_images/4b5/87c/709/4b587c709dffe51e88dcf8deb7db42ee.png" alt="image"></p><br>
<p>    ,    ?<br>
              ,         ,       ,    .</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/9fd/c68/b23/9fdc68b236ce758a977c1cca2f50ad69.png" alt="image"></p><br>
<p>          1   ,      .</p><br>
<p>    ,         ,          null.</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/c0f/0c7/835/c0f0c7835e56f5ac9372dc0a5139908d.png" alt="image"></p></div></div><br>
<h2 id="i-nakonec-tests">  Tests</h2><br>
<p>       ,     ,   .<br>
           .</p><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><p>  nuget FSCheck           .</p><br>
<p>     ,      .</p><br>
<p>     ,   ,    .</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/ff5/11a/bf1/ff511abf173fd7fd9b452934af2e0d20.png" alt="image"></p><br>
<p>    </p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/51e/ba1/1ec/51eba11ec1df6ca5393bba5095a4dd15.png" alt="image"></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/4dd/fa7/063/4ddfa706330f69bff4950bf9d46b7fe0.png" alt="image"></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/459/d62/92d/459d6292d288de62429663160487bb2c.png" alt="image"></p><br>
<p> -    ,  1-2      .<br>
     E2E ,    API           ,  ,  .</p></div></div><br>
<h2 id="fishki"></h2><br>
<div class="spoiler"><b class="spoiler_title"> ,   </b><div class="spoiler_text"><p>   ,   ,   requestId     ,  ,    API  ,        .</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/d4d/2e9/112/d4d2e9112f58db9beee8dbaaa9abb466.png" alt="image"></p></div></div><br>
<p> .</p><br>
<p>   ,        ,    .             .   BL   ,  BL    ,   .           .       , !</p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja459378/index.html">Reactコンポーネント用のAPIを作成する：パート2：相互作用ではなく動作に名前を付ける</a></li>
<li><a href="../ja459380/index.html">Reactコンポーネント用のAPIを作成する：パート3：小道具の順序は重要です</a></li>
<li><a href="../ja459384/index.html">ヤロスラヴナの別のまたは別の叫びの問題について</a></li>
<li><a href="../ja459388/index.html">スターウォーズ：旧共和国の騎士</a></li>
<li><a href="../ja459392/index.html">マイクロソフトの開発部門でのインタビュープロセスを再考する</a></li>
<li><a href="../ja459396/index.html">「警告：HTMLをサニタイズすると一部のコンテンツが削除されます」とそれを正しく処理する方法</a></li>
<li><a href="../ja459400/index.html">過去数年間でどのボーダーゲートウェイプロトコルインシデントが強調表示されますか</a></li>
<li><a href="../ja459402/index.html">Androidにクリーンアーキテクチャを実装する方法は？</a></li>
<li><a href="../ja459404/index.html">アイデア：Ethereum + Metamaskネットワークを使用した匿名の登録/承認、メールなしなど</a></li>
<li><a href="../ja459408/index.html">ドライバーのマップ検索を修正しようとした方法。パート3（最終）</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>