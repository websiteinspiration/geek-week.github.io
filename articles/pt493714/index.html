<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üì§ üêü üåé Folhas de dicas de seguran√ßa: Nodejs üìò üëãüèø ‚õµÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Muito j√° foi dito sobre a popularidade do NodeJS. O aumento no n√∫mero de aplicativos √© √≥bvio - o NodeJS √© bastante f√°cil de aprender, possui um grande...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Folhas de dicas de seguran√ßa: Nodejs</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/acribia/blog/493714/"><img src="https://habrastorage.org/webt/bs/ml/lo/bsmllozt2li3jmn_6ec8vy4krdq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Muito j√° foi dito sobre a popularidade do NodeJS. </font><font style="vertical-align: inherit;">O aumento no n√∫mero de aplicativos √© √≥bvio - o NodeJS √© bastante f√°cil de aprender, possui um grande n√∫mero de bibliotecas e um ecossistema em desenvolvimento din√¢mico. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fizemos </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recomenda√ß√µes para desenvolvedores do NodeJS com</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> base nas folhas de </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><b><font style="vertical-align: inherit;">dicas</font></b></a><font style="vertical-align: inherit;"> do OWASP para ajud√°-lo a antecipar problemas de seguran√ßa ao desenvolver aplicativos. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As recomenda√ß√µes de seguran√ßa para aplicativos NodeJS podem ser divididas nas seguintes categorias:</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seguran√ßa durante o desenvolvimento de aplicativos;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seguran√ßa do servidor;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seguran√ßa da plataforma;</font></font></li>
</ul><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seguran√ßa no desenvolvimento de aplicativos</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Evite o inferno de retorno de chamada O</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
uso de fun√ß√µes de retorno de chamada (retornos de chamada) √© um dos pontos fortes do NodeJS; no entanto, ao aninhar retornos de chamada, voc√™ pode esquecer facilmente de lidar com o erro em uma das fun√ß√µes. </font><font style="vertical-align: inherit;">Uma maneira de evitar o inferno de retorno de chamada √© usar promessas. </font><font style="vertical-align: inherit;">Mesmo que o m√≥dulo que voc√™ est√° usando n√£o suporte o trabalho com promessas, voc√™ sempre pode usar Promise.promisifyAll (). </font><font style="vertical-align: inherit;">Mas, mesmo usando promessas, vale a pena prestar aten√ß√£o ao aninhamento. </font><font style="vertical-align: inherit;">Para evitar completamente o erro de retorno de chamada, atenha-se a uma cadeia de promessas "plana". </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemplo infernal de retorno de chamada:</font></font></i><br>
<br>
<pre><code class="java hljs"><span class="hljs-function">function <span class="hljs-title">func1</span><span class="hljs-params">(name, callback)</span> </span>{<font></font>
   setTimeout(function() {<font></font>
      <span class="hljs-comment">// operations</span>
   }, <span class="hljs-number">500</span>);<font></font>
}<font></font>
<span class="hljs-function">function <span class="hljs-title">func2</span><span class="hljs-params">(name, callback)</span> </span>{<font></font>
   setTimeout(function() {<font></font>
      <span class="hljs-comment">// operations</span>
   }, <span class="hljs-number">100</span>);<font></font>
}<font></font>
<span class="hljs-function">function <span class="hljs-title">func3</span><span class="hljs-params">(name, callback)</span> </span>{<font></font>
   setTimeout(function() {<font></font>
      <span class="hljs-comment">// operations</span>
   }, <span class="hljs-number">900</span>);<font></font>
}<font></font>
<span class="hljs-function">function <span class="hljs-title">func4</span><span class="hljs-params">(name, callback)</span> </span>{<font></font>
   setTimeout(function() {<font></font>
      <span class="hljs-comment">// operations</span>
   }, <span class="hljs-number">3000</span>);<font></font>
}<font></font>
<font></font>
func1(<span class="hljs-string">"input1"</span>, function(err, result1){
   <span class="hljs-keyword">if</span>(err){
      <span class="hljs-comment">// error operations</span><font></font>
   }<font></font>
   <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">//some operations</span>
      func2(<span class="hljs-string">"input2"</span>, function(err, result2){
         <span class="hljs-keyword">if</span>(err){
            <span class="hljs-comment">//error operations</span><font></font>
         }<font></font>
         <span class="hljs-keyword">else</span>{
            <span class="hljs-comment">//some operations</span>
            func3(<span class="hljs-string">"input3"</span>, function(err, result3){
               <span class="hljs-keyword">if</span>(err){
                  <span class="hljs-comment">//error operations</span><font></font>
               }<font></font>
               <span class="hljs-keyword">else</span>{
                  <span class="hljs-comment">// some operations</span>
                  func4(<span class="hljs-string">"input 4"</span>, function(err, result4){
                     <span class="hljs-keyword">if</span>(err){
                        <span class="hljs-comment">// error operations</span><font></font>
                     }<font></font>
                     <span class="hljs-keyword">else</span> {
                        <span class="hljs-comment">// some operations</span><font></font>
                     }<font></font>
                  });<font></font>
               }<font></font>
            });<font></font>
         }<font></font>
      });<font></font>
   }<font></font>
});<font></font>
</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mesmo c√≥digo usando promessas de cadeia plana:</font></font></i><br>
<br>
<pre><code class="java hljs"><span class="hljs-function">function <span class="hljs-title">func1</span><span class="hljs-params">(name, callback)</span> </span>{<font></font>
   setTimeout(function() {<font></font>
      <span class="hljs-comment">// operations</span>
   }, <span class="hljs-number">500</span>);<font></font>
}<font></font>
<span class="hljs-function">function <span class="hljs-title">func2</span><span class="hljs-params">(name, callback)</span> </span>{<font></font>
   setTimeout(function() {<font></font>
      <span class="hljs-comment">// operations</span>
   }, <span class="hljs-number">100</span>);<font></font>
}<font></font>
<span class="hljs-function">function <span class="hljs-title">func3</span><span class="hljs-params">(name, callback)</span> </span>{<font></font>
   setTimeout(function() {<font></font>
      <span class="hljs-comment">// operations</span>
   }, <span class="hljs-number">900</span>);<font></font>
}<font></font>
<span class="hljs-function">function <span class="hljs-title">func4</span><span class="hljs-params">(name, callback)</span> </span>{<font></font>
   setTimeout(function() {<font></font>
      <span class="hljs-comment">// operations</span>
   }, <span class="hljs-number">3000</span>);<font></font>
}<font></font>
<font></font>
func1(<span class="hljs-string">"input1"</span>)<font></font>
   .then(function (result){<font></font>
      <span class="hljs-keyword">return</span> func2(<span class="hljs-string">"input2"</span>);<font></font>
   })<font></font>
   .then(function (result){<font></font>
      <span class="hljs-keyword">return</span> func3(<span class="hljs-string">"input3"</span>);<font></font>
   })<font></font>
   .then(function (result){<font></font>
      <span class="hljs-keyword">return</span> func4(<span class="hljs-string">"input4"</span>);<font></font>
   })<font></font>
   .<span class="hljs-keyword">catch</span>(function (error) {
      <span class="hljs-comment">// error operations</span><font></font>
   });<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Limitar o tamanho da solicita√ß√£o A</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
an√°lise do corpo da </font><b><font style="vertical-align: inherit;">solicita√ß√£o</font></b><font style="vertical-align: inherit;"> pode ser uma opera√ß√£o que consome muitos recursos. Se voc√™ n√£o limitar o tamanho da solicita√ß√£o, os invasores poder√£o enviar solicita√ß√µes grandes o suficiente para ocupar todo o espa√ßo em disco ou esgotar todos os recursos do servidor, mas, ao mesmo tempo, limitar o tamanho da solicita√ß√£o para todos os casos pode estar incorreto, pois h√° solicita√ß√µes, como o download de um arquivo. Portanto, √© recomend√°vel definir limites para diferentes tipos de conte√∫do. Por exemplo, usando a estrutura expressa, isso pode ser implementado da seguinte maneira:</font></font><br>
<br>
<pre><code class="java hljs">app.use(express.urlencoded({ limit: <span class="hljs-string">"1kb"</span> }));<font></font>
app.use(express.json({ limit: <span class="hljs-string">"1kb"</span> }));<font></font>
app.use(express.multipart({ limit:<span class="hljs-string">"10mb"</span> }));
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Deve-se observar que um invasor pode alterar o tipo de conte√∫do da solicita√ß√£o e contornar as restri√ß√µes; portanto, √© necess√°rio verificar se o conte√∫do da solicita√ß√£o corresponde ao tipo de conte√∫do especificado no cabe√ßalho da solicita√ß√£o. </font><font style="vertical-align: inherit;">Se a verifica√ß√£o do tipo de conte√∫do afetar o desempenho, voc√™ poder√° verificar apenas determinados tipos ou consultas maiores que um determinado tamanho. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√£o bloqueie o loop de eventos</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Um componente importante da linguagem √© o loop de eventos, que permite alternar o contexto de execu√ß√£o sem aguardar a conclus√£o da opera√ß√£o. </font><font style="vertical-align: inherit;">No entanto, existem opera√ß√µes de bloqueio cuja conclus√£o o NodeJS precisa aguardar antes de continuar com o c√≥digo. </font><font style="vertical-align: inherit;">Por exemplo, a maioria dos m√©todos s√≠ncronos est√° bloqueando:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">const</span> fs = require(<span class="hljs-string">'fs'</span>);<font></font>
fs.unlinkSync(<span class="hljs-string">'/file.txt'</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â recomend√°vel executar essas opera√ß√µes de forma ass√≠ncrona:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">const</span> fs = require(<span class="hljs-string">'fs'</span>);<font></font>
fs.unlink(<span class="hljs-string">'/file.txt'</span>, (err) =&gt; {
    <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err;<font></font>
});<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Ao mesmo tempo, n√£o esque√ßa que o c√≥digo parado ap√≥s a chamada ass√≠ncrona ser√° executado sem aguardar a conclus√£o da opera√ß√£o anterior. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, no c√≥digo abaixo, o arquivo ser√° exclu√≠do antes de ser lido, o que pode levar a uma condi√ß√£o de corrida.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">const</span> fs = require(<span class="hljs-string">'fs'</span>);<font></font>
fs.readFile(<span class="hljs-string">'/file.txt'</span>, (err, data) =&gt; {
  <span class="hljs-comment">// perform actions on file content</span><font></font>
});<font></font>
fs.unlinkSync(<span class="hljs-string">'/file.txt'</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Para evitar isso, voc√™ pode gravar todas as opera√ß√µes em uma fun√ß√£o sem bloqueio:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">const</span> fs = require(<span class="hljs-string">'fs'</span>);<font></font>
fs.readFile(<span class="hljs-string">'/file.txt'</span>, (err, data) =&gt; {
  <span class="hljs-comment">// perform actions on file content</span>
  fs.unlink(<span class="hljs-string">'/file.txt'</span>, (err) =&gt; {
    <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err;<font></font>
  });<font></font>
});<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verificar campos de entrada A</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
verifica√ß√£o dos campos de </font><b><font style="vertical-align: inherit;">entrada</font></b><font style="vertical-align: inherit;"> √© uma parte importante da seguran√ßa de qualquer aplicativo. Os erros de valida√ß√£o podem tornar seu aplicativo vulner√°vel imediatamente a muitos tipos de ataques: inje√ß√£o de sql, xss, inje√ß√£o de comando e outros. Para simplificar a valida√ß√£o de formul√°rio, voc√™ pode usar pacotes validadores, mongo-express-sanitize. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escapar dos dados do usu√°rio</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Uma das regras que ajudar√£o voc√™ a se proteger de ataques xss √© proteger os dados do usu√°rio. Voc√™ pode usar a biblioteca escape-html ou node-esapi para isso. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manter registros</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Al√©m disso, ele ajudar√° em erros de depura√ß√£o, o registro pode ser usado para responder a incidentes. Voc√™ pode ler mais sobre a necessidade de registro </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui.</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Um dos pacotes de registro mais populares do NodeJS √© o Winston e o Bunyan. </font><font style="vertical-align: inherit;">O exemplo abaixo mostra como usar o Winston para gerar logs para o console e o arquivo:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">var</span> logger = <span class="hljs-keyword">new</span> (Winston.Logger) ({<font></font>
    transports: [<font></font>
        <span class="hljs-keyword">new</span> (winston.transports.Console)(),
        <span class="hljs-keyword">new</span> (winston.transports.File)({ filename: <span class="hljs-string">'application.log'</span> })<font></font>
    ],<font></font>
    level: <span class="hljs-string">'verbose'</span><font></font>
});<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controlar o ciclo de eventos</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Se o seu servidor estiver em condi√ß√µes de intenso tr√°fego de rede, os usu√°rios poder√£o ter dificuldades com a disponibilidade do seu servi√ßo. </font><font style="vertical-align: inherit;">Este √© essencialmente um ataque de nega√ß√£o de servi√ßo. </font><font style="vertical-align: inherit;">Nesse caso, voc√™ pode rastrear o tempo de resposta e, se exceder o tempo especificado, enviar uma mensagem para 503 Server Too Busy. </font><font style="vertical-align: inherit;">O m√≥dulo toobusy-js pode ajudar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um exemplo de uso do m√≥dulo:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">var</span> toobusy = require(<span class="hljs-string">'toobusy-js'</span>);
<span class="hljs-keyword">var</span> express = require(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">var</span> app = express();<font></font>
app.use(function(req, res, next) {<font></font>
    <span class="hljs-keyword">if</span> (toobusy()) {
        <span class="hljs-comment">// log if you see necessary</span>
        res.send(<span class="hljs-number">503</span>, <span class="hljs-string">"Server Too Busy"</span>);<font></font>
    } <span class="hljs-keyword">else</span> {<font></font>
    next();<font></font>
    }<font></font>
});<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tome precau√ß√µes contra a for√ßa bruta.Mais uma</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
vez, os m√≥dulos s√£o √∫teis. </font><font style="vertical-align: inherit;">Por exemplo, express-brute ou express-bouncer. </font><font style="vertical-align: inherit;">Exemplo de uso:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">var</span> bouncer = require(<span class="hljs-string">'express-bouncer'</span>);<font></font>
bouncer.whitelist.push(<span class="hljs-string">'127.0.0.1'</span>); <span class="hljs-comment">// whitelist an IP address</span>
<span class="hljs-comment">// give a custom error message</span><font></font>
bouncer.blocked = function (req, res, next, remaining) {<font></font>
    res.send(<span class="hljs-number">429</span>, <span class="hljs-string">"Too many requests have been made. Please wait "</span> + remaining/<span class="hljs-number">1000</span> + <span class="hljs-string">" seconds."</span>);<font></font>
};<font></font>
<span class="hljs-comment">// route to protect</span>
app.post(<span class="hljs-string">"/login"</span>, bouncer.block, function(req, res) {
    <span class="hljs-keyword">if</span> (LoginFailed){  }
    <span class="hljs-keyword">else</span> {<font></font>
        bouncer.reset( req );<font></font>
    }<font></font>
});<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O uso do CAPTCHA √© outra contramedida comum de for√ßa bruta. </font><font style="vertical-align: inherit;">Um m√≥dulo usado com freq√º√™ncia para ajudar a implementar o CAPTCHA √© o svg-captcha. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Use tokens CSRF</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Uma das maneiras mais confi√°veis ‚Äã‚Äãde se proteger contra ataques CSRF √© usar um token CSRF. </font><font style="vertical-align: inherit;">O token deve ser gerado com alta entropia, estritamente verificado e vinculado √† sess√£o do usu√°rio. </font><font style="vertical-align: inherit;">Para garantir a opera√ß√£o do token CSRF, voc√™ pode usar o m√≥dulo csurf. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exemplo de uso:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">var</span> csrf = require(<span class="hljs-string">'csurf'</span>);<font></font>
csrfProtection = csrf({ cookie: <span class="hljs-keyword">true</span> });<font></font>
app.get(<span class="hljs-string">'/form'</span>, csrfProtection, function(req, res) {<font></font>
    res.render(<span class="hljs-string">'send'</span>, { csrfToken: req.csrfToken() })<font></font>
})<font></font>
app.post(<span class="hljs-string">'/process'</span>, parseForm, csrfProtection, function(req, res) {<font></font>
    res.send(<span class="hljs-string">'data is being processed'</span>);<font></font>
});<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√£o esque√ßa de adicionar o token ao campo oculto da p√°gina:</font></font><br>
<br>
<pre><code class="plaintext hljs">&lt;input type="hidden" name="_csrf" value="{{ csrfToken }}"&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode ler mais sobre os tokens CSRF em nosso </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artigo</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Excluir rotas desnecess√°rias.O</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
aplicativo Web n√£o deve conter p√°ginas que n√£o s√£o usadas pelos usu√°rios, pois isso pode aumentar a superf√≠cie de ataque. Portanto, todas as rotas de API n√£o utilizadas devem estar desabilitadas. Voc√™ deve prestar especial aten√ß√£o a esta pergunta se usar estruturas Sails ou Feathers, pois elas geram automaticamente pontos finais da API. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proteja-se da HPP (Polui√ß√£o de Par√¢metros HTTP)</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Por padr√£o, o express adiciona todos os par√¢metros da solicita√ß√£o a uma matriz. A OWASP recomenda o uso do m√≥dulo hpp, que ignora todos os valores de par√¢metros de req.query e / ou req.body e simplesmente seleciona o √∫ltimo valor entre os duplicados.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">var</span> hpp = require(<span class="hljs-string">'hpp'</span>);<font></font>
app.use(hpp());<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Monitore os valores retornados.Por</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
exemplo, a tabela do usu√°rio pode armazenar dados importantes: senha, endere√ßo de email, data de nascimento etc. </font><font style="vertical-align: inherit;">Portanto, √© importante retornar apenas os dados necess√°rios. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo:</font></font><br>
<br>
<pre><code class="java hljs"> <span class="hljs-keyword">exports</span>.sanitizeUser = function(user) {
  <span class="hljs-keyword">return</span> {<font></font>
    id: user.id,<font></font>
    username: user.username,<font></font>
    fullName: user.fullName<font></font>
  };<font></font>
};<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usar descritores</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Use descritores para descrever o comportamento de uma propriedade para v√°rias opera√ß√µes: grav√°vel - se √© poss√≠vel alterar o valor de uma propriedade, enumer√°vel - se √© poss√≠vel usar uma propriedade em um loop for..in, configur√°vel - se √© poss√≠vel substituir uma propriedade. </font><font style="vertical-align: inherit;">√â recomend√°vel prestar aten√ß√£o √†s propriedades listadas, pois ao definir a propriedade de um objeto, todos esses atributos s√£o verdadeiros por padr√£o. </font><font style="vertical-align: inherit;">Voc√™ pode alterar o valor das propriedades da seguinte maneira:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">var</span> o = {};<font></font>
Object.defineProperty(o, <span class="hljs-string">"a"</span>, {<font></font>
    writable: <span class="hljs-keyword">true</span>,<font></font>
    enumerable: <span class="hljs-keyword">true</span>,<font></font>
    configurable: <span class="hljs-keyword">true</span>,<font></font>
    value: <span class="hljs-string">"A"</span><font></font>
});<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usar ACLs O</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Acl pode ajudar a diferenciar o acesso a dados com base em fun√ß√µes. </font><font style="vertical-align: inherit;">Por exemplo, adicionar permiss√£o se parece com isso:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-comment">// guest is allowed to view blogs</span>
acl.allow(<span class="hljs-string">'guest'</span>, <span class="hljs-string">'blogs'</span>, <span class="hljs-string">'view'</span>)
<span class="hljs-comment">// allow function accepts arrays as any parameter</span>
acl.allow(<span class="hljs-string">'member'</span>, <span class="hljs-string">'blogs'</span>, [<span class="hljs-string">'edit'</span>, <span class="hljs-string">'view'</span>, <span class="hljs-string">'delete'</span>])
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Capturar uncaughtException</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Por padr√£o, no caso de uma exce√ß√£o n√£o capturada, o NodeJS lan√ßar√° o rastreamento de pilha atual e encerrar√° o encadeamento de execu√ß√£o. </font><font style="vertical-align: inherit;">No entanto, o NodeJS permite personalizar esse comportamento. </font><font style="vertical-align: inherit;">No caso de uma exce√ß√£o n√£o capturada, um evento uncaughtException √© gerado, que pode ser capturado usando o objeto de processo:</font></font><br>
<br>
<pre><code class="java hljs">process.on(<span class="hljs-string">"uncaughtException"</span>, function(err) {
    <span class="hljs-comment">// clean up allocated resources</span>
    <span class="hljs-comment">// log necessary error details to log files</span>
    process.exit(); <span class="hljs-comment">// exit the process to avoid unknown state</span><font></font>
});<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vale lembrar que, quando ocorre uma exce√ß√£o n√£o capturada, √© necess√°rio limpar todos os recursos alocados (por exemplo, descritores de arquivo e manipuladores) antes de concluir o processo Z para evitar erros imprevistos. </font><font style="vertical-align: inherit;">√â altamente desencorajado que o programa continue sendo executado se ocorrer uma exce√ß√£o n√£o detectada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, ao exibir mensagens de erro, o usu√°rio n√£o deve divulgar informa√ß√µes detalhadas sobre erros, como rastreamento de pilha.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seguran√ßa do servidor</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Definir sinalizadores para cabe√ßalhos ao trabalhar com cookies.Existem</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
v√°rios sinalizadores que podem ajudar a proteger contra ataques como xss e csrf: httpOnly, que impede o acesso a cookies atrav√©s de javascript; </font><font style="vertical-align: inherit;">Seguro - permite o envio de cookies apenas via HTTPS e SameSite, que determina a capacidade de transferir cookies para um recurso de terceiros. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exemplo de uso:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">var</span> session = require(<span class="hljs-string">'express-session'</span>);<font></font>
app.use(session({<font></font>
    secret: <span class="hljs-string">'your-secret-key'</span>,<font></font>
    key: <span class="hljs-string">'cookieName'</span>,<font></font>
    cookie: { secure: <span class="hljs-keyword">true</span>, httpOnly: <span class="hljs-keyword">true</span>, path: <span class="hljs-string">'/user'</span>, sameSite: <span class="hljs-keyword">true</span>}<font></font>
}));<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Definir cabe√ßalhos HTTP para seguran√ßa</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
A seguir, est√£o os cabe√ßalhos e exemplos de como conect√°-los para ajud√°-lo a se proteger de uma s√©rie de ataques comuns. </font><font style="vertical-align: inherit;">Os cabe√ßalhos s√£o definidos usando o m√≥dulo capacete </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Seguran√ßa de transporte restrita: HSTS (HTTP Strict Transport Security) informa ao navegador que o aplicativo pode ser acessado apenas via HTTPS</font></font><br>
<br>
<pre><code class="java hljs">app.use(helmet.hsts()); <span class="hljs-comment">// default configuration</span>
app.use(helmet.hsts(<span class="hljs-string">"&lt;max-age&gt;"</span>, <span class="hljs-string">"&lt;includeSubdomains&gt;"</span>)); <span class="hljs-comment">// custom configuration</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Op√ß√µes de quadro X: determina se a p√°gina pode ser usada em quadro, iframe, incorpora√ß√£o ou objeto</font></font><br>
<br>
<pre><code class="java hljs">app.use(hemlet.xframe()); <span class="hljs-comment">// default behavior (DENY)</span>
helmet.xframe(<span class="hljs-string">'sameorigin'</span>); <span class="hljs-comment">// SAMEORIGIN</span>
helmet.xframe(<span class="hljs-string">'allow-from'</span>, <span class="hljs-string">'http://alloweduri.com'</span>); <span class="hljs-comment">//ALLOW-FROM uri</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Prote√ß√£o X-XSS: permite que o navegador pare de carregar a p√°gina se detectar um ataque XSS refletido.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">var</span> xssFilter = require(<span class="hljs-string">'x-xss-protection'</span>);<font></font>
app.use(xssFilter());<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Op√ß√µes de tipo de conte√∫do X: usadas para impedir ataques usando tipos MIME</font></font><br>
<br>
<pre><code class="java hljs">app.use(helmet.noSniff());
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Pol√≠tica de seguran√ßa de conte√∫do: evita ataques como XSS e ataques de inje√ß√£o de dados</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">const</span> csp = require(<span class="hljs-string">'helmet-csp'</span>)<font></font>
app.use(csp({<font></font>
   directives: {<font></font>
       defaultSrc: [<span class="hljs-string">"'self'"</span>],  <span class="hljs-comment">// default value for all directives that are absent</span>
       scriptSrc: [<span class="hljs-string">"'self'"</span>],   <span class="hljs-comment">// helps prevent XSS attacks</span>
       frameAncestors: [<span class="hljs-string">"'none'"</span>],  <span class="hljs-comment">// helps prevent Clickjacking attacks</span>
       imgSrc: [<span class="hljs-string">"'self'"</span>, <span class="hljs-string">"'http://imgexample.com'"</span>],<font></font>
       styleSrc: [<span class="hljs-string">"'none'"</span>]<font></font>
    }<font></font>
}))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Controle de cache e Pragma: para gerenciar o cache, especialmente esse cabe√ßalho pode ser √∫til para p√°ginas que cont√™m dados confidenciais. </font><font style="vertical-align: inherit;">No entanto, lembre-se de que desativar o cache em todas as p√°ginas pode afetar o desempenho.</font></font><br>
<br>
<pre><code class="java hljs">app.use(helmet.noCache());
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Op√ß√µes de download X: cabe√ßalho impede que o Inter Explorer execute arquivos baixados</font></font><br>
<br>
<pre><code class="java hljs">app.use(helmet.ieNoOpen());
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Expect-CT: Transpar√™ncia de certificado - um mecanismo criado para solucionar alguns problemas com a infraestrutura de certificado SSL, este cabe√ßalho informa ao navegador sobre a necessidade de verifica√ß√£o adicional de certificado nos logs de CT</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">var</span> expectCt = require(<span class="hljs-string">'expect-ct'</span>);<font></font>
app.use(expectCt({ maxAge: <span class="hljs-number">123</span> }));<font></font>
app.use(expectCt({ enforce: <span class="hljs-keyword">true</span>, maxAge: <span class="hljs-number">123</span> }));<font></font>
app.use(expectCt({ enforce: <span class="hljs-keyword">true</span>, maxAge: <span class="hljs-number">123</span>, reportUri: <span class="hljs-string">'http://example.com'</span>}));
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ X-Powered-By: um cabe√ßalho opcional usado para indicar a tecnologia usada no servidor. </font><font style="vertical-align: inherit;">Voc√™ pode ocultar este cabe√ßalho da seguinte maneira:</font></font><br>
<br>
<pre><code class="java hljs">app.use(helmet.hidePoweredBy());
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Al√©m disso, voc√™ pode alterar o valor para ocultar informa√ß√µes reais sobre as tecnologias que voc√™ usa:</font></font><br>
<br>
<pre><code class="java hljs">app.use(helmet.hidePoweredBy({ setTo: <span class="hljs-string">'PHP 4.2.0'</span> }));
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seguran√ßa da plataforma</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atualize seus pacotes A</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
seguran√ßa do seu aplicativo depende da seguran√ßa dos pacotes que voc√™ usa, por isso √© importante usar a vers√£o mais recente do pacote. Para garantir que o pacote que voc√™ est√° usando n√£o contenha vulnerabilidades conhecidas, voc√™ pode usar a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lista especial do OWASP</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Voc√™ tamb√©m pode usar a biblioteca que verifica os pacotes quanto a vulnerabilidades conhecidas Retire.js. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√£o use fun√ß√µes inseguras.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
H√° fun√ß√µes que devem ser descartadas sempre que poss√≠vel. Entre essas fun√ß√µes est√° eval (), que executa uma string tomada como argumento. Em combina√ß√£o com a entrada do usu√°rio, o uso dessa fun√ß√£o pode levar a vulnerabilidades na execu√ß√£o remota de c√≥digo, pois, por raz√µes semelhantes, o uso de child_process.exec tamb√©m √© inseguro, porque a fun√ß√£o passa os argumentos recebidos para bin / sh. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, h√° v√°rios m√≥dulos que voc√™ deve usar com cuidado. Por exemplo, o m√≥dulo fs para trabalhar com arquivos. Se, de certa maneira, a entrada do usu√°rio gerada for passada para uma fun√ß√£o, seu aplicativo poder√° ficar vulner√°vel √† inclus√£o de um arquivo local e de passagem de diret√≥rio.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O m√≥dulo vm, que fornece uma API para compilar e executar c√≥digo em uma m√°quina virtual V8, deve ser usado apenas na sandbox. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqui</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> voc√™ pode se familiarizar com outras fun√ß√µes que podem tornar seu aplicativo inseguro.Tenha </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cuidado com express√µes regulares.Uma express√£o</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
regular pode ser escrita para que voc√™ possa alcan√ßar uma situa√ß√£o em que a express√£o crescer√° exponencialmente, o que pode levar a uma nega√ß√£o de servi√ßo. Esses ataques s√£o chamados de ReDoS. Existem v√°rias ferramentas para verificar se as express√µes regulares s√£o seguras, uma das quais √© o vuln-regex-detector. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Execute o linter periodicamente</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante o desenvolvimento, √© dif√≠cil manter todas as recomenda√ß√µes de seguran√ßa em mente e, quando se trata de desenvolvimento da equipe, n√£o √© f√°cil alcan√ßar a conformidade com as regras de todos os membros da equipe. Para tais fins, existem ferramentas para an√°lise de seguran√ßa est√°tica. Essas ferramentas, sem executar seu c√≥digo, procuram vulnerabilidades nele. Al√©m disso, os linters permitem adicionar regras personalizadas para localizar lugares no c√≥digo que possam estar vulner√°veis. Os linters mais usados ‚Äã‚Äãs√£o ESLint e JSHint. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Use o modo</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
estrito.O Javascript possui v√°rias fun√ß√µes inseguras e obsoletas que n√£o devem ser usadas. Para excluir a possibilidade de usar essas fun√ß√µes, o modo estrito tamb√©m √© fornecido. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Siga os princ√≠pios gerais de seguran√ßa</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As recomenda√ß√µes descritas se concentram no NodeJS, mas n√£o se esque√ßa dos princ√≠pios gerais de seguran√ßa que devem ser observados, independentemente da plataforma usada.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt493702/index.html">Transi√ß√£o maci√ßa para o trabalho remoto: problemas t√©cnicos e amea√ßas √† seguran√ßa</a></li>
<li><a href="../pt493704/index.html">Usando TypeScript em JavaScript sem escrever TypeScript</a></li>
<li><a href="../pt493706/index.html">Conhe√ßa o seu inimigo: crie um backdoor do Node.js.</a></li>
<li><a href="../pt493708/index.html">Anatomia do cluster Kubernetes da minha casa</a></li>
<li><a href="../pt493712/index.html">Novos recursos TypeScript para usabilidade aprimorada</a></li>
<li><a href="../pt493716/index.html">Digite infer√™ncia no TypeScript usando a constru√ß√£o as const e a palavra-chave infer</a></li>
<li><a href="../pt493718/index.html">Discuss√£o: utilit√°rios UNIX padr√£o que poucos usaram e est√£o usando atualmente</a></li>
<li><a href="../pt493720/index.html">A tempestade perfeita: como a tecnologia est√° mudando a ind√∫stria de servi√ßos de alimenta√ß√£o</a></li>
<li><a href="../pt493724/index.html">RPA Rob√≥tica de processos atrav√©s dos olhos de um analista</a></li>
<li><a href="../pt493726/index.html">Complexo de detec√ß√£o de fumantes por foto ou v√≠deo, com base na Intel NUC</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>