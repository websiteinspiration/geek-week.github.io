<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👆🏼 👨🏿‍🚒 😷 Implémentation d'un algorithme de détermination de la largeur d'un objet à l'aide d'un télémètre à ultrasons et d'encodeurs en langage RobotC 🌝 👨🏾‍🎨 🌫️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonne journée! 
 
 Aujourd'hui, je voudrais partager la mise en œuvre de l'algorithme pour déterminer la largeur d'un objet à l'aide d'un télémètre à ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Implémentation d'un algorithme de détermination de la largeur d'un objet à l'aide d'un télémètre à ultrasons et d'encodeurs en langage RobotC</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/503176/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonne journée! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aujourd'hui, je voudrais partager la mise en œuvre de l'algorithme pour déterminer la largeur d'un objet à l'aide d'un télémètre à ultrasons et d'encodeurs dans le langage de programmation RobotC (en utilisant la plate-forme VEX EDR).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Préhistoire</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Récemment, on m'a proposé de diriger une classe de maître sur la résolution de problèmes intéressants en utilisant le langage de programmation RobotC. </font><font style="vertical-align: inherit;">Lors de la master class, j'ai envisagé la tâche de déterminer la largeur de l'objet, dont l'implémentation de l'algorithme que je souhaite partager dans cette publication.</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Base élémentaire</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme terrain d'entraînement expérimental, j'ai utilisé l'environnement Robot Virtual Worlds pour la plate-forme VEX, le modèle de robot virtuel VEX Launcher, des modèles virtuels d'éléments de compétition VRC Turning Point (figure 1) et les formules mathématiques les plus simples (pour déterminer la longueur d'un accord dans un cercle avec un angle central connu). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/17/tx/x-/17txx-doqjqt3baxzodq7lefbmm.png" alt="image"><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Graphique 1</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Terrain d'entraînement virtuel avec un robot</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tâche</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Déterminer le diamètre de la balle en utilisant uniquement un télémètre à ultrasons et des encodeurs montés sur le robot</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Base théorique</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour déterminer la largeur de l'objet, j'ai utilisé le concept d'un </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diagramme de rayonnement</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (figure 2). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8m/1x/qw/8m1xqw4-9xx-e_hrazmepq8zdpq.png" alt="image"><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 2.</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sensibilité et motif directionnel du télémètre à ultrasons </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En substance, il était nécessaire de déterminer l'angle formé lors du passage de la position extrême droite à la position extrême gauche entre les tangentes aux points extrêmes du diagramme. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considérez la figure 3. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ym/pq/5j/ympq5j8yf8hlcecpz8j-kbvxjfa.png" alt="image"><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 3</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Géométrie de l'algorithme </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous rechercherons </font><font style="vertical-align: inherit;">l' </font><font style="vertical-align: inherit;">angle central de l'arc en fonction de la relation entre le rayon de l'angle et l'arc de rotation du robot. </font><font style="vertical-align: inherit;">La valeur de largeur finale correspondra à la corde m de l'arc.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paramètres d'entrée</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En tant que paramètres d'entrée, j'ai sélectionné: </font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dist = 100 mm (la distance à laquelle le robot s'arrête pour mesurer, le paramètre est sélectionné en fonction de la présence d'autres objets autour de l'objet qui peuvent tomber dans le champ de vision du capteur et interférer avec la mesure)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d_wheel = 102 mm (diamètre de la roue du robot)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d_ball = 102 mm (diamètre réel de la balle)</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une erreur a été déterminée comme paramètre de sortie de cette tâche, ce qui indiquera la précision de notre méthode et les paramètres sélectionnés: </font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erreur = abs (d_ball_exper - d_ball)</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Algorithme de fonctionnement du programme</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les étapes suivantes de l'algorithme ont été identifiées.</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Déplacement vers l'objet.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pivoter à l'extrême droite d'un objet.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Faire pivoter vers le point extrême gauche de l'objet.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Calcul de l'angle à l'aide de relevés issus de codeurs.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Calcul d'erreur.</font></font></li>
</ol><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implémentation RobotC de l'algorithme</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, nous devons initialiser la configuration standard du robot virtuel:</font></font><br>
<br>
<pre><code class="plaintext hljs">#pragma config(StandardModel, "VEX Launchbot")</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous implémentons une fonction qui sera chargée de faire tourner le robot vers l'extrême droite et / ou l'extrême gauche. </font><font style="vertical-align: inherit;">La fonction renvoie l'encodeur après un tour, qui sera utilisé dans d'autres calculs:</font></font><br>
<br>
<pre><code class="1c hljs">int turn_to_over_object(int leftSpeed, int rightSpeed, int distance, bool need_object, bool left_side)<font></font>
{<font></font>
if(need_object == true)<font></font>
{<font></font>
if(left_side == true)<font></font>
{<font></font>
while(SensorValue[sonarSensor] &gt; distance)<font></font>
{<font></font>
setMultipleMotors(-leftSpeed, leftMotor,frontLeftMotor);<font></font>
setMultipleMotors(rightSpeed, rightMotor,frontRightMotor);<font></font>
}<font></font>
}<font></font>
else<font></font>
{<font></font>
while(SensorValue[sonarSensor] &gt; distance)<font></font>
{<font></font>
setMultipleMotors(leftSpeed, leftMotor,frontLeftMotor);<font></font>
setMultipleMotors(-rightSpeed, rightMotor,frontRightMotor);<font></font>
}<font></font>
}<font></font>
}<font></font>
else<font></font>
{<font></font>
if(left_side == true)<font></font>
{<font></font>
while(SensorValue[sonarSensor] &lt; (distance + <span class="hljs-number">1</span>))<font></font>
{<font></font>
setMultipleMotors(-leftSpeed, leftMotor,frontLeftMotor);<font></font>
setMultipleMotors(rightSpeed, rightMotor,frontRightMotor);<font></font>
}<font></font>
}<font></font>
else<font></font>
{<font></font>
while(SensorValue[sonarSensor] &lt; (distance + <span class="hljs-number">1</span>))<font></font>
{<font></font>
setMultipleMotors(leftSpeed, leftMotor,frontLeftMotor);<font></font>
setMultipleMotors(-rightSpeed, rightMotor,frontRightMotor);<font></font>
}<font></font>
}<font></font>
}<font></font>
<font></font>
return getMotorEncoder(leftMotor);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Examinons de plus près les arguments de la fonction:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">leftSpeed ​​- vitesse d'entraînement gauche </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rightSpeed ​​- bonne vitesse d'entraînement </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rightSpeed ​​- bonne vitesse d'entraînement </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">distance - distance à l'objet où le robot s'est arrêté</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">need_object - mode mouvement: Vrai, si un objet est nécessaire dans le champ de vision du capteur, Faux si un objet est nécessaire</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">left_side - sens de rotation du robot. </font><font style="vertical-align: inherit;">Vrai - tourner à gauche, Faux - tourner à droite</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec la valeur need_object = True, le robot tournera jusqu'à ce que l'objet soit à distance du robot (dans notre cas, 100 mm). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec la valeur need_object = False, le robot tournera jusqu'à ce que l'objet soit à une distance (distance + 1) du robot. Le paramètre unitaire au total affecte la précision finale de détermination de l'absence d'un objet dans le champ de vision du capteur (il est possible d'améliorer le programme en intégrant ce paramètre dans les arguments de fonction). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Écrivons le corps principal du programme:</font></font><br>
<br>
<pre><code class="plaintext hljs">task main()<font></font>
{<font></font>
int d_ball = 10.2; //sm<font></font>
int d_wheel = 10.2;<font></font>
<font></font>
int dist = 10; //sm<font></font>
//  <font></font>
setMotor(armMotor, -50);<font></font>
wait(1);<font></font>
<font></font>
while(SensorValue[sonarSensor] &gt; 10)<font></font>
{<font></font>
setMultipleMotors(50, leftMotor, rightMotor, frontLeftMotor, frontRightMotor);<font></font>
}<font></font>
stopAllMotors();<font></font>
int enc = 0;<font></font>
enc = turn_to_over_object(50, 50, dist, false, false);<font></font>
enc = turn_to_over_object(50, 50, dist, true, true);<font></font>
resetMotorEncoder(leftMotor);<font></font>
enc = turn_to_over_object(50, 50, dist, false, true);<font></font>
stopAllMotors();<font></font>
<font></font>
float teta = abs(enc) * PI * d_wheel * d_wheel / (dist * 627);<font></font>
float d_ball_exper = 2 * dist * sin(teta / 2);<font></font>
	<font></font>
float error = abs(d_ball_exper - d_ball);<font></font>
while(1)<font></font>
{<font></font>
}<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La première boucle while s'exécute jusqu'à ce que le robot atteigne la distance spécifiée à l'objet. Ensuite, nous devons appeler la fonction écrite ci-dessus une par une afin de mesurer la lecture du codeur entre les positions la plus à droite et la plus à gauche (notez qu'avant de mesurer, il est nécessaire de remettre le codeur à zéro). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour obtenir la formule d'angle, j'ai été guidé par les formules suivantes: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - enc = N * 627, où </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;N est le nombre de tours de la roue, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;enc est la lecture du codeur, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;627 est la résolution du codeur =&gt; N express; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - S = N * l, où </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;l est la longueur de la roue, l = PI * d_wheel * d_wheel =&gt; on remplace N et l =&gt; S = enc * PI * d_wheel * d_wheel / 627; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - d'autre part, S = dist * teta, où</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;S est la grandeur de l'arc que le robot a tourné, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;teta est l'angle central souhaité; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - sur la base des données ci-dessus, nous exprimons teta =&gt; teta = enc * PI * d_wheel * d_wheel / (627 * dist) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour trouver l'accord égal au diamètre souhaité de la balle, nous utilisons la formule: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;d_ball_exper = 2 * dist * sin (teta / 2) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La boucle while sans fin à la fin du programme est nécessaire pour voir les valeurs reçues dans le débogueur.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Données récapitulatives</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les valeurs suivantes du diamètre de la balle et des erreurs ont été obtenues sur le champ virtuel: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;d_ball_exper = 10,6 cm </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;erreur = 0,4 cm </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, la méthode obtenue pour mesurer la largeur donne une petite valeur d'erreur, ce qui est acceptable pour la classe de précision des capteurs utilisés. </font><font style="vertical-align: inherit;">La valeur d'erreur peut être réduite en sélectionnant la valeur du paramètre dist (par exemple, en commençant un cycle avec le robot reculant avec une certaine étape qui passe à dist) ou en utilisant le contrôleur PID, ce qui réduira l'influence de l'inertie du robot sur la valeur finale de l'encodeur pendant le freinage.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perspectives</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À l'avenir, j'examinerai d'autres méthodes d'utilisation de capteurs robotiques pour déterminer les paramètres environnementaux.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr503154/index.html">Scénario futur pour débordement de pile</a></li>
<li><a href="../fr503156/index.html">Les gares de Russie peuvent être équipées d'imageurs thermiques russes; en apparence, ils sont très similaires aux Chinois</a></li>
<li><a href="../fr503158/index.html">L'intelligence artificielle peint une image par elle-même, vraiment par elle-même - sans apprendre des exemples d'autres peintures</a></li>
<li><a href="../fr503164/index.html">Publicité sur les jeux: politique de Google</a></li>
<li><a href="../fr503172/index.html">C #: Présentation des générateurs de code source</a></li>
<li><a href="../fr503178/index.html">Apple Mac et appareils fantaisie. LTO, SAS, Fibre Channel, eSATA</a></li>
<li><a href="../fr503182/index.html">"Je suis le premier développeur aveugle de mon entreprise." Partie 1</a></li>
<li><a href="../fr503184/index.html">Nous vous invitons à la réunion en ligne Zabbix</a></li>
<li><a href="../fr503192/index.html">oVirt en 2 heures. Partie 4. Opérations de base</a></li>
<li><a href="../fr503194/index.html">ISA ne pardonne pas les erreurs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>