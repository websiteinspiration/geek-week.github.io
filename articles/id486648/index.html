<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏼‍🎤 📝 ❣️ AWS Lambda Beraksi di Jawa 11. Pergi ke Serverless untuk Produksi 👌 🍈 💽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Artikel ini adalah panduan tentang cara menggunakan AWS Lambda dengan cepat dan tanpa rasa sakit dengan contoh sederhana. Cocok untuk pengembang yang ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>AWS Lambda Beraksi di Jawa 11. Pergi ke Serverless untuk Produksi</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dins/blog/486648/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artikel ini adalah panduan tentang cara menggunakan AWS Lambda dengan cepat dan tanpa rasa sakit dengan contoh sederhana. </font><font style="vertical-align: inherit;">Cocok untuk pengembang yang sama sekali tidak bekerja dengan Lambda, dan yang tahu Cloud untuk mengevaluasi visi lain untuk mengembangkan aplikasi Serverless.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bd/y8/lu/bdy8luzeox9qq09msokx8yzoba4.jpeg" alt="gambar"><br>
<a name="habracut"></a><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pengantar</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Halo semuanya. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nama saya Alexander Gruzdev, saya Pimpinan Tim Java di DINS. Selama lebih dari dua tahun, saya telah bekerja erat dengan infrastruktur AWS dan memiliki pengalaman dalam menulis aplikasi untuk AWS dan dalam menyebarkan aplikasi-aplikasi ini. Dalam pekerjaan saya, saya harus menggunakan ElasticBeanstalk, ECS, Fargate, EKS, dan, tentu saja, AWS Lambda. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Masing-masing layanan ini baik dengan caranya sendiri, dan dalam kerangka artikel ini saya tidak akan mendesak untuk hanya menggunakan AWS Lambda sebagai pengganti untuk semua opsi lainnya. Saya hanya ingin menunjukkan betapa mudahnya untuk mulai menggunakan Lambda, dan dalam hal apa Anda akan mendapatkan manfaat menggunakannya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semua orang, dari pengembang hingga manajer, menginginkan proses yang jelas untuk mengirimkan perubahan kepada pelanggan. </font><font style="vertical-align: inherit;">Semakin transparan jalur ini dan semakin sedikit upaya yang diperlukan, semakin menguntungkan. </font><font style="vertical-align: inherit;">Paling sering, pengembang dan penguji tidak ingin tahu di mana aplikasi akan digunakan, perangkat keras mana yang harus dipilih, di wilayah mana Anda ingin meletakkan replika, dll. </font><font style="vertical-align: inherit;">Dalam diagram berikut, Anda dapat melihat kelas layanan "aaS" (sebagai layanan), di mana AWS Lambda mewakili kategori FaaS.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z8/nj/wl/z8njwlqjrgatljwptthtqe9ealu.png" alt="gambar"><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Singkatnya</font></font></b>
                        <div class="spoiler_text">FaaS ,            .     ,  , CRUD   C, R, U, D     Create   Read.      ,   —  .<br>
</div>
                    </div><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ide</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk menunjukkan apa pengembangan solusi Serverless, saya memutuskan untuk mengambil contoh yang agak dangkal. </font><font style="vertical-align: inherit;">Saya pikir Anda telah melihat formulir umpan balik Hubungi Kami di banyak situs, di mana Anda dapat meninggalkan surat atau telepon dan mengajukan pertanyaan untuk dijawab kemudian. </font><font style="vertical-align: inherit;">Layar di bawah ini, bentuknya tidak super, tapi subjek artikel ini bukan desain material. </font></font><br>
<img src="https://habrastorage.org/webt/gv/5g/iv/gv5givju7glj8vftkb1cdhupdiw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan mengisi formulir ini, pelanggan potensial akan menunggu panggilan atau surat dari Anda. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dari sisi teknis yang Anda butuhkan:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menyimpan data dari formulir ke database;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mengirim surat ke agen yang akan menjawab pertanyaan;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mungkin menulis layanan lain di mana agen akan menandai pekerjaan yang dilakukan berdasarkan database yang sama (tidak termasuk dalam ruang lingkup artikel).</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Implementasi ide tersedia di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arsitektur</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hal pertama yang terlintas dalam pikiran selama implementasi adalah apa yang kita butuhkan:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mesin di belakang, depan, gambar, dll.,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mobil dengan pangkalan</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mesin dengan layanan email.</font></font></li>
</ul><br>
<br>
<img src="https://habrastorage.org/webt/9a/7h/83/9a7h83iyieeicpht4-bcwy8l-ja.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagian belakang dan pangkalan, dengan cara yang baik, perlu direplikasi, tetapi misalkan kita melakukan ini untuk mini-store dan beban pada formulir ini minimal. </font><font style="vertical-align: inherit;">Oleh karena itu, semua mesin ini dapat digabungkan menjadi satu dan digunakan dalam satu set. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi karena kita mempertimbangkan Serverless, mari kita membangun arsitektur sepenuhnya pada komponen serverless. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak peduli seberapa menjanjikan Serverless mungkin terdengar, kita semua mengerti bahwa server masih ada di sini, mereka hanya menghilang dari bidang visi Anda. </font><font style="vertical-align: inherit;">Dan sekarang cloud bekerja sehingga Anda bisa melakukan pekerjaan yang bisa Anda lakukan sendiri. </font><font style="vertical-align: inherit;">Tapi mari kita coba gunakan hanya komponen tanpa server seperti itu: </font></font><br>
<img src="https://habrastorage.org/webt/mf/iw/6i/mfiw6if-6nlss4pl-brkgxenxuc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diagram menunjukkan pemisahan yang sangat jelas dari fungsi masing-masing komponen.</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS Lambda adalah komponen utama yang berisi kode / logika,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S3 bertanggung jawab untuk menyimpan sumber daya statis dan skrip JS,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CloudFront - untuk mekanisme caching dan dukungan multi-regional,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SES - layanan email,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DynamoDB - basis untuk menyimpan data dari formulir (dari siapa, pertanyaan apa, ke mana harus mengirim jawabannya),</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gateway API - API HTTP untuk lambda kami,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Route53 - diperlukan jika Anda ingin menambahkan nama domain yang indah.</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak semua komponen ini akan digunakan dalam panduan kami berikutnya, hanya agar tidak meregangkan artikel. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Route53 dan CloudFront adalah komponen yang cukup sederhana yang dapat Anda baca secara terpisah. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Spoiler kecil yang akan memberi kita solusi:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami bergerak menjauh dari mendukung mesin EC2, tidak ada debugging melalui ssh,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurasi mudah: konfigurasikan pembatasan / caching / akses dalam satu klik,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mendukung kebijakan akses: membatasi hak dan memberikan akses,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Log out / pemantauan di luar kotak,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bayar hanya untuk sumber daya yang digunakan / permintaan.</font></font></li>
</ul><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Demo</font></font></h1><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Latihan</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mulai mengembangkan solusi Tanpa Server kami, Anda harus memenuhi persyaratan berikut:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Akun AWS aktif</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aws-cli</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sam-cli</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdk 11</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gradle</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah menginstal semua alat di atas, Anda perlu mengkonfigurasi aws-cli Anda untuk akses jarak jauh ke AWS. </font><font style="vertical-align: inherit;">Ikuti </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instruksi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ini akan membutuhkan membuat pengguna baru dan membongkar Kunci Akses dan Kunci Rahasianya.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perakitan proyek</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Buat proyek dari templat</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Buka direktori untuk proyek masa depan dan darinya luncurkan SAM CLI. </font><font style="vertical-align: inherit;">Ikuti instruksi: </font></font><br>
<img src="https://habrastorage.org/webt/kn/gu/7f/kngu7fr3q_h_7t7bq-ygr7baccs.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan: Tergantung pada versi SAM-CLI, perintahnya mungkin sedikit berbeda, tetapi semuanya tetap intuitif. </font><font style="vertical-align: inherit;">Pilih saja yang paling mirip dengan yang digunakan di atas. </font><font style="vertical-align: inherit;">Anda juga dapat memilih alat bangun yang berbeda jika Gradle tidak cocok untuk Anda. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Proyek "Halo, Dunia!" </font><font style="vertical-align: inherit;">siap. </font><font style="vertical-align: inherit;">Sekarang Anda dapat mengerjakan nama proyek dan paket, dependensi dan kode sumber.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Mari kita berurusan dengan kecanduan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambahkan dependensi berikut ke build.gradle:</font></font><br>
<pre><code class="javascript hljs">dependencies {
    <span class="hljs-comment">// AWS</span>
    implementation group: <span class="hljs-string">'com.amazonaws.serverless'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'aws-serverless-java-container-core'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'1.4'</span>
    implementation group: <span class="hljs-string">'com.amazonaws'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'aws-lambda-java-core'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'1.2.0'</span>
    implementation group: <span class="hljs-string">'com.amazonaws'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'aws-java-sdk-ses'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'1.11.670'</span>
    implementation group: <span class="hljs-string">'com.amazonaws'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'aws-java-sdk-dynamodb'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'1.11.670'</span>
    implementation group: <span class="hljs-string">'com.amazonaws'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'aws-lambda-java-log4j2'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'1.1.0'</span><font></font>
<font></font>
    <span class="hljs-comment">// Utils</span>
    implementation group: <span class="hljs-string">'com.fasterxml.jackson.core'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'jackson-core'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'2.10.0'</span>
    implementation group: <span class="hljs-string">'commons-io'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'commons-io'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'2.6'</span><font></font>
<font></font>
    <span class="hljs-comment">// Test</span>
    testImplementation group: <span class="hljs-string">'org.mockito'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'mockito-core'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'3.1.0'</span>
    testImplementation group: <span class="hljs-string">'org.powermock'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'powermock-api-mockito2'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'2.0.4'</span>
    testImplementation group: <span class="hljs-string">'org.powermock'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'powermock-module-junit4'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'2.0.4'</span>
    testImplementation group: <span class="hljs-string">'junit'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'junit'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'4.12'</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yang utama adalah AWS SDK. </font><font style="vertical-align: inherit;">Mereka akan memungkinkan Anda untuk bekerja dengan layanan tertentu, seperti SES, DynamoDB, dll.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Kami menulis lambda</font></font></h3><br>
<ul>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami mengubah kelas templat permintaan dan respons untuk RequestHandler menjadi AwsProxyRequest dan ContactUsProxyResponse.</font></font></b>
                        <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">RequestHandler</span>&lt;<span class="hljs-title">AwsProxyRequest</span>, <span class="hljs-title">ContactUsProxyResponse</span>&gt;
...
<span class="hljs-title">public</span> <span class="hljs-title">ContactUsProxyResponse</span> <span class="hljs-title">handleRequest</span>(<span class="hljs-title">AwsProxyRequest</span> <span class="hljs-title">request</span>, <span class="hljs-title">Context</span> <span class="hljs-title">context</span>) </span></code></pre><br>
</div>
                    </div></li>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">  AwsClientFactory   AWS SDK-.</b>
                        <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-comment">/**
 * Just an util class for an eager initialization of sdk clients.
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AwsClientFactory</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Logger LOG = LogManager.getLogger(AwsClientFactory.class);<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> AmazonSimpleEmailService sesClient;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> DynamoDB dynamoDB;<font></font>
<font></font>
    /**<font></font>
     * AWS regions should be env variables <span class="hljs-keyword">if</span> you want to generalize the solution.<font></font>
     */<font></font>
    AwsClientFactory() {<font></font>
        LOG.debug("AWS clients factory initialization.");<font></font>
        sesClient = AmazonSimpleEmailServiceClient.builder().withRegion(Regions.EU_WEST_1).build();<font></font>
        AmazonDynamoDB dynamoDBClient = AmazonDynamoDBClientBuilder.standard().withRegion(Regions.EU_WEST_1).build();<font></font>
        dynamoDB = <span class="hljs-keyword">new</span> DynamoDB(dynamoDBClient);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">DynamoDB <span class="hljs-title">getDynamoDB</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> dynamoDB;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">AmazonSimpleEmailService <span class="hljs-title">getSesClient</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> sesClient;<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></li>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">    ObjectMapper   .</b>
                        <div class="spoiler_text"><pre><code class="java hljs">
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ObjectMapper OBJECT_MAPPER = <span class="hljs-keyword">new</span> ObjectMapper();
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> AwsClientFactory AWS_CLIENT_FACTORY = <span class="hljs-keyword">new</span> AwsClientFactory();
</code></pre><br>
</div>
                    </div></li>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">         .</b>
                        <div class="spoiler_text"><pre><code class="java hljs">
 <span class="hljs-function"><span class="hljs-keyword">private</span> SendEmailResult <span class="hljs-title">sendEmail</span><span class="hljs-params">(ContactUsRequest contactUsRequest)</span> </span>{<font></font>
        String emailTemplate = getEmailTemplate();<font></font>
        String email = fillTemplate(emailTemplate, contactUsRequest);<font></font>
<font></font>
        SendEmailRequest sendEmailRequest =<font></font>
                <span class="hljs-keyword">new</span> SendEmailRequest(<font></font>
                        System.getenv(<span class="hljs-string">"SENDER_EMAIL"</span>),
                        <span class="hljs-keyword">new</span> Destination(List.of(System.getenv(<span class="hljs-string">"RECIPIENT_EMAIL"</span>))),
                        <span class="hljs-keyword">new</span> Message()<font></font>
                                .withSubject(<font></font>
                                        <span class="hljs-keyword">new</span> Content()<font></font>
                                                .withCharset(UTF_8.name())<font></font>
                                                .withData(contactUsRequest.getSubject()))<font></font>
                                .withBody(<span class="hljs-keyword">new</span> Body()<font></font>
                                        .withHtml(<span class="hljs-keyword">new</span> Content()<font></font>
                                                .withCharset(UTF_8.name())<font></font>
                                                .withData(email))));<font></font>
        LOG.info(<span class="hljs-string">"Email template is ready"</span>);
        <span class="hljs-keyword">return</span> AWS_CLIENT_FACTORY.getSesClient().sendEmail(sendEmailRequest);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">fillTemplate</span><span class="hljs-params">(String emailTemplate, ContactUsRequest contactUsRequest)</span> </span>{
        <span class="hljs-keyword">return</span> String.format(<font></font>
                emailTemplate,<font></font>
                contactUsRequest.getUsername(),<font></font>
                contactUsRequest.getEmail(),<font></font>
                contactUsRequest.getPhone(),<font></font>
                contactUsRequest.getQuestion());<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">getEmailTemplate</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> IOUtils.toString(<font></font>
                    Objects.requireNonNull(<span class="hljs-keyword">this</span>.getClass().getClassLoader()<font></font>
                                               .getResourceAsStream(<span class="hljs-string">"email_template.html"</span>)),<font></font>
                    UTF_8);<font></font>
        } <span class="hljs-keyword">catch</span> (IOException e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">"Loading an email template failed."</span>, e);<font></font>
        }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addEmailDetailsToDb</span><span class="hljs-params">(ContactUsRequest contactUsRequest, SendEmailResult sendEmailResult)</span> </span>{<font></font>
        AWS_CLIENT_FACTORY.getDynamoDB().getTable(<span class="hljs-string">"ContactUsTable"</span>)<font></font>
                          .putItem(<span class="hljs-keyword">new</span> Item()<font></font>
                                  .withPrimaryKey(<span class="hljs-string">"Id"</span>, sendEmailResult.getMessageId())<font></font>
                                  .withString(<span class="hljs-string">"Subject"</span>, contactUsRequest.getSubject())<font></font>
                                  .withString(<span class="hljs-string">"Username"</span>, contactUsRequest.getUsername())<font></font>
                                  .withString(<span class="hljs-string">"Phone"</span>, contactUsRequest.getPhone())<font></font>
                                  .withString(<span class="hljs-string">"Email"</span>, contactUsRequest.getEmail())<font></font>
                                  .withString(<span class="hljs-string">"Question"</span>, contactUsRequest.getQuestion()));<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></li>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">         .</b>
                        <div class="spoiler_text"><pre><code class="java hljs">
<span class="hljs-function"><span class="hljs-keyword">private</span> ContactUsProxyResponse <span class="hljs-title">buildResponse</span><span class="hljs-params">(<span class="hljs-keyword">int</span> statusCode, String body)</span> </span>{<font></font>
        ContactUsProxyResponse awsProxyResponse =<font></font>
                <span class="hljs-keyword">new</span> ContactUsProxyResponse();<font></font>
        awsProxyResponse.setStatusCode(statusCode);<font></font>
        awsProxyResponse.setBody(getBodyAsString(body));<font></font>
        awsProxyResponse.addHeader(CONTENT_TYPE, ContentType.APPLICATION_JSON.toString());<font></font>
        awsProxyResponse.addHeader(<span class="hljs-string">"Access-Control-Allow-Origin"</span>, <span class="hljs-string">"*"</span>);
        <span class="hljs-keyword">return</span> awsProxyResponse;<font></font>
}<font></font>
<font></font>
 <span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">getBodyAsString</span><span class="hljs-params">(String body)</span> </span>{
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> OBJECT_MAPPER.writeValueAsString(<span class="hljs-keyword">new</span> ContactUsResponseBody(body));<font></font>
        } <span class="hljs-keyword">catch</span> (JsonProcessingException e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">"Writing ContactUsResponseBody as string failed."</span>, e);<font></font>
        }<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></li>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">    .      «// WARMING UP».</b>
                        <div class="spoiler_text"><pre><code class="java hljs">
<span class="hljs-keyword">if</span> (Optional.ofNullable(request.getMultiValueHeaders()).map(headers -&gt; headers.containsKey(<span class="hljs-string">"X-WARM-UP"</span>)).orElse(FALSE)) {<font></font>
            LOG.info(<span class="hljs-string">"Lambda was warmed up"</span>);
            <span class="hljs-keyword">return</span> buildResponse(<span class="hljs-number">201</span>, <span class="hljs-string">"Lambda was warmed up. V1"</span>);<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></li>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">         handleRequest()</b>
                        <div class="spoiler_text"><pre><code class="java hljs">
<span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> ContactUsProxyResponse <span class="hljs-title">handleRequest</span><span class="hljs-params">(AwsProxyRequest request, Context context)</span> </span>{<font></font>
        LOG.info(<span class="hljs-string">"Request was received"</span>);<font></font>
        LOG.debug(getAsPrettyString(request));<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (Optional.ofNullable(request.getMultiValueHeaders()).map(headers -&gt; headers.containsKey(<span class="hljs-string">"X-WARM-UP"</span>)).orElse(FALSE)) {<font></font>
            LOG.info(<span class="hljs-string">"Lambda was warmed up"</span>);
            <span class="hljs-keyword">return</span> buildResponse(<span class="hljs-number">201</span>, <span class="hljs-string">"Lambda was warmed up. V1"</span>);<font></font>
        }<font></font>
<font></font>
        ContactUsRequest contactUsRequest = getContactUsRequest(request);<font></font>
<font></font>
        SendEmailResult sendEmailResult = sendEmail(contactUsRequest);<font></font>
        LOG.info(<span class="hljs-string">"Email was sent"</span>);<font></font>
<font></font>
        addEmailDetailsToDb(contactUsRequest, sendEmailResult);<font></font>
        LOG.info(<span class="hljs-string">"DB is updated"</span>);<font></font>
<font></font>
        <span class="hljs-keyword">return</span> buildResponse(<span class="hljs-number">200</span>,<font></font>
                String.format(<span class="hljs-string">"Message %s has been sent successfully."</span>, sendEmailResult.getMessageId()));<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Logika dasarnya cukup sederhana, jadi saya pikir tidak ada gunanya menggambarkannya secara rinci. Ada beberapa hal yang perlu diperhatikan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yang pertama adalah logging. Salah satu argumen dari metode lambda Konteks berisi banyak informasi tambahan, serta logger. Oleh karena itu, Anda tidak dapat membuat logger terpisah, tetapi gunakan konteks lambda yang disediakan. Untuk melakukan ini, cukup menelepon sebelum digunakan:</font></font><br>
<blockquote><code>LambdaLogger logger = context.getLogger(); </code></blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Poin kedua adalah pemanasan. Karena membuat lingkungan yang dapat dieksekusi untuk lambda malas, memulai JVM, memuat classpath dan mengeksekusi kode membutuhkan waktu. Panggilan pertama mungkin memakan waktu beberapa detik, yang tidak baik jika Anda menulis API sinkron yang berbeda. Untuk kasus-kasus seperti itu, Anda sendiri dapat memberi tahu AWS bahwa Anda perlu membuat beberapa instance lambda dalam keadaan siaga. Tapi ini mengharuskan seseorang untuk memanggil lambda. Jika kami melakukan ini dengan versi dasar kode, maka, pada kenyataannya, kami akan mengirim surat dan menulis beberapa data yang tidak akurat ke database.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk menghindari hal ini, kita dapat menambahkan semacam pemrosesan permintaan untuk membedakan permintaan sebenarnya dari permintaan pemanasan. Misalnya, kita bisa menambahkan header khusus ke permintaan. Dalam kasus kami, tajuk "X-WARM-UP" akan digunakan dengan nilai apa pun - untuk memahami bahwa ini adalah permintaan pemanasan dan kami hanya perlu mengembalikan semacam respons tanpa menjalankan logika bisnis.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hal terakhir yang ingin saya perhatikan adalah penggunaan variabel statis. </font><font style="vertical-align: inherit;">Ini tidak membuat instance lambda stateful dalam kasus kami, itu hanya memungkinkan menggunakan kembali objek yang sudah ada dan diinisialisasi. </font><font style="vertical-align: inherit;">Jika objek yang ingin Anda inisialisasi berubah secara statis selama eksekusi kode, coba pikirkan lagi apakah ini akan mengganggu operasi panggilan berikutnya ke lambda. </font><font style="vertical-align: inherit;">Juga, jika objek ini menggunakan variabel lingkungan selama inisialisasi, Anda tidak harus membuatnya statis.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Kami menulis tes</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode Lambda dapat dicakup oleh jenis tes yang sama yang Anda gunakan dalam kebanyakan kasus. </font><font style="vertical-align: inherit;">Tetapi untuk menjaga agar artikel tidak semakin berkembang, saya akan membahas pengujian aplikasi Serverless di artikel berikutnya tentang pengujian AWS Lambda dan pengembangan di tempat. </font><font style="vertical-align: inherit;">Meskipun unit test sudah tersedia di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repositori</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Kami menulis templat sumber daya SAM</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah kami menulis dan menguji lambda kami secara lokal, kami perlu menulis template SAM untuk menggunakan semua sumber daya ini di AWS.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sedikit tentang SAM</font></font></b>
                        <div class="spoiler_text">Serverless Application Model –     serverless .  ,      CloudFormation DSL,     –   Lambda, Gateway, DynamoDB  . . <br>
SAM, CloudFormation, Terraform –   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">IaC-</a>. SAM     Serverless-,   Terraform        . <br>
 Terraform   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">    DINS</a>.<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebenarnya, mari kita lihat sumber daya apa yang perlu kita deklarasikan di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SAM-template</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS :: Serverless :: Function</font></font></b></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Fitur utama sudah terisi bagi kami jika kami menggunakan SAM init untuk membuat proyek. </font><font style="vertical-align: inherit;">Tapi di sini adalah bagaimana mereka melihat contoh saya:</font></font><br>
<pre><code class="plaintext hljs">CodeUri: contact-us-function<font></font>
Handler: com.gralll.sam.App::handleRequest<font></font>
Runtime: java8<font></font>
MemorySize: 256<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini saya pikir semuanya sudah cukup jelas. </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CodeUri</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah direktori dengan </font><i><font style="vertical-align: inherit;">lambler </font></i></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Handler</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kami </font><font style="vertical-align: inherit;">- jalur penuh ke metode </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Runtime</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - apa yang </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ditulis oleh</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lambda </font><i><font style="vertical-align: inherit;">MemorySize</font></i><font style="vertical-align: inherit;"> - berbicara untuk dirinya sendiri </font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Berbicara tentang memori</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : hingga 3GB RAM tersedia di lambda, yang sesuai dengan sumber daya 2 CPU. Artinya, Anda tidak dapat mengatur CPU secara terpisah, hanya menambah / mengurangi jumlah memori.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Blok selanjutnya diperlukan untuk memilih metode penyebaran.</font></font><br>
<pre><code class="plaintext hljs">AutoPublishAlias: live<font></font>
DeploymentPreference:<font></font>
  Type: Canary10Percent10Minutes<font></font>
</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AutoPublishAlias</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - memungkinkan Anda </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menambahkan alias</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ke setiap versi yang digunakan </font><font style="vertical-align: inherit;">. Ini diperlukan untuk menerapkan penyebaran kenari. </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Canary10Percent10Minutes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - jenis penyebaran yang akan memungkinkan Anda untuk secara bersamaan memegang dua versi lambda: yang lama dan yang baru, tetapi hanya mengarahkan 10% dari lalu lintas ke yang baru. Jika dalam sepuluh menit tidak ada masalah, sisa traffic juga akan dialihkan ke versi baru. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat membaca lebih lanjut tentang menggunakan fitur-fitur canggih </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">di halaman SAM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berikutnya adalah variabel lingkungan yang akan digunakan dari kode. Setelah itu, blok lain untuk lambda:</font></font><br>
<pre><code class="plaintext hljs">Events:<font></font>
  ContactUs:<font></font>
    Type: Api<font></font>
    Properties:<font></font>
      Path: /contact<font></font>
      Method: post<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di dalamnya, kita harus menggambarkan pemicu untuk memanggil lambda. Dalam kasus kami, ini akan menjadi </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">permintaan Gateway API</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini adalah bentuk yang agak disederhanakan untuk menggambarkan API, tetapi cukup untuk Gateway API yang baru dibuat untuk mengarahkan semua permintaan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">POST / kontak</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ke lambda kami. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentu saja, kita perlu menggambarkan aspek keamanan. Di luar kotak, lambda yang dibuat tidak akan memiliki akses ke database atau layanan email. Jadi kita perlu secara eksplisit menentukan apa yang akan diizinkan. Ada </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">beberapa cara</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk memberikan akses di dalam AWS. Kami akan menggunakan Kebijakan Berbasis Sumberdaya:</font></font><br>
<pre><code class="plaintext hljs">Policies:<font></font>
  - AWSLambdaExecute<font></font>
  - Version: '2012-10-17'<font></font>
    Statement:<font></font>
      - Effect: Allow<font></font>
        Action:<font></font>
          - ses:SendEmail<font></font>
          - ses:SendRawEmail<font></font>
        Resource: 'arn:aws:ses:eu-west-1:548476639829:identity/aleksandrgruzdev11@gmail.com'<font></font>
      - Effect: Allow<font></font>
        Action:<font></font>
          - dynamodb:List*<font></font>
        Resource: '*'<font></font>
      - Effect: Allow<font></font>
        Action:<font></font>
          - dynamodb:Get*<font></font>
          - dynamodb:PutItem<font></font>
          - dynamodb:DescribeTable<font></font>
        Resource: 'arn:aws:dynamodb:*:*:table/ContactUsTable'<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Harap dicatat bahwa untuk tabel database kami tentukan nama tertentu, oleh karena itu, kami perlu membuat tabel dengan nama yang sama. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mengenai SES: Anda melihat alamat email saya. Dalam kasus Anda, itu harus alamat Anda yang sudah dikonfirmasi. Cara melakukannya, lihat di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tepat setelah itu, Anda dapat menemukan ARN Identitas sumber daya ini dengan mengklik alamat yang dibuat dan menggantinya dengan email dalam contoh di atas. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mereka seperti menemukan lambda. Sekarang mari kita beralih ke database. </font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS :: Serverless :: SimpleTable</font></font></i></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Untuk tugas kami, kami hanya akan membuat satu tabel </font><b><i><font style="vertical-align: inherit;">ContactUsTable</font></i></b><font style="vertical-align: inherit;"> :</font></font><br>
<pre><code class="plaintext hljs">ContactUsTable:<font></font>
  Type: AWS::Serverless::SimpleTable<font></font>
  Properties:<font></font>
    PrimaryKey:<font></font>
      Name: Id<font></font>
      Type: String<font></font>
    TableName: ContactUsTable<font></font>
    ProvisionedThroughput:<font></font>
      ReadCapacityUnits: 2<font></font>
      WriteCapacityUnits: 2<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bidang yang diperlukan - hanya Id, dan juga menunjukkan ReadCapacityUnits dan WriteCapacityUnits. </font><font style="vertical-align: inherit;">Kami tidak akan membahas secara terperinci nilai-nilai apa yang harus dipilih, karena ini juga merupakan topik yang agak luas. </font><font style="vertical-align: inherit;">Anda bisa membacanya di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Untuk aplikasi pengujian, nilai kecil dari urutan 1-2 juga cukup. </font><font style="vertical-align: inherit;">
Parameter </font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">global</font></font></i></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dapat diambil di blok ini jika, misalnya, Anda mendeklarasikan beberapa sumber daya tipe Function atau API.</font></font><br>
<pre><code class="plaintext hljs">Globals:<font></font>
  Function:<font></font>
    Timeout: 15<font></font>
  Api:<font></font>
    Cors:<font></font>
      AllowOrigin: "'*'"<font></font>
      AllowHeaders: "'Content-Type,X-WARM-UP,X-Amz-Date,Authorization,X-Api-Key'"<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya menggunakannya untuk mengatur batas waktu fungsi dan beberapa pengaturan Cors untuk memanggil Gateway API nanti dari halaman statis saya dengan formulir ContactUs. </font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keluaran</font></font></i></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Blok ini memungkinkan Anda untuk secara dinamis mendefinisikan beberapa variabel dalam konteks AWS CloudFormation global.</font></font><br>
<pre><code class="plaintext hljs">Outputs:<font></font>
  ContactUsApi:<font></font>
    Description: "API Gateway endpoint URL for Prod stage for ContactUs function"<font></font>
    Value: !Sub "https://${ServerlessRestApi}.execute-api.${AWS::Region}.amazonaws.com/Prod/contact/"<font></font>
  ContactUsFunction:<font></font>
    Description: "ContactUs Lambda Function ARN"<font></font>
    Value: !GetAtt ContactUsFunction.Arn<font></font>
  ContactUsFunctionIamRole:<font></font>
    Description: "Implicit IAM Role created for ContactUs function"<font></font>
    Value: !GetAtt ContactUsFunctionRole.Arn<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Misalnya, kami mendeklarasikan variabel ContactUsApi, yang akan ditetapkan ke nilai, sebagai alamat publik dari titik akhir API yang kami buat. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena kami menggunakan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ {ServerlessRestApi}</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , AWS akan memasukkan pengidentifikasi unik API Gateway baru kami ke dalam string. Akibatnya, aplikasi apa pun yang memiliki akses ke CloudFormation akan bisa mendapatkan alamat ini - dengan demikian Anda tidak dapat membuat hardcode URL layanan Anda. Nah, kelebihan lainnya adalah sangat mudah untuk melihat daftar output - beberapa informasi meta tentang stack Anda. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daftar lengkap fungsi dan parameter apa yang dapat Anda gunakan dapat ditemukan di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parameter</font></font></i></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Selain semua hal di atas, Anda dapat menambahkan blok </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parameter</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Opsi ini akan membantu membuat templat lebih fleksibel. </font><font style="vertical-align: inherit;">Di blok lain dari templat, Anda dapat membuat referensi ke parameter ini, sehingga tidak membuat hardcode beberapa nilai. </font><font style="vertical-align: inherit;">Misalnya, dalam templat saya dapat berupa email, SES ARN, jumlah memori, dll. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Itu seluruh templat. </font><font style="vertical-align: inherit;">Tidak ada yang melarang menambahkan beberapa sumber daya lebih dekat, misalnya, ember S3, sumber daya CloudFormation lainnya, atau </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sumber daya khusus</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> secara umum </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. Kami melanjutkan ke penyebaran</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk merakit proyek kami, kami tidak akan menggunakan Gradle, tetapi SAM.</font></font><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Majelis</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">F:\aws\projects\contact-us-sam-app&gt;sam build<font></font>
Building resource <span class="hljs-string">'ContactUsFunction'</span><font></font>
Running JavaGradleWorkflow:GradleBuild<font></font>
Running JavaGradleWorkflow:CopyArtifacts<font></font>
<font></font>
Build Succeeded<font></font>
<font></font>
Built Artifacts  : .aws-sam\build<font></font>
Built Template   : .aws-sam\build\template.yaml<font></font>
<font></font>
Commands you can use next<font></font>
=========================<font></font>
[*] Invoke Function: sam <span class="hljs-built_in">local</span> invoke<font></font>
[*] Deploy: sam deploy –guided<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menjalankan </font><font style="vertical-align: inherit;">perintah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build sam</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dari root proyek akan secara otomatis mengumpulkan </font><font style="vertical-align: inherit;">semua file yang diperlukan </font><font style="vertical-align: inherit;">ke </font><font style="vertical-align: inherit;">folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.aws-sam</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : kelas, dependensi, template SAM. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya, Anda perlu membuat ember S3, di mana SAM selanjutnya mengunggah semua artefak yang dikumpulkan. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini dapat dilakukan melalui konsol AWS berbasis browser, atau dengan perintah</font></font><br>
<blockquote><code>aws s3 mb s3://bucket-name</code></blockquote><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan: semua kotak dibuat dalam konteks global, dan itu dibagi-bagi di antara semua akun. </font><font style="vertical-align: inherit;">Jadi Anda tidak dapat membuat ember jika seseorang telah membuatnya di akun Anda. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saat ember siap, jalankan perintah:</font></font><br>
<blockquote><code>sam package --output-template-file packaged.yaml --s3-bucket &lt;YOUR_BACKET&gt;</code></blockquote><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hasil paket</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">F:\aws\projects\contact-us-sam-app&gt;sam package --output-template-file packaged.yaml --s3-bucket contact-us-sam-app<font></font>
Uploading to ea0c122c06a50d9676fbf9000a80a3bf  9212768 / 9212768.0  (100.00%)<font></font>
<font></font>
Successfully packaged artifacts and wrote output template to file packaged.yaml.<font></font>
Execute the following <span class="hljs-built_in">command</span> to deploy the packaged template<font></font>
sam deploy --template-file F:\aws\projects\contact-us-sam-app\packaged.yaml --stack-name &lt;YOUR STACK NAME&gt;<font></font>
</code></pre></div>
                    </div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya mengarahkan bucket contact-us-sam-app saya, dan SAM mengunggah semua sumber daya ke lokasi yang ditentukan. </font><font style="vertical-align: inherit;">Selanjutnya, SAM sudah memberi tahu Anda perintah untuk membuat tumpukan dengan sumber daya, dan dengan demikian menyematkan keputusan Anda. </font><font style="vertical-align: inherit;">Kami menjalankan perintah, setelah sedikit selesai:</font></font><br>
<blockquote><code>sam deploy --template-file packaged.yaml --region eu-west-1 --capabilities CAPABILITY_IAM --stack-name contact-us-sam-app </code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang Anda lihat, saya menambahkan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--capabilities CAPABILITY_IAM</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ini akan memungkinkan CloudFormation untuk membuat sumber daya IAM. </font><font style="vertical-align: inherit;">Jika tidak, Anda akan menerima kesalahan InsufficientCapabilities saat membuat. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berikut ini adalah log karya perintah ini (gambar dapat diklik). </font><font style="vertical-align: inherit;">Detail seperti status setiap sumber daya dan nilai-nilai output menjadi hanya tersedia di salah satu versi terbaru dari SAM CLI.</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/webt/nv/7p/4z/nv7p4zreqati1wd8c8vy3ubuzcm.png"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7. Periksa status CloudFormation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kita bisa menunggu penyebaran untuk menyelesaikan di konsol sampai muncul pesan yang menyatakan bahwa stack telah digunakan (perintah penyebaran log dalam paragraf sebelumnya):</font></font><br>
<blockquote><code>Successfully created/updated stack - contact-us-sam-app in eu-west-1</code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun dalam kasus kami, Anda akan melihat pesan ini hanya setelah sepuluh menit karena mode penyebaran kenari. Karenanya, lebih mudah untuk membuka konsol peramban dan menonton tumpukan di sana. </font></font><br>
<img src="https://habrastorage.org/webt/97/ki/k8/97kik8apukwxsvqwyvsd_wtmaqo.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah beberapa waktu, status akan berubah menjadi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CREATE_COMPLETE</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang berarti penyelesaiannya berhasil. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di tab </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acara</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">Anda dapat melihat status semua sumber daya. Jika tumpukan Anda gagal, ini adalah tempat Anda dapat menemukan pesan kesalahan terperinci. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Misalnya, ini: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPDATE_FAILED</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - jika Anda salah mengkonfigurasi API Gateway di templat.</font></font><br>
<img src="https://habrastorage.org/webt/ce/mh/aq/cemhaqtl6uvdmlvnr0bsvrbokok.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di tab Sumber Daya, Anda dapat menemukan semua sumber daya yang dibuat. </font><font style="vertical-align: inherit;">Jangan kaget dengan kuantitas mereka. </font><font style="vertical-align: inherit;">Meskipun kami hanya mendeklarasikan fungsi dan tabel database dalam templat SAM, CloudFormation menciptakan banyak sumber daya lain untuk kami. </font><font style="vertical-align: inherit;">Jika Anda melihat Tipe mereka, Anda dapat memahami layanan apa yang mereka miliki. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk Api Gateway, itu secara implisit dibuat:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ServerlessRestApi</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ServerlessRestApiDeployment</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ServerlessRestApiProdStage</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Juga untuk lambda beberapa objek tambahan telah dibuat. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang buka </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Outputs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan temukan URL API kami. </font><font style="vertical-align: inherit;">Salin, ini akan segera berguna.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8. Formulir HTML KontakUs</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang Anda ingat, saya memutuskan untuk membuat formulir ContactUs, dan sekarang kita perlu membuatnya agar tersedia tidak hanya di mesin lokal. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurasi</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Adapun formulir itu sendiri, misalnya, saya memutuskan untuk mengambil formulir HTML yang paling sederhana dan menambahkan panggilan Gateway API melalui ajax. </font></font><br>
<img src="https://habrastorage.org/webt/ps/e-/4h/pse-4hta3mojfuamij0dhj3bmyg.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain formulir itu sendiri, saya menambahkan beberapa tombol untuk debugging dan menyederhanakan pengisian: </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tetapkan default</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - pengganti, seperti yang diharapkan, parameter default yang ditentukan dalam HTML.</font></font><br>
<pre><code class="javascript hljs">$(<span class="hljs-string">"#url-input"</span>).val(<span class="hljs-string">"https://4ykskscuq0.execute-api.eu-west-1.amazonaws.com/Prod/contact"</span>);<font></font>
$(<span class="hljs-string">"#name-input"</span>).val(<span class="hljs-string">"Mike"</span>);<font></font>
$(<span class="hljs-string">"#email-input"</span>).val(<span class="hljs-string">"Mike@somemail.com"</span>);<font></font>
$(<span class="hljs-string">"#phone-input"</span>).val(<span class="hljs-string">"+79999999999"</span>);<font></font>
$(<span class="hljs-string">"#description-input"</span>).val(<span class="hljs-string">"How much does it cost?"</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda bermaksud untuk menggunakan fungsionalitas ini, ubah url-input ke path ke Gateway API Anda, yang Anda salin dari </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Output</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hosting</font></font></b><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buat ember S3 baru.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami memuat file HTML ke dalam ember dengan memilih opsi untuk menjadikan file tersebut publik.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami masuk ke ember tempat kami mengunggah file.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buka Properti, lalu aktifkan hosting situs web Static dan lihat Endpoint baru Anda yang tersedia untuk umum.</font></font></li>
</ul><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9. Pemeriksaan Kesehatan</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Permintaan standar</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sekarang Anda dapat mengikuti tautan ke formulir Anda, klik Tetapkan default dan Kirim. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan cara ini Anda akan membuat permintaan yang akan pergi melalui API Gateway ke AWS Lambda. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda mengkonfigurasi semuanya dengan benar setelah beberapa saat, Anda akan menerima pesan seperti:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Berhasil: Pesan 0102016f28b06243-ae897a1e-b805-406b-9987-019f21547682-000000 telah berhasil dikirim.</font></font><br>
</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini berarti bahwa pesan berhasil dikirim. Periksa kotak surat Anda yang Anda tentukan di templat SAM. Jika Anda belum mengubah templat, maka surat itu akan berada dalam format ini: </font></font><br>
<img src="https://habrastorage.org/webt/0z/wy/sv/0zwysv5ytv3uzn9fb9az7bsa6lg.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda juga dapat membuka DynamoDB dan memastikan bahwa entri baru telah muncul. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fitur awal yang dingin</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Saya pikir Anda memperhatikan bahwa pesan tentang pengiriman yang berhasil datang setelah waktu yang cukup lama. Hal ini disebabkan oleh fakta bahwa layanan AWS Lambda, setelah menerima permintaan untuk pemrosesan, mulai meningkatkan contoh aplikasi Java Anda, dan ini termasuk mengangkat wadah dengan sistem operasi dan JRE, memuat classpath, menginisialisasi semua variabel, dan hanya setelah itu adalah awal dari </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">handleRequest ( )</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ini disebut awal yang dingin.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Coba isi dan kirimkan formulir lagi. Kali ini jawabannya datang hampir secara instan, bukan? Jika lebih dari 20-30 menit telah berlalu antara permintaan pertama dan kedua, hasilnya dapat bervariasi. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apa alasannya? Dan dengan fakta bahwa AWS Lambda cache sudah menggunakan wadah dengan lambdas untuk digunakan kembali. Ini mengurangi waktu inisialisasi seluruh konteks untuk memulai metode. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak ada korelasi yang jelas untuk berapa lama lambda di-cache tergantung pada apa pun, tetapi beberapa orang secara eksperimental menemukan bahwa ini </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">secara langsung tergantung pada nilai RAM yang dipilih</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Artinya, lambda dengan memori 128MB akan tersedia lebih lama daripada dengan 3GB. Mungkin ada parameter lain, misalnya, beban rata-rata di wilayah di mana lambda Anda dieksekusi, tetapi ini tidak akurat. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena itu, coba sendiri dan rencanakan waktu caching jika Anda menggunakan permintaan sinkron. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pemanasan</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sebagai opsi tambahan, Anda dapat menggunakan pemanas lambda. Dalam kode, saya menambahkan cek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">header X-WAMP-UP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Jika ada, lambda hanya mengembalikan respons tanpa mengeksekusi logika bisnis, tetapi wadah akan siap untuk panggilan berikutnya. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat memanggil lambda Anda sendiri, misalnya, dengan timer mahkota, menggunakan CloudWatch. Ini akan membantu jika Anda tidak ingin pelanggan Anda bergabung dengan Cold Start.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam formulir HTML, Anda dapat menemukan tombol mode WarmUp, yang menambahkan header khusus ini ke permintaan. </font><font style="vertical-align: inherit;">Anda dapat memverifikasi bahwa pengiriman surat atau penulisan ke basis data tidak terjadi, tetapi respons dari lambda datang, dan panggilan selanjutnya untuk permintaan sebenarnya tidak akan memakan banyak waktu.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Meringkas</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selama artikel tersebut, kami melewati semua tahap utama dari desain aplikasi hingga rilis dalam </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apa yang disebut produksi</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya berharap bahwa orang-orang yang telah mendengar tentang Serverless dan AWS Lambda, tetapi yang tidak memiliki pengalaman praktis, akan dapat menggunakan panduan ini dan dapat merasakan bahwa ini memberikan keuntungan yang signifikan dalam kecepatan penyebaran beberapa solusi perangkat lunak dan bukan hanya itu. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manfaat</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Bagi saya sendiri, saya telah mengidentifikasi keuntungan yang paling berharga:</font></font><br>
<ul>
<li>     Free Tier      ,     ,       .</li>
<li>           1-2 .        /.</li>
<li>  ,          ,         .</li>
<li>  Serverless      .   ,  —  .   SAM          AWS. AWS    ,         ,   .</li>
<li>      Lambda ,     .</li>
<li>   Serverless    , , .          ELK/Promethes/Grafana      .</li>
<li>   ,             API.          API Key,   IAM ,                      .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yah, mungkin yang paling mendasar adalah Serverless. </font><font style="vertical-align: inherit;">Tidak perlu memikirkan instance EC2 mana yang harus Anda bayar, cara mengkonfigurasi akses ke sana, cara mengkonfigurasi peringatan jika terjadi crash aplikasi, mengkonfigurasi penskalaan otomatis, dll.</font></font></li>
</ul><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kekurangan</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sayangnya, ini tidak berarti bahwa sekarang Anda dapat mengambil solusi ini dan menggunakannya sebagai bagian dari sistem perusahaan alih-alih layanan microser favorit Anda di cuber. </font><font style="vertical-align: inherit;">Sangat sering, Anda perlu menggali lebih dalam untuk menentukan solusi yang lebih cocok dalam kasus tertentu. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan saya juga punya komentar yang harus Anda perhatikan ketika memilih Lambda:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mulai dingin. </font><font style="vertical-align: inherit;">Terutama signifikan saat menggunakan kueri sinkron, dan bahasa seperti Java atau C #. </font><font style="vertical-align: inherit;">Masalahnya cukup diselesaikan dengan pemanasan, tetapi lebih baik memikirkan solusi seperti itu di muka dan membandingkan biaya dan kemungkinan manfaatnya</font></font></li>
<li>    .       3GB  ,    2   ,    ,     - Fargate,       ,     .</li>
<li>          API,       ,           .</li>
<li>    /   1-2     Serverless,                .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika Anda sudah memiliki infrastruktur untuk mengembangkan layanan microser dan CI / CD di Coober, akan lagi menjadi masalah untuk berdebat (terutama untuk manajer) kebutuhan untuk mendukung proses CI / CD lainnya.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nah, di mana tanpa pengujian. </font><font style="vertical-align: inherit;">Dan untuk menguji lambda untuk throughput cukup sulit, karena masih berbeda dari pengujian kinerja biasa, dan ada banyak faktor yang perlu dipertimbangkan.</font></font></li>
</ul><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penggunaan</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Secara umum, penggunaan AWS Lambda dan layanan Serverless lainnya sangat cocok dengan prinsip-prinsip async dan pengembangan yang didorong oleh peristiwa. </font><font style="vertical-align: inherit;">Dan dengan menggunakan pemrosesan tidak sinkron, hasil optimal dapat dicapai baik dari segi kinerja maupun biaya. </font><font style="vertical-align: inherit;">Berikut adalah daftar solusi di mana solusi Serveress akan memainkan peran penting:</font></font><br>
<img src="https://habrastorage.org/webt/i6/ov/y6/i6ovy6ha2pszsiui5jvyewbf-dk.png"><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena artikelnya ternyata sangat luas, dan saya tidak ingin mengembang lebih jauh, saya kemungkinan besar akan menyiapkan kelanjutan di mana saya akan menunjukkan bagaimana melakukan pengembangan dengan lebih efisien menggunakan semua fitur dari konsol AWS, kerangka kerja SAM, dan bahkan IntelljIDEA. </font><font style="vertical-align: inherit;">Ya, karena saya menghilangkan bagian pengujian, saya akan mencoba menjelaskan aspek pengembangan ini secara lebih rinci. </font><font style="vertical-align: inherit;">Juga, jika Anda ingin menambahkan apa ke artikel berikutnya, atau pertanyaan, jangan ragu untuk menulis di komentar atau dalam pesan pribadi. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ditambahkan: </font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS Lambda dalam Aksi. </font><font style="vertical-align: inherit;">Bagian 2</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Beberapa tautan penting dan bermanfaat dari artikel:</font></font><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proyek GitHub</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unduh AWS-CLI</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unduh SAM-CLI</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurasi AWS-CLI</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Infrastruktur sebagai kode</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengalaman menggunakan Terraform</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deskripsi sumber daya SAM</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alias ​​Fungsi AWS Lambda</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penempatan lambda tingkat lanjut</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurasi Sumber Daya SAM Api</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">AWS IAM   </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">       SES</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> Read/Write capacity  DynamoDB </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SAM/CloudFormation  </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> Parameters   </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">  CloudFormation </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">      </a></li>
</ul></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id486634/index.html">Pembaruan MSVC Backend di Visual Studio 2019 versi 16.3 dan 16.4</a></li>
<li><a href="../id486638/index.html">Blazor WebAssembly 3.2.0 Preview 1 sekarang tersedia</a></li>
<li><a href="../id486640/index.html">Intisari materi menarik untuk pengembang seluler # 331 (27 Januari - 2 Februari)</a></li>
<li><a href="../id486644/index.html">Antena DIY dalam 5 menit</a></li>
<li><a href="../id486646/index.html">Pergi dari jQuery ke Svelte, tanpa rasa sakit</a></li>
<li><a href="../id486650/index.html">Memori dinamis dalam sistem waktu nyata yang sulit</a></li>
<li><a href="../id486652/index.html">"Kritik murni alasan" untuk programmer</a></li>
<li><a href="../id486654/index.html">Sensor gerak dan koneksi registrasi video dan alarm di Home Assistant on Raspberry pi</a></li>
<li><a href="../id486656/index.html">Bagaimana cara menambahkan karakter baru ke Unicode: pengalaman orang awam</a></li>
<li><a href="../id486658/index.html">Plugin Strategi Moksi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>