<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕠 👨🏽‍⚖️ 🤚🏼 Google Play Instant。生涯のリファクタリング 🛅 👨🏻‍🔬 🗼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="早期アクセスプログラムに参加すると、最終的に何が起こるかを事前に知ることはできません。もちろん、テクノロジーが成功し、アプリケーションが市場をリードし、Google I / OでPRの一部を受け取ることを望んでいます。また、これは、初期段階でドキュメントの代わりにソースコードを読むための良い動機です...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Google Play Instant。生涯のリファクタリング</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/462511/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">早期アクセスプログラムに参加すると、最終的に何が起こるかを事前に知ることはできません。もちろん、テクノロジーが成功し、アプリケーションが市場をリードし、Google I / OでPRの一部を受け取ることを望んでいます。また、これは、初期段階でドキュメントの代わりにソースコードを読むための良い動機です。これもシークレットアーカイブからダウンロードする必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
で</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AppsConf、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エフゲニーSaturovは、アーリーアクセスの参加は、インスタント打ち上げを使用してアプリケーションを開発し、すべての道に沿ってGoogle Playでのインスタントの特徴を説明する例として、につながる可能性があるものを示しました。彼のレポートを解読する際に、Android App Bundleがどこから来たのか、Dynamic Deliveryがそれと何をする必要があるのか​​を理解し、新しいGradleプラグインについて理解し、SDK開発者が用意してくれた驚きに対処する方法を学びます。</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/-KUj_Kp_Xcg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スピーカーについて：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エフゲニーサトゥロフ（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サトゥロフ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）カスタムのAndroidおよびiOS開発、さらに最近ではFlutterの開発に従事しているSurf社で働いています。</font><font style="vertical-align: inherit;">Eugene FlutterはFlutterDevPodcastの愛好者であり創設者です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">歴史への短い遠足</font></font></h2><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/lo/nw/zr/lonwzrpjzpi7m-nosk3wy3gndzw.png" width="300"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2年前、素晴らしい人がSurfにやって来て言った。</font><font style="vertical-align: inherit;">そして、顧客と興味深い事例があります。</font><font style="vertical-align: inherit;">さあ、私たちはあなたに私たちの技術を与え、あなたはそれをどこかに統合し、そしてあなたはクールな共生を得ます。</font><font style="vertical-align: inherit;">これをGoogle I / Oで宣伝し、誰もが元気になります。」</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アーリーアクセスプログラム</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">での</font><b><font style="vertical-align: inherit;">作業は、豚のようなもの</font></b><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">生のコードで作業する必要がありますが、もちろん、意図したとおりに機能しているとは限りません。</font><font style="vertical-align: inherit;">私たちの場合には：</font></font><br>
<br>
<ul>
<li>     ZIP-,                  .</li>
<li>    «».</li>
<li>  ,    Google Docs,      .</li>
<li>  , ,  —    ,      .       -.</li>
<li> ,    , ,  SDK       .       API —     .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、早期アクセスプログラムへの参加方法の概要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このすべてが可能になったのは、私たちの絶え間ないパートナーであるLabyrinthという会社です。これは、ロシアで最大の本と文房具のオンラインストアです。</font><font style="vertical-align: inherit;">彼らはプロジェクトに参加しましたが、結局は何の利益もあるかどうかさえもわかりませんでした。</font><font style="vertical-align: inherit;">そして、2017年にスタジオとしてサーフがGoogle認定代理店プログラムの一部であったという事実。</font><font style="vertical-align: inherit;">残念ながら、プログラムは今年終了しました。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Android Instant Apps&nbsp;</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2017年、アプリケーションをインストールせずに実行するには、アプリケーションをモジュールに正しく切断する必要がありました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fq/qz/d7/fqqzd7dexvnj3d6ojcpi7nunhrw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
対応するアーティファクトを生成する新しいGradleプラグインがあります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インスタントアプリモジュール-APKを使用してZIPアーカイブを生成したアプリケーションプラグイン。アプリケーションの各機能モジュールに1つ。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インストール可能なアプリモジュール-生成されたAPK。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
機能モジュールからの2レベルの階層が表示されました。</font><font style="vertical-align: inherit;">基本機能モジュールは常に1つだけであり、すべての機能、リソース、依存関係などで使用可能なすべての基本コードを含むことができます。</font><font style="vertical-align: inherit;">最上位の機能モジュールには、特定の画面の実装が含まれていました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それは</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多くの理由で</font><strong><font style="vertical-align: inherit;">長くて高価</font></strong><font style="vertical-align: inherit;">でした：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">剛直なモジュール構造自体は大きな制限です。</font><font style="vertical-align: inherit;">一部の大企業が、発展するかどうか不明な新技術をサポートするためだけに、開発中の完全に機能するアプリケーションを長年にわたって山積みの喫煙モジュールに変えるとは想像しがたいです。&nbsp;</font></font></li>
<li>    ,         4 .   ,      , , -    - .&nbsp;</li>
<li>  AppLinks,        Instant App.      , ,          .</li>
<li>,    .      NDK.   push-,  sensitive data,       . Services, Broadcast Receivers  Content Providers   .  Activity.&nbsp;</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instant Appの主な使命は、UIのデモンストレーションにすぎません。</font><font style="vertical-align: inherit;">リファクタリングは非常に骨の折れる作業でした。そのため、このストーリーはまだ本番環境ではほとんどありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、公平に言えば、迷宮にInstant Appを実装したことで、モバイルクライアントからの購入が5％増加しました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2019. Google Play Instant</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2019年の庭で2年が経過しました-Instant Appsはまだ存在していますが、独立したテクノロジーとして存在していません。それはまだプロダクションで非常にまれです、私はそれをわざと探していませんが、私はいくつかの例しか知りません：Sports.ru、Vimeo。グーグルがこのテクノロジーを発表したとき、グーグルがそのような結果に期待していたことはありそうにない。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、Instant Appの呼び方が変わりました-Google Play Instant。名前の変更は、無関係なドキュメントを取り除くのに役立ちました。 Android Instant Appが表示されれば、これが関係なくなったことはすぐにわかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
名前に加えて、モジュール構造を含む他のすべてが変更されました。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要求はより忠実になりました</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。このテクノロジーは完全に異なる方法でプロジェクトに統合され、そのような苦痛なリファクタリングを必要としないので、確かに優れています。</font></font><blockquote>           —  ,       ,     ,     .</blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当初、GoogleはInstant Appを、アプリケーションではなくビジネスを引き付けるテクノロジーとして位置づけていました。</font><font style="vertical-align: inherit;">ランディングアプリケーションを1つのボタン[アプリケーション全体をダウンロード]で禁止する設計ガイドラインがありました。</font><font style="vertical-align: inherit;">しかし、もう1つの根本的な問題は副次的に解決され、私はこれが偶然に起こったのではないかと考えています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今年の2月に、1 TBのメモリを搭載した注目に値するデバイスSamsung Galaxy S10 +がライトを目にしました。</font><font style="vertical-align: inherit;">考えてみてください-1テラバイト！</font><font style="vertical-align: inherit;">なぜそんなに必要なのですか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Googleの公式統計によると、過去7年間でAPKの平均サイズは5.5倍に増加しています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/n1/fj/gi/n1fjgis20pkxen7kpz7h1mqavte.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ビルドサイズは本当に重要です、</font><font style="vertical-align: inherit;">これらの統計</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に関する調査</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は示しています：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6 Mbのアセンブリを追加するたびに、インストールでの変換が1％減少します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーの70％がダウンロード前にアプリケーションのサイズを確認しています。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーの50％が、インストール後にデバイス上でアプリケーションが占めるスペースに関心があります。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、ターゲットオーディエンスが高齢者であるか、収入がそれほど多くない場合、またはこれらが新興市場である場合、さらに重要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
後者は無視することがますます難しくなっています。なぜなら、2018年にインドで設備が驚くほど増加したためです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/w8/l5/sc/w8l5sclkeutjcit1oweqt3t4n1q.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
iOSはごくわずかであり、Androidアプリケーションの合計インストール数は、米国、ブラジル、インドネシアを合わせた数を超えています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、Google Play Instantで解決できる問題が明らかになりました。</font><font style="vertical-align: inherit;">あなたは理解できない用語に行くことができます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Android App Bundle</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Android App Bundle-Google Playでアプリケーションを公開するための新しい形式。</font><font style="vertical-align: inherit;">内部では、すべてがAPKと大差ありません。すべて同じdexファイル、マニフェスト、リソース、アセットなどです。</font><font style="vertical-align: inherit;">等 </font><font style="vertical-align: inherit;">しかし、ユーザーのデバイスに到達しないメタデータもあります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bb/ut/jt/bbutjtxukmhiiflwbngb_ivjae0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メタデータは、resources.pb、assets.pb、native.pbの3つのファイルで表されます。</font><font style="vertical-align: inherit;">実際、これらはデバイスのアセンブリおよび構成設定にあるリソースの対応表です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Android Dynamic Delivery</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
誰もがGoogle Playによるアプリ署名の存在を知っています。ただし、アプリケーションのリリースキーをGoogle Playに保存する準備が整っているとは限りません。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Playによるアプリ署名の取得は不可能です。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Google Playにリリースキーを渡した後は、これまでどおりアプリケーションに署名することはできません。ただし、これと引き換えに、Android App Bundleをフォーマットとして最大限に活用できます。そして、アセンブリ署名プロセスは少し異なります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bc/lx/mw/bclxmwzyamlhlisvggnyrori7gk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Google Playでのリリース前に引き続きアセンブリに署名しますが、一意ではないアップロードキーを使用してアセンブリに署名します。これはコンソールから呼び出すことができ、侵害されたり失われたりした場合は再リリースできます。コンソールにリリースキーを渡し、それに対して別れを告げます。Googleがアセンブリに署名し、キーが安全に保たれることを誓います。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、リリースキーをGoogle Playに提供しないと、プロジェクトでさらに説明することはできなくなります。 Googleはねじを締め、Instant Appでさえキーを提供しなくても展開に失敗します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、Instant Appプロモーションを購入してストーリー全体に参加したユーザーはアプリケーションをリファクタリングしたため、これはまったくおかしくありませんが、何らかの理由でGoogle Playにキーを提供できません（またはセキュリティ部門は断固として反対します）または他の客観的な理由で）この決定をもはやサポートできない状況に陥った。</font><font style="vertical-align: inherit;">何百時間もの作業が実際にゴミ箱に捨てられました。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2014.分割APKサポートがAndroid Lollipopに表示される</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今日は懐かしいので、2014年にはもっと早く過去に戻ります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
世界最高の携帯電話であるNEXUS 5で、Android Lollipopアセンブリが爆撃されただけの信じられないほどのマテリアルデザインで飛んだのを今でも覚えています。しかし、多くの人が気付かなかった変更がありました-これは分割APKのサポートです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
APKの分割-アプリケーションを小さなAPKに分割し、1つのデバイスにインストールすると、それらを単一のアプリケーションとして動作させるメカニズム。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを覚えて、次に進んでください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Android Dynamic Deliveryは、Google Playの新しいアプリ配布形式です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pg/yk/85/pgyk85hx5b1ymk2ryhbek8ssmhi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前はAPKがありましたが、現在のところ、代替としてAndroid App Bundleが表示されています。</font><font style="vertical-align: inherit;">AABは、これらの非常に分割されたAPKのインキュベータージェネレーターとして機能します。</font><font style="vertical-align: inherit;">AABはAPKのbunを展開します。これは、並行してインストールすることにより、通常のアプリケーションとして使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それがどのようなAPKであるか見てみましょう。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ku/7k/e5/ku7ke5ykakq3mewuawg5jrcnf-k.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
少なくとも、これはInstant Appと同じ役割を果たす基本的なAPKです。これは、すべての機能の間にある基本的なコード、基本的なリソース、およびビジネスロジックです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また表示されます：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">APKの名前には、グラフィックリソース修飾子のプレフィックス（図の一番上の行）と疑わしいものがあります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">APKの別のファミリは、プロセッサアーキテクチャを思い出させます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ローカリゼーションAPK。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
約2年前、ベクターグラフィックスがそれほど普及していなかったとき、多くのアプリケーションには主にラスターリソースが含まれており、画面上のさまざまなピクセル密度にカットされました。</font><font style="vertical-align: inherit;">アセンブリはかなり重くなる可能性があります。</font><font style="vertical-align: inherit;">ユーザーはこれらのリソースをすべてダウンロードし、それらのほとんどは自重でデバイスに保存されていました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようなメカニズムにより、ユーザーは自分のデバイスに特に必要なリソースのセットのみを受け取ることができます。</font><font style="vertical-align: inherit;">人がGoogle Playにアクセスし、アプリケーションを選択すると、Google Playはユーザーのデバイスの特性を理解し、必要なスプリットAPKのセットを提供します-各カテゴリから1つのAPK。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
動的配信APKのタイプ：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1つだけの基本APK。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">構成APKは最大3つのタイプです：</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">res * x、assets * y、lib * z。</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここで、xは使用されるリソース修飾子の数です。</font><font style="vertical-align: inherit;">yは、使用されるアーキテクチャーのタイプの数です。</font><font style="vertical-align: inherit;">zは言語ローカリゼーションの数です。</font><font style="vertical-align: inherit;">たとえば、プロジェクトがネイティブコードとネイティブライブラリを使用しない場合、ネイティブコードに関連付けられたカテゴリはなく、2つのAPKが残ります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">無制限の動的機能APK。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dynamic Feature APKについては、以下で詳しく説明します。</font><font style="vertical-align: inherit;">しかし、最初に、Splitブロックに別れを告げます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さようならスプリット</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前に同様のことを行うことができ、適切なリソースのセットのみを使用してAPKの束を手動で生成し、それをすべて手動でGoogle Playにデプロイすると主張できます。</font></font><br>
<br>
<pre><code class="java hljs">android {<font></font>
    splits {<font></font>
        density {<font></font>
            enable <span class="hljs-keyword">true</span>
            exclude <span class="hljs-string">"ldpi"</span>, <span class="hljs-string">"xxhdpi"</span>, <span class="hljs-string">"xxxhdpi"</span>
            compatibleScreens <span class="hljs-string">'small'</span>, <span class="hljs-string">'normal'</span>, <span class="hljs-string">'large'</span>, <span class="hljs-string">'xlarge'</span><font></font>
        }<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この事業自体はかなり疑わしいものであり、今ではこれらすべてが単に無視されています。 Android App Bundleをビルドすると、プロジェクトを手動でカテゴリの1つに分割することを無効にできるBundleブロックが表示されます。</font></font><br>
<br>
<pre><code class="java hljs">android {<font></font>
    bundle {<font></font>
        language {<font></font>
            enableSplit = <span class="hljs-keyword">false</span><font></font>
        }<font></font>
        density {<font></font>
            enableSplit = <span class="hljs-keyword">true</span><font></font>
        }<font></font>
        abi {<font></font>
            enableSplit = <span class="hljs-keyword">true</span><font></font>
        }<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、ロシア語のみまたは英語のみをアプリケーションがサポートするように指定し、アセンブリ中にこの手順をスキップできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
おそらく最も注意深いのは、おそらくpreLollipopをどうするかを考えていることでしょう。</font><font style="vertical-align: inherit;">Android 5でのみ、Split APKのサポートが表示されました。</font><font style="vertical-align: inherit;">Min SDKは決して21日というわけではないため、この状況をどうにかして回避する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
preLollipopの場合、状況はかなり不器用ですが、可能性があります。</font><font style="vertical-align: inherit;">Google PlayはpreLollipopのマルチAPKを収集します。これには、構成APKのあらゆる種類の組み合わせが含まれます。</font><font style="vertical-align: inherit;">APKは1つしかありませんが、オプションはたくさんあります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Android App Bundleが私たちの生活を変える</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして非常に重要です。</font><font style="vertical-align: inherit;">まず、特に手動でSplit APKをビルドしていた場合は、プロジェクトをビルドする方がはるかに簡単です。</font><font style="vertical-align: inherit;">しかし、私の観察によれば、そのような人々はそれほど多くはありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、リリースキーを紛失したり、危険にさらしたりするリスクがなくなります。</font><font style="vertical-align: inherit;">大きな悲劇はありません。アップロードキーを紛失した場合は、リコールして再発行できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは指を指すことはしません-ロシアのGoogle Playの最上部には、w3bsit3-dns.comにリリースキーが長期間あるアプリケーションがあり、すべてのカスタムアセンブリはリリースキーで署名されており、今後5年間でこれを行う必要はありません。</font><font style="vertical-align: inherit;">APIが28個しかなかったSigning V3への移行を待つ必要があります。</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Android App Bundleの確かな利点：ユーザーは、不要なリソースへのトラフィックとディスク容量の消費を停止します。</font><font style="vertical-align: inherit;">これにより、アプリケーションの保持が大幅に向上します。</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しかし、ベクター内にすべてのグラフィック、2つのローカリゼーションがあり、ネイティブライブラリがない場合、利点は微視的です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">動的機能モジュール</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
動的機能モジュールは、アプリケーションのインストール時に提供されない機能モジュールですが、Google Playからダウンロードされ、オンデマンドでのみインストールされます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようなモジュールは、基本的なAPKと同等です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hp/ho/2v/hpho2vlpy2bawtztyql8r58aruu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの各機能モジュール自体にも、一連の構成分割APKが含まれていることが重要です。</font><font style="vertical-align: inherit;">したがって、APKの総数は測定値を超えて増加する可能性があります。</font><font style="vertical-align: inherit;">しかし、これはあなたの心配事ではありません。GooglePlayがこれを行っています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">動的機能モジュールのアプリケーション：</font></font></h3><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">視聴者のごく一部が使用する機能です</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が、それでもあなたの製品にとって重要です。たとえば、これはコンテンツエンターテイメントアプリケーションであり、ユーザーの95％がコンテンツを消費しています。しかし、コンテンツを生成するエディターの割合は非常にわずかです。彼らにとっては、本当に重くて信じられないほどクールに動作するクールなビデオエディタがあります。次に、すべての人とすべての人のアセンブリに重みを付けるのは意味がありません。この機能を動的機能モジュールに配置し、必要な人にのみ提供して、後でダウンロードすることができます。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主なアプリケーションの使用シナリオに関連しない重い機能。</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たとえば、マップサービスのARナビゲーション。すべてのAR機能は、動的機能モジュールに配置するのに最も適しています。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーション自体をインストールしなくてもユーザーが利用できる機能</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（カタログで製品を選択して注文するなど）。</font><font style="vertical-align: inherit;">確かに、これはすべてのことを非常に疑わしく思い起こさせるものです。</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Android Instant AppsがInstant対応の動的機能モジュールになりました。</font></font><br>
</blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">したがって、動的機能モジュールには2つのタイプがあることがわかります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">共通動的機能モジュールは、メインアプリケーションとは別にデバイスにダウンロードおよびインストールされる機能モジュールです。</font><font style="vertical-align: inherit;">アプリケーション自体が存続している限り、そこに存在します。</font><font style="vertical-align: inherit;">削除するまで、動的機能モジュールは削除されます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インスタント対応動的機能モジュール-デバイスにインストールしなくても実行できる機能モジュール。</font><font style="vertical-align: inherit;">このモジュールは限られた時間だけ有効です。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Google Playの2番目のタイプのアプリケーションは、[試行]ボタンの存在によって区別できます。</font><font style="vertical-align: inherit;">これをクリックすると、デフォルトのURLが置き換えられ、アプリケーションが少なくとも1つの主な機能の例としてどのように見えるかを確認できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは多くの場合、ゲームセクションにあります。</font><font style="vertical-align: inherit;">これは便利であり、アプリケーションよりもさらに適用可能です。なぜなら、ゲームの小さな部分をデモとしてダウンロードして、トラフィックと時間を費やす価値があるかどうか、実際にそれが何であるかを確認できるからです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モジュラー構造</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モジュール構造が簡素化されたとすでに述べました。方法を見てみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当初、私たちはかなり巨大な構造を持っていました。特に、Instant App Moduleは常に空であり、コードもリソースもなく、build.gradleファイルだけがありました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開発者は、特定のタイプのアーティファクトを収集するためだけに追加のモジュールを作成する理由を考えました。そして、彼らはそれを見て、機能性はApp Moduleに移されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、彼らはさらに進んで考えました-なぜベース機能モジュールが必要なのですか？私たちはそこですべてを初期化し、彼のアプリケーションIDが異なるため、彼にはいくつかの問題があります。松葉杖はここから来ます。たとえば、アプリケーションIDをアプリケーションモジュールから基本機能モジュールに転送し、それをアプリケーションの実際のアプリケーションIDに置き換えて、すべてがCrashlyticsで追跡されるようにします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、こんな感じでした。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/s5/ld/ys/s5ldysjxqmlmuqm8axqd70lxyq0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
彼らはアプリモジュールを残し、その上に機能モジュールを取り付けました-それで終わりです！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このことを知ったときは、自分の感情を伝えないでください。ビッグステージの人たちは、「この構造へのアプリケーションをすべてカットしましょう！」しかし、これは5分間では機能しませんが、大きな結果をもたらします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2017年、モノリシックアプリケーションを使用することはまだ残念ではありませんでした。</font><font style="vertical-align: inherit;">迷路はまさにそのようなものでした、そしてそれはそれは一般公開にさえ達していませんでしたが、ベータ版でした。</font><font style="vertical-align: inherit;">早期アクセスプログラムに参加した時点では、すでに約90の画面がありました。</font><font style="vertical-align: inherit;">さらに2か月をかけて、すべてが実際に機能することをリファクタリング、テスト、および検証しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そしてその後、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「私たちは賢すぎるので、実行するのがはるかに簡単になる可能性があります</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><strong><font style="vertical-align: inherit;">」</font></strong></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、散文に戻ります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gradle構成</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しい構成をサポートするには、最初にすべての動的機能モジュールをAndroidブロックのアプリモジュールのbuild.gradleファイルにリストする必要があります。</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-comment">//  build.gradle app- </span><font></font>
android {<font></font>
    dynamicFeatures = [<span class="hljs-string">":dynamic_feature"</span>, M:dynamic_feature2M]<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、各動的機能モジュールのbuild.gradleファイルに、アプリモジュールへの依存関係を記述します。</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-comment">//  build.gradle  dynamic feature- </span><font></font>
dependencies {<font></font>
    <span class="hljs-function">implementation <span class="hljs-title">project</span><span class="hljs-params">(<span class="hljs-string">':app'</span>)</span>
}</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
原則として、複雑なことは何もありません。</font><font style="vertical-align: inherit;">しかし、マニフェストの構成もあります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マニフェスト構成</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリモジュールマニフェストで、trueフラグを設定して、このアプリケーションに少なくとも1つのInstant-Enabled機能があることを示すことができます。</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-comment">//   app- </span>
&lt;dist:<span class="hljs-keyword">module</span> dist:instant=<span class="hljs-string">"true|false"</span> /&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このフラグが存在しない場合、Google Playの対応するトラックに自分自身を埋め込むことはできません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、動的機能モジュールごとに個別のマニフェスト構成もあり、さらに多くの設定があります。</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-comment">//    dynamic feature- </span>
&lt;dist:<span class="hljs-keyword">module</span>
    dist:instant=<span class="hljs-string">"true|false"</span> <span class="hljs-comment">// Instant-Enabled </span>
    dist:onDemand=<span class="hljs-string">"false|true"</span> <span class="hljs-comment">// ,        </span>
    dist:title=<span class="hljs-string">"@string/feature_modulejnstall_name"</span>&gt; <span class="hljs-comment">//   </span>
    &lt;dist:fusing dist:include=<span class="hljs-string">"true |false"</span> /&gt; <span class="hljs-comment">//,      APK  preLollipop</span>
&lt;/dist:<span class="hljs-keyword">module</span>&gt;</code></pre><br><font style="vertical-align: inherit;"></font><code>onDemand</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-これは通常の基本機能であり、</font></font><code>instant</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-これは同じインストール可能機能</font><font style="vertical-align: inherit;">
であるため、最初の2つのフラグはわずかに相互に排他的</font><font style="vertical-align: inherit;">です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タイトル-モジュールの技術名。これは、後でアプリケーションにハードコード化したため、Google Playからこのモジュールをポンプします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パラメータ</font></font><code>include</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-preLollipopsのパラメータ。</font><font style="vertical-align: inherit;">falseに設定すると、preLollipopsユーザーにはこの機能が表示されず、使用できなくなります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gradleプロジェクトの構成</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
instantappプラグインと機能プラグインの寿命は非常に短かったですが、活気に満ちていました。</font><font style="vertical-align: inherit;">彼らは2年未満続きました。</font><font style="vertical-align: inherit;">今年の3月以降、これらはサポートされなくなりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、使用する動的機能モジュールは1つだけになりました。</font></font><br>
<pre><code class="java hljs">apply plugin: <span class="hljs-string">'com.android.dynamic-feature'</span></code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリモジュールのみのプロジェクト構成</font></font></h3><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要なポイント：署名（signing-configuration）、アセンブリ（ProGuard-configuration）、versionCode、およびversionNameに関するすべての設定は、build.gradleアプリモジュールでのみ行う必要があります。</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それ以外の場合は無視されます。</font><font style="vertical-align: inherit;">動的機能モジュールのbuild.gradleファイルでこれらの構成ブロックを指定しないでください。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グーグルプレイインスタント</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで次のようになります。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モジュール構造の要件が最大限に簡素化されました。</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これはまだ参加していない人にとって本当に良いニュースです。</font><font style="vertical-align: inherit;">これで、独自の構造を持つアプリケーションがある場合でも、試すことができます。</font><font style="vertical-align: inherit;">これはまったく影響しません。モジュールを上に取り付けるだけで、すべてが正常に動作します。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アセンブリのサイズの制限がより忠実になりました。</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以前は4 MBだった場合、今：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">動的機能モジュールは通常、サイズに制限はありません。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instant対応の動的機能モジュールは、最大10 MBを使用できます。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、今は段階的な規模になっています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hn/xq/rg/hnxqrghmprre_roahys7gkwquhu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あなたの機能の場合：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10 MB以上の場合、ごめんなさい。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4〜10 Mb-Google Playの[お試し]ボタンからアクセスできます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4 MB未満-ユーザーをInstant-Enabledモジュールに引き付ける手段はすべて利用可能です（広告、リンク、メッセージなどから起動）。</font></font></li>
</ul><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モジュールをロードするためのメカニズムが登場-Play Core API。</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instant AppがChrome経由でインストールされていたことを知っている人はほとんどいません。</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">maybeLaunchInstantApp</span><span class="hljs-params">(Tab tab, String url, String referrerUrl, 
                 <span class="hljs-keyword">boolean</span> isIncomingRedirect)</span> </span>{
    <span class="hljs-keyword">if</span> (tab == <span class="hljs-keyword">null</span> || tab.getWebContents() == <span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<font></font>
    InstantAppsHandler handler = InstantAppsHandler.getInstance();<font></font>
    Intent intent = tab.getTabRedirectHandler() != <span class="hljs-keyword">null</span>
        ? tab.getTabRedirectHandler().getInitialIntent() : <span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">if</span> (isIncomingRedirect &amp;&amp; intent != <span class="hljs-keyword">null</span> &amp;&amp; <font></font>
                 intent.getAction() == Intent.ACTION_VIEW) {<font></font>
        Intent resolvedIntent = <span class="hljs-keyword">new</span> Intent(intent);<font></font>
        resolvedIntent.setData(Uri.parse(url));<font></font>
        <span class="hljs-keyword">return</span> handler.handleIncomingIntent(getAvailableContext(), resolvedIntent,<font></font>
            ChromeLauncherActivity.isCustomTabIntent(resolvedIntent));<font></font>
    } <span class="hljs-keyword">else</span> {<font></font>
        ...<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、Android for Chromeの実際のコードであり、Instant Appへのリンクをインターセプトし、Google Playに移動して、そこからInstant Appsを置き換えました。</font><font style="vertical-align: inherit;">インスタントアプリが検出された場合、なんらかの理由でアクティビティが開かれ、そこからインスタントアプリが起動されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、この機能のローリングには大きな問題がありました。</font><font style="vertical-align: inherit;">Samsungの場合、これはまったく別の話ですが、組み込みのブラウザーにはChromeよりもわずかに多くの特権があると思います。</font><font style="vertical-align: inherit;">プレビューアプリは最後まで機能しませんでした。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Play Core Libraryを</font></font></strong></a><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用すると、配信の問題を忘れることができます。</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パッケージとしてプラグインするだけです：</font></font><br>
<br>
<pre><code class="java hljs">implementation <span class="hljs-string">'com.google.android.play:core:1.4.0'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、必要な機能モジュールをGoogle Playからダウンロードします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ライブラリには、モジュールを一度に1つずつダウンロードできるかなり機能的な構文があります。</font></font><br>
<br>
<pre><code class="java hljs">val splitInstallManager = SplitInstallManagerFactory.create(context)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
またはすぐにいくつかのパック：</font></font><br>
<br>
<pre><code class="java hljs">val request =<font></font>
    SplitInstallRequest<font></font>
        .newBuilder()<font></font>
        .addModule(<span class="hljs-string">"feature1"</span>)<font></font>
        .addModule(<span class="hljs-string">"feature2"</span>)<font></font>
        .build()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
受話器を置く：</font></font><br>
<br>
<pre><code class="java hljs">splitInstallManager<font></font>
    .startInstall(request)<font></font>
    .addOnSuccessListener { sessionId -&gt; ... }<font></font>
    .addOnFailureListener { exception -&gt;  ... }</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これをUIに表示し、モジュールがインストールされているという事実に反応します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Play Core Libraryは良いスタートです：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最後に、おそらくGoogle Chromeに直面することを期待するのをやめることができます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIでのモジュールのロードを希望どおりにデモンストレーションできます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機能モジュールをバッチでロードすることが可能です。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機能モジュールをダウンロードしてインストールするときに発生するエラーを柔軟に処理する方法があります。&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機能がインストールされた後、アプリケーションを再起動する必要はありません。アプリケーションを再起動する必要があり</font></font><code>SplitCompat.install()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。これを呼び出すと、新しくインストールされた機能から即座にクラスにすぐにアクセスできます。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、Playコアライブラリがあなたを苦しめることにはならないと私が言ったら、私はあなたをだますでしょう：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードは難読化されており、ドキュメント化されていません。&nbsp;</font></font></li>
<li>  <code>SplitInstallStateUpdatedListener</code>        —   .    - ID ,         .</li>
<li>,  -   : 9  , 10  .       - ,       int.&nbsp;</li>
<li>           —   .&nbsp;</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
唯一の選択肢は、Google Playビルドを内部テストチャネルに埋め込み、何が起こったかを試すことです。何らかのバグを見つけた場合は、プロセス全体を最初からやり直し、アップデートを展開してさらに試してください。ビルドなしでどのように機能するかを確認したい場合は、「-2」のエラーが発生し、それが何を意味するかを推測することしかできません。これは、Google Dynamic Featuresの公式サンプルを含むリポジトリで最も一般的な問題です。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機能モジュール間を移動するための良い習慣はありません。</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機能モジュール間の相互作用がどのように発生するかを示す公式の例では、状況を非常に簡単に解決することが推奨されています。あるモジュールから別のモジュールへの依存関係をオンにします。各方向には独自の依存関係があります。なぜ戻ってくるのですか？</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yr/xh/vx/yrxhvxc_6mdbpre9ppka5-telrq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、モジュールに分割することのすべての利点は失われます。このような問題を解決する必要が生じるずっと前に、モジュールに切り替えました。また、経験の浅い開発者がbase-activityでsigning-activityを使用できるコードベースでの作業を簡略化し、コードレビューのためにそれを探すため、彼らはそれを部分的に行いました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
依存関係のあるすべてのモジュールを上下に接続すると、Googleだけがこれからうまくいきます。ナビゲーションについて何も考える必要はありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは長い間これをどうするかを考えていましたが、結局私はまだ私を震えさせる解決策に落ち着きました。これは</font></font><code>Class.forName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、クラス全体をインスタンス化する、</font><font style="vertical-align: inherit;">と呼ばれ</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">これは</font></font><code>ClassPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、パスからパッケージのクラスの名前を変更するなどして破壊されます。</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ActivityCrossFeatureRoute</span> </span>{<font></font>
<font></font>
   <span class="hljs-function">override fun <span class="hljs-title">prepareIntent</span><span class="hljs-params">(context: Context)</span>: Intent? </span>{
       <span class="hljs-keyword">try</span> {
           <span class="hljs-keyword">return</span> Intent(context, Class.forName(targetClassPath()))<font></font>
       } <span class="hljs-keyword">catch</span> (e: ClassNotFoundException) {<font></font>
           Logger.e(<span class="hljs-string">"Activity with the following classpath was not found in the current "</span> +
                   <span class="hljs-string">"application: ${targetClassPath()}. If this activity is the part of Dynamic Feature, "</span> +
                   <span class="hljs-string">"please check if this Dynamic Feature is downloaded and installed on the device"</span> +
                   <span class="hljs-string">"successfully."</span>)<font></font>
       }<font></font>
       <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span><font></font>
   }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plaid</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
アプリケーションレポジトリに</font><font style="vertical-align: inherit;">移動して、ナビゲーションの問題が同じ方法で解決され、スタックオーバーフローで実行するように全員にアドバイス</font><font style="vertical-align: inherit;">するまで、私はこれについて誰かに話すのを恥ずかしく思って</font><font style="vertical-align: inherit;">いました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plaidは最もクールなショーケースの1つであり、Googleはすべての最新のトレンド、クールなアニメーション、デザイントリック、最新のUIコンポーネント、特にモジュール性を試します。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たくさんの、本当にたくさんのバグ、アンダーエンジニアリング、荒さ。</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特に長い間、バグを検索する必要はありません。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリモジュールからのリソースへのアクセスは、フルパスでのみ可能です。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを書くのではなく、</font></font><code>R.string.primaryColor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">毎回次のようなコードを書く必要があります</font></font><code>ru.appname.package.R.string.primaryColor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ビルドは別の方法でアセンブルされることはありません</font><font style="vertical-align: inherit;">。公式の課題追跡への</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンク</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を次に示します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O +デバイスでJobSchedulerを実行する際の問題。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">公式の回避策</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は手動での起動</font></font><code>TestJobSchedulerService</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font></li>
</ul><br>
<pre><code class="java hljs"><span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) {<font></font>
  Intent serviceIntent = <span class="hljs-keyword">new</span> Intent(<span class="hljs-keyword">this</span>, TestJobSchedulerService.class);<font></font>
  startService(serviceIntent);<font></font>
}</code></pre><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firebase、Fabric、AndroidXパッケージなどのサードパーティライブラリを接続すると、マニフェストがフリーズします。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それらはすべて、マニフェストでプレースホルダーアプリケーションIDを使用します。</font><font style="vertical-align: inherit;">アプリケーションIDが正しく挿入されていないため、マニフェストがフリーズせず、Android Studioはデフォルトのアクティビティを見つけることができず、公式の課題追跡で</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アドバイス</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が見つかるまで長い間問題を検索します</font><font style="vertical-align: inherit;">-すべてのプロバイダーを再定義し、そこでアプリケーションIDを指定します。</font></font><br>
<br>
<pre><code class="java hljs">&lt;provider<font></font>
   android:name=<span class="hljs-string">"com.crashlytics.android.CrashlyticsInitProvider"</span>
   android:authorities=<span class="hljs-string">"ru.app.name.crashlyticsinitprovider"</span>
   tools:replace=<span class="hljs-string">"android:authorities"</span> /&gt;<font></font>
<font></font>
&lt;provider<font></font>
   android:name=<span class="hljs-string">"com.google.firebase.provider.FirebaseInitProvider"</span>
   android:authorities=<span class="hljs-string">"ru.app.name.firebaseinitprovider"</span>
   tools:replace=<span class="hljs-string">"android:authorities"</span> /&gt;<font></font>
<font></font>
&lt;provider<font></font>
   android:name=<span class="hljs-string">"androidx.core.content.FileProvider"</span>
   android:authorities=<span class="hljs-string">"ru.app.name.fileprovide"</span>
   tools:replace=<span class="hljs-string">"android:authorities"</span> /&gt;</code></pre><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サードパーティパッケージへの複数の依存関係の不可能性は、私のお気に入りのポイントの1つです。</font></font></li>
</ul> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2つの機能モジュールが1つのサードパーティライブラリに依存しているとします。</font><font style="vertical-align: inherit;">ただし、次のような関係になるため、直接的な関係を確立することはできません</font></font><code>org.gradle.api.GradleException: [:feature1, :feature2] all package the same library [com.lib.Name:VeryGoodLib]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">公式回答</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：これらのモジュールに異なるバージョンのライブラリが示されている場合はどうなりますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開発者は、サードパーティのライブラリへの依存関係のみが存在する機能モジュールを階層に追加し、2つのソース機能モジュールに依存させるようにアドバイスします。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">attachBaseContext（）のInstantApps.isInstantApp（コンテキスト）の呼び出しキャッシュ。</font></font></li>
</ul> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Android開発者向けのドキュメント</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">のコード例</font></a><font style="vertical-align: inherit;">は、それらがを</font></font><code>attachBaseContext()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介してコンテキスト</font><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">アクセスする</font><font style="vertical-align: inherit;">ことを提案しているためにクラッシュし</font><font style="vertical-align: inherit;">ます。</font></font><code>this</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">もしそうであれば</font></font><code>context==null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、InstantAppsが現在実行されているかどうかさえ確認できません。</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function">override fun <span class="hljs-title">attachBaseContext</span><span class="hljs-params">(base: Context)</span> </span>{
   <span class="hljs-keyword">super</span>.attachBaseContext(base)
   <span class="hljs-keyword">if</span> (!InstantApps.isInstantApp(<span class="hljs-keyword">this</span>)) {<font></font>
       SplitCompat.install(<span class="hljs-keyword">this</span>)<font></font>
   }<font></font>
}</code></pre><br>
<ul>
<li>  <code>ConstraintLayout</code>   <code>Groups</code>  <code>Barriers</code>. </li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あなたがすべてを経験したと想像してください：アセンブリを組み立て、それをGoogle Playのテストチャネルに埋め込む必要があると推測しましたが、Google Playは赤いダイアログを表示しませんでした。震えている手で、このアセンブリをデバイスにインストールし、機能をインストールし、画面に移動します。レイアウト全体が左上隅のヒープに集まっていることがわかります。これ</font><font style="vertical-align: inherit;">は、</font></font><code>Groups</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font><font style="vertical-align: inherit;">を使用する</font><font style="vertical-align: inherit;">と</font></font><code>Barriers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>getPackageName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">何らかの理由で誤って来る</font><font style="vertical-align: inherit;">素晴らしいメソッド</font><font style="vertical-align: inherit;">があるためです。その結果、すべてのビューが配置されません。すべての制約が外れ、すべてが画面上に無計画に置かれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に、これを克服すると、</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">動的機能がまだベータ版</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">であることがわかり</font><strong><font style="vertical-align: inherit;">ます。</font></strong><font style="vertical-align: inherit;">本番環境で立ち往生することはできません。これまでずっとGoogleの無料のテスターでした。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ry/ct/i6/rycti6op3z_5tkbmn0b5dv77psk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、Googleによるとそうではありません。</font><font style="vertical-align: inherit;">1つになりたい場合は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インタレストフォームに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記入することができ</font><font style="vertical-align: inherit;">ます。運が良ければ、本番環境にロックされるアクセス権が与えられるでしょう。</font></font><br>
<blockquote><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instant Appsがこの戦いに負けた</font><em><font style="vertical-align: inherit;">と考えられ</font></em><font style="vertical-align: inherit;">ています。</font><font style="vertical-align: inherit;">これが今後数年のうちに発表される可能性は低いですが、AMPを中心とした情報活動の増加により、こっそり確認されます。</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私があなたと私自身に思い出させたかった考え- </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">人々のために書いてください</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">特に他の開発者が使用するツールを開発している場合は、決定する前に3回考えてください。</font><font style="vertical-align: inherit;">あなたのあらゆる決定と行動は誰かに影響を及ぼし、そしておそらく、彼に少しの血を台無しにするでしょう。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私は誰かのために故障を引き起こしたくありません。</font></font></strong><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">役立つリンク</font></font></h3><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">https://developer.android.com/topic/google-play-instant/overview</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">https://developer.android.com/guide/app-bundle</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">https://developer.android.com/studio/proiects/dvnamic-delivery</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">https://developer.android.com/guide/app-bundle/playcore</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Bundling an App in an Instant (Android Dev Summit '18)</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">https://github.com/googlesamples/android-instant-apps</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">https://github.com/googlesamples/android-dynamic-features</a></li>
</ul><br>
<blockquote>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Saint AppsConf</a>,   21-22   -,     ,    . Check it out!<br>
<br>
   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">telegram</a>, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">fb</a> —         . <br>
</blockquote></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja462501/index.html">独自の証明機関が必要な理由</a></li>
<li><a href="../ja462503/index.html">モニタリングとSREの「ゴールデンシグナル」とは何ですか？</a></li>
<li><a href="../ja462505/index.html">関数型プログラミングに騙されないでください</a></li>
<li><a href="../ja462507/index.html">メール配信時：iOSでのプッシュ通知の喪失との戦い</a></li>
<li><a href="../ja462509/index.html">Product Fest-行きたいIT製品管理会議</a></li>
<li><a href="../ja462513/index.html">移転：領域の準備、選択、開発</a></li>
<li><a href="../ja462515/index.html">システムキーボードを操作するときのバグ</a></li>
<li><a href="../ja462519/index.html">本「マイクロサービス。開発とリファクタリングのパターン»</a></li>
<li><a href="../ja462523/index.html">LinOTP 2要素認証サーバー</a></li>
<li><a href="../ja462525/index.html">3CXは、エンドツーエンドの音声暗号化を備えたiOSおよびAndroid用の新しいSIPソフトフォンを発売</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>