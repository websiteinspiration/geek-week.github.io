<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😊 🚋 👨‍👩‍👧‍👦 关于JavaScript中Math对象的可变方法 🎹 👨🏾‍✈️ 🍞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="今天，我们正在发布一篇有关JavaScript中数学计算的文章的翻译，这是其作者在WaffleJS上的演讲的书面版本。该声明本身是Twitter上此对话的延续。
 
 
 数学教育
 
 对数学感兴趣
 这一切都是从我的数学教育开始的，后来我收到了一些延误。当我学习计算机科学时，我可以与世界一流的数...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>关于JavaScript中Math对象的可变方法</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/489826/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">今天，我们正在发布一篇有关JavaScript中数学计算的文章的翻译，这是其作者在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WaffleJS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上的</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">演讲</font></a><font style="vertical-align: inherit;">的书面版本</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该声明本身是</font><font style="vertical-align: inherit;">Twitter上</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对话</font><font style="vertical-align: inherit;">的延续</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c50/bea/705/c50bea705dc18becfec75951a06de4df.jpg"></div></a><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数学教育</font></font></font></i><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对数学感兴趣</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这一切都是从我的数学教育开始的，后来我收到了一些延误。当我学习计算机科学时，我可以与世界一流的数学老师进行交流，但是我错过了这个机会。我不喜欢数学：所研究的主题与实践相去甚远。此外，我已经因计算机培训的深层次理论程序而失去了平衡。然后，我相信她已经脱离了生活，而且在大多数情况下，我仍然这样认为。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是现在，在我完成学业的几年后，对数学学习的渴望在我心中激起。即使很小的数学知识应用对我的工作和兴趣也会产生什么影响，使我受到启发。但是我没有一个明确的学习计划。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
然后，在2012年，我开始着手</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">简单统计</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">项目，找到了一种学习数学的方法</font><font style="vertical-align: inherit;">。从那时起，我扩展并支持了这个项目。现在，它包括许多算法的实现；事实证明它是最“ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">繁星</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”的数学JavaScript库之一。而且，显然，人们确实在使用该库。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是我从2012年开始工作。如果我们谈论这段时间技术是如何变化的，那是很久以前的事情了。此后，8个LTS版本</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的Node.js</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已被释放</font><font style="vertical-align: inherit;">。从那时起，JavaSript本身以及使用该语言编写的程序的工作环境发生了很大变化。在2012年，React库尚不存在，因此尚未对Babel项目进行首次提交。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5d8/832/415/5d8832415ee3bf56c1f3a18e294f39fb.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">时间的流逝</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
多年来，我注意到更新Node.js时测试崩溃了。</font><font style="vertical-align: inherit;">例如，我可能有这样的测试：</font></font><br>
<br>
<pre><code class="javascript hljs">t.equal(ss.gamma(<span class="hljs-number">11.54</span>), <span class="hljs-number">13098426.039156161</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该测试在Node.js v10中工作正常，但在Node.js v12中失败。</font><font style="vertical-align: inherit;">在这里，它不是被测试了一些超级复杂的方法：该功能</font></font><code>gamma</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用标准的JavaScript函数实现的- </font></font><code>Math.pow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>Math.sqrt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>Math.sin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">算术</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我知道您在这里会想到什么：算术。</font><font style="vertical-align: inherit;">在Twitter上，由于计算以下表达式的结果，引起的讨论定期展开：</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-number">0.1</span> + <span class="hljs-number">0.2</span> = <span class="hljs-number">0.30000000000000004</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，正如我已经</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">写过的那样</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，所有流行的编程语言都具有这种方式，即使是像Haskell这样的老式又古怪的语言也是如此。</font><font style="vertical-align: inherit;">浮点算术可能看起来很奇怪，但是它们的行为相同，它们的行为有据可查。</font><font style="vertical-align: inherit;">即，我们正在谈论</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IEEE 754</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标准</font><font style="vertical-align: inherit;">，其要求严格以编程语言实现。</font><font style="vertical-align: inherit;">因此，问题就不在算术上：加法，减法，除法和乘法在语言中的实现，编程可以说是“刻板的”。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数学对象</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我的问题出在标准的JavaScript对象中</font></font><code>Math</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">特别是在</font><font style="vertical-align: inherit;">此对象的</font><font style="vertical-align: inherit;">所有</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一些技术，如</font></font><code>Math.sin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>Math.cos</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>Math.exp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>Math.pow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>Math.tan</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-是基本成分</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">几何</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等计算。</font><font style="vertical-align: inherit;">当我理解了这一点之后，我开始分别研究</font></font><code>Math</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不同版本的Node.js中</font><font style="vertical-align: inherit;">对象基本方法的行为变化</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这里有些例子。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
计算方式</font></font><code>Math.tanh(0.1)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">// Node 4</span>
<span class="hljs-number">0.09966799462495590234</span>
<span class="hljs-comment">// Node 6</span>
<span class="hljs-number">0.09966799462495581907</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
计算方式</font></font><code>Math.pow(1/3, 3)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">// Node 10</span>
<span class="hljs-number">0.03703703703703703498</span>
<span class="hljs-comment">// Node 12</span>
<span class="hljs-number">0.03703703703703702804</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
更糟糕的是，这个问题不仅在Node.js中显而易见。</font><font style="vertical-align: inherit;">在浏览器和其他支持JavaScript的环境中也会发生同样的事情。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这导致我们提出以下问题：什么是数学计算？</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a45/45e/f7c/a4545ef7cf6e282546aee3ea506d762f.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">计算的图形表示</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
三角法很容易可视化。如果您有一个圆圈并且可以支配几个月的高中，那么您就会知道余弦和正弦是圆圈边缘上某个点的坐标，并且sin和cos函数的图看起来像波浪。实际上，在高中时，他们研究了这些值的推导，但是用于此目的的方法-</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">泰勒级数</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -依赖于无限级数，计算机很难解决这些问题。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这是您可以从</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">维基百科</font></a><font style="vertical-align: inherit;">中学到的东西</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关于正弦计算算法：“没有用于计算正弦的标准算法。 IEEE 754-2008是浮点计算最广泛使用的标准，它不会影响正弦等三角函数的计算。” </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
计算机使用许多不同的近似值和算法来执行计算，例如</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CORDIC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，各种技巧和查找表。所有这些异质性解释了GitHub上许多</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fastmath库</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的存在</font><font style="vertical-align: inherit;">。事实是有很多方法可以实现该方法</font></font><code>Math.sin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。还有其他功能。例如，如您所知，Quake III Arena使用了</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更快的速度</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">替换标准反平方根计算方法以加快渲染速度。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
结果，数学计算是某些算法实施的结果。在实践中，使用了许多常见的算法及其变体。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JavaScript规范没有指定在语言实现中使用哪种特定算法，而是在数学计算中使用的函数方面为实现提供了很大的回旋余地。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这是</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标准</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对此的说明</font><font style="vertical-align: inherit;">（ECMA-262，第10版，第20.2.2节）：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
“功能acos，acosh，asin，asinh，atan，atanh，atan2，cbrt，cos，cosh，exp，expm1，hypot，log，log1p，log2，log10，pow，pow，random，sin，sinh，sqrt，tan和tanh的行为除了参数的特定值需要返回某些结果的要求（这是值得注意的边界情况）外，这里没有完整描述。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我不知道负责ECMA-262标准的委员会成员的内部活动是如何组织的，但是我相信他们制定了该标准，因此，如果Intel或AMD发布新的超快速数学指令，就不会在JavaScript中造成兼容性危机。在他们的新处理器中。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于存在许多广泛使用的JavaScript解释器，由于JavaScript经常在浏览器中使用以及在浏览器之间存在竞争之类的事实，并且甚至流行的JavaScript实现也面临着不断的压力。并被迫迅速发展，以提供最佳性能...正因为如此，我们拥有了自己所拥有的。</font><font style="vertical-align: inherit;">任何使用JavaScript的人都会经常遇到这样的事实，即在不同的实现中，通过对象的方式执行的数学计算的结果</font></font><code>Math</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是不同的。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在其他解释语言中，这并不重要，因为它们通常具有一些“规范”实现。</font><font style="vertical-align: inherit;">例如，对于Python解释器，这是正确的。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">计算在哪里进行？</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，让我们仔细看看计算的确切位置。</font><font style="vertical-align: inherit;">对于JavaScript，在三个区域中执行基本数学计算：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中央处理器。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语言解释器（特定JavaScript实现的C ++和C代码）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JavaScript代码，例如，专用库的代码。</font></font></li>
</ol><br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍1。</font><font style="vertical-align: inherit;">中央处理器</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当我想到进行计算的地方时，我想到的第一个想法是，计算是在处理器中执行的。我建议由于处理器执行算术计算，因此它们还可以执行一些更复杂的计算。事实证明，处理器具有执行三角函数和其他计算的指令，但是很少使用这些指令。例如，在具有x86架构的处理器中执行正弦计算并不十分普及，因为这种实现不一定比软件实现（使用处理器算术运算的实现）要快。另外，它不一定比软件实现更准确。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
英特尔也因其非常强大而蒙羞</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在文档中</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">夸大了</font></a><font style="vertical-align: inherit;">三角运算</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">的</font></a><font style="vertical-align: inherit;">准确性。</font><font style="vertical-align: inherit;">由于与程序不同的是，微芯片无法修补，因此这种错误尤其可悲。</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍2。</font><font style="vertical-align: inherit;">语言翻译</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这就是计算子系统在大多数JavaScript实现中的工作方式。</font><font style="vertical-align: inherit;">他们以各种方式实现这些子系统。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V8和SpiderMonkey引擎使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fdlibm</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">库端口进行计算</font><font style="vertical-align: inherit;">，这略有不同。</font><font style="vertical-align: inherit;">该库最初由Sun Microsystems编写，已代代相传。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JavaScriptCore（Safari）使用cmath库执行大多数操作。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Internet Explorer使用cmath和一些用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">汇编器</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编写的代码块</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果浏览器是为具有类似指令的处理器编译的，则此处甚至使用三角函数的处理器。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于历史原因，用于在不同JS引擎中执行计算的工具已更改。</font><font style="vertical-align: inherit;">因此，V8使用自己的解决方案进行计算，然后使用了</font><font style="vertical-align: inherit;">fdlibm </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JavaScript端口</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，然后</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">才</font></a><font style="vertical-align: inherit;">使用了C版本的fdlibm。</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍为什么会有问题？</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这里的要点是，所有这些都会降低JavaScript在解决涉及数学计算的任何问题时产生统一结果的能力。</font><font style="vertical-align: inherit;">这对数据科学尤其困难。</font><font style="vertical-align: inherit;">我希望JavaScript更适合在浏览器中进行数据科学计算。</font><font style="vertical-align: inherit;">此外，无法产生统一的结果意味着加剧</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">了重现性危机</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，这是所有科学的特征。</font><font style="vertical-align: inherit;">更不用说其他JavaScript问题，例如键入数字的功能以及缺少用于处理数据框架的广泛使用的库。</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍3。</font><font style="vertical-align: inherit;">使用专门的库</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们有一种可靠的方式来使用JavaScript进行计算。它包括使用专门的库。因此，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stdlib</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">库</font><font style="vertical-align: inherit;">仅使用算术运算来实现高级计算。规范中对算术计算进行了全面描述，它们是标准的，因此stdlib返回的结果为我们提供了完全一致的结果，而不管执行代码的平台如何。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这是以复杂性和决策速度为代价的。 stdlib方法没有内置方法快。另外，为了“只计算正弦”，您需要将整个库连接到项目。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，如果您更广泛地考虑，这是完全正常的。例如，WebAssembly平台不给程序员任何执行高级数学计算的方法。在它的文档中，建议您在自己的模块中独立包括相应机制的实现：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
“ WebAssembly不包括其自己的数学函数实现-例如sin，cos，exp，pow等。 WebAssembly针对此类功能的策略是允许开发人员将其作为WebAssembly平台本身中的库工具来实现（请注意，x86平台的sin和cos指令运行缓慢且不准确，因此，无论如何，尽量不要使用）。”</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这就是编译语言一直以来的工作方式：当编译用C编写的程序时，从中导入的方法</font></font><code>math.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将包含在编译程序中。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用epsilon值</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果某人不想在他的JavaScript项目中包括stdlib库来执行计算，但是需要测试执行一些复杂计算的代码，那么他可能应该采用简单统计信息库中已经使用的方法。它与使用</font></font><code>epsilon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定义边界</font><font style="vertical-align: inherit;">的值有关</font><font style="vertical-align: inherit;">，在该边界内不考虑数字差异。如果我们考虑</font><font style="vertical-align: inherit;">在数学中使用epsilon符号</font><font style="vertical-align: inherit;">的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，那么可以说我所说的是“任意小的正值”。简单统计</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> epsilon值equal </font></font><code>0.0001</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果需要找出两个数字是否相等，则检查表格的条件</font></font><code>Math.abs(result — expected) &lt; epsilon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果这个条件成立，那么我们可以说数字之间的差落在给定范围内，并认为它们相等。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">加法</font></font></font></h2><br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍精度</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Twitter上的评论员指出，示例中获得的结果变化超出</font><font style="vertical-align: inherit;">了浮点数</font><font style="vertical-align: inherit;">的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有效位数</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">从技术角度来看，这是正确的，这意味着与使用值相比，您可以找到一种更准确的数字比较方式</font></font><code>epsilon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">但实际上，这里的故事是一样的-数字末尾的数字会影响结果，并在最终结果中引入不准确之处。</font><font style="vertical-align: inherit;">此外，此处给出的示例并不详尽。</font><font style="vertical-align: inherit;">事实是，在不脱离规范的情况下，JavaScript解释器的实现功能会导致大多数数值结果出现差异。</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍JavaScript</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我不想批评JavaScript。</font><font style="vertical-align: inherit;">我认为，考虑到未来的不确定性以及创建语言实现的平台数量，JavaScript做出了合理的妥协。</font><font style="vertical-align: inherit;">我必须说，直接比较JavaScript和其他语言非常困难。</font><font style="vertical-align: inherit;">关键是JavaScript生态系统。</font><font style="vertical-align: inherit;">同时有许多同一种语言的口译员对于其他语言来说是完全不典型的。</font><font style="vertical-align: inherit;">另外，这是JavaScript的主要优势之一。</font><font style="vertical-align: inherit;">此外，不能不说这些是与该语言本身所发生的计划完全不同的现象。</font><font style="vertical-align: inherit;">随着时间的流逝，JavaScript发生了变化，其中出现了</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">很多好东西</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dStdlib或epsilon？</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我认为，在大多数情况下，在实践中值得使用暗示使用epsilon值的方法。</font><font style="vertical-align: inherit;">stdlib库是一个很棒的强大工具，但是在项目中包括一个额外的用于数学计算的库的代价可能会很高。</font><font style="vertical-align: inherit;">而且在大多数情况下，计算结果中的微小差异对于应用而言并不重要。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">摘要</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这里，我想从以上内容得出结论并分享一些想法。</font></font><br>
<br>
<ol>
<li>,     ,   ,    .         .     —    « ». ,   ,   ,   <code>Math.sin</code>   ,   ,      ,      .      ,   ,      ,   ,   ,   .    ,       ,   ,       .</li>
<li>      . ,   ,       Node.js,         ,    ,     simply-statistics.    ,    , ,     ,      .  —    .</li>
<li>  ,    .    V8,      ,   .    ,    .    , ,         ,     .</li>
</ol><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">亲爱的读者们！</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">升级到新版本的Node.js时，您是否遇到过有关计算结果更改的问题？</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN489812/index.html">在Oracle BI中配置LDAP</a></li>
<li><a href="../zh-CN489818/index.html">JavaScript等：4种创新的方法来衡量浏览器中的时间</a></li>
<li><a href="../zh-CN489820/index.html">样式良好的旧按钮元素</a></li>
<li><a href="../zh-CN489822/index.html">使用元胞自动机生成伪随机数：规则30</a></li>
<li><a href="../zh-CN489824/index.html">7个值得了解的开源云安全监控工具</a></li>
<li><a href="../zh-CN489828/index.html">在Node.js中使用GeoJSON：实用介绍</a></li>
<li><a href="../zh-CN489832/index.html">人造原子珠：大环操纵</a></li>
<li><a href="../zh-CN489834/index.html">将您的智能家居设备嵌入到SmartThings生态系统中</a></li>
<li><a href="../zh-CN489836/index.html">未来的激光雷达：11,000台激光器，而不是128台激光器</a></li>
<li><a href="../zh-CN489838/index.html">使用SSR（服务器端渲染）的Nuxt服务器端内存泄漏</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>