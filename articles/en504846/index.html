<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö¥üèº üê¥ ‚óæÔ∏è Getting started with Veeam Backup for Microsoft Azure üö∏ ‚èπÔ∏è üî£</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In modern times, both stability and novelty are pleasing. Here Veeam is true to itself: products will be released according to plan, and engineers are...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Getting started with Veeam Backup for Microsoft Azure</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/veeam/blog/504846/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In modern times, both stability and novelty are pleasing. </font><font style="vertical-align: inherit;">Here Veeam is true to itself: products will be released according to plan, and engineers are developing new solutions, including </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Veeam Backup for Microsoft Azure</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which was released several weeks ago. </font><font style="vertical-align: inherit;">In the last </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">post,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> my colleague</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Loxmatiymamont</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">already talked about its advantages and principles of work, and today we will consider the deployment and configuration of a new solution. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xy/4p/j0/xy4pj0f3mvqlnmvqazamy8hucmi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you recall, this product is designed to back up virtual machines deployed in the Microsoft Azure cloud. </font><font style="vertical-align: inherit;">It helps to safely and efficiently backup cloud infrastructures, and if necessary, quickly restore them. </font><font style="vertical-align: inherit;">Integration with Veeam Backup &amp; Replication is supported - so in organizations working with a hybrid infrastructure, you can deploy almost a whole platform for working with virtual and physical machines both in the cloud and at your own capacities. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For details, welcome to cat.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Veeam Backup for Microsoft Azure</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> can:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">configure policies for backup Azure VM</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">work with native snapshots of Azure VM</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">backup to Azure blob storage</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">create backups in standard Veeam format</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">calculate cloud storage cost</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">restore whole VMs or only single files</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deploy it quickly and easily directly from the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Azure Marketplace</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ln/60/7p/ln607ponwwvkixvtsgzwmlpqkze.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To ensure backup security, Microsoft Azure service accounts and Active Directory integration are used. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The free version right out of the box allows you to backup up to 10 virtual machines. </font><font style="vertical-align: inherit;">(Read more about licensing in a previous </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .)</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is inside?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The main component is the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">controller server</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , a Linux-based virtual machine deployed in the Microsoft Azure cloud; </font><font style="vertical-align: inherit;">Veeam Backup for Microsoft Azure is preinstalled on it. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The controller server</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> performs all the important functions:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Backup Infrastructure Management</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Control over the creation of snapshots, backup and recovery of Microsoft Azure VMs.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scheduled backup policy support</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Management of the configuration database, which stores information about policies protected by VMs, accounts, etc.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To protect certain cloud infrastructure objects, </font><font style="vertical-align: inherit;">backup </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">policies</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> are created </font><font style="vertical-align: inherit;">. When creating them, you can focus on the regional affiliation of protected objects, on service level agreements (SLAs), etc., etc. We will consider policy settings a bit later. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To process each individual VM, Veeam Backup for Microsoft Azure uses auxiliary components - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">workers</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . I‚Äôll also tell you about their settings a little lower. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veeam Backup for Microsoft Azure supports the creation of both snapshots and backups for managed and unmanaged disks of Azure virtual machines (including VM configuration). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schematically, the operation of the solution during backup can be represented as follows:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lh/zb/du/lhzbduuidiwkpratwqmvshysqom.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When a backup policy is applied, Veeam Backup for Microsoft Azure does this:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Retrieves configuration and VHDs for each VM from Microsoft Azure.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Creates and saves snapshots and backup copies of these disks, while:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Snapshots of managed disks are saved in the same resource group where the original VM is located - through the Azure Compute API.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Snapshots of unmanaged disks are stored in the Microsoft Azure Store, where the original VHD is located. </font><font style="vertical-align: inherit;">Blob uses the Blob Service REST API to add data to blob.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">All VHD backups are saved to the repository as blob also through the Blob Service REST API. </font><font style="vertical-align: inherit;">When backup to the repository, data encryption and compression are performed.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VM configuration data is saved in the Veeam Backup for Microsoft Azure configuration database.</font></font></li>
</ul></li>
</ol><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deploy Veeam Backup for Microsoft Azure</font></font></h2> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Before starting the setup, pay attention to the list of necessary </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ports</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and the necessary </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">accounts and rights</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also keep in mind that deploying Veeam Backup for Microsoft Azure to a dedicated resource group is recommended to isolate compliance from the production infrastructure - for added security. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The setup itself is pretty straightforward - go to the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Azure Marketplace</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , go through the steps of the wizard and expand the virtual machine with Veeam Backup for Microsoft Azure installed (application). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Basic</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> section of the </font><font style="vertical-align: inherit;">VM creation wizard, do the following:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">From the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Subscription</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> list, </font><font style="vertical-align: inherit;">select the subscription for which the application will be deployed.</font></font></li>
<li>  <b>Resource group</b>     Veeam Backup for Microsoft Azure ‚Äî        . <br>
 <i>!</i>   ,  ,     ,     . </li>
<li>       <b>Virtual machine name</b>.</li>
<li>  <b>Region</b>   Microsoft Azure,    . <br>
 <i>:</i>         ,     . </li>
<li>[]        <b>Availability options </b>(, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">availability set</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">availability zone</a>).</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select a Veeam Backup for Microsoft Azure image in the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Image</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> list </font><font style="vertical-align: inherit;">.</font></font></li>
</ol><br>
<br>
<img src="https://habrastorage.org/webt/cc/12/do/cc12dohxtjncevp_umqqurah8lg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Further in the section </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instance details</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> you need:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Specify the required size of the new virtual machine. </font><font style="vertical-align: inherit;">By default, the setup sets the default optimal size based on the performance and cost of servicing the Azure VM. </font><font style="vertical-align: inherit;">Learn more about Microsoft recommendations </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The minimum requirements for Veeam Backup for Microsoft Azure are </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 vCPUs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4GB RAM</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Check that </font><b><font style="vertical-align: inherit;">NO is</font></b><font style="vertical-align: inherit;"> selected </font><font style="vertical-align: inherit;">in the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Azure Spot Instance</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> options </font><font style="vertical-align: inherit;">.</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then you need to go to the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Administrator account</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> section </font><font style="vertical-align: inherit;">, in the authentication type settings, select the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Password</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> option </font><font style="vertical-align: inherit;">and enter the username and password to access the Veeam Backup for Microsoft Azure web console. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> If you </font><font style="vertical-align: inherit;">choose </font><b><font style="vertical-align: inherit;">SSH public key</font></b><font style="vertical-align: inherit;"> instead of </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Password</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , you will not have access to the Veeam Backup for Microsoft Azure web console. </font><font style="vertical-align: inherit;">
Then we go to the </font><b><font style="vertical-align: inherit;">Disks</font></b><font style="vertical-align: inherit;"> step </font><font style="vertical-align: inherit;">and specify the disk settings for our machine. For best performance, we recommend the choice of </font><b><font style="vertical-align: inherit;">OS disk type</font></b><font style="vertical-align: inherit;"> specify the </font><i><font style="vertical-align: inherit;">Premium the SSD</font></i><font style="vertical-align: inherit;"> . </font><i><font style="vertical-align: inherit;">Note:</font></i></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Some values ‚Äã‚Äãwill already be set by default, you can not change them. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, in the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Networking</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> step, we </font><font style="vertical-align: inherit;">set the network settings. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zc/97/zy/zc97zyvhz-_b0wbfyu8dvnpqlng.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Load balancing</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> section, </font><font style="vertical-align: inherit;">verify that for </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Place this virtual machine behind an existing load balancing solution? </font></font></b><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> was indicated </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then click </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Review + create</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and our application is ready to go. </font><font style="vertical-align: inherit;">This is what the web console looks like:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cm/xx/63/cmxx63rwhzdk4vf_kd2gfy1yhhi.jpeg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Account Settings</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To work with resource groups, subscriptions and other Microsoft Azure objects, our solution will need a service account - it will be used by the specially designed </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Azure AD Application</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">This application can be prepared in advance or indicated that it should be created automatically and authenticated in the Azure cloud. </font><font style="vertical-align: inherit;">Both options are described in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the user manual</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (in English). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can also configure additional accounting:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for working with backup repositories</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to send notifications via the mail server</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for users who need administrative rights to work with Veeam Backup for Microsoft Azure</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To do this, go to the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Accounts</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> section in the console </font><font style="vertical-align: inherit;">and follow the steps described </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<img src="https://habrastorage.org/webt/a1/hq/m4/a1hqm4cnwn2m9z78rvsg58tzsvu.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configure backup infrastructure</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Our server is configured, now we configure the repository and auxiliary components - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">workers</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you plan to protect machines in Microsoft Azure only with the help of native snapshots, you can go directly </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to the second part of the Marlezon Ballet</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to configure workers.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you want to use Microsoft Azure blob storages as a backup storage, you will need to create a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">backup repository</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> entity in the Veeam Backup for Microsoft Azure console </font><font style="vertical-align: inherit;">and specify the container and folder for it in the corresponding archive - these simple steps are described </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As for </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">workers</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , these are auxiliary Linux machines that help to scale the process and distribute the load during data transfer. </font><font style="vertical-align: inherit;">The configuration of these components is created either by the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">controller server</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (it does this automatically during backup or recovery), or by the user. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The configuration defines:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">how many workers can work in parallel</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">which virtual network and security group will these VMs belong to</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">what size will they be </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An automatically created </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">worker</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> configuration </font><font style="vertical-align: inherit;">is considered defaulted. </font><font style="vertical-align: inherit;">It belongs to one Azure region and may contain 1 to 5 </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">workers</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The user can create the configuration manually, as described </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dq/bo/nc/dqbonclzmyeun5qajmhjpjyo9ym.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The </font><font style="vertical-align: inherit;">following should be remembered </font><font style="vertical-align: inherit;">about the work of </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">workers</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">worker</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> can process data from only one VM. </font><font style="vertical-align: inherit;">That is, if you have 30 machines in the backup policy, then Veeam Backup for Microsoft Azure can deploy 30 such </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">workers</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (when using a non-default configuration).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If the default configuration is involved (as they say, this is up to 5 </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">workers</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), then 5 machines will be processed at the same time, and the rest will wait in line.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On each VM with </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">worker</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the controller server installs these services:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Worker service</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - this service takes data from the Azure cloud.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">File-level recovery service</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - during </font><b><font style="vertical-align: inherit;">file-level recovery,</font></b><font style="vertical-align: inherit;"> this service is responsible for mounting (mounting) data from a backup to a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">worker</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> VM</font></font></li>
</ul><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After a period of inactivity (idle time = </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10 min</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">worker</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> VM </font><font style="vertical-align: inherit;">automatically shuts down </font><font style="vertical-align: inherit;">.</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The politicians</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> here act as an analogue of the backup job; </font><font style="vertical-align: inherit;">they are configured using the wizard, at the steps of which you must specify:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Azure Active Directory</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Regions where protected resources are located</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Type of objects (resources) to which the policy will be applied:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Subscription</font></font></li>
<li>Resource group ‚Äî  </li>
<li>Tags ‚Äî </li>
<li>Individual VMs ‚Äî  </li>
</ul><br>
</li>
<li>   ‚Äî     </li>
<li>   ‚Äî  blob storage, ,  </li>
<li> </li>
<li>Cost Estmation ‚Äî    </li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All this is described in detail </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vn/vj/vj/vnvjvjxc5jdfnbpe2ky44ii-oqu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As for estimating the cost of Azure VMs backups, it is automatically performed by a calculator built into the policy creation and editing wizard. </font><font style="vertical-align: inherit;">It is based on calculations of the monthly cost of traffic, transactions, backups and snapshots. </font><font style="vertical-align: inherit;">A calculator is a useful thing to justify and plan your cloud infrastructure costs. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thanks to it, you can immediately see how much the backup will cost you if it is performed according to a policy with such and such settings.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recovery</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here are the recovery options offered to Veeam Backup for Microsoft Azure users:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Restoring the entire VM to its original location (with overwriting the original machine)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Restore an entire VM to a new location</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">File Level Recovery</font></font></li>
</ul><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Useful:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Restoring at the file level is good in that it allows you to get the necessary data from the backup without having to lift the whole machine (saving money is obvious).</font></font><br>
<br>
<img src="https://habrastorage.org/webt/el/sv/i1/elsvi1d5hlf4l8agnwgm6ngm8yo.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Integration with Veeam Backup &amp; Replication</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recovery is supported in Microsoft Azure directly from backups created by Veeam Backup &amp; Replication - and there Veeam Backup for Microsoft Azure will deal with VM protection. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Or vice versa: due to the fact that Veeam Backup &amp; Replication can work with repositories based on Azure blob storage (where </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Veeam Backup for Microsoft Azure</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> backups </font><font style="vertical-align: inherit;">), you can restore a Microsoft Azure VM from your backup to your ‚Äúterrestrial‚Äù infrastructure, where it will already be protected by Veeam Backup &amp; Replication. </font><font style="vertical-align: inherit;">In general, everything to please the owners of hybrid infrastructures.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">useful links</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Well, in conclusion, as usual, a few useful links:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Habr article about Veeam Backup for Microsoft Azure</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solution Overview</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (in Russian)</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Veeam Backup for Microsoft Azure FREE at the Azure Marketplace</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">    Veeam Backup for Microsoft Azure RESTful API</a> ( . )</li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en504822/index.html">What is the difference between ‚Äúapproved by the FDA‚Äù and ‚Äúapproved by the FDA‚Äù</a></li>
<li><a href="../en504828/index.html">JUG Ru Group # 4 Online Stream Week</a></li>
<li><a href="../en504838/index.html">Amazon wants to buy unmanned Zoox robotsaxi for a billion</a></li>
<li><a href="../en504840/index.html">Security Week 23: LiveJournal password leak</a></li>
<li><a href="../en504842/index.html">Retrospective: how Elon Musk affects Tesla's stock price</a></li>
<li><a href="../en504848/index.html">Apply personalization in E-commerce</a></li>
<li><a href="../en504850/index.html">Hewlett Packard Enterprise Webinars | June 2020</a></li>
<li><a href="../en504854/index.html">Outer Join at LINQ</a></li>
<li><a href="../en504856/index.html">Top 10 Reasons to Switch to Oracle Cloud How can businesses accelerate innovation?</a></li>
<li><a href="../en504858/index.html">The heroine of ‚ÄúProfessions of the Future‚Äù shared her thoughts on Russian education</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>