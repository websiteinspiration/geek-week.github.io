<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëÉüèº üíÜüèΩ üîΩ Detalhes de implementa√ß√£o do protocolo de sincroniza√ß√£o de tempo PTPv2 üéª üë∂üèΩ üàµ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introdu√ß√£o
 
 O conceito de constru√ß√£o de uma "Subesta√ß√£o Digital" no setor de energia el√©trica requer sincroniza√ß√£o com uma precis√£o de 1 Œºs. As tran...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Detalhes de implementa√ß√£o do protocolo de sincroniza√ß√£o de tempo PTPv2</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/phoenix_contact/blog/495920/"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introdu√ß√£o</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
O conceito de constru√ß√£o de uma "Subesta√ß√£o Digital" no setor de energia el√©trica requer sincroniza√ß√£o com uma precis√£o de 1 Œºs. </font><font style="vertical-align: inherit;">As transa√ß√µes financeiras tamb√©m exigem precis√£o de microssegundos. </font><font style="vertical-align: inherit;">Nessas aplica√ß√µes, a precis√£o do tempo NTP n√£o √© mais suficiente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O protocolo de sincroniza√ß√£o PTPv2, descrito pelo padr√£o IEEE 1588v2, permite precis√£o de sincroniza√ß√£o de v√°rias dezenas de nanossegundos. </font><font style="vertical-align: inherit;">O PTPv2 permite enviar pacotes de sincroniza√ß√£o em redes L2 e L3. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As principais √°reas em que o PTPv2 √© usado s√£o:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Engenharia de Energia;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">equipamento de controle e medi√ß√£o;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">complexo industrial militar;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telecom</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setor financeiro.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta publica√ß√£o analisa como o protocolo de sincroniza√ß√£o PTPv2 funciona. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Temos mais experi√™ncia no setor e geralmente encontramos esse protocolo em aplica√ß√µes de energia. Nesse sentido, faremos a revis√£o de olho </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">na energia</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por que isso √© necess√°rio?</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Atualmente, o STO 34.01-21-004-2019 do PJSC Rosseti e o STO 56947007-29.240.10.302-2020 do PJSC FGC UES cont√™m requisitos para organizar um barramento de processo com sincroniza√ß√£o de tempo via PTPv2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso se deve ao fato de os terminais de prote√ß√£o de rel√© e os dispositivos de medi√ß√£o estarem conectados ao barramento de processo, que transmitem valores instant√¢neos de corrente e tens√£o usando os chamados fluxos SV (fluxos multicast) atrav√©s do barramento de processo.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os terminais de prote√ß√£o de rel√© usam esses valores para implementar a prote√ß√£o de conex√£o. Se a precis√£o das medi√ß√µes ao longo do tempo for pequena, algumas prote√ß√µes podem funcionar falsamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, a prote√ß√£o da seletividade absoluta pode se tornar v√≠tima de sincroniza√ß√£o de tempo "fraca". Freq√ºentemente, a l√≥gica de tais defesas se baseia na compara√ß√£o de dois valores. Se os valores divergem para um valor suficientemente grande, a prote√ß√£o √© acionada. Se esses valores forem medidos com uma precis√£o de 1 ms, voc√™ poder√° obter uma grande diferen√ßa onde os valores s√£o realmente normais, se voc√™ medi-los com uma precis√£o de 1 Œºs. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vers√µes de PTP</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O protocolo PTP foi originalmente descrito em 2002 no padr√£o IEEE 1588-2002 e foi chamado de "Padr√£o para um Protocolo de Sincroniza√ß√£o de Rel√≥gio de Precis√£o para Sistemas de Medi√ß√£o e Controle em Rede". </font><font style="vertical-align: inherit;">Em 2008, foi lan√ßado o padr√£o IEEE 1588-2008 atualizado, que descreve a vers√£o 2. do PTP. Nesta vers√£o do protocolo, a precis√£o e a estabilidade foram aprimoradas, mas a compatibilidade com a primeira vers√£o do protocolo n√£o foi preservada. </font><font style="vertical-align: inherit;">Al√©m disso, em 2019, foi lan√ßada uma vers√£o do padr√£o IEEE 1588-2019 que descreve o PTP v2.1. </font><font style="vertical-align: inherit;">Esta vers√£o adiciona pequenas melhorias ao PTPv2 e √© compat√≠vel com o PTPv2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em outras palavras, temos a seguinte imagem com as vers√µes:</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PTPv1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(IEEE 1588-2002)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PTPv2 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(IEEE 1588-2008)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PTPv2.1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(IEEE 1588-2019)</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PTPv1 (IEEE 1588-2002)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Incompat√≠vel</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Incompat√≠vel</font></font><br>
</td>
</tr>
<tr>
<td>PTPv2 (IEEE 1588-2008)<br>
</td>
<td><br>
</td>
<td> ‚Äî </td>
<td><br>
</td>
</tr>
<tr>
<td>PTPv2.1 (IEEE 1588-2019)<br>
</td>
<td><br>
</td>
<td><br>
</td>
<td> ‚Äî </td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas, como sempre, existem nuances. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A incompatibilidade entre PTPv1 e PTPv2 sugere que um dispositivo com suporte a PTPv1 n√£o poder√° sincronizar a partir do rel√≥gio exato em execu√ß√£o no PTPv2. Eles usam diferentes formatos de mensagem para sincroniza√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas voc√™ ainda pode combinar dispositivos com PTPv1 e dispositivos com PTPv2 na mesma rede. Para isso, alguns fabricantes permitem selecionar a vers√£o do protocolo nas portas do rel√≥gio de borda. Ou seja, o rel√≥gio de limite pode ser sincronizado via PTPv2 e, ao mesmo tempo, sincronizar outros rel√≥gios conectados a ele por PTPv1 e PTPv2. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dispositivos PTP. O que s√£o e como eles diferem?</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
O padr√£o IEEE 1588v2 descreve v√°rios tipos de dispositivos. Todos eles s√£o apresentados na tabela. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os dispositivos se comunicam via LAN usando PTP.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os dispositivos PTP s√£o chamados de rel√≥gios. </font><font style="vertical-align: inherit;">Todos os rel√≥gios levam a hora exata do rel√≥gio grandmaster. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem 5 tipos de rel√≥gios:</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rel√≥gio Grandmaster</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A principal fonte de tempo preciso. </font><font style="vertical-align: inherit;">Frequentemente equipado com uma interface para conectar o GPS.</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rel√≥gio comum</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um dispositivo de porta √∫nica que pode ser um mestre (rel√≥gio mestre) ou um escravo (rel√≥gio mestre)</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Horas principais (mestre)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eles s√£o a fonte do hor√°rio exato em que outros rel√≥gios s√£o sincronizados.</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rel√≥gio Escravo (Escravo)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O dispositivo final que sincroniza a partir do rel√≥gio principal</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rel√≥gio de limite</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um dispositivo com v√°rias portas, que pode ser um mestre ou um escravo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ou seja, este rel√≥gio pode sincronizar a partir de um rel√≥gio mestre mais alto e sincronizar um rel√≥gio escravo mais baixo.</font></font><br>
</td>
</tr>
<tr>
<td>End-to-end Transparent Clock ( ,    End-to-End)<br>
</td>
<td>   ,      ,  .    PTP   . <br>
<br>
       PTP-. <br>
<br>
                .<br>
 </td>
</tr>
<tr>
<td>Peer-to-Peer Transparent Clock ( ,    Peer-to-Peer)<br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um dispositivo com v√°rias portas que n√£o √© um rel√≥gio principal nem um escravo. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ele transmite dados PTP entre duas horas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao transmitir dados, o rel√≥gio transparente corrige todas as mensagens PTP Sync e Follow_Up (mais sobre elas s√£o descritas abaixo). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A corre√ß√£o √© alcan√ßada adicionando ao campo do ajuste do pacote de atraso transmitido no dispositivo transmissor e o atraso no canal de dados.</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√≥ de Gerenciamento</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um dispositivo que configura e diagnostica outros rel√≥gios</font></font><br>
</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os rel√≥gios mestre e escravo s√£o sincronizados usando carimbos de hora nas mensagens PTP. </font><font style="vertical-align: inherit;">Existem dois tipos de mensagens no protocolo PTP:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As mensagens de evento s√£o mensagens sincronizadas que envolvem a gera√ß√£o de um registro de data e hora no momento em que uma mensagem √© enviada e no momento em que √© recebida.</font></font></li>
<li>General Messages ‚Äì      ,        </li>
</ul><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td>Event Messages<br>
</td>
<td>General Messages<br>
</td>
</tr>
<tr>
<td>Sync<br>
Delay_Req<br>
Pdelay_Req<br>
Pdelay_Resp<br>
</td>
<td>Announce<br>
Follow_Up<br>
Delay_Resp<br>
Pdelay_Resp_Follow_Up<br>
Management<br>
Signaling<br>
</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A seguir, consideraremos todos os tipos de mensagens com mais detalhes. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Principais problemas de sincroniza√ß√£o</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ao transmitir um pacote de sincroniza√ß√£o por uma rede local, o atraso √© feito no comutador e no canal de transmiss√£o de dados. </font><font style="vertical-align: inherit;">Qualquer op√ß√£o fornecer√° um atraso de cerca de 10 Œºs, o que √© inaceit√°vel para o PTPv2. </font><font style="vertical-align: inherit;">Afinal, precisamos obter uma precis√£o de 1 Œºs no dispositivo final. </font><font style="vertical-align: inherit;">(√â quando se trata de energia. Outras aplica√ß√µes podem exigir mais precis√£o.) O </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IEEE 1588v2 descreve v√°rios algoritmos de opera√ß√£o que permitem registrar o atraso e ajust√°-lo. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Algoritmo operacional</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Durante a opera√ß√£o normal, o protocolo opera em duas fases.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fase 1 - Estabelecimento da hierarquia ‚ÄúLeading Clock - Slave Clock‚Äù.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fase 2 - sincroniza√ß√£o do rel√≥gio usando o mecanismo de ponta a ponta ou ponto a ponto.</font></font></li>
</ul><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fase 1 - Configura√ß√£o da hierarquia do escravo mestre</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Cada porta de um rel√≥gio regular ou de fronteira tem um certo n√∫mero de estados (rel√≥gio escravo e rel√≥gio mestre). O padr√£o descreve o algoritmo de transi√ß√£o entre esses estados. Na programa√ß√£o, esse algoritmo √© chamado de m√°quina de estado ou m√°quina de estado (mais no Wiki). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta m√°quina de estado usa o Melhor algoritmo de rel√≥gio mestre (BMCA) para definir o mestre quando duas horas estiverem conectadas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esse algoritmo permite que o rel√≥gio assuma as obriga√ß√µes de um rel√≥gio grandmaster quando um rel√≥gio grandmaster superior perde seu sinal de GPS, se desconecta da rede etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As transi√ß√µes de estado de acordo com o BMCA s√£o mostradas brevemente no diagrama a seguir:</font></font><br>
<img src="https://habrastorage.org/webt/uy/hz/h6/uyhzh63gb0jt63bppsuuhcllwmu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As informa√ß√µes sobre o rel√≥gio na outra extremidade do ‚Äúfio‚Äù s√£o enviadas em uma mensagem especial (Anunciar mensagem). </font><font style="vertical-align: inherit;">Quando essas informa√ß√µes s√£o recebidas, o algoritmo da m√°quina de estados processa e compara qual rel√≥gio √© melhor. </font><font style="vertical-align: inherit;">A porta dos melhores rel√≥gios se torna o principal rel√≥gio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma hierarquia simples √© apresentada no diagrama abaixo. </font><font style="vertical-align: inherit;">Os caminhos 1, 2, 3, 4, 5 podem conter um rel√≥gio transparente (rel√≥gio transparente), mas eles n√£o participam do estabelecimento da hierarquia ‚ÄúRel√≥gio principal - rel√≥gio escravo‚Äù. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kj/md/ci/kjmdcibg-ls2rflwu6qtur-0osg.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fase 2 - Sincroniza√ß√£o de um rel√≥gio normal e de limite</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Imediatamente ap√≥s o estabelecimento da hierarquia ‚ÄúHoras iniciais - Horas escravas‚Äù, √© iniciada a fase de sincroniza√ß√£o de um rel√≥gio regular e limite. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para sincroniza√ß√£o, o rel√≥gio mestre envia uma mensagem contendo um carimbo de hora para o rel√≥gio escravo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os principais hor√°rios podem ser:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est√°gio √∫nico;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">duas etapas.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um rel√≥gio de est√°gio √∫nico para sincroniza√ß√£o envia uma mensagem de sincroniza√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um rel√≥gio de dois est√°gios usa duas mensagens para sincroniza√ß√£o - Sync e Follow_Up. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dois mecanismos podem ser usados ‚Äã‚Äãpara a fase de sincroniza√ß√£o:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atraso no mecanismo de solicita√ß√£o-resposta.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mecanismo de medi√ß√£o de atraso de pares.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para come√ßar, consideraremos esses mecanismos no caso mais simples - quando rel√≥gios transparentes n√£o forem usados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Atraso no mecanismo de solicita√ß√£o-resposta </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O mecanismo possui duas etapas:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Medi√ß√£o do atraso na transmiss√£o de uma mensagem entre um rel√≥gio principal e um escravo. </font><font style="vertical-align: inherit;">√â realizado usando o mecanismo de solicita√ß√£o-resposta de atraso.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O deslocamento exato da hora √© corrigido.</font></font></li>
</ol><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Medi√ß√£o de retardo</font></font></i><br>
<img src="https://habrastorage.org/webt/zj/hp/sa/zjhpsak259vihrylfiujf5vj2sm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
t1 - Sincronize o tempo de envio da mensagem pelo rel√≥gio principal; t2 - Sincronizar o tempo de recep√ß√£o da mensagem pelo rel√≥gio escravo; t3 - Atraso no tempo de envio da solicita√ß√£o (Delay_Req) ‚Äã‚Äãpor hora do escravo; t4 - Atraso_Req da hora de recep√ß√£o pelo rel√≥gio principal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando o rel√≥gio secund√°rio conhece o tempo t1, t2, t3 e t4, ele pode calcular o atraso m√©dio na transmiss√£o da mensagem de sincroniza√ß√£o (tmpd). √â calculado da seguinte forma: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/e6/cz/qx/e6czqxjr1wen8eld_z4y16joa4k.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao transmitir uma mensagem Sync e Follow_Up, o atraso de tempo do mestre para o escravo √© calculado - t-ms. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao transmitir mensagens Delay_Req e Delay_Resp, o atraso de tempo do escravo para o mestre, t-sm, √© calculado.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se ocorrer alguma assimetria entre esses dois valores, aparecer√° um erro na corre√ß√£o da partida do hor√°rio exato. O erro √© causado pelo fato de o atraso calculado ser a m√©dia dos atrasos t-ms e t-sm. Se os atrasos n√£o forem iguais, ajustaremos a hora incorretamente. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Corrigindo o deslocamento da hora exata</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Depois que o atraso entre o rel√≥gio principal e o rel√≥gio secund√°rio √© conhecido, o rel√≥gio secund√°rio executa a corre√ß√£o da hora. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/a7/gv/qz/a7gvqzykdjxtg6nm5rcqhcqmyzs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O rel√≥gio escravo usa a mensagem Sync e a mensagem opcional Follow_Up para calcular o deslocamento exato do tempo ao transmitir o pacote do rel√≥gio mestre para o escravo. O deslocamento √© calculado usando a seguinte f√≥rmula: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/n1/rk/nw/n1rknwzr-r0qio-uf1a9iiqd_9o.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mecanismo de medi√ß√£o de atraso de pares</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Esse mecanismo tamb√©m usa duas etapas para sincronizar:</font></font><br>
<br>
<ol>
<li>         .     peer delay mechanism.</li>
<li>   .</li>
</ol><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Medi√ß√£o de atraso</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ponto a ponto </font><i><font style="vertical-align: inherit;">O atraso entre dispositivos ativados</font></i><font style="vertical-align: inherit;"> ponto a ponto √© medido usando as seguintes mensagens: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/eo/0o/y2/eo0oy26vhwksm1rel2znic_q8rs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando a porta 1 sabe os tempos t1, t2, t3 e t4, pode calcular o atraso m√©dio (tmld ) √â calculado usando a seguinte f√≥rmula: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/a6/3r/mc/a63rmc4ehosk81dvktfv4prevt0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, a porta usa esse valor para calcular o campo de ajuste para cada mensagem de sincroniza√ß√£o ou mensagem opcional de Follow_Up que passa por este dispositivo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O atraso total ser√° igual √† soma do atraso durante a transmiss√£o atrav√©s deste dispositivo, o atraso m√©dio durante a transmiss√£o atrav√©s do canal de dados e o atraso j√° contido nesta mensagem, inclu√≠do nos dispositivos superiores.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As mensagens Pdelay_Req, Pdelay_Resp e Pdelay_Resp_Follow_Up opcionais permitem obter um atraso do mestre para o escravo e do escravo para o mestre (circular). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qualquer assimetria entre esses dois valores introduzir√° um erro preciso de corre√ß√£o do deslocamento no tempo. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Corrigindo o deslocamento da hora exata O</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/m6/do/ku/m6dokuldnfjmqscwyrtin2tvjiu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
rel√≥gio escravo usa a mensagem Sync e a mensagem Follow_Up opcional para calcular o deslocamento da hora exata ao transmitir o pacote do rel√≥gio principal para o escravo. O deslocamento √© calculado de acordo com a seguinte f√≥rmula: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ub/ui/xk/ubuixkpfmzizo7ilzkdgyfwvh8c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vantagens do ajuste ponto a ponto - o atraso de tempo de cada mensagem de sincroniza√ß√£o ou acompanhamento √© calculado √† medida que √© transmitido na rede. Portanto, uma mudan√ßa no caminho da transmiss√£o n√£o afetar√° de maneira alguma a precis√£o do ajuste.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao usar esse mecanismo, a sincroniza√ß√£o de tempo n√£o exige o c√°lculo do atraso no caminho percorrido pelo pacote de sincroniza√ß√£o, como √© feito em uma troca b√°sica. Essa. As mensagens Delay_Req e Delay_Resp n√£o s√£o enviadas. Nesse m√©todo, o atraso entre o rel√≥gio principal e os seguidores √© simplesmente somado no campo de ajuste de cada mensagem de sincroniza√ß√£o ou acompanhamento. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outra vantagem √© que o rel√≥gio de acionamento √© descarregado devido √† necessidade de processar mensagens Delay_Req. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modos de opera√ß√£o de rel√≥gios transparentes</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Assim, exemplos simples foram examinados. Agora, suponha que as op√ß√µes apare√ßam no caminho de sincroniza√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ usar comutadores sem suporte a PTPv2, o pacote de sincroniza√ß√£o ser√° atrasado em cerca de 10 ¬µs no comutador.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os comutadores com suporte a PTPv2 na terminologia IEEE 1588v2 s√£o chamados de rel√≥gios transparentes. </font><font style="vertical-align: inherit;">O rel√≥gio transparente n√£o √© sincronizado com o rel√≥gio principal e n√£o participa da hierarquia "Rel√≥gio principal - Rel√≥gio secund√°rio", mas ao transmitir mensagens de sincroniza√ß√£o, eles lembram o quanto a mensagem foi atrasada por eles. </font><font style="vertical-align: inherit;">Isso permite que voc√™ ajuste o atraso de tempo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um rel√≥gio transparente pode funcionar em dois modos:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De ponta a ponta.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pessoa para pessoa.</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"></font></b><br>
<br>
<img src="https://habrastorage.org/webt/cb/ev/vy/cbevvyylfmfgq9jgwm_jiuxvkjw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ponta a </font><b><font style="vertical-align: inherit;">ponta (E2E) O</font></b><font style="vertical-align: inherit;"> rel√≥gio E2E transparente transmite mensagens de sincroniza√ß√£o e mensagens de acompanhamento associadas a todas as portas. Mesmo aqueles que est√£o bloqueados por qualquer protocolo (por exemplo, RSTP). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O switch lembra o carimbo de data e hora quando o pacote Sync (Follow_Up) foi recebido na porta e quando foi enviado a partir da porta. Com base nesses dois registros de data e hora, o tempo de processamento do comutador para a mensagem √© calculado. No padr√£o, esse tempo √© chamado de tempo de perman√™ncia. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O tempo de processamento √© adicionado ao campo corre√ß√£oField da mensagem Sincronizar (rel√≥gio de est√°gio √∫nico) ou Follow_Up (rel√≥gio de dois est√°gios).</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hv/4q/rj/hv4qrjcuzer2hejocmtzitnntma.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O rel√≥gio transparente do E2E mede o tempo de processamento das mensagens Sync e Delay_Req que passam pelo comutador. Mas √© importante entender que o atraso de tempo entre o rel√≥gio principal e o rel√≥gio escravo √© calculado usando o mecanismo de solicita√ß√£o-resposta de atraso. Se o rel√≥gio principal mudar ou o caminho do rel√≥gio principal para o escravo mudar, o atraso ser√° medido novamente. Isso aumenta o tempo de transi√ß√£o no caso de altera√ß√µes na rede. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sw/im/q7/swimq7rpv2n24wyd8erbsvf420s.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O rel√≥gio P2P transparente, al√©m de medir o tempo de processamento da mensagem pelo comutador, mede o atraso no canal de dados para o vizinho mais pr√≥ximo, usando o mecanismo de medi√ß√£o de atraso do n√≥ vizinho.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O atraso √© medido em cada canal nas duas dire√ß√µes, incluindo os canais bloqueados por um protocolo (por exemplo, RSTP). </font><font style="vertical-align: inherit;">Isso permite que voc√™ calcule imediatamente um novo atraso no caminho de sincroniza√ß√£o se o rel√≥gio grandmaster ou a topologia de rede tiver sido alterada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O tempo de processamento do switch e o tempo de atraso s√£o acumulados ao transmitir mensagens Sync ou Follow_Up. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipos de suporte para comutadores PTPv2 Os</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
comutadores podem suportar PTPv2:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">programaticamente;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hardware.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na implementa√ß√£o de software do protocolo PTPv2, o switch solicita um carimbo de data / hora do firmware. </font><font style="vertical-align: inherit;">O problema √© que o firmware funciona ciclicamente e voc√™ ter√° que esperar at√© que ele termine o ciclo atual, levar a solicita√ß√£o ao processamento e, ap√≥s o pr√≥ximo ciclo, emitir um carimbo de data / hora. </font><font style="vertical-align: inherit;">Isso tamb√©m levar√° tempo e receberemos um atraso, embora n√£o seja t√£o significativo quanto sem o suporte de software para PTPv2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Somente o suporte de hardware para PTPv2 permite manter a precis√£o necess√°ria. </font><font style="vertical-align: inherit;">Nesse caso, a emiss√£o do registro de data e hora √© realizada por um ASIC especial, instalado na porta. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formato da mensagem</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Todas as mensagens PTP consistem nos seguintes campos:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cabe√ßalho - 34 bytes.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Corpo - o tamanho depende do tipo de mensagem.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sufixo - opcional.</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/ae/9l/_3/ae9l_3mph3pkhb-2oi0h_ppy48u.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cabe√ßalho</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
O campo </font><b><font style="vertical-align: inherit;">Cabe√ßalho</font></b><font style="vertical-align: inherit;"> √© o mesmo para todas as mensagens PTP. Seu tamanho √© 34 bytes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Formato do campo de cabe√ßalho: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yu/xs/gu/yuxsgundgrz9iyiyyfabaxt5i38.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">messageType</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - cont√©m o tipo de mensagem que est√° sendo enviada, por exemplo, Sincroniza√ß√£o, Delay_Req, PDelay_Req, etc. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">messageLength</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - cont√©m o tamanho completo da mensagem PTP, incluindo cabe√ßalho, corpo e sufixo (mas excluindo bytes de preenchimento). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">domainNumber</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Determina a qual dom√≠nio PTP a mensagem pertence. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um dom√≠nio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> s√£o alguns rel√≥gios diferentes, reunidos em um grupo l√≥gico e sincronizados a partir de um rel√≥gio principal, mas n√£o necessariamente sincronizados com um rel√≥gio pertencente a outro dom√≠nio. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sinalizadores</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - este campo cont√©m v√°rios sinalizadores para identificar o status da mensagem. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">correctField</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- cont√©m o tempo de atraso em nanossegundos. O tempo de atraso inclui o atraso de transmiss√£o atrav√©s do rel√≥gio transparente, bem como o atraso de transmiss√£o atrav√©s do canal ao usar o modo Ponto a Ponto. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourcePortIdentity</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - este campo cont√©m informa√ß√µes sobre a porta de onde esta mensagem foi enviada originalmente. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sequenceID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - cont√©m o n√∫mero de identifica√ß√£o para mensagens individuais. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">controlField</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - campo de artefato =) Permanece da primeira vers√£o do padr√£o e cont√©m informa√ß√µes sobre o tipo desta mensagem. Essencialmente o mesmo que messageType, mas com menos op√ß√µes. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">logMessageInterval</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - este campo √© determinado pelo tipo de mensagem. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Corpo</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como discutido acima, existem v√°rios tipos de mensagens. Estes tipos s√£o descritos abaixo: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anunciar mensagem A mensagem de an√∫ncio</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
√© usada para "informar" outros rel√≥gios no mesmo dom√≠nio sobre suas configura√ß√µes. Esta mensagem permite definir a hierarquia ‚ÄúLeading Clock - Slave Clock‚Äù. </font></font><br>
<img src="https://habrastorage.org/webt/-i/zs/dh/-izsdhnvkookhpjtrdrqx2myimy.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sincroniza√ß√£o</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
mensagem uma mensagem de sincroniza√ß√£o (Sync) √© enviado pelo rel√≥gio mestre e cont√©m a hora do rel√≥gio principal no momento que a mensagem de sincroniza√ß√£o foi criado. Se o rel√≥gio principal for de dois est√°gios, o registro de data e hora na mensagem de sincroniza√ß√£o ser√° definido como 0 e o registro de data e hora atual ser√° enviado na mensagem de acompanhamento emparelhada. A mensagem Sync √© usada para ambos os mecanismos de medi√ß√£o de atraso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A mensagem √© transmitida usando multicast. Opcionalmente, voc√™ pode usar o Unicast.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sc/pp/1f/scpp1fns1uuyccw9bucbvghesgo.png"><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mensagem </font><b><font style="vertical-align: inherit;">Delay_Req</font></b><font style="vertical-align: inherit;"> O formato da mensagem </font><b><font style="vertical-align: inherit;">Delay_Req</font></b><font style="vertical-align: inherit;"> √© id√™ntico √† mensagem Sync. O rel√≥gio escravo envia Delay_Req. Ele cont√©m a hora em que Delay_Req foi enviado pelo rel√≥gio escravo. Esta mensagem √© usada apenas para o mecanismo de solicita√ß√£o-resposta de atraso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A mensagem √© transmitida usando multicast. Opcionalmente, voc√™ pode usar o Unicast. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fe/bm/r_/febmr_zz7v1dricuta5z88xmjqk.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mensagem Follow_Up A mensagem Follow_Up</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
√© opcionalmente enviada pelo rel√≥gio principal e cont√©m a hora em que o </font><font style="vertical-align: inherit;">mestre </font><font style="vertical-align: inherit;">enviou a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mensagem de sincroniza√ß√£o</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . A mensagem Follow_Up √© enviada apenas por um rel√≥gio de duas etapas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A mensagem Follow_Up √© usada para os dois mecanismos de medi√ß√£o de atraso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A mensagem √© transmitida usando multicast. Opcionalmente, voc√™ pode usar o Unicast. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1g/42/2a/1g422aehbonsjrjjq0dwn9ceoxi.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Delay_Resp da mensagem</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A mensagem Delay_Resp √© enviada pelo rel√≥gio principal. Ele cont√©m a hora em que o Delay_Req √© recebido pelo rel√≥gio principal. Esta mensagem √© usada apenas para o mecanismo de solicita√ß√£o-resposta de atraso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A mensagem √© transmitida usando multicast. Opcionalmente, voc√™ pode usar o Unicast. </font><font style="vertical-align: inherit;">
Mensagem </font></font><br>
<br>
<img src="https://habrastorage.org/webt/up/is/gz/upisgzu5d7dk0iscixogmmjciwi.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pdelay_Req Uma</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mensagem </font><b><font style="vertical-align: inherit;">Pdelay_Req</font></b><font style="vertical-align: inherit;"> √© enviada por um dispositivo que solicita um atraso. Ele cont√©m o hor√°rio em que a mensagem foi enviada da porta deste dispositivo. Pdelay_Req √© usado apenas para o mecanismo de medi√ß√£o de atraso do n√≥ vizinho. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hn/km/rz/hnkmrzmcidqsawxtazho-oprpus.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mensagem Pdelay_Resp A mensagem Pdelay_Resp</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
√© enviada pelo dispositivo que recebeu a solicita√ß√£o de atraso. Ele cont√©m o hor√°rio em que a mensagem Pdelay_Req foi recebida por este dispositivo. As mensagens Pdelay_Resp s√£o usadas apenas para o mecanismo de medi√ß√£o de atraso do n√≥ vizinho.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kh/bb/34/khbb34wn7ujy84lldruomgaenmg.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mensagem Pdelay_Resp_Follow_Up A mensagem Pdelay_Resp_Follow_Up</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
√© opcionalmente enviada pelo dispositivo que recebeu a solicita√ß√£o de atraso. </font><font style="vertical-align: inherit;">Ele cont√©m o hor√°rio em que a mensagem Pdelay_Req foi recebida por este dispositivo. </font><font style="vertical-align: inherit;">A mensagem Pdelay_Resp_Follow_Up √© enviada apenas por um rel√≥gio principal de dois est√°gios. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta mensagem tamb√©m pode ser usada para tempo de execu√ß√£o em vez de um carimbo de data / hora. </font><font style="vertical-align: inherit;">O tempo de execu√ß√£o √© o tempo desde o momento em que o Pdelay-Req √© recebido at√© o envio do Pdelay_Resp. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pdelay_Resp_Follow_Up s√£o usados ‚Äã‚Äãapenas para o mecanismo de medi√ß√£o de atraso do n√≥ vizinho. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/w7/-k/q2/w7-kq2pssesbnko10w1tmsrs9ow.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mensagens de controle (mensagem de gerenciamento) As</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
mensagens de controle PTP s√£o necess√°rias para transferir informa√ß√µes entre um ou mais rel√≥gios e o n√≥ de controle. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/r7/xi/c0/r7xic0kvnb_yurjc53bah53f2ss.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transferir para LV</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma mensagem PTP pode ser transmitida em dois n√≠veis:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rede - como parte dos dados IP.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link - como parte de um quadro Ethernet.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enviando uma mensagem PTP sobre UDP sobre IP sobre Ethernet Os </font><b><font style="vertical-align: inherit;">perfis</font></b></font><br>
<br>
<img src="https://habrastorage.org/webt/f7/k6/al/f7k6alykkmt_4jrstkfkad_if-4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PTP sobre UDP sobre Ethernet sobre </font><font style="vertical-align: inherit;">
PTP possuem muitos par√¢metros "flex√≠veis" que precisam ser configurados. </font><font style="vertical-align: inherit;">Por exemplo:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/a7/pe/wu/a7pewujvuii1chap6wppv51dh0k.png"><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Op√ß√µes de BMCA.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O mecanismo de medi√ß√£o de atraso.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intervalos e valores iniciais de todos os par√¢metros configur√°veis, etc.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E, apesar do fato de que dissemos anteriormente que os dispositivos PTPv2 s√£o compat√≠veis entre si, de uma maneira boa, n√£o √©. Os dispositivos devem ter as mesmas configura√ß√µes para interagir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, existem os chamados perfis PTPv2. Perfis s√£o grupos de configura√ß√µes definidas e certas restri√ß√µes de protocolo para que voc√™ possa implementar a sincroniza√ß√£o de hor√°rio para um aplicativo espec√≠fico. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O pr√≥prio padr√£o IEEE 1588v2 descreve apenas um perfil - o ‚ÄúPerfil Padr√£o‚Äù. Todos os outros perfis s√£o criados e descritos por v√°rias organiza√ß√µes e associa√ß√µes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, o Power Profile ou PTPv2 Power Profile foi criado pelo Comit√™ de Retransmiss√£o de Sistemas de Pot√™ncia e pelo Comit√™ de Subesta√ß√£o da Sociedade de Energia e Energia IEEE. O perfil em si √© chamado IEEE C37.238-2011.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O perfil descreve que o PTP pode ser transmitido:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Somente atrav√©s de redes L2 (ou seja, Ethernet, HSR, PRP, n√£o IP).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As mensagens s√£o transmitidas apenas pela lista de distribui√ß√£o Multicast.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O mecanismo de medi√ß√£o de atraso de pares √© usado como um mecanismo de medi√ß√£o de atraso.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O dom√≠nio padr√£o √© 0, o dom√≠nio recomendado √© 93. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A filosofia de cria√ß√£o do C37.238-2011 era o desejo de reduzir o n√∫mero de recursos opcionais e deixar apenas as fun√ß√µes necess√°rias para uma intera√ß√£o confi√°vel entre dispositivos e aumentar a estabilidade do sistema. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, a frequ√™ncia de transmiss√£o da mensagem √© determinada: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wc/gp/z9/wcgpz9du_jejtkxidtptsh9x53i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De fato, apenas um par√¢metro est√° dispon√≠vel para sele√ß√£o - o tipo do rel√≥gio principal (est√°gio √∫nico ou dois est√°gios). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A precis√£o n√£o deve ser superior a 1 Œºs. </font><font style="vertical-align: inherit;">Em outras palavras, um m√°ximo de 15 rel√≥gios transparentes ou tr√™s horas limite podem estar contidos em um caminho de sincroniza√ß√£o.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/et/zp/y0/etzpy01l2mtcewn9mxik3wyztrq.png"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt495904/index.html">Uma epidemia pode ser prevista?</a></li>
<li><a href="../pt495908/index.html">O caminho para a recompensa</a></li>
<li><a href="../pt495910/index.html">Instalando o ROS em uma imagem IMG de placa √∫nica do Ubuntu</a></li>
<li><a href="../pt495912/index.html">Adesivos de repeti√ß√£o inteligente</a></li>
<li><a href="../pt495918/index.html">Como reproduzir som realista em jogos de computador e VR e por que √© dif√≠cil</a></li>
<li><a href="../pt495924/index.html">Por que √© t√£o dif√≠cil criar um bom modelo de distribui√ß√£o COVID-19?</a></li>
<li><a href="../pt495926/index.html">Estamos escrevendo firmware para a TI cc2530 no Z-Stack 3.0 para rel√© Zigbee Sonoff BASICZBR3 com sensor ds18b20</a></li>
<li><a href="../pt495932/index.html">Qual √© o significado oculto dos autores no Guia SCRUM. Parte 1. Sobre o processo</a></li>
<li><a href="../pt495934/index.html">DataGovernan√ßa em casa</a></li>
<li><a href="../pt495938/index.html">Uma sele√ß√£o de artigos sobre aprendizado de m√°quina: casos, guias e estudos para mar√ßo de 2020</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>