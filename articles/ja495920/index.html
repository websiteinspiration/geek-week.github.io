<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏽‍🤝‍👨🏼 👩🏽‍🏭 📿 PTPv2時間同期プロトコルの実装の詳細 😯 👩🏽‍🤝‍👨🏿 😽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="はじめに
 
 電力業界で「デジタル変電所」を構築するコンセプトでは、1μsの精度で同期する必要があります。金融取引にもマイクロ秒の精度が必要です。これらのアプリケーションでは、NTP時刻の精度はもはや十分ではありません。
 
 IEEE 1588v2標準で説明されているPTPv2同期プロトコルでは...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>PTPv2時間同期プロトコルの実装の詳細</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/phoenix_contact/blog/495920/"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はじめに</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
電力業界で「デジタル変電所」を構築するコンセプトでは、1μsの精度で同期する必要があります。</font><font style="vertical-align: inherit;">金融取引にもマイクロ秒の精度が必要です。</font><font style="vertical-align: inherit;">これらのアプリケーションでは、NTP時刻の精度はもはや十分ではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IEEE 1588v2標準で説明されているPTPv2同期プロトコルでは、数十ナノ秒の同期精度が可能です。</font><font style="vertical-align: inherit;">PTPv2を使用すると、L2およびL3ネットワーク経由で同期パケットを送信できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PTPv2が使用される主な領域は次のとおりです。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パワー工学;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">制御および測定機器;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">軍事産業複合体;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テレコム</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">金融部門。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この投稿では、PTPv2同期プロトコルのしくみについて説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちはより多くの業界経験を持っているため、エネルギーアプリケーションでこのプロトコルに遭遇することがよくあります。つきましては、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エネルギー</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に着目したレビューをさせていただきます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">なぜ必要なのですか？</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
現在、PJSC RossetiのSTO 34.01-21-004-2019およびPJSC FGC UESのSTO 56947007-29.240.10.302-2020には、PTPv2を介した時間同期を確保するプロセスバスの編成に関する要件が含まれています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、リレー保護端子と測定デバイスがプロセスバスに接続されており、プロセスバスを通じていわゆるSVストリーム（マルチキャストストリーム）を使用して電流と電圧の瞬時値を送信するためです。</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リレー保護端子は、これらの値を使用して接続保護を実装します。長期にわたる測定の精度が低い場合、一部の保護が誤って機能する可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、絶対選択性の保護は、「弱い」時間同期の犠牲になる可能性があります。多くの場合、そのような防御の論理は2つの値の比較に基づいています。値が十分に大きな値に分かれると、保護がトリガーされます。これらの値が1 msの精度で測定された場合、1μsの精度で測定すると、値が実際に正常である場合に大きな差を得ることができます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PTPバージョン</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PTPプロトコルは、もともと2002年にIEEE 1588-2002標準で記述され、「ネットワーク化された測定および制御システム用の高精度クロック同期プロトコルの標準」と呼ばれていました。</font><font style="vertical-align: inherit;">2008年に、PTPバージョン2を説明する更新されたIEEE 1588-2008標準がリリースされました。このバージョンのプロトコルでは、精度と安定性が向上しましたが、プロトコルの最初のバージョンとの下位互換性は維持されませんでした。</font><font style="vertical-align: inherit;">また、2019年には、PTP v2.1を説明するバージョンのIEEE 1588-2019規格がリリースされました。</font><font style="vertical-align: inherit;">このバージョンは、PTPv2にマイナーな改善を追加し、PTPv2との下位互換性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
言い換えると、バージョンを次の図に示します。</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PTPv1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（IEEE 1588-2002）</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PTPv2 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（IEEE 1588-2008）</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PTPv2.1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（IEEE 1588-2019）</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PTPv1（IEEE 1588-2002）</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非互換</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非互換</font></font><br>
</td>
</tr>
<tr>
<td>PTPv2 (IEEE 1588-2008)<br>
</td>
<td><br>
</td>
<td> — </td>
<td><br>
</td>
</tr>
<tr>
<td>PTPv2.1 (IEEE 1588-2019)<br>
</td>
<td><br>
</td>
<td><br>
</td>
<td> — </td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、いつものように、ニュアンスがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PTPv1とPTPv2の間の非互換性は、PTPv1をサポートするデバイスがPTPv2で実行されている正確なクロックから同期できないことを示唆しています。同期には異なるメッセージ形式を使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、同じネットワーク上でPTPv1を備えたデバイスとPTPv2を備えたデバイスを組み合わせることができます。これを行うために、一部の製造元では、ボーダークロックのポートでプロトコルバージョンを選択できます。つまり、境界クロックはPTPv2を介して同期でき、同時にPTPv1とPTPv2の両方によって境界クロックに接続されている他のクロックを同期できます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PTPデバイス。何がどのように違うのですか？</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
IEEE 1588v2規格は、いくつかのタイプのデバイスについて説明しています。それらはすべて表に示されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デバイスは、PTPを使用してLAN経由で相互に通信します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PTPデバイスはクロックと呼ばれます。</font><font style="vertical-align: inherit;">すべての時計は、グランドマスター時計から正確な時間を取ります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
時計には次の5種類があります。</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グランドマスター時計</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正確な時刻の主な情報源。</font><font style="vertical-align: inherit;">多くの場合、GPSを接続するためのインターフェースを備えています。</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">普通の時計</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マスター（マスタークロック）またはスレーブ（マスタークロック）のシングルポートデバイス</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">先行時間（マスター）</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これらは、他のクロックが同期される正確な時刻のソースです。</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スレーブクロック（スレーブ）</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マスタークロックから同期するエンドデバイス</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">境界時計</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マスターまたはスレーブになることができる複数のポートを持つデバイス。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、この時計は上位のマスタークロックから同期し、下位のスレーブクロックを同期できます。</font></font><br>
</td>
</tr>
<tr>
<td>End-to-end Transparent Clock ( ,    End-to-End)<br>
</td>
<td>   ,      ,  .    PTP   . <br>
<br>
       PTP-. <br>
<br>
                .<br>
 </td>
</tr>
<tr>
<td>Peer-to-Peer Transparent Clock ( ,    Peer-to-Peer)<br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マスタークロックでもスレーブでもない複数のポートを持つデバイス。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2時間の間にPTPデータを送信します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データを送信するとき、透過クロックはすべてのPTPメッセージSyncとFollow_Upを修正します（これらの詳細については以下で説明します）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
訂正は、送信デバイスで送信された遅延パケットとデータチャネルでの遅延の調整のフィールドに追加することで実現されます。</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">管理ノード</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">他の時計を構成および診断するデバイス</font></font><br>
</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マスタークロックとスレーブクロックは、PTPメッセージのタイムスタンプを使用して同期されます。</font><font style="vertical-align: inherit;">PTPプロトコルには2種類のメッセージがあります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">イベントメッセージは、メッセージの送信時と受信時のタイムスタンプの生成を含む同期メッセージです。</font></font></li>
<li>General Messages –      ,        </li>
</ul><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td>Event Messages<br>
</td>
<td>General Messages<br>
</td>
</tr>
<tr>
<td>Sync<br>
Delay_Req<br>
Pdelay_Req<br>
Pdelay_Resp<br>
</td>
<td>Announce<br>
Follow_Up<br>
Delay_Resp<br>
Pdelay_Resp_Follow_Up<br>
Management<br>
Signaling<br>
</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、すべてのタイプのメッセージをより詳細に検討します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同期の主な問題</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ローカルネットワークを介して同期パケットを送信すると、スイッチ上とデータ送信チャネル内で遅延が発生します。</font><font style="vertical-align: inherit;">どのスイッチでも約10μsの遅延が発生しますが、これはPTPv2では許容できません。</font><font style="vertical-align: inherit;">結局のところ、最終的なデバイスで1μsの精度を得る必要があります。</font><font style="vertical-align: inherit;">（これはエネルギーに関してです。他のアプリケーションではより高い精度が必要な場合があります。）</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IEEE 1588v2では、時間遅延を記録して調整できるいくつかの操作アルゴリズムについて説明しています。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">運用アルゴリズム</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
通常の運用では、プロトコルは2つのフェーズで動作します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フェーズ1-「先行クロック-スレーブクロック」階層の確立。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フェーズ2-エンドツーエンドメカニズムまたはピアツーピアを使用したクロック同期。</font></font></li>
</ul><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フェーズ1-マスタースレーブ階層の設定</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
通常または境界クロックの各ポートには、特定の数の状態（スレーブクロックとマスタークロック）があります。この規格は、これらの状態間の遷移アルゴリズムについて説明しています。プログラミングでは、このようなアルゴリズムはステートマシンまたはステートマシンと呼ばれます（詳細はWikiを参照）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このステートマシンは、2時間の接続時にマスターを設定するために、Best Master Clock Algorithm（BMCA）を使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアルゴリズムにより、上位のグランドマスター時計がGPS信号を失ったり、ネットワークから切断したりしたときに、時計がグランドマスター時計の義務を負うことができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の図に、BMCAに基づく状態遷移を簡単に示します。</font></font><br>
<img src="https://habrastorage.org/webt/uy/hz/h6/uyhzh63gb0jt63bppsuuhcllwmu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「ワイヤ」の反対側のクロックに関する情報は、特別なメッセージ（アナウンスメッセージ）で送信されます。</font><font style="vertical-align: inherit;">この情報が受信されると、ステートマシンアルゴリズムが処理し、どちらのクロックが優れているかを比較します。</font><font style="vertical-align: inherit;">最高の時計のポートが主要な時計になります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
単純な階層を下の図に示します。</font><font style="vertical-align: inherit;">パス1、2、3、4、5には透過クロック（透過クロック）が含まれている可能性がありますが、「先行クロック-スレーブクロック」という階層の確立には関与しません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kj/md/ci/kjmdcibg-ls2rflwu6qtur-0osg.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フェーズ2-通常クロックと境界クロックの同期</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
階層「リーディングアワー-スレーブ時間」が確立された直後</font><b><font style="vertical-align: inherit;">に、通常の境界クロック</font></b><font style="vertical-align: inherit;">の同期フェーズが始まります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同期のために、マスタークロックはタイムスタンプを含むメッセージをスレーブクロックに送信します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
先行時間は次のいずれかです。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">単段;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">二段階。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同期用の単一ステージクロックは、1つの同期メッセージを送信します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2ステージクロックは、同期のために2つのメッセージ（SyncとFollow_Up）を使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同期フェーズには2つのメカニズムを使用できます。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要求/応答メカニズムの遅延。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ピア遅延測定メカニズム。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、これらのメカニズムを最も単純なケース、つまり透明な時計を使用しない場合について検討します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要求/応答メカニズム</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
の</font><font style="vertical-align: inherit;">遅延</font><font style="vertical-align: inherit;">このメカニズムには2つのステップがあります。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マスタークロックとスレーブ間のメッセージ送信の遅延の測定。</font><font style="vertical-align: inherit;">これは、遅延要求応答メカニズムを使用して実行されます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正確な時刻のずれを修正します。</font></font></li>
</ol><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">遅延測定</font></font></i><br>
<img src="https://habrastorage.org/webt/zj/hp/sa/zjhpsak259vihrylfiujf5vj2sm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
t1-先行クロックによる同期メッセージ送信時間。 t2-スレーブクロックによる同期メッセージ受信時間。 t3-リクエスト送信時間の遅延（Delay_Req）スレーブ時間; t4-先行クロックによるDelay_Req受信時間。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スレーブクロックが時間t1、t2、t3、およびt4を知っている場合、同期メッセージ（tmpd）の送信における平均遅延を計算できます。これは次のように計算されます</font></font><br>
<br>
<img src="https://habrastorage.org/webt/e6/cz/qx/e6czqxjr1wen8eld_z4y16joa4k.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。SyncおよびFollow_Upメッセージを送信するときに、マスターからスレーブへの時間遅延が計算されます-t-ms。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Delay_ReqおよびDelay_Respメッセージを送信するとき、スレーブからマスターまでの時間遅延t-smが計算されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これら2つの値の間に何らかの非対称性が生じると、正確な時刻のずれの修正にエラーが表示されます。エラーは、計算された遅延が遅延t-msとt-smの平均であるという事実によって引き起こされます。遅延が互いに等しくない場合、時間を不正確に調整します。</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正確な時刻のオフセットの修正</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
先行クロックとスレーブクロック間の遅延がわかった後、スレーブクロックは時刻修正を実行します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/a7/gv/qz/a7gvqzykdjxtg6nm5rcqhcqmyzs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スレーブクロックは、SyncメッセージとオプションのFollow_Upメッセージを使用して、マスタークロックからスレーブにパケットを送信するときの正確な時間オフセットを計算します。シフトは次の式を使用して計算されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/n1/rk/nw/n1rknwzr-r0qio-uf1a9iiqd_9o.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ピア遅延測定メカニズム</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
このメカニズムも2つのステップを使用して同期します。</font></font><br>
<br>
<ol>
<li>         .     peer delay mechanism.</li>
<li>   .</li>
</ol><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ピアツーピア</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
遅延</font><i><font style="vertical-align: inherit;">測定</font></i><font style="vertical-align: inherit;">ピアツーピア</font><i><font style="vertical-align: inherit;">対応デバイス間の遅延は</font></i><font style="vertical-align: inherit;">、次のメッセージを使用して測定されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/eo/0o/y2/eo0oy26vhwksm1rel2znic_q8rs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ポート1が時間t1、t2、t3、およびt4を知っている場合、ポート1は平均遅延（tmld ）これは次の式を使用して計算されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/a6/3r/mc/a63rmc4ehosk81dvktfv4prevt0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、ポートはこの値を使用して、このデバイスを通過する各SyncメッセージまたはオプションのFollow_Upメッセージの調整フィールドを計算します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
合計遅延は、このデバイスを介して送信するときの遅延、データチャネルを介して送信するときの平均遅延、および上位のデバイスに含まれるこのメッセージにすでに含まれている遅延の合計に等しくなります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メッセージPdelay_Req、Pdelay_Resp、およびオプションのPdelay_Resp_Follow_Upを使用すると、マスターからスレーブ、およびスレーブからマスター（循環）への遅延を取得できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これら2つの値の非対称性により、正確な時間オフセット補正エラーが発生します。</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正確な時間のオフセットの修正</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/m6/do/ku/m6dokuldnfjmqscwyrtin2tvjiu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
スレーブクロックは、SyncメッセージとオプションのFollow_Upメッセージを使用して、先行クロックからスレーブにパケットを送信するときの正確な時間のオフセットを計算します。シフトは次の式に従って計算されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ub/ui/xk/ubuixkpfmzizo7ilzkdgyfwvh8c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
利点ピアツーピア調整-各SyncまたはFollow_Upメッセージの時間遅延は、ネットワーク上で送信されるときに計算されます。したがって、伝送経路の変更は、調整の精度にまったく影響を与えません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このメカニズムを使用する場合、時間の同期では、基本的な交換で行われるように、同期パケットが通過するパスの時間遅延を計算する必要はありません。それら。 Delay_ReqおよびDelay_Respメッセージは送信されません。この方法では、マスタークロックとフォロワー間の遅延は、各SyncまたはFollow_Upメッセージの調整フィールドで単純に合計されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別の利点は、駆動クロックがDelay_Reqメッセージを処理する必要から解放されることです。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">透明時計の動作モードしたがって</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
、簡単な例を検討しました。次に、同期パスにスイッチが表示されているとします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PTPv2をサポートしないスイッチを使用する場合、同期パケットはスイッチで約10μs遅延されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IEEE 1588v2の用語でPTPv2をサポートするスイッチは、透過クロックと呼ばれます。</font><font style="vertical-align: inherit;">透過クロックは、先行クロックと同期されておらず、「先行クロック-スレーブクロック」階層には参加していませんが、同期メッセージを送信するときに、メッセージがどれだけ遅延しているかを覚えています。</font><font style="vertical-align: inherit;">これにより、時間遅延を調整できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
透明な時計は次の2つのモードで機能します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">端から端まで。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ピアツーピア。</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エンドツーエンド（E2E）</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/cb/ev/vy/cbevvyylfmfgq9jgwm_jiuxvkjw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
トランスペアレントE2Eウォッチは、同期メッセージと付随するFollow_Upメッセージをすべてのポートに送信します。任意のプロトコル（RSTPなど）によってブロックされているものも含まれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スイッチは、ポートで同期パケット（Follow_Up）が受信されたときと、ポートから送信されたときのタイムスタンプを記憶しています。これらの2つのタイムスタンプに基づいて、メッセージのスイッチ処理時間が計算されます。標準では、この時間は滞留時間と呼ばれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
処理時間は、Syncメッセージ（1ステージクロック）またはFollow_Up（2ステージクロック）のcorrectionFieldフィールドに追加されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hv/4q/rj/hv4qrjcuzer2hejocmtzitnntma.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E2Eトランスペアレントウォッチは、スイッチを通過するSyncおよびDelay_Reqメッセージの処理時間を測定します。ただし、リーディングクロックとスレーブクロックの間の時間遅延は、遅延要求/応答メカニズムを使用して計算されることを理解することが重要です。マスタークロックが変化した場合、またはマスタークロックからスレーブへのパスが変化した場合、遅延が再度測定されます。これにより、ネットワークが変更された場合の移行時間が長くなります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sw/im/q7/swimq7rpv2n24wyd8erbsvf420s.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トランスペアレントP2Pクロックは、スイッチによるメッセージの処理時間を測定することに加えて、隣接ノードの遅延測定メカニズムを使用して、データチャネルの最も近い近傍への遅延を測定します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
遅延は、プロトコル（RSTPなど）によってブロックされているチャネルを含め、両方向の各チャネルで測定されます。</font><font style="vertical-align: inherit;">これにより、グランドマスタークロックまたはネットワークトポロジが変更された場合に、同期パスの新しい遅延をすぐに計算できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SyncまたはFollow_Upメッセージを送信すると、スイッチの処理時間と遅延時間が累積されます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PTPv2スイッチのサポートのタイプ</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
スイッチは</font><b><font style="vertical-align: inherit;">PTPv2をサポート</font></b><font style="vertical-align: inherit;">できます。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プログラム的に;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハードウェア。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PTPv2プロトコルのソフトウェア実装では、スイッチはファームウェアにタイムスタンプを要求します。</font><font style="vertical-align: inherit;">問題は、ファームウェアが周期的に動作し、現在のサイクルが完了するまで待機し、リクエストを処理に移す必要があり、次のサイクルの期限が切れると、タイムスタンプが発行されることです。</font><font style="vertical-align: inherit;">これにはすべて時間がかかり、PTPv2ソフトウェアサポートがない場合ほど重要ではありませんが、遅延が発生します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PTPv2のハードウェアサポートのみが、必要な精度を維持できます。</font><font style="vertical-align: inherit;">この場合、タイムスタンプの発行は、ポートにインストールされている特別なASICによって実行されます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メッセージ形式</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
すべてのPTPメッセージは、次のフィールドで構成されています。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヘッダー-34バイト。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本文-サイズはメッセージのタイプによって異なります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サフィックス-オプション。</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/ae/9l/_3/ae9l_3mph3pkhb-2oi0h_ppy48u.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヘッダーヘッダー</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
フィールドは、すべてのPTPメッセージで同じです。サイズは34バイトです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Header：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yu/xs/gu/yuxsgundgrz9iyiyyfabaxt5i38.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">messageTypeフィールド</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の形式は、送信されたメッセージのタイプです。たとえば、Sync、Delay_Req、PDelay_Reqなどです。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">messageLength-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヘッダー、本文、サフィックスを含むPTPメッセージのフルサイズが含まれます（ただし、フィルバイトは除きます）。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">domainNumber</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> —メッセージが属するPTPドメインを決定します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドメイン</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、いくつかの異なるクロックを1つの論理グループにまとめ、1つの先行クロックから同期させますが、必ずしも別のドメインに属するクロックと同期させる必要はありません。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flags-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このフィールドには、メッセージのステータスを識別するためのさまざまなフラグが含まれています。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CorrectionField</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ナノ秒単位の遅延時間が含まれます。遅延時間には、透過クロックによる伝送遅延と、ピアツーピアモードを使用する場合のチャネルによる伝送遅延が含まれます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourcePortIdentity-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このフィールドには、このメッセージが最初に送信されたポートに関する情報が含まれます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sequenceID-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">個々のメッセージの識別番号が含まれています。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">controlField-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アーティファクトフィールド=）標準の最初のバージョンから残っており、このメッセージのタイプに関する情報が含まれています。本質的にmessageTypeと同じですが、オプションは少なくなります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">logMessageInterval-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このフィールドは、メッセージのタイプによって決定されます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">体</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のように、メッセージにはいくつかのタイプがあります。これらのタイプについて以下に説明します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アナウンスメッセージアナウンス</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メッセージは、同じドメイン内の他の時計に設定について「伝える」ために使用されます。このメッセージでは、「Leading Clock-Slave Clock」という階層を設定できます。</font></font><br>
<img src="https://habrastorage.org/webt/-i/zs/dh/-izsdhnvkookhpjtrdrqx2myimy.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同期</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メッセージ同期メッセージ（Sync）はマスタークロックによって送信され、同期メッセージが作成されたときのマスタークロックの時刻が含まれます。先行クロックが2ステップの場合、同期メッセージのタイムスタンプは0に設定され、現在のタイムスタンプはペアのFollow_Upメッセージで送信されます。 Syncメッセージは、両方の遅延測定メカニズムに使用されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メッセージはマルチキャストを使用して送信されます。オプションでユニキャストを使用できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sc/pp/1f/scpp1fns1uuyccw9bucbvghesgo.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Delay_Req</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メッセージ</font><b><font style="vertical-align: inherit;">Delay_Req</font></b><font style="vertical-align: inherit;">メッセージのフォーマットは、</font><b><font style="vertical-align: inherit;">Sync</font></b><font style="vertical-align: inherit;">メッセージと同じです。スレーブクロックはDelay_Reqを送信します。これには、スレーブクロックによってDelay_Reqが送信された時間が含まれます。このメッセージは、遅延要求応答メカニズムでのみ使用されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メッセージはマルチキャストを使用して送信されます。オプションでユニキャストを使用できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fe/bm/r_/febmr_zz7v1dricuta5z88xmjqk.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Follow_UpメッセージFollow_Up</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メッセージは、オプションでマスタークロックによって送信され、マスターが</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Syncメッセージを</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">送信した時刻を含み</font><b><font style="vertical-align: inherit;">ます</font></b><font style="vertical-align: inherit;">。 Follow_Upメッセージは、2段階の駆動クロックによってのみ送信されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Follow_Upメッセージは、両方の遅延測定メカニズムで使用されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メッセージはマルチキャストを使用して送信されます。オプションでユニキャストを使用できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1g/42/2a/1g422aehbonsjrjjq0dwn9ceoxi.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メッセージ遅延_応答</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Delay_Respメッセージはマスタークロックによって送信されます。これには、Delay_Reqがマスタークロックによって受信された時間が含まれます。このメッセージは、遅延要求応答メカニズムでのみ使用されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メッセージはマルチキャストを使用して送信されます。オプションでユニキャストを使用できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/up/is/gz/upisgzu5d7dk0iscixogmmjciwi.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pdelay_Req</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メッセージ</font><b><font style="vertical-align: inherit;">Pdelay_Req</font></b><font style="vertical-align: inherit;">メッセージは、遅延を要求するデバイスによって送信されます。メッセージがこのデバイスのポートから送信された時刻が含まれています。 Pdelay_Reqは、隣接ノードの遅延測定メカニズムにのみ使用されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hn/km/rz/hnkmrzmcidqsawxtazho-oprpus.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pdelay_RespメッセージPdelay_Resp</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メッセージは、遅延要求を受信したデバイスによって送信されます。これには、このデバイスがPdelay_Reqメッセージを受信した時間が含まれます。 Pdelay_Respメッセージは、隣接ノードの遅延測定メカニズムにのみ使用されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kh/bb/34/khbb34wn7ujy84lldruomgaenmg.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pdelay_Resp_Follow_UpメッセージPdelay_Resp_Follow_Up</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メッセージは、遅延要求を受信したデバイスによってオプションで送信されます。</font><font style="vertical-align: inherit;">これには、このデバイスがPdelay_Reqメッセージを受信した時間が含まれます。</font><font style="vertical-align: inherit;">Pdelay_Resp_Follow_Upメッセージは、2ステージのマスタークロックによってのみ送信されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このメッセージは、タイムスタンプの代わりにランタイムにも使用できます。</font><font style="vertical-align: inherit;">実行時間は、Pdelay-Reqが受信されてからPdelay_Respが送信されるまでの時間です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pdelay_Resp_Follow_Upは、隣接ノードの遅延測定メカニズムにのみ使用されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/w7/-k/q2/w7-kq2pssesbnko10w1tmsrs9ow.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">制御メッセージ（管理メッセージ）</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PTP制御メッセージは、1つ以上のクロックと制御ノードの間で情報を転送するために必要です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/r7/xi/c0/r7xic0kvnb_yurjc53bah53f2ss.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LVに転送</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PTPメッセージは次の2つのレベルで送信できます。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネットワーク-IPデータの一部として。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンク-イーサネットフレームの一部として。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UDP over IP over Ethernetを介したPTPメッセージの送信</font></font><br>
<br>
<img src="https://habrastorage.org/webt/f7/k6/al/f7k6alykkmt_4jrstkfkad_if-4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PTP over UDP over Ethernetの</font><font style="vertical-align: inherit;">
PTP </font></font><br>
<br>
<img src="https://habrastorage.org/webt/a7/pe/wu/a7pewujvuii1chap6wppv51dh0k.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロファイルに</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、構成する必要がある多くの「柔軟な」パラメーターがあります。</font><font style="vertical-align: inherit;">例えば：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BMCAオプション。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">遅延測定メカニズム。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべての構成可能なパラメーターの間隔と初期値など</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、以前にPTPv2デバイスは相互に互換性があると述べましたが、そうではありません。対話するには、デバイスの設定が同じである必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、いわゆるPTPv2プロファイルがあります。プロファイルは、特定のアプリケーションの時間同期を実装できるように、構成された設定と特定のプロトコル制限のグループです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IEEE 1588v2標準自体は、「デフォルトプロファイル」という1つのプロファイルのみを記述しています。他のすべてのプロファイルは、さまざまな組織や団体によって作成および記述されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、電力プロファイルまたはPTPv2電力プロファイルは、IEEE Power and Energy SocietyのPower Systems Relaying CommitteeおよびSubstation Committeeによって作成されました。プロファイル自体はIEEE C37.238-2011と呼ばれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このプロファイルでは、PTPを送信できることが記述されています。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L2ネットワークのみ（IP、イーサネット、HSR、PRPなど）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メッセージはマルチキャストメーリングリストによってのみ送信されます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">遅延測定メカニズムとして、ピア遅延測定メカニズムが使用されます。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デフォルトドメインは0、推奨ドメインは93 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
です。C37.238-2011を作成する理念は、オプション機能の数を減らし、デバイス間の信頼できる相互作用に必要な機能のみを残し、システムの安定性を高めることでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、メッセージ送信の頻度も決定されます</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wc/gp/z9/wcgpz9du_jejtkxidtptsh9x53i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。実際には、選択できるパラメーターは1つだけです-先行クロックのタイプ（1ステージまたは2ステージ）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
精度は1μs以下である必要があります。</font><font style="vertical-align: inherit;">つまり、1つの同期パスに最大15の透過クロックまたは3つの境界時間を含めることができます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/et/zp/y0/etzpy01l2mtcewn9mxik3wyztrq.png"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja495904/index.html">流行は予測できますか？</a></li>
<li><a href="../ja495908/index.html">報酬への道</a></li>
<li><a href="../ja495910/index.html">UbuntuシングルボードIMGイメージへのROSのインストール</a></li>
<li><a href="../ja495912/index.html">スマートリプレイステッカー</a></li>
<li><a href="../ja495918/index.html">コンピュータゲームやVRでリアルなサウンドを再現する方法と、それが難しい理由</a></li>
<li><a href="../ja495924/index.html">優れたCOVID-19配布モデルを構築することがそれほど難しいのはなぜですか？</a></li>
<li><a href="../ja495926/index.html">ZigbeeリレーSonoff BASICZBR3（ds18b20センサー付き）のZ-Stack 3.0上のTI cc2530のファームウェアを作成しています</a></li>
<li><a href="../ja495932/index.html">SCRUMガイドで著者の隠された意味は何ですか？パート1.プロセスについて</a></li>
<li><a href="../ja495934/index.html">家庭でのDataGovernance</a></li>
<li><a href="../ja495938/index.html">機械学習に関する一連の記事：2020年3月の事例、ガイド、および研究</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>