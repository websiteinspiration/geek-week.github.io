<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏽‍🔧 👦🏼 👶🏿 CDNを作成してカスタマイズする 🤜🏼 🕙 🤕</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="コンテンツ配信ネットワーク（CDN）は、サイトやアプリケーションで主に静的要素の読み込みを高速化するために使用されます。これは、地理的に異なる地域にあるCDNサーバー上のファイルをキャッシュするために発生します。 CDNを介してデータを要求すると、ユーザーは最も近いサーバーからデータを受け取ります。...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>CDNを作成してカスタマイズする</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/496910/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテンツ配信ネットワーク（CDN）は、サイトやアプリケーションで主に静的要素の読み込みを高速化するために使用されます。これは、地理的に異なる地域にあるCDNサーバー上のファイルをキャッシュするために発生します。 CDNを介してデータを要求すると、ユーザーは最も近いサーバーからデータを受け取ります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのコンテンツ配信ネットワークの操作と機能の原理はほぼ同じです。 CDNサーバーは、ファイルのダウンロード要求を受信すると、元のサーバーからファイルを取得してユーザーに提供すると同時に、一定期間キャッシュします。後続のリクエストはすべてキャッシュから応答されます。すべてのCDNには、ファイルのプリロード、キャッシュのクリア、保存期間の設定などのオプションがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
なんらかの理由で、独自のコンテンツ配信ネットワークを編成する必要がある場合があります。それから、別の自転車の構築をお手伝いします。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qf/rw/ss/qfrwss0k86-bdbbbpztdh3d0nkq.jpeg"><br>
<font color="#B1B1B1"><sup><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソース：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pikisuperstarによって作成されたインフォグラフィックベクトル-www.freepik.com</font></font></a></i></sup></font><a name="habracut"></a><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">独自のCDNが必要な場合</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
独自のCDNを開始することが理にかなっている場合を検討してください。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あなたがお金を節約したいとき、そして</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BunnyCDNの</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ような安価なCDNを使用しているときでもランニングコスト</font><font style="vertical-align: inherit;">は月に数百ドルです</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーとチャネルに永続的なキャッシュまたはネイバーなしのキャッシュを取得する場合</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必要な地域では、CDNサービスは存在のポイントを持っていません</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必要な特別なコンテンツ配信設定</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本番サーバーのユーザーの近くに配置することで、動的コンテンツの配信を加速したい</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サードパーティのCDNサービスがユーザーの行動に関する情報を違法に収集または使用したり（GDPRに準拠していないサービスの場合）、その他の違法行為を行ったりするおそれがある</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他のほとんどの場合、既存の既製のソリューションを使用することをお勧めします。</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実行する必要があるもの</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
独自の自律システム（AS）があれば、すばらしいことです。</font><font style="vertical-align: inherit;">これにより、複数のサーバーに同じIPを割り当て</font><font style="vertical-align: inherit;">、ネットワークレベルで</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この指示に従って</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーを最も近い</font><font style="vertical-align: inherit;">サーバー</font><font style="vertical-align: inherit;">に誘導できます。</font><font style="vertical-align: inherit;">アドレスのブロック/ 24を使用しても、コンテンツ配信ネットワークを構築できることは言うまでもありません。</font><font style="vertical-align: inherit;">一部のサーバープロバイダーでは、利用可能なすべての地域で使用できるアナウンスを作成できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IPアドレスのブロックの幸せな所有者でない場合、単純なCDNを実行するには、次のものが必要です。</font></font><br>
<br>
<ul>
<li>   </li>
<li>     .     ,   </li>
<li>geoDNS .    ,   ,     </li>
</ul><br>
<br>
<h2>    </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ドメイン登録を使用すると、すべてが簡単です-あらゆるレジストラのあらゆるゾーンに登録します。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.namedomain.comの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ようなサブドメインをCDNに使用することもでき</font><font style="vertical-align: inherit;">ます。実際の例では、そうします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サーバーの注文については、ユーザーの対象ユーザーがいる地域や国でレンタルする必要があります。プロジェクトが大陸間である場合は、世界中のサーバーをすぐに提供するホスティングプロバイダーを選択すると便利です。例：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OVH</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LEASEWEB、</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100TB</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">専用サーバのため、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vultr</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DigitalOcean</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仮想、クラウドのための*。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのプライベートCDNでは、異なる大陸に3つの仮想サーバーを注文します。で</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vultr</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーで</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">月額5ドル</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25 GBのSSD</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スペースと</font><b><font style="vertical-align: inherit;">1 </font></b><b><font style="vertical-align: inherit;">TB </font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のトラフィック</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を獲得し</font><b><font style="vertical-align: inherit;">ます</font></b><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">インストールするときに、最新のDebianを選択します。</font><font style="vertical-align: inherit;">サーバー：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jy/di/f1/jydif1phgm45zpwjbety-fw_d-g.png" width="30"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フランクフルト</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ip：199.247.18.199 </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uk/wh/v1/ukwhv1lwwsr8snoiqc_yyzquo5s.png" width="30"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シカゴ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ip：149.28.121.123 </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3f/qk/6e/3fqk6endcgzeybs-yjlkkphep50.png" width="30"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シンガポール</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ip：157.230.240.216 </font></font><br>
<br>
<font color="#B1B1B1"><sup><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* VultrとDigitalOceanは、支払い方法を追加した直後に、記事のリンクを使用して登録されたユーザーに100ドルのローンを約束します。</font><font style="vertical-align: inherit;">著者はこれからも小さな褒め言葉を受け取ります。これは彼にとって今非常に重要です。</font><font style="vertical-align: inherit;">ご理解ください。</font></font></i></sup></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">geoDNSを構成する</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、ユーザーがCDNドメインまたはサブドメインにアクセスすると、目的の（ユーザーに最も近い）サーバーに誘導されるため、geoDNS機能を備えたDNSサーバーが必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
geoDNSの原理と手順は次のとおりです。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DNS要求を送信したクライアントのIP、またはクライアント要求の処理に使用される再帰DNSサーバーのIPを定義します。</font><font style="vertical-align: inherit;">これらの再帰サーバーは通常DNSプロバイダーです。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IPクライアントによって彼の国または地域を知っています。</font><font style="vertical-align: inherit;">これには、GeoIPベースが使用されますが、今日ではその多くが使用されています。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">無料のオプション</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">がいくつかあり</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クライアントの場所に応じて、最も近いCDNサーバーのIPアドレスを彼に与えます。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あなたはでき</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">構築</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> geoDNSが機能してDNSサーバを</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">自分で</font></a><font style="vertical-align: inherit;">、世界と周りのDNSサーバのネットワークと既製のソリューションを使用することをお勧めし</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エニーキャスト</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ボックスのうち：</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">月額</font></font></b></a><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> $ 9.95</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">からの</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"> louDNS</font></b></a><font style="vertical-align: inherit;">、GeoDNS関税、デフォルトでは1つのDNSフェイルオーバー</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zilore</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">月額25ドル</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から</font><font style="vertical-align: inherit;">、DNSフェイルオーバーが有効</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amazon Route 53は</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> $ 35 /月</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から</font><b><font style="vertical-align: inherit;"> 5000万の</font></b><font style="vertical-align: inherit;">ネットgeoリクエストに対応しています。</font><font style="vertical-align: inherit;">DNSフェイルオーバーは別途課金されます</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DNS</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> $ 125 /</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">月</font><font style="vertical-align: inherit;">から</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;">簡単に作成さ</font></b></a><font style="vertical-align: inherit;">れ</font><font style="vertical-align: inherit;">、10のDNSフェイルオーバーがあります</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloudflare</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、エンタープライズレートで利用可能なジオステアリング機能</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
geoDNSを注文するときは、関税に含まれる要求の数に注意を払い、ドメインへの実際の呼び出し数が予想を数倍超える可能性があることを考慮に入れる必要があります。何百万ものスパイダー、スキャナー、スパマー、その他の悪霊が精力的に働いています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほとんどすべてのDNSサービスには、CDNサービスを構築するために不可欠なDNSフェイルオーバーが含まれています。これを使用して、サーバーの監視を構成し、生命の兆候がない場合に、非稼働サーバーアドレスをDNS応答のバックアップサーバーに自動的に置き換えることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのCDNを構築するために、我々は、使用する</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ClouDNS</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、GeoDNS関税を。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ドメインを示す新しいDNSゾーンをアカウントに追加します。</font><font style="vertical-align: inherit;">サブドメインでCDNを構築し、メインドメインが既に使用されている場合は、ゾーンを追加した直後に、既存の有効なDNSレコードを追加することを忘れないでください。</font><font style="vertical-align: inherit;">次のステップは、CDNドメイン/サブドメイン用にいくつかのAレコードを作成することです。それぞれのレコードは、設定したリージョンに適用されます。</font><font style="vertical-align: inherit;">大陸または国をリージョンとして指定できます。サブリージョンは、米国およびカナダで使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今回のケースでは、CDNは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブドメインで発生し</font><font style="vertical-align: inherit;">ます。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sayt.in</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ゾーンを追加して</font><font style="vertical-align: inherit;">、サブドメインの最初のAレコードを作成し、北米全体をシカゴのサーバーに</font><i><font style="vertical-align: inherit;">転送</font></i><font style="vertical-align: inherit;">します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/0x/z_/zt/0xz_ztazcrmz8wqlruylrz4iqh4.png" width="500"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他のリージョンについても繰り返し、デフォルトのリージョンに対して1つのエントリを作成することを忘れないでください。</font><font style="vertical-align: inherit;">結果は次のとおりです。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/io/js/zy/iojszykgez_pu7wf3mzd8lvmffa.jpeg" width="600"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スクリーンショットの最後のデフォルトレコードは、すべての未確定地域（これはヨーロッパ、アフリカ、衛星インターネットユーザーなど）がフランクフルトのサーバーに送信されることを意味します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで基本的なDNS構成が完了しました。</font><font style="vertical-align: inherit;">ドメインレジストラーのWebサイトにアクセスして、現在のドメインNSをClouDNSによって発行されたNSに置き換える必要があります。</font><font style="vertical-align: inherit;">NSが更新される間、サーバーを準備します。</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSL証明書をインストールする</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのCDNはHTTPSで動作するので、ドメインまたはサブドメインのSSL証明書をすでに持っている場合は、それらをすべてのサーバーにアップロードします。たとえば、ディレクトリ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ etc / ssl / yourdomain /</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
証明書がない場合は、Let's Encryptから無料で入手できます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ACMEシェルスクリプトは</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これに最適です</font><font style="vertical-align: inherit;">。クライアントは便利で簡単に設定でき、最も重要なこととして、ClouDNSからAPIを介してDNSのドメイン/サブドメインを検証できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
acme.shは、1つのサーバー（ヨーロッパの199.247.18.199）にのみインストールし、そこから証明書が他のすべてのサーバーにコピーされます。インストールするには、次のようにします。</font></font><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# wget -O - https://get.acme.sh | bash; source ~/.bashrc</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スクリプトのインストール中に、CRONタスクが作成され、参加せずに証明書をさらに更新します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
証明書を発行するときのドメイン検証は、APIを使用してDNSを使用して実行されるため、Reseller APIメニューのClouDNS個人アカウントで、新しいユーザーAPIを作成し、パスワードを設定する必要があります。</font><font style="vertical-align: inherit;">結果のパスワード付きのauth-idは、ファイル</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">〜/ .acme.sh / dnsapi / dns_cloudns.shに</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">書き込まれます</font><font style="vertical-align: inherit;">（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dns_clou </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dns.shファイル</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と混同しないでください</font><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">コメントを外して編集する行は次のとおりです。</font></font><br>
<br>
<pre><code class="plaintext hljs">CLOUDNS_AUTH_ID=&lt;auth-id&gt;<font></font>
CLOUDNS_AUTH_PASSWORD="&lt;&gt;"<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、</font><b><font style="vertical-align: inherit;">cdn.sayt.inの</font></b><font style="vertical-align: inherit;"> SSL証明書を</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要求します</font></font></b><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# acme.sh --issue --dns dns_cloudns -d cdn.sayt.in --reloadcmd "service nginx reload"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
将来のパラメーターでは、将来の証明書の有効期間が更新されるたびにWebサーバーの構成を自動的に再読み込みするコマンドを指定しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
証明書を取得するプロセス全体には最大2分かかります。中断しないでください。</font><font style="vertical-align: inherit;">ドメイン検証エラーが発生した場合は、コマンドを再実行してください。</font><font style="vertical-align: inherit;">最後に、証明書がアップロードされた場所を確認します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/l6/qv/16/l6qv16mchqhhaokxuvbwmnnw6xu.png" width="952"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのパスを覚えておいてください。他のサーバーに証明書をコピーするときや、Webサーバーの設定でこれらのパスを指定する必要があります。</font><font style="vertical-align: inherit;">Nginx設定ファイルの再読み込みのエラーには注意を払っていません-完全に設定されたサーバーでは、証明書を更新するときに表示されません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SSL経由で残っているのは、ファイルへのパスを保存して、受信した証明書を他の2つのサーバーにコピーすることだけです。</font><font style="vertical-align: inherit;">それぞれに同じディレクトリを作成し、コピーを作成します。</font></font><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# mkdir -p /root/.acme.sh/cdn.sayt.in/<font></font>
root@cdn:~# scp -r root@199.247.18.199:/root/.acme.sh/cdn.sayt.in/* /root/.acme.sh/cdn.sayt.in/<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
証明書の更新が定期的に行われるように、次のコマンドを使用して両方のサーバーで毎日CRONタスクを作成します。</font></font><br>
<blockquote><code>scp -r root@199.247.18.199:/root/.acme.sh/cdn.sayt.in/* /root/.acme.sh/cdn.sayt.in/ &amp;&amp; service nginx reload</code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、リモートソースサーバーへのアクセスは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キー</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">設定</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">する</font></a><font style="vertical-align: inherit;">必要があります</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">パスワードを入力せずに。</font><font style="vertical-align: inherit;">それを行うことを忘れないでください。</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nginxをインストールして構成する</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
静的コンテンツを返すには、キャッシングプロキシサーバーとして構成されたNginxを使用します。</font><font style="vertical-align: inherit;">パッケージのリストを更新し、3つすべてのサーバーにインストールします。</font></font><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# apt update<font></font>
root@cdn:~# apt install nginx</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デフォルトの代わりに、以下のスポイラーの設定を使用してください：</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nginx.conf</font></font></b><div class="spoiler_text"><pre><code class="nginx hljs"><span class="hljs-attribute">user</span> www-data;
<span class="hljs-attribute">worker_processes</span> auto;
<span class="hljs-attribute">pid</span> /run/nginx.pid;<font></font>
<font></font>
<span class="hljs-section">events</span> {
    <span class="hljs-attribute">worker_connections</span> <span class="hljs-number">4096</span>;
    <span class="hljs-attribute">multi_accept</span> <span class="hljs-literal">on</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-section">http</span> {
    <span class="hljs-attribute">sendfile</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">tcp_nopush</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">tcp_nodelay</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">types_hash_max_size</span> <span class="hljs-number">2048</span>;<font></font>
<font></font>
    <span class="hljs-attribute">include</span> /etc/nginx/mime.types;
    <span class="hljs-attribute">default_type</span> application/octet-stream;<font></font>
<font></font>
    <span class="hljs-attribute">access_log</span> <span class="hljs-literal">off</span>;
    <span class="hljs-attribute">error_log</span> /var/log/nginx/error.log;<font></font>
<font></font>
    <span class="hljs-attribute">gzip</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">gzip_disable</span> <span class="hljs-string">"msie6"</span>;
    <span class="hljs-attribute">gzip_comp_level</span> <span class="hljs-number">6</span>;
    <span class="hljs-attribute">gzip_proxied</span> any;
    <span class="hljs-attribute">gzip_vary</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">gzip_types</span> text/plain application/javascript text/javascript text/css application/json application/xml text/xml application/rss+xml;
    <span class="hljs-attribute">gunzip</span> <span class="hljs-literal">on</span>;            <font></font>
<font></font>
    <span class="hljs-attribute">proxy_temp_path</span>    /var/cache/tmp;
    <span class="hljs-attribute">proxy_cache_path</span>   /var/cache/cdn levels=<span class="hljs-number">1</span>:<span class="hljs-number">2</span> keys_zone=cdn:<span class="hljs-number">64m</span> max_size=<span class="hljs-number">20g</span> inactive=<span class="hljs-number">7d</span>;
    <span class="hljs-attribute">proxy_cache_bypass</span> <span class="hljs-variable">$http_x_update</span>;<font></font>
<font></font>
<span class="hljs-section">server</span> {
  <span class="hljs-attribute">listen</span> <span class="hljs-number">443</span> ssl;
  <span class="hljs-attribute">server_name</span> cdn.sayt.in;<font></font>
<font></font>
  <span class="hljs-attribute">ssl_certificate</span> /root/.acme.sh/cdn.sayt.in/cdn.sayt.in.cer;
  <span class="hljs-attribute">ssl_certificate_key</span> /root/.acme.sh/cdn.sayt.in/cdn.sayt.in.key;<font></font>
<font></font>
  <span class="hljs-attribute">location</span> / {
    <span class="hljs-attribute">proxy_cache</span> cdn;
    <span class="hljs-attribute">proxy_cache_key</span> <span class="hljs-variable">$uri</span><span class="hljs-variable">$is_args</span><span class="hljs-variable">$args</span>;
    <span class="hljs-attribute">proxy_cache_valid</span> <span class="hljs-number">90d</span>;
    <span class="hljs-attribute">proxy_pass</span> https://sayt.in;<font></font>
    }<font></font>
  }<font></font>
}</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
設定で、以下を編集します。</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">max_size-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用可能なディスク容量を超えないキャッシュサイズ</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非アクティブ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -誰もアクセスしていないキャッシュデータの保存時間</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ssl_certificate</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ssl_certificate_key</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -SSL証明書とキーファイルへのパス</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proxy_cache_valid-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キャッシュされたデータの保存時間</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proxy_pass</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -CDNがキャッシュ用のファイルを要求する元のサーバーのアドレス。</font><font style="vertical-align: inherit;">この例では、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sayt.inです。</font></font></i></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、すべてが簡単です。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非アクティブ</font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font><i><font style="vertical-align: inherit;">proxy_cache_validディレクティブ</font></i><font style="vertical-align: inherit;">が類似しているため、キャッシュ時間の設定でのみ複雑さが生じ</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">私たちの例ではそれらを分析します。</font><font style="vertical-align: inherit;">これは、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inactive = 7d</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proxy_cache_valid 90dで</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">何が起こるか</font><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リクエストが7日以内に繰り返されない場合、データはこの期間後にキャッシュから削除されます</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リクエストが7日ごとに少なくとも1回繰り返される場合、キャッシュ内のデータは90日後に古くなっていると見なされ、次のリクエストでNginxは元のサーバーからデータを取得して更新します</font></font></li>
</ul><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nginx.confの編集が</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
完了</font><i><font style="vertical-align: inherit;">したら</font></i><font style="vertical-align: inherit;">、構成を再読み込みします。</font></font><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# service nginx reload</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CDNは完全に準備ができています。</font><font style="vertical-align: inherit;">月額15ドル </font><font style="vertical-align: inherit;">3つの大陸に3か所の拠点と3 TBのトラフィックがあり、各場所に1 TBありました。</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CDNの動作を確認する</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
地理的に異なる場所からのCDNへのpingを見てみましょう。</font><font style="vertical-align: inherit;">このため、任意のpingサービスが適しています。</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">発射点</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ホスト</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IP</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">平均時間、ミリ秒</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドイツベルリン</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">199.247.18.199</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.6</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オランダ、アムステルダム</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">199.247.18.199</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.1</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フランスパリ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">199.247.18.199</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16.3</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">イギリス、ロンドン</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">199.247.18.199</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">14.9</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カナダトロント</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">149.28.121.123</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16.2</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アメリカ、サンフランシスコ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">149.28.121.123</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">52.7</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アメリカ、ダラス</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">149.28.121.123</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">23.1</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アメリカ、シカゴ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">149.28.121.123</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.6</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アメリカ、ニューヨーク</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">149.28.121.123</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">19.8</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シンガポール</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">157.230.240.216</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.7</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">日本東京</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">157.230.240.216</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">74.8</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オーストラリア、シドニー</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">157.230.240.216</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">95.9</font></font></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果は良好です。</font><font style="vertical-align: inherit;">次に、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メインサイト</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のルートにテストイメージ</font><i><font style="vertical-align: inherit;">test.jpgを配置</font></i><font style="vertical-align: inherit;">し、</font><font style="vertical-align: inherit;">CDNを介してダウンロードの速度を確認します。</font><font style="vertical-align: inherit;">否やよりも、言わなかっ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行わ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">コンテンツは迅速に配信されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CDNポイントのキャッシュをクリアする場合に備えて、小さなスクリプトを作成します。</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">purge.sh</font></font></b><div class="spoiler_text"><pre><code class="bash hljs"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-keyword">if</span> [ -z <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> ]
<span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"Purging all cache"</span><font></font>
    rm -rf /var/cache/cdn/*<font></font>
<span class="hljs-keyword">else</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"Purging <span class="hljs-variable">$1</span>"</span>
    FILE=`<span class="hljs-built_in">echo</span> -n <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> | md5sum | awk <span class="hljs-string">'{print $1}'</span>`<font></font>
    FULLPATH=/var/cache/cdn/<span class="hljs-variable">${FILE:31:1}</span>/<span class="hljs-variable">${FILE:29:2}</span>/<span class="hljs-variable">${FILE}</span>
    rm -f <span class="hljs-string">"<span class="hljs-variable">${FULLPATH}</span>"</span>
<span class="hljs-keyword">fi</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
キャッシュ全体を削除するには、それを実行するだけで、次のように別のファイルをクリーンアップできます。</font></font><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# ./purge.sh /test.jpg</code></pre><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論の代わりに</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に、すくいをすぐに越えるために、いくつかの便利なヒントを提供したいと思いました。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CDNのフォールトトレランスを向上させるには、DNSフェールオーバーを構成することをお勧めします。これにより、サーバーに障害が発生した場合にAレコードをすばやく変更できます。</font><font style="vertical-align: inherit;">これは、ドメインのDNSレコードのコントロールパネルで行われます</font></font></li>
<li>           CDN,    .            CDN,      6-7 : ,   (),   (), , ,   </li>
<li>         CDN. ,          ,       -</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">  </a>,  ,           </li>
<li><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さまざまな場所</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">からサーバーへの</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ping</font></a><font style="vertical-align: inherit;">を確認</font><font style="vertical-align: inherit;">してください。</font><font style="vertical-align: inherit;">したがって、CDNポイントに最も近いリージョンを確認し、GeoDNSを正しく構成できます</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスクによっては、特定のキャッシング要件に合わせてNginxを構成し、サーバーの負荷を考慮することも適切です。</font><font style="vertical-align: inherit;">Nginxキャッシュに関する記事- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と、高負荷での作業の高速化：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ここ</font></a><font style="vertical-align: inherit;">は私を大きく助けました。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja496886/index.html">Elon Muskがテスラモデル3のバックミラー越しのカメラの目的を明らかに</a></li>
<li><a href="../ja496888/index.html">スタートアップはAIを使用してコロナウイルスとの戦いに役立つ分子を検索します</a></li>
<li><a href="../ja496892/index.html">1つの拠点にすべてのハブル。コメントとWebアプリケーション</a></li>
<li><a href="../ja496894/index.html">完璧な製品バックログ</a></li>
<li><a href="../ja496900/index.html">Apache NiFiを使用してUSRLEをインポートします。ステップ1-HTTPS経由でファイルをダウンロードする</a></li>
<li><a href="../ja496912/index.html">Windows上のThinkPad E480 IntelとUbuntu上のThinkPad E495 AMDは違いがありますか？</a></li>
<li><a href="../ja496914/index.html">最短の10進プログラム</a></li>
<li><a href="../ja496916/index.html">リモートでの指導、交渉、コンサルティング-パート3：Yealink Meeting Serverと4つの特別オファー</a></li>
<li><a href="../ja496920/index.html">ASP.NET CoreとArduinoでスマートホームを作る</a></li>
<li><a href="../ja496922/index.html">ジョブNeoQUEST-2020の例に関するリバースクライアントサーバーAPKのガイド</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>