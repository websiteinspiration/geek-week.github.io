<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ› ğŸ§™ğŸ» ğŸš– Kebenaran pertama-tama, atau mengapa sistem perlu dirancang berdasarkan pada perangkat basis data âœ‹ğŸ» â• ğŸ‘¨ğŸ¼â€ğŸ¤â€ğŸ‘¨ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo, Habr! 
 
 Kami terus mengeksplorasi topik Jawa dan Musim Semi , termasuk di tingkat basis data. Hari ini kami menyarankan membaca tentang mengap...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Kebenaran pertama-tama, atau mengapa sistem perlu dirancang berdasarkan pada perangkat basis data</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/498816/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Halo, Habr! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami terus mengeksplorasi topik </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jawa</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Musim Semi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , termasuk di tingkat basis data. Hari ini kami menyarankan membaca tentang mengapa, ketika merancang aplikasi besar, itu adalah struktur database, dan bukan kode Java, yang harus memiliki makna yang menentukan tentang bagaimana hal ini dilakukan, dan apa pengecualian dari aturan ini.</font></font><br>
<a name="habracut"></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam artikel yang agak terlambat ini, saya akan menjelaskan mengapa saya percaya bahwa dalam hampir semua kasus model data dalam aplikasi harus dirancang "berdasarkan pada basis data" dan bukan "berdasarkan pada kemampuan Java" (atau bahasa klien lain yang bekerja dengan Anda). </font><font style="vertical-align: inherit;">Memilih pendekatan kedua, Anda memulai perjalanan panjang rasa sakit dan penderitaan segera setelah proyek Anda mulai tumbuh. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Artikel ini didasarkan pada </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">satu pertanyaan yang</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diajukan pada Stack Overflow. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diskusi menarik tentang reddit di bagian </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ r / java</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ r / pemrograman</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pembuatan kode</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Betapa terkejutnya saya bahwa ada lapisan kecil pengguna yang, setelah berkenalan dengan JOOQ, sangat marah dengan kenyataan bahwa ketika bekerja JOOQ sangat bergantung pada pembuatan kode sumber. Tidak ada yang mengganggu Anda untuk menggunakan jOOQ sesuai keinginan Anda, dan tidak memaksa Anda untuk menggunakan pembuatan kode. Tetapi secara default (seperti yang dijelaskan dalam manual), bekerja dengan jOOQ terjadi seperti ini: Anda mulai dengan skema database (yang diwarisi), merekayasa balik dengan generator kode jOOQ, sehingga Anda mendapatkan satu set kelas yang mewakili tabel Anda, dan kemudian tulis kueri tipe-aman ke tabel ini:</font></font><br>
<br>
<pre><code class="java hljs">	<span class="hljs-keyword">for</span> (Record2&lt;String, String&gt; record : DSL.using(configuration)
<span class="hljs-comment">//   ^^^^^^^^^^^^^^^^^^^^^^^      </span>
<span class="hljs-comment">//     ,    </span>
<span class="hljs-comment">//   SELECT </span><font></font>
 <font></font>
       .select(ACTOR.FIRST_NAME, ACTOR.LAST_NAME)<font></font>
<span class="hljs-comment">//           vvvvv ^^^^^^^^^^^^  ^^^^^^^^^^^^^^^  </span><font></font>
       .from(ACTOR)<font></font>
       .orderBy(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)) {
    <span class="hljs-comment">// ...</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode dihasilkan baik secara manual di luar rakitan, atau secara manual dengan setiap rakitan. </font><font style="vertical-align: inherit;">Sebagai contoh, regenerasi tersebut dapat terjadi segera setelah </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">migrasi database Flyway, yang juga dapat dilakukan secara manual atau otomatis</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pembuatan kode sumber</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berbagai filosofi, kelebihan dan kekurangan dikaitkan dengan pendekatan seperti untuk pembuatan kode - manual dan otomatis - yang saya tidak akan membahas secara rinci dalam artikel ini. Tetapi, secara umum, inti dari kode yang dihasilkan adalah memungkinkannya untuk mereproduksi di Jawa bahwa "kebenaran" yang kita terima begitu saja, baik di dalam sistem kami atau di luarnya. Dalam arti tertentu, kompiler yang menghasilkan bytecode, kode mesin, atau semacam kode berbasis sumber lainnya melakukan hal yang sama - kami mendapatkan representasi dari "kebenaran" kami dalam bahasa lain, terlepas dari alasan spesifik. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada banyak generator kode seperti itu. Misalnya, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XJC dapat menghasilkan kode Java berdasarkan file XSD atau WSDL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Prinsipnya selalu sama:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ada beberapa kebenaran (internal atau eksternal) - misalnya, spesifikasi, model data, dll.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kita membutuhkan representasi lokal dari kebenaran ini dalam bahasa pemrograman kita.</font></font></li>
</ul> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain itu, menghasilkan representasi seperti itu hampir selalu disarankan - untuk menghindari redundansi.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jenis Penyedia dan Pemrosesan Anotasi</font></font></h4> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Catatan: pendekatan lain, lebih modern dan spesifik untuk pembuatan kode untuk jOOQ dikaitkan dengan penggunaan penyedia jenis, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dalam bentuk di mana mereka diimplementasikan dalam F #</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dalam hal ini, kode dihasilkan oleh kompiler, sebenarnya pada tahap kompilasi. </font><font style="vertical-align: inherit;">Dalam bentuk sumber, kode semacam itu, pada prinsipnya, tidak ada. </font><font style="vertical-align: inherit;">Ada yang serupa, meskipun alat yang kurang elegan di Jawa - ini adalah prosesor anotasi seperti </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lombok</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam arti tertentu, hal yang sama terjadi di sini seperti pada kasus pertama, dengan pengecualian:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anda tidak melihat kode yang dihasilkan (mungkin situasi ini bagi seseorang tampaknya tidak terlalu menjijikkan?)</font></font></li>
<li>  ,    ,  , Â«Â»    .     Lombok,   â€œâ€.      ,        .</li>
</ul><br>
<h4>     ?</h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain pertanyaan rumit tentang bagaimana lebih baik memulai pembuatan kode - secara manual atau otomatis, perlu disebutkan bahwa ada orang yang percaya bahwa pembuatan kode tidak diperlukan sama sekali. Alasan untuk sudut pandang ini, yang paling sering saya temui, adalah sulitnya mengkonfigurasi pipa rakitan. Ya, sangat sulit. Ada biaya infrastruktur tambahan. Jika Anda baru mulai bekerja dengan produk tertentu (baik itu jOOQ, atau JAXB, atau Hibernate, dll.), Diperlukan waktu untuk mengatur lingkungan kerja yang ingin Anda habiskan untuk mempelajari API itu sendiri, dan kemudian mengekstrak nilai darinya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika biaya yang terkait dengan pemahaman perangkat generator terlalu besar, maka, memang, API sedikit bekerja pada kegunaan dari generator kode (dan di masa depan ternyata konfigurasi pengguna di dalamnya rumit). Kemudahan penggunaan harus menjadi prioritas tertinggi untuk API semacam itu. Tapi ini hanya satu argumen terhadap pembuatan kode. Untuk selebihnya, ini sepenuhnya sepenuhnya manual untuk menulis representasi lokal dari kebenaran internal atau eksternal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Banyak yang akan mengatakan bahwa mereka tidak punya waktu untuk melakukan semua ini. Mereka memiliki tenggat waktu untuk Produk Super mereka. Beberapa waktu kemudian kita menyisir konveyor perakitan, itu akan tepat waktu. Saya akan menjawab mereka: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sd/ah/5v/sdah5v4nuslp0dylmjlrvcu0qfu.png"><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Asli</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alan O'Rourke, Penonton Stack </font></font></a> <br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tapi di Hibernate / JPA sangat mudah untuk menulis kode "untuk Java".</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Betulkah. </font><font style="vertical-align: inherit;">Untuk Hibernate dan penggunanya, ini adalah berkah sekaligus kutukan. </font><font style="vertical-align: inherit;">Di Hibernate, Anda cukup menulis beberapa entitas, seperti ini:</font></font><br>
<br>
<pre><code class="java hljs">	<span class="hljs-meta">@Entity</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Book</span> </span>{
  <span class="hljs-meta">@Id</span>
  <span class="hljs-keyword">int</span> id;<font></font>
  String title;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan hampir semuanya sudah siap. </font><font style="vertical-align: inherit;">Sekarang nasib Hibernate adalah untuk menghasilkan "detail" kompleks tentang bagaimana entitas ini akan didefinisikan pada DDL dari "dialek" SQL Anda:</font></font><br>
<br>
<pre><code class="sql hljs">	<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> book (
  <span class="hljs-keyword">id</span> <span class="hljs-built_in">INTEGER</span> PRIMARY <span class="hljs-keyword">KEY</span> <span class="hljs-keyword">GENERATED</span> <span class="hljs-keyword">ALWAYS</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">IDENTITY</span>,<font></font>
  title <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">50</span>),<font></font>
 <font></font>
  <span class="hljs-keyword">CONSTRAINT</span> pk_book PRIMARY <span class="hljs-keyword">KEY</span> (<span class="hljs-keyword">id</span>)<font></font>
);<font></font>
 <font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> i_book_title <span class="hljs-keyword">ON</span> book (title);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... dan kami mulai menjalankan aplikasi. </font><font style="vertical-align: inherit;">Kesempatan yang sangat keren untuk memulai dengan cepat dan mencoba berbagai hal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun, izinkan. </font><font style="vertical-align: inherit;">Saya menipu.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apakah Hibernate benar-benar menerapkan definisi kunci primer bernama ini?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Akankah Hibernate membuat indeks di TITLE? </font><font style="vertical-align: inherit;">"Aku tahu pasti bahwa kita akan membutuhkannya."</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apakah Hibernate benar-benar membuat kunci ini dapat diidentifikasi dalam Spesifikasi Identitas?</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mungkin tidak. </font><font style="vertical-align: inherit;">Jika Anda mengembangkan proyek Anda dari awal, selalu mudah untuk hanya membuang database lama dan menghasilkan yang baru segera setelah Anda menambahkan anotasi yang diperlukan. </font><font style="vertical-align: inherit;">Jadi, entitas Buku pada akhirnya akan mengambil bentuk:</font></font><br>
<br>
<pre><code class="java hljs">	<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "book", indexes = {
  @Index(name = "i_book_title", columnList = "title")
})</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Book</span> </span>{
  <span class="hljs-meta">@Id</span>
  <span class="hljs-meta">@GeneratedValue(strategy = IDENTITY)</span>
  <span class="hljs-keyword">int</span> id;<font></font>
  String title;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Keren. </font><font style="vertical-align: inherit;">Diperbaiki. </font><font style="vertical-align: inherit;">Sekali lagi, dalam hal ini, pada awalnya akan sangat mudah.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tetapi kemudian Anda harus membayarnya</font></font></h4> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cepat atau lambat Anda harus mulai berproduksi. Saat itu, model seperti itu akan berhenti bekerja. Karena: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam produksi, tidak mungkin lagi, jika perlu, membuang basis data lama dan memulai dari awal lagi. Basis data Anda akan berubah menjadi yang lama. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mulai sekarang, Anda harus menulis </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">skrip migrasi DDL, misalnya, menggunakan Flyway</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Lalu apa yang terjadi pada entitas Anda? Anda dapat mengadaptasinya secara manual (dan karenanya melipatgandakan beban kerja Anda), atau Anda dapat memesan Hibernate untuk membuatnya kembali untuk Anda (seberapa besar kemungkinan yang dihasilkan dengan cara ini akan memenuhi harapan Anda?) Anda tetap kalah.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, segera setelah Anda mulai berproduksi, Anda akan memerlukan hot patch. </font><font style="vertical-align: inherit;">Dan mereka harus dimasukkan ke dalam produksi dengan sangat cepat. </font><font style="vertical-align: inherit;">Karena Anda belum menyiapkan dan mengatur konveyor migrasi Anda untuk produksi yang lancar, Anda menambal semuanya dengan liar. </font><font style="vertical-align: inherit;">Dan kemudian Anda tidak punya waktu untuk melakukan semuanya dengan benar. </font><font style="vertical-align: inherit;">Dan memarahi Hibernate, karena siapa pun selalu harus disalahkan, tetapi bukan Anda ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebaliknya, sejak awal semuanya bisa dilakukan dengan cara yang sama sekali berbeda. </font><font style="vertical-align: inherit;">Misalnya, letakkan roda bundar di atas sepeda.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Database dulu</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Kebenaran" yang sebenarnya dalam skema basis data Anda dan "kedaulatan" di atasnya terletak di dalam basis data. </font><font style="vertical-align: inherit;">Skema ini didefinisikan hanya dalam database itu sendiri dan di tempat lain, dan masing-masing klien memiliki salinan skema ini, sehingga sangat disarankan untuk memaksakan kepatuhan dengan skema dan integritasnya, lakukan secara langsung dalam database - di mana informasi disimpan. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini bahkan merupakan kearifan usang. </font><font style="vertical-align: inherit;">Kunci primer dan unik bagus. </font><font style="vertical-align: inherit;">Kunci asing baik. </font><font style="vertical-align: inherit;">Memeriksa pembatasan itu bagus. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pernyataannya</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bagus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apalagi ini belum semuanya. </font><font style="vertical-align: inherit;">Misalnya, menggunakan Oracle, Anda mungkin ingin menentukan:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tablespace di mana tabel Anda? </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apa nilai PCTFREE-nya? </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Berapa ukuran cache dalam urutan Anda (di belakang pengidentifikasi)</font></font></li>
</ul> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mungkin semua ini tidak penting dalam sistem kecil, tetapi tidak perlu menunggu transisi ke area "data besar" - adalah mungkin dan jauh lebih awal untuk mulai mendapat manfaat dari optimasi penyimpanan yang disediakan oleh pemasok, seperti yang disebutkan di atas. </font><font style="vertical-align: inherit;">Tidak satu pun dari ORM yang saya lihat (termasuk jOOQ) memberikan akses ke set lengkap opsi DDL yang mungkin ingin Anda gunakan dalam database Anda. </font><font style="vertical-align: inherit;">ORM menawarkan beberapa alat yang membantu menulis DDL. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi pada akhirnya, sirkuit yang dirancang dengan baik ditulis secara manual dalam DDL. </font><font style="vertical-align: inherit;">Setiap DDL yang dihasilkan hanya perkiraan saja.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagaimana dengan model klien?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti disebutkan di atas, pada klien Anda akan memerlukan salinan skema database Anda, tampilan klien. Tidak perlu dikatakan, tampilan klien ini harus disinkronkan dengan model nyata. Apa cara terbaik untuk mencapai ini? Menggunakan generator kode. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semua database menyediakan informasi meta mereka melalui SQL. Inilah cara mendapatkan semua tabel dalam dialek SQL yang berbeda dari database Anda:</font></font><br>
<br>
<pre><code class="sql hljs">	<span class="hljs-comment">-- H2, HSQLDB, MySQL, PostgreSQL, SQL Server</span>
<span class="hljs-keyword">SELECT</span> table_schema, table_name
<span class="hljs-keyword">FROM</span> information_schema.tables<font></font>
 <font></font>
<span class="hljs-comment">-- DB2</span>
<span class="hljs-keyword">SELECT</span> tabschema, tabname
<span class="hljs-keyword">FROM</span> syscat.tables<font></font>
 <font></font>
<span class="hljs-comment">-- Oracle</span>
<span class="hljs-keyword">SELECT</span> owner, table_name
<span class="hljs-keyword">FROM</span> all_tables<font></font>
 <font></font>
<span class="hljs-comment">-- SQLite</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">name</span>
<span class="hljs-keyword">FROM</span> sqlite_master<font></font>
 <font></font>
<span class="hljs-comment">-- Teradata</span>
<span class="hljs-keyword">SELECT</span> databasename, tablename
<span class="hljs-keyword">FROM</span> dbc.tables
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kueri ini (atau yang serupa, tergantung pada apakah Anda juga harus mempertimbangkan representasi, representasi terwujud, fungsi dengan nilai tabel) juga dilakukan menggunakan panggilan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><code>DatabaseMetaData.getTables()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dari JDBC, atau menggunakan meta-modul jOOQ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dari hasil pertanyaan seperti itu, relatif mudah untuk menghasilkan pandangan klien dari model database Anda, terlepas dari teknologi apa yang digunakan pada klien Anda.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika Anda menggunakan JDBC atau Spring, Anda bisa membuat seperangkat konstanta string </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika menggunakan JPA, Anda dapat membuat entitas sendiri </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika menggunakan jOOQ, Anda dapat membuat meta-model jOOQ</font></font></li>
</ul> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bergantung pada berapa banyak fitur yang ditawarkan oleh API klien Anda (mis. JOOQ atau JPA), meta-model yang dihasilkan dapat benar-benar kaya dan lengkap. </font><font style="vertical-align: inherit;">Ambil, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">misalnya</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , kemungkinan </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">gabungan</font></a><font style="vertical-align: inherit;"> implisit yang </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">muncul di jOOQ 3.11</font></a><font style="vertical-align: inherit;"> , yang bergantung pada meta-informasi yang dihasilkan tentang hubungan kunci asing antara tabel Anda. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang setiap penambahan basis data akan secara otomatis menyebabkan pembaruan kode klien. </font><font style="vertical-align: inherit;">Bayangkan misalnya:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> book <span class="hljs-keyword">RENAME</span> <span class="hljs-keyword">COLUMN</span> title <span class="hljs-keyword">TO</span> book_title;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apakah Anda benar-benar ingin melakukan pekerjaan ini dua kali? </font><font style="vertical-align: inherit;">Sama sekali tidak. </font><font style="vertical-align: inherit;">Perbaiki DDL, jalankan melalui pipa perakitan Anda dan dapatkan entitas yang diperbarui:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "book", indexes = {
 
  //    ?
  @Index(name = "i_book_title", columnList = "book_title")
})</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Book</span> </span>{
  <span class="hljs-meta">@Id</span>
  <span class="hljs-meta">@GeneratedValue(strategy = IDENTITY)</span>
  <span class="hljs-keyword">int</span> id;<font></font>
 <font></font>
  <span class="hljs-meta">@Column("book_title")</span><font></font>
  String bookTitle;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Atau kelas jOOQ yang diperbarui. </font><font style="vertical-align: inherit;">Sebagian besar perubahan DDL juga memengaruhi semantik, bukan hanya sintaksis. </font><font style="vertical-align: inherit;">Oleh karena itu, akan lebih mudah untuk melihat dalam kode yang dikompilasi kode mana yang akan (atau mungkin) dipengaruhi oleh kenaikan basis data Anda.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Satu-satunya kebenaran</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak peduli teknologi apa yang Anda gunakan, selalu ada satu model yang merupakan satu-satunya sumber kebenaran untuk beberapa subsistem - atau, setidaknya, kita harus berjuang untuk ini dan menghindari kebingungan perusahaan seperti itu, di mana "kebenaran" ada di mana-mana dan di mana pun. </font><font style="vertical-align: inherit;">Semuanya bisa lebih sederhana. </font><font style="vertical-align: inherit;">Jika Anda hanya bertukar file XML dengan beberapa sistem lain, cukup gunakan XSD. </font><font style="vertical-align: inherit;">Lihatlah meta-model INFORMATION_SCHEMA dari jOOQ dalam bentuk XML: </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://www.jooq.org/xsd/jooq-meta-3.10.0.xsd</font></font></a><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XSD dipahami dengan baik</font></font></li>
<li>XSD     XML         </li>
<li>XSD        </li>
<li>XSD     Java   XJC</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Poin terakhir itu penting. </font><font style="vertical-align: inherit;">Saat berkomunikasi dengan sistem eksternal menggunakan pesan XML, kami ingin memastikan validitas pesan kami. </font><font style="vertical-align: inherit;">Ini sangat mudah dicapai dengan JAXB, XJC dan XSD. </font><font style="vertical-align: inherit;">Akan sangat gila untuk berharap bahwa, ketika mendekati desain "Java first", di mana kita membuat pesan kita dalam bentuk objek Java, mereka entah bagaimana dapat dengan jelas ditampilkan dalam XML dan dikirim untuk dikonsumsi ke sistem lain. </font><font style="vertical-align: inherit;">XML yang dihasilkan dengan cara ini akan memiliki kualitas yang sangat buruk, tidak didokumentasikan, dan akan sulit untuk dikembangkan. </font><font style="vertical-align: inherit;">Jika ada kesepakatan pada tingkat kualitas layanan (SLA) pada antarmuka seperti itu, kami akan segera merusaknya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jujur, itulah yang terjadi sepanjang waktu dari API ke JSON, tapi itu cerita lain, saya akan bersumpah lain kali ...</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Database: itu hal yang sama</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketika bekerja dengan basis data, Anda memahami bahwa mereka pada dasarnya serupa. Pangkalan memiliki datanya dan harus mengelola skema. Setiap modifikasi yang dilakukan pada sirkuit harus diimplementasikan langsung pada DDL untuk memperbarui satu sumber kebenaran. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketika pembaruan sumber telah terjadi, semua klien juga harus memperbarui salinan model mereka. Beberapa klien dapat ditulis dalam Java menggunakan jOOQ dan Hibernate atau JDBC (atau sekaligus). Klien lain dapat ditulis dalam Perl (tetap berharap mereka beruntung), dan yang lain dalam C #. Tidak masalah. Model utama ada di database. Model yang dihasilkan menggunakan ORM, biasanya berkualitas rendah, tidak terdokumentasi dengan baik dan sulit untuk dikembangkan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena itu, jangan membuat kesalahan. </font><font style="vertical-align: inherit;">Jangan membuat kesalahan sejak awal. </font><font style="vertical-align: inherit;">Bekerja dari basis data. </font><font style="vertical-align: inherit;">Bangun pipa penyebaran yang dapat diotomatisasi. </font><font style="vertical-align: inherit;">Nyalakan generator kode untuk membuatnya nyaman untuk menyalin model database Anda dan membuangnya ke klien. </font><font style="vertical-align: inherit;">Dan berhenti khawatir tentang pembuat kode. </font><font style="vertical-align: inherit;">Mereka baik. </font><font style="vertical-align: inherit;">Dengan mereka Anda akan menjadi lebih produktif. </font><font style="vertical-align: inherit;">Anda hanya perlu meluangkan sedikit waktu sejak awal untuk mengkonfigurasinya - dan kemudian Anda akan memiliki peningkatan produktivitas bertahun-tahun yang akan membentuk sejarah proyek Anda. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sampai saat itu, terima kasih.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penjelasan</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk kejelasan: Artikel ini sama sekali tidak menganjurkan bahwa di bawah model database Anda, Anda perlu membengkokkan seluruh sistem (mis., Area subjek, logika bisnis, dll., Dll.). </font><font style="vertical-align: inherit;">Dalam artikel ini, saya mengatakan bahwa kode klien yang berinteraksi dengan database harus bertindak berdasarkan model database sehingga tidak mereproduksi model database dalam status "kelas". </font><font style="vertical-align: inherit;">Logika ini biasanya terletak di tingkat akses data pada klien Anda. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam arsitektur dua tingkat, yang masih dipertahankan di beberapa tempat, model sistem seperti itu mungkin satu-satunya yang mungkin. </font><font style="vertical-align: inherit;">Namun, di sebagian besar sistem, tingkat akses data menurut saya adalah "subsistem" yang merangkum model basis data.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengecualian</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada pengecualian untuk aturan apa pun, dan saya telah mengatakan bahwa pendekatan dengan keutamaan basis data dan pembuatan kode sumber terkadang tidak tepat. </font><font style="vertical-align: inherit;">Berikut adalah beberapa pengecualian (mungkin ada yang lain):</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketika sirkuit tidak diketahui, dan harus dibuka. </font><font style="vertical-align: inherit;">Misalnya, Anda adalah penyedia alat untuk membantu pengguna menavigasi skema apa pun. </font><font style="vertical-align: inherit;">Fiuh </font><font style="vertical-align: inherit;">Tidak ada pembuatan kode. </font><font style="vertical-align: inherit;">Tapi tetap saja - database di atas segalanya.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketika sirkuit harus dihasilkan dengan cepat untuk memecahkan masalah tertentu. </font><font style="vertical-align: inherit;">Contoh ini tampak seperti versi yang sedikit fantastis dari pola </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nilai atribut entitas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yaitu, Anda benar-benar tidak memiliki skema yang terdefinisi dengan baik. </font><font style="vertical-align: inherit;">Dalam hal ini, seringkali mustahil untuk memastikan bahwa RDBMS tepat untuk Anda.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pengecualian pada dasarnya luar biasa. </font><font style="vertical-align: inherit;">Dalam kebanyakan kasus yang melibatkan penggunaan RDBMS, skema ini diketahui sebelumnya, terletak di dalam RDBMS dan merupakan satu-satunya sumber "kebenaran", dan semua pelanggan harus mendapatkan salinan yang berasal darinya. </font><font style="vertical-align: inherit;">Idealnya, Anda perlu menggunakan generator kode.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id498796/index.html">Kebijakan Keamanan Konten di Magento 2</a></li>
<li><a href="../id498798/index.html">Terus belajar dan belajar dengan JetBrains</a></li>
<li><a href="../id498800/index.html">Bagaimana saya mengajar komputer saya untuk bermain Dobble dengan OpenCV dan Deep Learning</a></li>
<li><a href="../id498808/index.html">Vim dengan Dukungan YAML untuk Kubernetes</a></li>
<li><a href="../id498814/index.html">Anda gagal satu pertanyaan teoritis tentang Jaminan Sosial, dan mereka mengakhiri Anda. Ini normal? // Kita Ditakdirkan # 3</a></li>
<li><a href="../id498820/index.html">Beberapa pertanyaan rumit tentang .NET dan C #</a></li>
<li><a href="../id498822/index.html">Pengembangan dan pembuatan dari awal mesin arcade untuk empat pemain</a></li>
<li><a href="../id498826/index.html">SIL dan Tenaga Pemasaran</a></li>
<li><a href="../id498828/index.html">Bagaimana garam meja dan protein akan meningkatkan kelangsungan hidup implan</a></li>
<li><a href="../id498830/index.html">Hash + cache: optimisasi pemrosesan aliran</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>