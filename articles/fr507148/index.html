<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö£üèΩ üöñ ü•ú Envoyer des liens magiques √† l'aide de Node.js üë®‚Äçüëß‚Äçüëß ‚óªÔ∏è üê®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Une traduction de l'article a √©t√© pr√©par√©e avant le lancement du cours Node.js Developer .
 
 
 La m√©thode la plus populaire pour entrer dans l'applic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Envoyer des liens magiques √† l'aide de Node.js</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/507148/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une traduction de l'article a √©t√© pr√©par√©e avant le lancement du </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cours Node.js Developer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></b></i><br>
<br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 La m√©thode la plus populaire pour entrer dans l'application consiste √† fournir un nom d'utilisateur et un mot de passe, mais les utilisateurs peuvent y trouver certains inconv√©nients. </font><font style="vertical-align: inherit;">Bien qu'il existe de nombreux gestionnaires de mots de passe, leur utilisation prend du temps. </font><font style="vertical-align: inherit;">Pas grand chose, mais quand m√™me. </font><font style="vertical-align: inherit;">Certaines applications promeuvent une politique de mot de passe complexe et donc d√©cevante, il peut donc √™tre difficile de trouver un nouveau mot de passe. </font><font style="vertical-align: inherit;">Un syst√®me sans mot de passe peut √™tre une bonne alternative √† l'authentification conventionnelle par identifiant et mot de passe. </font><font style="vertical-align: inherit;">Il est utilis√© par Slack et FramerX, et il ressemble √† l'envoi d'un lien magique √† l'utilisateur pour activer une telle authentification dans l'application. </font><font style="vertical-align: inherit;">Un syst√®me sans mot de passe fonctionne comme suit:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'utilisateur visite l'application, o√π il y a un formulaire pour entrer une adresse e-mail;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'utilisateur entre une adresse e-mail et appuie sur le bouton de confirmation;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un lien magique pour entrer dans le syst√®me est envoy√© au courrier √©lectronique de l'utilisateur;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'utilisateur clique sur le lien et est redirig√© vers l'application o√π il s'est d√©j√† connect√©.</font></font></li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s cela, le lien magique n'est plus valide. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ci-dessous, nous examinerons quelques points cl√©s pour la mise en ≈ìuvre de l'autorisation sans mot de passe sur Node.js.</font></font><a name="habracut"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cr√©ons une </font><font style="vertical-align: inherit;">application </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">express</font></font></a><font style="vertical-align: inherit;"></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Tout d'abord, nous devons cr√©er une application express simple et ajouter des points de terminaison. </font><font style="vertical-align: inherit;">Le code ci-dessous est responsable de la configuration d'un serveur express avec des assistants pour l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">analyse des demandes entrantes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">connexion</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et l'ajout de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cors</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Nous devrons cr√©er deux r√©pertoires auxquels nous ajouterons des gestionnaires plus tard. </font><font style="vertical-align: inherit;">Ce sera </font></font><code>/login</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>/account</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Le premier gestionnaire sera responsable de l'envoi de liens magiques aux utilisateurs, et le second - de leur authentification. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qt/3e/po/qt3epo1etknmhkp3rpijaekmexs.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">server.ts</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurer nodemailer</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous utiliserons </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nodemailer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour envoyer des e-mails, mais vous devez d'abord le configurer. </font><font style="vertical-align: inherit;">Nous aurons besoin de plusieurs composants: une adresse e-mail, un mot de passe e-mail, un h√¥te de serveur SMTP et un port de serveur SMTP. </font><font style="vertical-align: inherit;">Nous aurons √©galement besoin d'un mod√®le de lettre, que nous enverrons aux utilisateurs avec un lien magique. </font><font style="vertical-align: inherit;">Un mod√®le peut √™tre simplement une cha√Æne ou une page HTML.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vo/dc/r0/vodcr0nsmdbrvqdxnazj02mg1ew.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G√©n√©ration de jetons</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Pour cela, nous utiliserons le package </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jsonwebtoken</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui dans son ensemble fera tout pour nous. </font><font style="vertical-align: inherit;">Notre jeton comprendra deux propri√©t√©s: l'adresse e-mail et l'heure d'expiration. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/e0/x4/bm/e0x4bm02olp4xkoxn-vstcoxqkw.png"> <br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">token.ts</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Envoi d'email</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous devons maintenant ajouter un gestionnaire de connexion, o√π nous allons d'abord v√©rifier que la demande contient l'adresse e-mail de l'utilisateur, puis g√©n√©rer un nouveau jeton pour cet utilisateur sp√©cifique et, enfin, utiliser le m√©canisme d√©crit dans le code ci-dessus pour envoyer l'e-mail.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/s8/pf/yq/s8pfyqtbzuffdnumv4axfrl8tbc.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Authentification d'utilisateur</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsqu'un utilisateur se connecte au syst√®me, nous devons autoriser ses demandes √† notre serveur. </font><font style="vertical-align: inherit;">Pour ce faire, proc√©dez comme suit:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V√©rifiez s'il y a un en-t√™te d'autorisation dans la demande;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V√©rifiez que l'en-t√™te d'autorisation est </font></font><code>bearer token</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Essayez de d√©coder ce jeton;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V√©rifiez que le jeton poss√®de tous les champs obligatoires. </font><font style="vertical-align: inherit;">Dans notre cas: </font></font><code>email</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>expiration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comparez la date et l'heure d'expiration avec celles actuelles pour v√©rifier que le jeton n'a pas expir√©.</font></font></li>
<li>, ,     ,   , .</li>
</ol><br>
<br>
<img src="https://habrastorage.org/webt/dl/d5/r-/dld5r-jbbmywnwgbdkcapab7cdc.png"><br>
<br>
<h3></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici la configuration de base pour une connexion sans mot de passe en plus d'un flux d'autorisation normal. Le plus grand avantage que je vois dans cette approche est que si les utilisateurs peuvent se connecter √† un produit plus rapidement et plus facilement, leur exp√©rience d'utilisation du produit s'am√©liorera. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'un autre c√¥t√©, m√™me si la connexion au syst√®me peut √™tre plus facile qu'avec un identifiant / mot de passe normal, y revenir peut √™tre plus difficile. Chaque fois qu'un utilisateur se connecte, il devra attendre un e-mail, consulter sa bo√Æte de r√©ception et cliquer sur le lien. Ce processus peut √©galement √™tre d√©sagr√©able, donc si une session a de courtes p√©riodes d'expiration ou s'il est pr√©vu que les utilisateurs se connectent souvent au syst√®me, l'autorisation sans mot de passe peut ne pas √™tre le meilleur choix.</font></font><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">   .</a><br>
<br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr507116/index.html">"Udalenka". Notes du d√©veloppeur de bureau d'hier. Partie 2</a></li>
<li><a href="../fr507124/index.html">PDB n'est pas seulement une fourrure pr√©cieuse</a></li>
<li><a href="../fr507132/index.html">Vladimir Kitov: ¬´Il est impossible de comprendre comment des scientifiques pionniers pr√©voyaient l'informatisation universelle dans les ann√©es 1950!¬ª</a></li>
<li><a href="../fr507138/index.html">La g√©ologie du 21e si√®cle en tant que science des donn√©es de la Terre</a></li>
<li><a href="../fr507146/index.html">Fen√™tres multicolores: constructeur virtuel, CRTP et mod√®les complexes</a></li>
<li><a href="../fr507150/index.html">Nous dessinons une image d'interf√©rence en JavaScript</a></li>
<li><a href="../hi486176/index.html">‡§ï‡•â‡§∞‡•ç‡§™‡•ã‡§∞‡•á‡§ü ‡§à‡§Æ‡•á‡§≤ ‡§™‡§§‡•ç‡§∞‡§æ‡§ö‡§æ‡§∞ ‡§Æ‡•á‡§Æ‡•ã</a></li>
<li><a href="../hi486178/index.html">FOSS News No. 1 - 27 ‡§ú‡§®‡§µ‡§∞‡•Ä - 2 ‡§´‡§∞‡§µ‡§∞‡•Ä, 2020 ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•ç‡§µ‡§§‡§Ç‡§§‡•ç‡§∞ ‡§î‡§∞ ‡§Æ‡•Å‡§ï‡•ç‡§§ ‡§∏‡•ç‡§∞‡•ã‡§§ ‡§∏‡§Æ‡§æ‡§ö‡§æ‡§∞ ‡§ï‡•Ä ‡§∏‡§Æ‡•Ä‡§ï‡•ç‡§∑‡§æ</a></li>
<li><a href="../hi486180/index.html">‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§∞‡§π‡§ø‡§§ ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•Å‡§ù‡§æ‡§µ ‡§î‡§∞ ‡§∏‡•ç‡§∞‡•ã‡§§</a></li>
<li><a href="../hi486184/index.html">‡§™‡•ç‡§∞‡§≠‡§æ‡§µ‡•Ä ‡§¢‡§Ç‡§ó ‡§∏‡•á ‡§ñ‡•ã‡§ú ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡•à‡§∏‡•á ‡§ï‡§∞‡•á‡§Ç</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>