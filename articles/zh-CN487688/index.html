<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✋🏼 🏷️ 🔯 用Python开发类型为2019-nCoV的交互式冠状病毒分布图 🧑🏿‍🤝‍🧑🏽 🚟 💆🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在中国武汉市爆发后，2019-nCoV型冠状病毒正在全球范围内迅速传播。在撰写原始文章时（2020年1月30日），已经报告了9,000多例感染者和213人死亡，截至今天（2020年2月10日），已经报告了40,570例感染者，有910人死亡。在法国，澳大利亚，俄罗斯，日本，新加坡，马来西亚，德国，意...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>用Python开发类型为2019-nCoV的交互式冠状病毒分布图</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/487688/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在中国武汉市爆发后，2019-nCoV型冠状病毒正在全球范围内迅速传播。在撰写原始文章时（2020年1月30日），已经报告了9,000多例感染者和213人死亡，截至今天（2020年2月10日），已经报告了40,570例感染者，有910人死亡。在法国，澳大利亚，俄罗斯，日本，新加坡，马来西亚，德国，意大利，斯里兰卡，柬埔寨，尼泊尔和许多其他国家中已检测到冠状病毒感染病例。没有人知道何时停止病毒。同时，确诊的冠状病毒病例数仅在增加。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今天我们要翻译的文章的作者想谈一谈如何使用Python创建一个简单的应用程序来跟踪冠状病毒的传播。</font><font style="vertical-align: inherit;">在完成此应用程序的工作后，阅读器将具有一个HTML页面和一个滑块，该HTML页面显示该病毒的传播图，该滑块允许您选择在该地图上显示数据的日期。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f47/3a0/01d/f473a001d45ecadc8bcdc1415c43e983.gif"></div></a><br>
<i><font color="#999999"><font style="vertical-align: inherit;"></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这里将使用</font><i><font color="#999999"><font style="vertical-align: inherit;"> 2019-nCoV型冠状病毒</font></font></i><font style="vertical-align: inherit;">技术的</font><i><font color="#999999"><font style="vertical-align: inherit;">交互式分布图，</font></font></i><font style="vertical-align: inherit;">例如Python 3.7，Pandas，Plotly 4.1.0和Jupyter Notebook。</font></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">导入库</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们从导入基于Jupyter Notebook，Plotly和Pandas库的项目开始。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> plotly.offline <span class="hljs-keyword">as</span> go_offline
<span class="hljs-keyword">import</span> plotly.graph_objects <span class="hljs-keyword">as</span> go
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在继续之前，请尝试运行代码。</font><font style="vertical-align: inherit;">如果没有看到错误消息，则说明所有必需的库均已安装并且可以正常工作。</font><font style="vertical-align: inherit;">如果代码无法运行，请查看</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plotly</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pandas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的官方页面，</font><font style="vertical-align: inherit;">并阅读这些库的参考和安装材料。</font><font style="vertical-align: inherit;">如果您的硬件上没有运行Jupyter Notebook系统，建议您使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Colab</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，这是一个基于云的平台，可让您使用Jupyter Notebook。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据处理</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们在这里使用的数据可以在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这里</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">找到</font><font style="vertical-align: inherit;">。这是Google文档的共享电子表格，每天都会更新。非常感谢所有保持最新状态的人！您正在做非常必要的工作。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们将使用Pandas方法读取数据</font></font><code>read_csv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。但是在使用表链接从表中加载数据之前，我们需要使用此链接。现在看起来像这样：</font><font style="vertical-align: inherit;">
我们需要替换链接的选定片段，使链接变为这种形式：</font><font style="vertical-align: inherit;">
在以下代码中，我们</font><font style="vertical-align: inherit;">通过向数据写入链接来</font><font style="vertical-align: inherit;">初始化变量</font><font style="vertical-align: inherit;">，使用方法读取数据</font><font style="vertical-align: inherit;">并写入包含</font><font style="vertical-align: inherit;">value的</font><font style="vertical-align: inherit;">空单元格</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<code>https://docs.google.com/spreadsheets/d/18X1VM1671d99V_yd-cnUI1j8oSG2ZgfU_q1HfOizErA/<b>edit#gid=0</b></code><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<code>https://docs.google.com/spreadsheets/d/18X1VM1671d99V_yd-cnUI1j8oSG2ZgfU_q1HfOizErA/<b>export?format=csv&amp;id</b></code><br>
<br><font style="vertical-align: inherit;"></font><code>url</code><font style="vertical-align: inherit;"></font><code>read_csv</code><font style="vertical-align: inherit;"></font><code>NaN</code><font style="vertical-align: inherit;"></font><code>0</code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">url=<span class="hljs-string">'https://docs.google.com/spreadsheets/d/18X1VM1671d99V_yd-cnUI1j8oSG2ZgfU_q1HfOizErA/export?format=csv&amp;id'</span><font></font>
data=pd.read_csv(url)<font></font>
data=data.fillna(<span class="hljs-number">0</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在工作的这个阶段，了解我们使用的数据结构的结构非常重要，因为这决定了我们采用哪种数据处理方法。使用命令查看数据</font></font><code>data.head()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。这将导致表的前5行的输出。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3ac/130/bed/3ac130bed504767776a301ba85b377df.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">冠状病毒数据的前5行在</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
左下角，您可以看到数据表中有47列的信息。以下是前五个栏的名称：</font></font><code>country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>location_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>location</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>latitude</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>longitude</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。其他列是其名称构造如下的对：</font></font><code>confirmedcase_dd-mm-yyyy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>deaths_dd-mm-yyyy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。撰写本文时，表中的总列数为47。这意味着我有21天的数据可供使用（（47-5）/ 2 = 21）。如果数据收集的开始日期是10.01.2020，那么结束日期是30.01.2020。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该表的前五列的名称不会更改，但是随着时间的流逝，具有新名称的列将被添加到该表中。我们的交互式地图将输出的是冠状病毒分布的可视化图像，并能够指示形成地图的日期。因此，我们需要通过每天从中选择信息并考虑到表的前5列不变，并且每天由两列描述来分离整个数据集。然后，如果您仔细查看数据（例如10.01.2020的数据），结果发现许多日期与此日期相对应。实际上，到目前为止，仅在一个地方确认了冠状病毒的检测，并用相应的数字标记。该日期的所有其他行仅包含零。它的意思是，我们需要将这些线从地图构建过程中排除。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
准备用于可视化的数据的过程是循环执行的。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#  </span><font></font>
fig=go.Figure()<font></font>
col_name=data.columns<font></font>
n_col=len(data.columns)<font></font>
date_list=[]<font></font>
init=<span class="hljs-number">4</span>
n_range=int((n_col<span class="hljs-number">-5</span>)/<span class="hljs-number">2</span>)<font></font>
<font></font>
<span class="hljs-comment">#,          </span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(n_range):<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;col_case=init+<span class="hljs-number">1</span>
&nbsp;&nbsp;&nbsp;&nbsp;col_dead=col_case+<span class="hljs-number">1</span>
&nbsp;&nbsp;&nbsp;&nbsp;init=col_case+<span class="hljs-number">1</span>
&nbsp;&nbsp;&nbsp;&nbsp;df_split=data[[<span class="hljs-string">'latitude'</span>,<span class="hljs-string">'longitude'</span>,<span class="hljs-string">'country'</span>,<span class="hljs-string">'location'</span>,col_name[col_case],col_name[col_dead]]]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;df=df_split[(df_split[col_name[col_case]]!=<span class="hljs-number">0</span>)]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lat=df[<span class="hljs-string">'latitude'</span>]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lon=df[<span class="hljs-string">'longitude'</span>]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;case=df[df.columns[<span class="hljs-number">-2</span>]].astype(int)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;deaths=df[df.columns[<span class="hljs-number">-1</span>]].astype(int)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;df[<span class="hljs-string">'text'</span>]=df[<span class="hljs-string">'country'</span>]+<span class="hljs-string">'&lt;br&gt;'</span>+df[<span class="hljs-string">'location'</span>]+<span class="hljs-string">'&lt;br&gt;'</span>+<span class="hljs-string">'confirmed cases: '</span>+ case.astype(str)+<span class="hljs-string">'&lt;br&gt;'</span>+<span class="hljs-string">'deaths: '</span>+deaths.astype(str)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;date_label=deaths.name[<span class="hljs-number">7</span>:<span class="hljs-number">17</span>]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;date_list.append(date_label)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment">#  Scattergeo</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;fig.add_trace(go.Scattergeo(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;name=<span class="hljs-string">''</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lon=lon,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lat=lat,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;visible=<span class="hljs-literal">False</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;hovertemplate=df[<span class="hljs-string">'text'</span>],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;text=df[<span class="hljs-string">'text'</span>],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;mode=<span class="hljs-string">'markers'</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;marker=dict(size=<span class="hljs-number">15</span>,opacity=<span class="hljs-number">0.6</span>,color=<span class="hljs-string">'Red'</span>, symbol=<span class="hljs-string">'circle'</span>),<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在操作过程中，使用会将每个数据集的输出添加到Scattergeo图</font></font><code>fig.add_trace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在撰写本文时，将以21个对象表示将要基于其构建图像的数据。</font><font style="vertical-align: inherit;">您可以使用命令进行验证</font></font><code>fig.data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">滑块创建</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这里，我们将创建一个滑块，借助该滑块可以组织在地图上可视化的数据选择。</font><font style="vertical-align: inherit;">以下是相关代码：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># </span><font></font>
steps = []<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(fig.data)):<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;step = dict(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method=<span class="hljs-string">"restyle"</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args=[<span class="hljs-string">"visible"</span>, [<span class="hljs-literal">False</span>] * len(fig.data)],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label=date_list[i],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;step[<span class="hljs-string">"args"</span>][<span class="hljs-number">1</span>][i] = <span class="hljs-literal">True</span>&nbsp; <span class="hljs-comment">#  i-     "visible"</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;steps.append(step)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<font></font>
sliders = [dict(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;active=<span class="hljs-number">0</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;currentvalue={<span class="hljs-string">"prefix"</span>: <span class="hljs-string">"Date: "</span>},<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;pad={<span class="hljs-string">"t"</span>: <span class="hljs-number">1</span>},<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;steps=steps<font></font>
)]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
滑块代码由两个主要片段组成。</font><font style="vertical-align: inherit;">第一个是循环，其中填充</font></font><code>steps</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">了移动滑块时使用</font><font style="vertical-align: inherit;">的列表</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">移动滑块时，相应的数据集将可视化，并且之前显示的内容将被隐藏。</font><font style="vertical-align: inherit;">该代码的第二部分是</font></font><code>steps</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在滑块对象中</font><font style="vertical-align: inherit;">包含先前构造的列表</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">当滑块移动时，它将从中选择相应的元素</font></font><code>steps</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映射输出并将其另存为HTML文件</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在我们来介绍材料的最后一部分。</font><font style="vertical-align: inherit;">在这里，我们讨论如何显示地图以及如何将其保存为HTML格式。</font><font style="vertical-align: inherit;">这是实现这些操作的代码：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#    </span>
fig.data[<span class="hljs-number">0</span>].visible=<span class="hljs-literal">True</span><font></font>
<font></font>
<span class="hljs-comment">#       HTML</span>
fig.update_layout(sliders=sliders,title=<span class="hljs-string">'Coronavirus Spreading Map'</span>+<span class="hljs-string">'&lt;br&gt;geodose.com'</span>,height=<span class="hljs-number">600</span>)<font></font>
fig.show()<font></font>
go_offline.plot(fig,filename=<span class="hljs-string">'F:/html/map_ncov.html'</span>,validate=<span class="hljs-literal">True</span>, auto_open=<span class="hljs-literal">False</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当显示地图时，第一个数据集的视觉表示是可见的。</font><font style="vertical-align: inherit;">然后，我们根据滑块的位置更新地图的内容。</font><font style="vertical-align: inherit;">在这里，我们设置地图标题并调整其高度。</font><font style="vertical-align: inherit;">在最后一步，我们使用方法显示地图</font></font><code>fig.show</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，然后</font><font style="vertical-align: inherit;">使用方法</font><font style="vertical-align: inherit;">将其保存为HTML </font></font><code>go_offline.plot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完整的项目代码</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这是用于创建类型为2019-nCoV的冠状病毒分布图的完整项目代码。</font><font style="vertical-align: inherit;">请注意，负责保存地图HTML版本的最后一行需要进行编辑，用与您相关的路径替换那里指定的路径。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> plotly.offline <span class="hljs-keyword">as</span> go_offline
<span class="hljs-keyword">import</span> plotly.graph_objects <span class="hljs-keyword">as</span> go
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<font></font>
<font></font>
<span class="hljs-comment"># </span>
url=<span class="hljs-string">'https://docs.google.com/spreadsheets/d/18X1VM1671d99V_yd-cnUI1j8oSG2ZgfU_q1HfOizErA/export?format=csv&amp;id'</span><font></font>
data=pd.read_csv(url)<font></font>
data=data.fillna(<span class="hljs-number">0</span>)<font></font>
<font></font>
<span class="hljs-comment">#  </span><font></font>
fig=go.Figure()<font></font>
col_name=data.columns<font></font>
n_col=len(data.columns)<font></font>
date_list=[]<font></font>
init=<span class="hljs-number">4</span>
n_range=int((n_col<span class="hljs-number">-5</span>)/<span class="hljs-number">2</span>)<font></font>
<font></font>
<span class="hljs-comment">#,          </span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(n_range):<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;col_case=init+<span class="hljs-number">1</span>
&nbsp;&nbsp;&nbsp;&nbsp;col_dead=col_case+<span class="hljs-number">1</span>
&nbsp;&nbsp;&nbsp;&nbsp;init=col_case+<span class="hljs-number">1</span>
&nbsp;&nbsp;&nbsp;&nbsp;df_split=data[[<span class="hljs-string">'latitude'</span>,<span class="hljs-string">'longitude'</span>,<span class="hljs-string">'country'</span>,<span class="hljs-string">'location'</span>,col_name[col_case],col_name[col_dead]]]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;df=df_split[(df_split[col_name[col_case]]!=<span class="hljs-number">0</span>)]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lat=df[<span class="hljs-string">'latitude'</span>]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lon=df[<span class="hljs-string">'longitude'</span>]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;case=df[df.columns[<span class="hljs-number">-2</span>]].astype(int)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;deaths=df[df.columns[<span class="hljs-number">-1</span>]].astype(int)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;df[<span class="hljs-string">'text'</span>]=df[<span class="hljs-string">'country'</span>]+<span class="hljs-string">'&lt;br&gt;'</span>+df[<span class="hljs-string">'location'</span>]+<span class="hljs-string">'&lt;br&gt;'</span>+<span class="hljs-string">'confirmed cases: '</span>+ case.astype(str)+<span class="hljs-string">'&lt;br&gt;'</span>+<span class="hljs-string">'deaths: '</span>+deaths.astype(str)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;date_label=deaths.name[<span class="hljs-number">7</span>:<span class="hljs-number">17</span>]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;date_list.append(date_label)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment">#  Scattergeo</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;fig.add_trace(go.Scattergeo(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;name=<span class="hljs-string">''</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lon=lon,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lat=lat,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;visible=<span class="hljs-literal">False</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;hovertemplate=df[<span class="hljs-string">'text'</span>],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;text=df[<span class="hljs-string">'text'</span>],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;mode=<span class="hljs-string">'markers'</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;marker=dict(size=<span class="hljs-number">15</span>,opacity=<span class="hljs-number">0.6</span>,color=<span class="hljs-string">'Red'</span>, symbol=<span class="hljs-string">'circle'</span>),<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;))<font></font>
<font></font>
<font></font>
<span class="hljs-comment"># </span><font></font>
steps = []<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(fig.data)):<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;step = dict(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method=<span class="hljs-string">"restyle"</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args=[<span class="hljs-string">"visible"</span>, [<span class="hljs-literal">False</span>] * len(fig.data)],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label=date_list[i],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;step[<span class="hljs-string">"args"</span>][<span class="hljs-number">1</span>][i] = <span class="hljs-literal">True</span>&nbsp; <span class="hljs-comment">#  i-     "visible"</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;steps.append(step)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<font></font>
sliders = [dict(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;active=<span class="hljs-number">0</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;currentvalue={<span class="hljs-string">"prefix"</span>: <span class="hljs-string">"Date: "</span>},<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;pad={<span class="hljs-string">"t"</span>: <span class="hljs-number">1</span>},<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;steps=steps<font></font>
)]<font></font>
<font></font>
<span class="hljs-comment">#    </span>
fig.data[<span class="hljs-number">0</span>].visible=<span class="hljs-literal">True</span><font></font>
<font></font>
<span class="hljs-comment">#       HTML</span>
fig.update_layout(sliders=sliders,title=<span class="hljs-string">'Coronavirus Spreading Map'</span>+<span class="hljs-string">'&lt;br&gt;geodose.com'</span>,height=<span class="hljs-number">600</span>)<font></font>
fig.show()<font></font>
go_offline.plot(fig,filename=<span class="hljs-string">'F:/html/map_ncov_slider.html'</span>,validate=<span class="hljs-literal">True</span>, auto_open=<span class="hljs-literal">False</span>)</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">摘要</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们已完成对创建交互式地图的指南的审阅，以可视化2019-nCoV型冠状病毒的分布。阅读完这些材料后，您学习了如何从Google的公共电子表格中读取数据，如何使用Pandas处理数据，以及如何使用滑块和Plotly在交互式地图上可视化这些数据。可以</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">从此处</font></a><font style="vertical-align: inherit;">下载HTML页面的项目</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果。</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">地图上显示的信息取决于数据表。</font><font style="vertical-align: inherit;">每次执行项目代码时，都会更新地图，并且表上的新数据将变为可用状态。</font><font style="vertical-align: inherit;">这是一个非常简单的地图。</font><font style="vertical-align: inherit;">有很多方法可以改善它。</font><font style="vertical-align: inherit;">例如，可以用其他图形，一些摘要数据等进行补充。</font><font style="vertical-align: inherit;">如果您有兴趣，那么您可以自己做更多的事情。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">亲爱的读者们！</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您使用Jupyter Notebook技术执行哪些任务？</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN487676/index.html">新的ZX Spectrum游戏竞赛-您的游戏6</a></li>
<li><a href="../zh-CN487678/index.html">国际会议PGConf.Russia 2020的边注。要点和幻灯片</a></li>
<li><a href="../zh-CN487680/index.html">全面分析ShAD-2019考试</a></li>
<li><a href="../zh-CN487682/index.html">关于提高JavaScript代码可靠性的7条建议</a></li>
<li><a href="../zh-CN487684/index.html">在Vue.js上开发更快的应用程序</a></li>
<li><a href="../zh-CN487690/index.html">PHP摘要173号（2020年1月27日至2月10日）</a></li>
<li><a href="../zh-CN487694/index.html">虚拟私有云如何托管Yandex.Cloud，以及我们的用户如何帮助我们实现有用的功能</a></li>
<li><a href="../zh-CN487696/index.html">2月10日至16日在莫斯科举行的数字活动</a></li>
<li><a href="../zh-CN487698/index.html">2月10日至16日在圣彼得堡举行的数字活动</a></li>
<li><a href="../zh-CN487702/index.html">机器学习文章精选：案例研究，指南和2020年1月的研究</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>