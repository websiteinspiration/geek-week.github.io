<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔞 🐻 👨🏾‍💻 Zabbix: la topologie du réseau est claire et automatique 🗑️ ⁉️ 🛀🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Gérer un réseau plus grand qu'un hôte local? Vous ne contrôlez pas, mais vous voulez apprendre? Nous vous invitons au cours «Linux. Niveau 5. Zabbix. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Zabbix: la topologie du réseau est claire et automatique</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/486814/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gérer un réseau plus grand qu'un hôte local? Vous ne contrôlez pas, mais vous voulez apprendre? Nous vous invitons au cours </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">«Linux. Niveau 5. Zabbix. Surveillance de l'infrastructure informatique d'une entreprise</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">»</font></a><font style="vertical-align: inherit;"> Lors du séminaire gratuit du centre de formation spécialisée de l'Université technique d'État Bauman de Moscou, vous apprendrez à enseigner à Zabbix à surveiller automatiquement le réseau: rechercher des nœuds existants et en ajouter, dessiner et mettre à jour la topologie. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/iv/1c/ut/iv1cutamccowubgbjxpirduuwwe.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le séminaire sera organisé par l'enseignant principal du centre "spécialiste" du Bauman MSTU, principal administrateur système du réseau du MSTU. N.E.Bauman Vyacheslav Aleksandrovich Lokhturov. Inscrivez-vous (ou regardez les enregistrements) pour nos </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">séminaires gratuits</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bonjour à tous! </font><font style="vertical-align: inherit;">Je m'appelle Vyacheslav Lokhturov. </font><font style="vertical-align: inherit;">Je travaille comme ingénieur à l'Université technique d'État Bauman de Moscou. </font><font style="vertical-align: inherit;">Depuis l'obtention de mon diplôme en 1997, je travaille comme ingénieur. </font><font style="vertical-align: inherit;">En même temps, j'enseigne au centre de formation n ° 1 "spécialiste" - une entreprise qui est sympathique MSTU. </font><font style="vertical-align: inherit;">De nombreux autres enseignants et employés y travaillent. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le thème du webinaire fera partie de mon travail d'ingénieur - un merveilleux système de surveillance ...</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Topologie du réseau: historique, Baumanka Wikipedia, sources</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'enregistrement du webinaire peut être consulté à ce lien: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://wiki.val.bmstu.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - un format wiki. Mes adresses e-mail sont: val@bmstu.ru, val@specialist.ru. Ce </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tutoriel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que j'utilise en tant qu'ingénieur. Il existe de nombreux matériaux différents. Si vous ne l'aimez pas, il y a beaucoup de documents sur Internet sur votre sujet avec nous («Zabbix»). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Du point de vue du matériel pédagogique et de l'enseignement, j'utilise la section "Matériel sur la méthodologie des cours de lecture": </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dx/xt/bc/dxxtbcel7fbzpfzncdnohifiopy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et il y a une section avec des webinaires. Pour chacune de mes lectures, il y a un record ici: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/y9/sy/on/y9syon5yqio6tinrekmuwju2qec.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
j'ai immédiatement dit: «Si nous le faisons, faisons le plus cool! Montrons comment la topologie du réseau est automatiquement construite dans Zabbix. Dans 45 minutes, je dois dire ceci.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Concernant la topologie du réseau: au Bauman MSTU un immense réseau; en conséquence, la topologie du réseau est ce dont nous avions vraiment besoin depuis longtemps. Historiquement, Zabbix n'était pas le système que nous utilisions au stade initial. Comme tous les gens de départements comme l'informatique, la gestion, les systèmes informatiques, les complexes et les réseaux, nous aimions tous nous programmer nous-mêmes, et maintenant nous programmons ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons un petit Wikipédia qui est utilisé pour le travail. Et parmi les éléments de ce Wikipedia, il y a une section consacrée à la commutation de réseau. L'accès à ce Wikipedia est toujours fermé par un petit VPN: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nw/th/kw/nwthkwj2jsj-srqt6xkqrvgpps0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
je vais maintenant vous montrer à quoi ressemble la topologie du réseau dans notre université. Cela vaut la peine de le voir; puis comparer avec le résultat:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ma/a2/7h/maa27hc-e9fct-_lqqkig-pn6gs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il me semble que tout est clair: tous les commutateurs et leur chemin vers le commutateur racine; </font><font style="vertical-align: inherit;">si quelque chose manque, nous récupérerons rapidement de ce fichier texte. </font><font style="vertical-align: inherit;">La topologie du réseau est construite au quotidien. </font><font style="vertical-align: inherit;">Tout va bien, mais pas spectaculaire, bien sûr. </font><font style="vertical-align: inherit;">C'est difficile à vendre. </font><font style="vertical-align: inherit;">Par conséquent, nous avons un tel programme à l'université.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La topologie du réseau est nécessaire lorsqu'un commutateur a disparu. </font><font style="vertical-align: inherit;">Pour comprendre où il était connecté</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons essayer de voir quelque chose de plus spectaculaire. Et une certaine référence à ce que nous ferons est cet article sur le forum: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kj/an/rq/kjanrq-tf4gagfaq3sclcshi7ji.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/5r/uw/v-/5ruwv-zvi6w7keseask1zaxrctm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il indique qu'il existe une sorte de script merveilleux écrit dans mon ancienne langue préférée Perl, que l'équipement réseau interroge, en fait conclusions et alimente miraculeusement les résultats à Zabbix. Mais nous n'utiliserons pas Perl, mais nous utiliserons autre chose. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous disons au revoir à ce que nous avons. Passons à la pratique. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fu/jf/vx/fujfvxfzwxeijmvenkvnsghzxzs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je serai heureux si vous pouvez reproduire tout cela à la maison et essayer de vous préparer à tout cela. Après le webinaire, vous voudrez tout répéter et commencer par le fait que vous devez déployer Zabbix, une machine virtuelle, un réseau. Comment faire ça?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À la maison, vous tapez la commande ipconfig et vous voyez que vous avez un tel réseau IP à la maison (peut-être un autre, mais le plus souvent celui-ci): j'ai ici la </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nw/0m/sd/nw0msdf_bqqc1rbf2v9poyhvd8m.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cinquième adresse (192.168.1.5), et vous pouvez avoir la 20e ou la 30e ... Il y a sûrement un routeur Wi-Fi qui délivre ces adresses. </font><font style="vertical-align: inherit;">Par conséquent, je vais maintenant dessiner une topologie basée sur ce qui peut être dans votre maison afin que vous puissiez la reproduire:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z_/il/pv/z_ilpvbesmx9x8x0ntvfyvgz6by.jpeg"><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous avez un routeur WIFI.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le système dans lequel vous souhaitez jouer le webinaire.</font></font></li>
<li>  192.168.1/24 – 1-  WI-FI-,  5-, , –   .<br>
   .   ,    –   ,     2, 10, 20 ,     .  ,   linux-,    «».            ,     100. ,       192.168.1.100.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Où trouver une voiture? </font><font style="vertical-align: inherit;">Rien n'empêche de prendre la distribution Linux. </font><font style="vertical-align: inherit;">Je suis un grand fan de cette distribution. </font><font style="vertical-align: inherit;">Nous n'élèverons pas d'holivars - je l'aime, je le choisis, je l'utilise dans les cours. </font><font style="vertical-align: inherit;">Vous pouvez prendre et installer à partir de ce site: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fw/0p/7_/fw0p7_zevdd2b-hy4_myzkofi78.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin que nous ne passions pas 45 minutes à installer Debian, je vais prendre une image pré-installée prête à l'emploi. </font><font style="vertical-align: inherit;">Qui en a besoin - écrivez à l'e-mail, je vous enverrai cette image, bien qu'il n'y ait rien de particulièrement remarquable (juste pour ne pas perdre de temps à installer): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hd/sv/ju/hdsvju1d3xv2tlcppgmw7ze0fhk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pendant qu'elle est installée, vous pouvez voir la section dans le manuel ...</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Déploiement du stand</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a une histoire à propos de la commande ipconfig: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uz/3m/a3/uz3ma3gdidyrxl4ni-foi1xerse.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et puis, lorsque la machine se retourne: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1r/by/6n/1rby6nfa4-ie37px_jgo2gzdmsg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez donner un nom dans les paramètres, lui donner plus de RAM: Il </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yb/ru/el/ybruel8q66rozvw0tlyjxg3gaxy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
existe différentes virtualisations - VirtualBox est bon pour un usage domestique. Dans l'entreprise, nous et mes amis utilisons VSphere (nous sommes très satisfaits du produit de VMware), mais il y a plus qu'assez de cours pour VirtualBox. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Réseau: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9s/ie/ao/9sieaok8u0wwjefjyo8fgmze0y4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puisque nous disons que cette machine sera connectée à notre réseau, nous pouvons travailler avec elle - elle doit être connectée par un pont à un adaptateur physique. Je régénérerai l'adresse Mac. Je lance notre machine virtuelle:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jx/tu/vw/jxtuvw-er7hyjbhh8de-zowhqcg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et après avoir commencé, je fais une configuration. </font><font style="vertical-align: inherit;">Le manuel répertorie les fichiers à éditer: attribuez un nom à la machine, il est souhaitable d'éditer le fichier hosts, resolv.conf (responsable du client DNS) et l'adresse IP choisie par nous - ces quatre fichiers doivent être édités. </font><font style="vertical-align: inherit;">J'essaierai de le faire le plus rapidement possible.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Déploiement Zabbix</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le mot de passe de cet utilisateur (root) est immédiatement défini dans l'image - ne l'utilisez jamais en pratique! Pour gagner du temps, j'utilise un compte privilégié: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cf/dk/mt/cfdkmtiq3gditwh0q8d5obxhqyw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
le manuel répertorie les fichiers à éditer. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ou/ww/7a/ouww7abmkynaldx0c53orqbq1fi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, je donne le nom à notre machine (serveur de surveillance Zabbix): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/o7/aw/ey/o7aweyooy2otoditfxa76k4g6dw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fichier Hosts: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xk/zu/m3/xkzum3abl5tgowzag-aq0eew_us.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Changez l'adresse au 100ème et le nom de notre domaine inventé (chaque auditeur de nos cours a le sien, individuel, comme un réseau avec un domaine): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/im/sk/g3/imskg32tktggjcqyi-ue7phl_ww.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que reste-t-il? Resolv.conf (client DNS): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dj/_d/pb/dj_dpbav7eoi7w59gjgnaclace4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Corp1.un se connectera aux noms courts et votre routeur WIFI fonctionnera généralement comme un serveur DNS: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nc/ao/mv/ncaomvyveyk93fjj6zklqzpvfni.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que reste-t-il? Le fichier volumineux le plus important est le réseau / les interfaces. Voici un modèle pour différents cours, de nombreuses interfaces:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dm/yw/ak/dmywakkly3qdswu_mkrpp1dxy0u.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais notre voiture aura une seule interface. </font><font style="vertical-align: inherit;">Ce sera un serveur de surveillance avec la 100e adresse et aller sur Internet par le 1er: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2h/og/jv/2hogjvlx7gd5uxfxlvgmbalopdq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peut-être, il n'est pas nécessaire, mais plus rapide d'utiliser tous les fichiers - redémarrez la machine.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installer et démarrer un service dans Debian</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les Zabbiks peuvent être installés de différentes manières. Selon Zabbix, il existe un excellent site Web avec de la documentation (en passant, en russe, la section active est prise en charge). En conséquence, diverses options sont proposées ici. Je suis un grand partisan de l'installation de logiciels à partir d'un référentiel régulier. Ce n'est pas une coïncidence, c'est pourquoi j'ai choisi Debian: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-9/eu/2c/-9eu2cfgrndehx_bvjyjxo_gjwg.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/pk/ha/la/pkhalax-z8jy1_vivipznmnozem.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au fait, si tout est bien fait, maintenant je devrais pouvoir me connecter à mon système. Essayons de le faire. Je prends mon client SSH préféré et me connecte au système 192.168.1.100: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sf/me/tr/sfmetrwaaftvvrjxe9jetdjpv3a.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chanceux: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/re/qe/zb/reqezbzkzbnynazdnxp9blstocq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encore une fois, il n'est pas très correct que la racine soit autorisée ici: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bu/5j/_e/bu5j_eloihgsp4_8heomyuedskc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ne faites jamais cela dans une entreprise! Voici seulement un gain de temps.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/en/kr/k6/enkrk6smoeftphgdxai8xooemcu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous devons maintenant installer Zabbix. </font><font style="vertical-align: inherit;">Étant un grand amoureux et partisan de l'utilisation des logiciels de base et un adversaire de la connexion de tout référentiel tiers, je mettrai la version qui se trouve dans cette Debian. </font><font style="vertical-align: inherit;">Encore une fois, merci aux auteurs de "Debian" - composez simplement l'installation d'un tel paquet: je </font></font><br>
<br>
<img src="https://habrastorage.org/webt/id/ad/4z/idad4z6qgksfxjtpl0zh8z6wu3c.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
me </font><font style="vertical-align: inherit;">suis </font><font style="vertical-align: inherit;">souvenu d'une dernière chose! </font><font style="vertical-align: inherit;">Nous venons d'installer le système - nous devons synchroniser le référentiel (mise à jour apt): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/su/ho/1w/suho1w8zayqwukaczax17o2acgo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, il suffit de taper la commande d'installation de zabbix-server avec prise en charge de la base de données (DB) de vos informations dans SQL, car de nombreux composants seront installés (quelques minutes devraient être consacrées à l'installation) :</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hj/1y/ok/hj1yokti8khkpotcwlzkfu-lnji.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En quoi consiste Zabbix</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zabbix se compose des composants suivants:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serveur "Zabbix";</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il travaille activement avec la configuration, que nous allons configurer manuellement et automatiquement;</font></font></li>
<li>      ,       ;        MySQL (   –   ),    ( «»      – PostgreSQL,  Oracle ).</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour que nous puissions travailler avec Zabbix, le soi-disant frontend est utilisé. Frontend Zabbix est une application écrite probablement en PHP (peut-être pas tout, mais la plupart). En conséquence, l'application elle-même utilise un serveur Web. Jusqu'à présent, seule cette partie a été mise (maintenant nous attendrons son installation): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-p/f7/x1/-pf7x13a5ap9clor_mxdrs3nj2i.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminé. Maintenant, puisque Zabbix utilise la base de données, nous devons la créer en suivant la documentation. Pour créer une base de données, j'utiliserai un script simple: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/az/7j/lz/az7jlzl5ymcajcp1lkhebgv1nxa.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
je ne détaillerai pas quelles commandes signifient quoi. Si quelqu'un a travaillé avec le SGBD, il verra quelque chose de familier - le nom de la base de données et ainsi de suite ... </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6v/bd/kk/6vbdkkjydgvlkrnslc9_6s5xvr0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, en utilisant ce script, je crée la base de données:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/9-/ds/v2/9-dsv2o62nrjbkpzx6jevg4ax_q.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et remplissez cette base de données avec des métadonnées. Il y a plusieurs fichiers qui décrivent quelles tables doivent être, quels attributs, paramètres, etc. (tout cela est fait, encore une fois, selon la documentation): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zj/31/sd/zj31sdartmnaavfhghqy7im32bq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
c'est-à-dire que maintenant dans MySQL nous empilons des métadonnées que Zabbix utilisera pour stocker la configuration et les résultats: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ro/1p/0b/ro1p0baiwev54t9ttf1k-36zyj4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Non Je vais passer du temps à regarder ce qu'il va créer là-bas (il y aura un grand nombre de tableaux créés). Zabbix en tant que produit se développe depuis plus de dix ans et s'efforce constamment de devenir de mieux en mieux, la structure des données y est donc assez lourde. Mais tout cela est «sous le capot». En tant qu'administrateurs, nous travaillerons avec une application frontale externe, avec laquelle tout sera simple, clair et accessible.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selon la documentation, pour une raison quelconque, plusieurs fichiers. Mais comme ils l'ont fait, cela signifie qu'ils savent de quoi ils ont besoin! La base de données est prête: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ql/sf/pg/qlsfpgwecdjkq43bvi7-ddnbr4q.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
maintenant, selon la documentation, ce composant doit être expliqué: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/u-/n0/vl/u-n0vlfpaz12mtjtdkvjekaf1za.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
expliquez qu'il devrait fonctionner avec la base de données, en se connectant sous un identifiant et un mot de passe spécifiques. Cela se fait via le fichier de configuration: </font><font style="vertical-align: inherit;">
Insérer à la </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5x/pm/aa/5xpmaappvlhi6dtjmzb90m8dbb4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fin du fichier: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/89/gh/ul/89ghulcpbzbzw913qbznnaecsjm.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/n8/oo/_y/n8oo_yuz-elzo7w8scuvnwsjxo8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous décrivons ici que le serveur de base de données est ici sous notre compte: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/u5/vt/wi/u5vtwiauap-aibs5mbmgersdnji.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">«Debian» -package pour «Zabbix» ne signifie pas le démarrage automatique. Voici une équipe du grand et terrible SystemD, sur laquelle il existe un grand nombre d'holivars: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4t/mw/_9/4tmw_9on0khv1_i8flmuoufthkm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il rend le lancement de Zabbix automatique après le démarrage du serveur. Lancez Zabbix: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/66/kt/aj/66ktajsilnljqvtg8rff03vw5ki.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ces deux composants sont en cours d'exécution:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jf/pp/ih/jfppihb3mhcy6oc9ma6rzmxhqsy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez déjà surveiller, remplir la configuration. </font><font style="vertical-align: inherit;">Mais il est difficile de faire quelque chose de bien jusqu'à ce que le frontend soit défini ... Cependant, au début - l'étape manquée ...</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Déploiement Zabbix </font><font style="vertical-align: inherit;">Localisation du fuseau horaire</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai déplié l'image et le mauvais moment: la </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xu/mw/-r/xumw-rual8waq_g1bs36hd660g8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
date est correcte. </font><font style="vertical-align: inherit;">Notre fuseau horaire est incorrect, alors je l'ai corrigé en un clin d'œil:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/if/st/aq/ifstaqnjg4rrepsxshjhw_4o9p0.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se rendre au frontend. </font><font style="vertical-align: inherit;">Installation et lancement de l'interface Web</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Debian devrait installer un tel paquet (après l'installation du serveur web Apache): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/al/pt/i5/alpti55pbgnyvxlkwg6cusjayje.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PHP, une bibliothèque pour connecter des programmes écrits en PHP avec MySQL, sera installé. En général, je lance: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oh/fx/ow/ohfxown1obtvst8-eqn988l5kjy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous n'avez pas besoin d'effectuer d'actions pendant longtemps, tout sera fait automatiquement: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fd/gr/6q/fdgr6qma4k3n_ii43xiia9xpkmc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nous installons ce composant - le frontend Zabbix; un serveur Web, et nous lui expliquerons qu'il doit travailler avec le serveur Zabbix et le SGBD: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vu/xo/by/vuxobykpvrchotjwrd6locuvp7e.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
via le serveur Web, nous gérerons le Zabbix et à travers lui, nous verrons ce qu'il y a surveillé.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est presque établi et nous allons maintenant voir qu'il a une relation étroite avec notre pays. </font><font style="vertical-align: inherit;">Il a été développé comme une application d'une personne qui travaillait dans une banque. </font><font style="vertical-align: inherit;">Il a décidé de mettre en place un suivi et l'a pris et a écrit son programme au lieu d'utiliser celui terminé. </font><font style="vertical-align: inherit;">Il a travaillé à Riga, et vous et moi sommes à Moscou: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rd/p-/uu/rdp-uuppjegozljjxljdvkcyctk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce fichier ↑ l'initialisation PHP est nécessaire ↓ pour ce faire: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/af/zd/w6/afzdw6duwvdchcizhxre6pg-owm.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/n9/uv/11/n9uv119oq-21nip3nyevkey0c50.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
je ne vais pas approfondir la façon dont l'application web est configurée dans Debian. </font><font style="vertical-align: inherit;">Il suffit de connecter la configuration issue du package Zabbix et de redémarrer le serveur Web Apache:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cj/wq/dw/cjwqdwnivhxabf6kbey1qs3yyso.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connectez-vous au frontend pour configurer Zabbix</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Presque prêt à se connecter au frontend. </font><font style="vertical-align: inherit;">Il ne reste plus qu'à lui expliquer où se trouve le serveur de base de données. </font><font style="vertical-align: inherit;">Il y a deux options, et nous le ferons via l'assistant. </font><font style="vertical-align: inherit;">Pour cela, vous avez besoin d'un fichier dans lequel les configurations seront écrites: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/np/hh/1i/nphh1imvszjdktstdx-insdzihs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un serveur Web doit avoir des autorisations d'écriture sur ce fichier: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/x7/dj/_o/x7dj_oz6sci-rbq_xqem-hyt_sg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après quoi, vous pouvez essayer de vous connecter dans un navigateur. </font><font style="vertical-align: inherit;">Vous pouvez par adresse IP. </font><font style="vertical-align: inherit;">Mon DNS est configuré, je vais donc saisir cette opportunité: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/0n/1h/lf/0n1hlfvvisfesceo4d-rv2mra7g.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons l'assistant Zabbix, où je clique sur Suivant, car la plupart l'ont déjà installé: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5m/co/dc/5mcodckrskfsyf0rlu0omicrlnc.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/qo/qt/o_/qoqto_wcxr0gc_kwsr3ia12muhw.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/5w/1r/pu/5w1rpu_jvw5veghgbvrjltn722g.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/zg/jw/ng/zgjwngenwdojjj-jkx6um7kfnaa.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/li/i7/t2/lii7t2ybvosn2l1dg0wc4tf2exm.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/lz/gv/va/lzgvvams559x1iofedcqifizxy0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre Zabbix est prêt à se connecter. </font><font style="vertical-align: inherit;">Nous entrons le nom d'utilisateur et le mot de passe: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jx/tf/53/jxtf53atwbmrcyx9pjsiaqauffy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configuration, hôtes ... Ne surveille aucun hôte - "Zabbix" n'est jusqu'à présent prêt à se surveiller que si nous installons l'agent Zabbix:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/58/97/zv/5897zvb2kgkutggf-ccxvkpqlsy.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Développez le nuage de commutateurs</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais il n'y aura pas d'agent Zabbix pour notre webinaire. C'est trop simple et sans intérêt! Vous et moi surveillerons un réseau distribué, des chaînes de commutateurs de communication, nous avons donc besoin de cette chaîne de commutateurs. Où les obtenir? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai suggéré d'utiliser la virtualisation Virtual Box. Il vous permet d'émuler des PC (ordinateurs), et maintenant je vais vous présenter un autre émulateur, également utilisé dans nos cours. Un excellent produit est appelé Simulateur de réseau graphique (GNS): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/be/f8/d_/bef8d_bgqsw6r8xweossqbswqp8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cet émulateur vous permet d'émuler un équipement Cisco. Ici, nous déploierons notre nuage de commutateurs. Il sera nécessaire de retrouver le nom du projet (sauvegardons la configuration, et si demain est nécessaire):</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vr/cw/xi/vrcwxiidkq-rt6rlkrw3bohkee8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous voulez apprendre à travailler avec des équipements Cisco à la maison, installez ce GNS par vous-même et faites comme nous le faisons lors du séminaire, à savoir, nous allons maintenant déployer un nuage de commutateurs. Le problème est que GNS n'a pas de commutateurs (il n'y a pas d'émulation ici) - seulement une émulation de routeur. Par conséquent, nous devons mettre le routeur (faites glisser avec le curseur de la souris): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3q/kf/w9/3qkfw98g1cll_antal4ffvb3j8e.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et en quelque sorte en faire un commutateur. Comment faire une émulation de commutateur dans GNS? Nous devons prendre le routeur de la 36e série. Vous pouvez l'appeler un commutateur (clic droit sur le commutateur): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ds/hg/zr/dshgzra7cwuo96scx-s5vzxxgmc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez dessiner un commutateur: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dw/zb/xk/dwzbxklfnlvwgmewwyagg9ax61s.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/kh/ht/zl/khhtzlj_kwjdmmgofbbzrs1yove.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/v8/ly/wa/v8lywaans322t7f3vnrllvhidic.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ressemble à? Mais cela ne deviendra un véritable interrupteur que lorsque vous y ajouterez une telle carte:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ci/x9/qk/cix9qkmxc6ow8v5iwqk-atxl_fu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cette gamme de routeurs Cisco, vous pouvez insérer une carte Ethernet à 16 ports. Et pour un grand nombre de travaux de laboratoire liés aux interrupteurs, cette carte convient parfaitement. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous devons avoir un nuage de commutateurs, alors maintenant je vais faire ce nuage (changer le nom, l'image et insérer le tableau). Commençons par trois commutateurs, et si nous avons le temps, nous en ajouterons un quatrième: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bf/ti/rv/bftirv6azk16f-do5lt1uqntz4m.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
nous nous connecterons, sans viser particulièrement où. Notre topologie devra être construite automatiquement: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/n2/4d/uf/n24dufxk_bsi44_xj95nvga6afi.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/mq/9b/lq/mq9blquvwehjkbmvt5pjlplgsjs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminé: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wj/gt/f8/wjgtf8aqoy1vnx-h2-kiaw8oa7q.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, je commence cette entreprise: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pw/e6/f1/pwe6f1uu9h0idchwsfqj6xpu_ae.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Félicitations à ceux qui regardent pour la première fois comment Cisco fonctionne - afin que vous puissiez configurer rapidement le commutateur Cisco. En attendant, ils démarrent avec nous ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici notre système Windows (Windows 7) et Debian: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/i6/ve/uk/i6veukk0v9begz_gtkanjnx5sme.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici la virtualisation GNS3 et le cloud de commutateurs:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xu/jw/6t/xujw6t_eaje5nbl_56akrkthhwk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, ce qui se passe est clair: deux systèmes de virtualisation sont utilisés dans le cadre d’une machine. Virtualisation des systèmes PC (à droite) et virtualisation des systèmes Cisco (à gauche): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/66/hx/m2/66hxm25qeoexjawmjhhqpxy0yqa.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est nécessaire de faire surveiller le matériel par le serveur: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yo/ek/fz/yoekfz41z6ls3l72ik5yv6hltps.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et pour qu'il puisse le surveiller, cet équipement doit avoir des adresses dans le même réseau: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ve/rk/8x/verk8xxlqj_ldywe8dgkr7nw974.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par conséquent, sans réfléchir longtemps, je J'ai décidé de donner à ces commutateurs des adresses (points 101, 102, 103 pour les 1er, 2e et 3e commutateurs, respectivement). Le 100ème est notre Linux: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fh/xr/nf/fhxrnfp__tatacrxnf0i1egxato.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
vous pouvez configurer ceci comme suit: allez dans un cours Cisco autorisé et ils vous diront pour peu de frais.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour que le commutateur soit accessible à l'administration, vous devez effectuer les réglages suivants - passer en mode de configuration, donner un nom approprié, attribuer une adresse IP à l'interface et copier le résultat dans la mémoire à long terme: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xr/hs/of/xrhsof2vqmanjxahxyeeuwkitwy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
je préparerai le poisson afin de ne pas y passer beaucoup de temps. Le premier commutateur sera appelé switch1, l'adresse IP est la 101e. Je copie cette configuration sur le commutateur: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/he/4q/tc/he4qtcdsyugl9n7zlbsuvv1vdfm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Double-cliquez sur le commutateur souhaité (maintenant - commutateur1): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ux/ga/d5/uxgad5fmtc4q8xsr5tiry-yhkma.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/gc/mn/75/gcmn75v8xtwb9icgrakorfvo_o4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configurez commutateur1. Maintenant - la configuration pour le deuxième commutateur: appelé switch2, IP - 102: En </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rz/h_/g6/rzh_g6y2i_5c3jxkrm2e3flbu-i.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/w3/5a/p6/w35ap6gewzm3zpsggptzpljb6xc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
conséquence, nous agissons avec le troisième commutateur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh bien, ce sera très cool si non seulement notre serveur est disponible à partir de notre ordinateur Windows, mais aussi ce que nous avons configuré maintenant:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/4y/va/jr/4yvajrk9agiaacpycpxs6ojp6gq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GNS3 est un bon système. </font><font style="vertical-align: inherit;">J'insiste tellement parce qu'il y a assez de problèmes avec ça: c'est un peu buggé, un peu ... Mais pour apprendre, ça suffit. </font><font style="vertical-align: inherit;">Cette pause est alarmante pour moi - j'espère que tout ira bien, et notre commutateur répondra après un certain temps: Mais </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gq/3q/sl/gq3qslehu1-r-_skqokqhowkvqw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
non, il ne répondra pas, peu importe combien j'attends! </font><font style="vertical-align: inherit;">La communication ne suffit pas entre notre ordinateur et GNS. </font><font style="vertical-align: inherit;">GNS lui-même, il manque donc un élément supplémentaire:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/v9/14/vf/v914vfcq1mexkh_tyr96b_b4qe4.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connecter le cloud</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour que ces commutateurs deviennent disponibles, vous devez utiliser l'objet Cloud: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ri/uw/wq/riuwwqk1kguxglmtswubooqglas.jpeg"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aujourd'hui, Cloud l'utilise dans un sens complètement différent. Auteurs GNS en tant que fournisseur de services Internet. Dans les paramètres de cet objet, je peux le connecter à ma carte réseau: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gw/ri/r-/gwrir-quzcq745winbjfqhdry88.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il a l'air effrayant, mais c'est la même carte réseau: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yl/zq/ux/ylzquxupsoni1diu2tm2zuwbbwc.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/lb/pl/sk/lbplskyzgznkrrla6utigrs0qr0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
je mets Cloud. Maintenant, vous devez connecter l'un des commutateurs au Cloud (seulement alors une connexion peut apparaître): je </font></font><br>
<br>
<img src="https://habrastorage.org/webt/e9/kz/40/e9kz40sqnsx0avn3qmpijjuc7lu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
soupçonne que dans notre cas, il est plus rapide de redémarrer le commutateur pour que tout soit en place. La seule chose que je veux m'assurer que sa configuration est enregistrée. Soit dit en passant, à l'intérieur des commutateurs ping devraient déjà aller: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/v6/dl/hw/v6dlhwwha_rpetf4u-mvds8sqkg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Real Cisco! Le premier paquet disparaît, tout le reste est là:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ju/nm/dz/junmdzk7lnakhvcrpzjmmkydkgm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, ce n'est pas l'émulation naturelle qui est utilisée ici, mais iOS. Par conséquent, j'arrête le 1er interrupteur et recommence: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nq/vf/vo/nqvfvonfdf78rrmvlfy2bti50t4.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/e-/hl/jo/e-hljocq_u863hcwtqwuoy7ulzi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
si tout est en ordre, alors nous devrions voir la connexion via le cloud - mon Windows 7 sera connecté à cet équipement via une carte réseau (l'équipement a des adresses IP sur le même réseau que Windows) . En général, c'est le point de connexion entre GNS et Windows. Vérifions qu'il y a une connexion: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/db/vo/dh/dbvodhj8-wdkwxqf4iycwymwheu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons comment il se sent ... De là, il répond: Putain </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lr/zm/or/lrzmorkfuglvex1hz7ir5togsti.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
! Vous voyez, la connexion est apparue: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-c/hr/gh/-chrghapsw8pu8kmycxcjyixida.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
j'adore GNS car c'est gratuit, ça marche ... Mais tout n'est pas simple! Voici une situation amusante: notre Linux répond au système Windows, notre commutateur répond à Windows, mais le commutateur ne répond pas au système Linux:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1f/wu/re/1fwureh4q3tz4quhdcm7nybwwh8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, l'enseignant peut devenir gris! Vous dirigez une leçon, mais le stand ne fonctionne pas pour les gens ... Eh bien, rien, nous allons convaincre! Gratuit, bon marché et joyeux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'expérience a montré: pour que la connexion soit entre les trois éléments (de Windows - à Linux, de Linux - à GNS), vous devez aller dans les paramètres de la carte réseau et sélectionner l'option étrange - "Mode inaudible" ("Autoriser tout"): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fp/w8/op/fpw8opcow_frnq3ph1ksbtivq6w.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/jr/jv/ve/jrjvveot5clomchekaw9_xmyxc0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Venez à Virtualisation! Ce mode aveugle est dans toutes les décisions (et dans la "Sphère" aussi). Il est associé au passage de paquets Ethernet, d'adresses mac, etc. Allez bien sûr sur la virtualisation, les détails sont là. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous redémarrons notre système dans l'espoir que la connectivité sera rétablie: ce </font></font><br>
<br>
<img src="https://habrastorage.org/webt/my/8t/cy/my8tcyvvejsf5bt-cb5sh-va_lu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
n'est que maintenant qu'il sera possible de configurer la surveillance de nos commutateurs depuis Zabbix. Voyons comment cela se produit:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ge/ku/6m/geku6mzbdiqubhvfjx4pevfuiau.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La fondation est posée. </font><font style="vertical-align: inherit;">Si nous avons une connexion maintenant, alors tout sera prêt. </font><font style="vertical-align: inherit;">Dans "Zabbix", beaucoup de "Tsiska", intelligemment connectés les uns aux autres - vous pouvez commencer la surveillance. </font><font style="vertical-align: inherit;">Nous nous connectons à l'utilisateur root avec un mot de passe et vérifions le ping: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wq/ln/pc/wqlnpckl6msf6vp_rmiyt_q2a5s.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/g7/9y/8z/g79y8z6hx_bix4mvyje3ju34uia.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout est prêt: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4m/qw/1q/4mqw1qfbb61ytex0d4ldrwaklee.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En tant qu'administrateur du DNS local, j'ai également permis d'envoyer par ping des noms.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment Zabbix peut-il surveiller les équipements Cisco?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'agent ne peut pas être installé sur l'équipement Cisco. Beaucoup d'entre vous savent que l'équipement Cisco est parfaitement surveillé à l'aide de SNMP. Nous allons maintenant préparer le terrain pour cela. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons maintenant préparer le terrain pour cela. Pour surveiller les équipements à l'aide du protocole SNMP, vous devez d'abord installer la prise en charge SNMP sur le serveur de surveillance lui-même: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rx/pj/d_/rxpjd_oqrxzg3kyshufud5ydoik.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zabbix n'inclut pas cette prise en charge, il utilise des bibliothèques externes incluses dans ces packages: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/y7/6r/v4/y76rv4b1ulvxexqwi69yhhqld1u.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
je ne vous dirai pas ce qu'est la base d'informations de gestion - venir à des cours sur l'interaction de Lunux et Cisco, là, il est décrit en détail. Et maintenant, nous venons de mettre les packages nécessaires à la surveillance sur Linux: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/0x/ze/ed/0xzeedg4nazeeohex3hvh-zqjho.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/yn/lo/pr/ynloprjiladptnptxhd2nowybrc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et nous mettons des éléments de configuration sur notre Cisco qui nous permettront de les surveiller à leur tour.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/u6/yj/yt/u6yjyteqwobo-tckmhdnhm8clt4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, le serveur SNMP démarre simplement avec le mot de passe suivant: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9t/ie/zo/9tiezomf0b9sk_r6tqf3a9hg8zw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et nous le faisons sur nos trois commutateurs: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/k-/cu/-v/k-cu-vr3kzxuq3fcelvdhwyuo3e.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après ces étapes, nous vérifierons si notre serveur de surveillance peut accéder à l'équipement Cisco (n'importe lequel de ces commutateurs) via SNMP et, par exemple, découvrir quelque chose. </font><font style="vertical-align: inherit;">Il existe des options de test ici: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/u6/yj/yt/u6yjyteqwobo-tckmhdnhm8clt4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez interroger nos commutateurs à l'aide des soi-disant OID (identificateurs d'objet). </font><font style="vertical-align: inherit;">Ici, nous interrogeons le commutateur (nous demandons les valeurs du paramètre switch1): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dh/qr/ek/dhqreksw-lbhj1_ky-kitwkcbdu.jpeg"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et nous voyons que cet Oid fait référence au nom du commutateur, c'est-à-dire que nous pouvons retirer son nom de chaque commutateur (c'est très utile pour la topologie): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8e/ro/de/8erodew0gy2koqyma4o2k5xo5qi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et vous pouvez utiliser des textes plus humains, textuels - nous demandons sysName au commutateur (la même chose peut être demandée à partir de switch2, etc.):</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ti/rk/ih/tirkihmj9zh3mbtljm-8mzuuva4.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installer la console SNMP</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une autre action n'est pas évidente: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9l/bh/if/9lbhif1jx-4eees2yl4g2n6sse4.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/rf/xs/2f/rfxs2forhqzmhx1vb1pxzyecjzi.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/5r/c6/qi/5rc6qi5sesktvgwhchqnlk14hwy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
selon l'accord de licence, vous devez commenter les lignes de ce fichier ... Il s'agit d'une merveilleuse commande de pic qui a effacé le contenu du fichier, qui disait: "Pour confirmer la licence, commentez tout ce qui s'y trouve". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conséquence, le serveur Zabbix doit être redémarré car nous avons installé les bibliothèques qui seront utilisées par lui: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nh/n2/rv/nhn2rvgejooztpw-t-6iyqigdjw.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/8u/j9/dw/8uj9dwokqg4-byvjdxbp59fhwdc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beaucoup de gens savent que maintenant il suffit d'entrer dans la section Host, de créer un hôte et de sélectionner le protocole SNMP. </font><font style="vertical-align: inherit;">Spécifiez l'adresse IP:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gz/cs/ug/gzcsuga-vjjumzjitkwe0zvy2ak.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/bi/gv/kc/bigvkcnw1ji20omf739p434dzaa.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais nous ne sommes pas là pour ça. </font><font style="vertical-align: inherit;">Essayons d'obtenir que Zabbix trouve automatiquement tous nos commutateurs. </font><font style="vertical-align: inherit;">Nous en avons trois et à Baumanka, il y en a plus d'une centaine (120, semble-t-il). </font><font style="vertical-align: inherit;">Ce ne serait pas si amusant d'ajouter 100 commutateurs, c'est donc un bonus: nous verrons comment Zabbix trouve nos commutateurs.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajouter automatiquement des appareils à Zabbix</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Page "Ajout automatique de périphériques à Zabbix": </font></font><br>
<br>
<img src="https://habrastorage.org/webt/op/4h/3a/op4h3abcnttdjkx_h-zzpzb0zge.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour ce faire, nous irons dans la section "Configuration" (sous-section Découverte) et nous n'y créerons pas de nouvelle règle, mais nous utiliserons la règle existante:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cela indique correctement que vous devez analyser ce réseau ... Reconnaissez-vous le nôtre? </font><font style="vertical-align: inherit;">Afin de ne pas attendre longtemps, je vous indiquerai une plage limitée de 100-110 (assez pour moi).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Numériser une fois par heure, c'est un peu trop; </font><font style="vertical-align: inherit;">mettre - toutes les 60 secondes.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sur les appareils scannés, notre Zabbix recherche maintenant un agent Zabbix. </font><font style="vertical-align: inherit;">J'ai promis que vous et moi n'aurions aucun agent, alors je le supprime.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et je dis qu'en fait, notre appareil est accessible via SNMPv2, communauté - public; </font><font style="vertical-align: inherit;">nous avons demandé un tel OID:</font></font></li>
<li>       ,     . ,    .       (   ):</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Désormais, chaque minute, Zabbix parcourt ces adresses IP et demande le nom de l'appareil via SNMP. S'il existe un périphérique et prend en charge le protocole SNMP, il répondra: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ha/xg/-o/haxg-ohyxs1bfr23wjr10quhgoa.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cela ne suffit pas pour que nos périphériques apparaissent dans cette liste: vous </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1f/qq/ij/1fqqijogq1obsqxxxnqmd06l6l8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
devez configurer des actions. Nous allons en créer un nouveau (je vais le nommer, en copiant le manuel de formation): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zj/ds/hi/zjdshidzytis9o614hr8ebunnsi.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/qb/vr/7g/qbvr7grb1zx-e375rrkrndjtf0y.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Condition: la demande doit renvoyer des informations indiquant qu'il s'agit d'un commutateur. Par «chance coïncidence», nous avons tous les interrupteurs appelés interrupteur (interrupteur1, interrupteur2, interrupteur3), de sorte que la valeur reçue devrait ressembler (comme) à l'interrupteur: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jo/-q/ww/jo-qwwjs6zrndbxbnzinyj2gxog.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout cela est dans le manuel de formation. Il reste à indiquer quoi en faire - "Opérations": </font></font><br>
<br>
<img src="https://habrastorage.org/webt/z_/q2/bo/z_q2boros4ugh7rmz9gkmg9uico.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, vous devez l'ajouter à un groupe. J'utiliserai le groupe d'hôtes découverts prêt à l'emploi:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/t-/na/jf/t-najf0u9b3jw2js5xuu0mb0gfg.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/gk/lj/7h/gklj7honujvnwncitifax5zcrfy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce qui suit, le plus important, nous devons expliquer ce qu'il faut surveiller sur cet équipement. </font><font style="vertical-align: inherit;">Dans ce cas, nous utiliserons un modèle prêt à l'emploi qui convient à un grand nombre de divers périphériques SNMP: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ze/lw/1n/zelw1nlbpyv9fnu82tieuv7klh0.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/7v/a4/fe/7va4fejt0_p6_m83ru9xsdnr80o.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/km/ca/om/kmcaomawjtebabjjgaofcz1irls.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/2v/ma/et/2vmaet5v9zmyfx-gtmgbzpcyypw.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/bd/_7/4_/bd_74_jpcajgez4osptj4gswxqy.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/j8/x6/jw/j8x6jwcwob9zgdcu4qexixn2kk8.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/6h/do/_o/6hdo_oq76rh6esxpq-yc2hep0s8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
si tout est fait correctement, alors après un certain temps, 3 commutateurs apparaîtront miraculeusement dans notre Zabbix. </font><font style="vertical-align: inherit;">Nous attendons. </font><font style="vertical-align: inherit;">Ils apparaîtront dans la section Hôtes. </font><font style="vertical-align: inherit;">Il y a une connexion (cochée juste au cas où): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mp/d9/o9/mpd9o9nieg8be0a1nkw_nwjenkq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apparue: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9o/eb/zc/9oebzchr5zpdmq9wux7pjfiih28.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous avions 100 commutateurs, 100 commutateurs apparaîtraient. </font><font style="vertical-align: inherit;">Maintenant, nous pouvons parler du sujet principal - la construction automatique de la topologie du réseau.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Créer une carte réseau</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans "Zabbix" dans la section "Surveillance" - sous-section "Cartes réseau". Vous pouvez créer votre propre carte avec n'importe quel nom arbitraire (je l'appellerai, comme dans les manuels - Carte des commutateurs): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dj/fo/pi/djfopijhurrskrzaa1vdz2xqb7w.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/91/u6/2n/91u62nyrphdsb1u2ypo1rsnjrx8.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/n3/6d/m_/n36dm_svkvrglkplk7fl345msr8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez ajouter des appareils à cette carte: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ty/t1/df/tyt1df6wfkeq4j2amt9evassz88.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons une opération assez ennuyeuse pour ajouter nos cent commutateurs ici: j'ajoute un </font></font><br>
<br>
<img src="https://habrastorage.org/webt/w9/g7/ih/w9g7ihwj13mcrzevcdh4xbu1seo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
nouvel élément et </font><font style="vertical-align: inherit;">je </font><font style="vertical-align: inherit;">dis au système qu'il est sur en fait l'hôte que vous surveillez; hôte switch1:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/np/uw/7x/npuw7xcetykmgf0mzoo_wf84obe.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/iw/kf/7o/iwkf7on2ppl3_k6pbqtp7ddwgxo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les gens demandent souvent si ce processus peut être effectué automatiquement. Réponse: "C'est possible!". Mais alors nous devons résoudre le problème fascinant: "Comment pouvons-nous comprendre où mettre quels commutateurs?" Telle est la géométrie. Une solution potentielle: vous pouvez spécifier une marque de géolocalisation dans l'interrupteur (un paramètre tel que «vous vous tenez au 6ème étage, bâtiment AZLK, 666e auditorium), dessiner le bâtiment du laboratoire pédagogique, tous ses publics ... En général, c'est un bon élève pour le 4ème élève Cours d'informatique. Nous n'avons aucun plan pour cela!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je vais maintenant ajouter les 3 commutateurs manuellement, mais je promets de ne pas tracer de lignes de communication entre eux. Vous ajoutez le 101e commutateur, nous l'ajoutons automatiquement à Zabbix - si vous le souhaitez, dessinez-le sur la carte avec des stylos. Un moment désagréable, mais il y a un endroit où être. Il n'y a pas de solution simple à ce problème, pendant 45 minutes à coup sûr. Et ce que nous obtenons me semblera intéressant. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ajoute rapidement 3 commutateurs: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ht/q4/5m/htq45ms1qrynn5vv6rbfltivtag.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
j'ai dit que je n'ajouterai pas de lignes? Je le ferai, mais seulement pour que plus tard nous puissions comprendre comment les dessiner. Je vais connecter ces deux commutateurs (nous ne </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hu/yy/3v/huyy3v7rbnxbz-vcvvcfscrc3nu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
connectons </font><font style="vertical-align: inherit;">pas </font><font style="vertical-align: inherit;">le </font><font style="vertical-align: inherit;">1er au 3ème): </font><font style="vertical-align: inherit;">Je vais les connecter (switch1 et switch3 sont surlignés): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yg/xx/4w/ygxx4wbqysq3gqcuqbdb8h7vdlo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre système devra résoudre ce problème: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1o/p1/da/1op1danyvogme8oxdl5mjy_c_sg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est important de ne pas oublier de sauvegarder le résultat:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wb/gg/wk/wbggwkhsx0s5v1n-2rximlephs0.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/fu/vp/ld/fuvpldfvuoweq4md4vtd9tzpmgi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Soit dit en passant, à propos de GNS - vous pouvez très bien le faire ... Cachez son nom d'hôte, faites-en un commutateur et mettez-le l'un sous l'autre, créant un nuage de commutateurs:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ne/uz/f7/neuzf7ylh_eb46psuqp7sq0nsp8.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/fa/uh/iy/fauhiyblbluxal-l8g7mbu5gws4.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/3l/cl/0o/3lcl0ofm4pg0qh8weeshyayu1pg.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/oh/is/fv/ohisfv9b9hvxjtax_u2l73ysmfw.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/ua/1c/px/ua1cpxoki5x5akr4imn0wakcvxi.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment construire une topologie? </font><font style="vertical-align: inherit;">Configurer la création et la mise à jour automatiques des lignes de communication</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour que la topologie soit construite automatiquement, nous devons recevoir automatiquement des informations à son sujet. À l'université, nous utilisons des équipements Cisco, nous sommes donc tombés amoureux d'un protocole appelé Cisco discovery protocol - tapez simplement show cdp voisins sur n'importe quel appareil et il vous dira que switch1 est connecté à la 5ème interface: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/u8/yg/vu/u8ygvuncowttw3o0nn6tjjzhep8.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/lj/vo/rh/ljvorhmvhikkk-3r8ykhwgc2zoi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alternative à cdp est lldp (nous avons un segment commutateurs de la société "effrayante" Nortel - il lldp). Vous voyez, il y a deux commutateurs: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-h/qq/vf/-hqqvfloaxvhgsplf-dz87zfr1y.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
le serveur Zabbix doit en quelque sorte extraire ces informations (je les vois sur Cisco lui-même). Il y a plusieurs façons. L'un des plus rapides mais des plus stupides consiste à utiliser le protocole RSH. Un protocole très dense, et je ne le connais qu'à cause de mon âge:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/44/xz/y-/44xzy-rmyoe9q-yl1c-pxipc61c.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/ed/hq/o5/edhqo5l9mzpdzkgydqpi9hvrm4c.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les personnes RSH normales ne le savent pas, mais vous pouvez rapidement l'utiliser pour faire quelque chose à distance avec Cisco. </font><font style="vertical-align: inherit;">Ou, si nous parlons d'une sorte de réseau de gestion où il n'y a pas d'étranger, vous pouvez l'utiliser en production. </font><font style="vertical-align: inherit;">Cependant, les points de sécurité sont toujours une couture complète! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai donc configuré la prise en charge de l'accès au protocole RSH à mes serveurs Cisco à partir de cette adresse IP: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_r/fi/tt/_rfittxipjyhnofewteuvyojncu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, je peux installer le client RSH sur le serveur ... </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-i/ji/ns/-ijinsihdodtgzniujj7ps7iv-q.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/k4/zm/yj/k4zmyjbq64rg_kuh5vzd7eovoyu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... et démontrer à quel point il est facile de suivre les instructions que nous venons de suivre en se connectant directement à l'équipement Cisco depuis la station de gestion - sur switch1 je vais suivre cette instruction: En </font></font><br>
<br>
<img src="https://habrastorage.org/webt/87/nr/vn/87nrvnudd8y_alfjxwsbusezjdw.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/k7/kh/fz/k7khfzefhkhfbfip2whrfe7yick.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
conséquence, elle devrait apparaître sur switch2:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_k/tk/3x/_ktk3xdve_dtksfm1aj50nanqfa.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connexion depuis le serveur de surveillance</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plus loin. Les managers m'écrivent: «Vyacheslav, une requête est arrivée de l'auditeur. Il veut approfondir Bash, Csh, Sed et Awk. » Ce sont des utilitaires Unix denses que les gens connaissaient dans une année hirsute. En ce moment, il y aura un peu d'un Unix dense. Nous allons installer ce paquet (nous devons formater la sortie pour qu'elle soit mieux structurée): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zm/db/fg/zmdbfgngl98kq1y3gyimzhhl5u8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et toute l'équipe ressemblera à ceci: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vx/wg/5b/vxwg5buzmtotxsyuz45_tkjmuj8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
je ne dirai pas en quoi le code de retour dans Dos diffère d'Unix. Ensuite, je filtrerai uniquement les lignes qui contiennent le commutateur, supprimer les espaces supplémentaires et couper les champs nécessaires à travers les espaces:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/97/gz/dc/97gzdcixffxvpmffvo8nyjfo2t8.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/ck/oh/-o/ckoh-o4tmxqmak6u8yitnf3rv9a.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons le résultat, et vous verrez comment il diffère du précédent. Unix un peu plus «magique». Traitement de la transformation des informations en structures (par exemple, switch2). Au lieu de ces informations non structurées (beaucoup d'espaces, quelques touches étranges): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lh/ph/pu/lhphpuqqnrpivefwhm3r-26culq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La sortie apparaît: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/my/j6/wr/myj6wrr8s8yjn1xt5xduyuww43k.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Switch2 est connecté à switch3 via les interfaces Fas 0/6 (depuis switch2) et Fas 0/5 (depuis switch3). Le tableau s'avère: une sorte de commutateur avec lequel à travers quelles interfaces il est connecté. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pendant ce protocole, RSH et CDP partent. Maintenant, après avoir reçu ces informations, nous établissons ces liens sur tous les commutateurs. Pour ce faire, nous avons besoin d'informations sur les commutateurs auxquels se connecter. Vous pouvez obtenir un fichier texte, où lister tous les interrupteurs ... Mais ce n'est pas du sport!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il suffit d'ajouter physiquement le commutateur, et il devrait être automatiquement détecté par le Zabbix. </font><font style="vertical-align: inherit;">Nous avons déjà une base de données de commutateurs dans Zabbix. </font><font style="vertical-align: inherit;">Comment une application peut-elle obtenir des informations sur les commutateurs de Zabbix?</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API Zabbix</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'API Zabbix est écrite en utilisant le "merveilleux" protocole JSON. J'ai fini de programmer à l'époque où JSON n'était pas encore, donc pour moi, comme pour l'administrateur ... De nos jours, il n'y avait pas de telles ordures! Voici un fichier texte pour moi - c'est normal, mais JSON ... ( </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
je plaisante </font><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">JSON est tellement JSON! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JSON est le format utilisé pour échanger des données avec le serveur Web, et l'utilitaire cURL est l'un de ces utilitaires pratiques qui vous permettent d'envoyer toute demande au serveur Web: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xk/xy/fh/xkxyfhqtn9p-kllijsbwfda5pus.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/po/g0/qt/pog0qtpuciskhncsbhfespkg1n0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
je n'entrerai pas </font><font style="vertical-align: inherit;">dans le </font><font style="vertical-align: inherit;">détail de ce qu'est une demande POST, une demande GET et Je vais dire brièvement. Dans le "Zabbix" qui fonctionne ici: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xb/5x/bb/xb5xbbtwehskdqcmeygzyqczwfs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette application arrive: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ti/jf/gu/tijfguw4winkqmkpfbjusomxmbw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qui est prête à accepter une telle demande entre accolades "effrayantes" (c'est JSON):</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ez/an/cs/ezancsh3w2vyw6byftum-vjaoye.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette requête indique ce que je veux faire avec Zabbix, les paramètres sont indiqués: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/46/h8/e-/46h8e-jkhyzj4dljmuo-rd3i1g8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un Zabbix donne une réponse. </font><font style="vertical-align: inherit;">Voici un exemple qui dit: «Zabbix», veuillez me donner une chaîne d'authentification afin que je puisse vous envoyer d'autres demandes. » </font><font style="vertical-align: inherit;">Je confirme mes informations d'identification avec un identifiant et un mot de passe: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ti/8b/5n/ti8b5n7de63oqwt3emjs8wzf45u.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une telle demande JSON va maintenant nous renvoyer une réponse JSON: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/or/zw/af/orzwaf9ssguutgd98_tf0qk-yyy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et dans cette réponse JSON, il y aura une telle ligne: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dm/fw/qa/dmfwqa_ulb9csqhjwlaw8vuphd8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ceci est un authentificateur qui peut être utilisé pour les demandes restantes.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Travailler avec des objets hôtes</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous nous rappelons pourquoi nous avons commencé à étudier le JSON: nous voulons obtenir la base de données des commutateurs de Zabbix. Quels commutateurs interroger? Sortons-le! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apprenez à connaître: l'API Zabbix inclut, entre autres, la méthode host.get: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6h/9s/i9/6h9si95adtk44qyqujquhvjbkru.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Host - ce sont nos hôtes. Obtenir, c'est donner. Ensuite, je fais remarquer: donnez-moi des informations sur l'hôte! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_h/qh/jv/_hqhjvdgxtsbtlypqmjkrdbdndo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les paramètres, je dis: sortie tout ce que vous savez sur les hôtes: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/g2/jp/as/g2jpasm8v_0jb59cmy2kcjgdcty.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais je dois accompagner ma demande avec cette ligne: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qy/os/jj/qyosjjbate8nm6rcazxw_rz-bwe.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Démontrons. Pour me faciliter la tâche, je vais </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fo/xl/lr/foxllrj0twd3dauxqpkdgt3key8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
copier </font><font style="vertical-align: inherit;">cette demande: </font><font style="vertical-align: inherit;">Et je vais insérer l'authentificateur que Zabbix m'a retourné: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cq/ve/mu/cqvemull9ck4ohbobg57x99mbuw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, Zabbix Api: nous avons regardé comment demander au Zabbix un authentificateur pour l'accès. Et puis je montre comment utiliser cet authentificateur pour obtenir une sorte de réponse:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/df/c1/pn/dfc1pnn8ohqpvdto28ls6glrskg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je pense que tout est clair. Vous pouvez même voir si vous prenez une loupe. Reconnaissez-vous switch1? Quelque part, il y a un switch2 ... </font></font><br>
<br>
<img src="https://habrastorage.org/webt/70/2h/ev/702hevhmrlcdiegys1ae9dh6ndc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je me suis cassé les yeux pendant longtemps, puis j'ai décidé de lire comment travailler avec ce JSON sur la ligne de commande. Et l'une des recommandations était: utiliser JSON Query. Elle est en très bonne santé, illumine la réponse, voyez: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9a/ei/jz/9aeijz-slee1ekq2iu1tq86cqle.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/ha/jz/26/hajz26f3jvrfymevvidztnzizl8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Premièrement, tout est devenu coloré - c'est déjà bien; deuxièmement, switch2, switch1 sont clairement visibles ici:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qv/84/tp/qv84tptvurpqfkfqtmdbkfvh_wa.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, un peu de bricolage avec JSON Query, nous verrons beaucoup de choses intéressantes. </font><font style="vertical-align: inherit;">Et pour ne pas copier à chaque fois ces «crocodiles» du cahier, je propose de déterminer sur quoi nous allons programmer le travail avec notre «Zabbix». </font><font style="vertical-align: inherit;">Il y a une API Zabbix - c'est JSON, il y a un tas de langages de programmation. </font><font style="vertical-align: inherit;">JSON semble faire référence à un script Java, mais en fait, d'autres langages sont le plus souvent utilisés pour fonctionner avec Zabbix - par exemple, Perl, un script Perl qui fait quelque chose.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Faire des requêtes sous forme de scripts Bash</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perl n'est pas un langage à la mode aujourd'hui, obsolète. Si je recommençais la vie, je commencerais probablement à apprendre Pyton. Et il est bien connu que sous "Python" il y a une bibliothèque pratique pour travailler avec "Zabbix". Mais, puisque nous nous sommes réunis ici et ne donnerons la préférence à aucune langue, j'utilise cette langue: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sk/fv/xp/skfvxpn5j9scrpc3evf7eyrvnj0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
la langue de l'administrateur système, c'est-à-dire moi - Bash! Par conséquent, je ferai ces demandes à Zabbix: </font><font style="vertical-align: inherit;">
Je les </font><font style="vertical-align: inherit;">émettrai </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zh/3i/mb/zh3imb6ja0rkpyvy7bl-gpospwc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sous forme de scripts: Les </font></font><br>
<br>
<img src="https://habrastorage.org/webt/i0/fk/rg/i0fkrgjljz1l8gdq20zzqirqmno.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scripts sont prêts, je les copierai. Ils ressemblent à l'enfer. Je pense qu'un bon code Python sera beaucoup plus lisible. Mais, comme je ne connais pas moi-même "Python" et ne veux pas donner de préférence, je vais écrire sur ce qui est proche du cœur de l'administrateur système:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/01/qj/z2/01qjz2tstbcljo7hlnjbiq-ri7m.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je ne vous dirai pas ce que sont ces contre-obliques (et que Dieu les bénisse). Mais la chaîne d'authentification sera encadrée sous la forme d'une variable que nous devons exporter avant: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ni/uc/xf/niucxfqzrmv1ouy4jrin3lrs7mg.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/tt/wa/37/ttwa37gjveh9lxyfbqgnkoxhg-0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quelle valeur cela a-t-il eu pour nous? Et maintenant, au lieu de copier les longues lignes, je peux simplement exécuter le script: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gg/b0/xb/ggb0xbiuppm37ndovdlqev-81_u.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
le script renvoie une couture complète. En utilisant JSON Query, vous pouvez obtenir cette beauté: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lq/0r/ai/lq0raiqvp0e8ant2sj7ww2ruxkg.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/wh/k7/qg/whk7qgnjyn8amh0goeai98e05ne.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
rappelez-vous la tâche: obtenir la base de données des commutateurs qui sont dans Zabbix! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je vais immédiatement dessiner le résultat. Je ne dirai pas longtemps et en rond-point ce qui se trouve ici et comment. Nous avons une tâche intimidante: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uo/ku/f9/uokuf9cd68jhy4n_3tke1cc9bge.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
voici un tel résultat, voyez ce qu'il contient. Il est dit ici que nous avons de tels commutateurs dans Zabbix, et ceci (10105, 10106, 10107) est l'identifiant interne du commutateur «Zabbiksk»:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hx/l0/ub/hxl0ubkxevyy-ngfijnfw3k3vsa.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le résultat était un fichier plat. </font><font style="vertical-align: inherit;">Lorsque vous ajoutez chaque nouveau commutateur, vous devez exécuter ce script pour créer un fichier. </font><font style="vertical-align: inherit;">Pour que nous n'ayons pas de tels "crocodiles", j'inclurai cette ligne dans le script lui-même: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/l1/em/jh/l1emjhywmibe_ehavajfptgx4r0.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/kq/el/r6/kqelr6wblri6snfkbwk0jfvuhtc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et cela nous retournera une vue de table soignée. </font><font style="vertical-align: inherit;">Maintenant, je vais montrer. </font><font style="vertical-align: inherit;">J'exécute le script, il affiche et enregistre immédiatement ce fichier: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-h/u0/dz/-hu0dz2hoymtx7eepiys0v4grhi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'utilitaire tee est un bon utilitaire qui écrit le résultat dans un fichier et le distribue. </font><font style="vertical-align: inherit;">Nous avons maintenant 3 commutateurs et nous avons un fichier texte dans lequel tous les commutateurs sont répertoriés: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ur/bu/fz/urbufz8s11mczfb2uld8b_oxo8k.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, vous pouvez interroger chacun de ces commutateurs via RSH et découvrir qui est connecté à quoi. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons donc obtenu la base de données des commutateurs. </font><font style="vertical-align: inherit;">Notre objectif ultime est les cartes!</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obtenir une liste des cartes et de leurs éléments depuis Zabbix</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment travailler avec des cartes? Apprenons à lire les informations sur les cartes de Zabbix. Je vais copier ce script: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6t/9_/mb/6t9_mbgxpoyrttupz3cf-zsrmeg.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/pz/g0/gw/pzg0gw6tel-pjkfgzxcqrsy0lf4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
celui qui l'aime, vous pouvez prendre tous ces scripts. J'ai essayé de les simplifier autant que possible - cela ne fonctionne pas plus facilement. Si vous trouvez comment le simplifier, écrivez, je vais le corriger: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oj/ex/kt/ojexktdpilhdilffqxopetdrgws.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce script ↑ se transforme en Zabbix avec une requête map.get et dit: "Parlez-moi des liens et parlez-moi des éléments que ces liens se connectent les uns aux autres." </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, je lance ce script: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zf/96/us/zf96uszqpiityn1vqaezvxj2odc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et je montre le résultat: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fd/nn/ep/fdnnepoivtufayskrat49ak6nu4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout comme les informations sur les hôtes, il est très facile d'obtenir des informations sur les cartes de Zabbix. Chaque carte a son nom: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5n/wl/jt/5nwljtoelbudy0igqcrclgo6_v0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici les éléments de cette carte. Reconnaissez-vous le numéro? C'est l'élément interne de Zabbix:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/my/yk/cz/myykczkfzf6iev4s2s_vz-co5nk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le plus désagréable est que dans Zabbix les éléments sont à nouveau numérotés. </font><font style="vertical-align: inherit;">À gauche, l'élément id, à droite, la numérotation de l'élément à l'intérieur de la carte: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wz/ek/xi/wzekxi5xnw70eazz4fswo75s9-a.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
c'est-à-dire que dans Zabbix, chaque hôte a un numéro, et sur la carte il y a un autre numéro - cette chaîne est obtenue. </font><font style="vertical-align: inherit;">Autrement dit, le commutateur switch1 est appelé 10105 dans le Zabbix, et 2 sur la carte (une légère complication de la tâche est obtenue).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous rassemblons tout via CDP et RSH, découvrez la connexion des commutateurs avec les interfaces</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La dernière partie de ce script est que je dois obtenir des informations sur les identifiants de Zabbix associés à quels identifiants sur la carte. Regardez, dans "Zabbix", voici cet identifiant (10105, 10106, etc.), et sur la carte - 2, 3, etc.: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/td/e2/kq/tde2kqrnxxq8mw2xvrmckzu-cr8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Traditionnellement, je l'enregistre dans un fichier texte: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/o6/ts/wi/o6tswi34dpttupdmkapyier25ki.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nous avons presque tout. Il y a des informations sur les commutateurs dans ce fichier (quels identifiants à l'intérieur de Zabbix sont utilisés): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yr/uh/jn/yruhjnqamivzhfuufaefldqm-ya.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et nous avons des informations sur quel identifiant sur la carte est associé à quel identifiant Zabbix (par exemple, switch1 a le numéro 10105 dans Zabbix, et sur la carte numéro 10105 a l'identifiant 2):</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yr/uh/jn/yruhjnqamivzhfuufaefldqm-ya.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/2e/ug/7s/2eug7srj1krpadc4iasvh1mtdye.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce n'est pas de ma faute! Les gars ont écrit ça dans Zabbix. Mais je suis sûr qu'il y a une raison pour laquelle ils n'utilisent pas d'identifiants directs sur la carte. Peut-être parce que le même objet peut être affiché plusieurs fois sur la carte, et il doit avoir un identifiant unique. Par conséquent, la chaîne est plus longue. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et ici, je vais probablement commenter ce petit enfer. Play it: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/g8/rs/tq/g8rstq6pvpa0xqgrofdazuk_txm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la boucle, je lis les lignes décrivant à quel commutateur avec quel identifiant Zabbix </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ii/nh/eq/iinhequuyybluby-ybxdu7lkghw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/er/8h/xa/er8hxamulabcynmqppzokznfl-0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
je me </font><font style="vertical-align: inherit;">connecte à chaque commutateur du Zabbix via RSH: </font><font style="vertical-align: inherit;">je lis à quels hôtes il est connecté. Je redirige ce résultat vers un autre cycle: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ol/hr/pl/olhrpl7refin5zcmakahdqgec4a.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
qui, à son tour, lit les identifiants et découvre qui est connecté avec qui: je vais </font></font><br>
<br>
<img src="https://habrastorage.org/webt/98/wz/ww/98wzwwnjkx3qp65cl3iqlzfxlza.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
montrer les résultats de ce script (chmod + x):</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oi/qb/qy/oiqbqymkxfur8kd-i7xqglyxqd0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur la carte, le deuxième interrupteur est connecté au troisième (rappelez-vous que les identifiants sur la carte) via les interfaces correspondantes (Fas 0/5 - pour le second, Fas 0/6 - pour le troisième ↑). </font><font style="vertical-align: inherit;">Nous devons dessiner ces noms sur les liens, créer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si jusqu'à ce moment, nous ne lisons que les informations de Zabbix (hôtes, cartes lues, etc.), nous allons maintenant devoir écrire des informations sur Zabbix. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sauvegardons le résultat:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gs/uh/wt/gsuhwt_0qiojiuheizaq3gt3wcg.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dessiner des lignes de communication dans Zabbix</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai décidé d'écrire un script simple qui changera quelque chose dans Zabbix. Honnêtement, j'ai étudié l'API de cette façon - il était important pour moi que quelque chose de simple fonctionne: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yg/ke/s0/ygkes0eksoonvbajier32-c0dw4.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/gz/5g/_a/gz5g_anpr_docgcrlaxfm0jn-mw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
le premier script ne sera pas lié aux tâches - il changera le nom de la carte (pour voir comment cela se fait). Si nous voulons changer quelque chose dans Zabbix, nous devons également appliquer via la demande POST et le décrire en JSON, mais en utilisant la méthode map.update. Parmi les paramètres, nous devons indiquer explicitement: MAPID, qui trouvera la carte souhaitée, et MAPNAME, qui changera le nom de la carte: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kk/ms/3p/kkms3p-ixoafs4ifvpccikv1nd0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
il s'agit de l'ensemble minimal de paramètres. Ces paramètres eux-mêmes: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/im/fw/yv/imfwyviqvbgelp9gjmoeelpedic.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Passez à travers les variables les arguments du script. Je rend le script exécutable (chmod + x): je le lance </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hx/xj/uz/hxxjuzo5h4galmyprunx1ftd7so.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
, comme écrit dans le manuel de formation. Si tout est correct, la carte devrait s'appeler Super MAP:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/er/va/qd/ervaqdxvi_h0twak7rxcz9zjh8u.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Surveillance - Cartes - voila: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/68/vf/yq/68vfyqjmwq8mlq6pacsj_c7mbnc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Facile à changer - Super MAP2: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yf/xi/zx/yfxizx_w2ycib6jifb9cw_2qh5u.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout fonctionne: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vx/eh/7o/vxeh7o3axqtxzzggktfy1g1hqqw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais notre tâche est compliquée - changer les lignes de communication! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ve/j2/pb/vej2pbmp87qsuylhj6vx7sw5doo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est nécessaire de générer du JSON, qui décrira notre carte et toutes les lignes de communication. Pour ce faire, je crée un autre script: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vc/aj/fd/vcajfdntlvggtwxr0qffvjyb-de.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/o6/o_/p5/o6o_p5msbpvhw27e-jo0xjfi6lg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
le fait que j'ai plusieurs scripts ne signifie pas que cela doit être fait en entreprise. Dans l'entreprise, vous devez prendre un langage normal que vous connaissez ("Python", "Pearl" ou autre) et programmer ce qui est ici en utilisant un langage normal. Ces briques, chacune simple, permettent de comprendre quoi, pourquoi et comment le faire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre script qui sert plus à comprendre ce qui doit être fait, et non à copier (je ne vous vendrai pas le produit fini ici): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/v7/l8/uw/v7l8uwgwtmqbfuacxtnuqg89ery.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/cw/yn/ud/cwynudseywryxw-gkcajcp9vdua.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce script lit ce fichier:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/iu/gj/bt/iugjbtn5qbfhwnjw3ednxvxnqea.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qui indique quel élément sur la carte avec quel élément sur la carte à travers quelles interfaces il est connecté. Plus précisément, nous prendrons un élément sur la carte, un élément sur la carte et une étiquette. Ceci est un élément sur la carte: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fd/yf/ae/fdyfaeounbojncqky7ionmzjaa0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et cette signature devrait être: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9z/ge/lp/9zgelpwjnjlu_bvsxbvwmkqgkzc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
je lis ce fichier. Je trie tous les éléments de la carte: je </font></font><br>
<br>
<img src="https://habrastorage.org/webt/la/th/ls/lathlszamnf7drlctykzoe7rmlc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
programme les liens - description des liens sous forme de JASON. La demande finale ressemble à ceci: mettre à jour la carte (numéro de carte ↓): les </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sr/bp/ga/srbpgaaeocsxrerwasxiw4eww-o.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
liens seront décrits dans cette variable: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_s/jv/sb/_sjvsbsea4dfxn8xdhxu6wvq61s.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
qui a été formée dans ce cycle (tous les éléments et signatures des cartes ont été énumérés): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tm/tr/le/tmtrleu4iz3hj-tpihsmg60ai6m.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
encore une fois, nous avons une tâche intimidante et la décrivons en détail sur Shell ... Beaucoup d'entre vous n'ont sûrement pas programmé sur Shell. Il vous suffit de regarder ces textes et de programmer ce qui vous convient.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je m'attends à ce que maintenant tout se passe. Lancement d'un script: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/z6/ku/aj/z6kuajchdcyhzdsafzrgdwxrhbg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recharger la page Maps: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/j_/36/6p/j_366pbhfsxwdf6r6-ptm-ajfqc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh bien, comment? Au moins ça marche! Ajoutons un autre commutateur et réexécutons le script. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous prenons le commutateur, appelons-le switch4: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ki/w6/2w/kiw62wjjoudkeqlbyqpwi8w_rum.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous </font><font style="vertical-align: inherit;">dessinons </font><font style="vertical-align: inherit;">que c'est le commutateur: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4c/1f/jv/4c1fjvsupwx_ujkfykki_nlytbk.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/4k/qe/qu/4kqequ32eiap57vjw0ntpguworm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configurer </font><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">Nous le </font><font style="vertical-align: inherit;">connectons </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3y/vg/51/3yvg51etfkdm13nua1ricw7hkge.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
comme nous voulons (avec un astérisque, vous pouvez dessiner une saucisse): </font><font style="vertical-align: inherit;">Nous </font><font style="vertical-align: inherit;">configurons le </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_e/-z/3e/_e-z3ebtugz-banoljrocvnnhkc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
commutateur. Je lance: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fo/cm/vm/focmvm2m5meqrgmfpbrstofgpsg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout ce que nous avons fait précédemment (il suffit de passer à switch4 et l'adresse est 104): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qr/jh/hu/qrjhhudyhklwds0vqvel8bl7oxq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Double-cliquez sur le commutateur (collez ce que vous avez copié): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/0b/ng/ga/0bnggamteyi65nog6igvrnzbw3s.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encore une fois, il sera plus rapide de redémarrer le troisième commutateur (switch3), en enregistrant la configuration:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dv/k2/mr/dvk2mrpw11vgl6jraypfd1t7vva.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En attendant, il redémarre, vérifiez s'il est disponible sur notre nouveau commutateur via SNMP. Lorsque Zabbik le trouve, la première chose à demander est le nom d'hôte SNMP. Par conséquent, nous ajoutons cette conception à notre nouveau commutateur: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fb/yo/t2/fbyot2e9x1ugheuhu-du6jrf5gg.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/wx/ft/by/wxftbyv_y5abyoswch-ctg9cp3y.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
nous attendons maintenant que le commutateur soit disponible. Les 101ème, 102ème sont disponibles, le 103ème redémarre: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ud/kq/q-/udkqq-alaw8aoldd5re6a0wgoow.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le 103ème a </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ft/fr/ox/ftfroxxsep7orgxpyqhghouetsy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
répondu </font><font style="vertical-align: inherit;">: le </font><font style="vertical-align: inherit;">104ème a répondu. Vérifiez si SNMP est disponible via SNMP4: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mx/ts/rd/mxtsrdsg1tvvdd6y_cjuigbnhxi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Disponible! Nous avons toutes les chances de le voir dans la liste des hôtes. Attendons une minute (chaque minute que nous avons un réseau analysé): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kb/3c/ff/kb3cffka032ra7i5is9ayhewjya.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fois qu'il est apparu, nous revenons au premier script. Il nous a déchargé des informations sur les commutateurs en général:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/np/ea/zo/npeazo2te4hbnfd2ncdm0vsr32y.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vos câblo-opérateurs ont couru, ils ont bloqué un nouvel interrupteur, vous avez levé le lien et il est apparu automatiquement dans Zabbix. </font><font style="vertical-align: inherit;">En conséquence, nous devons voir ici que le quatrième commutateur est apparu: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/v2/q-/kt/v2q-ktdybfjkhgn_sz0vee3toum.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre base de données est automatiquement remplie.</font></font><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous réparons le matériel (ajoutez switch4), exécutons le script final</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, malheureusement, vous devez vous enfuir et afficher notre commutateur sur la carte: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ux/4a/5k/ux4a5kwj5gpfzmxbxnsqvncarpc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Non seulement vos câblo-opérateurs ont couru, non seulement vous avez configuré le lien - vous devez toujours aller ici et dire: "Nous ajoutons un nouveau commutateur." </font></font><br>
<br>
<img src="https://habrastorage.org/webt/g-/iz/nf/g-iznfb3qf_fillb6w40lmetgxa.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Localisez où il devrait être et indiquez que nous avons l'hôte, switch4, et dessinez également ce qu'est ce commutateur: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/y3/bp/pm/y3bppmrcdmfoaerjlafxilst_gk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et mettez à jour (nous ne </font><font style="vertical-align: inherit;">dessinons </font><font style="vertical-align: inherit;">pas encore la ligne de communication!): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gs/fa/fk/gsfafkqzwjjpiwihul-lfc1nzfm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous rappelons maintenant que nos scripts de ligne de communication sont construits sur la base du protocole CDP. Et pour obtenir des informations CDP du commutateur, vous devez configurer l'accès RSH à celui-ci. Rappelez-vous, j'ai décidé d'utiliser cette méthode?</font></font><br>
<br>
<img src="https://habrastorage.org/webt/84/q5/df/84q5dfhi0d4spzqawa1uumbn9gm.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/wq/kl/xn/wqklxnrebbym3uce1hrsg-izdmy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si tout va bien, je peux essayer, puis je peux essayer RSH - demander des informations sur sa connexion à partir du 4ème commutateur. Ici, il dit: "Je suis connecté au troisième, de mon côté - le 10ème, d'autre part - la 8ème interface." </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cy/_a/ug/cy_augy2yrbswanujdpjpdkcwqc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ils l'ont ajouté à la carte, et nous avons une table de correspondance entre les identifiants dans le Zabbix et les identifiants sur la carte (voir, c'est le 5ème sur la carte): ils ont </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-i/t8/vs/-it8vsr54h_fnue2-srk6zxcwzs.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/je/j5/at/jej5atlnmnnazwy6aga4k8n5sfi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
soulevé RSH. Maintenant, nous pouvons créer une connexion: quels commutateurs sont connectés via quels liens (nous avons le fichier texte): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ab/hl/zm/abhlzmj1mez4py4iecfw4e0mgs8.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/g7/st/qm/g7stqmpv_mu4qsylijjuxwwibac.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essayons d'exécuter le script final, qui lira ce fichier texte et générera une demande JASON pour la mise à jour des cartes, redessinant tous les liens sur la carte: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ct/aq/iy/ctaqiy_1gdpvipgk4t3pzzc86os.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/dq/ld/ue/dqldueagtxz_ap1rbmxphccytba.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/c3/6v/fp/c36vfphix1om8_etfenkvo9oeco.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh bien, comment? Impressionnant? Je n'ai pas réussi en 45 minutes prévues, mais tout de même rapidement (environ 75 minutes) - probablement, cela ne fonctionnera pas plus vite.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout! </font><font style="vertical-align: inherit;">Je suis des amis très heureux - ça a fonctionné. </font><font style="vertical-align: inherit;">Le manuel de formation est ici: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://wiki.val.bmstu.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Si vous ne le trouvez pas, écrivez à l'e-mail: val@bmstu.ru, val@specialist.ru - je vous l'enverrai avec plaisir. </font><font style="vertical-align: inherit;">Un webinaire apparaîtra sur specialist.ru - je vais vérifier cela à coup sûr. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et surtout, mes amis, que tout cela n'a pas été en vain, mais dans le but rusé de vous convaincre, vous ou vos collègues, de notre cours de 2 jours, qui comprend un grand nombre de tâches liées à Zabbix: détection et réglage de bas niveau ... Pas au sommet, comme c'est le cas actuellement, mais en détail, avec les laboratoires - vous le ferez: jusqu'à ce que vous le fassiez, je ne vous laisserai pas sortir. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je serai ravi de vous voir, vos collègues! </font><font style="vertical-align: inherit;">Écrire des lettres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À bientôt!</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/ZrNScBG9TnU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un peu de publicité :)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Merci de rester avec nous. Aimez-vous nos articles? Vous voulez voir des matériaux plus intéressants? Soutenez-nous en passant une commande ou en recommandant à vos amis, le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cloud VPS pour les développeurs à partir de 4,99 $</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , un </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">analogue unique de serveurs d'entrée de gamme que nous avons inventé pour vous: </font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Toute la vérité sur VPS (KVM) E5-2697 v3 (6 cœurs) 10 Go DDR4 480 Go SSD 1 Gbit / s à partir de 19 $ ou comment diviser le serveur?</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (les options sont disponibles avec RAID1 et RAID10, jusqu'à 24 cœurs et jusqu'à 40 Go de DDR4). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R730xd 2 fois moins cher au centre de données Equinix Tier IV à Amsterdam?</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nous avons seulement </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x Intel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 TV à partir de 199 $</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aux Pays-Bas!</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R420 - 2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB - à partir de 99 $! </font></font></b></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En savoir plus sur la</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> création d'un bâtiment d'infrastructure. </font><font style="vertical-align: inherit;">classe c utilisant des serveurs Dell R730xd E5-2650 v4 coûtant 9 000 euros pour un sou?</font></font></a></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr486800/index.html">Cassandra. Comment ne pas mourir si vous ne connaissez qu'Oracle</a></li>
<li><a href="../fr486802/index.html">Les gens rencontrent des systèmes de recommandation. Factorisation</a></li>
<li><a href="../fr486804/index.html">Informatique de santé mondiale: technologies cloud</a></li>
<li><a href="../fr486808/index.html">Test de grossesse électronique en pharmacie: comment ça marche</a></li>
<li><a href="../fr486810/index.html">Nouvelle interface Odnoklassniki: lancement de React en Java. Partie II</a></li>
<li><a href="../fr486818/index.html">Portage de Quake sur iPod Classic</a></li>
<li><a href="../fr486820/index.html">Questions d'entretiens chez Javascript</a></li>
<li><a href="../fr486822/index.html">[Par les quais] Flutter. Partie 4. Pour les développeurs Web</a></li>
<li><a href="../fr486824/index.html">Mauvais conseils lorsque vous travaillez avec ANTLR</a></li>
<li><a href="../fr486826/index.html">Création d'un Viberbot à part entière sur Django 2 et l'API Viber REST. Première partie - Webhook</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>