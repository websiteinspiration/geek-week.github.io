<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧗🏻 🧘🏻 🙂 Programmation déclarative des applications client-serveur sur Android. Partie 2 🐉 👍🏻 🎞️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L' article précédent a brièvement montré les avantages de la programmation déclarative des applications client-serveur pour Android par rapport à l'im...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Programmation déclarative des applications client-serveur sur Android. Partie 2</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502024/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article précédent a</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> brièvement montré les avantages de la programmation déclarative des applications client-serveur pour Android par rapport à l'impératif. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons maintenant écrire un petit projet, mais suffisant, pour évaluer l'efficacité de la bibliothèque DePro. </font><font style="vertical-align: inherit;">Il fait partie d'un des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exemples</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pédagogiques </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">de la bibliothèque</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">La conception de tous les écrans que nous décrivons est illustrée dans les figures suivantes:</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/f6c/afe/af5/f6cafeaf546e9467b0a1b71b122b7eeb.png" alt="image"> <img src="https://habrastorage.org/getpro/habr/post_images/287/0cb/0b9/2870cb0b957f2ed4318cd78a137ebf3a.png" alt="image"> <img src="https://habrastorage.org/getpro/habr/post_images/0d7/f08/980/0d7f08980838c23cc41258eca7a3093e.png" alt="image"><br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Écran TIROIR Écran CATALOGUE Écran PRODUCT_LIST</font></font></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/5a1/32c/952/5a132c9529aadcf1101fe14137e4ff17.png" alt="image"> <img src="https://habrastorage.org/getpro/habr/post_images/b4b/c8e/768/b4bc8e768bb0d616ddb4a4325986cdab.png" alt="image"> <img src="https://habrastorage.org/getpro/habr/post_images/227/00e/5f5/22700e5f57ffbc8fc43429ee87f79b87.png" alt="image"><br>
<pre> CATALOG_           DESCRIPT          CHARACTERISTIC</pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/5a6/635/394/5a6635394bccc0473f79ed51b0fab8b6.png" alt="image"> <img src="https://habrastorage.org/getpro/habr/post_images/150/f30/32f/150f3032f242fc892db119d5b0fc15a2.png" alt="image"> <img src="https://habrastorage.org/getpro/habr/post_images/a0d/44f/49b/a0d44f49bd430384c67a9e6a81a4bbe1.png" alt="image"><br>
<pre> FITNESS           FITNESS_          </pre><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A partir de ces écrans, leur fonctionnalité est généralement comprise. Le menu latéral contient deux éléments «Catalogue» et «Fitness». Lorsque vous sélectionnez un élément, l'écran correspondant s'affiche. L'écran CATALOGUE contient une liste horizontale "Actualités". Lorsque vous cliquez sur un «nouveau produit», un écran avec une description de ce produit s'affiche. La description se compose de deux onglets: «Description» et «Caractéristiques». Également sur l'écran CATALOGUE, il y a une liste déroulante "Catalogue". Lorsque vous cliquez sur la flèche vers le bas, le répertoire s'ouvre (se ferme). Lorsque vous cliquez sur toute la ligne, l'écran PRODUCT_LIST s'affiche avec une liste de produits pour l'article sélectionné dans le catalogue. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous cliquez sur l'élément «Fitness», l'écran FITNESS avec une liste de services s'affiche. La liste dépend du club sélectionné dans le spinner. Lorsque vous essayez de quitter l'application, une boîte de dialogue d'avertissement s'affiche.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le serveur transfère les données au format json vers l'application. </font><font style="vertical-align: inherit;">La structure des données pour chaque écran est décrite ci-dessous. </font><font style="vertical-align: inherit;">Dans les applications écrites dans DePro à partir de l'API, seule l'URL est utilisée, la structure de données n'est nécessaire que pour définir correctement la vue nom (id), car la liaison est effectuée par nom. </font><font style="vertical-align: inherit;">Il convient de noter que les données sont une tranche incomplète de données réelles. </font><font style="vertical-align: inherit;">Par conséquent, il peut ne pas y avoir de connexion sur les noms, les images. </font><font style="vertical-align: inherit;">En particulier, les images de produits totalisent 20 pièces. </font><font style="vertical-align: inherit;">Par conséquent, la même image peut être présente dans de nombreux produits.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API pour des exemples d'écrans</font></font></b>
                        <div class="spoiler_text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Écran CATALOGUE pour la liste horizontale (Nouveau) URL depro / cron / news, méthode GET. </font><font style="vertical-align: inherit;">Lors de la lecture des données sur les nouveaux produits, la pagination est utilisée. </font><font style="vertical-align: inherit;">Les paramètres de pagination sont passés dans l'en-tête. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Réponse</font></font><br>
<br>
<pre><code class="plaintext hljs">    {<font></font>
        "product_id":4610,<font></font>
        "catalog_id":15984,<font></font>
        "product_name":"  20  6  ( 1*20) APRO",<font></font>
        "catalog_code":"ZRG-20kit",<font></font>
        "picture":"depro/cronimg/picture_1.jpeg",<font></font>
        "bar_code":"4824041010653",<font></font>
        "oem":"",<font></font>
        "price":175.98,<font></font>
        "brand":"APRO",<font></font>
        "product_code":"032578",<font></font>
        "gift":0,<font></font>
        "bonus":0,<font></font>
        "new_product":1,<font></font>
        "quantity":5<font></font>
    },<font></font>
    . . .<font></font>
</code></pre><br>
     URL depro/cron/catalog. <br>
<br>
   URL depro/cron/catalog_ex   catalog_id      id ,  .<br>
<br>
    :<br>
<br>
<pre><code class="plaintext hljs">[<font></font>
    {<font></font>
        "catalog_id":15510,<font></font>
        "parent_id":0,<font></font>
        "catalog_name":""<font></font>
    },<font></font>
    {<font></font>
        "catalog_id":15584,<font></font>
        "parent_id":0,<font></font>
        "catalog_name":""<font></font>
    },<font></font>
    . . .<font></font>
]<font></font>
</code></pre><br>
 PRODUCT_LIST URL depro/cron/product_list  : expandedLevel  catalog_id.<br>
 expandedLevel —    (0, 1  2), catalog_id — id  .<br>
<br>
   0  1    ,    ,                .<br>
<br>
 GET<br>
<br>
        ()<br>
<br>
       URL depro/cron/product_barcode  <br>
 barcode_scanner. <br>
<br>
       URL depro/cron/product_search   product_name.     LIKE.  product_name      .<br>
<br>
        .<br>
<br>
 DESCRIPT <br>
<br>
 : URL depro/cron/product_id   product_id.  GET.<br>
<br>
<br>
<br>
<pre><code class="plaintext hljs">{<font></font>
    "product_id":2942,<font></font>
    "catalog_id":15594,<font></font>
    "product_name":"   2110, 2111, 2112,  Sens ''  ",<font></font>
    "catalog_code":"23.3828"<font></font>
    ,"picture":"depro/cronimg/picture_16.jpeg",<font></font>
    "bar_code":"2000000148472",<font></font>
    "oem":"2112-3851010",<font></font>
    "price":103.02,<font></font>
    "brand":", . , ",<font></font>
    "product_code":"027729",<font></font>
    "gift":1,<font></font>
    "bonus":0,<font></font>
    "new_product":0,<font></font>
    "quantity":16<font></font>
}<font></font>
</code></pre><br>
: URL depro/cron/product_analog   product_id.  GET.<br>
<br>
<br>
<br>
<pre><code class="plaintext hljs">[<font></font>
    {<font></font>
        "product_id":561,<font></font>
        "catalog_id":15587,<font></font>
        "product_name":"   2110, 2111, 2112 (  16 . ) AURORA",<font></font>
        "catalog_code":"WP-LA2112",<font></font>
        "picture":"depro/cronimg/picture_12.jpeg",<font></font>
        "bar_code":"2900011680711",<font></font>
        "oem":"2112-1307010",<font></font>
        "price":188.16,<font></font>
        "brand":"AURORA, Poland",<font></font>
        "product_code":"016807",<font></font>
        "gift":0,<font></font>
        "bonus":1,<font></font>
        "new_product":0,<font></font>
        "quantity":15<font></font>
    },<font></font>
    . . .<font></font>
]</code></pre><br>
<br>
 CHARACTERISTIC URL depro/cron/product_charact   product_id.  GET.<br>
<br>
<br>
<pre><code class="plaintext hljs">[<font></font>
    {<font></font>
        "prop_id":2764,<font></font>
        "product_id":2942,<font></font>
        "name":"",<font></font>
        "value":", . , "<font></font>
    },<font></font>
    {<font></font>
        "prop_id":2765,<font></font>
        "product_id":2942,<font></font>
        "name":"   ",<font></font>
        "value":","<font></font>
    },<font></font>
    . . .<font></font>
]</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considérez maintenant nos étapes pour rédiger une demande. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Dans le studio, nous allons créer un nouveau projet. Le nom peut être défini à votre discrétion. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Déploiement des ressources. Comme mentionné dans le premier article, les fichiers de ressources (XML) sont utilisés de manière conventionnelle. Par conséquent, afin de ne pas perdre de temps sur des choses connues, nous téléchargeons simplement </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">toutes les ressources nécessaires</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Décompressez le fichier res_example.zip résultant. Dans le studio, supprimez tout le contenu du dossier res. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Transférez le contenu du dossier res décompressé dans le dossier res du projet. Après cela, en tenant compte des fonctionnalités d'Android Studio, vous devrez peut-être effacer le projet et / ou exécuter la commande Caches / Redémarrage non valide. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. Connexion de la bibliothèque </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la section des dépendances du fichier build.gradle du module, vous devez spécifier:</font></font><br>
<br>
<pre><code class="java hljs">    implementation <span class="hljs-string">'github.com/deprosystem/depro:compon:3.0.1'</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la section android du fichier build.gradle du module, vous devez spécifier:</font></font><br>
<br>
<pre><code class="java hljs">    packagingOptions {<font></font>
        exclude <span class="hljs-string">'META-INF/DEPENDENCIES'</span><font></font>
    }<font></font>
    compileOptions {<font></font>
        sourceCompatibility JavaVersion.VERSION_1_8<font></font>
        targetCompatibility JavaVersion.VERSION_1_8<font></font>
    }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous choisissez l'attribut minSdkVersion, vous devez considérer que la bibliothèque prend en charge minSdkVersion = 17. Après avoir modifié build.gradle, vous devez synchroniser le projet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4. Création des classes nécessaires (fichiers). </font><font style="vertical-align: inherit;">Lorsque vous travaillez avec la bibliothèque, seules 4 classes sont utilisées: MyDeclareScreens - tous les écrans sont décrits; </font><font style="vertical-align: inherit;">MyParams - définissez les paramètres nécessaires pour l'application; </font><font style="vertical-align: inherit;">MyApp - la bibliothèque DePro est lancée; </font><font style="vertical-align: inherit;">MainActivity - activité de démarrage. </font><font style="vertical-align: inherit;">Vous pouvez utiliser vos propres noms de classe. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Créez la classe MyDeclareScreens.java. </font><font style="vertical-align: inherit;">Son contenu est le suivant:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyDeclareScreens</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">DeclareScreens</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">static</span> String<font></font>
            MAIN = <span class="hljs-string">"main"</span>, DRAWER = <span class="hljs-string">"DRAWER"</span>, CATALOG = <span class="hljs-string">"CATALOG"</span>,<font></font>
            DESCRIPT = <span class="hljs-string">"DESCRIPT"</span>, CHARACTERISTIC = <span class="hljs-string">"CHARACTERISTIC"</span>,<font></font>
            PRODUCT_LIST = <span class="hljs-string">"PRODUCT_LIST"</span>, PRODUCT_DESCRIPT = <span class="hljs-string">"PRODUCT_DESCRIPT"</span>,<font></font>
            FITNESS = <span class="hljs-string">"FITNESS"</span>;<font></font>
<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">declare</span><span class="hljs-params">()</span> </span>{<font></font>
        activity(MAIN, R.layout.activity_main)<font></font>
                .navigator(finishDialog(R.string.attention, R.string.finishOk))<font></font>
                .drawer(R.id.drawer, R.id.content_frame, R.id.left_drawer, <span class="hljs-keyword">null</span>, DRAWER);<font></font>
<font></font>
        fragment(DRAWER, R.layout.fragment_drawer)<font></font>
                .menu(model(menu), view(R.id.recycler));<font></font>
<font></font>
        fragment(CATALOG, R.layout.fragment_catalog)<font></font>
                .navigator(handler(R.id.back, VH.OPEN_DRAWER))<font></font>
                .component(TC.RECYCLER_HORIZONTAL, model(Api.NEWS_PROD).pagination().progress(R.id.progr),<font></font>
                        view(R.id.recycler_news, R.layout.item_news_prod),<font></font>
                        navigator(start(PRODUCT_DESCRIPT)))<font></font>
                .component(TC.RECYCLER, model(Api.CATALOG),<font></font>
                        view(R.id.recycler, <span class="hljs-string">"expandedLevel"</span>, <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]{R.layout.item_catalog_type_1,<font></font>
                                R.layout.item_catalog_type_2, R.layout.item_catalog_type_3})<font></font>
                                .expanded(R.id.expand, R.id.expand, model(Api.CATALOG_EX, <span class="hljs-string">"catalog_id"</span>)),<font></font>
                        navigator(start(PRODUCT_LIST)));<font></font>
<font></font>
        activity(PRODUCT_LIST, R.layout.activity_product_list, <span class="hljs-string">"%1$s"</span>, <span class="hljs-string">"catalog_name"</span>).animate(AS.RL)<font></font>
                .navigator(back(R.id.back))<font></font>
                .component(TC.RECYCLER, model(Api.PRODUCT_LIST, <span class="hljs-string">"expandedLevel,catalog_id"</span>),<font></font>
                        view(R.id.recycler, R.layout.item_product_list)<font></font>
                                .visibilityManager(visibility(R.id.bonus_i, <span class="hljs-string">"bonus"</span>),<font></font>
                                        visibility(R.id.gift_i, <span class="hljs-string">"gift"</span>),<font></font>
                                        visibility(R.id.newT, <span class="hljs-string">"new_product"</span>)),<font></font>
                        navigator(start(PRODUCT_DESCRIPT)));<font></font>
<font></font>
        activity(PRODUCT_DESCRIPT, R.layout.activity_product_descript, <span class="hljs-string">"%1$s"</span>, <span class="hljs-string">"catalog_name"</span>).animate(AS.RL)<font></font>
                .navigator(back(R.id.back))<font></font>
                .setValue(item(R.id.product_name, TS.PARAM, <span class="hljs-string">"product_name"</span>))<font></font>
                .component(TC.PAGER_F, view(R.id.pager, DESCRIPT, CHARACTERISTIC)<font></font>
                        .setTab(R.id.tabs, R.array.descript_tab_name));<font></font>
<font></font>
        fragment(DESCRIPT, R.layout.fragment_descript)<font></font>
                .component(TC.PANEL, model(Api.PRODUCT_ID, <span class="hljs-string">"product_id"</span>),<font></font>
                        view(R.id.panel).visibilityManager(visibility(R.id.bonus, <span class="hljs-string">"bonus"</span>)))<font></font>
                .component(TC.RECYCLER, model(Api.ANALOG_ID_PRODUCT,<span class="hljs-string">"product_id"</span>),<font></font>
                        view(R.id.recycler, R.layout.item_product_list).noDataView(R.id.not_analog)<font></font>
                                .visibilityManager(visibility(R.id.bonus_i, <span class="hljs-string">"bonus"</span>),<font></font>
                                        visibility(R.id.gift_i, <span class="hljs-string">"gift"</span>),<font></font>
                                        visibility(R.id.newT, <span class="hljs-string">"new_product"</span>)),<font></font>
                        navigator(start(<span class="hljs-number">0</span>, PRODUCT_DESCRIPT, PS.RECORD),<font></font>
                                handler(<span class="hljs-number">0</span>, VH.BACK))) ;<font></font>
<font></font>
        fragment(CHARACTERISTIC, R.layout.fragment_characteristic)<font></font>
                .component(TC.RECYCLER, model(Api.CHARACT_ID_PRODUCT, <span class="hljs-string">"product_id"</span>),<font></font>
                        view(R.id.recycler, <span class="hljs-string">"2"</span>, <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[] {R.layout.item_property, R.layout.item_property_1}));<font></font>
<font></font>
        fragment(FITNESS, R.layout.fragment_fitness)<font></font>
                .navigator(handler(R.id.back, VH.OPEN_DRAWER))<font></font>
                .component(TC.SPINNER, model(JSON, getString(R.string.clubs)),<font></font>
                        view(R.id.spinner, R.layout.item_spin_drop, R.layout.item_spin_hider))<font></font>
                .component(TC.RECYCLER, model(Api.FITNESS, <span class="hljs-string">"clubId"</span>),<font></font>
                        view(R.id.recycler, R.layout.item_fitness), <span class="hljs-keyword">null</span>).eventFrom(R.id.spinner);<font></font>
    }<font></font>
<font></font>
    Menu menu = <span class="hljs-keyword">new</span> Menu()<font></font>
            .item(R.drawable.list, R.string.m_catalog, CATALOG, <span class="hljs-keyword">true</span>)<font></font>
            .divider()<font></font>
            .item(R.drawable.ic_aura, R.string.fitness, FITNESS);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous décrirons plus loin toutes les constructions DePro utilisées. </font><font style="vertical-align: inherit;">Pour connecter l'importation, utilisez les touches alt + entrée. </font><font style="vertical-align: inherit;">Le rouge sera également mis en surbrillance Classe Api dans laquelle les adresses pour toutes les demandes sont définies. </font><font style="vertical-align: inherit;">Son contenu sera communiqué ultérieurement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Créez la classe MyParams.java. </font><font style="vertical-align: inherit;">Dans la plupart des cas, les paramètres par défaut sont suffisants. </font><font style="vertical-align: inherit;">Dans notre cas, nous ne définirons que l'URL de base.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyParams</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AppParams</span> </span>{
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setParams</span><span class="hljs-params">()</span> </span>{<font></font>
        baseUrl = <span class="hljs-string">"https://deprosystem.com/"</span>;<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Modifiez le contenu créé par le studio de la classe MainActivity comme suit:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseActivity</span> </span>{
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getNameScreen</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> MyDeclareScreens.MAIN;<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le manifeste de MainActivity, vous pouvez spécifier l'orientation portrait. </font><font style="vertical-align: inherit;">En principe, la bibliothèque prend en charge la rotation d'écran, mais dans cette version pour les écrans de type activité (), outre le début, l'orientation portrait est également prescrite. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Créez la classe MyApp:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyApp</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Application</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> MyApp instance;
    <span class="hljs-keyword">private</span> Context context;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> MyApp <span class="hljs-title">getInstance</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">if</span> (instance == <span class="hljs-keyword">null</span>) {<font></font>
            instance = <span class="hljs-keyword">new</span> MyApp();<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> instance;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">super</span>.onCreate();<font></font>
        instance = <span class="hljs-keyword">this</span>;<font></font>
        context = getApplicationContext();<font></font>
<font></font>
        DeclareParam.build(context)<font></font>
                .setAppParams(<span class="hljs-keyword">new</span> MyParams())<font></font>
                .setDeclareScreens(<span class="hljs-keyword">new</span> MyDeclareScreens());<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit d'un singleton régulier dans la méthode onCreate dont MyParams et MyDeclareScreens sont définis. </font></font><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N'oubliez pas de décrire MyApp dans le manifeste.</font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Pour terminer, créez la classe Api:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Api</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String CATALOG = <span class="hljs-string">"depro/cron/catalog"</span>,<font></font>
            NEWS_PROD = <span class="hljs-string">"depro/cron/news_prod"</span>,<font></font>
            PRODUCT_LIST = <span class="hljs-string">"depro/cron/product_list"</span>,<font></font>
            PRODUCT_ID = <span class="hljs-string">"depro/cron/product_id"</span>,<font></font>
            ANALOG_ID_PRODUCT = <span class="hljs-string">"depro/cron/product_analog"</span>,<font></font>
            CHARACT_ID_PRODUCT = <span class="hljs-string">"depro/cron/product_charact"</span>,<font></font>
            FITNESS = <span class="hljs-string">"depro/cron/fitness"</span>,<font></font>
            CATALOG_EX = <span class="hljs-string">"depro/cron/catalog_ex"</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5. Vous pouvez maintenant exécuter l'application pour exécution. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si tout est entré correctement, alors au démarrage de l'application, tous les écrans spécifiés seront affichés (et fonctionneront). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme nous le voyons, nous n'avons que cinq classes simples pour l'ensemble de l'application. Et quatre d'entre eux sont auxiliaires. Leur contenu est indépendant du nombre d'écrans. La description, généralement non banale, des écrans prend également un peu de place (moins de 80 lignes). Maintenant, nous montrons que la description est non seulement pas grande, mais aussi pas compliquée. Pour ce faire, nous décrivons le fonctionnement des composants de bibliothèque utilisés. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme indiqué dans le premier article, les écrans de la bibliothèque peuvent être soit des activités, soit des fragments, qui définissent le nom d'écran (ligne) et la disposition. Les liens vers les écrans se font par leur nom. Le choix du type d'écran à utiliser s'effectue de la manière habituelle.</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Écran MAIN</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ainsi, d'après la conception, on peut voir que l'écran de démarrage a un menu latéral et un conteneur pour les fragments. Dans le balisage de R.layout.activity_main, un DrawerLayout standard est défini. Par conséquent, dans la description de l'écran MAIN, nous spécifions le composant de tiroir, auquel nous transmettons l'id du DrawerLayout lui-même et ses conteneurs pour la barre latérale et les fragments. Nous indiquons également le nom de l'écran (TIROIR), qui sera affiché dans la barre latérale. Le navigateur finishDialog indique qu'avant de quitter l'application, vous devez ouvrir une boîte de dialogue de confirmation. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Écran TIROIR</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Contient un seul composant de menu pour lequel un modèle de type Menu est spécifié dans le modèle et dans la vue id d'un élément de balisage de type RecyclerView, qui affichera le menu. Le menu lui-même indique que l'élément de menu «CATALOGUE» sera affiché dans le conteneur de fragments au démarrage du menu.</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Écran CATALOG</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Contient une nouvelle liste horizontale. Lors de la réception de données du serveur, son modèle utilise la pagination et affiche la progression dans R.id.progr. Si votre Internet est rapide, vous ne remarquerez peut-être pas l'apparition d'un panneau en cours de progression. Si vous voulez le regarder, vous pouvez passer à un Internet plus lent ou changer la couleur d'arrière-plan de R.id.progr. Dans ce cas, vous le verrez au moins clignoter. Pour la pagination, les paramètres spécifiés dans AppParams par défaut sont utilisés. La vue est donnée à R.id.recycler_news avec un RecyclerView et une disposition pour les articles. Lorsque vous cliquez sur un élément de la liste, l'écran PRODUCT_DESCRIPT démarre.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La liste des répertoires est une liste déroulante. Le niveau de divulgation est défini dans le champ "extendedLevel". S'il n'est pas transmis avec les données source, la bibliothèque elle-même s'en occupera. Le même paramètre définit la disposition de la liste à utiliser à chaque niveau de divulgation. Le fait que la liste soit déroulante sert à la fonctionnalité étendue (...). Le modèle sera défini dans le cator pour recevoir les données du serveur pour les niveaux suivants. Le modèle spécifie l'adresse de la requête Api.CATALOG_EX et le nom du paramètre de requête «catalog_id». Dans développé, R.id.expand est également indiqué - un élément de balisage dans les éléments en cliquant sur lequel la liste sera développée et l'ID de l'élément qui sera animé d'une rotation de 180 degrés lors du développement - fermant la liste. Et enfin, le navigateur indiqueque lorsque vous cliquez sur l'élément de liste, l'écran PRODUCT_LIST sera appelé.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le navigateur, qui fait référence à tout l'écran, indique que lorsque vous cliquez sur l'élément R.id.back, un panneau latéral s'ouvre. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Écran PRODUCT_LIST</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Lorsque vous spécifiez un écran, il est indiqué que la valeur actuelle du paramètre catalog_name sera affichée dans l'en-tête et l'animation de sortie sera de droite à gauche (AS.RL). La description de la liste nous est déjà familière. La seule chose pour la présentation est le visibilitéManager, qui contrôle la visibilité des éléments de balisage en fonction des valeurs des données correspondantes. Le navigateur lié à l'ensemble de l'écran indique que lorsque vous cliquez sur l'élément R.id.back, vous revenez à l'écran précédent. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Écran PRODUCT_DESCRIPT</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nouveau pour nous est un composant de type PAGER_F. Il est associé à un ViewPager standard. On lui montre une liste d'écrans (fragments) à afficher, et TabLayout (setTab) est connecté. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'écran PRODUCT_DESCRIPT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> apparaît dans l'onglet DESCRIPTION. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un composant de type PANEL affiche les données obtenues par le modèle. La liste «Analogues» affiche une liste de produits similaires, le cas échéant, ou en utilisant la fonctionnalité noDataView (), le message «Analogues manquants». </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Écran CARACTÉRISTIQUE</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Affiche une liste des fonctionnalités du produit. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Écran FITNESS</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Un composant de type SPINNER affiche une liste de clubs avec l'option d'en sélectionner un. La liste des clubs est définie dans le modèle sous la forme d'une chaîne json.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La liste des catégories de classes est normale. </font><font style="vertical-align: inherit;">La fonction eventFrom (...) indique que lors du changement du composant associé à R.id.spinner (dans notre cas, le spiner), il est nécessaire de mettre à jour les données. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le code de l'application discuté dans l'article peut être consulté sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'article est uniquement à titre indicatif. </font><font style="vertical-align: inherit;">Plus complètement avec les capacités de la bibliothèque DePro est disponible dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr502004/index.html">Méthode Kanban: comprendre votre processus en tant que processus de renforcement des connaissances collectives - Partie 1 (recettes)</a></li>
<li><a href="../fr502008/index.html">Programmation aux masses</a></li>
<li><a href="../fr502014/index.html">Votre employeur: célébrez le Freelancer Day</a></li>
<li><a href="../fr502018/index.html">Podcast sur la sécurité des appareils mobiles et le développement de solutions de protection pour eux</a></li>
<li><a href="../fr502020/index.html">RoadHunters.io - amène les motocyclistes à travers le monde</a></li>
<li><a href="../fr502028/index.html">Vanya va à grand-mère ou adaptative JavaScript dynamique</a></li>
<li><a href="../fr502030/index.html">Services Web dans Oracle</a></li>
<li><a href="../fr502034/index.html">Les composants contrôlés et non contrôlés de React n'ont pas à être compliqués</a></li>
<li><a href="../fr502038/index.html">Élever un atome, approche 2.0.1</a></li>
<li><a href="../fr502040/index.html">À propos des verbes Phrasal-5 (haut / bas)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>