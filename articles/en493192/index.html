<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèæ‚Äçü§ù‚Äçüë®üèº üë®üèª‚Äçüéì üëáüèø ASCII game - a compromise of authenticity and convenience üëºüèº üîÉ üë©üèø‚Äçü§ù‚Äçüë©üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello everyone! While developing a game stylized as a text mode, I came to the expected contradiction. On the one hand, the game should be saturated w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ASCII game - a compromise of authenticity and convenience</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/493192/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hello everyone! </font><font style="vertical-align: inherit;">While developing a game stylized as a text mode, I came to the expected contradiction. </font><font style="vertical-align: inherit;">On the one hand, the game should be saturated with the spirit of the text mode, because for this I like it and, I hope, fans of retro games will like it. </font><font style="vertical-align: inherit;">On the other hand, I want the gameplay to be as enjoyable and modern as possible. </font><font style="vertical-align: inherit;">In this article I will describe five points on which I deviated from the true text mode. </font><font style="vertical-align: inherit;">Did I manage to keep the tube alphanumeric mood in the game? </font><font style="vertical-align: inherit;">I ask to express an opinion!</font></font><br>
<br>
<img src="https://habrastorage.org/webt/3m/au/i_/3maui_cqcqdkfsxpfwj-us8x0e4.jpeg"><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Character Set</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Absolutely all the graphics in the game are made using the characters that are typed on the keyboard. </font><font style="vertical-align: inherit;">To be more precise, the characters from the ASCII table from the 32nd to the 126th character are used. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/11/7_/e7/117_e79lbv7xxuzovttn1i3e7hy.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, the texts in the game are localized in several languages. </font><font style="vertical-align: inherit;">Now I support Russian and English in parallel, but I want to add a few more, including Chinese. </font><font style="vertical-align: inherit;">Characters from ASCII tables, even extended ones, are clearly not enough for these purposes. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/du/cl/oa/ducloab5-3du4oldzbmxptnvvja.jpeg"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dialogs in the game may contain characters not from the authentic range. </font><font style="vertical-align: inherit;">However, these characters are not involved in the design. </font><font style="vertical-align: inherit;">Graphics are ASCII only.</font></font><br>
 <br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Sub-character precision</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unlike text modes, ASCIIDENT uses pixel precision for moving text layers and moving sprites. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/0o/l0/op/0ol0ophebaebco715pyi0kic2e4.gif"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In text mode, sprite shifting by one position looks like a noticeable jump. For such a dynamic game as ASCIIDENT - this is unacceptable from the point of view of modern gaming experience. Therefore, for individual sprites and text layers, which will be discussed later, I made a smooth movement. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To maintain authenticity, I adhere to the following rule. Inside one text layer, all static objects are clearly aligned on the character grid. Moreover, each sprite consists of characters also aligned on a character grid.</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Relative to each other, layers and moving objects can be located at a sub-symbolic distance. </font><font style="vertical-align: inherit;">This ensures a smooth movement and, accordingly, a comfortable gameplay. </font><font style="vertical-align: inherit;">This is such a compromise.</font></font><br>
 <br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Parallax</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The game has several text layers that move at different speeds, realizing the parallax effect. </font><font style="vertical-align: inherit;">The symbols of the upper layers overlap the symbols of the lower ones. </font><font style="vertical-align: inherit;">With sub-character precision, the overlap criterion is an overlay of more than 50% of the width and / or height of the text cell. </font><font style="vertical-align: inherit;">Using a simple z-buffer, this overlap is easy to implement. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/tx/6f/sf/tx6fsfikvf90-erih8upoha3ssi.gif"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parallax with smooth movement of layers is a very expressive graphic technique. </font><font style="vertical-align: inherit;">Yes, it may greatly violate the authenticity of the text mode. </font><font style="vertical-align: inherit;">However, I decided to use parallax. </font><font style="vertical-align: inherit;">It turns out very beautifully.</font></font><br>
 <br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Animation</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Animation of individual sprites in the game "honest", made strictly in text mode. The position of each character is aligned on the text grid. Animations are obtained by replacing characters in cells. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/rq/-n/bt/rq-nbtwibvurx8nqe48jrl928fw.gif"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I found it very important to maintain the integrity of sprite animations. This is probably the main thing that makes the game so retro-attractive. Moreover, with this type of animation, it becomes technically very simple to create and edit animated ASCII sprites. I could not resist and made a built-in ASCII editor in the game. At any time, any graphic element can be loaded into it and changed. You can, for example, edit the chest by adding animation frames, and after saving all the chests in all places of the game will become new. Any player can do this, thereby creating his own mod of the game.</font></font><br>
 <br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/AZw6BZaF250" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, sometimes you need smooth animation! </font><font style="vertical-align: inherit;">For example, in the game there is such a place where biological optical fiber is grown. </font><font style="vertical-align: inherit;">A drone flies above the beds, which irrigates the optical fiber with a toxic liquid. </font><font style="vertical-align: inherit;">The liquid should drip smoothly, otherwise ugly. </font><font style="vertical-align: inherit;">To implement such effects, I made sprite generators and their binding to any other sprites in the game world. </font><font style="vertical-align: inherit;">Technically, every drop is a separate sprite that can move with subpixel accuracy. </font><font style="vertical-align: inherit;">A reasonable compromise again.</font></font><br>
 <br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Light, color and font</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Many people to whom I show the game make the remark that there are too many colors in my game. In text modes there was no such richness of shades. The fact is that I implemented a full-screen lightmap that calculates any number of light sources. At the same time, the color of each character is 24-bit (16,777,216 different colors). Sometimes the picture looks colorful. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/ta/5h/2i/ta5h2i1ijypt1yhav7kwmikgn1w.gif"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To emulate retro color modes, I made seven additional options: three monochrome modes, two 16-color modes (DOS / Mac), 2-bit and Game Boy mode. LED font mode is also available. In this mode, each pixel of each character is separated from neighboring ones. The video below shows all the modes - how they affect the picture.</font></font><br>
 <br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Xnl4sGhA0m0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The color conversion algorithm for monochrome modes made this. First, I calculate the color brightness (R, G, B): </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V = 0.3 * R + 0.59 * G + 0.11 * B </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Monochrome retro monitors have different color tones for different symbol brightness. Therefore, the shade must also change. I use such linear interpolation: </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RR = sqrt (V) * (monoR1 * (1 - V) + monoR2 * V) </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GG = sqrt (V) * (monoG1 * (1 - V) + monoG2 * V) </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BB = sqrt (V ) * (monoB1 * (1 - V) + monoB2 * V) </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Final color (RR, GG, BB) </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For 16-color modes, I use a different algorithm. For each color (R, G, B) I am looking for the closest color in the palette. That's all.</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2-bit and Game Boy mode has only four colors in the palette. </font><font style="vertical-align: inherit;">A simple search for the nearest color gives a very dark picture. </font><font style="vertical-align: inherit;">Therefore, before looking for a color in the palette, I do the normalization: </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d = 1 / max (R, G, B) </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
normR = d * R, normG = d * G, normB = d * B </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Formulas are schematic. </font><font style="vertical-align: inherit;">Checks for division by zero did not mention. </font><font style="vertical-align: inherit;">I hope that everyone who decides to play ASCIIDENT will be able to choose for themselves a color scheme that will maximally warm his or her retro soul.</font></font><br>
 <br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. Console with an honest text mode</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the process of creating the game, the idea came to put computer terminals with an honest text mode into the game world. You can approach them, connect and work / play. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If the game itself is stylized as an 80x25 text mode with smooth scrolling and parallax of text layers, then the built-in terminal screen has a resolution of 72x20 characters without any possibility to go beyond this grid. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All applications for embedded terminals (including the bootloader) are written in the DUHASM programming language. This language is similar to Assembler, but has dynamic variables and arrays. Here, for example, is a piece of Pi-astre Hanter game code: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yu/fh/gi/yufhgigy6d6il1scdqgmgaaen4q.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A fun feature is that loops are implemented as part of conditional constructs, where LOOP is placed instead of END.</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At launch, the game loads applications from * .duhasm files and compiles them into byte code. When a player activates the console, an honest interpreter is launched. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At the moment, I have written two games on DUHASM, which are already available in the current version. There is a plan to write a code editor (also on DUHASM of course) so that each player can try to create an application / game that all other players will see.</font></font><br>
 <br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/xlJWOktA9k0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I hope that I have not in vain spent a lot of effort and time to implement this feature and there will be people who like it. </font><font style="vertical-align: inherit;">The DUHASM language certainly needs some refinement. </font><font style="vertical-align: inherit;">I don‚Äôt really like how, for example, functions are called with arguments. </font><font style="vertical-align: inherit;">According to the history of the game, the DUHASM language came up with a semi-sensible cyborg who escaped from the laboratory of space pirates. </font><font style="vertical-align: inherit;">Surprisingly, this programming language has taken root on the outskirts of the inhabited part of the universe.</font></font><br>
 <br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CONCLUSION</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Well, there were a lot of compromises - a set of characters, sub-character precision, animation, colors. </font><font style="vertical-align: inherit;">But also to maintain a sense of authenticity to the text mode, I have undertaken a lot over these more than two years of development. </font><font style="vertical-align: inherit;">To get more feedback and understand whether I‚Äôm moving in the right direction, I decided to start the game on </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">early access in Steam</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">There is something magically attractive in text modes. </font><font style="vertical-align: inherit;">When any picture can be typed with characters on the keyboard, it is sometimes difficult to resist and not start the game with the built-in ASCII editor, and even not draw a prototype of a new mini-game, which then will be implemented in the DUHASM language. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/0y/i7/se/0yi7sedgucpkb-nstvzouepmo2s.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thanks to all! </font><font style="vertical-align: inherit;">Till!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en493172/index.html">The bigger, the worse or why the game loop matters</a></li>
<li><a href="../en493178/index.html">Everything is amazing in software, but everyone is unhappy</a></li>
<li><a href="../en493184/index.html">Contract development of electronics. Project calculation</a></li>
<li><a href="../en493186/index.html">The best automotive-related articles for developers on Habr√© [170+]</a></li>
<li><a href="../en493190/index.html">How we created the gallery of neural network art and why we do not give pictures to copy</a></li>
<li><a href="../en493196/index.html">Preparing for ShAD without leaving home</a></li>
<li><a href="../en493198/index.html">How to visualize and animate (geophysical) models. Voxel models and mesh surfaces</a></li>
<li><a href="../en493200/index.html">Distribution of a spherical horse in a vacuum throughout the Russian Federation</a></li>
<li><a href="../en493202/index.html">RBK.money released the world's first open-source payment processing - creating the future together</a></li>
<li><a href="../en493204/index.html">Alexey Komissarov about Digital Breakthrough 2020</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>