<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧀 👩🏼‍💻 💛 Einfache Integration von RabbitMQ und Spring Boot 🕗 🏹 👇🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eine Übersetzung des Artikels wurde vor Beginn des Kurses "Developer on the Spring Framework" erstellt .
 
 
 
 Hallo alle zusammen! 
 
 Ich möchte Ih...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Einfache Integration von RabbitMQ und Spring Boot</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/500936/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine Übersetzung des Artikels wurde vor Beginn des Kurses </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Developer on the Spring Framework" erstellt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></b></i><br>
<br>
<img src="https://habrastorage.org/webt/yc/3k/dp/yc3kdpwvkd25ltyl0y2e41jwvsk.png"><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hallo alle zusammen! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich möchte Ihnen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eine Open-Source-Bibliothek zur Verfügung stellen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die die Integration von RabbitMQ in Anwendungen auf Spring Boot erleichtert. </font><font style="vertical-align: inherit;">Darüber hinaus bietet diese Bibliothek ein neues, verbessertes Konzept für Wiederholungsversuche (im Vergleich zum Standardansatz von Spring AMQP).</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vereinfacht? </font><font style="vertical-align: inherit;">Aber wie?</font></font></blockquote><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autokonfiguration</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angenommen, wir möchten eine Interaktion (z. B. mit SSL) mit RabbitMQ mithilfe von Spring AMQP implementieren. </font><font style="vertical-align: inherit;">Wir brauchen ein paar Bohnen, wie zu schaffen </font></font><code>ConnectionFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>RabbitAdmin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>RabbitTemplate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>AbstractRabbitListenerContainerFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stellen Sie sich jedoch vor, dass es in RabbitMQ mehrere virtuelle Hosts gibt. </font><font style="vertical-align: inherit;">Standardmäßig müssen Sie in Spring AMQP ein solches Ökosystem für jeden virtuellen Host mit manueller Konfiguration von </font></font><code>RabbitTemplate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font><font style="vertical-align: inherit;">erstellen </font></font><code>RabbitListener</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jl/zr/hs/jlzrhsbdrmwg9oqcmv-hc4hlbjg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie sehen können, nimmt all diese Konfiguration Zeit in Anspruch und kann Kopfschmerzen verursachen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die vorgeschlagene Bibliothek ist sich dieses Problems bewusst und konfiguriert automatisch alle diese Beans für Sie. </font><font style="vertical-align: inherit;">Das einzige, was Sie tun müssen, ist die Konfiguration in zu bestimmen </font></font><b><code>application.properties</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, und Magie wird passieren!</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wow, aber wie sieht die Konfiguration aus </font></font><code><b>application.properties</b></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">?</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alles ist sehr einfach. </font><font style="vertical-align: inherit;">Erstens gibt es ein Präfix für die Eigenschaften - dies </font></font><b><code>spring.rabbitmq.custom</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Danach müssen Sie den Namen des Ereignisses angeben. </font><font style="vertical-align: inherit;">Dies ist ein sehr wichtiger Teil, da alle Einstellungen, die die Bibliothek vornimmt, auf diesem Namen basieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach dem Ereignisnamen können Sie die Eigenschaft und den Wert angeben. </font><font style="vertical-align: inherit;">Alle Eigenschaften sind in der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokumentation beschrieben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Vorlage sieht also wie folgt aus: </font><font style="vertical-align: inherit;">
Nachfolgend finden Sie eine Beispielkonfiguration für zwei verschiedene Verbindungen.</font></font><br>
<br>
<code><code>spring.rabbitmq.custom.&lt;</code>YOUR_EVENT&gt;.<code>&lt;</code>PROPERTY&gt;=<code>&lt;</code>VALUE&gt;<br>
</code><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="java hljs">spring.rabbitmq.custom.some-event.host=localhost<font></font>
spring.rabbitmq.custom.some-event.port=<span class="hljs-number">5672</span>
spring.rabbitmq.custom.some-event.ttlRetryMessage=<span class="hljs-number">5000</span>
spring.rabbitmq.custom.some-event.maxRetriesAttempts=<span class="hljs-number">5</span>
spring.rabbitmq.custom.some-event.ttlMultiply=<span class="hljs-number">2</span><font></font>
spring.rabbitmq.custom.some-event.queueRoutingKey=ROUTING.KEY.TEST<font></font>
spring.rabbitmq.custom.some-event.exchange=ex.custom.direct<font></font>
spring.rabbitmq.custom.some-event.exchangeType=direct<font></font>
spring.rabbitmq.custom.some-event.queue=queue.custom.test<font></font>
spring.rabbitmq.custom.some-event.autoCreate=<span class="hljs-keyword">true</span>
spring.rabbitmq.custom.some-event.concurrentConsumers=<span class="hljs-number">1</span>
spring.rabbitmq.custom.some-event.maxConcurrentConsumers=<span class="hljs-number">1</span><font></font>
spring.rabbitmq.custom.some-event.virtualHost=tradeshift<font></font>
spring.rabbitmq.custom.some-event.primary=<span class="hljs-keyword">true</span>
spring.rabbitmq.custom.some-event.sslConnection=<span class="hljs-keyword">true</span>
spring.rabbitmq.custom.some-event.tlsKeystoreLocation=file:<span class="hljs-comment">///etc/tradeshift/your-service/tls-keystore.pkcs12</span><font></font>
spring.rabbitmq.custom.some-event.tlsKeystorePassword=${RABBITMQ_PASS_CERT}<font></font>
<font></font>
spring.rabbitmq.custom.another-event.host=localhost<font></font>
spring.rabbitmq.custom.another-event.port=<span class="hljs-number">5672</span>
spring.rabbitmq.custom.another-event.ttlRetryMessage=<span class="hljs-number">5000</span>
spring.rabbitmq.custom.another-event.maxRetriesAttempts=<span class="hljs-number">5</span><font></font>
spring.rabbitmq.custom.another-event.queueRoutingKey=TEST.QUEUE<font></font>
spring.rabbitmq.custom.another-event.exchange=ex_test_1<font></font>
spring.rabbitmq.custom.another-event.exchangeType=direct<font></font>
spring.rabbitmq.custom.another-event.queue=queue_test_1<font></font>
spring.rabbitmq.custom.another-event.autoCreate=<span class="hljs-keyword">true</span>
spring.rabbitmq.custom.another-event.concurrentConsumers=<span class="hljs-number">1</span>
spring.rabbitmq.custom.another-event.maxConcurrentConsumers=<span class="hljs-number">1</span><font></font>
spring.rabbitmq.custom.another-event.username=guest<font></font>
spring.rabbitmq.custom.another-event.password=${RABBITMQ_PASS}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie sehen können, haben wir keine einzige Codezeile geschrieben !!!</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gut, aber Sie haben etwas über die neue Wiederholungsstrategie gesagt, oder?</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ja mein Freund sagte! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bevor wir diese neue Strategie erläutern, werfen wir einen Blick auf das Standardverhalten von RabbitMQ und Spring AMQP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Standardmäßig bietet RabbitMQ keine Wiederholungsverarbeitung, mit der Sie den gesamten Nachrichtenlebenszyklus steuern können. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vor </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RabbitMQ 3.8</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hatte der Nachrichtenkopf beispielsweise keine Eigenschaft, um die Anzahl der durchgeführten Wiederholungen zu steuern. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Standardverhalten von RabbitMQ:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie nicht definiert haben , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Time-to-Live</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (TTL, Lebensdauer), dann wird RabbitMQ ständig versuchen , </font><font style="vertical-align: inherit;">Ihre Nachricht in der </font><font style="vertical-align: inherit;">Warteschlange.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie TTL definiert </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">haben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">aber </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">dlx</font></a><font style="vertical-align: inherit;"> nicht definiert </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">haben</font></a><font style="vertical-align: inherit;"> , wird die Nachricht nach TTL aus der Warteschlange entfernt und Sie verlieren sie.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie TTL und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dlx</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> definiert </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">haben</font></a><font style="vertical-align: inherit;"> , wird die Nachricht nach TTL an den </font><font style="vertical-align: inherit;">in dlx definierten </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Austauscher</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gesendet.</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/pg/kb/bu/pgkbbu4_hvodxqc5oqtnjlxp5mo.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RabbitMQ-Standardverhalten</font></font></i><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aber was ist, wenn wir eine zunehmende TTL wollen (zum Beispiel bei instabilem Betrieb) und die Anzahl der Wiederholungsversuche kontrollieren möchten?</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gute Frage! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist Zeit zu erklären, wie Spring AQMP und Spring Rabbit Tuning Library funktionieren!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wiederholungsstrategien</font></font></h2><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spring AMQP standardmäßig</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spring AMQP standardmäßig verwenden, können</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sie Wiederholungsoptionen mithilfe der folgenden Eigenschaften definieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Ansatz hat jedoch Probleme. </font><font style="vertical-align: inherit;">Standardmäßig blockiert Spring AMQP Ihre Warteschlange, wenn Sie erneut versuchen, eine Nachricht zuzustellen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieses Problem kann auf Umwegen gelöst werden: Verwenden Sie Parallelität. </font><font style="vertical-align: inherit;">Auf diese Weise laden wir die JVM, und dies ist nicht der beste Ansatz. </font><font style="vertical-align: inherit;">Wenn Sie fünf problematische Meldungen haben (wie im Beispiel), tritt erneut ein Engpass auf, und wir müssen die Beans im </font></font><code>@Configuration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- bin für jede Verbindung und jeden Container </font><font style="vertical-align: inherit;">noch manuell ermitteln </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="java hljs">spring.rabbitmq.listener.simple.retry.enabled=<span class="hljs-keyword">true</span>
spring.rabbitmq.listener.simple.retry.initial-interval=<span class="hljs-number">2000</span>
spring.rabbitmq.listener.simple.retry.max-attempts=<span class="hljs-number">5</span>
spring.rabbitmq.listener.simple.retry.multiplier=<span class="hljs-number">2</span>
spring.rabbitmq.listener.simple.max-concurrency=<span class="hljs-number">5</span>
spring.rabbitmq.listener.simple.concurrency=<span class="hljs-number">5</span></code></pre><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spring RabbitMQ Tuning</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Bibliothek verfolgt einen anderen Ansatz mit einer separaten Warteschlange für Wiederholungsversuche. </font><font style="vertical-align: inherit;">Auf diese Weise können wir TTL mithilfe des Ablaufnachrichtenparameters und des Parameters x-death steuern, um die Anzahl der Wiederholungsversuche zu steuern.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aber wie?</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir verwenden das dlx-Konzept in der Wiederholungswarteschlange, um die Nachricht erneut an die Hauptwarteschlange zu senden. </font><font style="vertical-align: inherit;">Somit haben wir Zugriff auf den Parameter x-death und können die Lebensdauer der Nachricht programmgesteuert bestimmen. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinweis. </font><font style="vertical-align: inherit;">Da diese Bibliothek eine Erweiterung von Spring AMQP ist, können Sie die Standard-Wiederholungsstrategie verwenden und diese Bibliothek nur für die automatische Konfiguration von Beans verwenden. </font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/2t/d7/n3/2td7n3ayuw29wlik_b6y4xi_num.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spring RabbitMQ Tuning Retry</font></font></i><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kann ich Ihre Wiederholungsstrategie ohne automatische Konfiguration verwenden? </font><font style="vertical-align: inherit;">Ich habe bereits viele Bohnen und ich habe keine Zeit, sie umzuschreiben.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir wissen, dass die Welt nicht perfekt ist, und für diese Situation haben wir ein Flag, mit dem Sie die automatische Konfiguration deaktivieren und nur unseren Ansatz für die Wiederholungsverarbeitung und andere Vorteile wie die Behälterverwaltung verwenden können. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können die automatische Konfiguration mithilfe der folgenden Eigenschaft deaktivieren:</font></font><br>
<br>
<pre><code class="java hljs">spring.rabbitmq.enable.custom.autoconfiguration=<span class="hljs-keyword">false</span></code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aber ich habe zwei verschiedene Verbindungen. Was soll ich in diesem Fall tun?</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie mehr als eine Verbindung haben und die automatische Konfiguration deaktivieren möchten, müssen Sie den Bean-Namen </font></font><code>RabbitTemplate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">für jede Verbindung </font><font style="vertical-align: inherit;">angeben </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dies wird </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> beschrieben </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">
Sie können unsere Bean weiterhin verwenden </font><font style="vertical-align: inherit;">, um die Arbeit mit Spring AMQP zu vereinfachen.</font></font><br>
<br>
<code><code>spring.rabbitmq.custom.&lt;</code>YOUR_EVENT&gt;.rabbitTemplateBeanName= <code>&lt;</code>RABBITTEMPLATE_BEAN_NAME&gt;</code><br>
<br><font style="vertical-align: inherit;"></font><code>RabbitTemplateHandler</code><font style="vertical-align: inherit;"></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sehr gut! </font><font style="vertical-align: inherit;">Also möchte ich das nutzen. </font><font style="vertical-align: inherit;">Wie kann ich das machen? </font><font style="vertical-align: inherit;">Haben Sie ein Beispiel oder eine Dokumentation?</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ja! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diesem Repository</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> befindet </font><font style="vertical-align: inherit;">sich ein Beispielprojekt, in </font><font style="vertical-align: inherit;">dem Sie sehen können, wie Sie diese Bibliothek für Herausgeber und Abonnenten verwenden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber es ist so einfach, dass ich hier ein Beispiel geben werde!</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verleger</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt eine Klasse in der Bibliothek </font></font><code>RabbitTemplateHandler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und sie ist sehr einfach zu bedienen. </font><font style="vertical-align: inherit;">Sie müssen die Methode aufrufen </font></font><code>getRabbitTemplate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und den virtuellen Host als Parameter übergeben, um die Bean abzurufen </font></font><code>RabbitTemplate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Danach können Sie die convertAndSend-Methode aufrufen und in den Exchange- und Routing-Schlüsselparametern übergeben. </font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinweis</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Der Austausch- und Routing-Schlüssel kann mithilfe von Anmerkungen abgerufen werden</font></font></i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wert</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Beispiel</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Value("${spring.rabbitmq.custom.some-event.exchange}")</span>
<span class="hljs-keyword">private</span> String exchangeSomeEvent;<font></font>
<font></font>
<span class="hljs-meta">@Value("${spring.rabbitmq.custom.some-event.queueRoutingKey}")</span>
<span class="hljs-keyword">private</span> String routingKeySomeEvent;<font></font>
<font></font>
<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> RabbitTemplateHandler rabbitTemplateHandler;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">sendMessage</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String message)</span> </span>{<font></font>
   rabbitTemplateHandler.getRabbitTemplate(<span class="hljs-string">"some-event"</span>).convertAndSend(exchangeSomeEvent, routingKeySomeEvent, message);<font></font>
}</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teilnehmer</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abonnenten sind auch sehr einfach. </font><font style="vertical-align: inherit;">Sie müssen der Methode lediglich eine Anmerkung hinzufügen </font></font><code>RabbitListener</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(standardmäßig Spring AMQP-Anmerkung) und den Namen übergeben </font></font><code>containerFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie finde ich den richtigen containerFactory-Namen für einen virtuellen Host heraus?</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie müssen es nicht wissen, geben Sie einfach den Namen des Ereignisses ein und die Bibliothek wird die ganze Magie für Sie erledigen! </font><font style="vertical-align: inherit;">Diese Bibliothek kann auch Wiederholungsversuche und dlq enthalten, die empfohlen werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Einschalten ist sehr einfach. </font><font style="vertical-align: inherit;">Sie müssen der Methode Anmerkungen hinzufügen </font></font><code>EnableRabbitRetryAndDlq</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und den Namen der Eigenschaft als Argument übergeben. </font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinweis</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Sie können auch angeben, welche Ausnahmen mit Wiederholungsversuchen und dlq behandelt werden sollen. </font><font style="vertical-align: inherit;">Es wird standardmäßig verarbeitet </font></font><code>Exception.class</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dh alle Ausnahmen werden behandelt. </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispiel:</font></font></b><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@RabbitListener(containerFactory = "some-event", queues = "${spring.rabbitmq.custom.some-event.queue}")</span>
<span class="hljs-meta">@EnableRabbitRetryAndDlq(event = "some-event", exceptions = { IllegalArgumentException.class, RuntimeException.class })</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onMessage</span><span class="hljs-params">(Message message)</span> </span>{<font></font>
   ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das ist alles! </font><font style="vertical-align: inherit;">Ich hoffe, Ihnen gefällt diese Bibliothek genauso gut wie uns! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und vor allem: Sie können gerne einen Beitrag leisten oder Feedback senden!</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Besonderer Dank an</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andre Luis Gomes </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rogerio Bueno </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leonardo Ferreira</font></font></a><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Melden Sie sich für eine kostenlose Lektion an.</font></font></a><br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de500926/index.html">Dynamisches Tippen ist kein Entwicklungswerkzeug. Das ist Unsinn (mies)</a></li>
<li><a href="../de500928/index.html">Digital Breakthrough Contest 2020 startet Online-IT-Marathon</a></li>
<li><a href="../de500930/index.html">Kleine Geheimnisse für Spieledesigner, damit ein Spieler Ihr Spiel ein wenig weniger hasst</a></li>
<li><a href="../de500932/index.html">Spam als Schutzwerkzeug</a></li>
<li><a href="../de500934/index.html">Winnum kündigt eine neue Version der Flaggschiff-Plattform Winnum Platform 4.3 an</a></li>
<li><a href="../de500942/index.html">Ultraviolett: wirksame Desinfektion und Sicherheit</a></li>
<li><a href="../de500944/index.html">WexLang Reader - wie man gerne Bücher in Fremdsprachen liest (104 Sprachen)</a></li>
<li><a href="../de500948/index.html">Rust 1.43.1 Release: Einstellfreigabe</a></li>
<li><a href="../de500952/index.html">Wichtige Python-Programmiererfähigkeiten</a></li>
<li><a href="../de500956/index.html">Mobile ML: Maschinelles Lernen in der Tasche. Teil 1 - Eisen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>