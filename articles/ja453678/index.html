<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏽‍⚕️ 😲 😦 水を通して音のリバーブまたはビデオ伝送を確認する方法-2 ↙️ 🙎🏿 👃🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="こんにちは、あなた！
 
 今日は再び水を通して超音波で画像を送信します。文字通りの残響とエコー、さらには条件に応じてそれらがどのように変化するかがわかります。私がお伝えすることはすべて簡単です。自分で繰り返すのは興味深いことであり、ほとんど誰でも行うことができます。
 
 これらの言葉から何かがあ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>水を通して音のリバーブまたはビデオ伝送を確認する方法-2</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453678/"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こんにちは、あなた！</font></font></h3><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今日は再び水を通して超音波で画像を送信します。文字通りの残響とエコー、さらには条件に応じてそれらがどのように変化するかがわかります。</font><font style="vertical-align: inherit;">私がお伝えすることはすべて簡単です。自分で繰り返すのは興味深いことであり、ほとんど誰でも行うことができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの言葉から何かがあなたの魂に舞い散っていたなら、キャットへようこそ、私たちの池の暗い水の中へ！</font></font><br>
<br>
<img src="https://habrastorage.org/webt/e7/dd/ql/e7ddqlsffkcu34ex7scxfsvt4fs.png"><br>
<a name="habracut"></a><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「最もよい残りは有名な真実を解釈することです。」</font><font style="vertical-align: inherit;">（C）ABS、正午、XXII世紀</font></font></blockquote><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プレリュード</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
水中音響の目撃者クラブの基本的なルールは、水の中央で多かれ少なかれ重要な距離（数メートル以上）で水中音響を使用するビデオは送信できず、常に不可能であることです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これには重大な理由があります。非常に低い帯域幅、低い信号伝搬速度（水中では1,500 m /秒）、エラーの高い確率の通信チャネルです。利用可能な周波数帯域は、ほんの数十キロヘルツです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、これがすべてではありません-条件付きで言えば、10 kHzのオーダーの周波数の信号が約8-10 kmの距離で水中を伝播する場合、20 kHzの周波数ではすでに3-5 kmであり、周波数が高いほど、減衰は強くなります。たとえば、世界最小の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">uWAVE</font></a><font style="vertical-align: inherit;">モデム</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">20〜30 kHzの帯域で動作し、1000メートルあたり78ビット/秒の速度でデータを送信し、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RedLINEは5〜15〜8000</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メートルの帯域で送信します</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">商用デバイスの記録は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EvoLogicsに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属し、</font><font style="vertical-align: inherit;">300メートルあたり68 kビットです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
悲しいことに、物理学はだまされることができず、それに同意することは不可能です-それは非常にゆっくりとノイズ耐性があり、または速く、しかし短距離で伝わることがあります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、場合によっては、「一部の角を切り落とす」ことも可能です。今回はどの角を低くするかを決めます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">今日は何をしますか、そしてこれには何が必要ですか？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前の記事では、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">水を介して音声付きの「ビデオ」</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">をすでに</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">送信</font></a><font style="vertical-align: inherit;">しました。そこで、フレームが「スペクトルに描かれた」、つまり、スペクトル、つまり信号のスペクトログラムが画像であったことを思い出します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
後で私たち</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はゴミから単純な水音響アンテナ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を作り、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最も単純な水音響モデム</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を作りました</font><font style="vertical-align: inherit;">。そこで、アンテナ用のプリアンプも作成しました（LUTオームによる自己生産用のPCBの設計はまだ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あり</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">）。</font><s><font style="vertical-align: inherit;">幼稚園の</font></s><font style="vertical-align: inherit;">生徒で</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
も理解できるように、他の方法で写真を伝えよう</font><font style="vertical-align: inherit;">と考えていましたが、以前よりもさらに簡単な方法を考え出したと思います。</font><font style="vertical-align: inherit;">
要約すると、必要なもののリストを作成します。</font></font><s><font style="vertical-align: inherit;"></font></s><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -一対の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パイピッカーからソナーアンテナ</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
 - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プリアンプ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> LUTオーム社製</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のソースコード</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C＃でプロジェクト</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 12ボルトのリード電池のペア- </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - TDA上の増幅器、私が取った</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ものを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アリにのみ50ルーブル</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">理論のビット</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソナーモデム</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、サンプリング周波数より4倍低い周波数の単純なトーン検出器に基づいていた</font><font style="vertical-align: inherit;">ことを思い出してください</font><font style="vertical-align: inherit;">。それがどのように機能するかを簡単に思い出してください。</font></font><br>
<img src="https://habrastorage.org/webt/__/zm/oe/__zmoe1u0jzgjderykrsaogn0k8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図は、Pi / 2で相互にシフトした2つの振動、つまり正弦波と余弦波の位相を示しています。そして、周波数がサンプリング周波数より正確に4倍低い場合、4つのサンプルのみが周期に該当します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意深いhabuchitelは確かに両方の信号がPi / 4にシフトされることに気づきました。このようなシフトでは、信号は2つの値しか取りません：√2/ 2および-√2/ 2。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、特定の値は重要ではなく、「+」と「-」の記号のみを使用できることが重要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、サインフェーズを一連の記号「+」「+」「-」「-」として表し、コサインフェーズを「+」「-」「-」「+」として表すことができます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スポイラーの下で、検出器を繰り返します。</font></font></b><div class="spoiler_text">      sn,             — bs  bc  N.        — bH  bT.     bH = N-1, bT = 0.    C = 0.<br>
     4      .<br>
<br>
<code>a = sn(i)<br>
bs(bH) = a<br>
bc(bH) = a<br>
s1 = s1 + a - bs(bT)<br>
s2 = s2 + a - bc(bT) <br>
bH = (bH + 1) % N<br>
bT = (bT + 1) % N<br>
<br>
a = sn(i+1)<br>
bs(bH) = a<br>
bc(bH) = -a<br>
s1 = s1 + a - bs(bT)<br>
s2 = s2 - a - bc(bT) <br>
bH = (bH + 1) % N<br>
bT = (bT + 1) % N<br>
<br>
a = sn(i+2)<br>
bs(bH) = -a<br>
bc(bH) = -a<br>
s1 = s1 - a - bs(bT)<br>
s2 = s2 - a - bc(bT) <br>
bH = (bH + 1) % N<br>
bT = (bT + 1) % N<br>
<br>
a = sn(i+3)<br>
bs(bH) = -a<br>
bc(bH) = a<br>
s1 = s1 - a - bs(bT)<br>
s2 = s2 + a - bc(bT) <br>
bH = (bH + 1) % N<br>
bT = (bT + 1) % N<br>
</code><br>
<br>
              N,    cA :<br>
<br>
<code>if ++cycle &gt;= N<br>
 cA = sqrt(s1 * s1 + s2 * s2)<br>
 cycle = 0<br>
end<br>
</code><br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この方法を基本として、「同期」を担当します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、画像がどのようにエンコードされるかを見てみましょう。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">振幅操作</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用することをお勧めし</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">操作とは、信号をチップまたはシンボルと呼ばれる等しいセグメントに分割し、いくつかの可変パラメーター（この場合、振幅）をチップの長さに沿って保存することです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、振幅を0から32767（16ビットサンプル）の範囲で変化させることができ、ピクセルの輝度の255の値を送信する必要がある場合、ピクセルの輝度の変化の単位ごとに、チップの振幅は32768/255 = 128に変化します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もう1つの重要なパラメーターはチップの長さです。ここでは、1つのキャリア周期（この場合は4つのサンプル）から始めます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、画像はピクセルごとに送信され、各ピクセルは4サンプル持続し、この期間の振幅はb [x、y] * 128に等しくなります。ここで、b [x、y]は、画像bのx座標とy座標を持つピクセルの輝度値です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
伝送速度はどのくらいになるか試してみましょう。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例では、120x120ピクセルのフレームサイズを使用しました。つまり、1つのフレームを転送するには、</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
120x420x4 = 57600のサンプル</font><font style="vertical-align: inherit;">が必要</font><font style="vertical-align: inherit;">です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サンプリング周波数が96 kHzの場合、1つのフレームの転送には時間がかかります：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
57600/96000 = 0.6秒</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
明らかに、検出器が次のフレームの開始を決定できるように、ある種の一時停止、特定のガードインターバルが必要です。人道的な理由から、0.1秒で十分であると仮定します。その間、すべてのエコーが消滅します（実際には消滅します）。そして、最終的には、転送速度は</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1 /（0.6 + 0.1）= 1.428フレーム/秒になります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで間違いを犯し、速度をビット/秒で計算するのは非常に簡単です。見てください、信じられないほどの伝送速度になります：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
120 * 120 * 8 / 1.428 = 80 627 bps </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、8ビットピクセルではなく16ビットピクセルがある場合はどうなりますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
120 * 120 * 16 / 1.428 = 161344 bps </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでの問題は、この送信方法をデジタルと呼ぶことはできず、ビットレートの概念が完全に有効ではないことです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナログテレビ信号のビットレートを計算してみます。</font><font style="vertical-align: inherit;">そして、検出器レシーバーのために？</font><font style="vertical-align: inherit;">:) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、たとえば、信号の一部は、10ピクセルの明るさを伝達するように見え、その値は交互に変化します。1 2 1 2 1 2 1 2 1 2 </font></font><br>
<img src="https://habrastorage.org/webt/ul/kz/st/ulkzsthqa8tt4ykb7stgu7hehqe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
では、例でこれがどのように機能するかを見てみましょう。</font><font style="vertical-align: inherit;">EncodeメソッドとDecodeメソッドは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encoder</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスに</font><font style="vertical-align: inherit;">あり、画像の変調と復調を行います。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span>[] <span class="hljs-title">Encode</span>(<span class="hljs-params">Bitmap source, <span class="hljs-keyword">double</span> carrier, <span class="hljs-keyword">int</span> pSize, <span class="hljs-keyword">int</span> interframePauseMs</span>)</span><font></font>
        {<font></font>
            Bitmap frame;<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (source.PixelFormat != System.Drawing.Imaging.PixelFormat.Format8bppIndexed)<font></font>
                frame = Grayscale.CommonAlgorithms.RMY.Apply(source);<font></font>
            <span class="hljs-keyword">else</span><font></font>
                frame = source;<font></font>
            <font></font>
            <span class="hljs-keyword">if</span> (!frame.Size.Equals(frameSize))<font></font>
                frame = resizer.Apply(frame);<font></font>
<font></font>
            <span class="hljs-keyword">int</span> cols = frameSize.Width;
            <span class="hljs-keyword">int</span> rows = frameSize.Height;<font></font>
<font></font>
            <span class="hljs-keyword">int</span> col = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">int</span> row = <span class="hljs-number">0</span>;<font></font>
<font></font>
            <span class="hljs-keyword">double</span> delta = Math.PI * <span class="hljs-number">2</span> * carrier / sampleRate;
            <span class="hljs-keyword">double</span> alpha = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">double</span> phase = <span class="hljs-number">0</span>;<font></font>
<font></font>
            <span class="hljs-keyword">double</span> pxAmplitude = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">double</span> chipLimit = Math.PI * <span class="hljs-number">2</span> * chipSize;
            <span class="hljs-keyword">double</span> pLimit = Math.PI * <span class="hljs-number">2</span>;<font></font>
<font></font>
            List&lt;<span class="hljs-keyword">double</span>&gt; samples = <span class="hljs-keyword">new</span> List&lt;<span class="hljs-keyword">double</span>&gt;();            <font></font>
<font></font>
            <span class="hljs-keyword">bool</span> isFinished = <span class="hljs-literal">false</span>;<font></font>
<font></font>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; pSize; i++)<font></font>
            {<font></font>
                alpha = Math.Sin(phase);<font></font>
                phase += delta;<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (phase &gt;= pLimit)<font></font>
                {<font></font>
                    phase -= pLimit;                    <font></font>
                }<font></font>
<font></font>
                samples.Add(alpha * <span class="hljs-keyword">short</span>.MaxValue);<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">while</span> (!isFinished)<font></font>
            {<font></font>
                alpha = Math.Sin(phase);<font></font>
                phase += delta;<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (phase &gt;= chipLimit)<font></font>
                {<font></font>
                    phase -= chipLimit;<font></font>
                    pxAmplitude = (((<span class="hljs-keyword">double</span>)frame.GetPixel(col, row).R) / <span class="hljs-number">255.0</span>) * <span class="hljs-keyword">short</span>.MaxValue;<font></font>
<font></font>
                    <span class="hljs-keyword">if</span> (++col &gt;= cols)<font></font>
                    {<font></font>
                        <span class="hljs-keyword">if</span> (++row &gt;= rows)<font></font>
                            isFinished = <span class="hljs-literal">true</span>;
                        <span class="hljs-keyword">else</span>
                            col = <span class="hljs-number">0</span>;<font></font>
                    }<font></font>
                }<font></font>
<font></font>
                samples.Add(alpha * pxAmplitude);                <font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (interframePauseMs &gt; <span class="hljs-number">0</span>)<font></font>
            {<font></font>
                samples.AddRange(<span class="hljs-keyword">new</span> <span class="hljs-keyword">double</span>[(<span class="hljs-keyword">int</span>)((((<span class="hljs-keyword">double</span>)interframePauseMs) / <span class="hljs-number">1000.0</span>) * (<span class="hljs-keyword">double</span>)sampleRate)]);<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">return</span> samples.ToArray();<font></font>
        }<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードを見ると、イメージを変調する前に、純粋なトーン（pSizeサンプル）で構成される同期プレフィックスが出力信号に追加されていることがわかります。これは、受信側でイメージ自体の前に、</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一般的には</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">悪条件で</font><s><font style="vertical-align: inherit;">発生する可能性</font></s><font style="vertical-align: inherit;">があるために必要</font><font style="vertical-align: inherit;">です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Decodeメソッドは次のとおりです。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> Bitmap <span class="hljs-title">Decode</span>(<span class="hljs-params"><span class="hljs-keyword">double</span>[] samples, <span class="hljs-keyword">double</span> carrier, <span class="hljs-keyword">int</span> pSize</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">int</span> cols = frameSize.Width;
            <span class="hljs-keyword">int</span> rows = frameSize.Height;<font></font>
<font></font>
            <span class="hljs-keyword">int</span> col = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">int</span> row = <span class="hljs-number">0</span>;<font></font>
<font></font>
            Bitmap result = <span class="hljs-keyword">new</span> Bitmap(cols, rows);<font></font>
           <font></font>
            <span class="hljs-keyword">double</span> delta = Math.PI * <span class="hljs-number">2</span> * carrier / sampleRate;
            <span class="hljs-keyword">double</span> alpha = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">double</span> phase = <span class="hljs-number">0</span>;<font></font>
                        <font></font>
            <span class="hljs-keyword">double</span> chipLimit = Math.PI * <span class="hljs-number">2</span> * chipSize;            
            <span class="hljs-keyword">double</span> chipAmplitude = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">double</span> maxAmplitude = WaveUtils.GetMaxAmplitude(samples);
            <span class="hljs-keyword">double</span> pxMax = -maxAmplitude;
            <span class="hljs-keyword">double</span> pxMin = maxAmplitude;            <font></font>
<font></font>
            <span class="hljs-keyword">double</span> smp;<font></font>
<font></font>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = pSize; (i &lt; samples.Length) &amp;&amp; (row &lt; rows); i++)<font></font>
            {<font></font>
                alpha = Math.Sin(phase);                <font></font>
                phase += delta;<font></font>
                <font></font>
                <span class="hljs-keyword">if</span> (phase &gt;= chipLimit)<font></font>
                {<font></font>
                    phase -= chipLimit;<font></font>
                    chipAmplitude = (Math.Max(Math.Abs(pxMax), Math.Abs(pxMin)) / maxAmplitude);<font></font>
                    pxMin = maxAmplitude;<font></font>
                    pxMax = -maxAmplitude;<font></font>
                    <span class="hljs-keyword">var</span> gs = Convert.ToByte(chipAmplitude * <span class="hljs-number">255</span>);<font></font>
<font></font>
                    result.SetPixel(col, row, Color.FromArgb(<span class="hljs-number">255</span>, gs, gs, gs));<font></font>
<font></font>
                    <span class="hljs-keyword">if</span> (++col &gt;= cols)<font></font>
                    {<font></font>
                        col = <span class="hljs-number">0</span>;<font></font>
                        row++;<font></font>
                    }                   <font></font>
                }<font></font>
                <span class="hljs-keyword">else</span><font></font>
                {<font></font>
                    smp = samples[i] * alpha;<font></font>
                    <span class="hljs-keyword">if</span> (smp &gt; pxMax)<font></font>
                        pxMax = smp;<font></font>
                    <span class="hljs-keyword">if</span> (smp &lt; pxMin)<font></font>
                        pxMin = smp;<font></font>
                }<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">return</span> result;<font></font>
        }<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
どちらの方法も特定の周波数に関連付けられておらず、別の検出器で使用できることがわかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
信号検索自体（検出、同期）も、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最も単純な水中音響モデム</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font><font style="vertical-align: inherit;">同じように行われます。</font><font style="vertical-align: inherit;">唯一の違い</font><font style="vertical-align: inherit;">は、変更のために</font><font style="vertical-align: inherit;">別の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FsBy4CarrierDetector</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスに配置</font><font style="vertical-align: inherit;">したことです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
複雑でない魔法はすべてbool ProcessSampleメソッドで発生します（short a）</font></font><br>
<br>
<pre><code class="cs hljs">
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">ProcessSample</span>(<span class="hljs-params"><span class="hljs-keyword">short</span> a</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">bool</span> result = <span class="hljs-literal">false</span>;<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (smpCount == <span class="hljs-number">0</span>)<font></font>
            {<font></font>
                ring1[ringHead] = a;<font></font>
                ring2[ringHead] = a;<font></font>
                s1 += a - ring1[ringTail];<font></font>
                s2 += a - ring2[ringTail];<font></font>
            }<font></font>
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (smpCount == <span class="hljs-number">1</span>)<font></font>
            {<font></font>
                ring1[ringHead] = a;<font></font>
                ring2[ringHead] = -a;<font></font>
                s1 += a - ring1[ringTail];<font></font>
                s2 += - a - ring2[ringTail];<font></font>
            }<font></font>
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (smpCount == <span class="hljs-number">2</span>)<font></font>
            {<font></font>
                ring1[ringHead] = -a;<font></font>
                ring2[ringHead] = -a;<font></font>
                s1 += -a - ring1[ringTail];<font></font>
                s2 += -a - ring2[ringTail];<font></font>
            }<font></font>
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (smpCount == <span class="hljs-number">3</span>)<font></font>
            {<font></font>
                ring1[ringHead] = -a;<font></font>
                ring2[ringHead] = a;<font></font>
                s1 += -a - ring1[ringTail];<font></font>
                s2 += a - ring2[ringTail];<font></font>
            }<font></font>
                                                        <font></font>
            ringHead = (ringHead + <span class="hljs-number">1</span>) % ringSize;<font></font>
            ringTail = (ringTail + <span class="hljs-number">1</span>) % ringSize;<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (++smpCount &gt;= <span class="hljs-number">4</span>)<font></font>
            {<font></font>
                smpCount = <span class="hljs-number">0</span>;
                <span class="hljs-keyword">if</span> (++cycle &gt;= ringSize)<font></font>
                {<font></font>
                    s = Math.Sqrt(s1 * s1 + s2 * s2) / ringSize;                  <font></font>
                    cycle = <span class="hljs-number">0</span>;                    <font></font>
                    result = (s - sPrev) &gt;= Threshold;                    <font></font>
                    sPrev = s;<font></font>
                }<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">return</span> result;<font></font>
        }</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
着信サンプルごとに呼び出され、キャリア検出の場合はtrueを返します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
検出器は完全ではなく、ラインの中央で簡単に同期できるため、特別なスライダーを追加しました。これにより、より正確な同期を実現できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、これがどのように機能するかを簡単に調べた後、最もおいしい部分に移りましょう。これらすべてから何が得られるかです。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">少し練習</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、ソナーチャネルなしですべてがどのように機能するかを確認しましょう。受信アンテナと送信アンテナを相互に接続するだけです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、画像を大きく（240x120）して、少なくとも何かを分解できるようにします。</font></font><br>
<img src="https://habrastorage.org/webt/ev/ys/1t/evys1t89oks6jpvgeyxtgafgbp4.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、すぐに、</font><font style="vertical-align: inherit;">ビデオのように</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">もっと多くの生活を送れる</font></font></s><font style="vertical-align: inherit;"></font><br>
<img src="https://habrastorage.org/webt/2j/2t/y_/2j2ty_dym0iowoiq_xgtf_oqdrg.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ようにします。しかし、私たちは結論に急がず、プールに行きます。</font></font><br>
<img src="https://habrastorage.org/webt/_8/0u/jz/_80ujzh-1afojo46fevq6egccvg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、ここで、タイトルで約束したように、私たちは自分の目で反響を見る</font></font><br>
<img src="https://habrastorage.org/webt/lb/aq/xe/lbaqxezsgyzwjik0zxymshqjysi.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
でしょ</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">う</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：これは</font><font style="vertical-align: inherit;">どう</font><s><font style="vertical-align: inherit;">ですか、エロンマスク？</font></s><font style="vertical-align: inherit;"> HDは好きですか？これはなぜですか？</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、すべてが非常にシンプルです。本質的に、エコーは元の信号の遅延コピーであり、有名なことに、受信ポイントで干渉し、異なる位相で折りたたまれ、そのような画像を提供します。画像を転送するので、最終的には、多くの画像が異なる振幅で重ね合わされます。このすべてが最終的にぼやけと再生につながります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
振り返って、モデルの大きな画像ですべてをチェックしましょう。私はランダムな写真を撮りました：私</font></font><br>
<img src="https://habrastorage.org/webt/oo/hd/jb/oohdjbgoj4pqq-k8f9st0b9rdre.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
はそれ</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">変調し、エコーと少しのノイズを追加し、それをデコードしました、そしてはい-結果はプールで得られたものに似ています：</font></font><br>
<img src="https://habrastorage.org/webt/bk/dp/y_/bkdpy_9ztpti3b91ulbakqzokes.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
原則として、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デコンボリューション</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">実行</font><font style="vertical-align: inherit;">し、反射を差し引く</font><font style="vertical-align: inherit;">ことができます</font><font style="vertical-align: inherit;">が</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、それは私たちの地域</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、このアイテムを独立した作業に残します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ちなみに、</font><font style="vertical-align: inherit;">プール内</font><font style="vertical-align: inherit;">の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以前の方法</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は少し良く機能しますが、悪いことにもなります-ブロードバンド信号では、マルチパスと残響が周波数選択性フェージングを引き起こし、画像では（スペクトル上で読み取って）黒と白のストライプのように見えます-信号は逆位相です。フェーズで</font></font><br>
<img src="https://habrastorage.org/webt/zo/f-/pp/zof-ppqayi-rbz2h9yfgjlvc8da.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
具体化さ</font><font style="vertical-align: inherit;">れた場所（実際には、まだ中間オプションがたくさんあります）：</font><font style="vertical-align: inherit;">4月、私たちは瞬間をつかみ、モックアップで池に行き、そこに</font></font><br>
<img src="https://habrastorage.org/webt/mv/c-/v4/mvc-v4-m9tys6na8hip-8t8kzyc.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/pp/wc/8u/ppwc8uemc0xlmsmt_rz5h24s664.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
も</font><font style="vertical-align: inherit;">行きました：</font><font style="vertical-align: inherit;">結果はプールで得られた結果と大差ありません：</font></font><br>
<img src="https://habrastorage.org/webt/1-/8j/et/1-8jetei8ly02aanoubjimfhlty.png"><br>
<br>
<img src="https://habrastorage.org/webt/_o/1q/ij/_o1qijulzi1p0pqxmch5dijhrcc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そしてすぐに比較のために以前の方法：</font></font><br>
<img src="https://habrastorage.org/webt/dh/8o/nk/dh8onkjtu5jly6kr7ios0k3td44.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、保存されたフレームから収集されたgifアニメーションを示します。方法1 </font></font><br>
<img src="https://habrastorage.org/webt/b7/bq/nz/b7bqnzrvtoa1jkbc0cj4h0okv-u.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
と、この記事で説明する方法2です。</font></font><br>
<img src="https://habrastorage.org/webt/of/vg/gb/ofvggbrbktqq30iy0ihoybpx6le.gif"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最終的に</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
約束どおり、エコーとリバーブが文字通りどのように表示されるかを示し、時間を有効に使って、手で何かをしました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、この形式では、この方法は実際には適用できませんが、初心者には非常に役立ちます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般に、条件が非常に悪い浅い池をチェックインしました。他の貯水池で私たちの実験を繰り返して、その結果を確かに教えてくれるなら、涼しいでしょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
読者が（マイクとスピーカーを備えた空中でも）試してみたい場合は、リリースへのリンクを次に示します。</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド1 </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド2（この記事から）</font></font></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS</font></font></h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 私たちは読者からのフィードバックを心待ちにしています。あなたが無駄に何かをしていることを理解することは非常に重要です。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS / 2</font></font></h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 私はすぐによくある質問に答えます。そのような子供たちの能力での魚や他の海洋生物にとって、これはすべて気づかれないだけです。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja453664/index.html">Spring Boot-OAuth2とJWT</a></li>
<li><a href="../ja453666/index.html">無人タクシーに乗る方法</a></li>
<li><a href="../ja453668/index.html">若いROの10個のエラー（パートI-3個のエラー）</a></li>
<li><a href="../ja453672/index.html">CardInfo-ロゴ、銀行の色などをカード番号で決定するためのAPI</a></li>
<li><a href="../ja453676/index.html">LinuxのようにSSH経由でWindowsに接続する</a></li>
<li><a href="../ja453682/index.html">ReddにインストールされたFPGA用の最も単純な「ファームウェア」の開発。パート2.プログラムコード</a></li>
<li><a href="../ja453686/index.html">セキュリティウィーク22：脅威の統計、バンキング型トロイの木馬、一般的なエクスプロイト</a></li>
<li><a href="../ja453688/index.html">Javaは流血型の企業であるだけでなく、遅延に敏感な高速アプリケーションでもあります</a></li>
<li><a href="../ja453692/index.html">初心者向け3Dゲームシェーダー：効果</a></li>
<li><a href="../ja453696/index.html">双方向角度バインディング、もう少し理解</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>