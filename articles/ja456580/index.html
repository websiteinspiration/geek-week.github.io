<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✴️ 🙍🏼 👩‍❤️‍💋‍👩 DBMSの自律的な未来 👨🏼‍🔬 👨‍🏫 🎚️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="誰がPostgreSQLをより適切に構成すると思いますか-DBAまたはMLアルゴリズム？そして2番目の場合は、車に置き換えられたときに何をすべきかを考える時が来ました。または、これは実現されず、重要な決定は依然として人間によって行われるべきです。おそらく、トランザクションの安定性のための分離のレベル...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>DBMSの自律的な未来</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/456580/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">誰がPostgreSQLをより適切に構成すると思いますか-DBAまたはMLアルゴリズム？そして2番目の場合は、車に置き換えられたときに何をすべきかを考える時が来ました。または、これは実現されず、重要な決定は依然として人間によって行われるべきです。おそらく、トランザクションの安定性のための分離のレベルと要件は、管理者に任せる必要があります。しかし、すぐにインデックスを信頼して、自分でマシンを決定することができます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/k-/46/k3/k-46k3vgk1dm-quvhgnjdldvbay.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Andy Pavloが</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HighLoad ++</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で、未来のDBMSについて話しました。これは、今すぐ「触れる」ことができます。あなたがこのスピーチを逃したか、ロシア語で情報を受け取りたい場合-カットの下はスピーチの翻訳です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、自律型DBMSの作成に特化したカーネギーメロン大学のプロジェクトになります。 「自律型」という用語は、人間の介入なしに自動的に展開、構成、構成できるシステムを意味します。このようなものを開発するのに約10年かかるかもしれませんが、それがアンディと彼の生徒たちがしていることです。もちろん、自律型DBMSを作成するには機械学習アルゴリズムが必要ですが、この記事では、このトピックのエンジニアリング側のみに焦点を当てます。ソフトウェアを設計してスタンドアロンにする方法を検討してください。</font></font><br>
<a name="habracut"></a><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/QEAMBtUWqPM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">講演者について：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カーネギーメロン大学の准教授であるAndy Pavloは、リーダーシップの下で&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「自己管理型」のDBMS PelotonDBと</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、&nbsp; </font><font style="vertical-align: inherit;">機械学習を使用してPostgreSQLとMySQLの構成を調整するのに役立つ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ottertune</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を作成します。アンディと彼のチームは現在、自己管理データベースの真のリーダーです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自律型DBMSを作成する理由は明白です。</font><font style="vertical-align: inherit;">これらのDBMSツールの管理は、非常に費用と時間がかかるプロセスです。</font><font style="vertical-align: inherit;">米国の平均DBA給与は年間約89千ドルです。</font><font style="vertical-align: inherit;">ルーブルに換算すると、年間590万ルーブルが取得されます。</font><font style="vertical-align: inherit;">これは、ソフトウェアに目を離さないように人々に支払う、本当に高額な金額です。</font><font style="vertical-align: inherit;">データベースの使用にかかる総費用の約50％は、そのような管理者と関連スタッフの作業によって支払われます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HighLoad ++や数万のデータベースを使用するような非常に大きなプロジェクトの場合、その構造の複雑さは人間の認識を超えています。</font><font style="vertical-align: inherit;">すべては表面的にこの問題に取り組み、システムのチューニングに最小限の労力を費やすことで最大のパフォーマンスを達成しようとします。</font></font><br>
<br>
<blockquote>   ,        ,    .</blockquote><br>
<h2> , 1970–1990</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自律型DBMSのアイデアは新しいものではありません。その歴史は、リレーショナルデータベースが最初に作成され始めた1970年代にさかのぼります。その後、それらは自己適応データベース（Self-Adaptive Databases）と呼ばれ、彼らの助けを借りて、今日もなお苦労しているデータベース設計の古典的な問題を解決しようとしました。これは、インデックスの選択、データベーススキーマのパーティションと構築、およびデータの配置です。当時、データベース管理者がDBMSを展開するのに役立つツールが開発されていました。実際、これらのツールは、現在の対応ツールと同じように機能しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
管理者は、アプリケーションによって実行されたリクエストを追跡します。次に、このクエリスタックをチューニングアルゴリズムに渡し、アプリケーションがデータベースを使用する方法の内部モデルを構築します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インデックスの自動選択に役立つツールを作成する場合は、各列にアクセスする頻度を示すグラフを作成します。次に、この情報を検索アルゴリズムに渡します。検索アルゴリズムは、さまざまな場所を調べ、データベースでインデックスを作成できる列を特定しようとします。アルゴリズムは内部コストモデルを使用して、この特定のモデルが他のインデックスと比較してパフォーマンスが向上することを示します。次に、アルゴリズムは、インデックスにどのような変更を加える必要があるかを提案します。この時点で、参加し、この提案を検討し、それが正しいかどうかを判断するだけでなく、その実装に適した時間を選択します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gp/bz/wt/gpbzwtyv3yingx-qfyov_qao7i0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DBAは、ユーザーアクティビティが低下した場合のアプリケーションの使用方法を知っている必要があります。</font><font style="vertical-align: inherit;">たとえば、日曜日の午前3時にデータベースクエリの最低レベルなので、この時点でインデックスを再ロードできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私が言ったように、当時のすべての設計ツールは同じように機能しました- </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font><strong><font style="vertical-align: inherit;">非常に古い問題</font></strong><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">私の科学監督者の科学監督者が1976年に自動指標選択についての記事を書きました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自己調整データベース、1990〜2000</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1990年代、人々は実際に同じ問題に取り組みましたが、名前だけが適応型データベースから自己調整データベースに変更されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アルゴリズムは少し良くなり、ツールは少し良くなりましたが、高レベルでは以前と同じように機能しました。自動調整システム運動の最前線に立った唯一の企業は、自動管理プロジェクトを持つMicrosoft Researchでした。彼らは本当に素晴らしいソリューションを開発し、90年代後半から00年代前半に、データベースのセットアップに関する一連の推奨事項を再度提示しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Microsoftが提唱した主要なアイデアは、これまでとは異なりました。カスタマイズツールが独自のモデルをサポートする代わりに、実際にはクエリオプティマイザーコストモデルを再利用して、あるインデックスの別のインデックスに対する利点を判断しました。それについて考えれば、それは理にかなっています。単一のインデックスが実際にクエリを高速化できるかどうかを知る必要がある場合、オプティマイザがそれを選択しなければ、それがどれほど大きいかは問題ではありません。したがって、オプティマイザは、実際に何かを選択するかどうかを確認するために使用されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wx/tm/ae/wxtmae-qjlpvjydyrqmqhku0ac8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2007年、Microsoft Researchは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 10年にわたる研究の回顧を記し</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">た記事</font></a><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">発表しまし</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">た</font></a><font style="vertical-align: inherit;">。また、パスの各セグメントで発生したすべての複雑なタスクもカバーしています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
セルフチューニングデータベースの時代に注目されている別のタスクは、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レギュレーターを自動的に構成する方法です。</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データベースコントローラーは、実行時のデータベースシステムの動作を変更するある種の構成パラメーターです。</font><font style="vertical-align: inherit;">たとえば、ほとんどすべてのデータベースに存在するパラメーターは、バッファーのサイズです。</font><font style="vertical-align: inherit;">または、たとえば、ブロックポリシー、ディスククリーンアップの頻度などの設定を管理できます。</font><font style="vertical-align: inherit;">近年のDBMSレギュレーターの複雑さの大幅な増加により、このトピックは関連性が高まっています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何が悪いかを示すために、学生がPostgreSQLとMySQLの多くのリリースを研究した後に行ったレビューを行います。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">過去15年間で、PostgreSQLのレギュレーターの数は5倍になり、MySQLの場合は7倍になりました。</font></font></blockquote><br>
<img src="https://habrastorage.org/webt/mq/u7/y1/mqu7y1e6ntezta8e-jxj-wvf5t0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、すべての規制当局が実際にタスク実行プロセスを制御しているわけではありません。</font><font style="vertical-align: inherit;">たとえば、一部にはファイルパスまたはネットワークアドレスが含まれているため、個人のみがそれらを構成できます。</font><font style="vertical-align: inherit;">ただし、そのうちの数十は実際にパフォーマンスに影響を与える可能性があります。</font><font style="vertical-align: inherit;">誰も彼の頭をそんなに持つことはできません。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloud DB、2010年…</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、私たちは2010年代の時代に身を置いています。私はそれをクラウドデータベースの時代と呼んでいます。この間、クラウドへの多数のデータベースの展開を自動化するために多くの作業が行われました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
主要なクラウドプロバイダーが心配する主なことは、テナントをホストする方法や、テナント間で移行する方法です。各テナントに必要なリソースの量を決定し、生産性を最大化するため、またはSLAを最小限のコストで一致させるために、それらをマシン間で分散する方法。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Amazon、Microsoft、Googleはこの問題を解決しますが、主に運用レベルです。</font><font style="vertical-align: inherit;">最近になって、クラウドサービスプロバイダーは、個々のデータベースシステムを構成する必要性について考え始めました。</font><font style="vertical-align: inherit;">この作品は一般ユーザーには見えませんが、会社のハイレベルを左右します。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自律システムと非自律システムを使用したデータベースの40年にわたる研究を要約すると、この作業はまだ十分ではないと結論付けることができます。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
なぜ今日、自治の真に自律的なシステムを持つことができないのですか？これには3つの理由があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sm/d0/eg/smd0ega2yn_5o-ywbdz3zod1yf0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、これらのツールはすべて、クラウドサービスプロバイダーからのワークロードの分散を除いて、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本質的に助言</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のみ</font><font style="vertical-align: inherit;">です。つまり、計算されたオプションに基づいて、人はそのような提案が正しいかどうかに関して最終的な主観的な決定を行わなければなりません。さらに、サービスの開発中に行われた決定が正しいままであるかどうかを判断するために、システムの動作をしばらく観察する必要があります。そして、その知識を将来的にあなた自身の内部意思決定モデルに適用します。これは1つのデータベースに対して実行できますが、数万に対しては実行できません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の問題は、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">どんな行動も何かへの反応にすぎないということです</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。私たちが調査したすべての例で、作業は過去のワークロードのデータを使用しています。問題があり、それに関する記録が機器に転送され、彼は「はい、この問題を解決する方法を知っています」と言います。しかし、解決策はすでに発生した問題にのみ関係します。このツールは将来のイベントを予測しないため、準備アクションは提供されません。人はこれを行うことができ、手動で行いますが、ツールはできません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後の理由は、どのソリューションに</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">も知識の伝達がないことです。</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これが私が意味することです：たとえば、最初のデータベースインスタンスの1つのアプリケーションで機能したツールを、別のデータベースインスタンスの別の同じアプリケーションに配置した場合、最初のデータベースを操作したときに得られた知識に基づいて、それを行うことができますデータは、2番目のデータベースのセットアップに役立ちます。実際、すべてのツールはゼロから機能し始め、何が起こっているかに関するすべてのデータを再取得する必要があります。人間はまったく異なる方法で働きます。特定の方法で1つのアプリケーションを構成する方法を知っている場合、別のアプリケーションで同じパターンを確認でき、おそらくそれをはるかに速く構成できます。しかし、これらのアルゴリズムの1つではなく、これらのツールの1つもまだこのように機能しません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
なぜ変化の時だと確信しているのですか？この質問への答えは、データの超配列や機械学習が一般的になった理由の問題とほぼ同じです。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">設備は改善されています</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。生産リソースが増加し、ストレージ容量が増加し、ハードウェア容量が増加しているため、機械学習モデルの学習の計算が高速化しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
高度なソフトウェアツールが利用可能になりました。以前は、いくつかの機械学習アルゴリズムを作成するには、MATLABまたは低レベルの線形代数の専門家である必要がありました。これで、MLを使用可能にするTorchとTenso Flowが用意されました。もちろん、データをよりよく理解することも学びました。人々は、将来の意思決定に必要となる可能性のあるデータを正確に把握しているため、以前ほど多くのデータを破棄することはありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの研究の目標は、自律的なDBMSでこの輪を閉じることです。以前のツールと同様に、ソリューションを提案できますが、人に頼るのではなく、ソリューションを正確に展開する必要があるときにソリューションが適切であるかどうかにかかわらず、アルゴリズムがこれを自動的に行います。そして、フィードバックの助けを借りて、彼は時間をかけて勉強し、良くなるでしょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カーネギーメロン大学で現在取り組んでいるプロジェクトについてお話ししたいと思います。</font><font style="vertical-align: inherit;">それらの中で、私たちは2つの異なる方法で問題に取り組みます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初の-OtterTune-では、データベースを調整してブラックボックスとして扱う方法を探します。</font><font style="vertical-align: inherit;">つまり</font><font style="vertical-align: inherit;">、システムの内部を制御せず、応答のみを監視することなく、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">既存のDBMS</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><strong><font style="vertical-align: inherit;">調整する</font></strong><font style="vertical-align: inherit;">方法</font><font style="vertical-align: inherit;">です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pelotonプロジェクトは</font><font style="vertical-align: inherit;">、システムが自律的に動作する必要があるという事実を</font><font style="vertical-align: inherit;">踏まえて</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、新しいデータベースをゼロ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から、またはゼロ</font><strong><font style="vertical-align: inherit;">から作成することを</font></strong><font style="vertical-align: inherit;">目的としてい</font><strong><font style="vertical-align: inherit;">ます</font></strong><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">どの調整と最適化アルゴリズムを設定する必要があるか-既存のシステムには適用できません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
両方のプロジェクトを順番に検討してみましょう。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カワウソ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちが開発した既存のシステム調整プロジェクトはOtterTuneと呼ばれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データベースがサービスとして構成されていると想像してください。すべてのリソースを消費する重いデータベース操作のランタイムメトリックをダウンロードし、レギュレーターの推奨構成がそれに応じることで、生産性が向上すると考えています。これは、遅延時間、帯域幅、または指定したその他の特性である可能性があります。最適なオプションを見つけようとします。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zq/wi/eb/zqwiebmj38ma58e37dycznrjamq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OtterTuneプロジェクトの主な新</font><strong><font style="vertical-align: inherit;">機能</font></strong><font style="vertical-align: inherit;">は、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以前のセッションのデータを使用できることです。</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">設定し、次のセッションの効率を向上させます。たとえば、これまでに見たことのないアプリケーションを含むPostgreSQL構成を考えてみます。しかし、特定の特性がある場合や、アプリケーションですでに見たデータベースと同じ方法でデータベースを使用する場合は、このアプリケーションをより効率的に構成する方法をすでに知っています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
より高いレベルでは、作業のアルゴリズムは次のとおりです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ターゲットデータベースがあるとしましょう：PostgreSQL、MySQL、VectorWise。 2つのタスクを実行する同じドメインにコントローラーをインストールする必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fv/bu/e_/fvbue_hzhuwaq4zxkzyalcoxhke.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1つ目は、いわゆるコレクター（現在の構成に関するデータを収集するツール）によって実行されます。アプリケーションからデータベースへのクエリ実行時間メトリック。コレクターによって収集されたデータは、チューニングサービスであるTuning Managerに読み込まれます。データベースがローカルで機能するかクラウドで機能するかは問題ではありません。ダウンロード後、データは独自の内部リポジトリに保存されます。内部リポジトリには、これまでに行われたすべてのテストセットアップセッションが保存されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
推奨事項を提示する前に、2つのステップを実行する必要があります。まず、ランタイムメトリックを見て、どれが実際に重要かを見つける必要があります。以下の例では、MySQLがコマンドに返すメトリック</font></font><code>SHOW_GLOBAL_STATUS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InnoDB。それらすべてが私たちの分析に役立つわけではありません。機械学習では、大量のデータが必ずしも良いとは限らないことが知られています。なぜなら、穀物を籾殻から分離するためには、さらに多くのデータが必要だからです。この場合のように、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本当に重要ではないエンティティを取り除くことが重要</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qq/th/js/qqthjszvgbp7pp8m1q3d0ze2qge.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、</font></font><code>INNODB_BUFFER_POOL_BYTES_DATA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">との</font><font style="vertical-align: inherit;">2つのメトリックが</font><font style="vertical-align: inherit;">あり</font></font><code>INNODB_BUFFER_POOL_PAGES_DATA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。実際、これは同じメトリックですが、単位が異なります。統計分析を実行して、メトリックが高度に相関していることを確認し、両方を使用することは分析には冗長であると結論付けることができます。それらの1つが破棄されると、学習タスクの次元が減少し、回答を受け取るための時間が短縮されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第二段階では、規制当局に関してのみ同じことを行います。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font></font></strong><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQLの500のコントローラ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、そしてもちろん、それらのすべてが実際に重要であるわけではありませんが、アプリケーションごとに異なるものが重要です。どの規制当局が対象機能に実際に影響を及ぼしているかを見つけるために、別の統計分析を行う必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/g7/wz/h9/g7wzh9wquhh68lwkovxrnxdt8b0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例では</font></font><code>INNODB_BUFFER_POOL_SIZE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">3つのレギュレーター</font><font style="vertical-align: inherit;">が</font></font><code>FLUSH_METHOD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あり、</font></font><code>LOG_FILE_SIZE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パフォーマンスに最も大きな影響を与える</font><font style="vertical-align: inherit;">ことがわかりました</font><font style="vertical-align: inherit;">。トランザクションワークロードの遅延時間を短縮します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
規制当局に関連する他の興味深い点があります。スクリーンショットには、という名前のノブがあります</font></font><code>TIMED_MUTEXES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 MySQLの作業ドキュメントを参照すると、セクション45.7で、このレギュレーターが古くなっていることが示されます。しかし</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、機械学習アルゴリズムはドキュメントを読み取ることができません</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">したがってそれについて知りません。彼はオンまたはオフにできるレギュレーターがあることを知っており、これが何にも影響しないことを理解するには長い時間がかかります。しかし、事前に計算を行い、レギュレーターが何もせず、セットアップに時間を浪費しないことを確認できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
分析後、データは</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ガウスプロセスモデル</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（かなり古い方法）</font><font style="vertical-align: inherit;">を使用して構成アルゴリズムに転送されます</font><font style="vertical-align: inherit;">。おそらくディープラーニングについて聞いたことがあるでしょう。私たちは同様のことをしていますが、ディープネットワークはありません。</font><strong><font style="vertical-align: inherit;">GPflow</font></strong><font style="vertical-align: inherit;">を使用し</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-TensorFlowに基づいてロシアで開発されたガウス過程のモデルを操作するためのパッケージ。アルゴリズムは、目的関数を改善するべき推奨を与えます。このデータは、コントローラー内で動作しているインストールエージェントに転送されます。エージェントはリセットを実行して変更を適用します（残念ながら、データベースを再起動する必要があります）。その後、プロセスが再度繰り返されます。さらにいくつかのランタイムメトリックが収集され、アルゴリズムに転送され、生産性の向上および増加の可能性の分析が実行され、推奨が発行されるなど、何度も繰り返されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nz/qb/xc/nzqbxcp2ja9jbdwnaeoggdya0fw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OtterTuneの重要な機能は、アルゴリズムがランタイムメトリックに関する情報のみを入力として必要とすることです。データやユーザーのリクエストを確認する必要はありません。読み取り操作と書き込み操作を追跡するだけです。これは強力な議論です-あなたまたはあなたの顧客に属するデータは第三者に開示されません。アルゴリズムを実行する必要はありません。アルゴリズムは実行時メトリックのみに基づいて機能します。これは、物理設計ではなく、レギュレーターに対する推奨事項を提供するためです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OtterTuneデモを見てみましょう。プロジェクトのウェブサイトで、Postgres 9.6を実行し、TPC-Cテストを使用してシステムをロードします。 UbuntuにインストールしたときにデプロイされるPostgreSQLの初期設定から始めましょう。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/0e/7s/5o/0e7s5ohwzj1g_lfw-lxmi6_ibjm.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、TPC-Cテストを5分間実行し、必要なランタイムメトリックを収集してOtterTuneサービスにアップロードし、推奨事項を取得して変更を適用し、プロセスを繰り返します。後でこれに戻ります。データベースシステムは1台のコンピューターで実行され、Tensor Flowサービスは別のコンピューターで実行され、ここにデータを読み込みます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/6h/9d/yx/6h9dyxfovr6efc8m-a-znaguzgo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5分後、ページを更新します（結果のこの部分のデモンストレーションは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その時点で</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">始まります</font><font style="vertical-align: inherit;">）。最初に開始したとき、PostgreSQLのデフォルト構成では、毎秒623のトランザクションがありました。次に、推奨事項を受け取って変更を1回適用すると、トランザクション数が</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1秒あたり2300に増加しました</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。このデモンストレーションはすでに数回開始されているため、システムには以前に収集されたデータのセットがすでにあることを認識する価値があります。そのため、ソリューションは非常に高速です。以前に収集されたデータがシステムになかった場合はどうなりますか？このアルゴリズムは、段階的な関数の一種であり、徐々にこのレベルに到達します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/4q/ke/g3/4qkeg3wsp7yfxom1mojcv2mafhq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しばらくして5回の反復の後、最良の結果は2600でした。1秒あたり600トランザクションからずっと進んで、2600の値に到達することができました。アルゴリズムがレギュレーターを調整する別の方法を試すことを決定したため、わずかな低下が現れました。結果はマージンだったので、パフォーマンスの大幅な低下は起こりませんでした。否定的な結果を受け取ったため、アルゴリズムは再構成され、他の調整方法を探し始めました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アルゴリズムはソリューションスペースを探索し、SLA契約の条件を達成するためにさまざまな構成を試行するため、悪い戦略を実行に移すことを恐れるべきではないと結論付けます。ただし、アルゴリズムが改善するソリューションのみを選択するように、いつでもサービスを構成できます。そして、時間の経過とともに、すべての最良の結果が得られます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さて、話の話題に戻りましょう。</font><font style="vertical-align: inherit;">Sigmodに掲載され</font><font style="vertical-align: inherit;">た</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">からすでに利用可能な結果について</font><font style="vertical-align: inherit;">お知らせします。スループットを向上させるために、OtterTuneを使用してTPC-C用にMySQLとPostgreSQLを構成しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ubuntuへの最初のインストール時にデフォルトでデプロイされるこれらのDBMSの構成を比較します。次に、PerconaおよびPostgreSQLを使用する他のコンサルティング会社から入手できるいくつかのオープンソース構成スクリプトを実行します。これらのスクリプトは、ハードウェアに特定のバッファーサイズを設定する必要があるというルールなどのヒューリスティックな手順を使用します。また、Amazon RDSからの構成もあります。これには、作業中の機器用のAmazonプリセットがすでにあります。次に、これを、高価なDBAを手動で設定した結果と比較します。ただし、20分という条件と、必要なパラメーターを設定する機能があります。そして最後のステップはOtterTuneを起動することです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vb/oi/gg/vboigg_vly5yx81jkjs4zjslsqa.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQLの場合、デフォルトの構成がはるかに遅れており、スクリプトの動作が少し良く、RDSの方が少し良いことがわかります。この場合、最良の結果はデー​​タベース管理者、つまりFacebookの主要なMySQL管理者によって示されました。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OtterTuneは人に負けました</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。しかし実際には、ログのクリーニングの同期を無効にする特定のレギュレーターがあり、これはFacebookにとって重要ではありません。ただし、アルゴリズムは、最後の5ミリ秒のデータを失うことに同意するかどうかをアルゴリズムが認識していないため、このOtterTuneレギュレーターへのアクセスを拒否しました。私たちの意見では、この決定は人が行うべきです。おそらくFacebookはそのような損失に同意します、私たちはこれを知りません。このレギュレーターを同じように調整すると、人間と競争できます。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この例は、最終的な決定は人が行わなければならないという点で、保守的になる方法を示しています。</font><font style="vertical-align: inherit;">MLアルゴリズムが認識していないデータベースの特定の側面があるためです。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PostgreSQLの場合、構成スクリプトは適切に機能します。</font><font style="vertical-align: inherit;">RDSは少し悪いです。</font><font style="vertical-align: inherit;">しかし、これのOtterTune指標が人を上回ったことは注目に値します。</font><font style="vertical-align: inherit;">ヒストグラムは、ウィスコンシンのシニアPostgreSQLエキスパートアドバイザーによってデータベースが設定された後に得られた結果を示しています。</font><font style="vertical-align: inherit;">この例では、OtterTuneはログファイルのサイズとバッファプールのサイズの最適なバランスを見つけ、これら2つのコンポーネントが使用するメモリの量のバランスを取り、最高のパフォーマンスを保証しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
主な結論は、OtterTuneサービスは、非常に高価なDBAと同じかそれ以上のパフォーマンスを達成できるようなアルゴリズムと機械学習を使用しているということです。</font><font style="vertical-align: inherit;">これは、データベースの1つのインスタンスだけに適用されるのではなく、単なるソフトウェアであり、単なるデータであるため、作業を数万のコピーに拡張できます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ペロトン</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私がお話ししたい2つ目のプロジェクトはペロトンと呼ばれています。これは、カーネギーメロンでゼロから構築するまったく新しいデータシステムです。これを自己管理DBMSと呼びます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この考え方は、ソフトウェアスタック全体を制御する場合に、どのような変更を加えることができるかを見つけることです。システムの各フラグメントに関する知識があるため、プログラムサイクル全体に関するOtterTuneよりも優れた設定を行う方法。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/av/8g/13/av8g13hhckp7k2adftmzn7tlv5a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
仕組み：</font><strong><font style="vertical-align: inherit;">強化</font></strong><font style="vertical-align: inherit;">さ</font><strong><font style="vertical-align: inherit;">れた機械学習コンポーネント</font></strong><font style="vertical-align: inherit;">を統合しまし</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">た</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データベースシステムに入力すると、実行時にその動作のすべての側面を観察し、推奨事項を提示できます。そして、OtterTuneサービスで発生するように、レギュレーターの調整に関する推奨に限定されず、インデックスの選択、パーティションスキームの選択、垂直方向および水平方向のスケーリングなど、前述の標準アクションセット全体を実行したいと思います。</font><em><font style="vertical-align: inherit;">Peloton </font></em></font><br>
<br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">システムの名前は</font></font></em><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変更される可能性があります。ロシアではどうだかわかりませんが、アメリカでは「</font></font></em><font style="vertical-align: inherit;"><em><font style="vertical-align: inherit;">ペロトン」という</font></em><em><font style="vertical-align: inherit;">言葉</font></em></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は「大胆不敵」と「フィニッシュ」を意味し、フランス語では「小隊」を意味します。しかしアメリカにはサイクリング会社があります</font></font></em><em>Peloton,     .  ,     ,    ,     ,     : «,    ,   ».     ,     ,        .   </em><em>Uber       «</em><em>Peloton»,         .       ,            .</em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このシステムが高レベルでどのように機能するかを検討してください。</font><font style="vertical-align: inherit;">たとえば、ターゲットデータベースを取り上げます。繰り返しますが、これは私たちのソフトウェアです。</font><font style="vertical-align: inherit;">以前に示したのと同じワークロード履歴を収集します。</font><font style="vertical-align: inherit;">違いは、将来のワークロードサイクル、将来のワークロード要件を予測できる予測モデルを生成することです。</font><font style="vertical-align: inherit;">そのため、このシステムを自己管理DBMSと呼んでいます。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自己管理型DBMSの基本的な考え方は、自動制御を備えた自動車の考え方に似ています。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
無人車両は、自分の前を見て、道路の前にあるものを見ることができ、目的地への行き方を予測できます。スタンドアロンデータベースシステムも同じように機能します。将来を見据えて、1週間または1時間でワークロードがどのようになるかを判断できるはずです。次に、この予測されたデータを計画コンポーネントに渡します。これを脳と呼び、Tensor Flowで実行します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このプロセスは、Google Deep Mindプロジェクトの一部としてロンドンからのAlphaGoの作業を反映しています。最上位レベルでは、すべて同様のシナリオで機能します。モンテカルロがツリーを検索します。検索の結果は、目的を達成するために実行する必要があるさまざまなアクションです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作業スキームは、おおよそ次のアルゴリズムによって決定されます。</font></font><br>
<br>
<ul>
<li>     , ,  ,  ,    ,   .</li>
<li>   ,         .</li>
<li>  ,  ,   .</li>
<li>    ,      .</li>
</ul><br>
<img src="https://habrastorage.org/webt/lt/5u/te/lt5uteozlshw-wvgoc8eh2qaj5s.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
無人の車という比喩に常に頼るのではなく、それが彼らのしくみです。これは計画期間と呼ばれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
道路上の地平線を見た後、想像上のポイントに到達するように設定し、次に、地平線上のこのポイントに到達するための一連のアクションの計画を開始します：加速、減速、左折、右折など。次に、実行する必要がある最初のアクション以外のすべてのアクションを精神的に破棄し、実行してから、プロセスを繰り返します。 UAVはこのようなアルゴリズムを毎秒30回実行します。データベースの場合、このプロセスは少し遅くなりますが、考え方は変わりません。</font><strong><font style="vertical-align: inherit;">PostgreSQLの</font></strong><strong><font style="vertical-align: inherit;">上に何かを構築するのではなく</font></strong></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
、独自のデータベースシステム</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を最初から</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作成することにしました。</font></font><strong><font style="vertical-align: inherit;"></font></strong><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQLは</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、正直に言うと、私たちがやりたいことに比べて遅すぎるためです。 PostgreSQLは美しく、大好きで大学のコースで使用していますが、すべてのデータはディスクから取得されるため、インデックスの作成には時間がかかりすぎます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自動車と同様に、PostgreSQL上の自律型DBMSは無人のワゴンと比較できます。トラックは、道路の前にいる犬を認識してそれを迂回できますが、車の前の道路に走り出した場合は認識できません。トラックは十分に操縦できないため、衝突は避けられません。できるだけ早く変更を適用し、正しい構成を見つけることができるように、システムを最初から作成することにしました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今、私たちは最初の問題を解決し</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">、記事</font></a><font style="vertical-align: inherit;">を公​​開しまし</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">た</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ワークロードの自動選択と予測のための深層学習と古典的な線形回帰の組み合わせについて。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、より大きな問題があり、まだ適切なソリューション</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アクションカタログ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">がありません</font><font style="vertical-align: inherit;">。問題はアクションをどのように選択するかではありません。Microsoftの担当者がすでにそれを行っているからです。問題は、展開前と展開後に何が起こるかという点で、あるアクションが別のアクションよりも優れているかどうかを判断する方法です。人のコマンドによって作成されたインデックスが最適でない場合にアクションを元に戻す方法、このアクションをキャンセルしてキャンセルの理由を示すにはどうすればよいですか。さらに、私たちのシステムと外部の世界との相互作用に関しては、他にも多くのタスクがありますが、まだ解決策はありませんが、それらに取り組んでいます。</font></font><br>
<br>
<em> ,   ,    ,   .        ,     .      ,     .     ,   .   ,      ,    ,  ,   .       : «        ?»,  ,       .  — ,      .          .</em><br>
<br>
<h2>  </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自律型データベースシステムを作成するための2つの異なるアプローチを前提として、自律型になるようにDBMSを設計する方法について説明しましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3つのトピックについて詳しく説明します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レギュレーターの調整方法</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内部指標を収集する方法</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アクションの設計方法。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
繰り返しになりますが、重要なポイントに戻ります。データベースシステムは、機械学習アルゴリズムに正しい情報を提供して、その後のより良い決定を採用する必要があります。</font><font style="vertical-align: inherit;">応答の受信速度を上げるには、送信する無駄なデータの量を減らす必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私はすでに、自律コンポーネントで評価を行うことを人に要求する規制当局は、禁止としてマークされるべきであると述べました。</font></font><code>PG_SETTINGS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アルゴリズムがこのコントローラーにアクセスしないようにするに</font><font style="vertical-align: inherit;">は、設定</font><font style="vertical-align: inherit;">またはその他の構成ファイルで</font><font style="vertical-align: inherit;">このパラメーターをマークする必要があります</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルパス、分離レベル、トランザクションの安定性要件などのパラメーターに関連して。</font><font style="vertical-align: inherit;">決定は、アルゴリズムではなく、人が行う必要があります。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アルゴリズムは、ログで同期を無効にすると、速度が大幅に向上し、そのような変更が適用されることを検出する場合がありますが、これはプロジェクトの正しい決定ではない場合があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自動的に設定される必要のあるレギュレーターについては、アルゴリズムがそのようなレギュレーターを変更する方法に関する追加のメタデータが必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これには、次のようなパラメータが含まれます。</font></font><br>
<br>
<ul>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">値の範囲</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">数値変数、または列挙型の変数の値のセットに関しては、最小から最大まで。</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オプションを有効または無効にするブールフラグ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">オプションの有効化と無効化を担当するノブがある場合は、値-1または0を使用しないでください。個別のブールフラグを作成することをお勧めします。</font></font></li>
<li><strong>   </strong>,     . ,     .     64- ,       0  2<sup>64</sup>.          ,      .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
値の範囲が異なる場合は、アルゴリズムに使用可能な範囲を与えることが望ましいです。マシンに十分なメモリがない場合は、10キロバイト間隔でレギュレーターの値を増やすことが論理的ですが、大量のメモリを搭載したマシンで作業する場合は、10ギガバイトの増加ステップが可能です。したがって、ソリューションのスペースが削減され、これにより、アルゴリズムがより迅速に回答に収束できるようになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ハードウェアリソースによって制限される各レギュレーターを何らかの形でマークする必要があります。ニュアンスはありますが、これを行う必要があります。たとえば、アプリケーションまたはデータベースシステムが使用できるメモリの総量を制限して、使用可能なメモリの総量を超えないようにする必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
問題は、プロセッサコアなどのように、冗長な資料を配置することが理にかなっている場合があることです。実際のアルゴリズムがこれでどのように機能するかは、まだわかりません。しかし、私たちは、たとえば、このコントローラーがメモリに関係しているもの、これをディスクに関係しているなどについてのメタデータを操作できるようにしたいと考えています。そうすれば、どの範囲に留まる必要があるかを理解できるからです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは、自分自身を構成できるすべての規制機関を削除する必要があると考えています。この問題はオープンソースソフトウェアでは発生せず、ベンダーソフトウェアに関連しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作業の過程で、機械学習アルゴリズムでは考慮されていない追加の外部要因が発見されたとします。そのため、これを考慮して新しいモデルを構築する必要があります。これは、それ自体が追加のワークロードです。要求が何を返すかを事前に知ることができず、再び、次に何が起こるかを予測するモデルを構築する必要があります。システムにOracle自動チューニングコントローラーなどがある場合、コントローラーはいつでも値を変更でき、これを事前にシミュレートすることはできません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hp/7z/1p/hp7z1pthfae3wegk-k3jdbggzvs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
繰り返しますが、この行動モデルは商業圏でのみ観察されます。自律性を維持するには、このような規制機関をすべて無効にするか削除する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メトリックに関しては、データベースシステムの基礎となるハードウェア機能を明らかにしたいと考えています。プロセッサの機能、メモリ速度、ディスク速度、ネットワーク速度などについて話します。内部ディレクトリのようなもの、またはプロセッサがどのように見えるかを示す情報スキームが必要です。理由は簡単です。特定のマシンとハードウェアにPostgreSQLをデプロイする場合、1つのコントローラー構成が最適であり、より強力な機器を使用する場合、最適なコントローラー構成は大きく異なる可能性があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rb/mq/_x/rbmq_xap9pleuyrmfnrw2ofevbg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アルゴリズムにハードウェア情報を提供することで、機械学習手法を使用して、このコンピューターで達成できることと別のコンピューターで達成できることを推定できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カスタマイズできるサブコンポーネントがある場合は、個々のコンポーネントごとにすべての正しいメトリックが提供されていることを確認する必要があります。例として、これが適切に発生しない不良システムの例を考えます。 MySQLでMyRocksとして知られているRocksDBについて話しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RocksDBでは、列のさまざまなファミリをカスタマイズできます。テーブルごとに複数の列ファミリーを定義してから、各ファミリーのパラメーターを個別に構成できます。ファミリが正しくセットアップされているかどうかを確認するには、メトリックを見て、ハードウェアが実際にどのように使用されたかを理解する必要があります。列ファミリーの統計を取得するには、RocksDB情報スキームにリクエストを行う必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/r4/i0/d8/r4i0d82qeejj7rhh1f6fftdd1ua.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DBMSのパフォーマンスを判断するには、列のファミリとその構成方法を表示するのではなく、システムによって実行される読み取り操作と書き込み操作の数を表示することが重要です。しかし、MyRocksは列ファミリーに関するそのような情報を表示しません。この情報を取得する唯一の方法-ファミリー列のグローバル統計を見てください</font></font><code>ROCKSDB_BITES_READ, ROCKSDB_BITES_WRITTEN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。このような情報は集約されるため、ほとんど役に立ちません。また、各ファミリを個別に設定します。特定の列ファミリーが、読み取り操作と書き込み操作の数の全体的な結果にどのように影響するかはわかりません。集約された集約値からデータを抽出するには、大量のデータを収集する必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/uh/dh/3z/uhdh3zbip3urg8cdphihobpsine.png"><br>
<br>
<blockquote>, ,      ,                 .</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
商業分野では、オープンソースを使用する企業よりも状況は少し優れています。後者はリリースごとにこの側面を改善しますが、これまでのところ誰も理想に達していません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
明らかなダウンタイムに加えて、問題は</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ダウンタイムの長さをシミュレートする必要</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">がある</font><strong><font style="vertical-align: inherit;">ことです</font></strong><font style="vertical-align: inherit;">。 MySQLには、ログファイルのサイズを設定するレギュレーターがあります。また、現在および将来の値に応じて、ダウンタイムは変化します。ログファイルのサイズが現在5 GBで、値を10 GBに変更した場合、実際のファイルサイズは変更されないため、システムの再起動後すぐに作業を開始できます。ただし、5 GBを1つに変更する必要がある場合、ダウンタイムが増加します。ファイルの圧縮には長い時間がかかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このプロセス全体をシミュレートする必要があるため、変更の採用により多くの時間が費やされています。このため、システムをゼロから構築しています-PostgreSQLではこれを許可していません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通知は仕事の非常に重要な要素です。モデルで何が起こっているかを知る必要があります。たとえば、インデックスが現在作成されているため、または作成されたばかりのインデックスが最適ではなかったために、作業が遅くなった、などです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ワークロードを水平方向にスケーリングする場合にも問題が発生します。負荷が増加すると、システムの速度は低下しますが、それでも作業する必要があります。将来、システムはSLAレベルに準拠する必要があります。現時点では、この問題をどのように解決するかまだわかりません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、私が話したい最後のこと。ご存知のように、多くのデータシステムは複製環境で動作して高可用性を実現します。したがって、当然のことながら、追加のリソースを有益に使用して、トレーニング用のより多くのデータを収集したいという願望があります。これには、レプリカが異なり、設定が異なる必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8a/yg/zk/8aygzkmzaogstbgocmxpypcwpjq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1つのマスターデータベースと2つのレプリカを持つシステムで作業し、インデックスを選択する問題を解決するとします。マスターで優れたインデックスが選択されましたが、レプリカでは他のインデックスを試すことができますが、突然、マスターよりも優れたインデックスがいくつかあります。最初のレプリカで見つかったインデックスが本当に最高であることがわかったとします。これにより、それぞれマスターデータベースのインデックスよりも高いパフォーマンスが得られます。これを移動して、マスターでさらに使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、レプリカには、ワークロードのアプリケーション要件を満たすことができない構成がある可能性があることを忘れないでください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目のレプリカが、パフォーマンスの低いインデックスを使用するとします。これは悪いことです。マスターに障害が発生した場合は、そのようなレプリカに切り替える必要があり、5分の遅延が発生します。これらすべての結果としてダウンタイムが発生し、システムの高可用性の概念全体が失われます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
損失を回避するには、早い段階で構成を非流動的であると認識し、それをロールバックするか、オフにして再起動して正しい構成に戻すか、単にアクションをキャンセルして、できるだけ早く損失に追いつくようにする必要があります。</font><font style="vertical-align: inherit;">ここで説明しているレベルで異なる構成を使用できるDBMSがないことがわかっているため、機械学習に基づく環境で作業を行う必要があります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oracle自律型データベース</font></font></h2><br><font style="vertical-align: inherit;"><strong><font style="vertical-align: inherit;">オラクル</font></strong></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に対する批判で</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
私の報告を終えるつもりです</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">オラクルは2017年、世界初の自治DBMSをリリースしたと発表した。</font><font style="vertical-align: inherit;">OracleのCEOで創設者のラリーエリソンがステージに上がり、「これはOracleが20年間に行ってきた最も重要なことです」と述べました。</font></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zo/-f/-d/zo-f-daby9ck_ghomdje3fpny_8.png"></div><br>
<br>
<em>    .  ,       , ,   ,    ,        .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>   </em><em>CIDR     ,     .     ,   : «,    ,    ,       . ,        ,     ,  </em><em>Oracle       ?»      ,   —       . </em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、Oracleが提供するシステムが実際に何であるかを見てみましょう。彼らによれば、5つの重要なアイデアがシステムを自律的にします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、この</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自動的に最適化された修正</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はかなり良いものですが、新しいバージョンがリリースされたときに、ダウンタイムなしで変更が行われるため、自己管理とは呼びません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の3つのアイデアは、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自動インデックス作成、リカバリ、スケーリングです。</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。実際、これらは先ほどお話ししたツールと同じもので、2000年代の自己調整の時代から生まれました。 Oracleが10年前に行ったのと同じツールが、管理された環境でリリースされました。先に述べたのと同じ制限がそれらに適用されます。これらは反動的な措置であり、転送トレーニングの欠如です。さらなる改善のためにアクションまたは変更から知識を得る方法はありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、私はそのようなシステムは自治ではないと主張します。 DBMSの場合、自治という用語は意味しますが、これはかなり哲学的な問題です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5番目のポイント- </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自動クエリ調整</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。データベースの文献に精通している場合、これは適応クエリ処理と呼ばれます。基本的な考え方はこれです。多数のJOINを含む複雑なクエリを実行します。オプティマイザーをスキップして、クエリ実行プランを取得します。最適化されたリクエストを運用に投入した後、最適化の品質について疑問が生じる可能性があります。これが発生した場合、そのような要求での作業を停止し、オプティマイザに戻って、新しい計画を要求する必要があります。そして、停止点から続行するか、より適切な計画で要求を再開する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアイデアは新しいものでも、Oracleによって開発されたものでもありません。</font><font style="vertical-align: inherit;">Microsoftは2017年に、同じ機能を備えたSQL Serverを発表しました。</font><font style="vertical-align: inherit;">00年代前半のIBM DB2には、「LEO」と呼ばれる同様のものがありました-学習オプティマイザです。</font><font style="vertical-align: inherit;">そしてそれ以前にも、1970年代には、まさにIngresクエリオプティマイザが機能していました。</font><font style="vertical-align: inherit;">JOINを作成することができなかったため、彼はデータタプルを処理し、約100のタプルを持つテーブルを操作しました。</font><font style="vertical-align: inherit;">したがって、当時はそのアイデアは適用可能でした。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">今日存在する形の自治制度については、自治とは言いません。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結論として、今後10年間でDBMSの自律性を実現することが可能になると思います。それは多くの研究を必要とし、多くの問題は解決されておらず、それらはまだ取り組む必要があります。私たちがやっていることはとてもエキサイティングです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのようなシステムで作業するすべての人に、私は別れの言葉を与えたいと思います-新しい機能を追加するたびに、この機能がマシンによってどのように制御されるかを明確に理解する必要があります。任意のアプリケーション用にレギュレーターを構成する方法を知っている人がいるとは思わないでください。パラメータがソフトウェアによって制御されている場合、情報の処理方法、システムの再起動方法などについて常に考える必要があります。</font></font><br>
<br>
<blockquote>HighLoad++    ,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">HighLoad++ Siberia</a>  .     ,    39   ,   ,    highload- -        .<br>
<br>
 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">HighLoad++</a>    ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>.           ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">UseData Conf</a> —  16 ,   . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>  ,       . <br>
</blockquote></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja456564/index.html">MS SQLの弱いパスワードを持つユーザーのリスト</a></li>
<li><a href="../ja456570/index.html">この6月21日金曜日は、6月22日限定のマスタークラスであるDevConfXの記念日となります。</a></li>
<li><a href="../ja456572/index.html">40年間の広告宣伝-広告ビデオゲームの回顧</a></li>
<li><a href="../ja456574/index.html">最小のケーブルテレビネットワーク。パート10：KTVネットワークのトラブルシューティング</a></li>
<li><a href="../ja456578/index.html">バックエンド開発者のためのVueJSの概念-6月22日のマスタークラス</a></li>
<li><a href="../ja456582/index.html">なぜインターネットはまだオンラインなのですか？</a></li>
<li><a href="../ja456584/index.html">＃ITX5はJAVA開発者のパーティーを開催します</a></li>
<li><a href="../ja456588/index.html">依存性注入の研究</a></li>
<li><a href="../ja456592/index.html">英語の「時代」の発達における認知の歪み、または誰が私たちを妨害するかが私たちを助けます</a></li>
<li><a href="../ja456594/index.html">Webpackツリーの振とうと再エクスポートで2分</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>