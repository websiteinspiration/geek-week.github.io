<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔻 👣 👎🏼 Konferensi DEFCON 27 Buttplug: Pengujian Penetrasi Benar. Bagian 1 💏 🧖🏾 🎧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Analis percaya bahwa saat ini ada sekitar 10 miliar perangkat dari dunia Internet of Things (IoT). Terkadang perangkat ini mendapatkan tempat mereka d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Konferensi DEFCON 27 Buttplug: Pengujian Penetrasi Benar. Bagian 1</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/495378/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analis percaya bahwa saat ini ada sekitar 10 miliar perangkat dari dunia Internet of Things (IoT). Terkadang perangkat ini mendapatkan tempat mereka di pasar, benar-benar memanjat manusia. Ternyata, chip radio murah dan berdaya rendah tidak hanya bagus untuk otomatisasi rumah - mereka juga mengubah cara orang berinteraksi dengan mainan seks. Dalam laporan ini, kita akan terjun ke dunia dildonics televisi, teknologi seks pada jarak di mana taktil, suhu dan sensasi lainnya ditransmisikan antara pasangan melalui jalur komunikasi dua arah. Pembicara akan memberi tahu Anda bahwa keamanan mainan seks anal elektronik elektronik Buttplug dapat ditentang oleh penyerang yang menemukan dan mengeksploitasi kerentanan di setiap tingkat tumpukan. Pada akhirnya, ini memungkinkan sextoys sendiri untuk dikompromikan,dan perangkat yang mereka hubungkan.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z5/yr/ar/z5yraruqzcjhhyd_pc_eym4a5ly.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seorang hacker dengan nama panggilan smea, atau Smealum, memulai karirnya sebagai pengembang video game untuk konsol game seperti Nintendo DS, secara bersamaan mencoba memecahkannya. Di beberapa titik, konsol memperoleh sistem keamanan yang serius, dan Smea beralih dari perangkat lunak yang dikembangkan di rumah ke mengembangkan teknik untuk memecahkannya. Smea dikenal karena "bekerja" pada Nintendo 3DS dan Wii U, meskipun ia juga berkontribusi pada pengembangan eksploitasi untuk browser web dan tumpukan virtualisasi yang paling populer. Mungkin, sekarang dia menjadi tertarik membobol colokan anal "pintar".</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Halo semuanya, saya Smia, dan hari ini kita akan berbicara tentang cara memecahkan plug boot. Ini adalah objek yang saya pegang di tangan saya, saya tidak tahu apakah Anda pernah melihatnya sebelumnya, secara pribadi saya tidak. Tetapi selama 2 tahun terakhir, saya bertemu banyak perwakilan menarik dari industri IoT, jadi sekarang giliran hal ini telah datang. Anda mungkin bertanya-tanya bagaimana Anda dapat memecahkan plug boot, karena itu hanya sepotong silikon yang perlu dimasukkan di suatu tempat, dan Anda akan setuju bahwa tidak ada banyak tempat untuk ini.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bahkan, ini tidak memerlukan elektronik. Tetapi selama beberapa tahun terakhir, atau bahkan beberapa dekade, industri baru perangkat elektronik yang disebut teledildonika telah muncul. Asal usul istilah ini ditampilkan pada slide: kata Yunani "tele" berarti "dari jauh", dan "dildo" bahasa Inggris berarti tidak lebih dari sebuah dildo. Saya mencoba menemukan asal kata dildo, tetapi tidak ada yang tahu dari mana asalnya. Tapi ini bisa dimengerti, bukan? Idenya adalah Anda ingin membuat mainan seks yang entah bagaimana dapat dikendalikan dari kejauhan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada beberapa skenario untuk ini. Saya hanya ingin menjelaskan kepada Anda cara kerjanya, karena tidak semua orang akrab dengan perangkat tersebut. Jadi, Anda mengambil bootplag, masukkan di mana perlu dan dapat mengontrolnya dari jarak jauh dari mana pun Anda inginkan - dari ponsel, laptop, dll. Ini adalah skenario pertama yang disebut "permainan solo." Skenario kedua yang saya sebut "multiplayer lokal" - ini adalah saat Anda mentransfer kendali atas hal ini kepada orang lain. Ini adalah hal yang sangat nyata yang sering diiklankan - Anda dapat, misalnya, pergi ke bar dengannya dan tidak ada yang akan tahu betapa menyenangkannya itu. Tetapi secara teknis, ini menciptakan vektor serangan baru, karena Anda memberikan kontrol perangkat kepada orang luar, dan di sini model ancaman benar-benar berubah.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skenario ketiga, "multi-pemain jarak jauh," mirip dengan yang kedua, hanya sekarang Anda mengizinkan orang lain untuk mengontrol perangkat melalui Internet. Perlu diingat bahwa orang ini dapat menjadi orang asing. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mn/nb/hr/mnnbhrbihysuf1iengokudmgudm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagi banyak orang, berhubungan seks di kejauhan terlihat sangat keren dan menyenangkan, dan saya tidak akan bercanda tentang hal itu. Beberapa menggunakan teledildonics untuk mencari nafkah, dan skenario 3B disebut "multiplayer berbayar jarak jauh." Oleh karena itu, fakta bahwa saya mencoba untuk memecahkan plug butt bukan hanya hiburan - itu memberi studi penetrasi saya pembenaran tertentu.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gn/g0/m4/gng0m40-kjudzygpgp6fkeczt_i.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Banyak orang, saya tidak tahu harus memanggil mereka apa - laki-laki, perempuan - menyediakan hiburan seksual yang dinamis di Internet, memungkinkan orang lain untuk mengendalikan mainan seks mereka demi uang. Perusahaan yang memproduksi puntung ini memiliki paten untuk konsep pengurangan keuntungan saat menggunakan produknya untuk permainan seks di Internet. Dalam skenario ini, untuk potongan $ 5, Anda memiliki hak untuk menempatkan tautan, misalnya, di Twitter, untuk memberi seseorang peluang mengelola bootplag Anda untuk waktu yang terbatas. Karena orang mengandalkan mainan ini sebagai alat untuk menghasilkan uang, menurut pendapat saya, sangat penting untuk mempertimbangkan keselamatan mereka.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita lihat skenario yang menarik bagi penyerang. Yang pertama adalah peretasan lokal, ketika seorang penyerang yang berada dalam jangkauan perangkat memotong kendali melalui komunikasi nirkabel. Ada banyak penelitian tentang metode peretasan ini, jadi kami tidak akan terjebak dengan perhatian kami pada itu. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gy/wb/8g/gywb8gehwmsgsmf_5pra4m_lmr4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secara teknis, intervensi semacam itu dapat dianggap sebagai pelecehan seksual, jadi apakah itu legal atau tidak, jangan coba-coba melakukannya. Menurut skenario berikut, seorang penyerang melakukan hal yang sama, tetapi dari jarak jauh, melalui Internet. Seperti yang sudah saya katakan, jika Anda mendapat penghasilan seperti itu, Anda bisa dengan sukarela menyediakan orang asing - penyerang dengan akses jarak jauh ke sex toy Anda.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini berarti bahwa seorang peretas dapat membahayakan mainan seks "pintar" Anda atau perangkat terkait, singkatnya, melakukan sesuatu yang buruk kepada Anda, dan itu sepenuhnya legal, karena Anda sendiri memberinya akses. Untuk seorang hacker ini adalah opsi yang lebih menarik, jadi kita akan tinggal sedikit lebih lama. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8v/cb/hz/8vcbhzhmae_kgh9ka8v37s2jg_8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skenario ketiga adalah sebaliknya - penyerang sendiri menggunakan plug-in boot untuk mengendalikan komputer atau telepon dan meretas perangkat yang terletak di sisi pengguna yang secara remote berpartisipasi dalam game dengan plug-in. Orang-orang tidak mengerti bahwa ini adalah risiko nyata, tetapi Anda mungkin membayangkan bagaimana colokan butt bisa berbahaya (tertawa di aula). Kami juga sedang mengeksplorasi skenario ini.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vn/tv/sr/vntvsrxrvefsyh_y7k48hqd7fiu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang setelah Anda memiliki gagasan tentang dunia teledildonics, mari kita lihat bagaimana tampilannya dalam praktik. Pada slide, Anda melihat model dildo yang disebut Lovense Hush, dan kemudian saya akan menunjukkan kepada Anda demo dengan hal ini di udara. Ini adalah model pertama dari dildo-teledildonics di dunia, sebuah plug anal yang dapat dikontrol dari ponsel atau komputer Anda. Ada aplikasi untuk IoS dan Android untuk boot-plag ini, Anda dapat mengontrolnya dari komputer yang menjalankan Mac OS dan Windows. Aplikasi seluler mendukung fitur sosial seperti mengobrol, berbagi teks, gambar, video, dan mengendalikan mainan dengan teman atau orang asing.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/b-/ry/zq/b-ryzqagf71doiiyxeoj_hzvzm8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk Windows, Anda perlu menggunakan kunci USB khusus, yang akan saya tunjukkan nanti, karena sekarang plug-in boot ini terhubung ke komputer saya. Kunci flash drive elektronik dikembangkan oleh perusahaan yang sama, "Lovens", produsen plug-in boot yang menciptakan ekosistem dildo "pintar" sendiri dan membutuhkan komisi sekitar $ 5 untuk satu sesi di Internet.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bv/lg/dl/bvlgdlcsp4qckbaej8gps_szkua.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Slide berikut ini menunjukkan visi saya tentang serangan pada plug boot menggunakan aplikasi PC. Ada koneksi BLE (BlueTooth Low Energy) antara plug boot dan kunci USB, kunci terhubung ke komputer pengguna, yang pada gilirannya terhubung ke Internet. Skenario No. 1 digunakan oleh penyerang di bagian kunci plug-USB boot, yaitu, koneksi BLE diserang. Bahkan, tidak ada perlindungan, sehingga setiap orang asing bisa mengendalikan mainan ini. Tahun lalu, ada diskusi serius tentang alat yang disebut BTLE Jack, yang memungkinkan Anda untuk berhasil menyerang koneksi seperti itu.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/l_/ma/24/l_ma24foabt77cti9__dmq7ufam.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skenario No. 2 terdiri dari menyerang bagian dari koneksi Internet komputer pengguna. Skenario ketiga adalah upaya untuk meretas ke salah satu dari tiga situs: BLE, USB, Internet. Kemungkinan ada proyek terbuka Buttplug ... Anda bisa tertawa, itu lelucon. Jadi di mana kita memulai "pengujian penetrasi sejati" kita?</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cj/ov/21/cjov21ngohs6fh0gqaccbp2mdn0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya tidak menemukan kode atau binari untuk dildo dan dongle itu sendiri, tetapi ada file aplikasi biner untuk perangkat seluler dan komputer yang tersedia untuk diunduh di Internet. Saya menginstal file-file ini di komputer saya dan mulai mengerjakannya. Pada slide berikutnya, Anda melihat antarmuka aplikasi untuk mengelola plug-in boot. Di tengah layar terdapat slider untuk mengatur getaran mainan, dan di sebelah kiri adalah panel kontrol dengan tombol - akses ke akun, mode kontrol di jaringan lokal, mode kontrol jarak jauh melalui Internet. Untuk memahami struktur aplikasi, Anda hanya perlu membaca sedikit kode JavaScript yang membingungkan.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gy/tc/l_/gytcl_o4cfm0iolamia3r6cfryo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya tidak suka JavaScript, tetapi apa yang baik tentang itu adalah keberadaan sekelompok nama variabel dan nama bidang objek, dan semua ini direkayasa secara sempurna. Cukup masukkan kode di Beautifier dan cari tahu cara kerjanya. Setelah Anda melakukan ini, Anda dapat mulai memahami pengoperasian kunci elektronik.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fp/km/1s/fpkm1shgzrwislgaj09vm2ileg8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mengetahui bahwa ini hanyalah port serial untuk menghubungkan melalui USB, saya mulai mengendus lalu lintas antara tombol dan aplikasi. Perhatikan garis-garis di sebelah kanan slide - pertama-tama, saya perhatikan bahwa pesan antara dongle dan aplikasi dalam format teks JSON. Untuk kode JavaScript, ini sudah biasa, tetapi untuk kunci USB, yang merupakan mikrokontroler 32-bit, menanamkan parser JSON terlihat aneh ... Bagi kami itu sangat mudah, karena parser JSON biasanya berisi bug firmware yang dapat digunakan.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hj/5r/rk/hj5rrk2imjq5byefebbencwwmsg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun, menemukan bug tanpa kode kunci itu sendiri adalah tugas yang membosankan, tetapi karena saya memiliki kode aplikasi, saya mulai mencari mekanisme untuk memperbarui firmware kunci USB di dalamnya dan segera menemukan apa yang saya inginkan - URL dari simpul pembaruan. Ternyata firmware tidak dienkripsi atau masuk dengan cara apa pun, jadi saya hanya mengunduhnya dan mendapatkan biner untuk dianalisis. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xc/q7/vs/xcq7vsjbakxsctt8th2gd_fwhni.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lalu saya mulai membalikkan teknik dan menarik 2 hal. Pertama, ada 2 penangan perintah untuk port USB serial. Yang pertama menggunakan perintah sederhana seperti reset atau tipe perangkat, yang kedua menggunakan perintah seperti DFU untuk memperbarui firmware perangkat, sehingga kami memiliki kemampuan untuk mengirim perintah ini dan memperbarui firmware.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oy/ol/b-/oyolb-kfxvjs8uq4ccxmvyrowdw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah melihat parser JSON, yang paling menarik bagi kami, saya menemukan bug yang diharapkan - fungsi parseJsonString. Itu hanya perlu mengalokasikan salinan string asli ke buffer baru, dan juga bekerja dengan hal-hal seperti urutan melarikan diri. Saat menghitung panjang buffer baru, itu tidak cocok dengan panjang sebenarnya yang digunakan. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/po/n7/vw/pon7vwgs51_0b0xicll5adjy0km.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fungsi ini berfungsi seperti ini: ia mendukung urutan pelepasan dari 5 parameter U alih-alih, seperti yang diharapkan, menyamakannya 0. Berkat ini, kita dapat menghindari string yang diakhiri null dan membuat panjang string yang dihitung pertama salah.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lg/am/4y/lgam4y0v4ijpkvue8j2snjfr7xm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Animasi kecil ini menunjukkan apa yang terjadi di sini. Garis miring terbalik sebelum U berarti 6 karakter harus dibuang. Selanjutnya, fungsi melompati terminator nol, yang merupakan masalah. Kemudian proses berlanjut, semua karakter disalin dan jatuh ke buffer dengan panjang hanya 6 byte. Di sini masalah kedua muncul - risiko buffer overflows. Ini bagus, tapi kami masih tidak tahu bagaimana perangkat keras dongle bekerja. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wj/ea/hl/wjeahlydyx11z5kl0e_entwcoiw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami tahu pasti bahwa ia tidak memiliki pengacakan ruang alamat ASLR, tidak ada tumpukan cookie, tetapi ada kemungkinan bahwa kunci tersebut memiliki perlindungan seperti pencegahan eksekusi data DEP atau perlindungan XN yang mencegah eksekusi kode dalam memori, kecuali untuk wilayah .text.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kuncinya dilengkapi dengan chip NRF51822 SoC dengan prosesor Cortex M0, tanpa perlindungan DEP, sangat populer untuk perangkat BLE dan dilengkapi dengan banyak kontak debugging. Oleh karena itu, cukup mudah untuk terhubung ke kunci ini dengan menyolder beberapa hal untuk itu, dan melakukan debugging melalui antarmuka untuk debugging dan flashing chip SWD jika tidak dinonaktifkan di pengaturan pabrik. Dengan menghubungkan melalui SWD, kita dapat menyiram isi tumpukan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ternyata itu digunakan hanya untuk parser JSON, yang tidak terlalu keren, tetapi heap berisi metadata. Jadi apa yang bisa dimanjakan di sini? Tentu saja, tumpukan metadata! Dengan cara ini kami membuat exploit untuk parser JSON.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qw/9o/zh/qw9ozhk_k6ixcm_iupcoyvun3xa.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tumpukan hanyalah daftar gratis. Jika Anda melihat kode ini, Anda dapat melihat bahwa setiap distribusi memiliki panjang dan penunjuk sendiri. Jika Anda menggunakan buffer overflow, Anda dapat merusak panjang dan posisi pointer berikutnya, yang memungkinkan Anda untuk mengontrol lokasi distribusi berikutnya. Dengan menyalin baris baru ke dalamnya, Anda dapat dengan mudah mengatur data sewenang-wenang di tempat sewenang-wenang. Semua ini dapat dilakukan saat debugger terhubung. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tb/hk/y7/tbhky7ub8kj5cbgpjhmrl-frong.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sisi kanan slide, Anda melihat tumpukan yang diatur ulang dan sepenuhnya ditimpa hanya dengan 8 karakter. Ini memberi kita eksekusi kode kunci USB, yang cukup keren.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya ingat bahwa, sayangnya, dongle ini memiliki mode pembaruan firmware DFU darurat. Saya berharap dengan analogi dengan meretas konsol game, mode ini berfungsi untuk mengotentikasi pembaruan dengan cara apa pun yang memungkinkan. Ternyata di sini DFU menggunakan perhitungan checksum CRC16 klasik, yang, jika Anda mengerti kriptografi, bukan otentikasi jenis apa pun. Saya tidak berpikir mereka benar-benar ingin menggunakan otentikasi dalam kasus ini, kemungkinan besar mereka hanya memutuskan bahwa beberapa orang akan tertarik untuk mengeksekusi kode kunci USB untuk plug boot. Namun, itu membuat saya tertarik.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/if/lg/py/iflgpyq2h1z6kusfwcpqf-x0vxy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saat ini, saya punya 2 cara berbeda untuk mengeksekusi kode pada perangkat ini, tetapi sibuk dengan JSON parser, yang saya habiskan banyak waktu, ternyata tidak terlalu efektif karena kehadiran mode DFU. Nanti kita akan mempertimbangkan metode ini bersama dengan kerentanan parser yang ada. Sejauh ini, saya lebih tertarik pada apakah mungkin untuk hanya memodifikasi file main.bin, menghitung ulang CRC16-nya dan menanamkannya menggunakan program yang termasuk dalam aplikasi Lovense Remote. Ternyata itu mungkin. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Akibatnya, kami mendapat kunci USB yang dikompromikan menggunakan aplikasi PC, dan itu pasti bagian yang paling mudah untuk di-crack. Setelah menguasai kunci, saya mulai mencari cara untuk mengeksekusi kode pada plug boot itu sendiri.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vi/k2/vm/vik2vmib-ohaqm0hlaaldyaqmgc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk melakukan ini, saya beralih ke "perangkat keras" mainan seks kami - mungkin juga memiliki debugger di atasnya, dan itu layak untuk dilihat. Setelah memeriksa colokan boot, saya menemukan chip yang lebih serius, dengan sejumlah besar memori flash dan RAM dan prosesor Cortex M4 yang lebih kuat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya dengan mudah menemukan apa yang hilang dan apa yang ada di papan bootplag. Tidak ada DEP, seperti pada dongle, di bagian atas ada kabel yang mengarah ke baterai, selanjutnya adalah port pengisian daya, kontak motor vibrator, beberapa bantalan kontak untuk debugging dan antena Bluetooth. Dengan demikian, berkat kehadiran SWD, perangkat dapat dengan mudah dicerminkan.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/r8/ln/rd/r8lnrdx8uis5lkt3f-gtdkpssr0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda lihat apa yang terjadi - saya tidak memiliki pemegang saham, tetapi di dalam tas akan selalu ada banyak colokan untuk eksperimen. Kemudian saya mulai membalikkan rekayasa dan men-debug bootplag, mengatur ulang firmware asli. Tidak ada parser JSON, hanya perintah sederhana, tetapi dalam jumlah besar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya pikir jika mode pembaruan firmware dongle sangat tidak aman, maka ada kemungkinan ada kerentanan. Ternyata seperti itu. Sebagai hasil dari pencarian DFU, saya menemukan 2 hal: pengendali perintah DFU reguler dan garis DfuTarg di sektor boot. DfuTarg ini digunakan dengan cara yang sama dengan pengidentifikasi dari plugin boot LVS-Z00, yaitu, mirip dengan bootloader DFU untuk BLE. Oleh karena itu, dalam mode DFU, bootlog dikenali sebagai perangkat dengan nama DfuTarg, dan pengidentifikasi unik ini dapat digunakan untuk mencari perangkat. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, jika Anda mengirimnya perintah DFU yang persis sama dengan yang kami kirim ke kunci, bootplag akan masuk ke mode pembaruan firmware perangkat. Untuk mem-flash, Anda dapat menggunakan alat milik pabrik mikircircuit Nordic Semiconductor - nRF Toolbox.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xb/iy/pr/xbiyprlhoukirnf_su9htx71rqa.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menggunakan sniffer perangkat keras, Anda dapat memvisualisasikan paket BLE di Wireshark. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xc/ea/9o/xcea9of9tdquhsfcjnjglzcsj78.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya mengirim pesan singkat "halo dari plug", dan ini berarti Anda dapat mengeksekusi kode pada batplag tanpa peretasan, dan ini bukan kerentanan, tetapi hanya semacam desain pengembang yang memungkinkan Anda untuk merombak perangkat. Mungkin komunitas open source akan menyukai solusi ini. Intinya adalah bahwa siapa pun yang dapat terhubung ke plug-in boot Anda dapat menjalankan kode mereka sendiri di atasnya, dan ini sudah merupakan hal yang agak berbahaya. Dalam hal ini, peretas harus berada di area koneksi lokal, yaitu cukup dekat dengan sex toy untuk mendapatkan kontrol melalui saluran dongle dan BLE yang dikompromikan. Pada saat yang sama, Anda dapat menggunakan dongle itu sendiri, atau perangkat BLE lainnya.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/d_/uo/uy/d_uouyokp1p8mdsyx2x0yehkl14.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertanyaannya adalah, apa yang sebenarnya bisa dilakukan dengan plug-in boot, memiliki peluang untuk menjalankan kode Anda sendiri di atasnya? Saya punya beberapa ide. Pertama - mengambil kendali atas hal ini, Anda dapat membuat bootplag ransomware. Anda dapat memodifikasi firmware-nya sehingga pengguna tidak akan dapat mengaktifkan mode DFU sampai Anda memberinya kunci tertentu, atau Anda hanya mematikan fungsi getaran dan meminta 50 dolar untuk membuka kunci perangkat yang bermanfaat ini.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cl/jb/ob/cljbobzlggrarkc30am8im-fe14.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagi banyak orang, ini akan menjadi semacam vaksin dari penggunaan mainan tersebut. Gagasan kedua adalah mengubah bootplag menjadi senjata. Ini memiliki baterai yang cukup kuat yang memberi makan motor vibrator, kita dapat mengatakan bahwa 80% dari isi colokan boot adalah baterai. Anda mungkin ingat apa yang terjadi dengan smartphone Samsung Galaxy Note - mereka baru saja meledak (tertawa), sehingga kemungkinan hal ini dapat terjadi dengan colokan butt. Saya tidak tahu apa kemungkinan ledakannya, tetapi jika Anda memiliki banyak mainan seks dengan motor, Anda harus memikirkannya. Tim pengembang mengklaim bahwa hal-hal ini benar-benar aman, meskipun ada banyak bagian yang bergerak. Tetapi jika ini masalahnya, maka fitur keamanan perangkat dikodekan dalam perangkat lunak, bukan perangkat keras.Dalam hal ini, eksekusi kode berbahaya dapat memiliki konsekuensi yang membahayakan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mainan seks yang dilengkapi dengan pompa udara juga berbahaya. Mereka juga memiliki motor yang cukup kuat dengan baterai, jadi Anda juga harus memperhatikannya. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Akhirnya, ide terakhir adalah plug-in pertempuran yang tidak bersahabat. Bermusuhan, bukan dalam arti bahwa ia mampu meledakkan pantat Anda, tetapi pada kenyataan bahwa itu dapat berfungsi sebagai cara untuk meretas sisa perangkat Anda. Oleh karena itu, kami akan mempertimbangkan plug pertempuran dari sudut pandang permusuhannya, yang dipastikan dengan eksekusi kode berbahaya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita coba mencari tahu apakah mungkin untuk mencapai eksekusi kode dalam aplikasi untuk plug-in boot dengan mempertimbangkan bagaimana ia memproses pesan yang masuk.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/g_/ov/1v/g_ov1vzowj7o8hifa6xhfoo5gmq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sebelah kiri Anda melihat panggilan balik dalam JavaScript, dan di sebelah kanan bagaimana ia berinteraksi dengan aplikasi melalui port serial. Callback ditempatkan dalam sebuah string dan kemudian diproses oleh sekelompok fungsi yang berbeda. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fungsi pertama adalah untuk menemukan kunci, itu memproses pesan inisialisasi yang berasal dari kunci. Fungsi kedua aktif ("Data"), fungsi pemrosesan yang menerima paket JSON yang masuk, yang panjangnya, tidak bisa melebihi 32 karakter. Selanjutnya, penguraian dan segalanya dilakukan. Bahkan, tidak ada pemrosesan serius di sini - hanya permintaan dibuat untuk status perangkat, memeriksa muatan baterai dan overhead sejenisnya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fungsi terakhir jauh lebih menarik - saya menyebutnya log debug, meskipun sebenarnya tidak memiliki nama dalam kode sebenarnya. Fungsi ini mendaftarkan semua yang masuk ke perangkat melalui port serial dan mengatur ulang garis-garis ini ke konsol, yang jika perlu menampilkan pesan kesalahan. Selain itu, fungsi ini membuat elemen DOM baru sebagai elemen HTML, dan membuang semua konten yang diterima melalui port serial ke dalam HTML ini. Saya bukan pengembang web, tetapi saya pikir ini adalah kerentanan XSS yang serius.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, jika Anda memiliki kendali atas dongle, Anda dapat mengirim apa saja melalui port serial, memaksa aplikasi untuk menafsirkan ini sebagai HTML. </font><font style="vertical-align: inherit;">Ini masalahnya, karena HTML memiliki kemampuan untuk membuat kode JavaScript baru dalam aplikasi yang diinstal pada komputer Anda, yaitu, ia dapat mengompromikannya. </font><font style="vertical-align: inherit;">Pertanyaannya adalah, malware apa yang dapat ditemukan, mengetahui bahwa hanya 32 karakter yang diizinkan pada suatu waktu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
22:00 </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konferensi DEFCON 27 Buttplug: pengujian penetrasi asli. </font><font style="vertical-align: inherit;">Bagian 2</font></font></a><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/RnxcPeemHSc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sedikit iklan :)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terima kasih untuk tetap bersama kami. Apakah Anda suka artikel kami? Ingin melihat materi yang lebih menarik? Dukung kami dengan melakukan pemesanan atau merekomendasikan kepada teman Anda, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cloud VPS untuk pengembang dari $ 4,99</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">analog unik dari server entry-level yang diciptakan oleh kami untuk Anda: </font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seluruh kebenaran tentang VPS (KVM) E5-2697 v3 (6 Cores) 10GB DDR4 480GB SSD 1Gbps mulai dari $ 19 atau cara membagi server?</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (opsi tersedia dengan RAID1 dan RAID10, hingga 24 core dan hingga 40GB DDR4). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R730xd 2 kali lebih murah di pusat data Equinix Tier IV di Amsterdam?</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hanya kami yang memiliki </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x Intel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 TV dari $ 199</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di Belanda!</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R420 - 2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB - mulai dari $ 99! </font></font></b></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Baca tentang</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cara Membangun Infrastruktur Bldg. </font><font style="vertical-align: inherit;">kelas c menggunakan server Dell R730xd E5-2650 v4 seharga 9.000 euro untuk satu sen?</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id495366/index.html">16 jenis programmer, atau Pengembang bukan robot yang sama</a></li>
<li><a href="../id495368/index.html">Kami mendaftar sendiri untuk self-walking self-dog dalam kondisi isolasi diri</a></li>
<li><a href="../id495370/index.html">Publik itu jahat</a></li>
<li><a href="../id495374/index.html">Lampu langit-langit dekoratif General Lumino 02</a></li>
<li><a href="../id495376/index.html">Kebosanan karantina. Cara menghabiskan uang paling banyak di Azure dengan satu klik</a></li>
<li><a href="../id495380/index.html">Firewall Mesir Hebat</a></li>
<li><a href="../id495384/index.html">Pengalaman magang saya di Microsoft Redmond dan mendapatkan tawaran</a></li>
<li><a href="../id495388/index.html">Acara televisi 1970-an yang menjadi nenek moyang eSports</a></li>
<li><a href="../id495390/index.html">STM32CubeMonitor patut dicoba</a></li>
<li><a href="../id495392/index.html">Cara mencari bug di ujung depan: 4 tahap utama</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>