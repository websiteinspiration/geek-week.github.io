<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçÄ üë±üèø ü§¥üèº Confidence interval for the number of patients with coronavirus (mortality calculation) üêÅ üçï üë®üèæ‚Äç‚öñÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A popular argument for a viral publication about coronavirus - how can one get any statistics for three cases? You can‚Äôt draw conclusions on such smal...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Confidence interval for the number of patients with coronavirus (mortality calculation)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/492628/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A popular argument for a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">viral publication about coronavirus</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - how can one get any statistics for three cases? You can‚Äôt draw conclusions on such small samples! Everyone who studied social sciences absorbed this story about sample sizes with mother's alma milk. And this is correct in those situations with which we usually deal - with selective statistics. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For the case of the three dead, these statistics are very indirectly related. In those years when I was still teaching mathematical methods for psychologists at the university, I always tried to stop at this place - something that this whole course is about is not related to actual data. Only to the problem, when we need to make a conclusion about the general population from a random sample.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And here we have the number 3. Three dead, not some kind of vector, not a table or sample. </font><font style="vertical-align: inherit;">It is a fact. </font><font style="vertical-align: inherit;">Three of the dead came to us completely by chance. </font><font style="vertical-align: inherit;">They died.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, we will consider one of the simplest methods for determining the number of cases - by the mortality rate and the number of deaths. </font><font style="vertical-align: inherit;">Suppose that we know mortality and it is 1%. </font><font style="vertical-align: inherit;">In this situation, it would be logical and correct to consider that the number of people recovered will be 297. But what is the reliability of this judgment? </font><font style="vertical-align: inherit;">Can we just brush aside that we have three dead, stating that three are not statistics? </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/b11/684/aa6/b11684aa68acccca02d41b21e6f6ef35.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This question will be answered by a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">negative binomial distribution and its prophet - Wikipedia</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. There are many Greek letters, if you, like me, are afraid of them, then I will tell you what happens. This distribution just answers the question of how many times it is necessary to roll the die so that the six falls five times. I use the R programming language for calculations, in which there is a ready-made function that allows you to evaluate the confidence interval.</font></font><br>
<br>
<pre><code class="python hljs">qnbinom(p=c(<span class="hljs-number">.025</span>,<span class="hljs-number">.975</span>),size=<span class="hljs-number">3</span>, prob=<span class="hljs-number">0.01</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here p is 2.5% from below and 2.5% from above, between which the desired range is located. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The result is a confidence interval from 60 to 717. Not so bad! It is likely that the three dead do not mean at all 297 recovered, but only sixty! But maybe for seven hundred. :-( </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For the most suspicious, who do not believe in a negative binomial distribution, I can offer numerical modeling. In general, if you don‚Äôt know how to calculate by formulas and distributions, model! In any incomprehensible situation, model, Monte Carlo is waiting for you. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will write the random_infected function, which simulates a situation of disease and death.</font></font><br>
<br>
<pre><code class="python hljs">random_infected &lt;- function(deaths, fatality_rate)<font></font>
{<font></font>
  dead = <span class="hljs-number">0</span>
  all = <span class="hljs-number">1</span>
  <span class="hljs-keyword">while</span> (dead &lt; deaths) {
    <span class="hljs-keyword">if</span> (runif(<span class="hljs-number">1</span>) &lt; fatality_rate) {<font></font>
      all = all + <span class="hljs-number">1</span>
      dead = dead + <span class="hljs-number">1</span>
    } <span class="hljs-keyword">else</span>
      all = all + <span class="hljs-number">1</span><font></font>
  }<font></font>
  <span class="hljs-keyword">return</span>(all)<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This function does the following - rolls an ‚Äún-faced‚Äù cube (using uniform distribution). If one is dropped, then it increases the number of dead and the number all by one. And if it didn‚Äôt, then only the number all. Each roll of this die is a sick person who can either die or recover. As soon as we have the number of deaths specified by the deaths parameter, we stop and report how many times the die was rolled (the number is all). The likelihood of a one falling out on our imaginary cube is mortality, in our case the fatality_rate parameter.</font></font><br>
<br>
<pre><code class="python hljs">infected_sizes&lt;-replicate(<span class="hljs-number">100000</span>,random_infected(deaths=<span class="hljs-number">3</span>,fatality_rate=<span class="hljs-number">0.01</span>))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And now let's calculate this number 100 thousand times. I have an old laptop, so I‚Äôm reluctant to wait until a million are counted. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After that, you can calculate the arithmetic mean of the numbers obtained. I got 301.2 - very similar to the expected number 300. This is how the distribution of the number of rolls of our death cube looks like:</font></font><br>
<br>
<pre><code class="python hljs">library(ggplot2)<font></font>
theme_set(theme_classic())<font></font>
<font></font>
g &lt;- ggplot(data.frame(infected_sizes=infected_sizes), aes(infected_sizes))<font></font>
g + geom_density(alpha=<span class="hljs-number">0.8</span>,fill=<span class="hljs-string">"plum"</span>)
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/17f/eac/604/17feac604d1a227c82de8ee6e5f672c0.jpg" alt="image"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here it is - a negative binomial distribution, please love and favor. Based on such data, it is possible to give approximate answers to questions - what is the probability that the total number of cases is less than fifty (1.2%) or more than 1000 (0.3%). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Of course, these are just estimates. They are based on data that may be incorrect. We do not know about the true mortality of the coronavirus. But the lower this mortality rate, the more cases of disease occur in one deceased and the greater the estimate of the extent of the pandemic.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let me remind you that we roll this die instantly. To the model of calculating mortality, which was used in the sensational article by Thomas Pueyo, I have a small complaint. There, we assume that, based on the 3 deaths on day X, a mortality rate of 1% and the knowledge that the average time between infection and death is 17 days, 300 people were infected on day X-17. However, such a calculation is valid only if the number of sick people is the same every day. Since 17 days is not a strict number, it also has confidence intervals and errors. If we have a rapid increase in the number of cases, then among those who died on day X, we have a certain number of people infected not 17 days ago, but 16 or 15 days, and maybe 10 days ago. Perhaps there are even more of them than those who became infected 17 days ago. In this way,in a situation of a rapid increase in the number of cases, such a return calculation can lead to overestimated estimates of the prevalence of the disease. In general, everything is complicated.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS Thanks to Gregory Demin for a hint about the type of distribution.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en492606/index.html">Toolkit issues in large projects</a></li>
<li><a href="../en492608/index.html">Features delivery features in large projects</a></li>
<li><a href="../en492612/index.html">Decorative ceiling light Leek Celebrity</a></li>
<li><a href="../en492616/index.html">Packer, Terraform and Ansible: Kubernetes cluster deployment in an hour</a></li>
<li><a href="../en492622/index.html">‚ÄúHey bully, bring whiskey!‚Äù, Or About English words with Irish roots</a></li>
<li><a href="../en492632/index.html">Quarantined small business: panic is the enemy of reason</a></li>
<li><a href="../en492636/index.html">What does it mean to be effective?</a></li>
<li><a href="../en492638/index.html">Scaling a Redux app with ducks</a></li>
<li><a href="../en492642/index.html">Create a scalable and resilient architecture with dynamic microservices</a></li>
<li><a href="../en492652/index.html">Card game "Fool" on two M5Stack</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>