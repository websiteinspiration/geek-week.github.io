<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌐 🌋 😆 Utilisation de formats graphiques modernes dans les projets Web 📞 🛀🏿 🍵</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eddie Osmani, dans l'article «Le prix de JavaScript en 2018 », a exprimé une idée valable: le temps nécessaire pour traiter un script de 200 Ko et pou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Utilisation de formats graphiques modernes dans les projets Web</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/494710/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eddie Osmani, dans l'article «Le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prix de JavaScript en 2018</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> », a exprimé une idée valable: le temps nécessaire pour traiter un script de 200 Ko et pour traiter une image ayant la même taille varie considérablement. Le fait est que lors du traitement du code, le navigateur doit effectuer un travail plus poussé que pour préparer l'utilisation des images. Voici ce que l'article en dit:</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une image JPEG doit être décodée, tramée et affichée. Et le bundle JS est nécessaire, si nous le considérons de manière simplifiée, chargez, analysez, compilez, exécutez. En fait, le moteur doit résoudre d'autres problèmes dans le processus de traitement du code JS. En général, il convient de garder à l'esprit que beaucoup plus de ressources système sont consacrées au traitement du code JavaScript, dont la taille, en octets, est comparable à la taille d'autres matériaux.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ces mots ont été écrits en 2018, mais ils sont encore plus que justes. Certes, compte tenu de la situation actuelle, l'idée exprimée ici est perçue aujourd'hui un peu différemment.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/8f/9m/t0/8f9mt0mjuf4ivefgknhgl8ykpge.png"></a><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considérant qu'une pandémie a éclaté dans le monde maintenant, j'ai remarqué que ma connexion Internet est devenue instable. Heureusement, du fait qu'Internet est protégé par d'excellents spécialistes qui ne connaissent pas la fatigue, la plupart du World Wide Web fonctionne toujours bien. Mais sur Internet, quelque chose se passe définitivement. J'utilise une connexion à 100 Mbps, mais j'ai l'impression que je suis assis sur un modem 3G.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela apporte quelques modifications au raisonnement ci-dessus. Le fait est que nos appareils peuvent analyser et compiler JavaScript à la même vitesse qu'il y a quelques semaines. Mais les données transitent désormais plus lentement sur les réseaux. Par conséquent, pour le moment, il est extrêmement important de savoir combien de données représentant une certaine ressource sont transmises sur le réseau lorsque cette ressource est chargée. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et les sites ont généralement beaucoup plus de 200 Ko d'images. Une page avec plusieurs mégaoctets d'images est généralement le cas. De nombreux développeurs (et moi aussi!), En règle générale, ne pensent pas du tout à la taille des supports.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais ce qui est très bien, l'optimisation des images utilisées sur les pages Web n'est pas si difficile. </font><font style="vertical-align: inherit;">Dans cet article, nous expliquerons comment utiliser des formats graphiques modernes comme WebP. </font><font style="vertical-align: inherit;">Les images enregistrées dans de tels formats s'avèrent souvent 2 à 3 fois plus petites que celles pour lesquelles les anciens et anciens formats connus (comme JPG et PNG) sont utilisés par tout le monde. </font><font style="vertical-align: inherit;">L'utilisation de nouveaux formats peut sérieusement changer la situation pour le mieux.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aperçu général des formats graphiques modernes</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour améliorer le travail avec les graphiques Web, nous pouvons utiliser les trois formats suivants:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JPEG 2000 est un format qui est une version améliorée de JPG standard. </font><font style="vertical-align: inherit;">Ce format a été développé en 1997, principalement pour une utilisation au cinéma et en médecine. </font><font style="vertical-align: inherit;">Il vous permet de compresser des images plus fortes que JPEG, mais avec moins d'artefacts.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JPEG XR est un format lié à JPEG 2000. Il a été développé par Microsoft en 2009.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebP est un format créé par Google en 2010 pour le Web. </font><font style="vertical-align: inherit;">Le principal objectif de son développement était d'utiliser des méthodes avancées d'optimisation des images afin de réduire la taille des fichiers. </font><font style="vertical-align: inherit;">WebP prend en charge la transparence et même l'animation.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, nous parlerons principalement de WebP. </font><font style="vertical-align: inherit;">Formats liés au JPEG, nous verrons où se posera le problème de la compatibilité du navigateur.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Combien pouvez-vous gagner en utilisant des formats graphiques alternatifs?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a quelques mois, j'ai utilisé l'image suivante dans un matériau.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ebb/257/a61/ebb257a61229023d8aee7651708966c8.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'image utilisée dans un matériau</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
J'ai effectué quelques expériences, compte tenu de l'utilisation des formats JPG et PNG pour stocker l'image d'origine. </font><font style="vertical-align: inherit;">J'ai optimisé les options d'image en utilisant</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> imagemin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> afin de découvrir ce que WebP peut me donner à la place de ces formats «rétro». </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les résultats ont été incroyables.</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Caractéristiques de l'image</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Original</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Webp</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fichier .Png (depuis Photoshop)</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">742 Kb</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">61 Ko! </font><font style="vertical-align: inherit;">(92% de moins)</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fichier .png optimisé (après Imagemin)</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">178 Ko</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">58 Ko! </font><font style="vertical-align: inherit;">(67% de moins)</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fichier au format .jpg (depuis Photoshop)</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">242 Kb</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50 Ko! </font><font style="vertical-align: inherit;">(79% de moins)</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fichier optimisé au format .jpg (après imagemin)</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">151 Ko</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50 Ko! </font><font style="vertical-align: inherit;">(67% de moins)</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai mené des expériences similaires avec de nombreuses images. </font><font style="vertical-align: inherit;">Il s'est avéré presque toujours que les fichiers WebP étaient 30 à 70% plus petits que les versions même optimisées de fichiers graphiques d'autres formats. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela peut soulever la question de savoir comment la conversion en WebP peut affecter les images SVG. </font><font style="vertical-align: inherit;">Je n'ai pas mené de telles expériences avec SVG. </font><font style="vertical-align: inherit;">SVG est un format vectoriel. </font><font style="vertical-align: inherit;">Cela signifie que les images qu'il contient sont construites sur la base d'instructions mathématiques et non sur la base d'informations sur la couleur des pixels individuels. </font><font style="vertical-align: inherit;">Convertir une image SVG en WebP signifie abandonner la possibilité de mettre à l'échelle des images SVG, ce qui, je crois, est inacceptable. </font><font style="vertical-align: inherit;">De plus, je soupçonne qu'une telle conversion, dans la plupart des cas, entraînera une augmentation de la taille des fichiers.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compatibilité du navigateur</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour en savoir plus sur la prise en charge de certains formats graphiques par les navigateurs, consultez </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caniuse.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le format WebP est pris en charge par la plupart des navigateurs.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b8d/e47/094/b8de470941379e70ba194f35566deb05.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prise en charge du format WebP par les navigateurs</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Bien que le niveau de prise en charge de ce format soit très élevé, il est très regrettable que Safari et Internet Explorer ne le prennent pas en charge. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et voici des informations sur la prise en charge de JPEG 2000.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f50/5b6/1e3/f505b61e34cd89c8e5ae6c336396f5ee.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prise en charge du format JPEG 2000 par les navigateurs</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Donc, maintenant Safari est de notre côté, mais Internet Explorer est à nouveau sans travail. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qu'en est-il du JPEG XR?</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c39/c5c/ba1/c39c5cba1bb76927dee034cd17a893e6.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prise en charge du format JPEG XR par les navigateurs</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Et ici, Internet Explorer a été distingué. </font><font style="vertical-align: inherit;">Par conséquent, en utilisant ces trois formats, nous chevauchons tous les navigateurs existants (le navigateur KaiOS ne prend en charge aucun de ces formats, et je m'excuse auprès de lui de l'ignorer, mais je ne sais même pas de quel navigateur il s'agit. ) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parlons maintenant de la façon de choisir différents formats d'image conçus pour différents navigateurs.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'élément d'image à la rescousse</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HTML a deux éléments pour produire des images. Le premier peut être comparé à une pop star internationale comme Madonna. Ça l'est </font></font><code>img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Et le second est comme un nouveau groupe, connu uniquement dans les cercles étroits des mélomanes. Ceci est un élément </font></font><code>picture</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'élément </font></font><code>picture</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est apparu en HTML beaucoup plus tard que </font></font><code>img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. L'objectif principal de ce nouvel élément est de permettre aux développeurs de télécharger diverses ressources graphiques en fonction de la résolution de l'écran ou selon que le navigateur prend en charge un certain format graphique. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici à quoi ressemble le code HTML qui utilise l'élément </font></font><code>picture</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">picture</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"/images/cereal-box.webp"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"image/webp"</span> /&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"/images/cereal-box.jp2"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"image/jp2"</span> /&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/images/cereal-box.jxr"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"image/vnd.ms-photo"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">picture</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un élément </font></font><code>picture</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peut comprendre plusieurs éléments enfants </font></font><code>source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et un élément </font></font><code>img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Le navigateur analyse séquentielle de </font><font style="vertical-align: inherit;">ces éléments, la </font><font style="vertical-align: inherit;">sélection, basée sur l'attribut </font></font><code>type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(s </font></font><code>media</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), l' </font><font style="vertical-align: inherit;">un d'entre eux qui peuvent l' </font><font style="vertical-align: inherit;">utiliser. Lorsqu'un tel élément est trouvé, le navigateur recherche l'adresse de l'image à l'aide de l'attribut </font></font><code>srcset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, puis affiche cette image à l'aide de l'élément </font></font><code>img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'attribut </font></font><code>srcset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a des capacités beaucoup plus grandes que l'habituel </font></font><code>src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais, heureusement, nous pouvons le considérer comme un analogue </font></font><code>src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. En général, les éléments </font></font><code>source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sont quelque chose comme des paramètres qui correspondent à différentes images. L' </font></font><code>img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image qui correspond le mieux à l'environnement dans lequel la page est affichée est incluse.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans Chrome, par exemple, après avoir traité le balisage ci-dessus, le navigateur arrivera à quelque chose de plus ou moins équivalent au code suivant:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">picture</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/images/cereal-box.webp"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">picture</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'utilisation d'un ensemble d'éléments consécutifs </font></font><code>source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">signifie qu'au moins l'un d'entre eux conviendra à chaque navigateur. </font><font style="vertical-align: inherit;">Ainsi, la plupart des navigateurs utilisent une image webp, Safari chargera une image jp2, IE une image jxr. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il convient de rappeler qu'Internet Explorer ne prend pas en charge l'élément </font></font><code>picture</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Cet élément est trop nouveau pour ce navigateur. </font><font style="vertical-align: inherit;">Mais, malgré cela, le fragment de balisage ci-dessus dans IE fonctionnera comme prévu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le fait est que lorsque le navigateur tombe sur un élément qui lui est inconnu, il le considère comme un élément </font></font><code>div</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Par conséquent, lors de l'analyse de notre code, IE voit de nombreux éléments </font></font><code>div</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ainsi qu'une balise</font></font><code>&lt;img&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui contient le chemin d'accès à l'image jxr. </font><font style="vertical-align: inherit;">Et il se trouve que c'est le format même qu'Internet Explorer prend en charge.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alternative simplifiée</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le fragment de code ci-dessus est extrêmement bon car il vous permet d'utiliser des formats graphiques modernes dans tous les navigateurs actuels. </font><font style="vertical-align: inherit;">Mais l'utilisation d'un tel code est basée sur l'hypothèse de l'existence des images auxquelles il a des liens. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous créez vous-même de telles images, vous devez y investir beaucoup de travail manuel. </font><font style="vertical-align: inherit;">Si vous les générez automatiquement, cela peut augmenter considérablement le temps de génération du projet. </font><font style="vertical-align: inherit;">Le traitement graphique, comme vous le savez, devient un processus très lent pour beaucoup d'images.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seuls très peu de visiteurs de mon blog utilisent Internet Explorer (au cours des 7 derniers jours, seules 3 personnes avec IE ont essayé de le consulter, ce qui représentait 0,02% du trafic). </font><font style="vertical-align: inherit;">Par conséquent, j'ai décidé d'utiliser une version simplifiée de la solution ci-dessus:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">picture</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"/images/cereal-box.webp"</span> /&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/images/cereal-box.jpg"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">picture</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je donne une image webp compacte aux navigateurs qui prennent en charge ce format (Chrome, Firefox, Edge) et aux navigateurs qui ne prennent pas en charge ce format (IE, Safari), j'offre un héritage du passé - une image jpeg. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De mon point de vue, c'est un exemple d'amélioration progressive. </font><font style="vertical-align: inherit;">Le projet reste opérationnel sur les anciens navigateurs, bien que le chargement des images prenne plus de temps. </font><font style="vertical-align: inherit;">C'est un compromis qui me convient. </font><font style="vertical-align: inherit;">(Certes, j'espère que le support WebP apparaîtra bientôt dans les navigateurs d'Apple également).</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vérification de l'intégrité de la solution</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les outils de développement supposeront toujours que l'image contient ce qui a été écrit à l'origine dans l'attribut </font></font><code>src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tag </font></font><code>img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Si vous cochez l'élément à l'aide de l'onglet </font></font><code>Elements</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, vous pouvez voir que la page utilise une image jpg. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de vérifier l'opérabilité de tout cela, il est préférable, comme il me semble, de cliquer avec le bouton droit sur l'image et de sélectionner l'élément </font></font><code>  …</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans Chrome lorsque la commande est exécutée, le système devrait proposer d'enregistrer le fichier avec l'extension </font></font><code>.webp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mais dans Safari, ce sera un fichier jpeg. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de savoir exactement quel fichier graphique a été reçu du serveur lors du chargement de la page, vous pouvez vous référer à la barre d'outils du développeur </font></font><code>Network</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Convertir des fichiers image au format WebP</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Google a créé un ensemble d'outils destinés à travailler avec des fichiers webp. </font><font style="vertical-align: inherit;">Un tel outil est appelé </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cwebp</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Il vous permet de convertir des fichiers graphiques d'autres formats en WebP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous utilisez MacOS, vous pouvez installer cette boîte à outils à l'aide de Homebrew:</font></font><br>
<br>
<pre><code class="plaintext hljs">brew install webp
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur d'autres plates-formes, je pense qu'il sera nécessaire de télécharger le </font><font style="vertical-align: inherit;">package </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libwebp</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> approprié à </font><font style="vertical-align: inherit;">partir du référentiel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir installé les outils, vous pouvez les utiliser comme ceci:</font></font><br>
<br>
<pre><code class="plaintext hljs">cwebp -q 80 cereal.png -o cereal.webp
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considérez cette commande:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le drapeau </font></font><code>-q 80</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vous permet de définir la qualité d'image. </font><font style="vertical-align: inherit;">Sa valeur varie de 1 (pire qualité) à 100 (meilleure). </font><font style="vertical-align: inherit;">Vous pouvez expérimenter avec différentes valeurs. </font><font style="vertical-align: inherit;">J'ai découvert qu'il valait mieux demander quelque chose dans la région 70-80.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le nom du fichier </font></font><code>cereal.jpg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est l'image d'origine qui doit être convertie en webp.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La construction </font></font><code>-o cereal.webp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">définit le chemin d'accès au fichier de sortie.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Personne ne veut perdre du temps à taper ces commandes manuellement. </font><font style="vertical-align: inherit;">Heureusement, cette tâche peut être automatisée.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilisation de formats d'image modernes dans les applications React</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un composant est un excellent moyen d'ignorer certaines des bizarreries de l'élément </font></font><code>&lt;picture&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">J'utilise des composants React pour cela. </font><font style="vertical-align: inherit;">À mon avis, c'est très pratique. </font><font style="vertical-align: inherit;">Voici à quoi ça ressemble:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> ImgWithFallback = ({<font></font>
&nbsp;&nbsp;src,<font></font>
&nbsp;&nbsp;fallback,<font></font>
&nbsp;&nbsp;type = <span class="hljs-string">'image/webp'</span>,<font></font>
&nbsp;&nbsp;...delegated<font></font>
}) =&gt; {<font></font>
&nbsp;&nbsp;<span class="hljs-keyword">return</span> (
&nbsp;&nbsp;&nbsp;&nbsp;<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">picture</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">srcSet</span>=<span class="hljs-string">{src}</span> <span class="hljs-attr">type</span>=<span class="hljs-string">{type}</span> /&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{fallback}</span> {<span class="hljs-attr">...delegated</span>} /&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">picture</span>&gt;</span></span><font></font>
&nbsp;&nbsp;);<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'utilisation du composant est </font></font><code>ImgWithFallback</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">très similaire à l'utilisation d'une balise standard </font></font><code>img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;ImgWithFallback<font></font>
&nbsp;&nbsp;src=<span class="hljs-string">"/images/cereal.webp"</span>
&nbsp;&nbsp;fallback=<span class="hljs-string">"/images/cereal.png"</span>
&nbsp;&nbsp;alt=<span class="hljs-string">"A photo showing the expiration date on a box of Lucky Charms"</span><font></font>
/&gt;<font></font>
</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'utilisation de formats graphiques modernes avec des composants stylisés</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous utilisez des bibliothèques </font></font><code>styled-components</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou </font></font><code>emotion</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si vous êtes habitué à la conception d'images spéciales:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> FancyImg = styled.img<span class="hljs-string">`
&nbsp;&nbsp;whatever: stuff;
`</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La très bonne chose est que cela fonctionne avec notre composant </font></font><code>ImgWithFallback</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Vous pouvez l'envelopper dans le wrapper approprié comme n'importe quel autre composant:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> FancyImg = styled(ImgWithFallback)<span class="hljs-string">`
&nbsp;&nbsp;whatever: stuff;
`</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La raison de l'opérabilité de cette conception est le fonctionnement exact de la structure auxiliaire </font></font><code>styled</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Il génère une classe et l'intègre dans la feuille de style du document. </font><font style="vertical-align: inherit;">Ensuite, le nom de la classe générée est transmis au composant en tant que propriété:</font></font><br>
<br>
<pre><code class="css hljs">&lt;<span class="hljs-selector-tag">ImgWithFallback</span> <span class="hljs-selector-tag">className</span>="<span class="hljs-selector-tag">sc-some-generated-thing</span>" /&gt;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous déléguons toutes les propriétés à la balise enfant </font></font><code>&lt;img&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, en conséquence, les styles corrects sont appliqués à l'image, comme cela se produit généralement. </font><font style="vertical-align: inherit;">Tout fonctionne exactement comme vous pouvez vous y attendre.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilisation du package gatsby-image</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous utilisez Gatsby, sachez que le package </font></font><code>gatsby-image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, lorsqu'il est utilisé normalement, utilise déjà de nombreuses optimisations d'image. </font><font style="vertical-align: inherit;">Cela comprend la conversion d'images au format Webp (bien que, pour cela, vous devez activer l'option appropriée). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le colis </font></font><code>gatsby-image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne prétend pas être un remplacement </font></font><code>img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Son utilisation n'est peut-être pas si simple, ses mécanismes internes peuvent conduire à des surprises qui rendent la vie difficile au développeur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous êtes intéressé par ce package, jetez un œil à sa </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inconvénients de WebP</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le seul véritable inconvénient de webp que j'ai réussi à trouver est qu'il est très gênant de travailler avec des fichiers de ce format. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La plupart des packages d'images de bureau ne le prennent pas encore en charge. </font><font style="vertical-align: inherit;">Par exemple, je ne peux pas ouvrir les fichiers webp dans Aperçu sur MacOS. </font><font style="vertical-align: inherit;">Cela signifie, disons que si j'enregistre une image webp à partir d'une page web, je ne pourrai pas la visualiser sur mon ordinateur! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La conversion des fichiers webp en fichiers jpeg est un processus assez simple. </font><font style="vertical-align: inherit;">Sur Internet, vous pouvez trouver de nombreux services gratuits qui effectuent une telle conversion. </font><font style="vertical-align: inherit;">Mais, encore une fois, ce n'est pas aussi pratique que de travailler avec des formats graphiques traditionnels. </font><font style="vertical-align: inherit;">Si votre site propose aux utilisateurs de télécharger des fichiers graphiques à partir de celui-ci, vous pouvez décider que vous n'avez pas besoin de passer à webp.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sommaire</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'aime beaucoup le fait qu'en utilisant webp, j'ai pu réduire la taille des images sur mon blog d'environ 50%. En plus du fait que dans nos moments difficiles, cela améliore l'expérience utilisateur de travailler avec lui, j'espère également que cela me permettra d'économiser un peu sur le paiement du trafic. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien sûr, l'idée de convertir manuellement les fichiers image au format webp semble assez peu pratique. J'étudie déjà la question de savoir comment convertir automatiquement les fichiers jpg et png dans ce format. Idéalement, ce processus devrait se passer complètement inaperçu par le développeur, lors de l'assemblage du site.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les créateurs de projets Web ne sont généralement pas particulièrement intéressés par les fonctionnalités de l'utilisation de nouveaux formats d'image. </font><font style="vertical-align: inherit;">Mais je pense que la compréhension de cette question est très utile. </font><font style="vertical-align: inherit;">Après tout, l'utilisation de WebP est probablement le moyen le plus simple de réduire la taille de votre projet Web de centaines de kilo-octets. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chers lecteurs! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilisez-vous le format WebP?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/iq/fi/b4/iqfib45pgphfrxv--zfemt0qnmw.jpeg"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr494690/index.html">Intelligence artificielle vs coronavirus</a></li>
<li><a href="../fr494692/index.html">Injections indolores avec des aiguilles 4D</a></li>
<li><a href="../fr494700/index.html">Scénarios d'infection dans des villes spécifiques sur la base de l'ensemble de données sur les mouvements de personnes à travers la Russie</a></li>
<li><a href="../fr494702/index.html">Le condensé de matières fraîches du monde du front-end de la dernière semaine n ° 408 (23-29 mars 2020)</a></li>
<li><a href="../fr494704/index.html">CMI5, ou la vie après SCORM</a></li>
<li><a href="../fr494712/index.html">5 bonnes pratiques d'utilisation des hameçons React en production</a></li>
<li><a href="../fr494714/index.html">Sur l'impact positif des polices variables sur les performances des projets Web</a></li>
<li><a href="../fr494716/index.html">Tout sur le mot-clé auto en CSS</a></li>
<li><a href="../fr494718/index.html">Nouvelles du monde d'OpenStreetMap n ° 504 (10.03.2020-16.03.2020)</a></li>
<li><a href="../fr494720/index.html">Ma feuille de triche par pandas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>