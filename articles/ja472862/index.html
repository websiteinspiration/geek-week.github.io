<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎁 ⛑️ 🛃 カスケードキャッシュの無効化。パート2 👨🏾‍🚀 👂🏻 👨🏽‍🎓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="最初の部分のキャッシュの無効化をカスケードに専念材料の翻訳は、我々は問題の性質を議論し、インポートのカードを使用して構成され、それを解決するためのオプションのいずれかを検討しました。そのプラスは、実装の容易さです。そしてマイナス-貧弱なブラウザのサポート。今日は、この問題を解決する他の方法についてお...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>カスケードキャッシュの無効化。パート2</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/472862/"><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初の部分</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のキャッシュの無効化をカスケードに専念材料の翻訳は、我々は問題の性質を議論し、インポートのカードを使用して構成され、それを解決するためのオプションのいずれかを検討しました。</font><font style="vertical-align: inherit;">そのプラスは、実装の容易さです。</font><font style="vertical-align: inherit;">そしてマイナス-貧弱なブラウザのサポート。</font><font style="vertical-align: inherit;">今日は、この問題を解決する他の方法についてお話します。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/ft/lh/jx/ftlhjxkkxoeswh7akykdb6fcfoq.jpeg"></a><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプローチ2：サービスワーカー</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
問題の2番目の解決策は、Service Workerを使用してインポートカードの機能を再現することです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、Service Workerを使用する</font></font><code>fetch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と、インポートカードのキーに対応するアドレスにある資料をダウンロードすることを目的とした</font><font style="vertical-align: inherit;">イベント</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">リッスンできます</font><font style="vertical-align: inherit;">。これらのリクエストを実行することにより、名前にコンテンツのハッシュが含まれるファイルをアップロードできます。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> importMap = {
&nbsp;&nbsp;<span class="hljs-string">'/main.mjs'</span>: <span class="hljs-string">'/main-1a2b.mjs'</span>,
&nbsp;&nbsp;<span class="hljs-string">'/dep1.mjs'</span>: <span class="hljs-string">'/dep1-b2c3.mjs'</span>,
&nbsp;&nbsp;<span class="hljs-string">'/dep2.mjs'</span>: <span class="hljs-string">'/dep2-3c4d.mjs'</span>,
&nbsp;&nbsp;<span class="hljs-string">'/dep3.mjs'</span>: <span class="hljs-string">'/dep3-d4e5.mjs'</span>,
&nbsp;&nbsp;<span class="hljs-string">'/vendor.mjs'</span>: <span class="hljs-string">'/vendor-5e6f.mjs'</span>,<font></font>
};<font></font>
<font></font>
addEventListener(<span class="hljs-string">'fetch'</span>, (event) =&gt; {
&nbsp;&nbsp;<span class="hljs-keyword">const</span> oldPath = <span class="hljs-keyword">new</span> URL(event.request.url, location).pathname;
&nbsp;&nbsp;<span class="hljs-keyword">if</span> (importMap.hasOwnProperty(oldPath)) {
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> newPath = importMap[oldPath];<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;event.respondWith(fetch(<span class="hljs-keyword">new</span> Request(newPath, event.request)));<font></font>
&nbsp;&nbsp;}<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、上記のコードはService Workerであることを考慮すると、このコードはService Workerがインストールされてアクティブ化された後にのみ機能することを理解する必要があります。これは、サイトが初めて読み込まれたときに、名前にハッシュのないファイルが要求されることを意味します。名前にハッシュが含まれるファイルは、以降のサイトのダウンロード時に要求されます。言い換えれば、ここでは各ファイルの二重ロードを処理しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを考慮すると、サービスワーカーはキャッシュの無効化のカスケードの問題に対する適切な解決策ではないように思えるかもしれません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、ここでは、キャッシュに対する長年のアプローチを簡単に批判できるようにお願いします。 Service Workerコードにハッシュ情報を入力する代わりに、ファイル名でコンテンツハッシュの使用を停止した場合にどうなるかを考えてみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、</font><font style="vertical-align: inherit;">リソースをプリキャッシュするワーク</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ボックスの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ようなツールが機能する方法</font><font style="vertical-align: inherit;">です。これらは、アセンブリから各ファイルの内容のハッシュを生成し、ファイル名の対応をService Workerに保存します（外部のインポートカードのようなものになります）。さらに、Service Workerの最初のインストール時にリソースをキャッシュ</font></font><code>fetch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">し、インポートカード内のアドレスに対応するアドレスのリクエストに応じてキャッシュファイルを送信</font><font style="vertical-align: inherit;">するイベントリスナー</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">追加</font><font style="vertical-align: inherit;">します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンテンツのバージョンに関する情報が含まれていないファイルをクライアントが受信するという考えは恐ろしいように見えるかもしれません（そして、あなたが教えたことすべてに矛盾しています）が、対応するリソースをダウンロードする要求は、Service Workerがインストールされている場合にのみ実行されます。そのようなリソースをダウンロードするためのそれ以上の要求は、</font><font style="vertical-align: inherit;">（キャッシュヘッダーを使用しない）</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cache Storage API</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を経由</font><font style="vertical-align: inherit;">し、サーバーへの新しい要求は、Service Workerの新しいバージョンがデプロイされている場合にのみ実行されます（とにかくこれらのファイルの新しいバージョンが必要です）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、Service Workerを更新せずに新しいバージョンのモジュールのデプロイを開始するまで（これは絶対にお勧めできません）、競合やバージョンの不一致が発生することはありません。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ワークボックス</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
事前キャッシュ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライブラリ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用してファイルの予備キャッシュを整理</font></font><code>precacheAndRoute()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">する</font><font style="vertical-align: inherit;">には</font><font style="vertical-align: inherit;">、これらのファイルのバージョンに関する情報を含むファイルアドレスと文字列を</font><font style="vertical-align: inherit;">このライブラリのメソッドに渡し</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> {preacacheAndRoute} <span class="hljs-keyword">from</span> <span class="hljs-string">'workbox-precaching'</span>;<font></font>
<font></font>
precacheAndRoute([<font></font>
&nbsp;&nbsp;{<span class="hljs-attr">url</span>: <span class="hljs-string">'/main.mjs'</span>, <span class="hljs-attr">revision</span>: <span class="hljs-string">'1a2b'</span>},<font></font>
&nbsp;&nbsp;{<span class="hljs-attr">url</span>: <span class="hljs-string">'/dep1.mjs'</span>, <span class="hljs-attr">revision</span>: <span class="hljs-string">'b2c3'</span>},<font></font>
&nbsp;&nbsp;{<span class="hljs-attr">url</span>: <span class="hljs-string">'/dep2.mjs'</span>, <span class="hljs-attr">revision</span>: <span class="hljs-string">'3c4d'</span>},<font></font>
&nbsp;&nbsp;{<span class="hljs-attr">url</span>: <span class="hljs-string">'/dep3.mjs'</span>, <span class="hljs-attr">revision</span>: <span class="hljs-string">'d4e5'</span>},<font></font>
&nbsp;&nbsp;{<span class="hljs-attr">url</span>: <span class="hljs-string">'/vendor.mjs'</span>, <span class="hljs-attr">revision</span>: <span class="hljs-string">'5e6f'</span>},<font></font>
]);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
バージョンを含む行を正確に生成する方法は、開発者自身が決定します。</font><font style="vertical-align: inherit;">ただし、自分で作成したくない場合は、事前キャッシュマニフェストを生成するタスクにより、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">workbox-build</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">workbox-cli、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">workbox-webpack-pluginパッケージを簡略化できます</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（すべてのService Workerコードを生成することもできます）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デモ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクトには、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロールアップアプリケーション</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（を使用</font></font><code>workbox-cli</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）および</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Webpackアプリケーション</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（を使用</font></font><code>workbox-webpack-plugin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）で</font><font style="vertical-align: inherit;">Service Workerを使用して予備キャッシュを実装する例があり</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプローチ3：リソースをロードするためのカスタムスクリプト</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サイトにインポートカードまたはサービスワーカーを使用する機能がない場合、問題を解決するための3番目のアプローチを次に示します。これは、リソースをロードするための独自のスクリプトを使用して、インポートカードの機能を実装することです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AMDスタイルのモジュールローダー（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SystemJS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">や</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RequireJSなど</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）に</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">慣れ</font></a><font style="vertical-align: inherit;">ている場合は、これらのモジュールローダーが通常モジュールエイリアスをサポートしていることもご存知でしょう。実際、SystemJS </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インポートマップ構文を使用</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">した</font></a><font style="vertical-align: inherit;">エイリアス</font><font style="vertical-align: inherit;">を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">サポートしてい</font></a><font style="vertical-align: inherit;">ます。その結果、私たちの問題は、このソリューションが未来志向になるように（さらに、既存のすべてのブラウザーで機能するように）簡単に解決されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロールアップを使用する場合、オプションを設定できます</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">output.format</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">からvalueに</font></font><code>system</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">この場合、アプリケーションのインポートマップの作成は、カスケードキャッシュの無効化の問題を解決する最初のアプローチの説明で説明したのと同じ方法で実行されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私のデモアプリケーションには、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rollupを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用してSystemJSに適した形式でマテリアルを構築し、ファイルのハッシュバージョンをダウンロードするためのインポートマップを作成</font><font style="vertical-align: inherit;">するサンプルサイトが</font><font style="vertical-align: inherit;">あります。</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍Webpackとスクリプトを使用したリソースの読み込み</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Webpackは、独自のスクリプトを使用してリソースをロードすることもできますが、Webpackによって生成されるブートローダーは、従来のAMDローダーとは異なり、特定のバンドルごとに固有です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアプローチの利点は、Webpackランタイムがフラグメントの名前/識別子とそのアドレスの間に独自のマッピングを含めることができる（そして実際に機能する）ことです（これは私がここで推奨するものと同様です）。つまり、コード分割を使用するWebpackバンドルは、カスケードキャッシュの無効化の影響を受ける可能性が低くなります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際のところ、webpackユーザーにとっての朗報は、webpackを使用してプロジェクトビルドを正しく構成した場合（</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">マニュアルで</font></a><font style="vertical-align: inherit;">説明されているように、コードをフラグメントに分割することにより）です。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次に、個々のモジュールのコードを変更すると、3つ以上のフラグメントが無効になることはありません（1つは変更されたモジュールを含むフラグメント、2つ目はランタイムを含むフラグメントです）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、私はwebpackを使用してプロジェクトを構築する人たちにいくつか悪いニュースがあります。事実、このバンドラーの内部マッピングシステムは非標準です。これは、既存のツールと統合できず、ユーザーが構成できないことを意味します。たとえば、出力ファイルを個別に生成して（つまり、問題を解決するための最初のアプローチに関するストーリーで説明されているように）、独自のハッシュをマッピングに含めることはできません。そして、これはマイナスのwebpackです。これは、このバンドラーが使用するハッシュ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">が出力ファイルの内容に</font></a><font style="vertical-align: inherit;">基づい</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ていないためです。</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ただしソースファイルの内容とアセンブリ構成について。</font><font style="vertical-align: inherit;">そして、これは小さな微妙なエラーにつながる可能性があります（たとえば- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -このようなエラーに関するメッセージ）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
webpackを使用して、Service Workerも使用するアプリケーションを構築する場合は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">workbox-webpack-pluginプラグイン</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">とキャッシング戦略</font><font style="vertical-align: inherit;">を使用することをお勧めし</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。これは、問題を解決するための2番目のアプローチで説明されています。</font><font style="vertical-align: inherit;">プラグインは、webpackの出力内容に基づいてハッシュを生成します。つまり、上記のエラーについて心配する必要はありません。</font><font style="vertical-align: inherit;">これに加えて、ハッシュのないファイル名を操作する方が、ハッシュのある名前を操作するよりも簡単です。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その他のWebプロジェクトリソース</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前に、プログラムコードを含む「ハッシュされた」ファイル名を使用してJavaScriptプログラムで作業すると、カスケードキャッシュの無効化がどのように発生するかについて説明しました。しかし、この問題は他のWebプロジェクト資料にも当てはまります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのため、CSSおよびSVGファイルは、他のリソース（画像など）を参照することが多く、その名前には、対応するファイルのバージョンに関する情報がハッシュ形式で含まれている場合があります。 JSファイルの場合と同様に、類似したリソースの名前の変更によって引き起こされるキャッシュのカスケード無効化の問題を解決するには、インポートカードまたはService Workerを使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
画像や動画ファイルなどのリソースの場合、これで問題は発生しません。ここでは既存の推奨事項がすべて適用されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで重要なことは、ファイルAがファイルBをダウンロードし、さらにその内容のハッシュとしてファイルBのバージョンに関する情報を含む場合、ファイルBのキャッシュを無効にすると、ファイルAのキャッシュも無効になることを常に覚えておくことです。リソースの使用方法は構成が異なりますが、この資料に記載されているアドバイスは無視してください。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">概要</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事があなたのサイトを詳しく見て、キャッシュのカスケード無効化の問題がそれに影響を与えるかどうかを知るきっかけになったと思います。これを確認する最も簡単な方法は、サイトをアセンブルし、多くのモジュールによってインポートされたファイルの1行のコードを変更してから、サイトを再構築することです。アセンブリの結果が格納されているディレクトリ内で、複数のファイルの名前が変更されている場合、これは、目の前にカスケードキャッシュ無効化の兆候があることを意味します。その場合は、プロジェクトでこの問題を解決するために、ここで説明するアプローチの1つを使用することを検討する必要があるかもしれません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何を選ぶべきかについて話す場合、率直に言って、それは多くに依存します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インポートカードがブラウザで広くサポートされるようになると、カスケードキャッシュの無効化に対処する最も単純で最も完璧な方法に直面します。しかし、そのようなサポートが利用可能になるまで、このメカニズムは実際には適用できません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Service Workerを既に使用している場合、特にWorkboxを使用している場合は、ここで説明する問題を解決するための2番目のアプローチをお勧めします。</font><font style="vertical-align: inherit;">この資料のオリジナルが公開されて</font><font style="vertical-align: inherit;">いる</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイト</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">では、リソースの予備キャッシュのタスクはこの方法で解決されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、サービスワーカーは、本番環境で</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">JavaScriptモジュール</font></a><font style="vertical-align: inherit;">を使用する人にとっての唯一の選択肢です。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 （そして、私のユーザーの98％がService WorkerとJSモジュールの両方をサポートするブラウザーを持っていることを考えると、このオプションを選択するのは難しくありませんでした）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Service Workerが適切でない場合は、ここで説明した3番目のアプローチ（SystemJSの使用を含む）をお勧めします。このアプローチは、将来に焦点を当てた、ブートローダースクリプトに基づく他のアプローチよりも優れています。それから、すべてのブラウザでサポートが表示されるときに、インポートカードに切り替えるのは簡単です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
生産性について話す場合、最適化の方向の選択は特定のプロジェクトごとに異なります。パフォーマンスを最適化する前に、パフォーマンスを測定し、問題があるかどうか、および問題に対処するかどうかを決定することが重要です。新しいプロジェクトリリースを頻繁にリリースせず、プロジェクトに加えられた変更が通常非常に大規模である場合、キャッシュ無効化のカスケードの問題は関係がない可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一方、小さなプロジェクト変更を頻繁にデプロイする場合、リピーターはキャッシュに既に存在する大量のコードをロードする問題に直面する可能性があります。この問題を解決すると、そのようなユーザーのページ読み込みパフォーマンスが大幅に向上します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">読者の皆様！</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスケードキャッシュの無効化はプロジェクトに影響しますか？</font><font style="vertical-align: inherit;">もしそうなら、それをどのように解決する予定か教えてください。&nbsp;</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/-o/2e/tu/-o2etuqogwhmdnmysb9_vivc9v4.png"></div></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja472852/index.html">GitLabはクラウドおよび商用製品のユーザーのために変更を加えます</a></li>
<li><a href="../ja472854/index.html">Unity UIプロファイリング：誰が私のバッチ処理を台無しにするか？</a></li>
<li><a href="../ja472856/index.html">テーブルとスティックから品質管理サービスを作成する方法</a></li>
<li><a href="../ja472858/index.html">Pythonおよび高速HTTPクライアント</a></li>
<li><a href="../ja472860/index.html">カスケードキャッシュの無効化。パート1</a></li>
<li><a href="../ja472864/index.html">チェックポイント：CPUとRAMの最適化</a></li>
<li><a href="../ja472866/index.html">安定したコミュニケーションのためのタリスマン</a></li>
<li><a href="../ja472868/index.html">電話サーバー管理：RUVDSモバイルクライアント</a></li>
<li><a href="../ja472870/index.html">アジャイルがアーキテクチャと開発ツールを変換せずに停止する理由-カンファレンスプレゼンテーション</a></li>
<li><a href="../ja472872/index.html">文化を失うことなくスタートアップを50人の従業員に増やす方法</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>