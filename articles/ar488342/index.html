<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฉ๐ฝโ๐ซ ๐ฉ๐พโ๐ญ ๐ฃ๐ฟ Random Forest ุ ุทุฑููุฉ ุงูููููุงุช ุงูุฑุฆูุณูุฉ ูุชุญุณูู ุงููุนููุงุช ุงูููุฑุทุฉ: ูุซุงู ุนูู ุญู ูุดููุฉ ุงูุชุตููู ูู Python ๐ โ๏ธ ๐๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุฏู ูุชุฎุตุตู ูุนุงูุฌุฉ ุงูุจูุงูุงุช ูุชุญููููุง ุงูุนุฏูุฏ ูู ุงูุฃุฏูุงุช ูุฅูุดุงุก ููุงุฐุฌ ุงูุชุตููู. ูุงุญุฏุฉ ูู ุฃูุซุฑ ุงูุทุฑู ุดุนุจูุฉ ูููุซููุฉ ูุชุทููุฑ ูุซู ูุฐู ุงูููุงุฐุฌ ูู ุงุณุชุฎุฏุงู ุฎูุงุฑุฒู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Random Forest ุ ุทุฑููุฉ ุงูููููุงุช ุงูุฑุฆูุณูุฉ ูุชุญุณูู ุงููุนููุงุช ุงูููุฑุทุฉ: ูุซุงู ุนูู ุญู ูุดููุฉ ุงูุชุตููู ูู Python</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/488342/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฏู ูุชุฎุตุตู ูุนุงูุฌุฉ ุงูุจูุงูุงุช ูุชุญููููุง ุงูุนุฏูุฏ ูู ุงูุฃุฏูุงุช ูุฅูุดุงุก ููุงุฐุฌ ุงูุชุตููู. </font><font style="vertical-align: inherit;">ูุงุญุฏุฉ ูู ุฃูุซุฑ ุงูุทุฑู ุดุนุจูุฉ ูููุซููุฉ ูุชุทููุฑ ูุซู ูุฐู ุงูููุงุฐุฌ ูู ุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ Random Forest (RF). </font><font style="vertical-align: inherit;">ูู ุฃุฌู ูุญุงููุฉ ุชุญุณูู ุฃุฏุงุก ูููุฐุฌ ุชู ุฅูุดุงุคู ุจุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RF</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ููููู ุงุณุชุฎุฏุงู ุฃูุซููุฉ ุงููุนููุฉ ุงููุงุฆูุฉ ููููุฏูู ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hyperparameter Tuning</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ HT). </font><font style="vertical-align: inherit;">
ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ููุงู ููุฌ ูุงุณุน ุงูุงูุชุดุงุฑ ูุชู ูู ุฎูุงูู ูุนุงูุฌุฉ ุงูุจูุงูุงุช ุ ูุจู ููููุง ุฅูู ุงููููุฐุฌ ุ ุจุงุณุชุฎุฏุงู </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">ุชุญููู ุงููููู ุงูุฑุฆูุณู</font></a></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/tt/m5/h7/ttm5h7jbbx2u2wuc1var1azxwew.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ PCA). </font><font style="vertical-align: inherit;">ูููู ูู ูุณุชุญู ุงุณุชุฎุฏุงููุ </font><font style="vertical-align: inherit;">ุฃููุณ ุงูุบุฑุถ ุงูุฃุณุงุณู ูู ุฎูุงุฑุฒููุฉ ุงูุชุฑุฏุฏ ุงููุงุณููู ูู ูุณุงุนุฏุฉ ุงููุญูู ุนูู ุชูุณูุฑ ุฃูููุฉ ุงูุณูุงุชุ</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุนู ุ ูููู ุฃู ูุคุฏู ุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ PCA ุฅูู ุชุนููุฏ ุทููู ูู ุชูุณูุฑ ูู "ููุฒุฉ" ูู ุชุญููู "ุฃูููุฉ ุงูููุฒุงุช" ููููุฐุฌ RF. ููุน ุฐูู ุ ุชููู ุฎูุงุฑุฒููุฉ PCA ุจูุนุฏ ูุณุงุญุฉ ุงูููุฒุฉ ุ ููุง ูุฏ ูุคุฏู ุฅูู ุงูุฎูุงุถ ุนุฏุฏ ุงูููุฒุงุช ุงูุชู ุชุญุชุงุฌ ุฅูู ูุนุงูุฌุชูุง ุจูุงุณุทุฉ ูููุฐุฌ RF. ูุฑุฌู ููุงุญุธุฉ ุฃู ุญุฌู ุงูุญุณุงุจุงุช ูู ุฃุญุฏ ุงูุนููุจ ุงูุฑุฆูุณูุฉ ูุฎูุงุฑุฒููุฉ ุงูุบุงุจุฉ ุงูุนุดูุงุฆูุฉ (ุฃู ุฃูู ูููู ุฃู ูุณุชุบุฑู ููุชูุง ุทูููุงู ูุฅููุงู ุงููููุฐุฌ). ูููู ุฃู ูููู ุชุทุจูู ุฎูุงุฑุฒููุฉ PCA ุฌุฒุกูุง ููููุง ุฌุฏูุง ูู ุงูููุฐุฌุฉ ุ ุฎุงุตุฉ ูู ุงูุญุงูุงุช ุงูุชู ุชุนูู ูููุง ูุน ูุฆุงุช ุฃู ุญุชู ุขูุงู ุงูููุฒุงุช. ููุชูุฌุฉ ูุฐูู ุ ุฅุฐุง ูุงู ุงูุดูุก ุงูุฃูุซุฑ ุฃูููุฉ ูู ุจุจุณุงุทุฉ ุฅูุดุงุก ุงููููุฐุฌ ุงูุฃูุซุฑ ูุงุนููุฉ ุ ููู ุงูููุช ููุณู ููููู ุงูุชุถุญูุฉ ุจุฏูุฉ ุชุญุฏูุฏ ุฃูููุฉ ุงูุณูุงุช ุ ูุฅู PCA ูุฏ ูุณุชุญู ุงููุญุงููุฉ.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุฅูู ุงูููุทุฉ. </font><font style="vertical-align: inherit;">ุณูุนูู ูุน </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌููุนุฉ ุจูุงูุงุช ูุณุฑุทุงู ุงูุซุฏู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">Scikit-Learn "ุณุฑุทุงู ุงูุซุฏู"</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ุณูููู ุจุฅูุดุงุก ุซูุงุซุฉ ููุงุฐุฌ ูููุงุฑูุฉ ูุนุงููุชูุง. </font><font style="vertical-align: inherit;">ูุจุงูุชุญุฏูุฏ ูุชุญุฏุซ ุนู ุงูููุงุฐุฌ ุงูุชุงููุฉ:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููููุฐุฌ ุงูุฃุณุงุณู ุงููุงุฆู ุนูู ุฎูุงุฑุฒููุฉ RF (ุณูุฎุชุตุฑ ูุฐุง ุงููููุฐุฌ RF).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุณ ุงููููุฐุฌ ูุซู ุฑูู 1 ุ ูููู ูููุฐุฌูุง ูุชู ููู ุชุทุจูู ุชูููู ุฃุจุนุงุฏ ูุณุงุญุฉ ุงูููุฒุฉ ุจุงุณุชุฎุฏุงู ุทุฑููุฉ ุงููููู ุงูุฑุฆูุณู (RF + PCA).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุณ ุงููููุฐุฌ ูุซู ุฑูู 2 ุ ูููู ุชู ุฅูุดุงุคู ุจุงุณุชุฎุฏุงู ุชุญุณูู ุงููุนููุงุช ุงููุงุฆูุฉ (RF + PCA + HT).</font></font></li>
</ol><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุจุฏุก ุ ูู ุจุชุญููู ุงูุจูุงูุงุช ููู ุจุฅูุดุงุก Patas dataframe. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃููุง ูุณุชุฎุฏู ูุฌููุนุฉ ุจูุงูุงุช "ูุนุจุฉ" ุชู ูุณุญูุง ูุณุจููุง ูู Scikit-Learn ุ ูููููุง ุจุนุฏ ุฐูู ุจุฏุก ุนูููุฉ ุงูููุฐุฌุฉ ุจุงููุนู. </font><font style="vertical-align: inherit;">ูููู ุญุชู ุนูุฏ ุงุณุชุฎุฏุงู ูุฐู ุงูุจูุงูุงุช ุ ููุตู ุจุฃู ุชุจุฏุฃ ุงูุนูู ุฏุงุฆููุง ุจุฅุฌุฑุงุก ุชุญููู ุฃููู ููุจูุงูุงุช ุจุงุณุชุฎุฏุงู ุงูุฃูุงูุฑ ุงูุชุงููุฉ ุงููุทุจูุฉ ุนูู ุฅุทุงุฑ ุงูุจูุงูุงุช ( </font></font><code>df</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">):</font></font><br>
<br>
<ul>
<li><code>df.head()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ูุฅููุงุก ูุธุฑุฉ ุนูู ุฅุทุงุฑ ุงูุจูุงูุงุช ุงูุฌุฏูุฏ ููุนุฑูุฉ ูุง ุฅุฐุง ูุงู ูุจุฏู ููุง ูู ูุชููุน.</font></font></li>
<li><code>df.info()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ููุนุฑูุฉ ุฎุตุงุฆุต ุฃููุงุน ุงูุจูุงูุงุช ููุญุชููุงุช ุงูุฃุนูุฏุฉ. </font><font style="vertical-align: inherit;">ูุฏ ูููู ูู ุงูุถุฑูุฑู ุฅุฌุฑุงุก ุชุญููู ููุน ุงูุจูุงูุงุช ูุจู ุงููุชุงุจุนุฉ.</font></font></li>
<li><code>df.isna()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ููุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ููู ูู ุงูุจูุงูุงุช </font></font><code>NaN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุฏ ููุฒู ูุนุงูุฌุฉ ุงูููู ุงูููุงุจูุฉ ุ ุฅู ูุฌุฏุช ุ ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู ุ ุฃู ุ ุฅุฐุง ูุฒู ุงูุฃูุฑ ุ ูุฏ ูููู ูู ุงูุถุฑูุฑู ุฅุฒุงูุฉ ุตููู ูุงููุฉ ูู ุฅุทุงุฑ ุงูุจูุงูุงุช.</font></font></li>
<li><code>df.describe()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ููุนุฑูุฉ ููู ุงูุญุฏ ุงูุฃุฏูู ูุงูุญุฏ ุงูุฃูุตู ูุงููุชูุณุท โโูููุคุดุฑุงุช ูู ุงูุฃุนูุฏุฉ ุ ููุนุฑูุฉ ูุคุดุฑุงุช ูุชูุณุท โโูุฑุจุน ูุงูุงูุญุฑุงู ุงููุญุชูู ูู ุงูุฃุนูุฏุฉ.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจูุง ุ ููุซู ุงูุนููุฏ </font></font><code>cancer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(ุงูุณุฑุทุงู) ุงููุชุบูุฑ ุงููุณุชูุฏู ุงูุฐู ูุฑูุฏ ุชููุน ูููุชู ุจุงุณุชุฎุฏุงู ุงููููุฐุฌ. </font></font><code>0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุนูู "ูุง ูุฑุถ". </font></font><code>1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- "ูุฌูุฏ ุงููุฑุถ".</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_breast_cancer<font></font>
columns = [<span class="hljs-string">'mean radius'</span>, <span class="hljs-string">'mean texture'</span>, <span class="hljs-string">'mean perimeter'</span>, <span class="hljs-string">'mean area'</span>, <span class="hljs-string">'mean smoothness'</span>, <span class="hljs-string">'mean compactness'</span>, <span class="hljs-string">'mean concavity'</span>, <span class="hljs-string">'mean concave points'</span>, <span class="hljs-string">'mean symmetry'</span>, <span class="hljs-string">'mean fractal dimension'</span>, <span class="hljs-string">'radius error'</span>, <span class="hljs-string">'texture error'</span>, <span class="hljs-string">'perimeter error'</span>, <span class="hljs-string">'area error'</span>, <span class="hljs-string">'smoothness error'</span>, <span class="hljs-string">'compactness error'</span>, <span class="hljs-string">'concavity error'</span>, <span class="hljs-string">'concave points error'</span>, <span class="hljs-string">'symmetry error'</span>, <span class="hljs-string">'fractal dimension error'</span>, <span class="hljs-string">'worst radius'</span>, <span class="hljs-string">'worst texture'</span>, <span class="hljs-string">'worst perimeter'</span>, <span class="hljs-string">'worst area'</span>, <span class="hljs-string">'worst smoothness'</span>, <span class="hljs-string">'worst compactness'</span>, <span class="hljs-string">'worst concavity'</span>, <span class="hljs-string">'worst concave points'</span>, <span class="hljs-string">'worst symmetry'</span>, <span class="hljs-string">'worst fractal dimension'</span>]<font></font>
dataset = load_breast_cancer()<font></font>
data = pd.DataFrame(dataset[<span class="hljs-string">'data'</span>], columns=columns)<font></font>
data[<span class="hljs-string">'cancer'</span>] = dataset[<span class="hljs-string">'target'</span>]<font></font>
display(data.head())<font></font>
display(data.info())<font></font>
display(data.isna().sum())<font></font>
display(data.describe())</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bce/fb8/b60/bcefb8b60462b7658b40e1e56f7744ab.png"></div><br>
<i><font color="#999999">      .       .  , cancer,   ,    . 0  ยซ ยป. 1 โ ยซ ยป</font></i><br>
 <br>
<h2><font color="#3AC1EF">2.        </font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ูู ุจุชูุณูู ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ูุธููุฉ Scikit-Learn </font></font><code>train_test_split</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ูุฑูุฏ ุฃู ูุนุทู ุงููููุฐุฌ ุฃูุจุฑ ูุฏุฑ ูููู ูู ุจูุงูุงุช ุงูุชุฏุฑูุจ. ููุน ุฐูู ุ ูุญุชุงุฌ ุฅูู ูุฌูุฏ ุจูุงูุงุช ูุงููุฉ ุชุญุช ุชุตุฑููุง ูุงุฎุชุจุงุฑ ุงููููุฐุฌ. ุจุดูู ุนุงู ุ ูููููุง ุงูููู ุฃูู ูุน ุฒูุงุฏุฉ ุนุฏุฏ ุงูุตููู ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุ ูุฒุฏุงุฏ ุฃูุถูุง ููุฏุงุฑ ุงูุจูุงูุงุช ุงูุชู ูููู ุงุนุชุจุงุฑูุง ุชุนููููุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงู ููุงู ููุงููู ุงูุฎุทูุท ุ ููููู ุชูุณูู ุงููุฌููุนุฉ ูู ุฎูุงู ุชูููุฒ 90ูช ูู ุฎุทูุท ุจูุงูุงุช ุงูุชุฏุฑูุจ ู 10ูช ูุจูุงูุงุช ุงูุงุฎุชุจุงุฑ. ููู ูุฌููุนุฉ ุจูุงูุงุช ุงูุงุฎุชุจุงุฑ ุชุญุชูู ุนูู 569 ุตููุง ููุท. ููุฐุง ููุณ ูุซูุฑูุง ููุชุฏุฑูุจ ูุงุฎุชุจุงุฑ ุงููููุฐุฌ. ููุชูุฌุฉ ูุฐูู ุ ููู ูููู ููุตููู ูููุง ูุชุนูู ุจุจูุงูุงุช ุงูุชุฏุฑูุจ ูุงูุชุญูู ุ ุณููุณู ุงููุฌููุนุฉ ุฅูู ุฌุฒุฃูู ูุชุณุงูููู - 50ูช - ุจูุงูุงุช ุงูุชุฏุฑูุจ ู 50ูช - ุจูุงูุงุช ุงูุชุญูู. ูููู ุจุชุซุจูุช</font></font><code>stratify=y</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุชุฃูุฏ ูู ุฃู ูู ูู ูุฌููุนุงุช ุจูุงูุงุช ุงูุชุฏุฑูุจ ูุงูุงุฎุชุจุงุฑ ููุง ููุณ ูุณุจุฉ 0 ู 1 ูุซู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฃุตููุฉ.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<font></font>
X = data.drop(<span class="hljs-string">'cancer'</span>, axis=<span class="hljs-number">1</span>)&nbsp;&nbsp;<font></font>
y = data[<span class="hljs-string">'cancer'</span>]&nbsp;<font></font>
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class="hljs-number">0.50</span>, random_state = <span class="hljs-number">2020</span>, stratify=y)</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. ุชุญุฌูู ุงูุจูุงูุงุช</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจู ุงูุดุฑูุน ูู ุงูููุฐุฌุฉ ุ ุชุญุชุงุฌ ุฅูู "ุชูุณูุท" ู "ุชูุญูุฏ" ุงูุจูุงูุงุช ุนู ุทุฑูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญุฌูููุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูุชู ุฅุฌุฑุงุก ุงูููุงุณ ุจุณุจุจ ุญูููุฉ ุฃูู ูุชู ุงูุชุนุจูุฑ ุนู ุงููููุงุช ุงููุฎุชููุฉ ุจูุญุฏุงุช ูุฎุชููุฉ. </font><font style="vertical-align: inherit;">ูุณูุญ ูู ูุฐุง ุงูุฅุฌุฑุงุก ุจุชูุธูู "ูุนุฑูุฉ ุนุงุฏูุฉ" ุจูู ุงูุนูุงูุงุช ูู ุชุญุฏูุฏ ุฃูููุชูุง. </font><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูููู ุจุงูุชุญููู </font></font><code>y_train</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ููุน ุจูุงูุงุช Pandas </font></font><code>Series</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูู ุตููู NumPy ุจุญูุซ ูููู ูููููุฐุฌ ูุงุญููุง ุงูุนูู ูุน ุงูุฃูุฏุงู ุงูููุงุจูุฉ.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> StandardScaler<font></font>
ss = StandardScaler()<font></font>
X_train_scaled = ss.fit_transform(X_train)<font></font>
X_test_scaled = ss.transform(X_test)<font></font>
y_train = np.array(y_train)</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. ุชุฏุฑูุจ ุงููููุฐุฌ ุงูุฃุณุงุณู (ูููุฐุฌ ุฑูู 1 ุ RF)</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุฅูุดุงุก ูููุฐุฌ ุฑูู 1. </font><font style="vertical-align: inherit;">ูู ุฐูู ุ ูุชุฐูุฑ ุฃูู ูุชู ุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ ุงูุบุงุจุฉ ุงูุนุดูุงุฆูุฉ ููุท. </font><font style="vertical-align: inherit;">ูุณุชุฎุฏู ุฌููุน ุงูููุฒุงุช ููุชู ุชููููู ุจุงุณุชุฎุฏุงู ุงูููู ุงูุงูุชุฑุงุถูุฉ (ูููู ุงูุนุซูุฑ ุนูู ุชูุงุตูู ุญูู ูุฐู ุงูุฅุนุฏุงุฏุงุช ูู ูุซุงุฆู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sklearn.ensemble.RandomForestClassifier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">ุชููุฆุฉ ุงููููุฐุฌ. </font><font style="vertical-align: inherit;">ุจุนุฏ ุฐูู ุ ุณูู ูููู ุจุชุฏุฑูุจูุง ุนูู ุงูุจูุงูุงุช ุงููุชุฏุฑุฌุฉ. </font><font style="vertical-align: inherit;">ูููู ููุงุณ ุฏูุฉ ุงููููุฐุฌ ุนูู ุจูุงูุงุช ุงูุชุฏุฑูุจ:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> RandomForestClassifier
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> recall_score<font></font>
rfc = RandomForestClassifier()<font></font>
rfc.fit(X_train_scaled, y_train)<font></font>
display(rfc.score(X_train_scaled, y_train))<font></font>
<span class="hljs-comment"># 1.0</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅุฐุง ููุง ููุชููู ุจูุนุฑูุฉ ุงูููุฒุงุช ุงูุฃูุซุฑ ุฃูููุฉ ููููุฐุฌ RF ูู ุงูุชูุจุค ุจุณุฑุทุงู ุงูุซุฏู ุ ููููููุง ุชุตูุฑ ูุชุญุฏูุฏ ูุคุดุฑุงุช ุฃูููุฉ ุงูุนูุงูุงุช ูู ุฎูุงู ุงูุฅุดุงุฑุฉ ุฅูู ุงูุณูุฉ </font></font><code>feature_importances_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="python hljs">feats = {}
<span class="hljs-keyword">for</span> feature, importance <span class="hljs-keyword">in</span> zip(data.columns, rfc_1.feature_importances_):<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;feats[feature] = importance<font></font>
importances = pd.DataFrame.from_dict(feats, orient=<span class="hljs-string">'index'</span>).rename(columns={<span class="hljs-number">0</span>: <span class="hljs-string">'Gini-Importance'</span>})<font></font>
importances = importances.sort_values(by=<span class="hljs-string">'Gini-Importance'</span>, ascending=<span class="hljs-literal">False</span>)<font></font>
importances = importances.reset_index()<font></font>
importances = importances.rename(columns={<span class="hljs-string">'index'</span>: <span class="hljs-string">'Features'</span>})<font></font>
sns.set(font_scale = <span class="hljs-number">5</span>)<font></font>
sns.set(style=<span class="hljs-string">"whitegrid"</span>, color_codes=<span class="hljs-literal">True</span>, font_scale = <span class="hljs-number">1.7</span>)<font></font>
fig, ax = plt.subplots()<font></font>
fig.set_size_inches(<span class="hljs-number">30</span>,<span class="hljs-number">15</span>)<font></font>
sns.barplot(x=importances[<span class="hljs-string">'Gini-Importance'</span>], y=importances[<span class="hljs-string">'Features'</span>], data=importances, color=<span class="hljs-string">'skyblue'</span>)<font></font>
plt.xlabel(<span class="hljs-string">'Importance'</span>, fontsize=<span class="hljs-number">25</span>, weight = <span class="hljs-string">'bold'</span>)<font></font>
plt.ylabel(<span class="hljs-string">'Features'</span>, fontsize=<span class="hljs-number">25</span>, weight = <span class="hljs-string">'bold'</span>)<font></font>
plt.title(<span class="hljs-string">'Feature Importance'</span>, fontsize=<span class="hljs-number">25</span>, weight = <span class="hljs-string">'bold'</span>)<font></font>
display(plt.show())<font></font>
display(importances)</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a02/a8f/cd2/a02a8fcd28f87af338f364a70faeca3e.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุตูุฑ "ุฃูููุฉ" ุงูุนูุงูุงุช</font></font></font></i><br>
 <br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/830/176/e1f/830176e1fc9ce63bfedf2d727619253b.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุคุดุฑุงุช ุงูุฏูุงูุฉ</font></font></font></i><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. ุทุฑููุฉ ุงูููููุงุช ุงูุฑุฆูุณูุฉ</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุฏุนููุง ูุณุฃู ููู ูููููุง ุชุญุณูู ูููุฐุฌ RF ุงูุฃุณุงุณู. ุจุงุณุชุฎุฏุงู ุชูููุฉ ุชูููู ุฃุจุนุงุฏ ูุณุงุญุฉ ุงูููุฒุฉ ุ ูู ุงููููู ุชูุฏูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฃูููุฉ ูู ุฎูุงู ูุชุบูุฑุงุช ุฃูู ููู ููุณ ุงูููุช ุชูููู ูููุฉ ุงูููุงุฑุฏ ุงูุญุณุงุจูุฉ ุงููุงุฒูุฉ ูุถูุงู ุชุดุบูู ุงููููุฐุฌ. ุจุงุณุชุฎุฏุงู PCA ุ ููููู ุฏุฑุงุณุฉ ุชุจุงูู ุงูุนููุฉ ุงูุชุฑุงููู ููุฐู ุงูููุฒุงุช ูู ุฃุฌู ููู ุงูููุฒุงุช ุงูุชู ุชูุณุฑ ูุนุธู ุงูุชุจุงูู ูู ุงูุจูุงูุงุช. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุจุชููุฆุฉ ูุงุฆู PCA ( </font></font><code>pca_test</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) ุ ูุน ุงูุฅุดุงุฑุฉ ุฅูู ุนุฏุฏ ุงูููููุงุช (ุงูููุฒุงุช) ุงูุชู ูุฌุจ ุฃุฎุฐูุง ูู ุงูุงุนุชุจุงุฑ. ูููุง ุจุชุนููู ูุฐุง ุงููุคุดุฑ ุฅูู 30 ูู ุฃุฌู ุฑุคูุฉ ุงูุชุจุงูู ุงูููุถุญ ูุฌููุน ุงูููููุงุช ุงููููุฏุฉ ูุจู ุงุชุฎุงุฐ ูุฑุงุฑ ุจุดุฃู ุนุฏุฏ ุงูููููุงุช ุงูุชู ูุญุชุงุฌูุง. ุซู ููุชูู ุฅูู </font></font><code>pca_test</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุจูุงูุงุช ุงูููุงุณุฉ</font></font><code>X_train</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงุณุชุฎุฏุงู ุงูุทุฑููุฉ </font></font><code>pca_test.fit()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุจุนุฏ ุฐูู ูููู ุจุชุตูุฑ ุงูุจูุงูุงุช.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns
<span class="hljs-keyword">from</span> sklearn.decomposition <span class="hljs-keyword">import</span> PCA<font></font>
pca_test = PCA(n_components=<span class="hljs-number">30</span>)<font></font>
pca_test.fit(X_train_scaled)<font></font>
sns.set(style=<span class="hljs-string">'whitegrid'</span>)<font></font>
plt.plot(np.cumsum(pca_test.explained_variance_ratio_))<font></font>
plt.xlabel(<span class="hljs-string">'number of components'</span>)<font></font>
plt.ylabel(<span class="hljs-string">'cumulative explained variance'</span>)<font></font>
plt.axvline(linewidth=<span class="hljs-number">4</span>, color=<span class="hljs-string">'r'</span>, linestyle = <span class="hljs-string">'--'</span>, x=<span class="hljs-number">10</span>, ymin=<span class="hljs-number">0</span>, ymax=<span class="hljs-number">1</span>)<font></font>
display(plt.show())<font></font>
evr = pca_test.explained_variance_ratio_<font></font>
cvr = np.cumsum(pca_test.explained_variance_ratio_)<font></font>
pca_df = pd.DataFrame()<font></font>
pca_df[<span class="hljs-string">'Cumulative Variance Ratio'</span>] = cvr<font></font>
pca_df[<span class="hljs-string">'Explained Variance Ratio'</span>] = evr<font></font>
display(pca_df.head(<span class="hljs-number">10</span>))</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6eb/65f/acc/6eb65facc6c8b05f1e910d3b2b676d5e.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ุฃู ุชุฌุงูุฒ ุนุฏุฏ ุงูููููุงุช ุงููุณุชุฎุฏูุฉ 10 ุ ูุง ุชุคุฏู ุงูุฒูุงุฏุฉ ูู ุนุฏุฏูุง ุฅูู ุฒูุงุฏุฉ ุงูุชุจุงูู ุงูููุถุญ ุจุดูู ูุจูุฑ</font></font></font></i><br>
 <br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f12/e3c/915/f12e3c915d761e1d4623051dac74cd8d.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุชูู ุฅุทุงุฑ ุงูุจูุงูุงุช ูุฐุง ุนูู ูุคุดุฑุงุช ูุซู ูุณุจุฉ ุงูุชุจุงูู ุงูุชุฑุงููู (ุงูุญุฌู ุงูุชุฑุงููู ููุชุจุงูู ุงูููุถุญ ููุจูุงูุงุช) ููุณุจุฉ ุงูุชุจุงูู ุงูููุถุญุฉ (ูุณุงููุฉ ูู ูููู ูู ุงูุญุฌู ุงูุฅุฌูุงูู ููุชุจุงูู ุงูููุถุญ)</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ุฅุฐุง ูุธุฑุช ุฅูู ุฅุทุงุฑ ุงูุจูุงูุงุช ุฃุนูุงู ุ ูุชุจูู ุฃู ุงุณุชุฎุฏุงู PCA ููุงูุชูุงู ูู 30 ูุชุบูุฑูุง ุฅูู 10 ูุชุบูุฑุงุช ุฅูู ุงูููููุงุช ูุณูุญ ุจุดุฑุญ 95ูช ูู ุชุดุชุช ุงูุจูุงูุงุช. ุชูุซู ุงูููููุงุช 20 ุงูุฃุฎุฑู ุฃูู ูู 5 ูช ูู ุงูุชุจุงูู ุ ููุง ูุนูู ุฃูู ูููููุง ุฑูุถูุง. ุจุงุชุจุงุน ูุฐุง ุงูููุทู ุ ูุณุชุฎุฏู PCA ูุชูููู ุนุฏุฏ ุงูููููุงุช ูู 30 ุฅูู 10 ูู</font></font><code>X_train</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู</font></font><code>X_test</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ููุชุจ ูุฐู ูุตุทูุน "ุฎูุถ ุงูุจุนุฏ" ูุฌููุนุงุช ุงูุจูุงูุงุช ูู</font></font><code>X_train_scaled_pca</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู</font></font><code>X_test_scaled_pca</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="python hljs">pca = PCA(n_components=<span class="hljs-number">10</span>)<font></font>
pca.fit(X_train_scaled)<font></font>
X_train_scaled_pca = pca.transform(X_train_scaled)<font></font>
X_test_scaled_pca = pca.transform(X_test_scaled)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูููู ุนุจุงุฑุฉ ุนู ูุฌููุนุฉ ุฎุทูุฉ ูู ูุชุบูุฑุงุช ุงููุตุฏุฑ ูุน "ุงูุฃูุฒุงู" ุงูููุงุจูุฉ. </font><font style="vertical-align: inherit;">ูููููุง ุฃู ูุฑู ูุฐู "ุงูุฃูุฒุงู" ููู ูููู ูู ุฎูุงู ุฅูุดุงุก ุฅุทุงุฑ ุจูุงูุงุช.</font></font><br>
<br>
<pre><code class="python hljs">pca_dims = []
<span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, len(pca_df)):<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;pca_dims.append(<span class="hljs-string">'PCA Component {}'</span>.format(x))<font></font>
pca_test_df = pd.DataFrame(pca_test.components_, columns=columns, index=pca_dims)<font></font>
pca_test_df.head(<span class="hljs-number">10</span>).T</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/086/a28/ae4/086a28ae45e9048811cf813d4868902e.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูุตุฑ ุจูุงูุงุช ูุนูููุงุช ุงููููู</font></font></font></i><br>
 <br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. ุชุฏุฑูุจ ูููุฐุฌ RF ุงูุฃุณุงุณู ุจุนุฏ ุชุทุจูู ุทุฑููุฉ ุงูููููุงุช ุงูุฑุฆูุณูุฉ ุนูู ุงูุจูุงูุงุช (ุงููููุฐุฌ ุฑูู 2 ุ RF + PCA)</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ูููููุง ุฃู ุชูุฑ ุนูู ูุจูุงูุงุช RF-ูููุฐุฌ ุฃุณุงุณู ุขุฎุฑ </font></font><code>X_train_scaled_pca</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>y_train</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููู ูุนุฑูุฉ ูุง ุฅุฐุง ูุงู ููุงู ุชุญุณู ูู ุฏูุฉ ุงูุชููุนุงุช ุงูุตุงุฏุฑุฉ ุนู ูุฐุง ุงููููุฐุฌ.</font></font><br>
<br>
<pre><code class="python hljs">rfc = RandomForestClassifier()<font></font>
rfc.fit(X_train_scaled_pca, y_train)<font></font>
display(rfc.score(X_train_scaled_pca, y_train))<font></font>
<span class="hljs-comment"># 1.0</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงุฑูุฉ ุงูููุงุฐุฌ ุฃุฏูุงู.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7. ุชุญุณูู ุงููุนุงููุฑ ุงููุงุฆูุฉ. </font><font style="vertical-align: inherit;">ุงูุฌููุฉ 1: ุงูุจุญุซ ุงูุนุดูุงุฆู</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ูุนุงูุฌุฉ ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ุทุฑููุฉ ุงููููู ุงูุฑุฆูุณู ุ ููููู ูุญุงููุฉ ุงุณุชุฎุฏุงู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุซููุฉ ุงููุนููุงุช</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงููููุฐุฌูุฉ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">ูู</font></a><font style="vertical-align: inherit;"> ุฃุฌู ุชุญุณูู ุฌูุฏุฉ ุงูุชูุจุคุงุช ุงูุชู ููุชุฌูุง ูููุฐุฌ RF. ูููู ุงุนุชุจุงุฑ ุงููุนุงููุฑ ุงููุงุฆูุฉ ุนูู ุฃููุง ุดูุก ูุซู "ุฅุนุฏุงุฏุงุช" ุงููููุฐุฌ. ูู ุชุนูู ุงูุฅุนุฏุงุฏุงุช ุงููุซุงููุฉ ููุฌููุนุฉ ุจูุงูุงุช ูุงุญุฏุฉ ููุฌููุนุฉ ุฃุฎุฑู - ูููุฐุง ุงูุณุจุจ ุชุญุชุงุฌ ุฅูู ุชุญุณูููุง. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููููู ุงูุจุฏุก ุจุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ RandomizedSearchCV ุ ูุงูุชู ุชุชูุญ ูู ุงุณุชูุดุงู ูุฌููุนุฉ ูุจูุฑุฉ ูู ุงูููู ุชูุฑูุจูุง. ูููู ุงูุนุซูุฑ ุนูู ุฃูุตุงู ุฌููุน ุงููุนุงููุงุช ุงููุงุฆูุฉ ูููุงุฐุฌ ุงูุชุฑุฏุฏ ุงููุงุณููู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุณูุงู ุงูุนูู ุ ูููู ุจุฅูุดุงุก ููุงู </font></font><code>param_dist</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุชูู ุ ููู ูุนููุฉ ููุฑุทุฉ ุ ุนูู ูุฌููุนุฉ ูู ุงูููู ุงูุชู ูุฌุจ ุงุฎุชุจุงุฑูุง. ุจุนุฏ ุฐูู ุ ูููู ุจุชููุฆุฉ ุงููุงุฆู.</font></font><code>rs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงุณุชุฎุฏุงู ุงููุธููุฉ </font></font><code>RandomizedSearchCV()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุชูุฑูุฑูุง ูู ูููุฐุฌ RF </font></font><code>param_dist</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุนุฏุฏ ุงูุชูุฑุงุฑุงุช ูุนุฏุฏ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูููุงุช ุงูุชุญูู ุงููุชูุงุทุน</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุชู ูุชุนูู ุฅุฌุฑุงุคูุง. </font><font style="vertical-align: inherit;">ุชุณูุญ ูู </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงููุนููุฉ ุงููุงุฆูุฉ </font></font><code>verbose</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงูุชุญูู ูู ูููุฉ ุงููุนูููุงุช ุงูุชู ูุนุฑุถูุง ุงููููุฐุฌ ุฃุซูุงุก ุชุดุบููู (ูุซู ุฅุฎุฑุงุฌ ุงููุนูููุงุช ุฃุซูุงุก ุชุฏุฑูุจ ุงููููุฐุฌ). </font></font><code>n_jobs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณูุญ ูู </font><font style="vertical-align: inherit;">hyperparameter </font><font style="vertical-align: inherit;">ุจุชุญุฏูุฏ ุนุฏุฏ ููู ุงููุนุงูุฌ ุงูุชู ุชุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงููุง ูุถูุงู ุชุดุบูู ุงููููุฐุฌ. </font><font style="vertical-align: inherit;">ุชุนููููุง </font></font><code>n_jobs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูู ูููุฉ </font></font><code>-1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุดุฃููุง ุฃู ุชุคุฏู ุฅูู ูููุฐุฌ ุฃุณุฑุนุ ูุฃู ูุฐุง ุณูู ูุณุชุฎุฏู ูู ูู ููู ุงููุนุงูุฌ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณููุฎุฑุท ูู ุงุฎุชูุงุฑ ุงููุนุงููุฑ ุงููุงุฆูุฉ ุงูุชุงููุฉ:</font></font><br>
<br>
<ul>
<li><code>n_estimators</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ุนุฏุฏ "ุงูุฃุดุฌุงุฑ" ูู "ุงูุบุงุจุฉ ุงูุนุดูุงุฆูุฉ".</font></font></li>
<li><code>max_features</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ุนุฏุฏ ุงูููุฒุงุช ูุงุฎุชูุงุฑ ุงูุชูุณูู.</font></font></li>
<li><code>max_depth</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ุฃูุตู ุนูู ููุฃุดุฌุงุฑ.</font></font></li>
<li><code>min_samples_split</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ุงูุญุฏ ุงูุฃุฏูู ูู ุนุฏุฏ ุงูุนูุงุตุฑ ุงููุงุฒูุฉ ูุชูุณูู ุนูุฏุฉ ุงูุดุฌุฑุฉ.</font></font></li>
<li><code>min_samples_leaf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ุงูุญุฏ ุงูุฃุฏูู ูู ุงูุฃุดูุงุก ูู ุงูุฃูุฑุงู.</font></font></li>
<li><code>bootstrap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ุชุณุชุฎุฏู ูุจูุงุก ุฃุดุฌุงุฑ ุนููุฉ ูุฑุนูุฉ ูุน ุงูุนูุฏุฉ.</font></font></li>
</ul><br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> RandomizedSearchCV<font></font>
n_estimators = [int(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> np.linspace(start = <span class="hljs-number">100</span>, stop = <span class="hljs-number">1000</span>, num = <span class="hljs-number">10</span>)]<font></font>
max_features = [<span class="hljs-string">'log2'</span>, <span class="hljs-string">'sqrt'</span>]<font></font>
max_depth = [int(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> np.linspace(start = <span class="hljs-number">1</span>, stop = <span class="hljs-number">15</span>, num = <span class="hljs-number">15</span>)]<font></font>
min_samples_split = [int(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> np.linspace(start = <span class="hljs-number">2</span>, stop = <span class="hljs-number">50</span>, num = <span class="hljs-number">10</span>)]<font></font>
min_samples_leaf = [int(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> np.linspace(start = <span class="hljs-number">2</span>, stop = <span class="hljs-number">50</span>, num = <span class="hljs-number">10</span>)]<font></font>
bootstrap = [<span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>]<font></font>
param_dist = {<span class="hljs-string">'n_estimators'</span>: n_estimators,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'max_features'</span>: max_features,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'max_depth'</span>: max_depth,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'min_samples_split'</span>: min_samples_split,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'min_samples_leaf'</span>: min_samples_leaf,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'bootstrap'</span>: bootstrap}<font></font>
rs = RandomizedSearchCV(rfc_2,&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param_dist,&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_iter = <span class="hljs-number">100</span>,&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv = <span class="hljs-number">3</span>,&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verbose = <span class="hljs-number">1</span>,&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_jobs=<span class="hljs-number">-1</span>,&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;random_state=<span class="hljs-number">0</span>)<font></font>
rs.fit(X_train_scaled_pca, y_train)<font></font>
rs.best_params_<font></font>
<span class="hljs-comment"># {'n_estimators': 700,</span>
<span class="hljs-comment"># 'min_samples_split': 2,</span>
<span class="hljs-comment"># 'min_samples_leaf': 2,</span>
<span class="hljs-comment"># 'max_features': 'log2',</span>
<span class="hljs-comment"># 'max_depth': 11,</span>
<span class="hljs-comment"># 'bootstrap': True}</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุน ููู ุงููุนููุงุช </font></font><code>n_iter = 100</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>cv = 3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุฃูุดุฃูุง 300 ููุงุฐุฌ RFุ ุงุฎุชูุงุฑ ุนุดูุงุฆู ูุฌููุนุงุช ูู ูุฑุท </font><font style="vertical-align: inherit;">ุงููุนููุงุช </font><font style="vertical-align: inherit;">ุงููุงุฑุฏุฉ ุฃุนูุงู. </font><font style="vertical-align: inherit;">ูููููุง ุงูุฑุฌูุน ุฅูู ุงูุณูุฉ </font></font><code>best_params_ </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุญุตูู ุนูู ูุนูููุงุช ุญูู ูุฌููุนุฉ ูู ุงููุนููุงุช ุงูุชู ุชุณูุญ ูู ุจุฅูุดุงุก ุฃูุถู ูููุฐุฌ. </font><font style="vertical-align: inherit;">ูููู ูู ูุฐู ุงููุฑุญูุฉ ุ ูุฏ ูุง ูุนุทููุง ูุฐุง ุงูุจูุงูุงุช ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู ุญูู ูุทุงูุงุช ุงููุนููุงุช ุงูุชู ุชุณุชุญู ุงุณุชูุดุงููุง ูู ุงูุฌููุฉ ุงูุชุงููุฉ ูู ุงูุชุญุณูู. </font><font style="vertical-align: inherit;">ูู ุฃุฌู ูุนุฑูุฉ ูุทุงู ุงูููู ุงูุฐู ูุณุชุญู ุงูุงุณุชูุฑุงุฑ ูู ุงูุจุญุซ ุ ูููููุง ุจุณูููุฉ ุงูุญุตูู ุนูู ุฅุทุงุฑ ุจูุงูุงุช ูุญุชูู ุนูู ูุชุงุฆุฌ ุฎูุงุฑุฒููุฉ RandomizedSearchCV.</font></font><br>
<br>
<pre><code class="python hljs">rs_df = pd.DataFrame(rs.cv_results_).sort_values(<span class="hljs-string">'rank_test_score'</span>).reset_index(drop=<span class="hljs-literal">True</span>)<font></font>
rs_df = rs_df.drop([<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'mean_fit_time'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'std_fit_time'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'mean_score_time'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'std_score_time'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'params'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'split0_test_score'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'split1_test_score'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'split2_test_score'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'std_test_score'</span>],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;axis=<span class="hljs-number">1</span>)<font></font>
rs_df.head(<span class="hljs-number">10</span>)</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/617/b8c/20b/617b8c20b787acc3c76c23d9235b4b5a.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุงุฆุฌ ุฎูุงุฑุฒููุฉ RandomizedSearchCV</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ุงูุขู ุณูููู ุจุฅูุดุงุก ุฑุณูู ุจูุงููุฉ ุนููุฏูุฉ ุ ุนูู ุงููุญูุฑ X ุ ูู ููู ุงููุนููุงุช ุงูููุฑุทุฉ ุ ูุนูู ุงููุญูุฑ Y ูู ุงูููู ุงููุชูุณุทุฉ ุงูุชู ุชุธูุฑูุง ุงูููุงุฐุฌ. </font><font style="vertical-align: inherit;">ุณูุฌุนู ูุฐุง ูู ุงููููู ููู ููู ุงููุนููุงุช ุงูููุฑุทุฉ ุ ูู ุงููุชูุณุท โโุ ุงูุชู ุชุธูุฑ ุฃูุถู ุฃุฏุงุก ููุง.</font></font><br>
<br>
<pre><code class="python hljs">fig, axs = plt.subplots(ncols=<span class="hljs-number">3</span>, nrows=<span class="hljs-number">2</span>)<font></font>
sns.set(style=<span class="hljs-string">"whitegrid"</span>, color_codes=<span class="hljs-literal">True</span>, font_scale = <span class="hljs-number">2</span>)<font></font>
fig.set_size_inches(<span class="hljs-number">30</span>,<span class="hljs-number">25</span>)<font></font>
sns.barplot(x=<span class="hljs-string">'param_n_estimators'</span>, y=<span class="hljs-string">'mean_test_score'</span>, data=rs_df, ax=axs[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>], color=<span class="hljs-string">'lightgrey'</span>)<font></font>
axs[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>].set_ylim([<span class="hljs-number">.83</span>,<span class="hljs-number">.93</span>])axs[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>].set_title(label = <span class="hljs-string">'n_estimators'</span>, size=<span class="hljs-number">30</span>, weight=<span class="hljs-string">'bold'</span>)<font></font>
sns.barplot(x=<span class="hljs-string">'param_min_samples_split'</span>, y=<span class="hljs-string">'mean_test_score'</span>, data=rs_df, ax=axs[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>], color=<span class="hljs-string">'coral'</span>)<font></font>
axs[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>].set_ylim([<span class="hljs-number">.85</span>,<span class="hljs-number">.93</span>])axs[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>].set_title(label = <span class="hljs-string">'min_samples_split'</span>, size=<span class="hljs-number">30</span>, weight=<span class="hljs-string">'bold'</span>)<font></font>
sns.barplot(x=<span class="hljs-string">'param_min_samples_leaf'</span>, y=<span class="hljs-string">'mean_test_score'</span>, data=rs_df, ax=axs[<span class="hljs-number">0</span>,<span class="hljs-number">2</span>], color=<span class="hljs-string">'lightgreen'</span>)<font></font>
axs[<span class="hljs-number">0</span>,<span class="hljs-number">2</span>].set_ylim([<span class="hljs-number">.80</span>,<span class="hljs-number">.93</span>])axs[<span class="hljs-number">0</span>,<span class="hljs-number">2</span>].set_title(label = <span class="hljs-string">'min_samples_leaf'</span>, size=<span class="hljs-number">30</span>, weight=<span class="hljs-string">'bold'</span>)<font></font>
sns.barplot(x=<span class="hljs-string">'param_max_features'</span>, y=<span class="hljs-string">'mean_test_score'</span>, data=rs_df, ax=axs[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>], color=<span class="hljs-string">'wheat'</span>)<font></font>
axs[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>].set_ylim([<span class="hljs-number">.88</span>,<span class="hljs-number">.92</span>])axs[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>].set_title(label = <span class="hljs-string">'max_features'</span>, size=<span class="hljs-number">30</span>, weight=<span class="hljs-string">'bold'</span>)<font></font>
sns.barplot(x=<span class="hljs-string">'param_max_depth'</span>, y=<span class="hljs-string">'mean_test_score'</span>, data=rs_df, ax=axs[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>], color=<span class="hljs-string">'lightpink'</span>)<font></font>
axs[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>].set_ylim([<span class="hljs-number">.80</span>,<span class="hljs-number">.93</span>])axs[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>].set_title(label = <span class="hljs-string">'max_depth'</span>, size=<span class="hljs-number">30</span>, weight=<span class="hljs-string">'bold'</span>)<font></font>
sns.barplot(x=<span class="hljs-string">'param_bootstrap'</span>,y=<span class="hljs-string">'mean_test_score'</span>, data=rs_df, ax=axs[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], color=<span class="hljs-string">'skyblue'</span>)<font></font>
axs[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>].set_ylim([<span class="hljs-number">.88</span>,<span class="hljs-number">.92</span>])<font></font>
axs[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>].set_title(label = <span class="hljs-string">'bootstrap'</span>, size=<span class="hljs-number">30</span>, weight=<span class="hljs-string">'bold'</span>)<font></font>
plt.show()</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/418/311/ba6/418311ba6c38bfcebbf152af810d6b58.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญููู ููู ุงููุนููุงุช ุงููุงุฆูุฉ</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ุฅุฐุง ูููุง ุจุชุญููู ุงูุฑุณูู ุงูุจูุงููุฉ ุฃุนูุงู ุ ูููููุง ููุงุญุธุฉ ุจุนุถ ุงูุฃุดูุงุก ุงููุซูุฑุฉ ููุงูุชูุงู ุงูุชู ุชุชุญุฏุซ ุนู ููููุฉ ุชุฃุซูุฑ ูู ูููุฉ ูููุนููุงุช ุงููุงุฆูุฉ ูู ุงููุชูุณุท โโุนูู ุงููููุฐุฌ.</font></font><br>
<br>
<ul>
<li><code>n_estimators</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: ุงูููู 300 ุ 500 ุ 700 ุ ุนูู ูุง ูุจุฏู ุ ุชุธูุฑ ุฃูุถู ูุชูุณุท โโุงููุชุงุฆุฌ.</font></font></li>
<li><code>min_samples_split</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: ูุจุฏู ุฃู ุงูููู ุงูุตุบูุฑุฉ ูุซู 2 ู 7 ุชุธูุฑ ุฃูุถู ุงููุชุงุฆุฌ. </font><font style="vertical-align: inherit;">ุชุจุฏู ุงููููุฉ 23 ุฌูุฏุฉ ุฃูุถูุง. ููููู ูุญุต ุนุฏุฉ ููู ููุฐุง ุงููุนููุฉ ุงูุฒุงุฆุฏุฉ ุงูุชู ุชุฒูุฏ ุนู 2 ุ ุจุงูุฅุถุงูุฉ ุฅูู ุนุฏุฉ ููู ุชุจูุบ ุญูุงูู 23.</font></font></li>
<li><code>min_samples_leaf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: ููุงู ุดุนูุฑ ุจุฃู ุงูููู ุงูุตุบูุฑุฉ ููุฐุง ุงูุจุงุฑุงููุชุฑ ุชุนุทู ูุชุงุฆุฌ ุฃูุถู. </font><font style="vertical-align: inherit;">ูุฐุง ูุนูู ุฃูู ูููููุง ุชุฌุฑุจุฉ ุงูููู ุจูู 2 ู 7.</font></font></li>
<li><code>max_features</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: ุงูุฎูุงุฑ </font></font><code>sqrt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุนุทู ุฃุนูู ูุชูุณุท โโูุชูุฌุฉ.</font></font></li>
<li><code>max_depth</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: ูุง ุชูุฌุฏ ุนูุงูุฉ ูุงุถุญุฉ ุจูู ูููุฉ ุงููุนููุฉ ุงูููุฑุทุฉ ููุชุงุฆุฌ ุงููููุฐุฌ ุ ูููู ููุงู ุดุนูุฑ ุจุฃู ุงูููู 2 ุ 3 ุ 7 ุ 11 ุ 15 ุชุจุฏู ุฌูุฏุฉ.</font></font></li>
<li><code>bootstrap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><code>False</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุธูุฑ </font><font style="vertical-align: inherit;">ุงููููุฉ </font><font style="vertical-align: inherit;">ุฃูุถู ูุชูุฌุฉ ูุชูุณุท.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุ ุจุงุณุชุฎุฏุงู ูุฐู ุงููุชุงุฆุฌ ุ ูููููุง ุงูุงูุชูุงู ุฅูู ุงูุฌููุฉ ุงูุซุงููุฉ ูู ุงูุชุญุณูู ูููุนููุงุช ุงูููุฑุทุฉ. </font><font style="vertical-align: inherit;">ุณูุคุฏู ุฐูู ุฅูู ุชุถููู ูุทุงู ุงูููู ุงูุชู ููุชู ุจูุง.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8. ุชุญุณูู ุงููุนุงููุฑ ุงููุงุฆูุฉ. </font><font style="vertical-align: inherit;">ุงูุฌููุฉ 2: GridSearchCV (ุงูุฅุนุฏุงุฏ ุงูููุงุฆู ููุนููุงุช ุงููููุฐุฌ ุฑูู 3 ุ RF + PCA + HT)</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ุชุทุจูู ุฎูุงุฑุฒููุฉ RandomizedSearchCV ุ ุณูุณุชุฎุฏู ุฎูุงุฑุฒููุฉ GridSearchCV ูุฅุฌุฑุงุก ุจุญุซ ุฃูุซุฑ ุฏูุฉ ููุญุตูู ุนูู ุฃูุถู ุชุฑููุจุฉ ูู ุงููุนููุงุช ุงููุงุฆูุฉ. ูุชู ูุญุต ููุณ ุงููุนููุงุช ุงูุฒุงุฆุฏุฉ ููุง ุ ูููููุง ูููู ุงูุขู ุจุฅุฌุฑุงุก ุจุญุซ "ุฃูุซุฑ ุดูููุงู" ุนู ุฃูุถู ุชุฑููุจุฉ ููุง. ุจุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ GridSearchCV ุ ูุชู ูุญุต ูู ูุฌููุนุฉ ูู ุงููุนููุงุช ุงูููุฑุทุฉ. ูุชุทูุจ ูุฐุง ููุงุฑุฏ ุญุณุงุจูุฉ ุฃูุซุฑ ุจูุซูุฑ ูู ุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ RandomizedSearchCV ุนูุฏูุง ูููู ุจุชุนููู ุนุฏุฏ ุนูููุงุช ุชูุฑุงุฑ ุงูุจุญุซ ุจุดูู ูุณุชูู. ุนูู ุณุจูู ุงููุซุงู ุ ูุชุทูุจ ุงูุจุญุซ ุนู 10 ููู ููู ูู 6 ูุนููุงุช ููุฑุทุฉ ูุน ุงูุชุญูู ุงููุชูุงุทุน ูู 3 ูุฌููุนุงุช 10 ร 3 ุฃู 3ุ000ุ000 ุฌูุณุฉ ุชุฏุฑูุจ ูููุฐุฌูุฉ. ูุฐุง ูู ุงูุณุจุจ ูู ุฃููุง ูุณุชุฎุฏู ุฎูุงุฑุฒููุฉ GridSearchCV ุจุนุฏ ุ ุจุนุฏ ุชุทุจูู RandomizedSearchCV ุ ูููุง ุจุชุถููู ูุทุงูุงุช ููู ุงููุนููุงุช ุงููุฏุฑูุณุฉ.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐุง ุ ุจุงุณุชุฎุฏุงู ูุง ุงูุชุดููุงู ุจูุณุงุนุฏุฉ RandomizedSearchCV ุ ูุฏุฑุณ ููู ุงููุนููุงุช ุงููุงุฆูุฉ ุงูุชู ุฃุธูุฑุช ููุณูุง ุจุดูู ุฃูุถู:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> GridSearchCV<font></font>
n_estimators = [<span class="hljs-number">300</span>,<span class="hljs-number">500</span>,<span class="hljs-number">700</span>]<font></font>
max_features = [<span class="hljs-string">'sqrt'</span>]<font></font>
max_depth = [<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">7</span>,<span class="hljs-number">11</span>,<span class="hljs-number">15</span>]<font></font>
min_samples_split = [<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">22</span>,<span class="hljs-number">23</span>,<span class="hljs-number">24</span>]<font></font>
min_samples_leaf = [<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>]<font></font>
bootstrap = [<span class="hljs-literal">False</span>]<font></font>
param_grid = {<span class="hljs-string">'n_estimators'</span>: n_estimators,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'max_features'</span>: max_features,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'max_depth'</span>: max_depth,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'min_samples_split'</span>: min_samples_split,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'min_samples_leaf'</span>: min_samples_leaf,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'bootstrap'</span>: bootstrap}<font></font>
gs = GridSearchCV(rfc_2, param_grid, cv = <span class="hljs-number">3</span>, verbose = <span class="hljs-number">1</span>, n_jobs=<span class="hljs-number">-1</span>)<font></font>
gs.fit(X_train_scaled_pca, y_train)<font></font>
rfc_3 = gs.best_estimator_<font></font>
gs.best_params_<font></font>
<span class="hljs-comment"># {'bootstrap': False,</span>
<span class="hljs-comment"># 'max_depth': 7,</span>
<span class="hljs-comment"># 'max_features': 'sqrt',</span>
<span class="hljs-comment"># 'min_samples_leaf': 3,</span>
<span class="hljs-comment"># 'min_samples_split': 2,</span>
<span class="hljs-comment"># 'n_estimators': 500}</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุง ูุทุจู ุงูุชุญูู ุงููุชูุงุทุน ูู 3 ูุชู ูุฌูุณุงุช ุชุฏุฑูุจ ูููุฐุฌ 540 (3 ร 1 ร 5 ร 6 ร 6 ร 1) ุ ูุงูุชู ุชุนุทู 1620 ุฌูุณุฉ ุชุฏุฑูุจ ูููุฐุฌ. </font><font style="vertical-align: inherit;">ูุงูุขู ุ ุจุนุฏ ุฃู ุงุณุชุฎุฏููุง RandomizedSearchCV ู GridSearchCV ุ ูููููุง ุฃู ููุชูู ุฅูู ุงูุณูุฉ </font></font><code>best_params_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุนุฑูุฉ ููู </font><font style="vertical-align: inherit;">ุงููุนููุงุช ุงูููุฑุทุฉ </font><font style="vertical-align: inherit;">ุงูุชู ุชุณูุญ ูููููุฐุฌ ุจุงูุนูู ุจุดูู ุฃูุถู ูุน ูุฌููุนุฉ ุงูุจูุงูุงุช ููุฏ ุงูุฏุฑุงุณุฉ (ูููู ุฑุคูุฉ ูุฐู ุงูููู ูู ุฃุณูู ูุชูุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุณุงุจูุฉ) . </font><font style="vertical-align: inherit;">ูุชู ุงุณุชุฎุฏุงู ูุฐู ุงููุนููุงุช ูุฅูุดุงุก ูููุฐุฌ ุฑูู 3.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9. ุชูููู ุฌูุฏุฉ ุงูููุงุฐุฌ ุนูู ุจูุงูุงุช ุงูุชุญูู</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ููููู ุชูููู ุงูููุงุฐุฌ ุงูุชู ุชู ุฅูุดุงุคูุง ุนูู ุจูุงูุงุช ุงูุชุญูู. </font><font style="vertical-align: inherit;">ูุจุงูุชุญุฏูุฏ ุ ูุชุญุฏุซ ุนู ุชูู ุงูููุงุฐุฌ ุงูุซูุงุซุฉ ุงูููุถุญุฉ ูู ุจุฏุงูุฉ ุงููุงุฏุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุญูู ูู ูุฐู ุงูููุงุฐุฌ:</font></font><br>
<br>
<pre><code class="python hljs">y_pred = rfc.predict(X_test_scaled)<font></font>
y_pred_pca = rfc.predict(X_test_scaled_pca)<font></font>
y_pred_gs = gs.best_estimator_.predict(X_test_scaled_pca)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃูุดุฆ ูุตูููุงุช ุฎุทุฃ ููููุงุฐุฌ ูุงูุชุดู ูุฏู ูุฏุฑุฉ ูู ูููุง ุนูู ุงูุชูุจุค ุจุณุฑุทุงู ุงูุซุฏู:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> confusion_matrix<font></font>
conf_matrix_baseline = pd.DataFrame(confusion_matrix(y_test, y_pred), index = [<span class="hljs-string">'actual 0'</span>, <span class="hljs-string">'actual 1'</span>], columns = [<span class="hljs-string">'predicted 0'</span>, <span class="hljs-string">'predicted 1'</span>])<font></font>
conf_matrix_baseline_pca = pd.DataFrame(confusion_matrix(y_test, y_pred_pca), index = [<span class="hljs-string">'actual 0'</span>, <span class="hljs-string">'actual 1'</span>], columns = [<span class="hljs-string">'predicted 0'</span>, <span class="hljs-string">'predicted 1'</span>])<font></font>
conf_matrix_tuned_pca = pd.DataFrame(confusion_matrix(y_test, y_pred_gs), index = [<span class="hljs-string">'actual 0'</span>, <span class="hljs-string">'actual 1'</span>], columns = [<span class="hljs-string">'predicted 0'</span>, <span class="hljs-string">'predicted 1'</span>])<font></font>
display(conf_matrix_baseline)<font></font>
display(<span class="hljs-string">'Baseline Random Forest recall score'</span>, recall_score(y_test, y_pred))<font></font>
display(conf_matrix_baseline_pca)<font></font>
display(<span class="hljs-string">'Baseline Random Forest With PCA recall score'</span>, recall_score(y_test, y_pred_pca))<font></font>
display(conf_matrix_tuned_pca)<font></font>
display(<span class="hljs-string">'Hyperparameter Tuned Random Forest With PCA Reduced Dimensionality recall score'</span>, recall_score(y_test, y_pred_gs))</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f48/a9e/92f/f48a9e92fd5fdca613d6073e00bae2c6.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุงุฆุฌ ุนูู ุงูููุงุฐุฌ ุงูุซูุงุซุฉ</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ููุง ูุชู ุชูููู ูููุงุณ "ุงูุงูุชูุงู" (ุงูุงุณุชุฑุฌุงุน). </font><font style="vertical-align: inherit;">ุงูุญูููุฉ ูู ุฃููุง ูุชุนุงูู ูุน ุชุดุฎูุต ููุณุฑุทุงู. </font><font style="vertical-align: inherit;">ูุฐูู ุ ูุญู ููุชููู ููุบุงูุฉ ุจุชูููู ุงูุชููุนุงุช ุงูุณูุจูุฉ ุงูุฎุงุทุฆุฉ ุงูุตุงุฏุฑุฉ ุนู ุงูููุงุฐุฌ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงููุธุฑ ุฅูู ุฐูู ุ ูููููุง ุฃู ูุณุชูุชุฌ ุฃู ูููุฐุฌ RF ุงูุฃุณุงุณู ุฃุนุทู ุฃูุถู ุงููุชุงุฆุฌ. </font><font style="vertical-align: inherit;">ูุงู ูุนุฏู ุงูุชูุงูู 94.97ูช. </font><font style="vertical-align: inherit;">ูู ูุฌููุนุฉ ุจูุงูุงุช ุงูุงุฎุชุจุงุฑ ุ ูุงู ููุงู ุณุฌู ูู 179 ูุฑูุถูุง ูุตุงุจูุง ุจุงูุณุฑุทุงู. </font><font style="vertical-align: inherit;">ูุฌุฏ ุงููููุฐุฌ 170 ูููู.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฎุต</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชููุฑ ูุฐู ุงูุฏุฑุงุณุฉ ููุงุญุธุฉ ูููุฉ. </font><font style="vertical-align: inherit;">ูู ุจุนุถ ุงูุฃุญูุงู ุ ูุฏ ูุง ูุนูู ูููุฐุฌ RF ุ ุงูุฐู ูุณุชุฎุฏู ุทุฑููุฉ ุงููููู ุงูุฃุณุงุณู ูุงูุชุญุณูู ูุงุณุน ุงููุทุงู ูููุนููุงุช ุงููุงุฆูุฉ ุ ูุซู ุงููููุฐุฌ ุงูุนุงุฏู ูุน ุงูุฅุนุฏุงุฏุงุช ุงูููุงุณูุฉ. </font><font style="vertical-align: inherit;">ููู ูุฐุง ููุณ ุณุจุจุงู ูุชูุชุตุฑ ุนูู ุฃุจุณุท ุงูููุงุฐุฌ ููุท. </font><font style="vertical-align: inherit;">ุจุฏูู ุชุฌุฑุจุฉ ููุงุฐุฌ ูุฎุชููุฉ ุ ูู ุงููุณุชุญูู ุชุญุฏูุฏ ุงููููุฐุฌ ุงูุฐู ุณูุธูุฑ ุฃูุถู ูุชูุฌุฉ. </font><font style="vertical-align: inherit;">ููู ุญุงูุฉ ุงูููุงุฐุฌ ุงููุณุชุฎุฏูุฉ ููุชูุจุค ุจูุฌูุฏ ุงูุณุฑุทุงู ูู ุงููุฑุถู ุ ูููููุง ุงูููู ุฃูู ูููุง ูุงู ุงููููุฐุฌ ุฃูุถู - ูููุง ุฃููู ุฅููุงุฐ ุงููุฒูุฏ ูู ุงูุฃุฑูุงุญ. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุฑุงุก ุงูุฃุนุฒุงุก! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ุงูููุงู ุงูุชู ุชุญููุง ุจุงุณุชุฎุฏุงู ุทุฑู ุงูุชุนูู ุงูุขููุ</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar488330/index.html">ุงูุฅูุฌููุฒูุฉ ูุน ุฌูุฑุฌ ูุงุฑููู: ูููู ุจุชุญููู ุงููููู ุงูุนุจูุฑู ุญูู ุงููุญุฏุงุช ุงูุนุจุงุฑูุฉ</a></li>
<li><a href="../ar488332/index.html">ุตูุฑ ุ ูุงุญุฏ ุ ุงุซูุงู ุ ูุฑูุฏู ุณูู ูููู</a></li>
<li><a href="../ar488336/index.html">ูุตุงุฆุญ ูุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ ุทู ุฏุงูุฉ ุงูููุฌุฉ</a></li>
<li><a href="../ar488338/index.html">ุงูุชุฏุฑูุจ ุงูุฏุงุฎูู ูู Google: ุฒููุฑุฎ ูููุฏู ูุณูููููู ูุงูู</a></li>
<li><a href="../ar488340/index.html">ุงููููุฉ: ูุทูุฑ Backend</a></li>
<li><a href="../ar488346/index.html">ุชุซุจูุช ุฃู ุฃุฏูุงุช ุจุงุณุชุฎุฏุงู SCIP ู GLPK ูู ุจูุฆุฉ ุงูุชุฑุงุถูุฉ Python 3.7 ุนูู Linux</a></li>
<li><a href="../ar488348/index.html">ูุฏูุฉ ุนุจุฑ ุงูุฅูุชุฑูุช "ุนุดุฑุฉ ุชุญุฏูุงุช ุฑุดููุฉ ูููููุฉ ุงูุชุบูุจ ุนูููุง ูู ุณุงุนุฉ" 17 ูุจุฑุงูุฑ ุงูุณุงุนุฉ 20:00 ููุณูู</a></li>
<li><a href="../ar488352/index.html">ููุงุฑูุฉ ุชูููุฉ VDI: ุฏุงุฎู ุงูุดุฑูุฉ ููุงุจู ุงูุณุญุงุจุฉ ุงูุนุงูุฉ</a></li>
<li><a href="../ar488356/index.html">ุงูุชุฏุฑูุจ ูู ุฌุงูุนุฉ ุณุงูุช ุจุทุฑุณุจุฑุบ ุงูุญููููุฉ ุงูุชูููุฉ ุงูุจุญุฑูุฉ ุนูู ููุชุฌุงุช Dassault Systรจmes</a></li>
<li><a href="../ar488360/index.html">ุฃุณุงุทูุฑ ุงูุจูุงูุงุช ุงูุถุฎูุฉ ูุงูุซูุงูุฉ ุงูุฑูููุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>