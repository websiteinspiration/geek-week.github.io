<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😍 👨🏿‍🏫 💆🏼 T-Rex-duino - a clone of the dinosaur game from the Chrome browser for Arduino 🍇 🧑‍🤝‍🧑 🎂</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Having such a device, Firefox users will also be able to play T-Rex when the page fails to load.
 
 
 
 To begin with, I was interested in homemade su...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>T-Rex-duino - a clone of the dinosaur game from the Chrome browser for Arduino</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500540/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Having such a device, Firefox users will also be able to play T-Rex when the page fails to load.</font></font><br>
<br>
<div style="text-align:center;"><img width="500" src="https://habrastorage.org/webt/bx/us/cv/bxuscvgatrfwmzuz-36o0raptmo.jpeg"></div><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To begin with, I was interested in homemade super minimalistic portable game consoles. </font><font style="vertical-align: inherit;">In particular, the ATtiny85 + OLED display option is very popular:</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><div style="text-align:center;"><img width="300" src="https://habrastorage.org/webt/gz/sq/rp/gzsqrpkkqrcaq-eruycx8eh0mq8.jpeg"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So a person has already </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">made</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 13+ games for such a platform. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It's a funny gadget, but after assembling I don’t feel like playing it for a long time. </font><font style="vertical-align: inherit;">To my taste, the available games are not “speedy” enough to maintain interest for at least a few minutes. </font><font style="vertical-align: inherit;">Therefore, I decided to make a toy that I myself would like to play for 10-20 minutes and maybe even two or three times. </font><font style="vertical-align: inherit;">Fortunately, a relatively interesting game has long been appreciated, addictive and simple enough to fit into a microcontroller.</font></font><br>
<br>
<div style="text-align:center;"><img width="350" src="https://habrastorage.org/webt/xj/jz/mr/xjjzmrhltmh11pg05b4gdjcjqbm.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After 4 days off, I got such a clone.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_o/us/iw/_ousiwakssdaqppmqu96lpfr5gg.gif"></div><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Youtube video</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Unfortunately, it was not possible to fit into the ATtiny85 ROM, so I had to use the classic Arduino. </font><font style="vertical-align: inherit;">Now I even think that this is a better option, because </font><font style="vertical-align: inherit;">Arduino is more accessible, it is easier to flash and there is much to expand. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The game has additional “fittings”: Ti-Rex can bend down (although this is not necessary, you can just jump!), “Lives” are added to extend the gameplay. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can play around with the parameters of the game (such as speed, frequency of "enemies" and the like), many settings are placed at the beginning of the sketch.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assembly</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the minimum version, you will need an Arduino Uno / Nano / Mini, a 128x64 OLED display on the SSD1309 controller and one or two buttons. </font><font style="vertical-align: inherit;">In the portable version, you will need to add a battery with a charge circuit or batteries.</font></font><br>
<br>
<div style="text-align:center;"><img width="600" src="https://habrastorage.org/webt/oo/sf/b5/oosfb5cybt0qh7otjqsvvzonsmw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Scheme. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After the assembly, you need to flash the sketch from the directory </font></font><code>t-rex-duino/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(link to the repository at the end of the article).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Some implementation details</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here are some details that may come in handy for those who want to make their own mini-game. </font><font style="vertical-align: inherit;">I tried to write an “engine” in such a way that it was convenient to make games on it, based on rendering sprites and detecting their “collisions” (in general, these are almost the only two functions of the “engine”, the whole game is built on them). </font><font style="vertical-align: inherit;">Now there are still a lot of free resources, more than 50% in terms of performance and memory. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Because </font><font style="vertical-align: inherit;">I initially relied on a small microcontroller in which there is only 512 bytes of RAM and 2 times less frequency than that of an arduino stone, a quick render with a “virtual” buffer was written for the game, which renders the screen in vertical or horizontal pieces.</font></font><br>
<br>
<div style="text-align:center;"><img width="300" src="https://habrastorage.org/webt/ls/o-/sx/lso-sx5-snbtclq1u6k4ijhcjsc.gif"></div> <br>
<div style="text-align:center;"><img width="300" src="https://habrastorage.org/webt/zf/vn/y1/zfvny1xkwfj3zwmvxgrcj2wxabc.gif"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A vertical virtual buffer requires a minimum of 128 bytes of memory, and a horizontal buffer - from 8 bytes. In this case, a full buffer of the entire screen would take 1kb. The direction of the render should be chosen so that it coincides with the main direction of movement on the screen (less distortion). At the beginning of the sketch, there is a switch of the render mode to demonstrate the operation of both options. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Each sprite in the game is described by a point in the screen to which it needs to be rendered and two one-bit bitmaps: “data” and “mask”. These two bitmaps describe a single-bit image with "transparency". Those. each pixel in the sprite can be “white”, “black” or “transparent”. Along with the project code, there is a python utility for </font></font><code>game-assets-gen/img-conv.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">converting png to c-arrays of the corresponding bitmaps. To start the process of regeneration of existing bitmaps, you can run</font></font><code>gen_assets.bat</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">being in </font></font><code>game-assets-gen/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also, I give an explanatory picture of the coordinate system used.</font></font><br>
<br>
<div style="text-align:center;"><img width="400" src="https://habrastorage.org/webt/re/lf/65/relf65nkj0efibmnkwxyle0ctg0.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">References</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Project repository: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Available scheme, sources for Arduino, a utility for converting images to the format of bitmaps used in the game. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Display Module: diymore 2.42 inch 128x64 OLED Display Module SSD1309 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - That's it, thanks for </font><font style="vertical-align: inherit;">watching </font><font style="vertical-align: inherit;">!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en500518/index.html">Iterations of introducing scrum in a company</a></li>
<li><a href="../en500520/index.html">How to make your applications use around the world: 10 tips from CEO Wachanga</a></li>
<li><a href="../en500528/index.html">About the translation of "practice" / "practicality" without practice / practical</a></li>
<li><a href="../en500530/index.html">Canvas API Memo</a></li>
<li><a href="../en500538/index.html">Podcasts Rusbase, Medusa and KinoPoisk</a></li>
<li><a href="../en500542/index.html">Hack Age of Empires III to change shader quality settings</a></li>
<li><a href="../en500546/index.html">Create a simple table document using the ODF Toolkit</a></li>
<li><a href="../en500552/index.html">How to speed up code review</a></li>
<li><a href="../en500554/index.html">Golang backend server template - part 2 (REST API)</a></li>
<li><a href="../en500556/index.html">Two years of digital transformation in two months</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>