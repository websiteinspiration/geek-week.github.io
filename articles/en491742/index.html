<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍❤️‍💋‍👩 🧙 🏴󠁧󠁢󠁳󠁣󠁴󠁿 Sherbet: ergonomic gaming keyboard 🔈 👨🏽‍🍳 ⚡️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Translation of an article from the Billiam do-it- yourself blog
 
 Some time after my Logitech G13 was no longer produced, it broke down with me, and ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Sherbet: ergonomic gaming keyboard</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/491742/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Translation of an article from the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Billiam</font></font></a></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;"> do-it- </font></i><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">yourself</font></a></i><i><font style="vertical-align: inherit;"> blog</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Some time after my Logitech G13 was no longer produced, it broke down with me, and I decided to develop a replacement for it, which Sherbet called. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First - what happened: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/5fe/9be/905/5fe9be90508fd2dc4fca7ae27a53485c.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keyboard with joystick.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Print files and assembly instructions: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.prusaprinters.org/prints/5072-sherbet-gaming-keypad</font></font></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Design</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I wanted to make an analog thumb joystick like the G13, and I decided to include several ergonomic improvements from other keyboards in the project - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dactyl keyboard</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dactyl Manuform</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kinesis Advantage</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ergodox</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Specifically - the shift of the keys from the vertical, the shift in height, the curvature of the columns and a more convenient tilt.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I chose low-speed keyboard switches (linear NovelKeys Kailh Chocs) to reduce the height of the keyboard - in particular because my desk is taller than you need for a comfortable keyboard set and there is a large shelf underneath. Between the shelf and the tabletop there is about 10 cm left, both for the keyboard and for the brush. If you have no problems with the place, I recommend a more compatible switch - then you will have no problems with choosing buttons for it. I also recommend starting with Dactyl or Dactyl-Manuform, as this project took me much more time and effort than I might have expected.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I started by modeling keys based on Kailh's specifications for the switches before they even came to me, then I tried to find a convenient column curvature, printed a couple of test versions, and then printed a few more to check the vertical indentation. Here's what I got: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/a9c/aca/4f7/a9caca4f772cdeb5d31b65295d4292fa.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selecting the bending radii of the columns </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/53a/e4c/cb6/53ae4ccb6f44518c645658e3f0178c8e.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selecting the layout and height of the column </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/9a6/390/d28/9a6390d2852d97f1ccfcbb4ba324395d.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Designing the keys, view ¾ </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/3b7/8d1/9dd/3b78d19dd6d244f1203571677d9fc8ec.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Top view, you can see the shift of the columns </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/157/383/62b/15738362be99cba91001aa60f72428ef.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Front view, you can see the spread of the columns in height</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Selecting the scheme, I started to design the connectors for the switches, which should make main backing plate. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/3c2/43b/7de/3c243b7deb0904664f2a1f88d248bb44.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Key plate model </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/41a/674/94c/41a67494c3724c0b5fe4c63ff33ff6e8.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">First print after removal and cleaning of supports. </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/c16/a71/6ca/c16a716ca177c4bd116bfdc04a1378ce.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plate with switches. </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/567/0b3/37a/5670b337a8e3d762decae74de75c30a8.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After adding keys</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I picked up different angles of the keyboard, and stopped at an angle of about 20 degrees. </font><font style="vertical-align: inherit;">And this was again done so that there was a place above the keyboard. </font><font style="vertical-align: inherit;">It would be more convenient to make the angle a little larger, but it is still more convenient than the flat G13 and my current ergonomic keyboard. </font><font style="vertical-align: inherit;">In Fusion 360, I made the tilt angle changeable so that the rest of the project adjusts to it. </font><font style="vertical-align: inherit;">After complicating the project, this parameter could no longer be configured without breaking others. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/0bc/59f/d91/0bc59fd91d64431fcfe883f20090274e.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Printed support plate for tilt selection</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Brush stand</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then I started work on the brush stand. I needed a comfortable stand suitable for my hand, and I wanted to make a mold for it. I made a clay clay stand, then used </font><font style="vertical-align: inherit;">the </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Meshroom </font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">photogrammetric</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> package </font><font style="vertical-align: inherit;">(and a bunch of photos) to create a 3D model, and then scaled it so that its size matches the original. </font><i><font style="vertical-align: inherit;">Rough approximation to the stand using polymer clay. </font></i><i><font style="vertical-align: inherit;">Many photos. </font></i><i><font style="vertical-align: inherit;">Parting the stand with textures from Meshroom. </font></i><i><font style="vertical-align: inherit;">The model imported into Fusion 360.</font></i><font style="vertical-align: inherit;"> 
Then I just walked along the main contours of the model, smoothed it and got the desired print: </font><i><font style="vertical-align: inherit;">A scanned model with a superimposed 3D </font></i><i><font style="vertical-align: inherit;">model of polymer clay next to it with a smoothed and printed version</font></i></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/032/b1a/914/032b1a914fff07c3cf4b62f0659cf938.jpg"><br>
<i><font style="vertical-align: inherit;"></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/716/b1d/dc2/716b1ddc2138be5c425d37a68737e0b8.gif"><br>
<i><font style="vertical-align: inherit;"></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/06b/912/6ee/06b9126eef78fe036679db727e99b980.png"><br>
<i><font style="vertical-align: inherit;"></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/3ef/387/5fc/3ef3875fc3cdf50aa014b7fdd399c620.png"><br>
<i><font style="vertical-align: inherit;"></font></i><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/d91/201/053/d91201053695fca1c28db81484dcfb7c.png"><br>
<i><font style="vertical-align: inherit;"></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/804/f86/1f4/804f861f4c44c87139755fbbb61b467b.jpg"><br>
<i><font style="vertical-align: inherit;"></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It was interesting to do this, and the result was convenient, but then I found that during printing all these bends prevent the hand from moving, so the later versions are all flat. </font><font style="vertical-align: inherit;">Well…</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Housing</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then I began to work on the general case of the device, and this turned out to be the most difficult stage of all. I still work uncertainly in CAD, and haven’t done anything so complicated before. Attempts to find ways to describe the composite curves and connect the two surfaces proved to be very difficult, and took most of the time in this project. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/426/8c4/605/4268c460505c8418b5dc6f2714ce5133.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A computer model of the case along with an Arduino joystick and thumb buttons.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
I also found for myself a more convenient </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">environment for rendering</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , as a result of which the images became better. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/377/416/165/377416165dba6fe31639706e58668f04.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Re-made computer case model </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/f67/d02/6b0/f67d026b0f028c20643d02ed2e2a1a16.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Computer case model, view in,</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I printed only the thumb area to check its convenience and location. Everything turned out to be normal, but the joystick module was too voluminous to be placed exactly where it would be the best from the point of view of ergonomics. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/a90/bcc/af5/a90bccaf58b1ee665453369a43c5055e.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A printed joystick with buttons.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Instead, I purchased a much smaller Joy-Con controller for the Nintendo Switch from a third-party manufacturer, which can be placed much closer to the keys, and there is still room for connection. It connects to a (less convenient) flat cable of 5 wires 0.5 mm. I took the interface board for 6 contacts on Amazon, but it is much cheaper to take them from eBay or AliExpress. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/d60/e9b/a5d/d60e9ba5d34936b32a772cde4c56bf14.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comparison of </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/683/ee0/069/683ee00692c1faa16648961a4fa2d27a.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Joysticks by Joy-Con Joystick with Switches</font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/b65/d3a/b40/b65d3ab402644fb0b669ffaee067a341.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modified housing for a small joystick</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Having finished with a shell, I added support for electronic components. </font><font style="vertical-align: inherit;">For the joystick, it was necessary to make a small protective panel, screwed to the side of the housing. </font><font style="vertical-align: inherit;">For the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teensy microcontroller,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I made a holder, into which it simply fits tightly, and screws for it. </font><font style="vertical-align: inherit;">Added space for plastic clamps and 4 mm holes for attaching the stand for the brush. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I also use the micro USB interface for the main USB controller so that the microcontroller does not wear out and get damaged. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/65d/36b/fc3/65d36bfc3323afd5c75ca7322bf624fd.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The insides of the case</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
I think, for the whole of this design phase, it took a total of a month. </font><font style="vertical-align: inherit;">I will not try to guess the number of hours that went into it - let's say that there were “a lot of them”.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Print</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After I spent so much time designing and testing, it seemed to me that the final print of the project was boring and without incident. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/61b/4dd/aee/61b4ddaee9f35360c5138142a9ed4f84.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Printing with 0.2 mm resolution on Maker Select Plus took 15 hours. </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/16e/ab0/459/16eab0459d1192864fbae29e6c08781b.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Post-processing: removal of backups and cleaning. </font><font style="vertical-align: inherit;">Damage turned out to be small. </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/745/6b1/a4d/7456b1a4d8d987a557735a4ef6d673c9.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The upper part of the case with installed electronics.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
I also printed the cover with white plastic, and glued a cork coating to it. </font><font style="vertical-align: inherit;">To connect the cover to the body, I use M3 screws and a threaded mating sleeve </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inserted into the plastic by heating</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/de4/ae5/d59/de4ae5d592abc9997a2fcfb993ab7f30.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Non-slip cork cover</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Painting</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
During the design, I went over several color solutions, and eventually settled on a similar one. There are not many color options, since the keys are only black and white. </font><font style="vertical-align: inherit;">
Painting </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/994/fa8/55f/994fa855fc81963bdb1860cf0b3dc07c.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> For the final finish, I first sanded the part with 220 grit sandpaper to smooth out the strips from the layers and other problems, and then covered everything with a primer. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/2f2/946/923/2f2946923720feca63e29f332dc791ac.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The first layer of soil</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
After the primer, I used putty from Bondo, sanded the part (sandpaper 220 and 600), then again covered with primer, putty, and sanded again. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/862/66a/807/86266a807a16d878d64564d5a2d41637.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After two passes with primer and putty, and hard sanding. </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/b4a/921/1eb/b4a9211ebb575abda6789040fbac84a2.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Another layer, with white primer</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
, I made a strip with a thin vinyl film, and then covered this place with pink color from a spray gun. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/b93/623/387/b936233872bdce5af77c8a9e3756104f.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Case and paint residue</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After painting, I coated the part with 4-5 layers of glossy coating, and then sanded it with 1200 grit to remove dust, fluff and bugs, and then varnished again. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It looks good, but the roughness and spots of excess varnish are visible. </font><font style="vertical-align: inherit;">I polished the worst places a little with sandpaper 1200, and then polished it with a special compound. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/344/295/c12/344295c1290a422d2ae4ac78b9ed67c8.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After grinding and polishing</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assembly</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I made pimples for blind orientation by pressing 1.5 mm ceramic balls from the bearings into the keys. The photo shows one hole too large and one too small, into which I pressed the ball (without glue). I don’t know, it would be better to insert it into a large hole with glue than to deform the plastic by pushing the ball there. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/74a/f15/8a0/74af158a097bd1b6a8cc2a0afa972d0e.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When I had exhausted all the tasks that would help me deal with procrastination further, I started connecting wires, starting with rows and columns of keys. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I did not find thinner wires in local stores, and the only single-core wire that was sold was 22 awg [ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cross-section 0.325 mm sq. / approx. perev.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">] - and it would be too hard to bend around the column offsets and stuff it into a small space between the case and the switches. Instead, I used a 28 awg stranded wire [ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cross section 0.089 mm.kv. / approx. perev.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ], which was pulled from a flat cable, stripped with a wire stripper, and then made loops at the ends. With a thinner single-core cable, everything would be simpler. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/05f/e23/807/05fe2380755538ccde6f4e23cb3117e4.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Key switches with soldered rows and columns </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/938/f91/ed1/938f91ed1b41695eea20df2d9139bd7f.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rows and columns connected to a flat cable </font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">Rows, columns, a joystick and a USB interface board are </font></i><i><font style="vertical-align: inherit;">connected</font></i></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/591/0e7/077/5910e7077b3bfc2c14cc4a75c21a35a5.jpg"><br>
<i><font style="vertical-align: inherit;"></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I made a brush stand fastened to two M4 screws, which are screwed into the sleeve inserted into the plastic of the main body by heating. </font><font style="vertical-align: inherit;">After installing the couplings, it turned out that the holes do not match very well, so I can’t assemble them yet. </font><font style="vertical-align: inherit;">I plan to retype the case with the hole into which the M4 nut will be inserted, it will be easier to align it. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In practice, you need to somehow secure the keyboard on the table. </font><font style="vertical-align: inherit;">Even with a cork bottom and extra weight, the keyboard shifts when using the joystick. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS: I redid and retyped the stand so that it used two M4 nuts, and everything works fine.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Done!</font></font></h2><br>
<img src="https://habrastorage.org/getpro/habr/post_images/9de/aac/e03/9deaace036b1d73e1c1ae1333c5fc3b6.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ready-made housing and temporary brush holder </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/c70/a5c/32e/c70a5c32eb4c9c7c6515609b454cbb0e.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Housing, bottom view</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firmware</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Initially, I planned to use QMK as firmware, using a pool request with a joystick support that has not yet been included in the main branch. </font><font style="vertical-align: inherit;">However, QMK does not very well support the new ARM Teensy controllers (versions greater than 3.2). </font><font style="vertical-align: inherit;">The following patch does not yet support ARM controllers. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If this patch is implemented, as well as ARM support, I will finish and publish the version with QMK. </font><font style="vertical-align: inherit;">In the meantime, I sketched a sketch for Arduino, based on someone else's work. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It has two modes, one is the standard QWERTY layout and a joystick with one button, and the second is where all the keys are assigned to the joystick buttons. </font><font style="vertical-align: inherit;">As a result, there are enough buttons to configure the Steam controller configurator, and it can be used as an XInput device with support for a wider range of games.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Optional code to give the device a name</font></font></b><div class="spoiler_text">//  ,    .     ,   sherbet.ino.<br>
#include «usb_names.h»<br>
<br>
#define PRODUCT_NAME {'s', 'h', 'e', 'r', 'b', 'e', 't'}<br>
#define PRODUCT_NAME_LEN 7<br>
<br>
struct usb_string_descriptor_struct usb_string_product_name = {<br>
 2 + PRODUCT_NAME_LEN * 2,<br>
 3,<br>
 PRODUCT_NAME<br>
};<br>
<br>
</div></div><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firmware</font></font></b><div class="spoiler_text">/*<br>
 Original programming by Stefan Jakobsson, 2019<br>
 Released to public domain<br>
 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">forum.pjrc.com/threads/55395-Keyboard-simple-firmware</a><br>
*/<br>
/*<br>
Copyright 2019 Colin Fein<br>
Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the «Software»), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:<br>
The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.<br>
THE SOFTWARE IS PROVIDED «AS IS», WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.<br>
*/<br>
<br>
// Use USB Type: Keybord+Mouse+Joystick<br>
<br>
#include &lt;Bounce2.h&gt;<br>
<br>
const int ROW_COUNT = 4; //Number of rows in the keyboard matrix<br>
const int COL_COUNT = 6; //Number of columns in the keyboard matrix<br>
<br>
const int DEBOUNCE = 5; //Adjust as needed: increase if bouncing problem, decrease if not all keypresses register; not less than 2<br>
const int SCAN_DELAY = 5; //Delay between scan cycles in ms<br>
<br>
const int JOYSTICK_X_PIN = 14; // Analog pin used for the X axis<br>
const int JOYSTICK_Y_PIN = 15; // Analog pin used for the Y axis<br>
const bool REVERSE_X = true; // Reverses X axis input<br>
const bool REVERSE_Y = true; // Reverses Y axis input<br>
const int MIN_X = 215; // Minimum range for the X axis<br>
const int MAX_X = 780; // Maxixmum range for the X axis<br>
const int MIN_Y = 280; // Minimum range for the Y axis<br>
const int MAX_Y = 815; // Maximum range for the Y axis<br>
const int BUTTON_COUNT = 1; // Number of joystick buttons<br>
<br>
const int JOY_MIN = 0;<br>
const int JOY_MAX = 1023;<br>
<br>
Bounce buttons[BUTTON_COUNT];<br>
Bounce switches[ROW_COUNT * COL_COUNT];<br>
<br>
boolean buttonStatus[ROW_COUNT * COL_COUNT + BUTTON_COUNT]; //store button status so that inputs can be released<br>
boolean keyStatus[ROW_COUNT * COL_COUNT]; //store keyboard status so that keys can be released<br>
<br>
const int rowPins[] = {3, 2, 1, 0}; //Teensy pins attached to matrix rows<br>
const int colPins[] = {11, 10, 9, 8, 7, 6}; //Teensy pins attached to matrix columns<br>
const int buttonPins[] = {12}; //Teensy pins attached directly to switches<br>
<br>
int axes[] = {512, 512};<br>
<br>
int keyMode = true; // Whether to begin in standard qwerty mode or joystick button mode<br>
<br>
// Keycodes for qwerty input<br>
const int layer_rows[] = {<br>
 KEY_ESC, KEY_1, KEY_2, KEY_3, KEY_4, KEY_5,<br>
 KEY_TAB, KEY_Q, KEY_W, KEY_E, KEY_R, KEY_T,<br>
 KEY_CAPS_LOCK, KEY_A, KEY_S, KEY_D, KEY_F, KEY_G,<br>
 MODIFIERKEY_SHIFT, KEY_Z, KEY_X, KEY_C, KEY_V, KEY_B<br>
};<br>
// keystroke to use (counting from top left to top right of keypad) to switch between standard qwerty input and joystick buttons<br>
// default uses B+5<br>
const int mode_swap_keystroke[2] = {23, 5};<br>
int pivoted_keystroke[2]; //rows to columns<br>
boolean keystrokeModifier = false; //whether beginning of keystroke is active<br>
<br>
// rows to columns<br>
int layer[ROW_COUNT * COL_COUNT];<br>
<br>
void setup() {<br>
 int i;<br>
 //pivot key array for row-to-column diodes<br>
 for (i = 0; i &lt; ROW_COUNT * COL_COUNT; i++) {<br>
 layer[rotateIndex(i)] = layer_rows[i];<br>
<br>
// create debouncers for row pins<br>
 Bounce debouncer = Bounce();<br>
 debouncer.attach(rowPins[i % ROW_COUNT]);<br>
 debouncer.interval(DEBOUNCE);<br>
 switches[i] = debouncer;<br>
 }<br>
<br>
//convert keystroke to (pivoted) indexes<br>
 for (i = 0; i &lt; 2; i++) {<br>
 pivoted_keystroke[i] = rotateIndex(mode_swap_keystroke[i]);<br>
 }<br>
<br>
// create debouncers for non-matrix input pins<br>
 for (i = 0; i &lt; BUTTON_COUNT; i++) {<br>
 Bounce debouncer = Bounce();<br>
<br>
debouncer.attach(buttonPins[i], INPUT_PULLUP);<br>
 debouncer.interval(DEBOUNCE);<br>
 buttons[i] = debouncer;<br>
 }<br>
<br>
// Ground first column pin<br>
 pinMode(colPins[0], OUTPUT);<br>
 digitalWrite(colPins[0], LOW);<br>
<br>
for (i = 1; i &lt; COL_COUNT; i++) {<br>
 pinMode(colPins[i], INPUT);<br>
 }<br>
<br>
//Row pins<br>
 for (i = 0; i &lt; ROW_COUNT; i++) {<br>
 pinMode(rowPins[i], INPUT_PULLUP);<br>
 }<br>
}<br>
<br>
void loop() {<br>
 scanMatrix();<br>
 scanJoy();<br>
 delay(SCAN_DELAY);<br>
}<br>
<br>
/*<br>
 Scan keyboard matrix, triggering press and release events<br>
*/<br>
void scanMatrix() {<br>
 int i;<br>
<br>
for (i = 0; i &lt; ROW_COUNT * COL_COUNT; i++) {<br>
 prepareMatrixRead(i);<br>
 switches[i].update();<br>
<br>
if (switches[i].fell()) {<br>
 matrixPress(i);<br>
 } else if (switches[i].rose()) {<br>
 matrixRelease(i);<br>
 }<br>
 }<br>
}<br>
<br>
/*<br>
 Scan physical, non-matrix joystick buttons<br>
*/<br>
void scanJoy() {<br>
 int i;<br>
 boolean anyChange = false;<br>
<br>
for (i=0; i &lt; BUTTON_COUNT; i++) {<br>
 buttons[i].update();<br>
 if (buttons[i].fell()) {<br>
 buttonPress(i);<br>
 anyChange = true;<br>
 } else if (buttons[i].rose()) {<br>
 buttonRelease(i);<br>
 anyChange = true;<br>
 }<br>
 }<br>
<br>
int x = getJoyDeflection(JOYSTICK_X_PIN, REVERSE_X, MIN_X, MAX_X);<br>
 int y = getJoyDeflection(JOYSTICK_Y_PIN, REVERSE_Y, MIN_Y, MAX_Y);<br>
 Joystick.X(x);<br>
 Joystick.Y(y);<br>
<br>
if (x != axes[0] || y != axes[y]) {<br>
 anyChange = true;<br>
<br>
axes[0] = x;<br>
 axes[1] = y;<br>
 }<br>
<br>
if (anyChange) {<br>
 Joystick.send_now();<br>
 }<br>
}<br>
<br>
/*<br>
 Return a remapped and clamped analog value<br>
*/<br>
int getJoyDeflection(int pin, boolean reverse, int min, int max) {<br>
 int input = analogRead(pin);<br>
 if (reverse) {<br>
 input = JOY_MAX — input;<br>
 }<br>
<br>
return map(constrain(input, min, max), min, max, JOY_MIN, JOY_MAX);<br>
}<br>
/*<br>
 Returns input pin to be read by keyScan method<br>
 Param key is the keyboard matrix scan code (col * ROW_COUNT + row)<br>
*/<br>
void prepareMatrixRead(int key) {<br>
 static int currentCol = 0;<br>
 int p = key / ROW_COUNT;<br>
<br>
if (p != currentCol) {<br>
 pinMode(colPins[currentCol], INPUT);<br>
 pinMode(colPins[p], OUTPUT);<br>
 digitalWrite(colPins[p], LOW);<br>
 currentCol = p;<br>
 }<br>
}<br>
<br>
/*<br>
 Sends key press event<br>
 Param keyCode is the keyboard matrix scan code (col * ROW_COUNT + row)<br>
*/<br>
void matrixPress(int keyCode) {<br>
 if (keyMode) {<br>
 keyPress(keyCode);<br>
 } else {<br>
 buttonPress(BUTTON_COUNT + keyCode);<br>
 }<br>
<br>
keystrokePress(keyCode);<br>
}<br>
<br>
/*<br>
 Sends key release event<br>
 Param keyCode is the keyboard matrix scan code (col * ROW_COUNT + row)<br>
*/<br>
void matrixRelease(int keyCode) {<br>
 //TODO: Possibly do not trigger keyboard.release if key not already pressed (due to changing modes)<br>
 if (keyMode) {<br>
 keyRelease(keyCode);<br>
 } else {<br>
 buttonRelease(BUTTON_COUNT + keyCode);<br>
 }<br>
<br>
keystrokeRelease(keyCode);<br>
}<br>
<br>
/*<br>
 Send key press event<br>
*/<br>
void keyPress(int keyCode) {<br>
 Keyboard.press(layer[keyCode]);<br>
 keyStatus[keyCode]=true;<br>
}<br>
<br>
/*<br>
 Send key release event<br>
*/<br>
void keyRelease(int keyCode) {<br>
 Keyboard.release(layer[keyCode]);<br>
 keyStatus[keyCode]=false;<br>
}<br>
<br>
/*<br>
 Send joystick button press event<br>
 Param buttonId 0-indexed button ID<br>
*/<br>
void buttonPress(int buttonId) {<br>
 Joystick.button(buttonId + 1, 1);<br>
 buttonStatus[buttonId] = true;<br>
}<br>
<br>
/*<br>
 Send joystick button release event<br>
 Param buttonId 0-indexed button ID<br>
*/<br>
void buttonRelease(int buttonId) {<br>
 Joystick.button(buttonId + 1, 0);<br>
 buttonStatus[buttonId] = false;<br>
}<br>
<br>
/*<br>
 Listen for keystroke keys, and change keyboard mode when condition is met<br>
*/<br>
void keystrokePress(int keyCode) {<br>
 if (keyCode == pivoted_keystroke[0]) {<br>
 keystrokeModifier = true;<br>
 } else if (keystrokeModifier &amp;&amp; keyCode == pivoted_keystroke[1]) {<br>
 releaseLayer();<br>
 keyMode = !keyMode;<br>
 }<br>
}<br>
<br>
/*<br>
 Listen for keystroke key release, unsetting keystroke flag<br>
*/<br>
void keystrokeRelease(int keyCode) {<br>
 if (keyCode == pivoted_keystroke[0]) {<br>
 keystrokeModifier = false;<br>
 }<br>
}<br>
<br>
/*<br>
 Releases all matrix and non-matrix keys; called upon change of key mode<br>
*/<br>
void releaseLayer() {<br>
 int i;<br>
 for (i = 0; i &lt; ROW_COUNT * COL_COUNT; i++) {<br>
 matrixRelease(i);<br>
 }<br>
<br>
for (i=0; i &lt; BUTTON_COUNT; i++) {<br>
 if (buttonStatus[i]) {<br>
 buttonRelease(i);<br>
 }<br>
 }<br>
}<br>
<br>
/*<br>
 Converts an index in a row-first sequence to column-first<br>
 [1, 2, 3] [1, 4, 7]<br>
 [4, 5, 6] =&gt; [2, 5, 8]<br>
 [7, 8, 9] [3, 6, 9]<br>
*/<br>
int rotateIndex(int index) {<br>
 return index % COL_COUNT * ROW_COUNT + index / COL_COUNT;<br>
}<br>
<br>
</div></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en491726/index.html">Expand nested columns - lists using the R language (tidyr package and unnest family functions)</a></li>
<li><a href="../en491728/index.html">DRY principle with Laravel</a></li>
<li><a href="../en491732/index.html">Is there life after Scratch, or how to introduce a child to Python</a></li>
<li><a href="../en491736/index.html">TMS1000: the first commercially available microcontroller</a></li>
<li><a href="../en491740/index.html">The Internet of Things in Yandex.Cloud: How Yandex IoT Core and Yandex Cloud Functions Services Are Arranged</a></li>
<li><a href="../en491744/index.html">Iranian hackers exploited vulnerabilities in VPN</a></li>
<li><a href="../en491746/index.html">The history of speech synthesis: the era of electrical solutions</a></li>
<li><a href="../en491748/index.html">Technologies that help the blind learn English</a></li>
<li><a href="../en491750/index.html">We write substring search better than in textbooks</a></li>
<li><a href="../en491760/index.html">Telegram. Taxi for 200 lines of code</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>