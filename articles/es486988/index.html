<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèÇüèΩ üí∫ üë©‚Äç‚ù§Ô∏è‚Äçüíã‚Äçüë® Estaci√≥n meteorol√≥gica de bolsillo üö¥üèª üåæ üñïüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="S√≠, la estaci√≥n meteorol√≥gica se trata de algo que mide una gran cantidad de par√°metros desde la direcci√≥n y la fuerza del viento hasta el nivel de ra...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Estaci√≥n meteorol√≥gica de bolsillo</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/486988/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S√≠, la estaci√≥n meteorol√≥gica se trata de algo que mide una gran cantidad de par√°metros desde la direcci√≥n y la fuerza del viento hasta el nivel de radiaci√≥n solar, pero no hab√≠a un t√©rmino m√°s adecuado, por lo que debe confundirse. </font><font style="vertical-align: inherit;">Pero sobre el tama√±o, todo es justo.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/sb/vf/yl/sbvfylae2jg5ca22n6incvh0_le.jpeg"></div><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El dispositivo, tal vez, no tiene mucho valor comercial, porque </font><font style="vertical-align: inherit;">Incluso en la cantidad de componentes, es inferior a muchos chinos, y no solo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">productos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que tienen una funcionalidad similar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El bricolaje tambi√©n es dif√≠cil de nombrar debido a cosas como la necesidad de pedir placas de circuitos impresos con la posterior soldadura de componentes peque√±os / sin plomo, lo que reduce en gran medida el n√∫mero de personas que desean repetir el dispositivo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La estaci√≥n meteorol√≥gica en s√≠ misma se cre√≥ como algo, quiero pensar, est√©tico, compacto y capaz de evaluar r√°pidamente la temperatura + humedad alrededor, y una vez que el sensor seleccionado tambi√©n puede informar sobre la presi√≥n, entonces esto tambi√©n. </font><font style="vertical-align: inherit;">Todo se parece a esto (se puede hacer clic):</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/xy/6q/1n/xy6q1n0mungrju5uff3k_qznrhw.jpeg"></div></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/pa/ur/8t/paur8tgioddbzxqzwbkywgcr9pg.jpeg"></div><br>
</a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comparado:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/on/6z/bi/on6zbi8c1riuymare1htfaoy3gy.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sobre el hierro</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como sensor, se eligi√≥ el BOSCH-BME280, que proporciona los par√°metros ambientales requeridos incluso de acuerdo con I2C, incluso de acuerdo con SPI, ocho patas en un estuche LGA sin plomo de 2.5 x 2.5 mm, relativamente econ√≥mico, peque√±o. Inicialmente, se plane√≥ un sensor m√°s sofisticado de la misma serie BME680, que, adem√°s de la temperatura, la humedad y la presi√≥n atmosf√©rica, seg√∫n la hoja de datos, tambi√©n puede evaluar la calidad del aire mediante el denominado √çndice de calidad del aire (IAQ). Parece que no est√° mal, pero de hecho result√≥ que IAQ solo se puede obtener utilizando BSEC: Bosch Software Environmental Cluster, que, en funci√≥n de las lecturas del sensor y el cambio de estas lecturas, calcula IAQ. Parece que puede tomar el testimonio usted mismo y calcular todo; Ciertamente no de esa manera. Bajo pedido para medir la calidad del aire, el sensor proporciona resistencia, en ohmios.Calienta el interior de una peque√±a √°rea sensible que reacciona con conductividad a la presencia de sustancias org√°nicas vol√°tiles: compuestos org√°nicos vol√°tiles (COV) y da el resultado, es decir resistencia a esta √°rea. B√°sicamente,</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">algunos artesanos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ofrecen sus propios algoritmos para interpretar estas lecturas sin BSEC, pero, entre otras cosas, el costo m√∫ltiple, en comparaci√≥n con el BME280, no dej√≥ otra opci√≥n.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/xm/6f/ua/xm6fuaet6jexqzojp2ijibwk8yg.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La pantalla consta de dos TOS-F2101, estos son indicadores ordinarios de siete segmentos de color verde con un c√°todo com√∫n. </font><font style="vertical-align: inherit;">De lo notable, este es el tama√±o y la carcasa para el montaje en superficie, lo que le permite colocarlos de una manera poco convencional. </font><font style="vertical-align: inherit;">Por cierto, estos son los indicadores planos m√°s peque√±os que se encontraron a la venta y, en su mayor parte, determinan el tama√±o de todo el dispositivo.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/mv/s2/ur/mvs2urkyspmxu99dx60ynxqs0ju.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Administra todo el STM32F072 en un paquete QFPN de 48 pines. </font><font style="vertical-align: inherit;">Seleccionado, nuevamente, en funci√≥n del tama√±o, la disponibilidad de perif√©ricos y el n√∫mero requerido de conclusiones para controlar los indicadores que, en la versi√≥n dual, por alguna raz√≥n, no ocurren y las conclusiones deben ser decentes.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dd/1q/ph/dd1qph6m-u11ozvyb8nudzl1mf0.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El resto son resistencias, condensadores, un convertidor de voltaje de 3.3 V, cuanto menos, mejor, dentro de l√≠mites razonables y componentes TTX, por supuesto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El conector USB est√° hecho en la placa. Para un contacto confiable, el grosor de la PCB debe ser de aproximadamente 2 mm. Si se gu√≠a por el dibujo en USB Tipo A, entonces hay un poco m√°s, pero si tiene en cuenta la m√°scara en ambos lados, resulta bastante tolerable. Por supuesto, este formato de conector deja m√°s posibilidades de da√±os mec√°nicos a la salida USB, pero, en general, esto se puede solucionar con una unidad flash normal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El bot√≥n t√°ctil es un pol√≠gono redondo debajo de la imagen en el tablero, el bot√≥n responde a un toque corto y largo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s de la pantalla, la placa tiene tres LED que indican cu√°l de las lecturas se muestra actualmente en el indicador.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cuanto al software. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El programa est√° escrito usando CMSIS, la frecuencia de operaci√≥n es de 48 MHz y de una fuente interna; hay uno aqu√≠, incluso puedes usar USB sin usar cuarzo externo. Para mayor flexibilidad y, posiblemente, expansi√≥n de la funcionalidad, se agrega FreeRTOS.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El bot√≥n t√°ctil es manejado por el controlador de detecci√≥n t√°ctil (TSC). Dado que no hay teclado desde los botones t√°ctiles en el tablero o los controles deslizantes, cuando las almohadillas t√°ctiles se combinan en una l√≠nea, y hay un sensor que captura toques cortos y largos, no tiene sentido usar la biblioteca completa de ST. El principio de funcionamiento del sensor sensor es simple, hay varias conclusiones combinadas en grupos, un condensador (Muestreo capasitor) Cs est√° conectado a uno de ellos, esta conclusi√≥n se vuelve ejemplar, las conclusiones restantes del grupo se pueden conectar a los pol√≠gonos de los sensores, que de hecho tambi√©n son condensadores Cx . El controlador carga la capacitancia del capacitor de vertedero Cx y luego esta carga se destila al modelo Cs, la operaci√≥n se repite hasta cierto l√≠mite de voltaje en Cs. La capacidad del sensor suele ser peque√±a,por lo tanto, se requerir√°n muchas de estas operaciones y hay un registro separado (TSC_IOGxCR) para contar. Si toca el sensor, entonces la capacitancia Cx ser√° mayor y los ciclos para cargar Cs se necesitar√°n menos, se repara inmediatamente y se informa un toque hacia arriba. Por cierto, la capacitancia del sensor comienza a aumentar cuando no hay contacto directo, por lo que el sensor puede protegerse del contacto f√≠sico, por ejemplo con una m√°scara, o puede registrar diferentes grados de aproximaci√≥n.o fijar diferentes grados de aproximaci√≥n.o fijar diferentes grados de aproximaci√≥n.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para comunicarse con el BME280, se utiliza la interfaz I2C. </font><font style="vertical-align: inherit;">La implementaci√≥n de I2C en STM32F072 es m√°s simple que en el popular STM32F103, entre otras cosas, no necesita rastrear por separado 1/2 / muchos bytes recibidos, es suficiente especificar su n√∫mero por adelantado (I2C_CR2.NBYTES [7: 0]). </font><font style="vertical-align: inherit;">La misma biblioteca para trabajar con el sensor est√° </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">provisto</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y se recomienda para su uso por el fabricante del sensor. </font><font style="vertical-align: inherit;">Para leer las lecturas utilizando la biblioteca, debe crear dos estructuras: para la configuraci√≥n y los datos. </font><font style="vertical-align: inherit;">En la configuraci√≥n que necesita hacer:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">direcci√≥n del sensor en el bus I2C</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Funciones de lectura / escritura I2C, as√≠ como funci√≥n de retraso</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el n√∫mero de lecturas de indicaciones para promediar (Sobremuestreo) x1, x2, etc., para cada uno de los par√°metros temperatura / humedad / presi√≥n</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coeficiente de filtrado para ADC</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">per√≠odo de eliminaci√≥n de valores de par√°metros</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en general, cu√°l de los par√°metros se puede leer, por ejemplo, puede dejar una temperatura</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">modo de operaci√≥n, "normal" - con lecturas peri√≥dicas, "forzado" - tomando lecturas a pedido</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En principio, si se selecciona el modo "normal", los valores reales de las lecturas se pueden obtener ejecutando la funci√≥n "bme280_get_sensor_data", mirar√° los registros de sensores correspondientes, leer√° las lecturas directas y luego las procesar√° de acuerdo con los factores de correcci√≥n registrados en el microcircuito en la f√°brica. </font><font style="vertical-align: inherit;">Como resultado, la estructura de datos de salida contendr√° la temperatura en grados Celsius, la humedad relativa en porcentaje, la presi√≥n atmosf√©rica en Pascales. </font><font style="vertical-align: inherit;">En el modo "forzado", lo mismo, solo que cada vez antes de leer las lecturas, debe ejecutar la conversi√≥n "bme280_set_sensor_mode".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El principio general del dispositivo es el siguiente: con√©ctese a USB o a Power Bank en una versi√≥n m√≥vil. Para la visualizaci√≥n inicial y el cambio de lecturas, un toque breve del sensor, para desactivar, un toque prolongado. Primero, se muestra la temperatura en grados Celsius, luego la humedad relativa en porcentaje y la presi√≥n atmosf√©rica en mil√≠metros de mercurio, porque solo hay dos indicadores, y el indicador de presi√≥n rara vez va m√°s all√° de setecientos, entonces el n√∫mero siete es virtual aqu√≠. Si no toca el sensor por un tiempo, los indicadores se apagar√°n para que, por ejemplo, no descargue el Power Bank. El consumo promedio del dispositivo es de ~ 50 mA, y los principales consumidores son solo indicadores, si los apaga, el conteo va a microamperios.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/os/yc/m4/osycm4d_nxftmdscyosimsmxyqu.jpeg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/9g/of/6q/9gof6qylzgjq2zeba4rkgumqvze.jpeg"></div><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/n91MdTEM7X4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, el costo total de los componentes en enero de 2020 result√≥ ser de aproximadamente 850 rublos, esto sin tener en cuenta el tablero, fue f√°cil, porque </font><font style="vertical-align: inherit;">el fabricante ten√≠a descuentos de A√±o Nuevo y yo tengo cupones, pero es poco probable que vuelva a suceder en el futuro cercano, al menos hasta el pr√≥ximo diciembre. </font><font style="vertical-align: inherit;">Bueno, aquellos que quieran familiarizarse con la fuente pueden hacerlo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqu√≠</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es486988/">https://habr.com/ru/post/es486988/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es486976/index.html">Problemas de la educaci√≥n en informaci√≥n rusa y sus posibles soluciones.</a></li>
<li><a href="../es486978/index.html">Notas de campo: una de las mayores conferencias de c√≥digo abierto FOSDEM 2020</a></li>
<li><a href="../es486980/index.html">Kim Dotcom: Atrapado, la persona m√°s buscada en l√≠nea. Parte 1</a></li>
<li><a href="../es486982/index.html">C√≥mo aprender el desarrollo front-end, encontrar tu primer trabajo y no recibir golpes</a></li>
<li><a href="../es486984/index.html">Python Gateway en InterSystems IRIS</a></li>
<li><a href="../es486994/index.html">Angular: Pruebas de integraci√≥n (pruebas superficiales)</a></li>
<li><a href="../es486998/index.html">Impresi√≥n barata y r√°pida de la impresora t√©rmica</a></li>
<li><a href="../es487000/index.html">Citrus: Style Set para AvaloniaUI</a></li>
<li><a href="../es487002/index.html">Marketing de realidad aumentada: qu√© es y c√≥mo funciona</a></li>
<li><a href="../es487004/index.html">Por qu√© cada vez m√°s estados de EE. UU. Est√°n devolviendo la neutralidad de la red: discuta el curso de los eventos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>