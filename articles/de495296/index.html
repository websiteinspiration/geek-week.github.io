<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧘 🚒 🔡 Forensik, SQL-Injection und leidende Katze: Analyse der Aufgabe Nr. 3 der Online-Phase NeoQUEST-2020 💃🏿 🤜🏼 🧘🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Heute werden wir die umstrittenste Aufgabe von NeoQUEST-2020 betrachten : Der erste Teil ist ein Champion in der Anzahl der Teilnehmer, die ihn bestan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Forensik, SQL-Injection und leidende Katze: Analyse der Aufgabe Nr. 3 der Online-Phase NeoQUEST-2020</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/neobit/blog/495296/"><img src="https://habrastorage.org/webt/gd/oc/8f/gdoc8fvxf7oimhxlgxvmijvuwmk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Heute werden wir die umstrittenste Aufgabe von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NeoQUEST-2020 betrachten</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Der erste Teil ist ein Champion in der Anzahl der Teilnehmer, die ihn bestanden haben, und der zweite Teil hat nur wenigen gehorcht. </font><font style="vertical-align: inherit;">Was ist das Besondere an ihm? </font><font style="vertical-align: inherit;">Verstehe den Schnitt!</font></font><br>
<a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mussten Sie jemals einen RAM-Dump untersuchen? Wissen Sie, wie viele interessante Dinge Sie von dort bekommen können? (Spoiler: alles, einschließlich der Ergebnisse der Ausführung von Skripten, der letzten Fotos sowie des Browserverlaufs). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was ist mit exotischen SQL-Injektionen? Sie laden ein bestimmtes Bild auf die Website hoch und erhalten Informationen aus einer geschlossenen Datenbank. Ist dies nicht ein ideales Verbrechen? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im ersten Teil des Artikels werden wir die Mittel zum Analysieren des Speicherauszugs betrachten und lernen, wie wir die benötigten Informationen von dort extrahieren können, und im zweiten Teil des Artikels werden wir den Prozess der Manipulation von Bild-Tags für eine knifflige Injektion klar zeigen :) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Aufgabe besteht also darin, das </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Archiv</font></a><font style="vertical-align: inherit;"> herunterzuladen</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die eine 1-GB-Binärdatei mit dem sprechenden Namen memdump.bin enthält, auf deren Grundlage wir davon ausgehen können, dass es sich um einen RAM-Dump handelt. Wir werden das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Volatilitäts-Framework</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für seine Forschung verwenden </font><font style="vertical-align: inherit;">. Volatility unterstützt verschiedene Plugins, die das Suchen und Extrahieren verschiedener Informationen aus dem Speicherauszug erleichtern, die für die </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erpressung eines</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Analysten </font><font style="vertical-align: inherit;">nützlich sind </font><font style="vertical-align: inherit;">. Verwenden Sie zunächst den Befehl imageinfo, um Informationen zum Speicherauszug zu erhalten:</font></font><br>
<cut></cut><br>
<img src="https://habrastorage.org/webt/8b/po/2n/8bpo2nbfia9ykmdpqohz8zt4w0a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gemessen an der Ausgabe des Befehls imageinfo handelt es sich um einen Windows 7-Speicherauszug. Als Nächstes sehen wir uns die Liste der laufenden Prozesse im System an, als der Speicherauszug mit dem Befehl pslist entfernt wurde: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ja/1n/py/ja1npywtltvjjnzwwhbs7mkk1ho.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Liste sehen Sie einige interessante Prozesse. Beginnen wir die Studie mit dem Prozess chrome.exe - im Browser finden Sie immer etwas Interessantes. Es gibt zusätzliche Plugins für die Volatilität, die das Extrahieren von Informationen aus Prozessen automatisieren. Mit dem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chromehistory-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Plugin </font><font style="vertical-align: inherit;">können wir beispielsweise einen Browser-Besuchsverlauf aus einem RAM-Dump extrahieren: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lx/oo/o7/lxooo7skzcqwcxf-hw_njv5rmdk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Geschichte von Chrome können mehrere interessante Dinge gleichzeitig bemerkt werden. Zunächst ein Link </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zum zweiten Teil der Aufgabe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sowie Suchanfragen zu Metadaten in PNG-Bildern, was auch ein Hinweis auf den zweiten Teil ist, aber wir werden später darauf zurückkommen. Gegenwärtig sind wir an Anfragen nach einem Aktionscode </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">für einen Rabatt</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf die Website und PDF-Dateien </font><font style="vertical-align: inherit;">interessiert </font><font style="vertical-align: inherit;">, der auf den Gegenstand weiterer Suchvorgänge hinweist (das Ausführen von Acrobat Reader`a kann uns auch dazu auffordern). Versuchen wir, PDF-Dokumente in einem Speicherauszug mit dem Befehl filescan zu finden: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sb/ro/qk/sbroqkdf1jetkddyzac1rhasqh0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Viel Glück! Es sieht so aus, als ob sich in der Müllkippe eine promo.pdf befindet. Versuchen wir es mit dem Befehl dumpfiles zu ziehen:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/-w/gn/iz/-wgnizdzvl_kszkhof-z1bldwxu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Stadium können kleinere Schwierigkeiten auftreten, da einige PDF-Dokument-Viewer die gerade extrahierte Datei möglicherweise nicht erkennen (Sie müssen nur die zusätzlichen Bytes am Ende der Datei löschen). Aber haben wir wirklich Angst vor zusätzlichen Bytes? :) Öffnen Sie am Ende das Dokument und sehen Sie sich den QR-Code an. Nach dem Lesen erhalten wir die Flagge aus dem ersten Teil der Aufgabe (und gleichzeitig den Aktionscode für den Erhalt eines Geschenks vom NeoQUEST-Team - wir geben unvergessliche Preise alle Teilnehmer, die mindestens eine Aufgabe abgeschlossen haben!).</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xp/84/od/xp84odjm5frx774wqy9ka75rjws.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Versuchen Sie als nächstes, die zweite Flagge zu erhalten. Wir kehren zur Site zurück, deren Link im Browserverlauf gefunden wurde. Um auf die Website zugreifen zu können, müssen Sie einen Aktionscode eingeben. Wir erinnern uns an den Suchverlauf im Browser und an die Beschreibung des Dokuments selbst (USE THIS TO JOIN), aus der wir annehmen können, dass die erste Flagge der von uns benötigte Aktionscode ist. Wir geben es in das Feld ein und gelangen zu der Site, auf der wir ein Bild hochladen können: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/n9/kb/vu/n9kbvuleozzylxcgoa2hxy5trhq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anhand der Häufigkeit, mit der die Site einfriert, haben unsere Teilnehmer beschlossen, das Laden aller möglichen Arten von Dokumenten experimentell zu überprüfen. Eine gewisse Zeit später verstehen wir, dass nur PNG-Bilder auf die Site hochgeladen werden können. Das nächste Rätsel ist die Meldung "Nicht genügend Daten, um dieses Bild zu speichern, sorry!", Die auftritt, wenn Sie versuchen, ein Bild hochzuladen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zurück zum Verlauf des Browsers erinnern wir uns an Anfragen des Formulars „Metadaten zur PNG-Datei hinzufügen“. Mit einfachen Schlussfolgerungen schließen wir, dass höchstwahrscheinlich bestimmte Werte in die Metadaten eingegeben werden müssen, um ein Bild auf eine Site hochzuladen. Sie können beginnen, indem Sie das PNG-Format erkunden (für eine Beschreibung klicken Sie beispielsweise </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Überprüfen Sie zunächst die Liste der Standardschlüsselwörter für Metadaten-PNG-Bilder, z. B. "Autor", "Beschreibung" usw. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fügen Sie </font><font style="vertical-align: inherit;">beispielsweise mit dem Konvertierungsprogramm aus dem ImageMagick-Set Metadaten zum Testbild hinzu: </font><font style="vertical-align: inherit;">convert test.png -set 'Title' '1' -set 'Author' '2' -set 'Description' '3' -set 'Copyright' '4 '-set' Erstellungszeit '' 5 '-set' Software '' 6 '-set' Haftungsausschluss '' 7 '-set 'Warnung' '8' -set 'Quelle' '9' -set 'Kommentar' '0' out.png</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir versuchen, das resultierende Bild auf die Website hochzuladen und genießen den Erfolg: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sa/7o/pw/sa7opwndturwyzaqse9f4qah83g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es stellt sich heraus, dass die erforderlichen Metadatenfelder Titel, Beschreibung, Autor und Urheberrecht sind. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einen Hinweis dazu finden Sie übrigens auch im Speicherauszug: Die Erwähnung der Datei mr_cat.png finden Sie unter Volatility. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ix/bw/cn/ixbwcn3pzw3ndqxlbnfb6btadyk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unsere Teilnehmer entschieden, dass es mit Hilfe von Mr. Cat notwendig war, auf der Website zu injizieren (viele Nachrichten kamen mit Mr. Cat in komprimierter, umgekehrter, reflektierter und anderer </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unansehnlicher Form</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> an unsere Mail </font><font style="vertical-align: inherit;">), aber die Katze hatte nichts damit zu tun! Er lenkt einfach ab und deutet die Teilnehmer an: Nun, sieh mich an, da ist etwas Interessantes drin! Innerhalb der Müllkippe blieb das Bild nur teilweise erhalten; In den Resten können Sie jedoch die erforderlichen ausgefüllten Metadatenfelder erkennen:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zv/4h/0o/zv4h0ogsh94higmrsqslbzbxzby.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fahren Sie fort: Jetzt können wir Dateien auf die Site hochladen. Was gibt es jedoch und wie sucht man nach einer Flagge? Es ist logisch anzunehmen, dass Metadaten, da sie zum Herunterladen erforderlich sind, möglicherweise zum Speichern heruntergeladener Dateien verwendet werden (z. B. als Schlüssel in einer Datenbank). Hurra! Wir nähern uns dem Dessert: Wir müssen die Site auf die Möglichkeit einer SQL-Injektion überprüfen. Wir stellen fest, dass, wenn einer der Parameter durch ein doppeltes Anführungszeichen (") ersetzt wird, die Site uns über einen Fehler benachrichtigt, anstatt das Bild zu laden:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/f7/s2/bf/f7s2bfigyph9mkfj9jfg6wfxhxc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt sehen wir die SQL-Abfrage selbst und verstehen, welche Felder wir bearbeiten können, um eine Injektion zum Extrahieren von Daten aus der verwendeten Datenbank zu erstellen. In diesem Fall ist es logisch, das erste Bild zu überprüfen, das in die Datenbank hochgeladen wurde. Während des Einspritzvorgangs sollten Sie auch darauf achten, dass INSERT in der Anforderung ausgeführt wird. Dies zwingt uns, bestimmte Abfragen zu erstellen, da es unmöglich ist, eine SELECT-Operation explizit aus derselben Tabelle auszuführen, in die wir gleichzeitig mit der Einfügeoperation (INSERT) einfügen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stellen wir eine Anfrage, mit der wir die Beschreibung des ersten Bildes in der Datenbank herausziehen:</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
convert test1.png -set 'Title' '1' -set 'Author' '", (SELECT Beschreibung FROM (SELECT * FROM Bild) AS x limit 0,1)) - -' -set 'Description' '3' - set 'Copyright' '4' test.png Laden Sie </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
das empfangene Bild auf die Website </font><font style="vertical-align: inherit;">hoch </font><font style="vertical-align: inherit;">und erhalten Sie die Beschreibung im Feld Copyright, das ein Flag ist: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vz/k8/6x/vzk86xyosytdwsvc9orcwkypybi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hurra, Aufgabe erledigt! Wir hoffen, dass wir alle davon überzeugt haben, die Benutzereingaben zum millionsten Mal zu überprüfen und sie auch sicher zu verwahren Apfel deines Auges von der Erstellung eines Dumps deines RAM :) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beende den Artikel mit einem Zitat der großen Weisen:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qg/9i/un/qg9iunp8zncqovjy3_qg990lmlc.png"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de495280/index.html">Max Patrol SIEM. Übersicht über das Informationssicherheits-Ereignisverwaltungssystem</a></li>
<li><a href="../de495282/index.html">XML-Validierung mit XSD, JAXB und Spring Framework</a></li>
<li><a href="../de495290/index.html">Erkundung der Codequalität des Zephyr-Betriebssystems</a></li>
<li><a href="../de495292/index.html">InterSystems IRIS 2020.1 Release</a></li>
<li><a href="../de495294/index.html">Makros für einen Pythonisten. Yandex-Bericht</a></li>
<li><a href="../de495298/index.html">Bewerten Sie die Optionen von Monte Carlo Clojure</a></li>
<li><a href="../de495302/index.html">So steigern Sie den Umsatz in einem Online-Shop in 4 Monaten um das 2,5-fache - ein Argument für SEO-Werbung</a></li>
<li><a href="../de495304/index.html">Verjüngung menschlicher Zellen aufgrund ihrer Neuprogrammierung</a></li>
<li><a href="../de495308/index.html">Harken Sie auf dem Weg, um am Leben zu bleiben</a></li>
<li><a href="../de495310/index.html">Elektronischer Durchgang: Biometrie und Multiformat</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>