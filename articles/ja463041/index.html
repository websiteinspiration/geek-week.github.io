<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💅🏿 🤟🏿 👨🏻‍🚀 定義済みまたは未定義？JavaScriptで配列を作成するニュアンス 👩🏾‍🤝‍👨🏻 📹 🔯</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="数か月前、私はstackoverflowに関する興味深い質問に出くわしました。つまり、ある人が空の5x5マトリックスを作成したいと思ったのですが、ある方法を使用すると成功しましたが、もう1つの方法では成功しませんでした。このテーマに関するその後の議論では、興味深いアイデアが引用されました。
 
 確...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>定義済みまたは未定義？JavaScriptで配列を作成するニュアンス</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463041/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/cf/uz/xt/cfuzxt6gszx356ckhbffnh21g9g.jpeg" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数か月前、私は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stackoverflow</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に関する興味深い質問に</font><i><font style="vertical-align: inherit;">出くわし</font></i><font style="vertical-align: inherit;">ました。つまり、ある人が空の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5x5</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マトリックスを作成したいと思ったのです</font><font style="vertical-align: inherit;">が、ある方法を使用すると成功しましたが、もう1つの方法では成功しませんでした。このテーマに関するその後の議論では、興味深いアイデアが引用されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
確かに、質問をした人と答えた人は、実際には行列を作成できず、計算結果が正しくなかったことに注意を払いませんでした。これらすべてに興味を持ったので、少し深く掘り下げて、興味深い結論にたどり着くことにしました。</font></font><br>
<a name="habracut"></a><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：私はその議論の下でも、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AndreyGS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">というニックネームで</font><font style="vertical-align: inherit;">答えました。そこで、私はかなり簡単に答えました。ここでは、問題を完全にカバーするようにします。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
一般に、配列を作成するというタスクに直面しています。これをどのように行うのですか？奇妙なことに、取得したいものに応じて、さまざまなオプションがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JavaScriptの関数には</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Call</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Constructの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2つの内部メソッドがあることがわかっています</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">new</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キーワードを使用する場合</font><font style="vertical-align: inherit;">、Constructメソッドが使用されます。これは、オブジェクトの新しいインスタンスを作成し、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参照を</font><i><font style="vertical-align: inherit;">それ</font></i><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">参照に割り当て</font><i><font style="vertical-align: inherit;">て</font></i><font style="vertical-align: inherit;">から</font><font style="vertical-align: inherit;">、関数の本体を実行します。すべての関数にこのメソッドがあるわけではありませんが、現在のところ、これはそれほど重要ではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
配列を作成する場合、1つの特殊性があります。それは問題ではありません</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。配列（...）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しい配列（...）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用します</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。ECMAScript</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仕様</font><font style="vertical-align: inherit;">はそれらに違いをもたらさず、さらにそれらを同等と見なします。</font></font><br>
<br>
<pre><code class="dos hljs"><span class="hljs-number">22</span>.<span class="hljs-number">1</span>.<span class="hljs-number">1</span> The Array Constructor<font></font>
<font></font>
The Array constructor is the <span class="hljs-variable">%Array%</span> intrinsic object and the initial value of the Array property of the global object. When called as a constructor it creates and initializes a new exotic Array object. When Array is called as a function rather than as a constructor, it also creates and initializes a new Array object. Thus the function <span class="hljs-keyword">call</span> Array(…) is equivalent to the object creation expression new Array(…) with the same arguments.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、私はいたずらを哲学に</font><font style="vertical-align: inherit;">しないで、誰も混乱させないよう</font><font style="vertical-align: inherit;">に、例では</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しい配列（...）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">構文のみを使用し</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
始めましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
配列を作成します。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">5</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何を手に入れましたか？</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">console</span>.log(arr); <span class="hljs-comment">// Array(5) [ &lt;5 empty slots&gt; ]</span>
<span class="hljs-built_in">console</span>.log(arr[<span class="hljs-number">0</span>]); <span class="hljs-comment">// undefined</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>.getOwnPropertyDescriptor(arr,<span class="hljs-string">"0"</span>)); <span class="hljs-comment">// undefined</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
うーん...まあ、原則として、それはそうであるはずです-長さを設定し、値</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">undefined</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">5つの空のセルを取得しました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">確かに、私を混乱させるいくつかの点があります。</font><font style="vertical-align: inherit;">確認しよう。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">5</span>).map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">5</span>); });<font></font>
<font></font>
<span class="hljs-built_in">console</span>.log(arr); <span class="hljs-comment">// Array(5) [ &lt;5 empty slots&gt; ]</span>
<span class="hljs-built_in">console</span>.log(arr[<span class="hljs-number">0</span>]); <span class="hljs-comment">// undefined</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>.getOwnPropertyDescriptor(arr,<span class="hljs-string">"0"</span>)); <span class="hljs-comment">// undefined</span>
<span class="hljs-built_in">console</span>.log(arr[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]); <span class="hljs-comment">// TypeError: arr[0] is undefined</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結局のところ、マトリックスを取得する必要があり、それに応じて各セルには5つの要素の配列が必要です</font><i><font style="vertical-align: inherit;">。ECMAScriptの</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ドキュメント</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">もう一度</font><font style="vertical-align: inherit;">参照して、1つの引数で配列を作成する方法に関して何が記述されているか見て</font><font style="vertical-align: inherit;">みましょう</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="dos hljs"><span class="hljs-number">22</span>.<span class="hljs-number">1</span>.<span class="hljs-number">1</span>.<span class="hljs-number">2</span> Array (len)<font></font>
This description applies <span class="hljs-keyword">if</span> and only <span class="hljs-keyword">if</span> the Array constructor is called with exactly one argument.<font></font>
<font></font>
    <span class="hljs-number">1</span>. Let numberOfArgs be the number of arguments passed to this function <span class="hljs-keyword">call</span>. 
    <span class="hljs-number">2</span>. Assert: numberOfArgs = <span class="hljs-number">1</span>. 
    <span class="hljs-number">3</span>. <span class="hljs-keyword">If</span> NewTarget is undefined, let newTarget be the active function object, <span class="hljs-keyword">else</span> let newTarget be NewTarget. 
    <span class="hljs-number">4</span>. Let proto be GetPrototypeFromConstructor(newTarget, "<span class="hljs-variable">%ArrayPrototype%</span>"). 
    <span class="hljs-number">5</span>. ReturnIfAbrupt(proto). 
    <span class="hljs-number">6</span>. Let array be ArrayCreate(<span class="hljs-number">0</span>, proto). 
    <span class="hljs-number">7</span>. <span class="hljs-keyword">If</span> <span class="hljs-built_in">Type</span>(len) is <span class="hljs-keyword">not</span> Number, then 
        <span class="hljs-number">1</span>. Let defineStatus be CreateDataProperty(array, "<span class="hljs-number">0</span>", len). 
        <span class="hljs-number">2</span>. Assert: defineStatus is true. 
        <span class="hljs-number">3</span>. Let intLen be <span class="hljs-number">1</span>. 
    <span class="hljs-number">8</span>. <span class="hljs-keyword">Else</span>, 
        <span class="hljs-number">1</span>. Let intLen be ToUint32(len). 
        <span class="hljs-number">2</span>. <span class="hljs-keyword">If</span> intLen ≠ len, throw a RangeError exception. 
    <span class="hljs-number">9</span>. Let setStatus be <span class="hljs-built_in">Set</span>(array, "length", intLen, true). 
    <span class="hljs-number">10</span>. Assert: setStatus is <span class="hljs-keyword">not</span> an abrupt completion. 
    <span class="hljs-number">11</span>. Return array.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、オブジェクトが作成され、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">長さ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロパティが</font><font style="vertical-align: inherit;">ArrayCreateプロシージャで作成され（6ポイント）、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">長さ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロパティの値が設定され</font><font style="vertical-align: inherit;">（ポイント9）、セルについてはどうなりますか。渡された引数が数値ではなく、対応する値（ポイント7）を持つ単一のセル「0」で配列が作成されるという特別な場合を除いて、それらについての単語はありません...つまり、長さ== 5ですが、5つのセルはありません。はい、単一のセルにアクセスしようとするとコンパイラーは混乱します</font><font style="vertical-align: inherit;">。実際にはそうではありませんが、</font><font style="vertical-align: inherit;">その値は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">undefined</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">あることがわかります</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、比較のために、コンストラクターにいくつかの引数を送信して配列を作成する方法を示します。</font></font><br>
<br>
<pre><code class="dos hljs"><span class="hljs-number">22</span>.<span class="hljs-number">1</span>.<span class="hljs-number">1</span>.<span class="hljs-number">3</span> Array (...items )<font></font>
This description applies <span class="hljs-keyword">if</span> and only <span class="hljs-keyword">if</span> the Array constructor is called with <span class="hljs-built_in">at</span> least two arguments.<font></font>
When the Array function is called the following steps are taken:<font></font>
<font></font>
    <span class="hljs-number">1</span>. Let numberOfArgs be the number of arguments passed to this function <span class="hljs-keyword">call</span>. 
    <span class="hljs-number">2</span>. Assert: numberOfArgs ≥ <span class="hljs-number">2</span>. 
    <span class="hljs-number">3</span>. <span class="hljs-keyword">If</span> NewTarget is undefined, let newTarget be the active function object, <span class="hljs-keyword">else</span> let newTarget be NewTarget. 
    <span class="hljs-number">4</span>. Let proto be GetPrototypeFromConstructor(newTarget, "<span class="hljs-variable">%ArrayPrototype%</span>"). 
    <span class="hljs-number">5</span>. ReturnIfAbrupt(proto). 
    <span class="hljs-number">6</span>. Let array be ArrayCreate(numberOfArgs, proto). 
    <span class="hljs-number">7</span>. ReturnIfAbrupt(array). 
    <span class="hljs-number">8</span>. Let k be <span class="hljs-number">0</span>. 
    <span class="hljs-number">9</span>. Let items be a zero-origined List containing the argument items <span class="hljs-keyword">in</span> order. 
    <span class="hljs-number">10</span>. Repeat, while k &lt; numberOfArgs 
        <span class="hljs-number">1</span>. Let Pk be ToString(k). 
        <span class="hljs-number">2</span>. Let itemK be items[k]. 
        <span class="hljs-number">3</span>. Let defineStatus be CreateDataProperty(array, Pk, itemK). 
        <span class="hljs-number">4</span>. Assert: defineStatus is true. 
        <span class="hljs-number">5</span>. Increase k by <span class="hljs-number">1</span>. 
    <span class="hljs-number">11</span>. Assert: the value of array’s length property is numberOfArgs. 
    <span class="hljs-number">12</span>. Return array.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、10ポイント、同じセルを作成してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Array.prototype.map（）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は次に</font><font style="vertical-align: inherit;">何をしますか？</font></font><br>
<br>
<pre><code class="dos hljs"><span class="hljs-number">22</span>.<span class="hljs-number">1</span>.<span class="hljs-number">3</span>.<span class="hljs-number">15</span> Array.prototype.map ( callbackfn [ , thisArg ] )<font></font>
<font></font>
    <span class="hljs-number">1</span>. Let O be ToObject(this value). 
    <span class="hljs-number">2</span>. ReturnIfAbrupt(O). 
    <span class="hljs-number">3</span>. Let len be ToLength(Get(O, "length")). 
    <span class="hljs-number">4</span>. ReturnIfAbrupt(len). 
    <span class="hljs-number">5</span>. <span class="hljs-keyword">If</span> IsCallable(callbackfn) is false, throw a TypeError exception. 
    <span class="hljs-number">6</span>. <span class="hljs-keyword">If</span> thisArg was supplied, let T be thisArg; <span class="hljs-keyword">else</span> let T be undefined. 
    <span class="hljs-number">7</span>. Let A be ArraySpeciesCreate(O, len). 
    <span class="hljs-number">8</span>. ReturnIfAbrupt(A). 
    <span class="hljs-number">9</span>. Let k be <span class="hljs-number">0</span>. 
    <span class="hljs-number">10</span>. Repeat, while k &lt; len 
        <span class="hljs-number">1</span>. Let Pk be ToString(k). 
        <span class="hljs-number">2</span>. Let kPresent be HasProperty(O, Pk). 
        <span class="hljs-number">3</span>. ReturnIfAbrupt(kPresent). 
        <span class="hljs-number">4</span>. <span class="hljs-keyword">If</span> kPresent is true, then 
            <span class="hljs-number">1</span>. Let kValue be Get(O, Pk). 
            <span class="hljs-number">2</span>. ReturnIfAbrupt(kValue). 
            <span class="hljs-number">3</span>. Let mappedValue be <span class="hljs-keyword">Call</span>(callbackfn, T, «kValue, k, O»). 
            <span class="hljs-number">4</span>. ReturnIfAbrupt(mappedValue). 
            <span class="hljs-number">5</span>. Let status be CreateDataPropertyOrThrow (A, Pk, mappedValue). 
            <span class="hljs-number">6</span>. ReturnIfAbrupt(status). 
        <span class="hljs-number">5</span>. Increase k by <span class="hljs-number">1</span>. 
    <span class="hljs-number">11</span>. Return A.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
条項7-元の配列のコピーが作成されます。条項10では、</font><font style="vertical-align: inherit;">その要素に対して</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">len</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回の反復が行われます。特に、条項10.2は、ソース配列に特定のセルがあるかどうかをチェックし、成功した場合は（10.4）およびコピーに適切なセルを作成します-10.4.5。 10.2は</font><i><font style="vertical-align: inherit;">5つの</font></i><font style="vertical-align: inherit;">パスの</font><font style="vertical-align: inherit;">それぞれに</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">与える</font><font style="vertical-align: inherit;">ため</font><font style="vertical-align: inherit;">、返された配列のコピーに単一のセルも作成されません。</font><font style="vertical-align: inherit;">
したがって、配列コンストラクターと</font><i><font style="vertical-align: inherit;">Array.prototype.map（）</font></i><font style="vertical-align: inherit;">メソッドがどのように機能するか</font><font style="vertical-align: inherit;">を考え出しましたが、マトリックスが構築されなかったため、タスクは未解決のまま残りました。</font><i><font style="vertical-align: inherit;">Function.prototype.apply（）</font></i><font style="vertical-align: inherit;">が助けになり</font><font style="vertical-align: inherit;">ます！</font><font style="vertical-align: inherit;">
すぐに動作を確認してみましょう。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> arr = <span class="hljs-built_in">Array</span>.apply(<span class="hljs-literal">null</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">5</span>));<font></font>
<font></font>
<span class="hljs-built_in">console</span>.log(arr); <span class="hljs-comment">// Array(5) [ undefined, undefined, undefined, undefined, undefined ]</span>
<span class="hljs-built_in">console</span>.log(arr[<span class="hljs-number">0</span>]); <span class="hljs-comment">// undefined</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>.getOwnPropertyDescriptor(arr,<span class="hljs-string">"0"</span>)); <span class="hljs-comment">// Object { value: undefined, writable: true, enumerable: true, configurable: true }</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ばんざーい、5つのセルすべてがここではっきりと観察されています。また、番号が</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「0」</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の最初のテストセルには</font><font style="vertical-align: inherit;">記述子があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、プログラムは次のように機能しました。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Function.prototype.apply（）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドを呼び出し、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキストをそれに渡し</font><font style="vertical-align: inherit;">、配列として</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいArray（5）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を渡しました</font><font style="vertical-align: inherit;">。</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">new Array（5）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、セルを含まないが長さが</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配列を作成しました</font><font style="vertical-align: inherit;">。</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Function.prototype.apply（）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、配列を個別の引数に分割する内部メソッドを使用しました。その結果、</font><i><font style="vertical-align: inherit;">未定義の</font></i><font style="vertical-align: inherit;">値を持つ5つの引数が</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配列</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンストラクターに渡されました</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配列</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">、</font><i><font style="vertical-align: inherit;">未定義の</font></i><font style="vertical-align: inherit;">値を持つ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5つの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">引数を</font><font style="vertical-align: inherit;">受け取り</font><font style="vertical-align: inherit;">、それらを対応するセルに追加しました。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font></li>
</ol><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Function.prototype.apply（）の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
内部メソッド</font><font style="vertical-align: inherit;">で何もない</font><font style="vertical-align: inherit;">こと</font><font style="vertical-align: inherit;">から</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5つの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">引数</font><font style="vertical-align: inherit;">を作成する</font><font style="vertical-align: inherit;">ものを除いて、すべてが明確</font><font style="vertical-align: inherit;">に見えます</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。ECMAScriptの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメントをもう一度確認することをお勧めします</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="dos hljs"><span class="hljs-number">19</span>.<span class="hljs-number">2</span>.<span class="hljs-number">3</span>.<span class="hljs-number">1</span> Function.prototype.apply<font></font>
<font></font>
    <span class="hljs-number">1</span>. <span class="hljs-keyword">If</span> IsCallable(func) is false, throw a TypeError exception.
    <span class="hljs-number">2</span>. <span class="hljs-keyword">If</span> argArray is null or undefined, then Return <span class="hljs-keyword">Call</span>(func, thisArg).
    <span class="hljs-number">3</span>. Let argList be CreateListFromArrayLike(argArray).<font></font>
<font></font>
    <span class="hljs-number">7</span>.<span class="hljs-number">3</span>.<span class="hljs-number">17</span> CreateListFromArrayLike (obj [, elementTypes] )     <font></font>
<font></font>
        <span class="hljs-number">1</span>. ReturnIfAbrupt(obj).
        <span class="hljs-number">2</span>. <span class="hljs-keyword">If</span> elementTypes was <span class="hljs-keyword">not</span> passed, let elementTypes be (Undefined, Null, Boolean, String, Symbol, Number, Object).
        <span class="hljs-number">3</span>. <span class="hljs-keyword">If</span> <span class="hljs-built_in">Type</span>(obj) is <span class="hljs-keyword">not</span> Object, throw a TypeError exception.
        <span class="hljs-number">4</span>. Let len be ToLength(Get(obj, "length")).
        <span class="hljs-number">5</span>. ReturnIfAbrupt(len).
        <span class="hljs-number">6</span>. Let list be an empty List.
        <span class="hljs-number">7</span>. Let index be <span class="hljs-number">0</span>.
        <span class="hljs-number">8</span>. Repeat while index &lt; len<font></font>
            a. Let indexName be ToString(index).<font></font>
            b. Let next be Get(obj, indexName).<font></font>
            c. ReturnIfAbrupt(next).<font></font>
            d. <span class="hljs-keyword">If</span> <span class="hljs-built_in">Type</span>(next) is <span class="hljs-keyword">not</span> an element of elementTypes, throw a TypeError exception.<font></font>
            e. <span class="hljs-built_in">Append</span> next as the last element of list.<font></font>
            f. <span class="hljs-built_in">Set</span> index to index + <span class="hljs-number">1</span>.
        <span class="hljs-number">9</span>. Return list.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最も興味深い点を見てみましょう：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
19.2.3.1-ポイント3：配列に似たオブジェクトから引数のリストを作成します（覚えているように、そのようなオブジェクトにはlengthプロパティが必要です）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7.3.17-リスト作成メソッド自体。オブジェクトが存在するかどうかをチェックし、存在する場合は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">長さ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィールドの値を要求します</font><font style="vertical-align: inherit;">（ポイント4）。次に、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「0」に</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等しいインデックス</font><i><font style="vertical-align: inherit;">が作成されます</font></i><font style="vertical-align: inherit;">（段落7）。インデックスは、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">長さ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィールドから取得された値まで増加します</font><font style="vertical-align: inherit;">（パラグラフ8）。このサイクルでは、送信された配列のセルの値を、対応するインデックス（句8aおよび8b）で参照します。そして、私たちが覚えているように、実際にはセルがない配列内の単一のセルの値にアクセスするとき、それはまだ値を与えます- </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未定義</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">結果の値は、引数リストの最後に追加されます（パラグラフ8e）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さて、すべてが適切に配置されたので、非常に空のマトリックスを安全に構築できます。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> arr = <span class="hljs-built_in">Array</span>.apply(<span class="hljs-literal">null</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">5</span>)).map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{ <span class="hljs-keyword">return</span> <span class="hljs-built_in">Array</span>.apply(<span class="hljs-literal">null</span>,<span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">5</span>)); });<font></font>
<font></font>
<span class="hljs-built_in">console</span>.log(arr); <span class="hljs-comment">// Array(5) [ (5) […], (5) […], (5) […], (5) […], (5) […] ]</span>
<span class="hljs-built_in">console</span>.log(arr[<span class="hljs-number">0</span>]); <span class="hljs-comment">// Array(5) [ undefined, undefined, undefined, undefined, undefined ]</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>.getOwnPropertyDescriptor(arr,<span class="hljs-string">"0"</span>)); <span class="hljs-comment">// Object { value: (5) […], writable: true, enumerable: true, configurable: true }</span>
<span class="hljs-built_in">console</span>.log(arr[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]); <span class="hljs-comment">// undefined</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>.getOwnPropertyDescriptor(arr[<span class="hljs-number">0</span>],<span class="hljs-string">"0"</span>)); <span class="hljs-comment">// Object { value: undefined, writable: true, enumerable: true, configurable: true }</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、すべてが収束して非常にシンプルに見えます。すでに知っている方法で、単純な空の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Array.apply（null、new Array（5））</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配列を作成し、それをmapメソッドに渡して、同じ配列を作成します。各セル。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、それをさらに簡単にすることができます。</font><i><font style="vertical-align: inherit;">スプレッド</font></i><font style="vertical-align: inherit;"> - </font><i><font style="vertical-align: inherit;">...</font></i><font style="vertical-align: inherit;">登場オペレータ</font><font style="vertical-align: inherit;">に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ECMAScript6</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">典型的なものである、とは、それはまた、特に配列で動作します。</font><font style="vertical-align: inherit;">したがって、次のように簡単にドライブできます。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(...new <span class="hljs-built_in">Array</span>(<span class="hljs-number">5</span>)).map(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(...new <span class="hljs-built_in">Array</span>(<span class="hljs-number">5</span>)));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
または、私が以前に触れないことを約束していたにもかかわらず、それを完全に簡略化します...</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> arr = <span class="hljs-built_in">Array</span>(...Array(<span class="hljs-number">5</span>)).map(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">Array</span>(...Array(<span class="hljs-number">5</span>)));</code></pre><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：ここでも、アロー関数を使用しました。これは、アロー関数と同じ仕様にあるスプレッド演算子をまだ扱っているためです。</font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">スプレッド</font></i><font style="vertical-align: inherit;">演算子の</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
原理については</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">触れ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ませんが、一般的な開発では、この例も役に立ちました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、もちろん、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Function.prototype.apply（）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソート</font><font style="vertical-align: inherit;">を使用</font><font style="vertical-align: inherit;">して、空のセルを持つ通常の配列を作成する</font><i><font style="vertical-align: inherit;">関数</font></i><font style="vertical-align: inherit;">を作成できますが、JavaScriptの内部原理を理解しているため、適切かつ適切に使用できます組み込み関数は、優先事項であるマスターの基礎です。ええ、そしてもちろん、それはとてもシンプルで速くて便利です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、最後に、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stackoverflow</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に関するそのまさに質問に戻ります</font><font style="vertical-align: inherit;">-私は、彼が受け取った方法が正しい答えにつながり、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5x5</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マトリックスを受け取ったと誤って考えたと思い</font><font style="vertical-align: inherit;">ますが、小さなエラーがそこに忍び込みました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
彼は次の</font><font style="vertical-align: inherit;">
ように</font><font style="vertical-align: inherit;">叩きました：</font><font style="vertical-align: inherit;">実際の結果はここでどうなると思いますか？</font></font><br>
<br>
<code>Array.apply(null, new Array(5)).map(function(){<br>
 return new Array(5);<br>
});</code><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回答</font></font></b><div class="spoiler_text">console.log(arr); // Array(5) [ (5) […], (5) […], (5) […], (5) […], (5) […] ]<br>
console.log(arr[0]); // Array(5) [ &lt;5 empty slots&gt; ]<br>
console.log(Object.getOwnPropertyDescriptor(arr,«0»)); // Object { value: (5) […], writable: true, enumerable: true, configurable: true }<br>
console.log(arr[0][0]); // undefined<br>
console.log(Object.getOwnPropertyDescriptor(arr[0],«0»)); // undefined<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そうではない、これは彼が手に入れたいと思っていたものではない... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リンク：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
→ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ECMAScript 2015言語仕様</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
→ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Array.applyが実際に行っていること</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja463027/index.html">PVS-Studioの独立したレビュー（Linux、C ++）</a></li>
<li><a href="../ja463031/index.html">生活し、学びます。パート3.継続教育または永遠の学生の年齢</a></li>
<li><a href="../ja463035/index.html">OpenStreetMap No. 471の世界からのニュース（07.23.2019-29.07.2019）</a></li>
<li><a href="../ja463037/index.html">インスピレーションを求めて、またはFから抜け出す方法</a></li>
<li><a href="../ja463039/index.html">日曜大工マニキュア掃除機</a></li>
<li><a href="../ja463045/index.html">ニューラルネットワークを使用してテキスト会話の感情を自動的に検出</a></li>
<li><a href="../ja463055/index.html">社内の管理者、開発者、無限の混乱、DevOpsの変革について</a></li>
<li><a href="../ja463057/index.html">Yiiフレームワーク2カスタム権利</a></li>
<li><a href="../ja463059/index.html">ITの3つの生活</a></li>
<li><a href="../ja463061/index.html">Figmaでレイアウトを準備するためのルール</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>