<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧝🏿 💟 🖐🏾 DEFCON 27 Conference。Buttplug：真の侵入テスト。パート1 🧠 🔦 🤳🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="アナリストは、モノのインターネット（IoT）の世界には現在約100億台のデバイスがあると考えています。時々、これらのデバイスは市場での地位を獲得し、文字通り人間の尻を登っていきます。結局のところ、安価で低電力の無線チップは、ホームオートメーションに最適であるだけでなく、大人のおもちゃの扱い方も変えて...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>DEFCON 27 Conference。Buttplug：真の侵入テスト。パート1</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/495378/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アナリストは、モノのインターネット（IoT）の世界には現在約100億台のデバイスがあると考えています。時々、これらのデバイスは市場での地位を獲得し、文字通り人間の尻を登っていきます。結局のところ、安価で低電力の無線チップは、ホームオートメーションに最適であるだけでなく、大人のおもちゃの扱い方も変えています。このレポートでは、双方向の通信回線を通じてパートナー間で触覚、温度、その他の感覚が伝わる距離でのセックスのテクノロジーであるテレビディルドニクスの世界に突入します。スピーカーは、Buttplug電子電子肛門性玩具の安全性が、スタックの各レベルで脆弱性を見つけて悪用する攻撃者に対抗できることを教えてくれます。最終的には、これにより性玩具自体が危険にさらされ、そしてそれらが接続するデバイス。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z5/yr/ar/z5yraruqzcjhhyd_pc_eym4a5ly.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
smea、またはSmealumというニックネームを持つハッカーは、任天堂DSなどのゲームコンソール用のビデオゲームの開発者としてキャリアを始め、同時にそれらを解読しようとしました。ある時点で、コンソールは深刻なセキュリティシステムを取得し、Smeaは自社開発のソフトウェアからそれを破壊するための開発技術に切り替えました。 Smeaはニンテンドー3DSとWii Uでの「仕事」で知られていますが、最も人気のあるWebブラウザーと仮想化スタックのエクスプロイトの開発にも貢献しました。おそらく、今では彼は「スマートな」肛門プラグに侵入することに興味を持ちました。</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
みなさん、こんにちは、スミアです。今日は、ブートプラグをクラックする方法についてお話します。これは私が手に持っている物です、以前に見たことがあるかわかりませんが、個人的にはわかりません。しかし、過去2年間、私はIoT業界の多くの興味深い代表者に会ったので、今、このことの変わり目が来ています。それはどこかに挿入する必要があるのはシリコーンの断片であり、これのための多くの場所がないことに同意するので、あなたはbootplagをクラックする方法を疑問に思うかもしれません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、これには電子機器は必要ありません。しかし、過去数年、あるいは数十年にわたって、teledildonikaと呼ばれる電子機器の新しい産業が登場しました。この用語の由来はスライドに示されています。ギリシャ語の「テレ」は「遠くから」を意味し、英語の「ディルド」はディルドにすぎません。私はディルドという言葉の起源を見つけようとしましたが、それがどこから来たのか誰にもわかりません。しかし、これは理解できますよね？アイデアは、どういうわけか遠くからコントロールできる大人のおもちゃを作りたいということです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これにはいくつかのシナリオがあります。誰もがそのようなデバイスに精通しているわけではないので、これがどのように機能するかをあなたに説明したいだけです。したがって、bootplagを取得し、必要な場所に挿入して、電話、ラップトップなど、どこからでもリモートで制御できます。これが「ソロプレイ」と呼ばれる最初のシナリオです。私が「ローカルマルチプレーヤー」と呼んだ2番目のシナリオ-これは、このことの制御を他の誰かに移すときです。これはかなり宣伝されているかなり現実的なものです。たとえば、彼女と一緒にバーに行くことができ、誰もそれがどれほど楽しいかわからないでしょう。しかし、技術的には、外部の人にデバイスの制御権を与えるため、これにより新しい攻撃ベクトルが作成され、脅威モデルが実際に変化します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3番目のシナリオ「リモートマルチプレーヤー」は2番目のシナリオと似ていますが、インターネットを介して別のユーザーがデバイスを制御できるようになっています。この人は見知らぬ人になる可能性があることに注意してください。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mn/nb/hr/mnnbhrbihysuf1iengokudmgudm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの人にとって、離れた場所でセックスすることはかなりクールで楽しいようで、私はそれについて冗談を言うつもりはありません。テレディルドニクスを使用して生計を立てている人もいます。シナリオ3Bは「リモート有料マルチプレーヤー」と呼ばれています。したがって、私がバットプラグをクラックしようとしているという事実は、単なる娯楽ではありません-それは私の浸透研究に特定の正当性を与えます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gn/g0/m4/gng0m40-kjudzygpgp6fkeczt_i.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの人々、私はそれらを何と呼ぶべきか分かりません-男の子、女の子-インターネット上でダイナミックな性的娯楽を提供し、他の人々がお金のために自分の大人のおもちゃを制御できるようにします。これらのバットを製造している会社は、インターネット上のセックスゲームに自社製品を使用する際の利益の控除という概念について特許を取得しています。このシナリオでは、5ドルの控除額に対して、たとえばTwitterにリンクを配置して、誰かがあなたのbootplagを限られた時間管理する機会を提供する権利があります。人々はお金を稼ぐためのツールとしてこれらのおもちゃに依存しているので、私の意見では、彼らの安全を考慮することは非常に重要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
攻撃者にとって興味深いシナリオを見てみましょう。 1つはローカルハックで、デバイスの範囲内にいる攻撃者が無線通信を介してデバイスの制御を傍受します。このハッキング方法については多くの調査が行われたため、私たちはそれに注意を向ける必要はありません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gy/wb/8g/gywb8gehwmsgsmf_5pra4m_lmr4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
技術的には、そのような介入は性的虐待と見なされる可能性があるため、合法かどうかにかかわらず、そのような行為は行わないでください。次のシナリオによると、攻撃者はインターネットを介してリモートで同じことを行います。既に述べたように、あなたがそのように稼いだ場合、見知らぬ人、つまり大人のおもちゃにリモートアクセスできる攻撃者を自発的に提供できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、ハッカーは「スマート」な大人のおもちゃや関連デバイスを危険にさらす可能性があります。つまり、あなたに何か悪いことをする可能性があり、あなた自身が彼にアクセスを許可したので、それは完全に合法です。ハッカーにとっては、これはより興味深いオプションであるため、少し長く説明します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8v/cb/hz/8vcbhzhmae_kgh9ka8v37s2jg_8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3番目のシナリオは反対です。攻撃者自身がブートプラグインを使用して、コンピューターまたは電話を制御し、プラグインを使用してリモートでゲームに参加するユーザーの側にあるデバイスをハッキングします。これが本当のリスクであることを人々は理解していませんが、おそらくお尻の栓がいかに油断のならないものか想像できます（ホールでの笑い声）。このシナリオについても調査しています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vn/tv/sr/vntvsrxrvefsyh_y7k48hqd7fiu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テレディルドニクスの世界を理解したところで、実際の様子を見てみましょう。スライドには、Lovense Hushと呼ばれるディルドモデルが表示されています。このデモを後で紹介します。これは、世界で最初のディルドテレディルドニクスのモデルであり、携帯電話またはコンピュータから制御できる肛門プラグです。このブートプラグ用のIoSおよびAndroid用のアプリケーションがあり、Mac OSおよびWindowsを実行しているコンピューターからそれを制御できます。モバイルアプリケーションは、チャット、テキスト、写真、ビデオの共有、友人や見知らぬ人とのおもちゃの操作などのソーシャル機能をサポートしています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/b-/ry/zq/b-ryzqagf71doiiyxeoj_hzvzm8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windowsでは、特別なUSBキーを使用する必要があります。これは後で説明します。これは、このブートプラグインがコンピューターに接続されているためです。エレクトロニックフラッシュドライブのキーは、「スマート」ディルドの独自のエコシステムを作成し、インターネットでのセッションに約5ドルの手数料がかかる、ブートプラグインの製造業者であるLovensによって開発されました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bv/lg/dl/bvlgdlcsp4qckbaej8gps_szkua.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のスライドは、PCアプリケーションを使用したブートプラグへの攻撃の私のビジョンを示しています。ブートプラグとUSBキーの間にBLE（BlueTooth Low Energy）接続があり、キーはユーザーのコンピューターに接続され、ユーザーのコンピューターはインターネットに接続されます。シナリオ1は、攻撃者がブートプラグのUSBキーセクションで使用する、つまりBLE接続が攻撃されます。実際には、保護機能がないため、見知らぬ人がこのおもちゃを操作できます。昨年、BTLE Jackと呼ばれるツールについて真剣な議論がありました。このツールを使用すると、このような接続を攻撃できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/l_/ma/24/l_ma24foabt77cti9__dmq7ufam.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
シナリオ2は、ユーザーのコンピューターのインターネット接続の一部を攻撃することです。 3番目のシナリオは、BLE、USB、インターネットの3つのサイトのいずれかにハッキングする試みです。オープンプロジェクトのButplugがある可能性があります...あなたは笑うことができます、それは冗談でした。では、「真の侵入テスト」はどこから始めればよいのでしょうか。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cj/ov/21/cjov21ngohs6fh0gqaccbp2mdn0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ディルドとドングル自体のコードやバイナリは見つかりませんでしたが、モバイルデバイス用のバイナリアプリケーションファイルとインターネットでダウンロードできるコンピュータがあります。私は自分のコンピューターにこれらのファイルをインストールして、作業を始めました。次のスライドには、ブートプラグインを管理するためのアプリケーションインターフェイスが表示されています。画面の中央にはおもちゃの振動を調整するためのスライダーがあり、左側にはボタン付きのコントロールパネルがあります。アカウントへのアクセス、ローカルネットワークの制御モード、インターネット経由のリモート制御モードです。アプリケーションの構造を理解するには、少しわかりにくいJavaScriptコードを読む必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gy/tc/l_/gytcl_o4cfm0iolamia3r6cfryo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私はJavaScriptが好きではありませんが、変数名とオブジェクトフィールド名の束が存在することが良い点です。これらはすべて完全にリバースエンジニアリングされています。コードをBeautifierにドロップして、どのように機能するかを確認してください。これを行うと、電子キーの操作を理解し始めることができます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fp/km/1s/fpkm1shgzrwislgaj09vm2ileg8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これがUSB経由で接続するための単なるシリアルポートであることを知り、キーとアプリケーション間のトラフィックをスニッフィングし始めました。スライドの右側の行に注意してください。最初に、ドングルとアプリケーションの間のメッセージがJSONテキスト形式であることに気付きました。 JavaScriptコードの場合、これはおなじみですが、32ビットマイクロコントローラーであるUSBキーの場合、JSONパーサーの埋め込みは奇妙に見えます。JSONパーサーには通常、使用可能なファームウェアのバグが含まれているため、非常に便利です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hj/5r/rk/hj5rrk2imjq5byefebbencwwmsg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、キーコード自体なしでバグを見つけるのは退屈な作業ですが、アプリケーションコードがあったため、USBキーファームウェアを更新するためのメカニズムを探し始め、すぐに必要なもの、つまり更新ノードのURLを見つけました。ファームウェアは暗号化も署名もされていないことが判明したので、ダウンロードして分析用のバイナリを取得しました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xc/q7/vs/xcq7vsjbakxsctt8th2gd_fwhni.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、リバースエンジニアリングを開始し、2つのことに注目しました。まず、USBシリアルポート用の2つのコマンドハンドラーがあります。 1つ目はリセットやデバイスタイプなどの単純なコマンドを使用し、2つ目はDFUなどのコマンドを使用してデバイスのファームウェアを更新するため、これらのコマンドを送信してファームウェアを更新することができます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oy/ol/b-/oyolb-kfxvjs8uq4ccxmvyrowdw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちにとって最も興味深いJSONパーサーを見て、予想されるバグであるparseJsonString関数を発見しました。元の文字列のコピーを新しいバッファーに割り当て、エスケープシーケンスなどを処理するだけです。新しいバッファの長さを計算すると、実際に使用される長さと一致しません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/po/n7/vw/pon7vwgs51_0b0xicll5adjy0km.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この関数は次のように機能します。これは、期待どおりに0ではなく、5つのパラメーターUのエスケープシーケンスをサポートします。これにより、nullで終了する文字列を回避し、最初に計算された文字列の長さを不正確にすることができます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lg/am/4y/lgam4y0v4ijpkvue8j2snjfr7xm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この小さなアニメーションは、ここで何が起こっているかを示しています。 Uの前のバックスラッシュは、6文字を破棄する必要があることを意味します。次に、関数はnullターミネーターをジャンプしますが、これは問題です。次にプロセスが続行され、すべての文字がコピーされて、長さが6バイトのバッファーに入れられます。ここで2番目の問題が発生します-バッファオーバーフローのリスク。これはすばらしいことですが、ドングルハードウェアがどのように機能するかはまだわかりません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wj/ea/hl/wjeahlydyx11z5kl0e_entwcoiw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ASLRアドレス空間のランダム化はなく、Cookieスタックもないことは確かですが、.text領域を除いて、キーがDEPデータ実行防止やメモリ内のコード実行を防止するXN保護などの保護を持っている可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
キーには、Corp M0プロセッサを搭載したNRF51822 SoCチップが搭載されており、DEP保護はありません。これは、BLEデバイスに非常に人気があり、多数のデバッグ用接点が搭載されています。したがって、いくつかのことをはんだ付けしてこのキーに接続し、出荷時の設定で無効になっていない場合は、SWDチップをデバッグおよびフラッシュするためのインターフェイスを介してデバッグを行うのは非常に簡単です。 SWD経由で接続することにより、ヒープの内容をフラッシュできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それはJSONパーサーにのみ使用されることがわかりましたが、これはあまりクールではありませんが、ヒープにはメタデータが含まれています。では、ここで台無しにできるものは何でしょうか？もちろん、ヒープのメタデータ！このようにして、JSONパーサーのエクスプロイトを作成します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qw/9o/zh/qw9ozhk_k6ixcm_iupcoyvun3xa.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ヒープは単なる空きリストです。このコードを見ると、各ディストリビューションに独自の長さとポインターがあることがわかります。バッファオーバーフローを使用すると、次のポインタの長さと位置を損なう可能性があり、次の分布の場所を制御できるようになります。新しい行をそこにコピーすることで、任意のデータを任意の場所に簡単に配置できます。これはすべて、デバッガが接続されているときに実行できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tb/hk/y7/tbhky7ub8kj5cbgpjhmrl-frong.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スライドの右側に、リセットされ、8文字だけで完全に上書きされたスタックが表示されます。これにより、USBキーのコードが実行されます。これはかなり便利です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
残念ながら、このドングルには緊急DFUファームウェア更新モードがあることを思い出しました。ゲームコンソールをハッキングするのと同じように、このモードは可能な限りあらゆる方法で更新を認証するのに役立ちます。ここで、DFUが従来のCRC16チェックサム計算を使用していることがわかります。これは、暗号化を理解している場合、いかなる種類の認証でもありません。この場合、本当に認証を使用したいとは思わなかったと思います。おそらく、ブートプラグのUSBキーコードの実行に関心のある人はほとんどいないと判断しただけです。しかし、興味をそそられました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/if/lg/py/iflgpyq2h1z6kusfwcpqf-x0vxy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現時点では、このデバイスでコードを実行する方法は2つありましたが、長い時間を費やしていたJSONパーサーを使いこなす方法は、DFUモードが存在するため、あまり効果的ではないことがわかりました。後で、この方法と既存のパーサーの脆弱性について検討します。これまでのところ、単にmain.binファイルを変更し、そのCRC16を再計算して、Lovense Remoteアプリケーションに含まれているプログラムを使用して埋め込むことができるかどうかに、より関心がありました。それが可能であることがわかりました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、PCアプリケーションを使用して侵害されたUSBキーを取得しましたが、それは明らかにクラックするのが最も簡単な部分でした。キーを制御できるようになったので、ブートプラグ自体でコードを実行する方法を探し始めました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vi/k2/vm/vik2vmib-ohaqm0hlaaldyaqmgc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを行うために、私は私たちの大人のおもちゃの「ハードウェア」に目を向けました-おそらくそれにもデバッガがあり、一見の価値がありました。ブートプラグを調べたところ、大量のフラッシュメモリとRAM、およびより強力なCortex M4プロセッサを備えた、より深刻なチップが見つかりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何が欠けていて、何がbootplagに搭載されているのかは簡単にわかりました。ドングルのようなDEPはなく、上部にはバッテリーにつながる配線があり、次は充電ポート、バイブレーターモーターの接点、デバッグ用のいくつかの接点パッド、およびBluetoothアンテナです。したがって、SWDが存在するため、デバイスを簡単に再フラッシュできます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/r8/ln/rd/r8lnrdx8uis5lkt3f-gtdkpssr0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何が起こったのかわかります。私には株主がいませんが、バッグの中には常に実験用のバットプラグがたくさんあります。次に、リバースエンジニアリングとbootplagのデバッグを開始し、元のファームウェアをリセットしました。 JSONパーサーはなく、単純なコマンドだけでしたが、多数ありました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ドングルのファームウェア更新モードが安全でない場合、脆弱性が存在する可能性があると思いました。それがそうであることが判明しました。 DFU検索の結果、通常のDFUコマンドハンドラーとブートセクターのDfuTarg行の2つが見つかりました。このDfuTargは、LVS-Z00ブートプラグインの識別子と同じように使用されます。つまり、BLEのDFUブートローダーに似ています。したがって、DFUモードでは、ブートログはDfuTargという名前のデバイスとして認識され、この一意の識別子を使用してデバイスを検索できます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、キーに送信したものとまったく同じDFUコマンドを送信すると、bootplagはデバイスファームウェア更新モードになります。フラッシングには、Nordic Semiconductorマイクロサーキットの製造元であるnRF Toolboxの専用ツールを使用できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xb/iy/pr/xbiyprlhoukirnf_su9htx71rqa.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ハードウェアスニファを使用すると、WiresharkでBLEパケットを視覚化できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xc/ea/9o/xcea9of9tdquhsfcjnjglzcsj78.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私は「hello from plug」という短いメッセージを送信しました。これは、ハッキングすることなくコードをbatplagで実行できることを意味します。これは脆弱性ではなく、デバイスを再フラッシュできる一種の開発者向けデザインです。おそらく、オープンソースコミュニティはこのソリューションを望んでいます。要するに、ブートプラグインに接続できる人なら誰でも自分のコードを実行できるということです。これはすでにかなり危険なことです。この場合、ハッカーはローカル接続の領域にいる必要があります。つまり、危険にさらされたドングルとBLEチャネルを介して性玩具を制御できるように十分に近くにある必要があります。同時に、ドングル自体、またはその他のBLEデバイスを使用できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/d_/uo/uy/d_uouyokp1p8mdsyx2x0yehkl14.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
問題は、ブートプラグインで実際に何ができるか、独自のコードを実行する機会があるかどうかです。いくつかのアイデアがあります。 1つ目は、これを制御して、ランサムウェアブートプラグを作成する方法です。ファームウェアを変更して、ユーザーが特定のキーを提供するか、バイブレーション機能をオフにしてこの便利なデバイスのロックを解除するために50ドルを要求するまで、DFUモードをオンにできないようにすることができます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cl/jb/ob/cljbobzlggrarkc30am8im-fe14.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの人にとって、これはそのようなおもちゃの使用による一種のワクチンとなります。 2番目のアイデアは、bootplagを武器に変えることです。バイブレーターモーターに電力を供給するかなり強力なバッテリーを備えています。ブートプラグの内容の80％はバッテリーと言えます。おそらくSamsung Galaxy Noteスマートフォンで何が起こったのか覚えているでしょう-爆発したばかりなので（笑）、これはお尻のプラグで起こる可能性が高いです。爆発の確率はわかりませんが、モーター付きの大人のおもちゃがたくさんある場合は、考えてみてください。開発チームは、多くの可動部分が存在するにもかかわらず、これらは完全に安全であると主張しています。ただし、この場合、デバイスのセキュリティ機能はハードウェアではなくソフトウェアでエンコードされます。この場合、悪意のあるコードの実行は悲惨な結果をもたらす可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
空気ポンプを装備した大人のおもちゃも危険です。彼らはまた、バッテリー付きのかなり強力なモーターを持っているので、それらにも注意を払う必要があります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に、最後のアイデアは敵対的な戦闘プラグインです。それはあなたのお尻を吹き飛ばすことができるという意味ではなく、それはあなたの残りのデバイスをハッキングする手段として役立つことができるという事実で敵対的です。したがって、悪意のあるコードの実行によって保証される敵意の観点からバトルプラグを検討します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
着信メッセージの処理方法を考慮して、ブートプラグインのアプリケーションでコード実行を実現できるかどうかを確認してみましょう。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/g_/ov/1v/g_ov1vzowj7o8hifa6xhfoo5gmq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
左側にJavaScriptのコールバックが表示され、右側にシリアルポートを介してアプリケーションとやり取りする方法が表示されます。コールバックは文字列に配置され、一連のさまざまな関数によって処理されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初の機能はキーを見つけることです、それはキーから来る初期化メッセージを処理します。 2番目の関数はオン（「データ」）であり、着信JSONパケットを受け入れる処理関数です。ちなみに、その長さは32文字を超えることはできません。次に、解析とその他すべてが行われます。実際、ここには深刻な処理はありません。デバイスのステータスを要求し、バッテリーの充電などを確認するだけです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後の関数ははるかに興味深いものです。実際のコードでは名前がありませんが、デバッグログと呼んでいます。この関数は、シリアルポートを介してデバイスに入力されるすべてのものを登録し、これらのラインをコンソールにリセットします。コンソールは必要に応じてエラーメッセージを表示します。さらに、この関数はHTML要素として新しいDOM要素を作成し、シリアルポートを介して受信したすべてのコンテンツをこのHTMLにスローします。私はWeb開発者ではありませんが、これは重大なXSS脆弱性だと思います。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、ドングルを制御できる場合は、シリアルポートを介して何でも送信でき、アプリケーションにこれをHTMLとして解釈させることができます。</font><font style="vertical-align: inherit;">これは問題です。HTMLには、コンピューターにインストールされているアプリケーションで新しいJavaScriptコードを作成する機能があるため、コードが危険にさらされる可能性があります。</font><font style="vertical-align: inherit;">問題は、一度に32文字しか許可されないことを知って、どのようなマルウェアを発明できるかです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
22:00 min </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DEFCON 27 Conference。Buttplug：真の侵入テスト。</font><font style="vertical-align: inherit;">パート2</font></font></a><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/RnxcPeemHSc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">広告のビット:)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
いつもご利用いただきありがとうございます。私たちの記事は好きですか？もっと面白い資料を見たいですか？</font><b><font style="vertical-align: inherit;">私たちがあなたのために私たちが発明したエントリーレベルのサーバーのユニークなアナログで</font></b><font style="vertical-align: inherit;">ある</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ 4.99から</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注文またはお友達</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">に開発者向けのクラウドベースのVPS</font></a><font style="vertical-align: inherit;">をお勧めすることで私たちをサポートして</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ください：</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VPS（KVM）E5-2697 v3（6コア）10GB DDR4 480GB SSD 1Gbpsの真実19ドルから、またはサーバーを分割する方法？</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（オプションは、RAID1およびRAID10、最大24コア、最大40GB DDR4で利用可能です）。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R730xdは、アムステルダムのEquinix Tier IVデータセンターで2倍安いですか？</font></font></b><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">オランダでは、</font></b><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">199ドルから、インテルTetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 TV</font></a></b><font style="vertical-align: inherit;">を</font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">2台</font></a></b><font style="vertical-align: inherit;">だけ持ってい</font><b><font style="vertical-align: inherit;">ます！</font></b></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デルR420-2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB-$ 99から！</font></font></b></b><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">インフラストラクチャビルディングの構築方法</font></a><font style="vertical-align: inherit;">について</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">お</font></a><font style="vertical-align: inherit;">読みください</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">Dell R730xd E5-2650 v4サーバーを使用するクラスcは、1ペニーで9,000ユーロかかりますか？</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja495366/index.html">16種類のプログラマ、または開発者は同じロボットではありません</a></li>
<li><a href="../ja495368/index.html">自己隔離の条件で自己散歩する自己犬に自己登録します</a></li>
<li><a href="../ja495370/index.html">公共は悪</a></li>
<li><a href="../ja495374/index.html">装飾シーリングライトGeneral Lumino 02</a></li>
<li><a href="../ja495376/index.html">退屈な検疫。ワンクリックでAzureで最も多くのお金を使う方法</a></li>
<li><a href="../ja495380/index.html">偉大なエジプトのファイアウォール</a></li>
<li><a href="../ja495384/index.html">マイクロソフトレドモンドでのインターンシップ経験とオファーの取得</a></li>
<li><a href="../ja495388/index.html">eSportsの祖先となった1970年代のテレビ番組</a></li>
<li><a href="../ja495390/index.html">STM32CubeMonitorは試してみる価値があります</a></li>
<li><a href="../ja495392/index.html">フロントエンドでバグを検索する方法：4つのメインステージ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>