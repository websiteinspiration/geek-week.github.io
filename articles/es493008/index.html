<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëåüèæ üõ†Ô∏è üë©üèø‚Äçüîß Acerca del cl√∫ster de servidores 1C ü§öüèΩ üëäüèª üî¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Un cl√∫ster es un tipo de 
 sistema paralelo o distribuido que: 
 1. consta de varias 
 computadoras interconectadas ; 
 2. Utilizado como un √∫nico 
 r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Acerca del cl√∫ster de servidores 1C</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/1c/blog/493008/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un cl√∫ster es un tipo de </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sistema </font><font style="vertical-align: inherit;">paralelo </font><font style="vertical-align: inherit;">o distribuido que: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. consta de varias </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
computadoras </font><font style="vertical-align: inherit;">interconectadas </font><font style="vertical-align: inherit;">; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Utilizado como un √∫nico </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
recurso inform√°tico unificado </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gregory F. Pfister, "En busca de grupos". </font></font></a></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dado:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hay una aplicaci√≥n comercial (por ejemplo, un sistema ERP) con la que miles (posiblemente decenas de miles) de usuarios trabajan simult√°neamente. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es requerido:</font></font></b><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Haga que la aplicaci√≥n sea escalable, de modo que con un aumento en el n√∫mero de usuarios, sea posible debido al aumento en los recursos de hardware para proporcionar el rendimiento necesario de la aplicaci√≥n.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Haga que la aplicaci√≥n sea resistente a fallas en los componentes del sistema (tanto software como hardware), p√©rdida de conexi√≥n entre componentes y otros posibles problemas.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilice los recursos del sistema de la manera m√°s eficiente posible y proporcione el rendimiento deseado de la aplicaci√≥n.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Haga que el sistema sea f√°cil de implementar y administrar.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para resolver estos problemas, utilizamos la arquitectura de cl√∫ster en la plataforma 1C: Enterprise. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No alcanzamos de inmediato el resultado deseado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este art√≠culo, hablaremos sobre qu√© tipo de cl√∫steres son, c√≥mo elegimos el tipo de cl√∫ster que nos conviene y c√≥mo nuestro cl√∫ster evolucion√≥ de una versi√≥n a otra, y qu√© enfoques nos permitieron crear un sistema que sirva a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">decenas de </font></font></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">miles de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usuarios simult√°neos.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0g/mo/rq/0gmorqiise6fvaouym5mwpabl7y.png" alt="imagen"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como Gregory Pfister, autor del ep√≠grafe de este art√≠culo, escribi√≥ en su libro "En busca de cl√∫steres", el cl√∫ster no fue inventado por ning√∫n fabricante particular de hardware o software, sino por clientes que carec√≠an de la potencia de una computadora o necesitaban redundancia. </font><font style="vertical-align: inherit;">Esto sucedi√≥, seg√∫n Pfister, en los a√±os 60 del siglo pasado. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Distinguir tradicionalmente los siguientes tipos principales de grupos:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cl√∫steres de conmutaci√≥n por error (HA, cl√∫steres de alta disponibilidad)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clusters de equilibrio de carga (LBC)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clusters inform√°ticos (Clusters inform√°ticos de alto rendimiento, HPC)</font></font></li>
<li>   (grid)      ,              .   grid-      ,    .  grid-    HPC-,      .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para resolver nuestros problemas (resistencia a fallas de los componentes del sistema y uso eficiente de los recursos), necesit√°bamos combinar la funcionalidad de un cl√∫ster a prueba de fallas y un cl√∫ster con equilibrio de carga. </font><font style="vertical-align: inherit;">No tomamos esta decisi√≥n de inmediato, pero la abordamos evolutivamente, paso a paso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para aquellos que no est√°n actualizados, les contar√© brevemente c√≥mo se organizan las aplicaciones comerciales de 1C. </font><font style="vertical-align: inherit;">Estas son aplicaciones escritas en un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lenguaje orientado a materias</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , "afiladas" para la automatizaci√≥n de las tareas comerciales de contabilidad. </font><font style="vertical-align: inherit;">Para ejecutar aplicaciones escritas en este lenguaje, se debe instalar un tiempo de ejecuci√≥n de la plataforma 1C: Enterprise en la computadora.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1C: Enterprise 8.0</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La primera versi√≥n del servidor de aplicaciones 1C (a√∫n no es un cl√∫ster) apareci√≥ en la versi√≥n de plataforma 8.0. Antes de eso, 1C trabajaba en la versi√≥n cliente-servidor, los datos se almacenaban en un archivo DBMS o MS SQL, y la l√≥gica de negocios funcionaba exclusivamente en el cliente. En la versi√≥n 8.0, se realiz√≥ una transici√≥n a la arquitectura de tres niveles "cliente - servidor de aplicaciones - DBMS". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El servidor 1C en la plataforma 8.0 era </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COM +</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un servidor que puede ejecutar el c√≥digo de la aplicaci√≥n en 1C. </font><font style="vertical-align: inherit;">El uso de COM + nos proporcion√≥ un transporte listo para usar, permitiendo que las aplicaciones del cliente se comuniquen con el servidor a trav√©s de la red. </font><font style="vertical-align: inherit;">Se dise√±aron muchas cosas en la arquitectura de la interacci√≥n cliente-servidor y los objetos de aplicaci√≥n disponibles para el desarrollador de 1C teniendo en cuenta el uso de COM +. </font><font style="vertical-align: inherit;">En ese momento, la tolerancia a fallas no estaba integrada en la arquitectura, y un bloqueo del servidor provoc√≥ el cierre de todos los clientes. </font><font style="vertical-align: inherit;">Cuando la aplicaci√≥n del servidor se bloque√≥, COM + la levant√≥ cuando el primer cliente accedi√≥ a ella, y los clientes comenzaron su trabajo desde el principio, desde la conexi√≥n al servidor. </font><font style="vertical-align: inherit;">En ese momento, todos los clientes fueron atendidos por un proceso.</font></font><br>
<img src="https://habrastorage.org/webt/fg/oo/en/fgooenmx-pqv5tuizcfcvbvbaqg.png" alt="imagen"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1C: Enterprise 8.1</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la pr√≥xima versi√≥n, quer√≠amos:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proporcionar tolerancia a fallas a nuestros clientes para que los accidentes y errores de algunos usuarios no conduzcan a accidentes y errores de otros usuarios. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desh√°gase de la tecnolog√≠a COM +. </font><font style="vertical-align: inherit;">COM + solo funcionaba en Windows, y en ese momento la posibilidad de trabajar con Linux ya se estaba volviendo relevante.</font></font></li>
</ul> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al mismo tiempo, no quer√≠amos desarrollar una nueva versi√≥n de la plataforma desde cero, ser√≠a demasiado intensiva en recursos. </font><font style="vertical-align: inherit;">Quer√≠amos aprovechar al m√°ximo nuestros logros, as√≠ como mantener la compatibilidad con las aplicaciones desarrolladas para la versi√≥n 8.0. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, en la versi√≥n 8.1 apareci√≥ el primer cl√∫ster. </font><font style="vertical-align: inherit;">Implementamos nuestro protocolo para llamadas a procedimientos remotos (adem√°s de TCP), que en apariencia se parec√≠a casi a COM + para el cliente consumidor final (es decir, pr√°cticamente no tuvimos que volver a escribir el c√≥digo responsable de las llamadas cliente-servidor). </font><font style="vertical-align: inherit;">Al mismo tiempo, hicimos que el servidor implementado en la plataforma C ++ sea independiente, capaz de funcionar tanto en Windows como en Linux.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El servidor monol√≠tico versi√≥n 8.0 fue reemplazado por 3 tipos de procesos: un proceso de trabajo que sirve a los clientes y 2 procesos de servicio que admiten la operaci√≥n del cl√∫ster:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rphost es un flujo de trabajo que sirve a los clientes y ejecuta el c√≥digo de la aplicaci√≥n. </font><font style="vertical-align: inherit;">Un cl√∫ster puede tener m√°s de un flujo de trabajo, se pueden ejecutar diferentes flujos de trabajo en diferentes servidores f√≠sicos, debido a esta escalabilidad se logra.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ragent: un proceso de agente de servidor que inicia todos los dem√°s tipos de procesos, as√≠ como una lista l√≠der de cl√∫steres ubicados en este servidor.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rmngr es un administrador de cl√∫ster que controla el funcionamiento de todo el cl√∫ster (pero el c√≥digo de la aplicaci√≥n no funciona en √©l). </font></font></li>
</ul><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debajo del corte se encuentra el diagrama de operaci√≥n de estos tres procesos en el cl√∫ster.</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/mn/yh/tc/mnyhtcaf9zf3_nqddsbfq4xgpsg.png" alt="image"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante la sesi√≥n, el cliente trabaj√≥ con un flujo de trabajo, la ca√≠da en el flujo de trabajo signific√≥ para todos los clientes a los que sirvi√≥ este proceso, la sesi√≥n termin√≥ de manera anormal. </font><font style="vertical-align: inherit;">Los clientes restantes continuaron trabajando.</font></font><br>
<img src="https://habrastorage.org/webt/wm/tm/mc/wmtmmcct7xd6v2ecl6vi7nlx5dk.png" alt="imagen"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1C: Enterprise 8.2</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la versi√≥n 8.2, quer√≠amos que las aplicaciones 1C pudieran ejecutarse no solo en el cliente nativo (ejecutable), sino tambi√©n en el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">navegador</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (sin modificar el c√≥digo de la aplicaci√≥n). </font><font style="vertical-align: inherit;">En este sentido, en particular, surgi√≥ la tarea de desacoplar el estado actual de la aplicaci√≥n de la conexi√≥n actual con el flujo de trabajo de rphost y dejarlo sin estado. </font><font style="vertical-align: inherit;">Como resultado, surgi√≥ el concepto de una sesi√≥n y los datos de la sesi√≥n que tuvieron que almacenarse fuera del flujo de trabajo (porque no ten√≠a estado). </font><font style="vertical-align: inherit;">Se ha desarrollado un servicio de datos de sesi√≥n que almacena y almacena en cach√© la informaci√≥n de la sesi√≥n. </font><font style="vertical-align: inherit;">Tambi√©n aparecieron otros servicios: un servicio de bloqueos transaccionales administrados, un servicio de b√∫squeda de texto completo, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta versi√≥n tambi√©n introdujo varias innovaciones importantes: mejor tolerancia a fallas, equilibrio de carga y un mecanismo de redundancia de cl√∫ster.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tolerancia a fallos</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como el proceso de trabajo se convirti√≥ en ap√°trida y todos los datos necesarios para el trabajo se almacenaron fuera del cliente actual - conexi√≥n de flujo de trabajo, en el caso de un bloqueo del flujo de trabajo, el cliente cambi√≥ a otro flujo de trabajo "en vivo" la pr√≥xima vez que accedi√≥ al servidor. En la mayor√≠a de los casos, dicho cambio era invisible para el cliente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El mecanismo funciona as√≠. Si la llamada del cliente al flujo de trabajo por alguna raz√≥n no se pudo completar hasta el final, entonces la parte del cliente puede, despu√©s de recibir un error de llamada, repetir esta llamada restableciendo la conexi√≥n al mismo flujo de trabajo u otro. Pero no siempre puedes repetir una llamada; Repetir la llamada significa que enviamos la llamada al servidor, pero no recibimos el resultado. Intentamos repetir la llamada, mientras realizamos la segunda llamada, evaluamos cu√°l fue el resultado de la llamada anterior en el servidor (la informaci√≥n sobre esto se almacena en el servidor en los datos de la sesi√≥n), porque si la llamada ten√≠a tiempo para "heredar" all√≠ (cerrar la transacci√≥n, guardar los datos de la sesi√≥n etc.): es imposible repetirlo, provocar√° inconsistencias en los datos. Si la llamada no puede repetirse, el cliente recibir√° un mensaje sobre un error irrecuperable,y la aplicaci√≥n del cliente tendr√° que reiniciarse. Si no logr√≥ "heredar" la llamada (y esta es la situaci√≥n m√°s com√∫n, porque muchas llamadas no cambian datos, por ejemplo, informes, visualizaci√≥n de datos en un formulario, etc., y aquellos que cambian datos no tienen una transacci√≥n o hasta que se haya enviado un cambio en los datos de la sesi√≥n al administrador (no hay rastro de la llamada), se puede repetir sin riesgo de inconsistencia de datos. Si el flujo de trabajo se bloque√≥ o se interrumpi√≥ una conexi√≥n de red, dicha llamada se repite y este "desastre" para la aplicaci√≥n cliente pasa completamente desapercibido.que cambian los datos (hasta que se confirma la transacci√≥n o hasta que el cambio en los datos de la sesi√≥n se env√≠a al administrador, no hay rastro de la llamada), se puede repetir sin riesgo de inconsistencia de datos. Si el flujo de trabajo se bloque√≥ o se interrumpi√≥ una conexi√≥n de red, dicha llamada se repite y este "desastre" para la aplicaci√≥n cliente pasa completamente desapercibido.que cambian los datos (hasta que se confirma la transacci√≥n o hasta que el cambio en los datos de la sesi√≥n se env√≠a al administrador, no hay rastro de la llamada), se puede repetir sin riesgo de inconsistencia de datos. Si el flujo de trabajo se bloque√≥ o se interrumpi√≥ una conexi√≥n de red, dicha llamada se repite y este "desastre" para la aplicaci√≥n cliente pasa completamente desapercibido.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Balanceo de carga</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La tarea del equilibrio de carga en nuestro caso es la siguiente: un nuevo cliente ingresa al sistema (o un cliente que ya est√° en funcionamiento hace otra llamada). </font><font style="vertical-align: inherit;">Necesitamos elegir a qu√© servidor y flujo de trabajo enviar la llamada del cliente para proporcionarle la m√°xima velocidad. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta es una tarea est√°ndar para un cl√∫ster de carga equilibrada. </font><font style="vertical-align: inherit;">Existen varios algoritmos t√≠picos para resolverlo, por ejemplo:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Round-Robin ()</a> ‚Äì    ,      ,   ‚Äì    . .    .           .    ,          ¬´¬ª .           (   )    .</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Weighted Round Robin</a> ‚Äì  Round-Robin:          ,    ÃÅ    .</li>
<li>Least Connections:     ,       .</li>
<li>Least Response Time:       :    ,    .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para nuestro cl√∫ster, elegimos un algoritmo que est√° esencialmente cerca del tiempo de menor respuesta. Tenemos un mecanismo que recopila estad√≠sticas sobre el rendimiento de los flujos de trabajo en todos los servidores del cl√∫ster. Hace una llamada de referencia a cada proceso del servidor en el cl√∫ster; la llamada de referencia involucra un subconjunto de las funciones del subsistema de disco, memoria, procesador y eval√∫a qu√© tan r√°pido se realiza dicha llamada. El resultado de estas mediciones, promediado en los √∫ltimos 10 minutos, es un criterio: qu√© servidor del cl√∫ster es el m√°s productivo y el preferido para enviarle conexiones de clientes en un per√≠odo de tiempo determinado. Las solicitudes de los clientes se distribuyen de manera que se cargue mejor el servidor m√°s productivo: cargue el que tenga suerte.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La solicitud del nuevo cliente se dirige al servidor m√°s productivo en este momento. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la mayor√≠a de los casos, una solicitud de un cliente existente se dirige a ese servidor y al flujo de trabajo al que se dirigi√≥ su solicitud anterior. </font><font style="vertical-align: inherit;">Un conjunto extenso de datos en el servidor est√° asociado con un cliente que funciona; transferirlo entre procesos (y a√∫n m√°s entre servidores) es bastante costoso (aunque tambi√©n podemos hacerlo). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Una solicitud de un cliente existente se transfiere a otro flujo de trabajo en dos casos:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No hay m√°s procesos: el flujo de trabajo con el que el cliente interactu√≥ anteriormente ya no est√° disponible (el proceso se ha ca√≠do, el servidor no est√° disponible, etc.).</font></font></li>
<li>   :     ,            ,     ,   ,              .         ,  ,     ‚Äì             .    ‚Äì      (..   ).</li>
</ol><br>
<br>
<h3> </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Decidimos aumentar la resistencia del cl√∫ster recurriendo al esquema </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">activo / pasivo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Hubo una oportunidad para configurar dos grupos: trabajo y reserva. </font><font style="vertical-align: inherit;">Si el cl√∫ster principal no est√° disponible (problemas de red o, por ejemplo, mantenimiento programado), las llamadas del cliente se redirigen al cl√∫ster de respaldo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sin embargo, este dise√±o fue bastante dif√≠cil de configurar. </font><font style="vertical-align: inherit;">El administrador tuvo que ensamblar manualmente dos grupos de servidores en grupos y configurarlos. </font><font style="vertical-align: inherit;">A veces, los administradores cometieron errores al establecer configuraciones conflictivas, como </font><font style="vertical-align: inherit;">no exist√≠a un mecanismo centralizado para verificar la configuraci√≥n. </font><font style="vertical-align: inherit;">Pero, sin embargo, este enfoque aument√≥ la tolerancia a fallas del sistema.</font></font><br>
<img src="https://habrastorage.org/webt/ik/k7/06/ikk7062chdd8qtpk0kzvfncq7vu.png" alt="imagen"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1C: Enterprise 8.3</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la versi√≥n 8.3, reescribimos sustancialmente el c√≥digo del lado del servidor responsable de la tolerancia a fallas. Decidimos abandonar el esquema de cl√∫ster activo / pasivo debido a la complejidad de su configuraci√≥n. Solo qued√≥ un cl√∫ster tolerante a fallas en el sistema, que consta de cualquier n√∫mero de servidores; esto est√° m√°s cerca del esquema </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Activo / activo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en el que las solicitudes de un nodo fallido se distribuyen entre los nodos de trabajo restantes. Debido a esto, el cl√∫ster se ha vuelto m√°s f√°cil de configurar. Una serie de operaciones que aumentan la tolerancia a fallas y mejoran el equilibrio de carga se han automatizado. De las innovaciones importantes:</font></font><br>
<br>
<ul>
<li>   ¬´ ¬ª: , ,               .                ,           ¬´¬ª          .</li>
<li>     ,  ,            .</li>
<li>  ,     ,     ,   ,   ,    :</li>
</ul><br>
<img src="https://habrastorage.org/webt/o7/aw/pz/o7awpzltn3jxnderotcyf_wbahm.png" alt="imagen"><br>
<br>
<img src="https://habrastorage.org/webt/v5/kc/rj/v5kcrjv3ldm96l3ovj1seqobrga.png" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La idea principal de estos desarrollos es simplificar el trabajo del administrador, permiti√©ndole configurar el cl√∫ster en t√©rminos que le son familiares, en el nivel de operaci√≥n del servidor, no cayendo m√°s bajo, y tambi√©n para minimizar el nivel de "control manual" del trabajo del cl√∫ster, dando los mecanismos del cl√∫ster para resolver la mayor√≠a de las tareas de trabajo y posibles problemas ". en piloto autom√°tico ".</font></font><br>
<br>
<img src="https://habrastorage.org/webt/da/9i/zy/da9izy3cj4wlf80nr8s35tqnp3e.png" alt="imagen"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tres enlaces de tolerancia a fallas</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como sabe, incluso si los componentes del sistema por separado son confiables, pueden surgir problemas donde los componentes del sistema se causan entre s√≠. </font><font style="vertical-align: inherit;">Quer√≠amos minimizar la cantidad de lugares cr√≠ticos para el rendimiento del sistema. </font><font style="vertical-align: inherit;">Una consideraci√≥n adicional importante fue la minimizaci√≥n de las alteraciones de los mecanismos aplicados en la plataforma y la exclusi√≥n de los cambios en las soluciones aplicadas. </font><font style="vertical-align: inherit;">En la versi√≥n 8.3, hab√≠a 3 enlaces para garantizar la tolerancia a fallos "en las juntas":</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kb/1g/s1/kb1gs1mfus_rsminiyizg4t5dma.png" alt="imagen"><br>
<ol>
<li>  ,   HTTP(S),  -.   -     -.    ,   HTTP  -,    (     HTTP)    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">libcurl</a>    . </li>
<li>  ,                     .</li>
<li>  -   .       1,   -     .    -            .       ,         .           ,     ‚Äì    .    -         (,     ,   ,         ) ‚Äì          .</li>
<li>     ,    rmngr.    20 (    ) ‚Äî   ,     ..                .     1:          .</li>
</ol><br>
<br>
<h2> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gracias al mecanismo de tolerancia a fallas, las aplicaciones creadas en la plataforma 1C: Enterprise sobreviven con √©xito varios tipos de fallas de los servidores de producci√≥n en el cl√∫ster, mientras que la mayor√≠a de los clientes contin√∫an trabajando sin reiniciar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hay situaciones en las que no podemos repetir la llamada, o un bloqueo del servidor atrapa la plataforma en un momento muy desafortunado, por ejemplo, en medio de una transacci√≥n y no est√° muy claro qu√© hacer con ellos. Intentamos garantizar una supervivencia estad√≠sticamente buena del cliente cuando los servidores caen en el cl√∫ster. Como regla general, la p√©rdida promedio de clientes por falla del servidor es de un peque√±o porcentaje. En este caso, todos los clientes "perdidos" pueden continuar trabajando en el cl√∫ster despu√©s de reiniciar la aplicaci√≥n cliente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La confiabilidad del cl√∫ster de servidores 1C en la versi√≥n 8.3 ha aumentado significativamente. </font><font style="vertical-align: inherit;">Hace tiempo que no es raro introducir productos 1C, donde el n√∫mero de usuarios que trabajan simult√°neamente alcanza varios miles. </font><font style="vertical-align: inherit;">Existen implementaciones en las que tanto 5.000 como 10.000 usuarios trabajan simult√°neamente, por ejemplo, la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">introducci√≥n en Beeline</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , donde la aplicaci√≥n 1C: Trade Management sirve a todos los </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">puntos de</font></a><font style="vertical-align: inherit;"> venta de Beeline en Rusia, o la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">implementaci√≥n de Business Lines en el transportista de carga</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , donde la aplicaci√≥n, creada independientemente por los desarrolladores del departamento de TI de Business Lines en la plataforma 1C: Enterprise, sirve el ciclo completo del transporte de carga. </font><font style="vertical-align: inherit;">Nuestras pruebas de carga de cl√∫ster internas simulan la operaci√≥n simult√°nea de hasta 20,000 usuarios.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conclusi√≥n, me gustar√≠a enumerar brevemente qu√© m√°s es √∫til en nuestro cl√∫ster (la lista est√° incompleta):</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a>,         . ,             ,   .</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">  </a> ‚Äì ,   ,   ,   (      ‚Äì <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a>, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">   </a>  ..)      . ,   ,      (, )     ,   ERP, ,           ERP.</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">  </a> ‚Äì ,     (,  ,    ..).  ,  ,    ,     ,   ,        .</li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es492994/index.html">Novedades de TestMace Parte 1. Sincronizaci√≥n en la nube, interfaz actualizada y m√°s</a></li>
<li><a href="../es492996/index.html">Marcar y desmantelar formatos de fecha personalizados en Go</a></li>
<li><a href="../es492998/index.html">C√≥mo nos confundimos con el trabajo independiente para un centro de datos y qu√© surgi√≥</a></li>
<li><a href="../es493000/index.html">M√©todos para tratar con c√≥digo heredado usando GitLab como ejemplo</a></li>
<li><a href="../es493002/index.html">350 personas de forma remota: c√≥mo fue</a></li>
<li><a href="../es493010/index.html">C√≥mo combina Quarkus la programaci√≥n imperativa y reactiva</a></li>
<li><a href="../es493012/index.html">Aire, rel√©s, cable por la ventana: c√≥mo no encontrarse con un proveedor monopolista en un centro de negocios</a></li>
<li><a href="../es493014/index.html">Entrevista con Vyacheslav Utochkin, Director de Programas de Desarrollo Educativo en la Escuela Superior de Econom√≠a, Escuela Superior de Econom√≠a, Escuela Superior de Econom√≠a; 20 preguntas sobre Gamedev</a></li>
<li><a href="../es493016/index.html">El t√≠tulo "Leer art√≠culos para usted". Enero - febrero 2020</a></li>
<li><a href="../es493018/index.html">El desarrollador apreci√≥ la complejidad de los navegadores modernos.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>