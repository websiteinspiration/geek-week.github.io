<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â›¹ğŸ» ğŸ˜‚ ğŸš ãƒ­ãƒ¼ã‚«ãƒ«è‡ªå¾‹ãƒ‡ãƒ¼ã‚¿åé›†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆç¶šãï¼‰ ğŸ‘µğŸ½ ğŸ“ â–ªï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ã“ã®ã‚µã‚¤ãƒˆã‚’å‚ç…§ã—ã¦é–‹å§‹ã—ã¾ã™ã€‚
 
 ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã‚’ã‚ªãƒ³ã«ã™ã‚‹æƒ…å ±ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã®æœ€ã‚‚ä¾¿åˆ©ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€PC817ã‚ªãƒ—ãƒˆã‚«ãƒ—ãƒ©ãƒ¼ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã‚ã‚‹ã“ã¨ãŒåˆ¤æ˜ã—ã¾ã—ãŸã€‚
 
 å›è·¯å›³
 ãƒœãƒ¼ãƒ‰ã«ã¯3ã¤ã®åŒã˜å›è·¯ãŒå«ã¾ã‚Œã¦ãŠã‚Šã€ã™ã¹ã¦ãŒã‚µã‚¤ã‚º100x100 mmã®ABSãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯è£½ã®ãƒœãƒƒã‚¯ã‚¹ã«åã‚ã‚‰...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ãƒ­ãƒ¼ã‚«ãƒ«è‡ªå¾‹ãƒ‡ãƒ¼ã‚¿åé›†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆç¶šãï¼‰</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451154/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã®ã‚µã‚¤ãƒˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’å‚ç…§ã—ã¦</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é–‹å§‹ã—</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ã¾ã™</font></a><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã‚’ã‚ªãƒ³ã«ã™ã‚‹æƒ…å ±ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã®æœ€ã‚‚ä¾¿åˆ©ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€PC817ã‚ªãƒ—ãƒˆã‚«ãƒ—ãƒ©ãƒ¼ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã‚ã‚‹ã“ã¨ãŒåˆ¤æ˜ã—ã¾ã—ãŸã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å›è·¯å›³</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/wd/b4/bp/wdb4bp10a_fcsqmqvi5bxbkedgq.jpeg" alt="image alt" align="left"></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒœãƒ¼ãƒ‰ã«ã¯3ã¤ã®åŒã˜å›è·¯ãŒå«ã¾ã‚Œã¦ãŠã‚Šã€ã™ã¹ã¦ãŒã‚µã‚¤ã‚º100x100 mmã®ABSãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯è£½ã®ãƒœãƒƒã‚¯ã‚¹ã«åã‚ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚ </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å†™çœŸã‚ªãƒ—ãƒˆã‚«ãƒ—ãƒ©ãƒ¼</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/ww/au/qh/wwauqhutnnp2vez5-dtjlow9a-c.jpeg" alt="image alt" align="left"></div></div> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åŠå°ä½“ãƒãƒ«ãƒ–ã‚’å‚™ãˆãŸã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã«æ¥ç¶šã™ã‚‹ã¨ã€ãã‚Œã‚‰ã®æ¼ã‚Œé›»æµã¯PC817ã‚’é–‹ãã®ã«ååˆ†ã§ã‚ã‚Šã€èª¤ã£ãŸã‚«ã‚¦ãƒ³ã‚¿ãƒ¼æ“ä½œãŒç™ºç”Ÿã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®çŠ¶æ³ã‚’è§£æ¶ˆã™ã‚‹ã«ã¯</font></font><a name="habracut"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é †æ¬¡ã€ãƒ•ã‚©ãƒˆã‚«ãƒ—ãƒ©ãƒ¼LEDã¨å‹•ä½œè¡¨ç¤ºLEDã®å›è·¯ã«ã‚‚ã†1ã¤è¿½åŠ ã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã‚’è¡Œã†ã«ã¯ã€ã‚¸ãƒ£ãƒ³ãƒ‘ãƒ¼J1ã‚’é–‹ãã€è¿½åŠ ã®LED1ã‚’ã¯ã‚“ã ä»˜ã‘ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å—ä¿¡éƒ¨ã¯ä¸Šã«ä½œã‚‰ã‚Œã¦ã„ã¾ã™</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚µã‚¤ãƒ‰1</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/lh/gi/xw/lhgixwo48c-gcbyxvogroko5osw.jpeg" alt="image alt" align="left"></div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚µã‚¤ãƒ‰2</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/x5/-c/g1/x5-cg1zzm4bwpsheiw2zhs2jg4q.jpeg" alt="image alt" align="left"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ARDUINO MEGA 2560ã«æ¥ç¶šã•ã‚ŒãŸãƒ–ãƒ¬ãƒƒãƒ‰ãƒœãƒ¼ãƒ‰ã€‚ã“ã‚Œã«ã¯ã€ç«¯ã«ã‚ã‚‹2åˆ—ã®ã‚³ãƒã‚¯ã‚¿ãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">æƒ…å ±è¡¨ç¤ºè£…ç½®ã¨ã—ã¦ã€è§£åƒåº¦240x400ã®ç”»é¢ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HX8352Bã€‚</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/tt/o5/un/tto5unc0dk2yyqlk9z5xykbqryk.jpeg" alt="image alt" align="left"></div></div> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãŸã€ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒœãƒ¼ãƒ‰ä¸Šã®ICSPã¸ã®ã‚³ãƒã‚¯ã‚¿ãƒ¼ã¯è§£ä½“ã•ã‚Œã¦ãŠã‚Šã€ãƒã‚¤ã‚¯ãƒ­SDã‚¹ãƒ­ãƒƒãƒˆã¯ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚å®Ÿéš›ã«ã¯ã€SPIãƒã‚¹ã®ç«¶åˆã«ã‚ˆã‚Šã€ã€Œãƒã‚¤ãƒ†ã‚£ãƒ–ã€SDã‚¹ãƒ­ãƒƒãƒˆã¯ä½¿ç”¨ã§ãã¾ã›ã‚“ã€‚ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰ã«ã¯ã€3.3Vã‚¹ã‚¿ãƒ“ãƒ©ã‚¤ã‚¶ãƒ¼ã¨3ã¤ã®å‡ºåŠ›çŠ¶æ…‹ã‚’æŒã¤ãƒãƒƒãƒ•ã‚¡ãƒ¼ãƒãƒƒãƒ—ã‚’å‚™ãˆãŸåˆ¥ã®ã‚«ãƒ¼ãƒ‰ãƒªãƒ¼ãƒ€ãƒ¼74LVS125Aã‚’ä½¿ç”¨ã—ã¾ã—ãŸã€‚ã“ã“ã§ç†Šæ‰‹ãŒç§ã‚’å¾…ã£ã¦ã„ã¾ã—ãŸã€‚ 3ã¤ã®çŠ¶æ…‹ã‚’æŒã¤ãƒãƒƒãƒ•ã‚¡ã§ã™ãŒã€E01-ML01DP5ã¾ãŸã¯ã‚«ãƒ¼ãƒ‰ãƒªãƒ¼ãƒ€ãƒ¼ã®ã„ãšã‚Œã‹ã§å‹•ä½œã—ã¾ã—ãŸã€‚ SdFatãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚³ãƒ¡ãƒ³ãƒˆã§ã€ä»–ã®ãƒ‡ãƒã‚¤ã‚¹ã¨ã®éäº’æ›æ€§ã«é–¢ã™ã‚‹è­¦å‘ŠãŒè¡¨ç¤ºã•ã‚Œã¾ã—ãŸã€‚ TXS0108Eã®ãƒ¬ãƒ™ãƒ«ã‚³ãƒ³ãƒãƒ¼ã‚¿ãƒ¼ã¯å‰Šé™¤ã•ã‚Œã€ã‚¸ãƒ£ãƒ³ãƒ‘ãƒ¼ã«ç½®ãæ›ãˆã‚‰ã‚Œã¾ã—ãŸã€‚ E01-ML01DP5ã¯5Vä¿¡å·ã«è€ãˆã¾ã™-åŠ©ã‘ã«ã¯ãªã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ã‚ªã‚·ãƒ­ã‚¹ã‚³ãƒ¼ãƒ—ã‚’ä½¿ç”¨ã—ã¦ã€ã‚«ãƒ¼ãƒ‰ãƒªãƒ¼ãƒ€ãƒ¼ãŒæ¥ç¶šã•ã‚ŒãŸã¨ãã«MISOãƒ©ã‚¤ãƒ³ã®ä¿¡å·æå¤±ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸã€‚ã‚ˆãèª¿ã¹ã¦ã¿ã‚‹ã¨4ãƒãƒ£ãƒ³ãƒãƒ«ã®74LVS125Aã®æœ‰åŠ¹åŒ–ä¿¡å·OEã®å…¥åŠ›ã¯ã€å…±é€šã®ãƒ¯ã‚¤ãƒ¤ãƒ¼ã«ã¯ã‚“ã ä»˜ã‘ã•ã‚Œã¦ã„ã‚‹ã ã‘ã§ã‚ã‚Šã€3ç•ªç›®ã®çŠ¶æ…‹ã«ã¤ã„ã¦ã®è©±ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãƒãƒƒãƒ•ã‚¡ãƒãƒƒãƒ—ã¯ã€ä¿¡å·ç·šã¨ç›´åˆ—ã«æ¥ç¶šã•ã‚ŒãŸ3.3KÎ©æŠµæŠ—ã‚’ä½¿ç”¨ã—ã¦5Vã‹ã‚‰3.3Vã¸ã®ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ãƒ¬ãƒ™ãƒ«ã‚³ãƒ³ãƒãƒ¼ã‚¿ãƒ¼ã¨ã—ã¦ä½¿ç”¨ã•ã‚Œã¾ã—ãŸã€‚ MISOãƒ©ã‚¤ãƒ³ã‚’é™¤ãã¾ã™ã€‚å½¼å¥³ã®å‡ºåŠ›ä¸‹éƒ¨ã‚­ãƒ¼ã¯ãŠãã‚‰ãä¿¡å·ã‚’ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã«å¼•ã£å¼µã£ãŸã€‚ MISOãƒ©ã‚¤ãƒ³ã®ã‚¤ãƒãƒ¼ãƒ–ãƒ«ä¿¡å·ãŒãƒ”ãƒ³13ã§ã‚ã‚‹ã¨åˆ¤æ–­ã—ãŸãŸã‚ã€ãƒˆãƒ©ãƒƒã‚¯ã‹ã‚‰åˆ‡ã‚Šé›¢ã•ã‚Œã€MISOãƒ©ã‚¤ãƒ³ã®ã‚¤ãƒãƒ¼ãƒ–ãƒ«ä¿¡å·ãŒãƒ”ãƒ³13ã§ã‚ã‚‹ã¨åˆ¤æ–­ã—ãŸãŸã‚ã€ãƒˆãƒ©ãƒƒã‚¯ã‹ã‚‰åˆ‡ã‚Šé›¢ã•ã‚Œã€MISOãƒ©ã‚¤ãƒ³ã®ã‚¤ãƒãƒ¼ãƒ–ãƒ«ä¿¡å·ãŒãƒ”ãƒ³13ã§ã‚ã‚‹ã¨åˆ¤æ–­ã—ãŸãŸã‚ã€ãƒˆãƒ©ãƒƒã‚¯ã‹ã‚‰åˆ‡ã‚Šé›¢ã•ã‚Œã€</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯ã‚“ã ä»˜ã‘</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/wa/fy/dq/wafydqpdmui3d9sa0v4odl7csiy.jpeg" alt="image alt" align="left"></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CSãƒ‡ãƒã‚¤ã‚¹é¸æŠã®å…¥åŠ›ï¼ˆ9ï¼‰74LVS125Aã®å‡ºåŠ›ã¨çµ‚ç«¯æŠµæŠ—ã®é–“ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã§ã€ãƒ¡ãƒ¢ãƒªã‚«ãƒ¼ãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„å ´åˆã€MISOãƒãƒƒãƒ•ã‚¡ã¯ç„¡åŠ¹ã«ãªã‚Šã€åˆ¥ã®ãƒ‡ãƒã‚¤ã‚¹ã®å‹•ä½œã«å¹²æ¸‰ã—ãªããªã‚Šã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ–ãƒ¬ãƒƒãƒ‰ãƒœãƒ¼ãƒ‰ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/v7/h1/hw/v7h1hwt9dna8br023xqpfzcn0vk.jpeg" alt="image alt" align="left"></div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è·å ´ã®ãƒ¬ã‚·ãƒ¼ãƒãƒ¼</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/pw/ks/ic/pwksicc1dsu56ohlkei3gx8xgse.jpeg" alt="image alt" align="left"></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¯ãƒ­ãƒƒã‚¯ã‚’DS3231ã«æ¥ç¶šã™ã‚‹ã«ã¯ã€I2Cã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãƒã‚¹ï¼ˆTWIï¼‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino IDEãƒ—ãƒ­ã‚°ãƒ©ãƒ </font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">// IMPORTANT: Adafruit_TFTLCD LIBRARY MUST BE SPECIFICALLY<font></font>
// CONFIGURED FOR EITHER THE TFT SHIELD OR THE BREAKOUT BOARD.<font></font>
// SEE RELEVANT COMMENTS IN Adafruit_TFTLCD.h FOR SETUP.<font></font>
//by Open-Smart Team and Catalex Team<font></font>
//catalex_inc@163.com<font></font>
//Store:   http://dx.com<font></font>
//           https://open-smart.aliexpress.com/store/1199788<font></font>
//Demo Function: Display graphics, characters<font></font>
//Arduino IDE: 1.6.5<font></font>
// Board: Arduino UNO R3, Arduino Mega2560,Arduino Leonardo<font></font>
<font></font>
// Board:OPEN-SMART UNO R3 5V / 3.3V, Arduino UNO R3, Arduino Mega2560<font></font>
//3.2INCH TFT:<font></font>
// https://www.aliexpress.com/store/product/3-2-TFT-LCD-Display-module-Touch-Screen-Shield-board-onboard-temperature-sensor-w-Touch-Pen/1199788_32755473754.html?spm=2114.12010615.0.0.bXDdc3<font></font>
//OPEN-SMART UNO R3 5V / 3.3V:<font></font>
// https://www.aliexpress.com/store/product/OPEN-SMART-5V-3-3V-Compatible-UNO-R3-CH340G-ATMEGA328P-Development-Board-with-USB-Cable-for/1199788_32758607490.html?spm=2114.12010615.0.0.ckMTaN<font></font>
<font></font>
#include &lt;Adafruit_GFX.h&gt;    // Core graphics library<font></font>
//#include &lt;Adafruit_TFTLCD.h&gt; // Hardware-specific library<font></font>
#include &lt;MCUFRIEND_kbv.h&gt;<font></font>
MCUFRIEND_kbv tft;<font></font>
#include "SdFat.h"           // Use the SdFat library<font></font>
SdFat SD;<font></font>
SdFile file;<font></font>
File myFile;<font></font>
#define SD_CS_PIN SS<font></font>
<font></font>
#include &lt;SPI.h&gt;                                               //       SPI<font></font>
#include &lt;nRF24L01.h&gt;                                          //      RF24<font></font>
#include &lt;RF24.h&gt;                                              //      nRF24L01+<font></font>
RF24           radio(47, 49);<font></font>
<font></font>
#include &lt;DS3231.h&gt;<font></font>
<font></font>
DS3231  rtc(27, 25);<font></font>
Time  t;<font></font>
<font></font>
uint16_t   r = 6000;<font></font>
uint32_t    k = 0;<font></font>
<font></font>
volatile unsigned long data;<font></font>
float leb_1;<font></font>
float leb_2;<font></font>
float leb_3;<font></font>
float leb_4;<font></font>
<font></font>
uint8_t        pipe;<font></font>
int rc = 0;<font></font>
<font></font>
uint8_t time_sec_prev;<font></font>
uint8_t time_day_prev;<font></font>
<font></font>
//***********************************************//<font></font>
// If you use OPEN-SMART TFT breakout board                 //<font></font>
// Reconmmend you to add 5V-3.3V level converting circuit.<font></font>
// Of course you can use OPEN-SMART UNO Black version with 5V/3.3V power switch,<font></font>
// you just need switch to 3.3V.<font></font>
// The control pins for the LCD can be assigned to any digital or<font></font>
// analog pins...but we'll use the analog pins as this allows us to<font></font>
//----------------------------------------|<font></font>
// TFT Breakout  -- Arduino UNO / Mega2560 / OPEN-SMART UNO Black<font></font>
// GND              -- GND<font></font>
// 3V3               -- 3.3V<font></font>
// CS                 -- A3<font></font>
// RS                 -- A2<font></font>
// WR                -- A1<font></font>
// RD                 -- A0<font></font>
// RST                -- RESET<font></font>
// LED                -- GND<font></font>
// DB0                -- 8<font></font>
// DB1                -- 9<font></font>
// DB2                -- 10<font></font>
// DB3                -- 11<font></font>
// DB4                -- 4<font></font>
// DB5                -- 13<font></font>
// DB6                -- 6<font></font>
// DB7                -- 7<font></font>
<font></font>
// Assign human-readable names to some common 16-bit color values:<font></font>
#define	BLACK   0x0000<font></font>
#define	BLUE    0x001F<font></font>
#define	RED     0xF800<font></font>
#define	GREEN   0x07E0<font></font>
#define CYAN    0x07FF<font></font>
#define MAGENTA 0xF81F<font></font>
#define YELLOW  0xFFE0<font></font>
#define WHITE   0xFFFF<font></font>
#define GRAY    0x8C51<font></font>
#define GRAYD   0x39E7<font></font>
<font></font>
//Adafruit_TFTLCD tft(LCD_CS, LCD_CD, LCD_WR, LCD_RD, LCD_RESET);<font></font>
// If using the shield, all control and data lines are fixed, and<font></font>
// a simpler declaration can optionally be used:<font></font>
// Adafruit_TFTLCD tft;<font></font>
uint16_t g_identifier;<font></font>
<font></font>
String dataString;<font></font>
//String numfileMonth ="1.txt";<font></font>
char perv [] = {"2.txt"};<font></font>
//String *numfileMonth="1.txt" (sizeof (numfileMonth));<font></font>
///////////////////////////////////////////////////////////////////<font></font>
<font></font>
void setup(void) {<font></font>
<font></font>
  rtc.begin();<font></font>
<font></font>
  //   -   <font></font>
  // rtc.setDOW(6);               //  <font></font>
  // rtc.setTime(22, 04, 0);      // ,   24 .<font></font>
  // rtc.setDate(4, 5, 2019);   // , 29  2018.<font></font>
<font></font>
  Serial.begin(2000000);<font></font>
////////  <font></font>
  tft.begin(0x65);<font></font>
  tft.reset();<font></font>
  tft.setRotation(0);<font></font>
  tft.cp437(true);<font></font>
////////////////// ,  ,  <font></font>
  tft.fillScreen(BLACK);<font></font>
  tft.setTextColor(WHITE);<font></font>
  tft.setTextSize(2);<font></font>
  tft.setCursor (8, 0);<font></font>
  tft.println ("DEVELOPERS &amp; BUILD" );<font></font>
  tft.setCursor (30, 20);<font></font>
  tft.print (utf8rus(" .." ));<font></font>
  tft.setCursor (40, 40);<font></font>
  tft.print (utf8rus(" .." ));<font></font>
  delay (2000);<font></font>
<font></font>
  radio.begin();                             //   nRF24L01+<font></font>
  radio.setChannel(120);                     //     ( 0  127)<font></font>
  radio.setDataRate     (RF24_250KBPS);      //     (RF24_250KBPS, RF24_1MBPS, RF24_2MBPS), RF24_1MBPS - 1/<font></font>
  radio.setPALevel      (RF24_PA_MAX);       //    (RF24_PA_MIN=-18dBm, RF24_PA_LOW=-12dBm, RF24_PA_HIGH=-6dBm, RF24_PA_MAX=0dBm)<font></font>
  radio.openReadingPipe (1, 0xAABBCCDD11LL); //  1    1  0xAABBCCDD11,   <font></font>
                                             //  2    2  0xAABBCCDD22,   <font></font>
  radio.startListening  ();                  //  ,    <font></font>
  //  radio.stopListening   ();<font></font>
////////  <font></font>
  tft.fillScreen(BLACK);<font></font>
  tft.setCursor (8, 0);<font></font>
  tft.setTextSize(1);<font></font>
////////  SD <font></font>
  Serial.println("Initial SD card");<font></font>
  tft.println("Initial SD card");<font></font>
  tft.setCursor (8, 10);<font></font>
//////// <font></font>
  if (!SD.begin(SD_CS_PIN)) {<font></font>
    Serial.println("initial failed!");<font></font>
    tft.fillRect ( 8 , 10 , 85 , 7 , RED);<font></font>
    tft.setTextColor(BLACK);<font></font>
    tft.println("Initial failed!");<font></font>
    return;<font></font>
  }<font></font>
  tft.setTextColor(WHITE);<font></font>
  Serial.println("initialization done");<font></font>
  tft.println("Initialization done");<font></font>
  delay (2000);<font></font>
//////// -     <font></font>
  t = rtc.getTime();<font></font>
  time_sec_prev = t.sec;<font></font>
  time_day_prev = t.date;<font></font>
////////  ,        <font></font>
  tft.setCursor (  180 , 0 );              //   <font></font>
  tft.fillRect ( 178 , 0 , 65 , 7 , GRAY); //    <font></font>
  tft.setTextSize(1);<font></font>
  tft.print(rtc.getDateStr());<font></font>
////////   <font></font>
  tft.setTextSize(2);<font></font>
  tft.setCursor (60, 25);<font></font>
  tft.println (utf8rus(" I"));<font></font>
////////       <font></font>
  tft.setTextSize(1);<font></font>
  tft.setCursor(130, 10); //    2.txt ,      <font></font>
  if (SD.exists (perv)) {<font></font>
    //tft.setCursor(0, 90);<font></font>
    tft.println(perv);<font></font>
    Serial.println(perv);<font></font>
  } else {<font></font>
    myFile = SD.open(perv, FILE_WRITE);  //    2.txt ,    <font></font>
    myFile.close();<font></font>
    tft.println(perv);<font></font>
    Serial.println(perv);<font></font>
  }  <font></font>
}<font></font>
<font></font>
void loop(void) {<font></font>
////////       - <font></font>
  if (Serial.available() &gt; 0) {<font></font>
   <font></font>
////////    ,      <font></font>
    File myFile = SD.open(perv);<font></font>
    // if the file is available, write to it:<font></font>
    if (myFile) {<font></font>
      while (myFile.available()) {<font></font>
        Serial.write(myFile.read());<font></font>
      }<font></font>
      myFile.close();<font></font>
    }<font></font>
    else {<font></font>
      Serial.println("error opening .txt");<font></font>
    }<font></font>
  }<font></font>
//////// <font></font>
  t = rtc.getTime();<font></font>
  tft.setTextColor(WHITE);<font></font>
////////  ,     <font></font>
  if ( time_sec_prev != t.sec) {<font></font>
    tft.setCursor (  120 , 0 );     //   <font></font>
    tft.fillRect ( 118 , 0 , 50 , 7 , GRAY); //    <font></font>
    tft.setTextSize(1);<font></font>
    tft.print(rtc.getTimeStr());    //   <font></font>
    time_sec_prev = t.sec;<font></font>
  }<font></font>
////////  ,    <font></font>
  if ( time_day_prev != t.date) {<font></font>
    tft.setCursor (  180 , 0 );     //   <font></font>
    tft.fillRect ( 178 , 0 , 65 , 7 , GRAY); //    <font></font>
    tft.setTextSize(1);<font></font>
    tft.print(rtc.getDateStr());    //   <font></font>
    time_day_prev = t.date;<font></font>
  }<font></font>
////////  , <font></font>
  if (radio.available(&amp;pipe)) {<font></font>
////////   ,<font></font>
    radio.read(&amp;data, sizeof(data));<font></font>
////////    , <font></font>
    if (pipe == 1) {<font></font>
////////     <font></font>
//  <font></font>
      if ( data == 0000 ) {<font></font>
        rc = 0;<font></font>
      } else {<font></font>
        rc ++;<font></font>
      }<font></font>
////////       10  100-  <font></font>
      if ( rc == 1 ) {<font></font>
        leb_1 = data / 3600.0;<font></font>
      }<font></font>
<font></font>
      if ( rc == 2 ) {<font></font>
        leb_2 = data / 3600.0;<font></font>
      }<font></font>
<font></font>
      if ( rc == 3 ) {<font></font>
        leb_3 = data / 3600.0;<font></font>
      }<font></font>
<font></font>
      if ( rc == 4 ) {<font></font>
        leb_4 = data / 3600.0;<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
  r ++;<font></font>
  k ++; //   <font></font>
  ////////      <font></font>
  if ( r &gt;= 6500) {<font></font>
    tft.setTextSize(2);<font></font>
    tft.fillRect ( 0 , 41 , 180 , 64 , GRAYD);<font></font>
    Serial.println ("Lebedki I");<font></font>
    tft.setCursor (0, 41);<font></font>
    tft.println (leb_1);<font></font>
    Serial.println (leb_1);<font></font>
    tft.println (leb_2);<font></font>
    Serial.println (leb_2);<font></font>
    tft.println (leb_3);<font></font>
    Serial.println (leb_3);<font></font>
    tft.println (leb_4);<font></font>
    Serial.println (leb_4);<font></font>
    Serial.println (k);<font></font>
    r = 0;<font></font>
  }<font></font>
////////     SD  10 .<font></font>
  if ((t.min % 10 == 0) &amp;&amp; ( t.sec == 0)) {<font></font>
    tft.setTextSize(1);<font></font>
    tft.setCursor(200, 10);<font></font>
    tft.setTextColor(BLACK);<font></font>
////////    .csv<font></font>
    String dataString = String (rtc.getDateStr()) + ", "+(rtc.getTimeStr()) + ", " + (leb_1) + ", " + (leb_2)<font></font>
                        + ", " + (leb_3) + ", " + (leb_4) + ", ";<font></font>
////////       <font></font>
    myFile = SD.open(perv, FILE_WRITE); //     "2.txt" - ,    .<font></font>
    if (myFile) {<font></font>
      myFile.println(dataString);<font></font>
      myFile.close();<font></font>
      tft.fillRect ( 198 , 8 , 42 , 10 , GREEN);<font></font>
      tft.println("SD OK");<font></font>
      Serial.println("SD OK");<font></font>
      delay (900); // ,   13  ,    <font></font>
    } else {<font></font>
      tft.fillRect ( 198 , 8 , 42 , 10 , RED);<font></font>
      tft.println("SD ERR");<font></font>
      Serial.println("SD ERR");<font></font>
    }<font></font>
  }<font></font>
}</code></pre></div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–‡å­—å¤‰æ›ãƒ—ãƒ­ã‚°ãƒ©ãƒ </font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">/* Recode russian fonts from UTF-8 to Windows-1251 */<font></font>
<font></font>
String utf8rus(String source)<font></font>
{<font></font>
  int i,k;<font></font>
  String target;<font></font>
  unsigned char n;<font></font>
  char m[2] = { '0', '\0' };<font></font>
<font></font>
  k = source.length(); i = 0;<font></font>
<font></font>
  while (i &lt; k) {<font></font>
    n = source[i]; i++;<font></font>
<font></font>
    if (n &gt;= 0xC0) {<font></font>
      switch (n) {<font></font>
        case 0xD0: {<font></font>
          n = source[i]; i++;<font></font>
          if (n == 0x81) { n = 0xA8; break; }<font></font>
          if (n &gt;= 0x90 &amp;&amp; n &lt;= 0xBF) n = n + 0x30;//0x2F<font></font>
          break;<font></font>
        }<font></font>
        case 0xD1: {<font></font>
          n = source[i]; i++;<font></font>
          if (n == 0x91) { n = 0xB8; break; }<font></font>
          if (n &gt;= 0x80 &amp;&amp; n &lt;= 0x8F) n = n + 0x70;//0x6F<font></font>
          break;<font></font>
        }<font></font>
      }<font></font>
    }<font></font>
    m[0] = n; target = target + String(m);<font></font>
  }<font></font>
return target;<font></font>
}</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adafruit_GFXãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚ˆã‚‹ã‚­ãƒªãƒ«æ–‡å­—å‡ºåŠ›ç”¨ã®æ–‡å­—å¤‰æ›ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ã€ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¨åŒã˜ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã«é…ç½®ã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã¾ãŸã€glcdfont.cãƒ•ã‚¡ã‚¤ãƒ«ã‚’Adafruit_GFXã®åˆ¥ã®ãƒ•ã‚©ãƒ³ãƒˆã«ç½®ãæ›ãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¿…è¦ãªç½®ãæ›ãˆ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ãŒè¡Œã‚ã‚ŒãŸ</font></a><font style="vertical-align: inherit;">ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ­ã‚·ã‚¢åŒ–ã«ã¤ã„ã¦ã®è©³ç´°ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã§ç°¡å˜ã«æ¤œç´¢ã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ã¨ã‚ã‚‹ã¨ã€æœŸå¾…é€šã‚Šã®ã‚·ã‚¹ãƒ†ãƒ ã«ãªã£ãŸã¨è¨€ã†ã“ã¨ã§ã€è¨­å‚™ã®ç¨¼åƒæ™‚é–“ã‚’ç›£è¦–ã—ã‚„ã™ããªã‚Šã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ã™ã¹ã¦ãŒãƒ–ãƒ¬ãƒƒãƒ‰ãƒœãƒ¼ãƒ‰ã§çµ„ã¿ç«‹ã¦ã‚‰ã‚Œã¦ã„ã¾ã™ãŒã€ç·Šæ€¥æ€§ã®å•é¡Œã¨ã—ã¦ã®ä½œæ¥­ã«ã¤ã„ã¦ã®è‹¦æƒ…ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€åˆã®è¦ç´ ã¯6ã‹æœˆä»¥ä¸Šä½¿ç”¨ã•ã‚Œã¦ãŠã‚Šã€å†¬ã§ã‚‚ç”Ÿãæ®‹ã‚Šã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">9ã¤ã®ç›£è¦–å¯¾è±¡ãƒ¦ãƒ‹ãƒƒãƒˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã®æœ€æ–°ã®è¨­è¨ˆ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯3æœˆ5æ—¥ã‹ã‚‰ç¨¼åƒã—ã¦ãŠã‚Šã€ã™ã§ã«æ­£å¼ã«ç¨¼åƒæ™‚é–“ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™ã€‚</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja451144/index.html">éª¨è‘£å“ï¼šãƒ†ãƒ¬ãƒ“åºƒå‘Šã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯</a></li>
<li><a href="../ja451146/index.html">Webpackã‚’ä½¿ç”¨ã—ãŸWebã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰ã®é«˜é€ŸåŒ–</a></li>
<li><a href="../ja451148/index.html">ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯è¨€èªã§ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°</a></li>
<li><a href="../ja451150/index.html">ã§ãã‚Œã°ã‚­ãƒ£ãƒƒãƒãƒ»ãƒŸãƒ¼ã€‚ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³</a></li>
<li><a href="../ja451152/index.html">ã‚²ãƒ¼ãƒˆå›è·¯ã®æŠµæŠ—å™¨ã¾ãŸã¯ãã‚Œã‚’æ­£ã—ãè¡Œã†æ–¹æ³•</a></li>
<li><a href="../ja451158/index.html">é›»æ°—å›è·¯ã€‚å›è·¯ã‚¿ã‚¤ãƒ—</a></li>
<li><a href="../ja451160/index.html">Apache Kafkaã¨Sparkã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã«ã‚ˆã‚‹ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°</a></li>
<li><a href="../ja451162/index.html">ã‚¨ãƒ©ãƒ¼ä¿®æ­£-ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®å›½éš›å˜ä½ç³»ï¼ˆSIï¼‰ã®ç‰©ç†å®šæ•°</a></li>
<li><a href="../ja451164/index.html">Pythonã§ç„¡æ–™ã®é§è»Šã‚¹ãƒšãƒ¼ã‚¹ã‚’æ¢ã™</a></li>
<li><a href="../ja451166/index.html">AIãŠã‚ˆã³MOã‚·ã‚¹ãƒ†ãƒ ç”¨ã®æ–°ã—ã„ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¯ä½•ã‚’æä¾›ã—ã¾ã™ã‹ï¼Ÿ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>