<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚋 🌗 ♾ Création de liaisons Python pour les bibliothèques C / C ++ à l'aide de SIP. Partie 2 🧗🏾 🚧 👩🏽‍🏭</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans la première partie de l' article, nous avons examiné les bases de l'utilisation de l'utilitaire SIP conçu pour créer des liaisons Python pour les...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Création de liaisons Python pour les bibliothèques C / C ++ à l'aide de SIP. Partie 2</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495636/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">première partie de l'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> article, nous avons examiné les bases de l'utilisation de l'utilitaire SIP conçu pour créer des liaisons Python pour les bibliothèques écrites en C et C ++. </font><font style="vertical-align: inherit;">Nous avons examiné les fichiers de base que vous devez créer pour travailler avec SIP et avons commencé à examiner les directives et les annotations. </font><font style="vertical-align: inherit;">Jusqu'à présent, nous avons fait la liaison pour une bibliothèque simple écrite en C. Dans cette partie, nous allons voir comment faire la liaison pour une bibliothèque C ++ qui contient des classes. </font><font style="vertical-align: inherit;">En utilisant l'exemple de cette bibliothèque, nous verrons quelles techniques peuvent être utiles lorsque vous travaillez avec une bibliothèque orientée objet, et en même temps nous traiterons de nouvelles directives et annotations pour nous.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tous les exemples de l'article sont disponibles dans le référentiel github à l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adresse</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">https://github.com/Jenyay/sip-examples</font></a><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Créer une liaison pour une bibliothèque en C ++</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'exemple suivant, que nous considérerons, se trouve dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_01</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Créez d'abord une bibliothèque pour laquelle nous ferons la liaison. </font><font style="vertical-align: inherit;">La bibliothèque résidera toujours dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et contiendra une classe - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Le fichier d'en-tête </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec la déclaration de cette classe est le suivant:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> FOO_LIB</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> FOO_LIB</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> {</span>
    <span class="hljs-keyword">private</span>:
        <span class="hljs-keyword">int</span> _int_val;
        <span class="hljs-keyword">char</span>* _string_val;
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span> int_val, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* string_val);
        <span class="hljs-keyword">virtual</span> ~Foo();<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span></span>;<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* val)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">char</span>* <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span></span>;<font></font>
};<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit d'une classe simple avec deux getters et setters qui définit et renvoie des valeurs de type </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">L'implémentation de la classe est la suivante:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"foo.h"</span></span><font></font>
<font></font>
Foo::Foo(<span class="hljs-keyword">int</span> int_val, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* string_val): _int_val(int_val) {<font></font>
    _string_val = <span class="hljs-literal">nullptr</span>;<font></font>
    set_string_val(string_val);<font></font>
}<font></font>
<font></font>
Foo::~Foo(){<font></font>
    <span class="hljs-keyword">delete</span>[] _string_val;<font></font>
    _string_val = <span class="hljs-literal">nullptr</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Foo::set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span> </span>{<font></font>
    _int_val = val;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">Foo::get_int_val</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> _int_val;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Foo::set_string_val</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* val)</span> </span>{
    <span class="hljs-keyword">if</span> (_string_val != <span class="hljs-literal">nullptr</span>) {
        <span class="hljs-keyword">delete</span>[] _string_val;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">auto</span> count = <span class="hljs-built_in">strlen</span>(val) + <span class="hljs-number">1</span>;<font></font>
    _string_val = <span class="hljs-keyword">new</span> <span class="hljs-keyword">char</span>[count];
    <span class="hljs-built_in">strcpy</span>(_string_val, val);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">char</span>* <span class="hljs-title">Foo::get_string_val</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> _string_val;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour tester les fonctionnalités de la bibliothèque, le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contient également le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> à l'aide de la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"foo.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">using</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span>;
<span class="hljs-keyword">using</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span> </span>{
    <span class="hljs-keyword">auto</span> foo = Foo(<span class="hljs-number">10</span>, <span class="hljs-string">"Hello"</span>);
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"int_val: "</span> &lt;&lt; foo.get_int_val() &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"string_val: "</span> &lt;&lt; foo.get_string_val() &lt;&lt; <span class="hljs-built_in">endl</span>;<font></font>
<font></font>
    foo.set_int_val(<span class="hljs-number">0</span>);<font></font>
    foo.set_string_val(<span class="hljs-string">"Hello world!"</span>);<font></font>
<font></font>
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"int_val: "</span> &lt;&lt; foo.get_int_val() &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"string_val: "</span> &lt;&lt; foo.get_string_val() &lt;&lt; <span class="hljs-built_in">endl</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour construire la bibliothèque </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">utilisez le </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Makefile</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> suivant </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">CC=g++<font></font>
CFLAGS=-c -fPIC<font></font>
DIR_OUT=bin<font></font>
<font></font>
all: main<font></font>
<font></font>
main: main.o libfoo.a<font></font>
    $(CC) $(DIR_OUT)/main.o -L$(DIR_OUT) -lfoo -o $(DIR_OUT)/main<font></font>
<font></font>
main.o: makedir main.cpp<font></font>
    $(CC) $(CFLAGS) main.cpp -o $(DIR_OUT)/main.o<font></font>
<font></font>
libfoo.a: makedir foo.cpp<font></font>
    $(CC) $(CFLAGS) foo.cpp -o $(DIR_OUT)/foo.o<font></font>
    ar rcs $(DIR_OUT)/libfoo.a $(DIR_OUT)/foo.o<font></font>
<font></font>
makedir:<font></font>
    mkdir -p $(DIR_OUT)<font></font>
<font></font>
clean:<font></font>
    rm -rf $(DIR_OUT)/*<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La différence avec le </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Makefile</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans les exemples précédents, en plus de changer le compilateur de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gcc</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">g ++</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , est qu'une autre option </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-fPIC a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> été ajoutée pour la compilation </font><font style="vertical-align: inherit;">, qui indique au compilateur de placer le code dans la bibliothèque d'une certaine manière (le soi-disant "code indépendant de la position"). Étant donné que cet article ne concerne pas les compilateurs, nous n'examinerons pas plus en détail ce que fait ce paramètre et pourquoi il est nécessaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Commençons à lier pour cette bibliothèque. Les fichiers </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sont </font><i><font style="vertical-align: inherit;">presque inchangés par</font></i><font style="vertical-align: inherit;"> rapport aux exemples précédents. Voici à quoi ressemble maintenant le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">[build-system]<font></font>
requires = ["sip &gt;=5, &lt;6"]<font></font>
build-backend = "sipbuild.api"<font></font>
<font></font>
[tool.sip.metadata]<font></font>
name = "pyfoocpp"<font></font>
version = "0.1"<font></font>
license = "MIT"<font></font>
<font></font>
[tool.sip.bindings.pyfoocpp]<font></font>
headers = ["foo.h"]<font></font>
libraries = ["foo"]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nos exemples écrits en C ++ seront empaquetés dans le paquet </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Python </font><font style="vertical-align: inherit;">, c'est peut-être le seul changement notable dans ce fichier. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reste le même que dans l'exemple </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_04</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> subprocess<font></font>
<font></font>
<span class="hljs-keyword">from</span> sipbuild <span class="hljs-keyword">import</span> Project<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FooProject</span>(<span class="hljs-params">Project</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_build_foo</span>(<span class="hljs-params">self</span>):</span>
        cwd = os.path.abspath(<span class="hljs-string">'foo'</span>)<font></font>
        subprocess.run([<span class="hljs-string">'make'</span>], cwd=cwd, capture_output=<span class="hljs-literal">True</span>, check=<span class="hljs-literal">True</span>)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build</span>(<span class="hljs-params">self</span>):</span><font></font>
        self._build_foo()<font></font>
        super().build()<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_sdist</span>(<span class="hljs-params">self, sdist_directory</span>):</span><font></font>
        self._build_foo()<font></font>
        <span class="hljs-keyword">return</span> super().build_sdist(sdist_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_wheel</span>(<span class="hljs-params">self, wheel_directory</span>):</span><font></font>
        self._build_foo()<font></font>
        <span class="hljs-keyword">return</span> super().build_wheel(wheel_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">install</span>(<span class="hljs-params">self</span>):</span><font></font>
        self._build_foo()<font></font>
        super().install()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et ici, </font><font style="vertical-align: inherit;">nous examinerons le </font><font style="vertical-align: inherit;">fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> plus en détail. Permettez-moi de vous rappeler que ce fichier décrit l'interface du futur module Python: ce qu'il devrait inclure, à quoi devrait ressembler l'interface de classe, etc. Le fichier .sip n'est pas nécessaire pour répéter le fichier d'en-tête de bibliothèque, bien qu'ils aient beaucoup en commun. Dans cette classe, de nouvelles méthodes peuvent être ajoutées qui n'étaient pas dans la classe d'origine. Ceux. l'interface décrite dans le fichier .sip peut adapter les classes de bibliothèque aux principes acceptés en Python, si nécessaire. Dans le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">nous verrons de nouvelles directives pour nous. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons d'abord ce que contient ce fichier:</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foocpp, language=<span class="hljs-string">"C++"</span>)<font></font>
%DefaultEncoding <span class="hljs-string">"UTF-8"</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> {</span><font></font>
    %TypeHeaderCode<font></font>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;foo.h&gt;</span></span><font></font>
    %End<font></font>
<font></font>
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*);<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span></span>;<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">char</span>* <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span></span>;<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les premières lignes doivent déjà être claires pour nous à partir des exemples précédents. Dans la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Module</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">nous indiquons le nom du module Python qui sera créé (c'est-à-dire, pour utiliser ce module, nous devrons utiliser les commandes </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">import foocpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">from foocpp import ....</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dans la même directive, nous indiquons que nous avons maintenant le langage - C ++. La </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">directive% DefaultEncoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> définit le codage qui sera utilisé pour convertir la chaîne Python en types </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const char</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, la déclaration d'interface de la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> suit </font><font style="vertical-align: inherit;">. Immédiatement après la déclaration de la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">il n'y a toujours pas utilisé la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% TypeHeaderCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui se termine par la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% End</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . La </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">directive% TypeHeaderCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> doit contenir du code qui déclare l'interface de la classe C ++ pour laquelle l'encapsuleur est créé. En règle générale, dans cette directive, il suffit d'inclure le fichier d'en-tête avec la déclaration de classe. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après cela, les méthodes de classe qui seront converties en méthodes de la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour le langage Python </font><font style="vertical-align: inherit;">sont répertoriées </font><font style="vertical-align: inherit;">. Il est important de noter qu'à ce stade, nous déclarons uniquement les méthodes publiques qui seront accessibles à partir de la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en Python (car il n'y a pas de membres privés et protégés en Python). Puisque nous avons utilisé la directive </font><i><font style="vertical-align: inherit;">% DefaultEncoding</font></i><font style="vertical-align: inherit;"> au tout début</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, puis dans les méthodes qui prennent des arguments de type </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , vous ne pouvez pas utiliser l'annotation </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour spécifier l'encodage pour convertir ces paramètres en chaînes Python et vice versa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il nous suffit maintenant de compiler le paquet </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Python </font><font style="vertical-align: inherit;">et de le tester. </font><font style="vertical-align: inherit;">Mais avant d'assembler un package de roue à part entière, utilisons la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commande sip-build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et voyons quels fichiers source SIP créera pour une compilation ultérieure, et essayons de trouver en eux quelque chose de similaire à la classe qui sera créée en code Python. </font><font style="vertical-align: inherit;">Pour ce faire, la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commande sip-build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ci </font><i><font style="vertical-align: inherit;">-</font></i><font style="vertical-align: inherit;"> dessus </font><font style="vertical-align: inherit;">doit être appelée dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_01</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Par conséquent, le dossier de </font><i><font style="vertical-align: inherit;">génération</font></i><font style="vertical-align: inherit;"> sera créé.</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec le contenu suivant:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">construire</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
└── foocpp</font></font><font></font>
    ├── apiversions.c<font></font>
    ├── array.c<font></font>
    ├── array.h<font></font>
    ├── bool.cpp<font></font>
    ├── build<font></font>
    │&nbsp;&nbsp; └── temp.linux-x86_64-3.8<font></font>
    │&nbsp;&nbsp;     ├── apiversions.o<font></font>
    │&nbsp;&nbsp;     ├── array.o<font></font>
    │&nbsp;&nbsp;     ├── bool.o<font></font>
    │&nbsp;&nbsp;     ├── descriptors.o<font></font>
    │&nbsp;&nbsp;     ├── int_convertors.o<font></font>
    │&nbsp;&nbsp;     ├── objmap.o<font></font>
    │&nbsp;&nbsp;     ├── qtlib.o<font></font>
    │&nbsp;&nbsp;     ├── sipfoocppcmodule.o<font></font>
    │&nbsp;&nbsp;     ├── sipfoocppFoo.o<font></font>
    │&nbsp;&nbsp;     ├── siplib.o<font></font>
    │&nbsp;&nbsp;     ├── threads.o<font></font>
    │&nbsp;&nbsp;     └── voidptr.o<font></font>
    ├── descriptors.c<font></font>
    ├── foocpp.cpython-38-x86_64-linux-gnu.so<font></font>
    ├── int_convertors.c<font></font>
    ├── objmap.c<font></font>
    ├── qtlib.c<font></font>
    ├── sipAPIfoocpp.h<font></font>
    ├── sipfoocppcmodule.cpp<font></font>
    ├── sipfoocppFoo.cpp<font></font>
    ├── sip.h<font></font>
    ├── sipint.h<font></font>
    ├── siplib.c<font></font>
    ├── threads.c<font></font>
    └── voidptr.c<font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En tant que tâche supplémentaire, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">examinez</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> attentivement le fichier </font><i><font style="vertical-align: inherit;">sipfoocppFoo.cpp</font></i><font style="vertical-align: inherit;"> (nous ne </font><font style="vertical-align: inherit;">l' </font><i><font style="vertical-align: inherit;">expliquerons</font></i><font style="vertical-align: inherit;"> pas en détail dans cet article):</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/*
 * Interface wrapper code.
 *
 * Generated by SIP 5.1.1
 */</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"sipAPIfoocpp.h"</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">line</span> 6 <span class="hljs-meta-string">"/home/jenyay/temp/2/pyfoocpp.sip"</span></span>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;foo.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">line</span> 12 <span class="hljs-meta-string">"/home/jenyay/temp/2/build/foocpp/sipfoocppFoo.cpp"</span></span><font></font>
<font></font>
PyDoc_STRVAR(doc_Foo_set_int_val, <span class="hljs-string">"set_int_val(self, int)"</span>);<font></font>
<font></font>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_set_int_val</span><span class="hljs-params">(PyObject *, PyObject *)</span></span>;}
<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_set_int_val</span><span class="hljs-params">(PyObject *sipSelf, PyObject *sipArgs)</span>
</span>{<font></font>
    PyObject *sipParseErr = SIP_NULLPTR;<font></font>
<font></font>
    {<font></font>
        <span class="hljs-keyword">int</span> a0;<font></font>
         ::Foo *sipCpp;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (sipParseArgs(&amp;sipParseErr, sipArgs, <span class="hljs-string">"Bi"</span>, &amp;sipSelf, sipType_Foo, &amp;sipCpp, &amp;a0))<font></font>
        {<font></font>
            sipCpp-&gt;set_int_val(a0);<font></font>
<font></font>
            Py_INCREF(Py_None);<font></font>
            <span class="hljs-keyword">return</span> Py_None;<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/* Raise an exception if the arguments couldn't be parsed. */</span><font></font>
    sipNoMethod(sipParseErr, sipName_Foo, sipName_set_int_val, doc_Foo_set_int_val);<font></font>
<font></font>
    <span class="hljs-keyword">return</span> SIP_NULLPTR;<font></font>
}<font></font>
<font></font>
PyDoc_STRVAR(doc_Foo_get_int_val, <span class="hljs-string">"get_int_val(self) -&gt; int"</span>);<font></font>
<font></font>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_get_int_val</span><span class="hljs-params">(PyObject *, PyObject *)</span></span>;}
<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_get_int_val</span><span class="hljs-params">(PyObject *sipSelf, PyObject *sipArgs)</span>
</span>{<font></font>
    PyObject *sipParseErr = SIP_NULLPTR;<font></font>
<font></font>
    {<font></font>
         ::Foo *sipCpp;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (sipParseArgs(&amp;sipParseErr, sipArgs, <span class="hljs-string">"B"</span>, &amp;sipSelf, sipType_Foo, &amp;sipCpp))<font></font>
        {<font></font>
            <span class="hljs-keyword">int</span> sipRes;<font></font>
<font></font>
            sipRes = sipCpp-&gt;get_int_val();<font></font>
<font></font>
            <span class="hljs-keyword">return</span> PyLong_FromLong(sipRes);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/* Raise an exception if the arguments couldn't be parsed. */</span><font></font>
    sipNoMethod(sipParseErr, sipName_Foo, sipName_get_int_val, doc_Foo_get_int_val);<font></font>
<font></font>
    <span class="hljs-keyword">return</span> SIP_NULLPTR;<font></font>
}<font></font>
<font></font>
PyDoc_STRVAR(doc_Foo_set_string_val, <span class="hljs-string">"set_string_val(self, str)"</span>);<font></font>
<font></font>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_set_string_val</span><span class="hljs-params">(PyObject *, PyObject *)</span></span>;}
<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_set_string_val</span><span class="hljs-params">(PyObject *sipSelf, PyObject *sipArgs)</span>
</span>{<font></font>
    PyObject *sipParseErr = SIP_NULLPTR;<font></font>
<font></font>
    {<font></font>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* a0;<font></font>
        PyObject *a0Keep;<font></font>
         ::Foo *sipCpp;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (sipParseArgs(&amp;sipParseErr, sipArgs, <span class="hljs-string">"BA8"</span>, &amp;sipSelf, sipType_Foo, &amp;sipCpp, &amp;a0Keep, &amp;a0))<font></font>
        {<font></font>
            sipCpp-&gt;set_string_val(a0);<font></font>
            Py_DECREF(a0Keep);<font></font>
<font></font>
            Py_INCREF(Py_None);<font></font>
            <span class="hljs-keyword">return</span> Py_None;<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/* Raise an exception if the arguments couldn't be parsed. */</span><font></font>
    sipNoMethod(sipParseErr, sipName_Foo, sipName_set_string_val, doc_Foo_set_string_val);<font></font>
<font></font>
    <span class="hljs-keyword">return</span> SIP_NULLPTR;<font></font>
}<font></font>
<font></font>
PyDoc_STRVAR(doc_Foo_get_string_val, <span class="hljs-string">"get_string_val(self) -&gt; str"</span>);<font></font>
<font></font>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_get_string_val</span><span class="hljs-params">(PyObject *, PyObject *)</span></span>;}
<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_get_string_val</span><span class="hljs-params">(PyObject *sipSelf, PyObject *sipArgs)</span>
</span>{<font></font>
    PyObject *sipParseErr = SIP_NULLPTR;<font></font>
<font></font>
    {<font></font>
         ::Foo *sipCpp;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (sipParseArgs(&amp;sipParseErr, sipArgs, <span class="hljs-string">"B"</span>, &amp;sipSelf, sipType_Foo, &amp;sipCpp))<font></font>
        {<font></font>
            <span class="hljs-keyword">char</span>*sipRes;<font></font>
<font></font>
            sipRes = sipCpp-&gt;get_string_val();<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (sipRes == SIP_NULLPTR)<font></font>
            {<font></font>
                Py_INCREF(Py_None);<font></font>
                <span class="hljs-keyword">return</span> Py_None;<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">return</span> PyUnicode_FromString(sipRes);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/* Raise an exception if the arguments couldn't be parsed. */</span><font></font>
    sipNoMethod(sipParseErr, sipName_Foo, sipName_get_string_val, doc_Foo_get_string_val);<font></font>
<font></font>
    <span class="hljs-keyword">return</span> SIP_NULLPTR;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Call the instance's destructor. */</span>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">release_Foo</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *, <span class="hljs-keyword">int</span>)</span></span>;}
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">release_Foo</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *sipCppV, <span class="hljs-keyword">int</span>)</span>
</span>{
    <span class="hljs-keyword">delete</span> <span class="hljs-keyword">reinterpret_cast</span>&lt; ::Foo *&gt;(sipCppV);<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dealloc_Foo</span><span class="hljs-params">(sipSimpleWrapper *)</span></span>;}
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dealloc_Foo</span><span class="hljs-params">(sipSimpleWrapper *sipSelf)</span>
</span>{
    <span class="hljs-keyword">if</span> (sipIsOwnedByPython(sipSelf))<font></font>
    {<font></font>
        release_Foo(sipGetAddress(sipSelf), <span class="hljs-number">0</span>);<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> *<span class="hljs-title">init_type_Foo</span><span class="hljs-params">(sipSimpleWrapper *, PyObject *, 
                 PyObject *, PyObject **, PyObject **, PyObject **)</span></span>;}
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> *<span class="hljs-title">init_type_Foo</span><span class="hljs-params">(sipSimpleWrapper *, PyObject *sipArgs, PyObject *sipKwds,
                                   PyObject **sipUnused, PyObject **, PyObject **sipParseErr)</span>
</span>{<font></font>
     ::Foo *sipCpp = SIP_NULLPTR;<font></font>
<font></font>
    {<font></font>
        <span class="hljs-keyword">int</span> a0;
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* a1;<font></font>
        PyObject *a1Keep;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (sipParseKwdArgs(sipParseErr, sipArgs, sipKwds, SIP_NULLPTR, sipUnused, <span class="hljs-string">"iA8"</span>, &amp;a0, &amp;a1Keep, &amp;a1))<font></font>
        {<font></font>
            sipCpp = <span class="hljs-keyword">new</span>  ::Foo(a0,a1);<font></font>
            Py_DECREF(a1Keep);<font></font>
<font></font>
            <span class="hljs-keyword">return</span> sipCpp;<font></font>
        }<font></font>
    }<font></font>
<font></font>
    {<font></font>
        <span class="hljs-keyword">const</span>  ::Foo* a0;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (sipParseKwdArgs(sipParseErr, sipArgs, sipKwds, SIP_NULLPTR, sipUnused, <span class="hljs-string">"J9"</span>, sipType_Foo, &amp;a0))<font></font>
        {<font></font>
            sipCpp = <span class="hljs-keyword">new</span>  ::Foo(*a0);<font></font>
<font></font>
            <span class="hljs-keyword">return</span> sipCpp;<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">return</span> SIP_NULLPTR;<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">static</span> PyMethodDef methods_Foo[] = {<font></font>
    {sipName_get_int_val, meth_Foo_get_int_val, METH_VARARGS, doc_Foo_get_int_val},<font></font>
    {sipName_get_string_val, meth_Foo_get_string_val, METH_VARARGS, doc_Foo_get_string_val},<font></font>
    {sipName_set_int_val, meth_Foo_set_int_val, METH_VARARGS, doc_Foo_set_int_val},<font></font>
    {sipName_set_string_val, meth_Foo_set_string_val, METH_VARARGS, doc_Foo_set_string_val}<font></font>
};<font></font>
<font></font>
PyDoc_STRVAR(doc_Foo, <span class="hljs-string">"\1Foo(int, str)\n"</span>
<span class="hljs-string">"Foo(Foo)"</span>);<font></font>
<font></font>
sipClassTypeDef sipTypeDef_foocpp_Foo = {<font></font>
    {<font></font>
        <span class="hljs-number">-1</span>,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_TYPE_CLASS,<font></font>
        sipNameNr_Foo,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_NULLPTR<font></font>
    },<font></font>
    {<font></font>
        sipNameNr_Foo,<font></font>
        {<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>},
        <span class="hljs-number">4</span>, methods_Foo,
        <span class="hljs-number">0</span>, SIP_NULLPTR,
        <span class="hljs-number">0</span>, SIP_NULLPTR,<font></font>
        {SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR,<font></font>
         SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR},<font></font>
    },<font></font>
    doc_Foo,<font></font>
    <span class="hljs-number">-1</span>,
    <span class="hljs-number">-1</span>,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    init_type_Foo,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    dealloc_Foo,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    release_Foo,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, construisez le package à l'aide de la commande </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Après avoir exécuté cette commande, si tout se passe bien, un </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fichier pyfoocpp-0.1-cp38-cp38-manylinux1_x86_64.whl</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou avec un nom similaire </font><font style="vertical-align: inherit;">sera créé </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Installez-le à l'aide de la commande </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pip install --user pyfoocpp-0.1-cp38-cp38-manylinux1_x86_64.whl</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et exécutez l'interpréteur Python pour vérifier:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foocpp <span class="hljs-keyword">import</span> Foo
<span class="hljs-meta">&gt;&gt;&gt; </span>x = Foo(<span class="hljs-number">10</span>, <span class="hljs-string">'Hello'</span>)<font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.get_int_val()
<span class="hljs-number">10</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.get_string_val()
<span class="hljs-string">'Hello'</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.set_int_val(<span class="hljs-number">50</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>x.set_string_val(<span class="hljs-string">''</span>)<font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.get_int_val()
<span class="hljs-number">50</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.get_string_val()
<span class="hljs-string">''</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Travaux! </font><font style="vertical-align: inherit;">Ainsi, nous venons de créer un module Python avec une liaison pour une classe en C ++. </font><font style="vertical-align: inherit;">De plus, nous apporterons de la beauté à cette classe et ajouterons divers équipements.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajouter des propriétés</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les classes créées à l'aide de SIP ne sont pas nécessaires pour répéter exactement l'interface de classe C ++. Par exemple, dans notre classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">il y a deux getters et deux setters, qui peuvent clairement être combinés en une propriété pour rendre la classe plus «Python». L'ajout de propriétés à l'aide de sip est assez facile au fur et à mesure, comme le montre un exemple dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_02</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cet exemple est similaire au précédent, la principale différence réside dans le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui ressemble maintenant à ceci:</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foocpp, language=<span class="hljs-string">"C++"</span>)<font></font>
%DefaultEncoding <span class="hljs-string">"UTF-8"</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> {</span><font></font>
    %TypeHeaderCode<font></font>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;foo.h&gt;</span></span><font></font>
    %End<font></font>
<font></font>
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*);<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Property(name=int_val, get=get_int_val, <span class="hljs-built_in">set</span>=set_int_val)<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">char</span>* <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Property(name=string_val, get=get_string_val, <span class="hljs-built_in">set</span>=set_string_val)<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, tout est assez simple. Pour ajouter une propriété, la directive </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Property</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est prévue </font><font style="vertical-align: inherit;">, qui a deux paramètres requis: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nom</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour spécifier le nom de la propriété, et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">obtenir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour spécifier une méthode qui renvoie une valeur (getter). Il peut ne pas y avoir de setter, mais si la propriété doit également être affectée de valeurs, la méthode setter est spécifiée comme valeur du paramètre </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">set</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dans notre exemple, les propriétés sont créées de manière assez simple, car il existe déjà des fonctions qui fonctionnent comme des getters et des setters. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous pouvons uniquement collecter le package à l'aide de la commande </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , l'installer, après quoi nous vérifierons le fonctionnement des propriétés dans le mode de commande de l'interpréteur python:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foocpp <span class="hljs-keyword">import</span> Foo
<span class="hljs-meta">&gt;&gt;&gt; </span>x = Foo(<span class="hljs-number">10</span>, <span class="hljs-string">"Hello"</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>x.int_val
<span class="hljs-number">10</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.string_val
<span class="hljs-string">'Hello'</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.int_val = <span class="hljs-number">50</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.string_val = <span class="hljs-string">''</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.get_int_val()
<span class="hljs-number">50</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.get_string_val()
<span class="hljs-string">''</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir dans l'exemple d'utilisation de la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , les </font><i><font style="vertical-align: inherit;">propriétés </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int_val</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">string_val</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fonctionnent à la fois pour la lecture et l'écriture.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajouter des lignes de documentation</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous continuerons d'améliorer notre classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">L'exemple suivant, situé dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_03,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> montre comment ajouter des lignes de documentation (docstring) à divers éléments d'une classe. </font><font style="vertical-align: inherit;">Cet exemple est basé sur le précédent et le principal changement concerne le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Voici son contenu:</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foocpp, language=<span class="hljs-string">"C++"</span>)<font></font>
%DefaultEncoding <span class="hljs-string">"UTF-8"</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> {</span><font></font>
%Docstring<font></font>
Class example from C++ library<font></font>
%End<font></font>
<font></font>
    %TypeHeaderCode<font></font>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;foo.h&gt;</span></span><font></font>
    %End<font></font>
<font></font>
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*);<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span></span>;<font></font>
        %Docstring(format=<span class="hljs-string">"deindented"</span>, signature=<span class="hljs-string">"prepended"</span>)<font></font>
            Set integer value<font></font>
        %<span class="hljs-function">End

        <span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Docstring(format=<span class="hljs-string">"deindented"</span>, signature=<span class="hljs-string">"prepended"</span>)<font></font>
            Return integer value<font></font>
        %End<font></font>
<font></font>
        %Property(name=int_val, get=get_int_val, <span class="hljs-built_in">set</span>=set_int_val)<font></font>
        {<font></font>
            %Docstring <span class="hljs-string">"deindented"</span>
                The property <span class="hljs-keyword">for</span> integer value<font></font>
            %End<font></font>
        };<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*)</span></span>;<font></font>
        %Docstring(format=<span class="hljs-string">"deindented"</span>, signature=<span class="hljs-string">"appended"</span>)<font></font>
            Set <span class="hljs-built_in">string</span> value<font></font>
        %<span class="hljs-function">End

        <span class="hljs-keyword">char</span>* <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Docstring(format=<span class="hljs-string">"deindented"</span>, signature=<span class="hljs-string">"appended"</span>)<font></font>
            Return <span class="hljs-built_in">string</span> value<font></font>
        %End<font></font>
<font></font>
        %Property(name=string_val, get=get_string_val, <span class="hljs-built_in">set</span>=set_string_val)<font></font>
        {<font></font>
            %Docstring <span class="hljs-string">"deindented"</span>
                The property <span class="hljs-keyword">for</span> <span class="hljs-built_in">string</span> value<font></font>
            %End<font></font>
        };<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous l'avez déjà compris, pour ajouter des lignes de documentation à n'importe quel élément de la classe, vous devez utiliser la directive </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Docstring</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Cet exemple montre plusieurs façons d'utiliser cette directive. Pour une meilleure compréhension de cet exemple, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">compilons</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> immédiatement le paquet </font><i><font style="vertical-align: inherit;">pyfoocpp</font></i><font style="vertical-align: inherit;"> à l'aide de la commande </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , installez-le, et nous déterminerons séquentiellement quel paramètre de cette directive affecte quoi, compte tenu des lignes de documentation résultantes en mode de commande Python. Permettez-moi de vous rappeler que les lignes de documentation sont stockées en tant que membres des </font><font style="vertical-align: inherit;">objets </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__doc__</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auxquels ces lignes appartiennent. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La première ligne de documentation concerne la classe </font><i><font style="vertical-align: inherit;">Foo</font></i><font style="vertical-align: inherit;"> .</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Comme vous pouvez le voir, toutes les lignes de documentation sont situées entre les </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">directives% Docstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% End</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Les lignes 5-7 de cet exemple n'utilisent aucun paramètre supplémentaire de la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Docstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , la ligne de documentation sera donc écrite dans la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> telle </font><font style="vertical-align: inherit;">quelle </font><font style="vertical-align: inherit;">. C'est pourquoi il n'y a pas de retrait dans les lignes 5-7, sinon le retrait avant la ligne de documentation tomberait également dans Foo .__ doc__. Nous nous assurerons que la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contient vraiment la ligne de documentation que nous avons introduite:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foocpp <span class="hljs-keyword">import</span> Foo
<span class="hljs-meta">&gt;&gt;&gt; </span>Foo.__doc__
<span class="hljs-string">'Class example from C++ library'</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Docstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> suivante </font><font style="vertical-align: inherit;">, située sur les lignes 17-19, utilise deux paramètres à la fois. Le paramètre de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> peut prendre l'une des deux valeurs: «brut» ou «désindenté». Dans le premier cas, les lignes de documentation sont enregistrées au fur et à mesure qu'elles sont écrites et dans le second cas, les caractères d'espacement initiaux (mais pas les tabulations) sont supprimés. La valeur par défaut du cas si le paramètre de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n'est </font><font style="vertical-align: inherit;">pas spécifié peut être définie à l'aide de la directive </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultDocstringFormat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (nous la considérerons un peu plus tard), et si elle n'est pas spécifiée, alors on suppose que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format = "raw"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus des lignes de documentation spécifiées, SIP ajoute une description de sa signature (quels types de variables sont attendus à l'entrée et quel type la fonction renvoie) aux lignes de documentation des fonctions. Le paramètre de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">signature</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indique où placer une telle signature: avant la ligne de documentation spécifiée ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">signature = "pré-ajoutée"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), après celle-ci ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">signature = "ajoutée"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) ou ne pas ajouter la signature ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">signature = "supprimée"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre exemple définit le paramètre </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">signature = "prepended"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour les fonctions </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_int_val</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">set_int_val</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ainsi que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">signature = " </font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">appended </font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">"</font></i><font style="vertical-align: inherit;"> pour les fonctions </font><i><font style="vertical-align: inherit;">get_string_val</font></i><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">set_string_val</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Le paramètre </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format = "deindented"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a également été ajouté </font><font style="vertical-align: inherit;">pour supprimer les espaces au début de la ligne de documentation. Vérifions le fonctionnement de ces paramètres en Python:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span>Foo.get_int_val.__doc__
<span class="hljs-string">'get_int_val(self) -&gt; int\nReturn integer value'</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>Foo.set_int_val.__doc__
<span class="hljs-string">'set_int_val(self, int)\nSet integer value'</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>Foo.get_string_val.__doc__
<span class="hljs-string">'Return string value\nget_string_val(self) -&gt; str'</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>Foo.set_string_val.__doc__
<span class="hljs-string">'Set string value\nset_string_val(self, str)'</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, en utilisant le paramètre </font><font style="vertical-align: inherit;">de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">signature</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Docstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">vous pouvez modifier la position de la description de la signature de fonction dans la ligne de documentation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pensez maintenant à ajouter une ligne de documentation aux propriétés. Notez que dans ce cas, les </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">directives% Docstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ... </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% End</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sont </font><i><font style="vertical-align: inherit;">placées</font></i><font style="vertical-align: inherit;"> entre accolades après la directive% Property. Ce format d'enregistrement est décrit dans la documentation de la directive </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Property</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notez également comment nous </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spécifions le</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> paramètre de directive </font><i><font style="vertical-align: inherit;">% Docstring</font></i><font style="vertical-align: inherit;"> . Un tel format pour écrire des directives est possible si nous ne définissons que le premier paramètre de la directive (dans ce cas, le paramètre </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">Ainsi, dans cet exemple, trois méthodes d'utilisation des directives sont utilisées à la fois. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assurez-vous que la ligne de documentation des propriétés est définie:</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt;&gt;&gt; Foo.int_val.__doc__<font></font>
'The property for integer value'<font></font>
<font></font>
&gt;&gt;&gt; Foo.string_val.__doc__<font></font>
'The property for string value'<font></font>
<font></font>
&gt;&gt;&gt; help(Foo)<font></font>
Help on class Foo in module foocpp:<font></font>
<font></font>
class Foo(sip.wrapper)<font></font>
 |  Class example from C++ library<font></font>
 |  <font></font>
 |  Method resolution order:<font></font>
 |      Foo<font></font>
 |      sip.wrapper<font></font>
 |      sip.simplewrapper<font></font>
 |      builtins.object<font></font>
 |  <font></font>
 |  Methods defined here:<font></font>
 |  <font></font>
 |  get_int_val(...)<font></font>
 |      get_int_val(self) -&gt; int<font></font>
 |      Return integer value<font></font>
 |  <font></font>
 |  get_string_val(...)<font></font>
 |      Return string value<font></font>
 |      get_string_val(self) -&gt; str<font></font>
 |  <font></font>
 |  set_int_val(...)<font></font>
 |      set_int_val(self, int)<font></font>
 |      Set integer value<font></font>
 |  <font></font>
 |  set_string_val(...)<font></font>
 |      Set string value<font></font>
 |      set_string_val(self, str)<font></font>
...<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Simplifions cet exemple en définissant les valeurs par défaut des paramètres de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">signature</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> à l'aide des </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">directives </font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultDocstringFormat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultDocstringSignature</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">L'utilisation de ces directives est illustrée dans l'exemple du dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_04</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans cet exemple contient le code suivant:</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foocpp, language=<span class="hljs-string">"C++"</span>)<font></font>
%DefaultEncoding <span class="hljs-string">"UTF-8"</span>
%DefaultDocstringFormat <span class="hljs-string">"deindented"</span>
%DefaultDocstringSignature <span class="hljs-string">"prepended"</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> {</span><font></font>
    %Docstring<font></font>
    Class example from C++ library<font></font>
    %End<font></font>
<font></font>
    %TypeHeaderCode<font></font>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;foo.h&gt;</span></span><font></font>
    %End<font></font>
<font></font>
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*);<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span></span>;<font></font>
        %Docstring<font></font>
            Set integer value<font></font>
        %<span class="hljs-function">End

        <span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Docstring<font></font>
            Return integer value<font></font>
        %End<font></font>
<font></font>
        %Property(name=int_val, get=get_int_val, <span class="hljs-built_in">set</span>=set_int_val)<font></font>
        {<font></font>
            %Docstring<font></font>
                The property <span class="hljs-keyword">for</span> integer value<font></font>
            %End<font></font>
        };<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*)</span></span>;<font></font>
        %Docstring<font></font>
            Set <span class="hljs-built_in">string</span> value<font></font>
        %<span class="hljs-function">End

        <span class="hljs-keyword">char</span>* <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Docstring<font></font>
            Return <span class="hljs-built_in">string</span> value<font></font>
        %End<font></font>
<font></font>
        %Property(name=string_val, get=get_string_val, <span class="hljs-built_in">set</span>=set_string_val)<font></font>
        {<font></font>
            %Docstring<font></font>
                The property <span class="hljs-keyword">for</span> <span class="hljs-built_in">string</span> value<font></font>
            %End<font></font>
        };<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au début du fichier, les lignes </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultDocstringFormat "deindented"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultDocstringSignature "prepended" ont été ajoutées</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , puis tous les paramètres de la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Docstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ont été supprimés. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir assemblé et installé cet exemple, nous pouvons voir à quoi ressemble la description de la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que la commande </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">help (Foo)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> affiche </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt;&gt;&gt; from foocpp import Foo<font></font>
&gt;&gt;&gt; help(Foo)<font></font>
<font></font>
class Foo(sip.wrapper)<font></font>
 |  Class example from C++ library<font></font>
 |  <font></font>
 |  Method resolution order:<font></font>
 |      Foo<font></font>
 |      sip.wrapper<font></font>
 |      sip.simplewrapper<font></font>
 |      builtins.object<font></font>
 |  <font></font>
 |  Methods defined here:<font></font>
 |  <font></font>
 |  get_int_val(...)<font></font>
 |      get_int_val(self) -&gt; int<font></font>
 |      Return integer value<font></font>
 |  <font></font>
 |  get_string_val(...)<font></font>
 |      get_string_val(self) -&gt; str<font></font>
 |      Return string value<font></font>
 |  <font></font>
 |  set_int_val(...)<font></font>
 |      set_int_val(self, int)<font></font>
 |      Set integer value<font></font>
 |  <font></font>
 |  set_string_val(...)<font></font>
 |      set_string_val(self, str)<font></font>
 |      Set string value<font></font>
...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout a l'air assez soigné et du même type.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Renommer des classes et des méthodes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme nous l'avons déjà dit, l'interface fournie par les liaisons Python ne doit pas nécessairement correspondre à l'interface fournie par la bibliothèque C / C ++. Nous avons ajouté des propriétés aux classes ci-dessus, et nous allons maintenant examiner une autre technique qui peut être utile si des conflits de noms de classe ou de fonctions surviennent, par exemple, si un nom de fonction correspond à un mot-clé Python. Pour ce faire, vous pouvez renommer des classes, des fonctions, des exceptions et d'autres entités. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour renommer une entité, l'annotation </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est </font><i><font style="vertical-align: inherit;">utilisée</font></i><font style="vertical-align: inherit;"> , dont la valeur doit être affectée à un nouveau nom d'entité. Le travail avec l'annotation </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyName est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> illustré dans l'exemple du dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_05</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Cet exemple est basé sur l'exemple précédent.</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_04</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et en diffère par le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dont le contenu ressemble maintenant à ceci:</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foocpp, language=<span class="hljs-string">"C++"</span>)<font></font>
%DefaultEncoding <span class="hljs-string">"UTF-8"</span>
%DefaultDocstringFormat <span class="hljs-string">"deindented"</span>
%DefaultDocstringSignature <span class="hljs-string">"prepended"</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> /<span class="hljs-title">PyName</span>=<span class="hljs-title">Bar</span>/ {</span><font></font>
    %Docstring<font></font>
    Class example from C++ library<font></font>
    %End<font></font>
<font></font>
    %TypeHeaderCode<font></font>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;foo.h&gt;</span></span><font></font>
    %End<font></font>
<font></font>
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*);<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span> /PyName</span>=set_integer_value/;<font></font>
        %Docstring<font></font>
            Set integer value<font></font>
        %<span class="hljs-function">End

        <span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span> /PyName</span>=get_integer_value/;<font></font>
        %Docstring<font></font>
            Return integer value<font></font>
        %End<font></font>
<font></font>
        %Property(name=int_val, get=get_integer_value, <span class="hljs-built_in">set</span>=set_integer_value)<font></font>
        {<font></font>
            %Docstring<font></font>
                The property <span class="hljs-keyword">for</span> integer value<font></font>
            %End<font></font>
        };<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*)</span> /PyName</span>=set_string_value/;<font></font>
        %Docstring<font></font>
            Set <span class="hljs-built_in">string</span> value<font></font>
        %<span class="hljs-function">End

        <span class="hljs-keyword">char</span>* <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span> /PyName</span>=get_string_value/;<font></font>
        %Docstring<font></font>
            Return <span class="hljs-built_in">string</span> value<font></font>
        %End<font></font>
<font></font>
        %Property(name=string_val, get=get_string_value, <span class="hljs-built_in">set</span>=set_string_value)<font></font>
        {<font></font>
            %Docstring<font></font>
                The property <span class="hljs-keyword">for</span> <span class="hljs-built_in">string</span> value<font></font>
            %End<font></font>
        };<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet exemple, nous avons renommé la </font><font style="vertical-align: inherit;">classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo en</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font><font style="vertical-align: inherit;">avons </font><font style="vertical-align: inherit;">également attribué d'autres noms à toutes les méthodes à l'aide de l'annotation </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Je pense que tout ici est assez simple et clair, la seule chose à laquelle il faut prêter attention est la création de propriétés. </font><font style="vertical-align: inherit;">Dans la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Property</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">les paramètres </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">set</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> doivent spécifier les noms des méthodes, car ils seront appelés dans la classe Python, et non les noms qu'ils ont été initialement appelés en code C ++. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compilez l'exemple, installez-le et voyez à quoi ressemblera cette classe en Python:</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt;&gt;&gt; from foocpp import Bar<font></font>
&gt;&gt;&gt; help(Bar)<font></font>
<font></font>
Help on class Bar in module foocpp:<font></font>
<font></font>
class Bar(sip.wrapper)<font></font>
 |  Class example from C++ library<font></font>
 |  <font></font>
 |  Method resolution order:<font></font>
 |      Bar<font></font>
 |      sip.wrapper<font></font>
 |      sip.simplewrapper<font></font>
 |      builtins.object<font></font>
 |  <font></font>
 |  Methods defined here:<font></font>
 |  <font></font>
 |  get_integer_value(...)<font></font>
 |      get_integer_value(self) -&gt; int<font></font>
 |      Return integer value<font></font>
 |  <font></font>
 |  get_string_value(...)<font></font>
 |      get_string_value(self) -&gt; str<font></font>
 |      Return string value<font></font>
 |  <font></font>
 |  set_integer_value(...)<font></font>
 |      set_integer_value(self, int)<font></font>
 |      Set integer value<font></font>
 |  <font></font>
 |  set_string_value(...)<font></font>
 |      set_string_value(self, str)<font></font>
 |      Set string value<font></font>
 |  <font></font>
 |  ----------------------------------------------------------------------<font></font>
 |  Data descriptors defined here:<font></font>
 |  <font></font>
 |  __weakref__<font></font>
 |      list of weak references to the object (if defined)<font></font>
 |  <font></font>
 |  int_val<font></font>
 |      The property for integer value<font></font>
 |  <font></font>
 |  string_val<font></font>
 |      The property for string value<font></font>
 |  <font></font>
 |  ----------------------------------------------------------------------<font></font>
...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ça a marché! </font><font style="vertical-align: inherit;">Nous avons réussi à renommer la classe elle-même et ses méthodes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parfois, les bibliothèques utilisent l'accord que les noms de toutes les classes commencent par un préfixe, par exemple, avec la lettre «Q» dans Qt ou «wx» dans wxWidgets. </font><font style="vertical-align: inherit;">Si, dans votre liaison Python, vous souhaitez renommer toutes les classes en </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">supprimant</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ces préfixes, afin de ne pas définir l'annotation </font><i><font style="vertical-align: inherit;">PyName</font></i><font style="vertical-align: inherit;"> pour chaque classe, vous pouvez utiliser la directive </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% AutoPyName</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Nous ne considérerons pas cette directive dans cet article, nous dirons seulement que la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% AutoPyName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> doit être située à l'intérieur de la directive </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Module</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et nous limiter à un exemple de la documentation:</font></font><br>
<br>
<pre><code class="plaintext hljs">%Module PyQt5.QtCore<font></font>
{<font></font>
    %AutoPyName(remove_leading="Q")<font></font>
}<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajouter une conversion de type</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple d'utilisation de la classe std :: wstring</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jusqu'à présent, nous avons examiné les fonctions et les classes qui ont travaillé avec des types simples comme </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Pour ces types, SIP a automatiquement créé un convertisseur vers et depuis les classes Python. Dans l'exemple suivant, qui se trouve dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_06</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , nous considérerons le cas où les méthodes de classe acceptent et retournent des objets plus complexes, par exemple des chaînes de STL. Pour simplifier l'exemple et ne pas compliquer la conversion d'octets en Unicode et vice versa, la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classe de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> chaîne </font><i><font style="vertical-align: inherit;">std :: wstring</font></i><font style="vertical-align: inherit;"> sera utilisée dans cet exemple </font><font style="vertical-align: inherit;">. L'idée de cet exemple est de montrer comment vous pouvez définir manuellement les règles de conversion des classes C ++ vers et depuis les classes Python. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour cet exemple, nous allons changer la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de la bibliothèque </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Maintenant, la définition de classe ressemblera à ceci (fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> FOO_LIB</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> FOO_LIB</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><font></font>
<font></font>
<span class="hljs-keyword">using</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span>;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> {</span>
    <span class="hljs-keyword">private</span>:
        <span class="hljs-keyword">int</span> _int_val;
        <span class="hljs-built_in">wstring</span> _string_val;
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span> int_val, <span class="hljs-built_in">wstring</span> string_val);<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span></span>;<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-built_in">wstring</span> val)</span></span>;
        <span class="hljs-function"><span class="hljs-built_in">wstring</span> <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span></span>;<font></font>
};<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'implémentation de la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"foo.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">using</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span>;<font></font>
<font></font>
Foo::Foo(<span class="hljs-keyword">int</span> int_val, <span class="hljs-built_in">wstring</span> string_val):<font></font>
    _int_val(int_val), _string_val(string_val) {}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Foo::set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span> </span>{<font></font>
    _int_val = val;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">Foo::get_int_val</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> _int_val;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Foo::set_string_val</span><span class="hljs-params">(<span class="hljs-built_in">wstring</span> val)</span> </span>{<font></font>
    _string_val = val;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-built_in">wstring</span> <span class="hljs-title">Foo::get_string_val</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> _string_val;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour vérifier les fonctionnalités de la bibliothèque:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"foo.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">using</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span>;
<span class="hljs-keyword">using</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span> </span>{
    <span class="hljs-keyword">auto</span> foo = Foo(<span class="hljs-number">10</span>, <span class="hljs-string">L"Hello"</span>);
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">L"int_val: "</span> &lt;&lt; foo.get_int_val() &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">L"string_val: "</span> &lt;&lt; foo.get_string_val().c_str() &lt;&lt; <span class="hljs-built_in">endl</span>;<font></font>
<font></font>
    foo.set_int_val(<span class="hljs-number">0</span>);<font></font>
    foo.set_string_val(<span class="hljs-string">L"Hello world!"</span>);<font></font>
<font></font>
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">L"int_val: "</span> &lt;&lt; foo.get_int_val() &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">L"string_val: "</span> &lt;&lt; foo.get_string_val().c_str() &lt;&lt; <span class="hljs-built_in">endl</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les fichiers </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , comme précédemment, se trouvent dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> processus de création du </font><i><font style="vertical-align: inherit;">makefile</font></i><font style="vertical-align: inherit;"> et de la bibliothèque n'a pas changé. </font><font style="vertical-align: inherit;">Il n'y a pas non plus de modifications importantes dans les fichiers </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp.sip est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> devenu beaucoup plus compliqué:</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foocpp, language=<span class="hljs-string">"C++"</span>)<font></font>
%DefaultEncoding <span class="hljs-string">"UTF-8"</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> {</span><font></font>
    %TypeHeaderCode<font></font>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;foo.h&gt;</span></span><font></font>
    %End<font></font>
<font></font>
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span>, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span>);<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Property(name=int_val, get=get_int_val, <span class="hljs-built_in">set</span>=set_int_val)<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span>)</span></span>;
        <span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span> <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Property(name=string_val, get=get_string_val, <span class="hljs-built_in">set</span>=set_string_val)<font></font>
};<font></font>
<font></font>
%MappedType <span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span><font></font>
{<font></font>
%TypeHeaderCode<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><font></font>
%End<font></font>
<font></font>
%ConvertFromTypeCode<font></font>
    <span class="hljs-comment">// Convert an std::wstring to a Python (Unicode) string</span><font></font>
    PyObject* newstring;<font></font>
    newstring = PyUnicode_FromWideChar(sipCpp-&gt;data(), <span class="hljs-number">-1</span>);
    <span class="hljs-keyword">return</span> newstring;<font></font>
%End<font></font>
<font></font>
%ConvertToTypeCode<font></font>
    <span class="hljs-comment">// Convert a Python (Unicode) string to an std::wstring</span>
    <span class="hljs-keyword">if</span> (sipIsErr == <span class="hljs-literal">NULL</span>) {
        <span class="hljs-keyword">return</span> PyUnicode_Check(sipPy);<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (PyUnicode_Check(sipPy)) {<font></font>
        *sipCppPtr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span>(PyUnicode_AS_UNICODE(sipPy));
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
%End<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fins d'</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> illustration </font><i><font style="vertical-align: inherit;">, le</font></i><font style="vertical-align: inherit;"> fichier </font><i><font style="vertical-align: inherit;">pyfoocpp.sip n'ajoute</font></i><font style="vertical-align: inherit;"> pas de lignes de documentation. Si nous </font><font style="vertical-align: inherit;">ne </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conservions</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que la déclaration de la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans le fichier </font><i><font style="vertical-align: inherit;">pyfoocpp.sip</font></i><font style="vertical-align: inherit;"> sans la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% MappedType suivante</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , nous obtiendrions l'erreur suivante pendant le processus de génération:</font></font><br>
<br>
<pre><code class="plaintext hljs">$ sip-wheel<font></font>
<font></font>
These bindings will be built: pyfoocpp.<font></font>
Generating the pyfoocpp bindings...<font></font>
sip-wheel: std::wstring is undefined<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous devons décrire explicitement comment un objet de type </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sera converti en un objet Python, et également décrire la transformation inverse. Pour décrire la conversion, nous devons travailler à un niveau assez bas dans le langage C et utiliser l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API Python / C</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Étant donné que l'API Python / C est un gros sujet, digne même d'un article séparé, mais d'un livre, dans cette section, nous ne considérerons que les fonctions utilisées dans l'exemple, sans entrer dans trop de détails. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour déclarer des conversions d'objets C ++ en Python et vice versa, la directive </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% MappedType</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">prévue</font></a><font style="vertical-align: inherit;"> , à l'intérieur de laquelle il peut y avoir trois autres directives: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% TypeHeaderCode</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertToTypeCode</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertFromTypeCode</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Après l'expression </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% MappedType</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">vous devez spécifier le type pour lequel les convertisseurs seront créés. </font><font style="vertical-align: inherit;">Dans notre cas, la directive commence par l'expression </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% MappedType std :: wstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Nous avons déjà rencontré la </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% TypeHeaderCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans la section </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Création d'une liaison pour une bibliothèque en C ++</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Permettez-moi de vous rappeler que cette directive est destinée à déclarer les types utilisés ou à inclure les fichiers d'en-tête dans lesquels ils sont déclarés. </font><font style="vertical-align: inherit;">Dans cet exemple </font><font style="vertical-align: inherit;">, la </font><i><font style="vertical-align: inherit;">chaîne du</font></i><font style="vertical-align: inherit;"> fichier d'en-tête </font><font style="vertical-align: inherit;">, où la classe </font><i><font style="vertical-align: inherit;">std :: string est</font></i><font style="vertical-align: inherit;"> déclarée, est </font><font style="vertical-align: inherit;">connectée </font><font style="vertical-align: inherit;">à l'intérieur de la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% TypeHeaderCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">
Maintenant, nous devons décrire les transformations</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertFromTypeCode. </font><font style="vertical-align: inherit;">Conversion d'objets C ++ en Python</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous commençons par convertir les objets </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en la </font><font style="vertical-align: inherit;">classe </font><font style="vertical-align: inherit;">Python </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Cette conversion dans l'exemple est la suivante:</font></font><br>
<br>
<pre><code class="cpp hljs">%ConvertFromTypeCode
    <span class="hljs-comment">// Convert an std::wstring to a Python (Unicode) string</span><font></font>
    PyObject* newstring;<font></font>
    newstring = PyUnicode_FromWideChar(sipCpp-&gt;data(), <span class="hljs-number">-1</span>);
    <span class="hljs-keyword">return</span> newstring;<font></font>
%End<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À l'intérieur de cette directive, nous avons la variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipCpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - un pointeur vers un objet à partir du code C ++, par lequel nous devons créer un objet Python et renvoyer l'objet créé à partir de la directive à l'aide de l' </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instruction return</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dans ce cas, la variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipCpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est de type </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Pour créer la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , utilisez la fonction </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyUnicode_FromWideChar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de l'API Python / C. Cette fonction accepte un tableau (pointeur) de type </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const wchar_t * w</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comme premier paramètre </font><font style="vertical-align: inherit;">, et la taille de ce tableau comme deuxième paramètre. Si vous passez la valeur -1 comme deuxième paramètre, la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyUnicode_FromWideChar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> elle-même calculera la longueur à l'aide de la fonction</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wcslen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour obtenir le tableau </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wchar_t *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">utilisez la méthode </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">data</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de la classe </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyUnicode_FromWideChar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> renvoie un pointeur sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyObject</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULL</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en cas d'erreur. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyObject</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est n'importe quel objet Python, dans ce cas, ce sera la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dans l'API Python / C, le travail avec les objets s'effectue généralement via des pointeurs </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyObject *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dans ce cas, </font><font style="vertical-align: inherit;">nous </font><i><font style="vertical-align: inherit;">renvoyons le</font></i><font style="vertical-align: inherit;"> pointeur </font><i><font style="vertical-align: inherit;">PyObject * à</font></i><font style="vertical-align: inherit;"> partir de la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertFromTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertToTypeCode. </font><font style="vertical-align: inherit;">Convertir des objets Python en C ++</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La conversion inverse d'un objet Python (essentiellement de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyObject *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) en classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est </font><font style="vertical-align: inherit;">décrite dans la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertToTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dans l'exemple </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_06, la</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> conversion est la suivante:</font></font><br>
<br>
<pre><code class="cpp hljs">%ConvertToTypeCode
    <span class="hljs-comment">// Convert a Python (Unicode) string to an std::wstring</span>
    <span class="hljs-keyword">if</span> (sipIsErr == <span class="hljs-literal">NULL</span>) {
        <span class="hljs-keyword">return</span> PyUnicode_Check(sipPy);<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (PyUnicode_Check(sipPy)) {<font></font>
        *sipCppPtr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span>(PyUnicode_AS_UNICODE(sipPy));
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
%End<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le code de la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertToTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> semble plus compliqué, car pendant le processus de conversion, il est appelé plusieurs fois à des fins différentes. Dans la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertToTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">SIP crée plusieurs variables que nous pouvons (ou devons) utiliser. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'une de ces variables, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyObject * sipPy,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est un objet Python dont vous avez besoin pour créer une instance de la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans ce cas </font><font style="vertical-align: inherit;">. Le résultat devra être écrit dans une autre variable - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipCppPtr</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est un double pointeur vers l'objet créé, c'est-à-dire dans notre cas, cette variable sera de type </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring **</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre </font><i><font style="vertical-align: inherit;">% ConvertToTypeCode</font></i><font style="vertical-align: inherit;"> créé à l'intérieur de la directive</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la variable est </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int * sipIsErr</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Si la valeur de cette variable est </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULL</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertToTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est appelée uniquement pour vérifier si la conversion de type est possible. Dans ce cas, nous ne sommes pas obligés d'effectuer la transformation, mais il suffit de vérifier si cela est possible en principe. Si possible, la directive doit renvoyer une valeur non nulle, sinon, si la conversion n'est pas possible, ils doivent retourner 0. Si ce pointeur n'est pas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULL</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , alors vous devez effectuer la conversion, et si une erreur se produit pendant la conversion, le code d'erreur entier peut être enregistré dans cette variable (étant donné que cette variable est un pointeur vers </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet exemple, pour vérifier que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipPy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est une chaîne unicode (classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), la macro </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyUnicode_Check</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">utilisée</font></a><font style="vertical-align: inherit;"> , qui prend un argument de type </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyObject *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> si l'argument passé est une chaîne unicode ou une classe qui en dérive. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La conversion en un objet C ++ est effectuée à l'aide de la chaîne </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* sipCppPtr = new std :: wstring (PyUnicode_AS_UNICODE (sipPy));</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ici, la macro </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyUnicode_AS_UNICODE est appelée à</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> partir de l'API Python / C, qui renvoie un tableau de type </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Py_UNICODE *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui équivaut à </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wchar_t *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ce tableau est passé au constructeur de la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Comme mentionné ci-dessus, le résultat est stocké dans la variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipCppPtr</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour le moment, la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyUnicode_AS_UNICODE</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est </font><font style="vertical-align: inherit;">déconseillée et il est recommandé d'utiliser d'autres macros, mais cette macro est utilisée pour simplifier l'exemple. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si la conversion a réussi, la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertToTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> doit renvoyer une valeur non nulle (dans ce cas 1), et en cas d'erreur, elle doit retourner 0.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Vérifier </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons décrit la conversion du type </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et vice versa, maintenant nous pouvons nous assurer que le package est correctement construit et que la liaison fonctionne comme il se doit. </font><font style="vertical-align: inherit;">Pour construire, appelez </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , puis installez le package à l'aide de pip et vérifiez l'opérabilité en mode de commande Python:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foocpp <span class="hljs-keyword">import</span> Foo
<span class="hljs-meta">&gt;&gt;&gt; </span>x = Foo(<span class="hljs-number">10</span>, <span class="hljs-string">'Hello'</span>)<font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.string_val
<span class="hljs-string">'Hello'</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.string_val = <span class="hljs-string">''</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.string_val
<span class="hljs-string">''</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.get_string_val()
<span class="hljs-string">''</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, tout fonctionne, il n'y a pas non plus de problème avec la langue russe, c'est-à-dire </font><font style="vertical-align: inherit;">Les conversions de chaînes Unicode ont fonctionné correctement.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet article, nous avons couvert les bases de l'utilisation de SIP pour créer des liaisons Python pour des bibliothèques écrites en C et C ++. </font><font style="vertical-align: inherit;">Tout d'abord (dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">première partie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), nous avons créé une bibliothèque simple en C et trouvé les fichiers qui doivent être créés pour fonctionner avec SIP. </font><font style="vertical-align: inherit;">Le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contient des informations sur le package (nom, numéro de version, licence et chemins d'accès aux fichiers d'en-tête et d'objet). </font><font style="vertical-align: inherit;">À l'aide du fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">vous pouvez influencer le processus de génération du package Python, par exemple, commencer à créer la bibliothèque C / C ++ ou laisser l'utilisateur spécifier l'emplacement des fichiers d'en-tête et d'objet de la bibliothèque. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* .sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">décrit l'interface du module Python listant les fonctions et classes qui seront contenues dans le module. </font><font style="vertical-align: inherit;">Des directives et des annotations sont utilisées </font><font style="vertical-align: inherit;">pour décrire l'interface dans le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* .sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . L'interface de classe Python ne doit pas nécessairement correspondre à l'interface de classe C ++. Par exemple, vous pouvez ajouter des propriétés aux classes à l'aide de la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Property</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , renommer des entités à l'aide de l'annotation </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ PyName /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et ajouter des lignes de documentation à l'aide de la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Docstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Types élémentaires comme </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">etc. SIP se convertit automatiquement en classes Python similaires, mais si vous devez effectuer une conversion plus complexe, vous devez la programmer vous-même dans la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% MappedType</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> à l'aide de l'API Python / C. La conversion de la classe Python en C ++ doit être effectuée dans la directive imbriquée </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertToTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . La conversion d'un type C ++ en une classe Python doit être effectuée dans la directive imbriquée </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertFromTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Certaines directives comme </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultEncoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultDocstringFormat</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultDocstringSignature</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sont auxiliaires et vous permettent de définir des valeurs par défaut pour les cas où certains paramètres d'annotation ne sont pas définis explicitement.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet article, nous n'avons examiné que les directives et les annotations les plus simples et les plus simples, mais bon nombre d'entre elles ont été ignorées. </font><font style="vertical-align: inherit;">Par exemple, il existe des directives pour gérer GIL, pour créer de nouvelles exceptions Python, pour gérer manuellement la mémoire et les récupérateurs de place, pour peaufiner les classes pour différents systèmes d'exploitation, et bien d'autres qui peuvent être utiles lors de la création de liaisons de bibliothèque C / C ++ complexes. </font><font style="vertical-align: inherit;">Nous avons également ignoré le problème de la création de packages pour différents systèmes d'exploitation, en nous limitant à la construction sous Linux à l'aide de compilateurs gcc / g ++.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Références</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La première partie de l'article</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemples pour cet article</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Page d'accueil SIP</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Documentation pour SIP</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Documentation de l'API Python / C</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr495618/index.html">La mise en quarantaine entraîne des pertes. Comment vivre sans quarantaine?</a></li>
<li><a href="../fr495620/index.html">Assemblé une moissonneuse de vidéoconférence à Jabra Panacast, avantages et inconvénients pour le bureau et la maison</a></li>
<li><a href="../fr495622/index.html">Avion à double système de climatisation numérique (SLE)</a></li>
<li><a href="../fr495624/index.html">Pourquoi la Xbox Series X sera le principal achat de 2020</a></li>
<li><a href="../fr495634/index.html">Tout le monde le fait: pourquoi les employés sont la principale menace à la sécurité des informations de l'entreprise et comment y faire face</a></li>
<li><a href="../fr495638/index.html">Virgule en anglais: 5 règles et 3 principales erreurs</a></li>
<li><a href="../fr495642/index.html">Commencez à collecter les erreurs dans les fonctions de copie</a></li>
<li><a href="../fr495644/index.html">TS Total Sight. Outil de collecte d'événements, d'analyse d'incidents et d'automatisation de la réponse aux menaces</a></li>
<li><a href="../fr495646/index.html">Quels podcasts non stressants à écouter le week-end</a></li>
<li><a href="../fr495658/index.html">Où obtenir de l'audio pour l'apprentissage automatique: une sélection de bibliothèques ouvertes sous licence Creative Commons</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>