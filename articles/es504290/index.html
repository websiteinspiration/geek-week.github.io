<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⏺️ 🔙 🏏 Pruebas de carga como un servicio de CI para desarrolladores 🥝 🛂 🙅🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Uno de los problemas que a menudo encuentran los proveedores de software multiproducto es la duplicación de las competencias de los ingenieros (desarr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Pruebas de carga como un servicio de CI para desarrolladores</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/504290/"><img src="https://habrastorage.org/webt/r5/fa/5g/r5fa5gszksri1ly608-wffhunqu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uno de los problemas que a menudo encuentran los proveedores de software multiproducto es la duplicación de las competencias de los ingenieros (desarrolladores, probadores y administradores de infraestructura) en casi todos los equipos. Esto también se aplica a los costosos ingenieros, expertos en el campo de las pruebas de carga. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En lugar de comprometerse con sus responsabilidades directas y usar su experiencia única para construir el proceso de prueba de carga, eligiendo una metodología, métricas óptimas y escribiendo autoevaluaciones de acuerdo con los perfiles de carga, los ingenieros a menudo tienen que implementar infraestructura de prueba desde cero, configurar herramientas de carga e incorporarlas en sistemas CI, configure el monitoreo y la publicación de informes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede encontrar soluciones a algunos problemas de organización en las pruebas que utilizamos en Positive Technologies en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">otro artículo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Y en esto hablaré sobre la posibilidad de integrar pruebas de carga en una tubería común de CI utilizando el concepto de "prueba de carga como servicio". </font><font style="vertical-align: inherit;">Aprenderá cómo y qué imágenes acoplables de fuentes de carga se pueden utilizar en la canalización de CI; </font><font style="vertical-align: inherit;">Cómo conectar fuentes de carga a su proyecto de CI utilizando una plantilla de ensamblaje; </font><font style="vertical-align: inherit;">cómo se ve una tubería de demostración para ejecutar pruebas de carga y publicar resultados. </font><font style="vertical-align: inherit;">Este artículo puede ser útil para ingenieros de pruebas de software e ingenieros de automatización de CI que hayan pensado en la arquitectura de su sistema de carga.</font></font><a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esencia del concepto</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El concepto de prueba de carga como un servicio implica la capacidad de integrar Apache JMeter, Yandex.Tank herramientas de carga y marcos propios en un sistema arbitrario de integración continua. Una demostración será para GitLab CI, pero los principios son comunes a todos los sistemas CI. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La prueba de carga como servicio es un servicio centralizado para realizar pruebas de carga. Las pruebas de carga se ejecutan en grupos de agentes dedicados, los resultados se publican automáticamente en GitLab Pages, Influx DB y Grafana o en sistemas de informes de prueba (TestRail, ReportPortal, etc.). La automatización y el escalado se realizan de la manera más simple posible: agregando y parametrizando la plantilla gitlab-ci.yml habitual en el proyecto GitLab CI.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La ventaja del enfoque es que toda la infraestructura de CI, los agentes de carga, las imágenes acopladas de las fuentes de carga, las tuberías de prueba y la publicación de informes son compatibles con el departamento de automatización central (ingenieros de DevOps), y los ingenieros de prueba de carga pueden centrar sus esfuerzos en el desarrollo de pruebas y análisis de sus resultados, sin tratar con problemas de infraestructura. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para simplificar la descripción, asumimos que la aplicación de prueba de destino o el servidor ya está implementado y configurado de antemano (para esto, se pueden usar scripts automatizados en Python, SaltStack, Ansible, etc.). Luego, todo el concepto de prueba de esfuerzo como servicio se ajusta a tres etapas: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">preparación, prueba, publicación de informes</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Más detalles en el diagrama (se puede hacer clic en todas las imágenes):</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/uc/no/nj/ucnonjamcikvuob-3njskwev-he.png"></a><br>
<br>
<h2>      </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al realizar pruebas de estrés, tratamos de cumplir con los </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estándares y la metodología de ISTQB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , utilizamos la terminología adecuada y las métricas recomendadas. Daré una breve lista de conceptos básicos y definiciones en pruebas de carga. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agente de carga (agente de carga)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : la máquina virtual en la que se iniciará la aplicación, la fuente de la carga (Apache JMeter, Yandex.Tank o módulo de carga autoescrito). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El propósito de la prueba (objetivo)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es un servidor o aplicación instalada en el servidor que estará sujeta a carga. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Caso de prueba (caso de prueba)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : un conjunto de pasos parametrizados: acciones del usuario y reacciones esperadas a estas acciones, con solicitudes y respuestas de red fijas, según los parámetros especificados.</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perfil o plan de carga (perfil)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : en la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">metodología ISTQB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Sección 4.2.4, p. 43), los perfiles de carga determinan las métricas críticas para una prueba en particular y las opciones para cambiar los parámetros de carga durante la prueba. Puede ver ejemplos de perfiles en la figura. </font><b><font style="vertical-align: inherit;">Test</font></b><font style="vertical-align: inherit;"> es un script con un conjunto predefinido de parámetros. </font><b><font style="vertical-align: inherit;">Plan de</font></b><font style="vertical-align: inherit;"> prueba: conjunto de pruebas y perfil de carga. </font><b><font style="vertical-align: inherit;">Testrun (testrun)</font></b><font style="vertical-align: inherit;"> : una iteración de ejecutar una prueba con un escenario de carga totalmente ejecutado y un informe recibido. </font><b><font style="vertical-align: inherit;">Solicitud de red (solicitud)</font></b><font style="vertical-align: inherit;"> : una solicitud HTTP enviada desde el agente al destino. </font><b><font style="vertical-align: inherit;">Respuesta de red (respuesta)</font></b><font style="vertical-align: inherit;"> : una respuesta HTTP enviada desde el destino al agente.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/qm/iq/d5/qmiqd5egscabj6hrmlnufxnyv4m.png"></a><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El estado de respuesta HTTP es un código de respuesta estándar del servidor de aplicaciones. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Transacción (transacción): un ciclo completo de "solicitud - respuesta". </font><font style="vertical-align: inherit;">Una transacción se cuenta desde el comienzo del envío de una solicitud (solicitud) hasta la finalización de recibir una respuesta (respuesta). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estado de la transacción (estado de las transacciones)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : ¿fue posible completar con éxito el ciclo "solicitud-respuesta"? </font><font style="vertical-align: inherit;">Si hubo algún error en este bucle, la transacción completa se considera infructuosa. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tiempo de respuesta (latencia)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : tiempo desde el final del envío de una solicitud (solicitud) hasta el comienzo de recibir una respuesta (respuesta). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Métricas de carga (métricas)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : las características del servicio cargado y el agente de carga definidos durante el proceso de prueba de carga.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Métricas básicas para medir parámetros de carga</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Algunas de las </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">métricas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> más comunes y recomendadas en la metodología </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">ISTQB</font></a><font style="vertical-align: inherit;"> (p. 36, 52) se muestran en la tabla a continuación. </font><font style="vertical-align: inherit;">Métricas similares para el agente y el objetivo se muestran en la misma línea.</font></font><br>
<br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cargar métricas de agente</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Métricas del sistema o aplicación objetivo probadas bajo carga</font></font></th>
</tr>
</thead>
<tbody>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El número de&nbsp;&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vCPU</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y memoria </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAM</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">disco</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - características de "hierro" del agente de carga</font></font></td>
<td><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uso de </font></font></b><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">CPU</font></b><font style="vertical-align: inherit;"> , </font><b><font style="vertical-align: inherit;">memoria, disco</font></b><font style="vertical-align: inherit;"> : la dinámica de cargar el procesador, la memoria y el disco </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
durante las pruebas. </font><font style="vertical-align: inherit;">Usualmente se mide como un porcentaje de </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
los valores máximos disponibles.</font></font></td>
</tr>
<tr>
<td><b>Network throughput</b> (on load agent) —   <br>
   , <br>
   . <br>
      (bps)</td>
<td><b>Network throughput</b>(on target) —     <br>
  .       (bps)</td>
</tr>
<tr>
<td><b>Virtual users</b>—   , <br>
    <br>
   </td>
<td><b>Virtual users status</b>, Passed/Failed/Total —    <br>
     <br>
  ,     .<br>
<br>
 ,      <br>
  ,    . <br>
   ,       <br>
      </td>
</tr>
<tr>
<td><b>Requests per second (minute)</b>—      ( ).<br>
<br>
   :     . <br>
       </td>
<td><b>Responses per second (minute)</b><br>
 —      ( ).<br>
<br>
   :   <br>
       <br>
 </td>
</tr>
<tr>
<td></td>
<td><b>HTTP responses status</b>—     <br>
  ,   . <br>
, 200 OK   , <br>
 404 —    </td>
</tr>
<tr>
<td></td>
<td><b>Latency</b> ( ) —    <br>
  (request)     (response). <br>
    (ms)</td>
</tr>
<tr>
<td></td>
<td><b>Transaction response time</b>—    , <br>
  « — ». <br>
      (request) <br>
    (response).<br>
<br>
      ( ) <br>
 :  , <br>
,  , , 90- . <br>
    —   <br>
  . <br>
    , <br>
    , <br>
     </td>
</tr>
<tr>
<td></td>
<td><b>Transactions per second (minute)</b> —   <br>
   (), <br>
       <br>
    . <br>
    </td>
</tr>
<tr>
<td></td>
<td><b>Transactions status</b> , Passed / Failed / Total —  <br>
,     .<br>
<br>
    <br>
    <br>
     </td>
</tr>
</tbody>
</table></div><br>
<h2>   </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El esquema básico de las pruebas de carga es muy simple y consta de tres etapas principales, que ya mencioné: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preparar - Prueba - Informe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , es decir, preparar objetivos de prueba y establecer parámetros para las fuentes de carga, luego realizar pruebas de carga y, finalmente, generar y publicar un informe Sobre las pruebas. </font><font style="vertical-align: inherit;">
Notas al esquema:</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/o5/s5/z5/o5s5z5f79dpui3ojk5vbwgsayso.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QA.Tester - experto en pruebas de estrés,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Target es la aplicación de destino para la que necesita conocer su comportamiento bajo carga.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clasificador de entidades, etapas y pasos en el diagrama.</font></font></h2><br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Etapas y Pasos</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qué esta pasando</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Que hay en la entrada</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cual es la salida</font></font></th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preparar: fase de preparación de prueba</font></font></td>
</tr>
<tr>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parámetros de carga</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Establecer e inicializar </font><font style="vertical-align: inherit;">
parámetros de carga del </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
usuario </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
seleccionar métricas y </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
preparar un plan de prueba </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(perfil de carga)</font></font></td>
<td>  <br>
  <br>
-<br>
 </td>
<td></td>
</tr>
<tr>
<td><b>VM</b></td>
<td>   <br>
   <br>
 </td>
<td>    <br>
   <br>
 </td>
<td>  <br>
 </td>
</tr>
<tr>
<td><b>Env</b></td>
<td>    <br>
  <br>
  </td>
<td>   <br>
 <br>
   <br>
 </td>
<td> : <br>
,   , <br>
   <br>
 </td>
</tr>
<tr>
<td><b>LoadAgents</b></td>
<td>,    <br>
 . <br>
  -  <br>
  </td>
<td>-   <br>
(, JM   )<br>
  <br>
 </td>
<td>   <br>
   <br>
</td>
</tr>
<tr>
<td colspan="4">Test:    .    ,       GitLab CI</td>
</tr>
<tr>
<td><b>Load</b></td>
<td>   <br>
  -<br>
   </td>
<td>  <br>
  <br>
 <br>
-<br>
 </td>
<td>  <br>
 <br>
 <br>
      </td>
</tr>
<tr>
<td><b>RunAgents</b></td>
<td>  <br>
   <br>
  <br>
  <br>
   <br>
  </td>
<td>-<br>
 </td>
<td></td>
</tr>
<tr>
<td><b>Logs</b></td>
<td> «»  <br>
   : <br>
    , <br>
   <br>
 ,    </td>
<td></td>
<td>  <br>
 <br>
 </td>
</tr>
<tr>
<td><b>Metrics</b></td>
<td> «»    </td>
<td></td>
<td>    <br>
  </td>
</tr>
<tr>
<td colspan="4">Report:     </td>
</tr>
<tr>
<td><b>Generator</b></td>
<td>  <br>
   <br>
  «» <br>
  <br>
   <br>
 , <br>
   <br>
</td>
<td>  <br>
 <br>
 <br>
   <br>
   </td>
<td> «»  <br>
 ,   <br>
   <br>
   ,<br>
   </td>
</tr>
<tr>
<td><b>Publish</b></td>
<td>  <br>
  <br>
   <br>
</td>
<td> «» <br>
  ,  <br>
    <br>
</td>
<td>   <br>
   <br>
,  <br>
  </td>
</tr>
</tbody>
</table></div><br>
<h2>    CI-</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pasemos a la parte práctica. Quiero mostrar cómo en algunos proyectos en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Positive Technologies</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> implementamos el concepto de prueba de carga como un servicio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primero, con la ayuda de nuestros ingenieros de DevOps, creamos un grupo de agentes dedicado en GitLab CI para ejecutar pruebas de carga. Para no confundirlos en plantillas con otros, como grupos de ensamblaje, agregamos etiquetas a estos agentes, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">etiquetas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : carga. Puede usar cualquier otra etiqueta clara. Se establecen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">durante el registro de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GitLab CI Runners.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¿Cómo averiguar la potencia requerida por hardware? Las características de los agentes de carga (una cantidad suficiente de vCPU, RAM y disco) se pueden calcular sobre la base de que Docker, Python (para Yandex.Tank), el agente GitLab CI, Java (para Apache JMeter) deben ejecutarse en el agente. Para Java con JMeter, también se recomienda que use un mínimo de 512 MB de RAM y, como límite superior, el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">80% de la memoria disponible</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, según nuestra experiencia, recomendamos utilizar al menos 4 vCPU, 4 GB de RAM, 60 GB de SSD para agentes de carga. El ancho de banda de la tarjeta de red se determina en función de los requisitos del perfil de carga. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Utilizamos principalmente dos fuentes de carga: imágenes acoplables Apache JMeter y Yandex.Tank. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yandex.Tank</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Esta es la herramienta de código abierto de Yandex para pruebas de estrés. Su arquitectura modular se basa en el generador de solicitud HTTP asíncrono asíncrono de alto rendimiento Phantom. El tanque tiene monitoreo incorporado de los recursos del servidor probado utilizando el protocolo SSH, puede detener automáticamente la prueba de acuerdo con las condiciones dadas, puede enviar los resultados tanto a la consola como en forma de gráficos, puede conectar sus módulos a ella para ampliar la funcionalidad. Por cierto, usamos Tank cuando aún no era convencional. En el artículo " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yandex.Tank and Automation of Load Testing</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ", puede leer la historia de cómo, en 2013, lo usamos para </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">realizar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pruebas de carga de </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">PT Appllication Firewall</font></a><font style="vertical-align: inherit;"> , uno de los productos de nuestra empresa. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apache JMeter</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es una herramienta de código abierto para realizar pruebas de estrés de Apache. Se puede usar igualmente bien para probar aplicaciones web estáticas y dinámicas. JMeter admite una gran cantidad de protocolos y formas de interactuar con aplicaciones: HTTP, HTTPS (Java, NodeJS, PHP, ASP.NET, etc.), servicios web SOAP / REST, FTP, TCP, LDAP, SMTP (S), POP3 (S ) e IMAP (S), bases de datos a través de JDBC, pueden ejecutar comandos de shell y trabajar con objetos Java. JMeter tiene un IDE para crear, depurar y ejecutar planes de prueba. También hay una CLI para trabajar en la línea de comandos de cualquier sistema operativo Java compatible (Linux, Windows, Mac OS X). La herramienta puede generar dinámicamente un informe de prueba HTML.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para facilitar el uso dentro de nuestra empresa, para la capacidad de los evaluadores de cambiar y agregar el entorno, creamos imágenes acoplables de fuentes de carga en GitLab CI con publicación en el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">registro</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interno de </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">acopladores en Artifactory</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">De esta forma resulta más rápido y fácil conectarlos en tuberías para pruebas de carga. </font><font style="vertical-align: inherit;">Cómo hacer que Docker presione el registro a través de GitLab CI: consulte las </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instrucciones</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El archivo base docker para Yandex.Tank tomamos esto:</font></font><br>
<br>
<pre><code class="bash hljs">Dockerfile <font></font>
1 | FROM direvius/yandex-tank<font></font>
2 | ENTRYPOINT [<span class="hljs-string">""</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y para Apache JMeter este:</font></font><br>
<br>
<pre><code class="bash hljs">Dockerfile <font></font>
1 | FROM vmarrazzo/jmeter<font></font>
2 | ENTRYPOINT [<span class="hljs-string">""</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede leer cómo funciona nuestro sistema de integración continua en el artículo " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Automatización de procesos de desarrollo: cómo implementamos ideas de DevOps en tecnologías positivas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ".</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plantilla y tubería</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Una plantilla de ejemplo para realizar pruebas de carga está disponible en el proyecto de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">carga de demostración</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Puede </font><font style="vertical-align: inherit;">leer las instrucciones para usar la plantilla </font><font style="vertical-align: inherit;">en el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">archivo Léame</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En la plantilla misma (el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">archivo .gitlab-ci.yml</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) hay notas sobre de qué es responsable este o aquel paso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La plantilla es muy simple y muestra las tres etapas de prueba de carga descritas anteriormente en el diagrama: preparación, prueba y publicación de informes. Responsable del </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">directorio de etapas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la preparación, la prueba y el informe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<ol>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Prepare</a>           .       ,     -    docker registry:       Test.         .</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Test</a>     ,      .     : Yandex.Tank, Apache JMeter,    .         job-.     :<br>
 <ul>
<li>  Yandex.Tank    .<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">/tests/yandextank.sh</a>,</li>
<li>  Apache JMeter    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">./tests/jmeter.sh</a>.</li>
</ul><br>
:         CI-        .     ,    bash-.   ,       —    QA-.               .        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">./tests</a>.<br>
 </li>
<li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Report</a>      ,    Test,   ,   GitLab Pages    .  GitLab Pages ,      ./public        index.html.     GitLab Pages    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a>.<br>
<br>
,   : <ul>
<li> JMeter  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GitLab Pages</a>,</li>
<li> Yandex.Tank  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">InfluxDB  Grafana</a>.</li>
</ul><br>
   :<ul>
<li>HTML-  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GitLab Pages</a>,</li>
<li> InfluxDB    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Grafana</a>.</li>
</ul></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En un ejemplo de demostración, una tubería con pruebas de carga y dos fuentes de carga (puede deshabilitar innecesariamente) se ve así: </font><font style="vertical-align: inherit;">
Apache JMeter puede generar un informe HTML por sí mismo, por lo que es más rentable guardarlo en las páginas de GitLab usando herramientas regulares. </font><font style="vertical-align: inherit;">Así es como se ve el informe Apache JMeter: </font><font style="vertical-align: inherit;">
en la demostración de Yandex.Tank, verá solo un </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">informe de texto falso</font></a><font style="vertical-align: inherit;"> en la sección de páginas de GitLab. </font><font style="vertical-align: inherit;">Durante las pruebas, Tank puede guardar los resultados en la base de datos InfluxDB, y desde allí se pueden mostrar, por ejemplo, en Grafana (la configuración se realiza en el archivo </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">./tests/example-yandextank-test.yml</font></a><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Así es como se ve el informe de Tank en Grafana:</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/t6/0f/bx/t60fbxhrvwnju5mubzwmifhjmn0.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/fr/pl/pr/frplprdv1ns3obkqrpn2i4tgetu.png"></a><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/a6/y9/zw/a6y9zw9ej6wcy_g5pk69s1ncrpa.png"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Resumen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el artículo hablé sobre el concepto de "prueba de carga como servicio" (prueba de carga como servicio). La idea principal es utilizar la infraestructura de grupos preconfigurados de agentes de carga, imágenes acopladas de fuentes de carga, sistemas de informes y una tubería que los une en GitLab CI basado en una plantilla simple .gitlab-ci.yml (ejemplo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">por referencia</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Todo esto es respaldado por un pequeño equipo de ingenieros de automatización y se replica a pedido de los equipos de productos. Espero que esto le ayude a preparar e implementar un esquema similar en su empresa. ¡Gracias por su atención! </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PD: Quiero agradecerles a mis colegas, Sergey Kurbanov y Nikolay Yusev, por su asistencia técnica con la implementación del concepto de prueba de carga como un servicio en nuestra empresa. </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autor</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Timur Gilmullin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - diputado. </font><font style="vertical-align: inherit;">Jefe de Tecnología y Procesos de Desarrollo (DevOps), Tecnologías Positivas</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es504264/index.html">Comentario de revisión de Huawei: comenta sobre las publicaciones de Wi-Fi 6 y obtén premios</a></li>
<li><a href="../es504270/index.html">¿Es Svelte una buena opción para la implementación de widgets?</a></li>
<li><a href="../es504276/index.html">Los 10 mejores libros para desarrolladores</a></li>
<li><a href="../es504282/index.html">Creación de arquitectura empresarial en NSPK</a></li>
<li><a href="../es504284/index.html">El libro "Ágil puro. Los fundamentos de la flexibilidad</a></li>
<li><a href="../es504296/index.html">Generando ramas aleatorias en Python</a></li>
<li><a href="../es504306/index.html">¿Cómo se fabrica el hardware ruso para el almacenamiento de Aerodisk Vostok en Elbrus?</a></li>
<li><a href="../es504310/index.html">Dicotomía de datos: repensar la relación con datos y servicios.</a></li>
<li><a href="../es504312/index.html">Registro unificado de programas rusos y GPL. Mis cinco centavos</a></li>
<li><a href="../es504314/index.html">Implementación de los comandos docker pull y docker push sin el cliente docker a través de solicitudes HTTP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>