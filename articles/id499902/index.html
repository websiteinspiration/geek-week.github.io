<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§› ğŸ”‰ ğŸŒƒ Bagaimana TCP Reset Attack Bekerja ğŸ’ƒğŸ¼ ğŸ˜ƒ ğŸ‘¨â€ğŸ”¬</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Serangan reset TCP dilakukan menggunakan paket data tunggal yang berukuran tidak lebih dari beberapa byte. Segmen TCP diganti dengan spoofing, dibuat ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Bagaimana TCP Reset Attack Bekerja</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/499902/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serangan reset TCP dilakukan menggunakan paket data tunggal yang berukuran tidak lebih dari beberapa byte. </font><font style="vertical-align: inherit;">Segmen TCP diganti dengan spoofing, dibuat dan ditransmisikan oleh penyerang, trik dua korban untuk mengakhiri koneksi TCP, mengganggu koneksi di antara mereka, yang bisa menjadi sangat penting.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d0e/768/854/d0e7688544d90ce84fd01f7aae77b348.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Serangan ini memiliki konsekuensi di dunia nyata. </font><font style="vertical-align: inherit;">Kekhawatiran penggunaannya disebabkan oleh pengenalan perubahan pada protokol TCP itu sendiri. </font><font style="vertical-align: inherit;">Serangan itu diyakini merupakan komponen penting dari Tembok Cina Besar (Perisai Emas), yang digunakan oleh pemerintah Cina untuk menyensor Internet di luar Tiongkok. </font><font style="vertical-align: inherit;">Meskipun memiliki latar belakang yang mengesankan, memahami mekanisme di balik serangan ini tidak selalu membutuhkan pengetahuan mendalam tentang TCP. </font><font style="vertical-align: inherit;">Tentu saja, pemahaman tentang seluk-beluknya dapat mengajarkan Anda banyak tentang fitur penerapan protokol TCP, dan, seperti yang akan segera kita lihat, Anda bahkan dapat melakukan serangan ini terhadap diri sendiri hanya menggunakan satu laptop. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam posting ini kita:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pelajari dasar-dasar TCP</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pelajari cara kerja serangan itu.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mari kita lakukan serangan terhadap diri kita sendiri dengan skrip Python sederhana.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebelum kita mulai menganalisis mekanisme serangan, mari kita lihat dulu bagaimana itu digunakan di dunia nyata.</font></font><a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagaimana serangan reset TCP digunakan di Great Firewall?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Great Firewall (GFW) adalah seperangkat sistem dan teknik yang digunakan oleh pemerintah Cina untuk menyensor Internet bagi pengguna internal Cina. </font><font style="vertical-align: inherit;">GFW secara aktif memblokir dan memutuskan koneksi dengan server di dalam dan di luar negara, dan juga secara pasif memonitor lalu lintas Internet dari konten yang dilarang. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mencegah pengguna bahkan terhubung ke server yang terlarang, GFW menggunakan teknik seperti </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">polusi DNS</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pemblokiran IP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Keduanya biaya artikel terpisah). </font><font style="vertical-align: inherit;">Namun, terkadang firewall GFW perlu diizinkan untuk membuat koneksi, tetapi kemudian putuskan di tengah. </font><font style="vertical-align: inherit;">Misalnya, ini diperlukan jika Anda ingin melakukan analisis koneksi yang lambat dan tertunda, misalnya korelasinya dengan tindakan lain. </font><font style="vertical-align: inherit;">Atau digunakan jika firewall perlu menganalisis data yang dipertukarkan selama proses koneksi, dan kemudian menggunakan informasi ini untuk memutuskan apakah akan melanjutkan atau memblokirnya. </font><font style="vertical-align: inherit;">Misalnya, lalu lintas ke situs web berita mungkin diizinkan, tetapi video yang mengandung kata kunci terlarang akan disensor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk ini, GFW membutuhkan alat yang mampu mengganggu koneksi yang sudah ada. </font><font style="vertical-align: inherit;">Salah satu alat tersebut adalah serangan reset TCP.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagaimana cara kerja serangan reset TCP?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam serangan reset TCP, penyerang memutuskan koneksi antara kedua korban, mengirim satu atau kedua pesan palsu yang memberitahu mereka untuk segera memutuskan sambungan. Pesan-pesan ini disebut </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">segmen reset TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dalam operasi normal tanpa partisipasi penyerang, komputer mengirim segmen penurunan TCP ketika mereka menerima lalu lintas TCP yang tidak terduga dan ingin pengirim berhenti mengirimnya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Serangan reset TCP dengan jahat mengeksploitasi mekanisme ini, menipu korban agar mengakhiri koneksi TCP sebelum waktunya, mengirimkan mereka segmen reset palsu. Jika segmen reset palsu dibuat dengan benar, penerima akan mengambilnya untuk segmen nyata dan menutup koneksi untuk bagiannya, mengganggu transmisi informasi lebih lanjut tentang koneksi ini. Untuk melanjutkan pertukaran data, korban dapat mencoba membuat koneksi TCP baru, tetapi penyerang mungkin memiliki kesempatan untuk mereset koneksi baru ini. Untungnya, karena penyerang membutuhkan waktu untuk membangun dan mengirim paket palsu, menjatuhkan serangan benar-benar efektif hanya terhadap koneksi jangka panjang. Koneksi jangka pendek. misalnya, digunakan untuk mentransfer halaman web kecil, biasanya punya waktu untuk memenuhi misi mereka pada saat ituketika penyerang akan dapat mengatur ulang mereka.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mengirim segmen TCP palsu dalam beberapa hal merupakan proses yang mudah, karena baik TCP maupun IP tidak memiliki cara mereka sendiri untuk memverifikasi identitas pengirim. Ada ekstensi IP yang disebut IPSec yang menyediakan otentikasi, tetapi tidak begitu banyak digunakan. Penyedia layanan internet harus menolak untuk mengirimkan paket IP yang berasal dari alamat IP yang jelas salah, tetapi diduga bahwa pemeriksaan ini sangat biasa-biasa saja. Yang dapat dilakukan penerima adalah mengambil alamat IP sumber dan port di dalam paket atau segmen pada nilai nominal dan, jika mungkin, gunakan protokol tingkat yang lebih tinggi, seperti </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/2014/03/27/how-does-"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TLS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , untuk mengidentifikasi pengirim </font><font style="vertical-align: inherit;">. Namun, karena paket dump TCP adalah bagian dari protokol TCP itu sendiri, mereka tidak dapat diverifikasi menggunakan protokol tingkat tinggi ini.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meskipun kesederhanaan mengirim segmen palsu, membuat segmen palsu dan mengeksekusi serangan reset TCP yang sukses masih bisa menjadi tugas yang menakutkan. </font><font style="vertical-align: inherit;">Untuk memahami mengapa ini terjadi, kita perlu memahami operasi protokol TCP.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cara kerja TCP</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tujuan protokol TCP adalah mengirim penerima salinan yang tepat dari blok data. </font><font style="vertical-align: inherit;">Misalnya, jika server saya mengirim HTML melalui TCP ke komputer Anda, maka </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tumpukan TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> komputer Anda (bagian dari sistem operasinya yang memproses TCP) harus menampilkan HTML saya dalam bentuk dan urutan yang persis sama dengan yang dikirim oleh server saya.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/54d/bf5/d64/54dbf5d644d0a3d8ece1cff6cde7b790.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun, HTML saya tidak ditransmisikan melalui Internet dengan cara yang sangat teratur. Ini dibagi menjadi banyak fragmen kecil (disebut </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">segmen TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), yang masing-masing ditransmisikan secara individual melalui Internet dan dibuat ulang dalam urutan yang ditransfer oleh tumpukan TCP komputer Anda. Output yang dikembalikan ini disebut </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aliran TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Setiap segmen TCP ditransmisikan dalam </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paket IP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sendiri </font><font style="vertical-align: inherit;">, namun, untuk memahami serangan itu, kita tidak perlu mengetahui detail tentang IP.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/468/904/175/4689041752b8fa9f66c57c696c4be2ef.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mengubah segmen ke aliran memerlukan kehati-hatian karena Internet tidak dapat diandalkan. </font><font style="vertical-align: inherit;">Segmen TCP mungkin hilang. </font><font style="vertical-align: inherit;">Mereka dapat rusak, dikirim dua kali, rusak dan mengalami banyak kesalahan. </font><font style="vertical-align: inherit;">Oleh karena itu, tujuan protokol TCP adalah untuk memastikan pengiriman data yang andal melalui jaringan yang tidak dapat diandalkan. </font><font style="vertical-align: inherit;">TCP melakukan tugas ini, membutuhkan kedua sisi koneksi untuk menjaga hubungan yang erat antara satu sama lain dan untuk secara konstan mengirimkan informasi tentang blok data mana yang diterima. </font><font style="vertical-align: inherit;">Ini memungkinkan pengirim untuk memahami data apa yang belum diterima penerima, dan mengirimkan kembali data yang hilang. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memahami bagaimana proses itu bekerja, kita perlu memahami bagaimana pengirim dan penerima menggunakan </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nomor urut TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk menandai dan melacak data yang dikirimkan melalui TCP.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nomor urut TCP</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setiap byte yang dikirimkan melalui koneksi TCP memiliki nomor urut yang ditetapkan oleh pengirim. </font><font style="vertical-align: inherit;">Mesin penerima menggunakan nomor seri untuk memindahkan data yang diterima ke dalam urutan awal.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/402/fbc/144/402fbc144a2864f986debfb2ea9b6412.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketika dua mesin menegosiasikan koneksi TCP, setiap mesin mengirimkan </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nomor urut mulai</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> acak lain </font><font style="vertical-align: inherit;">. Ini adalah nomor urut yang akan ditetapkan mesin ke byte pertama yang dikirimkannya. Setiap byte berikutnya diberikan nomor urut dari byte sebelumnya ditambah 1. Segmen </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> berisi </font><em><font style="vertical-align: inherit;">header TCP</font></em><font style="vertical-align: inherit;"> , yang merupakan metadata yang melekat pada awal segmen. Nomor urut byte pertama dalam tubuh segmen termasuk dalam header TCP dari segmen ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perlu dicatat bahwa koneksi TCP adalah dua arah, yaitu, data dapat ditransmisikan dalam dua arah, dan setiap mesin dalam koneksi TCP bertindak baik sebagai pengirim dan penerima. Karena itu, setiap mesin harus menetapkan dan memproses set nomor urutnya sendiri.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfirmasi penerimaan data</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketika mesin menerima segmen TCP, ia memberi tahu pengirim segmen bahwa ia diterima. </font><font style="vertical-align: inherit;">Penerima melakukan ini dengan mengirimkan sebuah segmen </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(kependekan dari â€œacknowledgmentâ€), yang berisi nomor urut </font><font style="vertical-align: inherit;">byte </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">berikutnya</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> yang ia harapkan akan terima dari pengirim. </font><font style="vertical-align: inherit;">Pengirim menggunakan informasi ini untuk memahami bahwa penerima telah berhasil menerima semua byte lainnya hingga nomor ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Segmen </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ditunjukkan oleh kehadiran bendera </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan nomor konfirmasi yang sesuai di tajuk TCP segmen tersebut. </font><font style="vertical-align: inherit;">Hanya ada 6 flag dalam protokol TCP, termasuk (seperti yang akan kita lihat sebentar lagi) flag </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(kependekan dari "reset" - "reset"), yang mengindikasikan segmen reset.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/242/452/e35/242452e35d360faf406441ab93f8c383.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Catatan: TCP juga memungkinkan penggunaan </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ACK selektif</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang ditransmisikan ketika penerima telah menerima beberapa, tetapi tidak semua, segmen dalam kisaran angka. Misalnya, "Saya menerima byte 1000-3000 dan 4000-5000, tetapi tidak 3001-3999." Untuk kesederhanaan, saya tidak akan mempertimbangkan ACK selektif dalam diskusi kita tentang serangan reset TCP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika pengirim mentransmisikan data tetapi tidak menerima</font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bagi mereka selama interval waktu tertentu, ia mengasumsikan bahwa data telah hilang dan mengirimnya kembali, memberi mereka nomor seri yang sama. Ini berarti bahwa jika penerima menerima byte yang sama dua kali, maka dengan sepele menggunakan nomor urut untuk menyingkirkan duplikat tanpa memutus aliran. Penerima dapat menerima data duplikat karena segmen asli diterima kemudian, setelah dikirim lagi, atau karena segmen asli berhasil diterima, tetapi yang bersangkutan </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hilang dalam perjalanan ke pengirim.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e6d/22f/a09/e6d22fa098d7375dab30e6c8341ff358.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meskipun data duplikat seperti itu cukup langka, pemborosan sumber daya yang berlebihan yang disebabkannya tidak menimbulkan masalah. </font><font style="vertical-align: inherit;">Jika semua data cepat atau lambat mencapai penerima, dan data yang sesuai </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mencapai pengirim, maka koneksi TCP melakukan tugasnya.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memilih nomor seri untuk segmen palsu</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saat membuat segmen palsu, </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">penyerang perlu memberinya nomor seri. </font><font style="vertical-align: inherit;">Penerima cukup senang bahwa Anda perlu menerima segmen dengan nomor seri yang tidak konsisten dan menghubungkannya secara independen dalam urutan yang benar. </font><font style="vertical-align: inherit;">Namun, kemampuan mereka terbatas. </font><font style="vertical-align: inherit;">Jika penerima menerima segmen dengan nomor urut yang â€œterlaluâ€ rusak, maka segmen tersebut dibuang. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oleh karena itu, untuk serangan reset TCP yang berhasil, diperlukan nomor urut yang masuk akal. </font><font style="vertical-align: inherit;">Tapi apa yang dianggap nomor seperti itu? </font><font style="vertical-align: inherit;">Untuk sebagian besar segmen (meskipun, seperti yang akan kita lihat nanti, bukan untuk </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), jawabannya ditentukan oleh </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ukuran jendela TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ukuran jendela TCP</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bayangkan sebuah komputer kuno di awal 1990-an, yang terhubung ke jaringan serat optik gigabit modern. Jaringan ultrafast dapat mentransfer data ke komputer tua ini dengan kecepatan luar biasa, lebih cepat dari yang dapat diproses oleh mesin. Ini akan mengganggu kita, karena segmen TCP tidak dapat dianggap diterima sampai penerima dapat memprosesnya.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8a5/299/76a/8a529976a3acd7a28babb9e8220bcb7d.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Komputer memiliki </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">buffer TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di mana data kedatangan baru menunggu pemrosesan sementara komputer bekerja pada data yang tiba sebelum itu. Namun, buffer ini memiliki ukuran terbatas. Jika penerima tidak dapat mengatasi jumlah data yang dikirimkan kepadanya oleh jaringan, maka buffer akan meluap. Ketika buffer sudah penuh, penerima tidak punya pilihan selain menyingkirkan data yang berlebihan. Penerima tidak mengirim </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk data yang dibuang, jadi pengirim harus mengirim ulang mereka ketika ada ruang kosong di buffer penerima. Tidak masalah seberapa cepat jaringan dapat mengirimkan data jika penerima tidak punya waktu untuk mengatasinya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bayangkan seorang teman yang terlalu bersemangat yang mengirimi Anda seluruh aliran surat ke email Anda lebih cepat daripada yang bisa Anda baca. Ada ruang penyangga tertentu di dalam kotak surat Anda, tetapi setelah penuh semua surat yang tidak ditempatkan akan jatuh ke tanah, di mana rubah dan makhluk lain akan memakannya. Seorang teman harus mengirim ulang surat-surat yang telah dimakannya, tetapi untuk sekarang Anda akan punya waktu untuk menerima pesan-pesan sebelumnya. Mengirim terlalu banyak huruf atau volume data yang tidak dapat diproses oleh penerima adalah pemborosan energi dan saluran transmisi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Terlalu banyak" - berapa banyak data itu? Bagaimana pengirim memahami kapan mengirim lebih banyak data, dan kapan layak menunggu? Di sinilah </font><em><font style="vertical-align: inherit;">ukuran jendela TCP</font></em><font style="vertical-align: inherit;"> berguna.</font></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ukuran jendela penerima adalah jumlah maksimum byte yang tidak diakui yang dapat ditransfer pengirim kepadanya kapan saja. Misalkan penerima melaporkan bahwa ukuran jendelanya adalah 100.000 (kami akan segera mengetahui bagaimana ia melewati nilai ini), sehingga pengirim mengirim 100.000 byte. Misalkan pada saat pengirim mentransmisikan seratus ribu byte, penerima mengirim segmen </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk 10.000 byte pertama. Ini berarti bahwa 90.000 byte belum dikonfirmasi. Karena ukuran jendela 100.000, pengirim dapat mentransfer 10.000 byte sebelum ia harus menunggu yang baru </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Jika setelah mengirim 10.000 byte tambahan ini lebih lanjut</font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jika tidak diterima, maka pengirim akan mencapai batas 100.000 byte yang belum dikonfirmasi. Akibatnya, pengirim harus menunggu dan berhenti mengirim data (kecuali pengiriman ulang data yang dianggapnya hilang) sampai ia menerima yang baru </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/afa/5df/46f/afa5df46f3304b04abbf629ca6ef34a0.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Masing-masing sisi koneksi TCP memberitahukan sisi lain ukuran jendelanya selama proses jabat tangan yang dilakukan ketika koneksi dibuka. Selain itu, ukuran jendela dapat diubah secara dinamis selama proses koneksi. Komputer dengan buffer TCP besar dapat mengumumkan ukuran jendela besar untuk memaksimalkan throughput. Ini memungkinkan mesin yang berkomunikasi dengannya secara terus-menerus mengirimkan data melalui koneksi TCP tanpa berhenti atau menunggu konfirmasi. Komputer dengan buffer TCP kecil mungkin terpaksa melaporkan ukuran jendela kecil. Terkadang pengirim benar-benar mengisi jendela dan dipaksa untuk menunggu sampai beberapa segmen dikonfirmasi. Bandwidth menderita karena ini, tetapi perlu bahwa buffer TCP tidak meluap.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8e3/d5e/5e0/8e3d5e5e0e4b574c6896e6ef7adc94bc.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ukuran jendela TCP adalah batasan ketat pada jumlah data yang dikirim yang belum dikonfirmasi. </font><font style="vertical-align: inherit;">Kita dapat menggunakannya untuk menghitung nomor urut maksimum yang mungkin (yang dalam persamaan di bawah ini saya tunjuk sebagai </font></font><code>max_seq_no</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), yang dapat dikirim pengirim pada saat ini:</font></font><br>
<br>
<blockquote><code>max_seq_no = max_acked_seq_no + window_size</code></blockquote><br>
<code>max_acked_seq_no</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Ini adalah nomor urut maksimum yang telah dikirim oleh penerima </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ini adalah nomor urut maksimum yang diketahui pengirim bahwa penerima telah tepat menerima. </font><font style="vertical-align: inherit;">Karena pengirim hanya dapat mengirimkan </font></font><code>window_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">byte yang belum dikonfirmasi, nomor urutan maksimum yang dapat dikirim adalah </font></font><code>max_acked_seq_no + window_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena itu, spesifikasi TCP menyatakan bahwa penerima harus mengabaikan data yang diterimanya yang memiliki nomor seri di luar jendela yang valid. Misalnya, jika penerima telah mengkonfirmasi semua byte hingga 15.000, dan ukuran jendelanya adalah 30.000, maka ia akan menerima data apa pun dengan nomor seri dalam kisaran dari 15.000 hingga (15.000 + 30.000 = 45.000). Selain itu, penerima sepenuhnya mengabaikan data dengan nomor seri di luar interval ini. Jika segmen tersebut berisi data, beberapa di antaranya berada di dalam jendela ini, dan beberapa di luarnya, maka data di dalam jendela akan diterima dan dikonfirmasi, tetapi data di luar itu akan dibuang. Perhatikan bahwa kami masih mengabaikan kemungkinan </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selektif yang</font></font><code>ACK</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> disentuh sebentar di awal posting.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam kasus sebagian besar segmen TCP, aturan ini memberi kita interval nomor urut yang dapat diterima. </font><font style="vertical-align: inherit;">Namun, seperti yang disebutkan sebelumnya, </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pembatasan yang </font><font style="vertical-align: inherit;">diberlakukan pada segmen </font><font style="vertical-align: inherit;">lebih ketat daripada pembatasan pada segmen transmisi data biasa. </font><font style="vertical-align: inherit;">Seperti yang akan kita lihat nanti, ini dilakukan untuk mempersulit pelaksanaan varian </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">serangan</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reset TCP yang disebut </font><em><font style="vertical-align: inherit;">"blind TCP reset attack"</font></em><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nomor Urutan yang Dapat Diterima untuk Segmen RST</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Segmen reguler diterima jika nomor urutnya berada di antara nomor urut yang diharapkan berikutnya dan nomor ini ditambah ukuran jendela. Namun, paket </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hanya diterima ketika nomor urut mereka </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">persis sama dengan</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nomor urut yang diharapkan berikutnya. Mari kita kembali ke contoh sebelumnya, di mana penerima mengirim nomor konfirmasi 15.000. Agar paket </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diterima, nomor urutnya harus tepat 15.000. Jika penerima menerima segmen </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dengan nomor urut tidak sama dengan 15.000, maka ia tidak akan menerimanya.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1d9/596/b55/1d9596b55bb0ac4946ed16ff6b878dff.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika nomor urut di luar interval, maka penerima sepenuhnya mengabaikannya. </font><font style="vertical-align: inherit;">Namun, jika berada di dalam jendela nomor urut yang diharapkan, penerima mengirimkan "tantangan </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" ("panggilan ACK"). </font><font style="vertical-align: inherit;">Ini adalah segmen yang memberi tahu pengirim bahwa segmen </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memiliki nomor urut yang tidak valid. </font><font style="vertical-align: inherit;">Dia juga memberi tahu pengirim nomor urut yang diharapkan penerima. </font><font style="vertical-align: inherit;">Pengirim dapat menggunakan informasi ini dari </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">panggilan untuk membuat ulang dan mengirim ulang </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hingga 2010, TCP tidak menerapkan batasan segmen tambahan ini </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Segmen </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diterima atau ditolak sesuai dengan aturan yang sama seperti yang lainnya. </font><font style="vertical-align: inherit;">Namun, ini terlalu disederhanakan serangan </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">blind blind reset TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serangan TCP buta</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika penyerang memiliki kemampuan untuk mencegat lalu lintas yang dipertukarkan antara korbannya, ia dapat membaca nomor seri dan konfirmasi paket TCP para korban. Dia dapat menggunakan informasi ini untuk memilih nomor seri mana yang akan diberikan kepada segmen palsu </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Namun, jika penyerang tidak dapat mencegat lalu lintas para korban, ia tidak akan tahu nomor urut yang dimasukkan. Tapi dia masih bisa mentransfer sejumlah segmen </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dengan nomor seri yang berbeda, berharap salah satu dari mereka ternyata benar. Serangan semacam itu disebut serangan reset TCP buta. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang telah kami katakan, dalam versi awal protokol TCP, penyerang hanya perlu mengambil nomor seri</font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dalam jendela TCP penerima. </font><font style="vertical-align: inherit;">Sebuah artikel berjudul "Slipping in the Window" menunjukkan bahwa ini membuat serangan buta terlalu mudah, karena untuk kesuksesan yang hampir pasti, seorang penyerang hanya perlu mengirim puluhan ribu segmen. </font><font style="vertical-align: inherit;">Untuk mengatasi ini, aturan yang memaksa penerima untuk menerima segmen </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diganti dengan kriteria yang lebih ketat yang dijelaskan di atas. </font><font style="vertical-align: inherit;">Berkat aturan baru untuk melakukan serangan reset TCP, jutaan segmen perlu dikirim secara membabi buta, yang membuatnya tidak bisa direalisasikan. </font><font style="vertical-align: inherit;">Lihat </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RFC-5963 untuk</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> detailnya </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lakukan serangan reset TCP terhadap diri kita sendiri</font></font></h2><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan: Saya menguji proses ini pada OSX, tetapi menerima beberapa komentar bahwa itu tidak berfungsi dengan baik di Linux. </font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kita tahu segalanya tentang mengeksekusi serangan reset TCP. </font><font style="vertical-align: inherit;">Penyerang harus:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menonton lalu lintas jaringan ( </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"mengendus"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> itu) antara dua korban</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengendus segmen TCP dengan bendera diaktifkan </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan membaca nomor yang dikonfirmasi</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buat segmen TCP yang salah dengan bendera dihidupkan </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan nomor urut sama dengan nomor yang dikonfirmasi dari segmen yang dicegat (perhatikan bahwa ini menyiratkan transmisi lambat, jika tidak, nomor urut yang dipilih akan dengan cepat menjadi usang. (Untuk meningkatkan peluang keberhasilan, Anda dapat mentransfer beberapa segmen </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dengan interval besar nomor urut) .)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kirim segmen palsu ke satu atau kedua korban, berharap ini akan memutus koneksi TCP mereka</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk berlatih, mari kita lakukan serangan TCP pada diri kita di komputer yang sama, berkomunikasi dengan diri kita sendiri melalui </font></font><code>localhost</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Untuk ini kita perlu:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurasikan koneksi TCP antara dua terminal windows</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tulis sebuah program serangan yang akan menangani penghirupan lalu lintas</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubah program sehingga menghasilkan dan mengirimkan segmen palsu </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita mulai.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Membangun koneksi TCP antara dua terminal windows</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami akan mengonfigurasi koneksi TCP menggunakan alat ini </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><code>netcat</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, yang secara default tersedia di banyak sistem operasi. </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klien TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lainnya </font><em><font style="vertical-align: inherit;">akan melakukannya</font></em><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Di jendela terminal pertama, kami akan menjalankan perintah berikut:</font></font><br>
<br>
<blockquote><code>nc -nvl 8000</code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perintah ini memulai mendengarkan server TCP pada port di mesin lokal kami </font></font><code>8000</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Di jendela terminal kedua, jalankan perintah berikut:</font></font><br>
<br>
<blockquote><code>nc 127.0.0.1 8000</code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perintah ini mencoba membuat koneksi TCP ke mesin dengan alamat IP </font></font><code>127.0.0.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">port </font></font><code>8000</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Sekarang, di antara dua jendela terminal, koneksi TCP harus dibuat. </font><font style="vertical-align: inherit;">Coba masukkan sesuatu dalam satu jendela - data harus dikirim melalui koneksi TCP dan muncul di jendela lain.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/911/301/786/911301786c4f56287f80d38f67ef73f6.gif"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Mengendus Lalu Lintas</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami akan menulis program serangan yang melakukan sniffing lalu lintas menggunakan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><code>scapy</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pustaka jaringan Python yang populer. </font><font style="vertical-align: inherit;">Program ini menggunakan scapy untuk membaca data yang ditransfer antara dua jendela terminal, meskipun itu bukan bagian dari koneksi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode program diposting di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repositori saya di GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Program mengendus lalu lintas koneksi dan menampilkannya di terminal. </font><font style="vertical-align: inherit;">Inti utama kode adalah pemanggilan metode </font></font><code>sniff</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dari pustaka yang </font></font><code>scapy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">terletak di akhir file:</font></font><br>
<br>
<pre><code class="python hljs">t = sniff(<font></font>
        iface=<span class="hljs-string">'lo0'</span>,<font></font>
        lfilter=is_packet_tcp_client_to_server(localhost_ip, localhost_server_port, localhost_ip),<font></font>
        prn=log_packet,<font></font>
        count=<span class="hljs-number">50</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sepotong kode ini memberitahu kita </font></font><code>scapy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk mengendus paket pada antarmuka </font></font><code>lo0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan menangkap detail semua paket sebagai bagian dari koneksi TCP kami. </font><font style="vertical-align: inherit;">Panggilan memiliki parameter berikut:</font></font><br>
<br>
<ul>
<li><code>iface</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- pesanan </font></font><code>scapy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk mendengarkan antarmuka jaringan </font></font><code>lo0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, atau localhost</font></font></li>
<li><code>lfilter</code> â€”  ,  <code>scapy</code>   ,      IP- localhost   .   ,        ,   <code>lo0</code>.     ,     .</li>
<li><code>prn</code> â€” ,  <code>scapy</code>     ,    <code>lfilter</code>.          .       ,      <code>RST</code>.</li>
<li><code>count</code> â€”  ,  <code>scapy</code>    .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk menguji program ini, konfigurasikan koneksi TCP dari langkah 1. Kloning repositori GitHub saya, ikuti instruksi konfigurasi, dan jalankan program di jendela ketiga terminal. </font><font style="vertical-align: inherit;">Masukkan beberapa teks ke salah satu terminal koneksi TCP. </font><font style="vertical-align: inherit;">Anda harus melihat bahwa program akan mulai merekam informasi tentang segmen koneksi.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Mengirim paket palsu </font></font><code>RST</code></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami telah membuat koneksi, dan program ini dapat mengendus semua segmen TCP yang melewatinya. Satu-satunya yang tersisa bagi kami adalah memodifikasi program sehingga melakukan serangan reset TCP dengan mengirimkan segmen palsu </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Untuk melakukan ini, kami akan mengubah fungsi </font></font><code>prn</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(lihat daftar parameter di atas), yang dipanggil </font></font><code>scapy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk paket yang memenuhi persyaratan fungsi </font></font><code>lfilter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dalam versi modifikasi fungsi, alih-alih hanya memperbaiki paket yang sesuai, kami mempelajarinya, mengekstrak parameter yang diperlukan, dan menggunakan parameter ini untuk membangun dan mengirim segmen </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Misalkan kita mencegat segmen dari </font></font><code>(src_ip, src_port)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font><code>(dst_ip, dst_port)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ia memiliki satu set bendera </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan nomor konfirmasi adalah 100.000. Untuk membuat dan mengirim segmen, kami:</font></font><br>
<br>
<ul>
<li>  IP-   ,    .  ,         .          ,  .</li>
<li>  <code>RST</code> ,     ,    <code>RST</code></li>
<li>        ,      ,    </li>
<li>  <code>send</code>  <code>scapy</code>     â€”   .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memodifikasi program kami sebelumnya sesuai kebutuhan, batalkan komentar </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pada baris ini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan beri komentar pada baris di atasnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kita siap untuk serangan skala penuh. </font><font style="vertical-align: inherit;">Konfigurasikan koneksi TCP sesuai dengan langkah 1. Jalankan program serangan dari langkah 2 di jendela ketiga terminal. </font><font style="vertical-align: inherit;">Kemudian masukkan beberapa teks di salah satu terminal koneksi TCP. </font><font style="vertical-align: inherit;">Di terminal tempat Anda memasukkan teks, koneksi TCP akan tiba-tiba dan secara misterius terputus. </font><font style="vertical-align: inherit;">Serangan sudah selesai!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ad9/2a2/b18/ad92a2b18c1533c47d88ab4ff10dedf7.gif"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pekerjaan selanjutnya</font></font></h3><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lanjutkan bereksperimen dengan alat serangan. </font><font style="vertical-align: inherit;">Lacak apa yang terjadi jika Anda menambah atau mengurangi 1 dari nomor urut paket </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Pastikan bahwa itu harus </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">persis</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sama dengan nilai </font></font><code>ack</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paket yang dicegat.</font></font></li>
<li> Wireshark       <code>lo0</code>    .            TCP-,       <code>RST</code>.   <code>ip.src == 127.0.0.1 &amp;&amp; ip.dst == 127.0.0.1 &amp;&amp; tcp.port == 8000</code>       .</li>
<li>  ,      .           <code>RST</code>,       <code>RST</code>         ,      .   ,      <code>RST</code>,       .</li>
</ol><br>
<h2></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Serangan reset TCP sangat dalam dan sederhana pada saat bersamaan. </font><font style="vertical-align: inherit;">Semoga berhasil dengan eksperimen Anda dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">beri tahu saya</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> jika Anda memiliki pertanyaan atau komentar.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id499884/index.html">11 hal yang saya mengerti tentang CustDev</a></li>
<li><a href="../id499894/index.html">Tempat bernyanyi. Ulasan Chipolo ONE Smart Keychain Tracker</a></li>
<li><a href="../id499896/index.html">Kami pergi ke situs jarak jauh dengan benar: bagaimana mengatur pekerjaan kami dan pekerjaan proyek di Telegram?</a></li>
<li><a href="../id499898/index.html">Bagaimana orang-orang IT berhubungan dengan karantina, apa yang mereka lakukan sendiri dan apa yang mereka gunakan</a></li>
<li><a href="../id499900/index.html">Mitap analitik produk: gratis, tanpa kontak, online</a></li>
<li><a href="../id499904/index.html">"Saya ketakutan". Apa yang harus dilakukan?</a></li>
<li><a href="../id499906/index.html">Contoh penggunaan AR di industri mainan</a></li>
<li><a href="../id499910/index.html">Seimbang dalam pengambilan keputusan. Fork "pengalaman acak"</a></li>
<li><a href="../id499920/index.html">Trik Kecil SSH</a></li>
<li><a href="../id499922/index.html">Akhirnya kami berurusan dengan baud rate Modbus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>