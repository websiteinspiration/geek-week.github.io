<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¼â€ğŸ¤â€ğŸ‘¨ğŸ» ğŸ§¦ ğŸ‘©ğŸ¾â€ğŸŒ¾ ä½¿ç”¨ç²’å­ç³»ç»Ÿæ˜¾ç¤ºæ¸¸æˆå†…æ¶ˆæ¯ ğŸ™ŒğŸ¼ ğŸš­ ğŸ†”</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ä»»åŠ¡
 åœ¨å¼€å‘æ¸¸æˆThe Unlivingæ—¶ï¼Œæˆ‘ä»¬å°†è‡ªå·±çš„ä»»åŠ¡è®¾å®šä¸ºä½¿ç”¨ç²’å­ç³»ç»Ÿæ˜¾ç¤ºå„ç§æ¶ˆæ¯ï¼Œä¾‹å¦‚æ‰€é€ æˆçš„æŸå®³ï¼Œç¼ºä¹å¥åº·æˆ–ç²¾åŠ›ï¼Œå¥–åŠ±ä»·å€¼ï¼Œæ¢å¤çš„å¥åº·ç‚¹æ•°ç­‰ã€‚å†³å®šè¿™æ ·åšæ˜¯ä¸ºäº†è·å¾—æ›´å¤šçš„æœºä¼šæ¥å®šåˆ¶è¿™ç§æ¶ˆæ¯çš„å¤–è§‚æ•ˆæœå’Œè¿›ä¸€æ­¥çš„è¡Œä¸ºï¼Œè¿™åœ¨ä½¿ç”¨Unity UIç³»ç»Ÿçš„æ ‡å‡†å…ƒç´ æ—¶ä¼šå‡ºç°é—®é¢˜ã€‚
 
 æ­¤å¤–ï¼Œè¿™ç§æ–¹æ³•...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ä½¿ç”¨ç²’å­ç³»ç»Ÿæ˜¾ç¤ºæ¸¸æˆå†…æ¶ˆæ¯</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/486260/"><img src="https://habrastorage.org/getpro/habr/post_images/74b/904/6a5/74b9046a520d2199cfc062791bdc1cc5.jpg" alt="å›¾ç‰‡"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»»åŠ¡</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨å¼€å‘æ¸¸æˆThe Unlivingæ—¶ï¼Œæˆ‘ä»¬å°†è‡ªå·±çš„ä»»åŠ¡è®¾å®šä¸ºä½¿ç”¨ç²’å­ç³»ç»Ÿæ˜¾ç¤ºå„ç§æ¶ˆæ¯ï¼Œä¾‹å¦‚æ‰€é€ æˆçš„æŸå®³ï¼Œç¼ºä¹å¥åº·æˆ–ç²¾åŠ›ï¼Œå¥–åŠ±ä»·å€¼ï¼Œæ¢å¤çš„å¥åº·ç‚¹æ•°ç­‰ã€‚</font><font style="vertical-align: inherit;">å†³å®šè¿™æ ·åšæ˜¯ä¸ºäº†è·å¾—æ›´å¤šçš„æœºä¼šæ¥å®šåˆ¶è¿™ç§æ¶ˆæ¯çš„å¤–è§‚æ•ˆæœå’Œè¿›ä¸€æ­¥çš„è¡Œä¸ºï¼Œè¿™åœ¨ä½¿ç”¨Unity UIç³»ç»Ÿçš„æ ‡å‡†å…ƒç´ æ—¶ä¼šå‡ºç°é—®é¢˜ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­¤å¤–ï¼Œè¿™ç§æ–¹æ³•æ„å‘³ç€æ¯ç§æ¶ˆæ¯ç±»å‹ä»…ä½¿ç”¨ä¸€ä¸ªç²’å­ç³»ç»Ÿå®ä¾‹ï¼Œä¸ä½¿ç”¨Unity UIè¾“å‡ºç›¸åŒæ¶ˆæ¯ç›¸æ¯”ï¼Œç”Ÿäº§ç‡å¤§å¤§æé«˜ã€‚</font></font><br>
<a name="habracut"></a><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŸåæŠ¥å‘Š</font></font></b><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/597/961/b10/597961b10d0ca2e3e8fcd56c2cefb824.gif" alt="å›¾ç‰‡"></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çŸ­ä¿¡çŸ­ç¼º</font></font></b><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/79a/b45/e90/79ab45e904a5c648f9c62fb66a7c5049.gif" alt="å›¾ç‰‡"></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å†³ç­–ç®—æ³•</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½¿ç”¨ç€è‰²å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ­£ç¡®çš„UVåæ ‡æ˜¾ç¤ºé¢„å…ˆå‡†å¤‡çš„çº¹ç†ã€‚</font><font style="vertical-align: inherit;">å¸¦æœ‰UVåæ ‡çš„ä¿¡æ¯é€šè¿‡ä¸¤ä¸ªæµï¼ˆé¡¶ç‚¹æµï¼‰ä½¿ç”¨Vector4åˆ—è¡¨å½¢å¼çš„ParticleSystem.SetCustomParticleDataä¼ è¾“åˆ°ParticleSystemã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬çš„å®ç°æ¶‰åŠä½¿ç”¨åŒ…å«10è¡Œ10åˆ—å­—ç¬¦çš„çº¹ç†ã€‚</font><font style="vertical-align: inherit;">ä»»ä½•ç­‰å®½å­—ä½“éƒ½å¯ä»¥ç”¨ä½œå­—ä½“ã€‚</font><font style="vertical-align: inherit;">è¿™æ˜¯ä¸ºäº†é¿å…æ¶ˆæ¯å­—ç¬¦ä¹‹é—´çš„é—´è·ä¸åŒã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â†’ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PSDä¸­çš„çº¹ç†æº</font></font></a><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€æ­¥å®æ–½</font></font></h4><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ›å»ºVector4ä»¥ä¼ è¾“åˆ°é¡¶ç‚¹æµ</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ä¸ºäº†æè¿°å­—ç¬¦é›†ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨SymbolsTextureDataç»“æ„ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¿…é¡»æ‰‹åŠ¨å¡«å……charsæ•°ç»„ï¼Œé¡ºåºæ˜¯ä»å·¦ä¸Šè§’å¼€å§‹å‘å…¶æ·»åŠ æ‰€æœ‰å­—ä½“çº¹ç†ç¬¦å·ã€‚</font></font><br>
<br>
<pre><code class="cs hljs">[<span class="hljs-meta">Serializable</span>]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">struct</span> SymbolsTextureData<font></font>
{<font></font>
    <span class="hljs-comment">//   </span>
    <span class="hljs-keyword">public</span> Texture texture;
    <span class="hljs-comment">//    ,   - </span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">char</span>[] chars;<font></font>
    <font></font>
    <span class="hljs-comment">//Dictionary     -    </span>
    <span class="hljs-keyword">private</span> Dictionary&lt;<span class="hljs-keyword">char</span>, Vector2&gt; charsDict;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Initialize</span>(<span class="hljs-params"></span>)</span><font></font>
    {<font></font>
        charsDict = <span class="hljs-keyword">new</span> Dictionary&lt;<span class="hljs-keyword">char</span>, Vector2&gt;();
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; chars.Length; i++)<font></font>
        {<font></font>
            <span class="hljs-keyword">var</span> c = <span class="hljs-keyword">char</span>.ToLowerInvariant(chars[i]);
            <span class="hljs-keyword">if</span> (charsDict.ContainsKey(c)) <span class="hljs-keyword">continue</span>;
            <span class="hljs-comment">//  ,    </span>
            <span class="hljs-comment">//    , ,     10.</span>
            <span class="hljs-keyword">var</span> uv = <span class="hljs-keyword">new</span> Vector2(i % <span class="hljs-number">10</span>, <span class="hljs-number">9</span> - i / <span class="hljs-number">10</span>);<font></font>
            charsDict.Add(c, uv);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Vector2 <span class="hljs-title">GetTextureCoordinates</span>(<span class="hljs-params"><span class="hljs-keyword">char</span> c</span>)</span><font></font>
    {<font></font>
        c = <span class="hljs-keyword">char</span>.ToLowerInvariant(c);
        <span class="hljs-keyword">if</span> (charsDict == <span class="hljs-literal">null</span>) Initialize();<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (charsDict.TryGetValue(c, <span class="hljs-keyword">out</span> Vector2 texCoord))
            <span class="hljs-keyword">return</span> texCoord;
        <span class="hljs-keyword">return</span> Vector2.zero;<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç»“æœï¼Œæˆ‘ä»¬å¾—åˆ°äº†TextRendererParticleSystemç±»ã€‚</font><font style="vertical-align: inherit;">å½“æ‚¨è°ƒç”¨å…¬å…±SpawnParticleæ–¹æ³•æ—¶ï¼Œç²’å­ç³»ç»Ÿçš„ä¸€ä¸ªç²’å­å°†ç”Ÿæˆåˆ°å…·æœ‰æ‰€éœ€å€¼ï¼Œé¢œè‰²å’Œå¤§å°çš„æ‰€éœ€ä½ç½®ã€‚</font></font><br>
<br>
<pre><code class="cs hljs">[<span class="hljs-meta">RequireComponent(typeof(ParticleSystem))</span>]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">TextRendererParticleSystem</span> : <span class="hljs-title">MonoBehaviour</span><font></font>
{<font></font>
    <span class="hljs-keyword">private</span> ParticleSystemRenderer particleSystemRenderer;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">new</span> ParticleSystem particleSystem;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SpawnParticle</span>(<span class="hljs-params">Vector3 position, <span class="hljs-keyword">string</span> message, Color color, <span class="hljs-keyword">float</span>? startSize = <span class="hljs-literal">null</span></span>)</span><font></font>
    {<font></font>
        <span class="hljs-comment">//  </span><font></font>
     }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unityä¸­çš„ç²’å­ç³»ç»Ÿå…è®¸æ‚¨ä»¥2ä¸ªVector4æµçš„å½¢å¼ä¼ è¾“è‡ªå®šä¹‰æ•°æ®ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gw/bm/dc/gwbmdcxpmyhh2ogwebrz4i9qjjm.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬æœ‰æ„æ·»åŠ äº†é¢å¤–çš„UV2æµï¼Œä»¥é¿å…æµçš„åæ ‡å‘ç”Ÿåç§»ã€‚å¦‚æœä¸è¿™æ ·åšï¼Œåˆ™Cï¼ƒä¸­Custom1-vectorçš„Xå’ŒYåæ ‡å°†å¯¹åº”äºZå’ŒW TEXCOORD0ç€è‰²å™¨ã€‚å› æ­¤ï¼ŒCustom1.z = TEXCOORD1.xï¼ŒCustom1.w = TEXCOORD1.yã€‚å°†æ¥ä¼šå¸¦æ¥å¾ˆå¤šä¸ä¾¿ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/c5/re/vu/c5revuuurt5nlhhrtpj8qr4wqsu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚å‰æ‰€è¿°ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸¤ä¸ªVector4ä¼ è¾¾æ¶ˆæ¯çš„é•¿åº¦å’Œå­—ç¬¦çš„UVåæ ‡ã€‚ç”±äºVector4åŒ…å«4ä¸ªfloatç±»å‹çš„å…ƒç´ ï¼Œå› æ­¤é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å°†4 * 4 = 16å­—èŠ‚çš„æ•°æ®æ‰“åŒ…åˆ°å…¶ä¸­ã€‚å› ä¸ºç”±äºæˆ‘ä»¬çš„æ¶ˆæ¯ä»…åŒ…å«æ¶ˆæ¯é•¿åº¦ï¼ˆä¸¤ä½æ•°ï¼‰å’Œå­—ç¬¦åæ ‡ï¼ˆæ¯ä¸ªå­—ç¬¦ä¸¤ä½æ•°ï¼‰ï¼Œå› æ­¤å­—èŠ‚ç±»å‹ï¼ˆ0-255ï¼‰çš„èŒƒå›´å¯¹æˆ‘ä»¬æ¥è¯´æ˜¯å¤šä½™çš„ã€‚è™½ç„¶ä½¿ç”¨å°æ•°ä½ä¼šå¾ˆå¥½ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æµ®ç‚¹ç²¾åº¦ä¸º6-9ä¸ªå­—ç¬¦ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å®‰å…¨åœ°ä½¿ç”¨æ¯ä¸ªVector4åæ ‡çš„6ä½ï¼Œè€Œä¸å¿…æ‹…å¿ƒæ•°æ®çš„å®Œæ•´æ€§å’Œå‡†ç¡®æ€§ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬å°è¯•æ‰“åŒ…7ã€8å’Œ9ä¸ªå­—ç¬¦ï¼Œä½†æµ®ç‚¹ç²¾åº¦è¿˜ä¸å¤Ÿã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
äº‹å®è¯æ˜ï¼Œä¸å››ä¸ªå­—èŠ‚çš„æ ‡å‡†ç‰ˆæœ¬ç›¸æ¯”ï¼Œåœ¨æ¯ä¸ªæµ®ç‚¹æ•°ä¸­ï¼Œä½¿ç”¨å°æ•°ä½åï¼Œæˆ‘ä»¬å°†æ‰“åŒ…å¤šè¾¾6ä½æ•°å­—ã€‚</font><font style="vertical-align: inherit;">æ€»å…±ä¸€ä¸ªVector4å°†åŒ…å«24ä¸ªä¸ªä½æ•°ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å¯ä»¥åœ¨æµä¸­ä¼ è¾“2ä¸ªçŸ¢é‡ï¼Œå› æ­¤æˆ‘ä»¬å°†åŒæ—¶ä½¿ç”¨è¿™ä¸¤ä¸ªçŸ¢é‡æ¥ä¼ è¾“æœ€é•¿23 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ªå­—ç¬¦çš„æ¶ˆæ¯</font><font style="vertical-align: inherit;">ï¼š</font><font style="vertical-align: inherit;">Custom1.xyzw-æ¶ˆæ¯çš„å‰12ä¸ªå­—ç¬¦ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Custom2.xyzw-æ¶ˆæ¯çš„å¦å¤–11ä¸ªå­—ç¬¦+æ¶ˆæ¯çš„é•¿åº¦ï¼ˆæœ€å2ä¸ªå­—ç¬¦ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¾‹å¦‚ï¼Œæ¶ˆæ¯â€œ Helloâ€å°†å¦‚ä¸‹æ‰€ç¤ºã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/g3/nm/tj/g3nmtjvqme40jjcrw-ear7hwnoo.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å­—ç¬¦åæ ‡å¯¹åº”äºçº¹ç†ä¸­çš„åˆ—å·å’Œå­—ç¬¦ä½ç½®çº¿ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/47/9h/d6/479hd6qetusenhgjdafodmsgk7u.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨ä»£ç ä¸­ï¼Œå°†å­—ç¬¦ä¸²åŒ…è£…åœ¨ä¸¤ä¸ªVector4ä¸­å°†å¦‚ä¸‹æ‰€ç¤ºï¼š</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-comment">//   Vector2     float</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">float</span> <span class="hljs-title">PackFloat</span>(<span class="hljs-params">Vector2[] vecs</span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">if</span> (vecs == <span class="hljs-literal">null</span> || vecs.Length == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;            
    <span class="hljs-comment">//      float</span>
    <span class="hljs-keyword">var</span> result = vecs[<span class="hljs-number">0</span>].y * <span class="hljs-number">10000</span> + vecs[<span class="hljs-number">0</span>].x * <span class="hljs-number">100000</span>;
    <span class="hljs-keyword">if</span> (vecs.Length &gt; <span class="hljs-number">1</span>) result += vecs[<span class="hljs-number">1</span>].y * <span class="hljs-number">100</span> + vecs[<span class="hljs-number">1</span>].x * <span class="hljs-number">1000</span>;
    <span class="hljs-keyword">if</span> (vecs.Length &gt; <span class="hljs-number">2</span>) result += vecs[<span class="hljs-number">2</span>].y + vecs[<span class="hljs-number">2</span>].x * <span class="hljs-number">10</span>;            
        <span class="hljs-keyword">return</span> result;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//  Vector4    CustomData</span>
<span class="hljs-function"><span class="hljs-keyword">private</span> Vector4 <span class="hljs-title">CreateCustomData</span>(<span class="hljs-params">Vector2[] texCoords, <span class="hljs-keyword">int</span> offset = <span class="hljs-number">0</span></span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">var</span> data = Vector4.zero;            
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++)<font></font>
    {<font></font>
        <span class="hljs-keyword">var</span> vecs = <span class="hljs-keyword">new</span> Vector2[<span class="hljs-number">3</span>];                
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">3</span>; j++)<font></font>
        {<font></font>
            <span class="hljs-keyword">var</span> ind = i * <span class="hljs-number">3</span> + j + offset;
            <span class="hljs-keyword">if</span> (texCoords.Length &gt; ind)<font></font>
            {<font></font>
                vecs[j] = texCoords[ind];<font></font>
            }<font></font>
            <span class="hljs-keyword">else</span><font></font>
            {<font></font>
                data[i] = PackFloat(vecs);<font></font>
                i = <span class="hljs-number">5</span>; 
                <span class="hljs-keyword">break</span>;<font></font>
            }<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (i &lt; <span class="hljs-number">4</span>) data[i] = PackFloat(vecs);<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> data;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//    </span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SpawnParticle</span>(<span class="hljs-params">Vector3 position, <span class="hljs-keyword">string</span> message, Color color, <span class="hljs-keyword">float</span>? startSize = <span class="hljs-literal">null</span></span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">var</span> texCords = <span class="hljs-keyword">new</span> Vector2[<span class="hljs-number">24</span>]; <span class="hljs-comment">//  24  - 23  +  </span>
    <span class="hljs-keyword">var</span> messageLenght = Mathf.Min(<span class="hljs-number">23</span>, message.Length);<font></font>
    texCords[texCords.Length - <span class="hljs-number">1</span>] = <span class="hljs-keyword">new</span> Vector2(<span class="hljs-number">0</span>, messageLenght);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; texCords.Length; i++)<font></font>
    {<font></font>
        <span class="hljs-keyword">if</span> (i &gt;= messageLenght) <span class="hljs-keyword">break</span>;
        <span class="hljs-comment">//  GetTextureCoordinates()  SymbolsTextureData    </span><font></font>
        texCords[i] = textureData.GetTextureCoordinates(message[i]);<font></font>
    }<font></font>
		<font></font>
    <span class="hljs-keyword">var</span> custom1Data = CreateCustomData(texCords);
    <span class="hljs-keyword">var</span> custom2Data = CreateCustomData(texCords, <span class="hljs-number">12</span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‡†å¤‡å¥½CustomDataçš„å‘é‡ã€‚</font><font style="vertical-align: inherit;">ç°åœ¨è¯¥æ‰‹åŠ¨ç”Ÿæˆå…·æœ‰æ‰€éœ€å‚æ•°çš„æ–°ç²’å­äº†ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç²’å­</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ç”Ÿæˆæˆ‘ä»¬éœ€è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯ç¡®ä¿åœ¨ç²’å­ç³»ç»Ÿçš„â€œæ¸²æŸ“å™¨â€è®¾ç½®ä¸­æ¿€æ´»CustomDataæµï¼š</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-comment">//   ParticleSystem</span>
<span class="hljs-keyword">if</span> (particleSystem == <span class="hljs-literal">null</span>) particleSystem = GetComponent&lt;ParticleSystem&gt;();<font></font>
<font></font>
<span class="hljs-keyword">if</span> (particleSystemRenderer == <span class="hljs-literal">null</span>)<font></font>
{<font></font>
    <span class="hljs-comment">//   ParticleSystemRenderer,       </span><font></font>
    particleSystemRenderer = particleSystem.GetComponent&lt;ParticleSystemRenderer&gt;();<font></font>
    <span class="hljs-keyword">var</span> streams = <span class="hljs-keyword">new</span> List&lt;ParticleSystemVertexStream&gt;();<font></font>
    particleSystemRenderer.GetActiveVertexStreams(streams);<font></font>
    <span class="hljs-comment">//   Vector2(UV2, SizeXY, etc.),        </span>
    <span class="hljs-keyword">if</span> (!streams.Contains(ParticleSystemVertexStream.UV2)) streams.Add(ParticleSystemVertexStream.UV2);
    <span class="hljs-keyword">if</span> (!streams.Contains(ParticleSystemVertexStream.Custom1XYZW)) streams.Add(ParticleSystemVertexStream.Custom1XYZW);
    <span class="hljs-keyword">if</span> (!streams.Contains(ParticleSystemVertexStream.Custom2XYZW)) streams.Add(ParticleSystemVertexStream.Custom2XYZW);<font></font>
    particleSystemRenderer.SetActiveVertexStreams(streams);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦åˆ›å»ºç²’å­ï¼Œæˆ‘ä»¬ä½¿ç”¨ParticleSystemç±»çš„Emitï¼ˆï¼‰æ–¹æ³•ã€‚</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-comment">//  </span>
<span class="hljs-comment">//      </span>
<span class="hljs-comment">// startSize3D  X,       </span>
<span class="hljs-comment">//   </span>
<span class="hljs-keyword">var</span> emitParams = <span class="hljs-keyword">new</span> ParticleSystem.EmitParams<font></font>
{<font></font>
    startColor = color,<font></font>
    position = position,<font></font>
    applyShapeToPosition = <span class="hljs-literal">true</span>,<font></font>
    startSize3D = <span class="hljs-keyword">new</span> Vector3(messageLenght, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<font></font>
};<font></font>
<span class="hljs-comment">//      ,    SpawnParticle </span>
<span class="hljs-comment">//   startSize</span>
<span class="hljs-keyword">if</span> (startSize.HasValue) emitParams.startSize3D *= startSize.Value * particleSystem.main.startSizeMultiplier;
<span class="hljs-comment">//  </span>
particleSystem.Emit(emitParams, <span class="hljs-number">1</span>);<font></font>
<font></font>
<span class="hljs-comment">//     </span>
<span class="hljs-keyword">var</span> customData = <span class="hljs-keyword">new</span> List&lt;Vector4&gt;();
<span class="hljs-comment">//  ParticleSystemCustomData.Custom1  ParticleSystem</span><font></font>
particleSystem.GetCustomParticleData(customData, ParticleSystemCustomData.Custom1);<font></font>
<span class="hljs-comment">//   , ..  ,     </span>
customData[customData.Count - <span class="hljs-number">1</span>] = custom1Data;
<span class="hljs-comment">//   ParticleSystem</span><font></font>
particleSystem.SetCustomParticleData(customData, ParticleSystemCustomData.Custom1);<font></font>
<font></font>
<span class="hljs-comment">//  ParticleSystemCustomData.Custom2</span><font></font>
particleSystem.GetCustomParticleData(customData, ParticleSystemCustomData.Custom2);            <font></font>
customData[customData.Count - <span class="hljs-number">1</span>] = custom2Data;<font></font>
particleSystem.SetCustomParticleData(customData, ParticleSystemCustomData.Custom2);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°†ä¸¤ä¸ªå—éƒ½æ·»åŠ åˆ°SpawnParticleï¼ˆï¼‰æ–¹æ³•ä¸­ï¼ŒCï¼ƒéƒ¨åˆ†å‡†å¤‡å°±ç»ªï¼šæ¶ˆæ¯åœ¨GPUä¸­ä»¥Vertex Streamä¸­ä¸¤ä¸ªVector4çš„å½¢å¼æ‰“åŒ…å’Œä¼ è¾“ã€‚</font><font style="vertical-align: inherit;">å‰©ä¸‹çš„æœ€æœ‰è¶£çš„äº‹æƒ…æ˜¯æ¥å—æ­¤æ•°æ®å¹¶æ­£ç¡®æ˜¾ç¤ºå®ƒã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç€è‰²å™¨ä»£ç </font></font></b><br>
<br>
<pre><code class="plaintext hljs">Shader "Custom/TextParticles"<font></font>
{<font></font>
    Properties<font></font>
    {<font></font>
        _MainTex ("Texture", 2D) = "white" {}<font></font>
        //         10,    <font></font>
        _Cols ("Columns Count", Int) = 10<font></font>
        _Rows ("Rows Count", Int) = 10<font></font>
    }<font></font>
    SubShader<font></font>
    {            <font></font>
        Tags { "RenderType"="Opaque" "PreviewType"="Plane" "Queue" = "Transparent+1"}<font></font>
        LOD 100<font></font>
        ZWrite Off<font></font>
        Blend SrcAlpha OneMinusSrcAlpha<font></font>
<font></font>
        Pass<font></font>
        {<font></font>
            CGPROGRAM<font></font>
            #pragma vertex vert<font></font>
            #pragma fragment frag<font></font>
            <font></font>
            #include "UnityCG.cginc"<font></font>
            <font></font>
            struct appdata<font></font>
            {<font></font>
                float4 vertex : POSITION;<font></font>
                fixed4 color : COLOR;<font></font>
                float4 uv : TEXCOORD0;<font></font>
                //    customData<font></font>
                float4 customData1 : TEXCOORD1;<font></font>
                float4 customData2 : TEXCOORD2;<font></font>
            };           <font></font>
<font></font>
            struct v2f<font></font>
            {<font></font>
                float4 vertex : SV_POSITION;<font></font>
                fixed4 color : COLOR;<font></font>
                float4 uv : TEXCOORD0;<font></font>
                float4 customData1 : TEXCOORD1;<font></font>
                float4 customData2 : TEXCOORD2;<font></font>
            };<font></font>
            <font></font>
            uniform sampler2D _MainTex;<font></font>
            uniform uint _Cols;<font></font>
            uniform uint _Rows;<font></font>
            <font></font>
            v2f vert (appdata v)<font></font>
            {<font></font>
                v2f o;<font></font>
                //        w- ?<font></font>
                //       .<font></font>
                //      100.<font></font>
                float textLength = ceil(fmod(v.customData2.w, 100));<font></font>
<font></font>
                o.vertex = UnityObjectToClipPos(v.vertex);<font></font>
                //  UV ,   -   <font></font>
                o.uv.xy = v.uv.xy * fixed2(textLength / _Cols, 1.0 / _Rows);<font></font>
                o.uv.zw = v.uv.zw;<font></font>
                o.color = v.color;                <font></font>
                o.customData1 = floor(v.customData1);<font></font>
                o.customData2 = floor(v.customData2);<font></font>
                return o;<font></font>
            }<font></font>
            <font></font>
            fixed4 frag (v2f v) : SV_Target<font></font>
            {<font></font>
                fixed2 uv = v.uv.xy;<font></font>
                //   <font></font>
                uint ind = floor(uv.x * _Cols);<font></font>
<font></font>
                uint x = 0;<font></font>
                uint y = 0;<font></font>
<font></font>
                //  ,   <font></font>
                //0-3 - customData1<font></font>
                //4-7 - customData2<font></font>
                uint dataInd = ind / 3;<font></font>
                //   6     float<font></font>
                uint sum = dataInd &lt; 4 ? v.customData1[dataInd] : v.customData2[dataInd - 4];<font></font>
<font></font>
                //  float      <font></font>
                for(int i = 0; i &lt; 3; ++i)<font></font>
                {<font></font>
                    if (dataInd &gt; 3 &amp; i == 3) break;<font></font>
                    //  ,   10^2 = 99  ..<font></font>
                    uint val = ceil(pow(10, 5 - i * 2));<font></font>
                    x = sum / val;<font></font>
                    sum -= x * val;<font></font>
<font></font>
                    val = ceil(pow(10, 4 - i * 2));<font></font>
                    y = sum / val;<font></font>
                    sum -= floor(y * val);<font></font>
<font></font>
                    if (dataInd * 3 + i == ind) i = 3;<font></font>
                }                <font></font>
<font></font>
                float cols = 1.0 / _Cols;<font></font>
                float rows = 1.0 / _Rows;<font></font>
                // UV-,  - , , <font></font>
                //     <font></font>
                uv.x += x * cols - ind * rows;<font></font>
                uv.y += y * rows;<font></font>
                <font></font>
                return tex2D(_MainTex, uv.xy) * v.color;<font></font>
            }<font></font>
            ENDCG<font></font>
        }<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unityç¼–è¾‘å™¨</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
åˆ›å»ºæè´¨å¹¶å°†å…¶åˆ†é…ç»™æˆ‘ä»¬çš„ç€è‰²å™¨ã€‚</font><font style="vertical-align: inherit;">åœ¨åœºæ™¯ä¸­ï¼Œä½¿ç”¨ParticleSystemç»„ä»¶åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œåˆ†é…åˆ›å»ºçš„æè´¨ã€‚</font><font style="vertical-align: inherit;">ç„¶åï¼Œæˆ‘ä»¬è°ƒæ•´ç²’å­è¡Œä¸ºå¹¶å…³é—­â€œå”¤é†’æ—¶æ’­æ”¾â€å‚æ•°ã€‚</font><font style="vertical-align: inherit;">ä»ä»»ä½•ç±»ä¸­ï¼Œæˆ‘ä»¬éƒ½è°ƒç”¨RendererParticleSystem.SpawnParticleï¼ˆï¼‰æ–¹æ³•æˆ–ä½¿ç”¨è®¨ä»·è¿˜ä»·æ–¹æ³•ã€‚</font></font><br>
<br>
<pre><code class="cs hljs">[<span class="hljs-meta">ContextMenu(<span class="hljs-meta-string">"TestText"</span>)</span>]
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">TestText</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    SpawnParticle(transform.position, <span class="hljs-string">"Hello world!"</span>, Color.red);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æºä»£ç ï¼Œèµ„æºå’Œç”¨æ³•ç¤ºä¾‹å¯ä»¥åœ¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­¤å¤„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰¾åˆ°</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¶ˆæ¯ç³»ç»Ÿåœ¨è¿è¡Œ</font></font></b><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f8d/91e/a20/f8d91ea20610d787563e72398802cccd.gif" alt="å›¾ç‰‡"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°±è¿™æ ·ã€‚</font><font style="vertical-align: inherit;">ä½¿ç”¨ç²’å­ç³»ç»Ÿçš„æ¶ˆæ¯è¾“å‡ºå°±ç»ªï¼</font><font style="vertical-align: inherit;">æˆ‘ä»¬å¸Œæœ›è¯¥è§£å†³æ–¹æ¡ˆå°†ä½¿Unityæ¸¸æˆå¼€å‘äººå‘˜å—ç›Šã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPDï¼šæè®®çš„è§£å†³æ–¹æ¡ˆçš„æ€§èƒ½</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
åœ¨ä¸€äº›äººçš„è¯„è®ºä¸­ï¼Œäººä»¬å¯¹è¯¥æ–¹æ³•çš„æ€§èƒ½äº§ç”Ÿäº†ç–‘é—®ã€‚</font><font style="vertical-align: inherit;">ç”±è”åˆåˆ†æå™¨ä¸“é—¨è¿›è¡Œçš„æµ‹é‡ã€‚</font><font style="vertical-align: inherit;">æ¡ä»¶æ˜¯ç›¸åŒçš„-1000ä¸ªç§»åŠ¨çš„å˜è‰²å¯¹è±¡ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½¿ç”¨æ ‡å‡†UIï¼ˆå”¯ä¸€çš„ç”»å¸ƒä¸Šåªæœ‰1000ä¸ªUIæ–‡æœ¬å¯¹è±¡ï¼‰çš„ç»“æœï¼š</font></font><br>
<img src="https://habrastorage.org/webt/p6/un/5f/p6un5fkfn-qnhmz6uwusisggwsq.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ€»å¸§æ—¶é—´è‡³å°‘ä¸º50msï¼Œå…¶ä¸­40msç”¨äºæ›´æ–°ç”»å¸ƒã€‚</font><font style="vertical-align: inherit;">åŒæ—¶ï¼Œå¯¹è±¡ç”šè‡³ä¸ä¼šç”Ÿæˆï¼Œè€Œåªæ˜¯ç§»åŠ¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½¿ç”¨æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆç”Ÿæˆ1000ä¸ªç²’å­çš„ç»“æœï¼š</font></font><br>
<img src="https://habrastorage.org/webt/-p/bf/ga/-pbfga8pj7nj5oi7sssvu9ch9pw.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‰€æœ‰é­”æœ¯éƒ½å‘ç”Ÿåœ¨GPUä¸Šï¼Œå³ä½¿åœ¨ç”Ÿæˆ1000ä¸ªç²’å­æ—¶ï¼Œè¯¥å¸§çš„è®¡ç®—æ—¶é—´ä¹Ÿä¸åˆ°5æ¯«ç§’ã€‚</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN486260/">https://habr.com/ru/post/zh-CN486260/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN486242/index.html">Pinebook Proï¼šä¸ªäººç¬”è®°æœ¬ç”µè„‘ä½“éªŒ</a></li>
<li><a href="../zh-CN486246/index.html">ç”¨Pythonç¼–å†™ä¸€æ¬¡æ€§å‰ªè´´ç°¿æœåŠ¡</a></li>
<li><a href="../zh-CN486252/index.html">å¦‚æœåŠ é€Ÿä¸€å€åŠä¼šæ€æ ·ï¼Ÿ</a></li>
<li><a href="../zh-CN486256/index.html">ç”µå­èº«ä»½è¯</a></li>
<li><a href="../zh-CN486258/index.html">Pindastrialå±è”½-Raspberry PIçš„ç”µæºå’ŒRS-485æ¥å£æ¨¡å—</a></li>
<li><a href="../zh-CN486262/index.html">5Gç½‘ç»œæ¼æ´</a></li>
<li><a href="../zh-CN486264/index.html">PostgreSQL 13ï¼šå¹¶è¡ŒVACUUM</a></li>
<li><a href="../zh-CN486268/index.html">Rust 1.41.0ç‰ˆæœ¬ï¼šFFIä¸­Box <T>çš„æ–°ä¿è¯ï¼Œè´§ç‰©å®‰è£…çš„æ”¹è¿›ï¼Œç‰¹å¾çš„å®½æ¾</a></li>
<li><a href="../zh-CN486274/index.html">åœ¨å¸‚åœºå¯¹ä¼Šæœ—å’Œç¾å›½ä¹‹é—´çš„å†²çªåšå‡ºååº”ä¹‹åï¼Œæ¯”ç‰¹å¸æ˜¯å¦è¢«è§†ä¸ºå®‰å…¨èµ„äº§ï¼Ÿ</a></li>
<li><a href="../zh-CN486278/index.html">Kafka mitapçš„ææ–™ï¼šĞ¡DCè¿æ¥å™¨ï¼Œå¢é•¿é—®é¢˜ï¼ŒKubernetes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>