<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧓🏽 🥘 🤷🏻 oVirt在2小时内。第4部分。基本操作 🔢 🤩 ㊗️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="今天，我们研究了虚拟化环境的管理员通常需要执行的许多基本操作。本文是oVirt系列文章的继续：第1 部分，第2 部分和第3部分：
 
 内容
 

- 创建VM和模板 ;
- VM迁移（实时迁移）；
- 存储迁移（storage migration）；
- 重命名VM和磁盘 ;
- 更新oVirt-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>oVirt在2小时内。第4部分。基本操作</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/503192/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">今天，我们研究了虚拟化环境的管理员通常需要执行的许多基本操作。</font><font style="vertical-align: inherit;">本文是oVirt系列文章的继续：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第1 </font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">第2 </font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">第3部分</font></a><font style="vertical-align: inherit;">：</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内容</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建VM和模板</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VM迁移</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（实时迁移）；</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存储迁移</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（storage migration）；</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重命名VM和磁盘</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新oVirt-Host</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（系统管理程序）；</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新oVirt-Engine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（经理）；</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">导入VM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">任务管理</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
</ul><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文章</font></font></h2><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装管理器（ovirt引擎）和管理程序（主机） </font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其他设置</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基本操作-我们在这里</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
传统上，有关管理任务的详细信息，请访问</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
输入oVirt时，您将看到2个门户：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行政门户</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">虚拟机门户</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第一个用于管理员和管理任务，第二个-用于计算机的客户，但也可以由管理员使用-某些功能在那里更加方便。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
每个oVirt对象集合的窗口顶部都有一个功能强大的搜索框，其中包含上下文提示。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例如，在控制面板中选择问题主机实际上会导致过滤器：</font></font><br>
<br>
<pre><code class="plaintext hljs">status = unassigned or status = maintenance or status = installing or status = reboot or status = preparingformaintenance or status = pendingapproval or status = connecting or status = installingos or status = kdumping</code></pre><br>
<a name="vm-pool"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建虚拟机和模板</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我想您已经在第2部分中创建了一个简单的VM，现在我们将了解与虚拟机直接相关的其他oVirt实体-虚拟机本身，模板和池。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模板</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是设计用于创建相同计算机（克隆）的计算机（通常是预先准备好的）的副本。模板可能有版本，很方便，因为每次更新参考计算机后，无需制作新的单独模板。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档中有</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更多详细信息</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">池</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是从单个模板生成的一组相同的计算机。当数十或数百个用户需要提供相同的工作环境时，此功能非常方便，而VDI（虚拟桌面基础结构）只需眨眼就能完成。在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阅读有关池的更多信息</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们创建一个模板，我们可以为其克隆一个先前创建的机器，但是为了进行演示，我们将采用另一种方法-从外部集合中导入模板Glance Images：存储-&gt;域-&gt; ovirt-image-repository（1），导入（2）：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fx/gg/lt/fxggltgss5p9llxyplgghxmpbsg.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。 1-导入Fedora 32图像</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
我们标记“导入为模板”（3，导入为模板），为模板命名（4）。强烈建议给磁盘起一个友好的名称（5，磁盘别名）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在“ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">任务”</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分可以方便地监视任务的进度</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cj/p6/co/cjp6cor50gw2euzkgnf_vl-lc24.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。 2-在oVirt中完成任务的进度。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
成功上传后，模板将添加到列表中。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cg/_n/o3/cg_no3kzfukaodkzouox0q2bt3q.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。 3-模板。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
根据加载的模板，创建一个池：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fn/qk/aj/fnqkajhsx4hrbzr_wc8jozs9zua.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。 4-创建一个池。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
转到计算-&gt;池（1），新建（2），选择Fedora32（3）模板，版本-最新（4），分配名称“ myPoolA- ??”。 （5）。我们尚未触摸“虚拟机数量”和“预启动虚拟机”字段，我们将在下一步中返回到它们。接下来，打开高级设置（6），然后继续设置“初始运行”。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zx/m5/dj/zxm5djt-ud05hne1hyahor2nluo.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。 4-配置初始启动。</font></font><br>
</i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因为从Glance Images下载了Cloud Image，我们需要配置身份验证。检查是否已启用“使用Cloud-Init / Sysprep”（1），打开身份验证（2），指定用户名，例如root或user（3）。要为池创建唯一的密码，请禁用“使用已配置的密码”（4），然后输入密码（5）。单击“确定”-创建池，相同的计算机出现在“计算”-&gt;“虚拟机”中（请注意其图标，它不同于单独运行的计算机）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意池的名称。正如您所注意到的，最后是“-??”。这包括机器的“归一化”编号（由0补充-01、02，...，09、10等），否则，编号将是不对齐的自然数（1、2，...，9、10， ...）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在继续之前，让我们回到池设置。</font><font style="vertical-align: inherit;">请注意，“虚拟机数量”字段已更改为“增加池中的虚拟机数量”。</font><font style="vertical-align: inherit;">我们在此处指定31，并且池中的计算机数几乎立即变为32。现在，在“ Prestarted VM”字段中，我们输入16-这将强制oVirt保持指定数目的计算机预先启动并准备连接用户。</font><font style="vertical-align: inherit;">在这里，我们将完成有关机器，模板和池的工作，然后继续进行迁移。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
关键VM图标：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">机架单元-服务器；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">显示器-桌面；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3个塔-池中的服务器；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3个监视器-池中的桌面；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">倒带（倒带）-无状态（计算机在关闭后将其状态重置为原始状态；所有更改都会回滚）；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">橙色监视器中的三角形-要求的配置更改需要重新启动。</font></font></li>
</ul><br>
<a name="live-migration"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VM迁移（实时迁移）</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
迁移已打开计算机的状态很简单-右键单击一台计算机或一组计算机。</font><font style="vertical-align: inherit;">该过程与vSphere中的vMotion相似。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zm/ne/dz/zmnedzcid6vyhsgubvv95u6cnsy.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。</font><font style="vertical-align: inherit;">5-开始迁移。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
计算-&gt;虚拟机，选择一台或多台计算机，进行迁移。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8v/bp/9h/8vbp9hslgmoa_n_v3ltlmuxfknw.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。</font><font style="vertical-align: inherit;">6-可以在主机（计算-&gt;主机）中观察迁移过程。</font></font><br>
</i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一次最多只能行驶2辆汽车。</font></font><br>
<a name="storage-migration"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存储迁移</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是此过程对于VMware vSphere用户而言似乎很不寻常，因为 </font><font style="vertical-align: inherit;">在系统中存储磁盘映像和计算机配置的方法不同。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要传输VM存储，请转到磁盘（存储-&gt;磁盘）或域（存储-&gt;域-&gt; </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{域名}</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -&gt;磁盘）。</font><font style="vertical-align: inherit;">选择驱动器，然后按</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">移动</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">就是这样，将驱动器发送到另一个存储。</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意：由于内部组织的原因，迁移模板存储库和池存在一些限制。</font><font style="vertical-align: inherit;">熟悉存储迁移最好在池外的单独计算机上完成。</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
磁盘复制在与手动加载/卸载相同的菜单中执行。</font></font><br>
<a name="rename"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重命名VM和磁盘</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
更改计算机或模板的名称非常简单-编辑并输入新名称。</font><font style="vertical-align: inherit;">重命名池需要删除其计算机并重新创建它，因为 </font><font style="vertical-align: inherit;">基于此，将使用相应的名称和配置生成VM。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
也可以重命名磁盘，但是路径比</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
e长：计算-&gt;虚拟机-&gt; {VM名称}-&gt;磁盘-&gt; {VM磁盘别名}-&gt;编辑，别名。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
内部对象标识符基于UUID。</font><font style="vertical-align: inherit;">重命名时，我们实际上会更改别名。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
本部分介绍当版本号更改时的更新，即更新（次要）而不是升级（主要）（这是一个更复杂的过程，不属于日常任务）。</font></font><br>
<a name="update-host"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新oVirt-Host（系统管理程序）</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
主机更新比vSphere中的更新简单，oVirt中的更新管理器已有机地集成到平台中，不需要任何设置。官方</font><font style="vertical-align: inherit;">更新</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fj/we/j1/fjwej1ph06a03bqpfx2ye6ijeny.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。 7-如果有更新，管理员将使用CD图标进行报告。</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/ww/vw/rn/wwvwrnz9q9hizaqo3mfndfihp_m.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。 8-开始更新之前，您需要启用维护模式（管理-&gt;维护），它将自动开始将VM迁移到其他主机（请参见图6）并为更新做准备。</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/ol/ry/fw/olryfwdduor2j39tr47n8zlnpew.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。 9-扳手图标指示主机已准备就绪，可以维修了。</font></font><br>
</i><br>
<img src="https://habrastorage.org/webt/ov/rt/ta/ovrttawkmmi6fkfp-wic5_mpy00.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。 10-安装-&gt;升级开始升级过程。</font></font><br>
</i><br>
<img src="https://habrastorage.org/webt/8z/ch/7s/8zch7sdgo_plq5suw8yevk8nzz8.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。 11-我们可以要求管理器向主机发出命令，使其在更新完成后重新启动，以使其生效。</font></font><br>
</i><br>
<img src="https://habrastorage.org/webt/ze/dg/kb/zedgkbmmuxxm7kvy6qoxhh-bvza.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。</font><font style="vertical-align: inherit;">12-重新引导后，我们使虚拟机管理程序退出服务模式（管理-&gt;激活）。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们浏览所有主机并更新它们。</font></font><br>
<a name="update-engine"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新oVirt-Engine（经理）</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
首先，这可能会造成混淆，但是如</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所述，使用引擎设置执行管理器更新以及其他步骤</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果可能，请对计算机进行存档或快照，请确保上次计划的备份成功。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们检查并更新安装软件包：</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo engine-upgrade-check<font></font>
$ sudo update ovirt\*setup\*</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新的主要部分由引擎设置程序执行。</font><font style="vertical-align: inherit;">她将询问许多配置问题，然后停止ovirt-engine服务，下载并安装更新的软件包，创建档案并更新数据库，应用更新的配置，然后启动ovirt-engine服务。</font></font><br>
 <br>
<pre><code class="bash hljs">$ sudo engine-setup</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 成功更新后，我们将收到以下消息：</font></font><br>
 <br>
<pre><code class="plaintext hljs">Execution of setup completed successfully</code></pre><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">引擎设置脚本的示例输出</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">$ sudo engine-setup</code></pre><br>
<pre><code class="plaintext hljs">[ INFO  ] Stage: Initializing<font></font>
[ INFO  ] Stage: Environment setup<font></font>
          Configuration files: ['/etc/ovirt-engine-setup.conf.d/10-packaging-jboss.conf', '/etc/ovirt-engine-setup.conf.d/10-packaging.conf', '/etc/ovirt-engine-setup.conf.d/20-setup-ovirt-post.conf']<font></font>
          Log file: /var/log/ovirt-engine/setup/ovirt-engine-setup-20200522232449-o97vyx.log<font></font>
          Version: otopi-1.8.2 (otopi-1.8.2-1.el7)<font></font>
[ INFO  ] Stage: Environment packages setup<font></font>
[ INFO  ] Stage: Programs detection<font></font>
[ INFO  ] Stage: Environment setup (late)<font></font>
[ INFO  ] Stage: Environment customization<font></font>
         <font></font>
          --== PRODUCT OPTIONS ==--<font></font>
         <font></font>
         <font></font>
          --== PACKAGES ==--<font></font>
         <font></font>
[ INFO  ] Checking for product updates...<font></font>
          Setup needs to install or update the following packages:<font></font>
          [updated] ovirt-engine-4.3.5.5-1.el7.noarch will be updated<font></font>
...<font></font>
          [update] ovirt-engine-wildfly-overlay-17.0.1-1.el7.noarch is an update<font></font>
          Replying "No" will abort Setup. You can pass the option "--offline" to prevent installing or updating packages.<font></font>
          Do you wish to update them now? (Yes, No) [Yes]: <font></font>
[ INFO  ] Checking for an update for Setup...<font></font>
         <font></font>
          --== NETWORK CONFIGURATION ==--<font></font>
         <font></font>
          Setup can automatically configure the firewall on this system.<font></font>
          Note: automatic configuration of the firewall may overwrite current settings.<font></font>
          NOTICE: iptables is deprecated and will be removed in future releases<font></font>
          Do you want Setup to configure the firewall? (Yes, No) [Yes]: <font></font>
[ INFO  ] firewalld will be configured as firewall manager.<font></font>
         <font></font>
          --== DATABASE CONFIGURATION ==--<font></font>
         <font></font>
          The detected DWH database size is 439 MB.<font></font>
          Setup can backup the existing database. The time and space required for the database backup depend on its size. This process takes time, and in some cases (for instance, when the size is few GBs) may take several hours to complete.<font></font>
          If you choose to not back up the database, and Setup later fails for some reason, it will not be able to restore the database and all DWH data will be lost.<font></font>
          Would you like to backup the existing database before upgrading it? (Yes, No) [Yes]: <font></font>
          Perform full vacuum on the oVirt engine history<font></font>
          database ovirt_engine_history@localhost?<font></font>
          This operation may take a while depending on this setup health and the<font></font>
          configuration of the db vacuum process.<font></font>
          See https://www.postgresql.org/docs/10/sql-vacuum.html<font></font>
          (Yes, No) [No]: <font></font>
         <font></font>
          --== OVIRT ENGINE CONFIGURATION ==--<font></font>
         <font></font>
          Perform full vacuum on the engine database engine@localhost?<font></font>
          This operation may take a while depending on this setup health and the<font></font>
          configuration of the db vacuum process.<font></font>
          See https://www.postgresql.org/docs/10/sql-vacuum.html<font></font>
          (Yes, No) [No]: <font></font>
         <font></font>
          --== STORAGE CONFIGURATION ==--<font></font>
         <font></font>
         <font></font>
          --== PKI CONFIGURATION ==--<font></font>
         <font></font>
         <font></font>
          --== APACHE CONFIGURATION ==--<font></font>
         <font></font>
         <font></font>
          --== SYSTEM CONFIGURATION ==--<font></font>
         <font></font>
         <font></font>
          --== MISC CONFIGURATION ==--<font></font>
         <font></font>
         <font></font>
          --== END OF CONFIGURATION ==--<font></font>
         <font></font>
[ INFO  ] Stage: Setup validation<font></font>
          During execution engine service will be stopped (OK, Cancel) [OK]: <font></font>
[ INFO  ] Cleaning stale zombie tasks and commands<font></font>
         <font></font>
          --== CONFIGURATION PREVIEW ==--<font></font>
         <font></font>
          Default SAN wipe after delete           : False<font></font>
          Firewall manager                        : firewalld<font></font>
          Update Firewall                         : True<font></font>
          Host FQDN                               : ovirt.example.com<font></font>
          Upgrade packages                        : True<font></font>
          Set up Cinderlib integration            : False<font></font>
          Engine database secured connection      : False<font></font>
          Engine database user name               : engine<font></font>
          Engine database name                    : engine<font></font>
          Engine database host                    : localhost<font></font>
          Engine database port                    : 5432<font></font>
          Engine database host name validation    : False<font></font>
          Engine installation                     : True<font></font>
          PKI organization                        : JSC Open Lab<font></font>
          Set up ovirt-provider-ovn               : False<font></font>
          Configure WebSocket Proxy               : True<font></font>
          DWH installation                        : True<font></font>
          DWH database secured connection         : False<font></font>
          DWH database host                       : localhost<font></font>
          DWH database user name                  : ovirt_engine_history<font></font>
          DWH database name                       : ovirt_engine_history<font></font>
          Backup DWH database                     : True<font></font>
          DWH database port                       : 5432<font></font>
          DWH database host name validation       : False<font></font>
          Configure Image I/O Proxy               : True<font></font>
          Configure VMConsole Proxy               : True<font></font>
         <font></font>
          Please confirm installation settings (OK, Cancel) [OK]: <font></font>
[ INFO  ] Cleaning async tasks and compensations<font></font>
[ INFO  ] Unlocking existing entities<font></font>
[ INFO  ] Checking the Engine database consistency<font></font>
[ INFO  ] Stage: Transaction setup<font></font>
[ INFO  ] Stopping engine service<font></font>
[ INFO  ] Stopping ovirt-fence-kdump-listener service<font></font>
[ INFO  ] Stopping dwh service<font></font>
[ INFO  ] Stopping Image I/O Proxy service<font></font>
[ INFO  ] Stopping vmconsole-proxy service<font></font>
[ INFO  ] Stopping websocket-proxy service<font></font>
[ INFO  ] Stage: Misc configuration (early)<font></font>
[ INFO  ] Stage: Package installation<font></font>
[ INFO  ] Yum Status: Downloading Packages<font></font>
...<font></font>
[ INFO  ] Stage: Misc configuration<font></font>
[ INFO  ] Upgrading CA<font></font>
[ INFO  ] Not rewriting /etc/ovirt-imageio-proxy/ovirt-imageio-proxy.conf because it was changed manually. You might want to compare it with /etc/ovirt-imageio-proxy/ovirt-imageio-proxy.conf.new and edit as needed.<font></font>
[ INFO  ] Backing up database localhost:ovirt_engine_history to '/var/lib/ovirt-engine-dwh/backups/dwh-20200522233531.6LDItj.dump'.<font></font>
[ INFO  ] Creating/refreshing DWH database schema<font></font>
[ INFO  ] Configuring Image I/O Proxy<font></font>
[ INFO  ] Configuring WebSocket Proxy<font></font>
[ INFO  ] Backing up database localhost:engine to '/var/lib/ovirt-engine/backups/engine-20200522233538.LZCwME.dump'.<font></font>
[ INFO  ] Creating/refreshing Engine database schema<font></font>
[ INFO  ] Creating/refreshing Engine 'internal' domain database schema<font></font>
          Unregistering existing client registration info.<font></font>
[ INFO  ] Generating post install configuration file '/etc/ovirt-engine-setup.conf.d/20-setup-ovirt-post.conf'<font></font>
[ INFO  ] Stage: Transaction commit<font></font>
[ INFO  ] Stage: Closing up<font></font>
[ INFO  ] Starting engine service<font></font>
[ INFO  ] Starting dwh service<font></font>
[ INFO  ] Restarting ovirt-vmconsole proxy service<font></font>
         <font></font>
          --== SUMMARY ==--<font></font>
         <font></font>
[ INFO  ] Restarting httpd<font></font>
          Web access is enabled at:<font></font>
              http://ovirt.example.com:80/ovirt-engine<font></font>
              https://ovirt.example.com:443/ovirt-engine<font></font>
          SSH fingerprint: SHA256:JvilhbwRuMjBCJEjQVPlFQgk0aLaKz7Od0WzsZtx4j4<font></font>
          Did not update /etc/ovirt-imageio-proxy/ovirt-imageio-proxy.conf because it was changed manually. You might want to compare it with /etc/ovirt-imageio-proxy/ovirt-imageio-proxy.conf.new and edit as needed.<font></font>
         <font></font>
          --== END OF SUMMARY ==--<font></font>
         <font></font>
[ INFO  ] Stage: Clean up<font></font>
          Log file is located at /var/log/ovirt-engine/setup/ovirt-engine-setup-20200522232449-o97vyx.log<font></font>
[ INFO  ] Generating answer file '/var/lib/ovirt-engine/setup/answers/20200522233608-setup.conf'<font></font>
[ INFO  ] Stage: Pre-termination<font></font>
[ INFO  ] Stage: Termination<font></font>
[ INFO  ] Execution of setup completed successfully</code></pre></div>
                    </div><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们更新了操作系统和其他软件包：</font></font><br>
 <pre><code class="bash hljs">$ sudo yum update</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 如有必要（更新内核或其组件），我们将重启计算机。</font></font></li>
</ol><br>
<a name="import-vm"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">导入虚拟机</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您可以从VMware导入，导出域（用于在数据中心之间交换映像的特殊实体oVirt），虚拟设备（OVA），XEN，KVM。</font><font style="vertical-align: inherit;">所有官方支持的选项：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从VMware ESXi / VSPHERE导入VM可以在主机+上运行ESXi / VSPHERE的主机上进行身份验证</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从Libvirt导入KVM / Xen VM：用户向运行Libvirt的主机指定URL +身份验证</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从给定的路径导入KVM / Xen VM：用户指定VM配置和磁盘的nfs / posix路径</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">导入从VMware导出的VM：用户指定ova文件的nfs / posix路径</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上载KVM / Xen VM：用户指定配置文件和磁盘</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从VMware导出的上载VM：用户指定ova文件</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从文件夹导入VM：用户指定包含KVM / Xen VM或从VMware导出的VM的文件夹的路径</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们详细介绍两个选项-从vSphere导入和带有KVM的独立计算机。</font><font style="vertical-align: inherit;">要在Compute-&gt; Virtual Machines中启动导入工具，请单击按钮以获得其他菜单项（3个垂直点，请参见图13）。</font><font style="vertical-align: inherit;">必须关闭源计算机。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从vCenter导入计算机</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在向导中：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据来源：VMware；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外部提供程序：在管理-&gt;提供程序中，您可以配置用于频繁操作的模板；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vCenter：vCenter服务器的名称或地址；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESXi：我们将从哪个虚拟机管理程序接车；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据中心：群集的完整路径；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">集群：包含管理程序集群；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户名/密码：用于连接vCenter的用户名和密码；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">验证服务器的SSL证书：使用自签名证书时，您必须禁用其验证。</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/g9/0i/4b/g90i4btxfdhaz_ji-bntbutlaei.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。</font><font style="vertical-align: inherit;">13-从VMware vSphere导入VM。</font></font></i><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从KVM导入机器</font></font></h4><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
有关从KVM导入的详细信息</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
首先，必须先从外部启用到KVM的连接（如果之前尚未配置）。</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许将计算机导出到KVM</font></font></b>
                        <div class="spoiler_text">        ,      .       ! ,      ,        ,       .     , .,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">ArchLinux</a>.<br>
<br>
 ,   libvirtd<br>
<br>
<pre><code class="bash hljs">$ sudo vim /etc/sysconfig/libvirtd</code></pre><br>
 <br>
<br>
<pre><code class="plaintext hljs">LIBVIRTD_ARGS="--listen"</code></pre><br>
      <br>
<br>
<pre><code class="bash hljs">$ sudo cp /etc/libvirt/libvirtd.conf /etc/libvirt/libvirtd.conf.`date +%F`<font></font>
$ sudo vim /etc/libvirt/libvirtd.conf</code></pre><br>
  :<br>
<br>
<pre><code class="plaintext hljs">listen_tls = 0<font></font>
listen_tcp = 1<font></font>
listen_addr = "0.0.0.0"<font></font>
auth_tcp = "none"</code></pre><br>
     <br>
<br>
<pre><code class="plaintext hljs">log_outputs="3:syslog:libvirtd"</code></pre><br>
    libvirtd.    ,    libvirtd &gt; 0.6 (  libvirtd --version),   .<br>
<br>
<pre><code class="bash hljs">$ sudo service libvirtd restart</code></pre><br>
     tcp:16509.<br>
<br>
 CentOS 7     (  permanent):<br>
<br>
<pre><code class="bash hljs">$ sudo firewall-cmd --add-rich-rule=<span class="hljs-string">'rule family="ipv4" source address="172.17.71.32/30" port port="16509" protocol="tcp" accept'</span></code></pre><br>
 :<br>
<br>
<pre><code class="bash hljs">$ virsh -r -c <span class="hljs-string">'qemu+tcp://mgmt@kvm46.example.com/system'</span> list --all</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此外，导入本身非常简单：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
计算-&gt;虚拟机-&gt;：：（附加菜单，三个垂直点）-&gt;导入-&gt;源（通过libvirt的KVM）-&gt; URI（qemu + tcp：//kvm46.example.com /系统）-&gt;需要身份验证（禁用）-&gt;加载。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们标记必要的机器，选择分配策略（Allocation Policy）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
分配策略-对于具有硬件零检测功能的存储卷，具有高I / O的卷，具有高占用率的卷等，首选进行预分配，否则可以进行精简配置。无论如何，我们都会对情况进行分析。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
选中的“克隆”打勾，但不会复制汽车。例如，将为网络接口分配一个新的MAC地址。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在“常规”选项卡上，指定正确的操作系统类型非常重要，在“网络接口”选项卡上，可以指定所需的网络。</font><font style="vertical-align: inherit;">接下来，“导入”，然后根据设备的速度，获得导入的机器。</font><font style="vertical-align: inherit;">导入后（或之前），请不要忘记安装ovirt-guest-agent。</font></font><br>
<br>
<a name="task-mgmt"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">任务管理</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当任务冻结时，困难的“舞蹈”开始，我将尝试谈谈其中的一些。</font><font style="vertical-align: inherit;">通过常规行为，可以在图1中观察到它们。</font><font style="vertical-align: inherit;">2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果任务或多或少地正常执行，那么常规工具就足够了。</font><font style="vertical-align: inherit;">您可以</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在这里</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">看到pimers和图片</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
任务在oVirt-host上执行。</font></font><br>
<br>
<pre><code class="plaintext hljs">[mgmt@ovirt-nodeNN] $ sudo vdsm-client Host getAllTasksInfo<font></font>
[mgmt@ovirt-nodeNN] $ sudo vdsm-client Task getStatus taskID=&lt;TASKID&gt;<font></font>
[mgmt@ovirt-nodeNN] $ sudo vdsm-client Task stop taskID=&lt;TaskID&gt;<font></font>
[mgmt@ovirt-nodeNN] $ sudo vdsm-client Task clear taskID=&lt;TaskID&gt;<font></font>
[mgmt@ovirt-nodeNN] $ sudo vdsm-client Host getAllTasksInfo</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此外，vdsm-client可能会尝试回滚该任务以及所有受支持的方法：</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo vdsm-client Task -h</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
任务方法：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 方法[arg = value] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 getStatus获取任务状态信息。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 恢复回滚任务以恢复先前的系统状态。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 清除丢弃有关已完成任务的信息。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 getInfo获取有关任务的信息。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 停止停止当前正在运行的任务。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，如果无法使用标准方法停止任务，则动作会变得更加复杂。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
正式而言，taskcleaner工具用于此目的：</font></font><br>
<br>
<pre><code class="bash hljs">[mgmt@ovirt-engine] $ sudo /usr/share/ovirt-engine/setup/dbutils/taskcleaner.sh --<span class="hljs-built_in">help</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对于更严重的情况，需要直接编辑数据库。</font><font style="vertical-align: inherit;">仅在万不得已时才使用此方法，该方法应具有oVirt和受影响的计算机的新存档。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，我们连接软件集合</font></font><br>
<br>
<pre><code class="bash hljs">[mgmt@ovirt-engine] $ sudo scl <span class="hljs-built_in">enable</span> rh-postgresql10 <span class="hljs-string">"psql -d engine -U postgres"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，连接到数据库</font></font><br>
<br>
<pre><code class="plaintext hljs">su postgres<font></font>
psql -d engine -U postgres<font></font>
select * from job order by start_time desc;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
直接删除-为有问题的任务运行DeleteJob过程：</font></font><br>
<br>
<pre><code class="plaintext hljs">select DeleteJob('UUID_HERE');</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例：</font></font><br>
<br>
<pre><code class="plaintext hljs">select DeleteJob('ed0127c7-b052-4ec2-a67c-8b3a65d55e19');</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今天就这些了，我希望您永远不需要手动编辑数据库！</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN503172/index.html">C＃：介绍源代码生成器</a></li>
<li><a href="../zh-CN503176/index.html">使用RobotC语言的超声波测距仪和编码器实现确定物体宽度的算法的实现</a></li>
<li><a href="../zh-CN503178/index.html">Apple Mac和精美的设备。LTO，SAS，光纤通道，eSATA</a></li>
<li><a href="../zh-CN503182/index.html">“我是公司中的第一个盲人开发人员。” 第1部分</a></li>
<li><a href="../zh-CN503184/index.html">我们邀请您参加Zabbix在线会议</a></li>
<li><a href="../zh-CN503196/index.html">常春藤联盟提供450道免费课程</a></li>
<li><a href="../zh-CN503200/index.html">YOLOv4-Microsoft COCO数据集上最准确的实时神经网络</a></li>
<li><a href="../zh-CN503204/index.html">如何在Android 10上闪烁小米Redmi 4 Prime / Pro / Premium</a></li>
<li><a href="../zh-CN503208/index.html">什么时候是最佳投资时间？</a></li>
<li><a href="../zh-CN503210/index.html">网络钓鱼站点可以根除吗？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>