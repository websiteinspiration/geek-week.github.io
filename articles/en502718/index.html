<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêì üôéüèø üëåüèø The Talking Head project, or the history of developing software for a telepresence robot ‚öóÔ∏è üèì üõÑ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="My work at T-Systems began with a rather unusual project. Actually, largely because of this project, I came to the company. During our first telephone...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>The Talking Head project, or the history of developing software for a telepresence robot</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tsystems/blog/502718/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">My work at T-Systems began with a rather unusual project. Actually, largely because of this project, I came to the company. During our first telephone conversation, the task was described to me as follows: it is necessary to develop a speech translation system for a telepresence robot. I heard about telepresence robot for the first time, but what could be more exciting than developing for robots? Therefore, I agreed almost immediately.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/994/30b/6d5/99430b6d50dcc913d4ce745e20da2478.jpg"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
My first call to the customer. The task is posed approximately like this - we want the speech translation system to work during the conversation through this telepresence robot, that is, the person speaks Russian, and on the other end of the ‚Äúwire‚Äù the robot reproduces his speech in German and vice versa. Immediately after such a statement of the problem was followed by the question of how much people and time it takes to develop this, and how much it will cost. We agreed that I will look at the documentation on the robot (the robot itself was not in our office), I will study the translation systems and give rough estimates in a month, but for now we will call up a couple of times a week to clarify the details.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The documentation for the robot was rather scarce, to say the least. It was impossible to find anything other than marketing materials, so I wrote to the developers. The existing system made it possible to make a video call to a telepresence robot from a web browser and control its movements in a remote location, and the obvious idea that I had was: is it possible to somehow integrate a speech translation system into the current system?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In parallel, it was necessary to understand how the translation system can be made, and most importantly, what will be the quality of this translation, will it be acceptable to the customer? Therefore, simultaneously with the correspondence with the developers of the robot, I decided to make a call with the customer and communicate with him through Translator. Translator is a mobile application from Microsoft that can translate and voice translation in different languages. The application is free, installed on Android or iOS and uses the appropriate service from Microsoft. During the call, we had to find out whether it is possible to conduct a conversation in this way. For the purity of the experiment, I spoke Russian, and the customer in German, that is, both absolutely did not know the second language, called up through a conference call and first spoke their native language in Translator,and then brought the mobile to the conference handset.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In general, this did not look very convenient, but a general idea of ‚Äã‚Äãthe quality of the translation gave (an inquisitive reader would say that it was easier to phone through Skype with the translation turned on, but for some reason it did not occur to us then). </font><font style="vertical-align: inherit;">After the conversation, we decided that the project to be and the quality for the customer is acceptable.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, following the results of the first month of work on the project, the following was revealed. </font><font style="vertical-align: inherit;">The existing system for the telepresence robot cannot be modified, since the developers of the robot do not provide an API for this. </font><font style="vertical-align: inherit;">However, it turned out that the robot is a kind of Segway to which the iPad connects, and there is an SDK for iOS, with which you can control the Segway. </font><font style="vertical-align: inherit;">That is, you must write your own system completely, not counting on integration with the existing one. </font><font style="vertical-align: inherit;">The first schematic representation of a future product has appeared.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/0e0/bb9/bbe/0e0bb9bbe36876dc82235d7b0a78373e.png">&nbsp;<br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After discussion with the customer, it was decided that 3 people would work on the project - iOS developer, backend &amp; frontend developers. We will divide the project itself into stages of 2-3 months long and will set a goal for each stage with the conclusion of a separate contract. At the end of the stage - a demonstration of the results to the customer and investor of the project. It was important for the customer that by the new year there was already a working POC. Since I joined the company in July, the deadlines were pretty tight. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The goal for the first 2-month stage was set to find two more developers, choose services for video calls and translation. At the end of the stage, it was necessary to show a simple web application that allows you to make a video call with an integrated translation service.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WebRTC is now widely used for making video calls, which is currently supported by most web browsers. However, in view of limited resources, we did not dare to write on the bare WebRTC and chose a provider that provides the service on top of WebRTC. We considered two services - TokBox and Voxeet. As a result, they chose TokBox. It is necessary to take into account that these services are paid, therefore, along with the description of the application architecture, we performed cost calculations for a minute of a video call with translation.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/bdc/1ab/14d/bdc1ab14da6d21042d7c800e5cdd7b5b.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We also considered several services for translation: TranslateYourWorld.com (it provides a single API that unites several translation providers at once, including Google and Microsoft, but the company is very small and unreliable, their site did not open at the time of this writing), Google Cloud translation, Microsoft Speech. As a result, we stopped at the MS Speech service, since it has a more convenient API, we can stream the audio stream to the service via websocket and immediately receive audio recordings with translation, plus good translation quality. In addition, Microsoft is a partner of our company, which facilitates cooperation with them.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An experienced, talented (Misha, hello!) Full stack developer joined me, and in early October, our small team successfully closed the next stage and demonstrated a simple web application that, using TokBox and MS Speech services, made it possible to arrange video calls with translation into several languages including Russian and German. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The next stage was designed for 3 months and its goal was MVP with a robot. At this stage, the third and last developer joined us. The following technology stack was chosen for the project: the backend - NodeJS + MongoDB, the web frontend on ReactJS and Swift for the iOS application that interacts with the robot. A story deserves a separate story about how I drove a robot from Germany to St. Petersburg and first explained to German, then to our customs officers, what kind of device this is in the box.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/265/eef/3aa/265eef3aaee9258e004e83448e995da4.png"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/472/877/f5d/472877f5d568cdb19327362bf67d0988.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At the first stages, while we didn‚Äôt have a robot, the iOS application only allowed us to make a video call with translation. When the robot was with us, in early December, we quickly added the sending of control signals to the robot through an already debugged call connection, and it became possible to control the robot by pressing the arrows on the keyboard. Thus, in January we closed the third stage and demonstrated its results to the customer.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The result of the penultimate stage was a debugged system with the correction of all critical bugs. When calling a robot, the operator can see the room through the main camera and the floor through the secondary camera (to make it easier to go around obstacles). The operator‚Äôs face is displayed on the screen of the robot. In this case, the conversation can be conducted with translation into any of the 7 supported languages, which include Russian, German and some other languages. During the translation, two lines of text run: the first is recognized speech and the second translation into another language with karaoke lighting, so that it is clear which part of the phrase is currently being played on the other end of the connection.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/009/a69/c5d/009a69c5d7e8e404d70812e4a06464a7.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And finally, at the last stage, we added a user management system, user groups, statistics and reports on the number and duration of calls. </font><font style="vertical-align: inherit;">Thus, a year later, we successfully completed the project and transferred it to the customer.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the course of work on the project, new, interesting ideas arose. </font><font style="vertical-align: inherit;">For example, wear virtual reality goggles on the operator so that he has the full immersion effect and the ability to control the robot by turning his head.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We also conducted a study on the subject of creating a self-driving robot using the ROS framework in order to ‚Äúteach‚Äù it to avoid obstacles on its own and get from point A to point B or meet guests at the entrance to the office. </font><font style="vertical-align: inherit;">In general, the project turned out to be quite fascinating, and who knows what other interesting features we will add to the system in the future.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/1fe/a1c/2ef/1fea1c2ef8947730c4f33ef4919a2f50.jpg"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en502704/index.html">How we retrained support to speak humanly, and what happened</a></li>
<li><a href="../en502706/index.html">The state of soft skills</a></li>
<li><a href="../en502712/index.html">How does an address led strip work?</a></li>
<li><a href="../en502714/index.html">Export OpenStreetMap data using visual editor on rete.js</a></li>
<li><a href="../en502716/index.html">Can't share your home computer? Make one out of two</a></li>
<li><a href="../en502720/index.html">Testing Trends to Look At in 2020</a></li>
<li><a href="../en502722/index.html">Silicon Valley in Russian. How # ITX5 works in Innopolis</a></li>
<li><a href="../en502726/index.html">WebRTC Making an application with blackjack and video calls</a></li>
<li><a href="../en502728/index.html">Interesting tricks and SSH tricks</a></li>
<li><a href="../en502730/index.html">What do industrial designers know about the devices you use every day. Or 50 years of transforming a computer mouse</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>