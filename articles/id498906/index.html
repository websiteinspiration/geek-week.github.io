<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💇🏼 👩🏽‍💼 🤞🏻 Bagaimana kami membantu sekolah beralih ke pembelajaran jarak jauh dan mengatasi bebannya ⏲️ 🤷 👨🏿‍🎓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo, Habr! Nama saya Alexey Vakhov, saya direktur teknis Uchi.ru. Pada pertengahan Maret, ketika sekolah mulai beralih ke pembelajaran jarak jauh, ka...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Bagaimana kami membantu sekolah beralih ke pembelajaran jarak jauh dan mengatasi bebannya</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/uchi_ru/blog/498906/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Halo, Habr! Nama saya Alexey Vakhov, saya direktur teknis Uchi.ru. Pada pertengahan Maret, ketika sekolah mulai beralih ke pembelajaran jarak jauh, kami memberikan beberapa layanan kepada guru dan siswa untuk kelas online. Menurut perhitungan kami, kami memiliki margin keselamatan untuk bertahan maksimal 1,5-2 kali beban. Pada pertengahan April, lalu lintas kami tumbuh 8 kali. Saya harus melakukan banyak hal untuk tetap bertahan. Mungkin seseorang akan membutuhkan pengalaman kita untuk selamat dari krisis ini atau masa depan.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami tidak mengharapkan kejutan seperti itu dan tidak siap untuk mereka, mungkin tidak ada satu perusahaan pun di Rusia, atau di dunia, yang siap untuk ini. Biasanya pada bulan Maret, aktivitas di Uchi.ru relatif lebih rendah dibandingkan dengan musim gugur karena liburan musim semi dan musim panas mendatang, di mana saat ini kami sudah bersiap untuk bulan September: kami menggergaji fitur, melakukan refactoring, melakukan perubahan arsitektur skala besar, dan melakukan rutinitas menyenangkan lainnya. Namun, kali ini berbeda. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jumlah puncak pengguna unik di situs pada satu waktu mencapai 240 ribu, kami mencatat maksimum tahun sekolah saat ini pada 30 ribu orang. Pada titik ini, beban bertambah setiap hari, dan kami bekerja sepanjang waktu untuk menstabilkan situs.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketika beban seperti itu jatuh di situs, sebagai aturan, aplikasi, layanan, penyeimbang, pangkalan, web, saluran terbentuk. </font><font style="vertical-align: inherit;">Semua "kemacetan" infrastruktur terpapar. </font><font style="vertical-align: inherit;">Dalam kondisi seperti itu, sulit untuk mendiagnosis masalah - secara simtomatis semuanya bermasalah. </font><font style="vertical-align: inherit;">Sangat mudah untuk memperbaiki ketika lalu lintas tumbuh dengan lancar dan satu hal rusak. </font><font style="vertical-align: inherit;">Ketika beban mengalir dalam kebingungan, salah satu masalah besar adalah memahami penyebab kegagalan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Strategi untuk bekerja dalam kondisi seperti ini adalah menghilangkan apa yang paling menghantam situs, kemudian menemukan titik paling menyakitkan berikutnya, pada saat yang sama mencari potensi masalah dan memperbaikinya, dan sebagainya. </font><font style="vertical-align: inherit;">Berikut adalah beberapa hal penting yang kami lakukan untuk menstabilkan platform.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bergantung pada diri mereka sendiri</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selama krisis sebelum lalu lintas, Anda sebagai satu tim menjadi satu. Itu akan tergantung pada karyawan Anda apakah Anda akan menemukan solusi, mengatasi krisis, atau tidak. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak ada orang di industri yang akan datang, melihat ke dalam sistem Anda yang kompleks, segera melakukan sesuatu dan semuanya akan baik-baik saja. Tentu saja, di dunia ada cukup banyak spesialis yang akan mengatasi tugas jika ada waktu. Tetapi ketika solusi mendasar diperlukan saat ini, Anda hanya dapat mengandalkan tim Anda, yang mengetahui sistem dan spesifiknya. Hasil dan tanggung jawab untuk bisnis terletak pada tim. Pemeriksaan eksternal disarankan untuk menghubungkan secara langsung.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Koordinasi operasional tim anti-krisis dalam obrolan khusus di Slack membantu kami dengan cepat menavigasi dan membangun pekerjaan - semua masalah diselesaikan di sini dan sekarang. </font><font style="vertical-align: inherit;">Kami membagi area tanggung jawab antara karyawan sehingga tidak ada persimpangan dan orang-orang tidak melakukan pekerjaan ganda. </font><font style="vertical-align: inherit;">Pada hari-hari yang paling sulit, saya harus berhubungan secara harfiah sepanjang waktu.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloud yang diperluas</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda tidak dapat mengasuransikan diri dari semua krisis, tetapi penting untuk fleksibel. </font><font style="vertical-align: inherit;">Tumpukan cloud memberi kami plastisitas dan kesempatan untuk tetap bertahan meski dengan peningkatan beban yang dramatis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Awalnya, kami meningkatkan sumber daya di bawah peningkatan beban, tetapi pada beberapa titik kami berlari ke kuota wilayah penyedia cloud kami. </font><font style="vertical-align: inherit;">Masalah muncul pada tingkatnya: server virtual kami dipengaruhi oleh tetangga, di mana lalu lintas juga tumbuh, yang menyebabkan kegagalan dalam pengoperasian aplikasi kami. </font><font style="vertical-align: inherit;">Ini diharapkan: kami bergantung pada penyedia dan infrastrukturnya, yang pada gilirannya juga mengalami beban yang tinggi. </font><font style="vertical-align: inherit;">Kami telah merilis beberapa sumber daya dari mesin virtual non-prioritas untuk situs utama. </font><font style="vertical-align: inherit;">Dengan penyedia, kami menyetujui sumber daya khusus.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alat pemantauan yang ditingkatkan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selama krisis, waspada sebenarnya tidak memenuhi fungsinya. </font><font style="vertical-align: inherit;">Semua anggota tim sudah memantau semua sistem sepanjang waktu, dan manajemen insiden dikurangi menjadi pekerjaan konstan di semua lini. </font><font style="vertical-align: inherit;">Untuk sepenuhnya mendiagnosis masalah yang kami temui, kami memiliki terlalu sedikit data. </font><font style="vertical-align: inherit;">Misalnya, untuk memantau mesin virtual, kami menggunakan Node Eksportir standar untuk Prometheus. </font><font style="vertical-align: inherit;">Dia baik melihat gambaran besar, karena melihat lebih dekat pada satu mesin virtual mulai menggunakan NetData.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penyimpanan cache yang dioptimalkan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Masalah juga muncul dengan penyimpanan nilai kunci. </font><font style="vertical-align: inherit;">Dalam salah satu aplikasi, Redis tidak dapat mengatasinya - dalam satu salinan, itu dapat bekerja hanya pada satu inti. </font><font style="vertical-align: inherit;">Oleh karena itu, mereka menggunakan garpu Redis yang disebut KeyDB, yang dapat bekerja di banyak utas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk meningkatkan bandwidth di aplikasi lain, kami telah mengumpulkan 10 Redis'ov independen. </font><font style="vertical-align: inherit;">Mereka diproksi dengan Service Mesh kami, yang juga memberikan kunci. </font><font style="vertical-align: inherit;">Bahkan jika satu atau dua Redis crash, ini tidak akan menyebabkan masalah karena hashing yang konsisten. </font><font style="vertical-align: inherit;">Plus, mereka secara praktis tidak perlu diberikan.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memperluas jaringan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang Anda ketahui, 640 Kb sudah cukup untuk semua orang. </font><font style="vertical-align: inherit;">Kami selalu menggunakan subnet pribadi / 24, tetapi dengan latar belakang karantina kami harus segera memperluas ke / 22. </font><font style="vertical-align: inherit;">Sekarang jaringan menampung empat kali lebih banyak server, kami berharap itu akan cukup untuk memastikan.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PgBouncer dilakukan secara terpisah</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai basis data relasional, kami menggunakan PostgreSQL di mana-mana, di suatu tempat contoh virtual kecil, dan di suatu tempat - instalasi beberapa server khusus besar untuk master dan replika. Hambatan yang jelas dari arsitektur ini adalah master, yang dalam kasus ideal hanya digunakan untuk merekam dan tidak skala secara horizontal. Dengan pertumbuhan lalu lintas, kami mulai beristirahat pada CPU.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada saat yang sama, kami menggunakan PgBouncer, yang diinstal pada wizard dan pada setiap replika, untuk mengelola koneksi. </font><font style="vertical-align: inherit;">Pada satu port, dapat menggunakan tidak lebih dari satu inti prosesor, jadi pada setiap server kami memiliki beberapa penjaga. </font><font style="vertical-align: inherit;">Pada titik tertentu, menjadi jelas bahwa PgBouncer sendiri mengambil bagian nyata dari CPU dari pangkalan, dan pada beban maksimum kami mengalami peningkatan rata-rata beban yang cepat dan penurunan kinerja sistem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami memindahkan penjaga ke server terpisah, yang membantu kami menghemat 20-25% CPU di setiap server basis data.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menghadapi kejutan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hanya satu alat yang tidak dapat dipercaya, terutama di saat krisis. Sebaliknya, redundansi alat membantu, karena memungkinkan untuk melihat gambar yang lebih objektif. Alat yang familier mulai gagal karena berbagai alasan. Misalnya, biasanya untuk memperkirakan jumlah orang di situs, kami biasanya menggunakan laporan Google Analytics real-time, yang merupakan metrik sensitif dan akurat. Tetapi kadang-kadang sulit dan kali ini kami harus melihat metrik internal seperti jumlah acara tampilan halaman dan jumlah permintaan per detik.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk logging terpusat kami menggunakan ELK. </font><font style="vertical-align: inherit;">Pipa pengiriman log kami didasarkan pada Apache Kafka dan Elastic Filebeat. </font><font style="vertical-align: inherit;">Di bawah beban tinggi, konveyor pengiriman log berhenti mengelola, log mulai hilang atau tertinggal. </font><font style="vertical-align: inherit;">Kami meningkatkan kecepatan pengindeksan log dan penyimpanan log dengan memanipulasi indeks Elasticsearch, meningkatkan jumlah partisi di Kafka dan Filebeat, dan kompresi yang lebih baik pada semua tahap. </font><font style="vertical-align: inherit;">Karena kenyataan bahwa pipa untuk mengumpulkan kayu bulat terpisah dari produksi, masalah dengan peningkatan lalu lintas kayu bulat tidak berpengaruh pada fungsi situs.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menerima aturan main</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak mungkin untuk mempersiapkan setiap krisis sebelumnya, tetapi Anda awalnya dapat mencoba membangun sistem yang fleksibel. </font><font style="vertical-align: inherit;">Perusahaan rintisan atau perusahaan yang secara bertahap berhenti menjadi perusahaan rintisan, dalam waktu tenang, tidak selalu rasional untuk mempersiapkan pertumbuhan lalu lintas yang tidak normal: sumber daya tim terbatas. </font><font style="vertical-align: inherit;">Jika kita menyisihkan persiapan mereka untuk sesuatu yang mungkin tidak pernah terjadi, tidak akan ada kekuatan tersisa untuk produk utama. </font><font style="vertical-align: inherit;">Jauh lebih penting untuk bereaksi dengan benar saat ini dan tidak takut dengan keputusan berani. </font><font style="vertical-align: inherit;">Sebagai aturan, jalan keluar dari krisis mereka adalah jalan keluar ke tingkat yang secara kualitatif baru. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inilah musim semi yang menyenangkan tahun ini. </font><font style="vertical-align: inherit;">Ketika tampaknya segala sesuatu yang mungkin telah dilakukan, kadang-kadang ternyata ini hanya permulaan.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id498892/index.html">Tinjauan API Renga Terakhir</a></li>
<li><a href="../id498894/index.html">Penerbangan normal</a></li>
<li><a href="../id498898/index.html">Jaringan saraf untuk anak-anak: jelaskan sesederhana mungkin</a></li>
<li><a href="../id498900/index.html">Rosbank Java-school - hasil pembelajaran</a></li>
<li><a href="../id498904/index.html">Menambahkan Komputasi Paralel ke Panda</a></li>
<li><a href="../id498910/index.html">Astronotika komersial - mitos dan kenyataan</a></li>
<li><a href="../id498912/index.html">Bagian anti-krisis Habr</a></li>
<li><a href="../id498914/index.html">AI yang Bertumbuh - Algoritma Genetika: Suatu Pengantar</a></li>
<li><a href="../id498918/index.html">Pernyataan Anda 100% benar, hanya salah sasaran</a></li>
<li><a href="../id498920/index.html">Sistem pembayaran. Persaingan Armor dan Shell</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>