<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐀 😕 🧑🏻 システムまたはLOLDrivers上の危険なサードパーティドライバー 🧡 ↗️ 👩🏿‍🤝‍👩🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="完全に正当なドライバーが攻撃者にシステムに長期間登録する機会を与え、再インストールした後も内部にとどまることを知っていますか？または、コンピュータをレンガに変えますか？たとえば、一見無害で信頼できる（署名された）ドライバーのいくつかは、BIOSを上書きするための付随的なツールです。そのような攻撃の後...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>システムまたはLOLDrivers上の危険なサードパーティドライバー</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/468691/"><p><img src="https://habrastorage.org/webt/jo/vj/6b/jovj6bremrnesqprdgan6fibwqu.jpeg"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完全に正当なドライバーが攻撃者にシステムに長期間登録する機会を与え、再インストールした後も内部にとどまることを知っていますか？</font><font style="vertical-align: inherit;">または、コンピュータをレンガに変えますか？</font><font style="vertical-align: inherit;">たとえば、一見無害で信頼できる（署名された）ドライバーのいくつかは、BIOSを上書きするための付随的なツールです。</font><font style="vertical-align: inherit;">そのような攻撃の後、プログラマーだけが保存します。</font></font></p><br>
<p> C Windows   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">//</a>   <del></del>      ,  ,  UAC  ..        ,   .</p><a name="habracut"></a><br>
<p>  Windows Vista x64,   Driver Signature Enforcement (DSE) –       .   (  /)          ( kernel rootkit/bootkit/SMM-rootkit/BIOS-rootkit),   -     .                  ,       .       (        ,           ).</p><br>
<h2 id="sposoby-obhoda-dse"><strong>  DSE</strong></h2><br>
<p> ,         DSE (  -   ring0).       DSE      ( ,     ).  ,      Windows x64,   Vista.</p><br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td> Boot Configuration Data (Test Mode)</td>
<td></td>
<td><ul>
<li>    </li>
<li>     </li>
<li> </li>
</ul></td>
</tr>
<tr>
<td>   </td>
<td>   </td>
<td><ul>
<li>      Certificate Revocation List (CRL)</li>
</ul></td>
</tr>
<tr>
<td>     DSE</td>
<td>      Windows</td>
<td><ul>
<li>   </li>
<li>   </li>
</ul></td>
</tr>
<tr>
<td>    (bootmgr, winload.exe, winresume.exe, ci.dll)</td>
<td>      OC</td>
<td><ul>
<li> </li>
<li>   Secure Boot ( )</li>
<li> </li>
<li>   </li>
<li>    </li>
</ul></td>
</tr>
<tr>
<td>    </td>
<td>  </td>
<td><ul>
<li>   </li>
<li>    </li>
</ul></td>
</tr>
<tr>
<td>      </td>
<td>      Windows</td>
<td><ul>
<li>  ( )      </li>
</ul></td>
</tr>
</tbody>
</table></div><br>
<p>   ,              DSE.</p><br>
<h2 id="opasnaya-funkcionalnost-ili-funkcionalnost-dvoynogo-naznacheniya"><strong>     </strong></h2><br>
<p>   ,            .</p><br>
<ul>
<li>    /SYSTEM.  /  .    , ,    ASMMAP  ASUS.          EPROCESS (    ),        ,      ,        SYSTEM (, lsass, wininit).     Token       .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>. </li>
<li> SMEP.        cr4 (,   20- ). ,  bandainamcoonline.sys    SMEP,            .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>     .</li>
<li><p>     .  /    MSR.      (    MSR),         ,     . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>      .    PatchGuard,       .</p><br>
<blockquote>   PatchGuard    Ring 0,       PatchGuard (  , ,  Microsoft    Intel          ).    Microsoft              ,       .  , -      PatchGuard       .<br>
<br>
 — <em>Blunden B. The Rootkit arsenal: Escape and evasion in the dark corners of the system.</em></blockquote><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><blockquote>Given that driver code and PatchGuard code both execute in Ring 0, there's nothing to prevent a KMD from disabling PatchGuard checks (unless, of course, Microsoft takes a cue from Intel and moves beyond a two-ring privilege model). The kernel engineers at Microsoft are acutely aware of this fact and perform all sorts of programming acrobatics to obfuscate where the code resides, what it does, and the internal data-structures that it manipulates. In other words, they can't keep you from modifying PatchGuard code, so they're going to try like hell to hide it.<br>
<br>
 — <em>Blunden B. The Rootkit arsenal: Escape and evasion in the dark corners of the system.</em></blockquote><br>
</div></div><br>
</li>
</ul><br>
<ul>
<li> BIOS.  in the wild – <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Lojax</a>.     RwDrv.sys       :  BIOS,    .  Windows   ,         SPI-flash.    BIOS  (  ),    .           .</li>
<li> SMI-. -,   BIOS’       ring0:      /,    ,      –   SMM ( ).         –  SMI- (     ).   SMI-      I/O ,        ring0.        I/O     SMI-,         SMM.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>    RwDrv.sys.</li>
<li>  .    (   ),  BIOS,    ,    /   (  MSR,  ,    /),        ( VirtualBox <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> MSR</a>).        ,    ,   . ,      RamCaptureDriver64.sys  Belkasoft.</li>
</ul><br>
<p>       CVE,           ring3   .           . </p><br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th>  </th>
<th>     </th>
</tr>
</thead>
<tbody>
<tr>
<td>/  MSR</td>
<td>CVE-2018-10711, CVE-2018-18535, CVE-2018-19323, CVE-2007-5633, CVE-2007-5761</td>
</tr>
<tr>
<td>/  /</td>
<td>CVE-2018-10712, CVE-2018-18536, CVE-2018-19322</td>
</tr>
<tr>
<td>/  </td>
<td>CVE-2018-16712, CVE-2018-10710, CVE-2017-15302, CVE-2017-15303, CVE-2018-19321</td>
</tr>
<tr>
<td>/  </td>
<td>CVE-2018-10709, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Eset — Windows exploitation in 2016</a></td>
</tr>
<tr>
<td>    /</td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Leif Uhsadel, Andy Georges, Ingrid Verbauwhed — Exploiting Hardware Performance Counters</a></td>
</tr>
<tr>
<td>/  </td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Wojtczuk R., Rutkowska J. Following the White Rabbit: Software attacks against Intel VT-d technolog</a></td>
</tr>
<tr>
<td>   </td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Cache-Based Side-Channel Attacks Detection through Intel Cache Monitoring Technology and Hardware Performance Counters</a></td>
</tr>
</tbody>
</table></div><br>
<p>        .      /   , / MMIO,   PCI  ..</p><br>
<p> ,     (       )    : /  MSR, /  /, /  .         ,       /  /  ring3 (,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>   ),      (    ,   /),  , .</p><br>
<p>       DEFCON 27  -  Jesse Michael  Mickey Shkatov   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">"Get off the kernel if you cant drive"</a>,       ,         .               ,     .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>      .</p><br>
<p>  ,         .   2018        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">"What makes OS drivers dangerous for BIOS?"</a>     ,      BIOS. </p><br>
<h2 id="drayvery-s-funkciyami-dvoynogo-naznacheniya"><strong>    </strong></h2><br>
<p>         .</p><br>
<ul>
<li><p>RwDrv.sys –    (   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">RWeverything</a>).     , I/O , MSR   .      PoC’,         Lojax.    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>  C++,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">chipsec</a>.</p><br>
</li>
<li><p>cpuz/gpuz</p><br>
<div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: static; visibility: visible; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="561208359383097346"></twitter-widget>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div><br>
<p>    ,   MSR.   PoC-    (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>).</p><br>
</li>
<li><p>pcdsrvc_x64 –   Dell,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a> .  /     I/O .</p><br>
</li>
<li><p>AsIO64.sys<br>
<img src="https://habrastorage.org/webt/nt/lv/kt/ntlvkt0qhmrs_otokd_exel9bqw.png" alt="画像"><br>
   /    I/O ,        dll’    .</p><br>
</li>
<li><p>Asmmap64.sys –     ASUS,  /  , I/O   MSR.       ,             .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>.</p><br>
</li>
<li><p>ntiolib_x64.sys/winio64.sys –   MSI,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>.   ntiolib_x64.sys  /  , I/O   MSR, winio64.sys    ,  MSR.</p><br>
</li>
</ul><br>
<p>     ,        ( ACL)        (  bandainamcoonline.sys).      ,       ,          . </p><br>
<p>  ,      ,   .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>  .       ASUS, AVAST, Razer, LG, American Megatrends    .    ,   .  ,    .</p><br>
<p>     Microsoft.         ;)<br>
<img src="https://habrastorage.org/webt/ch/cd/pt/chcdptm1b5s848omknbcd0sr-im.png" alt="画像"></p><br>
<h2 id="rekomendacii"><strong></strong></h2><br>
<p> :</p><br>
<ul>
<li>        ,  UAC (  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>  ). </li>
<li>      (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>). </li>
<li>       (,   BIOS  ..)    .</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Device Guard</a> (     Windows 10).          ,  ""    . ,    ,         WHQL  Microsoft.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>       Device Guard   .</li>
</ul><br>
<p>      .     BIOS,      (, chipsec),      - ,    ,       Test Mode,   ,   . Usability    ,   security.</p><br>
<h2 id="vyvody"><strong></strong></h2><br>
<p> - ,      . -,  -   ,  -,   (     )   .</p><br>
<p>          ,          .   ,    .          ,   RwEverything,   -   ,      .     ,           .</p><br>
<p>:  </p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja468679/index.html">KubernetesのセキュリティのABC：認証、承認、監査</a></li>
<li><a href="../ja468683/index.html">Dockerサービスの標準化の理論と実践</a></li>
<li><a href="../ja468685/index.html">音響心理学、ロスレス、およびオーディオ標準について他に何を知っていますか</a></li>
<li><a href="../ja468687/index.html">株式市場を規制するための中央銀行の新しい取り組みを分析します：投資家の3つのグループ、初心者向けの制限</a></li>
<li><a href="../ja468689/index.html">シンガポールでのITビジネスの登録：どうすればよいですか？</a></li>
<li><a href="../ja468693/index.html">自動化がウォルマートの従業員を破壊する方法</a></li>
<li><a href="../ja468695/index.html">私の最初のハック：ユーザーのパスワードを設定できるサイト</a></li>
<li><a href="../ja468697/index.html">DB＆DWH MeetUp＃5ライファイゼンバンク</a></li>
<li><a href="../ja468703/index.html">プログラマーはどのようにしてさらに稼ぐことができますか？</a></li>
<li><a href="../ja468705/index.html">PeerJSのブラウザーでのビデオ通話。ファストスタート</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>