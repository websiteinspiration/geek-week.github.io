<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏊 🌿 👌 TON（Telegram Open Network）テストクライアントとスマートコントラクト用の新しいFift言語 😈 🛥️ 👩🏻‍🎓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="1年以上前に、独自の分散型ネットワークTelegram Open NetworkをリリースするTelegramメッセンジャーの計画について知られるようになりました。その後、膨大な技術文書が利用可能になりました。おそらくNikolai Durovによって書かれ、将来のネットワークの構造を説明しています...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>TON（Telegram Open Network）テストクライアントとスマートコントラクト用の新しいFift言語</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453714/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1年以上前に、独自の分散型ネットワーク</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telegram Open Network</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">をリリースするTelegramメッセンジャーの計画について知られるようになり</font><strong><font style="vertical-align: inherit;">ました</font></strong><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">その後、膨大な技術文書が利用可能になりました。おそらくNikolai Durovによって書かれ、将来のネットワークの構造を説明しています。</font><font style="vertical-align: inherit;">見逃した方は、この文書の再読をお読みになることをお勧めします（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パート1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パート2、3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">番目のパートは悲しいことに、まだドラフトコピーにほこりがたまっています）。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それ以来、TONの開発状況に関する重要なニュースはありませんでした。数日前（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非公式のチャネルの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1つ</font><font style="vertical-align: inherit;">）で、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https：//test.ton.org/download.html</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ページへのリンクが表示されるまでは</font><font style="vertical-align: inherit;">、次のとおりです。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">◦ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トンテストliteclient-full.tar.xz</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - TONテストネットワークの光クライアントソースコードと</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
◦ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トン-LITE-クライアントtest1.config.json</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -テスト・ネットワークに接続するための設定ファイル。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
◦ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">README</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -クライアントを構築し、起動については、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
◦ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HOWTO</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -ステップバイステップのクライアントを使用してスマート契約の作成手順。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
◦ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ton.pdf</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - TONネットワークの技術的な概要を持つ（2019年3月2日付けの）更新されたドキュメント。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
◦ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tvm.pdf</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - TVM（TON仮想マシン、仮想マシンTON）の技術的な説明。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
◦ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tblkch.pdf</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - TONのblockchainの技術的な説明。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
◦ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fiftbase.pdf</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -TONでスマートコントラクトを作成するために設計された新しいFift言語の説明。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">繰り返しますが、ページとこれらのすべてのドキュメントはTelegramによって公式に確認されたわけではありませんが、これらの資料の量は非常に説得力があります。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自己の責任において</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">公開クライアント</font><strong><font style="vertical-align: inherit;">を</font></strong><font style="vertical-align: inherit;">実行</font><strong><font style="vertical-align: inherit;">してください</font></strong><font style="vertical-align: inherit;">。</font></font></p><a name="habracut"></a><br>
<h2 id="sborka-testovogo-klienta"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テストクライアントの構築</font></font></h2><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初に、テストクライアントをビルドして実行してみましょう-幸い、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">README</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">では、</font><font style="vertical-align: inherit;">この単純なプロセスについて詳しく説明しています。</font><font style="vertical-align: inherit;">macOS 10.14.5の例でこれを行いますが、他のシステムでのアセンブリの成功を保証できません。</font></font></p><br>
<ol>
<li><p><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アーカイブを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ダウンロードし、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ソースコードとともに</font></a><font style="vertical-align: inherit;">解凍し</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">この段階では下位互換性が保証されていないため、最新バージョンをダウンロードすることが重要です。</font></font></p><br>
</li>
<li><p>,       make, cmake ( 3.0.2  ), OpenSSL (   C), g++  clang.     ,   .</p><br>
</li>
<li><p>,     <code>~/lite-client</code>.          (, <code>~/liteclient-build</code>),    (<code>cd ~/liteclient-build</code>)  :</p><br>
<pre><code class="bash hljs">cmake ~/lite-client<font></font>
cmake --build . --target <span class="hljs-built_in">test</span>-lite-client</code></pre><br>
<p><img src="https://habrastorage.org/webt/sr/lx/j8/srlxj8au48yus3uuddlpenvika0.png" alt="成功した顧客構築"><br>
<br>
    Fift  - (  ),  </p><br>
<pre><code class="plaintext hljs">cmake --build . --target fift</code></pre><br>
</li>
<li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>             .</p><br>
</li>
<li><p><strong></strong>,   :</p><br>
<pre><code class="plaintext hljs">./test-lite-client -C ton-lite-client-test1.config.json</code></pre><br>
</li>
</ol><br>
<p>   ,     - :</p><br>
<p><img src="https://habrastorage.org/webt/gl/gg/d3/glggd35dzg4vwogf9woibu43zrk.png" alt="クライアントの立ち上げ"></p><br>
<p> ,  , :</p><br>
<p>◦ <strong><code>help</code></strong> —    ;<br>
◦ <strong><code>quit</code></strong> — ;<br>
◦ <strong><code>time</code></strong> —     ;<br>
◦ <strong><code>status</code></strong> —      ;<br>
◦ <strong><code>last</code></strong> —    (  ).       ,   ,       .<br>
◦ <strong><code>sendfile</code></strong> <code>&lt;filename&gt;</code> —      TON.      —   , ,   -       ;<br>
◦ <strong><code>getaccount</code></strong> <code>&lt;address&gt;</code> —&nbsp;  (    <strong><code>last</code></strong>)     ;<br>
◦ <strong><code>privkey</code></strong> <code>&lt;filename&gt;</code> —      .</p><br>
<p>          <code>-D</code>,         :</p><br>
<pre><code class="bash hljs">./<span class="hljs-built_in">test</span>-lite-client -C ton-lite-client-test1.config.json -D ~/ton-db-dir</code></pre><br>
<p>       —   Fift,   - (,   ),          .</p><br>
<h2 id="yazyk-fift"> Fift</h2><br>
<p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">fiftbase.pdf</a>  ,    -  Telegram     <strong>Fift</strong> (,   <em>fifth</em>,    Forth — ,    Fift  ).</p><br>
<p>  ,  87 ,             ( ,        :).            .</p><br>
<p>  ,    :     <em></em>,  ,      ( :       ).  <em></em> —  -  ,    <em></em> ( , ,    ,    ).    ,          . ,   —&nbsp; — 257- ,     — ,      ,      .</p><br>
<p>,  ,   ,    .    — <em></em> —   ,        . ,     —  «» (<code>"</code>)   ,    () ,       .       (<code>//</code>)   (<code>/*</code>) .</p><br>
<p>       .   (  )    ( ,        ;    « » <code>Fift.fif</code>,     <code>crypto/fift</code>  ).</p><br>
<p>    Fift:</p><br>
<pre><code class="plaintext hljs">{ dup =: x dup * =: y } : setxy<font></font>
3 setxy x . y . x y + .<font></font>
7 setxy x . y . x y + .</code></pre><br>
<p>      <code>setxy</code> (    <code>{</code>,      <code>}</code>   <code>:</code>,    ). <code>setxy</code>     ,  ( )    <em></em> <code>x</code>,     —&nbsp;  <code>y</code> (,     ,      ,      ).</p><br>
<p>       ,  <code>setxy</code>,     <code>x</code>, <code>y</code> (    <code>.</code>),     ,     .    :</p><br>
<pre><code class="plaintext hljs">3 9 12 ok<font></font>
7 49 56 ok</code></pre><br>
<p>( «ok»  ,         )</p><br>
<p>    :</p><br>
<pre><code class="plaintext hljs">"Asm.fif" include<font></font>
<font></font>
-1 constant wc  // create a wallet in workchain -1 (masterchain)<font></font>
<font></font>
// Create new simple wallet<font></font>
&lt;{  SETCP0 DUP IFNOTRET INC 32 THROWIF  // return if recv_internal, fail unless recv_external<font></font>
    512 INT LDSLICEX DUP 32 PLDU   // sign cs cnt<font></font>
    c4 PUSHCTR CTOS 32 LDU 256 LDU ENDS  // sign cs cnt cnt' pubk<font></font>
    s1 s2 XCPU            // sign cs cnt pubk cnt' cnt<font></font>
    EQUAL 33 THROWIFNOT   // ( seqno mismatch? )<font></font>
    s2 PUSH HASHSU        // sign cs cnt pubk hash<font></font>
    s0 s4 s4 XC2PU        // pubk cs cnt hash sign pubk<font></font>
    CHKSIGNU              // pubk cs cnt ?<font></font>
    34 THROWIFNOT         // signature mismatch<font></font>
    ACCEPT<font></font>
    SWAP 32 LDU NIP <font></font>
    DUP SREFS IF:&lt;{<font></font>
      8 LDU LDREF         // pubk cnt mode msg cs<font></font>
      s0 s2 XCHG SENDRAWMSG  // pubk cnt cs ; ( message sent )<font></font>
    }&gt;<font></font>
    ENDS<font></font>
    INC NEWC 32 STU 256 STU ENDC c4 POPCTR<font></font>
}&gt;c<font></font>
// code<font></font>
&lt;b 0 32 u, <font></font>
   newkeypair swap dup constant wallet_pk <font></font>
   "new-wallet.pk" B&gt;file<font></font>
   B, <font></font>
b&gt; // data<font></font>
// no libraries<font></font>
&lt;b b{00110} s, rot ref, swap ref, b&gt;  // create StateInit<font></font>
dup ."StateInit: " &lt;s csr. cr<font></font>
dup hash dup constant wallet_addr<font></font>
."new wallet address = " wc . .": " dup x. cr<font></font>
wc over 7 smca&gt;$ type cr<font></font>
256 u&gt;B "new-wallet.addr" B&gt;file<font></font>
&lt;b 0 32 u, b&gt;<font></font>
dup ."signing message: " &lt;s csr. cr<font></font>
dup hash wallet_pk ed25519_sign_uint rot<font></font>
&lt;b b{1000100} s, wc 8 i, wallet_addr 256 u, b{000010} s, swap &lt;s s, b{0} s, swap B, swap &lt;s s, b&gt;<font></font>
dup ."External message for initialization is " &lt;s csr. cr<font></font>
2 boc+&gt;B dup Bx. cr<font></font>
"new-wallet-query.boc" tuck B&gt;file<font></font>
."(Saved to file " type .")" cr</code></pre><br>
<p>       - —      <code>new-wallet-query.boc</code>  .  ,     ,    TON Virtual Machine (      ),       .</p><br>
<p> ,   TVM   Fift —       <code>crypto/fift/Asm.fif</code>        .</p><br>
<p>   , ,         :)</p><br>
<h2 id="sozdanie-smart-kontrakta-i-vzaimodeystvie-s-ton"> -    TON</h2><br>
<p>, ,    TON   Fift,   ,    .    -?      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">HOWTO</a>,   .</p><br>
<h3 id="akkaunty-v-ton">  TON</h3><br>
<p>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> TON</a>,       —   , .. «»,      «»,  32- .    -1,       «»    0.       .      ,     ,     .</p><br>
<p>      ,      account_id.         256 .  ,   , , :</p><br>
<pre><code class="plaintext hljs">-1:8156775b79325e5d62e742d9b96c30b6515a5cd2f1f64c5da4b193c03f070e0d</code></pre><br>
<p> «» :   ,  ,      .</p><br>
<p> ,    —         ,           Base64:</p><br>
<pre><code class="plaintext hljs">Ef+BVndbeTJeXWLnQtm5bDC2UVpc0vH2TF2ksZPAPwcODSkb</code></pre><br>
<p>   ,      -       </p><br>
<pre><code class="plaintext hljs">getaccount -1:8156775b79325e5d62e742d9b96c30b6515a5cd2f1f64c5da4b193c03f070e0d</code></pre><br>
<p>   :</p><br>
<pre><code class="plaintext hljs">[ 3][t 2][1558746708.815218925][test-lite-client.cpp:631][!testnode]    requesting account state for -1:8156775B79325E5D62E742D9B96C30B6515A5CD2F1F64C5DA4B193C03F070E0D<font></font>
[ 3][t 2][1558746708.858564138][test-lite-client.cpp:652][!testnode]    got account state for -1:8156775B79325E5D62E742D9B96C30B6515A5CD2F1F64C5DA4B193C03F070E0D with respect to blocks (-1,8000000000000000,72355):F566005749C1B97F18EDE013EBA7A054B9014961BC1AD91F475B9082919A2296:1BD5DE54333164025EE39D389ECE2E93DA2871DA616D488253953E52B50DC03F and (-1,8000000000000000,72355):F566005749C1B97F18EDE013EBA7A054B9014961BC1AD91F475B9082919A2296:1BD5DE54333164025EE39D389ECE2E93DA2871DA616D488253953E52B50DC03F<font></font>
account state is (account<font></font>
  addr:(addr_std<font></font>
    anycast:nothing workchain_id:-1 address:x8156775B79325E5D62E742D9B96C30B6515A5CD2F1F64C5DA4B193C03F070E0D)<font></font>
  storage_stat:(storage_info<font></font>
    used:(storage_used<font></font>
      cells:(var_uint len:1 value:3)<font></font>
      bits:(var_uint len:2 value:539)<font></font>
      public_cells:(var_uint len:0 value:0)) last_paid:0<font></font>
    due_payment:nothing)<font></font>
  storage:(account_storage last_trans_lt:74208000003<font></font>
    balance:(currencies<font></font>
      grams:(nanograms<font></font>
        amount:(var_uint len:7 value:999928362430000))<font></font>
      other:(extra_currencies<font></font>
        dict:hme_empty))<font></font>
    state:(account_active<font></font>
      (<font></font>
        split_depth:nothing<font></font>
        special:nothing<font></font>
        code:(just<font></font>
          value:(raw@^Cell <font></font>
            x{}<font></font>
             x{FF0020DDA4F260D31F01ED44D0D31FD166BAF2A1F80001D307D4D1821804A817C80073FB0201FB00A4C8CB1FC9ED54}<font></font>
            ))<font></font>
        data:(just<font></font>
          value:(raw@^Cell <font></font>
            x{}<font></font>
             x{0000000D}<font></font>
            ))<font></font>
        library:hme_empty))))<font></font>
x{CFF8156775B79325E5D62E742D9B96C30B6515A5CD2F1F64C5DA4B193C03F070E0D2068086C000000000000000451C90E00DC0E35B7DB5FB8C134_}<font></font>
 x{FF0020DDA4F260D31F01ED44D0D31FD166BAF2A1F80001D307D4D1821804A817C80073FB0201FB00A4C8CB1FC9ED54}<font></font>
 x{0000000D}</code></pre><br>
<p> ,    DHT  . ,   <code>storage.balance</code>    ,  <code>storage.state.code</code> —  -,   <code>storage.state.data</code> —   .  ,    TON — Cell,  —  ,        ,    .        .</p><br>
<h3 id="sborka-smart-kontrakta"> -</h3><br>
<p>      (  BOC — <em>bag of cells</em>)    Fift.  ,   -   —   <code>crypto/block</code>       <code>new-wallet.fif</code>,      .        (<code>~/liteclient-build</code>,      ).            Fift.</p><br>
<p>    :</p><br>
<pre><code class="plaintext hljs">./crypto/fift -I"&lt;source-directory&gt;/crypto/fift" new-wallet.fif</code></pre><br>
<p> <code>&lt;source-directory&gt;</code>        ( "~" ,  ,  ,   ).    <code>-I</code>     <code>FIFTPATH</code>      .</p><br>
<p>  Fift      <code>new-wallet.fif</code>,     .    ,        .</p><br>
<p>      - :</p><br>
<pre><code class="plaintext hljs">StateInit: x{34_}<font></font>
 x{FF0020DDA4F260810200D71820D70B1FED44D0D31FD3FFD15112BAF2A122F901541044F910F2A2F80001D31F3120D74A96D307D402FB00DED1A4C8CB1FCBFFC9ED54}<font></font>
 x{0000000055375F730EDC2292E8CB15C42E8036EE9C25AA958EE002D2DE48A205E3A3426B}<font></font>
<font></font>
new wallet address = -1 : 4fcd520b8fcca096b567d734be3528edc6bed005f6930a9ec9ac1aa714f211f2 <font></font>
0f9PzVILj8yglrVn1zS-NSjtxr7QBfaTCp7JrBqnFPIR8nhZ<font></font>
signing message: x{00000000}<font></font>
<font></font>
External message for initialization is x{89FEE120E20C7E953E31546F64C23CD654002C1AA919ADD24DB12DDF85C6F3B58AE41198A28AD8DAF3B9588E7A629252BA3DB88F030D00BC1016110B2073359EAC3C13823C53245B65D056F2C070B940CDA09789585935C7ABA4D2AD4BED139281CFA1200000001_}<font></font>
 x{FF0020DDA4F260810200D71820D70B1FED44D0D31FD3FFD15112BAF2A122F901541044F910F2A2F80001D31F3120D74A96D307D402FB00DED1A4C8CB1FCBFFC9ED54}<font></font>
 x{0000000055375F730EDC2292E8CB15C42E8036EE9C25AA958EE002D2DE48A205E3A3426B}<font></font>
<font></font>
B5EE9C724104030100000000D60002CF89FEE120E20C7E953E31546F64C23CD654002C1AA919ADD24DB12DDF85C6F3B58AE41198A28AD8DAF3B9588E7A629252BA3DB88F030D00BC1016110B2073359EAC3C13823C53245B65D056F2C070B940CDA09789585935C7ABA4D2AD4BED139281CFA1200000001001020084FF0020DDA4F260810200D71820D70B1FED44D0D31FD3FFD15112BAF2A122F901541044F910F2A2F80001D31F3120D74A96D307D402FB00DED1A4C8CB1FCBFFC9ED5400480000000055375F730EDC2292E8CB15C42E8036EE9C25AA958EE002D2DE48A205E3A3426B6290698B<font></font>
(Saved to file new-wallet-query.boc)</code></pre><br>
<p> ,     <code>-1:4fcd520b8fcca096b567d734be3528edc6bed005f6930a9ec9ac1aa714f211f2</code> (,    , <code>0f9PzVILj8yglrVn1zS-NSjtxr7QBfaTCp7JrBqnFPIR8nhZ</code>)  .       <code>new-wallet-query.boc</code>,   —  <code>new-wallet.addr</code>,    —  <code>new-wallet.pk</code> (  —      ).</p><br>
<p>,  TON      ,       .      . ,   ,    -   ,       .</p><br>
<p>          (    ).         -,      20   .</p><br>
<h3 id="formirovanie-zaprosa-k-chuzhomu-smart-kontraktu">    -</h3><br>
<p>  -,     ,  .      <code>crypto/block</code>   <code>testgiver.fif</code>:</p><br>
<pre><code class="plaintext hljs">// "testgiver.addr" file&gt;B 256 B&gt;u@ <font></font>
0x8156775b79325e5d62e742d9b96c30b6515a5cd2f1f64c5da4b193c03f070e0d<font></font>
dup constant wallet_addr ."Test giver address = " x. cr<font></font>
<font></font>
0x4fcd520b8fcca096b567d734be3528edc6bed005f6930a9ec9ac1aa714f211f2<font></font>
constant dest_addr<font></font>
<font></font>
-1 constant wc<font></font>
0x00000011 constant seqno<font></font>
<font></font>
1000000000 constant Gram<font></font>
{ Gram swap */ } : Gram*/<font></font>
<font></font>
6.666 Gram*/ constant amount<font></font>
<font></font>
// b x --&gt; b'  ( serializes a Gram amount )<font></font>
{ -1 { 1+ 2dup 8 * ufits } until<font></font>
  rot over 4 u, -rot 8 * u, } : Gram, <font></font>
<font></font>
// create a message (NB: 01b00.., b = bounce)<font></font>
&lt;b b{010000100} s, wc 8 i, dest_addr 256 u, amount Gram, 0 9 64 32 + + 1+ 1+ u, "GIFT" $, b&gt;<font></font>
&lt;b seqno 32 u, 1 8 u, swap ref, b&gt;<font></font>
dup ."enveloping message: " &lt;s csr. cr<font></font>
&lt;b b{1000100} s, wc 8 i, wallet_addr 256 u, 0 Gram, b{00} s,<font></font>
   swap &lt;s s, b&gt;<font></font>
dup ."resulting external message: " &lt;s csr. cr<font></font>
2 boc+&gt;B dup Bx. cr<font></font>
"wallet-query.boc" B&gt;file</code></pre><br>
<p>       ,     —   "<code>constant dest_addr</code>".      ,      (,  ). "-1:"     ,      "0x".</p><br>
<p>    <code>6.666 Gram*/ constant amount</code> —    ,    (  20).     ,   .</p><br>
<p>,    <code>0x00000011 constant seqno</code>.    —   sequence number,    ,  .   ?   ,    :</p><br>
<pre><code class="plaintext hljs">last<font></font>
getaccount -1:8156775b79325e5d62e742d9b96c30b6515a5cd2f1f64c5da4b193c03f070e0d</code></pre><br>
<p>     - </p><br>
<pre><code class="plaintext hljs">...<font></font>
x{FF0020DDA4F260D31F01ED44D0D31FD166BAF2A1F80001D307D4D1821804A817C80073FB0201FB00A4C8CB1FC9ED54}<font></font>
 x{0000000D}</code></pre><br>
<p> 0000000D (    )   sequence number,     <code>testgiver.fif</code>.</p><br>
<p>,     (<code>./crypto/fift testgiver.fif</code>).     <code>wallet-query.boc</code>.     <em></em>   - —&nbsp; « -   - ».</p><br>
<p>      :</p><br>
<pre><code class="plaintext hljs">&gt; sendfile wallet-query.boc<font></font>
[ 1][t 1][1558747399.456575155][test-lite-client.cpp:577][!testnode]    sending query from file wallet-query.boc<font></font>
[ 3][t 2][1558747399.500236034][test-lite-client.cpp:587][!query]   external message status is 1</code></pre><br>
<p>   <code>last</code>,      ,     ,    ,   sequence number    —  ,      .</p><br>
<p>   —     (   ,    -     ).  <code>sendfile new-wallet-query.boc</code> —  ,        TON (    ).</p><br>
<h3 id="sozdanie-ishodyaschih-tranzakciy">  </h3><br>
<p>      ,   <code>crypto/block/wallet.fif</code>,         .</p><br>
<p>  ,     ,   ,   (dest_addr),  seqno   (  1       1     —&nbsp;   ,    ).    , ,   —&nbsp;<code>0x4fcd520b8fcca096b567d734be3528edc6bed005f6930a9ec9ac1aa714f211f2</code>.</p><br>
<p>  (<code>./crypto/fift wallet.fif</code>)      (  )       <code>new-wallet.addr</code>  <code>new-wallet.pk</code>,      <code>new-wallet-query.boc</code>.</p><br>
<p>  ,    ,  <code>sendfile new-wallet-query.boc</code>  .        (<code>last</code>)  ,    seqno    (<code>getaccount &lt;account_id&gt;</code>).</p><br>
<p><img src="https://habrastorage.org/webt/fp/d1/is/fpd1is8dlh4_iz9rdbakflyeq5s.png" alt="アカウントの説明"></p><br>
<p>  ,     -  TON     .  ,    , , ,     c   (, ,         ).</p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja453700/index.html">SDL 2のレッスン：レッスン1-こんにちは、SDL 2</a></li>
<li><a href="../ja453706/index.html">Google Cloud Professional Data Engineer認定試験に合格した方法</a></li>
<li><a href="../ja453708/index.html">BASCOM AVR環境のMK AVR用AQUA RTOSリアルタイムOS</a></li>
<li><a href="../ja453710/index.html">大規模プロジェクトでの開発実践：mitap SberPractice iOS＃1</a></li>
<li><a href="../ja453712/index.html">eBayがWebAssemblyでバーコードスキャナーを実行した方法</a></li>
<li><a href="../ja453716/index.html">家族のIT担当者のための国のコワーキング-誰かいますか？</a></li>
<li><a href="../ja453720/index.html">Cでのラムダ式の微妙さ＃</a></li>
<li><a href="../ja453722/index.html">非定常プロセスの研究について</a></li>
<li><a href="../ja453728/index.html">ハイパースターの戦い</a></li>
<li><a href="../ja453730/index.html">現代の歯科：テクニカルディレクターの目を通して同時に行われる歯の移植と顎骨の拡張</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>