<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍🏫 🥚 🚛 Beberapa seluk-beluk koleksi injeksi di Spring 😯 🐡 🤦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya! Nama saya Vladislav Rodin. Saat ini saya mengajar kursus arsitektur perangkat lunak dan arsitektur perangkat lunak beban tinggi di port...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Beberapa seluk-beluk koleksi injeksi di Spring</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/487750/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Halo semuanya! </font><font style="vertical-align: inherit;">Nama saya Vladislav Rodin. </font><font style="vertical-align: inherit;">Saat ini saya mengajar kursus arsitektur perangkat lunak dan arsitektur perangkat lunak beban tinggi di portal OTUS. </font><font style="vertical-align: inherit;">Sekarang di OTUS ada set terbuka untuk utas baru dari kursus </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengembang pada Kerangka Musim Semi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Untuk mengantisipasi dimulainya kursus, saya memutuskan untuk menulis sedikit materi hak cipta yang ingin saya bagikan kepada Anda.</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/z-/xc/bw/z-xcbwfaea9ckpi7rtggkasvdmq.png"><br>
<hr><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Latar Belakang</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Musim semi mengandung banyak "sihir" dalam dirinya sendiri, melakukan beberapa hal yang tidak terlihat dengan sendirinya. </font><font style="vertical-align: inherit;">Ketidaktahuan atau kesalahpahaman tentang hal ini dapat menyebabkan efek samping yang mungkin Anda temui dalam proses penulisan aplikasi Anda menggunakan kerangka kerja ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Salah satu dari hal-hal yang tidak terlihat ini adalah injeksi antarmuka Java Collection Framework. </font><font style="vertical-align: inherit;">Setelah secara mandiri menginjak menyapu yang terkait dengan topik ini, dan setelah mendengar pertanyaan-pertanyaan berikutnya dari rekan-rekan saya, saya memutuskan untuk mengatasinya dan mencatat hasil penelitian saya dalam bentuk artikel dengan harapan bahwa itu akan membantu seseorang yang sudah bekerja atau selama pengembangan awal Spring.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Skenario</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita lihat layanan yang akan bekerja dengan para pahlawan film. </font><font style="vertical-align: inherit;">Akan ada 3 dari mereka: Rambo, Terminator dan Gandalf. </font><font style="vertical-align: inherit;">Masing-masing dari mereka akan mewakili kelas yang terpisah, dan orang tua mereka akan menjadi umum - Pahlawan.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hero</span> </span>{<font></font>
}<font></font>
<font></font>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Rambo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Hero</span> </span>{<font></font>
<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Rambo"</span>;<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Terminator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Hero</span> </span>{<font></font>
<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Terminator"</span>;<font></font>
    }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Gandalf</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Hero</span> </span>{
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Gandalf"</span>;<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daftar Injeksi</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita asumsikan bahwa kita ingin menciptakan layanan yang akan bekerja dengan para pahlawan militan. </font><font style="vertical-align: inherit;">Mungkin, Anda harus menyuntikkan daftar pahlawan seperti itu ke dalamnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak masalah! </font><font style="vertical-align: inherit;">Buat layanan dan konfigurasi:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Getter</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ActionHeroesService</span> </span>{
    <span class="hljs-meta">@Autowired</span><font></font>
    List&lt;Hero&gt; actionHeroes;<font></font>
}<font></font>
<font></font>
<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HeroesConfig</span> </span>{<font></font>
<font></font>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Hero&gt; <span class="hljs-title">action</span><span class="hljs-params">()</span> </span>{<font></font>
        List&lt;Hero&gt; result = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<font></font>
        result.add(<span class="hljs-keyword">new</span> Terminator());<font></font>
        result.add(<span class="hljs-keyword">new</span> Rambo());
        <span class="hljs-keyword">return</span> result;<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semuanya baik-baik saja, tetapi ketika memeriksa dapat ditemukan bahwa Gandalf ada dalam daftar! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Spring, melihat bahwa perlu untuk menyuntikkan Daftar, berkeliling biji yang terletak dalam konteks, menemukan di antara mereka semua yang sesuai dengan jenis generik, mengumpulkan Daftar dari mereka dan menyuntikkannya, mengabaikan Daftar kami. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagaimana cara membuat Spring melakukan apa yang kita inginkan?</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opsi 1. Kruk</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena masalahnya adalah tepatnya ketika mencoba menyuntikkan antarmuka Java Collection Framework, Anda cukup mengganti List dengan ArrayList di layanan dan, tentu saja, dalam konfigurasi sehingga Spring menemukan instance kelas yang kita butuhkan. </font><font style="vertical-align: inherit;">Maka semuanya akan berjalan sesuai harapan</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HeroesConfig</span> </span>{<font></font>
<font></font>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> ArrayList&lt;Hero&gt; <span class="hljs-title">action</span><span class="hljs-params">()</span> </span>{<font></font>
        ArrayList&lt;Hero&gt; result = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<font></font>
        result.add(<span class="hljs-keyword">new</span> Terminator());<font></font>
        result.add(<span class="hljs-keyword">new</span> Rambo());
        <span class="hljs-keyword">return</span> result;<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Getter</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ActionHeroesService</span> </span>{
    <span class="hljs-meta">@Autowired</span><font></font>
    ArrayList&lt;Hero&gt; actionHeroes;<font></font>
}<font></font>
</code></pre> <br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opsi 2. Lebih benar</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cara lain untuk mengikat tangan Spring adalah memintanya untuk menyuntikkan ke layanan tidak hanya Daftar apa pun, tetapi kacang dengan nama khusus, menambahkan Kualifikasi. </font><font style="vertical-align: inherit;">Dengan demikian, kita akan dapat menyuntikkan kacang kita.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Getter</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ActionHeroesService</span> </span>{
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-meta">@Qualifier("action")</span><font></font>
    List&lt;Hero&gt; actionHeroes;<font></font>
}<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peta Injeksi</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika banyak orang tahu tentang nuansa suntikan Daftar, maka pada umumnya keadaan menjadi lebih buruk dengan Peta. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita menulis layanan yang akan bekerja dengan karakter utama film. Peta akan disuntikkan ke dalamnya, berisi nama-nama film dengan kunci, dan oleh nilai-nilai kacang karakter utama:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Getter</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainCharactersService</span> </span>{
    <span class="hljs-meta">@Autowired</span><font></font>
    Map&lt;String, Hero&gt; mainCharactersByFilmName;<font></font>
}<font></font>
<font></font>
<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HeroesConfig</span> </span>{<font></font>
<font></font>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Map&lt;String, Hero&gt; <span class="hljs-title">mainCharactersByFilmName</span><span class="hljs-params">()</span> </span>{<font></font>
        Map&lt;String, Hero&gt; result = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();<font></font>
<font></font>
        result.put(<span class="hljs-string">"rambo"</span>, <span class="hljs-keyword">new</span> Rambo());<font></font>
        result.put(<span class="hljs-string">"terminator"</span>, <span class="hljs-keyword">new</span> Terminator());<font></font>
        result.put(<span class="hljs-string">"LOTR"</span>, <span class="hljs-keyword">new</span> Gandalf());<font></font>
<font></font>
        <span class="hljs-keyword">return</span> result;<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saat startup, Anda dapat melihat bahwa kunci Gandalf bukan LOTR, tetapi gandalf, dari mana kita dapat menyimpulkan bahwa itu bukan nama film yang ditulis, tetapi nama kacang, sedangkan dalam kasus Rimbaud dan terminator itu hanya beruntung: nama-nama karakter utama bertepatan dengan: judul film. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bahkan, ketika diperlukan untuk menyuntikkan Peta, kuncinya adalah String, dan nilai kacang, Spring (seperti dalam kasus Daftar) hanya akan mengabaikan Peta yang kami usulkan, pergi melalui konteks dan kumpulkan semua kacang yang cocok s, dan akan membuat Peta dengan mereka sebagai nilai dan dengan nama mereka sebagai kunci. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solusinya mirip dengan yang bekerja untuk Daftar:</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opsi 1. Kruk</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ganti Peta dengan HashMap:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Getter</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainCharactersService</span> </span>{
    <span class="hljs-meta">@Autowired</span><font></font>
    HashMap&lt;String, Hero&gt; mainCharactersByFilmName;<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HeroesConfig</span> </span>{<font></font>
<font></font>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> HashMap&lt;String, Hero&gt; <span class="hljs-title">mainCharactersByFilmName</span><span class="hljs-params">()</span> </span>{<font></font>
        HashMap&lt;String, Hero&gt; result = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();<font></font>
<font></font>
        result.put(<span class="hljs-string">"rambo"</span>, <span class="hljs-keyword">new</span> Rambo());<font></font>
        result.put(<span class="hljs-string">"terminator"</span>, <span class="hljs-keyword">new</span> Terminator());<font></font>
        result.put(<span class="hljs-string">"LOTR"</span>, <span class="hljs-keyword">new</span> Gandalf());<font></font>
<font></font>
        <span class="hljs-keyword">return</span> result;<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opsi 2. Lebih benar</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambahkan Kualifikasi:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Getter</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainCharactersService</span> </span>{
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-meta">@Qualifier("mainCharactersByFilmName")</span><font></font>
    Map&lt;String, Hero&gt; mainCharactersByFilmName;<font></font>
}<font></font>
<font></font>
</code></pre></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id487740/index.html">Merakit magnetometer portabel</a></li>
<li><a href="../id487742/index.html">Perdagangan Arbitrage (Algoritma Bellman-Ford)</a></li>
<li><a href="../id487744/index.html">FARO Memperkenalkan FOCUS S 70 Laser 3D Scanner</a></li>
<li><a href="../id487746/index.html">Kekal</a></li>
<li><a href="../id487748/index.html">Kunci enkripsi perangkat keras $ 3 - apakah ini mungkin?</a></li>
<li><a href="../id487752/index.html">Optimalkan penyimpanan: kasus penyatuan dan biaya kepemilikan yang lebih rendah</a></li>
<li><a href="../id487754/index.html">Organisasi intranet (otomatisasi produksi TI). Bagian 1 - Pengguna dan Email</a></li>
<li><a href="../id487756/index.html">RIT, Maxim Lapshin (Erlyvideo): bagaimana seorang programmer menumbuhkan perusahaan</a></li>
<li><a href="../id487764/index.html">Saya berusia 14 tahun dan saya menggabungkan sekolah dengan pekerjaan di bidang TI</a></li>
<li><a href="../id487768/index.html">Membuka porta 4321 dan 9898 pada Xiaomi Gateway 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>