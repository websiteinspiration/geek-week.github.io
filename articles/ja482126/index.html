<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✉️ 🔍 🥑 TensorFlowのKerasレビュー 🦃 🍧 👩🏻‍🤝‍👨🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tensorflow.orgの概要ガイドの翻訳。このガイドでは、Kerasを使い始めるための基本を説明します。読書には10分かかります。
 
 tf.kerasをインポートする
 tf.kerasKeras API仕様のTensorFlow実装です。これは、熱心な実行、パイプラインtf.data、推...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>TensorFlowのKerasレビュー</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482126/"><img src="https://habrastorage.org/webt/wz/o5/gm/wzo5gmjyybfdr1ea_lwtrhsjzvw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tensorflow.orgの概要ガイドの翻訳。</font><font style="vertical-align: inherit;">このガイドでは、Kerasを使い始めるための基本を説明します。</font><font style="vertical-align: inherit;">読書には10分かかります。</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tf.kerasをインポートする</font></font></h2><br>
<code>tf.keras</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keras API仕様のTensorFlow実装です。</font><font style="vertical-align: inherit;">これは、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">熱心な実行</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、パイプライン</font></font><code>tf.data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">推定器</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">などのTensorFlow固有の機能に対するファーストクラスのサポートを含む、モデルを構築およびトレーニングするための高レベルAPIです</font><font style="vertical-align: inherit;">。</font></font><code>tf.keras</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">柔軟性とパフォーマンスを犠牲にすることなくTensorFlowを使いやすくします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
はじめに、</font></font><code>tf.keras</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TensorFlowセットアップの一部として</font><font style="vertical-align: inherit;">インポート</font><font style="vertical-align: inherit;">します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> absolute_import, division, print_function, unicode_literals<font></font>
<font></font>
<span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf<font></font>
<font></font>
<span class="hljs-keyword">from</span> tensorflow <span class="hljs-keyword">import</span> keras</code></pre><br>
<code>tf.keras</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Keras互換のコードであればどれでも実行できますが、次の点に注意してください。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バージョン</font></font><code>tf.keras</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最新TensorFlowのリリースでは、最新バージョンと異なる場合があり</font></font><code>keras</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、PyPIインチ </font><font style="vertical-align: inherit;">ご覧ください</font></font><code>tf.keras.__version__</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モデルの重みを保存すると</font></font><code>tf.keras</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、デフォルトでチェックポイント形式で</font><font style="vertical-align: inherit;">保存</font><font style="vertical-align: inherit;">されます。</font></font><code>save_format='h5'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HDF5を使用する</font><font style="vertical-align: inherit;">ためにパラメーター</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">渡し</font><font style="vertical-align: inherit;">ます（またはファイル名に拡張子を追加します</font></font><code>.h5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">単純なモデルを作成する</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">順次モデル</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kerasでは、</font><i><font style="vertical-align: inherit;">モデル</font></i><font style="vertical-align: inherit;">を構築</font><font style="vertical-align: inherit;">するための</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レイヤー</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">収集し</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">モデルは（通常は）層グラフです。</font><font style="vertical-align: inherit;">最も一般的なモデルのタイプは、レイヤースタックのモデル</font></font><code>tf.keras.Sequential</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
単純な完全に接続されたネットワーク（つまり、多層パーセプトロン）を構築します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> tensorflow.keras <span class="hljs-keyword">import</span> layers<font></font>
<font></font>
model = tf.keras.Sequential()<font></font>
<span class="hljs-comment">#       64 :</span>
model.add(layers.Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">'relu'</span>))
<span class="hljs-comment">#   :</span>
model.add(layers.Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">'relu'</span>))
<span class="hljs-comment">#   softmax  10 :</span>
model.add(layers.Dense(<span class="hljs-number">10</span>, activation=<span class="hljs-string">'softmax'</span>))</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レイヤーをカスタマイズする</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの種類のレイヤーが利用可能です</font></font><code>tf.keras.layers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">それらのほとんどは、共通の引数コンストラクタを使用します。</font></font><br>
<br>
<ul>
<li><code>activation</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：レイヤーのアクティベーション機能を設定します。</font><font style="vertical-align: inherit;">このパラメーターは、組み込み関数または呼び出されるオブジェクトの名前を指定します。</font><font style="vertical-align: inherit;">パラメータにはデフォルト値はありません。</font></font></li>
<li><code>kernel_initializer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><code>bias_initializer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：レイヤーの重みを作成する初期化スキーム（コアとシフト）。</font><font style="vertical-align: inherit;">このパラメーターは、名前または呼び出されるオブジェクトにすることができます。</font><font style="vertical-align: inherit;">デフォルトでは、初期化子が使用され</font></font><code>"Glorot uniform"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font></li>
<li><code>kernel_regularizer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><code>bias_regularizer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：L1またはL2の正則化など、層の重み（コアとせん断）に追加された正則化スキーム。</font><font style="vertical-align: inherit;">デフォルトでは、正則化は設定されていません。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の `tf.keras.layers.Dense`レイヤーのインスタンスの例では、コンストラクター引数を使用しています。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#    :</span>
layers.Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">'sigmoid'</span>)
<span class="hljs-comment"># :</span>
layers.Dense(<span class="hljs-number">64</span>, activation=tf.keras.activations.sigmoid)<font></font>
<font></font>
<span class="hljs-comment">#     L1   0.01    :</span>
layers.Dense(<span class="hljs-number">64</span>, kernel_regularizer=tf.keras.regularizers.l1(<span class="hljs-number">0.01</span>))<font></font>
<font></font>
<span class="hljs-comment">#     L2   0.01    :</span>
layers.Dense(<span class="hljs-number">64</span>, bias_regularizer=tf.keras.regularizers.l2(<span class="hljs-number">0.01</span>))<font></font>
<font></font>
<span class="hljs-comment">#        :</span>
layers.Dense(<span class="hljs-number">64</span>, kernel_initializer=<span class="hljs-string">'orthogonal'</span>)<font></font>
<font></font>
<span class="hljs-comment">#        2.0:</span>
layers.Dense(<span class="hljs-number">64</span>, bias_initializer=tf.keras.initializers.Constant(<span class="hljs-number">2.0</span>))</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トレーニングと評価</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トレーニング設定</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モデルが構築されたら、メソッドを呼び出してトレーニングのプロセスを構成します</font></font><code>compile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="python hljs">model = tf.keras.Sequential([
<span class="hljs-comment">#     64   :</span>
layers.Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">'relu'</span>, input_shape=(<span class="hljs-number">32</span>,)),
<span class="hljs-comment">#  :</span>
layers.Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">'relu'</span>),
<span class="hljs-comment">#   softmax  10 :</span>
layers.Dense(<span class="hljs-number">10</span>, activation=<span class="hljs-string">'softmax'</span>)])<font></font>
<font></font>
model.compile(optimizer=tf.keras.optimizers.Adam(<span class="hljs-number">0.01</span>),<font></font>
              loss=<span class="hljs-string">'categorical_crossentropy'</span>,<font></font>
              metrics=[<span class="hljs-string">'accuracy'</span>])</code></pre><br>
<code>tf.keras.Model.compile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3つの重要な引数を取ります。</font></font><br>
<br>
<ul>
<li><code>optimizer</code>:     .        <code>tf.keras.optimizers</code>,   <code>tf.keras.optimizers.Adam</code>  <code>tf.keras.optimizers.SGD</code>.        ,       ,   <code>'adam'</code>  <code>'sgd'</code>.</li>
<li><code>loss</code>:       .      (<code>mse</code>), <code>categorical_crossentropy</code>, <code>binary_crossentropy</code>.            <code>tf.keras.losses</code>.</li>
<li><code>metrics</code>:    .         <code>tf.keras.metrics</code>.</li>
<li> ,   ,      eagerly,       <code>run_eagerly=True</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、トレーニング用のモデルの構成例をいくつか示します。</font></font><br>
 <br>
<pre><code class="python hljs"><span class="hljs-comment">#       .</span>
model.compile(optimizer=tf.keras.optimizers.Adam(<span class="hljs-number">0.01</span>),<font></font>
              loss=<span class="hljs-string">'mse'</span>,       <span class="hljs-comment"># mean squared error</span>
              metrics=[<span class="hljs-string">'mae'</span>])  <span class="hljs-comment"># mean absolute error</span><font></font>
<font></font>
<span class="hljs-comment">#     .</span>
model.compile(optimizer=tf.keras.optimizers.RMSprop(<span class="hljs-number">0.01</span>),<font></font>
              loss=tf.keras.losses.CategoricalCrossentropy(),<font></font>
              metrics=[tf.keras.metrics.CategoricalAccuracy()])</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NumPyデータからの学習</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
小さいデータセットの場合は、NumPyのメモリ配列を使用してモデルをトレーニングおよび評価します。</font><font style="vertical-align: inherit;">モデルは、 `fit`メソッドを使用してトレーニングデータで「トレーニング」されます。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<font></font>
<font></font>
data = np.random.random((<span class="hljs-number">1000</span>, <span class="hljs-number">32</span>))<font></font>
labels = np.random.random((<span class="hljs-number">1000</span>, <span class="hljs-number">10</span>))<font></font>
<font></font>
model.fit(data, labels, epochs=<span class="hljs-number">10</span>, batch_size=<span class="hljs-number">32</span>)</code></pre><br>
<code>tf.keras.Model.fit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3つの重要な引数を取ります。</font></font><br>
<br>
<ul>
<li><code>epochs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：学習は*時代*に分けられます。</font><font style="vertical-align: inherit;">時代はすべての入力データの1回の反復です（これは小さなバッチで行われます）。</font></font></li>
<li><code>batch_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：NumPyデータを送信する場合、モデルはデータを小さなブロック（バッチ）に分割し、トレーニング中にこれらのブロックを反復します。</font><font style="vertical-align: inherit;">この数値は、各データブロックのサイズを示します。</font><font style="vertical-align: inherit;">レコードの総数がバッチサイズで除算されない場合、最後のブロックが小さくなる可能性があることに注意してください。</font></font></li>
<li><code>validation_data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：モデルのプロトタイプを作成するとき、検証データのパフォーマンスを簡単に追跡する必要があります。</font><font style="vertical-align: inherit;">この引数とともに入力データとラベルのタプルを渡すと、モデルは各時代の終わりに送信されるデータの出力モードで損失関数とメトリックの値を表示できます。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に使用例を示し</font></font><code>validation_data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<font></font>
<font></font>
data = np.random.random((<span class="hljs-number">1000</span>, <span class="hljs-number">32</span>))<font></font>
labels = np.random.random((<span class="hljs-number">1000</span>, <span class="hljs-number">10</span>))<font></font>
<font></font>
val_data = np.random.random((<span class="hljs-number">100</span>, <span class="hljs-number">32</span>))<font></font>
val_labels = np.random.random((<span class="hljs-number">100</span>, <span class="hljs-number">10</span>))<font></font>
<font></font>
model.fit(data, labels, epochs=<span class="hljs-number">10</span>, batch_size=<span class="hljs-number">32</span>,<font></font>
          validation_data=(val_data, val_labels))</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tf.dataデータセットを使用したトレーニング</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Datasets APIを使用して、大規模なデータベースをスケーリングしたり、複数のデバイスにわたってトレーニングしたりします。</font><font style="vertical-align: inherit;">`tf.data.Dataset`のインスタンスをメソッドに渡します</font></font><code>fit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#    :</span><font></font>
dataset = tf.data.Dataset.from_tensor_slices((data, labels))<font></font>
dataset = dataset.batch(<span class="hljs-number">32</span>)<font></font>
<font></font>
model.fit(dataset, epochs=<span class="hljs-number">10</span>)</code></pre><br><font style="vertical-align: inherit;"></font><code>Dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データをバッチ</font><font style="vertical-align: inherit;">
で</font><font style="vertical-align: inherit;">出力する</font><font style="vertical-align: inherit;">ため</font><font style="vertical-align: inherit;">、このコードは引数を必要としません</font></font><code>batch_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データセットは、以下の検証にも使用できます。</font></font><br>
<br>
<pre><code class="python hljs">dataset = tf.data.Dataset.from_tensor_slices((data, labels))<font></font>
dataset = dataset.batch(<span class="hljs-number">32</span>)<font></font>
<font></font>
val_dataset = tf.data.Dataset.from_tensor_slices((val_data, val_labels))<font></font>
val_dataset = val_dataset.batch(<span class="hljs-number">32</span>)<font></font>
<font></font>
model.fit(dataset, epochs=<span class="hljs-number">10</span>,<font></font>
          validation_data=val_dataset)</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">評価と予測</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メソッド</font></font><code>tf.keras.Model.evaluate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>tf.keras.Model.predict</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NumPy </font><font style="vertical-align: inherit;">および</font><font style="vertical-align: inherit;">を使用できます</font></font><code>tf.data.Dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは</font><font style="vertical-align: inherit;">、出力モードで</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">損失と提供されたデータのメトリックを</font><i><font style="vertical-align: inherit;">評価する</font></i><font style="vertical-align: inherit;">方法です</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#   Numpy</span>
data = np.random.random((<span class="hljs-number">1000</span>, <span class="hljs-number">32</span>))<font></font>
labels = np.random.random((<span class="hljs-number">1000</span>, <span class="hljs-number">10</span>))<font></font>
<font></font>
model.evaluate(data, labels, batch_size=<span class="hljs-number">32</span>)<font></font>
<font></font>
<span class="hljs-comment">#  </span><font></font>
dataset = tf.data.Dataset.from_tensor_slices((data, labels))<font></font>
dataset = dataset.batch(<span class="hljs-number">32</span>)<font></font>
<font></font>
model.evaluate(dataset)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、ここ</font><font style="vertical-align: inherit;">で、提供されたデータの出力モードで最後のレベルの出力をNumPy配列として</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">予測する</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法を示し</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">複雑なモデルの構築</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機能API</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モデル</font></font><code>tf.keras.Sequential</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、任意のモデルを想像できない単純なレイヤースタックです。</font><font style="vertical-align: inherit;">Keras機能APIを使用して、次のような複雑なモデルトポロジを構築します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">複数の入力モデル</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">複数の出力を持つモデル、</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">共通のレイヤーを持つモデル（同じレイヤーが複数回呼び出されます）、</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一貫性のないデータストリーム（残差関係など）を持つモデル。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
関数型APIを使用したモデルの構築は、次のように機能します。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レイヤーインスタンスは呼び出し可能で、テンソルを返します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">入力と出力のテンソルを使用してインスタンスを決定します。 </font></font><code>tf.keras.Model</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このモデルは、「順次」モデルと同じようにトレーニングされます。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の例では、機能APIを使用して、完全に接続されたシンプルなネットワークを構築しています。</font></font><br>
<br>
<pre><code class="python hljs">inputs = tf.keras.Input(shape=(<span class="hljs-number">32</span>,))  <span class="hljs-comment">#   </span><font></font>
<font></font>
<span class="hljs-comment">#        .</span>
x = layers.Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">'relu'</span>)(inputs)<font></font>
x = layers.Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">'relu'</span>)(x)<font></font>
predictions = layers.Dense(<span class="hljs-number">10</span>, activation=<span class="hljs-string">'softmax'</span>)(x)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの入力と出力を使用してモデルインスタンスを作成します。</font></font><br>
<br>
<pre><code class="python hljs">model = tf.keras.Model(inputs=inputs, outputs=predictions)<font></font>
<font></font>
<span class="hljs-comment">#     .</span>
model.compile(optimizer=tf.keras.optimizers.RMSprop(<span class="hljs-number">0.001</span>),<font></font>
              loss=<span class="hljs-string">'categorical_crossentropy'</span>,<font></font>
              metrics=[<span class="hljs-string">'accuracy'</span>])<font></font>
<font></font>
<span class="hljs-comment">#    5 </span>
model.fit(data, labels, batch_size=<span class="hljs-number">32</span>, epochs=<span class="hljs-number">5</span>)</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モデルのサブクラス化</font></font></h3><br><font style="vertical-align: inherit;"></font><code>tf.keras.Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">独自の直接分布</font><font style="vertical-align: inherit;">
をサブクラス化</font><font style="vertical-align: inherit;">および定義して</font><font style="vertical-align: inherit;">、完全にカスタマイズ可能なモデルを作成します</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">メソッド内にレイヤーを作成し、</font></font><code>__init__</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それらをクラスインスタンスの属性として設定します。</font><font style="vertical-align: inherit;">メソッドで直接分布を定義し</font></font><code>call</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モデルをサブクラス化すると、意欲的な実行が有効になっている場合に特に役立ちます。これにより、直接分散を命令的に記述することができるからです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注：モデルを</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">常に</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必須にする</font></font><code>dynamic=True</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">場合は、コンストラクターを呼び出すときに</font><font style="vertical-align: inherit;">設定でき</font><font style="vertical-align: inherit;">ます</font></font><code>super</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要なポイント：正しいAPIを使用して動作します。</font><font style="vertical-align: inherit;">モデルをサブクラス化すると柔軟性が得られますが、複雑でカスタムエラーが発生する可能性が高いため、その代償を払う必要があります。</font><font style="vertical-align: inherit;">可能であれば、機能APIを選択してください。</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次の例は、</font></font><code>tf.keras.Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスタムの直接配布を使用し</font><font style="vertical-align: inherit;">たサブクラス化されたモデル</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">示していますが、</font><font style="vertical-align: inherit;">必須ではありません。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyModel</span>(<span class="hljs-params">tf.keras.Model</span>):</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, num_classes=<span class="hljs-number">10</span></span>):</span>
    super(MyModel, self).__init__(name=<span class="hljs-string">'my_model'</span>)<font></font>
    self.num_classes = num_classes<font></font>
    <span class="hljs-comment">#    .</span>
    self.dense_1 = layers.Dense(<span class="hljs-number">32</span>, activation=<span class="hljs-string">'relu'</span>)<font></font>
    self.dense_2 = layers.Dense(num_classes, activation=<span class="hljs-string">'sigmoid'</span>)<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call</span>(<span class="hljs-params">self, inputs</span>):</span>
    <span class="hljs-comment">#     ,</span>
    <span class="hljs-comment">#      ( `__init__`).</span><font></font>
    x = self.dense_1(inputs)<font></font>
    <span class="hljs-keyword">return</span> self.dense_2(x)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいモデルクラスのインスタンスを作成します。</font></font><br>
<br>
<pre><code class="python hljs">model = MyModel(num_classes=<span class="hljs-number">10</span>)<font></font>
<font></font>
<span class="hljs-comment">#     .</span>
model.compile(optimizer=tf.keras.optimizers.RMSprop(<span class="hljs-number">0.001</span>),<font></font>
              loss=<span class="hljs-string">'categorical_crossentropy'</span>,<font></font>
              metrics=[<span class="hljs-string">'accuracy'</span>])<font></font>
<font></font>
<span class="hljs-comment">#   5 .</span>
model.fit(data, labels, batch_size=<span class="hljs-number">32</span>, epochs=<span class="hljs-number">5</span>)</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスタムレイヤー</font></font></h3><br><font style="vertical-align: inherit;"></font><code>tf.keras.layers.Layer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次のメソッドを</font><font style="vertical-align: inherit;">
サブクラス化</font><font style="vertical-align: inherit;">して実装すること</font><font style="vertical-align: inherit;">により、カスタムレイヤーを作成します</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<ul>
<li><code>__init__</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：オプションで、このレイヤーで使用するサブレイヤーを指定します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* </font></font><code>build</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：レイヤーの重みを作成します。</font><font style="vertical-align: inherit;">メソッドを使用して重みを追加する</font></font><code>add_weight</code></li>
<li><code>call</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：直接配布を定義します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オプションで、メソッド</font></font><code>get_config</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">とクラスメソッドを</font><font style="vertical-align: inherit;">実装することにより、レイヤーをシリアル化できます</font></font><code>from_config</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下は、</font></font><code>matmul</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">入力に適用された</font><font style="vertical-align: inherit;">行列（</font><font style="vertical-align: inherit;">）とカーネル行列</font><font style="vertical-align: inherit;">を乗算するユーザー層の例です</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyLayer</span>(<span class="hljs-params">layers.Layer</span>):</span><font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, output_dim, **kwargs</span>):</span><font></font>
    self.output_dim = output_dim<font></font>
    super(MyLayer, self).__init__(**kwargs)<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build</span>(<span class="hljs-params">self, input_shape</span>):</span>
    <span class="hljs-comment">#       .</span>
    self.kernel = self.add_weight(name=<span class="hljs-string">'kernel'</span>,<font></font>
                                  shape=(input_shape[<span class="hljs-number">1</span>], self.output_dim),<font></font>
                                  initializer=<span class="hljs-string">'uniform'</span>,<font></font>
                                  trainable=<span class="hljs-literal">True</span>)<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call</span>(<span class="hljs-params">self, inputs</span>):</span>
    <span class="hljs-keyword">return</span> tf.matmul(inputs, self.kernel)<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_config</span>(<span class="hljs-params">self</span>):</span><font></font>
    base_config = super(MyLayer, self).get_config()<font></font>
    base_config[<span class="hljs-string">'output_dim'</span>] = self.output_dim
    <span class="hljs-keyword">return</span> base_config<font></font>
<font></font>
<span class="hljs-meta">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">from_config</span>(<span class="hljs-params">cls, config</span>):</span>
    <span class="hljs-keyword">return</span> cls(**config)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カスタムレイヤーを使用してモデルを作成します。</font></font><br>
<br>
<pre><code class="python hljs">model = tf.keras.Sequential([<font></font>
    MyLayer(<span class="hljs-number">10</span>),<font></font>
    layers.Activation(<span class="hljs-string">'softmax'</span>)])<font></font>
<font></font>
<span class="hljs-comment">#     </span>
model.compile(optimizer=tf.keras.optimizers.RMSprop(<span class="hljs-number">0.001</span>),<font></font>
              loss=<span class="hljs-string">'categorical_crossentropy'</span>,<font></font>
              metrics=[<span class="hljs-string">'accuracy'</span>])<font></font>
<font></font>
<span class="hljs-comment">#   5 .</span>
model.fit(data, labels, batch_size=<span class="hljs-number">32</span>, epochs=<span class="hljs-number">5</span>)</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コルベキ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kolbekは、トレーニング中にその動作をカスタマイズおよび拡張するためにモデルに転送されるオブジェクトです。</font><font style="vertical-align: inherit;">独自のカスタムコールバックを作成するか、または組み込みのコールバック</font></font><code>tf.keras.callbacks</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用でき</font></font><br>
<br>
<code>tf.keras.callbacks.ModelCheckpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<code>tf.keras.callbacks.LearningRateScheduler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：学習ステップの動的な変化。</font></font><br>
<code>tf.keras.callbacks.EarlyStopping</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：検証の結果が改善しなくなったときにトレーニングを停止します。</font><font style="vertical-align: inherit;">
TensorBoard </font><font style="vertical-align: inherit;">
を使用して</font></font><br>
<code>tf.keras.callbacks.TensorBoard:</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モデルの動作を監視</font><font style="vertical-align: inherit;">するを使用するには</font><font style="vertical-align: inherit;">、それをモデルメソッドに渡します</font><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><code>tf.keras.callbacks.Callback</code><font style="vertical-align: inherit;"></font><code>fit</code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">callbacks = [
  <span class="hljs-comment">#    `val_loss`     2 </span>
  tf.keras.callbacks.EarlyStopping(patience=<span class="hljs-number">2</span>, monitor=<span class="hljs-string">'val_loss'</span>),
  <span class="hljs-comment">#   TensorBoard   `./logs` directory</span>
  tf.keras.callbacks.TensorBoard(log_dir=<span class="hljs-string">'./logs'</span>)<font></font>
]<font></font>
model.fit(data, labels, batch_size=<span class="hljs-number">32</span>, epochs=<span class="hljs-number">5</span>, callbacks=callbacks,<font></font>
          validation_data=(val_data, val_labels))</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保存と復元</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重量値のみを保存する</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下を使用してモデルの重みを保存およびロードします</font></font><code>tf.keras.Model.save_weights</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="python hljs">model = tf.keras.Sequential([<font></font>
layers.Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">'relu'</span>, input_shape=(<span class="hljs-number">32</span>,)),<font></font>
layers.Dense(<span class="hljs-number">10</span>, activation=<span class="hljs-string">'softmax'</span>)])<font></font>
<font></font>
model.compile(optimizer=tf.keras.optimizers.Adam(<span class="hljs-number">0.001</span>),<font></font>
              loss=<span class="hljs-string">'categorical_crossentropy'</span>,<font></font>
              metrics=[<span class="hljs-string">'accuracy'</span>])</code></pre><br>
<pre><code class="python hljs"><span class="hljs-comment">#     TensorFlow Checkpoint</span>
model.save_weights(<span class="hljs-string">'./weights/my_model'</span>)<font></font>
<font></font>
<span class="hljs-comment">#   </span>
<span class="hljs-comment">#        .     </span>
model.load_weights(<span class="hljs-string">'./weights/my_model'</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デフォルトでは、モデルの重みはTensorFlowチェックポイント形式で保存されます。</font><font style="vertical-align: inherit;">重みは、Keras HDF5形式（Kerasユニバーサル実装のデフォルト値）で保存することもできます。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#     HDF5</span>
model.save_weights(<span class="hljs-string">'my_model.h5'</span>, save_format=<span class="hljs-string">'h5'</span>)<font></font>
<font></font>
<span class="hljs-comment">#   </span>
model.load_weights(<span class="hljs-string">'my_model.h5'</span>)</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モデル構成のみを保存しています</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モデルの構成を保存できます。これにより、重みなしでモデルのアーキテクチャがシリアル化されます。</font><font style="vertical-align: inherit;">保存された構成は、元のモデルを定義するコードがなくても、同じモデルを復元して初期化できます。</font><font style="vertical-align: inherit;">KerasはJSONおよびYAMLシリアル化フォーマットをサポートしています：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#     JSON</span><font></font>
json_string = model.to_json()<font></font>
json_string</code></pre><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> json
<span class="hljs-keyword">import</span> pprint<font></font>
pprint.pprint(json.loads(json_string))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JSONから（再初期化された）モデルを復元する：</font></font><br>
<br>
<pre><code class="python hljs">fresh_model = tf.keras.models.model_from_json(json_string)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モデルをYAMLにシリアル化</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">するに</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、TensorFlow </font><i><font style="vertical-align: inherit;">をインポートする前</font></i><font style="vertical-align: inherit;">に「pyyaml」をインストールする必要があります</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="python hljs">yaml_string = model.to_yaml()<font></font>
print(yaml_string)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
YAMLからモデルを復元する：</font></font><br>
<br>
<pre><code class="python hljs">fresh_model = tf.keras.models.model_from_yaml(yaml_string)</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：サブクラス化されたモデルは、 `call`メソッドの本体のPythonコードによって定義されるため、シリアル化できません。</font></font></blockquote><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モデル全体を1つのファイルに保存する</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モデル全体は、重みの値、モデルの構成、さらにはオプティマイザーの構成を含むファイルに保存できます。</font><font style="vertical-align: inherit;">これにより、モデルのブレークポイントを設定し、ソースコードにアクセスしなくても、まったく同じ位置から後でトレーニングを続けることができます。</font></font><br>
<br>
<pre><code class="plaintext hljs">#   <font></font>
model = tf.keras.Sequential([<font></font>
  layers.Dense(10, activation='softmax', input_shape=(32,)),<font></font>
  layers.Dense(10, activation='softmax')<font></font>
])<font></font>
model.compile(optimizer='rmsprop',<font></font>
              loss='categorical_crossentropy',<font></font>
              metrics=['accuracy'])<font></font>
model.fit(data, labels, batch_size=32, epochs=5)<font></font>
<font></font>
#      HDF5<font></font>
model.save('my_model.h5')<font></font>
<font></font>
#         .<font></font>
model = tf.keras.models.load_model('my_model.h5')</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">熱心な実行</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
熱心な実行は、操作をすぐに実行する必須のプログラミング環境です。</font><font style="vertical-align: inherit;">これはKerasには必要ありませんが、サポートされて</font></font><code>tf.keras</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">おり、プログラムのチェックとデバッグに役立ちます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
`tf.keras` APIのすべての構築モデルは、熱心な実行と互換性があります。</font><font style="vertical-align: inherit;">「順次」APIと関数型APIを使用することもできますが、熱心な実行は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、モデル</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><i><font style="vertical-align: inherit;">サブクラス化して</font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスタムレイヤー</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を構築</font><i><font style="vertical-align: inherit;">する</font></i><font style="vertical-align: inherit;">ときに特に役立ち</font><font style="vertical-align: inherit;">ます。これらのAPIでは、（既存のレイヤーを組み立ててモデルを作成するAPIの代わりに）コードの形式で直接配布する必要があります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分布</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">複数のGPU</font></font></h3><br>
<code>tf.keras</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モデルは、を使用して複数のGPUで実行できます</font></font><code>tf.distribute.Strategy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このAPIは、既存のコードをほとんどまたはまったく変更せずに、複数のGPUに分散学習を提供します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現在、</font></font><code>tf.distribute.MirroredStrategy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サポートされて</font><font style="vertical-align: inherit;">いる</font><font style="vertical-align: inherit;">唯一の配布戦略。</font><font style="vertical-align: inherit;">
同じマシン上でall-reduceを使用</font></font><code>MirroredStrategy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">して</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同期学習を</font><font style="vertical-align: inherit;">行うグラフでレプリケーションを実行します</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">` </font></font><code>distribute.Strategy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">` </font><font style="vertical-align: inherit;">を使用するに</font><font style="vertical-align: inherit;">は、オプティマイザのインス​​トールをネストし、 ` </font></font><code>Strategy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">` ` </font></font><code>.scope()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">`で</font><font style="vertical-align: inherit;">モデルを構築およびコンパイルしてから、モデルを</font><font style="vertical-align: inherit;">トレーニングします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の例</font></font><code>tf.keras.Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、同じマシン上の複数のGPU間で分散します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、分散戦略の領域内でモデルを定義します。</font></font><br>
<br>
<pre><code class="python hljs">strategy = tf.distribute.MirroredStrategy()<font></font>
<font></font>
<span class="hljs-keyword">with</span> strategy.scope():<font></font>
  model = tf.keras.Sequential()<font></font>
  model.add(layers.Dense(<span class="hljs-number">16</span>, activation=<span class="hljs-string">'relu'</span>, input_shape=(<span class="hljs-number">10</span>,)))<font></font>
  model.add(layers.Dense(<span class="hljs-number">1</span>, activation=<span class="hljs-string">'sigmoid'</span>))<font></font>
<font></font>
  optimizer = tf.keras.optimizers.SGD(<span class="hljs-number">0.2</span>)<font></font>
<font></font>
  model.compile(loss=<span class="hljs-string">'binary_crossentropy'</span>, optimizer=optimizer)<font></font>
<font></font>
model.summary()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、通常どおりデータでモデルをトレーニングします。</font></font><br>
<br>
<pre><code class="python hljs">x = np.random.random((<span class="hljs-number">1024</span>, <span class="hljs-number">10</span>))<font></font>
y = np.random.randint(<span class="hljs-number">2</span>, size=(<span class="hljs-number">1024</span>, <span class="hljs-number">1</span>))<font></font>
x = tf.cast(x, tf.float32)<font></font>
dataset = tf.data.Dataset.from_tensor_slices((x, y))<font></font>
dataset = dataset.shuffle(buffer_size=<span class="hljs-number">1024</span>).batch(<span class="hljs-number">32</span>)<font></font>
<font></font>
model.fit(dataset, epochs=<span class="hljs-number">1</span>)</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">検証後、翻訳はTensorflow.orgにも表示されます。</font><font style="vertical-align: inherit;">Tensorflow.orgウェブサイトのドキュメントのロシア語への翻訳に参加したい場合は、個人またはコメントでご連絡ください。</font><font style="vertical-align: inherit;">修正やコメントはありがたいです。</font></font></i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja482106/index.html">Habr Freelance 2019：今年の結果</a></li>
<li><a href="../ja482108/index.html">静かな知性。潜在的なWEB脆弱性を特定する方法</a></li>
<li><a href="../ja482110/index.html">Linuxは私の名刺で動作します</a></li>
<li><a href="../ja482114/index.html">Djangoアプリケーションからasyncioとaiohttpを使用してメールを送信する</a></li>
<li><a href="../ja482118/index.html">Docker API + Portainer API =利益</a></li>
<li><a href="../ja482128/index.html">gReebokが検出されました。皮膚科医自身</a></li>
<li><a href="../ja482130/index.html">異なるフォレストのドメインユーザーへの権利の大規模な割り当て</a></li>
<li><a href="../ja482134/index.html">ハイブリッドの比較、またはルーマニア語Mezeヘッドフォンの所有者に84 990ルーブルと239 990ルーブルの期待値</a></li>
<li><a href="../ja482136/index.html">モノブランドプロジェクトは、アグリゲーターと検索エンジンの内部サービスを倒すことによって、どのようにしてTOPに入ることができますか</a></li>
<li><a href="../ja482140/index.html">4〜10歳の若いプログラマー向けのボードゲーム。2019年末に市場で見つけることができるもの</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>