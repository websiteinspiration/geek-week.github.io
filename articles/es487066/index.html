<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßïüèø üíáüèΩ üåä Trabaja con el chip chino ADC Hx711 üëÉüèº üéÇ ‚Ü™Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La raz√≥n para escribir esta publicaci√≥n es el deseo de tratar con el convertidor ADC delta sigma del m√≥dulo de 24 bits basado en el chip Hx711. El con...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Trabaja con el chip chino ADC Hx711</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/487066/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La raz√≥n para escribir esta publicaci√≥n es el deseo de tratar con el convertidor ADC delta sigma del m√≥dulo de 24 bits basado en el chip Hx711. </font><font style="vertical-align: inherit;">El convertidor en s√≠ mismo se ensambla en forma de un m√≥dulo listo para usar de acuerdo con el circuito de conmutaci√≥n recomendado por el fabricante (????). </font><font style="vertical-align: inherit;">Hay comentarios sobre el funcionamiento de este m√≥dulo en este sitio en el blog de Andrey Gerasimenko </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"ADC 711 de 3.3V- no creo en la documentaci√≥n china y no solo ..."</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para probar este m√≥dulo, se ensambl√≥ un circuito basado en el microcontrolador ATmega16, el m√≥dulo ADC, el LCD de dos l√≠neas BC1602, basado en el controlador HD44780, cuatro botones. Como entorno de desarrollo, utilizamos el programa AVR Code Vision, versi√≥n 1.25.9 profesional, AVR Studio 4, versi√≥n 4.09.0.338, el programador USB AVR JTAG, que permite no solo programar el cristal, sino tambi√©n seguir paso a paso, si es necesario, la ejecuci√≥n del programa en el microcontrolador, Casi en tiempo real.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dn/yi/hh/dnyihhcg8d2ckj5tzu68ae5f_cg.jpeg"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se eligi√≥ una celda de carga de fabricaci√≥n china con un l√≠mite de peso m√°ximo de 40 kg como fuente de se√±al para el ADC. y unidad de inserci√≥n de sensor est√°ndar. Cabe se√±alar que el uso de unidades de integraci√≥n "nativas" le permite obtener todos los datos de salida postulados de un extens√≠metro de punto √∫nico, modelo CZL A6. Por lo tanto, los medidores de tensi√≥n de tipo Single Point, cuando se utiliza el tama√±o especificado en las especificaciones t√©cnicas de la plataforma para la ubicaci√≥n de la carga pesada, est√°n dise√±ados de modo que la se√±al de desequilibrio del puente de tracci√≥n no dependa de la posici√≥n de la carga en la plataforma. Son las propiedades MEC√ÅNICAS del cuerpo del sensor: las dimensiones geom√©tricas, la ubicaci√≥n de las pel√≠culas de galgas extensom√©tricas pegadas, especialmente el recorte de "hueso" en el medio del cuerpo del sensor, el tama√±o de la plataforma que afecta el par aplicado al cuerpo del sensor determina esta independencia.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/k1/jp/zw/k1jpzwxmwwbmdko-l2o7tj_bfbc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bueno, la √∫ltima fuente es "GOST 29329-92. B√°sculas para pesaje est√°tico. Requisitos t√©cnicos generales. Este GOST define las propiedades de los instrumentos de medici√≥n de peso. Tambi√©n es importante trabajar con el programa de oficina EXCEL. Estoy usando EXCEL 2003 XP3. Esto le permite procesar r√°pidamente los resultados utilizando m√©todos preparados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Espero que toda la informaci√≥n necesaria para repetir mis experimentos se d√© completamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora el programa en s√≠ que utilizo para trabajar con el m√≥dulo. El programa se centra en CHECK, y apenas directamente, es decir. sin cambios, se puede aplicar para algunas necesidades aplicadas. Aunque, como dicen, "depende de d√≥nde presentar la solicitud".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El programa en s√≠ es una estructura de bloques. Consta de 4 rutinas y la quinta principal principal. La primera subrutina: ReadCount, lee los datos del m√≥dulo ADC y los genera en la variable Count. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CreatInput, genera una matriz de entrada de datos de conversi√≥n a partir de 32 valores. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CreatOutput, genera una matriz de salida de datos de conversi√≥n ADC mediante la organizaci√≥n de un promedio m√≥vil con un tama√±o de ventana de 16 datos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Keys, un programa simple para responder a las pulsaciones de teclas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces eso es todo. Las variables son b√°sicamente todas globales, especialmente porque se permiten mega recursos.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/md/z4/xz/mdz4xz4rpghbubo4yfc4luas2y4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El programa principal comienza creando la matriz de entrada CreatInput, luego los datos de entrada se filtran utilizando el m√©todo de promedio m√≥vil. La selecci√≥n de este filtro se basa en lo siguiente. Cuando el programa se est√° ejecutando, los datos en la pantalla cambian su valor en un rango bastante grande. He tomado los valores del ADC con cero esfuerzo en la plataforma y tabulado. Los valores se obtuvieron utilizando el depurador USB JATAG en el entorno AVR Studio. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8w/x7/ne/8wx7ne82a80fp4ofgryytwhza7s.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el archivo de Excel "Adquisici√≥n de datos", en la pesta√±a "Media m√≥vil", se muestra el resultado de filtrar datos de InputBuff oscilantes (amplitud de oscilaci√≥n de 436 unidades) con una ventana de promedio de 3.12.16 intervalos. El resultado se muestra en las celdas A37-A40. De lo cual se ve que lo m√°s efectivo, en este caso, es una media m√≥vil con una ventana de 16 muestras.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los gr√°ficos construidos muestran esto claramente. </font><font style="vertical-align: inherit;">Los datos se toman de un controlador en funcionamiento, se detiene en el momento de la transici√≥n al procedimiento de visualizaci√≥n de datos. </font><font style="vertical-align: inherit;">En las im√°genes se muestran ejemplos ilustrativos de dicha captura de datos. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/li/d2/5s/lid25s7vqelzw_hlumiy2uol9qa.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ning√∫n m√©todo de filtrado de datos, mediante el uso de varios filtros digitales, podr√≠a "domesticar" las fluctuaciones de entrada. </font><font style="vertical-align: inherit;">Si observa el gr√°fico de los datos de entrada, la distribuci√≥n gaussiana aqu√≠ ni siquiera "huele". </font><font style="vertical-align: inherit;">Seg√∫n lo confirmado por el usuario Nikopol_86 en el blog "... no creo en la documentaci√≥n china"</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nikopol_86 5 febrero 2019 a las 09:27 0</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para ser honesto, tiene suficiente ruido en todas las proporciones. Investigu√© un poco sobre la densidad de distribuci√≥n de los c√≥digos ADC emitidos con circuitos de entrada en corto, por lo que hay una extensi√≥n de hasta 1000 1_5V y nifiga no es una ley de distribuci√≥n normal, lo que sugiere que el cableado de la placa est√° en problemas, o con el ADC, o todos juntos. . Tambi√©n not√© que √©l tampoco tiene estabilizaci√≥n de temperatura, y el rango de temperatura de operaci√≥n alegado no corresponde a la realidad. Aunque solo sea porque cuando conecta un medidor de tensi√≥n de 5 kg al ADC, cambiar la temperatura de la habitaci√≥n en 1 grado tomar√° lecturas en 2 gramos, y si calienta el microcircuito con el dedo, las lecturas volar√°n hasta 5-7 gramos. En general, llegu√© a la conclusi√≥n de que solo se puede hacer un dispensador de comida para gatos en este dispositivo,donde la precisi√≥n en una parada de tranv√≠a ser√° m√°s que suficiente. Y, por desgracia, las soluciones normales no son baratas, porque tiene que usar ADC de alta calidad de AO o T1.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como puede ver, las conclusiones fueron confirmadas. Es cierto, lo mismo es cierto: </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jushabrauser 4 de febrero de 2019 a las 12:52 p.m.Con</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
una relaci√≥n se√±al / ruido &lt;1, esto nunca ayudar√°. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Incluso con un circuito de puente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, en condiciones normales (sin matem√°ticas y / o circuitos especiales), un m√≠nimo de 8 bits menos significativos emiten tonter√≠as (lo m√°s probable). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
24 bits chinos honestos por 350 rublos? No le digas a mis zapatillas. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si el hierro en s√≠ mismo "miente", ¬øqu√© puede hacer al respecto? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠, incluso un filtro no lineal de tercer orden no ayudar√°, porque los datos de origen no son pan comido. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fue desde este lugar que quer√≠a ver de qu√© es capaz este m√≥dulo en la composici√≥n de las escalas. La b√∫squeda de problemas en la red con el jitter de los √∫ltimos bits del ADC condujo al foro </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kazus.ru/forums/showthread.php?t=105320&amp;page=4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Aqu√≠ hay una discusi√≥n completa sobre lecturas estabilizadoras. Sin embargo, ninguno de los m√©todos matem√°ticos propuestos "calm√≥" los datos de entrada que recibo. Desde el "hardware" mismo, para estabilizar las lecturas, se introdujo: la conexi√≥n de tierra digital y anal√≥gica, as√≠ como el cortocircuito de la entrada B a tierra. Utilizamos blindaje completo y alimentaci√≥n del m√≥dulo desde una bater√≠a de 6v (seguida de un estabilizador 7805) por separado de los circuitos del controlador. No hay resultado, los datos de entrada est√°n oscilando ...</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, no se puede obtener la categor√≠a 24 "limpia" y la raz√≥n aqu√≠ me parece ser un m / circuito de baja calidad. Por lo tanto, debe recortar el rango de conversi√≥n resultante. Para esto, en el programa ReadCount, se introdujo una l√≠nea con divisi√≥n de datos por 100. 100 es un poco menos de 2 a 8 grados. A. La conversi√≥n AD viene en 16 bits. Sin embargo, incluso esa limitaci√≥n no hizo que el testimonio fuera confiable. Y la raz√≥n aqu√≠ es las propiedades de galgas extensom√©tricas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, despu√©s de aplicar el proceso de calibraci√≥n (que vincula el valor del ADC y el peso en la plataforma), el peso se muestra en gramos. Muestra 500 gramos como el n√∫mero 500, un kg como 1000. El precio de divisi√≥n es 1 gramo. Aquellos. obtenemos con sensor de 40 kg 40,000 divisiones. De acuerdo con los datos t√©cnicos de la celda de carga, podemos obtener del sensor solo 3000 divisiones (s√≠mbolo C3 en el nombre del sensor). Entonces, el precio de la divisi√≥n debe ser (40000/3000) = 13.3 gramos. Sin embargo, de acuerdo con GOST 29329, la metrolog√≠a de peso no funciona con el n√∫mero 3. Se deben usar d√≠gitos: </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.1.3 El valor del valor de divisi√≥n de calibraci√≥n (e), el precio de divisi√≥n de escala (d) y la resoluci√≥n de lectura (dd) en unidades de masa se deben seleccionar entre los siguientes: 1X10a; 2X10a; 5X10a, donde a es un entero positivo, negativo o cero.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A. El precio de divisi√≥n para este sensor, garantizado por el fabricante de 10 gramos. Es decir, el formato de salida debe ser 0.0x kg. donde x = 1,2,3, ... .0. Tratemos de hacer el precio de divisi√≥n de 5 gramos. Se enumeran las acciones program√°ticas relevantes. Despu√©s de tal restricci√≥n, "tomamos" del sensor 40,000 / 5 = 8,000 divisiones, que es 2.6 veces m√°s de lo permitido. Despu√©s de estos supuestos, las escalas resultantes funcionan de manera bastante constante.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La observaci√≥n anterior sobre la celda de carga aplicada y su "resoluci√≥n" no nos permite afirmar de manera concluyente que este m√≥dulo no puede producir una conversi√≥n de 24 bits. Sin embargo, he probado este sensor para que funcione con una resoluci√≥n de 1 gramo, en otro dispositivo, con un convertidor AD diferente. En este dispositivo, el funcionamiento del sensor y la conversi√≥n pueden considerarse satisfactorios, ya que la fluctuaci√≥n del peso no fue superior a 3 gramos. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øQu√© no permite el uso de este ADC en el comercio?</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bueno, lo primero y m√°s importante es la dependencia de la medici√≥n de la temperatura. En segundo lugar, utilizando las operaciones de divisi√≥n y multiplicaci√≥n integradas en ATMEGA, especialmente para 8 bits, es dif√≠cil calibrar las b√°sculas en todo el rango de peso en estas condiciones. Debe tenerse en cuenta que el programa no reacciona de ninguna manera a la sobrecarga del sensor.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C√≥mo superar estos inconvenientes. Primero, ingrese el sensor de temperatura y ajuste la lectura del peso del valor de temperatura. Lo cual es bastante complicado. "M√°s barato" es introducir la opci√≥n de calibraci√≥n, para diferentes cargas y, dependiendo del error causado por la temperatura, calibrar el peso utilizado en el trabajo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El segundo es m√°s dif√≠cil. Reemplace el procedimiento de multiplicaci√≥n y divisi√≥n por operaciones tabulares y de corte. Creo que esta es la mejor manera de usar este m√≥dulo en la pr√°ctica de construir pesas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para completar la descripci√≥n de los requisitos para la creaci√≥n de un programa para las escalas, es necesario utilizar el "Programa de (certificaci√≥n) metrol√≥gica de calibraci√≥n de las escalas" adjuntos a cada balance. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La creaci√≥n de escalas basadas en m / s Hx711 es posible sujeto a todos los requisitos metrol√≥gicos para las escalas. </font><font style="vertical-align: inherit;">La introducci√≥n de correcciones para la dependencia de la temperatura de la conversi√≥n debe preverse en un procedimiento separado. </font><font style="vertical-align: inherit;">El uso de un m√≥dulo con una resoluci√≥n de m√°s de 16 bits requiere un enfoque y control por separado.</font></font></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es487056/index.html">¬øEs peligroso mantener RDP abierto en Internet?</a></li>
<li><a href="../es487058/index.html">"Hadoop. ZooKeeper ‚Äùde la serie Mail.Ru Group Technostream‚Äú Procesamiento distribuido de datos grandes en Hadoop ‚Äù</a></li>
<li><a href="../es487060/index.html">¬øEst√°s usando Google Chrome? Entonces Google recopila sus datos a trav√©s de X-client-data</a></li>
<li><a href="../es487062/index.html">CBS permiti√≥ a los usuarios de Linux ver Star Trek, gracias a ella por eso</a></li>
<li><a href="../es487064/index.html">Mi segundo a√±o como desarrollador independiente.</a></li>
<li><a href="../es487068/index.html">Tarjeta de negocios APEC: una alternativa a una visa de negocios para China y otros pa√≠ses</a></li>
<li><a href="../es487072/index.html">me quiero casar</a></li>
<li><a href="../es487074/index.html">C√≥mo ABLYY NLP Technologies aprende a monitorear noticias y administrar riesgos</a></li>
<li><a href="../es487076/index.html">Los anuncios de Google / Yandex no se muestran: 15 razones</a></li>
<li><a href="../es487078/index.html">–ö–∞–∫ –º—ã –ø—Ä–∏—É—á–∏–ª–∏ –∫–æ–ª–ª–µ–≥ –±—Ä–∞—Ç—å –≤–µ—â–∏ –±–µ–∑ —Å–ø—Ä–æ—Å–∞</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>