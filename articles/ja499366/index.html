<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚺 🚨 👞 ジオチャット、有害なボット、ステガノグラフィ：Telegramに関する知識の充実 👋🏿 🖇️ ❔</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="テレグラムのテレグラムについて何を知っていますか？また、VideoNoteでステガノグラフィを区別できますか（一般的に-ラウンドロビン）。私たちは、NeoQUEST-2020というまさにそのタスクを分析しました。スポイラー：はい、そしてここにも少し暗号があります:)
 
 でNeoQUEST-202...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ジオチャット、有害なボット、ステガノグラフィ：Telegramに関する知識の充実</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/neobit/blog/499366/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ls/r-/kn/lsr-knoirt_c2eklbngtrv43ys4.png"></div> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テレグラムのテレグラムについて何を知っていますか？</font><font style="vertical-align: inherit;">また、VideoNoteでステガノグラフィを区別できますか（一般的に-ラウンドロビン）。</font><font style="vertical-align: inherit;">私たちは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NeoQUEST-2020</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">というまさにそのタスクを分析しました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">スポイラー：はい、そしてここにも少し暗号があります:)</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
で</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NeoQUEST-2020</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">伝説、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">我々は</font></a><font style="vertical-align: inherit;">見つける</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンク</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Instagramの上の走行ロボットのプロファイルにします。異常なことはありませんよね？だから私たちもそう決めましたが、問題を解決する必要があるので、プロファイル内のすべての写真を注意深く検討し、少なくともいくつかの手がかりを探します。バイカル湖の美しい写真について少し瞑想し、手掛かりが最後の投稿にあることに気づきました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wg/f3/yp/wgf3ypumnzx-gms9aj5ixn7qllw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
写真のおかげで、バイカル（シャーマンロック）とテレグラムを何らかの形で接続する必要があることを理解しています（「Uは私に加わることができます...」-それは何かを思い出させませんか？）。</font><font style="vertical-align: inherit;">最初は、参加者に地理チャットの直接のヒントを与えないことを決めました（そしてこれがそれです！）。多くの参加者は、地理的位置を変更する機能を備えたエミュレーターまたはモバイルデバイスを使用して、タスクにうまく対処しました。</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シャーマニムシャーマン</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カ岩の領域に座標（53.20074、107.349426）（目で確認できます）</font><s><font style="vertical-align: inherit;">を設定</font></s><font style="vertical-align: inherit;">し、最も難しいこと、つまり待機の準備をします。</font><font style="vertical-align: inherit;">電報は不思議なことにジオポジショニングと連動し、関連する連絡先とチャットを1時間引き出します。</font><font style="vertical-align: inherit;">私たちの勤勉さと忍耐のために、私たちは全額が支払われます-希望のチャットが連絡先セクションに表示されます-&gt;近くの人を見つけます-&gt;近くのグループ。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/cb/z_/ti/cbz_tiwdqa0j0cqdikmwjob704y.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
出来上がり！ </font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_c/or/zt/_corztflxylgeewrehp61prvssu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ボットは、不明なコンテンツを含むファイルsome.bytesの形式でタスクを実行します。このタスクでは、「Decrypt me」および「Apocalypse Spares Nobody」という行を読み取ることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
問題なく最初の行を理解していますが、2番目の意味は何ですか？..ここでは、参加者が2つのキャンプに分かれました。行き止まりに入ったために郵送で書いた人もいれば、「黙示録のスペア誰も」というフレーズを注意深く見て、それを識別した人もいます。 ？正しい！古き良き</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASN.1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォーマット</font><font style="vertical-align: inherit;">（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">では、それを解析する方法についてすでに説明しました）。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bb/vr/k4/bbvrk4nu0xsdayswyptuv2z1gpw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それを正しくしましょう。内部は2つの構造です。 1つには、「Decrypt me」とマークされたバイトのセットがあり、これが暗号文であると想定しています。 2番目の構造では、2つの数値が表示されます。これが、参加者が暗号文とともに寛大に提示した鍵である可能性は低いです。公開鍵を扱っています。収集されたすべての情報は、明白な結論に導きます-なぜ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RSAを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">試してみません</font><font style="vertical-align: inherit;">か？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、モジュールとオープンインジケーターがあります。</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いくつかの</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">考え</font><s><font style="vertical-align: inherit;">についてRSAのけいれん的な研究を行った</font></s><font style="vertical-align: inherit;">後、</font><font style="vertical-align: inherit;">クローズドインジケーターは小さい、つまり何を意味していると結論付けますか？ビンゴ！私たちは間違いなく悪者を演じ、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウィーナーの攻撃</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使うことができ</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
暗号化を好まない人でも、私たちはそれをじっくり考えました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">たとえば、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻撃の既製バージョンを使用できます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、閉じた図の値を取得し、</font></font><code>d=40553818206320299896275948250950248823966726834704013657854904761789429403771</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">暗号文を復号化します</font></font><code>key=nq2020faAeFeGUCBjYf7UDrH9FapFCdFPa4u;pass=passCxws3jzYhp0HD5Fy84</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ジョブの最初の部分のキー「nq2020faAeFeGUCBjYf7UDrH9FapFCdFPa4u」とボットの代表者にフィードするために必要なパスワード「passCxws3jzYhp0HD5Fy84」を取得します。</font><font style="vertical-align: inherit;">これは、@ neoquestbotという名前でチャット参加者の中にあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初のキーを受け取ってからのポジティブな波に乗っているため、ボットがコミュニケーションにうるさいことにすぐに気づくことはなく、常に対話者がいないと言っています：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ex/ky/t_/exkyt__66acqprkte1kk_hljuge.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、ボットはVideoNoteラウンドメッセージを喜んで受信し、同じラウンド形式でそれらに応答さえします。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gv/tk/k4/gvtkk4hr8u_a8gsidkkqijtcuzy.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
映像と音声は同じようですが、一見しただけです。</font><font style="vertical-align: inherit;">ボットが秘密の兆候を見せてくれたら？</font><font style="vertical-align: inherit;">調べるために、元の動画を保存してボットの応答と比較します。</font><font style="vertical-align: inherit;">これと次のステップでは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FFmpeg</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パッケージが最適です</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">だから、そこに何があるか見てみましょう：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/re/jy/z0/rejyz0tnqx0lgvvcggpctdv2elq.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ri/e3/_v/rie3_vg77u1j1txjch9te5a8y1w.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フォーマットaac-&gt; flac、周波数44100 Hz-&gt; 98000 Hz。</font><font style="vertical-align: inherit;">彼らは、私たちがさらにオーディオを使って作業を続けることを発見しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
手の巧妙な動きで、ビデオから引き出します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/er/ql/jh/erqljhyvzkhdq34zoxmfvl7ezty.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
元のメッセージでも同じことができるので、後で比較することができます。</font><font style="vertical-align: inherit;">明確にするために、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Audacityで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">両方のトラックを開き</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gd/ga/gq/gdgagqn_qtefqtnbyphj2ud0b00.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ボットの音声応答の振幅のジャンプがすぐにあなたの目を引きます（特に、私たちがまったく黙っていた場合は奇妙です）。</font><font style="vertical-align: inherit;">よく調べてみると、「波の沈黙」が交替する間の区間の明確な境界に注意します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/mu/7f/zp/mu7fzposl6z9ozjrxanvjfnh2hw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのものを脇に置き、少し数えることをお勧めします。</font><font style="vertical-align: inherit;">我々は、フラグメントによって分析：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 0.005 - 0沈黙</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0.005 - 0.01 -波</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0.0225 - -沈黙0、01 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
波- 0.04 - 0.025を</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
沈黙- 0.045から0.04の</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最小間隔は0.005であり、そして他のすべて間隔は0.005の倍数です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1の場合は0.005の波の存在を、0の場合は沈黙をとります。バイナリコード以外は何も得られません。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
周波数が変化したことを思い出して、スペクトルグラフ（分析-&gt;スペクトルグラフ）を見てみましょう。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7p/us/g0/7pusg01eyco5oawp9fyw92rbpzi.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最も強力な信号は、超音波である約44100 Hzの周波数であることがわかります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、高周波でのみ作業する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、ボットはその信号を可聴スペクトルの元のオーディオに重ね合わせます。そして、元のビデオでサウンドを持っていた参加者は、Audacityでこれに気づきました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Audacityまたは同じffmpegのいずれかで、ハイパスフィルターを使用して高周波を遮断します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3c/tk/tc/3ctktc0fgdc9zevjijzypncxb9o.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、16ビットのモノwavファイルがあります。ヘッダー、非圧縮オーディオストリーム、メタデータで構成されます。オーディオストリーム自体はフレームに分割されており（フレームには複数のサンプルを格納できますが、これは完全に異なるストーリーです）、それぞれ16ビットです（これはスクリーンショットのpcm_s16の文字で示されています）。フレームは、1つ以上のチャネル（この場合は1つ）の波の振幅を一度に表すビットのシーケンスです。オーディオストリームのサンプリング周波数は98000フレーム（つまり、1秒あたり98000フレーム）、0.005秒間隔で490フレームです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、さらに単純なアルゴリズムに従って作業します。490フレームを読み取り、それが波か沈黙かを判断し、それに応じてビットを0または1に設定し</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ます。Pythonとパッケージ</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用します</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wavファイルを解析するための</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">wave</font></a><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファイルを開くときにエラー「wave.Error：unknown format：65534」が発生した場合は、ヘッダーの「wFormatTag」を「FE FF」から「01 00」に置き換えます。</font></font><br>
<br>
<pre><code class="python hljs">fh = open(input_file, <span class="hljs-string">"r+b"</span>)<font></font>
fh.seek(<span class="hljs-number">20</span>)<font></font>
fh.write(<span class="hljs-string">b'\x01\x00'</span>)<font></font>
fh.close()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、ファイルを開き、490フレームを処理して平均値を計算します。</font></font><br>
<br>
<pre><code class="python hljs">file = wave.open(input_file,<span class="hljs-string">"r"</span>)
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range (<span class="hljs-number">1</span>, int(file.getnframes()/<span class="hljs-number">490</span>)+<span class="hljs-number">1</span>):<font></font>
        frames = file.readframes(<span class="hljs-number">490</span>)<font></font>
        bit = <span class="hljs-number">0</span>
        sum = <span class="hljs-number">0</span>
        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, <span class="hljs-number">246</span>):<font></font>
            frame_bytes = frames[k*<span class="hljs-number">2</span>:k*<span class="hljs-number">2</span>+<span class="hljs-number">2</span>]<font></font>
            sum += int.from_bytes(frame_bytes, <span class="hljs-string">"big"</span>)
        <span class="hljs-keyword">if</span> sum/<span class="hljs-number">490</span> &gt; <span class="hljs-number">16000</span>:<font></font>
            bit = <span class="hljs-number">1</span><font></font>
        bits.append(bit)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
沈黙が必要な場所（Audacityの画像と比較）で、ノイズが残る場合があります。</font><font style="vertical-align: inherit;">したがって、しきい値を設定し（16000にします）、超過すると信号を1と見なします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、ビットをバイトにグループ化します。</font></font><br>
<br>
<pre><code class="python hljs">bytes = []    
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range (<span class="hljs-number">1</span>, int(len(bits)/<span class="hljs-number">8</span>)+<span class="hljs-number">1</span>):<font></font>
        b1 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-8</span>]<font></font>
        b2 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-7</span>]<font></font>
        b3 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-6</span>]<font></font>
        b4 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-5</span>]<font></font>
        b5 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-4</span>]<font></font>
        b6 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-3</span>]<font></font>
        b7 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-2</span>]<font></font>
        b8 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-1</span>]<font></font>
        byte = (b1 &lt;&lt; <span class="hljs-number">7</span>) | (b2 &lt;&lt; <span class="hljs-number">6</span>) | (b3 &lt;&lt; <span class="hljs-number">5</span>) | (b4 &lt;&lt; <span class="hljs-number">4</span>) | (b5 &lt;&lt; <span class="hljs-number">3</span>) | (b6 &lt;&lt; <span class="hljs-number">2</span>) | (b7 &lt;&lt; <span class="hljs-number">1</span>) | b8<font></font>
        bytes.append(byte.to_bytes(<span class="hljs-number">1</span>, byteorder=<span class="hljs-string">'big'</span>)) 
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてが正しく行われると、結果は文字列「Givemethepassword」になります。</font><font style="vertical-align: inherit;">ボットはステガノグラフィーを使用して円を描くように通信するので、そのパスワード（および復号化の結果としてキーと一緒に受け取ったもの）のパスワードを同じ形式で入力するのが合理的です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
はじめに、パスワードを使用してオーディオトラックを作成します。</font><font style="vertical-align: inherit;">これを行うには、ボットからのメッセージの分析中に取得したデータを使用します。サンプリング周波数は98000 Hz。</font><font style="vertical-align: inherit;">各ビットを表す信号の持続時間は5 msです。</font><font style="vertical-align: inherit;">ビット値「1」に対応する信号周波数-グラフからわかるように、44100 Hz。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、沈黙を「生成」する必要があります。</font><font style="vertical-align: inherit;">私たちはこれを中和することによってこれを行います：</font></font><br>
<br>
<pre><code class="python hljs">sample_rate = <span class="hljs-number">98000.0</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">generate_silence</span>(<span class="hljs-params">duration_milliseconds=<span class="hljs-number">5</span></span>):</span><font></font>
    fragment = []<font></font>
    num_samples = duration_milliseconds * (sample_rate / <span class="hljs-number">1000.0</span>)
    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(int(num_samples)): <font></font>
        fragment.append(<span class="hljs-number">0.0</span>)
    <span class="hljs-keyword">return</span> fragment
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
音を生成するには、正弦波を使用します（情報は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で読むことができ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">）：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">generate_sinewave</span>(<span class="hljs-params">
        freq=<span class="hljs-number">41000.0</span>, 
        duration_milliseconds=<span class="hljs-number">5</span>, 
        volume=<span class="hljs-number">0.5</span></span>):</span><font></font>
    fragment = []<font></font>
    amplitude = volume * <span class="hljs-number">32767.0</span>
    num_samples = duration_milliseconds * (sample_rate / <span class="hljs-number">1000.0</span>)
    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(int(num_samples)):<font></font>
        fragment.append(amplitude * math.sin(<span class="hljs-number">2</span> * math.pi * freq * ( x / sample_rate )))
    <span class="hljs-keyword">return</span> fragment
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さて、問題は小さくなります。パスワードをビットに変換し、その後音に変換することは残ります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注：前述のとおり、ボットは元の入力ビデオトラックを使用してメッセージをオーバーレイします。</font><font style="vertical-align: inherit;">そのため、ボットからキー全体をシェイクするには、その最初だけではなく（キーの長さは36バイトでした）、パスワードの後に​​数バイトを追加する必要があります。</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">音の発生</font></font></b>
                        <div class="spoiler_text"><pre><code class="python hljs">    audio = []<font></font>
    f = open(input_file, <span class="hljs-string">'rb'</span>)
    <span class="hljs-keyword">for</span> character <span class="hljs-keyword">in</span> f.read():<font></font>
        a = character<font></font>
        b8 = a &amp; <span class="hljs-number">0b00000001</span> 
        b7 = (a &amp; <span class="hljs-number">0b00000010</span>) &gt;&gt; <span class="hljs-number">1</span> 
        b6 = (a &amp; <span class="hljs-number">0b00000100</span>) &gt;&gt; <span class="hljs-number">2</span>
        b5 = (a &amp; <span class="hljs-number">0b00001000</span>) &gt;&gt; <span class="hljs-number">3</span>
        b4 = (a &amp; <span class="hljs-number">0b00010000</span>) &gt;&gt; <span class="hljs-number">4</span>
        b3 = (a &amp; <span class="hljs-number">0b00100000</span>) &gt;&gt; <span class="hljs-number">5</span>
        b2 = (a &amp; <span class="hljs-number">0b01000000</span>) &gt;&gt; <span class="hljs-number">6</span>
        b1 = (a &amp; <span class="hljs-number">0b10000000</span>) &gt;&gt; <span class="hljs-number">7</span>
        <span class="hljs-keyword">if</span> b1 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b2 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b3 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b4 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b5 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b6 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b7 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b8 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、完成したwaveファイルを作成します。</font></font><br>
<br>
<pre><code class="python hljs">wav_file=wave.open(file_name,<span class="hljs-string">"w"</span>)<font></font>
    nchannels = <span class="hljs-number">1</span>
    sampwidth = <span class="hljs-number">2</span><font></font>
    nframes = len(audio)<font></font>
    comptype = <span class="hljs-string">"NONE"</span>
    compname = <span class="hljs-string">"not compressed"</span><font></font>
    wav_file.setparams((nchannels, sampwidth, sample_rate, nframes, comptype, compname))<font></font>
    <span class="hljs-keyword">for</span> sample <span class="hljs-keyword">in</span> audio:<font></font>
        wav_file.writeframes(struct.pack(<span class="hljs-string">'h'</span>, int(sample)))<font></font>
    wav_file.close()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、pass.wavにトラックを保存します。</font><font style="vertical-align: inherit;">途中で、パスワードが認識されているかどうかをstegoデコーダーで確認します。</font><font style="vertical-align: inherit;">問題がなければ、元のビデオmy_video.mp4からパスワード付きの新しいビデオを取得し、オーディオトラックを置き換えます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7y/vg/_u/7yvg_ulbp5wmx8jmz5vmxucgogu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これからVideoNoteを作成する必要があります。</font><font style="vertical-align: inherit;">機能しているもの（たとえば、@ TelescopyBotが見つかった参加者など）を探すか、TelegramAPIを使用してボットを作成できます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/rk/_4/np/rk_4nphgkerx68klet43x0npzrg.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 とにかく、ボットに転送します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3x/li/0g/3xli0gyrmnawsnl6fyqa90slv6e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我々はすでに働いたシナリオに従って、音声をデコード新ラウンドとお祝いの言葉（！私たちは、このような仕事をしているだろうが）、取得し、キーました：「nq2020SyOMK7SnnJP1sNlvbTs8zt35vUrrsD」</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
確かに、ステガノグラフィは何のためにサイバーセキュリティの最も困難な地域の一つと考えられている-ここではこれらのすべてを推測しようとします！</font><font style="vertical-align: inherit;">しかし、NeoQUESTの参加者は、この作業中に優れた器用さとユーモアのセンスを示したので、私たちは（ボットおめでとうございます）誠実な賞賛に取り組んでいます！</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja499356/index.html">Powermac G5のHackintoshまたはワークステーションの組み立て方法。パート2</a></li>
<li><a href="../ja499358/index.html">ロシア語のPEP 257。（Docstrings契約）</a></li>
<li><a href="../ja499360/index.html">メッシュネットワークの作成と構成、およびいくつかの数値と分析</a></li>
<li><a href="../ja499362/index.html">リモートマラソンウィーク2：ワークフロー</a></li>
<li><a href="../ja499364/index.html">アレクセイ・カプテレフ：クリティカルシンキング101（パート1）</a></li>
<li><a href="../ja499368/index.html">Phrasal Verbs-4について（in / out）</a></li>
<li><a href="../ja499370/index.html">私のお気に入りのCSS質問と詳細な回答</a></li>
<li><a href="../ja499374/index.html">一次差異を使用したCOVID-19増殖データの調査。そして、それから来たもの</a></li>
<li><a href="../ja499376/index.html">HackRF Oneを例にした最新のラジオのデバイスについて少し</a></li>
<li><a href="../ja499378/index.html">最初のサイプレステストを構築する</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>