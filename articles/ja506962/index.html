<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😷 🛎️ 👩🏼‍🤝‍👨🏻 Unityで非同期/待機 🙉 🤰 🧝</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="敬礼、ハブロフスク。コース"Game Developer on Unity"の開始までに残された時間はほとんどありません。この点に関して、興味深い翻訳を用意しました。
 
 
 
 asyncUnityは、非同期動作をシミュレートするプラグインやcorutinラッパーがなくても機能しTask、すべて...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Unityで非同期/待機</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/506962/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">敬礼、ハブロフスク。</font><font style="vertical-align: inherit;">コース</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Game Developer on Unity"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の開始までに残された時間はほとんどありません。</font><font style="vertical-align: inherit;">この点に関して、興味深い翻訳を用意しました。</font></font></b></i><br>
<br>
<img src="https://habrastorage.org/webt/37/kv/yt/37kvytgqxylnrra818g7eckd5ly.png"><br>
<hr><br>
<code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unityは</font><font style="vertical-align: inherit;">、非同期動作をシミュレートする</font><font style="vertical-align: inherit;">プラグインや</font><font style="vertical-align: inherit;">corutinラッパーが</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">なくて</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">も</font><font style="vertical-align: inherit;">機能し</font></font><code>Task</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、すべてのフレームで完了をチェックします。</font><font style="vertical-align: inherit;">しかし、それはまだ一種の魔法です。</font><font style="vertical-align: inherit;">このトピックをもう少し詳しく見てみましょう。</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（注：当面の間</font></font><code>async/await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、C＃</font><font style="vertical-align: inherit;">のすべてのフードの詳細</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">理想的に理解しているわけではない</font><font style="vertical-align: inherit;">ので、理解が深まるにつれて、前述の内容を補完するように努めます。）</font></font></i><a name="habracut"></a><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h4><br>
<img src="https://habrastorage.org/webt/ps/8i/so/ps8isowfho7xsjl99bnyzfh_5fo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クリックするとクラシックボックスアニメーションを再生するボタンが必要だとします。しかし、一つ落とし穴があります：ボタン（で暗く非アクティブ状態に行かなければならない</font></font><code>.interactable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">まで</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のボックスが終了回転。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードをクリーンにする</font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ために、</font></font><code>interactable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">各フレームの状態をチェックしてこのタスクを開始するコルーチンを含むオブジェクトを作成するようなものではなく</font><font style="vertical-align: inherit;">、ボックスの回転が完了するのを待ち、すぐにを復元する行を追加する</font><font style="vertical-align: inherit;">ものを使用します。 1つの場所に明らかな線形コードがあることは、読みやすさの点で大きなプラスになります。そのようなコードを書くのはいいことです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のシンプルでコンパクトなコードは、必要なタスクを実装しています。 （</font></font><code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> メソッドはUnityデリゲートリストにも表示されます。心配しないでください。）</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">using</span> System.Threading.Tasks;
<span class="hljs-keyword">using</span> UnityEngine;
<span class="hljs-keyword">using</span> UnityEngine.UI;<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">SpinBox</span> : <span class="hljs-title">MonoBehaviour</span><font></font>
{<font></font>
    <span class="hljs-keyword">public</span> Button button;
    <span class="hljs-keyword">public</span> Animation ani;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SpinAndDisableButton</span>(<span class="hljs-params"></span>)</span><font></font>
    {<font></font>
        ani.Play();<font></font>
        button.interactable = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">while</span> (ani.isPlaying == <span class="hljs-literal">true</span>)<font></font>
        {<font></font>
            <span class="hljs-keyword">await</span> Task.Yield();<font></font>
        }<font></font>
        button.interactable = <span class="hljs-literal">true</span>;<font></font>
    }<font></font>
}</code></pre><br>
<br>
<img src="https://habrastorage.org/webt/m-/or/ad/m-orad9ixe4ebtae_f6hm0ast1w.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あなたが尋ねるべきだったいくつかの質問はここにあります：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"></font><code>while</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドの残りの部分を</font><font style="vertical-align: inherit;">「実行する」「実行する」</font><font style="vertical-align: inherit;">次のフレームで魔法のようにチェックされます</font></font><code>SpinAndDisableButton</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が</font><font style="vertical-align: inherit;">、呼び出し</font><font style="vertical-align: inherit;">は1回だけ行われ</font></font><code>Update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、再起動するコルーチン</font><font style="vertical-align: inherit;">はありません</font><font style="vertical-align: inherit;">。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">各実行のタイミングは何ですか？</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">なに</font></font><code>Task.Yield()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">？</font><font style="vertical-align: inherit;">これは、ここで起こるすべての鍵となるようです。</font></font><code>yield return null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コルーチンに</font><font style="vertical-align: inherit;">慣れていると思います</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">次のフレームでもう一度試すことをお勧めしますが、これはC＃列挙子を使用して言います。</font><font style="vertical-align: inherit;">利回りの表現は似ており、動作も似ています。</font></font></li>
</ul><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同期コンテキスト</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プログラムの残りの部分をどのようにキャプチャして継続できるかについては、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この記事を</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
チェックし</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">てください</font></a><font style="vertical-align: inherit;">（たとえば、どのスレッドで？呼び出しスレッドまたはタスクを起動するスレッドで？）</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、Unityにもあることが</font><font style="vertical-align: inherit;">わかります。</font><font style="vertical-align: inherit;">このような概念ですが、一見しただけではわかりません。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常のC＃プログラムと比較</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてが通常のC＃プログラムとまったく同じではありません。公式ドキュメントを見る</font></font><code>await. await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と、オブジェクトの呼び出し元に戻る必要があります</font></font><code>Task</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。呼び出し元は、実行結果が必要になるまで続行できますが、現時点では、（タスクがマルチスレッドであるかどうかは関係ありません）を除いて、他に何かをする余裕はありません</font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。このチェーンは、最終的にに到達するまで継続できます</font></font><code>Main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。ここでも</font></font><code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">出会った場合</font><font style="vertical-align: inherit;">、コンパイラによって生成された</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">別のウェイトがあり</font></a><font style="vertical-align: inherit;">、即座に結果を要求します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さて、私たちのものに戻り</font></font><code>SpinAndDisableButton</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。返品はどこに行き</font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ますか？ Unityにはありません</font></font><code>Main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、それはエンジンコードに深く隠されているからです。質問は、実際には、誰が実行すると同じであり</font></font><code>Update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>LateUpdate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そして上のようにします。これは、</font></font><code>PlayerLoop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ゲームサイクル内でエンジンコードをサポートし、オブジェクトとフレームで実行されるすべての規則正しいレンダリングを提供</font><font style="vertical-align: inherit;">する</font><font style="vertical-align: inherit;">APIです。しかし以前は、これまでのところこれらのエントリポイントが戻ってきたため、問題はありませんでした</font></font><code>void</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで</font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、後で特定のポイントで自動的に続行できることを期待して、実行ポイントを誰かに返します。そして、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ゲームループは継続さ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">れるまで</font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が待っています。</font><font style="vertical-align: inherit;">そうしないと、ボックスがアニメーションを終了するまで実際に待機した場合、フレームの変更が継続しないとアニメーションを終了できないため、回転するボックスはまったく表示されません。</font><font style="vertical-align: inherit;">では、次のフレームで何が起こるでしょうか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、ボタンを押して無効にしたフレームとは異なるフレームで受信する疑似コードです。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">for</span> ( )<font></font>
{<font></font>
    <span class="hljs-keyword">if</span>(  )<font></font>
    {<font></font>
    	 .<font></font>
    }<font></font>
  <font></font>
     .<font></font>
         .<font></font>
        .<font></font>
}</code></pre><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デバッグ中</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードにログを追加してください。ステップバイステップのデバッグを試みます。</font></font><br>
<pre><code class="cs hljs"><span class="hljs-keyword">using</span> System.Threading.Tasks;
<span class="hljs-keyword">using</span> UnityEngine;
<span class="hljs-keyword">using</span> UnityEngine.UI;<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">SpinBox</span> : <span class="hljs-title">MonoBehaviour</span><font></font>
{<font></font>
    <span class="hljs-keyword">public</span> Button button;
    <span class="hljs-keyword">public</span> Animation ani;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SpinAndDisableButton</span>(<span class="hljs-params"></span>)</span><font></font>
    {<font></font>
        Debug.Log(<span class="hljs-string">$"Started async <span class="hljs-subst">{Time.frameCount}</span>"</span>);<font></font>
        ani.Play();<font></font>
        button.interactable = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">while</span> (ani.isPlaying == <span class="hljs-literal">true</span>)<font></font>
        {<font></font>
            <span class="hljs-keyword">await</span> Task.Yield();<font></font>
        }<font></font>
        button.interactable = <span class="hljs-literal">true</span>;<font></font>
        Debug.Log(<span class="hljs-string">$"Finished async <span class="hljs-subst">{Time.frameCount}</span>"</span>);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Update</span>(<span class="hljs-params"></span>)</span><font></font>
    {<font></font>
        Debug.Log(<span class="hljs-string">$"Update <span class="hljs-subst">{Time.frameCount}</span>"</span>);<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">LateUpdate</span>(<span class="hljs-params"></span>)</span><font></font>
    {<font></font>
        Debug.Log(<span class="hljs-string">$"Late Update <span class="hljs-subst">{Time.frameCount}</span>"</span>);<font></font>
    }<font></font>
}</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
更新の順序は次のとおりです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ku/rp/b7/kurpb70kzx35oellcgqqwor5eow.png"><br>
<br>
<img src="https://habrastorage.org/webt/1c/k8/ef/1ck8ef1r0hmycnkfcubqfa4kwec.png"><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちはアニメーションを開始するフレームがが先行し、さ</font></font><code>Update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>LateUpdate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マウスクリックから来るので</font></font><code>EventSystem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>GraphicRaycaster</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">における実行の順序がある、それが判明したとして、UGUIユニティから、</font></font><code>Update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上記のスクリプトのいずれかを。</font></font></li>
<li><code>while</code>   <b> </b>      ,   <b></b> <code>Update</code>,   <code>LateUpdate</code>.     ,     !</li>
<li>      ,    ,      ,   <code>Awaiting</code>,    UGUI   ,   ,  <code>await</code> ,        -   </li>
<li>         <code>Update</code>  -   . <code>await</code>     .</li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私は完全には解決しなかった「保留中のオブジェクト」をわかりやすく説明するために残っていますが、意図的にエンコードされているため、少なくともそれがどのように機能するかはわかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ボタンをクリックした最初のフレームでは、何も奇妙なことはありません。</font></font><code>Update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（同じ魔法の1つ</font></font><code>MonoBehaviour Update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font><code>EventSystem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、</font></font><code>Input</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">APIを</font><font style="vertical-align: inherit;">使用し</font><font style="vertical-align: inherit;">てクリックを確認します。その後、キャンバス上のボタンをスキャンして、何かができることを確認します。次に、呼び出され</font></font><code>public async void</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">てその行に到達します。 （これらを</font></font><code>ExecuteEvents</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">手動で</font><font style="vertical-align: inherit;">使用することもできます</font><font style="vertical-align: inherit;">！これはヘルパー</font></font><code>static</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスです。）</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ut/6q/yb/ut6qybougoh8yuhav3o2gpn8hly.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マジックが発生する次のフレームで、コールスタックは、数フレームごとにチェックを処理する人を正確に示すことができます。ここで何が起こっているのかよくわかりません。 （これは動作しますが）</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fr/gw/uj/frgwujptlworykklroix5o0m4sk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
チェックしたとき</font></font><code>UnitySynchronizationContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、多くはエンジンコードから呼び出されているようなので、私は推測しかできません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/re/qh/vm/reqhvmmgmoxuzm6i-e-9ts49txm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし</font></font><code>WorkRequest</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、あなたの期待される未完成のビジネスのそれぞれを表す、</font><font style="vertical-align: inherit;">そこに呼ばれるものがあり</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">リターンは</font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「ゲームのような」方法で適切に登録されていると思います。これは、人事のパラダイムと互換性があり、すべての安全なコードがメインスレッドでロックされる</font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ため、フレームの適切なタイミングで行われるため、</font><font style="vertical-align: inherit;">後で何かを完全に実行できます。</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Task.Yield（）</font></font></h4><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このメソッドの説明は非常に混乱します：</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docs.microsoft.com/en-us/dotnet/api/system.threading.tasks.task.yield?view=netframework-4.8</font></font></a></i><br>
<blockquote><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">YieldAwaitable</a><br>
<br>
 ,  ,          .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">SynchronizationContext</a>   NULL,     .     ,     ,    .<br>
<br>
<b></b><br>
<br>
   <code>await Task.Yield()</code>;   ,     .      ( SynchronizationContext),         .   ,  ,         ,    .  ,    UI     UI,    ,    ,     .     ,  <code>await Task.Yield()</code>;   UI .      « ,    ContinueWith»   «   .NET».</blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
英語は私の母国語ではありません。C＃</font></font><code>yield return</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">も</font></font><code>Task.Yield()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、彼らが実行する機能</font><font style="vertical-align: inherit;">も</font><font style="vertical-align: inherit;">反映して</font><font style="vertical-align: inherit;">いないと思い</font><font style="vertical-align: inherit;">ます。しかし、メソッドの定義に移りましょう。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/6k/-f/oi/6k-foipgostpw8fxs9c9znoz7jo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メモ内の主張されたユースケースは、メソッドが実際</font></font><code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">はでないことを示している</font></font><code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ようですが、</font><font style="vertical-align: inherit;">それをに変えたい</font><font style="vertical-align: inherit;">ので、</font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">どこかで（期待する）</font><font style="vertical-align: inherit;">必要</font></font><code>Task.Yield()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">がある</font><font style="vertical-align: inherit;">ため</font><font style="vertical-align: inherit;">、理想的なスケープゴートです。メソッドをすぐに終了する代わりに（asyncはメソッドを魔法のように非同期に変換しない</font><font style="vertical-align: inherit;">ことに注意して</font><font style="vertical-align: inherit;">ください</font><font style="vertical-align: inherit;">。これ</font><font style="vertical-align: inherit;">はメソッドの内容に依存します）、ここで</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">強制的</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に非同期にします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、私たちの場合、コンテキストの受信者は通常のコンテキストではなく、</font></font><code>UnitySynchronizationContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。さて</font></font><code>Task.Yield()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次のフレームでも効果的に機能し続ける、より便利な機能があります。</font><font style="vertical-align: inherit;">それが普通</font></font><code>SynchronizationContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">だったとしたら、この例では無限ループが発生する可能性があると思います。なぜなら、それはまっすぐに</font></font><code>while</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">何度</font><font style="vertical-align: inherit;">も続くため</font><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">呼び出し元が続行に使用できる</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ものを返します</font></font><code>YieldAwaiter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ログが示すように、コンテキスト（その隣のコード</font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）がこのアビエイターに保存された</font><font style="vertical-align: inherit;">ため、「待機」が各フレームの先頭に記録されました</font><font style="vertical-align: inherit;">。</font></font><code>UnitySynchronizationContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">魔法をかけ、フレームを待機し、このアベイターを使用して続行し、次に</font></font><code>while</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいもの</font><font style="vertical-align: inherit;">に到達</font><font style="vertical-align: inherit;">して返します</font></font><code>YieldAwaiter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これはおそらく、新規に追加していきます</font></font><code>WorkRequest</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">まで待ちタスクとして、以前の各フレーム内のコードを</font></font><code>while</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、それはなり</font></font><code>false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UniTask</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">APIに</font><font style="vertical-align: inherit;">直接バインドする</font><font style="vertical-align: inherit;">新しいタイプの軽量タスク</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">完全に排除</font><font style="vertical-align: inherit;">して導入</font><font style="vertical-align: inherit;">
する人気のある</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UniTask</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パッケージ</font><font style="vertical-align: inherit;">が</font><font style="vertical-align: inherit;">あり</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">次に、次のフレームでチェックを行う時間を選択できます。</font><font style="vertical-align: inherit;">（初期化？最新の更新？）しかし、実際には、</font><font style="vertical-align: inherit;">プラグインなしで</font><font style="vertical-align: inherit;">何が</font><font style="vertical-align: inherit;">機能するか</font><font style="vertical-align: inherit;">知ってい</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">これは、可能な</font><font style="vertical-align: inherit;">限り</font><font style="vertical-align: inherit;">Addressablesで役立ち</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">で使用できます</font><font style="vertical-align: inherit;">。</font></font><code>SynchronizationContext</code><font style="vertical-align: inherit;"></font><code>UniTask</code><font style="vertical-align: inherit;"></font><code>PlayerLoop</code><font style="vertical-align: inherit;"></font><code>await</code><font style="vertical-align: inherit;"></font><code>AsyncOperationHandle</code><font style="vertical-align: inherit;"></font><code>Task</code><font style="vertical-align: inherit;"></font><code>await</code><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示するには</font></font></h3><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/7eKi6NKri6I" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは良い会話です。これは</font></font><code>Await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">既に正常に機能し</font><font style="vertical-align: inherit;">ていることを示していますが</font><font style="vertical-align: inherit;">、合理的に使用されているコルーチンにはプラス点があります。</font><font style="vertical-align: inherit;">まだ混乱している場合は、このスライドを注意して少し整理してください。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8c/md/kw/8cmdkwfptrr0hr-y6twos_oto7u.png"><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちは、1時間半で宇宙にネットワークシューターを作成します。</font></font></a><br>
<br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja506940/index.html">理想への道：プログラマーとそのリーダーのための短いガイド</a></li>
<li><a href="../ja506950/index.html">School 21とは何ですか、なぜそのように設計されているのですか</a></li>
<li><a href="../ja506952/index.html">APIポータル：設計時に何を探すか。Wrike Experience</a></li>
<li><a href="../ja506954/index.html">RailsとELKに関する別の記事</a></li>
<li><a href="../ja506956/index.html">量子テクノロジーと健康</a></li>
<li><a href="../ja506964/index.html">Android開発：2020年5月のキャリアレビュー</a></li>
<li><a href="../ja506976/index.html">Solutionix D500およびD700 3Dスキャナーの概要</a></li>
<li><a href="../ja506980/index.html">HackTheBoxエンドゲーム。ウォークスルーXenラボ。Pentest Active Directory</a></li>
<li><a href="../pt486176/index.html">Memorando de correspondência por e-mail corporativo</a></li>
<li><a href="../pt486178/index.html">FOSS News No. 1 - revisão de notícias gratuitas e de código aberto de 27 de janeiro a 2 de fevereiro de 2020</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>