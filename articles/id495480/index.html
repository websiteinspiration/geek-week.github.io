<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨ğŸ½â€ğŸ¨ â˜ï¸ ğŸ” Membuat binding Python untuk pustaka C / C ++ menggunakan SIP. Bagian 1 â–«ï¸ ğŸ˜¨ ğŸ“¤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Terkadang, saat mengerjakan proyek dengan Python, ada keinginan untuk menggunakan pustaka yang tidak ditulis dalam Python, tetapi, misalnya, dalam C a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Membuat binding Python untuk pustaka C / C ++ menggunakan SIP. Bagian 1</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495480/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terkadang, saat mengerjakan proyek dengan Python, ada keinginan untuk menggunakan pustaka yang tidak ditulis dalam Python, tetapi, misalnya, dalam C atau C ++. Alasan untuk ini mungkin berbeda: Pertama, Python adalah bahasa yang indah, tetapi dalam beberapa situasi itu tidak cukup cepat. Dan jika Anda melihat bahwa kinerja dibatasi oleh fitur-fitur bahasa Python, maka masuk akal untuk menulis bagian dari program dalam bahasa lain (dalam artikel ini kita akan berbicara tentang C dan C ++), mengatur bagian program ini sebagai perpustakaan, membuat binding Python (binding Python) di atasnya dan gunakan modul sehingga diperoleh sebagai perpustakaan Python normal. Kedua, situasi sering terjadi ketika Anda tahu bahwa ada perpustakaan yang memecahkan masalah yang diperlukan, tetapi, sayangnya, perpustakaan ini tidak ditulis dengan Python, tetapi dalam C atau C ++ yang sama.Dalam hal ini, kita juga dapat membuat Python yang mengikat perpustakaan dan menggunakannya tanpa memikirkan fakta bahwa perpustakaan tersebut pada awalnya tidak ditulis dengan Python.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada berbagai alat untuk membuat binding Python, mulai dari yang lebih rendah seperti </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API Python / C</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hingga yang lebih tinggi seperti </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SWIG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya tidak memiliki tujuan membandingkan berbagai cara membuat binding Python, tetapi saya ingin berbicara tentang dasar-dasar menggunakan satu alat, yaitu </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Awalnya, SIP dirancang untuk membuat pengikatan di sekitar perpustakaan Qt - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyQt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan juga digunakan untuk mengembangkan pustaka Python besar lainnya, misalnya, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wxPython</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada artikel ini, gcc akan digunakan sebagai kompiler untuk C, dan g ++ akan digunakan sebagai kompiler C ++. </font><font style="vertical-align: inherit;">Semua contoh diuji di bawah Arch Linux dan Python 3.8. </font><font style="vertical-align: inherit;">Agar tidak menyulitkan contoh, topik kompilasi untuk sistem operasi yang berbeda dan menggunakan kompiler yang berbeda (misalnya, Visual Studio) tidak termasuk dalam ruang lingkup artikel ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat mengunduh semua contoh untuk artikel ini dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repositori di github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Repositori dengan sumber SIP terletak di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://www.riverbankcomputing.com/hg/sip/</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Mercurial digunakan sebagai sistem kontrol versi untuk SIP.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Membuat penjilidan ke perpustakaan di C</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Menulis perpustakaan di C</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contoh ini terletak di folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_01</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di sumber, tetapi dalam artikel ini kita akan menganggap bahwa kita melakukan semuanya dari awal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita mulai dengan contoh sederhana. </font><font style="vertical-align: inherit;">Pertama, kita akan membuat pustaka C sederhana, yang kemudian akan kita jalankan dari skrip Python. </font><font style="vertical-align: inherit;">Biarkan perpustakaan kami menjadi satu-satunya fungsi</font></font><br>
<br>
<pre><code class="plaintext hljs">int foo(char*);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
yang akan mengambil string dan mengembalikan panjangnya dikalikan dengan 2. File </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
header </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mungkin terlihat, misalnya, seperti ini:</font></font><br>
<br>
<pre><code class="plaintext hljs">#ifndef FOO_LIB<font></font>
#define FOO_LIB<font></font>
<font></font>
int foo(char* str);<font></font>
<font></font>
#endif<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan file dengan implementasi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">#include &lt;string.h&gt;<font></font>
<font></font>
#include "foo.h"<font></font>
<font></font>
int foo(char* str) {<font></font>
	return strlen(str) * 2;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk menguji fungsionalitas perpustakaan, kami akan menulis program </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.c</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sederhana </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">#include &lt;stdio.h&gt;<font></font>
<font></font>
#include "foo.h"<font></font>
<font></font>
int main(int argc, char* argv[]) {<font></font>
	char* str = "0123456789";<font></font>
	printf("%d\n", foo(str));<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk akurasi, buat </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Makefile</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">CC=gcc<font></font>
CFLAGS=-c<font></font>
DIR_OUT=bin<font></font>
<font></font>
all: main<font></font>
<font></font>
main: main.o libfoo.a<font></font>
	$(CC) $(DIR_OUT)/main.o -L$(DIR_OUT) -lfoo -o $(DIR_OUT)/main<font></font>
<font></font>
main.o: makedir main.c<font></font>
	$(CC) $(CFLAGS) main.c -o $(DIR_OUT)/main.o<font></font>
<font></font>
libfoo.a: makedir foo.c<font></font>
	$(CC) $(CFLAGS) foo.c -o $(DIR_OUT)/foo.o<font></font>
	ar rcs $(DIR_OUT)/libfoo.a $(DIR_OUT)/foo.o<font></font>
<font></font>
makedir:<font></font>
	mkdir -p $(DIR_OUT)<font></font>
<font></font>
clean:<font></font>
	rm -rf $(DIR_OUT)/*<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Biarkan semua sumber </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> perpustakaan </font><font style="vertical-align: inherit;">berada dalam subfolder dari </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di folder sumber:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo_c_01 /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â””â”€â”€ foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    â”œâ”€â”€ foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    â”œâ”€â”€ foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    â”œâ”€â”€ main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    â””â”€â”€ Makefile</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami masuk ke folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan kompilasi sumber menggunakan perintah</font></font><br>
<br>
<pre><code class="bash hljs">make
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selama kompilasi, teks akan ditampilkan.</font></font><br>
<br>
<pre><code class="bash hljs">mkdir -p bin<font></font>
gcc -c main.c -o bin/main.o<font></font>
gcc -c foo.c -o bin/foo.o<font></font>
ar rcs bin/libfoo.a bin/foo.o<font></font>
gcc bin/main.o -Lbin -lfoo -o bin/main<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hasil kompilasi akan ditempatkan di folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bin</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di dalam folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo_c_01 /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â””â”€â”€ foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    â”œâ”€â”€ bin</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    â”‚ â”œâ”€â”€ foo.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    â”‚ â”œâ”€â”€ libfoo.a</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    â”‚ â”œâ”€â”€ utama</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    â”‚ â””â”€â”€ main.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    â”œâ”€â”€ foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    â”œâ”€â”€ foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    â”œâ”€â”€ main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    â””â”€â”€ Makefile</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami mengkompilasi pustaka untuk tautan statis dan program yang menggunakannya dengan nama </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utama</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Setelah kompilasi, Anda dapat memverifikasi bahwa program </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utama</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dimulai. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita membuat Python yang mengikat perpustakaan foo.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dasar-dasar SIP</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama, Anda perlu menginstal SIP. </font><font style="vertical-align: inherit;">Ini dilakukan secara standar, seperti semua perpustakaan lain yang menggunakan pip:</font></font><br>
<br>
<pre><code class="bash hljs">pip install --user sip
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentu saja, jika Anda bekerja di lingkungan virtual, maka parameter --user, yang menunjukkan bahwa perpustakaan SIP perlu diinstal di folder pengguna, dan tidak secara global dalam sistem, tidak boleh ditentukan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apa yang perlu kita lakukan agar foo library dapat dipanggil dari kode Python? Minimal, Anda perlu membuat dua file: salah satunya dalam format TOML dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">beri</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nama </font><i><font style="vertical-align: inherit;">pyproject.toml</font></i><font style="vertical-align: inherit;"> , dan yang kedua adalah file dengan ekstensi .sip. Mari kita hadapi masing-masing secara berurutan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kita perlu menyetujui struktur sumbernya. Di dalam </font><font style="vertical-align: inherit;">folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang berisi sumber untuk perpustakaan. Setelah dikompilasi </font><font style="vertical-align: inherit;">, folder </font><i><font style="vertical-align: inherit;">bin</font></i><font style="vertical-align: inherit;"> dibuat </font><font style="vertical-align: inherit;">di dalam </font><font style="vertical-align: inherit;">folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, yang akan berisi semua file yang dikompilasi. </font><font style="vertical-align: inherit;">Nanti kita akan menambahkan kemampuan bagi pengguna untuk menentukan jalur ke file header dan objek perpustakaan melalui baris perintah. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
File yang diperlukan untuk SIP akan berada di folder yang sama dengan folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pyproject.toml</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
File </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bukan merupakan penemuan pengembang SIP, tetapi format deskripsi proyek Python dijelaskan dalam </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP 517 â€œFormat independen sistem bangun untuk pohon sumberâ€</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan dalam </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP 518 â€œMenentukan Persyaratan Sistem Bangun Minimum untuk Proyek Pythonâ€</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ini adalah </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">file TOML</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang dapat dianggap sebagai versi yang lebih maju dari format ini, di mana parameter disimpan dalam bentuk "key = value", dan parameter dapat ditemukan tidak hanya di bagian seperti [foo], yang disebut tabel dalam istilah TOML, tetapi dan di subbagian formulir [foo.bar.spam]. Parameter dapat berisi tidak hanya string, tetapi juga daftar, angka, dan nilai Boolean.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
File ini seharusnya menggambarkan semua yang diperlukan untuk membangun paket Python, dan tidak harus menggunakan SIP. </font><font style="vertical-align: inherit;">Namun, seperti yang akan kita lihat nanti, dalam beberapa kasus file ini tidak akan cukup, dan di samping itu perlu membuat skrip Python kecil. </font><font style="vertical-align: inherit;">Tapi mari kita bicara tentang semuanya secara berurutan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deskripsi lengkap tentang semua parameter yang mungkin dari file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> yang terkait dengan SIP dapat ditemukan di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">halaman dokumentasi SIP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai contoh kita, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">buat</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> file </font><i><font style="vertical-align: inherit;">pyproject.toml</font></i><font style="vertical-align: inherit;"> pada tingkat yang sama dengan folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo_c_01 /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”œâ”€â”€ foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ bin</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â”œâ”€â”€ foo.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â”œâ”€â”€ libfoo.a</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â”œâ”€â”€ utama</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â””â”€â”€ main.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â””â”€â”€ Makefile</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â””â”€â”€ pyproject.toml</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah sebagai berikut:</font></font><br>
<br>
<pre><code class="plaintext hljs">[build-system]<font></font>
requires = ["sip &gt;=5, &lt;6"]<font></font>
build-backend = "sipbuild.api"<font></font>
<font></font>
[tool.sip.metadata]<font></font>
name = "pyfoo"<font></font>
version = "0.1"<font></font>
license = "MIT"<font></font>
<font></font>
[tool.sip.bindings.pyfoo]<font></font>
headers = ["foo.h"]<font></font>
libraries = ["foo"]<font></font>
include-dirs = ["foo"]<font></font>
library-dirs = ["foo/bin"]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagian </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[build-system]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ("table" dalam istilah TOML) adalah standar dan dijelaskan dalam </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP 518</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ini berisi dua parameter:</font></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">membutuhkan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - daftar paket yang diperlukan untuk membangun paket kami. </font><font style="vertical-align: inherit;">Format deskripsi ketergantungan paket dijelaskan dalam </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spesifikasi Ketergantungan PEP 508 untuk Paket Perangkat Lunak Python</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dalam hal ini, kita hanya perlu paket sip versi 5.x.</font></font></li>
<li><i>build-backend</i> ,        .  ,          Python-,    .        ,   ,    SIP,     Â«sipbuild.apiÂ».</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parameter lain dijelaskan dalam Bagian </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[tool.sip. *]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagian </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[tool.sip.metadata]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> berisi informasi umum tentang paket: nama paket yang akan dirakit (paket kami akan disebut </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tetapi jangan bingung nama ini dengan nama modul, yang nantinya akan kami impor ke Python), nomor versi paket (dalam kasus kami) nomor versi "0,1") dan lisensi (misalnya, " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MIT</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yang paling penting dari sudut pandang perakitan dijelaskan dalam [tool.sip.bindings. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perhatikan nama paket di header bagian. </font><font style="vertical-align: inherit;">Kami telah menambahkan dua parameter ke bagian ini:</font></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">header</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - daftar file header yang diperlukan untuk menggunakan perpustakaan foo.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perpustakaan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - daftar file objek yang dikompilasi untuk tautan statis.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">termasuk-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah jalan mana untuk mencari file header tambahan selain mereka yang melekat pada C compiler. Dalam hal ini, di mana untuk mencari </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> berkas </font><font style="vertical-align: inherit;">.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dir-library</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah path tempat mencari file objek tambahan selain yang dilampirkan ke kompiler C. Dalam hal ini, ini adalah folder di mana file library yang dikompilasi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo dibuat</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, kami membuat file yang diperlukan pertama untuk SIP. </font><font style="vertical-align: inherit;">Sekarang kita beralih ke membuat file selanjutnya yang akan menjelaskan isi modul Python masa depan.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pyfoo.sip</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Buat file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di folder yang sama dengan file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo_c_01 /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”œâ”€â”€ foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ bin</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â”œâ”€â”€ foo.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â”œâ”€â”€ libfoo.a</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â”œâ”€â”€ utama</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â””â”€â”€ main.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â””â”€â”€ Makefile</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”œâ”€â”€ pyfoo.sip</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â””â”€â”€ pyproject.toml</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
File dengan ekstensi .sip menggambarkan antarmuka pustaka sumber, yang akan dikonversi menjadi modul dengan Python. </font><font style="vertical-align: inherit;">File ini memiliki format sendiri, yang sekarang akan kita pertimbangkan, dan menyerupai file header C / C ++ dengan markup tambahan, yang seharusnya membantu SIP membuat modul Python. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam contoh kita, file ini harus disebut </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , karena sebelum itu, dalam file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kami membuat [tool.sip.bindings. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">] Dalam kasus umum, mungkin ada beberapa partisi seperti itu dan, karenanya, harus ada beberapa file * .sip. Tetapi jika kita memiliki beberapa file sip, maka ini adalah kasus khusus dari sudut pandang SIP, dan kami tidak akan mempertimbangkannya dalam artikel ini. Harap perhatikan bahwa dalam kasus umum, nama file .sip (dan, sesuai dengan itu, nama bagian) mungkin tidak sesuai dengan nama paket yang ditentukan dalam parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nama</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di bagian </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[tool.sip.metadata]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertimbangkan file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dari contoh kami:</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foo, language=<span class="hljs-string">"C"</span>)<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-keyword">char</span>*)</span></span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris yang dimulai dengan karakter "%" disebut arahan. Mereka harus memberi tahu SIP cara merakit dan mengatur modul Python dengan benar. Daftar lengkap arahan dijelaskan pada </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">halaman dokumentasi ini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Beberapa arahan memiliki parameter tambahan. Parameter mungkin tidak diperlukan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam contoh ini, kami menggunakan dua arahan, kami akan mengenal beberapa arahan lain dalam contoh berikut. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
File </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dimulai dengan direktif </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Module (name = foo, language = "C")</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Harap dicatat bahwa </font><font style="vertical-align: inherit;">kami menentukan </font><font style="vertical-align: inherit;">nilai parameter pertama ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nama</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) tanpa tanda kutip, dan nilai parameter kedua ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bahasa</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) dengan tanda kutip, seperti string dalam C / C ++. </font><font style="vertical-align: inherit;">Ini adalah persyaratan dari arahan ini seperti yang dijelaskan dalam dokumentasi untuk </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> direktif </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Modul</font></a><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam direktif </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Module</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">hanya parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nama</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> yang diperlukan </font><font style="vertical-align: inherit;">, yang menetapkan nama modul Python dari mana kita akan mengimpor fungsi pustaka. </font><font style="vertical-align: inherit;">Dalam hal ini, modul ini disebut </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , itu akan berisi fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , jadi setelah perakitan dan instalasi kita akan mengimpornya menggunakan kode:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> foo <span class="hljs-keyword">import</span> foo
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kita dapat membuat modul ini bersarang di modul lain dengan mengganti baris ini, misalnya, dengan ini:</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foo.bar, language=<span class="hljs-string">"C"</span>)<font></font>
...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kemudian impor fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> harus sebagai berikut:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> foo.bar <span class="hljs-keyword">import</span> foo
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bahasa</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dari direktif </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Module</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menunjukkan bahasa tempat pustaka sumber ditulis. </font><font style="vertical-align: inherit;">Nilai parameter ini bisa berupa "C" atau "C ++". </font><font style="vertical-align: inherit;">Jika parameter ini tidak ditentukan, maka SIP akan menganggap bahwa pustaka ditulis dalam C ++. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang lihat baris terakhir file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-keyword">char</span>*)</span></span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini adalah deskripsi antarmuka fungsi dari perpustakaan yang ingin kita masukkan ke dalam modul Python. </font><font style="vertical-align: inherit;">Berdasarkan deklarasi ini, sip akan membuat fungsi Python. </font><font style="vertical-align: inherit;">Saya pikir semuanya harus jelas di sini.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kami mengumpulkan dan memeriksa</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang semuanya siap untuk membangun paket Python dengan pengikatan untuk pustaka C. Pertama-tama, Anda perlu membangun pustaka itu sendiri. </font><font style="vertical-align: inherit;">Pergi ke </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">folder pyfoo_c_01 / foo /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan mulai membangun menggunakan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perintah make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="bash hljs">$ make<font></font>
<font></font>
mkdir -p bin<font></font>
gcc -c main.c -o bin/main.o<font></font>
gcc -c foo.c -o bin/foo.o<font></font>
ar rcs bin/libfoo.a bin/foo.o<font></font>
gcc bin/main.o -Lbin -lfoo -o bin/main<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika semuanya berjalan dengan baik, maka </font><font style="vertical-align: inherit;">folder </font><i><font style="vertical-align: inherit;">bin</font></i><font style="vertical-align: inherit;"> akan dibuat </font><font style="vertical-align: inherit;">di dalam </font><font style="vertical-align: inherit;">folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , di mana, di antara file-file lain, akan ada perpustakaan </font><i><font style="vertical-align: inherit;">libfoo.a yang</font></i><font style="vertical-align: inherit;"> dikompilasi </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Biarkan saya mengingatkan Anda bahwa di sini, agar tidak teralihkan dari topik utama, kita hanya berbicara tentang membangun di Linux menggunakan gcc. </font><font style="vertical-align: inherit;">
Kembali ke folder </font><i><font style="vertical-align: inherit;">pyfoo_c_01</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Sekarang saatnya mengenal tim SIP. </font><font style="vertical-align: inherit;">Setelah menginstal SIP, perintah baris perintah berikut akan tersedia ( </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">halaman dokumentasi</font></a><font style="vertical-align: inherit;"> ):</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Membuat file objek ekstensi Python.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-instal</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Membuat file objek ekstensi Python dan menginstalnya.</font></font></li>
<li><i>sip-sdist</i>.      .tar.gz,      pip.</li>
<li><i>sip-wheel</i>.     wheel (   .whl).</li>
<li><i>sip-module</i>.  ,      ,   SIP.  ,    ,    .         ,       standalone project,      ,     ,     ,    .</li>
<li><i>sip-distinfo</i>.     <i>.dist-info</i>,       wheel.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perintah-perintah ini harus dijalankan dari folder di mana file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml berada</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memulai, untuk lebih memahami operasi SIP, jalankan perintah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dengan opsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--verbose</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk output yang lebih detail ke konsol, dan lihat apa yang terjadi selama proses build. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-build --verbose</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Bindings ini akan dibuat: pyfoo. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menghasilkan binding pyfoo ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mengkompilasi modul 'foo' ... </font><font style="vertical-align: inherit;">
membuat </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ekstensi 'foo' </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">membuat </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pembuatan build build / temp.linux-x86_64-3.8</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-tidak digunakan-hasil -Wsign-bandingkan -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c sipfoocmodule.c -o build / temp.linux-x86_64-3.8 / sipfoocmodule.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sipfoocmodule.c: Dalam fungsi </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
func_foo </font><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">sipfoocmodule .c: 29: 22: peringatan: deklarasi fungsi implisit â€œfooâ€ [-Wimplicit-function-declaration] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 29 | sipRes = foo (a0); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~~</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-tidak digunakan-hasil -Wsign-bandingkan -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c array.c -o build / temp.linux-x86_64-3.8 / array.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-tidak digunakan-hasil -Wsign -compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = publik -I. -I ../../ foo -I / usr / include / python3.8 -c bool.cpp -o build / temp.linux-x86_64-3.8 / bool.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-tidak digunakan-hasil -Wsign-bandingkan -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c objmap.c -o build / temp.linux-x86_64-3.8 / objmap.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-tidak digunakan-hasil -Wsign -compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = publik -I. -I ../../ foo -I / usr / include / python3.8 -c qtlib.c -o build / temp.linux-x86_64-3.8 / qtlib.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-tidak digunakan-hasil -Wsign-bandingkan -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c int_convertors.c -o build / temp.linux-x86_64-3.8 / int_convertors.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-tidak digunakan-hasil -Wsign -compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = publik -I. -I ../../ foo -I / usr / include / python3.8 -c voidptr.c -o build / temp.linux-x86_64-3.8 / voidptr.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-tidak digunakan-hasil -Wsign-bandingkan -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c apiversions.c -o build / temp.linux-x86_64-3.8 / apiversions.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-tidak digunakan-hasil -Wsign -compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = publik -I. -I ../../ foo -I / usr / include / python3.8 -c descriptors.c -o build / temp.linux-x86_64-3.8 / descriptors.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-tidak digunakan-hasil -Wsign-bandingkan -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c threads.c -o build / temp.linux-x86_64-3.8 / </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
threads.o gcc -pthread -Wno-tidak digunakan-hasil -Wsign -compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -march = x86-64 -mtune = generik -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = publik -I. -I ../../ foo -I / usr / include / python3.8 -c siplib.c -o build / temp.linux-x86_64-3.8 / siplib.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: Dalam fungsi "slot_richcompare": </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: 9536: 16: peringatan: "st" dapat digunakan tanpa inisialisasi dalam fungsi ini [-Wmaybe-uninitialized] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 9536 | slot = findSlotInClass (ctd, st); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~~~~~~~~~~~~~~~~~~~~~~~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: 10671: 19: note: "st" dideklarasikan di sini </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
10671 | sipPySlotType st; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: Dalam fungsi "parsePass2": </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: 5625: 32: peringatan: "pemilik" dapat digunakan tanpa inisialisasi dalam fungsi ini [-Wmaybe-uninitialized] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 5625 | * pemilik = arg; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ~~~~~~~ ^ ~</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
g ++ -pthread-shared -Wl, -O1, - sort-common, - sesuai kebutuhan, -z, relro, -z, sekarang -fno-semantic-interposition -Wl, -O1, - sort-common, --sebagai diperlukan, -z, relro, -z, sekarang build / temp.linux-x86_64-3.8 / sipfoocmodule.o build / temp.linux-x86_64-3.8 / array.o build / temp.linux-x86_64-3.8 /bool.o build / temp.linux-x86_64-3.8 / objmap.o build / temp.linux-x86_64-3.8 / qtlib.o build / temp.linux-x86_64-3.8 / int_convertors.o build / temp.linux-x86_64 -3.8 / voidptr.o build / temp.linux-x86_64-3.8 / apiversions.o build / temp.linux-x86_64-3.8 / descriptors.o build / temp.linux-x86_64-3.8 / threads.o build / temp.linux -x86_64-3.8 / siplib.o -L ../../ foo / bin -L / usr / lib -lfoo -o / home / jenyay / proyek / soft / sip-contoh / pyfoo_c_01 / build / foo / foo. cpython-38-x86_64-linux-gnu.so </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Proyek ini telah dibangun.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami tidak akan masuk jauh ke dalam pekerjaan SIP, tetapi dapat dilihat dari output yang dikompilasi oleh beberapa sumber. </font><font style="vertical-align: inherit;">Sumber-sumber ini dapat dilihat di folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build / foo / yang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dibuat oleh perintah ini </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_01</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”œâ”€â”€ membangun</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â””â”€â”€ foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ perpisahan.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ array.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ array.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ bool.cpp</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ membangun</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â””â”€â”€ temp.linux-x86_64-3.8</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â”œâ”€â”€ perpisahan.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â”œâ”€â”€ array.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â”œâ”€â”€ bool.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â”œâ”€â”€ deskriptor.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â”œâ”€â”€ int_convertors.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â”œâ”€â”€ objmap.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â”œâ”€â”€ qtlib.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â”œâ”€â”€ sipfoocmodule.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â”œâ”€â”€ siplib.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â”œâ”€â”€ threads.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â””â”€â”€ voidptr.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ deskriptor.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ foo.cpython-38-x86_64-linux-gnu.so</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ int_convertors.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ objmap.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ qtlib.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ sipAPIfoo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ sipfoocmodule.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ sip.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ sipint.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ siplib.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ threads.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â””â”€â”€ voidptr.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”œâ”€â”€ foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ bin</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â”œâ”€â”€ foo.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â”œâ”€â”€ libfoo.a</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â”œâ”€â”€ utama</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”‚ â””â”€â”€ main.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â”œâ”€â”€ main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”‚ â””â”€â”€ Makefile</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â”œâ”€â”€ pyfoo.sip</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â””â”€â”€ pyproject.toml</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sumber tambahan muncul </font><font style="vertical-align: inherit;">
di folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build / foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Karena penasaran, mari kita lihat file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipfoocmodule.c</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , karena langsung berhubungan dengan modul </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> yang akan dibuat:</font></font><br>
<br>
<pre><code class="plaintext hljs">/*<font></font>
 * Module code.<font></font>
 *<font></font>
 * Generated by SIP 5.1.1<font></font>
 */<font></font>
<font></font>
#include "sipAPIfoo.h"<font></font>
<font></font>
/* Define the strings used by this module. */<font></font>
const char sipStrings_foo[] = {<font></font>
    'f', 'o', 'o', 0,<font></font>
};<font></font>
<font></font>
PyDoc_STRVAR(doc_foo, "foo(str) -&gt; int");<font></font>
<font></font>
static PyObject *func_foo(PyObject *sipSelf,PyObject *sipArgs)<font></font>
{<font></font>
    PyObject *sipParseErr = SIP_NULLPTR;<font></font>
<font></font>
    {<font></font>
        char* a0;<font></font>
<font></font>
        if (sipParseArgs(&amp;sipParseErr, sipArgs, "s", &amp;a0))<font></font>
        {<font></font>
            int sipRes;<font></font>
<font></font>
            sipRes = foo(a0);<font></font>
<font></font>
            return PyLong_FromLong(sipRes);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    /* Raise an exception if the arguments couldn't be parsed. */<font></font>
    sipNoFunction(sipParseErr, sipName_foo, doc_foo);<font></font>
<font></font>
    return SIP_NULLPTR;<font></font>
}<font></font>
<font></font>
/* This defines this module. */<font></font>
sipExportedModuleDef sipModuleAPI_foo = {<font></font>
    0,<font></font>
    SIP_ABI_MINOR_VERSION,<font></font>
    sipNameNr_foo,<font></font>
    0,<font></font>
    sipStrings_foo,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    0,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    0,<font></font>
    SIP_NULLPTR,<font></font>
    0,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    {SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR,<font></font>
            SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR},<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR<font></font>
};<font></font>
<font></font>
/* The SIP API and the APIs of any imported modules. */<font></font>
const sipAPIDef *sipAPI_foo;<font></font>
<font></font>
/* The Python module initialisation function. */<font></font>
#if defined(SIP_STATIC_MODULE)<font></font>
PyObject *PyInit_foo(void)<font></font>
#else<font></font>
PyMODINIT_FUNC PyInit_foo(void)<font></font>
#endif<font></font>
{<font></font>
    static PyMethodDef sip_methods[] = {<font></font>
        {sipName_foo, func_foo, METH_VARARGS, doc_foo},<font></font>
        {SIP_NULLPTR, SIP_NULLPTR, 0, SIP_NULLPTR}<font></font>
    };<font></font>
<font></font>
    static PyModuleDef sip_module_def = {<font></font>
        PyModuleDef_HEAD_INIT,<font></font>
        "foo",<font></font>
        SIP_NULLPTR,<font></font>
        -1,<font></font>
        sip_methods,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_NULLPTR<font></font>
    };<font></font>
<font></font>
    PyObject *sipModule, *sipModuleDict;<font></font>
    /* Initialise the module and get it's dictionary. */<font></font>
    if ((sipModule = PyModule_Create(&amp;sip_module_def)) == SIP_NULLPTR)<font></font>
        return SIP_NULLPTR;<font></font>
<font></font>
    sipModuleDict = PyModule_GetDict(sipModule);<font></font>
<font></font>
    if ((sipAPI_foo = sip_init_library(sipModuleDict)) == SIP_NULLPTR)<font></font>
        return SIP_NULLPTR;<font></font>
<font></font>
    /* Export the module and publish it's API. */<font></font>
    if (sipExportModule(&amp;sipModuleAPI_foo, SIP_ABI_MAJOR_VERSION, SIP_ABI_MINOR_VERSION, 0) &lt; 0)<font></font>
    {<font></font>
        Py_DECREF(sipModule);<font></font>
        return SIP_NULLPTR;<font></font>
    }<font></font>
    /* Initialise the module now all its dependencies have been set up. */<font></font>
    if (sipInitModule(&amp;sipModuleAPI_foo,sipModuleDict) &lt; 0)<font></font>
    {<font></font>
        Py_DECREF(sipModule);<font></font>
        return SIP_NULLPTR;<font></font>
    }<font></font>
<font></font>
    return sipModule;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda bekerja dengan API Python / C, Anda akan melihat fungsi yang sudah dikenal. Perhatikan fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">func_foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mulai dari baris 18. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai hasil kompilasi dari sumber-sumber ini, file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build / foo / foo.cpython-38-x86_64-linux-gnu.so</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan dibuat </font><font style="vertical-align: inherit;">, dan berisi ekstensi Python, yang masih perlu diinstal dengan benar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mengkompilasi ekstensi dan menginstalnya segera, Anda dapat menggunakan perintah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-install</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tetapi kami tidak akan menggunakannya, karena secara default ia mencoba untuk menginstal ekstensi Python yang dibuat secara global ke dalam sistem. Perintah ini memiliki parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--target-dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dengan mana Anda dapat menentukan jalur tempat Anda ingin menginstal ekstensi, tetapi kami lebih baik menggunakan alat lain yang membuat paket, yang kemudian dapat diinstal menggunakan pip. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama, gunakan perintah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Menggunakannya sangat sederhana:</font></font><br>
<br>
<pre><code class="bash hljs">$ sip-sdist<font></font>
<font></font>
The sdist has been built.<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah itu, file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo-0.1.tar.gz</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan dibuat </font><font style="vertical-align: inherit;">, yang dapat diinstal menggunakan perintah:</font></font><br>
<br>
<pre><code class="bash hljs">pip install --user pyfoo-0.1.tar.gz
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Akibatnya, informasi berikut akan ditampilkan dan paket akan diinstal:</font></font><br>
<br>
<pre><code class="plaintext hljs">Processing ./pyfoo-0.1.tar.gz<font></font>
  Installing build dependencies ... done<font></font>
  Getting requirements to build wheel ... done<font></font>
    Preparing wheel metadata ... done<font></font>
Building wheels for collected packages: pyfoo<font></font>
  Building wheel for pyfoo (PEP 517) ... done<font></font>
  Created wheel for pyfoo: filename=pyfoo-0.1-cp38-cp38-manylinux1_x86_64.whl size=337289 sha256=762fc578...<font></font>
  Stored in directory: /home/jenyay/.cache/pip/wheels/54/dc/d8/cc534fff...<font></font>
Successfully built pyfoo<font></font>
Installing collected packages: pyfoo<font></font>
  Attempting uninstall: pyfoo<font></font>
    Found existing installation: pyfoo 0.1<font></font>
    Uninstalling pyfoo-0.1:<font></font>
      Successfully uninstalled pyfoo-0.1<font></font>
Successfully installed pyfoo-0.1<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita pastikan bahwa kita berhasil membuat pengikatan Python. </font><font style="vertical-align: inherit;">Kami memulai Python dan mencoba memanggil fungsinya. </font><font style="vertical-align: inherit;">Biarkan saya mengingatkan Anda bahwa menurut pengaturan kami, paket </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> berisi modul </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang memiliki fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foo <span class="hljs-keyword">import</span> foo
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">b'123456'</span>)
<span class="hljs-number">12</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Harap dicatat bahwa sebagai parameter ke fungsi, kami melewati bukan hanya string, tetapi string byte b'123456 '- analog langsung </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ke C. Beberapa saat kemudian, kami akan menambahkan konversi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ke </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan sebaliknya. Hasilnya diharapkan. Biarkan saya mengingatkan Anda bahwa fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mengembalikan ukuran ganda dari array tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , diteruskan ke parameter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita coba meneruskan </font><font style="vertical-align: inherit;">string Python biasa </font><font style="vertical-align: inherit;">ke fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> alih-alih daftar byte.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foo <span class="hljs-keyword">import</span> foo
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">'123456'</span>)<font></font>
<font></font>
Traceback (most recent call last):<font></font>
  File <span class="hljs-string">"&lt;stdin&gt;"</span>, line <span class="hljs-number">1</span>, <span class="hljs-keyword">in</span> &lt;module&gt;<font></font>
TypeError: foo(str): argument <span class="hljs-number">1</span> has unexpected type <span class="hljs-string">'str'</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Penjilidan yang dibuat tidak dapat mengubah string menjadi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; kita akan membahas bagaimana cara mengajarkannya untuk melakukan ini di bagian selanjutnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selamat, kami membuat pengikatan pertama pada perpustakaan yang ditulis dalam C. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Keluar dari juru bahasa Python dan merakit perakitan dalam format roda. Seperti yang kemungkinan besar Anda ketahui, wheel adalah format paket yang relatif baru yang telah digunakan secara universal baru-baru ini. Formatnya dijelaskan dalam </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP 427, â€œPaket Binary Wheel Format 1.0,â€</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tetapi deskripsi fitur dari format roda adalah topik yang layak untuk artikel besar yang terpisah. Penting bagi kami bahwa pengguna dapat dengan mudah menginstal paket dalam format roda menggunakan pip. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Paket dalam format roda tidak lebih rumit dari paket dalam format sdist. Untuk melakukan ini, dalam folder dengan file tersebut</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> perlu menjalankan perintah</font></font><br>
<br>
<pre><code class="bash hljs">sip-wheel
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah menjalankan perintah ini, proses build akan ditampilkan dan mungkin ada peringatan dari kompiler: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ sip-wheel </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
binding ini akan dibangun: pyfoo. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menghasilkan binding pyfoo ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mengkompilasi modul 'foo' ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sipfoocmodule.c: Dalam fungsi </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
func_foo: sipfoocmodule.c: 29:22: warning: fungsi implisit deklarasi fungsi foo [-Wimplicit-function-declaration] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 29 | sipRes = foo (a0); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: Dalam fungsi "slot_richcompare": </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: 9536: 16: peringatan: "st" dapat digunakan tanpa inisialisasi dalam fungsi ini [-Wmaybe-uninitialized] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 9536 | slot = findSlotInClass (ctd, st); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~~~~~~~~~~~~~~~~~~~~~~~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: 10671: 19: komentar: "st" dinyatakan di sini</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
10671 | sipPySlotType st; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: Dalam fungsi "parsePass2": </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: 5625: 32: peringatan: "pemilik" mungkin digunakan tanpa inisialisasi dalam fungsi ini [-Wmaybe-uninitialized] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 5625 | * pemilik = arg; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ~~~~~~~ ^ ~ ~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Roda telah dibangun. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketika perakitan selesai (proyek kecil kami mengkompilasi dengan cepat), sebuah file dengan nama </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo-0.1-cp38-cp38-manylinux1_x86_64.whl</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau yang serupa </font><font style="vertical-align: inherit;">akan muncul di folder proyek </font><font style="vertical-align: inherit;">. Nama file yang dihasilkan mungkin berbeda tergantung pada sistem operasi dan versi Python Anda. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kita dapat menginstal paket ini menggunakan pip:</font></font><br>
<br>
<pre><code class="bash hljs">pip install --user --upgrade pyfoo-0.1-cp38-cp38-manylinux1_x86_64.whl
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Opsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--upgrade</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> digunakan di </font><i><font style="vertical-align: inherit;">sini</font></i><font style="vertical-align: inherit;"> sehingga pip menggantikan modul pyfoo yang diinstal sebelumnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya, modul </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan paket </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dapat digunakan, seperti yang ditunjukkan di atas.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tambahkan aturan konversi ke char *</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di bagian sebelumnya, kami mengalami masalah bahwa fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hanya dapat menerima satu set byte, tetapi bukan string. Sekarang kita akan memperbaiki kekurangan ini. Untuk melakukan ini, kita akan menggunakan alat SIP lain - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">anotasi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Anotasi digunakan di dalam file .sip dan diterapkan ke beberapa elemen kode: fungsi, kelas, argumen fungsi, pengecualian, variabel, dll. Anotasi ditulis di antara garis miring: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ annotation /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anotasi dapat berfungsi sebagai bendera, yang dapat di set negara atau tidak diatur, misalnya: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ ReleaseGIL /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , atau beberapa penjelasan perlu diberi beberapa nilai, misalnya: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Encoding = "UTF-8" /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Jika beberapa anotasi perlu diterapkan ke beberapa objek, maka dipisahkan dengan tanda koma di dalam garis miring: / annotation_1, annotation_2 /. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam contoh berikut, yang terletak di folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_02</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tambahkan file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fungsi parameter anotasi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">%Module(name=foo, language="C")<font></font>
<font></font>
int foo(char* /Encoding="UTF-8"/);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anotasi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengkodean</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menunjukkan di mana pengkodean string yang akan diteruskan ke fungsi harus dikodekan. Nilai untuk anotasi ini mungkin: ASCII, Latin-1, UTF-8, atau Tidak Ada. Jika anotasi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengkodean</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak ditentukan atau sama dengan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tidak Ada</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , maka parameter untuk fungsi tersebut tidak mengalami pengkodean apa pun dan diteruskan ke fungsi seperti apa adanya, tetapi dalam hal ini parameter dalam kode Python harus bertipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bytes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yaitu. array byte, seperti yang kita lihat pada contoh sebelumnya. Jika pengkodean ditentukan, maka parameter ini dapat berupa string (ketik </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dalam Python). Anotasi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pengodean</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hanya dapat diterapkan ke parameter tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const char</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita periksa bagaimana fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dari modul </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sekarang berfungsi </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Untuk melakukan ini, seperti sebelumnya, Anda pertama-tama harus mengkompilasi pustaka </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan </font><font style="vertical-align: inherit;">memanggil </font><font style="vertical-align: inherit;">perintah </font><i><font style="vertical-align: inherit;">make</font></i><font style="vertical-align: inherit;"> di dalam folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan kemudian </font><font style="vertical-align: inherit;">memanggil perintah, misalnya, </font><i><font style="vertical-align: inherit;">sip-wheel,</font></i><font style="vertical-align: inherit;"> dari folder contoh </font><i><font style="vertical-align: inherit;">pyfoo_c_02</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">File </font><i><font style="vertical-align: inherit;">pyfoo-0.2-cp38-cp38-manylinux1_x86_64.whl</font></i><font style="vertical-align: inherit;"> atau dengan nama yang serupa </font><font style="vertical-align: inherit;">akan dibuat </font><font style="vertical-align: inherit;">, yang dapat diatur menggunakan perintah:</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="bash hljs">pip install --user --upgrade pyfoo-0.2-cp38-cp38-manylinux1_x86_64.whl
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika semuanya berjalan dengan baik, jalankan interpreter Python dan coba panggil fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan argumen string:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foo <span class="hljs-keyword">import</span> foo<font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">b'qwerty'</span>)
<span class="hljs-number">12</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">'qwerty'</span>)
<span class="hljs-number">12</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">''</span>)
<span class="hljs-number">24</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama, kami memastikan bahwa menggunakan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">byte</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> masih dimungkinkan. Setelah itu, kami memastikan bahwa sekarang kami dapat meneruskan </font><font style="vertical-align: inherit;">argumen string </font><font style="vertical-align: inherit;">ke fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> juga. Perhatikan bahwa fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk argumen string dengan huruf Rusia mengembalikan nilai dua kali lebih besar dari string yang hanya berisi huruf Latin. Ini terjadi karena fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak menghitung panjang string dalam karakter (dan menggandakannya), tetapi panjang array </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan karena dalam UTF-8 pengkodean huruf Rusia menempati 2 byte, ukuran array </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> setelah konversi dari String python ternyata dua kali lebih panjang. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baik! Kami memecahkan masalah dengan argumen fungsi</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tetapi bagaimana jika kita memiliki lusinan atau ratusan fungsi seperti itu di perpustakaan kami, apakah Anda harus menentukan pengkodean parameter untuk masing-masing fungsi? Seringkali pengkodean yang digunakan dalam suatu program adalah sama, dan tidak ada tujuan untuk fungsi yang berbeda untuk menunjukkan pengkodean yang berbeda. Dalam hal ini, dimungkinkan untuk menentukan pengkodean default di SIP, dan jika untuk beberapa fungsi diperlukan pengkodean lainnya, maka itu dapat didefinisikan ulang menggunakan anotasi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengkodean</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mengatur pengkodean parameter fungsi secara default, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> direktif </font><i><font style="vertical-align: inherit;">% DefaultEncoding digunakan</font></i><font style="vertical-align: inherit;"> . Penggunaannya ditunjukkan dalam contoh yang terletak di folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_03</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memanfaatkan direktif </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultEncoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ubah file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, sekarang isinya adalah sebagai berikut:</font></font><br>
<br>
<pre><code class="plaintext hljs">%Module(name=foo, language="C")<font></font>
%DefaultEncoding "UTF-8"<font></font>
<font></font>
int foo(char*);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang, jika argumennya adalah fungsi dari tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dll. </font><font style="vertical-align: inherit;">Jika </font><font style="vertical-align: inherit;">tidak ada penjelasan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enkode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , maka enkode diambil dari arahan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultEncoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan jika tidak, maka konversi tidak dilakukan, dan untuk semua parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">karakter *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dll. </font><font style="vertical-align: inherit;">perlu untuk mentransfer bukan garis, tetapi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">byte</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contoh dari folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_03</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dikumpulkan dan diverifikasi dengan cara yang sama dengan contoh dari folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_02</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Secara singkat tentang project.py. </font><font style="vertical-align: inherit;">Perakitan otomatis</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sejauh ini, kami telah menggunakan dua file utilitas untuk membuat Python binding - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Sekarang kita akan berkenalan dengan file lain seperti itu, yang seharusnya disebut </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dengan skrip ini, kita dapat memengaruhi proses pembuatan paket kita. Mari kita lakukan otomatisasi pembuatan. Untuk mengumpulkan contoh-contoh </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_01</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_03</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dari bagian sebelumnya, Anda harus terlebih dahulu pergi ke </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> folder </font><font style="vertical-align: inherit;">, kompilasi di sana menggunakan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perintah make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , kembali ke folder tempat file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml berada,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan baru kemudian mulai membangun paket menggunakan salah satu dari perintah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip- *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang tujuan kami adalah untuk memastikan bahwa ketika menjalankan perintah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , perakitan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C-library dimulai terlebih dahulu </font><font style="vertical-align: inherit;">, dan kemudian perintah itu sendiri sudah diluncurkan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contoh yang dibuat di bagian ini terletak di folder </font><font style="vertical-align: inherit;">sumber </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_04</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mengubah proses pembangunan, kita dapat </font><font style="vertical-align: inherit;">mendeklarasikan kelas </font><font style="vertical-align: inherit;">dalam file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (nama file seharusnya hanya itu) yang diturunkan dari kelas </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Project</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Kelas ini memiliki metode yang dapat kita atur sendiri. </font><font style="vertical-align: inherit;">Saat ini kami tertarik dengan metode berikut:</font></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">membangun</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dipanggil selama panggilan ke perintah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Disebut ketika perintah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-sdist dipanggil</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Disebut ketika perintah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dipanggil </font><font style="vertical-align: inherit;">.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instal</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Disebut ketika perintah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-install</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dipanggil </font><font style="vertical-align: inherit;">.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Artinya, kita dapat mendefinisikan kembali perilaku perintah-perintah ini. </font><font style="vertical-align: inherit;">Sebenarnya, metode yang terdaftar dideklarasikan dalam kelas abstrak </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Proyek Ekstrak</font></a><font style="vertical-align: inherit;"> , dari mana kelas turunan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Proyek</font></a><font style="vertical-align: inherit;"> dibuat </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Buat file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan konten berikut:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> subprocess<font></font>
<font></font>
<span class="hljs-keyword">from</span> sipbuild <span class="hljs-keyword">import</span> Project<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FooProject</span>(<span class="hljs-params">Project</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_build_foo</span>(<span class="hljs-params">self</span>):</span>
        cwd = os.path.abspath(<span class="hljs-string">'foo'</span>)<font></font>
        subprocess.run([<span class="hljs-string">'make'</span>], cwd=cwd, capture_output=<span class="hljs-literal">True</span>, check=<span class="hljs-literal">True</span>)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build</span>(<span class="hljs-params">self</span>):</span><font></font>
        self._build_foo()<font></font>
        super().build()<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_sdist</span>(<span class="hljs-params">self, sdist_directory</span>):</span><font></font>
        self._build_foo()<font></font>
        <span class="hljs-keyword">return</span> super().build_sdist(sdist_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_wheel</span>(<span class="hljs-params">self, wheel_directory</span>):</span><font></font>
        self._build_foo()<font></font>
        <span class="hljs-keyword">return</span> super().build_wheel(wheel_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">install</span>(<span class="hljs-params">self</span>):</span><font></font>
        self._build_foo()<font></font>
        super().install()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami mendeklarasikan kelas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FooProject</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang berasal dari kelas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Project,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font><i><font style="vertical-align: inherit;">mendefinisikan </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instal</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> metode di dalamnya </font><font style="vertical-align: inherit;">. Dalam semua metode ini, kita memanggil metode dengan nama yang sama dari kelas dasar, sebelum memanggil metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_build_foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang memulai eksekusi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perintah make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perhatikan bahwa metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> harus mengembalikan nama file yang mereka buat. Ini tidak ditulis dalam dokumentasi, tetapi ditunjukkan dalam sumber SIP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kita tidak perlu menjalankan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perintah make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">secara manual untuk membangun perpustakaan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ini akan dilakukan secara otomatis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda sekarang </font><font style="vertical-align: inherit;">menjalankan perintah </font><i><font style="vertical-align: inherit;">sip-wheel</font></i><font style="vertical-align: inherit;"> di folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_04</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sebuah file dibuat dengan nama pyfoo-0.4-cp38-cp38-manylinux1_x86_64.whl atau serupa tergantung pada sistem operasi dan versi Python Anda. </font><font style="vertical-align: inherit;">
Paket ini dapat diinstal menggunakan perintah:</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="bash hljs">pip install --user --upgrade pyfoo-0.4-cp38-cp38-manylinux1_x86_64.whl
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah itu, Anda dapat memastikan bahwa fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dari modul </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> masih berfungsi.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tambahkan opsi baris perintah untuk membangun</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contoh berikut ada di folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_05</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan paket memiliki nomor versi 0,5 (lihat pengaturan di file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Contoh ini didasarkan pada </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contoh dari dokumentasi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan beberapa koreksi. Dalam contoh ini, kami akan mengulang file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kami </font><font style="vertical-align: inherit;">dan menambahkan opsi baris perintah baru untuk build. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam contoh kami, kami sedang membangun </font><i><font style="vertical-align: inherit;">foo</font></i><font style="vertical-align: inherit;"> perpustakaan yang sangat sederhana</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan dalam proyek nyata, pustaka bisa sangat besar dan kemudian tidak masuk akal untuk memasukkannya dalam kode sumber proyek pengikatan Python. Biarkan saya mengingatkan Anda bahwa SIP pada awalnya dibuat untuk membuat pengikatan untuk perpustakaan besar seperti Qt. Anda dapat, tentu saja, berpendapat bahwa submodul dari git dapat membantu mengatur sumber, tetapi bukan itu intinya. Misalkan perpustakaan mungkin tidak ada di folder dengan sumber yang mengikat. Dalam kasus ini, muncul pertanyaan, di mana kolektor SIP harus mencari header perpustakaan dan file objek? Dalam hal ini, pengguna yang berbeda mungkin memiliki cara sendiri untuk menempatkan perpustakaan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mengatasi masalah ini, kami akan menambahkan dua opsi baris perintah baru ke sistem build, yang dengannya Anda dapat menentukan lintasan ke file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--foo-include-dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) dan ke file objek perpustakaan (parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--foo-library-dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Selain itu, kami akan menganggap bahwa jika parameter ini tidak ditentukan, maka pustaka </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> masih terletak bersama dengan sumber yang mengikat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kita perlu membuat file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lagi </font><font style="vertical-align: inherit;">, dan di dalamnya mendeklarasikan kelas yang berasal dari </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Project</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Mari kita lihat versi baru file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> terlebih dahulu </font><font style="vertical-align: inherit;">, dan kemudian </font><font style="vertical-align: inherit;">lihat </font><font style="vertical-align: inherit;">cara kerjanya.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> os<font></font>
<font></font>
<span class="hljs-keyword">from</span> sipbuild <span class="hljs-keyword">import</span> Option, Project<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FooProject</span>(<span class="hljs-params">Project</span>):</span>
    <span class="hljs-string">"""        
       foo.
    """</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_options</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-string">"""     . """</span><font></font>
<font></font>
        tools = [<span class="hljs-string">'build'</span>, <span class="hljs-string">'install'</span>, <span class="hljs-string">'sdist'</span>, <span class="hljs-string">'wheel'</span>]<font></font>
<font></font>
        <span class="hljs-comment">#   .</span><font></font>
        options = super().get_options()<font></font>
<font></font>
        <span class="hljs-comment">#   </span>
        inc_dir_option = Option(<span class="hljs-string">'foo_include_dir'</span>,<font></font>
                                help=<span class="hljs-string">"the directory containing foo.h"</span>,<font></font>
                                metavar=<span class="hljs-string">"DIR"</span>,<font></font>
                                default=os.path.abspath(<span class="hljs-string">'foo'</span>),<font></font>
                                tools=tools)<font></font>
        options.append(inc_dir_option)<font></font>
<font></font>
        lib_dir_option = Option(<span class="hljs-string">'foo_library_dir'</span>,<font></font>
                                help=<span class="hljs-string">"the directory containing the foo library"</span>,<font></font>
                                metavar=<span class="hljs-string">"DIR"</span>,<font></font>
                                default=os.path.abspath(<span class="hljs-string">'foo/bin'</span>),<font></font>
                                tools=tools)<font></font>
<font></font>
        options.append(lib_dir_option)<font></font>
<font></font>
        <span class="hljs-keyword">return</span> options<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply_user_defaults</span>(<span class="hljs-params">self, tool</span>):</span>
        <span class="hljs-string">"""    . """</span><font></font>
<font></font>
        <span class="hljs-comment">#     </span><font></font>
        super().apply_user_defaults(tool)<font></font>
<font></font>
        <span class="hljs-comment">#  ,         </span><font></font>
        self.foo_include_dir = os.path.abspath(self.foo_include_dir)<font></font>
        self.foo_library_dir = os.path.abspath(self.foo_library_dir)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, tool</span>):</span>
        <span class="hljs-string">"""   . """</span><font></font>
<font></font>
        <span class="hljs-comment">#   pyfoo</span>
        <span class="hljs-comment"># (  pyproject.toml  [tool.sip.bindings.pyfoo])</span>
        foo_bindings = self.bindings[<span class="hljs-string">'pyfoo'</span>]<font></font>
<font></font>
        <span class="hljs-comment">#   include_dirs  </span>
        <span class="hljs-keyword">if</span> self.foo_include_dir <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<font></font>
            foo_bindings.include_dirs = [self.foo_include_dir]<font></font>
<font></font>
        <span class="hljs-comment">#   library_dirs  </span>
        <span class="hljs-keyword">if</span> self.foo_library_dir <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<font></font>
            foo_bindings.library_dirs = [self.foo_library_dir]<font></font>
<font></font>
        super().update(tool)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami kembali membuat kelas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FooProject</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , berasal dari </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Project</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dalam contoh ini, perakitan otomatis perpustakaan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dinonaktifkan </font><font style="vertical-align: inherit;">, karena sekarang diasumsikan bahwa ia dapat berada di tempat lain, dan pada saat pengikatan dibuat, file header dan objek harus siap. </font><font style="vertical-align: inherit;">Tiga metode yang didefinisikan ulang </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
di </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FooProject</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kelas </font><font style="vertical-align: inherit;">: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pembaruan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Pertimbangkan mereka dengan lebih cermat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita mulai dengan metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Metode ini harus mengembalikan daftar instance dari kelas </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Option</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Setiap item daftar adalah opsi baris perintah. Di dalam metode overridden, kita mendapatkan daftar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opsi</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> default (variabel </font><i><font style="vertical-align: inherit;">opsi</font></i><font style="vertical-align: inherit;"> ) dengan memanggil metode kelas dasar dari nama yang sama, kemudian membuat dua opsi baru ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--foo_library_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) dan menambahkannya ke daftar, dan kemudian mengembalikan daftar ini dari fungsi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Konstruktor dari kelas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opsi</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menerima satu parameter yang diperlukan (nama opsi) dan sejumlah besar yang opsional yang menggambarkan jenis nilai untuk parameter ini, nilai default, deskripsi parameter, dan beberapa lainnya. Contoh ini menggunakan opsi berikut untuk konstruktor </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opsi</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><i>help</i>   ,   ,     <i>sip-wheel -h</i></li>
<li><i>metavar</i> â€”  ,    ,       .     <i>metavar</i>  Â«DIRÂ»,   ,     â€” .</li>
<li><i>default</i> â€”     .    ,          ,   <i>foo</i>   ,      (    ).</li>
<li><i>tools</i> â€”  ,        .        <i>sip-build</i>, <i>sip-install</i>, <i>sip-sdist</i>  <i>sip-wheel</i>,  tools = ['build', 'install', 'sdist', 'wheel'].</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kelebihan beban berikut </font><font style="vertical-align: inherit;">dirancang untuk menetapkan nilai parameter yang dapat dilewati pengguna melalui baris perintah. Metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dari kelas dasar membuat </font><font style="vertical-align: inherit;">variabel (anggota kelas) </font><font style="vertical-align: inherit;">untuk setiap parameter baris perintah yang dibuat dalam metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , jadi penting untuk memanggil metode kelas dasar dari nama yang sama sebelum menggunakan variabel yang dibuat sehingga semua variabel yang dibuat menggunakan parameter baris perintah dibuat dan diinisialisasi dengan nilai default . Setelah itu, dalam contoh kita, variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font><i><font style="vertical-align: inherit;">self.foo_library_dir</font></i><font style="vertical-align: inherit;"> akan dibuat</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Jika pengguna belum menentukan parameter baris perintah yang sesuai, maka mereka akan mengambil nilai default sesuai dengan parameter konstruktor dari kelas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opsi</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">default</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Jika parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">default</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak disetel, maka tergantung pada jenis nilai parameter yang diharapkan, itu akan diinisialisasi baik Tidak ada, atau daftar kosong, atau 0. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di dalam metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><i><font style="vertical-align: inherit;">kami</font></i><font style="vertical-align: inherit;"> memastikan bahwa path dalam variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_library_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> selalu absolut. Ini diperlukan agar tidak tergantung pada apa folder yang akan bekerja pada saat perakitan dimulai. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Metode kelebihan beban terakhir di kelas ini adalah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pembaruan.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Metode ini dipanggil ketika perlu untuk menerapkan perubahan yang dibuat sebelum proyek ke proyek ini. Misalnya, ubah atau tambahkan parameter yang ditentukan dalam file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dalam contoh sebelumnya, kami menetapkan path ke file header dan objek menggunakan parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">include-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">library-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">masing-masing, di dalam bagian </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[tool.sip.bindings.pyfoo]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Sekarang kita akan mengatur parameter ini dari skrip </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , jadi pada file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kita akan </font><font style="vertical-align: inherit;">menghapus parameter ini:</font></font><br>
<br>
<pre><code class="plaintext hljs">[build-system]<font></font>
requires = ["sip &gt;=5, &lt;6"]<font></font>
build-backend = "sipbuild.api"<font></font>
<font></font>
[tool.sip.metadata]<font></font>
name = "pyfoo"<font></font>
version = "0.3"<font></font>
license = "MIT"<font></font>
<font></font>
[tool.sip.bindings.pyfoo]<font></font>
headers = ["foo.h"]<font></font>
libraries = ["foo"]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memperbarui</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kita dari kamus </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.bindings</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mengetik </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gat misalnya </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Bindings</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Nama kuncinya sesuai dengan [tool.sip.bindings. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ] dari file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan instance kelas yang diperoleh menjelaskan pengaturan yang dijelaskan dalam bagian ini. Kemudian, anggota kelas ini </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">include_dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">library_dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (nama-nama anggota sesuai dengan parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">include-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">library-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan tanda hubung diganti dengan garis bawah) ditugaskan daftar berisi jalur yang disimpan di anggota </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_library_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dalam contoh ini, untuk akurasi, kami memeriksa bahwa nilai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_library_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak sama dengan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tidak ada</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tetapi dalam contoh ini kondisi ini selalu terpenuhi karena parameter baris perintah yang kami buat memiliki nilai default. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan demikian, kami menyiapkan file konfigurasi sehingga selama perakitan itu mungkin untuk menunjukkan path ke file header dan objek. Mari kita periksa apa yang terjadi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama, pastikan bahwa nilai default berfungsi. Untuk melakukan ini, buka folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_05 / foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan bangun pustaka menggunakan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perintah make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , karena kami menonaktifkan pustaka otomatis dalam contoh ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah itu, buka folder</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_05</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan jalankan perintah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Sebagai hasil dari perintah ini, file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo-0.5-cp38-cp38-manylinux1_x86_64.whl</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau dengan nama yang sama </font><font style="vertical-align: inherit;">akan dibuat </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang pindahkan folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo di</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> suatu tempat di luar folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_05</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan jalankan perintah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lagi </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Akibatnya, kami mendapatkan kesalahan yang diharapkan dengan menginformasikan bahwa kami tidak memiliki file perpustakaan objek:</font></font><br>
<br>
<pre><code class="plaintext hljs">usr/bin/ld:   -lfoo<font></font>
collect2: :  ld     1<font></font>
sip-wheel: Unable to compile the 'foo' module: command 'g++' failed with exit status 1<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah itu, jalankan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menggunakan opsi baris perintah baru:</font></font><br>
<br>
<pre><code class="bash hljs">sip-wheel --foo-include-dir <span class="hljs-string">".../foo"</span> --foo-library-dir <span class="hljs-string">".../foo/bin"</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alih-alih elipsis, Anda harus menentukan path ke folder tempat Anda memindahkan folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan pustaka yang dirakit. </font><font style="vertical-align: inherit;">Akibatnya, majelis harus berhasil membuat file .whl. </font><font style="vertical-align: inherit;">Modul yang dibuat dapat diinstal dan diuji dengan cara yang sama seperti pada bagian sebelumnya.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Periksa urutan metode panggilan dari project.py</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contoh berikutnya, yang akan kami pertimbangkan, akan sangat sederhana, itu akan menunjukkan urutan pemanggilan metode kelas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proyek</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang kami muat berlebihan di bagian sebelumnya. Ini dapat berguna untuk memahami kapan variabel dapat diinisialisasi. Contoh ini terletak di folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_06</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di repositori sumber. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inti dari contoh ini adalah </font><font style="vertical-align: inherit;">membebani semua metode yang kami gunakan sebelumnya </font><font style="vertical-align: inherit;">di kelas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FooProject</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang terletak di file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan menambahkan panggilan ke fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cetak</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang akan menampilkan nama metode di mana ia berada:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sipbuild <span class="hljs-keyword">import</span> Project<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FooProject</span>(<span class="hljs-params">Project</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_options</span>(<span class="hljs-params">self</span>):</span>
        print(<span class="hljs-string">'get_options()'</span>)<font></font>
        options = super().get_options()<font></font>
        <span class="hljs-keyword">return</span> options<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply_user_defaults</span>(<span class="hljs-params">self, tool</span>):</span>
        print(<span class="hljs-string">'apply_user_defaults()'</span>)<font></font>
        super().apply_user_defaults(tool)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply_nonuser_defaults</span>(<span class="hljs-params">self, tool</span>):</span>
        print(<span class="hljs-string">'apply_nonuser_defaults()'</span>)<font></font>
        super().apply_nonuser_defaults(tool)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, tool</span>):</span>
        print(<span class="hljs-string">'update()'</span>)<font></font>
        super().update(tool)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build</span>(<span class="hljs-params">self</span>):</span>
        print(<span class="hljs-string">'build()'</span>)<font></font>
        super().build()<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_sdist</span>(<span class="hljs-params">self, sdist_directory</span>):</span>
        print(<span class="hljs-string">'build_sdist()'</span>)
        <span class="hljs-keyword">return</span> super().build_sdist(sdist_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_wheel</span>(<span class="hljs-params">self, wheel_directory</span>):</span>
        print(<span class="hljs-string">'build_wheel()'</span>)
        <span class="hljs-keyword">return</span> super().build_wheel(wheel_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">install</span>(<span class="hljs-params">self</span>):</span>
        print(<span class="hljs-string">'install()'</span>)<font></font>
        super().install()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pembaca yang penuh perhatian harus mencatat bahwa selain metode yang digunakan sebelumnya, metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_nonuser_defaults ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang belum kita bicarakan sebelumnya </font><font style="vertical-align: inherit;">, kelebihan beban dalam contoh ini </font><font style="vertical-align: inherit;">. Metode ini merekomendasikan pengaturan nilai default untuk semua variabel yang tidak dapat diubah melalui parameter baris perintah. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kembalikan jalur eksplisit ke perpustakaan:</font></font><br>
<br>
<pre><code class="plaintext hljs">[build-system]<font></font>
requires = ["sip &gt;=5, &lt;6"]<font></font>
build-backend = "sipbuild.api"<font></font>
<font></font>
[tool.sip.metadata]<font></font>
name = "pyfoo"<font></font>
version = "0.4"<font></font>
license = "MIT"<font></font>
<font></font>
[tool.sip.bindings.pyfoo]<font></font>
headers = ["foo.h"]<font></font>
libraries = ["foo"]<font></font>
include-dirs = ["foo"]<font></font>
library-dirs = ["foo/bin"]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agar proyek berhasil </font><font style="vertical-align: inherit;">dibangun </font><font style="vertical-align: inherit;">, Anda harus masuk ke folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan membangun perpustakaan di sana menggunakan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perintah make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Setelah itu, kembali ke folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_06</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan jalankan, misalnya, perintah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Akibatnya, jika Anda membuang peringatan kompiler, teks berikut akan ditampilkan: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_nonuser_defaults () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_opefe () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pembaruan ()</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
binding ini akan dibuat: pyfoo. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel ()</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Menghasilkan binding pyfoo ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mengkompilasi modul 'foo' ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Roda telah dibuat.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Garis tebal ditampilkan yang merupakan output dari file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kami </font><font style="vertical-align: inherit;">. Jadi, kita melihat bahwa metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dipanggil beberapa kali, dan ini harus diperhitungkan jika Anda akan menginisialisasi variabel anggota apa pun di kelas yang berasal dari </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Project</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bukan tempat terbaik untuk ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Juga berguna untuk mengingat bahwa metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_nonuser_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dipanggil sebelum metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yaitu dalam metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sudah dimungkinkan untuk menggunakan variabel yang nilainya diatur dalam metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_nonuser_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah itu, metode </font><i><font style="vertical-align: inherit;">pembaruan</font></i><font style="vertical-align: inherit;"> dipanggil</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan pada akhirnya, metode yang bertanggung jawab langsung untuk perakitan, dalam kasus kami, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kesimpulan ke bagian pertama</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada artikel ini, kami mulai mempelajari alat SIP yang dirancang untuk membuat binding Python untuk perpustakaan yang ditulis dalam C atau C ++. Pada bagian pertama artikel ini, kami memeriksa dasar-dasar menggunakan SIP menggunakan contoh membuat pengikatan Python untuk pustaka yang sangat sederhana yang ditulis dalam C. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami menemukan file yang Anda perlu buat untuk bekerja dengan SIP. File </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> berisi informasi tentang paket (nama, nomor versi, lisensi, dan jalur ke file header dan objek). Menggunakan file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">Anda bisa memengaruhi proses pembuatan paket Python, misalnya, mulai membangun C-library atau membiarkan pengguna menentukan lokasi header dan file objek perpustakaan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* .sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menjelaskan antarmuka modul Python yang mencantumkan fungsi dan kelas yang akan dimuat dalam modul. </font><font style="vertical-align: inherit;">Arahan dan anotasi digunakan </font><font style="vertical-align: inherit;">untuk menggambarkan antarmuka dalam file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* .sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada bagian kedua artikel ini, kita akan membuat pengikatan atas pustaka berorientasi objek yang ditulis dalam C ++, dan dengan contohnya kita akan mempelajari teknik yang akan berguna dalam menggambarkan antarmuka kelas C ++, dan pada saat yang sama kita akan membahas arahan dan anotasi baru untuk kita. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bersambung.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Referensi</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh untuk artikel ini</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beranda SIP</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokumentasi untuk SIP</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id495468/index.html">Algoritma pengenalan tag harga yang bekerja bahkan pada terminal pengumpulan data</a></li>
<li><a href="../id495472/index.html">Beralih ke vegetarian tidak akan mencegah orang terinfeksi dari penyakit seperti COVID-19</a></li>
<li><a href="../id495474/index.html">DataGrip 2020.1: Luncurkan konfigurasi, ekspor ke Excel, hasil dalam editor dan banyak lagi</a></li>
<li><a href="../id495476/index.html">Mengapa kesuksesan Atari DeepMind AI mengecewakan?</a></li>
<li><a href="../id495478/index.html">Penguji data besar dan kecil: tren, teori, kisah saya</a></li>
<li><a href="../id495484/index.html">Bagaimana Unix pipeline diimplementasikan</a></li>
<li><a href="../id495486/index.html">Ancaman Baru terhadap Data Rahasia: Hasil Survei Acronis Global</a></li>
<li><a href="../id495490/index.html">Bagian Pengujian dan QA pada konferensi DUMP 2020. Apa yang diharapkan tahun ini? Spoiler: sepasang penghilang rasa sakit dan ceri</a></li>
<li><a href="../id495492/index.html">Fitur Rilis Game Unreal Engine 4 iOS</a></li>
<li><a href="../id495494/index.html">Membuat penjadwal-kubus tambahan dengan seperangkat aturan perencanaan khusus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>