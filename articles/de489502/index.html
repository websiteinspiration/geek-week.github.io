<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👣 👎 👩🏿‍🤝‍👩🏻 Selen + AutoIT. Windows Test Automation Windows 🌋 ✊ 🚶🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mein Name ist Ivan Sidorenko, ich bin Testingenieur bei Digital Design. 
 
 Meine Aufgabe war es, Autotests für eines unserer Projekte mit dem Seleniu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Selen + AutoIT. Windows Test Automation Windows</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/digdes/blog/489502/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mein Name ist Ivan Sidorenko, ich bin Testingenieur bei Digital Design. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meine Aufgabe war es, Autotests für eines unserer Projekte mit dem Selenium WebDriver-Tool in Java zu entwickeln. Weitere </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informationen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hierzu finden Sie in meinem letzten </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Artikel. </font></a></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist ein Tool zur Automatisierung von Webanwendungen in verschiedenen Browsern. Während der Entwicklung von Autotests bin ich auf ein Szenario gestoßen, in dem Sie mit dem Windows-Fenster interagieren müssen, um Dateien herunterzuladen. Leider kann Selenium nicht mit Windows-Fenstern arbeiten, sodass eine alternative Lösung gefunden werden musste.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/cd/zl/d4/cdzld4whe4et6m2j_xhh47dl-6g.png"></div><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Während der Suche fiel die Wahl auf </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AutoIT</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dieses Tool dient zur Automatisierung von Aufgaben in Microsoft Windows, die erforderlich waren. In diesem Artikel werde ich die Arbeit mit AutoIT beschreiben, um eine Aufgabe zu lösen. Es wird davon ausgegangen, dass Sie bereits eine Entwicklungsumgebung mit Selenium WebDriver verbunden haben. Beispielsweise wird ein Fenster zum Hochladen von Fotos auf eine der Fotobearbeitungsseiten verwendet. Also lasst uns anfangen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Laden Sie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> AutoIT </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">herunter</font></a><font style="vertical-align: inherit;"> und installieren Sie es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Gehen Sie zu einem der Dienste, um beispielsweise Fotos herunterzuladen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hier müssen Sie auf die Schaltfläche "Fotos herunterladen" klicken, um ein solches Windows-Fenster zu erhalten. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8d/td/ff/8dtdff77nmvci12qingkdozlmuq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. Gehen Sie nun zum AutoIT3-Ordner und wählen Sie Au3Info.exe</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xw/zt/a8/xwzta8im-wldwys3d4kukksyfx4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4. Au3Info ist ein Tool, mit dem Sie Informationen über das für die Automatisierung erforderliche Fenster abrufen können. Um Informationen zu einem bestimmten Element zu erhalten, ziehen Sie einfach aus dem Finder-Tool-Block auf das Fensterelement. Wir erhalten die Werte der Eingabefeldattribute des Elements "Dateiname". </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9p/rr/yl/9prryludo95c5_qeehpmqehltac.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für die Verwendung im AutoIT-Skript benötigen wir die Attribute Title = 'Open' und Class = 'Edit'. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5. Gehen Sie zum Ordner AutoIt3 \ SciTE und wählen Sie SciTE aus. Hier schreiben wir ein so einfaches Skript. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ce/a_/e-/cea_e-yqn5uroh9gfadffplsnxe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ControlFocus</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> eine Methode , der den Fokus auf das Fensterelement "Dateiname" legt </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Der erste Parameter ist der Titelwert des gewünschten Fensters, in unserem Fall "Öffnen" </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Der zweite Parameter ist optional</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Der dritte Parameter ist die Kombination der Werte des Attributs Klasse und Instanz, d.h. </font><font style="vertical-align: inherit;">es stellt sich heraus, Edit1 </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hp/db/bn/hpdbbnufdzq_j0h9w2uhsyuc3xq.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ControlSetText</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - eine Methode, mit der der Text in die Eingabe des Elements "Dateiname" eingegeben wird</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der erste Parameter ist der Wert von Title</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der zweite Parameter ist optional</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der dritte Parameter ist die Kombination der Werte des Klassen- und Instanzattributs, d.h. </font><font style="vertical-align: inherit;">es stellt sich heraus, Edit1</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der vierte Parameter ist der Text, der in die Eingabe eingegeben wird. Hier schreiben wir den Pfad zu der Datei, die wir anhängen werden</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ControlClick</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - klickt auf die Schaltfläche "Öffnen"</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der erste Parameter ist der Wert von Title</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der zweite Parameter ist optional</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der dritte Parameter ist die Kombination der Werte des Klassen- und Instanzattributs, d.h. </font><font style="vertical-align: inherit;">es dreht Button1</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/mh/ky/n9/mhkyn9hzowkdemfo0-mxtayc-qu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6. Speichern Sie das Skript als Autoit </font></font><br>
<br>
<img src="https://habrastorage.org/webt/be/k-/yf/bek-yfclqoutktdksfwsmbn66bq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7. </font><font style="vertical-align: inherit;">Um das Skript auszuführen </font><font style="vertical-align: inherit;">, müssen Sie es jetzt kompilieren. Zum Kompilieren eines Skripts gibt es zwei Optionen - entweder für ein 64-Bit-System oder für 86. Wählen Sie die für Ihr Betriebssystem geeignete aus. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nk/ce/7z/nkce7zytnqeugrvb2zdd4-wcceq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8. Wir haben eine kompilierte AutoItScript.exe-Datei erhalten. Wir überprüfen ihre Leistung. Gehen Sie zum </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fotobearbeitungsdienst</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &lt; </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">www.iloveimg.com/de/photo-editor</font></a><font style="vertical-align: inherit;"> "&gt; und klicken Sie auf" Bild </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">auswählen</font></a><font style="vertical-align: inherit;"> ". Führen Sie </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ea/nw/ef/eanwefram2fb9xsmiqrlmfrjl94.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
nun </font><font style="vertical-align: inherit;">AutoItScript.exe aus. </font><font style="vertical-align: inherit;">9. Jetzt können Sie dieses Skript hinzufügen In Selen, zum Beispiel für Java, würde eine solche Ergänzung folgendermaßen aussehen:</font></font><br>
<br>
<pre><code class="plaintext hljs">Runtime.getRuntime().exec(":\\auto\\AutoItScript.exe");</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Lösung ist sehr stabil. </font><font style="vertical-align: inherit;">Aufgrund der Tatsache, dass wir am Ende eine ausführbare Datei haben, kann diese Lösung auch mit verschiedenen Programmiersprachen verwendet werden. </font><font style="vertical-align: inherit;">Der Nachteil ist, dass ein solches Skript nicht im Headless-Modus verwendet werden kann - einem Modus, in dem der Browser nicht gestartet wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich hoffe, dieser Artikel hilft Ihnen beim Testen der Automatisierung!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de489490/index.html">Tic Tac Toe (PixiJS)</a></li>
<li><a href="../de489492/index.html">Yandex.Disk hat die Verwendung des Open-Source-Dienstprogramms rclone verboten. UPD - funktioniert wieder</a></li>
<li><a href="../de489494/index.html">Beliebteste Datenstrukturen</a></li>
<li><a href="../de489496/index.html">Suche nach Mitarbeitern und Jobsuche: meine Sicht von innen und außen</a></li>
<li><a href="../de489500/index.html">Aufgaben an Story-Punkten bewerten</a></li>
<li><a href="../de489504/index.html">So erstellen Sie eine Karte in UE4</a></li>
<li><a href="../de489510/index.html">Der Versuch, das Problem der Auswahl von Tickets vor Urlaub Nr. 2 zu lösen</a></li>
<li><a href="../de489512/index.html">Flattern. BlOC, Provider, Async - Shelf Architecture</a></li>
<li><a href="../de489514/index.html">Laden Sie kostenlos Dateien jeder Größe auf Google Drive herunter und speichern Sie sie. Fehler oder Funktion?</a></li>
<li><a href="../de489516/index.html">Freunde reagieren auf Native und Fastlane</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>