<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍🔬 🧑🏼‍🤝‍🧑🏻 🧑🏼‍🤝‍🧑🏼 Uninterruptible APC Smart UPS, and how to cook them 👝 🧛🏽 👩🏿‍🤝‍👨🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Among the variety of UPSs, APC Smart UPS (now Schneider Electric) are considered the most common in the entry-level server. Excellent reliability and ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Uninterruptible APC Smart UPS, and how to cook them</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/487802/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Among the variety of UPSs, APC Smart UPS (now Schneider Electric) are considered the most common in the entry-level server. </font><font style="vertical-align: inherit;">Excellent reliability and low price in the secondary market, contribute to the fact that system administrators, without any hesitation, populate the racks with UPS data and try to extract maximum profit from the glands of 10-15 years ago by trivial battery replacement. </font><font style="vertical-align: inherit;">Unfortunately, this does not always give the expected result. </font><font style="vertical-align: inherit;">Let's try to figure out what to do and how to make your UPS work “like new”.</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Battery Choice</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All articles and topics on the forums about choosing a battery for UPS most often resemble topics on choosing motor oil for cars / bikes. </font><font style="vertical-align: inherit;">Let's try not to be like them, but to understand the basic principles of choosing batteries using the CSB manufacturer as an example. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We see them with a bunch of different lines of batteries: GP, GPL, HR, HRL, UPS, TPL. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We start reading: GP, GPL - batteries of universal application </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for small and medium discharge currents</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Recommended for use in security and fire systems and UPS. </font><font style="vertical-align: inherit;">They don’t suit us. </font><font style="vertical-align: inherit;">Although it’s just that they are most often bought, without bothering to study their characteristics.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wo/2h/fw/wo2hfwblbz8j44irqqviwnzxdxe.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HR series - batteries of increased energy intensity and allowing deep discharge (up to 11% of residual capacity), are especially useful when large discharge currents are required. The difference between “H” batteries is the special design of the grill, which makes it possible to increase the output power by 20%. They are most suitable for use in powerful power plants and UPSs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The letter “L” in the series indicates that these are Long Life batteries in buffer operation up to 10 years. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Well, the UPS series is a specially designed battery for operation in high current mode with a short discharge time.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For myself, I chose between UPS and HRL for a long time, but decided to take HRL. </font><font style="vertical-align: inherit;">Unfortunately, it will be possible to talk about how they will behave in long-term work in 5 years, and necroposterism seems to be not very welcome. </font><font style="vertical-align: inherit;">Therefore, we assume that this is my personal choice and I am not going to impose it. </font><font style="vertical-align: inherit;">But you must understand that you need to choose high-current batteries, as they must be able to give all the accumulated capacity within 20-30 minutes.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Battery Assembly Selection</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Given that several batteries are used in the assembly, it is highly desirable that they have the same characteristics. </font><font style="vertical-align: inherit;">For one low-quality battery will lead to the fact that the entire assembly will work completely not as expected. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
About 5 years ago, I discovered the Bastion Rostov company producing battery capacity testers under the Skat trademark. </font><font style="vertical-align: inherit;">I can’t pretend to say about the ideal accuracy of capacity measurements, but to assess the level: ideal-living-still-serve-corpse, this tester is more than enough.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hk/rb/e5/hkrbe5qjtpkrj09sgovoioe6ga8.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In principle, you can measure the capacity with a banal charge-discharge using a clock, a 21W car lamp (it gives a load of about 1A) and a tester, but this is long and often lazy. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Well, in extreme cases - we just try to put fresh batteries from one batch and hope that you are lucky.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Electrics is the science of contacts.</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One bad contact in an assembly of 4 batteries will negate all your efforts, so we disassemble the assembly very carefully. </font><font style="vertical-align: inherit;">Typically, UPSs use battery connectors with latches that simply pull out just as easily put in a dead state. </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Therefore, we take a small flat-blade screwdriver, insert it into the connector as in the photo, and carefully remove it without applying much effort. </font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As a colleague suggested in a comment, you just need to pull on the plastic casing, not on the wire. </font><font style="vertical-align: inherit;">The connector is removed with a slight click.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/vu/ed/is/vuedislwdifmpnyrqckp8afub28.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Well, about the correct connection of the wires, I think, writing is unnecessary. </font><font style="vertical-align: inherit;">If you climbed inside the UPS, then obviously you know the principle of serial connection of the battery. </font><font style="vertical-align: inherit;">And for the rest: a piece of paper or a smartphone with a camera. </font><font style="vertical-align: inherit;">At the end of the assembly, just in case, we measure the voltage on the assembly with a tester and compare it with that which should be based on the number of batteries.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“I did everything as it is written, but it did not help”</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Well, now the fun begins. UPS, in the course of its work, periodically (usually every 7 or 14 days, depending on the setting) performs a short battery calibration. It switches to battery mode and measures the voltage immediately and after a short time. The result of this is a certain correction factor "battery life", which he puts himself in the register. During the gradual death of the battery, the state of this register gradually decreases. Based on this, UPS calculates the remaining battery life. And then, at one fine moment, realizing that everything is bad, UPS lights up an indicator demanding to replace the battery. But when we make a replacement, UPS does not know about it! The state of the battery’s liveness register remains the same. We need to fix it.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are two ways. The first way, simple and quick - you need to do a full UPS calibration. To do this, load it by more than 35% and start calibration, for example, from the PowerChute program. This works in about half the cases. Why not always - a mystery covered in darkness. Therefore, we will go along a long but more reliable path. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will need: a computer with a COM port, a proprietary cable (for example, 940-0024, UpsDiag 2.0 program (for the safety of your UPS, a colleague recommends using apcfix in free mode better. I can’t say anything about this except that I strongly recommend not pressing UpsDiag something other than editing 0 register, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">especially the button for automatically correcting battery errors</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) and a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">table of calibration values</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">We are interested in the value of register 0. The table shows the value for ideal, spherical batteries in vacuum. </font><font style="vertical-align: inherit;">Any real batteries will give a smaller value after calibration, but not by much.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ei/js/pg/eijspg_1k9t1no9rhzvqtp50q4w.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, take a real UPS SUA1500RMI2U. </font><font style="vertical-align: inherit;">At the time of replacing the battery, UpsDiag showed the value of the register 0 - 42. That is, the battery is dead. </font><font style="vertical-align: inherit;">The calibration value from the table is A1. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We begin to edit. </font><font style="vertical-align: inherit;">First of all, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remove the network card from UPS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Having a network card will not give you the opportunity to edit the register. </font><font style="vertical-align: inherit;">Why - a question for APC engineers. </font><font style="vertical-align: inherit;">Fortunately, you can pull it off hot without shutting down the UPS.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We connect the cable, start UpsDiag, go to the “Calibration” tab and look at the status of register 0. We write to a piece of paper, right-click on it - Change. Raise it to the value from the table of calibration values ​​- A1. If the table does not have your UPS, then in principle it can be raised to FF. There is nothing wrong with this, except for the dumb UPS, which will show that it is ready to hold the load until the second advent. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then we need to wait until the battery is charged to 100%, load the UPS to 35% or slightly higher and start the calibration. At the end of the calibration, again look at the value in 0 register and compare it with the one written on a piece of paper. In the SUA1500RMI2U described above with new HRL1234W batteries, the value is - 98, which, in principle, is not very far from calibration A1.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After all, let us charge up to 100% again, pull off the COM cable, stick the network card back in and wish UPS a long and happy life for the benefit of our server rack. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By the way, network cards such as AP9619 in the secondary market also fell in price to indecent values. </font><font style="vertical-align: inherit;">But how to cook them (password reset, firmware update, setup) is the topic of a separate article.</font></font></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en487792/index.html">Raising Mercurial on a Windows server (with Nginx)</a></li>
<li><a href="../en487794/index.html">Rating of high-speed web frameworks 2020</a></li>
<li><a href="../en487796/index.html">Top 10 Essential Eclipse Plugins for Java Developers</a></li>
<li><a href="../en487798/index.html">How we migrated from Oracle JDK and Java Web Start to AdoptOpenJDK and OpenWebStart</a></li>
<li><a href="../en487800/index.html">Why is it important to tell the applicant what went wrong during the interview (and how to do it right)</a></li>
<li><a href="../en487804/index.html">Growth Teams Meetup at Raiffeisenbank</a></li>
<li><a href="../en487806/index.html">Creating a small Deno API</a></li>
<li><a href="../en487808/index.html">Recurrent Neural Networks (RNN) with Keras</a></li>
<li><a href="../en487812/index.html">Testing Polish LED Spectrum Led E27</a></li>
<li><a href="../en487814/index.html">Speed ​​and reliability are higher, and the price is lower. New Kingston KC2000 Solid State Drives</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>