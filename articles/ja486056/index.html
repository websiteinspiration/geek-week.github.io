<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤸 😅 👨🏿‍🚒 スクリプトから独自のプラットフォームへ：Cyan Instituteで開発を自動化した方法 🤶 👨🏼‍🏫 🎑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="RIT 2019で、同僚のAlexander KorotkovがCIAN での開発の自動化に関するレポートを作成しました。生活と仕事を簡素化するために、私たちは独自のIntegroプラットフォームを使用しています。タスクのライフサイクルを監視し、開発者から日常の操作を取り除き、本番環境のバグの数を大...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>スクリプトから独自のプラットフォームへ：Cyan Instituteで開発を自動化した方法</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/cian/blog/486056/"><img src="https://habrastorage.org/webt/di/vp/_w/divp_woyk4ubltspau3m_ogodkg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RIT 2019で、同僚のAlexander KorotkovがCIAN </font><font style="vertical-align: inherit;">での開発の自動化</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に関するレポートを作成し</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ました。生活と仕事を簡素化するために、私たちは独自のIntegroプラットフォームを使用しています。</font><font style="vertical-align: inherit;">タスクのライフサイクルを監視し、開発者から日常の操作を取り除き、本番環境のバグの数を大幅に減らします。</font><font style="vertical-align: inherit;">この投稿では、Alexanderのレポートを補足し、簡単なスクリプトから独自のプラットフォームを介してオープンソース製品を組み合わせるまでの経緯と、別の自動化チームの役割について説明します。</font></font><br>
&nbsp;<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レベル0</font></font></h2><br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「ゼロレベルはありません。そんなことは知りません」</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
カンフーパンダのシーフマスターm / f</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Cyan Instituteでの自動化は、会社の設立から14年後に始まりました。その後、開発チームには35人が参加しました。信じがたいですよね？もちろん、自動化は何らかの形で存在していましたが、継続的な統合とコード配信の別の領域が2015年に形成され始めました。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当時、私たちはPython、C＃、PHPの巨大なモノリスをLinux / Windowsサーバーにデプロイしていました。このモンスターを配置するために、手動で実行する一連のスクリプトを用意しました。また、モノリスアセンブリもあり、ブランチのマージ、不具合の編集、および「ビルド内の異なるタスクセットを使用して」再ビルドする際の競合により、苦痛が生じました。簡略化されたプロセスは次のようになります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bz/tn/ll/bztnllnatyoaiauwlw0xvvaatde.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは私たちには適さなかったため、再現性があり、自動化され、制御されたビルドおよび展開プロセスを構築したいと考えました。</font><font style="vertical-align: inherit;">これを行うには、CI / CDシステムが必要でした。Teamcityの無料バージョンと無料のJenkinsのどちらかを選択しました。それらを使用して、どちらも一連の機能に適しているからです。</font><font style="vertical-align: inherit;">Teamcityを最近の製品として選択しました。</font><font style="vertical-align: inherit;">次に、マイクロサービスアーキテクチャを使用せず、多数のタスクとプロジェクトに頼りませんでした。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちは私たち自身のシステムのアイデアを思いつきます</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Teamcityの実装では、手作業の一部のみが削除されました。それでも、プルリクエストの作成、Jiraでのステータスによるタスクの昇格、リリースするタスクの選択がありました。 Teamcityはこれに対処できなくなりました。さらに自動化する方法を選択する必要がありました。 Teamcityでスクリプトを操作したり、サードパーティの自動化システムに切り替えたりするためのオプションを検討しました。しかし結局、彼らは自分たちのソリューションだけが提供する最大の柔軟性が必要だと判断しました。そこで、Integroと呼ばれる内部自動化システムの最初のバージョンが登場しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Teamcityは、ビルドおよびデプロイメントプロセスのスタートアップレベルでの自動化に従事しており、Integroは、開発プロセスのトップレベルの自動化に焦点を当てています。作業をJiraのタスクと組み合わせ、関連するソースコードをBitbucketで処理する必要がありました。この段階で、Integroはさまざまなタイプのタスクを処理するための独自のワークフローを持ち始めました。&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ビジネスプロセスの自動化の増加により、Teamcityでのプロジェクトと実行の数は増加しています。新しい問題が発生しました。1つの無料のTeamcityインスタンス（3つのエージェントと100のプロジェクト）が見つからず、別のインスタンス（3つのエージェントと100のプロジェクト）を追加し、次に別のインスタンスを追加しました。その結果、いくつかのクラスターのシステムができましたが、管理が困難でした。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hb/gv/rp/hbgvrp2ms-wfixyw-v0wycqjphy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4番目のインスタンスの質問が出てきたとき、4つのインスタンスをサポートするための総コストがどのフレームワークにも適合しなくなったため、私たちはもはやそのように生きることができないことに気付きました。有料のTeamcityを購入するか、無料のJenkinsを選択するかという質問がありました。インスタンスの計算と自動化の計画を実行し、ジェンキンスに住むことにしました。数週間後、Jenkinsに切り替えて、複数のTeamcityインスタンスのサポートに関連する頭痛の種を取り除きました。したがって、インテグロの開発とジェンキンスの完成に集中することができました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
基本的な自動化（プルリクエストの自動作成、コードカバレッジの収集と公開、その他のチェックの形で）の成長に伴い、手動によるリリースをできる限り拒否し、この作業をロボットに与えることが強く望まれていました。</font><font style="vertical-align: inherit;">さらに、同社は頻繁なリリースを必要とするマイクロサービスへの移行を開始しました。</font><font style="vertical-align: inherit;">そこで、マイクロサービスの自動リリースに徐々に移行しました（現時点では、プロセスが複雑なため、モノリスを手動でリリースしています）。</font><font style="vertical-align: inherit;">しかし、通常発生するように、新しい複雑さが生じています。&nbsp;</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テストの自動化</font></font></h2><br>
<img src="https://habrastorage.org/webt/kk/rc/v8/kkrcv8melsazessicjkebzle2s4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リリースの自動化により、一部のテスト段階が省略されたこともあり、開発プロセスが加速しています。そして、これは一時的に品質の低下につながりました。いい加減に聞こえますが、リリースの加速に伴い、製品開発の方法論を変更する必要がありました。リリースされたコードとその中のバグに対する開発者の個人的な責任（ここでは金銭的な罰金ではなく「頭の中でのアイデアの受け入れ」について話している）と、自動展開を通じてタスクを発行する/発行しないという決定について、テストの自動化について考える必要がありました。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
品質の問題を排除するために、2つの重要な決定を下しました。カナリアテストの実施を開始し、エラーのバックグラウンドの自動監視を導入し、超過に自動応答しました。</font><font style="vertical-align: inherit;">最初のソリューションは、コードが完全に本稼働する前に明らかなエラーを見つけることを可能にし、2番目のソリューションは、本番環境の問題に対する応答時間を短縮しました。</font><font style="vertical-align: inherit;">もちろん、間違いは起こりますが、私たちはほとんどの時間とエネルギーを修正ではなく最小化に費やしています。&nbsp;</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自動化チーム</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現在、130人の開発者を擁し、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成長</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を続け</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ています</font></a><font style="vertical-align: inherit;">。継続的インテグレーションとコード配信のためのチーム（以下、デプロイとインテグレーションまたはDIチームと呼びます）は7人で構成され、自動化プラットフォームIntegroとDevOpsの開発という2つの方向で作業します。&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DevOpsは、CIAN WebサイトのDev / Beta環境であるIntegro環境を担当し、開発者が問題を解決し、環境をスケーリングするための新しいアプローチを開発するのに役立ちます。 Integroの事業部門は、Jenkins、Jira、Confluenceのプラグインなど、Integro自体と関連サービスの両方を扱っており、開発チーム用の補助ユーティリティとアプリケーションも開発しています。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DIチームはプラットフォームチームと連携し、プラットフォームチームは社内でアーキテクチャ、ライブラリ、および開発アプローチを開発します。</font><font style="vertical-align: inherit;">同時に、CIAN内のすべての開発者は、自動化に貢献できます。たとえば、チームのニーズに合わせてマイクロ自動化を行ったり、自動化をさらに向上させるためのクールなアイデアを共有したりできます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シアンのパフパイオートメーション</font></font></h2><br>
<img src="https://habrastorage.org/webt/v8/xt/rz/v8xtrzfhj8bp-kzio9qduuixgf4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自動化に関わるすべてのシステムは、いくつかの層に分けることができます。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外部システム（Jira、Bitbucketなど）。</font><font style="vertical-align: inherit;">開発チームは彼らと協力します。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プラットフォームインテグロ。</font><font style="vertical-align: inherit;">ほとんどの場合、開発者はそれを直接使用しませんが、すべての自動化の作業をサポートするのは彼女です。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配信、オーケストレーション、ディスカバリーサービス（Jeknins、Consul、Nomadなど）。</font><font style="vertical-align: inherit;">彼らの助けを借りて、サーバーにコードを展開し、サービスが互いに連携するようにします。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">物理層（サーバー、OS、関連ソフトウェア）。</font><font style="vertical-align: inherit;">このレベルでは、コードは機能します。</font><font style="vertical-align: inherit;">物理サーバーまたは仮想サーバー（LXC、KVM、Docker）のいずれかです。</font></font><br>
</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このコンセプトに基づいて、DIチーム内で責任の領域を分割します。</font><font style="vertical-align: inherit;">最初の2つのレベルは、Integro開発領域の責任の領域にあり、最後の2つのレベルは、DevOpsの責任の領域にすでにあります。</font><font style="vertical-align: inherit;">この分離により、タスクに集中することができ、相互作用を妨げることはありません。私たちは互いに隣り合っており、常に知識と経験を交換しているからです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インテグロ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Integroに焦点を当てて、テクノロジースタックから始めましょう。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CentOs 7</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Docker + Nomad + Consul + Vault</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Java 11（古いIntegroモノリスはJava 8に残ります）</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spring Boot 2.X + Spring Cloud Config</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PostgreSql 11</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">うさぎ&nbsp;</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アパッチに火をつける</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カマンダ（埋め込み）</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グラファナ+グラファイト+プロメテウス+イエーガー+ ELK</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Web UI：React（CSR）+ MobX</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSO：Keycloak</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マイクロサービス開発の原則を順守していますが、以前のバージョンのIntegroのモノリスの形の遺産があります。</font><font style="vertical-align: inherit;">各マイクロサービスはDockerコンテナーで回転しており、サービスはHTTPリクエストとRabbitMQメッセージを介して相互に通信します。</font><font style="vertical-align: inherit;">マイクロサービスはConsulを介してお互いを見つけ、それにリクエストを実行し、SSO（Keycloak、OAuth 2 / OpenID Connect）を介して承認を渡します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ib/mn/ne/ibmnnec5ijrxrai9mpx_tdiipri.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際の例として、Jenkinsとの相互作用を考えてみましょう。これは次のステップで構成されています。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ワークフロー管理マイクロサービス（以下、フローマイクロサービスと呼びます）は、Jenkinsでアセンブリを実行しようとしています。</font><font style="vertical-align: inherit;">これを行うために、彼はConsul IP：PORTを介してJenkinsとのマイクロサービス統合（以下、Jenkinsマイクロサービス）を見つけ、Jenkinsでアセンブリーを開始する非同期要求を送信します。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リクエストを受け取った後、JenkinsマイクロサービスはジョブIDを生成して応答します。これにより、作業の結果を識別することができます。</font><font style="vertical-align: inherit;">これとともに、彼はREST APIの呼び出しを通じてJenkinsでビルドを開始します。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jenkinsはビルドし、終了したら結果を含むWebhookをJenkinsマイクロサービスに送信します。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Webhookを受け取ったJenkinsマイクロサービスは、リクエスト処理の完了に関するメッセージを生成し、結果をそれに添付します。</font><font style="vertical-align: inherit;">生成されたメッセージは、RabbitMQキューに送信されます。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">公開されたメッセージは、RabbitMQを介してFlowマイクロサービスに届きます。Flowマイクロサービスは、リクエストのジョブIDと受信したメッセージを比較して、タスクの処理結果を学習します。</font></font><br>
</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、いくつかのグループに分割できる約30のマイクロサービスができました。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">構成管理。</font></font><br>
</li>
<li>     (, ).<br>
</li>
<li>   .<br>
</li>
<li>    (jenkins, nomad, consul  . .).<br>
</li>
<li> (,   . .).<br>
</li>
<li>Web- (UI    ,    . .).<br>
</li>
<li>  -   .<br>
</li>
<li> workflow   .<br>
</li>
</ol><br>
<h2>Workflow </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Integroは、タスクのライフサイクルに関連するアクティビティを自動化します。</font><font style="vertical-align: inherit;">タスクのライフサイクルによって簡略化された、私たちはJiraでのタスクのワークフローを意味します。</font><font style="vertical-align: inherit;">開発プロセスでは、プロジェクト、タスクのタイプ、および特定のタスクで選択されたオプションに応じて、ワークフローにいくつかのバリエーションがあります。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちが最も頻繁に使用するワークフローを検討してください。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yu/va/8x/yuva8xxb7edyldadgxorqwixdtm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図では、ギアは、トランジションがIntegroによって自動的に呼び出されることを示しています。</font><font style="vertical-align: inherit;">タスクがこのワークフローを通過するいくつかの方法を見てみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カナリアテストなしのDEV +ベータ版の完全手動テスト（通常、モノリスをリリースします）：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nu/ab/be/nuabbeencu3tzfmryb2wpcya-cy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
遷移の他の組み合わせがあるかもしれません。</font><font style="vertical-align: inherit;">タスクがたどるパスは、Jiraのオプションを通じて選択できる場合があります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク移動</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タスクがワークフロー「DEV +カナリアテストのテスト」に沿って移動するときに実行される基本的な手順を検討してください</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。1.開発者またはPMがタスクを作成します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2.開発者がタスクを実行します。</font><font style="vertical-align: inherit;">完了すると、それをIN REVIEWのステータスに転送します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. JiraはJiraマイクロサービスに向けてWebhookを送信します（Jiraとの統合を担当します）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4. Jiraマイクロサービスは、ワークフローサービスを開始するリクエストをフローサービス（作業が実行される内部ワークフローを担当）に送信します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5.フローサービスの内部：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスクのレビュー担当者が割り当てられます（ユーザーに関するすべてを知っているユーザーマイクロサービス+ Jiraマイクロサービス）。</font></font></li>
<li> Source- (    ,      )   ,       (          Jira).          ,           .</li>
<li>       :<br>
 <br>
 i)  master- (Git-    ).<br>
 ii)      (Bitbucket-).<br>
 iii)  Pull Request    (Bitbucket-).<br>
 iv)     Pull Request    (Notify-    ).<br>
 v)  ,      DEV (Jenkins-    Jenkins).<br>
 vi)      ,  Integro   Approve  Pull Request (Bitbucket-).</li>
<li>Integro  Approve  Pull Request   .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必要なすべての承認が受信されると（自動テストが正常に合格したことを含む）、IntegroはタスクをTest on Devステータス（Jiraマイクロサービス）に転送します。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6.テスターがタスクをテストします。</font><font style="vertical-align: inherit;">問題がない場合は、タスクをビルドの準備完了ステータスに転送します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7. Integroは、タスクがリリースの準備ができていることを「確認」し、カナリアモード（Jenkinsマイクロサービス）でそのデプロイメントを起動します。</font><font style="vertical-align: inherit;">リリースの準備は、一連のルールによって決定されます。</font><font style="vertical-align: inherit;">たとえば、必要なステータスのタスク、他のタスクにロックはありません、このマイクロサービスのアクティブな計算などはありません。8. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タスクはカナリアステータス（Jiraマイクロサービス）に転送されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
9. Jenkinsは、Nomadを介してカナリアモード（通常は1〜3インスタンス）でタスクのデプロイメントを実行し、計算をリリース監視サービス（DeployWatchマイクロサービス）に通知します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
10. DeployWatch-microserviceはバックグラウンドエラーを収集し、必要に応じてそれに応答します。</font><font style="vertical-align: inherit;">バックグラウンドエラーを超えた場合（バックグラウンドの基準は自動的に計算されます）、開発者はNotifyマイクロサービスを通じて通知されます。</font><font style="vertical-align: inherit;">5分後に開発者が応答しなかった場合（[元に戻す]または[滞在]をクリックした場合）、カナリアインスタンスの自動ロールバックが開始されます。</font><font style="vertical-align: inherit;">バックグラウンドを超えない場合、開発者は手動で（UIのボタンを押して）プロダクション用のタスクのデプロイメントを起動する必要があります。</font><font style="vertical-align: inherit;">60分以内に開発者が本番環境でデプロイメントを開始しなかった場合、セキュリティ上の理由からカナリアインスタンスもポンプで送られます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
11.本番環境へのデプロイメントを開始した後：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスクはプロダクションステータス（Jiraマイクロサービス）に転送されます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jenkinsマイクロサービスがデプロイプロセスを開始し、DeployWatchマイクロサービスのデプロイを通知します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DeployWatch-microserviceは、すべてのコンテナーが本番環境で更新されたことを確認します（すべてが更新されない場合がありました）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本番環境へのデプロイ結果に関する通知は、Notifyマイクロサービスを介して送信されます。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
12.開発者は、マイクロサービスの不正な動作が検出された場合に備えて、本番環境でのタスクのロールバックを開始するまでに30分かかります。</font><font style="vertical-align: inherit;">この時間の後、タスクは自動的にマスター（Git-microservice）に注がれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
13.マスターでのマージが正常に完了すると、タスクのステータスが[クローズ（Jiraマイクロサービス）]に変更されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スキームは完全に詳細なふりをするわけではありませんが（実際にはさらに多くのステップがあります）、プロセスへの統合の度合いを評価することができます。</font><font style="vertical-align: inherit;">私たちはこのスキームを理想的とは考えておらず、リリースとデプロイの自動追跡のプロセスを改善しています。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次は何ですか</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モノリスリリース中の手動操作の拒否、自動展開中の監視の改善、開発者とのやり取りの改善など、自動化の開発には大きな計画があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、この場所に立ち寄りましょう。</font><font style="vertical-align: inherit;">自動化レビューでは表面的に多くのトピックをカバーしましたが、まったく触れなかったトピックもあるので、喜んで質問に回答します。</font><font style="vertical-align: inherit;">詳細をカバーするための提案をお待ちしております。コメントを書き込んでください。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja486040/index.html">1. CheckFlow-Flowmonを使用した内部ネットワークトラフィックの高速かつ無料の包括的な監査</a></li>
<li><a href="../ja486042/index.html">メッセンジャーと通信法</a></li>
<li><a href="../ja486046/index.html">LinuxカーネルにはWireGuard VPNが含まれています</a></li>
<li><a href="../ja486050/index.html">初心者の目から見たWebix JavaScriptライブラリ。パート3.モジュール、図、ツリーテーブル</a></li>
<li><a href="../ja486052/index.html">焦げた地球はすべてのゲームの母です。クリエイターインタビュー</a></li>
<li><a href="../ja486058/index.html">ロボットビースト、レッスンプラン、新しい詳細：LEGO Education SPIKE Primeの概要</a></li>
<li><a href="../ja486060/index.html">ITの混乱の中で秩序を見つける：独自の開発を組織する</a></li>
<li><a href="../ja486062/index.html">QMLのハードウェアアクセラレーションビデオの単純なゼロコピーレンダリング</a></li>
<li><a href="../ja486064/index.html">アニメーション化されたCSSスライドショーを作成する</a></li>
<li><a href="../ja486066/index.html">アクセスエリア。ポイントからエリアまでの距離を検出し、逆ジオコーディングの要求を減らす</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>