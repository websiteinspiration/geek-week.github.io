<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛪️ 🗄️ 🏑 使用思科威胁响应调查DNSpionage活动，包括远程工作 👨🏿‍🔧 🌬️ 🏊</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="我已经讨论过免费的思科威胁响应（CTR）解决方案，该解决方案可以大大减少调查具有许多不同危害指标类型的事件的时间-文件哈希，IP地址，域名，电子邮件地址等。但是，过去的记录专门针对将CTR与单独的思科解决方案结合使用的示例，或与GosSOPKA和FinCERT集成的示例。今天，我想描述一下如何使用C...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>使用思科威胁响应调查DNSpionage活动，包括远程工作</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/cisco/blog/494140/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我已经讨论过免费的思科威胁响应（CTR）解决方案，该解决方案可以大大减少调查具有许多不同危害指标类型的事件的时间-文件哈希，IP地址，域名，电子邮件地址等。但是，过去的记录专门针对将CTR与单独的思科解决方案结合使用的示例，或与GosSOPKA和FinCERT集成的示例。今天，我想描述一下如何使用CTR来调查可以针对公司内许多不同目标使用多种媒介的黑客活动。例如，以我在上一篇文章中提到的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DNSpionage活动</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为例</font><font style="vertical-align: inherit;">。</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上次我展示了如何仅使用一种解决方案-Cisco Stealthwatch Enterprise网络异常分析系统就可以检测到它。然后，我们通过DNS协议记录了恶意客户端部分与命令服务器的交互，这可以作为是否在公司网络内未经授权的节点上使用的指示。实际上，我们在网络流量中寻找异常情况以寻找事件征兆。现在，让我们看看如何使用更熟悉的恶意活动指标（IOC）来识别DNSpionage活动？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们可以在任何威胁情报公告中看到指标列表。在这种情况下，我们将使用世界上最大的非政府事件调查组Cisco Talos的站点，该站点首先揭示了DNSpionage活动（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在这里</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这里</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/if/ov/-1/ifov-1vhdwekrvyy45jaovtiix4.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在时事通讯中，我们看到了一个指标列表-攻击所涉及的命令和网络钓鱼服务器的文件哈希，IP和域地址。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xp/dy/bv/xpdybvedg1uraqxn0yo2m1ehzpy.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果我们通过适当的保护手段来“推动”每个指标，那将花费我们太多时间。例如，在EDR类解决方案Cisco AMP for Endpoints中，我们在搜索栏中（右上角）输入一个或几个感兴趣的哈希值：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jd/us/2b/jdus2bkm5mu_b4s0l1cdnr9vtri.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们得到了我们感兴趣的结果-我们找到了一个节点，在该节点上检测到了我们有哈希的恶意程序的活动。 。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tl/ea/6q/tlea6qaed_a8kcopyzzfepcx07m.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
顺便说一句，我想指出的是，哈希搜索不仅可以用来检测恶意活动，而且还可以用来防止信息泄漏。回想一下，用于处理泄漏（连同容器/标签和内容分析）的技术之一是使用数字指纹，可以仅使用AMP4E将控制的哈希（以及其他可能包括以下解决方案的Cisco解决方案）来实现数字指纹。已实施的AMP引擎-Cisco Firepower，Cisco电子邮件安全设备，Cisco Web安全设备，Cisco伞等）。的确，这种机制仅适用于很少修改的文件。如果您对思科提供的解决泄漏的方法感兴趣，我建议您进行</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">记录</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">演示。</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们最新的网络研讨会，我们致力于该主题。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是回到我们的故事。</font><font style="vertical-align: inherit;">如果您尝试跟踪对命令或网络钓鱼服务器域的访问，则Cisco Umbrella可以为我们提供帮助。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/c2/1x/gx/c21xgx-dvavn5o9cgpjurhzr4mm.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于大多数事件中主要的感染媒介是电子邮件，因此我们还需要在电子邮件中寻找我们感兴趣的指标。</font><font style="vertical-align: inherit;">为此，我们在Cisco安全管理设备或Cisco电子邮件安全设备中指示相应指示符的哈希值：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yg/ul/r8/ygulr8dih6q_5u4xb77qmdel2eq.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们找到5个邮箱，在其中找到了要查找的文件的痕迹。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fy/zm/pf/fyzmpftvdwyxm2gejaovdfsgmb0.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最后，具有内置入侵防御系统的下一代防火墙Cisco Firepower可帮助我们跟踪（并阻止）恶意活动的客户端与之交互的IP地址。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yn/zk/y7/ynzky7yzkvxxrhipzos4ypgu7iu.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在此示例中，尽管我们检测到DNSpionage的迹象，但我们没有按照自己想要的速度进行。我们正在控制台之间切换。我们进行了许多复制粘贴操作，并且4种不同的产品正在寻找4种不同类型的危害指标，从而增加了调查和响应时间。这个过程可以加速吗？当然。您可以使用SIEM，它可以与TI信息源集成在一起，也可以从外部TI信息源下载危害指标。但是，如果它来自开放源代码类别，则如果它是商业性的或需要高能力，则价格昂贵。有一个更简单，更免费的解决方案-思科威胁响应，它主要侧重于思科解决方案以及其他供应商的解决方案。使用浏览器插件，我们从Cisco Talos博客页面“拉出”描述DNSpionage活动的所有指标。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vk/wz/sh/vkwzshjii1wgjxmth16plgfxb5e.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了加快响应速度，我们可以直接通过插件阻止相关指标。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/w1/jw/iw/w1jwiwoxjpkmmvm_is3eunkjnga.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是我们有兴趣调查此事件，以试图了解我们的哪个节点和用户受到了攻击。建议在一个屏幕上查看所有内容。点击率给了我们这个机会。在图形界面的左上方，我们看到了所有指标。在左下方-我们的“感染”地图。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qb/p9/mr/qbp9mrufw-sj1vki2ofqyyuemgo.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
紫色表示我们的基础架构中已经受影响的目标-PC，邮箱，子网等。在右上方，我们看到了一个时间线，显示了我们网络环境中指标出现的日期（包括第一个）。最后，右下角的区域使我们能够获取有关每个指标的详细信息，并由外部TI来源（例如VirusTotal或第三方保护工具）丰富和验证。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/l9/jx/yq/l9jxyqsjricd3smbegy3su8hsoy.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
了解了感染的程度后，我们可以通过阻止与命令服务器域进行交互的Cisco Umbrella（</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xp/0c/ac/xp0cactpyjnuh4dnluuvjediqhg.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
或隔离了恶意文件或进程的运行的Cisco AMP）</font><font style="vertical-align: inherit;">阻止已发生的威胁，从而开始对已识别的威胁做出适当的响应</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/un/jz/mo/unjzmo-jhiuzledetjvf-t_q5fy.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
立即从CTR界面中，我们可以看到阻止文件，域或其他指标的结果。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hk/qa/jo/hkqajo70ap-vqaw4gc51wfulglg.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通过将CTR与Cisco电子邮件安全设备或Cisco Firepower集成，我们还可以分别隔离受感染的邮箱或受感染的站点。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
是否可以做同样的事情，但不使用Cisco Threat Response接口？有时您想使用自己的，更熟悉的工具来完成此任务。是的你可以。例如，我们可以将CTR功能嵌入支持浏览器的任何技术中（例如，在我们自己的门户中），并且由于API的可用性，可以从任何地方访问CTR功能。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
假设您希望使用命令行界面，并希望通过键盘输入所有命令来进行调查并做出响应。这也很容易做到。例如，以下是CTR集成与Cisco Webex Teams团队合作系统以及以DNSpionage活动为例开发的AskWill机器人一起工作的方式。我们的客户经常使用Cisco Webex Teams组织信息安全专家的互动。该示例更加有趣，因为它显示了在远程工作时如何建立调查和响应过程，而此时，唯一使SOC专家团结在一起的就是通信系统。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例如，我们要获取域0ffice36o.com的状态，该域被命令服务器用作DNSpionage的一部分。我们看到Cisco伞返回给我们“恶意”状态。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/g6/ml/p6/g6mlp61yd2fe8a1lr48j2kwvgju.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这是该团队将如何查找有关Cisco Talos在我们的基础架构中立即发现DNSpionage活动是否存在多个危害指标的信息。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/aw/2l/ax/aw2laxyma1otgdyvtp5ewi1sduu.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
然后，我们可以通过Cisco Umbrella或Cisco Stealthwatch Cloud阻止恶意域。在后一种情况下，异常分析系统将阻止与命令服务器的交互，以用于我们使用的Amazon AWS，MS Azure云基础架构等。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kz/yp/ba/kzypbayjmcv56maxri4jjmblzgq.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最后，如果我们错误地阻止了一个指标，或者随着时间的流逝，人们已经知道它已不再构成威胁，则可以将其从保护性解决方案的黑名单中删除。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bh/a5/rs/bha5rsgaph_on7cm55cbvucvm5c.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这是免费的Cisco Threat Response解决方案的工作方式，其主要任务是减少调查和响应事件的时间。</font><font style="vertical-align: inherit;">就像我们的客户所说的那样，点击率可以使他们大大降低点击率。</font><font style="vertical-align: inherit;">60％的用户减少了50％；</font><font style="vertical-align: inherit;">另外23％的人至少有25％。</font><font style="vertical-align: inherit;">免费解决方案还不错，是吗？</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">附加信息：</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">思科威胁响应和思科Stealthwatch Enterprise的集成</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GosSOPKoy和FinCERT中思科解决方案的交互</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">思科为何不购买Splunk或谈论思科平台如何用于威胁搜寻</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">借助思科可见性进行威胁搜寻</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用网络异常分析工具的案例研究：DNSpionage广告活动发现</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN494126/index.html">最佳科学。二月媒体十：螃蟹僵尸女权主义者，史前Sal和夸张的酒鬼</a></li>
<li><a href="../zh-CN494128/index.html">Hackspace Neuron-莫斯科黑客的聚会场所</a></li>
<li><a href="../zh-CN494130/index.html">在线事件发生了什么：我们的一些统计数据</a></li>
<li><a href="../zh-CN494132/index.html">Python中的Befunge编译器</a></li>
<li><a href="../zh-CN494136/index.html">滴什么东西以免痒</a></li>
<li><a href="../zh-CN494150/index.html">阿维托的ClickHouse：与Alexey Milovidov的现场聚会</a></li>
<li><a href="../zh-CN494152/index.html">HoughNet：搜索与经典算法融合的消失点</a></li>
<li><a href="../zh-CN494154/index.html">我们如何将视频编码加速八倍</a></li>
<li><a href="../zh-CN494156/index.html">如何在家工作-Plesk去除剂的经验</a></li>
<li><a href="../zh-CN494158/index.html">如何保持检疫工作质量</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>