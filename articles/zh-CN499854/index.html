<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚳 🏫 👩🏾 Apache Bigtop和当今Hadoop发行版的选择 🖱️ ‼️ 🚵🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="去年对于Apache Hadoop来说是巨大变化的一年，这可能不是什么秘密。去年，Cloudera和Hortonworks合并（基本上是对第二家公司的收购），由于严重的财务问题，Mapr被卖给了惠普。如果是几年前，就本地安装而言，通常必须在Cloudera和Hortonworks之间进行选择，可惜今...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Apache Bigtop和当今Hadoop发行版的选择</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/rostelecom/blog/499854/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/mc/g4/_k/mcg4_kr77oelzmcrcsuoak_bvgm.png"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
去年对于Apache Hadoop来说是巨大变化的一年，这可能不是什么秘密。去年，Cloudera和Hortonworks合并（基本上是对第二家公司的收购），由于严重的财务问题，Mapr被卖给了惠普。如果是几年前，就本地安装而言，通常必须在Cloudera和Hortonworks之间进行选择，可惜今天，我们没有这个选择。另一个令人惊讶的事实是，自今年2月以来，Cloudera宣布终止将二进制程序集分发到公共存储库的发行，现在只能通过付费订阅才能使用它们。当然，仍然可以下载2019年底之前发布的最新版本的CDH和HDP的功能，并且预计将对其支持一到两年。但是下一步该怎么办？对于那些，以前为订阅付费的人，没有任何变化。对于那些不想切换到发行版的付费版本，但又希望能够获得最新版本的群集组件以及补丁和其他更新的用户，我们准备了本文。在其中，我们将考虑解决这种情况的可能方法。</font></font><br>
<br>
<i>  .          ,          .    ?        Arenadata Hadoop,         ,     .     Vanilla Hadoop,    ,    “”   Apache Bigtop. ?     .</i><br>
<a name="habracut"></a><br>
<h2>Arenadata Hadoop</h2><br>
<img src="https://habrastorage.org/webt/7f/kr/ri/7fkrriu9pcnmo67yb6nogwconaa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这是迄今为止国内发展的一个全新的，鲜为人知的分布。不幸的是，目前关于哈布雷的只有</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这篇文章</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
可以在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">项目</font><font style="vertical-align: inherit;">的官方</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">网站上</font></a><font style="vertical-align: inherit;">找到更多信息</font><font style="vertical-align: inherit;">。最新发行版基于Hadoop 3.1.2版本3和2.8.5版本2。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
关于路线图的信息可以在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这里</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">找到</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rd/yk/gu/rdykgutfce6fdwm1v-chlynbpfg.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arenadata Cluster Manager界面Arenadata的</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
主要产品是</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arenadata Cluster Manager（ADCM）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，用于安装，配置和监视公司的各种软件解决方案。 ADCM是免费的，并且通过向其添加捆绑软件来扩展其功能，捆绑软件是一组ansible-playbook。捆绑包分为两种：企业和社区。后者可以从Arenadata免费下载。也可以开发自己的捆绑软件并将其连接到ADCM。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对于Hadoop 3的部署和管理，提供了捆绑版本和ADCM的社区版本，而对于hadoop 2，仅</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apache Ambari</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为备选。</font><font style="vertical-align: inherit;">至于带有软件包的存储库，它们是开放供公众访问的，可以按常规方式为所有集群组件下载和安装它们。</font><font style="vertical-align: inherit;">通常，该分布看起来非常有趣。</font><font style="vertical-align: inherit;">我敢肯定，有些人已经习惯了Cloudera Manager和Ambari之类的解决方案，并且会喜欢ADCM本身。</font><font style="vertical-align: inherit;">对于某些人而言，将分发工具包</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含在</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进口替代</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">软件注册表中</font></a><font style="vertical-align: inherit;">的事实将是一个巨大的优势</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果我们谈论缺点，那么它们将与所有其他Hadoop发行版相同。</font><font style="vertical-align: inherit;">即：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所谓的“供应商锁定”。</font><font style="vertical-align: inherit;">通过使用Cloudera和Hortonworks的示例，我们已经意识到，始终存在更改公司政策的风险。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在上游落后于Apache。</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">香草哈杜普</font></font></h2><br>
<img src="https://habrastorage.org/webt/uc/ai/cf/ucaicfkxuxclezuxfumjrokgeak.png" width="500"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如您所知，Hadoop并非单片产品，实际上是围绕其分布式HDFS文件系统的整个服务体系。很少有人需要一个文件集群。一个需要Hive，另一个需要Presto，还有HBase和Phoenix，Spark被越来越多地使用。有时会发现Oozie，Sqoop和Flume可以编排和下载数据。并且，如果出现安全问题，将立即记住Kerberos和Ranger的结合。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hadoop组件的二进制版本以压缩文件的形式在每个生态系统项目的网站上提供。</font><font style="vertical-align: inherit;">可以下载它们并开始安装，但有一个条件：除了您最有可能希望运行的“原始”二进制文件中的程序包的自组装以外，您对组件的下载版本之间的兼容性也没有任何信心。</font><font style="vertical-align: inherit;">首选选项是使用Apache Bigtop构建。</font><font style="vertical-align: inherit;">Bigtop允许您从Apache的Maven存储库进行构建，运行测试和构建软件包。</font><font style="vertical-align: inherit;">但是，对我们而言，这很重要，Bigtop将收集彼此兼容的那些组件版本。</font><font style="vertical-align: inherit;">我们将在下面更详细地讨论它。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apache Bigtop</font></font></h2><br>
<img src="https://habrastorage.org/webt/-g/qm/q6/-gqmq6irdahwcfpmntftm15tqni.png" width="500"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apache Bigtop是用于构建，打包和测试许多</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
开源项目（例如Hadoop和Greenplum）的工具。 Bigtop有许多</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
版本。在撰写本文时，最新的稳定版本是1.4版，</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
而master </font><font style="vertical-align: inherit;">版本</font><font style="vertical-align: inherit;">是1.5版。不同版本的发行版使用不同版本的</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
组件。例如，对于1.4，Hadoop核心组件的版本为2.8.5，主版本为</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2.10.0。支持的组件的组成也在改变。一些过时且</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不可更新的叶子，取而代之的是一些新的，需求量更大的东西，而</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不一定来自Apache家族本身。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bigtop也有很多</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">叉子</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当我们开始熟悉Bigtop时，与其他Apache项目，盛行和成名以及一个很小的社区相比，它的谦逊首先让我们感到惊讶。由此可见，产品信息最少，对于通过论坛和新闻通讯出现的问题的解决方案的搜索可能根本不会产生任何效果。首先，由于工具本身的功能，对我们来说完成分发工具包的组装是一项艰巨的任务，但是稍后我们将对此进行讨论。</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为预告，对于那些曾经访问过诸如Gentoo和LFS之类的Linux宇宙项目的人来说，使用此东西并回想起我们自己搜索（甚至编写）ebuild的那些“过去的”时代似乎怀旧起来很愉快。并定期使用新补丁mozilla进行重建。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bigtop的一大优点可以认为是其基础工具的开放性和多功能性。</font><font style="vertical-align: inherit;">它的基础是Gradle和Apache Maven。</font><font style="vertical-align: inherit;">Gradle是Google为其收集Android的工具而闻名。</font><font style="vertical-align: inherit;">它很灵活，而且正如他们所说的那样，“经过了考验”。</font><font style="vertical-align: inherit;">Maven是用于在Apache本身中构建项目的全职工具，并且由于其大多数产品都是通过Maven发布的，所以没有它就无法做到。</font><font style="vertical-align: inherit;">值得关注的是POM（项目对象模型）-一个“基本的” xml文件，其中描述了Maven处理项目所必需的一切，所有工作都围绕该文件进行构建。</font><font style="vertical-align: inherit;">在</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maven部分中，遇到一些障碍，这些障碍通常在占据Bigtop时首次遇到。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实践</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
那么从哪里开始呢？</font><font style="vertical-align: inherit;">我们转到下载页面，并下载最新的稳定版本作为存档。</font><font style="vertical-align: inherit;">Bigtop收集的二进制工件也可以在此处找到。</font><font style="vertical-align: inherit;">顺便说一下，在常见的程序包管理器中，YUM和APT受支持。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
另外，您可以直接从</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
github </font><font style="vertical-align: inherit;">下载最新的稳定版本</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="plaintext hljs">$ git clone --branch branch-1.4 https://github.com/apache/bigtop.git</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在“ bigtop”中克隆...</font></font><br>
<br>
<pre><code class="plaintext hljs">remote: Enumerating objects: 46, done.<font></font>
remote: Counting objects: 100% (46/46), done.<font></font>
remote: Compressing objects: 100% (41/41), done.<font></font>
remote: Total 40217 (delta 14), reused 10 (delta 1), pack-reused 40171<font></font>
 : 100% (40217/40217), 43.54 MiB | 1.05 MiB/s, .<font></font>
 : 100% (20503/20503), .<font></font>
Updating files: 100% (1998/1998), .</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
生成的./bigtop目录如下所示：</font></font><br>
<br>
<code>./bigtop-bigpetstore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-演示应用程序，合成示例</font></font><br>
<code>./bigtop-ci</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-CI工具，詹金斯</font></font><br>
<code>./bigtop-data-generators</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-数据生成，合成，冒烟测试等。</font></font><br>
<code>./bigtop-deploy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-部署工具</font></font><br>
<code>./bigtop-packages</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-配置，脚本，组装补丁，工具的主要部分</font></font><br>
<code>./bigtop-test-framework</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-测试框架</font></font><br>
<code>./bigtop-tests</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-测试自身，压力和冒烟</font></font><br>
<code>./bigtop_toolchain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-组装环境，工具可以使用的环境的准备</font></font><br>
<code>./build</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-组装的工作目录</font></font><br>
<code>./dl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-下载源的目录</font></font><br>
<code>./docker</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-docker </font><font style="vertical-align: inherit;">中的组装</font><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">映像，测试</font></font><br>
<code>./gradle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-gradle config- </font></font><br>
<code>./output </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">程序集工件进入的目录</font></font><br>
<code>./provisioner</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-设置</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在此阶段，对我们而言最有趣的是主配置</font></font><code>./bigtop/bigtop.bom</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其中我们可以看到所有受支持的组件及其版本。</font><font style="vertical-align: inherit;">在这里我们可以指定产品的其他版本（如果突然想尝试构建它）或程序集的版本（例如，如果我们添加了重要的补丁程序）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
子目录也引起了极大的兴趣，该子目录</font></font><code>./bigtop/bigtop-packages</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与组件和组件的组装过程直接相关。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，我们下载了档案文件，将其解压缩或使用github克隆，可以启动程序集吗？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不，首先要准备环境。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">环境准备</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这里需要一点题外话。</font><font style="vertical-align: inherit;">要构建几乎或多或少复杂的产品，您需要一个特定的环境-在我们的例子中，它是JDK，相同的共享库，头文件等工具，例如ant，ivy2等。</font><font style="vertical-align: inherit;">获得Bigtop所需环境的一种选择是在组装主机上安装必要的组件。</font><font style="vertical-align: inherit;">我可能在编年史上弄错了，但是从1.0版开始，似乎在预配置且可访问的Docker映像中还有一个构建选项，您可以在这里找到它们。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
至于环境的准备，还有一个助手-木偶。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您可以使用以下命令，启动是从</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
工具</font><font style="vertical-align: inherit;">的根目录完成的</font><font style="vertical-align: inherit;">，</font></font><code>./bigtop:</code><br>
<br>
<pre><code class="plaintext hljs">./gradlew toolchain<font></font>
./gradlew toolchain-devtools<font></font>
./gradlew toolchain-puppetmodules<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
或直接通过木偶：</font></font><br>
<br>
<pre><code class="plaintext hljs">puppet apply --modulepath=&lt;path_to_bigtop&gt; -e "include bigtop_toolchain::installer"<font></font>
puppet apply --modulepath=&lt;path_to_bigtop&gt; -e "include bigtop_toolchain::deployment-tools"<font></font>
puppet apply --modulepath=&lt;path_to_bigtop&gt; -e "include bigtop_toolchain::development-tools"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不幸的是，现阶段可能已经出现困难。</font><font style="vertical-align: inherit;">这里的一般建议是在构建主机上使用最新的受支持的发行版，或者尝试使用docker的路径。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部件</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们可以尝试收集什么？</font><font style="vertical-align: inherit;">这个问题的答案将给出命令的输出</font></font><br>
<br>
<pre><code class="plaintext hljs">./gradlew tasks</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
打包任务部分包含许多产品，这些产品是Bigtop的最终产品。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
它们可以通过后缀-rpm或-pkg-ind进行标识（如果在docker中进行组装</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
）。</font><font style="vertical-align: inherit;">在我们的案例中，最有趣的是Hadoop。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们尝试在构建服务器的环境中进行构建：</font></font><br>
<br>
<pre><code class="plaintext hljs">./gradlew hadoop-rpm</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bigtop本身将下载特定组件所需的必要资源并开始构建。因此，该工具与Maven存储库和其他来源相关联，也就是说，它需要Internet访问。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在此过程中，将形成标准输出。有时您可以从中了解错误信息，并从错误消息中了解问题所在。有时您需要更多信息。在这种情况下，值得添加参数</font></font><code>--info </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>--debug</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并且也可能有用</font></font><code>–stacktrace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。有一种方便的方法可以生成一个数据集，以供以后参考邮件列表，即key </font></font><code> --scan</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
有了它，bigtop将收集所有信息并将其放在gradle中，然后将提供一个链接，</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
然后有能力的人将能够知道装配失败的原因。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您需要记住，此选项可能会使您不希望公开的信息，例如用户名，节点，环境变量等，因此请当心。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
错误通常是由于无法获得组装所需的任何组件而导致的。</font><font style="vertical-align: inherit;">通常，可以通过创建修补程序来修复源中的某些内容（例如，源根目录中pom.xml中的地址）来解决问题。</font><font style="vertical-align: inherit;">这是通过将其创建并放置在适当的</font></font><code> ./bigtop/bigtop-packages/src/common/oozie/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">补丁程序</font><font style="vertical-align: inherit;">目录中</font><font style="vertical-align: inherit;">（例如，</font><i><font style="vertical-align: inherit;">patch2-fix.diff</font></i><font style="vertical-align: inherit;">的形式）来</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完成的。</font></font></i><br>
<br>
<pre><code class="apache hljs">--- <span class="hljs-attribute">a</span>/pom.xml<font></font>
+++ <span class="hljs-attribute">b</span>/pom.xml<font></font>
@@ -<span class="hljs-attribute">136</span>,<span class="hljs-number">7</span> +<span class="hljs-number">136</span>,<span class="hljs-number">7</span> @@
<span class="hljs-section">&lt;repositories&gt;</span>
<span class="hljs-section">&lt;repository&gt;</span>
<span class="hljs-section">&lt;id&gt;</span><span class="hljs-attribute">central</span>&lt;/id&gt;<font></font>
- <span class="hljs-section">&lt;url&gt;</span><span class="hljs-attribute">http</span>://repo<span class="hljs-number">1</span>.maven.org/maven<span class="hljs-number">2</span>&lt;/url&gt;<font></font>
+ <span class="hljs-section">&lt;url&gt;</span><span class="hljs-attribute">https</span>://repo<span class="hljs-number">1</span>.maven.org/maven<span class="hljs-number">2</span>&lt;/url&gt;
<span class="hljs-section">&lt;snapshots&gt;</span>
<span class="hljs-section">&lt;enabled&gt;</span><span class="hljs-attribute">false</span>&lt;/enabled&gt;
<span class="hljs-section">&lt;/snapshots&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在阅读本文时，最有可能您不必自己进行上述更正。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
将任何补丁和编辑内容引入组装机制时，您可能需要通过cleanup命令“重置”组装：</font></font><br>
<br>
<pre><code class="plaintext hljs">./gradlew hadoop-clean<font></font>
&gt; Task :hadoop_vardefines<font></font>
&gt; Task :hadoop-clean<font></font>
BUILD SUCCESSFUL in 5s<font></font>
2 actionable tasks: 2 executed</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此操作将回滚此组件的装配中的所有更改，然后将再次执行装配。</font><font style="vertical-align: inherit;">这次，我们将尝试在Docker映像中构建项目：</font></font><br>
<br>
<pre><code class="plaintext hljs">./gradlew -POS=centos-7 -Pprefix=1.2.1 hadoop-pkg-ind<font></font>
&gt; Task :hadoop-pkg-ind<font></font>
Building 1.2.1 hadoop-pkg on centos-7 in Docker...<font></font>
+++ dirname ./bigtop-ci/build.sh<font></font>
++ cd ./bigtop-ci/..<font></font>
++ pwd<font></font>
+ BIGTOP_HOME=/tmp/bigtop<font></font>
+ '[' 6 -eq 0 ']'<font></font>
+ [[ 6 -gt 0 ]]<font></font>
+ key=--prefix<font></font>
+ case $key in<font></font>
+ PREFIX=1.2.1<font></font>
+ shift<font></font>
+ shift<font></font>
+ [[ 4 -gt 0 ]]<font></font>
+ key=--os<font></font>
+ case $key in<font></font>
+ OS=centos-7<font></font>
+ shift<font></font>
+ shift<font></font>
+ [[ 2 -gt 0 ]]<font></font>
+ key=--target<font></font>
+ case $key in<font></font>
+ TARGET=hadoop-pkg<font></font>
+ shift<font></font>
+ shift<font></font>
+ [[ 0 -gt 0 ]]<font></font>
+ '[' -z x ']'<font></font>
+ '[' -z x ']'<font></font>
+ '[' '' == true ']'<font></font>
+ IMAGE_NAME=bigtop/slaves:1.2.1-centos-7<font></font>
++ uname -m<font></font>
+ ARCH=x86_64<font></font>
+ '[' x86_64 '!=' x86_64 ']'<font></font>
++ docker run -d bigtop/slaves:1.2.1-centos-7 /sbin/init<font></font>
+<font></font>
CONTAINER_ID=0ce5ac5ca955b822a3e6c5eb3f477f0a152cd27d5487680f77e33fbe66b5bed8<font></font>
+ trap 'docker rm -f<font></font>
0ce5ac5ca955b822a3e6c5eb3f477f0a152cd27d5487680f77e33fbe66b5bed8' EXIT<font></font>
....<font></font>
 <font></font>
....<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-2.8.5-1.el7.x86_64.rpm<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-hdfs-2.8.5-1.el7.x86_64.rpm<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-yarn-2.8.5-1.el7.x86_64.rpm<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-mapreduce-2.8.5-1.el7.x86_64.rpm<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-hdfs-namenode-2.8.5-1.el7.x86_64.rpm<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-hdfs-secondarynamenode-2.8.5-<font></font>
1.el7.x86_64.rpm<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-hdfs-zkfc-2.8.5-1.el7.x86_64.rpm<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-hdfs-journalnode-2.8.5-<font></font>
1.el7.x86_64.rpm<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-hdfs-datanode-2.8.5-1.el7.x86_64.rpm<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-httpfs-2.8.5-1.el7.x86_64.rpm<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-yarn-resourcemanager-2.8.5-<font></font>
1.el7.x86_64.rpm<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-yarn-nodemanager-2.8.5-<font></font>
1.el7.x86_64.rpm<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-yarn-proxyserver-2.8.5-<font></font>
1.el7.x86_64.rpm<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-yarn-timelineserver-2.8.5-<font></font>
1.el7.x86_64.rpm<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-mapreduce-historyserver-2.8.5-<font></font>
1.el7.x86_64.rpm<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-client-2.8.5-1.el7.x86_64.rpm<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-conf-pseudo-2.8.5-1.el7.x86_64.rpm<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-doc-2.8.5-1.el7.x86_64.rpm<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-libhdfs-2.8.5-1.el7.x86_64.rpm<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-libhdfs-devel-2.8.5-1.el7.x86_64.rpm<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-hdfs-fuse-2.8.5-1.el7.x86_64.rpm<font></font>
Wrote: /bigtop/build/hadoop/rpm/RPMS/x86_64/hadoop-debuginfo-2.8.5-1.el7.x86_64.rpm<font></font>
+ umask 022<font></font>
+ cd /bigtop/build/hadoop/rpm//BUILD<font></font>
+ cd hadoop-2.8.5-src<font></font>
+ /usr/bin/rm -rf /bigtop/build/hadoop/rpm/BUILDROOT/hadoop-2.8.5-1.el7.x86_64<font></font>
Executing(%clean): /bin/sh -e /var/tmp/rpm-tmp.uQ2FCn<font></font>
+ exit 0<font></font>
+ umask 022<font></font>
Executing(--clean): /bin/sh -e /var/tmp/rpm-tmp.CwDb22<font></font>
+ cd /bigtop/build/hadoop/rpm//BUILD<font></font>
+ rm -rf hadoop-2.8.5-src<font></font>
+ exit 0<font></font>
[ant:touch] Creating /bigtop/build/hadoop/.rpm<font></font>
:hadoop-rpm (Thread[Task worker for ':',5,main]) completed. Took 38 mins 1.151 secs.<font></font>
:hadoop-pkg (Thread[Task worker for ':',5,main]) started.<font></font>
&gt; Task :hadoop-pkg<font></font>
Task ':hadoop-pkg' is not up-to-date because:<font></font>
Task has not declared any outputs despite executing actions.<font></font>
:hadoop-pkg (Thread[Task worker for ':',5,main]) completed. Took 0.0 secs.<font></font>
BUILD SUCCESSFUL in 40m 37s<font></font>
6 actionable tasks: 6 executed<font></font>
+ RESULT=0<font></font>
+ mkdir -p output<font></font>
+ docker cp<font></font>
ac46014fd9501bdc86b6c67d08789fbdc6ee46a2645550ff6b6712f7d02ffebb:/bigtop/build .<font></font>
+ docker cp<font></font>
ac46014fd9501bdc86b6c67d08789fbdc6ee46a2645550ff6b6712f7d02ffebb:/bigtop/output .<font></font>
+ docker rm -f ac46014fd9501bdc86b6c67d08789fbdc6ee46a2645550ff6b6712f7d02ffebb<font></font>
ac46014fd9501bdc86b6c67d08789fbdc6ee46a2645550ff6b6712f7d02ffebb<font></font>
+ '[' 0 -ne 0 ']'<font></font>
+ docker rm -f ac46014fd9501bdc86b6c67d08789fbdc6ee46a2645550ff6b6712f7d02ffebb<font></font>
Error: No such container:<font></font>
ac46014fd9501bdc86b6c67d08789fbdc6ee46a2645550ff6b6712f7d02ffebb<font></font>
BUILD SUCCESSFUL in 41m 24s<font></font>
1 actionable task: 1 executed</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
构建是在CentOS下完成的，但您也可以在Ubuntu下进行：</font></font><br>
<br>
<pre><code class="plaintext hljs">./gradlew -POS=ubuntu-16.04 -Pprefix=1.2.1 hadoop-pkg-ind</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
除了为各种Linux发行版组装软件包之外，该工具还可以使用组装的软件包创建存储库，例如：</font></font><br>
<br>
<pre><code class="plaintext hljs">./gradlew yum</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您可能还记得在docker中进行烟雾测试和部署。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
创建一个由三个节点组成的集群：</font></font><br>
<br>
<pre><code class="plaintext hljs">./gradlew -Pnum_instances=3 docker-provisioner</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在三个节点的集群中运行冒烟测试：</font></font><br>
<br>
<pre><code class="plaintext hljs">./gradlew -Pnum_instances=3 -Prun_smoke_tests docker-provisioner</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
删除集群：</font></font><br>
<br>
<pre><code class="plaintext hljs">./gradlew docker-provisioner-destroy</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
获取用于在Docker容器内部进行连接的命令：</font></font><br>
<br>
<pre><code class="plaintext hljs">./gradlew docker-provisioner-ssh</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
显示状态：</font></font><br>
<br>
<pre><code class="plaintext hljs">./gradlew docker-provisioner-status</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您可以在文档中阅读有关部署任务的更多信息。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果我们谈论测试，那么有很多测试，主要是烟雾测试和集成测试。</font><font style="vertical-align: inherit;">他们的分析超出了本文的范围。</font><font style="vertical-align: inherit;">我只能说，构建分发工具包并不像乍看起来那样困难。</font><font style="vertical-align: inherit;">我们设法在测试中收集并通过了我们在产品中使用的所有组件，并且在测试环境中它们的部署和基本操作也没有问题。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
除了Bigtop中的现有组件之外，还可以添加其他内容，甚至可以自己开发软件。</font><font style="vertical-align: inherit;">所有这些都是完全自动化的，并且适合CI / CD的概念。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结论</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
显然，以这种方式构建的发行版不应立即发送到生产环境。您需要了解，如果确实需要建立和维护您的发行版，那么您需要在财务和时间上进行投资。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，结合正确的方法和专业的团队，很可能无需商业解决方案。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要的是要注意，Bigtop项目本身需要开发，并且似乎今天没有积极的开发。此外，Hadoop的3在它的外观上的前景并不明确。顺便说一句，如果你有建立的Hadoop 3的实际需要，你可以看一下</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">叉</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从Arenadata，其中，除了标准的</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
成分，还有一些附加组件（游侠，诺克斯，NiFi）的。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
至于Rostelecom，对我们而言，Bigtop是当今考虑的选项之一。</font><font style="vertical-align: inherit;">无论我们是否停止，时间都会证明一切。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">附录</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要在部件中包括新组件，您需要在bigtop.bom和./bigtop-packages中添加其描述。</font><font style="vertical-align: inherit;">您可以尝试通过与现有组件类似的方式来执行此操作。</font><font style="vertical-align: inherit;">尝试弄清楚。</font><font style="vertical-align: inherit;">它并不像乍看起来那样困难。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
你怎么看？</font><font style="vertical-align: inherit;">我们很高兴在评论中看到您的意见，并感谢您的关注！</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本文由Rostelecom数据管理团队编写</font></font></i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN499838/index.html">.NET：依赖关系处理</a></li>
<li><a href="../zh-CN499842/index.html">人们为什么要重新学习</a></li>
<li><a href="../zh-CN499846/index.html">什么时候开始单独的垃圾收集工作，为什么需要对垃圾容器的站点进行视频监视</a></li>
<li><a href="../zh-CN499850/index.html">如何在40分钟内分析竞争对手并制定数字策略</a></li>
<li><a href="../zh-CN499852/index.html">Angular的英语文档</a></li>
<li><a href="../zh-CN499858/index.html">周末该做什么：厌倦蓝屏的人的一些棋盘游戏概述</a></li>
<li><a href="../zh-CN499870/index.html">Pylint：代码分析器的详细测试</a></li>
<li><a href="../zh-CN499872/index.html">Java 9中的模块化</a></li>
<li><a href="../zh-CN499874/index.html">英特尔NUC咳嗽检测</a></li>
<li><a href="../zh-CN499876/index.html">前五本经典书籍，旨在提高金融知识和为交流的第一步做准备</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>