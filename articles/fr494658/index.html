<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖖 🧑‍🤝‍🧑 👨🏿‍🏫 Utilisation de traits pour les relations polymorphes dans Laravel 👴🏽 🧜 👨‍👨‍👦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="introduction
 

Parlons de l'utilisation possible des traits ainsi que des relations polymorphes dans Laravel. 
 

Le contenu de l'article:
 

1. Desc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Utilisation de traits pour les relations polymorphes dans Laravel</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/494658/"><h4 id="vvedenie"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">introduction</font></font></h4><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parlons de l'utilisation possible des traits ainsi que des relations polymorphes dans Laravel. </font></font></p><br>
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le contenu de l'article:</font></font></strong></p><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description du domaine</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Création d'application</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Structures de base de données possibles</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Création d'entité</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilisation des traits</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tests d'écriture</font></font></a></li>
</ol><a name="habracut"></a><br>
<h4 id="anchorstartanchoropisanie-predmetnoy-oblasti"><a name="start"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description du domaine</font></font></h4><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous développerons un système dans lequel certains employés et certaines équipes pourront être rattachés au projet. </font><font style="vertical-align: inherit;">L'essence du sujet sera les employés, les équipes et les projets: une équipe composée d'employés, d'employés et d'équipes peut être attachée à un projet. </font><font style="vertical-align: inherit;">Entre une équipe et un employé, une relation plusieurs à plusieurs (disons qu'un employé peut participer à différentes équipes), plusieurs à plusieurs entre projets et employés, plusieurs à plusieurs entre équipes et projets. </font><font style="vertical-align: inherit;">Pour un examen plus approfondi, omettons la mise en œuvre de la communication entre l'équipe et les employés, concentrons-nous sur l'attitude des équipes et des employés envers le projet.</font></font></p><br>
<h4 id="anchorappanchorsozdanie-prilozheniya"><a name="app"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Création d'application</font></font></h4><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les applications Laravel sont très faciles à construire à </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aide </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">du package du créateur d'application</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Après l'avoir installé, la création d'une nouvelle application tient dans une seule commande:</font></font></p><br>
<pre><code class="bash hljs">laravel new system</code></pre><br>
<h4 id="anchordatabaseanchorvozmozhnye-struktury-bd"><a name="database"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Structures de base de données possibles</font></font></h4><br>
<p>   ,             : -, -, -. </p><br>
<p>   ,       -  -  ,         (, 1 — , 2 — ). </p><br>
<p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">-</a>     ,         —     ,    . </p><br>
<h4 id="anchorentitiesanchorsozdanie-suschnostey"><a name="entities"></a> </h4><br>
<p>  ,     , ,   .     :</p><br>
<pre><code class="bash hljs">php artisan make:model Employee -f //    <font></font>
php artisan make:model Team -f //    <font></font>
php artisan make:model Project -f //    <font></font>
php artisan make:migration CreateEntitiesTables //     <font></font>
php artisan make:model Attach -m //    </code></pre><br>
<p>        App/,     database/migrations/    database/factories/. </p><br>
<p><strong>   </strong>.       ,     :  ,      .        —      . </p><br>
<p><strong>  </strong></p><br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Database</span>\<span class="hljs-title">Migrations</span>\<span class="hljs-title">Migration</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Database</span>\<span class="hljs-title">Schema</span>\<span class="hljs-title">Blueprint</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Support</span>\<span class="hljs-title">Facades</span>\<span class="hljs-title">Schema</span>;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CreateEntitesTables</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Migration</span>
</span>{
    <span class="hljs-comment">/**
     * Run the migrations.
     *
     * <span class="hljs-doctag">@return</span> void
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span>(<span class="hljs-params"></span>)
    </span>{<font></font>
        Schema::create(<span class="hljs-string">'employees'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">Blueprint $table</span>) </span>{<font></font>
            $table-&gt;id();<font></font>
            $table-&gt;string(<span class="hljs-string">'name'</span>);<font></font>
            $table-&gt;timestamps();<font></font>
        });<font></font>
<font></font>
        Schema::create(<span class="hljs-string">'teams'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">Blueprint $table</span>) </span>{<font></font>
            $table-&gt;id();<font></font>
            $table-&gt;string(<span class="hljs-string">'name'</span>);<font></font>
            $table-&gt;timestamps();<font></font>
        });<font></font>
<font></font>
        Schema::create(<span class="hljs-string">'projects'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">Blueprint $table</span>) </span>{<font></font>
            $table-&gt;id();<font></font>
            $table-&gt;string(<span class="hljs-string">'name'</span>);<font></font>
            $table-&gt;timestamps();<font></font>
        });<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * Reverse the migrations.
     *
     * <span class="hljs-doctag">@return</span> void
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">down</span>(<span class="hljs-params"></span>)
    </span>{<font></font>
        Schema::dropIfExists(<span class="hljs-string">'employees'</span>);<font></font>
        Schema::dropIfExists(<span class="hljs-string">'teams'</span>);<font></font>
        Schema::dropIfExists(<span class="hljs-string">'projects'</span>);<font></font>
    }<font></font>
}</code></pre><br>
<p><strong>  </strong></p><br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Database</span>\<span class="hljs-title">Migrations</span>\<span class="hljs-title">Migration</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Database</span>\<span class="hljs-title">Schema</span>\<span class="hljs-title">Blueprint</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Support</span>\<span class="hljs-title">Facades</span>\<span class="hljs-title">Schema</span>;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CreateAttachesTable</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Migration</span>
</span>{
    <span class="hljs-comment">/**
     * Run the migrations.
     *
     * <span class="hljs-doctag">@return</span> void
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span>(<span class="hljs-params"></span>)
    </span>{<font></font>
        Schema::create(<span class="hljs-string">'attachments'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">Blueprint $table</span>) </span>{<font></font>
            $table-&gt;id();<font></font>
            $table-&gt;morphs(<span class="hljs-string">'attachable'</span>);<font></font>
            $table-&gt;unsignedInteger(<span class="hljs-string">'project_id'</span>);<font></font>
            $table-&gt;timestamps();<font></font>
<font></font>
            $table-&gt;foreign(<span class="hljs-string">'project_id'</span>)-&gt;references(<span class="hljs-string">'id'</span>)-&gt;on(<span class="hljs-string">'projects'</span>)<font></font>
                -&gt;onDelete(<span class="hljs-string">'cascade'</span>);<font></font>
        });<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * Reverse the migrations.
     *
     * <span class="hljs-doctag">@return</span> void
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">down</span>(<span class="hljs-params"></span>)
    </span>{<font></font>
        Schema::dropIfExists(<span class="hljs-string">'attachments'</span>);<font></font>
    }<font></font>
}</code></pre><br>
<p> ,          morphs().</p><br>
<p><strong>  </strong></p><br>
<p>    : </p><br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Database</span>\<span class="hljs-title">Eloquent</span>\<span class="hljs-title">Model</span>;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Employee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Model</span>
</span>{
    <span class="hljs-keyword">protected</span> $fillable = [<span class="hljs-string">'name'</span>];<font></font>
}</code></pre><br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Database</span>\<span class="hljs-title">Eloquent</span>\<span class="hljs-title">Model</span>;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Team</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Model</span>
</span>{
    <span class="hljs-keyword">protected</span> $fillable = [<span class="hljs-string">'name'</span>];<font></font>
}</code></pre><br>
<p><strong> </strong></p><br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Database</span>\<span class="hljs-title">Eloquent</span>\<span class="hljs-title">Model</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Database</span>\<span class="hljs-title">Eloquent</span>\<span class="hljs-title">Relations</span>\<span class="hljs-title">HasMany</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Database</span>\<span class="hljs-title">Eloquent</span>\<span class="hljs-title">Relations</span>\<span class="hljs-title">MorphToMany</span>;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Project</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Model</span>
</span>{
    <span class="hljs-keyword">protected</span> $fillable = [<span class="hljs-string">'name'</span>];<font></font>
<font></font>
    <span class="hljs-comment">/**
     * Relation for project attachments
     * <span class="hljs-doctag">@return</span> HasMany
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">attachments</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;hasMany(Attach::class);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * Relation for project employees
     * <span class="hljs-doctag">@return</span> MorphToMany
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">employees</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;morphedByMany(Employee::class, <span class="hljs-string">'attachable'</span>, <span class="hljs-string">'attachments'</span>);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * Relation for project teams
     * <span class="hljs-doctag">@return</span> MorphToMany
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">teams</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;morphedByMany(Team::class, <span class="hljs-string">'attachable'</span>, <span class="hljs-string">'attachments'</span>);<font></font>
    }    <font></font>
}</code></pre><br>
<p><strong></strong></p><br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Database</span>\<span class="hljs-title">Eloquent</span>\<span class="hljs-title">Model</span>;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Attach</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Model</span>
</span>{
    <span class="hljs-keyword">protected</span> $table = <span class="hljs-string">'attachments'</span>;
    <span class="hljs-keyword">protected</span> $fillable = [<span class="hljs-string">'attachable_id'</span>, <span class="hljs-string">'attachable_type'</span>, <span class="hljs-string">'project_id'</span>];<font></font>
}</code></pre><br>
<p><strong></strong>    </p><br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-comment">/** <span class="hljs-doctag">@var</span> \Illuminate\Database\Eloquent\Factory $factory */</span><font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">Faker</span>\<span class="hljs-title">Generator</span> <span class="hljs-title">as</span> <span class="hljs-title">Faker</span>;<font></font>
<font></font>
$factory-&gt;define(<span class="hljs-comment">/* (//) */</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">Faker $faker</span>) </span>{
    <span class="hljs-keyword">return</span> [
        <span class="hljs-string">'name'</span> =&gt; $faker-&gt;colorName<font></font>
    ];<font></font>
});</code></pre><br>
<p> ,   . </p><br>
<h4 id="anchortraitsanchorispolzovanie-treyta"><a name="traits"></a> </h4><br>
<p>   Laravel          —      morphedByMany(),    — morphToMany().          ,               .</p><br>
<p>   app/Traits      : Attachable.php</p><br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Traits</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Project</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Database</span>\<span class="hljs-title">Eloquent</span>\<span class="hljs-title">Relations</span>\<span class="hljs-title">MorphToMany</span>;<font></font>
<font></font>
<span class="hljs-keyword">trait</span> Attachable<font></font>
{<font></font>
    <span class="hljs-comment">/**
     * Relation for entity attachments
     * <span class="hljs-doctag">@return</span> MorphToMany
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">attachments</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;morphToMany(Project::class, <span class="hljs-string">'attachable'</span>, <span class="hljs-string">'attachments'</span>);<font></font>
    }<font></font>
}</code></pre><br>
<p>          use.</p><br>
<pre><code class="php hljs">...
    <span class="hljs-keyword">use</span> <span class="hljs-title">Attachable</span>;<font></font>
...</code></pre><br>
<p>      .</p><br>
<h4 id="anchortestsanchornapisanie-testov"><a name="tests"></a> </h4><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"> </a>, Laravel  PHPUnit  .    : </p><br>
<pre><code class="bash hljs">php artisan make:<span class="hljs-built_in">test</span> AttachableTest</code></pre><br>
<p>     tests/Feature/.           RefreshDatabase. </p><br>
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vérifiez la morphologie du côté du projet et le trait de la part de l'équipe et du personnel</font></font></strong></p><br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">Tests</span>\<span class="hljs-title">Feature</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Team</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Employee</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Project</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Foundation</span>\<span class="hljs-title">Testing</span>\<span class="hljs-title">RefreshDatabase</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Tests</span>\<span class="hljs-title">TestCase</span>;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OrderTest</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">TestCase</span>
</span>{
    <span class="hljs-keyword">use</span> <span class="hljs-title">RefreshDatabase</span>;<font></font>
<font></font>
    <span class="hljs-comment">/** <span class="hljs-doctag">@test</span> */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">polymorphic_relations_scheme</span>(<span class="hljs-params"></span>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-comment">// Given project</span><font></font>
        $project = factory(Project::class)-&gt;create();<font></font>
        <span class="hljs-comment">// Given team</span><font></font>
        $team = factory(Team::class)-&gt;create();<font></font>
        <span class="hljs-comment">// Given employee</span><font></font>
        $employee = factory(Employee::class)-&gt;create();<font></font>
<font></font>
        <span class="hljs-comment">// When we add team and employee to project</span><font></font>
        $project-&gt;teams()-&gt;save($team);<font></font>
        $project-&gt;employees()-&gt;save($employee);<font></font>
<font></font>
        <span class="hljs-comment">// Then project should have two attachments</span>
        <span class="hljs-keyword">$this</span>-&gt;assertCount(<span class="hljs-number">2</span>, $project-&gt;attachments);
        <span class="hljs-keyword">$this</span>-&gt;assertCount(<span class="hljs-number">1</span>, $project-&gt;teams);
        <span class="hljs-keyword">$this</span>-&gt;assertCount(<span class="hljs-number">1</span>, $project-&gt;employees);
        <span class="hljs-keyword">$this</span>-&gt;assertEquals($team-&gt;id, $project-&gt;teams-&gt;first()-&gt;id);
        <span class="hljs-keyword">$this</span>-&gt;assertEquals($employee-&gt;id, $project-&gt;employees-&gt;first()-&gt;id);
        <span class="hljs-comment">// Team and employee should have attachment to project</span>
        <span class="hljs-keyword">$this</span>-&gt;assertCount(<span class="hljs-number">1</span>, $team-&gt;attachments);
        <span class="hljs-keyword">$this</span>-&gt;assertCount(<span class="hljs-number">1</span>, $employee-&gt;attachments);
        <span class="hljs-keyword">$this</span>-&gt;assertEquals($project-&gt;id, $team-&gt;attachments-&gt;first()-&gt;id);
        <span class="hljs-keyword">$this</span>-&gt;assertEquals($project-&gt;id, $employee-&gt;attachments-&gt;first()-&gt;id);<font></font>
    }<font></font>
}</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le test est réussi! </font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les traits vous permettent de ne pas dupliquer les méthodes courantes pour les relations polymorphes au sein des classes de modèle, vous pouvez également les utiliser si vous avez les mêmes champs dans de nombreuses tables (par exemple, l'auteur de l'enregistrement) - ici, vous pouvez également faire un trait avec la méthode de connexion.</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je serai heureux d'entendre vos cas d'utilisation de traits dans Laravel et PHP.</font></font></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr494644/index.html">Automatisation d'un journaliste. Partie 2. Travailler avec des conférenciers</a></li>
<li><a href="../fr494646/index.html">La vie de l'analytique mène ou "je pensais que vous le feriez vous-même"</a></li>
<li><a href="../fr494648/index.html">Nous analysons les problèmes de GOST R 53894-2016 «Knowledge Management. Termes et définitions"</a></li>
<li><a href="../fr494650/index.html">Recherche d'anagrammes et de sabanagrammes dans tous les mots de la langue</a></li>
<li><a href="../fr494652/index.html">Quel est le volume de marketing chez ACID?</a></li>
<li><a href="../fr494660/index.html">Tutoriel CSS Houdini</a></li>
<li><a href="../fr494662/index.html">Notre espace - est-il si mauvais?</a></li>
<li><a href="../fr494664/index.html">Comment la mise en œuvre des processus de sécurité facilite la transition vers le travail à distance</a></li>
<li><a href="../fr494666/index.html">Finds of a audio man: où écouter de la musique d'époques révolues</a></li>
<li><a href="../fr494668/index.html">Puissants décorateurs de typographie - comment ils fonctionnent, dans quoi ils sont compilés et pour quelles tâches d'application sont applicables</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>