<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍓 ⌚️ 🧑🏿‍🤝‍🧑🏻 OpenAPI v3（別名Swagger 3）からTypeScriptだけでなく、TypeScriptへのコード生成 🌷 🚑 ⛸️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="2年前、開発を始めました もう一つOpenAPI仕様 v3からTypeScriptへの無料のコードジェネレーター（Githubから入手できます）。最初に、oneOf / anyOf / allOfなどのさまざまなJSONスキーマ機能を考慮して、TypeScriptでプリミティブデータ型と複雑なデータ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>OpenAPI v3（別名Swagger 3）からTypeScriptだけでなく、TypeScriptへのコード生成</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483628/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2年前、開発を始めました </font></font><del><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">もう一つ</font></font></del><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenAPI仕様</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> v3からTypeScriptへの</font><font style="vertical-align: inherit;">無料のコードジェネレーター</font><font style="vertical-align: inherit;">（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Githubから入手できます</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。最初に、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">oneOf / anyOf / allOf</font></a><font style="vertical-align: inherit;">などの</font><font style="vertical-align: inherit;">さまざまな</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSONスキーマ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機能を考慮して、TypeScriptでプリミティブデータ型と複雑なデータ型を効率的に生成することを</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目指しました</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 （</font><font style="vertical-align: inherit;">Swaggerの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネイティブソリューションに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、これに関するいくつかの問題がありました）。もう1つのアイデアは、仕様のスキーマを使用して、システムの前面、背面、およびその他の部分の検証を行うことでした。</font></font></p><br>
<p><img src="https://habrastorage.org/webt/hz/cd/u4/hzcdu47rcjbutgqbe6pdb2k46x8.png"></p><a name="habracut"></a><br>
<p>    —     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">MVP</a>.      ,       ,       - (   Angular).             ,    TypeScript  OpenAPI v3. ,       ,      .     ,    ,     ,      .</p><br>
<h2 id="soderzhanie"></h2><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">     </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   OAS-</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">     REST API</a><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  ?</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a></li>
</ol></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
</ol><br>
<a name="Foreword"></a><br>
<h2 id="predystoriya"></h2><br>
<div class="spoiler"><b class="spoiler_title">,   ( )</b><div class="spoiler_text"><p>     —     ,  Data Mining      ( , TypeScript + Angular).           (30  )     -  .  ,       .        ,          .  ,    ,   OpenAPI   .     ,         ,      ,    Core-,      -.  OpenAPI   “ ” —     v3.0</p><br>
<p>          YML/JSON-,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>,    , ,   ,     DDD- .       ,      OAS-    .     work flow,      Design-First.</p><br>
<blockquote>   .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>,     Design First</blockquote><p>Design First      ,      —   .          (  — ) .     :  ,     REST  .. -       ;         .    ,     —  .   OAS-    ,     .      .</p><br>
<p>      ,     ,     .   REST API   ,     “Design First”  ;      .   ,      ,      —    “”   .       ;     - .</p><br>
<p>  .   : OAS  3.0,   , ,    ,     —    (,     ),       : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> Swagger</a>   Microsoft (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>).    OAS 3.0    .      2.x,     .  ,    Microsoft           Swagger 2.0.   Swagger ,  -    $ref-    “ERROR!”,        .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>. ,    ,     -  — ,    ,       ,   (  ).   ,  JAR-  NPM- CI/CD  :    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>,  , , 13 ,  -   .  ,         .</p><br>
<p>       .      -,           REST API   .      :  -   —     REST-   .  ,     ,   .   ,           ,        .  ,      :  ,  .      ,     .  ,   ,   “”       .           ,   -   .</p><br>
<p>         - ,      .           ,          .     “”   ,       .</p><br>
<p>  ,    ,      . , -,    .   ,  /    ;       .   -    ,    Redoc/Swagger :     ,  ,      .   “”   ,    ,   (   —       )      (    ).</p><br>
<blockquote>   ,           : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">playground</a>,  ,  .      .</blockquote></div></div><br>
<a name="Description"></a><br>
<h2 id="opisanie"></h2><br>
<p>  ,        NPM-,    <code>@codegena</code>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">-</a>:</p><br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>@codegena/oapi3ts</td>
<td>  —   OAS3     (   TypeScript)</td>
</tr>
<tr>
<td>@codegena/ng-api-service</td>
<td>  Angular-</td>
</tr>
<tr>
<td>@codegena/oapi3ts-cli</td>
<td>     CLI-</td>
</tr>
</tbody>
</table></div><br>
<a name="SetupAndUsing"></a><br>
<h3 id="ustanovka-i-ispolzovanie">  </h3><br>
<p>   —   NodeJS-,   CLI.     :</p><br>
<pre><code class="plaintext hljs">npm i @codegena/oapi3ts, @codegena/ng-api-service, @codegena/oapi3ts-cli</code></pre><br>
<p>,  js- (, <code>update-typings.js</code>)  :</p><br>
<pre><code class="javascript hljs"><span class="hljs-meta">"use strict"</span>;<font></font>
<font></font>
<span class="hljs-keyword">var</span> cliLib = <span class="hljs-built_in">require</span>(<span class="hljs-string">'@codegena/oapi3ts-cli'</span>);
<span class="hljs-keyword">var</span> cliApp = <span class="hljs-keyword">new</span> cliLib.CliApplication;<font></font>
<font></font>
cliApp.createTypings();<font></font>
<span class="hljs-comment">// cliApp.createServices('angular'); // optional</span></code></pre><br>
<p>  ,   :</p><br>
<pre><code class="plaintext hljs">node ./update-typings.js --srcPath ./specs/todo-app-spec.json --destPath ./src/lib --separatedFiles true</code></pre><br>
<p> <code>destPath</code>    , ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a>       . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a>,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>    NPM-. ,         ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Playground</a>.</p><br>
<a name="CodegenerationUsingPractice"></a><br>
<h2 id="praktika-ispolzovanie-kodogeneratora">  </h2><br>
<p>     ,     :   ,    .     -.     :  (  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">NestJS</a>)   ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Angular</a>).  ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a>.</p><br>
<blockquote>      Angular / NestJS,     :  ,   ,     TypeScript-.</blockquote><p>    (,     ,    ),      data flow     ,    .     80-85%,  “”  ,      ,   .</p><br>
<a name="UsingGeneratedDataTypes"></a><br>
<h2 id="ispolzovanie-generiruemyh-tipov-dannyh-v-prilozheniyah">     </h2><br>
<p>,    OpenAPI- (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>),    . ,   -  ,   ,   ,       — .       ,     .      ,     .        ,     ;    ,  IDE /   .</p><br>
<p>        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">components.schems</a>.    ,      ,    —     .  :</p><br>
<pre><code class="javascript hljs">@Controller(<span class="hljs-string">'group'</span>)
<span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppController</span> </span>{<font></font>
<font></font>
    <span class="hljs-comment">// ...</span><font></font>
<font></font>
    @Put(<span class="hljs-string">':groupId'</span>)<font></font>
    rewriteGroup(<font></font>
        @Param(ParseQueryPipe) { groupId }: RewriteGroupParameters,<font></font>
        @Body() body: RewriteGroupRequest,<font></font>
        @Session() session<font></font>
    ): RewriteGroupResponse&lt;HttpStatus.OK&gt; {<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.appService<font></font>
            .setSession(session)<font></font>
            .rewriteGroup(groupId, body);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// ...</span>
}</code></pre><br>
<p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>   NestJS,     (<code>RewriteGroupParameters</code>),   (<code>RewriteGroupRequest</code>)    (<code>RewriteGroupResponse&lt;T&gt;</code>).          :</p><br>
<ul>
<li>      <code>groupId</code>,    <code>groupUid</code>,      .<br>
<img src="https://habrastorage.org/webt/1z/2q/0c/1z2q0cstw2lv3vncwmgi8gkxfa0.png"></li>
<li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">this.appService.rewriteGroup(groupId, body)</a>   ,       <code>body</code>.             ,     .  , ,         ,   <code>RewriteGroupRequest</code>,    ,     . ,      ,    <code>ToDoGroup</code>  <code>ToDoGroupBlank</code>, IDE      :<br>
<img src="https://habrastorage.org/webt/wo/cq/rr/wocqrrks2gtcthaq_wghrhlbbta.png"></li>
<li> ,       .        ,   <code>202</code>  <code>200</code>,     ,   <code>RewriteGroupResponse</code> — <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">    </a>:<br>
<img src="https://habrastorage.org/webt/pt/io/ss/ptiossjjfhihchrlwdlydrrkft4.png"></li>
</ul><br>
<p>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  -</a>,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> API-</a>:</p><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-title">initSelectedGroupData</span><span class="hljs-params">(truth: ComponentTruth)</span>: Observable&lt;ComponentTruth&gt; </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getGroupsService.request(<span class="hljs-keyword">null</span>, {<font></font>
        isComplete: <span class="hljs-keyword">null</span>,<font></font>
        withItems: <span class="hljs-keyword">false</span><font></font>
    }).pipe(<font></font>
        pickResponseBody&lt;GetGroupsResponse&lt;<span class="hljs-number">200</span>&gt;&gt;(<span class="hljs-number">200</span>, <span class="hljs-keyword">null</span>, <span class="hljs-keyword">true</span>),<font></font>
        switchMap&lt;ToDoGroup[], Observable&lt;ComponentTruth&gt;&gt;(<font></font>
            groups =&gt; <span class="hljs-keyword">this</span>.loadItemsOfSelectedGroups({<font></font>
                ...truth,<font></font>
                groups<font></font>
            })<font></font>
        )<font></font>
    );<font></font>
}</code></pre><br>
<p>       RxJS- <code>pickResponseBody</code>,       <code>GetGroupsResponse</code>.      RxJS-,         <code>ToDoGroup[]</code>.    ,       .       ,         API —      :</p><br>
<p><img src="https://habrastorage.org/webt/ci/hr/7c/cihr7csbo5kqn9fqkreoij7kuxk.png"></p><br>
<p>  ,   <code>this.getGroupsService.request</code>  .      .</p><br>
<blockquote>     ,   ,          — ,   ..        -    -,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>   .         ,     ,   OAS-,        .</blockquote><br>
<a name="DecompositionInOAS"></a><br>
<h2 id="dekompoziciya-shem-vnutri-oas-specifikacii">   OAS-</h2><br>
<p>,         <code>ToDoGroupBlank</code>, <code>ToDoGroup</code>,    <code>RewriteGroupResponse</code>  <code>GetGroupsResponse</code>. , <code>RewriteGroupResponse</code> —  - -  <code>ToDoGroup</code>, <code>HttpErrorBadRequest</code>  ..  ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">ToDoGroup</a>,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">HttpErrorBadRequest</a> —      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">components.schems</a>,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> “rewriteGroup”</a> (   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>):</p><br>
<pre><code class="json hljs"><span class="hljs-string">"responses"</span>: {
  <span class="hljs-attr">"200"</span>: {
    <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Todo group saved"</span>,
    <span class="hljs-attr">"content"</span>: {
      <span class="hljs-attr">"application/json"</span>: {
        <span class="hljs-attr">"schema"</span>: {
          <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#/components/schemas/ToDoGroup"</span><font></font>
        }<font></font>
      }<font></font>
    }<font></font>
  },<font></font>
  <span class="hljs-attr">"400"</span>: {
    <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#/components/responses/errorBadRequest"</span><font></font>
  },<font></font>
  <span class="hljs-attr">"404"</span>: {
    <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#/components/responses/errorGroupNotFound"</span><font></font>
  },<font></font>
  <span class="hljs-attr">"409"</span>: {
    <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#/components/responses/errorConflict"</span><font></font>
  },<font></font>
  <span class="hljs-attr">"500"</span>: {
    <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#/components/responses/errorServer"</span><font></font>
  }<font></font>
}<font></font>
</code></pre><br>
<p>    ,     ,      . ,   ,    :     (   ),      JSON Schema.     ,         .          OpenAPI,      .</p><br>
<blockquote>    OAS-    DDD-   .     ,     ,    .              .</blockquote><p>   —   ,    —  .        , ..           .       :</p><br>
<ul>
<li>    ,    ,       —  .</li>
<li>     ,     :    .</li>
</ul><br>
<p>,      ,     : ,     ,  ,     .   ,    UID,  ,   ..,       .     (<code>ToDoTaskBlank</code>  <code>ToDoTask</code>)  ,     :</p><br>
<pre><code class="json hljs"><span class="hljs-string">"components"</span>: {
  <span class="hljs-attr">"ToDoTaskBlank"</span>: {
    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Base part of data of item in todo's group"</span>,
    <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Data about group item needed for creation of it"</span>,
    <span class="hljs-attr">"properties"</span>: {
      <span class="hljs-attr">"groupUid"</span>: {
        <span class="hljs-attr">"description"</span>: <span class="hljs-string">"An unique id of group that item belongs to"</span>,
        <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#/components/schemas/Uid"</span><font></font>
      },<font></font>
      <span class="hljs-attr">"title"</span>: {
        <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Short brief of task to be done"</span>,
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
        <span class="hljs-attr">"minLength"</span>: <span class="hljs-number">3</span>,
        <span class="hljs-attr">"maxLength"</span>: <span class="hljs-number">64</span><font></font>
      },<font></font>
      <span class="hljs-attr">"description"</span>: {
        <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Detailed description and context of the task. Allowed using of Common Markdown."</span>,
        <span class="hljs-attr">"type"</span>: [<span class="hljs-string">"string"</span>, <span class="hljs-string">"null"</span>],
        <span class="hljs-attr">"minLength"</span>: <span class="hljs-number">10</span>,
        <span class="hljs-attr">"maxLength"</span>: <span class="hljs-number">1024</span><font></font>
      },<font></font>
      <span class="hljs-attr">"isDone"</span>: {
        <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Status of task: is done or not"</span>,
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"boolean"</span>,
        <span class="hljs-attr">"default"</span>: <span class="hljs-string">"false"</span>,
        <span class="hljs-attr">"example"</span>: <span class="hljs-literal">false</span><font></font>
      },<font></font>
      <span class="hljs-attr">"position"</span>: {
        <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Position of a task in group. Allows to track changing of state of a concrete item, including changing od position."</span>,
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"number"</span>,
        <span class="hljs-attr">"min"</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">"max"</span>: <span class="hljs-number">4096</span>,
        <span class="hljs-attr">"example"</span>: <span class="hljs-number">0</span><font></font>
      },<font></font>
      <span class="hljs-attr">"attachments"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"array"</span>,
        <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Any material attached to the task: may be screenshots, photos, pdf- or doc- documents on something else"</span>,
        <span class="hljs-attr">"items"</span>: {
          <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#/components/schemas/AttachmentMeta"</span><font></font>
        },<font></font>
        <span class="hljs-attr">"maxItems"</span>: <span class="hljs-number">16</span>,
        <span class="hljs-attr">"example"</span>: []<font></font>
      }<font></font>
    },<font></font>
    <span class="hljs-attr">"required"</span>: [
      <span class="hljs-string">"isDone"</span>,
      <span class="hljs-string">"title"</span><font></font>
    ],<font></font>
    <span class="hljs-attr">"example"</span>: {
      <span class="hljs-attr">"isDone"</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Book soccer field"</span>,
      <span class="hljs-attr">"description"</span>: <span class="hljs-string">"The complainant agreed and recruited more members to play soccer."</span><font></font>
    }<font></font>
  },<font></font>
  <span class="hljs-attr">"ToDoTask"</span>: {
    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Item in todo's group"</span>,
    <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Describe data structure of an item in group of tasks"</span>,
    <span class="hljs-attr">"allOf"</span>: [<font></font>
      {<font></font>
        <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#/components/schemas/ToDoTaskBlank"</span><font></font>
      },<font></font>
      {<font></font>
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
        <span class="hljs-attr">"properties"</span>: {
          <span class="hljs-attr">"uid"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"An unique id of task"</span>,
            <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#/components/schemas/Uid"</span>,
            <span class="hljs-attr">"readOnly"</span>: <span class="hljs-literal">true</span><font></font>
          },<font></font>
          <span class="hljs-attr">"dateCreated"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Date/time (ISO) when task was created"</span>,
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
            <span class="hljs-attr">"format"</span>: <span class="hljs-string">"date-time"</span>,
            <span class="hljs-attr">"readOnly"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">"example"</span>: <span class="hljs-string">"2019-11-17T11:20:51.555Z"</span><font></font>
          },<font></font>
          <span class="hljs-attr">"dateChanged"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Date/time (ISO) when task was changed last time"</span>,
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
            <span class="hljs-attr">"format"</span>: <span class="hljs-string">"date-time"</span>,
            <span class="hljs-attr">"readOnly"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">"example"</span>: <span class="hljs-string">"2019-11-17T11:20:51.555Z"</span><font></font>
          }<font></font>
        },<font></font>
        <span class="hljs-attr">"required"</span>: [
          <span class="hljs-string">"dateChanged"</span>,
          <span class="hljs-string">"dateCreated"</span>,
          <span class="hljs-string">"position"</span>,
          <span class="hljs-string">"uid"</span><font></font>
        ]<font></font>
      }<font></font>
    ]<font></font>
  }<font></font>
}</code></pre><br>
<p>     TypeScript-,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>:</p><br>
<pre><code class="java hljs"><span class="hljs-comment">/**
 * ## Base part of data of item in todo's group
 * Data about group item needed for creation of it
 */</span>
export <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ToDoTaskBlank</span> </span>{
  <span class="hljs-comment">// ... imagine there are ToDoTaskBlank properties</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/**
 * ## Item in todo's group
 * Describe data structure of an item in group of tasks
 */</span>
export <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ToDoTask</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ToDoTaskBlank</span> </span>{
  <span class="hljs-comment">/**
   * ## UID of element
   * An unique id of task
   */</span><font></font>
  readonly uid: string;<font></font>
  <span class="hljs-comment">/**
   * Date/time (ISO) when task was created
   */</span><font></font>
  readonly dateCreated: string;<font></font>
  <span class="hljs-comment">/**
   * Date/time (ISO) when task was changed last time
   */</span><font></font>
  readonly dateChanged: string;<font></font>
<font></font>
  <span class="hljs-comment">// ... imagine there are ToDoTaskBlank properties</span>
}</code></pre><br>
<p>       ,      <strong>   </strong> ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">-</a>:</p><br>
<pre><code class="java hljs"><span class="hljs-keyword">import</span> {<font></font>
    ToDoTask,<font></font>
    ToDoTaskBlank,<font></font>
} from <span class="hljs-string">'@our-npm-scope/our-generated-lib'</span>;<font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ToDoTaskTeaser</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ToDoTask</span> </span>{<font></font>
    isInvalid?: <span class="hljs-keyword">boolean</span>;<font></font>
<font></font>
    <span class="hljs-comment">/**
     * Means this task just created, has temporary uid
     * and not saved yet.
     */</span>
    isJustCreated?: <span class="hljs-keyword">boolean</span>;<font></font>
<font></font>
    <span class="hljs-comment">/**
     * Means this task is saving now.
     */</span>
    isPending?: <span class="hljs-keyword">boolean</span>;<font></font>
<font></font>
    <span class="hljs-comment">/**
     * Previous uid of task temporary assigned until
     * it gets saved and gets new UID from backend.
     */</span><font></font>
    prevTempUid?: string;<font></font>
}</code></pre><br>
<p>      ,   <code>ToDoTask</code>  ,       -.  , -,         .       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>  -   DTO:</p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">downgradeTeaserToTask</span>(<span class="hljs-params">
    taskTeaser: ToDoTaskTeaser
</span>): <span class="hljs-title">ToDoTask</span> </span>{
    <span class="hljs-keyword">const</span> task = { ...taskTeaser };<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (!task.description || !task.description.trim()) {
        <span class="hljs-keyword">delete</span> task.description;<font></font>
    } <span class="hljs-keyword">else</span> {<font></font>
        task.description = task.description.trim();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">delete</span> task.isJustCreated;
    <span class="hljs-keyword">delete</span> task.isPending;
    <span class="hljs-keyword">delete</span> task.prevTempUid;<font></font>
<font></font>
    <span class="hljs-keyword">return</span> task;<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">downgradeTeaserToTaskBlank</span>(<span class="hljs-params">
    taskTeaser: ToDoTaskTeaser
</span>): <span class="hljs-title">ToDoTaskBlank</span> </span>{
    <span class="hljs-keyword">const</span> task = downgradeTeaserToTask(taskTeaser) <span class="hljs-keyword">as</span> any;<font></font>
<font></font>
    <span class="hljs-keyword">delete</span> task.dateChanged;
    <span class="hljs-keyword">delete</span> task.dateCreated;
    <span class="hljs-keyword">delete</span> task.uid;<font></font>
<font></font>
    <span class="hljs-keyword">return</span> task;<font></font>
}</code></pre><br>
<div class="spoiler"><b class="spoiler_title">-          </b><div class="spoiler_text"><pre><code class="java hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ToDoTaskTeaser</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ToDoTask</span> </span>{<font></font>
<font></font>
    <span class="hljs-comment">// … imagine, definitions from ToDoTask are here</span><font></font>
<font></font>
    constructor(<font></font>
        task: ToDoTask,<font></font>
        <span class="hljs-keyword">public</span> isInvalid?: <span class="hljs-keyword">boolean</span>,
        <span class="hljs-keyword">public</span> isJustCreated?: <span class="hljs-keyword">boolean</span>,
        <span class="hljs-keyword">public</span> isPending?: <span class="hljs-keyword">boolean</span>,
        <span class="hljs-keyword">public</span> prevTempUid?: string<font></font>
    ) {<font></font>
        Object.assign(<span class="hljs-keyword">this</span>, task);<font></font>
    }<font></font>
<font></font>
    downgradeTeaserToTask(): ToDoTask {<font></font>
        <span class="hljs-keyword">const</span> task = {...<span class="hljs-keyword">this</span>};<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!task.description || !task.description.trim()) {<font></font>
            delete task.description;<font></font>
        } <span class="hljs-keyword">else</span> {<font></font>
            task.description = task.description.trim();<font></font>
        }<font></font>
<font></font>
        delete task.isJustCreated;<font></font>
        delete task.isPending;<font></font>
        delete task.prevTempUid;<font></font>
<font></font>
        <span class="hljs-keyword">return</span> task;<font></font>
    }<font></font>
<font></font>
    downgradeTeaserToTaskBlank(): ToDoTaskBlank {<font></font>
        <span class="hljs-comment">// … some code</span><font></font>
    }<font></font>
}</code></pre></div></div><br>
<p>   ,   ,      .   ,    ,              . ,    -  <code>uid</code>  <code>ToDoTask</code>  ,       ,  :</p><br>
<p><img src="https://habrastorage.org/webt/cc/7g/yz/cc7gyzy0tc4oh5zpomvjy09endw.png"></p><br>
<a name="NestedDecomposition"></a><br>
<h2 id="vlozhennaya-dekompoziciya"> </h2><br>
<p>,      <code>ToDoTask</code>,      .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">ToDoTaskGroup</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">ToDoTaskGroupBlank</a>,          <code>ToDoTask</code>  <code>ToDoTaskBlank</code>, .    “ ”   ,    :       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">ToDoGroupExtendedData</a>.     ,        :</p><br>
<pre><code class="plaintext hljs">"ToDoGroup": {<font></font>
  "allOf": [<font></font>
    {<font></font>
      "$ref": "#/components/schemas/ToDoGroupBlank"<font></font>
    },<font></font>
    {<font></font>
      "$ref": "#/components/schemas/ToDoGroupExtendedData"<font></font>
    }<font></font>
  ]<font></font>
}</code></pre><br>
<p>   ,     TypeScript-:</p><br>
<pre><code class="java hljs">export type ToDoGroup = ToDoGroupBlank &amp; <span class="hljs-comment">// Data needed for group creation</span>
 ToDoGroupExtendedData; <span class="hljs-comment">// Extended data has to be obtained after first save</span></code></pre><br>
<p>  <code>ToDoGroup</code>   “”,       . ,       () ,        (    ).    ,   <code>items</code>  <code>ToDoGroupBlank</code>    <code>ToDoTaskBlank</code>,    <code>ToDoGroupBlank</code>  <code>ToDoTask</code>.  ,          JSON Schema  TypeScipt.</p><br>
<pre><code class="java hljs"><span class="hljs-comment">/* tslint:disable */</span>
<span class="hljs-keyword">import</span> { ToDoTaskBlank } from <span class="hljs-string">'./to-do-task-blank'</span>;<font></font>
<font></font>
<span class="hljs-comment">/**
* ## Base part of data of group
* Data needed for group creation
*/</span>
export <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ToDoGroupBlank</span> </span>{
 <span class="hljs-comment">// ...</span><font></font>
 items?: Array&lt;ToDoTaskBlank&gt;;<font></font>
 <span class="hljs-comment">// ...</span>
}</code></pre><br>
<pre><code class="java hljs"><span class="hljs-comment">/* tslint:disable */</span>
<span class="hljs-keyword">import</span> { ToDoTask } from <span class="hljs-string">'./to-do-task'</span>;<font></font>
<font></font>
<span class="hljs-comment">/**
* ## Extended data of group
* Extended data has to be obtained after first save
*/</span>
export <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ToDoGroupExtendedData</span> </span>{
 <span class="hljs-comment">// ...</span><font></font>
 items: Array&lt;ToDoTask&gt;;<font></font>
}<font></font>
</code></pre><br>
<p>  ,  <code>ToDoTask</code> / <code>ToDoTaskBlank</code>     . ,     ,   <code>attachments</code>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">AttachmentMeta</a>.      :</p><br>
<pre><code class="java hljs"><span class="hljs-string">"AttachmentMeta"</span>: {
 <span class="hljs-string">"description"</span>: <span class="hljs-string">"Common meta data model of any type of attachment"</span>,
 <span class="hljs-string">"oneOf"</span>: [<font></font>
   {<span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#/components/schemas/AttachmentMetaImage"</span>},<font></font>
   {<span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#/components/schemas/AttachmentMetaDocument"</span>},<font></font>
   {<span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#/components/schemas/ExternalResource"</span>}<font></font>
 ]<font></font>
}</code></pre><br>
<p> ,      . ,     ,        ,    ,      :</p><br>
<pre><code class="java hljs"><span class="hljs-comment">/**
 * Any material attached to the task: may be screenshots, photos, pdf- or doc-
 * documents on something else
 */</span><font></font>
attachments?: Array&lt;<font></font>
  | AttachmentMetaImage <span class="hljs-comment">// Meta data of image attached to task</span>
  | AttachmentMetaDocument <span class="hljs-comment">// Meta data of document attached to task</span>
  | string <span class="hljs-comment">// Link to any external resource</span>
&gt;;</code></pre><br>
<p> ,   <code>AttachmentMetaImage</code>  <code>AttachmentMetaDocument</code>   ,      :</p><br>
<pre><code class="java hljs"><span class="hljs-keyword">import</span> { AttachmentMetaDocument } from <span class="hljs-string">'./attachment-meta-document'</span>;
<span class="hljs-keyword">import</span> { AttachmentMetaImage } from <span class="hljs-string">'./attachment-meta-image'</span>;</code></pre><br>
<p>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">AttachmentMetaImage</a>          <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">ImageOptions</a>,   ,   ,    (   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">additionalProperties</a>):</p><br>
<pre><code class="java hljs"><span class="hljs-comment">/* tslint:disable */</span>
<span class="hljs-keyword">import</span> { ImageOptions } from <span class="hljs-string">'./image-options'</span>;<font></font>
<font></font>
<span class="hljs-comment">/**
 * Meta data of image attached to task
 */</span>
export <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">AttachmentMetaImage</span> </span>{<font></font>
<font></font>
  <span class="hljs-comment">// ...</span><font></font>
<font></font>
  <span class="hljs-comment">/**
   * Possible thumbnails of uploaded image
   */</span><font></font>
  thumbs?: {<font></font>
    [key: string]: {<font></font>
      <span class="hljs-comment">/**
       * Link to any external resource
       */</span><font></font>
      url?: string;<font></font>
      imageOptions?: ImageOptions;<font></font>
    };<font></font>
  };<font></font>
<font></font>
  <span class="hljs-comment">// ...</span><font></font>
<font></font>
  imageOptions: ImageOptions;<font></font>
}</code></pre><br>
<p>     <code>ToDoTask</code>  <code>ToDoGroup</code>,               -,         -,     . ,        .     OpenAPI,         ,   .</p><br>
<a name="ServiceGeneration"></a><br>
<h2 id="avtogeneraciya-servisov-dlya-raboty-s-rest-api">     REST API</h2><br>
<a name="WhyItNeccessary"></a><br>
<h3 id="zachem-eto-nuzhno">  ?</h3><br>
<p>   - -,   -  REST API,         (  )    API.     :</p><br>
<ul>
<li> URL  </li>
<li> ,   </li>
<li>     </li>
</ul><br>
<p> ,             .     —    ,     API:</p><br>
<div class="spoiler"><b class="spoiler_title">-    REST API</b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-keyword">import</span> _ <span class="hljs-keyword">from</span> <span class="hljs-string">'lodash'</span>;
<span class="hljs-keyword">import</span> { Observable, fromFetch, throwError } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs'</span>;
<span class="hljs-keyword">import</span> { switchMap } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs/operators'</span>;<font></font>
<font></font>
<span class="hljs-comment">// Definitions</span><font></font>
<font></font>
<span class="hljs-keyword">const</span> URLS = {
    <span class="hljs-string">'getTasksOfGroup'</span>: <span class="hljs-string">`<span class="hljs-subst">${env.REST_API_BASE_URL}</span>/tasks/\${groupId}`</span>,
    <span class="hljs-comment">// ... other urls ...</span><font></font>
};<font></font>
<span class="hljs-keyword">const</span> URL_TEMPLATES = _.mapValues(urls, url =&gt; _.template(url));<font></font>
<font></font>
interface GetTaskConditions {<font></font>
    isDone?: <span class="hljs-literal">true</span> | <span class="hljs-literal">false</span>;<font></font>
    offset?: number;<font></font>
    limit?: number;<font></font>
}<font></font>
<font></font>
interface ErrorReponse {<font></font>
    <span class="hljs-attr">error</span>: boolean;<font></font>
    message?: string;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">// Helpers</span><font></font>
<font></font>
<span class="hljs-comment">// I taken this snippet from StackOverflow only for example</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encodeData</span>(<span class="hljs-params">data</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.keys(data).map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key</span>) </span>{
        <span class="hljs-keyword">return</span> [key, data[key]].map(<span class="hljs-built_in">encodeURIComponent</span>).join(<span class="hljs-string">"="</span>);<font></font>
    }).join(<span class="hljs-string">"&amp;"</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">// REST API functions</span><font></font>
<font></font>
<span class="hljs-comment">// our REST API working function example</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTasksFromServer</span>(<span class="hljs-params">groupUid: string, conditions: GetTaskConditions = {}</span>): <span class="hljs-title">Observable</span>&lt;<span class="hljs-title">Response</span>&gt; </span>{
    <span class="hljs-keyword">if</span> (!groupUid) {
        <span class="hljs-keyword">return</span> throwError(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'You should specify "groupUid"!'</span>));<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (!_.isString(groupUid)) {
        <span class="hljs-keyword">return</span> throwError(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'`groupUid` should be string!'</span>));<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_.isBoolean(conditions.isDone)) {
        <span class="hljs-comment">// ... applying of conditions.isDone</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (conditions.isDone !== <span class="hljs-literal">undefined</span>) {
        <span class="hljs-keyword">return</span> throwError(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'`isDone` should be "true", "false" or should\'t be set!'</span>!));<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (offset) {
        <span class="hljs-comment">// ... check of `offset` and applying or error throwing</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (limit) {
        <span class="hljs-comment">// ... check of `limit` and applying or error throwing</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">const</span> url = [<font></font>
        URL_TEMPLATES[<span class="hljs-string">'getTasksOfGroup'</span>]({groupUid}),<font></font>
        ...(conditions ? [encodeData(conditions)] : [])<font></font>
    ]; <font></font>
<font></font>
    <span class="hljs-keyword">return</span> fromFetch(url);<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">// Using of REST API working functions</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getRemainedTasks</span>(<span class="hljs-params">groupUid: number</span>): <span class="hljs-title">Observable</span>&lt;<span class="hljs-title">ToDoTask</span>[] | <span class="hljs-title">ErrorReponse</span>&gt; </span>{
    <span class="hljs-keyword">return</span> getTasksFromServer(groupUid, {<span class="hljs-attr">isDone</span>: <span class="hljs-literal">false</span>}).pipe(<font></font>
        switchMap(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
            <span class="hljs-keyword">if</span> (response.ok) {
                <span class="hljs-comment">// OK return data</span>
                <span class="hljs-keyword">return</span> response.json();<font></font>
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// Server is returning a status requiring the client to try something else.</span>
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">of</span>({ <span class="hljs-attr">error</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">`Error <span class="hljs-subst">${response.status}</span>`</span> });<font></font>
            }<font></font>
        }),<font></font>
        catchError(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
            <span class="hljs-comment">// Network or other error, handle appropriately</span>
            <span class="hljs-built_in">console</span>.error(err);
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">of</span>({ <span class="hljs-attr">error</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: err.message })<font></font>
        })<font></font>
    );<font></font>
}</code></pre></div></div><br>
<p>        REST —     ,   : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Axios</a>, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://angular.io/guide/">Angular HttpClient</a>,     .   ,        .  ,   :</p><br>
<ul>
<li>        ( <code>getTasksFromServer</code>  )</li>
<li> ,    ( <code>getRemainedTasks</code>)</li>
</ul><br>
<p>    ,    :   - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  5-6  </a>. , REST API   ,           .              :           ,           .</p><br>
<blockquote>        ,    (    - )     .       .     ,    ,     .   —   ,      .     ,      .</blockquote><p>   OpenAPI, ,   OAS-    , :</p><br>
<ul>
<li>   -     </li>
<li>     </li>
<li>  URL     </li>
<li>       </li>
</ul><br>
<p>        — <strong></strong>.    ,     ,     /  — 5, 10  200,            .  ,      ,   : , , , RxJS- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">pickResponseBody</a>,            ,     - ;  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">tapResponse</a>,    side-effect (tap)   HTTP-.     ,     -   .    ,       ,    .</p><br>
<blockquote>,     —   -,      .      ,       ,  ,   ""  /     API     "-"  "" .    -   ,        "" (    ),     .</blockquote><p>  ,          REST API   Angular.         ,      ,        /.      . ,      ,    .  ,      , ..      .</p><br>
<a name="HowToGenerateServices"></a><br>
<h3 id="generaciya-servisov"> </h3><br>
<p>  "<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a>"      .   Angular-,       <code>update-typings.js</code>:</p><br>
<pre><code class="javascript hljs"><span class="hljs-meta">"use strict"</span>;<font></font>
<font></font>
<span class="hljs-keyword">var</span> cliLib = <span class="hljs-built_in">require</span>(<span class="hljs-string">'@codegena/oapi3ts-cli'</span>);
<span class="hljs-keyword">var</span> cliApp = <span class="hljs-keyword">new</span> cliLib.CliApplication;<font></font>
<font></font>
cliApp.createTypings();<font></font>
cliApp.createServices(<span class="hljs-string">'angular'</span>);</code></pre><br>
<p>            ,   Angular-    API   .    , -   - ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>.     ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">RewriteGroupService</a>.    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">ApiService</a>,        ,   ,   -:</p><br>
<div class="spoiler"><b class="spoiler_title">-  </b><div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-comment">// Typings for this API method</span>
<span class="hljs-keyword">import</span> {<font></font>
  RewriteGroupParameters,<font></font>
  RewriteGroupResponse,<font></font>
  RewriteGroupRequest<font></font>
} from <span class="hljs-string">'../typings'</span>;
<span class="hljs-comment">// Schemas</span>
<span class="hljs-keyword">import</span> { schema as domainSchema } from <span class="hljs-string">'./schema.b4c655ec1635af1be28bd6'</span>;<font></font>
<font></font>
<span class="hljs-comment">/**
 * Service for angular based on ApiAgent solution.
 * Provides assured request to API method with implicit
 * validation and common errors handling scheme.
 */</span>
<span class="hljs-meta">@Injectable()</span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RewriteGroupService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ApiService</span>&lt;
  <span class="hljs-title">RewriteGroupResponse</span>,
  <span class="hljs-title">RewriteGroupRequest</span>,
  <span class="hljs-title">RewriteGroupParameters</span>
&gt; </span>{
  <span class="hljs-function"><span class="hljs-keyword">protected</span> get <span class="hljs-title">method</span><span class="hljs-params">()</span>: 'PUT' </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">'PUT'</span>;<font></font>
  }<font></font>
<font></font>
  <span class="hljs-comment">/**
   * Path template, example: `/some/path/{id}`.
   */</span>
  <span class="hljs-function"><span class="hljs-keyword">protected</span> get <span class="hljs-title">pathTemplate</span><span class="hljs-params">()</span>: string </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">'/group/{groupId}'</span>;<font></font>
  }<font></font>
<font></font>
  <span class="hljs-comment">/**
   * Parameters in a query.
   */</span>
  <span class="hljs-function"><span class="hljs-keyword">protected</span> get <span class="hljs-title">queryParams</span><span class="hljs-params">()</span>: string[] </span>{
    <span class="hljs-keyword">return</span> [<span class="hljs-string">'forceSave'</span>];<font></font>
  }<font></font>
<font></font>
  <span class="hljs-comment">// ...   </span>
}</code></pre></div></div><br>
<p>, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   JSON Schema</a>  ,   .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>,        ,       :</p><br>
<pre><code class="java hljs"><span class="hljs-keyword">import</span> { schema as domainSchema } from <span class="hljs-string">'./schema.b4c655ec1635af1be28bd6'</span>;</code></pre><br>
<blockquote>,     <code>schema.b4c655ec1635af1be28bd6.ts</code>       ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a>  ,  .</blockquote><br>
<a name="UsingOfGeneratedServices"></a><br>
<h3 id="ispolzovanie-generiruemyh-servisov">  </h3><br>
<p>      ,   Angular-.</p><br>
<div class="spoiler"><b class="spoiler_title">    Angular-</b><div class="spoiler_text"><p>     <code>ApiModule</code>       :</p><br>
<pre><code class="plaintext hljs">import {<font></font>
    ApiModule,<font></font>
    API_ERROR_HANDLER<font></font>
} from '@codegena/ng-api-service';<font></font>
<font></font>
import {<font></font>
    CreateGroupItemService,<font></font>
    GetGroupsService,<font></font>
    GetGroupItemsService,<font></font>
    UpdateFewItemsService<font></font>
} from '@codegena/todo-app-scheme';<font></font>
<font></font>
@NgModule({<font></font>
    imports: [<font></font>
        ApiModule,<font></font>
        // ...<font></font>
    ],<font></font>
    providers: [<font></font>
        RewriteGroupService,<font></font>
        {<font></font>
            provide: API_ERROR_HANDLER,<font></font>
            useClass: ApiErrorHandlerService<font></font>
        },<font></font>
        // ...<font></font>
    ],<font></font>
    // ...<font></font>
})<font></font>
export class TodoAppModule { }</code></pre></div></div><br>
<p>   ,     [])(<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">https://angular.io/guide/dependency-injection</a>):</p><br>
<pre><code class="plaintext hljs">@Injectable()<font></font>
export class TodoTasksStore {<font></font>
<font></font>
    constructor(<font></font>
        protected createGroupItemService: CreateGroupItemService,<font></font>
        protected getGroupsService: GetGroupsService,<font></font>
        protected getGroupItemsService: GetGroupItemsService,<font></font>
        protected updateFewItemsService: UpdateFewItemsService<font></font>
    ) {}<font></font>
}</code></pre><br>
<p>        —  ,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">request</a>,        :</p><br>
<pre><code class="plaintext hljs">return this.getGroupsService.request(null, {<font></font>
    isComplete: null,<font></font>
    withItems: false<font></font>
}).pipe(<font></font>
    pickResponseBody&lt;GetGroupsResponse&lt;200&gt;&gt;(200, null, true),<font></font>
    switchMap&lt;ToDoGroup[], Observable&lt;ComponentTruth&gt;&gt;(<font></font>
        groups =&gt; this.loadItemsOfSelectedGroups({<font></font>
            ...truth,<font></font>
            groups<font></font>
        })<font></font>
    )<font></font>
);</code></pre><br>
<p> <code>request</code>   <code>Observable&lt;HttpResponse&lt;R&gt; | HttpEvent&lt;R&gt;&gt;</code>,   ,        . ,     ,      . ,  ,      ,     .     RxJS- <code>pickResponseBody</code>.</p><br>
<p> ,    ,    ,   .         API,    .        .   ,     :</p><br>
<p><img src="https://habrastorage.org/webt/3y/xe/dy/3yxedy51z7su99butzrk2dvunnq.png"></p><br>
<p>     .   JSON Schema     .       ,   ""      - .   ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Sentry</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Kibana</a>,   .       .  ,      ,      .</p><br>
<blockquote> ,             .  ,      :)</blockquote><br>
<a name="AfterWord"></a><br>
<h2 id="vmesto-poslesloviya"> </h2><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結局この記事はくしゃくしゃになったような気がします。</font><font style="vertical-align: inherit;">しかし、私は自分のタイムボックスを超えており、永遠の歌からの「言うのは難しい」とは言えないのですが、これは私のことです。</font><font style="vertical-align: inherit;">それでも、写真を撮るのに十分だと私は思った。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードジェネレータ自体については-その将来の運命は不確実であり、そのための計画/野心はありません（そしてそれは不可能です）。</font><font style="vertical-align: inherit;">今、私はフィードバックを得たいと思っています-非常に興味深いでしょう。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">読んでくれてありがとう。</font></font></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja483614/index.html">ロボット工学クラブでの盗難と戦う方法</a></li>
<li><a href="../ja483616/index.html">Lacmusプロジェクト：コンピュータービジョンが失われた人々を救う方法</a></li>
<li><a href="../ja483618/index.html">WIMPインターフェイスとは何ですか？なぜそれがまだ残っているのですか？</a></li>
<li><a href="../ja483624/index.html">Yandex.Taxiとの競争：プログラミング選手権のバックエンドトラックの分析</a></li>
<li><a href="../ja483626/index.html">Jsonnetで100 gitlabジョブを100行で説明する方法</a></li>
<li><a href="../ja483630/index.html">エンバータイムズ-130号</a></li>
<li><a href="../ja483634/index.html">CSSの最小と最大の幅/高さのプロパティ</a></li>
<li><a href="../ja483646/index.html">ハックザボックス-Bitlabウォークスルー。弱いJS難読化、GIT、および逆Windowsアプリケーション</a></li>
<li><a href="../ja483648/index.html">ジョージア州のITビジネスのオフショア：ライフハックと落とし穴</a></li>
<li><a href="../ja483650/index.html">赤道に近いコスモドローム-ウェンチャントロピカルコスモドローム</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>