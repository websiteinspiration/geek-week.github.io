<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👰🏻 👨‍🍳 👩🏾‍🍳 Schreiben eines einfachen WYSIWYG-Editors mit ProseMirror 👩🏻‍🚀 👨‍🚀 🎡</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Als Sports.ru einen eigenen WYSIWYG- Editor benötigte, haben wir beschlossen, ihn auf der Grundlage der ProseMirror-Bibliothek zu erstellen. Eines der...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Schreiben eines einfachen WYSIWYG-Editors mit ProseMirror</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/sports_ru/blog/491902/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Als Sports.ru einen eigenen </font></font><abbr title="Was du siehst ist was du kriegst"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WYSIWYG-</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Editor benötigte, haben wir beschlossen, ihn auf der Grundlage der ProseMirror-Bibliothek zu erstellen. </font><font style="vertical-align: inherit;">Eines der Hauptmerkmale dieses Tools ist seine Modularität und die vielfältigen Anpassungsmöglichkeiten, sodass Sie den Editor sehr genau auf jedes Projekt zuschneiden können. </font><font style="vertical-align: inherit;">Insbesondere wird ProseMirror bereits in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der New York Times</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und im </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Guardian verwendet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">In diesem Artikel wird erläutert, wie Sie Ihren WYSIWYG-Editor mit ProseMirror schreiben.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kf/to/_b/kfto_btseokytxzu3k5jsbltebs.png" alt="Schreiben eines einfachen WYSIWYG-Editors mit ProseMirror"><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Übersicht über ProseMirror</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Autor von ProseMirror ist </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Marijn Haverbeke,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> der in der Frontend-Entwickler-Community hauptsächlich als Autor des beliebten Buches </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eloquent Javascript bekannt ist</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Zu Beginn unserer Arbeit (Herbst 2018) gab es keine Materialien zur Arbeit mit dieser Bibliothek, außer offiziellen Dokumentationen und Tutorials des Autors. Das Dokumentationspaket des Autors enthält mehrere Abschnitte, von denen die nützlichsten das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ProseMirror-Handbuch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Beschreibung der Grundkonzepte) und das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Referenzhandbuch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Bibliotheksspezifikation) sind. Im Folgenden finden Sie eine Zusammenfassung der wichtigsten Ideen aus dem ProseMirror-Handbuch.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ProseMirror speichert den Status eines Dokuments immer in seiner eigenen Datenstruktur. Und bereits aus dieser Struktur werden zur Laufzeit die entsprechenden DOM-Elemente auf der Seite generiert, mit der der Endbenutzer interagiert. Darüber hinaus speichert ProseMirror nicht nur den aktuellen Status (Status), sondern auch den Verlauf früherer Änderungen, die bei Bedarf zurückgesetzt werden können. Jede Statusänderung sollte durch Transaktionen erfolgen, die üblichen Manipulationen mit dem DOM-Baum funktionieren hier nicht direkt. Eine Transaktion ist eine Abstraktion, die die Logik einer schrittweisen Statusänderung beschreibt. Das Wesentliche ihrer Arbeit erinnert an das Senden und Ausführen von Aktionen in Bibliotheken zur Statusverwaltung, z. B. Redux und Vuex.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Bibliothek selbst basiert auf unabhängigen Modulen, die je nach Bedarf deaktiviert oder hinzugefügt werden können. </font><font style="vertical-align: inherit;">Eine Liste der Hauptmodule, von denen wir dachten, dass sie von fast allen benötigt werden:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prosemirror-Modell</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ein Dokumentmodell, das alle Komponenten eines Dokuments, ihre Eigenschaften und Aktionen beschreibt, die für sie ausgeführt werden können;</font></font><br>
 </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prosemirror-Status</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Eine Datenstruktur, die den Status des erstellten Dokuments zu einem bestimmten Zeitpunkt beschreibt, einschließlich ausgewählter Fragmente und Transaktionen für den Wechsel von einem Status in einen anderen.</font></font><br>
 </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prosemirror-Ansicht</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Präsentation des Dokuments im Browser und in den Tools, damit der Benutzer mit dem Dokument interagieren kann;</font></font><br>
 </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prosemirror-transform</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - eine Funktion zum Speichern des Transaktionsverlaufs, mit deren Hilfe Transaktionen implementiert werden und mit der Sie zu früheren Zuständen zurückkehren oder ein Dokument gemeinsam entwickeln können.</font></font><br>
 </li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zusätzlich zu diesem minimalen Satz können auch die folgenden Module nützlich sein:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prosemirror-befehle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - eine Reihe von vorgefertigten Befehlen zum Bearbeiten. </font><font style="vertical-align: inherit;">In der Regel müssen Sie selbst etwas Komplexeres oder Individuelleres schreiben, aber Marijn Haverbeke hat bereits einige Dinge für uns getan, zum Beispiel das Löschen eines ausgewählten Textfragments.</font></font><br>
 </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prosemirror-keymap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ein Modul mit zwei Methoden zum Festlegen von Tastaturkürzeln;</font></font><br>
 </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">prosemirror-history</a> –          , ..    ,    ,  ,       ;<br>
 </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">prosemirror-schema-list</a> –      ,     (      DOM-,   ,      ).<br>
 </li>
</ul><br>
<h2>   ProseMirror</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beginnen wir mit der Erstellung einer Editor-Gliederung. Das Schema in ProseMirror definiert eine Liste der Elemente in unserem Dokument und deren Eigenschaften. Jedes Element verfügt über eine toDOM-Methode, die bestimmt, wie dieses Element im DOM-Baum auf der Webseite dargestellt wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Prinzip von WYSIWYG wird genau dadurch verwirklicht, dass wir beim Erstellen des Schemas die volle Kontrolle darüber haben, wie bearbeitbarer Inhalt auf der Seite angezeigt wird, und dementsprechend können wir jedem Element eine solche HTML-Struktur geben und Stile festlegen, genau wie der anzuzeigende Inhalt. Knoten können erstellt und an Ihre Anforderungen angepasst werden. Insbesondere benötigen Sie höchstwahrscheinlich Absätze, Überschriften, Listen, Bilder, Absätze und Medien.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angenommen, jeder Absatz des Textes sollte in das Tag "p" mit der Klasse "Absatz" eingeschlossen werden, die die Regeln für Absatzstile festlegt, die für das Layout erforderlich sind. Dann könnte das ProseMirror-Schema in diesem Fall folgendermaßen aussehen:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { Schema } <span class="hljs-keyword">from</span> <span class="hljs-string">"prosemirror-model"</span>;<font></font>
<font></font>
<span class="hljs-keyword">const</span> mySchema = <span class="hljs-keyword">new</span> Schema({
    <span class="hljs-attr">nodes</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;    <span class="hljs-attr">doc</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">content</span>: <span class="hljs-string">'block'</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attr">text</span>: {},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attr">paragraph</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <span class="hljs-attr">content</span>: <span class="hljs-string">'inline'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;<span class="hljs-attr">group</span>: <span class="hljs-string">'block'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="hljs-attr">toDOM</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toDOM</span>(<span class="hljs-params">node</span>) </span>{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <span class="hljs-keyword">return</span> [<span class="hljs-string">'p'</span>, {<span class="hljs-attr">class</span>: <span class="hljs-string">'paragraph'</span>}, <span class="hljs-number">0</span>];<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  },<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  },<font></font>
    },<font></font>
});<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zuerst importieren wir den Konstruktor, um unser Schema zu erstellen, und übergeben ihm ein Objekt, das die Knoten (im Folgenden als Knoten bezeichnet) im zukünftigen Editor beschreibt. Knoten sind Abstraktionen, die die Arten von Inhalten beschreiben, die erstellt werden. Bei einem solchen Schema können sich beispielsweise nur Knoten vom Typ Text und Absatz im Editor befinden. Doc ist der Name des Knotens der obersten Ebene, der nur aus Blockelementen besteht, d. H. in diesem Fall nur aus Absätzen (weil wir andere nicht beschrieben haben). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Text sind Textknoten, ähnlich wie Text-DOM-Knoten. Mithilfe der Gruppeneigenschaft können wir unsere Knoten auf verschiedene Arten gruppieren, damit im Code leichter auf sie zugegriffen werden kann. Gruppen können auf jede für uns bequeme Weise festgelegt werden. In unserem Fall haben wir die Knoten nur in Block und Inline unterteilt. Text ist standardmäßig inline, daher kann dies explizit weggelassen werden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine ganz andere Sache ist Absatz (Absatz). </font><font style="vertical-align: inherit;">Wir haben angekündigt, dass Absätze aus Inline-Textelementen bestehen und auch eine eigene Darstellung im DOM haben. </font><font style="vertical-align: inherit;">Ein Absatz ist ein Blockelement, ungefähr in dem Sinne, wie es die DOM-Blockelemente sind. </font><font style="vertical-align: inherit;">Nach diesem Schema werden die Absätze auf der Seite im Online-Editor wie folgt dargestellt:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"paragraph"</span>&gt;</span>Content of the paragraph<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt können Sie den Editor selbst erstellen:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { EditorState } <span class="hljs-keyword">from</span> <span class="hljs-string">"prosemirror-state"</span>;
<span class="hljs-keyword">import</span> { EditorView } <span class="hljs-keyword">from</span> <span class="hljs-string">"prosemirror-view"</span>;
<span class="hljs-keyword">import</span> { Schema } <span class="hljs-keyword">from</span> <span class="hljs-string">"prosemirror-model"</span>;<font></font>
<font></font>
<span class="hljs-keyword">const</span> mySchema = <span class="hljs-keyword">new</span> Schema({
    <span class="hljs-attr">nodes</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;    <span class="hljs-attr">doc</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <span class="hljs-attr">content</span>: <span class="hljs-string">'block+'</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attr">text</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <span class="hljs-attr">group</span>: <span class="hljs-string">'inline'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attr">inline</span>: <span class="hljs-literal">true</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<span class="hljs-attr">paragraph</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attr">content</span>: <span class="hljs-string">'inline*'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attr">group</span>: <span class="hljs-string">'block'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attr">toDOM</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toDOM</span>(<span class="hljs-params">node</span>) </span>{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <span class="hljs-keyword">return</span> [<span class="hljs-string">'p'</span>, {<span class="hljs-attr">class</span>: <span class="hljs-string">'paragraph'</span>}, <span class="hljs-number">0</span>];<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;    },<font></font>
    },<font></font>
});<font></font>
<font></font>
<span class="hljs-comment">/**
 * @classdesc  
 * @param {Object} el DOM-,    
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Wysiwyg</span> </span>{
    <span class="hljs-keyword">constructor</span>(el) {
        <span class="hljs-keyword">this</span>.el = el;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
      * <span class="hljs-doctag">@description </span>    
&nbsp;    &nbsp;* <span class="hljs-doctag">@param <span class="hljs-type">{Object}</span> </span>content ,    
&nbsp;     */</span><font></font>
    setArticle(content) {<font></font>
        <span class="hljs-keyword">const</span> state = EditorState.fromJSON(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;        {<span class="hljs-attr">schema</span>: mySchema},<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;        content,<font></font>
        );<font></font>
        <span class="hljs-keyword">const</span> view = <span class="hljs-keyword">new</span> EditorView(<span class="hljs-keyword">this</span>.el, {<span class="hljs-attr">state</span>: state});<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zu Beginn importieren wir wie gewohnt alle notwendigen Konstruktoren aus den entsprechenden Modulen und verwenden das oben beschriebene Schema. Wir erstellen den Editor als Klasse mit einer Reihe notwendiger Methoden. Damit die Webseite Inhalte bearbeiten und erstellen kann, müssen Sie einen Status erstellen, den Layout und den Inhalt des Artikels verwenden und den Inhalt aus dem aktuellen Status im angegebenen Stammelement darstellen. Wir fügen diese Aktionen in die setArticle-Methode ein, außer für die bisher nichts benötigt wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gleichzeitig ist der Inhalt optional. Ist dies nicht der Fall, erhalten Sie einen leeren Editor, und der Inhalt kann bereits direkt vor Ort erstellt werden. Angenommen, wir haben eine HTML-Datei mit diesem Markup:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"editor"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um einen leeren WYSIWYG-Editor auf einer Seite zu erstellen, benötigen Sie nur wenige Zeilen in einem Skript, das auf einer Seite mit diesem Markup ausgeführt wird:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">//     </span>
<span class="hljs-keyword">import</span> Wysiwyg <span class="hljs-keyword">from</span> <span class="hljs-string">'wysiwyg'</span>;<font></font>
<font></font>
<span class="hljs-keyword">const</span> root = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'editor'</span>);
<span class="hljs-keyword">const</span> myWysiwyg = <span class="hljs-keyword">new</span> Wysiwyg(root);<font></font>
myWysiwyg.setArticle();<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit diesem Code können Sie jeden Text von Grund auf neu schreiben. </font><font style="vertical-align: inherit;">Zu diesem Zeitpunkt können Sie bereits sehen, wie ProseMirror funktioniert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn ein Benutzer in diesem Editor Text eingibt, werden Status-Transaktionen ausgeführt. </font><font style="vertical-align: inherit;">Wenn Sie beispielsweise im Editor mit dem obigen Schema den Ausdruck "Dies ist mein neuer cooler WYSIWYG-Editor" eingeben, reagiert ProseMirror auf Tastatureingaben mit dem Aufrufen der entsprechenden Transaktionen. Nach Abschluss der Eingabe sieht der Inhalt im Dokumentstatus folgendermaßen aus:</font></font><br>
<br>
<pre><code class="javascript hljs">content: [<font></font>
    {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;    <span class="hljs-attr">type</span>: <span class="hljs-string">'paragraph'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attr">value</span>: <span class="hljs-string">'    WYSIWYG-'</span>,<font></font>
    },<font></font>
]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Text, z. B. der Inhalt eines bereits zuvor erstellten Artikels, im Editor zum Bearbeiten geöffnet werden soll, muss dieser Inhalt dem zuvor erstellten Schema entsprechen. </font><font style="vertical-align: inherit;">Dann sieht der Initialisierungscode des Editors etwas anders aus:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">//     </span>
<span class="hljs-keyword">import</span> Wysiwyg <span class="hljs-keyword">from</span> <span class="hljs-string">'wysiwyg'</span>;<font></font>
<font></font>
<span class="hljs-keyword">const</span> root = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'editor'</span>);
<span class="hljs-keyword">const</span> myWysiwyg = <span class="hljs-keyword">new</span> Wysiwyg(root);
<span class="hljs-keyword">const</span> content = {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'doc'</span>,
    <span class="hljs-attr">content</span>: [<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;    {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <span class="hljs-attr">type</span>: <span class="hljs-string">'paragraph'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attr">value</span>: <span class="hljs-string">'Hello, world!'</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<span class="hljs-attr">type</span>: <span class="hljs-string">'paragraph'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attr">value</span>: <span class="hljs-string">'This is my first wysiwyg-editor'</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;}<font></font>
    ],<font></font>
};<font></font>
myWysiwyg.setArticle(content);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hurra! </font><font style="vertical-align: inherit;">Wir haben unseren ersten Editor erstellt, mit dem eine saubere Seite erstellt werden kann, um neue Inhalte zu erstellen und vorhandene zur Bearbeitung zu öffnen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was tun als nächstes mit dem Editor?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber selbst mit einem vollständigen Satz von Knoten fehlen unserem Editor wichtige Funktionen - Formatieren von Text, Absätze. Dazu muss neben den Knoten auch ein Objekt mit Formatierungseinstellungen, Markierungen, auf die Schaltung übertragen werden. Der Einfachheit halber nennen wir sie so - Marken. Um das Hinzufügen, Löschen und Formatieren all dieser Elemente zu steuern, benötigen Benutzer ein Menü. Menüs können mithilfe benutzerdefinierter Plugins hinzugefügt werden, die Menüobjekte stilisieren und die Änderung des Status eines Dokuments bei der Auswahl bestimmter Aktionen beschreiben.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit Plugins können Sie jedes Design erstellen, das die integrierten Funktionen des Editors erweitert. Die Hauptidee von Plugins ist, dass sie bestimmte Benutzeraktionen verarbeiten, um entsprechende Transaktionen zu generieren. Wenn Sie beispielsweise auf das Listensymbol im Menü klicken möchten, um eine neue leere Liste zu erstellen und den Cursor an den Anfang des ersten Elements zu bewegen, müssen Sie diese Transaktion unbedingt im entsprechenden Plugin beschreiben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Weitere </font><font style="vertical-align: inherit;">Informationen zu </font><font style="vertical-align: inherit;">Formatierungseinstellungen und Plugins finden Sie in der offiziellen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokumentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Sehr kleine nützliche </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispiele für die</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verwendung von ProseMirror-Funktionen </font><font style="vertical-align: inherit;">können sehr nützlich sein </font><font style="vertical-align: inherit;">. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie daran interessiert sind, wie wir einen neuen Editor basierend auf ProseMirror in ein vorhandenes Projekt integriert haben, haben wir in einem anderen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artikel darüber gesprochen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de491886/index.html">KnowledgeConf 2020 Online: Implementierung eines schrittweisen Wissensmanagements</a></li>
<li><a href="../de491888/index.html">GitLab CI: 6 Funktionen aus den neuesten Versionen, auf die wir gewartet haben</a></li>
<li><a href="../de491890/index.html">Laufwerksanatomie: SSD</a></li>
<li><a href="../de491896/index.html">Wie wir bei Cyan ein Produkt durch User Experience Research verbessern</a></li>
<li><a href="../de491900/index.html">Flexibilität und Automatisierung beim maschinellen Lernen</a></li>
<li><a href="../de491904/index.html">So schreiben Sie sicheren Python-Code. Mahlzeiten Kushal Das</a></li>
<li><a href="../de491916/index.html">Erstellen virtueller Umgebungen und Installieren von Bibliotheken für Python 3 in der PyCharm-IDE</a></li>
<li><a href="../de491924/index.html">PVS-Studio Analyzer Beta-Test # unter Linux und MacOS</a></li>
<li><a href="../de491926/index.html">Plattformübergreifende Entwicklung mobiler Anwendungen im Jahr 2020</a></li>
<li><a href="../de491934/index.html">Psychologische Profile von Aktieninvestoren: wie es funktioniert</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>