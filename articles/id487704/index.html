<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🈺 👩‍❤️‍💋‍👨 📹 Bagaimana kami membuat laporan dinamis di SSRS 2014 🚈 🤴🏿 🔗</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kami sudah berbicara tentang bagaimana kami membantu satu perusahaan manufaktur mengubah proses pelatihan perusahaan dan pengembangan personel. Karyaw...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Bagaimana kami membuat laporan dinamis di SSRS 2014</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/true_engineering/blog/487704/"><img src="https://habrastorage.org/webt/_q/hb/qb/_qhbqb8irkmfwui-lrqaktkhe8q.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sudah berbicara tentang</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bagaimana kami membantu satu perusahaan manufaktur mengubah proses pelatihan perusahaan dan pengembangan personel. </font><font style="vertical-align: inherit;">Karyawan pelanggan, yang tenggelam dalam dokumen kertas dan lembar kerja Excel, menerima aplikasi iPad yang nyaman dan portal web. </font><font style="vertical-align: inherit;">Salah satu fungsi terpenting dari produk ini adalah pembuatan laporan dinamis yang digunakan manajer untuk menilai pekerjaan karyawan “di lapangan”. </font><font style="vertical-align: inherit;">Ini adalah dokumen besar dengan puluhan bidang dan ukuran rata-rata 3000 * 1600 piksel.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada artikel ini, kita akan berbicara tentang bagaimana menggunakan kecantikan ini berdasarkan Layanan Pelaporan Microsoft SQL Server, mengapa backend seperti itu bisa menjadi teman yang buruk dengan portal web dan trik apa yang akan membantu untuk membangun hubungan mereka. </font><font style="vertical-align: inherit;">Seluruh bagian bisnis dari solusi telah dijelaskan dalam artikel sebelumnya, jadi di sini kami fokus pada masalah teknis. </font><font style="vertical-align: inherit;">Ayo mulai!</font></font><br>
<br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perumusan masalah</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami memiliki portal tempat beberapa ratus pengguna bekerja. </font><font style="vertical-align: inherit;">Mereka diatur dalam hierarki bertahap, di mana setiap pengguna memiliki pengawas peringkat yang lebih tinggi. </font><font style="vertical-align: inherit;">Diferensiasi hak ini diperlukan agar pengguna dapat membuat acara dengan karyawan bawahan apa pun. </font><font style="vertical-align: inherit;">Anda dapat melompati langkah, mis. </font><font style="vertical-align: inherit;">pengguna dapat memulai aktivitas dengan karyawan dari peringkat apa pun yang lebih rendah dari dirinya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peristiwa apa yang dimaksudkan di sini? </font><font style="vertical-align: inherit;">Ini dapat berupa pelatihan, dukungan, atau sertifikasi karyawan perusahaan dagang, yang dilakukan penyelia di suatu titik penjualan. </font><font style="vertical-align: inherit;">Hasil dari acara tersebut adalah kuesioner yang diisi di iPad dengan peringkat karyawan untuk kualitas dan keterampilan profesional. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menurut data kuesioner, Anda dapat menyiapkan statistik, misalnya:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Berapa banyak acara dengan bawahannya seperti ini yang dilakukan Vasya Ivanov dalam sebulan? </font><font style="vertical-align: inherit;">Berapa banyak dari mereka yang selesai?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Berapa persentase peringkat yang memuaskan? </font><font style="vertical-align: inherit;">Pertanyaan apa yang paling buruk dijawab oleh pedagang? </font><font style="vertical-align: inherit;">Manajer mana yang lebih buruk dalam mengambil tes?</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Statistik tersebut terdapat dalam </font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Laporan</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> yang dapat dibuat melalui antarmuka web, dalam format XLS, PDF, DOCX, dan dicetak. </font><font style="vertical-align: inherit;">Semua fungsi ini dirancang untuk para manajer di berbagai tingkatan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Konten dan desain laporan didefinisikan dalam </font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">template</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , memungkinkan Anda untuk mengatur parameter yang diperlukan. </font><font style="vertical-align: inherit;">Jika di masa depan pengguna akan membutuhkan jenis laporan baru, sistem memiliki kemampuan untuk membuat template, menentukan parameter yang dapat dimodifikasi dan menambahkan templat ke portal. </font><font style="vertical-align: inherit;">Semua ini - tanpa mengganggu kode sumber dan proses kerja produk.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spesifikasi dan Keterbatasan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portal berjalan pada arsitektur microservice, bagian depan ditulis dalam Angular 5. Sumber daya menggunakan otorisasi JWT, mendukung Google Chrome, Firefox, Microsoft Edge, dan browser </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IE 11</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semua data disimpan di MS SQL Server 2014. SQL Server Reporting Services (SSRS) diinstal di server, pelanggan menggunakannya dan tidak akan menolak. </font><font style="vertical-align: inherit;">Oleh karena itu batasan paling penting: akses ke SSRS ditutup dari luar, sehingga Anda dapat mengakses antarmuka web dan SOAP hanya dari jaringan lokal melalui otorisasi NTLM.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beberapa kata tentang SSR</font></font></b><div class="spoiler_text"><b>SSRS </b>–    ,        ,     .     docs.microsoft.com,  SSRS        (API)    ( Report Server,  -    HTTP). <br>
</div></div><br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perhatian, pertanyaannya: bagaimana menyelesaikan tugas tanpa metode manual, dengan sumber daya minimal dan manfaat maksimum bagi pelanggan? </font></font></b></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena pelanggan memiliki SSR pada server khusus, biarkan SSR melakukan semua pekerjaan kotor menghasilkan dan mengekspor laporan. </font><font style="vertical-align: inherit;">Maka kita tidak perlu menulis layanan pelaporan sendiri, mengekspor modul ke XLS, PDF, DOCX, HTML, dan API yang sesuai. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan demikian, tugasnya adalah untuk berteman dengan SSRS dengan portal dan memastikan pengoperasian fungsi yang ditentukan dalam tugas. </font><font style="vertical-align: inherit;">Jadi mari kita melihat daftar skenario ini - seluk-beluk menarik ditemukan di hampir setiap titik.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Struktur solusi</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena kami sudah memiliki SSR, ada semua alat untuk mengelola template laporan: </font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Server Laporan - bertanggung jawab atas seluruh logika bekerja dengan laporan, penyimpanan, pembuatan, manajemen, dan banyak lagi lainnya.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manajer Laporan - layanan dengan antarmuka web untuk mengelola laporan. </font><font style="vertical-align: inherit;">Di sini Anda dapat mengunggah templat yang dibuat dalam Alat Data SQL Server ke server, mengonfigurasi hak akses, sumber data dan parameter (termasuk yang dapat diubah saat melaporkan permintaan). </font><font style="vertical-align: inherit;">Dia dapat menghasilkan laporan tentang template yang diunduh dan mengunggahnya ke berbagai format, termasuk XLS, PDF, DOCX dan HTML.</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Total:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kami membuat templat dalam Alat Data SQL Server, dengan bantuan Manajer Laporan, kami mengisinya di Server Laporan, kami mengonfigurasi - dan sudah siap. </font><font style="vertical-align: inherit;">Kami dapat menghasilkan laporan, mengubah parameternya. </font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pertanyaan selanjutnya: bagaimana cara meminta pembuatan laporan tentang templat tertentu melalui portal dan mendapatkan hasilnya ke depan untuk output ke UI atau mengunduh dalam format yang diinginkan?</font></font></i></b><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pelaporan dari SSRS ke portal</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang kami katakan di atas, SSRS memiliki API sendiri untuk mengakses laporan. Tetapi kami tidak ingin memberikan fungsinya untuk alasan keamanan dan kebersihan digital - kami hanya perlu meminta data dari SSR dalam bentuk yang tepat dan mengirimkan hasilnya kepada pengguna. Manajemen laporan akan ditangani oleh staf pelanggan yang terlatih khusus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena akses ke SSR hanya dari jaringan lokal, pertukaran data antara server dan portal adalah melalui layanan proxy. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/kz/f5/9x/kzf59xp7_ltztohtag_orirmn5i.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pertukaran data antara portal dan server.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Mari kita lihat cara kerjanya dan mengapa ReportProxy ada di sini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, di sisi portal, kami memiliki ReportService, yang diakses portal untuk laporan. Layanan ini memeriksa otorisasi pengguna, tingkat hak-haknya, mengubah data dari SSR ke bentuk yang diinginkan berdasarkan kontrak.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
API ReportService hanya berisi 2 metode, yang cukup bagi kami:</font></font><br>
<br>
<ol>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetReports</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - memberikan pengidentifikasi dan nama semua templat yang dapat diterima pengguna saat ini;</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetReportData (format, params)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - memberikan data laporan yang siap pakai dan diekspor dalam format yang ditentukan, dengan serangkaian parameter tertentu.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang Anda memerlukan 2 metode ini untuk dapat berkomunikasi dengan SSRS dan mengambil data yang diperlukan dari itu dalam bentuk yang tepat. </font><font style="vertical-align: inherit;">Dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dokumentasi diketahui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bahwa kita dapat mengakses server laporan melalui HTTP menggunakan SOAP API. </font><font style="vertical-align: inherit;">Sepertinya teka-teki itu berkembang ... Tetapi pada kenyataannya, kejutan menunggu kita di sini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena SSRS tertutup bagi dunia luar dan Anda hanya dapat mencapainya melalui otentikasi NTLM, itu tidak tersedia langsung dari portal SOAP. </font><font style="vertical-align: inherit;">Ada juga keinginan kita sendiri:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Berikan akses hanya ke set fungsi yang diperlukan, dan bahkan melarang perubahan;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika Anda harus beralih ke sistem pelaporan lain, pengeditan di ReportService harus minimal, dan lebih baik tidak diperlukan sama sekali.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sinilah ReportProxy membantu kami, yang terletak di mesin yang sama dengan SSRS dan bertanggung jawab atas permintaan proxy dari ReportService ke SSRS. </font><font style="vertical-align: inherit;">Pemrosesan permintaan adalah sebagai berikut:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">layanan menerima permintaan dari ReportService, memeriksa otorisasi JWT;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sesuai dengan metode API, proxy melewati protokol SOAP di SSRS untuk data yang diperlukan, masuk melalui NTLM sepanjang jalan;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data yang diterima dari SSRS dikirim kembali ke ReportService sebagai tanggapan atas permintaan.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bahkan, ReportProxy adalah adaptor antara SSRS dan ReportService. </font></font><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kontroler adalah sebagai berikut:</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs">[BasicAuthentication]<font></font>
public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReportProxyController</span> : <span class="hljs-title">ApiController</span>
</span>{<font></font>
    [HttpGet()]<font></font>
    public List&lt;ReportItem&gt; Get(string rootPath)<font></font>
    {<font></font>
        <span class="hljs-comment">//  ...</span><font></font>
    }<font></font>
<font></font>
    public HttpResponseMessage Post([FromBody]ReportRequest request)<font></font>
    {<font></font>
        <span class="hljs-comment">//  ...</span><font></font>
    }<font></font>
}<font></font>
</code></pre><br>
  BasicAuthentication   :<br>
<br>
<pre><code class="javascript hljs">public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BasicAuthenticationAttribute</span> : <span class="hljs-title">AuthorizationFilterAttribute</span>
</span>{<font></font>
    public override <span class="hljs-keyword">void</span> OnAuthorization(HttpActionContext actionContext)<font></font>
    {<font></font>
        <span class="hljs-keyword">var</span> authHeader = actionContext.Request.Headers.Authorization;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (authHeader != <span class="hljs-literal">null</span>)<font></font>
        {<font></font>
            <span class="hljs-keyword">var</span> authenticationToken = actionContext.Request.Headers.Authorization.Parameter;
            <span class="hljs-keyword">var</span> tokenFromBase64 = Convert.FromBase64String(authenticationToken);
            <span class="hljs-keyword">var</span> decodedAuthenticationToken = Encoding.UTF8.GetString(tokenFromBase64);
            <span class="hljs-keyword">var</span> usernamePasswordArray = decodedAuthenticationToken.Split(<span class="hljs-string">':'</span>);
            <span class="hljs-keyword">var</span> userName = usernamePasswordArray[<span class="hljs-number">0</span>];
            <span class="hljs-keyword">var</span> password = usernamePasswordArray[<span class="hljs-number">1</span>];<font></font>
<font></font>
            <span class="hljs-keyword">var</span> isValid = userName == BasiAuthConf.Login &amp;&amp; password == BasiAuthConf.Password;<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (isValid)<font></font>
            {<font></font>
                <span class="hljs-keyword">var</span> principal = <span class="hljs-keyword">new</span> GenericPrincipal(<span class="hljs-keyword">new</span> GenericIdentity(userName), <span class="hljs-literal">null</span>);<font></font>
                Thread.CurrentPrincipal = principal;<font></font>
<font></font>
                <span class="hljs-keyword">return</span>;<font></font>
            }<font></font>
        }<font></font>
<font></font>
        HandleUnathorized(actionContext);<font></font>
    }<font></font>
<font></font>
    private <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> HandleUnathorized(HttpActionContext actionContext)<font></font>
    {<font></font>
        actionContext.Response = actionContext.Request.CreateResponse(<font></font>
            HttpStatusCode.Unauthorized<font></font>
        );<font></font>
<font></font>
        actionContext.Response.Headers.Add(<font></font>
            <span class="hljs-string">"WWW-Authenticate"</span>, <span class="hljs-string">"Basic Scheme='Data' location = 'http://localhost:"</span><font></font>
        );<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Akibatnya, prosesnya terlihat seperti ini:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Front mengirimkan permintaan http ke ReportService;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReportService mengirimkan permintaan http ke ReportProxy;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReportProxy melalui antarmuka SOAP menerima data dari SSRS dan mengirimkan hasilnya ke ReportService;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReportService membawa hasilnya sesuai dengan kontrak dan memberikannya kepada klien.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami memiliki sistem kerja yang meminta daftar templat yang tersedia, pergi ke SSRS untuk laporan, dan memberikannya ke depan dalam format apa pun yang didukung. </font><font style="vertical-align: inherit;">Sekarang Anda perlu menampilkan laporan yang dihasilkan di bagian depan sesuai dengan parameter yang ditentukan, beri kesempatan untuk mengunggahnya ke XLS, PDF, file DOCX dan cetak. </font><font style="vertical-align: inherit;">Mari kita mulai dengan tampilan.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bekerja dengan Laporan SSR di Portal</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada pandangan pertama, ini adalah masalah sehari-hari - laporannya hadir dalam format HTML, sehingga kami dapat melakukan apa pun yang kami inginkan dengannya! </font><font style="vertical-align: inherit;">Kami akan menanamkannya di halaman, mewarnai dengan gaya desain, dan masalahnya ada di topi. </font><font style="vertical-align: inherit;">Bahkan, ternyata ada cukup jebakan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menurut konsep desain, bagian laporan di portal harus terdiri dari dua halaman: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1) daftar templat tempat kami dapat:</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lihat statistik kegiatan untuk seluruh portal;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lihat semua templat yang tersedia untuk kami;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">klik pada templat yang diinginkan dan pergi ke pembuat laporan yang sesuai.</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/yx/tp/1h/yxtp1h3tvvpujymptptca2gcyew.jpeg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2) generator laporan yang memungkinkan kita untuk:</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mengatur parameter templat dan membuat laporannya;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lihat apa yang terjadi sebagai akibatnya;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pilih format file output, unduh;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cetak laporan dalam bentuk yang mudah dan visual.</font></font></li>
</ul><br>
 <img src="https://habrastorage.org/webt/au/ct/2f/auct2fiklpvvfad6vpbovv0xat0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak ada masalah khusus dengan halaman pertama, jadi kami tidak akan mempertimbangkannya lebih lanjut. </font><font style="vertical-align: inherit;">Dan pembuat laporan memaksa kami untuk menyalakan insinyur, sehingga akan lebih mudah bagi orang sungguhan untuk menggunakan semua fungsi pada TK.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah nomor 1. </font><font style="vertical-align: inherit;">Meja raksasa</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menurut konsep desain, halaman ini harus memiliki area tampilan sehingga pengguna dapat melihat laporannya sebelum mengekspor. Jika laporan tidak sesuai dengan jendela, Anda dapat menggulir secara horizontal dan vertikal. Pada saat yang sama, laporan tipikal dapat mencapai ukuran beberapa layar, yang berarti kita perlu menempelkan blok dengan nama baris dan kolom. Tanpa ini, pengguna harus terus-menerus kembali ke atas tabel untuk mengingat apa artinya sel tertentu. Atau secara umum akan lebih mudah untuk mencetak laporan dan secara konstan menyimpan dedaunan yang diperlukan di depan mata Anda, tetapi kemudian tabel di layar kehilangan artinya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secara umum, blok penempel tidak dapat dihindari. Dan SSR 2014 tidak tahu cara memperbaiki baris dan kolom dalam dokumen MHTML - hanya di antarmuka webnya sendiri.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini kita ingat bahwa browser modern mendukung </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">properti lengket CSS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang hanya menyediakan fungsi yang kita butuhkan. Kami menempatkan posisi: lengket pada blok yang ditandai, tentukan indentasi di sebelah kiri atau di atas (kiri, properti teratas), dan blok akan tetap di tempatnya selama pengguliran horizontal dan vertikal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda perlu menemukan parameter yang dapat menangkap CSS. Nilai sel khusus yang memungkinkan SSRS 2014 untuk menangkapnya di antarmuka web hilang saat mengekspor ke HTML. OK, kami akan menandai mereka sendiri - kami hanya akan mengerti caranya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah beberapa jam membaca dokumentasi dan diskusi dengan rekan kerja, tampaknya tidak ada pilihan. Dan di sini, berdasarkan semua hukum plot, bidang ToolTip muncul untuk kita, yang memungkinkan kita untuk menentukan tip alat untuk sel. Ternyata itu dilemparkan ke dalam kode HTML yang diekspor dalam atribut tooltip - tepat pada tag yang dimiliki sel kustom di Alat Data Server SQL. Tidak ada pilihan - kami tidak menemukan cara lain untuk menandai sel untuk fiksasi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, Anda perlu membuat aturan penandaan dan meneruskan penanda dalam HTML melalui ToolTip. Kemudian, menggunakan JS, kita mengubah atribut tooltip ke kelas CSS di penanda yang ditentukan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hanya ada dua cara untuk memperbaiki sel: vertikal (kolom tetap) dan horizontal (baris tetap). </font><font style="vertical-align: inherit;">Masuk akal untuk menempatkan penanda lain pada sel-sel sudut, yang tetap di tempatnya saat menggulirkan kedua arah - memperbaiki-keduanya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Langkah selanjutnya adalah melakukan UI. </font><font style="vertical-align: inherit;">Saat Anda menerima dokumen HTML, Anda perlu menemukan semua elemen HTML dengan spidol di dalamnya, mengenali nilai-nilai, mengatur kelas CSS yang sesuai dan menghapus atribut tooltip sehingga tidak keluar ketika Anda mengarahkan kursor ke sana. </font><font style="vertical-align: inherit;">Perlu dicatat bahwa markup yang dihasilkan terdiri dari tabel bersarang (tag tabel).</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lihat kode</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs">type FixationType = <span class="hljs-string">'row'</span> | <span class="hljs-string">'column'</span> | <span class="hljs-string">'both'</span>;<font></font>
<font></font>
init(reportHTML: HTMLElement) {<font></font>
    <span class="hljs-comment">//    </span><font></font>
<font></font>
    <span class="hljs-comment">// -  </span>
    <span class="hljs-keyword">const</span> rowsFixed: NodeList = reportHTML.querySelectorAll(<span class="hljs-string">'[title^="RowFixed"]'</span>);
    <span class="hljs-comment">// -  </span>
    <span class="hljs-keyword">const</span> columnFixed: NodeList = reportHTML.querySelectorAll(<span class="hljs-string">'[title^="ColumnFixed"]'</span>);
    <span class="hljs-comment">// -    </span>
    <span class="hljs-keyword">const</span> bothFixed: NodeList = reportHTML.querySelectorAll(<span class="hljs-string">'[title^="BothFixed"]'</span>);<font></font>
<font></font>
    <span class="hljs-keyword">this</span>.prepare(rowsFixed, <span class="hljs-string">'row'</span>);
    <span class="hljs-keyword">this</span>.prepare(columnFixed, <span class="hljs-string">'column'</span>);
    <span class="hljs-keyword">this</span>.prepare(bothFixed, <span class="hljs-string">'both'</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//    </span>
prepare(nodeList: NodeList, <span class="hljs-attr">fixingType</span>: FixationType) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; nodeList.length; i++) {
        <span class="hljs-keyword">const</span> element: HTMLElement = nodeList[i];
        <span class="hljs-comment">//   -</span>
        element.classList.add(fixingType + <span class="hljs-string">'-fixed'</span>);<font></font>
<font></font>
        element.removeAttribute(<span class="hljs-string">'title'</span>);<font></font>
        element.removeAttribute(<span class="hljs-string">'alt'</span>); <span class="hljs-comment">//   SSRS</span><font></font>
<font></font>
        element.parentElement.classList.add(fixingType  + <span class="hljs-string">'-fixed-parent'</span>);<font></font>
<font></font>
        <span class="hljs-comment">//     ,     </span>
        element.style.width = element.getBoundingClientRect().width  + <span class="hljs-string">'px'</span>;
        <span class="hljs-comment">//     ,     </span>
        element.style.height = element.getBoundingClientRect().height  + <span class="hljs-string">'px'</span>;<font></font>
<font></font>
        <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">this</span>.calculateCellCascadeParams(element, fixingType);<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan ini adalah masalah baru: dengan perilaku berjenjang, ketika beberapa blok bergerak dalam satu arah diperbaiki sekaligus dalam tabel, sel-sel yang berjalan satu demi satu akan berlapis. </font><font style="vertical-align: inherit;">Pada saat yang sama, tidak jelas berapa banyak setiap blok berikutnya harus mundur - indentasi harus dihitung melalui JavaScript berdasarkan ketinggian blok di depannya. </font><font style="vertical-align: inherit;">Semua ini berlaku untuk jangkar vertikal dan horizontal.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Skrip koreksi menyelesaikan masalah.</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-comment">//      </span>
calculateCellCascadeParams(cell: HTMLElement, <span class="hljs-attr">fixationType</span>: FixationType) {
    <span class="hljs-keyword">const</span> currentTD: HTMLTableCellElement = cell.parentElement;
    <span class="hljs-keyword">const</span> currentCellIndex = currentTD.cellIndex;<font></font>
<font></font>
    <span class="hljs-comment">//   </span>
    currentTD.style.left = <span class="hljs-string">''</span>;<font></font>
    currentTD.style.top = <span class="hljs-string">''</span>;<font></font>
<font></font>
    <span class="hljs-keyword">const</span> currentTDStyles = getComputedStyle(currentTD);<font></font>
<font></font>
    <span class="hljs-comment">//  </span>
    <span class="hljs-keyword">if</span> (fixationType === <span class="hljs-string">'row'</span> || fixationType === <span class="hljs-string">'both'</span>) {
        <span class="hljs-keyword">const</span> parentRow: HTMLTableRowElement = currentTD.parentElement;<font></font>
<font></font>
        <span class="hljs-comment">//        </span>
        <span class="hljs-comment">//    .</span>
        <span class="hljs-comment">//   ,    .</span>
        <span class="hljs-keyword">let</span> previousRow: HTMLTableRowElement = parentRow;
        <span class="hljs-keyword">let</span> topOffset = <span class="hljs-number">0</span>;<font></font>
<font></font>
        <span class="hljs-keyword">while</span> (previousRow = previousRow.previousElementSibling) {
            <span class="hljs-keyword">let</span> previousCellIndex = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">let</span> cellIndexBulk = <span class="hljs-number">0</span>;<font></font>
<font></font>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; previousRow.cells.length; i++) {
                <span class="hljs-keyword">if</span> (previousRow.cells[i].colSpan &gt; <span class="hljs-number">1</span>) {<font></font>
                    cellIndexBulk += previousRow.cells[i].colSpan;<font></font>
                } <span class="hljs-keyword">else</span> {<font></font>
                    cellIndexBulk += <span class="hljs-number">1</span>;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">if</span> ((cellIndexBulk - <span class="hljs-number">1</span>) &gt;= currentCellIndex) {<font></font>
                    previousCellIndex = i;<font></font>
                    <span class="hljs-keyword">break</span>;<font></font>
                }<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">const</span> previousCell = previousRow.cells[previousCellIndex];<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (previousCell.classList.contains(fixationType + <span class="hljs-string">'_fixed_parent'</span>)) {<font></font>
                topOffset += previousCell.getBoundingClientRect().height;<font></font>
            }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (topOffset &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">if</span> (currentTDStyles.top) {<font></font>
                topOffset += &lt;any&gt;currentTDStyles.top.replace('px', '') - 0;<font></font>
            }<font></font>
<font></font>
            currentTD.style.top = topOffset + 'px';<font></font>
        }<font></font>
    }<font></font>
<font></font>
    //  <font></font>
    if (fixationType === 'column' || fixationType === 'both') {<font></font>
        //       <font></font>
        //     .<font></font>
        //   ,    .<font></font>
        let previousCell: HTMLTableCellElement = currentTD;<font></font>
        let leftOffset = 0;<font></font>
<font></font>
        while (previousCell = previousCell.previousElementSibling) {<font></font>
            if (previousCell.classList.contains(fixationType + '_fixed_parent')) {<font></font>
                leftOffset += previousCell.getBoundingClientRect().width;<font></font>
            }<font></font>
        }<font></font>
<font></font>
        if (leftOffset &gt; 0) {<font></font>
            if (currentTDStyles.left) {<font></font>
                leftOffset += &lt;any&gt;currentTDStyles.left.replace('px', '') - 0;<font></font>
            }<font></font>
<font></font>
            currentTD.style.left = leftOffset + 'px';<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode memeriksa tag elemen yang ditandai dan menambahkan parameter sel tetap ke nilai indentasi. </font><font style="vertical-align: inherit;">Dalam kasus baris patuh, tinggi mereka ditambahkan, untuk kolom, lebar mereka. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/vj/ix/bf/vjixbfnbewh6_pb3smfcogdpevc.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh laporan dengan garis atas yang lengket.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Akibatnya, prosesnya terlihat seperti ini:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami mendapatkan markup dari SSRS dan menempelkannya di tempat yang tepat di DOM;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kenali spidol;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sesuaikan parameter untuk perilaku cascading.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena perilaku menempel sepenuhnya diimplementasikan melalui CSS, dan JS hanya terlibat dalam persiapan dokumen yang masuk, solusinya bekerja cukup cepat dan tanpa lag. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sayangnya, untuk IE, sticking block harus dinonaktifkan karena </font><font style="vertical-align: inherit;">itu tidak mendukung posisi: properti lengket. </font><font style="vertical-align: inherit;">Sisanya - Safari, Mozilla Firefox dan Chrome - melakukan pekerjaan yang sangat baik. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berpindah.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah nomor 2. </font><font style="vertical-align: inherit;">Laporkan Ekspor</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk menarik laporan dari sistem, Anda harus (1) mengakses SSR melalui ReportService untuk objek Blob, (2) mendapatkan tautan ke objek melalui antarmuka menggunakan metode window.URL.createObjectURL, (3) meletakkan tautan di tag dan mensimulasikan klik untuk unggah file. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini berfungsi di Firefox, Safari, dan di semua versi Chrome kecuali Apple. Agar IE, Edge dan Chrome untuk iOS juga mendukung fungsi ini, saya harus membuang otak saya kembali.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di IE dan Edge, acara tersebut tidak akan memicu permintaan browser untuk mengunduh file. Browser ini memiliki fitur sedemikian rupa sehingga untuk mensimulasikan klik, konfirmasi pengguna untuk mengunduh diperlukan, serta indikasi yang jelas tentang tindakan lebih lanjut. Solusinya ditemukan di metode window.navigator.msSaveOrOpenBlob (), yang tersedia di IE dan Edge. Dia hanya tahu bagaimana cara meminta izin pengguna untuk operasi dan menjelaskan apa yang harus dilakukan selanjutnya. Jadi, kami menentukan apakah metode window.navigator.msSaveOrOpenBlob ada, dan bertindak sesuai situasinya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chrome di iOS tidak memiliki peretasan seperti itu, dan alih-alih laporan, kami hanya memiliki halaman kosong. </font><font style="vertical-align: inherit;">Berkeliaran di Web, kami menemukan cerita yang sama, menilai di mana di iOS 13 bug ini seharusnya diperbaiki. </font><font style="vertical-align: inherit;">Sayangnya, kami menulis kembali aplikasi pada masa iOS 12, jadi pada akhirnya kami memutuskan untuk tidak membuang waktu lagi dan hanya mematikan tombol di Chrome untuk iOS. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang tentang bagaimana proses ekspor akhir ke UI. </font><font style="vertical-align: inherit;">Ada tombol di komponen laporan sudut yang meluncurkan rantai langkah-langkah:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">melalui parameter acara, pawang menerima pengidentifikasi format ekspor (misalnya, "PDF");</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengirim permintaan ke ReportService untuk menerima objek-Blob untuk format yang ditentukan;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memeriksa apakah browser itu IE atau Edge;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ketika jawabannya berasal dari ReportService:</font></font><br>
 <ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jika itu IE atau Edge, ia memanggil window.navigator.msSaveOrOpenBlob (fileStream, fileName);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jika tidak, ia memanggil metode this.exportDownload (fileStream, fileName), di mana fileStream adalah Blob yang diperoleh dari permintaan ke ReportService, dan fileName adalah nama file yang akan disimpan. </font><font style="vertical-align: inherit;">Metode ini membuat tag tersembunyi dengan tautan ke window.URL.createObjectURL (fileStream), mensimulasikan klik dan menghapus tag.</font></font></li>
</ul></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan ini beres, petualangan terakhir tetap ada.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah nomor 3. </font><font style="vertical-align: inherit;">Cetakan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kita dapat melihat laporan di portal dan mengekspornya ke format XLS, PDF, DOCX. </font><font style="vertical-align: inherit;">Tetap menerapkan pencetakan dokumen untuk mendapatkan laporan multi-halaman yang akurat. </font><font style="vertical-align: inherit;">Jika tabel ternyata dibagi menjadi beberapa halaman, masing-masing harus berisi judul - blok lengket yang sama yang kita bicarakan di bagian sebelumnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Opsi termudah adalah mengambil halaman saat ini dengan laporan yang ditampilkan, menyembunyikan segala sesuatu yang berlebihan menggunakan CSS dan mengirimkannya untuk dicetak menggunakan metode window.print (). </font><font style="vertical-align: inherit;">Metode ini tidak langsung berfungsi karena beberapa alasan:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Area tampilan non-standar - laporan itu sendiri terdapat di area yang dapat digulir secara terpisah sehingga halaman tidak melebar ke dimensi horizontal yang luar biasa. </font><font style="vertical-align: inherit;">Menggunakan window.print () memotong konten yang tidak sesuai dengan layar;</font></font></li>
<li>   ,      ;</li>
<li>     ,       .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semua ini dapat diperbaiki menggunakan JS dan CSS, tetapi kami memutuskan untuk menghemat waktu pengembang dan mencari alternatif untuk window.print (). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SSRS dapat segera memberi kami PDF siap pakai dengan pagination yang layak. Ini menyelamatkan kita dari semua kesulitan dari versi sebelumnya, satu-satunya pertanyaan adalah, bisakah kita mencetak PDF melalui browser? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena PDF adalah standar pihak ketiga, browser mendukungnya melalui berbagai plugin viewer. Tidak ada plug-in - tidak ada kartun, jadi sekali lagi kita membutuhkan opsi alternatif. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan jika Anda meletakkan PDF pada halaman sebagai gambar, dan mengirim halaman ini untuk dicetak? Sudah ada perpustakaan dan komponen untuk Angular yang menyediakan rendering seperti itu. Dicari, dicoba, diimplementasikan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agar tidak berurusan dengan data yang tidak ingin kami cetak, diputuskan untuk mentransfer konten yang dirender ke halaman baru, dan sudah ada jalankan window.print (). </font><font style="vertical-align: inherit;">Akibatnya, seluruh proses adalah sebagai berikut:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Minta ReportService untuk mengekspor laporan dalam format PDF;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami mendapatkan objek-Blob, mengonversinya menjadi URL (URL.createObjectURL (fileStream)), memberikan URL ke penampil PDF untuk rendering;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami mengambil gambar dari penampil PDF;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buka halaman baru dan tambahkan sedikit markup di sana (judul, sedikit indentasi);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tambahkan gambar dari penampil PDF ke markup, panggil window.print ().</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah beberapa pemeriksaan, kode JS juga muncul di halaman, yang, sebelum dicetak, memeriksa apakah semua gambar telah dimuat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan demikian, seluruh tampilan dokumen ditentukan oleh parameter template SSRS, dan UI tidak mengganggu proses ini. </font><font style="vertical-align: inherit;">Ini mengurangi jumlah kemungkinan bug. </font><font style="vertical-align: inherit;">Karena gambar sedang ditransfer untuk dicetak, kami diasuransikan terhadap kerusakan atau deformasi tata letak. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada juga kelemahannya:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">laporan besar akan banyak menimbang, yang akan berdampak buruk pada platform seluler;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desain tidak diperbarui secara otomatis - warna, font dan elemen desain lainnya harus diinstal pada tingkat templat.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam kasus kami, penambahan templat baru yang sering tidak diharapkan, sehingga solusinya dapat diterima. </font><font style="vertical-align: inherit;">Performa seluler telah diterima begitu saja.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kata terakhir</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini adalah bagaimana proyek reguler sekali lagi membuat kami mencari solusi sederhana untuk tugas-tugas non-sepele. </font><font style="vertical-align: inherit;">Produk akhir sepenuhnya memenuhi persyaratan desain dan terlihat cantik. </font><font style="vertical-align: inherit;">Dan yang paling penting, meskipun kami tidak harus mencari metode implementasi yang paling jelas, tugas itu diselesaikan lebih cepat daripada jika kami mengambil modul laporan asli dengan semua konsekuensinya. </font><font style="vertical-align: inherit;">Dan pada akhirnya, kami dapat fokus pada tujuan bisnis proyek.</font></font></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id487690/index.html">PHP Digest No. 173 (27 Januari - 10 Februari 2020)</a></li>
<li><a href="../id487694/index.html">Bagaimana Yandex.Cloud di-host oleh Virtual Private Cloud dan bagaimana pengguna kami membantu kami menerapkan fitur yang bermanfaat</a></li>
<li><a href="../id487696/index.html">Acara digital di Moskow dari 10 hingga 16 Februari</a></li>
<li><a href="../id487698/index.html">Acara digital di St. Petersburg dari 10 hingga 16 Februari</a></li>
<li><a href="../id487702/index.html">Pilihan artikel tentang pembelajaran mesin: studi kasus, panduan dan penelitian untuk Januari 2020</a></li>
<li><a href="../id487706/index.html">Service Discovery dalam sistem terdistribusi menggunakan contoh Konsul. Alexander Sigachev</a></li>
<li><a href="../id487716/index.html">SAST sempurna. Parser</a></li>
<li><a href="../id487720/index.html">Tentang persaingan ketat (menggunakan pemrograman reaktif sebagai contoh)</a></li>
<li><a href="../id487724/index.html">BlazingPizza: Aplikasi Blazor dari awal hingga akhir. Bagian 2. Tambahkan komponen</a></li>
<li><a href="../id487728/index.html">@Pythonetc kompilasi, Januari 2020</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>