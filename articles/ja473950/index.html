<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏻‍🚒 📥 👧🏽 実装、スケーリング：VTBで自動テストを使用した経験 ❇️ 💅🏻 🙎🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="私たちの部門は、アプリケーションの新しいバージョンを本番環境に出力するための完全自動のパイプラインを作成します。もちろん、これには自動機能テストが必要です。ローカルマシンの1つのスレッドでのテストから始めて、GitLabページのAllureレポートを使用して、アセンブリパイプラインでSelenoid...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>実装、スケーリング：VTBで自動テストを使用した経験</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vtb/blog/473950/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちの部門は、アプリケーションの新しいバージョンを本番環境に出力するための完全自動のパイプラインを作成します。</font><font style="vertical-align: inherit;">もちろん、これには自動機能テストが必要です。</font><font style="vertical-align: inherit;">ローカルマシンの1つのスレッドでのテストから始めて、GitLabページのAllureレポートを使用して、アセンブリパイプラインでSelenoidのセルフテストをマルチスレッドで起動する方法の話を行い、その結果、将来のツールで使用できるクールな自動化ツールを得ました。チーム。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/29e/991/c13/29e991c13a89c4069a46fb4ed6965ec0.jpg"><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">どこから始めましたか</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自動テストを実装してパイプラインに埋め込むには、自動化のためのフレームワークが必要でした。これは、ニーズに合わせて柔軟に変更できます。</font><font style="vertical-align: inherit;">理想的には、自動テストをパイプラインに埋め込むために適合された、自動テストエンジンの単一の標準を取得したかったのです。</font><font style="vertical-align: inherit;">実装には、次のテクノロジーを選択しました。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ジャワ</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メイベン</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セレン</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">きゅうり+ JUNIT 4</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">魅力</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gitlab</font></font><br>
</li>
</ul><br>
<img src="https://habrastorage.org/getpro/habr/post_images/252/ac0/c39/252ac0c39f01083634120a48b2a96952.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
なぜそのようなセットなのか？</font><font style="vertical-align: inherit;">Javaは自動テストで最も人気のある言語の1つであり、さらに、チームのすべてのメンバーがそれを話します。</font><font style="vertical-align: inherit;">セレンは明白な解決策です。</font><font style="vertical-align: inherit;">とりわけ、キュウリは、手動テストに関与するユニットによる自動テストの結果の信頼性を高めるはずでした。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シングルスレッドテスト</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
車輪を再発明しないために、フレームワークの基礎としてGitHubのさまざまなリポジトリからの経験を取り入れ、それらを自分自身に適応させました。</font><font style="vertical-align: inherit;">自動テストフレームワークのコアを含むメインライブラリのリポジトリと、コアに自動テストを実装するゴールドの例を含むリポジトリを作成しました。</font><font style="vertical-align: inherit;">各チームはゴールドイメージを取得してテストを開発し、プロジェクトに適応させる必要がありました。</font><font style="vertical-align: inherit;">構成したGitLab-CIバンクにデプロイしました。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">各プロジェクトのすべての書かれた自動テストの毎日の実行。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アセンブリパイプラインで起動します。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初はいくつかのテストがあり、それらは1つのストリームに行きました。</font><font style="vertical-align: inherit;">GitLab Windows-runnerでのシングルスレッドの起動は、私たちにとって非常に適していました。テストはテストスタンドにわずかに負荷をかけ、リソースをほとんど使用しませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
時間が経つにつれて自動テストはますます多くなり、フル実行に約3時間かかるようになったときに、それらを並行して実行することを考えました。</font><font style="vertical-align: inherit;">その他の問題が発生しました：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テストが安定していることを確認できませんでした。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ローカルマシンで連続して数回実行されたテストは、CIに分類される場合がありました。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自動テストのセットアップ例：</font></font><br>
<br>
<pre><code class="java hljs">&lt;plugins&gt;<font></font>
	<font></font>
&lt;plugin&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;version&gt;<span class="hljs-number">2.20</span>&lt;/version&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;configuration&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;skipTests&gt;${skipTests}&lt;/skipTests&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;testFailureIgnore&gt;<span class="hljs-keyword">false</span>&lt;/testFailureIgnore&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;argLine&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
-javaagent:<span class="hljs-string">"${settings.localRepository}/org/aspectj/aspectjweaver/${aspectj.version}/aspectjweaver-${aspectj.version}.jar"</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
-Dcucumber.options=<span class="hljs-string">"--tags ${TAGS} --plugin io.qameta.allure.cucumber2jvm.AllureCucumber2Jvm --plugin pretty"</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;/argLine&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;/configuration&gt;<font></font>
	<font></font>
&nbsp; &nbsp; &lt;dependencies&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;dependency&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;groupId&gt;org.aspectj&lt;/groupId&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;version&gt;${aspectj.version}&lt;/version&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;/dependency&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;/dependencies&gt;<font></font>
	<font></font>
&lt;/plugin&gt;<font></font>
	<font></font>
&lt;plugin&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;groupId&gt;io.qameta.allure&lt;/groupId&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;artifactId&gt;allure-maven&lt;/artifactId&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;version&gt;<span class="hljs-number">2.9</span>&lt;/version&gt;<font></font>
	<font></font>
&lt;/plugin&gt;<font></font>
&lt;/plugins&gt;<font></font>
</code></pre><br>
&nbsp;<img src="https://habrastorage.org/getpro/habr/post_images/864/1b8/23b/8641b823bd4b8e0cd4f55ea6f026c6fd.png"><br>
<i><font style="vertical-align: inherit;"></font></i><br>
<br>
&nbsp;<img src="https://habrastorage.org/getpro/habr/post_images/387/23c/761/38723c761d476c0f5d7536d22529d614.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テスト中</font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">のアリュールレポート</font></i><i><font style="vertical-align: inherit;">ランナーの負荷の</font></i><i><font style="vertical-align: inherit;">例</font></i><i><font style="vertical-align: inherit;">（8コア、8 GBのRAM、1スレッド）</font></i></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
シングルスレッドテストの利点：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">設定と実行が簡単。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CIでの起動は、ローカルでの起動と実質的に違いはありません。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テストは互いに影響しません。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最小ランナーリソース要件。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
シングルスレッドテストの短所：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非常に長い目で見ます。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テストの長期安定;</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ランナーリソースの非効率的な使用、非常に低い使用率。</font></font><br>
</li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JVMフォークテスト</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
基本的なフレームワークを実装するとき、スレッドセーフなコードは処理しなかったため、並列で実行する最も明白な方法は</font><font style="vertical-align: inherit;">、Mavenの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cucumber-jvm-parallel-plugin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">でした。プラグインは設定が簡単ですが、自動テストを正しく並行して実行するには、別のブラウザーで実行する必要があります。何もする必要はありません。Selenoidを使用する必要がありました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selenoidサーバーは、32コアと24 GBのRAMを搭載したマシンで開発されました。制限は48のブラウザーで設定されました-コアあたり1.5スレッド、約400 MBのRAM。その結果、試験時間は3時間から40分に短縮されました。実行を高速化することで、安定化の問題を解決することができました。新しい自動テストを20〜30回すばやく実行して、安定して実行されることを確認できました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ソリューションの最初の欠点は、並列スレッドの数が少ないランナーリソースの使用率が高いことでした。4コアと8 GBのRAMでは、テストは6スレッド以下で安定して動作しました。 2番目のマイナス：プラグインは、いくつ実行されても、シナリオごとにランナークラスを生成します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要！</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たとえば、次のように</font><font style="vertical-align: inherit;">、</font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">argLine</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">でタグ付きの変数をスローしないでください</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="java hljs">&lt;argLine&gt;-Dcucumber.options=<span class="hljs-string">"--tags ${TAGS} --plugin io.qameta.allure.cucumber2jvm.AllureCucumber2Jvm --plugin pretty"</span>&lt;/argLine&gt;<font></font>
…<font></font>
Mvn –DTAGS=<span class="hljs-string">"@smoke"</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この方法でタグを渡すと、プラグインはすべてのテストのランナーを生成します。つまり、すべてのテストを実行し、起動直後にスキップして、多数のJVMフォークを作成します。</font><font style="vertical-align: inherit;">プラグイン設定で、</font><i><b><font style="vertical-align: inherit;">タグ</font></b></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
付きの変数をタグにスローするのが正しい</font><font style="vertical-align: inherit;">です。以下の例を参照してください。</font><font style="vertical-align: inherit;">テストした他の方法では、Allureプラグインの接続に問題があります。</font><font style="vertical-align: inherit;">
設定が正しくない6つの短いテストの実行時間の例：</font></font><i><b><font style="vertical-align: inherit;"></font></b></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="java hljs">[INFO] Total time: <span class="hljs-number">03</span>:<span class="hljs-number">17</span> min
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タグを</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mvn ... –Dcucumber.optionsに</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">直接渡した場合のテストランタイムの例</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="java hljs">[INFO] Total time: <span class="hljs-number">44.467</span> s
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自動テストのセットアップ例：</font></font><br>
<br>
<pre><code class="java hljs">&lt;profiles&gt;<font></font>
	<font></font>
&lt;profile&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;id&gt;parallel&lt;/id&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;build&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;plugins&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;plugin&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;groupId&gt;com.github.temyers&lt;/groupId&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;artifactId&gt;cucumber-jvm-parallel-plugin&lt;/artifactId&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;version&gt;<span class="hljs-number">5.0</span><span class="hljs-number">.0</span>&lt;/version&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;executions&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;execution&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;id&gt;generateRunners&lt;/id&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;phase&gt;generate-test-sources&lt;/phase&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;goals&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;goal&gt;generateRunners&lt;/goal&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;/goals&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;configuration&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;tags&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;tag&gt;${TAGS}&lt;/tag&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;/tags&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;glue&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;<span class="hljs-keyword">package</span>&gt;stepdefs&lt;/<span class="hljs-keyword">package</span>&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;/glue&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;/configuration&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/execution&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;/executions&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&nbsp; &nbsp; &nbsp; &nbsp; &lt;/plugin&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;plugin&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&nbsp; &nbsp; &nbsp; &nbsp; &lt;version&gt;<span class="hljs-number">2.21</span><span class="hljs-number">.0</span>&lt;/version&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;configuration&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;forkCount&gt;<span class="hljs-number">12</span>&lt;/forkCount&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;reuseForks&gt;<span class="hljs-keyword">false</span>&lt;/reuseForks&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;includes&gt;**<span class="hljs-comment">/*IT.class&lt;/includes&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	
 &lt;testFailureIgnore&gt;false&lt;/testFailureIgnore&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	
&lt;!--suppress UnresolvedMavenProperty --&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	
&lt;argLine&gt;
&nbsp;&nbsp;	
 -javaagent:"${settings.localRepository}/org/aspectj/aspectjweaver/${aspectj.version}/aspectjweaver-${aspectj.version}.jar" -Dcucumber.options="--plugin io.qameta.allure.cucumber2jvm.AllureCucumber2Jvm TagPFAllureReporter --plugin pretty"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	
&lt;/argLine&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	
&lt;/configuration&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	
&lt;dependencies&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	
&lt;dependency&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	
&lt;groupId&gt;org.aspectj&lt;/groupId&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	
&lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	
&lt;version&gt;${aspectj.version}&lt;/version&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	
 &nbsp; &lt;/dependency&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	
&lt;/dependencies&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	
 &nbsp; &lt;/plugin&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	
&lt;/plugins&gt;
&nbsp;&nbsp;&nbsp;&nbsp;	
&lt;/build&gt;
	
&lt;/profile&gt;
</span></code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/82f/fa3/c04/82ffa3c04c02ca5be5e47fdfe8c9b052.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">魅力レポート（最も不安定な試験、4 reranes）ランナーの例</font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/075/70c/0ce/07570c0ceade310c1afdceb8e0daf50f.png"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">試験時の負荷（8個のコア、RAMの8 GB、12スレッド）</font></font></i><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
長所：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">簡単なセットアップ-プラグインを追加するだけです。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多数のテストを同時に実行する機能。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クレーム1のおかげでテストの安定化が速く&nbsp;</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マイナス：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">複数のOS /コンテナが必要です。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォークごとの高いリソース消費。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プラグインは廃止され、サポートされなくなりました。&nbsp;</font></font><br>
</li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不安定さを克服する方法&nbsp;</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自動テスト自体と同様に、テストスタンドも完璧ではありません。</font><font style="vertical-align: inherit;">当然のことながら、いくつかの不安定なテストが行​​われました。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">maven surefireプラグイン</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">救いの手を差し伸べてくれ</font></a><font style="vertical-align: inherit;">ました</font><font style="vertical-align: inherit;">。これ</font><font style="vertical-align: inherit;">は</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">そのままでフォールン</font></a><font style="vertical-align: inherit;">テストの再開をサポートしています。</font><font style="vertical-align: inherit;">プラグインのバージョンを少なくとも2.21に更新し、pom-fileに再起動回数を1行書き込むか、Mavenの引数として渡す必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自動テストのセットアップ例：</font></font><br>
<br>
<pre><code class="java hljs">&nbsp;&nbsp;&nbsp;	<font></font>
&lt;plugin&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<font></font>
&nbsp;&nbsp;	<font></font>
&nbsp; &nbsp; &nbsp; &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;version&gt;<span class="hljs-number">2.21</span><span class="hljs-number">.0</span>&lt;/version&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;configuration&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
….<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;rerunFailingTestsCount&gt;<span class="hljs-number">2</span>&lt;/rerunFailingTestsCount&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
….<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;/configuration&gt;<font></font>
&lt;/plugin&gt;<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
または起動時に：</font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mvn ... -Dsurefire.rerunFailingTestsCount = 2 ...</font></font></b></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
または、PowerShellスクリプト（PS1）のMavenオプションを設定します。</font></font><br>
<br>
<pre><code class="java hljs">&nbsp;&nbsp;
Set-Item Env:MAVEN_OPTS <span class="hljs-string">"-Dfile.encoding=UTF-8 -Dsurefire.rerunFailingTestsCount=2"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
長所：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不安定なテストが落ちたときに分析に時間を費やす必要はありません。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テストベンチの安定性の問題を解消できます。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マイナス：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">浮動欠陥をスキップできます。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実行時間が増加します。</font></font><br>
</li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cucumber 4ライブラリを使用した並列テスト</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テストの数は毎日増加しました。</font><font style="vertical-align: inherit;">走行を加速することをもう一度考えました。</font><font style="vertical-align: inherit;">さらに、アプリケーションのパイプラインアセンブリにできるだけ多くのテストを統合したいと考えました。</font><font style="vertical-align: inherit;">重要な要素は、Mavenプラグインを使用して並行して実行する場合のランナーの生成が長すぎることです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cucumber 4はその時点ですでにリリースされていたので、このバージョンのカーネルを書き直すことにしました。</font><font style="vertical-align: inherit;">リリースノートでは、スレッドレベルでの並行起動を約束しました。</font><font style="vertical-align: inherit;">理論的には、これは次のとおりでした。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スレッド数を増やすことにより、自動テストの実行を大幅にスピードアップします。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自動テストごとにランナーを生成するための時間の損失を除外します。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マルチスレッド自動テストのフレームワークを最適化することはそれほど難しくありませんでした。</font><font style="vertical-align: inherit;">Cucumber 4は、最初から最後まで専用のスレッドで個々のテストを実行するため、一般的な静的なものはThreadLocal変数に単純に変換されました。&nbsp;</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ideaリファクタリングツールで変換する際の主なことは、変数が比較された場所をチェックすることです（たとえば、nullをチェックする）。</font><font style="vertical-align: inherit;">さらに、Junit RunnerクラスのアノテーションでAllureプラグインをレンダリングする必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自動テストのセットアップ例：</font></font><br>
<br>
<pre><code class="java hljs">&nbsp;<font></font>
&lt;profile&gt;<font></font>
	<font></font>
&lt;id&gt;parallel&lt;/id&gt;<font></font>
	<font></font>
&lt;build&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;plugins&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;plugin&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<font></font>
&nbsp;	<font></font>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;version&gt;<span class="hljs-number">3.0</span><span class="hljs-number">.0</span>-M3&lt;/version&gt;<font></font>
&nbsp;&nbsp;&nbsp;	<font></font>
 &nbsp; &nbsp; &nbsp; &nbsp; &lt;configuration&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;useFile&gt;<span class="hljs-keyword">false</span>&lt;/useFile&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;testFailureIgnore&gt;<span class="hljs-keyword">false</span>&lt;/testFailureIgnore&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&nbsp; &nbsp; &nbsp; &nbsp; &lt;parallel&gt;methods&lt;/parallel&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;threadCount&gt;<span class="hljs-number">6</span>&lt;/threadCount&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;perCoreThreadCount&gt;<span class="hljs-keyword">true</span>&lt;/perCoreThreadCount&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;argLine&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
-javaagent:<span class="hljs-string">"${settings.localRepository}/org/aspectj/aspectjweaver/${aspectj.version}/aspectjweaver-${aspectj.version}.jar"</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;/argLine&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;/configuration&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;dependencies&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;dependency&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;groupId&gt;org.aspectj&lt;/groupId&gt;<font></font>
&nbsp;&nbsp;&nbsp;	<font></font>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;version&gt;${aspectj.version}&lt;/version&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;/dependency&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;/dependencies&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;/plugin&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;	<font></font>
&lt;/plugins&gt;<font></font>
	<font></font>
&lt;/build&gt;<font></font>
&lt;/profile&gt;<font></font>
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/b47/ef9/2c6/b47ef92c6608aebaccd13664af9cbf07.png"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アリュールレポートの例（最も不安定なテスト、5回の再実行）</font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/6d7/db7/677/6d7db7677375e71ebde6992c96cee920.png"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テスト中の</font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">ランナーの</font></i><i><font style="vertical-align: inherit;">負荷（8コア、8 GBのRAM、24スレッド）</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
長所：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リソース消費が少ない。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cucumberによるネイティブサポート-追加のツールは必要ありません。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロセッサー・コアで6つを超えるスレッドを実行する機能。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マイナス：</font></font><br>
<br>
<ul>
<li>   ,     ;<br>
</li>
<li>  .<br>
</li>
</ul><br>
<h2>Allure-  GitLab pages</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マルチスレッド化の導入後、レポートの分析により多くの時間を費やすようになりました。</font><font style="vertical-align: inherit;">その際、各レポートをGitLabのアーティファクトとしてアップロードし、ダウンロードして解凍する必要がありました。</font><font style="vertical-align: inherit;">それは非常に便利で長いわけではありません。</font><font style="vertical-align: inherit;">そして、誰かが自宅でレポートを見たい場合は、同じ操作を行う必要があります。</font><font style="vertical-align: inherit;">私たちはフィードバックを早く受け取りたかったのですが、解決策がありました-GitLabページ。</font><font style="vertical-align: inherit;">これは、GitLabの最近のすべてのバージョンでそのまま使用できる組み込み機能です。</font><font style="vertical-align: inherit;">サーバーに静的サイトをデプロイし、直接リンクを介してそれらにアクセスできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AllureレポートのスクリーンショットはすべてGitLabページで作成されました。</font><font style="vertical-align: inherit;">レポートをGitLabページにデプロイするためのスクリプトは、Windows PowerShellです（自動テストを実行する前に）。</font></font><br>
<br>
<pre><code class="java hljs">New-Item -ItemType directory -Path $testresult\history | Out-Null<font></font>
<font></font>
<span class="hljs-keyword">try</span> {Invoke-WebRequest -Uri $hst -OutFile $outputhst}<font></font>
Catch{echo <span class="hljs-string">"fail copy history"</span>}
<span class="hljs-keyword">try</span> {Invoke-WebRequest -Uri $hsttrend -OutFile $outputhsttrnd}<font></font>
Catch{echo <span class="hljs-string">"fail copy history trend"</span>}<font></font>
<font></font>
mvn allure:report<font></font>
#mvn assembly:single -PzipAllureReport<font></font>
xcopy $buildlocation\target\site\allure-maven-plugin\* $buildlocation\<span class="hljs-keyword">public</span> /s /i /Y
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果は何ですか&nbsp;</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、Cucumber自動テストフレームワークでスレッドセーフコードが必要かどうかを考えていた場合、答えは明らかです。Cucumber4を使用すると簡単に実装できるため、同時に起動されるスレッドの数が大幅に増加します。</font><font style="vertical-align: inherit;">テストを実行するこの方法では、Selenoidとテストベンチを備えたマシンのパフォーマンスに関する問題がすでにあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スレッドで自動テストを実行すると、リソースの消費を最小限に抑え、最高のパフォーマンスを実現できることが実践でわかっています。</font><font style="vertical-align: inherit;">グラフからわかるように、フローが2倍に増加しても、パフォーマンステストに合格する際に同様の加速にはつながりません。</font><font style="vertical-align: inherit;">それにもかかわらず、アプリケーションアセンブリに200以上の自動テストを追加することができました。5回の再実行でも、約24分で完了できます。</font><font style="vertical-align: inherit;">これにより、ユーザーから迅速なフィードバックを受け取り、必要に応じて変更を加えて、手順を繰り返すことができます。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja473938/index.html">IConfigurationを介してアプリケーション設定をユニバーサルに保存する</a></li>
<li><a href="../ja473940/index.html">強度テスト：真珠貝の貴族の耳介のナノメカニクス</a></li>
<li><a href="../ja473944/index.html">RimWorldの作成者からのアドバイス：ゲームのファンを予測する際の認知の歪み</a></li>
<li><a href="../ja473946/index.html">マイクロサービスの分散ロギングとトレース</a></li>
<li><a href="../ja473948/index.html">Operon：Ansibleのパフォーマンスをスピードアップ</a></li>
<li><a href="../ja473952/index.html">ターンベースの戦略のためにAIを書いたとき</a></li>
<li><a href="../ja473956/index.html">ドラッグディーラーの電話会社からの秘密情報</a></li>
<li><a href="../ja473958/index.html">NICTの日本人が、1 Pbit / sの帯域幅で動作するファイバークラスターを紹介しました</a></li>
<li><a href="../ja473962/index.html">ダークモードは今どこにでもあります。とても便利ですか？（投稿の最後の投票）</a></li>
<li><a href="../ja473972/index.html">組み込み開発者の注文：Amazon FreeRTOSでバグを探す</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>