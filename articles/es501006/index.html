<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§™ üìÇ ‚õ∏Ô∏è Somos amigos STM32 con pantalla LCD 1604 en bus I2C (biblioteca HAL) üå∏ ü§≤üèª üì∏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola Habr! 
 
 En este art√≠culo, me gustar√≠a hablar sobre mi experiencia al conectar pantallas LCD al microcontrolador STM32 utilizando la biblioteca ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Somos amigos STM32 con pantalla LCD 1604 en bus I2C (biblioteca HAL)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/501006/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hola Habr! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este art√≠culo, me gustar√≠a hablar sobre mi experiencia al conectar pantallas LCD al microcontrolador STM32 utilizando la biblioteca HAL en el bus I2C. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yj/tq/li/yjtqliuuokrq220g_4kyg5lty3y.jpeg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Conectar√© la pantalla 1602 y 2004. Ambos tienen un adaptador I2C soldado basado en el chip PCF8574T. </font><font style="vertical-align: inherit;">La placa de depuraci√≥n ser√° </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nucleo767ZI</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y el entorno de desarrollo ser√° </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STM32CubeIDE 1.3.0.</font></font></b><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No hablar√© en detalle sobre el principio de funcionamiento del bus I2C, le aconsejo que mire </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqu√≠</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqu√≠</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Creamos el proyecto, seleccionamos la placa de depuraci√≥n: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ka/dg/gq/kadggqufgj38rtpnuhafups7usg.jpeg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
indicamos que usaremos I2C1. Tambi√©n conectar√© UART5 para comunicarme con la placa, esto es necesario para recibir informaci√≥n de la placa sobre la direcci√≥n de pantalla. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cv/h2/o5/cvh2o5rcohuwwpqecrcedg4m62a.jpeg" alt="imagen"><br>
<br>
<img src="https://habrastorage.org/webt/cp/iz/dt/cpizdtxz2sosftjpdrvgycthcz8.jpeg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la misma ventana, puede ver los n√∫meros de las patas a las que est√° conectada la pantalla, en mi caso result√≥ as√≠: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gj/jg/yd/gjjgydsz_j5o4czfol2wgsqfayy.jpeg" alt="imagen"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
para comenzar, conecte solo una pantalla, comenzar√© con 1602. Adem√°s, conectar√© el adaptador USB-UART CH340, conocido por los controladores arduin experimentados, para recibir datos de la placa. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pl/ka/tq/plkatqffrxr3txh7d3gar6m9wka.jpeg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tenga en cuenta que el adaptador conecta RX a TX y TX a RX, el puente en el adaptador es 3.3V</font></font><br>
<br>
<img src="https://habrastorage.org/webt/n_/u-/jl/n_u-jlv9qayzjrgmqg9yoqlz7mi.jpeg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Echemos un vistazo m√°s de cerca al trabajo con el chip y la pantalla PCF8574T. </font><font style="vertical-align: inherit;">A continuaci√≥n se muestra un diagrama esquem√°tico de un m√≥dulo con una pantalla: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-v/-p/5e/-v-p5ehplnmtvvbvncmbaqqo1ru.jpeg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
el chip PCF8574T tiene una funci√≥n similar al registro de desplazamiento 74hc595: recibe bytes a trav√©s de la interfaz I2C y asigna los valores del bit correspondiente a sus salidas (P0-P7). </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considere qu√© pines del microcircuito est√°n conectados a la pantalla y de qu√© son responsables:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El terminal P0 del microcircuito est√° conectado al terminal RS de la pantalla, que es responsable de recibir los datos de la pantalla (1) o las instrucciones de operaci√≥n de la pantalla (0);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El pin P1 est√° conectado a R \ W, si 1 - escribe datos en la pantalla, 0 - lee;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El terminal P2 est√° conectado a CS: el terminal, tras el cambio de estado del cual se est√° leyendo;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n P3 - control de luz de fondo;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusiones P4 - P7 se utilizan para transmitir datos a la pantalla. </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se pueden conectar varios dispositivos a un bus I2C al mismo tiempo. Para poder acceder a un dispositivo espec√≠fico, cada uno de ellos tiene su propia direcci√≥n, primero lo descubriremos. Si los contactos A1, A2 y A3 en la placa adaptadora no est√°n sellados, lo m√°s probable es que la direcci√≥n sea 0x27, pero es mejor verificar. Para hacer esto, escribiremos una peque√±a funci√≥n que mostrar√° las direcciones de todos los dispositivos que est√°n conectados al bus I2C:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">I2C_Scan</span> <span class="hljs-params">()</span>
</span>{
	<span class="hljs-comment">//  ,  </span><font></font>
        HAL_StatusTypeDef res;                          <font></font>
	<span class="hljs-comment">//    </span>
        <span class="hljs-keyword">char</span> info[] = <span class="hljs-string">"Scanning I2C bus...\r\n"</span>;      
        <span class="hljs-comment">//    UART	</span>
        HAL_UART_Transmit(&amp;huart5, (<span class="hljs-keyword">uint8_t</span>*)info, <span class="hljs-built_in">strlen</span>(info), HAL_MAX_DELAY);  
	<span class="hljs-comment">/* &amp;huart5 -   UART
	 * (uint8_t*)info -     
	 * strlen(info) -   
	 * HAL_MAX_DELAY - 
	 */</span>
        <span class="hljs-comment">//    </span>
	<span class="hljs-keyword">for</span>(<span class="hljs-keyword">uint16_t</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">128</span>; i++)              <font></font>
	{<font></font>
            <span class="hljs-comment">// ,      i  </span>
            res = HAL_I2C_IsDeviceReady(&amp;hi2c1, i &lt;&lt; <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, HAL_MAX_DELAY);                   
	    <span class="hljs-comment">//  , </span>
            <span class="hljs-keyword">if</span>(res == HAL_OK)                              <font></font>
	    {<font></font>
	    	<span class="hljs-keyword">char</span> msg[<span class="hljs-number">64</span>];
	    	<span class="hljs-comment">//   i,   ,     </span>
                <span class="hljs-comment">// 16 :</span>
	    	<span class="hljs-built_in">snprintf</span>(msg, <span class="hljs-keyword">sizeof</span>(msg), <span class="hljs-string">"0x%02X"</span>, i);
	    	<span class="hljs-comment">//    </span>
	    	HAL_UART_Transmit(&amp;huart5, (<span class="hljs-keyword">uint8_t</span>*)msg, <span class="hljs-built_in">strlen</span>(msg), HAL_MAX_DELAY);
	    	<span class="hljs-comment">//    </span>
	    	HAL_UART_Transmit(&amp;huart5, (<span class="hljs-keyword">uint8_t</span>*)<span class="hljs-string">"\r\n"</span>, <span class="hljs-number">2</span>, HAL_MAX_DELAY);<font></font>
	    }<font></font>
	    <span class="hljs-keyword">else</span> HAL_UART_Transmit(&amp;huart5, (<span class="hljs-keyword">uint8_t</span>*)<span class="hljs-string">"."</span>, <span class="hljs-number">1</span>, HAL_MAX_DELAY);<font></font>
	}<font></font>
	HAL_UART_Transmit(&amp;huart5, (<span class="hljs-keyword">uint8_t</span>*)<span class="hljs-string">"\r\n"</span>, <span class="hljs-number">2</span>, HAL_MAX_DELAY);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta funci√≥n sondea todas las direcciones de 0 a 127 y si se recibe una respuesta de esta direcci√≥n, env√≠a el n√∫mero de direcci√≥n en forma hexadecimal a UART. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para comunicarme con la junta, utilizo el programa Termite. Por defecto, la velocidad UART del microcontrolador est√° establecida en 115200, debe configurarla en termitas. Llamamos a la funci√≥n en el cuerpo principal del programa, flasheamos la placa y nos conectamos en termitas a nuestro microcontrolador: los </font></font><br>
<br>
<img src="https://habrastorage.org/webt/0f/3d/uj/0f3dujga-iwbhudpe7kauth_ivi.jpeg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
puntos muestran todas las direcciones de las cuales no se recibi√≥ la respuesta. La direcci√≥n en mi pantalla es 0x26, ya que solde√© el puente A0. Ahora conecte la segunda pantalla paralela a la primera y vea lo que dar√° el programa:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/f4/dz/hm/f4dzhm0py_f9kbvecthsshrpemi.jpeg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tenemos dos direcciones: 0x26 (pantalla 1602) y 0x27 (pantalla 2004). Ahora sobre c√≥mo trabajar con la pantalla. El microcontrolador env√≠a un byte de direcci√≥n y todos los dispositivos conectados al bus lo comprueban con el suyo. Si coincide, entonces el m√≥dulo inicia la comunicaci√≥n con el microcontrolador. En primer lugar, debe configurar la pantalla: desde d√≥nde ir√° el recuento de caracteres y en qu√© direcci√≥n, c√≥mo se comportar√° el cursor, etc. Despu√©s de eso, ya ser√° posible transmitir informaci√≥n para mostrar a la pantalla. La peculiaridad es que solo podemos usar 4 bits para transmitir informaci√≥n, es decir Los datos deben dividirse en dos partes. Los datos se almacenan en los bits altos (4-7), y los bits bajos se usan para indicar si la luz de fondo se encender√° (3 bits), si los datos vienen para la salida o la configuraci√≥n de la pantalla (salida RS, 0 bits) y 2 bits, por el cambio en el que tiene lugar la lectura, es decire para enviar 1 byte de datos, debe enviar 4 bytes: el primer byte contendr√° 4 bits de informaci√≥n, el segundo bit al estado 1, el segundo byte es una repetici√≥n del primero, solo el segundo bit al estado 0. Los bytes 3 y 4 son similares, solo que contienen segunda mitad de los datos. Suena un poco incomprensible, te mostrar√© un ejemplo:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">I2C_send</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> data, <span class="hljs-keyword">uint8_t</span> flags)</span>
</span>{<font></font>
	HAL_StatusTypeDef res;<font></font>
	 <span class="hljs-comment">//     </span>
        <span class="hljs-keyword">for</span>(;;) {
                <span class="hljs-comment">// ,      lcd_addr                                                                                        </span>
	        res = HAL_I2C_IsDeviceReady(&amp;hi2c1, LCD_ADDR, <span class="hljs-number">1</span>, HAL_MAX_DELAY);               
	         <span class="hljs-comment">//  ,     </span>
                <span class="hljs-keyword">if</span>(res == HAL_OK) <span class="hljs-keyword">break</span>;                                                  <font></font>
	    }<font></font>
        <span class="hljs-comment">//    1111 0000      0  3,    4  7</span>
	<span class="hljs-keyword">uint8_t</span> up = data &amp; <span class="hljs-number">0xF0</span>;   
        <span class="hljs-comment">//   ,  data   4                	</span>
        <span class="hljs-keyword">uint8_t</span> lo = (data &lt;&lt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0xF0</span>;          <font></font>
                                          <font></font>
	<span class="hljs-keyword">uint8_t</span> data_arr[<span class="hljs-number">4</span>];
         <span class="hljs-comment">// 4-7   ,  0-3   </span>
	data_arr[<span class="hljs-number">0</span>] = up|flags|BACKLIGHT|PIN_EN; 
         <span class="hljs-comment">//  ,       0  </span>
	data_arr[<span class="hljs-number">1</span>] = up|flags|BACKLIGHT;         <font></font>
	data_arr[<span class="hljs-number">2</span>] = lo|flags|BACKLIGHT|PIN_EN;<font></font>
	data_arr[<span class="hljs-number">3</span>] = lo|flags|BACKLIGHT;<font></font>
<font></font>
	HAL_I2C_Master_Transmit(&amp;hi2c1, LCD_ADDR, data_arr, <span class="hljs-keyword">sizeof</span>(data_arr), HAL_MAX_DELAY);<font></font>
	HAL_Delay(LCD_DELAY_MS);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tom√©moslo en orden. Al principio, hay variables que almacenan la direcci√≥n de visualizaci√≥n, y bits de configuraci√≥n que deben enviarse cada vez junto con los datos. En la funci√≥n de env√≠o, primero verificamos si hay un m√≥dulo en la direcci√≥n registrada. En caso de recibir el mensaje HAL_OK, comenzamos a formar bytes para enviar. Al comienzo del byte que enviaremos, es necesario dividirlo en dos partes, escribir ambas en los bits altos. Supongamos que queremos que la pantalla muestre el car√°cter 's', en el sistema binario es 1110011 ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">calculadora</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) Usando la operaci√≥n l√≥gica y escribimos = 01110000 en la variable, es decir escribe solo los bits m√°s significativos. Los bits de orden inferior se desplazan a la izquierda 4 caracteres al principio, y luego se escriben en la variable lo = 00110000. A continuaci√≥n, formamos una matriz de 4 bytes que contienen informaci√≥n sobre el car√°cter que se mostrar√°. Ahora asignamos bits de configuraci√≥n (0-3 bits) a los bytes existentes. Despu√©s de eso, enviamos el byte de direcci√≥n y 4 bytes de informaci√≥n a la pantalla usando la funci√≥n HAL_I2C_Master_Transmit (); </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero no se apresure a descargar el programa, porque al principio debe establecer la configuraci√≥n de la pantalla. El </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sitio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tiene una excelente tabla traducida con comandos para personalizar la pantalla. Despu√©s de verificarlo con la documentaci√≥n, llegu√© a la siguiente configuraci√≥n que es √≥ptima para m√≠:</font></font><br>
<br>
<pre><code class="cpp hljs">  I2C_send(<span class="hljs-number">0b00110000</span>,<span class="hljs-number">0</span>);   <span class="hljs-comment">// 8  </span>
  I2C_send(<span class="hljs-number">0b00000010</span>,<span class="hljs-number">0</span>);   <span class="hljs-comment">//     </span>
  I2C_send(<span class="hljs-number">0b00001100</span>,<span class="hljs-number">0</span>);   <span class="hljs-comment">//   ,  </span>
  I2C_send(<span class="hljs-number">0b00000001</span>,<span class="hljs-number">0</span>);   <span class="hljs-comment">//  </span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Colocamos estos comandos antes del comienzo de un bucle infinito, de modo que la configuraci√≥n se env√≠e una vez antes de comenzar a trabajar (como la configuraci√≥n de vac√≠o en arduinki). </font><font style="vertical-align: inherit;">La funci√≥n I2C_send, adem√°s del byte, requiere que especifique si se enviar√°n las configuraciones de visualizaci√≥n o los datos. </font><font style="vertical-align: inherit;">Si el segundo argumento de la funci√≥n es 0, entonces la configuraci√≥n, y si es 1, entonces los datos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y el √∫ltimo toque: necesita una funci√≥n que env√≠e una fecha l√≠mite car√°cter por car√°cter. </font><font style="vertical-align: inherit;">Aqu√≠ todo es bastante simple:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">LCD_SendString</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *str)</span>
</span>{
    <span class="hljs-comment">// *char    </span>
    <span class="hljs-comment">//    </span>
	<span class="hljs-keyword">while</span>(*str) <font></font>
        {                                   <font></font>
                <span class="hljs-comment">//    </span>
		I2C_send((<span class="hljs-keyword">uint8_t</span>)(*str), <span class="hljs-number">1</span>); 
                <span class="hljs-comment">//     1               </span><font></font>
                str++;                                     <font></font>
        }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de haber reunido todas estas funciones juntas, puede escribir:</font></font><br>
<br>
<pre><code class="cpp hljs">  LCD_SendString(<span class="hljs-string">"  Hello"</span>);<font></font>
  I2C_send(<span class="hljs-number">0b11000000</span>,<span class="hljs-number">0</span>);   <span class="hljs-comment">//  </span>
  LCD_SendString(<span class="hljs-string">"    Habr"</span>);
</code></pre><br>
<img src="https://habrastorage.org/webt/wl/yz/_p/wlyz_pkm6xjhc8pqk9anu93m5n0.jpeg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bueno, descubrimos la pantalla 1602, ahora 2004. La diferencia entre ellos es m√≠nima, incluso este c√≥digo funcionar√° bien. Toda la diferencia se reduce a organizar las direcciones de las celdas en la pantalla. En ambas pantallas, la memoria contiene 80 celdas, en la pantalla 1602, las primeras 16 celdas son responsables de la primera l√≠nea y las celdas 40 a 56 son responsables de la segunda l√≠nea. Las celdas de memoria restantes no se muestran, por lo que si env√≠a 17 caracteres a la pantalla, la √∫ltima no se transferir√° en la segunda l√≠nea, y se grabar√° en una celda de memoria que no tiene salida a la pantalla. Un poco m√°s claro, la memoria se organiza de la siguiente manera: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pz/-u/cp/pz-ucp3k76pfuilzikli5ce_m7g.jpeg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
para usar el avance de l√≠nea, utilic√© el comando </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I2C_send (0b11000000,0);</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , solo va a 40 celdas. La exhibici√≥n de 2004 es m√°s interesante. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La primera fila son las celdas 1 a 20 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La segunda fila son las celdas 40 a 60</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La tercera fila: celdas del 21 al 40 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La cuarta fila: celdas del 60 al 80, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
es decir </font><font style="vertical-align: inherit;">si envias un comando</font></font><br>
<br>
<pre><code class="cpp hljs">LCD_SendString(<span class="hljs-string">"___________________1___________________2___________________3___________________4"</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obtenemos lo siguiente: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/z9/fe/xw/z9fexwtyq9grtdqtnq1bbw7jijm.jpeg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para organizar las transiciones entre l√≠neas, debe mover manualmente el cursor a la celda de memoria deseada, o puede complementar mediante programaci√≥n la funci√≥n. </font><font style="vertical-align: inherit;">Hasta ahora me he decidido por la versi√≥n manual:</font></font><br>
<br>
<pre><code class="cpp hljs">  I2C_send(<span class="hljs-number">0b10000000</span>,<span class="hljs-number">0</span>);   <span class="hljs-comment">//   1 </span>
  LCD_SendString(<span class="hljs-string">"  Hello Habr"</span>);<font></font>
  I2C_send(<span class="hljs-number">0b11000000</span>,<span class="hljs-number">0</span>);   <span class="hljs-comment">//   2 </span>
  LCD_SendString(<span class="hljs-string">" STM32 + LCD 1602"</span>);<font></font>
  I2C_send(<span class="hljs-number">0b10010100</span>,<span class="hljs-number">0</span>);   <span class="hljs-comment">//   3 </span>
  LCD_SendString(<span class="hljs-string">" +LCD 2004A"</span>);<font></font>
  I2C_send(<span class="hljs-number">0b11010100</span>,<span class="hljs-number">0</span>);   <span class="hljs-comment">//   4 </span>
  LCD_SendString(<span class="hljs-string">" library HAL"</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Resultado: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yj/tq/li/yjtqliuuokrq220g_4kyg5lty3y.jpeg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
eso es probablemente todo con estas pantallas, enlaces √∫tiles gracias a los cuales pude resolverlo todo:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El c√≥digo se ve√≠a mucho </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqu√≠</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las tablas para la configuraci√≥n de visualizaci√≥n se miraron </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqu√≠</font></font></a> </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El procedimiento fue mirado </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqu√≠</font></font></a></li>
</ol><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Programa y hoja de datos</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PS: no olvide ajustar el brillo de la pantalla de antemano.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es500994/index.html">Corre hormiga. correr</a></li>
<li><a href="../es500996/index.html">C√≥mo convertirse en ingeniero de DevOps en seis meses o incluso m√°s r√°pido. Parte 1. Introducci√≥n</a></li>
<li><a href="../es501000/index.html">Generaci√≥n de c√≥digo en Go con el ejemplo de crear un cliente para la base de datos</a></li>
<li><a href="../es501002/index.html">Umka: nuevo lenguaje de script est√°ticamente tipado</a></li>
<li><a href="../es501004/index.html">Hazlo. Trabajo</a></li>
<li><a href="../es501008/index.html">Pavimentaci√≥n de domin√≥</a></li>
<li><a href="../es501010/index.html">Linux Kernel TLS y Nginx</a></li>
<li><a href="../es501012/index.html">C√≥mo estaba buscando un motor para ni√±os para un blog</a></li>
<li><a href="../es501016/index.html">Sobre las tendencias de desarrollo de la arquitectura del procesador, o por qu√© creo en el √©xito de Huawei en el mercado de servidores</a></li>
<li><a href="../es501018/index.html">C√≥mo sortear algunas restricciones de Google Translate</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>