<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧖🏾 🤸🏽 👨🏽‍✈️ Code SIL propre 🏜️ ✍🏻 🤚🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="SIL est un langage de programmation pour automatiser le travail dans Atlassian Jira et Confluence. Vous pouvez en savoir plus sur SIL ici .
  
 Je tra...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Code SIL propre</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497866/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIL est un langage de programmation pour automatiser le travail dans Atlassian Jira et Confluence. </font><font style="vertical-align: inherit;">Vous pouvez en savoir plus sur SIL </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<a name="habracut"></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je travaille souvent avec des scripts écrits en SIL, et je voudrais partager avec vous mes réflexions sur la façon de rendre le code SIL «propre». </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet article, je vais d'abord formuler les règles que je respecte lors de l'écriture de code SIL, puis donner un exemple de code et effectuer la refactorisation à l'aide de ces règles.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">règles</font></font></h4><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">structures de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> noms </font><font style="vertical-align: inherit;">commencent par une majuscule.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajoutez des éléments de tableau à l'aide de la méthode </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AddElement</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilisez </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">des routines définies par l'utilisateur</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour diviser votre code en blocs logiques et vous débarrasser des commentaires dans le code.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apportez du code réutilisable aux bibliothèques ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inclusions</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Déclarez les structures avant le reste de la déclaration de variable.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Donnez des noms significatifs aux structures et aux variables, dans ce cas, vous n'avez pas à ajouter de commentaires supplémentaires aux structures et aux variables.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nommez les variables et les fonctions conformément au </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">guide de style Google Java</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons maintenant un exemple de code SIL.</font></font><br>
<br>
<pre><code class="java hljs">string USER = currentUser();
<span class="hljs-comment">// Response</span><font></font>
struct returnData {<font></font>
    string status;<font></font>
}<font></font>
<span class="hljs-comment">// Project</span><font></font>
struct space {<font></font>
    string key;<font></font>
}<font></font>
<span class="hljs-comment">// Inner part with content</span><font></font>
struct storage {<font></font>
    string value;<font></font>
    string representation;<font></font>
}<font></font>
<span class="hljs-comment">// Part for storage</span><font></font>
struct body {<font></font>
    storage storage;<font></font>
}<font></font>
<span class="hljs-comment">// Main entity for sending to Confluence</span><font></font>
struct reqData {<font></font>
    string type;<font></font>
    string title;<font></font>
    space space;<font></font>
    body body;<font></font>
}<font></font>
reqData data;<font></font>
data.type = <span class="hljs-string">"page"</span>;<font></font>
data.title = <span class="hljs-string">"Page for issue "</span> + key + <span class="hljs-string">"  "</span> + summary + <span class="hljs-string">"."</span>;<font></font>
data.space.key = project;<font></font>
data.body.storage.value = <span class="hljs-string">"&lt;p&gt; Author:"</span>+userFullName(USER) + <span class="hljs-string">" description: "</span>  + description + <span class="hljs-string">"&lt;/p&gt;"</span>;<font></font>
data.body.storage.representation = <span class="hljs-string">"storage"</span>;
<span class="hljs-comment">// Create request</span><font></font>
HttpRequest request;<font></font>
HttpHeader header = httpCreateHeader(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"application/json"</span>);<font></font>
HttpHeader authHeader = httpBasicAuthHeader(<span class="hljs-string">"admin"</span>, <span class="hljs-string">"admin"</span>);<font></font>
request.headers += header;<font></font>
request.headers += authHeader;<font></font>
logPrint(<span class="hljs-string">"WARN"</span>, request);
<span class="hljs-comment">//POST</span><font></font>
string JSONData = toJson(data);<font></font>
logPrint(<span class="hljs-string">"WARN"</span>, JSONData);<font></font>
returnData result = httpPost(<span class="hljs-string">"http://192.168.54.203:8090/rest/api/content/"</span>, request, JSONData);<font></font>
string errMsg = httpGetErrorMessage();<font></font>
logPrint(<span class="hljs-string">"ERROR"</span>, <span class="hljs-string">"Last error message: "</span> + errMsg);<font></font>
logPrint(<span class="hljs-string">"WARN"</span>, result);<font></font>
string COMMENT = <span class="hljs-string">"Page created in Confluence "</span> + updated + <span class="hljs-string">" by "</span> + userFullName(USER) + <span class="hljs-string">" Status : "</span> +result.status + <span class="hljs-string">"."</span>; <font></font>
addComment(key, USER, COMMENT);<font></font>
<span class="hljs-comment">//Return Status</span>
<span class="hljs-keyword">return</span> result.status;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En regardant le code, il est assez difficile de déterminer rapidement ce que fait le code. </font><font style="vertical-align: inherit;">Les commentaires dans le code n'aident pas beaucoup non plus. </font><font style="vertical-align: inherit;">Essayons de changer le code selon les règles ci-dessus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Regardez d'abord la structure. </font><font style="vertical-align: inherit;">Voici un exemple:</font></font><br>
<br>
<pre><code class="java hljs">struct body {<font></font>
    storage storage;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous voyons que le «stockage de stockage» semble incompréhensible. </font><font style="vertical-align: inherit;">Il serait plus clair si le code était comme ceci:</font></font><br>
<br>
<pre><code class="java hljs">struct body {<font></font>
    Storage storage;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous voyons maintenant que nous définissons un champ dans la structure sous le nom de stockage de type Stockage. </font><font style="vertical-align: inherit;">Pour que nous puissions écrire un tel code, nous devons mettre en majuscule la première lettre de chaque structure:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-comment">// Response</span><font></font>
struct ReturnData {<font></font>
    string status;<font></font>
}<font></font>
<span class="hljs-comment">// Project</span><font></font>
struct Space {<font></font>
    string key;<font></font>
}<font></font>
<span class="hljs-comment">// Inner part with content</span><font></font>
struct Storage {<font></font>
    string value;<font></font>
    string representation;<font></font>
}<font></font>
<span class="hljs-comment">// Part for storage</span><font></font>
struct Body {<font></font>
    Storage storage;<font></font>
}<font></font>
<span class="hljs-comment">// Main entity for sending to Confluence</span><font></font>
struct ReqData {<font></font>
    string type;<font></font>
    string title;<font></font>
    Space space;<font></font>
    Body body;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, renommons la structure afin que le nom de la structure indique clairement pourquoi elle est nécessaire, et nous n'aurions pas à ajouter de commentaires:</font></font><br>
<br>
<pre><code class="java hljs">struct Space {<font></font>
    string key;<font></font>
}<font></font>
struct Storage {<font></font>
    string value;<font></font>
    string representation;<font></font>
}<font></font>
struct Body {<font></font>
    Storage storage;<font></font>
}<font></font>
struct CreateConfluencePageRequest {<font></font>
    string type;<font></font>
    string title;<font></font>
    Space space;<font></font>
    Body body;<font></font>
}<font></font>
struct CreateConfluencePageResponse {<font></font>
    string status;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À mon avis, de tels noms ne nécessitent pas de commentaires supplémentaires pour les structures. </font><font style="vertical-align: inherit;">Nous déclarerons également les structures au tout début du code. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons utilisé les règles 1, 5, 6. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Regardons maintenant le code après la déclaration des structures:</font></font><br>
<br>
<pre><code class="java hljs">string USER = currentUser();<font></font>
CreateConfluencePageRequest data;<font></font>
data.type = <span class="hljs-string">"page"</span>;<font></font>
data.title = <span class="hljs-string">"Page for issue "</span> + key + <span class="hljs-string">"  "</span> + summary + <span class="hljs-string">"."</span>;<font></font>
data.space.key = project;<font></font>
data.body.storage.value = <span class="hljs-string">"&lt;p&gt; Author:"</span>+userFullName(USER) + <span class="hljs-string">" description: "</span>  + description + <span class="hljs-string">"&lt;/p&gt;"</span>;<font></font>
data.body.storage.representation = <span class="hljs-string">"storage"</span>;
<span class="hljs-comment">// Create request</span><font></font>
HttpRequest request;<font></font>
HttpHeader header = httpCreateHeader(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"application/json"</span>);<font></font>
HttpHeader authHeader = httpBasicAuthHeader(<span class="hljs-string">"admin"</span>, <span class="hljs-string">"admin"</span>);<font></font>
request.headers += header;<font></font>
request.headers += authHeader;<font></font>
logPrint(<span class="hljs-string">"WARN"</span>, request);
<span class="hljs-comment">//POST</span><font></font>
string JSONData = toJson(data);<font></font>
logPrint(<span class="hljs-string">"WARN"</span>, JSONData);<font></font>
CreateConfluencePageResponse result = httpPost(<span class="hljs-string">"http://192.168.54.203:8090/rest/api/content/"</span>, request, JSONData);<font></font>
string errMsg = httpGetErrorMessage();<font></font>
logPrint(<span class="hljs-string">"ERROR"</span>, <span class="hljs-string">"Last error message: "</span> + errMsg);<font></font>
logPrint(<span class="hljs-string">"WARN"</span>, result);<font></font>
string COMMENT = <span class="hljs-string">"Page created in Confluence "</span> + updated + <span class="hljs-string">" by "</span> + userFullName(USER) + <span class="hljs-string">" Status : "</span> +result.status + <span class="hljs-string">"."</span>; <font></font>
addComment(key, USER, COMMENT);<font></font>
<span class="hljs-comment">//Return Status</span>
<span class="hljs-keyword">return</span> result.status;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En regardant le code, nous ne pouvons pas comprendre rapidement ce qui se passe dans le code. </font><font style="vertical-align: inherit;">Essayons d'abord de diviser le code en blocs logiques:</font></font><br>
<br>
<pre><code class="java hljs">getNewConfluencePageContent();<font></font>
createHttpRequest();<font></font>
createConfluencePage();<font></font>
addCommentToJiraIssue();<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est-à-dire que nous obtenons d'abord le contenu de la nouvelle page dans Confluence, puis créons une demande http, créons une page dans Confluence et écrivons un commentaire dans la demande Jira que la page dans Confluence est créée. </font><font style="vertical-align: inherit;">Maintenant, implémentons ces fonctions:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function">function <span class="hljs-title">getNewConfluencePageContent</span><span class="hljs-params">()</span> </span>{<font></font>
    CreateConfluencePageRequest data;<font></font>
    data.type = <span class="hljs-string">"page"</span>;<font></font>
    data.title = <span class="hljs-string">"Page for issue "</span> + key + <span class="hljs-string">"  "</span> + summary + <span class="hljs-string">"."</span>;<font></font>
    data.space.key = project;<font></font>
    data.body.storage.value = <span class="hljs-string">"&lt;p&gt; Author:"</span>+userFullName(currentUser()) + <span class="hljs-string">" description: "</span>  + description + <span class="hljs-string">"&lt;/p&gt;"</span>;<font></font>
    data.body.storage.representation = <span class="hljs-string">"storage"</span>;
    <span class="hljs-keyword">return</span> toJson(data);<font></font>
}<font></font>
<font></font>
<span class="hljs-function">function <span class="hljs-title">createHttpRequest</span><span class="hljs-params">()</span> </span>{<font></font>
    HttpRequest request;<font></font>
    HttpHeader header = httpCreateHeader(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"application/json"</span>);<font></font>
    HttpHeader authHeader = httpBasicAuthHeader(<span class="hljs-string">"admin"</span>, <span class="hljs-string">"admin"</span>);<font></font>
    request.headers = addElement(request.headers, header);<font></font>
    request.headers += addElement(request.headers, authHeader);<font></font>
    logPrint(<span class="hljs-string">"WARN"</span>, request);
    <span class="hljs-keyword">return</span> request;<font></font>
}<font></font>
<font></font>
<span class="hljs-function">function <span class="hljs-title">createConfluencePage</span><span class="hljs-params">(string pageJson)</span> </span>{<font></font>
    HttpRequest request = createHttpRequest();<font></font>
    CreateConfluencePageResponse result = httpPost(<span class="hljs-string">"http://192.168.54.203:8090/rest/api/content/"</span>, request, pageJson);<font></font>
    logPrint(<span class="hljs-string">"ERROR"</span>, <span class="hljs-string">"Last error message: "</span> + httpGetErrorMessage());<font></font>
    logPrint(<span class="hljs-string">"WARN"</span>, result);
    <span class="hljs-keyword">return</span> result;<font></font>
}<font></font>
<font></font>
<span class="hljs-function">function <span class="hljs-title">addCommentToJiraIssue</span><span class="hljs-params">(string resultStatus)</span> </span>{<font></font>
    string COMMENT = <span class="hljs-string">"Page created in Confluence "</span> + updated + <span class="hljs-string">" by "</span> + userFullName(currentUser()) + <span class="hljs-string">" Status : "</span> +resultStatus + <span class="hljs-string">"."</span>; <font></font>
    addComment(key, currentUser(), COMMENT);<font></font>
}<font></font>
<font></font>
string pageJson = getNewConfluencePageContent();<font></font>
CreateConfluencePageResponse result = createConfluencePage(pageJson);<font></font>
addCommentToJiraIssue(result.status);<font></font>
<span class="hljs-keyword">return</span> result.status;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons supprimé les blocs logiques de la fonction (règle 2). </font><font style="vertical-align: inherit;">Maintenant, nous pouvons simplement écrire le code comme ceci:</font></font><br>
<br>
<pre><code class="java hljs">string pageJson = getNewConfluencePageContent();<font></font>
CreateConfluencePageResponse result = createConfluencePage(pageJson);<font></font>
addCommentToJiraIssue(result.status);<font></font>
<span class="hljs-keyword">return</span> result.status;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre code contient quatre blocs logiques. </font><font style="vertical-align: inherit;">Nous obtenons d'abord le json de la nouvelle page, puis créons la page dans Confluence, ajoutez un commentaire à la demande et renvoyons le statut de création de page à Confluence. </font><font style="vertical-align: inherit;">Ces quatre lignes nous donnent une vue globale de ce que fait le script. </font><font style="vertical-align: inherit;">Si nous voulons comprendre le contenu de la page dans Confluence, alors nous pouvons toujours aller sur getNewConfluencePageContent et voir le contenu de cette fonction. </font><font style="vertical-align: inherit;">Cette fonction ne contient que du code pour créer le contenu de la page et rien de plus, ainsi, tout en étudiant le code de fonction, nous ne serons pas distraits par d'autres fonctionnalités.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous pouvons supposer que nous devrons créer des pages dans Confluence non seulement à partir d'un script. </font><font style="vertical-align: inherit;">Par conséquent, créons le fichier confluence_helper.incl et mettons toutes les fonctions nécessaires pour créer une page dans Confluence dans ce fichier:</font></font><br>
<br>
<pre><code class="java hljs">struct Space {<font></font>
    string key;<font></font>
}<font></font>
struct Storage {<font></font>
    string value;<font></font>
    string representation;<font></font>
}<font></font>
struct Body {<font></font>
    Storage storage;<font></font>
}<font></font>
struct CreateConfluencePageRequest {<font></font>
    string type;<font></font>
    string title;<font></font>
    Space space;<font></font>
    Body body;<font></font>
}<font></font>
struct CreateConfluencePageResponse {<font></font>
    string status;<font></font>
}<font></font>
<font></font>
<span class="hljs-function">function <span class="hljs-title">createHttpRequest</span><span class="hljs-params">()</span> </span>{<font></font>
    HttpRequest request;<font></font>
    HttpHeader header = httpCreateHeader(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"application/json"</span>);<font></font>
    HttpHeader authHeader = httpBasicAuthHeader(<span class="hljs-string">"admin"</span>, <span class="hljs-string">"admin"</span>);<font></font>
    request.headers = addElement(request.headers, header);<font></font>
    request.headers += addElement(request.headers, authHeader);<font></font>
    logPrint(<span class="hljs-string">"INFO"</span>, request);
    <span class="hljs-keyword">return</span> request;<font></font>
}<font></font>
<font></font>
<span class="hljs-function">function <span class="hljs-title">createConfluencePage</span><span class="hljs-params">(string confluenceUrl, string pageJson)</span> </span>{<font></font>
    HttpRequest request = createHttpRequest();<font></font>
    CreateConfluencePageResponse result = httpPost(confluenceUrl, request, pageJson);<font></font>
    logPrint(<span class="hljs-string">"ERROR"</span>, <span class="hljs-string">"Last error message: "</span> + httpGetErrorMessage());<font></font>
    logPrint(<span class="hljs-string">"INFO"</span>, result);
    <span class="hljs-keyword">return</span> result;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai rendu la fonction createConfluencePage plus générale en y ajoutant un autre paramètre confluenceUrl. </font><font style="vertical-align: inherit;">Ainsi, nous avons suivi la règle 4. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, notre script principal ressemblera à ceci:</font></font><br>
<br>
<pre><code class="java hljs">include <span class="hljs-string">"confluence_helper.incl"</span>;<font></font>
<font></font>
<span class="hljs-function">function <span class="hljs-title">getNewConfluencePageContent</span><span class="hljs-params">()</span> </span>{<font></font>
    CreateConfluencePageRequest data;<font></font>
    data.type = <span class="hljs-string">"page"</span>;<font></font>
    data.title = <span class="hljs-string">"Page for issue "</span> + key + <span class="hljs-string">"  "</span> + summary + <span class="hljs-string">"."</span>;<font></font>
    data.space.key = project;<font></font>
    data.body.storage.value = <span class="hljs-string">"&lt;p&gt; Author:"</span>+userFullName(currentUser()) + <span class="hljs-string">" description: "</span>  + description + <span class="hljs-string">"&lt;/p&gt;"</span>;<font></font>
    data.body.storage.representation = <span class="hljs-string">"storage"</span>;
    <span class="hljs-keyword">return</span> toJson(data);<font></font>
}<font></font>
<font></font>
<span class="hljs-function">function <span class="hljs-title">addCommentToJiraIssue</span><span class="hljs-params">(string resultStatus)</span> </span>{<font></font>
    string comment = <span class="hljs-string">"Page created in Confluence "</span> + updated + <span class="hljs-string">" by "</span> + userFullName(currentUser()) + <span class="hljs-string">" Status : "</span> +resultStatus + <span class="hljs-string">"."</span>; <font></font>
    addComment(key, currentUser(), comment);<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-keyword">const</span> string CONFLUENCE_URL = <span class="hljs-string">"http://192.168.54.203:8090/rest/api/content/"</span>;<font></font>
<font></font>
string pageJson = getNewConfluencePageContent();<font></font>
CreateConfluencePageResponse result = createConfluencePage(CONFLUENCE_URL, pageJson);<font></font>
addCommentToJiraIssue(result.status);<font></font>
<span class="hljs-keyword">return</span> result.status;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la première ligne, j'ai inclus le fichier confluence_helper.incl pour utiliser la fonction de création de page dans Confluence à partir de celui-ci. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai enregistré l'adresse Confluence dans une variable constante et changé les noms de variable conformément au style de notation Google Java (règle 7). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il me semble que cela peut être arrêté avec un refactoring. </font><font style="vertical-align: inherit;">À la suite de la refactorisation, nous avons obtenu une fonction de création de page réutilisable dans Confluence, et notre code est devenu plus lisible et pris en charge.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr497856/index.html">Boost Converter: DCM vs CCM. Ou pourquoi ne pas avoir peur de le prendre vous-même</a></li>
<li><a href="../fr497858/index.html">Besoins importants en mémoire sous Android - que faire?</a></li>
<li><a href="../fr497860/index.html">Génération de modèles de conception dans ES6 + sur l'exemple de Game of Thrones</a></li>
<li><a href="../fr497862/index.html">Pourquoi ne pas supprimer tous les éléments du tableau en le réaffectant à []?</a></li>
<li><a href="../fr497864/index.html">(S) SDLC, ou Comment rendre le développement plus sûr. Partie 1</a></li>
<li><a href="../fr497870/index.html">Virus informatiques: une histoire d'espions domestiques inoffensifs aux voleurs de cartes bancaires</a></li>
<li><a href="../fr497872/index.html">Facteurs inhabituels et assez évidents affectant le trafic des réseaux d'entreprise et le travail des prestataires</a></li>
<li><a href="../fr497874/index.html">David Heinemeyer Hansson (Basecamp, ReWork, Ruby on Rails) sur son fonctionnement</a></li>
<li><a href="../fr497876/index.html">[signet] Travailler avec des images sur le Web</a></li>
<li><a href="../fr497878/index.html">Installer la version GPL de HPL avec OpenBLAS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>