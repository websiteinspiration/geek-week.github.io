<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔌 👼🏼 🏍️ Verwalten von Arduino über das Internet mit einem PC - Anfängererfahrung 💃🏻 🐵 ⭕️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo alle zusammen. In diesem Artikel werde ich darüber sprechen, wie ich es geschafft habe, die Arduino-Steuerung über das Internet mithilfe eines m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Verwalten von Arduino über das Internet mit einem PC - Anfängererfahrung</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/491616/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hallo alle zusammen. </font><font style="vertical-align: inherit;">In diesem Artikel werde ich darüber sprechen, wie ich es geschafft habe, die Arduino-Steuerung über das Internet mithilfe eines mit dem Internet verbundenen PCs zu implementieren. </font><font style="vertical-align: inherit;">Im Allgemeinen kann dieses Verfahren für jeden Mikrocontroller verwendet werden, beispielsweise für PIC. </font><font style="vertical-align: inherit;">Die Methode ist ziemlich eiche, es gibt viel zu modernisieren und es gibt viel fortgeschrittenere Schemata, aber im einfachsten Fall ist dies genug.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anstatt mitzumachen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich möchte gleich sagen, dass ich in diesem Artikel nicht sehr tief auf die Feinheiten der Programmierung eingehen werde. Es wird davon ausgegangen, dass der Leser zumindest über minimale Grundlagen verfügt. </font><font style="vertical-align: inherit;">Ich werde Ihnen allgemein sagen, wie Ressourcen verwendet wurden und über interessante Punkte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voraussetzungen für die Erstellung dieser Methode, die ich bei der Erstellung meines Elektroautos hatte: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zhmyak hier! </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich muss sofort sagen, dass es mehr und mehr aus sportlichem Interesse als für ernsthafte praktische Arbeit geschaffen wurde, aber es funktioniert trotzdem und kann für jemanden nützlich sein.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Worauf baut das gesamte System auf und wie ist es in der Hardware implementiert?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Arbeitsschema ist wie folgt: Vom Server lesen wir die Datei, in der die Daten gespeichert sind, mit dem Programm, das auf dem PC / Laptop ausgeführt wird. Dieses Programm sendet über USB Daten an die Steuerung. Die Steuerung empfängt Daten und führt Aktionen für sie aus. Das Schema mit dem Server ist insofern attraktiv, als Sie das Schema ohne Anwendung steuern können, indem Sie die Site einfach von jedem Smartphone / Tablet / PC / Laptop auf der ganzen Welt aus besuchen, wo es Internetzugang gibt. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS. Informationen zur Serverseite finden Sie weiter unten.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In diesem Artikel werde ich das Arduino MEGA 2560 (das chinesische Gegenstück) steuern, aber hinter den Kulissen funktionierte die Schaltung reibungslos mit dem PIC16F877A. Das einzige, was ich verwenden musste, war der USB-TTL-Adapter: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yd/zx/7m/ydzx7myngxgoecwxi6t1gkzxtc4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist klar, dass sich das PIC-Programm aufgrund anderer Unterschiede geringfügig vom Arduino-Programm unterscheidet Arten von MK, aber das Prinzip ist das gleiche:</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir empfangen Daten über den COM-Port, vergleichen sie mit der internen Befehlstabelle und führen die entsprechende Aktion aus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Schema schien mir anfangs sehr einfach zu sein, aber es gab ein ABER - es gab kein Programm, das die Datei im Internet lesen und Daten an den COM-Port senden würde. Dementsprechend musste ich ein solches Programm schreiben.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Programm wurde auf VB6 geschrieben. Zum Lesen der Datei vom Server wird die VB6-Komponente verwendet: Microsoft Internet Transfer Control 6.0. Mit seiner Hilfe wird eine Textdatei auf dem Server einfach in eine Zeichenfolgenvariable eingelesen. Nach dem Lesen dieser Zeile wird sie mit der VB6-Komponente Microsoft Comm Control 6.0 an den COM-Port gesendet. Der gesamte Vorgang des Lesens einer Datei und des Sendens einer Zeile wird mithilfe eines Timers in einer Schleife gelesen. Das Timer-Intervall kann in der Programmkonfiguration oder direkt während des Betriebs geändert werden. Außerdem können Sie die Betriebsart des Ports, seine Nummer, die Funktionsweise der Internetverbindung und einen Link zur lesbaren Datei auswählen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich möchte eine Bemerkung machen, dass das Programm bei großen Dateien und kleinen Lücken einfriert, aber weiterhin funktioniert. Die Puffergröße meines Programms beträgt 512 Bytes. Da mein MK weniger Puffer hat, reicht dies aus.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein wichtiger Punkt. </font><font style="vertical-align: inherit;">Ein Programm in MK kann keine Daten analysieren, sondern nur lesen, welches Zeichen über die serielle Schnittstelle an den Eingang übertragen wurde. </font><font style="vertical-align: inherit;">Ohne Fehler konnte ich das lateinische Alphabet akzeptieren (26 Zeichen AZ und 10 Ziffern 0-9). </font><font style="vertical-align: inherit;">Insgesamt 36 Teams können alle Daten übertragen, wenn der Algorithmus fertiggestellt und die Datenanalyse in den MK eingeführt wurde. </font><font style="vertical-align: inherit;">Es besteht auch die Möglichkeit, Software für den bidirektionalen Datenaustausch zu „dotieren“.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serverauswahl und Serverseite</font></font></h2><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auf der Serverseite hätte jeder Server mit PHP-Unterstützung</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , selbst wenn er auf einem PC ausgeführt wird, nur eine statische IP, aber ich persönlich verwende einen gemieteten Jino. </font><font style="vertical-align: inherit;">Der Serverteil in meinem Beispiel besteht aus zwei Dateien: HTML-Seiten mit einem Formular mit EIN / AUS-Schaltflächen für eine LED und einem PHP-Skript, das den Inhalt einer TXT-Datei ändert, aus der ein auf einem PC ausgeführtes Programm Daten liest.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Software</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HTML Quelltext </font><font style="vertical-align: inherit;">Form mit 2 Tasten, Ein / Aus-LED auf der Platine:</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span> <span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>  
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"work.php"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"post"</span>&gt;</span><font></font>
:<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"sv"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"On"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"sv"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Off"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>    
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>    
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PHP-Code, hier schreiben wir den Befehl A in die Datei, wenn die LED leuchten soll, und B, wenn sie erlöschen soll:</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span>
$cm = fopen(<span class="hljs-string">"command.txt"</span>, <span class="hljs-string">"w"</span>);
<span class="hljs-keyword">switch</span> ($_POST[<span class="hljs-string">'sv'</span>]) {
<span class="hljs-keyword">case</span> <span class="hljs-string">"On"</span>:<font></font>
fwrite($cm,<span class="hljs-string">"a"</span>);    
    <span class="hljs-keyword">break</span>;   
<span class="hljs-keyword">case</span> <span class="hljs-string">"Off"</span>:<font></font>
fwrite($cm,<span class="hljs-string">"b"</span>);    
    <span class="hljs-keyword">break</span>;  <font></font>
}<font></font>
fclose($cm); <font></font>
<span class="hljs-meta">?&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun der eigentliche Code für Arduino:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">int</span> val; <span class="hljs-comment">//      </span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{<font></font>
Serial.begin(<span class="hljs-number">9600</span>); <span class="hljs-comment">//   </span>
pinMode(<span class="hljs-number">13</span>, OUTPUT); <span class="hljs-comment">//   13  </span><font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{
<span class="hljs-comment">// ,   - </span>
<span class="hljs-keyword">if</span> (Serial.available()) {<font></font>
val = Serial.read(); <span class="hljs-comment">//  val   </span>
<span class="hljs-keyword">if</span> (val == <span class="hljs-string">'a'</span>) {digitalWrite(<span class="hljs-number">13</span>, HIGH);} <span class="hljs-comment">//  a  </span>
<span class="hljs-keyword">if</span> (val == <span class="hljs-string">'b'</span>) {digitalWrite(<span class="hljs-number">13</span>, LOW);} <span class="hljs-comment">//  b  </span><font></font>
}}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Programm selbst zum Lesen von Informationen auf dem Server mit Weiterleitung an den COM-Port und dessen Quellcode befindet sich im Archiv unter folgendem Link: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yandex-Disk Das</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Programm ist in mehrere Versionen des Codes kompiliert, es kann einige Unterschiede im Betrieb geben, sollte es aber nicht sein. </font><font style="vertical-align: inherit;">Beim ersten Start der EXE-Datei werden eine Hilfedatei und eine Konfigurationsdatei generiert. </font><font style="vertical-align: inherit;">Daten aus dieser Datei werden beim Start des Programms gelesen, sofern vorhanden. </font><font style="vertical-align: inherit;">Wenn die Datei nicht vorhanden ist (z. B. beim ersten Start des Programms), wird die Konfigurationsdatei mit Standardwerten erstellt.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arbeitsergebnisse</font></font></h2><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/in_3FCOodP4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anstelle einer Schlussfolgerung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Beispiel habe ich einen einfachen "Eichen" -Algorithmus implementiert, der funktioniert. </font><font style="vertical-align: inherit;">Es gibt natürlich Möglichkeiten, sich weiterzuentwickeln, aber dennoch können bereits 36 Teams in dieser Form geschickt werden. </font><font style="vertical-align: inherit;">Wenn Sie das Parsen eingehender Daten im Mikrocontroller implementieren, können Sie beliebige Daten übertragen. </font><font style="vertical-align: inherit;">Für meine Aufgaben werden 36 Teams mit dem Kopf ausreichen, und außerdem ist dies die Erfahrung eines Anfängers :)</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de491606/index.html">So erstellen Sie ein Startmenü und eine Minikarte</a></li>
<li><a href="../de491608/index.html">Animationstipps von Cuphead und God of War</a></li>
<li><a href="../de491610/index.html">Deklarative Datenfilterung vorne. Js / ts</a></li>
<li><a href="../de491612/index.html">Vergleich der Dynamik von Notierungen zweier Aktien in Python am Beispiel von Vorzugs- und Stammaktien der Sberbank</a></li>
<li><a href="../de491614/index.html">Warum Masterhost zum Scheitern verurteilt war: ein Einblick</a></li>
<li><a href="../de491618/index.html">Warum sterben ethnische und Programmiersprachen aus und wie helfen sie, sie in sozialen Netzwerken zu retten?</a></li>
<li><a href="../de491620/index.html">Was macht Cypress ideal für Anfänger in der Automatisierung?</a></li>
<li><a href="../de491622/index.html">Prognostizieren Sie Finanzkrisen mit Python</a></li>
<li><a href="../de491624/index.html">Erstellen eines Gliederungseffekts in der Unity Universal Render-Pipeline</a></li>
<li><a href="../de491628/index.html">Spelunky als Beispiel für gutes Spieldesign</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>