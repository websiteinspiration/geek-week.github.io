<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëÅÔ∏è üê¢ ü¶Ä Spam, spam, spam ... üöÅ üôåüèæ ü§∑üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Each active subscriber receives an average of more than four unwanted calls per week - this is advertising, bank offers, sometimes just fraud. Most cu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Spam, spam, spam ...</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ru_mts/blog/488828/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Each active subscriber receives an average of more than four unwanted calls per week - this is advertising, bank offers, sometimes just fraud. </font><font style="vertical-align: inherit;">Most customers react negatively to these types of calls. </font><font style="vertical-align: inherit;">To solve this problem, we developed the ‚ÄúSpam Call Blocking‚Äù service, by connecting which the user stops receiving unwanted calls, and at the end of each day the system notifies the subscriber about calls that have been blocked. </font><font style="vertical-align: inherit;">In this article, MTS data scientists Anna Rozhkova ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@RogotulkA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) and Olga Gerasimova ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ynonaolga</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) will tell how they developed an algorithm that distinguishes spammers numbers from the rest of the subscriber base.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/rv/0j/16/rv0j16anuibqqp6u6xieglpbujo.jpeg"></div><br>
<a name="habracut"></a><br>
<h2><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Model building</font></font></b></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, we were faced with the task of binary classification.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Indeed, how to distinguish a subscriber (even a very sociable, with a wide range of new contacts) from a spammer who tirelessly imposes the services of another medical center? At first, we considered those numbers that phoned many different subscribers as spam, but it turned out to be difficult to distinguish from online stores. Then we decided to take the numbers, whose calls are often dropped, but people sometimes drop calls when they are just not comfortable talking. We also tested the hypothesis that subscribers will not call back to spammers (within a short period of time after a missed call), but there were too many such numbers, perhaps for some subscribers this is a standard behavior, they do not call back to friends. As a result, we came to the decision that spam numbers differ in the level of user dissatisfaction with them. Therefore as</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the target variable</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> was taken numbers, which received a lot of complaints, and negative examples were marked out those that have few negative reviews or none at all. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aggregated data of the subscriber activity of the subscribers were used as signs: the average duration of calls, the periods of the day with the highest activity, the average duration of a break between calls, the speed of updating the circle of contacts, and many others. </font><font style="vertical-align: inherit;">We also noticed that many spammers select ‚Äúbeautiful numbers‚Äù or similar to known existing ones (for example, the bank‚Äôs hotline number) and add such binary features.‚ÄØ</font></font><br>
<br>
<h2><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Metric Selection</font></font></b></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The next step was to choose an optimization metric. In our decision, it was important not to block calls from ordinary numbers, so we determined that the accuracy of the model should be at least 95%. Precision is the percentage of numbers recognized as spam class objects that the model correctly predicted. But it is important to block as many unwanted numbers as possible, so choose the maximum recall (recall) for an acceptable level of accuracy. The final version of the model has the following indicators: 95% precision, recall 94%. Now the model is on the schedule and is regularly retrained to note changes in the call activity of various groups of subscribers, and these metrics are checked so that they do not fall below 90% each.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/oa/hm/nh/oahmnhcygk2ifjeivsddcju75-i.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Due to the fact that spam numbers are much smaller than usual, that is, the sample is unbalanced, the number of negative examples was reduced relative to positive ones (undersampling). In the validation sample, the class ratio was chosen real in order to have an idea of ‚Äã‚Äãthe quality of the model ‚Äúin battle‚Äù. Also, only those spam numbers that were active on a certain date due to the inconsistency of spammers were included in the sample: there are periods of active dialing, and there is a period of passivity when they make several calls, most likely to maintain the number. Sometimes the numbers after the campaign are blocked and transferred to another owner.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As an algorithm, the implementation of xgboost boosting was used, since it gave the best results on the validation sample. </font><font style="vertical-align: inherit;">Important signs for the model turned out to be: data on the activity of subscribers at different times of the day, the number of short calls, the breadth of the circle of friends. </font><font style="vertical-align: inherit;">An interesting fact was that the feature of the telecom operator entered the top features. </font><font style="vertical-align: inherit;">Below on the chart we anonymized mobile operators and presented statistics on the use of their numbers by spammers:</font></font><br>
<br>
<div style="text-align:center;"><img width="75%" src="https://habrastorage.org/webt/a5/d9/iu/a5d9iuohyewmhckgyyd52moc-fq.jpeg"></div><br>
<h2><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testing</font></font></b></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this task, it was not possible to conduct A / B testing: the service at the network level does not imply the existence of various lists of spam numbers, so we launched the pilot of the first version of the model inside the company, colleagues and top management became testers. </font><font style="vertical-align: inherit;">One of the positive features of internal testing is quick feedback. </font><font style="vertical-align: inherit;">We immediately began to pour questions:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">why did this number get through? </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">why did you block this number? </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I do not need another car insurance (how much can I ?!)</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Our personal experience also became an additional reason to search for new features for the model, when after a long wait for delivery from the online store, the courier's phone was found in the list of blocked ones. </font></font><br>
<br>
<h2><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Launch in prod</font></font></b></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Another serious problem in the classification of numbers was the difference in ideas about what spam is: for some, calls with a loan offer are unnecessary information, and someone is waiting for personal offers and choosing the best one, so the subscriber was given the opportunity to view the list of callers numbers with the option to disable those that are potentially useful to him.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/jy/qn/qc/jyqnqcqdqssy_guhaqyntaziueu.png" width="45%"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One of the most popular requests from users to finalize the service was to expand the informational content of the SMS report on daily blocked numbers with data on call categories, for example, banks, medical services or real estate. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first versions of the model were built on features collected over a long period of time, but we noticed that the model often does not consider numbers that appeared recently to be spam, i.e. new numbers or those that started active caller calls after a period of ‚Äúsilence‚Äù. To solve this problem, we built an additional model on features collected over a shorter period. It was not enough to add ‚Äúshort‚Äù features to the training showcase, since the training samples themselves are different: subscribers who are active for a long and short periods of time do not match.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Our further plans for the development of the product include the creation of individual spam lists, taking into account the profile of the client and his needs, transferring the model to online mode, so that it catches the peak of spammers' activity starting here and now.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en488816/index.html">How we lost Mir: a fire at a space station, a collision with a Progress truck, depressurization</a></li>
<li><a href="../en488818/index.html">Breakthroughs #DeepPavlov in 2019: review and results of the year</a></li>
<li><a href="../en488820/index.html">How not to burn out at work and what to do if you still burn out</a></li>
<li><a href="../en488824/index.html">DGTL Design Community Meetup at Raiffeisenbank: Broadcast</a></li>
<li><a href="../en488826/index.html">Recognize privilege escalation in ABBYY FineReader</a></li>
<li><a href="../en488830/index.html">Internet in Turkmenistan: price, availability and restrictions</a></li>
<li><a href="../en488832/index.html">Surprisingly, last year, corporate HDDs were more popular than SSDs and their sales are growing</a></li>
<li><a href="../en488834/index.html">How the error from 2009 causes a conflict between Docker for Windows and Razer Synapse</a></li>
<li><a href="../en488836/index.html">Some aspects of working with Dictionary when developing loaded applications</a></li>
<li><a href="../en488842/index.html">Catch an electron: observing a process that takes a quintillionth of a second</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>