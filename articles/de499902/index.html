<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚åõÔ∏è üõéÔ∏è üëäüèª Funktionsweise von TCP Reset Attack üë©üèΩ‚Äçüè´ ‚Ñ¢Ô∏è üçÆ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ein TCP-Reset-Angriff wird mit einem einzelnen Datenpaket ausgef√ºhrt, das nicht gr√∂√üer als einige Bytes ist. Das durch Angreifer ersetzte und √ºbertrag...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Funktionsweise von TCP Reset Attack</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/499902/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein TCP-Reset-Angriff wird mit einem einzelnen Datenpaket ausgef√ºhrt, das nicht gr√∂√üer als einige Bytes ist. </font><font style="vertical-align: inherit;">Das durch Angreifer ersetzte und √ºbertragene TCP-Segment t√§uscht die beiden Opfer vor, die TCP-Verbindung zu beenden, und unterbricht die Verbindung zwischen ihnen, was kritisch sein kann.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d0e/768/854/d0e7688544d90ce84fd01f7aae77b348.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Angriff hatte Konsequenzen in der realen Welt. </font><font style="vertical-align: inherit;">Bef√ºrchtungen hinsichtlich seiner Verwendung wurden durch die Einf√ºhrung von √Ñnderungen am TCP-Protokoll selbst verursacht. </font><font style="vertical-align: inherit;">Es wird angenommen, dass der Angriff ein wesentlicher Bestandteil der Great Chinese Firewall (Golden Shield) ist, mit der die chinesische Regierung das Internet au√üerhalb Chinas zensiert. </font><font style="vertical-align: inherit;">Trotz ihres beeindruckenden Hintergrunds erfordert das Verst√§ndnis der Mechanismen hinter diesem Angriff nicht unbedingt gr√ºndliche Kenntnisse √ºber TCP. </font><font style="vertical-align: inherit;">Nat√ºrlich kann Ihnen ein Verst√§ndnis der Feinheiten viel √ºber die Funktionen der Implementierung des TCP-Protokolls beibringen, und wie wir gleich sehen werden, k√∂nnen Sie diesen Angriff sogar mit nur einem Laptop gegen sich selbst ausf√ºhren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Beitrag haben wir:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lernen Sie die Grundlagen von TCP</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erfahren Sie, wie der Angriff funktioniert.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lassen Sie uns mit einem einfachen Python-Skript einen Angriff gegen uns selbst durchf√ºhren.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bevor wir beginnen, die Mechanik des Angriffs zu analysieren, wollen wir zun√§chst sehen, wie er in der realen Welt verwendet wird.</font></font><a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie wird ein TCP-Reset-Angriff in der Great Firewall verwendet?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Great Firewall (GFW) ist eine Reihe von Systemen und Techniken, mit denen die chinesische Regierung das Internet f√ºr interne chinesische Benutzer zensiert. </font><font style="vertical-align: inherit;">GFW blockiert und unterbricht aktiv Verbindungen mit Servern innerhalb und au√üerhalb des Landes und √ºberwacht passiv den Internetverkehr mit verbotenen Inhalten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um zu verhindern, dass Benutzer √ºberhaupt eine Verbindung zu gesperrten Servern herstellen, verwendet GFW Techniken wie </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DNS-Verschmutzung</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IP-Blockierung</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(beide kosten separate Artikel). </font><font style="vertical-align: inherit;">Manchmal muss es der GFW-Firewall jedoch gestattet sein, eine Verbindung herzustellen, diese jedoch in der Mitte zu unterbrechen. </font><font style="vertical-align: inherit;">Dies ist beispielsweise erforderlich, wenn Sie eine langsame, ausstehende Analyse der Verbindung durchf√ºhren m√∂chten, z. B. ihre Korrelation mit anderen Aktionen. </font><font style="vertical-align: inherit;">Oder es wird verwendet, wenn die Firewall die w√§hrend des Verbindungsprozesses ausgetauschten Daten analysieren und anhand dieser Informationen entscheiden muss, ob sie fortgesetzt oder blockiert werden sollen. </font><font style="vertical-align: inherit;">Beispielsweise kann der Verkehr zu einer Nachrichtenwebsite zugelassen werden, Videos mit verbotenen Schl√ºsselw√∂rtern werden jedoch zensiert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daf√ºr ben√∂tigt GFW Tools, mit denen bereits bestehende Verbindungen unterbrochen werden k√∂nnen. </font><font style="vertical-align: inherit;">Ein solches Tool ist ein TCP-Reset-Angriff.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie funktioniert ein TCP-Reset-Angriff?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei einem TCP-Reset-Angriff unterbricht der Angreifer die Verbindung zwischen den beiden Opfern und sendet eine oder beide gef√§lschte Nachrichten, in denen er sie auffordert, die Verbindung sofort zu trennen. Diese Nachrichten werden als </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCP-R√ºcksetzsegmente bezeichnet</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Im normalen Betrieb ohne Beteiligung eines Angreifers senden Computer TCP-Drop-Segmente, wenn sie unerwarteten TCP-Verkehr empfangen und m√∂chten, dass der Absender den Versand beendet.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der TCP-Reset-Angriff nutzt diesen Mechanismus b√∂swillig aus und bringt die Opfer dazu, TCP-Verbindungen vorzeitig zu beenden, und sendet ihnen gef√§lschte Reset-Segmente. Wenn das falsche R√ºcksetzsegment korrekt ausgef√ºhrt wird, nimmt der Empf√§nger es f√ºr das reale Segment und schlie√üt die Verbindung seinerseits, wodurch die weitere √úbertragung von Informationen √ºber diese Verbindung unterbrochen wird. Um den Datenaustausch fortzusetzen, versuchen die Opfer m√∂glicherweise, eine neue TCP-Verbindung herzustellen. Der Angreifer hat jedoch m√∂glicherweise die M√∂glichkeit, diese neue Verbindung zur√ºckzusetzen. Da ein Angreifer Zeit ben√∂tigt, um ein gef√§lschtes Paket zu erstellen und zu senden, ist das Ablegen von Angriffen gl√ºcklicherweise nur gegen langfristige Verbindungen wirklich effektiv. Kurzfristige Verbindungen. Wenn Sie beispielsweise kleine Webseiten √ºbertragen, haben Sie normalerweise Zeit, um Ihre Mission zu erf√ºllenwenn der Angreifer sie zur√ºcksetzen kann.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Senden gef√§lschter TCP-Segmente ist in gewissem Sinne ein einfacher Vorgang, da weder TCP noch IP √ºber eigene Methoden zur √úberpr√ºfung der Identit√§t des Absenders verf√ºgen. Es gibt eine IP-Erweiterung namens IPSec, die Authentifizierung bietet, aber nicht so weit verbreitet ist. Internetdienstanbieter m√ºssen sich weigern, IP-Pakete zu √ºbertragen, die von einer offensichtlich falschen IP-Adresse stammen. Es wird jedoch behauptet, dass diese √úberpr√ºfung sehr mittelm√§√üig ist. Der Empf√§nger kann lediglich die Quell-IP-Adresse und den Port innerhalb des Pakets oder Segments zum Nennwert verwenden und, wenn m√∂glich, √ºbergeordnete Protokolle wie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/2014/03/27/how-does-"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TLS verwenden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , um den Absender zu identifizieren </font><font style="vertical-align: inherit;">. Da TCP-Dump-Pakete jedoch Teil des TCP-Protokolls selbst sind, k√∂nnen sie mit diesen Protokollen auf hoher Ebene nicht √ºberpr√ºft werden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trotz der Einfachheit, gef√§lschte Segmente zu senden, kann das Erstellen eines gef√§lschten Segments und das Ausf√ºhren eines erfolgreichen TCP-Reset-Angriffs immer noch eine entmutigende Aufgabe sein. </font><font style="vertical-align: inherit;">Um zu verstehen, warum dies geschieht, m√ºssen wir die Funktionsweise des TCP-Protokolls verstehen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie funktioniert TCP?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Zweck des TCP-Protokolls besteht darin, dem Empf√§nger eine genaue Kopie des Datenblocks zu senden. </font><font style="vertical-align: inherit;">Wenn mein Server beispielsweise HTML √ºber TCP an Ihren Computer sendet, sollte </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der TCP-Stapel</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ihres Computers (der Teil seines Betriebssystems, der TCP verarbeitet) mein HTML in genau der Form und Reihenfolge ausgeben, in der mein Server es gesendet hat.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/54d/bf5/d64/54dbf5d644d0a3d8ece1cff6cde7b790.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mein HTML wird jedoch nicht so perfekt geordnet √ºber das Internet √ºbertragen. Es ist in viele kleine Fragmente (sogenannte </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCP-Segmente</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) unterteilt, von denen jedes einzeln √ºber das Internet √ºbertragen und in der vom TCP-Stapel Ihres Computers √ºbertragenen Reihenfolge neu erstellt wird. Diese wiederhergestellte Ausgabe wird als </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCP-Stream bezeichnet</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Jedes TCP-Segment wird in einem eigenen </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IP-Paket</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √ºbertragen. </font><font style="vertical-align: inherit;">Um den Angriff zu verstehen, m√ºssen wir jedoch keine Details zu IP kennen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/468/904/175/4689041752b8fa9f66c57c696c4be2ef.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Konvertieren von Segmenten in einen Stream erfordert Sorgfalt, da das Internet unzuverl√§ssig ist. </font><font style="vertical-align: inherit;">TCP-Segmente k√∂nnen verloren gehen. </font><font style="vertical-align: inherit;">Sie k√∂nnen au√üer Betrieb geraten, zweimal verschickt werden, besch√§digt werden und viele andere Missgeschicke erleiden. </font><font style="vertical-align: inherit;">Daher besteht der Zweck des TCP-Protokolls darin, eine zuverl√§ssige Daten√ºbertragung √ºber ein unzuverl√§ssiges Netzwerk sicherzustellen. </font><font style="vertical-align: inherit;">TCP f√ºhrt diese Aufgabe aus, wobei beide Seiten der Verbindung einen engen Kontakt untereinander aufrechterhalten und st√§ndig Informationen dar√ºber √ºbertragen m√ºssen, welche Datenbl√∂cke empfangen wurden. </font><font style="vertical-align: inherit;">Auf diese Weise k√∂nnen Absender nachvollziehen, welche Daten der Empf√§nger noch nicht empfangen hat, und die verlorenen Daten erneut √ºbertragen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um zu verstehen, wie der Prozess funktioniert, m√ºssen wir verstehen, wie Sender und Empf√§nger </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCP-Sequenznummern verwenden</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zum Markieren und Verfolgen von Daten, die √ºber TCP √ºbertragen werden.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCP-Sequenznummern</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jedem √ºber eine TCP-Verbindung √ºbertragenen Byte wird vom Absender eine Sequenznummer zugewiesen. </font><font style="vertical-align: inherit;">Empfangsmaschinen verwenden Seriennummern, um die empfangenen Daten in die urspr√ºngliche Reihenfolge zu verschieben.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/402/fbc/144/402fbc144a2864f986debfb2ea9b6412.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn zwei Computer eine TCP-Verbindung aushandeln, sendet jeder Computer eine andere zuf√§llige </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Startsequenznummer</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dies ist die Sequenznummer, die das Ger√§t dem ersten gesendeten Byte zuweist. Jedem nachfolgenden Byte wird die Sequenznummer des vorherigen Bytes plus 1 zugewiesen. TCP-Segmente enthalten </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCP-Header</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die Metadaten sind, die an den Anfang des Segments angeh√§ngt sind. Die Sequenznummer des ersten Bytes im Segmentk√∂rper ist im TCP-Header dieses Segments enthalten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist zu beachten, dass TCP-Verbindungen bidirektional sind, dh Daten k√∂nnen in beide Richtungen √ºbertragen werden, und jeder Computer in einer TCP-Verbindung fungiert sowohl als Sender als auch als Empf√§nger. Aus diesem Grund muss jede Maschine ihren eigenen unabh√§ngigen Satz von Sequenznummern zuweisen und verarbeiten.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Best√§tigung des Datenempfangs</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn ein Computer ein TCP-Segment empf√§ngt, teilt er dem Absender des Segments mit, dass es empfangen wurde. </font><font style="vertical-align: inherit;">Der Empf√§nger sendet dazu ein Segment </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(kurz f√ºr "Best√§tigen"), das die Sequenznummer des </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√§chsten</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bytes enth√§lt, das er vom Absender erwartet. </font><font style="vertical-align: inherit;">Der Absender verwendet diese Informationen, um zu verstehen, dass der Empf√§nger alle anderen Bytes bis zu dieser Nummer erfolgreich empfangen hat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein Segment wird </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">durch das Vorhandensein eines Flags </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und der entsprechenden Best√§tigungsnummer im TCP-Header des Segments </font><font style="vertical-align: inherit;">angezeigt </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Das TCP-Protokoll enth√§lt nur 6 Flags, einschlie√ülich (wie wir in K√ºrze sehen werden) eines Flags </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(kurz f√ºr "Reset" - "Reset"), das das Reset-Segment angibt.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/242/452/e35/242452e35d360faf406441ab93f8c383.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hinweis: TCP erm√∂glicht auch die Verwendung </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selektiver ACKs</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die gesendet werden, wenn der Empf√§nger einige, aber nicht alle Segmente im Zahlenbereich empfangen hat. Beispiel: "Ich habe die Bytes 1000-3000 und 4000-5000 empfangen, aber nicht 3001-3999." Der Einfachheit halber werde ich in unserer Diskussion √ºber TCP-Reset-Angriffe keine selektiven ACKs ber√ºcksichtigen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn der Absender Daten sendet, aber nicht empf√§ngt</font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F√ºr sie w√§hrend eines bestimmten Zeitintervalls geht er davon aus, dass die Daten verloren gegangen sind, und sendet sie erneut, wobei sie dieselben Seriennummern erhalten. Dies bedeutet, dass wenn der Empf√§nger dieselben Bytes zweimal akzeptiert, er trivial Folgenummern verwendet, um Duplikate zu entfernen, ohne den Stream zu unterbrechen. Der Empf√§nger kann doppelte Daten akzeptieren, weil das urspr√ºngliche Segment sp√§ter empfangen wurde, nachdem es erneut gesendet wurde, oder weil das urspr√ºngliche Segment erfolgreich empfangen wurde, das entsprechende </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jedoch auf dem Weg zum Absender verloren ging.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e6d/22f/a09/e6d22fa098d7375dab30e6c8341ff358.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
W√§hrend solche doppelten Daten selten genug sind, f√ºhrt die dadurch verursachte √ºberm√§√üige Verschwendung von Ressourcen nicht zu Problemen. </font><font style="vertical-align: inherit;">Wenn alle Daten fr√ºher oder sp√§ter den Empf√§nger erreichen und die entsprechenden Daten </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">den Absender erreichen, erledigt die TCP-Verbindung ihre Aufgabe.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auswahl einer Seriennummer f√ºr ein gef√§lschtes Segment</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim Erstellen eines falschen Segments muss der </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Angreifer ihm eine Seriennummer geben. </font><font style="vertical-align: inherit;">Die Empf√§nger sind sehr froh, dass Sie Segmente mit inkonsistenten Seriennummern akzeptieren und unabh√§ngig voneinander in der richtigen Reihenfolge verbinden m√ºssen. </font><font style="vertical-align: inherit;">Ihre F√§higkeiten sind jedoch begrenzt. </font><font style="vertical-align: inherit;">Wenn der Empf√§nger ein Segment mit einer Sequenznummer erh√§lt, die "zu" nicht in der richtigen Reihenfolge ist, verwirft er ein solches Segment. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr einen erfolgreichen TCP-Reset-Angriff ist daher eine plausible Sequenznummer erforderlich. </font><font style="vertical-align: inherit;">Aber was ist eine solche Zahl? </font><font style="vertical-align: inherit;">F√ºr die meisten Segmente (obwohl, wie wir sp√§ter sehen werden, nicht f√ºr </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) wird die Antwort durch die </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gr√∂√üe des TCP-Fensters bestimmt</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCP-Fenstergr√∂√üe</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stellen Sie sich einen alten Computer aus den fr√ºhen neunziger Jahren vor, der an ein modernes Gigabit-Glasfasernetz angeschlossen ist. Ein ultraschnelles Netzwerk kann Daten mit einer erstaunlichen Geschwindigkeit auf diesen √§lteren Computer √ºbertragen, schneller als das Ger√§t sie verarbeiten kann. Dies wird uns st√∂ren, da das TCP-Segment erst dann als empfangen betrachtet werden kann, wenn der Empf√§nger es verarbeiten kann.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8a5/299/76a/8a529976a3acd7a28babb9e8220bcb7d.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Computer verf√ºgen √ºber einen </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCP-Puffer,</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in dem neu ankommende Daten auf ihre Verarbeitung warten, w√§hrend der Computer an Daten arbeitet, die vor ihm eintreffen. Dieser Puffer hat jedoch eine begrenzte Gr√∂√üe. Wenn der Empf√§nger die vom Netzwerk an ihn √ºbertragene Datenmenge nicht bew√§ltigen kann, l√§uft der Puffer √ºber. Wenn der Puffer voll ist, hat der Empf√§nger keine andere Wahl, als die redundanten Daten zu entfernen. Der Empf√§nger sendet keine </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verworfenen Daten, daher muss der Absender sie erneut senden, wenn im Puffer des Empf√§ngers freier Speicherplatz vorhanden ist. Es spielt keine Rolle, wie schnell das Netzwerk Daten √ºbertragen kann, wenn der Empf√§nger keine Zeit hat, mit ihnen umzugehen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stellen Sie sich einen √ºberm√§√üig eifrigen Freund vor, der Ihnen einen ganzen Strom von Briefen schneller an Ihre Post sendet, als Sie sie lesen k√∂nnen. Es gibt einen bestimmten Pufferraum in Ihrem Postfach, aber nachdem es voll ist, fallen alle nicht platzierten Buchstaben zu Boden, wo F√ºchse und andere Kreaturen sie fressen. Ein Freund muss die Briefe, die er gegessen hat, erneut senden, aber jetzt haben Sie Zeit, seine vorherigen Nachrichten zu erhalten. Das Senden zu vieler Briefe oder Datenmengen, die der Empf√§nger nicht verarbeiten kann, ist eine Verschwendung von Energie und √úbertragungskanal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Zu viel" - wie viele Daten sind das? Wie versteht der Absender, wann weitere Daten gesendet werden sollen und wann sich das Warten lohnt? Hier bietet sich die </font><em><font style="vertical-align: inherit;">Gr√∂√üe</font></em><font style="vertical-align: inherit;"> des </font><em><font style="vertical-align: inherit;">TCP-Fensters</font></em><font style="vertical-align: inherit;"> an.</font></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Die Gr√∂√üe des Empf√§ngerfensters gibt die maximale Anzahl nicht best√§tigter Bytes an, die der Absender jederzeit an ihn √ºbertragen kann. Angenommen, der Empf√§nger meldet, dass seine Fenstergr√∂√üe 100.000 betr√§gt (wir werden bald herausfinden, wie er diesen Wert √ºbergibt), sodass der Absender 100.000 Bytes sendet. Angenommen, bis der Sender ein hunderttausendstes Byte gesendet hat, hat der Empf√§nger die Segmente </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f√ºr die ersten 10.000 dieser Bytes </font><font style="vertical-align: inherit;">gesendet </font><font style="vertical-align: inherit;">. Dies bedeutet, dass 90.000 Bytes noch nicht best√§tigt wurden. Da die Fenstergr√∂√üe 100.000 betr√§gt, kann der Absender weitere 10.000 Bytes √ºbertragen, bevor er auf neue warten muss </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Wenn nach dem Senden dieser 10.000 zus√§tzlichen Bytes weiter</font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn es nicht empfangen wurde, st√∂√üt der Absender auf sein Limit von 100.000 nicht best√§tigten Bytes. Folglich muss der Absender warten und das Senden von Daten beenden (mit Ausnahme der erneuten √úbertragung von Daten, die er als verloren betrachtet), bis er neue Daten erh√§lt </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/afa/5df/46f/afa5df46f3304b04abbf629ca6ef34a0.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jede Seite der TCP-Verbindung benachrichtigt die andere Seite √ºber die Gr√∂√üe ihres Fensters w√§hrend des Handshake-Vorgangs, der beim √ñffnen der Verbindung ausgef√ºhrt wird. Dar√ºber hinaus k√∂nnen Fenstergr√∂√üen w√§hrend des Verbindungsvorgangs dynamisch ge√§ndert werden. Ein Computer mit einem gro√üen TCP-Puffer kann eine gro√üe Fenstergr√∂√üe ank√ºndigen, um den Durchsatz zu maximieren. Auf diese Weise kann die mit ihr kommunizierende Maschine kontinuierlich Daten √ºber eine TCP-Verbindung √ºbertragen, ohne anzuhalten oder auf eine Best√§tigung zu warten. Ein Computer mit einem kleinen TCP-Puffer kann gezwungen sein, eine kleine Fenstergr√∂√üe zu melden. Manchmal f√ºllen Absender das Fenster vollst√§ndig aus und m√ºssen warten, bis einige der Segmente best√§tigt sind. Die Bandbreite leidet darunter, aber es ist erforderlich, dass die TCP-Puffer nicht √ºberlaufen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8e3/d5e/5e0/8e3d5e5e0e4b574c6896e6ef7adc94bc.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Gr√∂√üe des TCP-Fensters ist eine strikte Begrenzung der Menge der √ºbertragenen unbest√§tigten Daten. </font><font style="vertical-align: inherit;">Wir k√∂nnen es verwenden, um die maximal m√∂gliche Sequenznummer (die ich in der folgenden Gleichung als bezeichnet habe </font></font><code>max_seq_no</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">zu berechnen </font><font style="vertical-align: inherit;">, die der Absender zum aktuellen Zeitpunkt senden kann:</font></font><br>
<br>
<blockquote><code>max_seq_no = max_acked_seq_no + window_size</code></blockquote><br>
<code>max_acked_seq_no</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Dies ist die maximale Sequenznummer, f√ºr die der Empf√§nger gesendet hat </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dies ist die maximale Sequenznummer, von der der Absender wei√ü, dass der Empf√§nger sie genau erhalten hat. </font><font style="vertical-align: inherit;">Da der Absender nur </font></font><code>window_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unbest√§tigte Bytes senden kann, kann er maximal eine Sequenznummer senden </font></font><code>max_acked_seq_no + window_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aus diesem Grund gibt die TCP-Spezifikation an, dass der Empf√§nger alle empfangenen Daten ignorieren soll, deren Seriennummern au√üerhalb des g√ºltigen Fensters liegen. Wenn der Empf√§nger beispielsweise alle Bytes bis zu 15.000 best√§tigt hat und seine Fenstergr√∂√üe 30.000 betr√§gt, erh√§lt er alle Daten mit einer Seriennummer im Bereich von 15.000 bis (15.000 + 30.000 = 45.000). Dar√ºber hinaus ignoriert der Empf√§nger Daten mit Seriennummern au√üerhalb dieses Intervalls vollst√§ndig. Wenn das Segment Daten enth√§lt, von denen sich einige innerhalb dieses Fensters und einige au√üerhalb befinden, werden die Daten innerhalb des Fensters akzeptiert und best√§tigt, aber die Daten au√üerhalb des Fensters werden verworfen. Beachten Sie, dass wir die M√∂glichkeit der </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selektiven,</font></font><code>ACK</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> die zu Beginn des Beitrags kurz angesprochen wurden </font><font style="vertical-align: inherit;">, immer noch ignorieren </font><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei den meisten TCP-Segmenten gibt diese Regel ein Intervall akzeptabler Sequenznummern an. </font><font style="vertical-align: inherit;">Wie bereits erw√§hnt, sind die </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beschr√§nkungen </font><font style="vertical-align: inherit;">f√ºr Segmente </font><font style="vertical-align: inherit;">jedoch noch strenger als die Beschr√§nkungen f√ºr gew√∂hnliche Daten√ºbertragungssegmente. </font><font style="vertical-align: inherit;">Wie wir gleich sehen werden, wurde dies durchgef√ºhrt, um die Durchf√ºhrung einer Variante eines TCP-Reset- </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Angriffs</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu erschweren, der als </font><em><font style="vertical-align: inherit;">"blinder TCP-Reset-Angriff" bezeichnet wird</font></em><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Akzeptable Sequenznummern f√ºr RST-Segmente</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Regul√§re Segmente werden akzeptiert, wenn ihre Sequenznummer zwischen der n√§chsten erwarteten Sequenznummer und dieser Nummer plus der Fenstergr√∂√üe liegt. Pakete </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">werden jedoch nur empfangen, wenn ihre Sequenznummer </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">genau der</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√§chsten erwarteten Sequenznummer entspricht. Kehren wir zum vorherigen Beispiel zur√ºck, in dem der Empf√§nger die Best√§tigungsnummer 15.000 gesendet hat. Damit das Paket </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">empfangen werden kann, muss seine Sequenznummer genau 15.000 sein. Wenn der Empf√§nger ein Segment </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit einer Sequenznummer ungleich 15.000 </font><font style="vertical-align: inherit;">empf√§ngt </font><font style="vertical-align: inherit;">, akzeptiert er es nicht.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1d9/596/b55/1d9596b55bb0ac4946ed16ff6b878dff.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn die Sequenznummer au√üerhalb des Intervalls liegt, ignoriert der Empf√§nger sie vollst√§ndig. </font><font style="vertical-align: inherit;">Befindet es sich jedoch innerhalb des Fensters der erwarteten Sequenznummern, sendet der Empf√§nger eine "Herausforderung </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" ("ACK-Anruf"). </font><font style="vertical-align: inherit;">Dies ist ein Segment, das dem Absender mitteilt, dass das Segment </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eine ung√ºltige Sequenznummer hat. </font><font style="vertical-align: inherit;">Er teilt dem Absender auch die Sequenznummer mit, die der Empf√§nger erwartet. </font><font style="vertical-align: inherit;">Der Absender kann diese Informationen aus dem </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anruf verwenden, um seine </font><font style="vertical-align: inherit;">Informationen </font><font style="vertical-align: inherit;">neu zu erstellen und erneut zu senden </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bis 2010 hat TCP diese zus√§tzlichen Segmentbeschr√§nkungen nicht eingef√ºhrt </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Segmente wurden </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nach den gleichen Regeln wie alle anderen angenommen oder abgelehnt. </font><font style="vertical-align: inherit;">Dies vereinfachte jedoch auch die </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Blind-Blind-TCP-Reset-Angriffe</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Blinde TCP-Angriffe</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn der Angreifer den zwischen seinen Opfern ausgetauschten Datenverkehr abfangen kann, kann er die Serien- und Best√§tigungsnummern der TCP-Pakete der Opfer lesen. Er kann diese Informationen verwenden, um auszuw√§hlen, welche Seriennummern er seinen gef√§lschten Segmenten geben soll </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Wenn der Angreifer jedoch den Verkehr der Opfer nicht abfangen kann, wei√ü er nicht, welche Sequenznummern er einf√ºgen soll. Er kann jedoch immer noch eine beliebige Anzahl von Segmenten </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit einer beliebigen Anzahl unterschiedlicher Seriennummern √ºbertragen, in der Hoffnung, dass sich eines davon als richtig herausstellt. Ein solcher Angriff wird als blinder TCP-Reset-Angriff bezeichnet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie bereits erw√§hnt, musste der Angreifer in der ersten Version des TCP-Protokolls nur die Seriennummer abrufen</font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">innerhalb des TCP-Fensters des Empf√§ngers. </font><font style="vertical-align: inherit;">Ein Artikel mit dem Titel ‚ÄûSlipping in the Window‚Äú zeigte, dass dies die blinden Angriffe zu einfach machte, da ein Angreifer f√ºr einen fast garantierten Erfolg nur Zehntausende von Segmenten senden musste. </font><font style="vertical-align: inherit;">Um dem entgegenzuwirken, wurde die Regel, die den Empf√§nger zur Annahme des Segments zwang, </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">durch das oben beschriebene strengere Kriterium ersetzt. </font><font style="vertical-align: inherit;">Dank der neuen Regeln f√ºr die Durchf√ºhrung von TCP-Reset-Angriffen m√ºssen Millionen von Segmenten blind gesendet werden, was sie praktisch nicht realisierbar macht. </font><font style="vertical-align: inherit;">Siehe </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RFC-5963 f√ºr</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Details </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F√ºhren Sie einen TCP-Reset-Angriff gegen uns selbst durch</font></font></h2><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinweis: Ich habe diesen Prozess unter OSX getestet, aber einige Kommentare erhalten, dass er unter Linux nicht ordnungsgem√§√ü funktioniert. </font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt wissen wir alles √ºber die Ausf√ºhrung eines TCP-Reset-Angriffs. </font><font style="vertical-align: inherit;">Der Angreifer muss:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verkehrswacht - </font><font style="vertical-align: inherit;">Netzwerk ( </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄûSchn√ºffeln‚Äú</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> it) zwischen zwei Opfer</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schn√ºffeln Sie am TCP-Segment mit aktiviertem Flag </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und lesen Sie die best√§tigte Nummer</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erstellen Sie ein falsches TCP-Segment mit aktiviertem Flag </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und einer Sequenznummer, die der best√§tigten Nummer des abgefangenen Segments entspricht (beachten Sie, dass dies eine langsame √úbertragung impliziert, da sonst die ausgew√§hlte Sequenznummer schnell veraltet ist.) Um die Erfolgschancen zu erh√∂hen, k√∂nnen Sie mehrere Segmente </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit einem gro√üen Intervall von Sequenznummern √ºbertragen .)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Senden Sie gef√§lschte Segmente an ein oder beide Opfer, in der Hoffnung, dass dadurch die TCP-Verbindung unterbrochen wird</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns zum √úben einen TCP-Angriff auf uns selbst auf demselben Computer durchf√ºhren und √ºber uns selbst kommunizieren </font></font><code>localhost</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Daf√ºr brauchen wir:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurieren Sie die TCP-Verbindung zwischen zwei Terminalfenstern</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schreiben Sie ein Angriffsprogramm, das sich mit Verkehrsschn√ºffeln befasst</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ñndern Sie das Programm so, dass es gef√§lschte Segmente erzeugt und sendet </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lass uns anfangen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Herstellen einer TCP-Verbindung zwischen zwei Terminalfenstern</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden die TCP-Verbindung mit dem Tool konfigurieren </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><code>netcat</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, das standardm√§√üig auf vielen Betriebssystemen verf√ºgbar ist. </font><font style="vertical-align: inherit;">Jeder andere </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCP-Client reicht aus</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Im ersten Terminalfenster f√ºhren wir den folgenden Befehl aus:</font></font><br>
<br>
<blockquote><code>nc -nvl 8000</code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Befehl startet einen TCP-Server, der einen Port auf unserem lokalen Computer √ºberwacht </font></font><code>8000</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">F√ºhren Sie im zweiten Terminalfenster den folgenden Befehl aus:</font></font><br>
<br>
<blockquote><code>nc 127.0.0.1 8000</code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Befehl versucht, √ºber die IP-Adresse des </font></font><code>127.0.0.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ports </font><font style="vertical-align: inherit;">eine TCP-Verbindung zum Computer herzustellen </font></font><code>8000</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Nun sollte zwischen den beiden Fenstern des Terminals eine TCP-Verbindung hergestellt werden. </font><font style="vertical-align: inherit;">Versuchen Sie, etwas in ein Fenster einzugeben - die Daten m√ºssen √ºber die TCP-Verbindung √ºbertragen werden und in einem anderen Fenster angezeigt werden.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/911/301/786/911301786c4f56287f80d38f67ef73f6.gif"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Verkehrsschn√ºffeln</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden ein Angriffsprogramm schreiben, das mithilfe der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><code>scapy</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">beliebten Python-Netzwerkbibliothek </font><font style="vertical-align: inherit;">Traffic-Sniffing durchf√ºhrt </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dieses Programm verwendet scapy, um Daten zu lesen, die zwischen zwei Fenstern des Terminals √ºbertragen wurden, obwohl sie nicht Teil der Verbindung sind. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Programmcode wird in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">meinem Repository auf GitHub ver√∂ffentlicht</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Das Programm √ºberwacht den Verbindungsverkehr und zeigt ihn auf dem Terminal an. </font><font style="vertical-align: inherit;">Der Hauptkern des Codes ist der Methodenaufruf </font></font><code>sniff</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aus der Bibliothek </font></font><code>scapy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">am Ende der Datei:</font></font><br>
<br>
<pre><code class="python hljs">t = sniff(<font></font>
        iface=<span class="hljs-string">'lo0'</span>,<font></font>
        lfilter=is_packet_tcp_client_to_server(localhost_ip, localhost_server_port, localhost_ip),<font></font>
        prn=log_packet,<font></font>
        count=<span class="hljs-number">50</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Code weist uns </font></font><code>scapy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">an, Pakete auf der Schnittstelle zu schn√ºffeln </font></font><code>lo0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und Details aller Pakete als Teil unserer TCP-Verbindung zu erfassen. </font><font style="vertical-align: inherit;">Der Aufruf hat folgende Parameter:</font></font><br>
<br>
<ul>
<li><code>iface</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Befehle </font></font><code>scapy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zum Abh√∂ren der Netzwerkschnittstelle </font></font><code>lo0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder des lokalen Hosts</font></font></li>
<li><code>lfilter</code> ‚Äî  ,  <code>scapy</code>   ,      IP- localhost   .   ,        ,   <code>lo0</code>.     ,     .</li>
<li><code>prn</code> ‚Äî ,  <code>scapy</code>     ,    <code>lfilter</code>.          .       ,      <code>RST</code>.</li>
<li><code>count</code> ‚Äî  ,  <code>scapy</code>    .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um dieses Programm zu testen, konfigurieren Sie die TCP-Verbindung ab Schritt 1. Klonen Sie mein GitHub-Repository, befolgen Sie die Konfigurationsanweisungen und f√ºhren Sie das Programm im dritten Fenster des Terminals aus. </font><font style="vertical-align: inherit;">Geben Sie Text in eines der Terminals der TCP-Verbindung ein. </font><font style="vertical-align: inherit;">Sie sollten sehen, dass das Programm beginnt, Informationen √ºber die Verbindungssegmente aufzuzeichnen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Senden gef√§lschter Pakete </font></font><code>RST</code></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben eine Verbindung hergestellt, und das Programm kann alle durchlaufenden TCP-Segmente abh√∂ren. Das einzige, was uns noch bleibt, ist, das Programm so zu √§ndern, dass es einen TCP-Reset-Angriff durch √úbertragen gef√§lschter Segmente ausf√ºhrt </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Zu diesem Zweck √§ndern wir die Funktion </font></font><code>prn</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(siehe Liste der Parameter oben), die </font></font><code>scapy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f√ºr Pakete </font><font style="vertical-align: inherit;">aufgerufen wird </font><font style="vertical-align: inherit;">, die die Anforderungen der Funktion erf√ºllen </font></font><code>lfilter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. In der modifizierten Version der Funktion wird das entsprechende Paket nicht einfach repariert, sondern untersucht, die erforderlichen Parameter extrahiert und mit diesen Parametern das Segment erstellt und gesendet </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angenommen, wir haben ein Segment ab </font></font><code>(src_ip, src_port)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font><font style="vertical-align: inherit;">abgefangen </font></font><code>(dst_ip, dst_port)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Er hat eine Flagge gesetzt </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und die Best√§tigungsnummer ist 100.000. Um ein Segment herzustellen und zu versenden, haben wir:</font></font><br>
<br>
<ul>
<li>  IP-   ,    .  ,         .          ,  .</li>
<li>  <code>RST</code> ,     ,    <code>RST</code></li>
<li>        ,      ,    </li>
<li>  <code>send</code>  <code>scapy</code>     ‚Äî   .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um unser vorheriges Programm nach Bedarf zu √§ndern, </font><font style="vertical-align: inherit;">kommentieren Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diese Zeile aus</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und kommentieren Sie die Zeile dar√ºber aus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt sind wir bereit f√ºr einen umfassenden Angriff. </font><font style="vertical-align: inherit;">Konfigurieren Sie die TCP-Verbindung gem√§√ü Schritt 1. F√ºhren Sie das Angriffsprogramm ab Schritt 2 im dritten Fenster des Terminals aus. </font><font style="vertical-align: inherit;">Geben Sie dann einen Text in eines der Terminals der TCP-Verbindung ein. </font><font style="vertical-align: inherit;">In dem Terminal, in dem Sie den Text eingegeben haben, wird die TCP-Verbindung pl√∂tzlich und auf mysteri√∂se Weise unterbrochen. </font><font style="vertical-align: inherit;">Der Angriff ist beendet!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ad9/2a2/b18/ad92a2b18c1533c47d88ab4ff10dedf7.gif"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Weitere Arbeit</font></font></h3><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Experimentieren Sie weiter mit dem Angriffstool. </font><font style="vertical-align: inherit;">Verfolgen Sie, was passiert, wenn Sie 1 zur Sequenznummer des Pakets addieren oder von dieser subtrahieren </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Stellen Sie sicher, dass es </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">genau</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dem Wert des </font></font><code>ack</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">abgefangenen Pakets entspricht.</font></font></li>
<li> Wireshark       <code>lo0</code>    .            TCP-,       <code>RST</code>.   <code>ip.src == 127.0.0.1 &amp;&amp; ip.dst == 127.0.0.1 &amp;&amp; tcp.port == 8000</code>       .</li>
<li>  ,      .           <code>RST</code>,       <code>RST</code>         ,      .   ,      <code>RST</code>,       .</li>
</ol><br>
<h2></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der TCP-Reset-Angriff ist gleichzeitig tiefgreifend und einfach. </font><font style="vertical-align: inherit;">Viel Gl√ºck bei Ihren Experimenten und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lassen Sie mich wissen,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wenn Sie Fragen oder Kommentare haben.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de499884/index.html">11 Dinge, die ich √ºber CustDev verstanden habe</a></li>
<li><a href="../de499894/index.html">Haus der singenden Dinge. Chipolo ONE Smart Keychain Tracker Bewertung</a></li>
<li><a href="../de499896/index.html">Wir gehen korrekt zum entfernten Standort: Wie organisieren wir unsere Arbeit und die Arbeit des Projekts in Telegram?</a></li>
<li><a href="../de499898/index.html">Wie IT-Mitarbeiter mit Quarant√§ne umgehen, was sie in Selbstisolation tun und was sie verwenden</a></li>
<li><a href="../de499900/index.html">Produktanalyse mitap: kostenlos, kontaktlos, online</a></li>
<li><a href="../de499904/index.html">"Ich habe Angst". Was zu tun ist?</a></li>
<li><a href="../de499906/index.html">Beispiele f√ºr die Verwendung von AR in der Spielwarenindustrie</a></li>
<li><a href="../de499910/index.html">Ausgewogenheit bei der Entscheidungsfindung. Gabel "zuf√§llige Erfahrung"</a></li>
<li><a href="../de499920/index.html">SSH kleine Tricks</a></li>
<li><a href="../de499922/index.html">Schlie√ülich besch√§ftigen wir uns mit der Modbus-Baudrate</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>