<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👇🏼 🕵🏽 🛌🏻 Spiral: framework PHP / Go hautes performances 👩‍🏫 📲 👁️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr. Je m'appelle Anton Titov, directeur technique de Spiral Scout. Aujourd'hui, je voudrais vous parler de notre éléphant PHP. Ou plutôt, s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Spiral: framework PHP / Go hautes performances</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495224/"><img src="https://habrastorage.org/webt/1_/ku/gu/1_kugualputdvwq2gxujopusshg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bonjour, Habr. </font><font style="vertical-align: inherit;">Je m'appelle Anton Titov, directeur technique de Spiral Scout. </font><font style="vertical-align: inherit;">Aujourd'hui, je voudrais vous parler de notre éléphant PHP. </font><font style="vertical-align: inherit;">Ou plutôt, sur la deuxième version du framework PHP / Go open-source full-stack - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spiral</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Spiral est un framework full-stack de composants développé par notre entreprise depuis plus de onze ans et servant une centaine de projets réels. </font><font style="vertical-align: inherit;">Le progiciel est basé sur de nombreuses bibliothèques ouvertes et propriétaires, y compris </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RoadRunner</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cycle ORM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le cadre est compatible avec la plupart des recommandations PSR, prend en charge MVC et fonctionne 5 à 10 fois plus rapidement que Laravel / Symfony. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous n'avez jamais entendu parler de Spiral et que vous vous demandez ce qu'est le framework PHP / Go et où est passée la première version, alors bienvenue sur cat.</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">À propos du cadre</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le développement en spirale a commencé en 2008/09 en tant que noyau portable pour les applications indépendantes. En 2010, nous avons finalement formé une société d'externalisation et nous nous sommes depuis engagés dans l'amélioration de notre stack. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conséquence, le cadre a été transformé en un ensemble de composants indépendants, unis par une couche d'intégration commune. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La seule annonce publique de la première version a eu lieu sur Reddit en 2017 et nous a clairement montré que, techniquement, Spiral ne battait pas vraiment les concurrents à l'époque. Nous avons pris en compte les retours que nous avons reçus, l'expérience de projets plus complexes et terminé la deuxième version en mai 2019. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après un an de documentation et de fonctionnement sur de vrais projets, nous sommes prêts à soumettre ce développement au public.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La principale différence entre Spiral 2.0 de la génération précédente du framework et, peut-être, de tous les autres frameworks PHP existants est le serveur d'applications intégré RoadRunner, ainsi que l'adaptation de l'architecture pour un modèle d'exécution à longue durée de vie (mode démon). </font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hybride Rantheim</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le concept principal du framework est la symbiose entre le serveur d'applications écrit en Golang et le noyau PHP. </font><font style="vertical-align: inherit;">Le code d'application PHP n'est chargé qu'une seule fois dans la mémoire - de cette façon, vous économisez beaucoup de ressources, mais perdez la possibilité d'exécuter WordPress.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/88/-o/fw/88-ofwfx3p83cjgqkkwuqmkuxk0.png"><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous pouvez en savoir plus sur le modèle hybride </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le serveur est responsable de toute la partie infrastructure: HTTP / FastCGI, communication avec les courtiers de file d'attente, GRPC, WebSockets, Pub / Sub, cache, métriques, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'écriture de code pour Spiral n'est pratiquement pas différente du code pour tout autre framework. </font><font style="vertical-align: inherit;">Cependant, les principes SOLIDES devront être plus responsables. </font><font style="vertical-align: inherit;">Si auparavant la mise en cache des données utilisateur dans singleton n'a causé que de graves difficultés pour la révision du code, maintenant un tel code ne fonctionnera tout simplement pas correctement.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La connaissance de Golang n'est pas requise pour travailler avec la plateforme. </font><font style="vertical-align: inherit;">Cependant, après avoir appris une deuxième langue, vous pouvez créer des intégrations presque transparentes avec les bibliothèques Golang. </font><font style="vertical-align: inherit;">Par exemple, intégrez un moteur de recherche en texte intégral ou écrivez votre propre pilote Kafka.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tirer dans la jambe était un peu plus difficile, il a été décidé d'abandonner le système d'événements et de hooks et de prioriser le travail avec la pile d'appels sous une forme explicite. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le cadre fournit un ensemble d'outils, tels que les fermetures IoC, les middlewares, les spoilers de couche de domaine et les services immuables.</font></font><br>
<br>
<pre><code class="php hljs">$container-&gt;runScope(<font></font>
    [UserContext::class =&gt; $user],<font></font>
    <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) <span class="hljs-title">use</span> (<span class="hljs-params">$container</span>) </span>{<font></font>
        dump($container-&gt;get(UserContext::class);<font></font>
    }<font></font>
);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien qu'une telle approche impose une surcharge supplémentaire, la possibilité de ne pas décharger le cœur du programme, les connexions à la base de données et les sockets de la mémoire couvre plus que ces limitations.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Performance</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la classe full-stack des frameworks PHP, Spiral est principalement en concurrence avec les assemblages basés sur Swoole et plusieurs micro-frameworks. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nw/a5/tz/nwa5tzv_osg63cq6l2ha2xpbs2c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Des benchmarks complets sont disponibles </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour nous, la performance est un effet secondaire de l'architecture choisie. Nous sommes sûrs qu'avec une configuration appropriée et en remplaçant le PSR-7 par une abstraction plus légère, la productivité peut être augmentée de 50 à 80% (cela est prouvé par l'exemple de l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ubiquité-roadrunner</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<blockquote> Swoole. Swoole     RoadRunner,     PHP        ++.       ,     Go.     ,   .<br>
<br>
   RoadRunner   (   ),    ,       Windows.<br>
<br>
   Spiral     Swoole,     !</blockquote><br>
<h4>PSR-*  </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La plupart des composants Spiral sont facultatifs pour votre version, la différence entre la version micro et la version complète ne concerne que le contenu </font></font><code>composer.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Si nécessaire, vous pouvez utiliser les interfaces pour remplacer les bibliothèques standard par des implémentations alternatives. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La couche HTTP du framework est écrite en tenant compte des standards PSR-7/15/17, vous pouvez </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://spiral.dev/docs/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">changer en</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> toute sécurité </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://spiral.dev/docs/" rel="nofollow"><font style="vertical-align: inherit;">le routeur</font></a><font style="vertical-align: inherit;"> , l'implémentation des messages, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La plupart des bibliothèques de frameworks peuvent être utilisées en dehors du framework. </font><font style="vertical-align: inherit;">Par exemple, RoadRunner fonctionne très bien avec </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symfony</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Laravel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et Cycle ORM sera disponible dans Yii3.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Composants serveur</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus des composants PHP, l'assemblage RoadRunner comprend plusieurs bibliothèques écrites en Golang. </font><font style="vertical-align: inherit;">La plupart des services serveur peuvent être gérés depuis PHP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En particulier, il existe un composant de file d'attente qui prend en charge le travail avec les courtiers AMQP, Amazon SQS et Beanstalk. </font><font style="vertical-align: inherit;">La bibliothèque peut correctement arrêter, reconnecter et distribuer n'importe quel nombre de files d'attente entrantes à plusieurs travailleurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dès la sortie de la boîte, il y a une surveillance sur Prometheus et des points de contrôle de santé, un redémarrage à chaud et une limite de mémoire. </font><font style="vertical-align: inherit;">Pour les projets distribués, il existe un serveur et un client GRPC. </font><font style="vertical-align: inherit;">
Il existe des sockets web, elles peuvent être autorisées depuis une application PHP et connectées au bus pub-sub (en mémoire ou sur Redis). </font><font style="vertical-align: inherit;">Les pilotes de valeur-clé sont actuellement testés.</font></font><br>
<br>
<code>INFO[0154] 10.42.5.55:51990 Ok {2.28ms} /images.Service/GetFiles<br>
INFO[0155] 10.42.3.95:50926 Ok {11.3ms} /images.Service/GetFiles<br>
INFO[0156] 10.42.5.55:52068 Ok {3.60ms} /images.Service/GetFiles<br>
INFO[0158] 10.42.5.55:52612 Ok {2.30ms} /images.Service/GetFiles<br>
INFO[0166] 10.42.5.55:52892 Ok {2.23ms} /images.Service/GetFiles<br>
INFO[0167] 10.42.3.95:49938 Ok {2.37ms} /images.Service/GetFiles<br>
INFO[0169] 10.42.5.55:52988 Ok {2.22ms} /images.Service/GetFiles</code><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portabilité</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le framework ne nécessite pas PHP-FPM et NGINX. </font><font style="vertical-align: inherit;">Et tous les composants Golang ont des pilotes pour fonctionner sans dépendances externes. </font><font style="vertical-align: inherit;">Ainsi, vous pouvez utiliser des files d'attente, des sockets Web, des métriques sans installer de courtiers ou de programmes externes.</font></font><br>
<br>
<pre><code class="plaintext hljs">./spiral serve -v -d</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La spirale n'a pas d'importance si vous écrivez une énorme application distribuée ou un petit site envoyant "écrivez-nous" en arrière-plan. </font><font style="vertical-align: inherit;">Dans tous les cas, vous pouvez utiliser les mêmes outils, unifiant le comportement des environnements locaux et de production.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La couche HTTP étant facultative, vous pouvez écrire des applications de console qui traitent les données en arrière-plan à l'aide d'un package de files d'attente. </font><font style="vertical-align: inherit;">Nous utilisons de tels programmes pour la migration des données.</font></font></blockquote><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cycle ORM</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En tant qu'ORM prêt à l'emploi, vient le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cycle ORM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ce moteur Data Mapper est très similaire en fonction de Doctrine, mais très différent sur le plan architectural. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme Doctrine, Cycle peut fonctionner avec des modèles de domaine purs, générant indépendamment des migrations et organisant des clés étrangères. </font><font style="vertical-align: inherit;">Le schéma de mappage peut être décrit par code ou collecté à partir d'annotations. </font><font style="vertical-align: inherit;">Mais au lieu de DQL, des constructeurs de requêtes classiques sont utilisés.</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">//    </span>
<span class="hljs-comment">//        </span><font></font>
$users = $orm-&gt;getRepository(User::class)<font></font>
    -&gt;select()<font></font>
    -&gt;where(<span class="hljs-string">'active'</span>, <span class="hljs-literal">true</span>)<font></font>
    -&gt;load(<span class="hljs-string">'orders'</span>, [
        <span class="hljs-string">'method'</span> =&gt; Select::SINGLE_QUERY, <span class="hljs-comment">// force LEFT JOIN</span>
        <span class="hljs-string">'load'</span>   =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$query</span>) </span>{<font></font>
            $query-&gt;where(<span class="hljs-string">'paid'</span>, <span class="hljs-literal">true</span>)-&gt;orderBy(<span class="hljs-string">'timeCreated'</span>, <span class="hljs-string">'DESC'</span>);<font></font>
        }<font></font>
    ])<font></font>
    -&gt;fetchAll();<font></font>
<font></font>
$transaction = <span class="hljs-keyword">new</span> Transaction($orm);<font></font>
<font></font>
<span class="hljs-keyword">foreach</span>($users <span class="hljs-keyword">as</span> $user) {<font></font>
    $transaction-&gt;persist($user);<font></font>
}<font></font>
<font></font>
$transaction-&gt;run();</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le cycle s'exécute </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plus rapidement que</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Doctrine sur les sélections, mais plus lentement persiste. </font><font style="vertical-align: inherit;">Le moteur prend en charge les requêtes complexes avec plusieurs stratégies de chargement, classes proxy, incorporations et fournit des transactions portables au lieu du EntityManager global.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plus de détails peuvent être entendus à </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PHP Russie 2020</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La principale «fonctionnalité» d'ORM est la possibilité de modifier le mappage des données et des liens lors de l'exécution. </font><font style="vertical-align: inherit;">En termes simples, vous pouvez permettre aux utilisateurs de définir indépendamment le schéma de données (DBAL prend en charge l'introspection et la déclaration des schémas de base de données).</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous pouvez en savoir plus sur la comparaison de Cycle, Eloquent et Doctrine 2 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></blockquote><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prototypage rapide</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Spiral comprend plusieurs outils pour accélérer et simplifier le développement. </font><font style="vertical-align: inherit;">Les principaux sont l'injection d'auto-dépendance, la configuration automatique et la recherche automatique de modèle utilisant l'analyse statique. </font><font style="vertical-align: inherit;">Les commandes de la console vous permettent de générer la plupart des classes requises et sont facilement personnalisables. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour l'intégration dans l'IDE, il existe un système de prototypage rapide. </font><font style="vertical-align: inherit;">En utilisant le magique PrototypeTrait, vous pouvez accéder rapidement à des astuces dans l'EDI. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/33/9u/_a/339u_ac_8gelzkarpyljtgtisck.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le trait trouve automatiquement les référentiels ORM, les composants standard et peut indexer vos services par des annotations. </font><font style="vertical-align: inherit;">Sous le capot, la méthode magique </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__get</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est utilisée </font><font style="vertical-align: inherit;">, ce qui vous garantit une révision rapide du code.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exécutez simplement la commande `php app.php prototype: inject -r`, et le système de prototypage supprimera automatiquement toute la magie:</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Controller</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Database</span>\<span class="hljs-title">Repository</span>\<span class="hljs-title">UserRepository</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Spiral</span>\<span class="hljs-title">Views</span>\<span class="hljs-title">ViewsInterface</span>;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HomeController</span>
</span>{
    <span class="hljs-comment">/** <span class="hljs-doctag">@var</span> ViewsInterface */</span>
    <span class="hljs-keyword">private</span> $views;<font></font>
<font></font>
    <span class="hljs-comment">/** <span class="hljs-doctag">@var</span> UserRepository */</span>
    <span class="hljs-keyword">private</span> $users;<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@param</span> ViewsInterface $views
     * <span class="hljs-doctag">@param</span> UserRepository $users
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">ViewsInterface $views, UserRepository $users</span>)
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;users = $users;
        <span class="hljs-keyword">$this</span>-&gt;views = $views;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">index</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;views-&gt;render(<span class="hljs-string">'profile'</span>, [
            <span class="hljs-string">'user'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;users-&gt;findByName(<span class="hljs-string">'Antony'</span>)<font></font>
        ]);<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sous le capot, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PHP-Parser est utilisé</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sécurité</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La plupart de nos applications étant développées pour le segment B2B, les questions de sécurité doivent être prises au sérieux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Des composants pour valider les demandes complexes (Filtres de demande), CSRF et chiffrement (basé sur le chiffrement par </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">désamorçage / php</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">seront à votre disposition </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Le travail avec les cookies et la session prennent en charge la protection contre la falsification et la signature des données côté serveur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le cadre fournit </font><font style="vertical-align: inherit;">un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">composant d'authentification</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> basé sur un jeton expirant. </font><font style="vertical-align: inherit;">En tant que pilote, vous pouvez utiliser des sessions, une base de données ou même du JWT pur.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ou tous les types de jetons en même temps, si l'exigence "connectez de toute urgence SAML / SSO / 2FA!" Vole soudainement vers vous </font><font style="vertical-align: inherit;">:(</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'autorisation d'accès est effectuée via le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">composant RBAC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec quelques améliorations qui permettent un fonctionnement en mode DAC et ABAC. </font><font style="vertical-align: inherit;">De nombreux rôles sont pris en charge, des annotations pour protéger les méthodes du contrôleur et un système de règles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le travail avec la couche domaine se fait via une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">couche intercepteur</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> intermédiaire </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Vous pouvez donc créer des restrictions spéciales sur un groupe de contrôleurs, pré-valider les données et envelopper les erreurs.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moteur de modèle</font></font></h4><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous n'aimez que Twig - vous pouvez faire défiler cette section, installez simplement l'extension et utilisez des outils familiers. </font><font style="vertical-align: inherit;">:)</font></font><br>
</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le moteur de modèle Stemper, ou plutôt, une bibliothèque pour créer votre propre balisage DSL est sorti de la boîte. En particulier, il existe un lexer à part entière, plusieurs grammaires, un analyseur et un accès à AST (similaire au PHP-Parser de Nikita). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est possible d'analyser plusieurs grammaires imbriquées. Ainsi, par exemple, vous pouvez utiliser les directives Laravel Blade et votre propre balisage DSL (sous la forme de balises HTML) dans le même modèle. Il s'avère quelque chose comme des composants Web côté serveur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous utilisons ce composant pour décrire des interfaces complexes à l'aide de primitives et de règles simples.</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">extends:admin.layout.tabs</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"User Information"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">use:bundle</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"admin/bundle"</span>/&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">ui:tab</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"info"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"Information"</span>&gt;</span><font></font>
  User, {{ $user-&gt;name }}<font></font>
<span class="hljs-tag">&lt;/<span class="hljs-name">ui:tab</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">ui:tab</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"data"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"User Settings"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">grid:table</span> <span class="hljs-attr">for</span>=<span class="hljs-string">{{</span> $<span class="hljs-attr">user-</span>&gt;</span>settings }}&gt;
    <span class="hljs-tag">&lt;<span class="hljs-name">grid:cell</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"Key"</span>&gt;</span>{{ $key }}<span class="hljs-tag">&lt;/<span class="hljs-name">grid:cell</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">grid:cell</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"Value"</span>&gt;</span>{{ $value }}<span class="hljs-tag">&lt;/<span class="hljs-name">grid:cell</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">grid:table</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ui:tab</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il prend en charge l'échappement automatique avec prise en charge du contexte (par exemple, la sortie de PHP à l'intérieur du bloc JS convertit automatiquement les données en JSON), les cartes source pour travailler avec les erreurs. </font><font style="vertical-align: inherit;">Les modèles sont compilés en code PHP optimisé puis donnés directement à partir de la mémoire de l'application.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stemper peut fonctionner pleinement avec le DOM du document (bien que plus lent si vous utilisez des outils spécialisés).</font></font></blockquote><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Développement du cadre</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien sûr, en plus d'une décennie de développement de cet outil, nous avons commis de nombreuses erreurs. Certains d'entre eux ont été corrigés pour la sortie de la deuxième version, tandis que l'autre partie nécessite une révision du concept de certains composants. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous ne nierons pas non plus que certaines choses nécessitent un fichier. Et certaines questions peuvent nous sembler pour la première fois. Bien que la documentation essaie de couvrir le maximum de composants, elle peut encore s'affaisser à certains endroits. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous sommes ouverts aux critiques et aux suggestions, car nous-mêmes utilisons activement cet outil. L'énorme arriéré d'améliorations est lentement trié par notre équipe et la communauté.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beaucoup de travail sera nécessaire pour améliorer et accélérer le cycle, ainsi que pour réécrire les filtres de demande selon les derniers RFC. </font><font style="vertical-align: inherit;">En cours de développement, un composant permet de travailler et d'émuler des bases de données de valeurs-clés. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous n'avons tout simplement pas réussi à traduire beaucoup de choses depuis la première version. </font><font style="vertical-align: inherit;">Les plans sont de restaurer les packages ODM, le panneau d'administration, d'écrire un bon profileur, etc.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Communauté et liens</font></font></h4> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez vous connecter à notre petite communauté </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Discord</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Canal télégramme</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Site cadre</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Framework Github</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Application standard Github</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout le code est distribué sous la licence MIT et n'a aucune restriction pour une utilisation commerciale. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Merci pour l'attention. </font><font style="vertical-align: inherit;">J'espère que nos outils vous seront utiles dans vos projets!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr495210/index.html">Comment les fraudeurs de Runet ont réagi au coronavirus</a></li>
<li><a href="../fr495212/index.html">Compilation native dans Quarkus - pourquoi c'est important</a></li>
<li><a href="../fr495214/index.html">Au bureau de personne: développer des jeux sur un site distant</a></li>
<li><a href="../fr495216/index.html">Apprentissage, négociation, conseil à distance - Partie 2: Vinteo Server - 3 mois de visioconférence gratuits</a></li>
<li><a href="../fr495220/index.html">Le système solaire a acquis sa configuration actuelle peu de temps après sa formation</a></li>
<li><a href="../fr495226/index.html">Dans la plupart des réseaux d'entreprise, il peut y avoir des traces de pirates et de vulnérabilités associées</a></li>
<li><a href="../fr495228/index.html">WebStorm 2020.1: améliorations de l'interface, prise en charge de Vuex et lancement de Prettier lors de l'enregistrement de fichiers</a></li>
<li><a href="../fr495230/index.html">Technique d'entrevue «MoSt»</a></li>
<li><a href="../fr495232/index.html">Du 4 au 5 avril sera une sélection d'intensifs en ligne dans le cadre du festival RuCode</a></li>
<li><a href="../fr495234/index.html">Jeu de données public OpenStreetMap sur Google Cloud Platform avec BigQuery SQL. Classificateur de couche OSM</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>