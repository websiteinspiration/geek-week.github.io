<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíæ üë©üèª‚Äçüç≥ üîö 13 ferramentas de processamento de texto baseadas em shell ‚¨õÔ∏è üßîüèø üë©üèΩ‚Äçüåæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aqui est√° um fragmento de um livro futuro, Ferramentas e pr√°ticas b√°sicas para um desenvolvedor de software iniciante, de Balthazar Ruberol e Etienne ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>13 ferramentas de processamento de texto baseadas em shell</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/itsumma/blog/492932/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqui est√° um fragmento de um livro futuro, Ferramentas e pr√°ticas b√°sicas para um desenvolvedor de software iniciante, de Balthazar Ruberol e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Etienne Broad</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">O livro deve ajudar a educar a gera√ß√£o mais jovem de desenvolvedores. </font><font style="vertical-align: inherit;">Ele cobrir√° temas como dominar o console, configurar e trabalhar de forma eficiente no shell de comando, controle de vers√£o de c√≥digo usando </font></font><code>git</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no√ß√µes b√°sicas de SQL, ferramentas como </font></font><code>Make</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>jq</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e express√µes regulares, no√ß√µes b√°sicas de rede, bem como as melhores pr√°ticas para o desenvolvimento de software e colabora√ß√£o. </font><font style="vertical-align: inherit;">Os autores est√£o atualmente trabalhando neste projeto e est√£o convidando todos a participar </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">da lista de discuss√£o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conte√∫do</font></font></h1><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gato</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cabe√ßa</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rabo</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">banheiro</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grep</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cortar</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">colar</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ordenar</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uniq</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">awk</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tr</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dobra</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sed</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemplos reais</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aprofundamento: loops for e xargs</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sum√°rio</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qual √© o pr√≥ximo</font></font></a></li>
</ul><a name="habracut"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Processamento de texto do shell</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um dos motivos que tornam o shell de comando uma ferramenta inestim√°vel √© o grande n√∫mero de comandos de processamento de texto e a capacidade de combin√°-los facilmente no pipeline, criando modelos de processamento complexos. </font><font style="vertical-align: inherit;">Esses comandos tornam muitas tarefas triviais para analisar texto e dados, converter dados entre diferentes formatos, filtrar seq√º√™ncias de caracteres, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao trabalhar com dados de texto, o princ√≠pio principal √© dividir qualquer problema complexo em muitos menores - e resolver cada deles usando uma ferramenta especializada.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fa√ßa com que cada programa fa√ßa uma coisa bem - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The Fundamentals of Unix Philosophy</font></font></a></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os exemplos deste cap√≠tulo podem parecer um pouco exagerados √† primeira vista, mas isso √© feito de prop√≥sito. </font><font style="vertical-align: inherit;">Cada uma das ferramentas foi projetada para resolver um pequeno problema. </font><font style="vertical-align: inherit;">No entanto, quando combinados, eles se tornam extremamente poderosos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Examinaremos alguns dos comandos de processamento de texto mais comuns e √∫teis no shell de comando e demonstraremos os fluxos de trabalho reais que os conectam. </font><font style="vertical-align: inherit;">Sugiro olhar para a mana dessas equipes para ver toda a amplitude de possibilidades √† sua disposi√ß√£o.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um arquivo CSV de exemplo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est√° dispon√≠vel online</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Voc√™ pode baix√°-lo para verificar o material.</font></font></blockquote><br>
<a name="1"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gato</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O comando √© </font></font><code>cat</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usado para compilar uma lista de um ou mais arquivos e exibir seu conte√∫do na tela.</font></font><br>
<br>
<pre><code class="plaintext hljs">$ cat Documents/readme<font></font>
Thanks again for reading this book!<font></font>
I hope you're following so far!<font></font>
<font></font>
$ cat Documents/computers<font></font>
Computers are not intelligent<font></font>
They're just fast at making dumb things.<font></font>
<font></font>
$ cat Documents/readme Documents/computers<font></font>
Thanks again for reading this book!<font></font>
I hope you are following so far!<font></font>
<font></font>
Computers are not intelligent<font></font>
They're just fast at making dumb things.</code></pre><br>
<a name="2"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cabe√ßa</font></font></h1><br>
<code>head</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imprime as primeiras n linhas no arquivo. </font><font style="vertical-align: inherit;">Isso pode ser muito √∫til para procurar um arquivo de estrutura e formato desconhecido, sem encher o console inteiro com um monte de texto.</font></font><br>
<br>
<pre><code class="bash hljs">$ head -n 2 metadata.csv<font></font>
metric_name,metric_type,interval,unit_name,per_unit_name,description,orientation,integration,short_name<font></font>
mysql.galera.wsrep_cluster_size,gauge,,node,,The current number of nodes <span class="hljs-keyword">in</span> the Galera cluster.,0,mysql,galera cluster size</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se </font></font><code>-n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o especificado, </font></font><code>head</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imprime as dez primeiras linhas do arquivo ou fluxo de entrada especificado.</font></font><br>
<br>
<a name="3"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rabo</font></font></h1><br>
<code>tail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- um anal√≥gico </font></font><code>head</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, apenas exibe as √∫ltimas n linhas do arquivo.</font></font><br>
<br>
<pre><code class="bash hljs">$ tail -n 1 metadata.csv<font></font>
mysql.performance.queries,gauge,,query,second,The rate of queries.,0,mysql,queries</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ quiser imprimir todas as linhas localizadas ap√≥s a linha n (inclusive), voc√™ pode usar o argumento </font></font><code>-n +n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ tail -n +42 metadata.csv<font></font>
mysql.replication.slaves_connected,gauge,,,,Number of slaves connected to a replication master.,0,mysql,slaves connected<font></font>
mysql.performance.queries,gauge,,query,second,The rate of queries.,0,mysql,queries</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem 43 linhas em nosso arquivo, portanto, ele </font></font><code>tail -n +42</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apenas gera as 42¬™ e 43¬™ linhas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se o par√¢metro </font></font><code>-n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o </font><font style="vertical-align: inherit;">for </font><font style="vertical-align: inherit;">especificado, ele </font></font><code>tail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">produzir√° as √∫ltimas dez linhas no arquivo especificado ou no fluxo de entrada. </font></font><br>
<br>
<code>tail -f</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou </font></font><code>tail --follow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exiba as √∫ltimas linhas do arquivo e cada nova linha conforme elas s√£o gravadas no arquivo. </font><font style="vertical-align: inherit;">Isso √© muito √∫til para visualizar atividades em tempo real, por exemplo, o que √© registrado nos logs do servidor da web etc.</font></font><br>
<br>
<a name="4"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">banheiro</font></font></h1><br>
<code>wc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(contagem de palavras) exibe o n√∫mero de caracteres ( </font></font><code>-c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), palavras ( </font></font><code>-w</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) ou linhas ( </font></font><code>-l</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) no arquivo ou fluxo especificado.</font></font><br>
<br>
<pre><code class="bash hljs">$ wc -l metadata.csv<font></font>
43  metadata.csv<font></font>
$ wc -w metadata.csv<font></font>
405 metadata.csv<font></font>
$ wc -c metadata.csv<font></font>
5094 metadata.csv</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por padr√£o, todas as op√ß√µes acima s√£o exibidas.</font></font><br>
<br>
<pre><code class="bash hljs">$ wc metadata.csv<font></font>
43     405    5094 metadata.csv</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se os dados de texto forem canalizados ou redirecionados </font></font><code>stdin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, apenas o contador ser√° exibido.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat metadata.csv | wc<font></font>
43     405    5094<font></font>
$ cat metadata.csv | wc -l<font></font>
43<font></font>
$ wc -w &lt; metadata.csv<font></font>
405</code></pre><br>
<a name="5"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grep</font></font></h1><br>
<code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Trata-se de um filtro de faca su√≠√ßo, de acordo com um determinado padr√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, podemos encontrar todas as ocorr√™ncias da palavra </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mutex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> em um arquivo.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep mutex metadata.csv<font></font>
mysql.innodb.mutex_os_waits,gauge,,event,second,The rate of mutex OS waits.,0,mysql,mutex os waits<font></font>
mysql.innodb.mutex_spin_rounds,gauge,,event,second,The rate of mutex spin rounds.,0,mysql,mutex spin rounds<font></font>
mysql.innodb.mutex_spin_waits,gauge,,event,second,The rate of mutex spin waits.,0,mysql,mutex spin waits</code></pre><br>
<code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pode processar arquivos especificados como argumentos ou um fluxo de texto passado para ele </font></font><code>stdin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Assim, podemos concatenar v√°rios comandos </font></font><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para filtrar ainda mais o texto. </font><font style="vertical-align: inherit;">No exemplo a seguir, filtramos as linhas em nosso arquivo </font></font><code>metadata.csv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para encontrar linhas que contenham </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mutex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="bash hljs">$ grep mutex metadata.csv | grep OS<font></font>
mysql.innodb.mutex_os_waits,gauge,,event,second,The rate of mutex OS waits.,0,mysql,mutex os waits</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos considerar algumas op√ß√µes </font></font><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e seu comportamento. </font></font><br>
<br>
<code>grep -v</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Executa a correspond√™ncia inversa: filtra as strings que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> correspondem ao padr√£o de argumento.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -v gauge metadata.csv<font></font>
metric_name,metric_type,interval,unit_name,per_unit_name,description,orientation,integration,short_name</code></pre><br>
<code> grep -i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Executa correspond√™ncia sem distin√ß√£o entre mai√∫sculas e min√∫sculas. </font><font style="vertical-align: inherit;">O exemplo a seguir </font></font><code>grep -i os</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localiza </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -i os metadata.csv<font></font>
mysql.innodb.mutex_os_waits,gauge,,event,second,The rate of mutex OS waits.,0,mysql,mutex os waits<font></font>
mysql.innodb.os_log_fsyncs,gauge,,write,second,The rate of fsync writes to the <span class="hljs-built_in">log</span> file.,0,mysql,<span class="hljs-built_in">log</span> fsyncs</code></pre><br>
<code>grep -l</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lista arquivos que cont√™m uma correspond√™ncia.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -l mysql metadata.csv<font></font>
metadata.csv</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A equipe </font></font><code>grep -c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conta quantas vezes uma amostra foi encontrada.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -c select metadata.csv<font></font>
3</code></pre><br>
<code>grep -r</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> procura recursivamente por arquivos no diret√≥rio de trabalho atual e todos os seus subdiret√≥rios.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -r are ~/Documents<font></font>
/home/br/Documents/computers:Computers are not intelligent<font></font>
/home/br/Documents/readme:I hope you are following so far!</code></pre><br>
<code>grep -w</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mostra apenas palavras inteiras correspondentes.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep follow ~/Documents/readme<font></font>
I hope you are following so far!<font></font>
$ grep -w follow ~/Documents/readme<font></font>
$</code></pre><br>
<a name="6"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cortar</font></font></h1><br>
<code>cut</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extrai parte do arquivo (ou, como sempre, o fluxo de entrada). </font><font style="vertical-align: inherit;">O comando define o separador de campos (que separa as colunas) usando a op√ß√£o </font></font><code>-d</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e os n√∫meros das colunas a serem recuperados usando a op√ß√£o </font></font><code>-f</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, o comando a seguir recupera a primeira coluna das √∫ltimas cinco linhas do nosso arquivo CSV.</font></font><br>
<br>
<pre><code class="bash hljs">$ tail -n 5 metadata.csv | cut -d , -f 1<font></font>
mysql.performance.user_time<font></font>
mysql.replication.seconds_behind_master<font></font>
mysql.replication.slave_running<font></font>
mysql.replication.slaves_connected<font></font>
mysql.performance.queries</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como estamos lidando com CSV, as colunas s√£o separadas por v√≠rgula e a op√ß√£o √© respons√°vel por recuperar a primeira coluna </font></font><code>-f 1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode selecionar ambas as primeira e segunda colunas usando a op√ß√£o </font></font><code>-f 1,2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ tail -n 5 metadata.csv | cut -d , -f 1,2<font></font>
mysql.performance.user_time,gauge<font></font>
mysql.replication.seconds_behind_master,gauge<font></font>
mysql.replication.slave_running,gauge<font></font>
mysql.replication.slaves_connected,gauge<font></font>
mysql.performance.queries,gauge</code></pre><br>
<a name="7"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">colar</font></font></h1><br>
<code>paste</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mescla dois arquivos diferentes em um arquivo de v√°rias colunas.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat ingredients<font></font>
eggs<font></font>
milk<font></font>
butter<font></font>
tomatoes<font></font>
$ cat prices<font></font>
1$<font></font>
1.99$<font></font>
1.50$<font></font>
2$/kg<font></font>
$ paste ingredients prices<font></font>
eggs    1$<font></font>
milk    1.99$<font></font>
butter  1.50$<font></font>
tomatoes    2$/kg</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por padr√£o, ele </font></font><code>paste</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usa um delimitador de guia, mas ele pode ser alterado usando o par√¢metro </font></font><code>-d</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ paste ingredients prices -d:<font></font>
eggs:1$<font></font>
milk:1.99$<font></font>
butter:1.50$<font></font>
tomatoes:2$/kg</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outro caso de uso comum </font></font><code>paste</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;√© combinar todas as linhas em um fluxo ou arquivo usando o delimitador especificado, usando uma combina√ß√£o de </font></font><code>-s</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>-d</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ paste -s -d, ingredients<font></font>
eggs,milk,butter,tomatoes</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se um par√¢metro for especificado como um arquivo de entrada </font></font><code>-</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ele ser√° lido </font></font><code>stdin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat ingredients | paste -s -d, -<font></font>
eggs,milk,butter,tomatoes</code></pre><br>
<a name="8"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ordenar</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O comando </font></font><code>sort</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">realmente classifica os dados (no arquivo especificado ou no fluxo de entrada).</font></font><br>
<br>
<pre><code class="bash hljs">$ cat ingredients<font></font>
eggs<font></font>
milk<font></font>
butter<font></font>
tomatoes<font></font>
salt<font></font>
$ sort ingredients<font></font>
butter<font></font>
eggs<font></font>
milk<font></font>
salt<font></font>
tomatoes</code></pre><br>
<code>sort -r</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> executa a classifica√ß√£o reversa.</font></font><br>
<br>
<pre><code class="bash hljs">$ sort -r ingredients<font></font>
tomatoes<font></font>
salt<font></font>
milk<font></font>
eggs<font></font>
butter</code></pre><br>
<code>sort -n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Classifica os campos pelo seu valor aritm√©tico.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat numbers<font></font>
0<font></font>
2<font></font>
1<font></font>
10<font></font>
3<font></font>
$ sort numbers<font></font>
0<font></font>
1<font></font>
10<font></font>
2<font></font>
3<font></font>
$ sort -n numbers<font></font>
0<font></font>
1<font></font>
2<font></font>
3<font></font>
10</code></pre><br>
<a name="9"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uniq</font></font></h1><br>
<code>uniq</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Detecta e filtra linhas id√™nticas adjacentes no arquivo ou fluxo de entrada especificado.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat duplicates<font></font>
and one<font></font>
and one<font></font>
and two<font></font>
and one<font></font>
and two<font></font>
and one, two, three<font></font>
$ uniq duplicates<font></font>
and one<font></font>
and two<font></font>
and one<font></font>
and two<font></font>
and one, two, three</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como </font></font><code>uniq</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filtra apenas as </font><font style="vertical-align: inherit;">linhas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adjacentes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , duplicatas ainda podem permanecer em nossos dados. </font><font style="vertical-align: inherit;">Para filtrar todas as mesmas linhas de um arquivo, voc√™ deve primeiro classificar seu conte√∫do.</font></font><br>
<br>
<pre><code class="bash hljs">$ sort duplicates | uniq<font></font>
and one<font></font>
and one, two, three<font></font>
and two</code></pre><br>
<code>uniq -c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no in√≠cio de cada linha insere o n√∫mero de suas ocorr√™ncias.</font></font><br>
<br>
<pre><code class="bash hljs">$ sort duplicates | uniq -c<font></font>
   3 and one<font></font>
   1 and one, two, three<font></font>
   2 and two</code></pre><br>
<code>uniq -u</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Exibe apenas cadeias √∫nicas.</font></font><br>
<br>
<pre><code class="bash hljs">$ sort duplicates | uniq -u<font></font>
and one, two, three</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota. </font></font><code>uniq</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√â especialmente √∫til em combina√ß√£o com a classifica√ß√£o, pois o pipeline </font></font><code>| sort | uniq</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">permite excluir todas as linhas duplicadas em um arquivo ou fluxo.</font></font></blockquote><br>
<a name="10"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">awk</font></font></h1><br>
<code>awk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Isso √© um pouco mais do que apenas uma ferramenta de processamento de texto: na verdade, ele tem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uma linguagem de programa√ß√£o inteira</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">O que √© </font></font><code>awk</code> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">realmente</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bom √© dividir arquivos em colunas e o faz com um brilho especial quando espa√ßos e guias s√£o misturados nos arquivos.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat -t multi-columns<font></font>
John Smith    Doctor^ITardis<font></font>
Sarah-James Smith^I    Companion^ILondon<font></font>
Rose Tyler   Companion^ILondon</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota. </font></font><code>cat -t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exibe guias como </font></font><code>^I</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como voc√™ pode ver, as colunas s√£o separadas por espa√ßos ou tabula√ß√µes e nem sempre pelo mesmo n√∫mero de espa√ßos. </font></font><code>cut</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui √© in√∫til porque funciona com apenas um caractere separador. </font><font style="vertical-align: inherit;">Mas </font></font><code>awk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© f√°cil lidar com esse arquivo. </font></font><br>
<br>
<code>awk '{ print $n }'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exibe a en√©sima coluna no texto.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat multi-columns | awk <span class="hljs-string">'{ print $1 }'</span><font></font>
John<font></font>
Sarah-James<font></font>
Rose<font></font>
$ cat multi-columns | awk <span class="hljs-string">'{ print $3 }'</span><font></font>
Doctor<font></font>
Companion<font></font>
Companion<font></font>
$ cat multi-columns | awk <span class="hljs-string">'{ print $1,$2 }'</span><font></font>
John Smith<font></font>
Sarah-James Smith<font></font>
Rose Tyler</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Embora seja </font></font><code>awk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">capaz de muito mais, a sa√≠da dos alto-falantes √© provavelmente 99% dos casos de uso no meu caso pessoal.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota. </font></font><code>{ print $NF }</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exibe a √∫ltima coluna em uma linha.</font></font></blockquote><br>
<a name="11"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tr</font></font></h1><br>
<code>tr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">significa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">traduzir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Este comando substitui um caractere por outro. </font><font style="vertical-align: inherit;">Funciona com caracteres ou </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classes de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> caracteres como min√∫sculas, digitadas, espa√ßos alfanum√©ricos etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na entrada padr√£o, </font></font><code>tr &lt;char1&gt; &lt;char2&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">substitui todas as ocorr√™ncias de &lt;char1&gt; por &lt;char2&gt;.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"Computers are fast"</span> | tr a A<font></font>
computers Are fAst</code></pre><br>
<code>tr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pode traduzir classes de caracteres usando nota√ß√£o </font></font><code>[:class:]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Uma lista completa de classes dispon√≠veis √© descrita na p√°gina de manual </font></font><code>tr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas algumas s√£o demonstradas aqui. </font></font><br>
<br>
<code>[:space:]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">representa todos os tipos de espa√ßos, de espa√ßos simples a guias ou novas linhas.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"computers are fast"</span> | tr <span class="hljs-string">'[:space:]'</span> <span class="hljs-string">','</span>
computers,are,fast,%</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos os caracteres, como espa√ßos, s√£o separados por v√≠rgula. </font><font style="vertical-align: inherit;">Observe que o caractere </font></font><code>%</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no final da sa√≠da indica a aus√™ncia de uma nova linha final. </font><font style="vertical-align: inherit;">Na verdade, esse personagem tamb√©m √© convertido em v√≠rgula. </font></font><br>
<br>
<code>[:lower:]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">representa todos os caracteres em min√∫sculas e </font></font><code>[:upper:]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;todos os </font><font style="vertical-align: inherit;">caracteres em </font><font style="vertical-align: inherit;">mai√∫sculas. </font><font style="vertical-align: inherit;">Assim, a transforma√ß√£o entre eles se torna trivial.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"computers are fast"</span> | tr <span class="hljs-string">'[:lower:]'</span> <span class="hljs-string">'[:upper:]'</span><font></font>
COMPUTERS ARE FAST<font></font>
$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"COMPUTERS ARE FAST"</span> | tr <span class="hljs-string">'[:upper:]'</span> <span class="hljs-string">'[:lower:]'</span>
computers are fast</code></pre><br>
<code>tr -c SET1 SET2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">converte qualquer caractere </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> inclu√≠do no SET1 em caracteres no SET2. </font><font style="vertical-align: inherit;">No exemplo a seguir, todos os caracteres, exceto as vogais indicadas, s√£o substitu√≠dos por espa√ßos.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"computers are fast"</span> | tr -c <span class="hljs-string">'[aeiouy]'</span> <span class="hljs-string">' '</span>
 o  u e   a e  a</code></pre><br>
<code>tr -d</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exclui os caracteres especificados, mas n√£o os substitui. </font><font style="vertical-align: inherit;">Isto √© o equivalente </font></font><code>tr &lt;char&gt; ''</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"Computers Are Fast"</span> | tr -d <span class="hljs-string">'[:lower:]'</span>
C A F</code></pre><br>
<code>tr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tamb√©m pode substituir os intervalos de caracteres, por exemplo, todas as letras entre </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou todos os n√∫meros entre 1 e 8, usando a nota√ß√£o </font></font><code>s-e</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, onde </font></font><code>s</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;√© o caractere inicial e </font></font><code>e</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;o final.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"computers are fast"</span> | tr <span class="hljs-string">'a-e'</span> <span class="hljs-string">'x'</span><font></font>
xomputxrs xrx fxst<font></font>
$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"5uch l337 5p34k"</span> | tr <span class="hljs-string">'1-4'</span> <span class="hljs-string">'x'</span>
5uch lxx7 5pxxk</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O comando </font></font><code>tr -s string1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">compacta todas as m√∫ltiplas ocorr√™ncias de caracteres </font></font><code>string1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em um √∫nico. </font><font style="vertical-align: inherit;">Um dos usos mais √∫teis </font></font><code>tr -s</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© substituir v√°rios espa√ßos consecutivos por um.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"Computers         are       fast"</span> | tr -s <span class="hljs-string">' '</span>
Computers are fast</code></pre><br>
<a name="12"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dobra</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O comando </font></font><code>fold</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recolhe todas as linhas de entrada para a largura especificada. </font><font style="vertical-align: inherit;">Por exemplo, pode ser √∫til garantir que o texto caiba em telas pequenas. </font><font style="vertical-align: inherit;">Ent√£o, </font></font><code>fold -w n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">empilha strings de largura n caracteres.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat ~/Documents/readme | fold -w 16<font></font>
Thanks again <span class="hljs-keyword">for</span><font></font>
 reading this bo<font></font>
ok!<font></font>
I hope you<span class="hljs-string">'re fo
llowing so far!</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O comando </font></font><code>fold -s</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quebrar√° linhas apenas em caracteres de espa√ßo. </font><font style="vertical-align: inherit;">Pode ser combinado com o anterior para limitar a sequ√™ncia ao n√∫mero especificado de caracteres.</font></font><br>
<br>
<pre><code class="bash hljs">Thanks again
<span class="hljs-keyword">for</span> reading<font></font>
this book!<font></font>
I hope you<span class="hljs-string">'re
following so
far!</span></code></pre><br>
<a name="13"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sed</font></font></h1><br>
<code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√â um editor de fluxo n√£o interativo usado para converter texto no fluxo de entrada linha por linha. </font><font style="vertical-align: inherit;">Como entrada, um arquivo ou, ou </font></font><code>stdin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, na sa√≠da, um arquivo ou </font></font><code>stdout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os comandos do editor podem incluir um ou mais </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">endere√ßos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , uma </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fun√ß√£o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par√¢metros</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Assim, os comandos s√£o os seguintes:</font></font><br>
<br>
<pre><code class="bash hljs">[address[,address]]<span class="hljs-keyword">function</span>[arguments]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Embora ele </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">execute muitas fun√ß√µes, consideraremos apenas substituir o texto como um dos casos de uso mais comuns.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Substitui√ß√£o de texto</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O comando de substitui√ß√£o √© </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o seguinte:</font></font><br>
<br>
<pre><code class="bash hljs">s/PATTERN/REPLACEMENT/[options]</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemplo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : substituindo a primeira inst√¢ncia de uma palavra em cada linha de um arquivo:</font></font><br>
<br>
<pre><code class="bash hljs">$ cat hello<font></font>
hello hello<font></font>
hello world!<font></font>
hi<font></font>
$ cat hello | sed <span class="hljs-string">'s/hello/Hey I just met you/'</span><font></font>
Hey I just met you hello<font></font>
Hey I just met you world<font></font>
hi</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos que na primeira linha apenas a primeira inst√¢ncia √© substitu√≠da </font></font><code>hello</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Para substituir </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">todas as</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ocorr√™ncias </font></font><code>hello</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em todas as linhas, voc√™ pode usar a op√ß√£o </font></font><code>g</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(significa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">global</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<pre><code class="bash hljs">$ cat hello | sed <span class="hljs-string">'s/hello/Hey I just met you/g'</span><font></font>
Hey I just met you Hey I just met you<font></font>
Hey I just met you world<font></font>
hi</code></pre><br>
<code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">permite usar qualquer delimitador </font></font><code>/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font><font style="vertical-align: inherit;">exceto </font><font style="vertical-align: inherit;">, o que melhora especialmente a legibilidade se houver barras nos pr√≥prios argumentos do comando.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat hello | sed <span class="hljs-string">'s@hello@Hey I just met you@g'</span><font></font>
Hey I just met you Hey I just met you<font></font>
Hey I just met you world<font></font>
hi</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O endere√ßo informa ao editor em qual linha ou intervalo de linhas executar a substitui√ß√£o.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat hello | sed <span class="hljs-string">'1s/hello/Hey I just met you/g'</span><font></font>
Hey I just met you hello<font></font>
hello world<font></font>
hi<font></font>
$ cat hello | sed <span class="hljs-string">'2s/hello/Hey I just met you/g'</span><font></font>
hello hello<font></font>
Hey I just met you  world<font></font>
hi</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O endere√ßo </font></font><code>1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indica substituir </font></font><code>hello</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no </font></font><code>Hey I just met you</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">na primeira linha. </font><font style="vertical-align: inherit;">Podemos especificar o intervalo de endere√ßos na nota√ß√£o </font></font><code>&lt;start&gt;,&lt;end&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, onde </font></font><code>&lt;end&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pode ser o n√∫mero da linha ou </font></font><code>$</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font><font style="vertical-align: inherit;">ou </font><font style="vertical-align: inherit;">seja, a √∫ltima linha do arquivo.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat hello | sed <span class="hljs-string">'1,2s/hello/Hey I just met you/g'</span><font></font>
Hey I just met you Hey I just met you<font></font>
Hey I just met you world<font></font>
hi<font></font>
$ cat hello | sed <span class="hljs-string">'2,3s/hello/Hey I just met you/g'</span><font></font>
hello hello<font></font>
Hey I just met you world<font></font>
hi<font></font>
$ cat hello | sed <span class="hljs-string">'2,$s/hello/Hey I just met you/g'</span><font></font>
hello hello<font></font>
Hey I just met you world<font></font>
hi</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por padr√£o, ele </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">produz o resultado em sua pr√≥pria </font></font><code>stdout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas tamb√©m pode editar o arquivo original com a op√ß√£o </font></font><code>-i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ sed -i <span class="hljs-string">''</span> <span class="hljs-string">'s/hello/Bonjour/'</span> sed-data<font></font>
$ cat sed-data<font></font>
Bonjour hello<font></font>
Bonjour world<font></font>
hi</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota. </font><font style="vertical-align: inherit;">No Linux, apenas o suficiente </font></font><code>-i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mas no macOS, o comportamento do comando √© um pouco diferente, ent√£o </font></font><code>-i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">voc√™ precisa adicionar </font><font style="vertical-align: inherit;">logo em seguida </font></font><code>''</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></blockquote><br>
<a name="14"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemplos reais</font></font></h1><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Filtragem CSV com grep e awk</font></font></h3><br>
<pre><code class="bash hljs">$ grep -w gauge metadata.csv | awk -F, <span class="hljs-string">'{ if ($4 == "query") { print $1, "per", $5 } }'</span><font></font>
mysql.performance.com_delete per second<font></font>
mysql.performance.com_delete_multi per second<font></font>
mysql.performance.com_insert per second<font></font>
mysql.performance.com_insert_select per second<font></font>
mysql.performance.com_replace_select per second<font></font>
mysql.performance.com_select per second<font></font>
mysql.performance.com_update per second<font></font>
mysql.performance.com_update_multi per second<font></font>
mysql.performance.questions per second<font></font>
mysql.performance.slow_queries per second<font></font>
mysql.performance.queries per second</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste exemplo </font></font><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, o arquivo </font></font><code>metadata.csv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filtra primeiro as linhas que cont√™m a palavra </font></font><code>gauge</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, depois as da </font></font><code>query</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quarta coluna e exibe o nome da m√©trica (1¬™ coluna) com o valor correspondente </font></font><code>per_unit_name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(5¬™ coluna).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exibe o endere√ßo IPv4 associado √† interface de rede</font></font></h3><br>
<pre><code class="bash hljs">$ ifconfig en0 | grep inet | grep -v inet6 | awk <span class="hljs-string">'{ print $2 }'</span>
192.168.0.38</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O comando </font></font><code>ifconfig &lt;interface name&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exibe informa√ß√µes na interface de rede especificada. </font><font style="vertical-align: inherit;">Por exemplo:</font></font><br>
<br>
<pre><code class="bash hljs">en0: flags=8863&lt;UP,BROADCAST,SMART,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500<font></font>
    ether 19:64:92:de:20:ba<font></font>
    inet6 fe80::8a3:a1cb:56ae:7c7c%en0 prefixlen 64 secured scopeid 0x7<font></font>
    inet 192.168.0.38 netmask 0xffffff00 broadcast 192.168.0.255<font></font>
    nd6 options=201&lt;PERFORMNUD,DAD&gt;<font></font>
    media: autoselect<font></font>
    status: active</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o corra </font></font><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para </font></font><code>inet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, isso produzir√° duas linhas de correspond√™ncia.</font></font><br>
<br>
<pre><code class="bash hljs">$ ifconfig en0 | grep inet<font></font>
    inet6 fe80::8a3:a1cb:56ae:7c7c%en0 prefixlen 64 secured scopeid 0x7<font></font>
    inet 192.168.0.38 netmask 0xffffff00 broadcast 192.168.0.255</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, usando </font></font><code>grep -v</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">excluir a linha com </font></font><code>ipv6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ ifconfig en0 | grep inet | grep -v inet6<font></font>
inet 192.168.0.38 netmask 0xffffff00 broadcast 192.168.0.255</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Finalmente, com a ajuda, </font></font><code>awk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solicitamos a segunda coluna nesta linha: este √© o endere√ßo IPv4 associado √† nossa interface de rede </font></font><code>en0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ ifconfig en0 | grep inet | grep -v inet6 | awk <span class="hljs-string">'{ print $2 }'</span>
192.168.0.38</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota. </font><font style="vertical-align: inherit;">Me </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ofereceram</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a substitui√ß√£o por </font></font><code>grep inet | grep -v inet6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uma equipe t√£o confi√°vel </font></font><code>awk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="bash hljs">$ ifconfig en0 | awk <span class="hljs-string">' $1 == "inet" { print $2 }'</span>
192.168.0.38</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â mais curto e √© direcionado especificamente para IPv4 com a condi√ß√£o </font></font><code>$1 == "inet"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></blockquote><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recuperando um valor de um arquivo de configura√ß√£o</font></font></h3><br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">'editor ='</span> ~/.gitconfig  | cut -d = -f2 | sed <span class="hljs-string">'s/ //g'</span>
/usr/bin/vim</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No arquivo de configura√ß√£o git do usu√°rio atual, procure o valor </font></font><code>editor =</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, corte o caractere </font></font><code>=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, extraia a segunda coluna e exclua todos os espa√ßos ao redor.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">'editor ='</span> ~/.gitconfig<font></font>
     editor = /usr/bin/vim<font></font>
$ grep <span class="hljs-string">'editor ='</span> ~/.gitconfig  | cut -d<span class="hljs-string">'='</span> -f2<font></font>
 /usr/bin/vim<font></font>
$ grep <span class="hljs-string">'editor ='</span> ~/.gitconfig  | cut -d<span class="hljs-string">'='</span> -f2 | sed <span class="hljs-string">'s/ //'</span>
/usr/bin/vim</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Extrair IPs de um arquivo de log</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O c√≥digo real a seguir procura uma mensagem no log do banco de dados </font></font><code>Too many connections from</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(seguido por um endere√ßo IP) e exibe os dez principais invasores.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">'Too many connections from'</span> db.log | \<font></font>
  awk <span class="hljs-string">'{ print $12 }'</span> | \<font></font>
  sed <span class="hljs-string">'s@/@@'</span> | \<font></font>
  sort | \<font></font>
  uniq -c | \<font></font>
  sort -rn | \<font></font>
  head -n 10 | \<font></font>
  awk <span class="hljs-string">'{ print $2 }'</span><font></font>
   10.11.112.108<font></font>
   10.11.111.70<font></font>
   10.11.97.57<font></font>
   10.11.109.72<font></font>
   10.11.116.156<font></font>
   10.11.100.221<font></font>
   10.11.96.242<font></font>
   10.11.81.68<font></font>
   10.11.99.112<font></font>
   10.11.107.120</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos ver o que esse pipeline faz. </font><font style="vertical-align: inherit;">Primeiro, como √© a linha no log.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">"Too many connections from"</span> db.log | head -n 1<font></font>
2020-01-01 08:02:37,617 [myid:1] - WARN  [NIOServerCxn.Factory:1.2.3.4/1.2.3.4:2181:NIOServerCnxnFactory@193] - Too many connections from /10.11.112.108 - max is 60</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, </font></font><code>awk '{ print $12 }'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extrai o endere√ßo IP da string.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">"Too many connections from"</span> db.log | awk <span class="hljs-string">'{ print $12 }'</span><font></font>
/10.11.112.108<font></font>
...</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O comando </font></font><code>sed 's@/@@'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exclui a barra inicial.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">"Too many connections from"</span> db.log | awk <span class="hljs-string">'{ print $12 }'</span> | sed <span class="hljs-string">'s@/@@'</span><font></font>
10.11.112.108<font></font>
...</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota. </font><font style="vertical-align: inherit;">Como vimos anteriormente, </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">voc√™ pode usar qualquer separador no. </font><font style="vertical-align: inherit;">Embora seja geralmente usado como separador </font></font><code>/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, aqui estamos substituindo esse caractere em particular, o que prejudicar√° levemente a legibilidade da express√£o de substitui√ß√£o.</font></font><br>
<br>
<pre><code class="bash hljs">sed <span class="hljs-string">'s/\///'</span></code></pre></blockquote><br>
<code>sort | uniq -c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> classifica os endere√ßos IP em ordem lexicogr√°fica e remove duplicatas, adicionando o n√∫mero de entradas antes de cada endere√ßo IP.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">'Too many connections from'</span> db.log | \<font></font>
  awk <span class="hljs-string">'{ print $12 }'</span> | \<font></font>
  sed <span class="hljs-string">'s@/@@'</span> | \<font></font>
  sort | \<font></font>
  uniq -c<font></font>
   1379 10.11.100.221<font></font>
   1213 10.11.103.168<font></font>
   1138 10.11.105.177<font></font>
    946 10.11.106.213<font></font>
   1211 10.11.106.4<font></font>
   1326 10.11.107.120<font></font>
   ...</code></pre><br>
<code>sort -rn | head -n 10</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classifica as linhas pelo n√∫mero de ocorr√™ncias, numericamente e na ordem inversa, para que os principais violadores sejam exibidos primeiro, dos quais 10 linhas s√£o exibidas. </font><font style="vertical-align: inherit;">O √∫ltimo comando </font></font><code>awk { print $2 }</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recupera os pr√≥prios endere√ßos IP.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">'Too many connections from'</span> db.log | \<font></font>
  awk <span class="hljs-string">'{ print $12 }'</span> | \<font></font>
  sed <span class="hljs-string">'s@/@@'</span> | \<font></font>
  sort | \<font></font>
  uniq -c | \<font></font>
  sort -rn | \<font></font>
  head -n 10 | \<font></font>
  awk <span class="hljs-string">'{ print $2 }'</span><font></font>
  10.11.112.108<font></font>
  10.11.111.70<font></font>
  10.11.97.57<font></font>
  10.11.109.72<font></font>
  10.11.116.156<font></font>
  10.11.100.221<font></font>
  10.11.96.242<font></font>
  10.11.81.68<font></font>
  10.11.99.112<font></font>
  10.11.107.120</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Renomeando uma fun√ß√£o no arquivo de origem</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imagine que estamos trabalhando em um projeto e gostar√≠amos de renomear a fun√ß√£o com o sobrenome (ou classe, vari√°vel etc.) no arquivo de origem. </font><font style="vertical-align: inherit;">Voc√™ pode fazer isso com um comando </font></font><code>sed -i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que substitui diretamente no arquivo original.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat izk/utils.py<font></font>
def bool_from_str(s):<font></font>
    <span class="hljs-keyword">if</span> s.isdigit():
        <span class="hljs-built_in">return</span> int(s) == 1
    <span class="hljs-built_in">return</span> s.lower() <span class="hljs-keyword">in</span> [<span class="hljs-string">'yes'</span>, <span class="hljs-string">'true'</span>, <span class="hljs-string">'y'</span>]</code></pre><br>
<pre><code class="bash hljs">$ sed -i <span class="hljs-string">'s/def bool_from_str/def is_affirmative/'</span> izk/utils.py<font></font>
$ cat izk/utils.py<font></font>
def is_affirmative(s):<font></font>
    <span class="hljs-keyword">if</span> s.isdigit():
        <span class="hljs-built_in">return</span> int(s) == 1
    <span class="hljs-built_in">return</span> s.lower() <span class="hljs-keyword">in</span> [<span class="hljs-string">'yes'</span>, <span class="hljs-string">'true'</span>, <span class="hljs-string">'y'</span>]</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota. </font><font style="vertical-align: inherit;">No macOS, </font></font><code>sed -i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">use em seu </font><font style="vertical-align: inherit;">lugar </font></font><code>sed -i ''</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, renomeamos a fun√ß√£o apenas no arquivo original. </font><font style="vertical-align: inherit;">Isso interromper√° a importa√ß√£o </font></font><code>bool_from_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em qualquer outro arquivo, pois essa fun√ß√£o n√£o est√° mais definida. </font><font style="vertical-align: inherit;">Precisamos encontrar uma maneira de renomear em </font></font><code>bool_from_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">todo o projeto. </font><font style="vertical-align: inherit;">Isso pode ser conseguido usando comandos </font></font><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bem como loops </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou usando </font></font><code>xargs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<a name="15"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aprofundamento: ciclos </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e</font></font><code>xargs</code></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para substituir todas as ocorr√™ncias em nosso projeto </font></font><code>bool_from_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, voc√™ deve primeiro encontr√°-las recursivamente com </font></font><code>grep -r</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -r bool_from_str .<font></font>
./tests/test_utils.py:from izk.utils import bool_from_str<font></font>
./tests/test_utils.py:def test_bool_from_str(s, expected):<font></font>
./tests/test_utils.py:    assert bool_from_str(s) == expected<font></font>
./izk/utils.py:def bool_from_str(s):<font></font>
./izk/prompt.py:from .utils import bool_from_str<font></font>
./izk/prompt.py:                    default = bool_from_str(os.environ[envvar])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como estamos interessados ‚Äã‚Äãapenas em arquivos com correspond√™ncias, voc√™ tamb√©m deve usar a op√ß√£o </font></font><code>-l/--files-with-matches</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="bash hljs">-l, --files-with-matches<font></font>
        Only the names of files containing selected lines are written to standard out-<font></font>
        put.  grep will only search a file until a match has been found, making<font></font>
        searches potentially less expensive.  Pathnames are listed once per file<font></font>
        searched.  If the standard input is searched, the string ``(standard input)<span class="hljs-string">''</span>
        is written.</code></pre><br>
<pre><code class="bash hljs">$ grep -r --files-with-matches bool_from_str .<font></font>
./tests/test_utils.py<font></font>
./izk/utils.py<font></font>
./izk/prompt.py</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, podemos usar o comando </font></font><code>xargs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para executar a√ß√µes de cada linha da sa√≠da (ou seja, todos os arquivos que cont√™m a linha </font></font><code>bool_from_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">).</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -r --files-with-matches bool_from_str . | \<font></font>
  xargs -n 1 sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A op√ß√£o </font></font><code>-n 1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indica que cada linha na sa√≠da deve executar um comando separado </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, os seguintes comandos s√£o executados:</font></font><br>
<br>
<pre><code class="bash hljs">$ sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> ./tests/test_utils.py<font></font>
$ sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> ./izk/utils.py<font></font>
$ sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> ./izk/prompt.py</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se o comando com o qual voc√™ chama </font></font><code>xargs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(no nosso caso </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) suporta v√°rios argumentos, voc√™ deve descart√°-lo </font></font><code>-n 1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para desempenho.</font></font><br>
<br>
<pre><code class="bash hljs">grep -r --files-with-matches bool_from_str . | xargs sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este comando ser√° executado</font></font><br>
<br>
<pre><code class="bash hljs">$ sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> ./tests/test_utils.py ./izk/utils.py ./izk/prompt.py</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota. </font><font style="vertical-align: inherit;">A partir da sinopse </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">na p√°gina do manual, pode-se ver que a equipe pode aceitar v√°rios argumentos.</font></font><br>
<br>
<pre><code class="bash hljs">SYNOPSIS<font></font>
     sed [-Ealn] <span class="hljs-built_in">command</span> [file ...]<font></font>
     sed [-Ealn] [-e <span class="hljs-built_in">command</span>] [-f command_file] [-i extension] [file ...]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De fato, como vimos no cap√≠tulo anterior, isso </font></font><code>file ...</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">significa que v√°rios argumentos s√£o aceitos, que s√£o nomes de arquivos.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos que s√£o feitas substitui√ß√µes para todas as ocorr√™ncias </font></font><code>bool_from_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -r is_affirmative .<font></font>
./tests/test_utils.py:from izk.utils import is_affirmative<font></font>
./tests/test_utils.py:def test_is_affirmative(s, expected):<font></font>
./tests/test_utils.py:    assert is_affirmative(s) == expected<font></font>
./izk/utils.py:def is_affirmative(s):<font></font>
./izk/prompt.py:from .utils import is_affirmative<font></font>
./izk/prompt.py:                    default = is_affirmative(os.environ[envvar])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como costuma acontecer, existem v√°rias maneiras de obter o mesmo resultado. </font><font style="vertical-align: inherit;">Em vez disso, </font></font><code>xargs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">poder√≠amos usar loops </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para percorrer as linhas da lista e executar a√ß√µes em cada item. </font><font style="vertical-align: inherit;">Esses loops t√™m a seguinte sintaxe:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> list; <span class="hljs-keyword">do</span>
    <span class="hljs-built_in">command</span> <span class="hljs-variable">$item</span>
<span class="hljs-keyword">done</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se n√≥s envolvemos o nosso comando </font></font><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em </font></font><code>$()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, em seguida, o shell ir√° execut√°-lo em um </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">subn√≠vel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , cujo resultado ser√° ent√£o repetido em um loop </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> $(grep -r --files-with-matches bool_from_str .); <span class="hljs-keyword">do</span>
  sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> <span class="hljs-variable">$file</span>
<span class="hljs-keyword">done</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este comando ser√° executado</font></font><br>
<br>
<pre><code class="bash hljs">$ sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> ./tests/test_utils.py<font></font>
$ sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> ./izk/utils.py<font></font>
$ sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> ./izk/prompt.py</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A sintaxe do loop </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">me parece mais clara do que isso </font></font><code>xargs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas o √∫ltimo pode executar comandos em paralelo usando par√¢metros </font></font><code>-P n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, onde </font></font><code>n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© o n√∫mero m√°ximo de comandos paralelos executados ao mesmo tempo, o que pode proporcionar um ganho de desempenho.</font></font><br>
<br>
<a name="16"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sum√°rio</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todas essas ferramentas abrem um mundo inteiro de possibilidades, pois permitem extrair e transformar dados, criando pipelines inteiros de equipes que talvez nunca foram projetadas para trabalhar juntas. Cada um deles desempenha uma fun√ß√£o relativamente pequena (classifica√ß√£o </font></font><code>sort</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, combina√ß√£o </font></font><code>cat</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, filtros </font></font><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, edi√ß√£o </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, corte </font></font><code>cut</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, etc.). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qualquer tarefa que inclua texto pode ser reduzida a um pipeline de tarefas menores, cada uma executando uma a√ß√£o simples e transferindo sua sa√≠da para a pr√≥xima tarefa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, se quisermos saber quantos endere√ßos IP exclusivos est√£o no arquivo de log e para que esses endere√ßos IP sempre apare√ßam na mesma coluna, podemos executar a seguinte sequ√™ncia de comandos:</font></font><br>
<br>
<ul>
<li><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> strings que correspondem ao padr√£o de strings com endere√ßos IP</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">encontre a coluna com o endere√ßo IP, extraia-a com </font></font><code>awk</code><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classifique a lista de endere√ßos IP usando </font></font><code>sort</code><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eliminar duplicatas adjacentes com </font></font><code>uniq</code><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conte o n√∫mero de linhas (ou seja, endere√ßos IP exclusivos) usando </font></font><code>wc -l</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como existem muitas ferramentas de processamento de texto nativas e de terceiros, tamb√©m existem v√°rias maneiras de resolver qualquer problema. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os exemplos deste artigo foram exagerados, mas sugiro que voc√™ leia o incr√≠vel artigo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúAs ferramentas de linha de comando podem ser 235 vezes mais r√°pidas que o cluster do Hadoop‚Äù</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para ter uma id√©ia de qu√£o √∫teis e poderosos esses comandos realmente s√£o e quais s√£o os problemas reais eles podem decidir.</font></font><br>
<br>
<a name="17"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qual √© o pr√≥ximo</font></font></h1><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conte o n√∫mero de arquivos e diret√≥rios localizados no seu diret√≥rio pessoal.</font></font><br>
</li>
<li>     .<br>
</li>
<li>,       .<br>
</li>
<li>    .         .</li>
</ol><br>
<hr><br>
<i>  ¬´        ¬ª (Essential Tools and Practices for the Aspiring Software Developer)    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a>            ,     .    ,    ,   ,       ,      <code>git</code>,  SQL,   <code>Make</code>, <code>jq</code>   ,   ,          .<br>
<br>
    ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a>!</i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt492910/index.html">Controle de motor de passo via controlador Canny</a></li>
<li><a href="../pt492914/index.html">Como proteger funcion√°rios remotos ou o Home Office Security</a></li>
<li><a href="../pt492918/index.html">Papa: √âtica para IA e ve√≠culos n√£o tripulados</a></li>
<li><a href="../pt492920/index.html">Quarentena na Rep√∫blica Tcheca: um olhar por dentro</a></li>
<li><a href="../pt492924/index.html">Como visualizar e animar modelos (geof√≠sicos). Informatividade da visualiza√ß√£o</a></li>
<li><a href="../pt492934/index.html">Dificuldades em criar um assistente de voz. O olhar de um linguista e desenvolvedor</a></li>
<li><a href="../pt492938/index.html">Portal de ambientes de teste ou salve nossos devops</a></li>
<li><a href="../pt492940/index.html">Mergulhe no Charles Proxy</a></li>
<li><a href="../pt492942/index.html">Ontol (= mais √∫til) sobre trabalho remoto [compila√ß√£o de mais de 100 artigos]</a></li>
<li><a href="../pt492946/index.html">Coronav√≠rus: como nos enganamos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>