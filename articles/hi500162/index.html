<!doctype html>
<html class="no-js" lang="hi">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯРС ЁЯТЖЁЯП╝ ЁЯЪ┤ЁЯП╗ рдЧреНрд░реЗрдЯ рдЕрдЬрдЧрд░ рд╕реНрдкреЛрд░реНрдЯреНрд╕ рдбреЗрдЯрд╛ рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ ЁЯЩП ЁЯТ┤ тЧАя╕П</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдЕрдкрдиреЗ рдЦрд╛рд▓реА рд╕рдордп рдореЗрдВ рдкрд┐рдЫрд▓реЗ рдХреБрдЫ рд╡рд░реНрд╖реЛрдВ рд╕реЗ рдореИрдВ рдЯреНрд░рд╛рдпрдерд▓реЙрди рдХрд░ рд░рд╣рд╛ рд╣реВрдВред рдпрд╣ рдЦреЗрд▓ рджреБрдирд┐рдпрд╛ рдХреЗ рдХрдИ рджреЗрд╢реЛрдВ рдореЗрдВ рдмрд╣реБрдд рд▓реЛрдХрдкреНрд░рд┐рдп рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╕рдВрдпреБрдХреНрдд рд░рд╛рдЬреНрдп рдЕрдореЗрд░рд┐рдХрд╛, рдСрд╕...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>рдЧреНрд░реЗрдЯ рдЕрдЬрдЧрд░ рд╕реНрдкреЛрд░реНрдЯреНрд╕ рдбреЗрдЯрд╛ рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500162/"><img src="https://habrastorage.org/webt/wd/xv/ft/wdxvftc1pifrlchwt7ddj8dxtos.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдкрдиреЗ рдЦрд╛рд▓реА рд╕рдордп рдореЗрдВ рдкрд┐рдЫрд▓реЗ рдХреБрдЫ рд╡рд░реНрд╖реЛрдВ рд╕реЗ рдореИрдВ рдЯреНрд░рд╛рдпрдерд▓реЙрди рдХрд░ рд░рд╣рд╛ рд╣реВрдВред рдпрд╣ рдЦреЗрд▓ рджреБрдирд┐рдпрд╛ рдХреЗ рдХрдИ рджреЗрд╢реЛрдВ рдореЗрдВ рдмрд╣реБрдд рд▓реЛрдХрдкреНрд░рд┐рдп рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╕рдВрдпреБрдХреНрдд рд░рд╛рдЬреНрдп рдЕрдореЗрд░рд┐рдХрд╛, рдСрд╕реНрдЯреНрд░реЗрд▓рд┐рдпрд╛ рдФрд░ рдпреВрд░реЛрдк рдореЗрдВред рд╡рд░реНрддрдорд╛рди рдореЗрдВ рд░реВрд╕ рдФрд░ рд╕реАрдЖрдИрдПрд╕ рджреЗрд╢реЛрдВ рдореЗрдВ рддреЗрдЬреА рд╕реЗ рд▓реЛрдХрдкреНрд░рд┐рдпрддрд╛ рд╣рд╛рд╕рд┐рд▓ рдХрд░ рд░рд╣рд╛ рд╣реИред рдпрд╣ рдкреЗрд╢реЗрд╡рд░реЛрдВ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд╢реМрдХреАрдиреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╣реИред рд╕реБрдмрд╣ рдкреВрд▓ рдореЗрдВ рддреИрд░рдиреЗ, рд╕рд╛рдЗрдХрд┐рд▓ рдЪрд▓рд╛рдиреЗ рдФрд░ рдЬреЙрдЧрд┐рдВрдЧ рдХрд░рдиреЗ рдХреЗ рд╡рд┐рдкрд░реАрдд, рдПрдХ рдЯреНрд░рд╛рдпрдерд▓реЙрди рдореЗрдВ рдкреЗрд╢реЗрд╡рд░ рд╣реЛрдиреЗ рдХреЗ рдмрд┐рдирд╛ рднреА рдкреНрд░рддрд┐рдпреЛрдЧрд┐рддрд╛рдУрдВ рдФрд░ рдЙрдирдХреЗ рд▓рд┐рдП рд╡реНрдпрд╡рд╕реНрдерд┐рдд рддреИрдпрд╛рд░реА рдореЗрдВ рднрд╛рдЧ рд▓реЗрдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдЖрдкрдХреЗ рджреЛрд╕реНрддреЛрдВ рдХреЗ рдмреАрдЪ рдХрдо рд╕реЗ рдХрдо рдПрдХ "рд▓реМрд╣ рдкреБрд░реБрд╖" рдпрд╛ рдХреЛрдИ рд╣реИ рдЬреЛ рдПрдХ рдмрдирдиреЗ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛ рд░рд╣рд╛ рд╣реИред рджреНрд░рд╡реНрдпрдорд╛рди, рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреА рджреВрд░реА рдФрд░ рд╕реНрдерд┐рддрд┐рдпрд╛рдВ, рдПрдХ рдореЗрдВ рддреАрди рдЦреЗрд▓ - рдпрд╣ рд╕рдм рдмрдбрд╝реА рдорд╛рддреНрд░рд╛ рдореЗрдВ рдбреЗрдЯрд╛ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреА рдХреНрд╖рдорддрд╛ рд╣реИред рд╣рд░ рд╕рд╛рд▓, рджреБрдирд┐рдпрд╛ рдореЗрдВ рдХрдИ рд╕реМ рдЯреНрд░рд╛рдпрдерд▓реЙрди рдкреНрд░рддрд┐рдпреЛрдЧрд┐рддрд╛рдПрдВ рд╣реЛрддреА рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ рдХрдИ рд╕реМ рд▓реЛрдЧ рднрд╛рдЧ рд▓реЗрддреЗ рд╣реИрдВредрдХрдИ рдЖрдпреЛрдЬрдХреЛрдВ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рдпреЛрдЧрд┐рддрд╛рдПрдВ рдЖрдпреЛрдЬрд┐рдд рдХреА рдЬрд╛рддреА рд╣реИрдВред рдЙрдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ, рдЬрд╝рд╛рд╣рд┐рд░ рд╣реИ, рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рдЕрдкрдиреЗ рдЖрдк рдореЗрдВ рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рд▓реЗрдХрд┐рди рд░реВрд╕ рдФрд░ рдХреБрдЫ рд╕реАрдЖрдИрдПрд╕ рджреЗрд╢реЛрдВ рдХреЗ рдПрдерд▓реАрдЯреЛрдВ рдХреЗ рд▓рд┐рдП, рдЯреАрдо</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tristats.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрдХ рд╣реА рдирд╛рдо рдХреА рдЕрдкрдиреА рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ - рд╕рднреА рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рдПрдХ рдЬрдЧрд╣ рдЗрдХрдЯреНрдард╛ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдЖрдкрдХреЗ рдФрд░ рдЖрдкрдХреЗ рдорд┐рддреНрд░реЛрдВ рдФрд░ рдкреНрд░рддрд┐рджреНрд╡рдВрджреНрд╡рд┐рдпреЛрдВ, рдпрд╛ рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдЖрдкрдХреА рдореВрд░реНрддрд┐рдпреЛрдВ, рджреЛрдиреЛрдВ рдХреЗ рд▓рд┐рдП рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рдЦреЛрдЬрдирд╛ рдмрд╣реБрдд рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛рддрд╛ рд╣реИред рд▓реЗрдХрд┐рди рдореЗрд░реЗ рд▓рд┐рдП рдЗрд╕рдиреЗ рдкреНрд░реЛрдЧреНрд░рд╛рдореЗрдЯрд┐рдХ рд░реВрдк рд╕реЗ рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХрд╛ рдЕрд╡рд╕рд░ рджрд┐рдпрд╛ред рддреНрд░реИрд▓рд┐рдлрд╝ рдкрд░ рдкреНрд░рдХрд╛рд╢рд┐рдд рдкрд░рд┐рдгрд╛рдо: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрдврд╝реЗрдВ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдЗрд╕ рддрд░рд╣ рдХреА рдореЗрд░реА рдкрд╣рд▓реА рдкрд░рд┐рдпреЛрдЬрдирд╛ рдереА, рдХреНрдпреЛрдВрдХрд┐ рд╣рд╛рд▓ рд╣реА рдореЗрдВ рдореИрдВрдиреЗ рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ рдбреЗрдЯрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд┐рдпрд╛ рдерд╛, рд╕рд╛рде рд╣реА </font><i><font style="vertical-align: inherit;">рдЕрдЬрдЧрд░</font></i><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рдХрд┐рдпрд╛ рдерд╛</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдореИрдВ рдЖрдкрдХреЛ рдЗрд╕ рдХрд╛рдо рдХреЗ рддрдХрдиреАрдХреА рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрддрд╛рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдВ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдмрд╛рдж рд╕реЗ, рд╡рд┐рднрд┐рдиреНрди рдмрд╛рд░реАрдХрд┐рдпрд╛рдВ рд╕рд╛рдордиреЗ рдЖрдИрдВ, рдХрднреА-рдХрднреА рдПрдХ рд╡рд┐рд╢реЗрд╖ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рд╕реНрдХреНрд░реИрдкрд┐рдВрдЧ, рдкрд╛рд░реНрд╕рд┐рдВрдЧ, рдХрд╛рд╕реНрдЯрд┐рдВрдЧ рдкреНрд░рдХрд╛рд░ рдФрд░ рдкреНрд░рд╛рд░реВрдк рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╣реЛрдЧрд╛, рдЕрдкреВрд░реНрдг рдбреЗрдЯрд╛ рдХреЛ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛, рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдирдореВрдирд╛ рдмрдирд╛рдирд╛, рд╡рд┐рдЬрд╝реБрдЕрд▓рд╛рдЗрдЬрд╝реЗрд╢рди, рд╡реЗрдХреНрдЯрд░рд╛рдЗрдЬреЗрд╢рди рдФрд░ рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рд╕рдорд╛рдирд╛рдВрддрд░ рдХрдВрдкреНрдпреВрдЯрд┐рдВрдЧ рднреАред</font></font><br>
<a name="habracut"></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдорд╛рддреНрд░рд╛ рдмрдбрд╝реА рд╣реЛ рдЧрдИ рдереА, рдЗрд╕рд▓рд┐рдП рдореИрдВрдиреЗ рд╕рдм рдХреБрдЫ рдкрд╛рдВрдЪ рднрд╛рдЧреЛрдВ рдореЗрдВ рддреЛрдбрд╝ рджрд┐рдпрд╛, рддрд╛рдХрд┐ рдореИрдВ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдмрд╛рд╣рд░ рдХрд░ рд╕рдХреВрдВ рдФрд░ рдпрд╛рдж рд░рдЦреВрдВ рдХрд┐ рдмреНрд░реЗрдХ рдХреЗ рдмрд╛рдж рдХрд╣рд╛рдВ рд╕реЗ рд╢реБрд░реВ рдХрд░рдирд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдЧреЗ рдмрдврд╝рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдЕрдзреНрдпрдпрди рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЗ рд╕рд╛рде рдкрд╣рд▓реЗ рдореЗрд░реЗ рд▓реЗрдЦ рдХреЛ рдкрдврд╝рдирд╛ рдмреЗрд╣рддрд░ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣рд╛рдВ рдЕрдирд┐рд╡рд╛рд░реНрдп рд░реВрдк рд╕реЗ рдЗрд╕рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреЗ рд▓рд┐рдП рд░рд╕реЛрдИ рдХрд╛ рд╡рд░реНрдгрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рдореЗрдВ 10-15 рдорд┐рдирдЯ рд▓рдЧрддреЗ рд╣реИрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХреНрдпрд╛ рдЖрдкрдиреЗ рдкрдврд╝ рд▓рд┐рдпрд╛? </font><font style="vertical-align: inherit;">рддреЛ рдЪрд▓рддреЗ рд╣реИрдВ!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рднрд╛рдЧ 1. рд╕реНрдХреНрд░реИрдкрд┐рдВрдЧ рдФрд░ рдкрд╛рд░реНрд╕рд┐рдВрдЧ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рджреЗрдЦрддреЗ рд╣реБрдП: рд╡реЗрдмрд╕рд╛рдЗрдЯ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tristats.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред рдЗрд╕ рдкрд░ рджреЛ рдкреНрд░рдХрд╛рд░ рдХреЗ рдЯреЗрдмрд▓ рд╣реИрдВ рдЬреЛ рд╣рдореЗрдВ рд░реВрдЪрд┐ рджреЗрддреЗ рд╣реИрдВред рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╕рднреА рдирд╕реНрд▓реЛрдВ рдХреА рдПрдХ рд╕рд╛рд░рд╛рдВрд╢ рддрд╛рд▓рд┐рдХрд╛ рдФрд░ рдЙрдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХрд╛ рдПрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИред </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vp/m5/do/vpm5dopzyltw9iwcwdddcff2osw.png"><br>
<br>
<img src="https://habrastorage.org/webt/yf/ez/ve/yfezve61_ds1wsaiguh5tjpwd2m.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдирдВрдмрд░ рдПрдХ рдХрд╛рд░реНрдп рдЗрд╕ рдбреЗрдЯрд╛ рдХреЛ рдкреНрд░реЛрдЧреНрд░рд╛рдореЗрдЯрд┐рдХ рд░реВрдк рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдФрд░ рдЗрд╕реЗ рдЖрдЧреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП рд╕рд╣реЗрдЬрдирд╛ рдерд╛ред рдРрд╕рд╛ рд╣реБрдЖ рдХрд┐ рдЙрд╕ рд╕рдордп рдореИрдВ рд╡реЗрдм рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдирдпрд╛ рдерд╛ рдФрд░ рдЗрд╕рд▓рд┐рдП рддреБрд░рдВрдд рдирд╣реАрдВ рдкрддрд╛ рдерд╛ рдХрд┐ рдпрд╣ рдХреИрд╕реЗ рдХрд░рдирд╛ рд╣реИред рдореИрдВрдиреЗ рдЙрд╕реА рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╢реБрд░реБрдЖрдд рдХреА рдЬреЛ рдореБрдЭреЗ рдкрддрд╛ рдерд╛ - рдкреГрд╖реНрда рдХреЛрдб рдХреЛ рджреЗрдЦреЛред рдпрд╣ рд╕рд╣реА рдорд╛рдЙрд╕ рдмрдЯрди рдпрд╛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F12</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font></font><br>
<br>
<img src="https://habrastorage.org/webt/43/wc/ex/43wcexjx3j9qfvjla_dubcsjgl0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chrome рдореЗрдВ рдореЗрдиреВ рдореЗрдВ рджреЛ рд╡рд┐рдХрд▓реНрдк рд╣реЛрддреЗ рд╣реИрдВ: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреГрд╖реНрда рдХреЛрдб</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреГрд╢реНрдп рдХреЛрдб рджреЗрдЦреЗрдВ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред рд╕рдмрд╕реЗ рд╕реНрдкрд╖реНрдЯ рд╡рд┐рднрд╛рдЬрди рдирд╣реАрдВред рд╕реНрд╡рд╛рднрд╛рд╡рд┐рдХ рд░реВрдк рд╕реЗ, рд╡реЗ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдкрд░рд┐рдгрд╛рдо рджреЗрддреЗ рд╣реИрдВред рд╡рд╣ рдЬреЛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрдб рдХреЛ рджреЗрдЦрддрд╛ рд╣реИ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдпрд╣ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F12</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬреИрд╕рд╛ рд╣реА рд╣реИ </font><font style="vertical-align: inherit;">- рд╕реАрдзреЗ рд╢рд╛рдмреНрджрд┐рдХ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">html-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ </font><i><font style="vertical-align: inherit;">рдЙрд╕рдХрд╛</font></i><font style="vertical-align: inherit;"> рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рддрддреНрд╡-рд╡рд╛рд░ рд╣реИред </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vv/ow/wb/vvowwbmi5fdawtjbocfjo5zztm4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдмрджрд▓реЗ рдореЗрдВ, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреЗрдЬ рдХреЛрдб рджреЗрдЦрдиреЗ рд╕реЗ рдкреЗрдЬ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рд╕реЛрд░реНрд╕ рдХреЛрдб рдорд┐рд▓рддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">html</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рд▓реЗрдХрд┐рди рд╡рд╣рд╛рдВ рдХреЛрдИ рдбреЗрдЯрд╛ рдирд╣реАрдВ рд╣реИ, рдХреЗрд╡рд▓ рдЬреЗрдПрд╕ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдирд╛рдо рдЬреЛ рдЙрдиреНрд╣реЗрдВ рдЕрдирд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВред рдареАрдХ рд╣реИред </font></font><br>
<br>
<img src="https://habrastorage.org/webt/o4/k7/d5/o4k7d5k8zuu66hp43vegbix9hoc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╣рдореЗрдВ рдпрд╣ рд╕рдордЭрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдПрдХ рдЕрд▓рдЧ рдкрд╛рда рдлрд╝рд╛рдЗрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдкреГрд╖реНрда рдХреЗ рдХреЛрдб рдХреЛ рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдЬрдЧрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВред рдореИрдВ рдпрд╣ рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реВрдВ:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> requests<font></font>
<font></font>
r = requests.get(url=<span class="hljs-string">'http://tristats.ru/'</span>)<font></font>
print(r.content)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ рдореБрдЭреЗ рдорд┐рд▓рддрд╛ рд╣реИ ... рд╕реНрд░реЛрдд рдХреЛрдбред рд▓реЗрдХрд┐рди рдореБрдЭреЗ рдЗрд╕рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдкрд░рд┐рдгрд╛рдо рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдЕрдзреНрдпрдпрди рдХрд░рдиреЗ, рдЦреЛрдЬ рдХрд░рдиреЗ рдФрд░ рдЖрд╕рдкрд╛рд╕ рдкреВрдЫрдиреЗ рдХреЗ рдмрд╛рдж, рдореБрдЭреЗ рдорд╣рд╕реВрд╕ рд╣реБрдЖ рдХрд┐ рдореБрдЭреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдкрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдереА, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реЗрд▓реЗрдирд┐рдпрдо</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред рдореИрдВ рдЗрд╕реЗ рд░рдЦрддрд╛ рд╣реВрдВред рдФрд░ </font><i><font style="vertical-align: inherit;">Google Chrome рдХреЗ</font></i><font style="vertical-align: inherit;"> рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ChromeDriver</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рднреА </font><font style="vertical-align: inherit;">ред рддрдм рдореИрдВрдиреЗ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрд┐рдпрд╛:</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver
<span class="hljs-keyword">from</span> selenium.webdriver.chrome.service <span class="hljs-keyword">import</span> Service<font></font>
<font></font>
service = Service(<span class="hljs-string">r'C:\ChromeDriver\chromedriver.exe'</span>)<font></font>
service.start()<font></font>
driver = webdriver.Remote(service.service_url)<font></font>
driver.get(<span class="hljs-string">'http://www.tristats.ru/'</span>)<font></font>
print(driver.page_source)<font></font>
driver.quit()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдХреЛрдб рдПрдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╡рд┐рдВрдбреЛ рд▓реЙрдиреНрдЪ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ url рдкрд░ рдПрдХ рдкреЗрдЬ рдЦреЛрд▓рддрд╛ рд╣реИред рдирддреАрдЬрддрди, рд╣рдореЗрдВ </font><font style="vertical-align: inherit;">рд╡рд╛рдВрдЫрд┐рдд рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдкрд╣рд▓реЗ рд╕реЗ рд╣реА </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTML</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЛрдб </font><font style="vertical-align: inherit;">рдорд┐рд▓рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред рд▓реЗрдХрд┐рди рдПрдХ рд░реЛрдбрд╝рд╛ рд╣реИред рдкрд░рд┐рдгрд╛рдо рдХреЗрд╡рд▓ 100 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдВ рд╣реИрдВ, рдФрд░ рдХреБрд▓ рджреМрдбрд╝ рдХреА рд╕рдВрдЦреНрдпрд╛ рд▓рдЧрднрдЧ 2000 рд╣реИред рдРрд╕рд╛ рдХреИрд╕реЗ? рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐ рд╢реБрд░реВ рдореЗрдВ рдХреЗрд╡рд▓ рдкрд╣рд▓реЗ 100 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХреА рдЬрд╛рддреА рд╣реИрдВ, рдФрд░ рдХреЗрд╡рд▓ рдпрджрд┐ рдЖрдк рдкреГрд╖реНрда рдХреЗ рдмрд╣реБрдд рдиреАрдЪреЗ рддрдХ рд╕реНрдХреНрд░реЙрд▓ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЕрдЧрд▓реЗ 100 рд▓реЛрдб рд╣реЛрддреЗ рд╣реИрдВ, рдФрд░ рдЗрд╕реА рддрд░рд╣ред рдЗрд╕рд▓рд┐рдП, рд╕реНрдХреНрд░реЙрд▓рд┐рдВрдЧ рдХреЛ рдкреНрд░реЛрдЧреНрд░рд╛рдореЗрдЯрд┐рдХ рд░реВрдк рд╕реЗ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:</font></font><br>
<br>
<pre><code class="python hljs">driver.execute_script(<span class="hljs-string">"window.scrollTo(0, document.body.scrollHeight);"</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рд╕реНрдХреНрд░реЙрд▓рд┐рдВрдЧ рдХреЗ рд╕рд╛рде, рд╣рдо рдЬрд╛рдВрдЪ рдХрд░реЗрдВрдЧреЗ рдХрд┐ рд▓реЛрдб рдХрд┐рдП рдЧрдП рдкреГрд╖реНрда рдХрд╛ рдХреЛрдб рдмрджрд▓ рдЧрдпрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдпрд╣ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдирд╣реАрдВ рд╣реБрдЖ рд╣реИ, рддреЛ рд╣рдо рд╡рд┐рд╢реНрд╡рд╕рдиреАрдпрддрд╛ рдХреЗ рд▓рд┐рдП рдХрдИ рдмрд╛рд░ рдЬрд╛рдВрдЪ рдХрд░реЗрдВрдЧреЗ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП 10, рдлрд┐рд░ рдкреВрд░рд╛ рдкреГрд╖реНрда рд▓реЛрдб рд╣реЛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдЖрдк рд░реЛрдХ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╕реНрдХреНрд░реЙрд▓ рдХреЗ рдмреАрдЪ рд╣рдо рдЯрд╛рдЗрдордЖрдЙрдЯ рдХреЛ рдПрдХ рд╕реЗрдХрдВрдб рдореЗрдВ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдкреЗрдЬ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рд╕рдордп рд╣реЛред </font><font style="vertical-align: inherit;">(рднрд▓реЗ рд╣реА рдЙрд╕рдХреЗ рдкрд╛рд╕ рд╕рдордп рдирд╣реАрдВ рд╣реИ, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рдЖрд░рдХреНрд╖рд┐рдд рд╣реИ - рдПрдХ рдФрд░ рдиреМ рд╕реЗрдХрдВрдб)ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ рдкреВрд░реНрдг рдХреЛрдб рдЗрд╕ рддрд░рд╣ рджрд┐рдЦреЗрдЧрд╛:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver
<span class="hljs-keyword">from</span> selenium.webdriver.chrome.service <span class="hljs-keyword">import</span> Service
<span class="hljs-keyword">import</span> time<font></font>
<font></font>
service = Service(<span class="hljs-string">r'C:\ChromeDriver\chromedriver.exe'</span>)<font></font>
service.start()<font></font>
driver = webdriver.Remote(service.service_url)<font></font>
driver.get(<span class="hljs-string">'http://www.tristats.ru/'</span>)<font></font>
prev_html = <span class="hljs-string">''</span>
scroll_attempt = <span class="hljs-number">0</span><font></font>
<font></font>
<span class="hljs-keyword">while</span> scroll_attempt &lt; <span class="hljs-number">10</span>:<font></font>
    driver.execute_script(<span class="hljs-string">"window.scrollTo(0, document.body.scrollHeight);"</span>)<font></font>
    time.sleep(<span class="hljs-number">1</span>)<font></font>
<font></font>
    <span class="hljs-keyword">if</span> prev_html == driver.page_source:<font></font>
        scroll_attempt += <span class="hljs-number">1</span>
    <span class="hljs-keyword">else</span>:<font></font>
        prev_html = driver.page_source<font></font>
        scroll_attempt = <span class="hljs-number">0</span> <font></font>
<font></font>
<span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\summary.txt'</span>, <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> f:<font></font>
    f.write(prev_html)<font></font>
<font></font>
driver.quit()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕рд▓рд┐рдП, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ </font><font style="vertical-align: inherit;">рд╕рднреА рджреМрдбрд╝ рдХреА рд╕рд╛рд░рд╛рдВрд╢ рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рд╕рд╛рде рдПрдХ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">html</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдлрд╝рд╛рдЗрд▓ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕реЗ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lxml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ </font><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> lxml <span class="hljs-keyword">import</span> html
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкрд╣рд▓реЗ рд╣рдо рддрд╛рд▓рд┐рдХрд╛ рдХреА рд╕рднреА рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рдкрд╛рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд╕рдВрдХреЗрдд рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдмрд╕ </font><font style="vertical-align: inherit;">рдПрдХ рдЯреЗрдХреНрд╕реНрдЯ рдПрдбрд┐рдЯрд░ рдореЗрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">html</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдлрд╝рд╛рдЗрд▓ рджреЗрдЦреЗрдВред </font></font><br>
<br>
<img src="https://habrastorage.org/webt/b2/j6/_8/b2j6_8isg6smzxbgkojrppfwif4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"tr ng-repeat = 'r inDData' рдХреНрд▓рд╛рд╕ = 'рдПрдирдЬреА-рд╕реНрдХреЛрдк'</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╛ </font><i><font style="vertical-align: inherit;">"</font></i><font style="vertical-align: inherit;"> рдХреБрдЫ рдЕрдВрд╢ рдЬреЛ рдЕрдм рдХрд┐рд╕реА рднреА рдЯреИрдЧ рдореЗрдВ рдирд╣реАрдВ рдорд┐рд▓ рд╕рдХрддреЗ рд╣реИрдВред</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\summary.txt'</span>, <span class="hljs-string">'r'</span>) <span class="hljs-keyword">as</span> f:<font></font>
    sum_html = f.read()<font></font>
<font></font>
tree = html.fromstring(sum_html)<font></font>
rows = tree.findall(<span class="hljs-string">".//*[@ng-repeat='r in racesData']"</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдлрд┐рд░ рд╣рдо </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╛рдВрдбрд╛ рдбреЗрдЯрд╛рдлрд╝реНрд░реЗрдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╢реБрд░реВ </font><font style="vertical-align: inherit;">рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рддрд╛рд▓рд┐рдХрд╛ рдХреА рдкреНрд░рддреНрдпреЗрдХ рдкрдВрдХреНрддрд┐ рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рддрддреНрд╡ рдХреЛ рдЗрд╕ рдбреЗрдЯрд╛рдлрд╝реНрд░реЗрдо рдХреЛ рд▓рд┐рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<font></font>
<font></font>
rs = pd.DataFrame(columns=[<span class="hljs-string">'date'</span>,<span class="hljs-string">'name'</span>,<span class="hljs-string">'link'</span>,<span class="hljs-string">'males'</span>,<span class="hljs-string">'females'</span>,<span class="hljs-string">'rus'</span>,<span class="hljs-string">'total'</span>], index=range(len(rows))) <span class="hljs-comment">#rs тАУ races summary</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рддрддреНрд╡ рдХрд╣рд╛рдВ рдЫрд┐рдкрд╛ рд╣реБрдЖ рд╣реИ, рдЖрдкрдХреЛ рдмрд╕ </font><font style="vertical-align: inherit;">рдПрдХ </font><font style="vertical-align: inherit;">рд╣реА рдЯреЗрдХреНрд╕реНрдЯ рдПрдбрд┐рдЯрд░ рдореЗрдВ </font><font style="vertical-align: inherit;">рд╣рдорд╛рд░реА </font><i><font style="vertical-align: inherit;">рдкрдВрдХреНрддрд┐рдпреЛрдВ</font></i><font style="vertical-align: inherit;"> рдХреЗ рддрддреНрд╡реЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдХрд╛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">html</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЛрдб </font><font style="vertical-align: inherit;">рджреЗрдЦрдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИ </font><font style="vertical-align: inherit;">ред</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">ng-repeat</span>=<span class="hljs-string">"r in racesData"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ng-scope"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ng-binding"</span>&gt;</span>2015-04-26<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/Images/flags/24/USA.png"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flag"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/rus/result/ironman/texas/half/2015"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"_self"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ng-binding"</span>&gt;</span>Ironman Texas 70.3 2015<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/rus/result/ironman/texas/half/2015?sex=F"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"_self"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ng-binding"</span>&gt;</span>605<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-venus fa-lg"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"color:Pink"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><font></font>
      /<font></font>
      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/rus/result/ironman/texas/half/2015?sex=M"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"_self"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ng-binding"</span>&gt;</span>1539<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-mars fa-lg"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"color:LightBlue"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ng-binding"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/Images/flags/24/rus.png"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flag"</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- ngIf: r.CountryCount == 0 --&gt;</span>
      <span class="hljs-comment">&lt;!-- ngIf: r.CountryCount &gt; 0 --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">ng-if</span>=<span class="hljs-string">"r.CountryCount &gt; 0"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/rus/result/ironman/texas/half/2015?country=rus"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"_self"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ng-binding ng-scope"</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- end ngIf: r.CountryCount &gt; 0 --&gt;</span><font></font>
      / 2144<font></font>
  <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣рд╛рдВ рдмрдЪреНрдЪреЛрдВ рдХреЗ рд▓рд┐рдП рд╣рд╛рд░реНрдбрдХреЛрдб рдиреЗрд╡рд┐рдЧреЗрд╢рди рдХрд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЙрдирдореЗрдВ рд╕реЗ рдХрдИ рдирд╣реАрдВ рд╣реИрдВред </font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(rows)):<font></font>
    rs.loc[i,<span class="hljs-string">'date'</span>] = rows[i].getchildren()[<span class="hljs-number">0</span>].text.strip()<font></font>
    rs.loc[i,<span class="hljs-string">'name'</span>] = rows[i].getchildren()[<span class="hljs-number">1</span>].getchildren()[<span class="hljs-number">1</span>].text.strip()<font></font>
    rs.loc[i,<span class="hljs-string">'link'</span>] = rows[i].getchildren()[<span class="hljs-number">1</span>].getchildren()[<span class="hljs-number">1</span>].attrib[<span class="hljs-string">'href'</span>].strip()<font></font>
    rs.loc[i,<span class="hljs-string">'males'</span>] = rows[i].getchildren()[<span class="hljs-number">2</span>].getchildren()[<span class="hljs-number">2</span>].text.strip()<font></font>
    rs.loc[i,<span class="hljs-string">'females'</span>] = rows[i].getchildren()[<span class="hljs-number">2</span>].getchildren()[<span class="hljs-number">0</span>].text.strip()<font></font>
    rs.loc[i,<span class="hljs-string">'rus'</span>] = rows[i].getchildren()[<span class="hljs-number">3</span>].getchildren()[<span class="hljs-number">3</span>].text.strip()<font></font>
    rs.loc[i,<span class="hljs-string">'total'</span>] = rows[i].getchildren()[<span class="hljs-number">3</span>].text_content().split(<span class="hljs-string">'/'</span>)[<span class="hljs-number">1</span>].strip()
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣рд╛рдБ рдкрд░рд┐рдгрд╛рдо рд╣реИ: </font><font style="vertical-align: inherit;">
рдЗрд╕ рдбреЗрдЯрд╛ рдлрд╝реНрд░реЗрдо рдХреЛ рдХрд┐рд╕реА рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕рд╣реЗрдЬреЗрдВред </font><font style="vertical-align: inherit;">рдореИрдВ </font><i><font style="vertical-align: inherit;">рдЕрдЪрд╛рд░ рдХрд╛</font></i><font style="vertical-align: inherit;"> рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реВрдВ </font><font style="vertical-align: inherit;">, рд▓реЗрдХрд┐рди рдпрд╣ </font><i><font style="vertical-align: inherit;">csv</font></i><font style="vertical-align: inherit;"> , рдпрд╛ рдХреБрдЫ рдФрд░ </font><font style="vertical-align: inherit;">рд╣реЛ рд╕рдХрддрд╛ </font><font style="vertical-align: inherit;">рд╣реИред</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>date</th>
<th>event</th>
<th>link</th>
<th>males</th>
<th>females</th>
<th>rus</th>
<th>total</th>
</tr>
<tr>
<td>0</td>
<td>2020-07-02</td>
<td>Ironman Dubai Duathlon 70.3 2020</td>
<td>/rus/result/ironman/dubai-duathlon/half/2020</td>
<td>835</td>
<td>215</td>
<td>65</td>
<td>1050</td>
</tr>
<tr>
<td>1</td>
<td>2020-02-07</td>
<td>Ironman Dubai 70.3 2020</td>
<td>/rus/result/ironman/dubai/half/2020</td>
<td>638</td>
<td>132</td>
<td>55</td>
<td>770</td>
</tr>
<tr>
<td>2</td>
<td>2020-01-29</td>
<td>Israman Half 2020</td>
<td>/rus/result/israman/israman/half/2020</td>
<td>670</td>
<td>126</td>
<td>4</td>
<td>796</td>
</tr>
<tr>
<td>3</td>
<td>2019-12-08</td>
<td>Ironman Indian Wells La Quinta 70.3 2019</td>
<td>/rus/result/ironman/indian-wells-la-quinta/hal...</td>
<td>1590</td>
<td>593</td>
<td>6</td>
<td>2183</td>
</tr>
<tr>
<td>4</td>
<td>2019-12-07</td>
<td>Ironman Taupo 70.3 2019</td>
<td>/rus/result/ironman/taupo/half/2019</td>
<td>767</td>
<td>420</td>
<td>3</td>
<td>1187</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td>1917</td>
<td>1994-07-02</td>
<td>ITU European Championship Eichstatt Olympic 1994</td>
<td>/rus/result/itu/european-championship-eichstat...</td>
<td>61</td>
<td>0</td>
<td>2</td>
<td>61</td>
</tr>
<tr>
<td>1918</td>
<td>1993-09-04</td>
<td>Challenge Almere-Amsterdam Long 1993</td>
<td>/rus/result/challenge/almere-amsterdam/full/1993</td>
<td>795</td>
<td>32</td>
<td>1</td>
<td>827</td>
</tr>
<tr>
<td>1919</td>
<td>1993-07-04</td>
<td>ITU European Cup Echternach Olympic 1993</td>
<td>/rus/result/itu/european-cup-echternach/olympi...</td>
<td>60</td>
<td>0</td>
<td>2</td>
<td>60</td>
</tr>
<tr>
<td>1920</td>
<td>1992-09-12</td>
<td>ITU World Championship Huntsville Olympic 1992</td>
<td>/rus/result/itu/world-championship-huntsville/...</td>
<td>317</td>
<td>0</td>
<td>3</td>
<td>317</td>
</tr>
<tr>
<td>1921</td>
<td>1990-09-15</td>
<td>ITU World Championship Orlando Olympic 1990</td>
<td>/rus/result/itu/world-championship-orlando/oly...</td>
<td>286</td>
<td>0</td>
<td>5</td>
<td>28</td>
</tr>
</tbody></table></div></code><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> pickle <span class="hljs-keyword">as</span> pkl<font></font>
<font></font>
<span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\summary.pkl'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:<font></font>
    pkl.dump(df,f)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рд╕реНрддрд░ рдкрд░, рд╕рднреА рдбреЗрдЯрд╛ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдмрд╛рдж рдореЗрдВ рдмрджрд▓ рджреЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдЕрдм рд╣рдореЗрдВ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЪреАрдЬ рд▓рд┐рдВрдХ рдХреА рдЬрд░реВрд░рдд рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рд╕рднреА рджреМрдбрд╝ рдХреЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рд╕реНрдХреНрд░реИрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕реЗ рдЫрд╡рд┐ рдФрд░ рд╕рдорд╛рдирддрд╛ рдореЗрдВ рдмрдирд╛рддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рдкрд┐рд╡рдЯ рдЯреЗрдмрд▓ рдХреЗ рд▓рд┐рдП рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред </font><font style="vertical-align: inherit;">рдкреНрд░рддреНрдпреЗрдХ рдХреЗ рд▓рд┐рдП рд╕рднреА рджреМрдбрд╝ рдХреЗ рд▓рд┐рдП рдЪрдХреНрд░ рдореЗрдВ, рд╣рдо рдкреГрд╖реНрда рдХреЛ рд╕рдВрджрд░реНрдн рджреНрд╡рд╛рд░рд╛ рдЦреЛрд▓реЗрдВрдЧреЗ, рд╕реНрдХреНрд░реЙрд▓ рдХрд░реЗрдВрдЧреЗ рдФрд░ рдкреГрд╖реНрда рдХреЛрдб рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рд╕рд╛рд░рд╛рдВрд╢ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рд╣рдо рджреМрдбрд╝ рдореЗрдВ рднрд╛рдЧ рд▓реЗрдиреЗ рд╡рд╛рд▓реЛрдВ рдХреА рдХреБрд▓ рд╕рдВрдЦреНрдпрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╣реИ - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреБрд▓</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рд╣рдо рдпрд╣ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ рдХрд┐ рдЖрдкрдХреЛ рдХрд┐рд╕ рдмрд┐рдВрджреБ рддрдХ рд╕реНрдХреНрд░реЙрд▓ рдХрд░рдирд╛ рдЬрд╛рд░реА рд░рдЦрдирд╛ рд╣реИред рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рд╕реАрдзреЗ рдкреНрд░рддреНрдпреЗрдХ рдкреГрд╖реНрда рдХреЛ рд╕реНрдХреНрд░реИрдк рдХрд░рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рд░рд┐рдХреЙрд░реНрдб рдХреА рд╕рдВрдЦреНрдпрд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВрдЧреЗ рдФрд░ рдХреБрд▓ рдореВрд▓реНрдп рдХреЗ рдЕрдкреЗрдХреНрд╖рд┐рдд рдореВрд▓реНрдп рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░реЗрдВрдЧреЗред рдЬреИрд╕реЗ рд╣реА рдпрд╣ рдмрд░рд╛рдмрд░ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╣рдо рдЕрдВрдд рддрдХ рд╕реНрдХреНрд░реЙрд▓ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЖрдк рдЕрдЧрд▓реА рджреМрдбрд╝ рдХреЗ рд▓рд┐рдП рдЖрдЧреЗ рдмрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред рд╣рдордиреЗ 60 рд╕реЗрдХрдВрдб рдХрд╛ рд╕рдордп рднреА рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рд╣реИред рдЗрд╕ рд╕рдордп рдХреЗ рджреМрд░рд╛рди, рд╣рдореЗрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреБрд▓</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдирд╣реАрдВ рдорд┐рд▓рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">, рдЕрдЧрд▓реА рджреМрдбрд╝ рдкрд░ рдЬрд╛рдПрдВред рдкреЗрдЬ рдХреЛрдб рдПрдХ рдлрд╛рдЗрд▓ рдореЗрдВ рд╕реЗрд╡ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред рд╣рдо рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рд╕рднреА рдирд╕реНрд▓реЛрдВ рдХреА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╕рд╣реЗрдЬреЗрдВрдЧреЗ, рдФрд░ рдЙрдиреНрд╣реЗрдВ </font><font style="vertical-align: inherit;">рд╕рд╛рд░рд╛рдВрд╢ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдИрд╡реЗрдВрдЯ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЙрд▓рдо </font><font style="vertical-align: inherit;">рдореЗрдВ </font><font style="vertical-align: inherit;">рдорд╛рди рдХреЗ рдЕрдиреБрд╕рд╛рд░ рджреМрдбрд╝ рдХреЗ рдирд╛рдо рд╕реЗ рдирд╛рдо рджреЗрдВ </font><font style="vertical-align: inherit;">ред рдирд╛рдореЛрдВ рдХреЗ рдЯрдХрд░рд╛рд╡ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП, рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХрд┐ рд╕рднреА рджреМрдбрд╝ рдореЗрдВ рдзреБрд░реА рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдирд╛рдо рд╣реЛрдВред рдЗрд╕реЗ рджреЗрдЦреЛ:</font></font><br>
<br>
<pre><code class="python hljs">df[df.duplicated(subset = <span class="hljs-string">'event'</span>, keep=<span class="hljs-literal">False</span>)]
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>date</th>
<th>event</th>
<th>link</th>
<th>males</th>
<th>females</th>
<th>rus</th>
<th>total</th>
</tr>
<tr>
<td>450</td>
<td>2018-07-15</td>
<td>A1  Sprint 2018</td>
<td>/rus/result/a1/cc/sprint/2018-07-15</td>
<td>43</td>
<td>15</td>
<td>47</td>
<td>58</td>
</tr>
<tr>
<td>483</td>
<td>2018-06-23</td>
<td>A1  Sprint 2018</td>
<td>/rus/result/a1/cc/sprint/2018-06-23</td>
<td>61</td>
<td>15</td>
<td>76</td>
<td>76</td>
</tr>
<tr>
<td>670</td>
<td>2017-07-30</td>
<td>3Grom  Olympic 2017</td>
<td>/rus/result/3grom//olympic/2017-07-30</td>
<td>249</td>
<td>44</td>
<td>293</td>
<td>293</td>
</tr>
<tr>
<td>752</td>
<td>2017-06-11</td>
<td>3Grom  Olympic 2017</td>
<td>/rus/result/3grom//olympic/2017-06-11</td>
<td>251</td>
<td>28</td>
<td>279</td>
<td>279</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЦреИрд░, рд╕рд╛рд░рд╛рдВрд╢ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдпрд╛рдБ, рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рддрд┐рдерд┐рдпрд╛рдВ, рдФрд░ рдкреНрд░рддрд┐рднрд╛рдЧрд┐рдпреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреБрд░реБрд╖реЛрдВ, рдорд╣рд┐рд▓рд╛рдУрдВ, рд░рд╕, рдХреБрд▓</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), рдФрд░ рд▓рд┐рдВрдХ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЖрдкрдХреЛ рдЗрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЙрдирдореЗрдВ рд╕реЗ рдХреБрдЫ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЖрдк рдЗрд╕реЗ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЕрдм рд╕рднреА рдирд╛рдо рдЕрджреНрд╡рд┐рддреАрдп рд╣реИрдВ, рд╣рдо рдПрдХ рдмрдбрд╝рд╛ рдЦрдирди рдЪрдХреНрд░ рд▓реЙрдиреНрдЪ рдХрд░рддреЗ рд╣реИрдВ:</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/a8/v7/n8/a8v7n8qoxbzobftxcm0knnvks6m.png"><br>
<br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>date</th>
<th>event</th>
<th>link</th>
<th>males</th>
<th>females</th>
<th>rus</th>
<th>total</th>
</tr>
<tr>
<td>450</td>
<td>2018-07-15</td>
<td>A1  Sprint <u>7</u> 2018</td>
<td>/rus/result/a1/cc/sprint/2018-07-15</td>
<td>43</td>
<td>15</td>
<td>47</td>
<td>58</td>
</tr>
<tr>
<td>483</td>
<td>2018-06-23</td>
<td>A1  Sprint <u>6</u> 2018</td>
<td>/rus/result/a1/cc/sprint/2018-06-23</td>
<td>61</td>
<td>15</td>
<td>76</td>
<td>76</td>
</tr>
<tr>
<td>670</td>
<td>2017-07-30</td>
<td>3Grom  Olympic <u>7</u> 2017</td>
<td>/rus/result/3grom//olympic/2017-07-30</td>
<td>249</td>
<td>44</td>
<td>293</td>
<td>293</td>
</tr>
<tr>
<td>752</td>
<td>2017-06-11</td>
<td>3Grom  Olympic <u>6</u> 2017</td>
<td>/rus/result/3grom//olympic/2017-06-11</td>
<td>251</td>
<td>28</td>
<td>279</td>
<td>27</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">service.start()<font></font>
driver = webdriver.Remote(service.service_url)<font></font>
timeout = <span class="hljs-number">60</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> index, row <span class="hljs-keyword">in</span> df.iterrows():
    <span class="hljs-keyword">try</span>:<font></font>
        driver.get(<span class="hljs-string">'http://www.tristats.ru'</span> + row[<span class="hljs-string">'link'</span>])     <font></font>
        start = time.time()<font></font>
<font></font>
        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<font></font>
            driver.execute_script(<span class="hljs-string">"window.scrollTo(0, document.body.scrollHeight);"</span>)<font></font>
            time.sleep(<span class="hljs-number">1</span>)<font></font>
            race_html = driver.page_source<font></font>
            tree = html.fromstring(race_html)<font></font>
            race_rows = tree.findall(<span class="hljs-string">".//*[@ng-repeat='r in resultsData']"</span>)<font></font>
<font></font>
            <span class="hljs-keyword">if</span> len(race_rows) == int(row[<span class="hljs-string">'total'</span>]):
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">if</span> time.time() - start &gt; timeout:<font></font>
                print(<span class="hljs-string">'timeout'</span>)
                <span class="hljs-keyword">break</span><font></font>
<font></font>
        <span class="hljs-keyword">with</span> open(os.path.join(<span class="hljs-string">r'D:\tri\races'</span>, row[<span class="hljs-string">'event'</span>] +  <span class="hljs-string">'.txt'</span>), <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> f:<font></font>
            f.write(race_html)<font></font>
<font></font>
    <span class="hljs-keyword">except</span>:<font></font>
        traceback.print_exc()<font></font>
<font></font>
    time.sleep(<span class="hljs-number">1</span>)<font></font>
    <font></font>
driver.quit()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдПрдХ рд▓рдВрдмреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдЬрдм рд╕рдм рдХреБрдЫ рд╕реЗрдЯ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдпрд╣ рднрд╛рд░реА рддрдВрддреНрд░ рдШреВрдордирд╛ рд╢реБрд░реВ рдХрд░ рджреЗрддрд╛ рд╣реИ, рддреЛ рдПрдХ рдХреЗ рдмрд╛рдж рдПрдХ рдбреЗрдЯрд╛ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рд╕реЗ рд╕реБрдЦрдж рдЙрддреНрд╕рд╛рд╣ рдХреА рднрд╛рд╡рдирд╛ рдЖрддреА рд╣реИред </font><font style="vertical-align: inherit;">рдХреЗрд╡рд▓ рддреАрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкреНрд░рддрд┐ рдорд┐рдирдЯ рд▓реЛрдб рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдмрд╣реБрдд рдзреАрд░реЗ-рдзреАрд░реЗред </font><font style="vertical-align: inherit;">рд░рд╛рдд рдХреЗ рд▓рд┐рдП рд╕реНрдкрд┐рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЫреЛрдбрд╝ рджрд┐рдпрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕рдореЗрдВ рд▓рдЧрднрдЧ 10 рдШрдВрдЯреЗ рд▓рдЧреЗред </font><font style="vertical-align: inherit;">рд╕реБрдмрд╣ рддрдХ, рдЕрдзрд┐рдХрд╛рдВрд╢ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдЕрдкрд▓реЛрдб рдХрд┐рдП рдЧрдП рдереЗред </font><font style="vertical-align: inherit;">рдЬреИрд╕рд╛ рдХрд┐ рдЖрдорддреМрд░ рдкрд░ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддреЗ рд╕рдордп рд╣реЛрддрд╛ рд╣реИ, рдХреБрдЫ рд╡рд┐рдлрд▓ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдПрдХ рджреВрд╕рд░реЗ рдкреНрд░рдпрд╛рд╕ рдХреЗ рд╕рд╛рде рдЙрдиреНрд╣реЗрдВ рдлрд┐рд░ рд╕реЗ рд╢реБрд░реВ рдХрд┐рдпрд╛ред</font></font><br>
<br>
<img src="https://habrastorage.org/webt/un/wi/el/unwielrqjzt6u6otf8sbwwjbq8q.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рддреЛ, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ 1,922 рдлрд╛рдЗрд▓реЗрдВ рд╣реИрдВ рдЬрд┐рдирдХреА рдХреБрд▓ рдХреНрд╖рдорддрд╛ рд▓рдЧрднрдЧ 3 рдЬреАрдмреА рд╣реИред рдардВрдбрд╛! рд▓реЗрдХрд┐рди рд▓рдЧрднрдЧ 300 рджреМрдбрд╝ рдХреЛ рд╕рдВрднрд╛рд▓рдирд╛ рдПрдХ рд╕рдордп рд╕рдорд╛рдкреНрдд рд╣реЛ рдЧрдпрд╛ред рдмрд╛рдд рдХреНрдпрд╛ рд╣реИ? рдЪреБрдирд┐рдВрджрд╛ рддрд░реАрдХреЗ рд╕реЗ, рдпрд╣ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдзреБрд░реА рддрд╛рд▓рд┐рдХрд╛ рд╕реЗ рдХреБрд▓ рдореВрд▓реНрдп рдФрд░ рджреМрдбрд╝ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдореЗрдВ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдЬреЛ рд╣рдордиреЗ рдЬрд╛рдБрдЪ рдХреА рд╣реИ, рд╡рд╣ рд╕рдВрдпреЛрдЧ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА рд╣реИред рдпрд╣ рджреБрдЦрдж рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдЗрд╕ рд╡рд┐рд╕рдВрдЧрддрд┐ рдХрд╛ рдХрд╛рд░рдг рдХреНрдпрд╛ рд╣реИред рдпрд╛ рддреЛ рдпрд╣ рдЗрд╕ рддрдереНрдп рдХреЗ рдХрд╛рд░рдг рд╣реИ рдХрд┐ рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рд╣рд░ рдХреЛрдИ рдЦрддреНрдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛, рдпрд╛ рдХрд┐рд╕реА рдкреНрд░рдХрд╛рд░ рдХреА рдмрдЧ рдирд╣реАрдВ рд╣реЛрдЧреАред рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рдбреЗрдЯрд╛ рдЕрдкреВрд░реНрдгрддрд╛ рдХрд╛ рдкрд╣рд▓рд╛ рд╕рдВрдХреЗрддред рдХрд┐рд╕реА рднреА рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдо рдЙрди рд▓реЛрдЧреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рдирдореЗрдВ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ 100 рдпрд╛ 0 рд╣реИ, рдпреЗ рд╕рдмрд╕реЗ рд╕рдВрджрд┐рдЧреНрдз рдЙрдореНрдореАрджрд╡рд╛рд░ рд╣реИрдВред рдЙрдирдореЗрдВ рд╕реЗ рдЖрда рдереЗред рдЙрдиреНрд╣реЗрдВ рдлрд┐рд░ рд╕реЗ рдирдЬрд╝рджреАрдХреА рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВред рд╡реИрд╕реЗ, рдЙрдирдореЗрдВ рд╕реЗ рджреЛ рдореЗрдВ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ 100 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдВ рд╣реИрдВред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЦреИрд░, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╕рд╛рд░рд╛ рдбреЗрдЯрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдкрд╛рд░реНрд╕рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЧреБрдЬрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рджреЛрдмрд╛рд░рд╛, рдПрдХ рдЪрдХреНрд░ рдореЗрдВ рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рджреМрдбрд╝ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЪрд▓реЗрдВрдЧреЗ, рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкрдврд╝реЗрдВрдЧреЗ рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрдВрдбреЛрдВ рдХреЗ рдбреЗрдЯрд╛рдлрд╝реНрд░реЗрдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рд╕рд╛рдордЧреНрд░реА рдХреЛ </font><i><font style="vertical-align: inherit;">рд╕рд╣реЗрдЬреЗрдВрдЧреЗ</font></i><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рд╣рдо рдЗрди рдбреЗрдЯрд╛ рдлрд╝реНрд░реЗрдореЛрдВ рдХреЛ рдПрдХ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддрд╛рдирд╛рд╢рд╛рд╣</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рдЬреЛрдбрд╝ рджреЗрдВрдЧреЗ </font><font style="vertical-align: inherit;">, рдЬрд┐рд╕рдореЗрдВ рджреМрдбрд╝ рдХреЗ рдирд╛рдо рдХреА рдХреБрдВрдЬреА рд╣реЛрдЧреА - рдпрд╛рдиреА, </font><font style="vertical-align: inherit;">рдкрд┐рд╡рдЯ рдЯреЗрдмрд▓ рд╕реЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдШрдЯрдирд╛ рдХреЗ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдорд╛рди </font><font style="vertical-align: inherit;">рдпрд╛ </font><font style="vertical-align: inherit;">рджреМрдбрд╝ рдкреГрд╖реНрдареЛрдВ </font><font style="vertical-align: inherit;">рдХреЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTML</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЛрдб рдХреЗ </font><font style="vertical-align: inherit;">рд╕рд╛рде рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдирд╛рдо </font><font style="vertical-align: inherit;">, рд╡реЗ рдореЗрд▓ рдЦрд╛рддреЗ рд╣реИрдВред</font></font><br>
<br>
<pre><code class="python hljs">rd = {} <span class="hljs-comment">#rd тАУ race details</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> rs[<span class="hljs-string">'event'</span>]:<font></font>
    place = []<font></font>
    ... sex = [], name=..., country, group, place_in_group, swim, t1, bike, t2, run<font></font>
    result = []<font></font>
<font></font>
    <span class="hljs-keyword">with</span> open(os.path.join(<span class="hljs-string">r'D:\tri\races'</span>, e + <span class="hljs-string">'.txt'</span>), <span class="hljs-string">'r'</span>)<font></font>
        race_html = f.read()<font></font>
<font></font>
    tree = html.fromstring(race_html)<font></font>
    rows = tree.findall(<span class="hljs-string">".//*[@ng-repeat='r in resultsData']"</span>)<font></font>
<font></font>
    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(len(rows)):<font></font>
        row = rows[j]<font></font>
        parts = row.text_content().split(<span class="hljs-string">'\n'</span>)<font></font>
        parts = [r.strip() <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> parts <span class="hljs-keyword">if</span> r.strip() != <span class="hljs-string">''</span>]<font></font>
        place.append(parts[<span class="hljs-number">0</span>])<font></font>
<font></font>
        <span class="hljs-keyword">if</span> len([a <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> row.findall(<span class="hljs-string">'.//i'</span>)]) &gt; <span class="hljs-number">0</span>:<font></font>
            sex.append([a <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> row.findall(<span class="hljs-string">'.//i'</span>)][<span class="hljs-number">0</span>].attrib[<span class="hljs-string">'ng-if'</span>][<span class="hljs-number">10</span>:<span class="hljs-number">-1</span>])
        <span class="hljs-keyword">else</span>:<font></font>
            sex.append(<span class="hljs-string">''</span>)<font></font>
<font></font>
        name.append(parts[<span class="hljs-number">1</span>])<font></font>
<font></font>
        <span class="hljs-keyword">if</span> len(parts) &gt; <span class="hljs-number">10</span>:<font></font>
            country.append(parts[<span class="hljs-number">2</span>].strip())         <font></font>
            k=<span class="hljs-number">0</span>
        <span class="hljs-keyword">else</span>:<font></font>
            country.append(<span class="hljs-string">''</span>)<font></font>
            k=<span class="hljs-number">1</span><font></font>
<font></font>
        group.append(parts[<span class="hljs-number">3</span>-k])<font></font>
        ... place_in_group.append(...), swim.append ..., t1, bike, t2, run<font></font>
        result.append(parts[<span class="hljs-number">10</span>-k])<font></font>
<font></font>
    race = pd.DataFrame()<font></font>
    race[<span class="hljs-string">'place'</span>] = place<font></font>
    ... race[<span class="hljs-string">'sex'</span>] = sex, race[<span class="hljs-string">'name'</span>] = ..., <span class="hljs-string">'country'</span>, <span class="hljs-string">'group'</span>, <span class="hljs-string">'place_in_group'</span>, <span class="hljs-string">'swim'</span>, <span class="hljs-string">' t1'</span>, <span class="hljs-string">'bike'</span>, <span class="hljs-string">'t2'</span>, <span class="hljs-string">'run'</span>
    race[<span class="hljs-string">'result'</span>] = result<font></font>
<font></font>
    rd[e] = race<font></font>
<font></font>
<span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\details.pkl'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:<font></font>
    pkl.dump(rd,f)<font></font>
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>place in group</th>
<th>swim</th>
<th>t1</th>
<th>bike</th>
<th>t2</th>
<th>run</th>
<th>result</th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td>Reed, Tim</td>
<td>AUS</td>
<td>MPRO</td>
<td>1</td>
<td>24:34</td>
<td>1:07</td>
<td>2:13:46</td>
<td>1:49</td>
<td>1:23:17</td>
<td>4:04:33</td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td>Van Berkel, Tim</td>
<td>AUS</td>
<td>MPRO</td>
<td>2</td>
<td>24:34</td>
<td>1:05</td>
<td>2:13:47</td>
<td>1:53</td>
<td>1:27:17</td>
<td>4:08:36</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td>Baldwin, Nicholas</td>
<td>SEY</td>
<td>MPRO</td>
<td>3</td>
<td>26:31</td>
<td>0:59</td>
<td>2:14:06</td>
<td>1:54</td>
<td>1:25:36</td>
<td>4:09:06</td>
</tr>
<tr>
<td>3</td>
<td>4</td>
<td>M</td>
<td>Polizzi, Alexander</td>
<td>AUS</td>
<td>MPRO</td>
<td>4</td>
<td>23:21</td>
<td>1:12</td>
<td>2:14:53</td>
<td>1:54</td>
<td>1:31:16</td>
<td>4:12:36</td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>M</td>
<td>Chang, Chia-Hao</td>
<td>TWN</td>
<td>M18-24</td>
<td>1</td>
<td>25:18</td>
<td>1:34</td>
<td>2:23:38</td>
<td>2:13</td>
<td>1:29:01</td>
<td>4:21:44</td>
</tr>
<tr>
<td>5</td>
<td>6</td>
<td>M</td>
<td>Rondy, Guillaume</td>
<td>FRA</td>
<td>M35-39</td>
<td>1</td>
<td>27:51</td>
<td>1:26</td>
<td>2:21:53</td>
<td>2:29</td>
<td>1:35:19</td>
<td>4:28:58</td>
</tr>
<tr>
<td>6</td>
<td>7</td>
<td>F</td>
<td>Steffen, Caroline</td>
<td>SUI</td>
<td>FPRO</td>
<td>1</td>
<td>26:52</td>
<td>1:01</td>
<td>2:24:54</td>
<td>2:10</td>
<td>1:34:17</td>
<td>4:29:14</td>
</tr>
<tr>
<td>7</td>
<td>8</td>
<td>M</td>
<td>Betten, Sam</td>
<td>AUS</td>
<td>MPRO</td>
<td>5</td>
<td>23:30</td>
<td>1:26</td>
<td>2:18:24</td>
<td>1:57</td>
<td>1:45:07</td>
<td>4:30:24</td>
</tr>
<tr>
<td>8</td>
<td>9</td>
<td>M</td>
<td>Gallot, Simon</td>
<td>FRA</td>
<td>M30-34</td>
<td>1</td>
<td>27:50</td>
<td>1:33</td>
<td>2:20:15</td>
<td>2:13</td>
<td>1:45:22</td>
<td>4:37:13</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td>524</td>
<td>525</td>
<td>M</td>
<td>Santos, Alfredo</td>
<td>PHI</td>
<td>M65-69</td>
<td>2</td>
<td>50:42</td>
<td>4:23</td>
<td>3:52:10</td>
<td>10:32</td>
<td>3:36:11</td>
<td>8:33:58</td>
</tr>
<tr>
<td>525</td>
<td>526</td>
<td>F</td>
<td>Escober, Eula</td>
<td>PHI</td>
<td>F18-24</td>
<td>5</td>
<td>47:07</td>
<td>3:50</td>
<td>4:43:44</td>
<td>3:41</td>
<td>2:59:45</td>
<td>8:38:07</td>
</tr>
<tr>
<td>526</td>
<td>527</td>
<td>M</td>
<td>Belen, Virgilio Jr.</td>
<td>PHI</td>
<td>M45-49</td>
<td>76</td>
<td>47:05</td>
<td>5:49</td>
<td>3:48:18</td>
<td>11:21</td>
<td>3:46:06</td>
<td>8:38:39</td>
</tr>
<tr>
<td>527</td>
<td>528</td>
<td>M</td>
<td>Kunimoto, Kilhak</td>
<td>GUM</td>
<td>M70-74</td>
<td>2</td>
<td>40:32</td>
<td>2:50</td>
<td>3:53:37</td>
<td>6:45</td>
<td>4:01:36</td>
<td>8:45:20</td>
</tr>
<tr>
<td>528</td>
<td>529</td>
<td>M</td>
<td>Sumicad, Siegfred</td>
<td>PHI</td>
<td>M50-54</td>
<td>54</td>
<td>59:10</td>
<td>4:38</td>
<td>4:11:55</td>
<td>6:35</td>
<td>3:23:45</td>
<td>8:46:03</td>
</tr>
<tr>
<td>529</td>
<td>530</td>
<td>M</td>
<td>Gomez, Paul</td>
<td>PHI</td>
<td>M45-49</td>
<td>77</td>
<td>50:02</td>
<td>6:29</td>
<td>4:07:58</td>
<td>7:24</td>
<td>3:41:41</td>
<td>8:53:34</td>
</tr>
<tr>
<td>530</td>
<td>531</td>
<td>M</td>
<td>Ramos, John Raymund</td>
<td>PHI</td>
<td>M25-29</td>
<td>26</td>
<td>43:44</td>
<td>3:04</td>
<td>4:21:13</td>
<td>5:56</td>
<td>3:45:10</td>
<td>8:59:07</td>
</tr>
<tr>
<td>531</td>
<td>532</td>
<td>F</td>
<td>De Guzman, Clouie Anne</td>
<td>PHI</td>
<td>F30-34</td>
<td>9</td>
<td>52:29</td>
<td>3:16</td>
<td>4:03:02</td>
<td>7:01</td>
<td>3:56:39</td>
<td>9:02:27</td>
</tr>
<tr>
<td>532</td>
<td>533</td>
<td>F</td>
<td>Samson, Maria Dolores</td>
<td>PHI</td>
<td>F45-49</td>
<td>17</td>
<td>48:56</td>
<td>4:21</td>
<td>4:16:34</td>
<td>6:26</td>
<td>3:47:06</td>
<td>9:03:23</td>
</tr>
<tr>
<td>533</td>
<td>534</td>
<td>M</td>
<td>Salazar, Richard</td>
<td>PHI</td>
<td>M40-44</td>
<td>107</td>
<td>42:19</td>
<td>4:02</td>
<td>4:30:36</td>
<td>6:39</td>
<td>3:39:51</td>
<td>9:03:27</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рддрд┐рднрд╛рдЧрд┐рдпреЛрдВ рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЗ рд╕рд╛рде рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рдЕрд▓рд╛рд╡рд╛, </font><font style="vertical-align: inherit;">рдкреНрд░рддреНрдпреЗрдХ рджреМрдбрд╝ </font><font style="vertical-align: inherit;">рдХреА </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTML</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдкреНрд░рддрд┐рдпреЛрдЧрд┐рддрд╛ рдХреА рддрд╛рд░реАрдЦ, рдирд╛рдо рдФрд░ рд╕реНрдерд╛рди рднреА рд╣реЛрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рджрд┐рдирд╛рдВрдХ рдФрд░ рдирд╛рдо рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдзреБрд░реА рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдХреЛрдИ рд╕реНрдерд╛рди рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTML</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдлрд╝рд╛рдЗрд▓реЛрдВ </font><font style="vertical-align: inherit;">рд╕реЗ рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдкрдврд╝рддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">рдФрд░ рдЗрд╕реЗ рдкрд┐рд╡рдЯ рдЯреЗрдмрд▓ рдореЗрдВ рдПрдХ рдирдП рдХреЙрд▓рдо рдореЗрдВ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> index, row <span class="hljs-keyword">in</span> rs.iterrows():<font></font>
    e = row[<span class="hljs-string">'event'</span>]       
    <span class="hljs-keyword">with</span> open(os.path.join(<span class="hljs-string">r'D:\tri\races'</span>, e + <span class="hljs-string">'.txt'</span>), <span class="hljs-string">'r'</span>) <span class="hljs-keyword">as</span> f:<font></font>
        race_html = f.read()<font></font>
<font></font>
    tree = html.fromstring(race_html)<font></font>
    header_elem = [tb <span class="hljs-keyword">for</span> tb <span class="hljs-keyword">in</span> tree.findall(<span class="hljs-string">'.//tbody'</span>) <span class="hljs-keyword">if</span> tb.getchildren()[<span class="hljs-number">0</span>].getchildren()[<span class="hljs-number">0</span>].text == <span class="hljs-string">''</span>][<span class="hljs-number">0</span>]<font></font>
    location = header_elem.getchildren()[<span class="hljs-number">1</span>].getchildren()[<span class="hljs-number">1</span>].text.strip()<font></font>
    rs.loc[index, <span class="hljs-string">'loc'</span>] = location
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th>date</th>
<th><u>loc</u></th>
<th>male</th>
<th>female</th>
<th>rus</th>
<th>total</th>
<th>link</th>
</tr>
<tr>
<td>0</td>
<td>Ironman Dubai Duathlon 70.3 2020</td>
<td>2020-07-02</td>
<td><u>Dubai, United Arab Emirates</u></td>
<td>835</td>
<td>215</td>
<td>65</td>
<td>1050</td>
<td>...</td>
</tr>
<tr>
<td>1</td>
<td>Ironman Dubai 70.3 2020</td>
<td>2020-02-07</td>
<td><u>Dubai, United Arab Emirates</u></td>
<td>638</td>
<td>132</td>
<td>55</td>
<td>770</td>
<td>...</td>
</tr>
<tr>
<td>2</td>
<td>Israman Half 2020</td>
<td>2020-01-29</td>
<td><u>Israel, Eilat</u></td>
<td>670</td>
<td>126</td>
<td>4</td>
<td>796</td>
<td>...</td>
</tr>
<tr>
<td>3</td>
<td>Ironman Indian Wells La Quinta 70.3 2019</td>
<td>2019-12-08</td>
<td><u>Indian Wells/La Quinta, California, USA</u></td>
<td>1590</td>
<td>593</td>
<td>6</td>
<td>2183</td>
<td>...</td>
</tr>
<tr>
<td>4</td>
<td>Ironman Taupo 70.3 2019</td>
<td>2019-12-07</td>
<td><u>New Zealand</u></td>
<td>767</td>
<td>420</td>
<td>3</td>
<td>1187</td>
<td>...</td>
</tr>
<tr>
<td>5</td>
<td>Ironman Bahrain 70.3 2019</td>
<td>2019-12-07</td>
<td><u>Manama, Bahrain</u></td>
<td>858</td>
<td>214</td>
<td>38</td>
<td>1072</td>
<td>...</td>
</tr>
<tr>
<td>6</td>
<td>Ironman Western Australia 2019</td>
<td>2019-12-01</td>
<td><u>Busselton, Western Australia</u></td>
<td>940</td>
<td>229</td>
<td>1</td>
<td>1169</td>
<td>...</td>
</tr>
<tr>
<td>7</td>
<td>Ironman Mar del Plata 2019</td>
<td>2019-12-01</td>
<td><u>Mar del Plata, Argentina</u></td>
<td>506</td>
<td>66</td>
<td>3</td>
<td>572</td>
<td>...</td>
</tr>
<tr>
<td>8</td>
<td>Ironman Cozumel 2019</td>
<td>2019-11-24</td>
<td><u>Cozumel, Mexico</u></td>
<td>1158</td>
<td>395</td>
<td>12</td>
<td>1553</td>
<td>...</td>
</tr>
<tr>
<td>9</td>
<td>Ironman Arizona 2019</td>
<td>2019-11-24</td>
<td><u>Tempe, Arizona, USA</u></td>
<td>1697</td>
<td>633</td>
<td>3</td>
<td>2330</td>
<td>...</td>
</tr>
<tr>
<td>10</td>
<td>Ironman Xiamen 70.3 2019</td>
<td>2019-11-10</td>
<td><u>Xiamen, China</u></td>
<td>897</td>
<td>170</td>
<td>14</td>
<td>1067</td>
<td>...</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╣реЗрдЬреЗрдВред </font><font style="vertical-align: inherit;">рдПрдХ рдирдИ рдлрд╛рдЗрд▓ рдХреЗ рд▓рд┐рдПред</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\summary1.pkl'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:<font></font>
    pkl.dump(df,f)<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рднрд╛рдЧ 2. рдЯрд╛рдЗрдк рдХрд╛рд╕реНрдЯрд┐рдВрдЧ рдФрд░ рд╕реНрд╡рд░реВрдкрдг</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕рд▓рд┐рдП, рд╣рдордиреЗ рд╕рднреА рдбреЗрдЯрд╛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдП рдФрд░ рдЗрд╕реЗ рдбреЗрдЯрд╛ рдлрд╝реНрд░реЗрдо рдореЗрдВ рдбрд╛рд▓ рджрд┐рдпрд╛ред </font><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╕рднреА рдореВрд▓реНрдпреЛрдВ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╣реЛрддреЗ рд╣реИрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рдпрд╣ рджрд┐рдирд╛рдВрдХ, рдФрд░ рдкрд░рд┐рдгрд╛рдореЛрдВ, рдФрд░ рд╕реНрдерд╛рди рдФрд░ рдЕрдиреНрдп рд╕рднреА рдорд╛рдкрджрдВрдбреЛрдВ рдкрд░ рд▓рд╛рдЧреВ рд╣реЛрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╕рднреА рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рдЙрдкрдпреБрдХреНрдд рдкреНрд░рдХрд╛рд░реЛрдВ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЪрд▓реЛ рдзреБрд░реА рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВред</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th>date</th>
<th><u>loc</u></th>
<th>male</th>
<th>female</th>
<th>rus</th>
<th>total</th>
<th>link</th>
</tr>
<tr>
<td>0</td>
<td>Ironman Dubai Duathlon 70.3 2020</td>
<td>2020-07-02</td>
<td><u>Dubai, United Arab Emirates</u></td>
<td>835</td>
<td>215</td>
<td>65</td>
<td>1050</td>
<td>...</td>
</tr>
<tr>
<td>1</td>
<td>Ironman Dubai 70.3 2020</td>
<td>2020-02-07</td>
<td><u>Dubai, United Arab Emirates</u></td>
<td>638</td>
<td>132</td>
<td>55</td>
<td>770</td>
<td>...</td>
</tr>
<tr>
<td>2</td>
<td>Israman Half 2020</td>
<td>2020-01-29</td>
<td><u>Israel, Eilat</u></td>
<td>670</td>
<td>126</td>
<td>4</td>
<td>796</td>
<td>...</td>
</tr>
<tr>
<td>3</td>
<td>Ironman Indian Wells La Quinta 70.3 2019</td>
<td>2019-12-08</td>
<td><u>Indian Wells/La Quinta, California, USA</u></td>
<td>1590</td>
<td>593</td>
<td>6</td>
<td>2183</td>
<td>...</td>
</tr>
<tr>
<td>4</td>
<td>Ironman Taupo 70.3 2019</td>
<td>2019-12-07</td>
<td><u>New Zealand</u></td>
<td>767</td>
<td>420</td>
<td>3</td>
<td>1187</td>
<td>...</td>
</tr>
<tr>
<td>5</td>
<td>Ironman Bahrain 70.3 2019</td>
<td>2019-12-07</td>
<td><u>Manama, Bahrain</u></td>
<td>858</td>
<td>214</td>
<td>38</td>
<td>1072</td>
<td>...</td>
</tr>
<tr>
<td>6</td>
<td>Ironman Western Australia 2019</td>
<td>2019-12-01</td>
<td><u>Busselton, Western Australia</u></td>
<td>940</td>
<td>229</td>
<td>1</td>
<td>1169</td>
<td>...</td>
</tr>
<tr>
<td>7</td>
<td>Ironman Mar del Plata 2019</td>
<td>2019-12-01</td>
<td><u>Mar del Plata, Argentina</u></td>
<td>506</td>
<td>66</td>
<td>3</td>
<td>572</td>
<td>...</td>
</tr>
<tr>
<td>8</td>
<td>Ironman Cozumel 2019</td>
<td>2019-11-24</td>
<td><u>Cozumel, Mexico</u></td>
<td>1158</td>
<td>395</td>
<td>12</td>
<td>1553</td>
<td>...</td>
</tr>
<tr>
<td>9</td>
<td>Ironman Arizona 2019</td>
<td>2019-11-24</td>
<td><u>Tempe, Arizona, USA</u></td>
<td>1697</td>
<td>633</td>
<td>3</td>
<td>2330</td>
<td>...</td>
</tr>
<tr>
<td>10</td>
<td>Ironman Xiamen 70.3 2019</td>
<td>2019-11-10</td>
<td><u>Xiamen, China</u></td>
<td>897</td>
<td>170</td>
<td>14</td>
<td>1067</td>
<td>...</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
<td><u>...</u></td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody></table></div></code><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджрд┐рдирд╛рдВрдХ рдФрд░ рд╕рдордп</font></font></h3><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдИрд╡реЗрдВрдЯ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓реЛрдХреЗрд╢рди</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рд┐рдВрдХ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЛ рд╡реИрд╕реЗ рд╣реА рдЫреЛрдбрд╝ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджрд┐рдирд╛рдВрдХ </font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрдВрдбреЛрдВ рдХреЗ рдбреЗрдЯрд╛рдЗрдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ </font><font style="vertical-align: inherit;">рдкрд░рд┐рд╡рд░реНрддрд┐рдд </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="python hljs">rs[<span class="hljs-string">'date'</span>] = pd.to_datetime(rs[<span class="hljs-string">'date'</span>])
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдмрд╛рдХреА рдПрдХ рдкреВрд░реНрдгрд╛рдВрдХ рдкреНрд░рдХрд╛рд░ рдХреЗ рд▓рд┐рдП рдбрд╛рд▓реЗ рдЬрд╛рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="python hljs">cols = [<span class="hljs-string">'males'</span>, <span class="hljs-string">'females'</span>, <span class="hljs-string">'rus'</span>, <span class="hljs-string">'total'</span>]<font></font>
rs[cols] = rs[cols].astype(int)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рдм рдХреБрдЫ рдЖрд╕рд╛рдиреА рд╕реЗ рд╣реЛ рдЧрдпрд╛, рдХреЛрдИ рддреНрд░реБрдЯрд┐ рдирд╣реАрдВ рд╣реБрдИред </font><font style="vertical-align: inherit;">рддреЛ рд╕рдм рдХреБрдЫ рдареАрдХ рд╣реИ - рд╕рд╣реЗрдЬреЗрдВ:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\summary2.pkl'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:<font></font>
    pkl.dump(rs, f)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рдбреЗрдЯрд╛рдлреНрд░реЗрдо рдХреА рд░реЗрд╕рд┐рдВрдЧред </font><font style="vertical-align: inherit;">рдЪреВрдБрдХрд┐ рд╕рднреА рджреМрдбрд╝ рдПрдХ рд╕рд╛рде рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдФрд░ рддреЗрдЬрд╝ рд╣реЛрддреА рд╣реИрдВ, рдФрд░ рдПрдХ рдмрд╛рд░ рдореЗрдВ рдПрдХ рдирд╣реАрдВ, рд╣рдо </font><i><font style="vertical-align: inherit;">рдХреЙрдирдХреИрдЯ</font></i><font style="vertical-align: inherit;"> рдкрджреНрдзрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ </font><font style="vertical-align: inherit;">рдЙрдиреНрд╣реЗрдВ рдПрдХ рдмрдбрд╝реЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрд░</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдбреЗрдЯрд╛ рдлреНрд░реЗрдо </font><font style="vertical-align: inherit;">( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рднреА рд░рд┐рдХреЙрд░реНрдб рдХреЗ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд▓рд┐рдП рдЫреЛрдЯрд╛ </font><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">рдореЗрдВ рдЗрдХрдЯреНрдард╛ рдХрд░реЗрдВрдЧреЗ </font><font style="vertical-align: inherit;">ред</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar = pd.concat(rd) 
</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ 1,416,365 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ рд╣реИрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╕рдореВрд╣ рдореЗрдВ рдЬрдЧрд╣ рдФрд░ рдЬрдЧрд╣ рдХреЛ рдкреВрд░реНрдгрд╛рдВрдХ рдорд╛рди рдореЗрдВ рдмрджрд▓реЗрдВред</font></font><br>
<br>
<pre><code class="python hljs">ar[[<span class="hljs-string">'place'</span>, <span class="hljs-string">'place in group'</span>]] = ar[[<span class="hljs-string">'place'</span>, <span class="hljs-string">'place in group'</span>]].astype(int))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдЧрд▓рд╛, рд╣рдо рдЕрд╕реНрдерд╛рдпреА рдорд╛рдиреЛрдВ рдХреЗ рд╕рд╛рде рдХреЙрд▓рдо рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╣рдо рдЙрдиреНрд╣реЗрдВ </font><i><font style="vertical-align: inherit;">рдкрд╛рдВрдбрд╛</font></i><font style="vertical-align: inherit;"> рд╕реЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреЗрдбрд┐рдореЗрд▓реНрдЯрд╛</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреНрд░рдХрд╛рд░ рдореЗрдВ </font><i><font style="vertical-align: inherit;">рдбрд╛рд▓реЗрдВрдЧреЗ</font></i><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рд░реВрдкрд╛рдВрддрд░рдг рдХреЗ рд╕рдлрд▓ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдбреЗрдЯрд╛ рдХреЛ рдареАрдХ рд╕реЗ рддреИрдпрд╛рд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреБрдЫ рдореВрд▓реНрдп рдЬреЛ рдПрдХ рдШрдВрдЯреЗ рд╕реЗ рдХрдо рд╣реИрдВ, рдмрд╣реБрдд рдЯрд┐рдк рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдП рдмрд┐рдирд╛ рдЪрд▓рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕реЗ рдЬреЛрдбрд╝рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИред</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>place in group</th>
<th><u>swim</u></th>
<th><u>t1</u></th>
<th>bike</th>
<th><u>t2</u></th>
<th>run</th>
<th>result</th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td>Dejan Patrcevic</td>
<td>CRO</td>
<td>M40-44</td>
<td>1</td>
<td><u>29:03</u></td>
<td><u>2:50</u></td>
<td>2:09:17</td>
<td><u>1:37</u></td>
<td>1:22:06</td>
<td>4:04:51</td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td>Lukas Krpec</td>
<td>CZE</td>
<td>M35-39</td>
<td>1</td>
<td><u>29:00</u></td>
<td><u>2:40</u></td>
<td>2:07:01</td>
<td><u>1:48</u></td>
<td>1:25:48</td>
<td>4:06:15</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td>Marin Koceic</td>
<td>CRO</td>
<td>M40-44</td>
<td>2</td>
<td><u>27:34</u></td>
<td><u>2:09</u></td>
<td>2:12:13</td>
<td><u>1:30</u></td>
<td>1:27:19</td>
<td>4:10:44</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> [<span class="hljs-string">'swim'</span>, <span class="hljs-string">'t1'</span>, <span class="hljs-string">'bike'</span>, <span class="hljs-string">'t2'</span>, <span class="hljs-string">'run'</span>, <span class="hljs-string">'result'</span>]:<font></font>
    strlen = ar[col].str.len()<font></font>
    ar.loc[strlen==<span class="hljs-number">5</span>, col] = <span class="hljs-string">'0:'</span> + ar.loc[strlen==<span class="hljs-number">5</span>, col]<font></font>
    ar.loc[strlen==<span class="hljs-number">4</span>, col] = <span class="hljs-string">'0:0'</span> + ar.loc[strlen==<span class="hljs-number">4</span>, col]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рднреА, рдЕрднреА рднреА рд╢реЗрд╖ рддрд╛рд░, рдЗрд╕ рддрд░рд╣ </font><font style="vertical-align: inherit;">рд╕реЗ </font><i><font style="vertical-align: inherit;">рджреЗрдЦреЗрдВ</font></i><font style="vertical-align: inherit;"> : </font><i><font style="vertical-align: inherit;">Timedelta рдореЗрдВ</font></i><font style="vertical-align: inherit;"> рдХрдирд╡рд░реНрдЯ рдХрд░реЗрдВ </font><font style="vertical-align: inherit;">:</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>place in group</th>
<th><u>swim</u></th>
<th><u>t1</u></th>
<th>bike</th>
<th><u>t2</u></th>
<th>run</th>
<th>result</th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td>Dejan Patrcevic</td>
<td>CRO</td>
<td>M40-44</td>
<td>1</td>
<td><u>0:29:03</u></td>
<td><u>0:02:50</u></td>
<td>2:09:17</td>
<td><u>0:01:37</u></td>
<td>1:22:06</td>
<td>4:04:51</td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td>Lukas Krpec</td>
<td>CZE</td>
<td>M35-39</td>
<td>1</td>
<td><u>0:29:00</u></td>
<td><u>0:02:40</u></td>
<td>2:07:01</td>
<td><u>0:01:48</u></td>
<td>1:25:48</td>
<td>4:06:15</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td>Marin Koceic</td>
<td>CRO</td>
<td>M40-44</td>
<td>2</td>
<td><u>0:27:34</u></td>
<td><u>0:02:09</u></td>
<td>2:12:13</td>
<td><u>0:01:30</u></td>
<td>1:27:19</td>
<td>4:10:44</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> [<span class="hljs-string">'swim'</span>, <span class="hljs-string">'t1'</span>, <span class="hljs-string">'bike'</span>, <span class="hljs-string">'t2'</span>, <span class="hljs-string">'run'</span>, <span class="hljs-string">'result'</span>]:<font></font>
    ar[col] = pd.to_timedelta(ar[col])<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдордВрдЬрд╝рд┐рд▓</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдЧреЗ рдмрдврд╝реЛред </font><font style="vertical-align: inherit;">рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реЗрдХреНрд╕</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЙрд▓рдо </font><font style="vertical-align: inherit;">рдореЗрдВ рдХреЗрд╡рд▓ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдл рдХреЗ рдореВрд▓реНрдп рд╣реИрдВ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'sex'</span>].unique() 
</code></pre><br>
<code><b>Out:</b> ['M', 'F', '']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдЕрднреА рднреА рдПрдХ рдЦрд╛рд▓реА рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╣реИ, рдЕрд░реНрдерд╛рдд, рд▓рд┐рдВрдЧ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рдЖрдЗрдП рджреЗрдЦрддреЗ рд╣реИрдВ рдРрд╕реЗ рдХрд┐рддрдиреЗ рдорд╛рдорд▓реЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="python hljs">len(ar[ar[<span class="hljs-string">'sex'</span>] == <span class="hljs-string">''</span>]) 
</code></pre><br>
<code><b>Out:</b> 2538<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрддрдирд╛ рдЕрдЪреНрдЫрд╛ рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рднрд╡рд┐рд╖реНрдп рдореЗрдВ, рд╣рдо рдЗрд╕ рдореВрд▓реНрдп рдХреЛ рдФрд░ рдХрдо рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдЗрд╕ рдмреАрдЪ, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реЗрдХреНрд╕</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЙрд▓рдо </font><font style="vertical-align: inherit;">рдХреЛ </font><font style="vertical-align: inherit;">рдЫреЛрдбрд╝ рджреЗрдВ </font><font style="vertical-align: inherit;">рдЬреИрд╕рд╛ рдХрд┐ рд▓рд╛рдЗрдиреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рд╣реИред </font><font style="vertical-align: inherit;">рдЕрдзрд┐рдХ рдЧрдВрднреАрд░ рдФрд░ рдЬреЛрдЦрд┐рдо рднрд░реЗ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреА рдУрд░ рдмрдврд╝рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд╣рдо рдкрд░рд┐рдгрд╛рдо рдХреЛ рдмрдЪрд╛рдПрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдЖрджреЗрд╢ рдлрд╛рдЗрд▓реЛрдВ рдХреЗ рдмреАрдЪ рдирд┐рд░рдВрддрд░рддрд╛ рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рд╕рдВрдпреБрдХреНрдд рдбреЗрдЯрд╛ рдлреНрд░реЗрдо рдмрджрд▓рдиреЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдбреЗрдЯрд╛ рдлреНрд░реЗрдо рдХреЗ рд╢рдмреНрджрдХреЛрд╢ рдореЗрдВ рд╡рд╛рдкрд╕ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> ar.index.get_level_values(<span class="hljs-number">0</span>).unique():<font></font>
    rd[event] = ar.loc[event]<font></font>
<font></font>
<span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\details1.pkl'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:<font></font>
    pkl.dump(rd,f)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╡реИрд╕реЗ, рдХреБрдЫ рд╕реНрддрдВрднреЛрдВ рдХреЗ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд░реВрдкрд╛рдВрддрд░рдг рдХреЗ рдХрд╛рд░рдг, рдлрд╝рд╛рдЗрд▓ рдЖрдХрд╛рд░ 367 рдХреЗрдмреА рд╕реЗ рдШрдЯрдХрд░ рдкреЙрдЯ рдЯреЗрдмрд▓ рдХреЗ рд▓рд┐рдП 295 рдХреЗрдмреА рдФрд░ рд░реЗрд╕рд┐рдВрдЧ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд▓рд┐рдП 251 рдПрдордмреА рд╕реЗ 168 рдПрдордмреА рд╣реЛ рдЧрдпрд╛ рд╣реИред </font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреЗрд╢ рдХреЛрдб</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рджреЗрд╢ рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВред</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'country'</span>].unique()
</code></pre><br>
<code><b>Out:</b> ['CRO', 'CZE', 'SLO', 'SRB', 'BUL', 'SVK', 'SWE', 'BIH', 'POL', 'MK', 'ROU', 'GRE', 'FRA', 'HUN', 'NOR', 'AUT', 'MNE', 'GBR', 'RUS', 'UAE', 'USA', 'GER', 'URU', 'CRC', 'ITA', 'DEN', 'TUR', 'SUI', 'MEX', 'BLR', 'EST', 'NED', 'AUS', 'BGI', 'BEL', 'ESP', 'POR', 'UKR', 'CAN', 'IRL', 'JPN', 'HKG', 'JEY', 'SGP', 'BRA', 'QAT', 'LUX', 'RSA', 'NZL', 'LAT', 'PHI', 'KSA', 'SEY', 'MAS', 'OMA', 'ARG', 'ECU', 'THA', 'JOR', 'BRN', 'CIV', 'FIN', 'IRN', 'BER', 'LBA', 'KUW', 'LTU', 'SRI', 'HON', 'INA', 'LBN', 'PAN', 'EGY', 'MLT', 'WAL', 'ISL', 'CYP', 'DOM', 'IND', 'VIE', 'MRI', 'AZE', 'MLD', 'LIE', 'VEN', 'ALG', 'SYR', 'MAR', 'KZK', 'PER', 'COL', 'IRQ', 'PAK', 'CZK', 'KAZ', 'CHN', 'NEP', 'ISR', 'MKD', 'FRO', 'BAN', 'ARU', 'CPV', 'ALB', 'BIZ', 'TPE', 'KGZ', 'BNN', 'CUB', 'SNG', 'VTN', 'THI', 'PRG', 'KOR', 'RE', 'TW', 'VN', 'MOL', 'FRE', 'AND', 'MDV', 'GUA', 'MON', 'ARM', 'F.I.TRI.', 'BAHREIN', 'SUECIA', 'REPUBLICA CHECA', 'BRASIL', 'CHI', 'MDA', 'TUN', 'NDL', 'Danish(Dane)', 'Welsh', 'Austrian', 'Unknown', 'AFG', 'Argentinean', 'Pitcairn', 'South African', 'Greenland', 'ESTADOS UNIDOS', 'LUXEMBURGO', 'SUDAFRICA', 'NUEVA ZELANDA', 'RUMANIA', 'PM', 'BAH', 'LTV', 'ESA', 'LAB', 'GIB', 'GUT', 'SAR', 'ita', 'aut', 'ger', 'esp', 'gbr', 'hun', 'den', 'usa', 'sui', 'slo', 'cze', 'svk', 'fra', 'fin', 'isr', 'irn', 'irl', 'bel', 'ned', 'sco', 'pol', 'SMR', 'mex', 'STEEL T BG', 'KINO MANA', 'IVB', 'TCH', 'SCO', 'KEN', 'BAS', 'ZIM', 'Joe', 'PUR', 'SWZ', 'Mark', 'WLS', 'MYA', 'BOT', 'REU', 'NAM', 'NCL', 'BOL', 'GGY', 'ISV', 'TWN', 'GUM', 'FIJ', 'COK', 'NGR', 'IRI', 'GAB', 'ANT', 'GEO', 'COG', 'sue', 'SUD', 'BAR', 'CAY', 'BO', 'VE', 'AX', 'MD', 'PAR', 'UM', 'SEN', 'NIG', 'RWA', 'YEM', 'PLE', 'GHA', 'ITU', 'UZB', 'MGL', 'MAC', 'DMA', 'TAH', 'TTO', 'AHO', 'JAM', 'SKN', 'GRN', 'PRK', 'NFK', 'SOL', 'Sandy', 'SAM', 'PNG', 'SGS', 'Suchy, Jorg', 'SOG', 'GEQ', 'BVT', 'DJI', 'CHA', 'ANG', 'YUG', 'IOT', 'HAI', 'SJM', 'CUW', 'BHU', 'ERI', 'FLK', 'HMD', 'GUF', 'ESH', 'sandy', 'UMI', 'selsmark, 'Alise', 'Eddie', '31/3, Colin', 'CC', '', '', '', '', '', ' ', '', '', '', '-', '', 'GRL', 'UGA', 'VAT', 'ETH', 'ASA', 'PYF', 'ATA', 'ALA', 'MTQ', 'ZZ', 'CXR', 'AIA', 'TJK', 'GUY', 'KR', 'PF', 'BN', 'MO', 'LA', 'CAM', 'NCA', 'ZAM', 'MAD', 'TOG', 'VIR', 'ATF', 'VAN', 'SLE', 'GLP', 'SCG', 'LAO', 'IMN', 'BUR', 'IR', 'SY', 'CMR', 'GBS', 'SUR', 'MOZ', 'BLM', 'MSR', 'CAF', 'BEN', 'COD', 'CCK', 'TUV', 'TGA', 'GI', 'XKX', 'NRU', 'NC', 'LBR', 'TAN', 'VIN', 'SSD', 'GP', 'PS', 'IM', 'JE', '', 'MLI', 'FSM', 'LCA', 'GMB', 'MHL', 'NH', 'FL', 'CT', 'UT', 'AQ', 'Korea', 'Taiwan', 'NewCaledonia', 'Czech Republic', 'PLW', 'BRU', 'RUN', 'NIU', 'KIR', 'SOM', 'TKM', 'SPM', 'BDI', 'COM', 'TCA', 'SHN', 'DO2', 'DCF', 'PCN', 'MNP', 'MYT', 'SXM', 'MAF', 'GUI', 'AN', 'Slovak republic', 'Channel Islands', 'Reunion', 'Wales', 'Scotland', 'ica', 'WLF', 'D', 'F', 'I', 'B', 'L', 'E', 'A', 'S', 'N', 'H', 'R', 'NU', 'BES', 'Bavaria', 'TLS', 'J', 'TKL', 'Tirol"', 'P', '?????', 'EU', 'ES-IB', 'ES-CT', '', 'SOO', 'LZE', '', '', '', '', '', '']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
412 рдЕрджреНрд╡рд┐рддреАрдп рдореВрд▓реНрдпред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдореВрд▓ рд░реВрдк рд╕реЗ, рдХрд┐рд╕реА рджреЗрд╢ рдХреЛ рдКрдкрд░реА рдорд╛рдорд▓реЗ рдореЗрдВ рддреАрди рдЕрдВрдХреЛрдВ рдХреЗ рдЕрдХреНрд╖рд░ рдХреЛрдб рджреНрд╡рд╛рд░рд╛ рдЗрдВрдЧрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдЬрд╛рд╣рд┐рд░ рд╣реИ, рд╣рдореЗрд╢рд╛ рдирд╣реАрдВред </font><font style="vertical-align: inherit;">рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдПрдХ рдЕрдВрддрд░рд░рд╛рд╖реНрдЯреНрд░реАрдп рдорд╛рдирдХ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдИрдПрд╕рдУ 3166 рд╣реИ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдЬрд┐рд╕рдореЗрдВ рд╕рднреА рджреЗрд╢реЛрдВ рдХреЗ рд▓рд┐рдП, рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдЙрди рд▓реЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рднреА рдЬреЛ рдЕрдм рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИрдВ, рдЗрд╕реА рддреАрди-рдЕрдВрдХреАрдп рдФрд░ рджреЛ-рдЕрдВрдХреАрдп рдХреЛрдб рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╣реИрдВред </font><font style="vertical-align: inherit;">рдХреЗ рд▓рд┐рдП </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдЬрдЧрд░,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЗрд╕ рдорд╛рдирдХ рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ рд╕реЗ рдПрдХ рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pycountry</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреИрдХреЗрдЬ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдВ рджреЗрдЦрд┐рдП рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> pycountry <span class="hljs-keyword">as</span> pyco<font></font>
<font></font>
pyco.countries.get(alpha_3 = <span class="hljs-string">'RUS'</span>)
</code></pre><br>
<code><b>Out:</b> Country(alpha_2='RU', alpha_3='RUS', name='Russian Federation', numeric='643')<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╣рдо рд╕рднреА рддреАрди рдЕрдВрдХреЛрдВ рдХреЗ рдХреЛрдбреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВрдЧреЗ, рдЬреЛ рдКрдкрд░реА рдорд╛рдорд▓реЗ рдХреЗ рд▓рд┐рдП рдЕрдЧреНрд░рдгреА рд╣реЛрдВрдЧреЗ, рдЬреЛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреЗрд╢реЛрдВ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рдПрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрддреЗ </font><i><font style="vertical-align: inherit;">рд╣реИрдВред (...)</font></i><font style="vertical-align: inherit;"> рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">historical_countries.get (...)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs">valid_a3 = [c <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> ar[<span class="hljs-string">'country'</span>].unique() <span class="hljs-keyword">if</span> pyco.countries.get(alpha_3 = c.upper()) != <span class="hljs-literal">None</span> <span class="hljs-keyword">or</span> pyco.historic_countries.get(alpha_3 = c.upper()) != <span class="hljs-literal">None</span>])
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЙрдирдореЗрдВ рд╕реЗ рез реп рекрезреи рдереЗред рдпрд╛рдиреА рдЖрдзреЗ рд╕реЗ рднреА рдХрдоред </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╢реЗрд╖ 222 рдХреЗ рд▓рд┐рдП (рд╣рдо рдЙрдирдХреА рд╕реВрдЪреА рдХреЛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tofix</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджреНрд╡рд╛рд░рд╛ </font><i><font style="vertical-align: inherit;">рджрд░реНрд╢рд╛рддреЗ рд╣реИрдВ</font></i><font style="vertical-align: inherit;"> ), рд╣рдо </font><i><font style="vertical-align: inherit;">рдПрдХ </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлрд┐рдХреНрд╕</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдорд┐рд▓рд╛рди рд╢рдмреНрджрдХреЛрд╢ </font><i><font style="vertical-align: inherit;">рдмрдирд╛рдПрдВрдЧреЗ</font></i><font style="vertical-align: inherit;"> , рдЬрд┐рд╕рдореЗрдВ рдХреБрдВрдЬреА рдХрд╛ рдореВрд▓ рдирд╛рдо рд╣реЛрдЧрд╛, рдФрд░ рдЖрдИрдПрд╕рдУ рдорд╛рдирдХ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдореВрд▓реНрдп рддреАрди рдЕрдВрдХреЛрдВ рдХрд╛ рдХреЛрдб рд╣реЛрдЧрд╛ред</font></font><br>
<br>
<pre><code class="python hljs">tofix = list(set(ar[<span class="hljs-string">'country'</span>].unique()) - set(valid_a3))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рджреЛ рдЕрдВрдХреЛрдВ рдХреЗ рдХреЛрдбреЛрдВ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pycountry.countries.get (alp_2 = ...) рдХреЗ рд╕рд╛рде</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдКрдкрд░реА рдорд╛рдорд▓реЗ рдХреЗ рд▓рд┐рдП рдЕрдЧреНрд░рдгреА:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> icc <span class="hljs-keyword">in</span> tofix: <span class="hljs-comment">#icc -invalid country code</span>
    <span class="hljs-keyword">if</span> pyco.countries.get(alpha_2 = icc.upper()) != <span class="hljs-literal">None</span>:<font></font>
        fix[icc] = pyco.countries.get(alpha_2 = icc.upper()).alpha_3<font></font>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">if</span> pyco.historic_countries.get(alpha_2 = icc.upper()) != <span class="hljs-literal">None</span>:<font></font>
            fix[icc] = pyco.historic_countries.get(alpha_2 = icc.upper()).alpha_3<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдлрд┐рд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pycountry.countries.get (рдирд╛рдо = ...) рдХреЗ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдорд╛рдзреНрдпрдо рд╕реЗ рдкреВрд░рд╛ рдирд╛рдо </font><i><font style="vertical-align: inherit;">, pycountry.countries.get (common_name = ...)</font></i><font style="vertical-align: inherit;"> , рдЙрдиреНрд╣реЗрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str.title () рдореЗрдВ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> icc <span class="hljs-keyword">in</span> tofix:
    <span class="hljs-keyword">if</span> pyco.countries.get(common_name = icc.title()) != <span class="hljs-literal">None</span>:<font></font>
        fix[icc] = pyco.countries.get(common_name = icc.title()).alpha_3<font></font>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">if</span> pyco.countries.get(name = icc.title()) != <span class="hljs-literal">None</span>:<font></font>
            fix[icc] = pyco.countries.get(name = icc.title()).alpha_3<font></font>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">if</span> pyco.historic_countries.get(name = icc.title()) != <span class="hljs-literal">None</span>:<font></font>
                fix[icc] = pyco.historic_countries.get(name = icc.title()).alpha_3<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╣рдо рдЕрдкрд░рд┐рдЪрд┐рдд рдорд╛рдиреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ 190 рддрдХ рдХрдо рдХрд░ рджреЗрддреЗ рд╣реИрдВред рдлрд┐рд░ рднреА рдХрд╛рдлреА: </font><font style="vertical-align: inherit;">
рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЙрдирдореЗрдВ рд╕реЗ рдЕрднреА рднреА рдХрдИ рддреАрди-рдЕрдВрдХреАрдп рдХреЛрдб рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣ ISO рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рдлрд┐рд░ рдХреНрдпрд╛? </font><font style="vertical-align: inherit;">рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рд╣реИ рдХрд┐ рдПрдХ рдФрд░ рдорд╛рдирдХ рд╣реИ - </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">рдУрд▓рдВрдкрд┐рдХ</font></a><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рдЗрд╕рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдкрд╛рдЗрдХрд╛рдЙрдВрдЯреНрд░реА рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реИ рдФрд░ рдЖрдкрдХреЛ рдХреБрдЫ рдФрд░ рджреЗрдЦрдирд╛ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рд╕рдорд╛рдзрд╛рди </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">datahub.io</font></a><font style="vertical-align: inherit;"> рдкрд░ </font><font style="vertical-align: inherit;">рдПрдХ </font><i><font style="vertical-align: inherit;">рд╕реАрдПрд╕рд╡реА</font></i><font style="vertical-align: inherit;"> рдлрд╝рд╛рдЗрд▓ </font><font style="vertical-align: inherit;">рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдПрдХ </font><i><font style="vertical-align: inherit;">рдкрд╛рдВрдбрд╛ рдбреЗрдЯрд╛рдлрд╝реНрд░реЗрдо</font></i><font style="vertical-align: inherit;"> рдирд╛рдо рдореЗрдВ </font><i><font style="vertical-align: inherit;">рд░рдЦреЗрдВ</font></i><font style="vertical-align: inherit;"> рдЬрд┐рд╕реЗ </font><i><font style="vertical-align: inherit;">cdf</font></i><font style="vertical-align: inherit;"> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><i><font style="vertical-align: inherit;">рдЖрдИрдУрд╕реА</font></i><font style="vertical-align: inherit;"> - рд╕рдВрдзрд┐рдЧрдд рдУрд▓рдВрдкрд┐рдХ рд╕рдорд┐рддрд┐ (IOC)</font></font><br>
<code>['URU', '', 'PAR', 'SUECIA', 'KUW', 'South African', '', 'Austrian', 'ISV', 'H', 'SCO', 'ES-CT', ', 'GUI', 'BOT', 'SEY', 'BIZ', 'LAB', 'PUR', ' ', 'Scotland', '', '', 'TCH', 'TGA', 'UT', 'BAH', 'GEQ', 'NEP', 'TAH', 'ica', 'FRE', 'E', 'TOG', 'MYA', '', 'Danish (Dane)', 'SAM', 'TPE', 'MON', 'ger', 'Unknown', 'sui', 'R', 'SUI', 'A', 'GRN', 'KZK', 'Wales', '', 'GBS', 'ESA', 'Bavaria', 'Czech Republic', '31/3, Colin', 'SOL', 'SKN', '', 'MGL', 'XKX', 'WLS', 'MOL', 'FIJ', 'CAY', 'ES-IB', 'BER', 'PLE', 'MRI', 'B', 'KSA', '', '', 'LAT', 'GRE', 'ARU', '', 'THI', 'NGR', 'MAD', 'SOG', 'MLD', '?????', 'AHO', 'sco', 'UAE', 'RUMANIA', 'CRO', 'RSA', 'NUEVA ZELANDA', 'KINO MANA', 'PHI', 'sue', 'Tirol"', 'IRI', 'POR', 'CZK', 'SAR', 'D', 'BRASIL', 'DCF', 'HAI', 'ned', 'N', 'BAHREIN', 'VTN', 'EU', 'CAM', 'Mark', 'BUL', 'Welsh', 'VIN', 'HON', 'ESTADOS UNIDOS', 'I', 'GUA', 'OMA', 'CRC', 'PRG', 'NIG', 'BHU', 'Joe', 'GER', 'RUN', 'ALG', '', 'Channel Islands', 'Reunion', 'REPUBLICA CHECA', 'slo', 'ANG', 'NewCaledonia', 'GUT', 'VIE', 'ASA', 'BAR', 'SRI', 'L', '', 'J', 'BAS', 'LUXEMBURGO', 'S', 'CHI', 'SNG', 'BNN', 'den', 'F.I.TRI.', 'STEEL T BG', 'NCA', 'Slovak republic', 'MAS', 'LZE', '-', 'F', 'BRU', '', 'LBA', 'NDL', 'DEN', 'IVB', 'BAN', 'Sandy', 'ZAM', 'sandy', 'Korea', 'SOO', 'BGI', '', 'LTV', 'selsmark, Alise', 'TAN', 'NED', '', 'Suchy, Jorg', 'SLO', 'SUDAFRICA', 'ZIM', 'Eddie', 'INA', '', 'SUD', 'VAN', 'FL', 'P', 'ITU', 'ZZ', 'Argentinean', 'CHA', 'DO2', 'WAL']<br>
</code><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>official name</th>
<th>short name</th>
<th>iso2</th>
<th><u>iso3</u></th>
<th><u>ioc</u></th>
</tr>
<tr>
<td>0</td>
<td>NaN</td>
<td>Taiwan</td>
<td>TW</td>
<td><u>TWN</u></td>
<td><u>TPE</u></td>
</tr>
<tr>
<td>1</td>
<td>Afghanistan</td>
<td>Afghanistan</td>
<td>AF</td>
<td><u>AFG</u></td>
<td><u>AFG</u></td>
</tr>
<tr>
<td>2</td>
<td>Albania</td>
<td>Albania</td>
<td>AL</td>
<td><u>ALB</u></td>
<td><u>ALB</u></td>
</tr>
<tr>
<td>3</td>
<td>Algeria</td>
<td>Algeria</td>
<td>DZ</td>
<td><u>DZA</u></td>
<td><u>ALG</u></td>
</tr>
<tr>
<td>4</td>
<td>American Samoa</td>
<td>American Samoa</td>
<td>AS</td>
<td><u>ASM</u></td>
<td><u>ASA</u></td>
</tr>
<tr>
<td>5</td>
<td>Andorra</td>
<td>Andorra</td>
<td>AD</td>
<td><u>AND</u></td>
<td><u>AND</u></td>
</tr>
<tr>
<td>6</td>
<td>Angola</td>
<td>Angola</td>
<td>AO</td>
<td><u>AGO</u></td>
<td><u>ANG</u></td>
</tr>
<tr>
<td>7</td>
<td>Anguilla</td>
<td>Anguilla</td>
<td>AI</td>
<td><u>AIA</u></td>
<td><u>AIA</u></td>
</tr>
<tr>
<td>8</td>
<td>Antarctica</td>
<td>Antarctica</td>
<td>AQ</td>
<td><u>ATA</u></td>
<td><u>NaN</u></td>
</tr>
<tr>
<td>9</td>
<td>Antigua and Barbuda</td>
<td>Antigua &amp; Barbuda</td>
<td>AG</td>
<td><u>ATG</u></td>
<td><u>ANT</u></td>
</tr>
<tr>
<td>10</td>
<td>Argentina</td>
<td>Argentina</td>
<td>AR</td>
<td><u>ARG</u></td>
<td><u>ARG</u></td>
</tr>
</tbody></table></div></code><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">len(([x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> tofix <span class="hljs-keyword">if</span> x.upper() <span class="hljs-keyword">in</span> list(cdf[<span class="hljs-string">'ioc'</span>])]))
</code></pre><br>
<code><b>Out:</b> 82<br>
</code><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tofix</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рд╕реЗ рддреАрди рдЕрдВрдХреЛрдВ рдХреЗ рдХреЛрдб рдХреЗ </font><i><font style="vertical-align: inherit;">рдмреАрдЪ,</font></i><font style="vertical-align: inherit;"> 82 рдЗрд╕реА </font><i><font style="vertical-align: inherit;">IOC</font></i><font style="vertical-align: inherit;"> рдкрд╛рдП </font><i><font style="vertical-align: inherit;">рдЧрдП</font></i><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рдЙрдиреНрд╣реЗрдВ рд╣рдорд╛рд░реЗ рдорд┐рд▓рд╛рди рд╢рдмреНрджрдХреЛрд╢ рдореЗрдВ рдЬреЛрдбрд╝реЗрдВред</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> icc <span class="hljs-keyword">in</span> tofix:
    <span class="hljs-keyword">if</span> icc.upper() <span class="hljs-keyword">in</span> list(cdf[<span class="hljs-string">'ioc'</span>]):<font></font>
        ind = cdf[cdf[<span class="hljs-string">'ioc'</span>] == icc.upper()].index[<span class="hljs-number">0</span>]<font></font>
        fix[icc] = cdf.loc[ind, <span class="hljs-string">'iso3'</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
108 рдХрдЪреНрдЪреЗ рдорд╛рди рдмрдЪреЗред </font><font style="vertical-align: inherit;">рд╡реЗ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ, рдХрднреА-рдХрднреА рдорджрдж рдХреЗ рд▓рд┐рдП Google рдХреА рдУрд░ рд░реБрдЦ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">
рд▓реЗрдХрд┐рди рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдореИрдиреБрдЕрд▓ рдирд┐рдпрдВрддреНрд░рдг рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">49 рдорд╛рди рдмрдиреЗ рд╣реБрдП рд╣реИрдВ рдЬрд┐рдирдХреА рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд░рдирд╛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЕрд╕рдВрднрд╡ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрдирдореЗрдВ рд╕реЗ рдЕрдзрд┐рдХрд╛рдВрд╢ рдореВрд▓реНрдп рд╕рдВрднрд╡рддрдГ рдХреЗрд╡рд▓ рдбреЗрдЯрд╛ рддреНрд░реБрдЯрд┐рдпрд╛рдВ рд╣реИрдВред</font></font><br>
<code>{'BGI': 'BRB', 'WAL': 'GBR', 'MLD': 'MDA', 'KZK': 'KAZ', 'CZK': 'CZE', 'BNN': 'BEN', 'SNG': 'SGP', 'VTN': 'VNM', 'THI': 'THA', 'PRG': 'PRT', 'MOL': 'MDA', 'FRE': 'FRA', 'F.I.TRI.': 'ITA', 'BAHREIN': 'BHR', 'SUECIA': 'SWE', 'REPUBLICA CHECA': 'CZE', 'BRASIL': 'BRA', 'NDL': 'NLD', 'Danish (Dane)': 'DNK', 'Welsh': 'GBR', 'Austrian': 'AUT', 'Argentinean': 'ARG', 'South African': 'ZAF', 'ESTADOS UNIDOS': 'USA', 'LUXEMBURGO': 'LUX', 'SUDAFRICA': 'ZAF', 'NUEVA ZELANDA': 'NZL', 'RUMANIA': 'ROU', 'sco': 'GBR', 'SCO': 'GBR', 'WLS': 'GBR', '': 'IND', '': 'IRL', '': 'ARM', '': 'BGR', '': 'SRB', ' ': 'BLR', '': 'GBR', '': 'FRA', '': 'HND', '-': 'CRI', '': 'AZE', 'Korea': 'KOR', 'NewCaledonia': 'FRA', 'Czech Republic': 'CZE', 'Slovak republic': 'SVK', 'Channel Islands': 'FRA', 'Reunion': 'FRA', 'Wales': 'GBR', 'Scotland': 'GBR', 'Bavaria': 'DEU', 'Tirol"': 'AUT', '': 'KGZ', '': 'BLR', '': 'BLR', '': 'BLR', '': 'RUS', '': 'BLR', '': 'RUS'}<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">unfixed = [x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> tofix <span class="hljs-keyword">if</span> x <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> fix.keys()]
</code></pre><br>
<code><b>Out:</b> ['', 'H', 'ES-CT', 'LAB', 'TCH', 'UT', 'TAH', 'ica', 'E', 'Unknown', 'R', 'A', '31/3, Colin', 'XKX', 'ES-IB','B','SOG','?????','KINO MANA','sue','SAR','D', 'DCF', 'N', 'EU', 'Mark', 'I', 'Joe', 'RUN', 'GUT', 'L', 'J', 'BAS', 'S', 'STEEL T BG', 'LZE', 'F', 'Sandy', 'DO2', 'sandy', 'SOO', 'LTV', 'selsmark, Alise', 'Suchy, Jorg' 'Eddie', 'FL', 'P', 'ITU', 'ZZ']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрди рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЗ рдорд┐рд▓рд╛рди рд╢рдмреНрджрдХреЛрд╢ рдореЗрдВ рдПрдХ рд░рд┐рдХреНрдд рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╣реЛрдЧреАред</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> cc <span class="hljs-keyword">in</span> unfixed:<font></font>
    fix[cc] = <span class="hljs-string">''</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдВрдд рдореЗрдВ, рд╣рдо рдореЗрд▓ рдЦрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╢рдмреНрджрдХреЛрд╢ рдХреЛрдбреЛрдВ рдХреЛ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ рдЬреЛ рдорд╛рдиреНрдп рд╣реИрдВ рд▓реЗрдХрд┐рди рдирд┐рдЪрд▓реЗ рдорд╛рдорд▓реЗ рдореЗрдВ рд▓рд┐рдЦреЗ рдЧрдП рд╣реИрдВред</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> cc <span class="hljs-keyword">in</span> valid_a3:
    <span class="hljs-keyword">if</span> cc.upper() != cc:<font></font>
        fix[cc] = cc.upper()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рдкрд╛рдпрд╛ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрдиреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХрд╛ рд╕рдордп рд╣реИред </font><font style="vertical-align: inherit;">рдЖрдЧреЗ рдХреА рддреБрд▓рдирд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдбреЗрдЯрд╛ рдХреЛ рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреЗрд╢</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЙрд▓рдо </font><font style="vertical-align: inherit;">рдХреЛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреЗрд╢ рдХреЗ рдХрдЪреНрдЪреЗ рдореЗрдВ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЙрдкреА рдХрд░реЗрдВ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдлрд┐рд░, рдмрдирд╛рдП рдЧрдП рдорд┐рд▓рд╛рди рд╢рдмреНрджрдХреЛрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рд╣рдо </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреЗрд╢</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЙрд▓рдо рдореЗрдВ рдЙрди </font><font style="vertical-align: inherit;">рдорд╛рдиреЛрдВ </font><font style="vertical-align: inherit;">рдХреЛ рд╕рд╣реА рдХрд░рддреЗ </font><font style="vertical-align: inherit;">рд╣реИрдВ </font><font style="vertical-align: inherit;">рдЬреЛ </font><font style="vertical-align: inherit;">рдЖрдИрдПрд╕рдУ рдХреЗ рдЕрдиреБрд░реВрдк рдирд╣реАрдВ рд╣реИрдВред</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> cc <span class="hljs-keyword">in</span> fix:<font></font>
    ind = ar[ar[<span class="hljs-string">'country'</span>] == cc].index<font></font>
    ar.loc[ind,<span class="hljs-string">'country'</span>] = fix[cc]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣рд╛рдВ, рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ, рдХреЛрдИ рднреА рд╡реИрд╢реНрд╡реАрдХрд░рдг рдХреЗ рдмрд┐рдирд╛ рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рд▓рдЧрднрдЧ рдбреЗрдврд╝ рдорд┐рд▓рд┐рдпрди рдкрдВрдХреНрддрд┐рдпрд╛рдВ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рд╢рдмреНрджрдХреЛрд╢ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╣рдо рдПрдХ рдЪрдХреНрд░ рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдФрд░ рдХреИрд╕реЗ? </font><font style="vertical-align: inherit;">рдЬрд╛рдБрдЪреЗрдВ рдХрд┐ рдХрд┐рддрдиреЗ рд░рд┐рдХреЙрд░реНрдб рдмрджрд▓реЗ рдЧрдП рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="python hljs">len(ar[ar[<span class="hljs-string">'country'</span>] != ar[<span class="hljs-string">'country raw'</span>]])
</code></pre><br>
<code><b>Out:</b> 315955<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╛рдиреА рдХреБрд▓ рдХрд╛ 20% рд╕реЗ рдЕрдзрд┐рдХред </font></font><br>
<br>
<pre><code class="python hljs">ar[ar[<span class="hljs-string">'country'</span>] != ar[<span class="hljs-string">'country raw'</span>]].sample(<span class="hljs-number">10</span>)
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th><u>country</u></th>
<th>group</th>
<th>place in group</th>
<th>...</th>
<th><u>country raw</u></th>
</tr>
<tr>
<td>285</td>
<td>286</td>
<td>M</td>
<td>Albaek, Mads Orla</td>
<td><u>DNK</u></td>
<td>M30-34</td>
<td>63</td>
<td>...</td>
<td><u>DEN</u></td>
</tr>
<tr>
<td>1288</td>
<td>1289</td>
<td>M</td>
<td>Benthien, Andreas</td>
<td><u>DEU</u></td>
<td>M40-44</td>
<td>198</td>
<td>...</td>
<td><u>GER</u></td>
</tr>
<tr>
<td>490</td>
<td>491</td>
<td>M</td>
<td>Lontok, Joselito</td>
<td><u>PHL</u></td>
<td>M50-54</td>
<td>18</td>
<td>...</td>
<td><u>PHI</u></td>
</tr>
<tr>
<td>145</td>
<td>146</td>
<td>M</td>
<td>Mathiasen, Keld</td>
<td><u>DNK</u></td>
<td>M45-49</td>
<td>16</td>
<td>...</td>
<td><u>DEN</u></td>
</tr>
<tr>
<td>445</td>
<td>446</td>
<td>M</td>
<td>Palm, Francois</td>
<td><u>ZAF</u></td>
<td>M25-29</td>
<td>48</td>
<td>...</td>
<td><u>RSA</u></td>
</tr>
<tr>
<td>152</td>
<td>153</td>
<td>M</td>
<td>Muller, Johannes</td>
<td><u>DEU</u></td>
<td>M35-39</td>
<td>19</td>
<td>...</td>
<td><u>GER</u></td>
</tr>
<tr>
<td>764</td>
<td>765</td>
<td>F</td>
<td>Woscher Sylvia</td>
<td><u>DEU</u></td>
<td>F55-59</td>
<td>8</td>
<td>...</td>
<td><u>GER</u></td>
</tr>
<tr>
<td>2182</td>
<td>2183</td>
<td>M</td>
<td>Kojellis, Holger</td>
<td><u>DEU</u></td>
<td>M40-44</td>
<td>258</td>
<td>...</td>
<td><u>GER</u></td>
</tr>
<tr>
<td>1293</td>
<td>1294</td>
<td>M</td>
<td>Zweer, Waldemar</td>
<td><u>DEU</u></td>
<td>M25-29</td>
<td>117</td>
<td>...</td>
<td><u>GER</u></td>
</tr>
<tr>
<td>747</td>
<td>748</td>
<td>M</td>
<td>Petersen, Mathias</td>
<td><u>DNK</u></td>
<td>M25-29</td>
<td>79</td>
<td>...</td>
<td><u>DE</u></td>
</tr>
</tbody></table></div></code><br>
<pre><code class="python hljs">len(ar[ar[<span class="hljs-string">'country'</span>] == <span class="hljs-string">''</span>])
</code></pre><br>
<code><b>Out:</b> 3221<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдПрдХ рджреЗрд╢ рдХреЗ рдмрд┐рдирд╛ рдпрд╛ рдПрдХ рдЕрдиреМрдкрдЪрд╛рд░рд┐рдХ рджреЗрд╢ рдХреЗ рд╕рд╛рде рд░рд┐рдХреЙрд░реНрдб рдХреА рд╕рдВрдЦреНрдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЕрджреНрд╡рд┐рддреАрдп рджреЗрд╢реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ 412 рд╕реЗ рдШрдЯрдХрд░ 250 рд╣реЛ рдЧрдИред рдпрд╣рд╛рдБ рд╡реЗ рд╣реИрдВ: </font><font style="vertical-align: inherit;">
рдЕрдм рдХреЛрдИ рд╡рд┐рдЪрд▓рди рдирд╣реАрдВ рд╣реИрдВред </font><i><font style="vertical-align: inherit;">рд╣рдо</font></i><font style="vertical-align: inherit;"> рдкрд░рд┐рдгрд╛рдо рдХреЛ рдПрдХ рдирдП рд╡рд┐рд╡рд░рдг </font><i><font style="vertical-align: inherit;">2.pkl</font></i><font style="vertical-align: inherit;"> рдлрд╝рд╛рдЗрд▓ рдореЗрдВ </font><i><font style="vertical-align: inherit;">рд╕рд╣реЗрдЬрддреЗ</font></i><font style="vertical-align: inherit;"> рд╣реИрдВ </font><font style="vertical-align: inherit;">, рд╕рдВрдпреБрдХреНрдд рдбреЗрдЯрд╛ рдлрд╝реНрд░реЗрдо рдХреЛ рдбреЗрдЯрд╛ рдлрд╝реНрд░реЗрдо рдХреЗ рд╢рдмреНрджрдХреЛрд╢ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред</font></font><br>
<code>['', 'ABW', 'AFG', 'AGO', 'AIA', 'ALA', 'ALB', 'AND', 'ANT', 'ARE', 'ARG', 'ARM', 'ASM', 'ATA', 'ATF', 'AUS', 'AUT', 'AZE', 'BDI', 'BEL', 'BEN', 'BES', 'BGD', 'BGR', 'BHR', 'BHS', 'BIH', 'BLM', 'BLR', 'BLZ', 'BMU', 'BOL', 'BRA', 'BRB', 'BRN', 'BTN', 'BUR', 'BVT', 'BWA', 'CAF', 'CAN', 'CCK', 'CHE', 'CHL', 'CHN', 'CIV', 'CMR', 'COD', 'COG', 'COK', 'COL', 'COM', 'CPV', 'CRI', 'CTE', 'CUB', 'CUW', 'CXR', 'CYM', 'CYP', 'CZE', 'DEU', 'DJI', 'DMA', 'DNK', 'DOM', 'DZA', 'ECU', 'EGY', 'ERI', 'ESH', 'ESP', 'EST', 'ETH', 'FIN', 'FJI', 'FLK', 'FRA', 'FRO', 'FSM', 'GAB', 'GBR', 'GEO', 'GGY', 'GHA', 'GIB', 'GIN', 'GLP', 'GMB', 'GNB', 'GNQ', 'GRC', 'GRD', 'GRL', 'GTM', 'GUF', 'GUM', 'GUY', 'HKG', 'HMD', 'HND', 'HRV', 'HTI', 'HUN', 'IDN', 'IMN', 'IND', 'IOT', 'IRL', 'IRN', 'IRQ', 'ISL', 'ISR', 'ITA', 'JAM', 'JEY', 'JOR', 'JPN', 'KAZ', 'KEN', 'KGZ', 'KHM', 'KIR', 'KNA', 'KOR', 'KWT', 'LAO', 'LBN', 'LBR', 'LBY', 'LCA', 'LIE', 'LKA', 'LTU', 'LUX', 'LVA', 'MAC', 'MAF', 'MAR', 'MCO', 'MDA', 'MDG', 'MDV', 'MEX', 'MHL', 'MKD', 'MLI', 'MLT', 'MMR', 'MNE', 'MNG', 'MNP', 'MOZ', 'MSR', 'MTQ', 'MUS', 'MYS', 'MYT', 'NAM', 'NCL', 'NER', 'NFK', 'NGA', 'NHB', 'NIC', 'NIU', 'NLD', 'NOR', 'NPL', 'NRU', 'NZL', 'OMN', 'PAK', 'PAN', 'PCN', 'PER', 'PHL', 'PLW', 'PNG', 'POL', 'PRI', 'PRK', 'PRT', 'PRY', 'PSE', 'PYF', 'QAT', 'REU', 'ROU', 'RUS', 'RWA', 'SAU', 'SCG', 'SDN', 'SEN', 'SGP', 'SGS', 'SHN', 'SJM', 'SLB', 'SLE', 'SLV', 'SMR', 'SOM', 'SPM', 'SRB', 'SSD', 'SUR', 'SVK', 'SVN', 'SWE', 'SWZ', 'SXM', 'SYC', 'SYR', 'TCA', 'TCD', 'TGO', 'THA', 'TJK', 'TKL', 'TKM', 'TLS', 'TON', 'TTO', 'TUN', 'TUR', 'TUV', 'TWN', 'TZA', 'UGA', 'UKR', 'UMI', 'URY', 'USA', 'UZB', 'VAT', 'VCT', 'VEN', 'VGB', 'VIR', 'VNM', 'VUT', 'WLF', 'WSM', 'YEM', 'YUG', 'ZAF', 'ZMB', 'ZWE']<br>
</code><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдерд╛рди</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рдпрд╛рдж рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рджреЗрд╢реЛрдВ рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рдкрд┐рд╡рдЯ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рднреА рд╣реИ, рд╕реНрддрдВрдн рдореЗрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">loc</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рдЗрд╕реЗ рдПрдХ рдорд╛рдирдХ рд░реВрдк рдореЗрдВ рд▓рд╛рдиреЗ рдХреА рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдпрд╣рд╛рдБ рдПрдХ рдЕрд▓рдЧ рдХрд╣рд╛рдиреА рд╣реИ: рди рддреЛ рдЖрдИрдПрд╕рдУ рдФрд░ рди рд╣реА рдУрд▓рдВрдкрд┐рдХ рдХреЛрдб рджрд┐рдЦрд╛рдИ рджреЗрддреЗ рд╣реИрдВред рд╕рдм рдХреБрдЫ рдХрд╛рдлреА рдореБрдХреНрдд рд░реВрдк рдореЗрдВ рд╡рд░реНрдгрд┐рдд рд╣реИред рд╢рд╣рд░, рджреЗрд╢ рдФрд░ рдкрддреЗ рдХреЗ рдЕрдиреНрдп рдШрдЯрдХреЛрдВ рдХреЛ рдЕрд▓реНрдкрд╡рд┐рд░рд╛рдо рдФрд░ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдХреНрд░рдо рдореЗрдВ рд╕реВрдЪреАрдмрджреНрдз рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдкрд╣рд▓реЗ рдореЗрдВ рдХрд╣реАрдВ, рдЖрдЦрд┐рд░реА рдореЗрдВ рдХрд╣реАрдВред рдкрд╛рдЗрдХрд╛рдЙрдВрдЯреНрд░реА рдпрд╣рд╛рдВ рдорджрдж рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ред рдФрд░ рдмрд╣реБрдд рд╕рд╛рд░реЗ рд░рд┐рдХреЙрд░реНрдб рд╣реИрдВ - 1922 рдХреА рджреМрдбрд╝ рдХреЗ рд▓рд┐рдП 525 рдЕрджреНрд╡рд┐рддреАрдп рд╕реНрдерд╛рди (рдЕрдкрдиреЗ рдореВрд▓ рд░реВрдк рдореЗрдВ)ред </font><font style="vertical-align: inherit;">
рд▓реЗрдХрд┐рди рдпрд╣рд╛рдВ рдПрдХ рдЙрдкрдпреБрдХреНрдд рдЙрдкрдХрд░рдг рдорд┐рд▓рд╛ред рдпрд╣ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">рдЬрд┐рдпреЛрдлрд╛рдИ рд╣реИ</font></a><font style="vertical-align: inherit;"> , рдЬрд┐рд╕рдХрд╛ рдирд╛рдо рд╣реИ </font><i><font style="vertical-align: inherit;">рдЬрд┐рдпреЛрд▓реЛрдХреЗрдЯрд░ </font></i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">рдиреЛрдорд┐рдирд╛рдЯреАрдо</font></a><font style="vertical-align: inherit;"> ред рдпрд╣ рдЗрд╕ рддрд░рд╣ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ:</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th>date</th>
<th><u>loc</u></th>
<th>males</th>
<th>females</th>
<th>rus</th>
<th>total</th>
<th>link</th>
</tr>
<tr>
<td>0</td>
<td>Ironman Dubai Duathlon 70.3 2020</td>
<td>2020-07-02</td>
<td><u>Dubai, United Arab Emirates</u></td>
<td>835</td>
<td>215</td>
<td>65</td>
<td>1050</td>
<td>тАж</td>
</tr>
<tr>
<td>1</td>
<td>Ironman Dubai 70.3 2020</td>
<td>2020-02-07</td>
<td><u>Dubai, United Arab Emirates</u></td>
<td>638</td>
<td>132</td>
<td>55</td>
<td>770</td>
<td>тАж</td>
</tr>
<tr>
<td>2</td>
<td>Israman Half 2020</td>
<td>2020-01-29</td>
<td><u>Israel, Eilat</u></td>
<td>670</td>
<td>126</td>
<td>4</td>
<td>796</td>
<td>тАж</td>
</tr>
<tr>
<td>3</td>
<td>Ironman Indian Wells La Quinta 70.3 2019</td>
<td>2019-12-08</td>
<td><u>Indian Wells/La Quinta, California, USA</u></td>
<td>1590</td>
<td>593</td>
<td>6</td>
<td>2183</td>
<td>тАж</td>
</tr>
<tr>
<td>4</td>
<td>Ironman Taupo 70.3 2019</td>
<td>2019-12-07</td>
<td><u>New Zealand</u></td>
<td>767</td>
<td>420</td>
<td>3</td>
<td>1187</td>
<td>тАж</td>
</tr>
<tr>
<td>5</td>
<td>Ironman Bahrain 70.3 2019</td>
<td>2019-12-07</td>
<td><u>Manama, Bahrain</u></td>
<td>858</td>
<td>214</td>
<td>38</td>
<td>1072</td>
<td>тАж</td>
</tr>
<tr>
<td>6</td>
<td>Ironman Western Australia 2019</td>
<td>2019-12-01</td>
<td><u>Busselton, Western Australia</u></td>
<td>940</td>
<td>229</td>
<td>1</td>
<td>1169</td>
<td>тАж</td>
</tr>
<tr>
<td>7</td>
<td>Ironman Mar del Plata 2019</td>
<td>2019-12-01</td>
<td><u>Mar del Plata, Argentina</u></td>
<td>506</td>
<td>66</td>
<td>3</td>
<td>572</td>
<td>тАж</td>
</tr>
<tr>
<td>8</td>
<td>Ironman Cozumel 2019</td>
<td>2019-11-24</td>
<td><u>Cozumel, Mexico</u></td>
<td>1158</td>
<td>395</td>
<td>12</td>
<td>1553</td>
<td>тАж</td>
</tr>
<tr>
<td>9</td>
<td>Ironman Arizona 2019</td>
<td>2019-11-24</td>
<td><u>Tempe, Arizona, USA</u></td>
<td>1697</td>
<td>633</td>
<td>3</td>
<td>2330</td>
<td>тАж</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> geopy.geocoders <span class="hljs-keyword">import</span> Nominatim<font></font>
<font></font>
geolocator = Nominatim(user_agent=<span class="hljs-string">'triathlon results researcher'</span>)<font></font>
geolocator.geocode(<span class="hljs-string">' , , '</span>, language=<span class="hljs-string">'en'</span>)
</code></pre><br>
<code><b>Out:</b> Location( ,  тАУ  ,  , Altaysky District, Altai Krai, Siberian Federal District, Russia, (51.78897945, 85.73956296106752, 0.0))<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдиреБрд░реЛрдз рдкрд░, рдПрдХ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рдореЗрдВ, рдпрд╣ рдПрдХ рд╕рдВрд░рдЪрд┐рдд рдЙрддреНрддрд░ рджреЗрддрд╛ рд╣реИ - рдкрддрд╛ рдФрд░ рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХред рдпрджрд┐ рдЖрдк рднрд╛рд╖рд╛ рдХреЛ, рдпрд╣рд╛рдВ - рдЕрдВрдЧреНрд░реЗрдЬреА рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рдХреНрдпрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ - рдЕрдиреБрд╡рд╛рдж рдХрд░реЗрдЧрд╛ред рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдореЗрдВ рдЖрдИрдПрд╕рдУ рдХреЛрдб рдореЗрдВ рдмрд╛рдж рдХреЗ рдЕрдиреБрд╡рд╛рдж рдХреЗ рд▓рд┐рдП рджреЗрд╢ рдХреЗ рдорд╛рдирдХ рдирд╛рдо рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдпрд╣ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрддрд╛</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдВрдкрддреНрддрд┐ рдореЗрдВ рдЕрдВрддрд┐рдо рд╕реНрдерд╛рди рд▓реЗрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред рдЪреВрдВрдХрд┐ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд┐рдпреЛрд▓реЛрдХреЗрдЯрд░</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рд░ рдмрд╛рд░ рд╕рд░реНрд╡рд░ рдХреЛ рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрддрд╛ рд╣реИ, рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рддреЗрдЬ рдирд╣реАрдВ рд╣реИ рдФрд░ 500 рд░рд┐рдХреЙрд░реНрдб рдХреЗ рд▓рд┐рдП 500 рдорд┐рдирдЯ рд▓рдЧрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдРрд╕рд╛ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдЙрддреНрддрд░ рдирд╣реАрдВ рдЖрддрд╛ рд╣реИред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдПрдХ рджреВрд╕рд░рд╛ рдЕрдиреБрд░реЛрдз рдХрднреА-рдХрднреА рдорджрдж рдХрд░рддрд╛ рд╣реИред рдореЗрд░реА рдкрд╣рд▓реА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ 130 рдЕрдиреБрд░реЛрдз рдирд╣реАрдВ рдЖрдПред рдЙрдирдореЗрдВ рд╕реЗ рдЕрдзрд┐рдХрд╛рдВрд╢ рдХреЛ рджреЛ рд░рд┐рдЯреНрд░реА рдХреЗ рд╕рд╛рде рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рд╣рд╛рд▓рд╛рдБрдХрд┐, 34 рдирд╛рдореЛрдВ рдХреЛ рдХрдИ рдЖрдЧреЗ рдХреА рд░рд┐рдЯреНрд░реАрдЬрд╝ рджреНрд╡рд╛рд░рд╛ рднреА рд╕рдВрд╕рд╛рдзрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рд╡реЗ рдпрд╣рд╛рдБ рд╣реИрдВ:</font></font><br>
<code>['Tongyeong, Korea, Korea, South', 'Constanta, Mamaia, Romania, Romania', 'Weihai, China, China', '. ,  .', 'Odaiba Marin Park, Tokyo, Japan, Japan', 'Sweden, Smaland, Kalmar', 'Cholpon-Ata city, Resort Center "Kapriz", Kyrgyzstan', 'Luxembourg, Region Moselle, Moselle', 'Chita Peninsula, Japan', 'Kraichgau Region, Germany', 'Jintang, Chengdu, Sichuan Province, China, China', 'Madrid, Spain, Spain', 'North American Pro Championship, St. George, Utah, USA', 'Milan Idroscalo Linate, Italy', 'Dexing, Jiangxi Province, China, China', 'Mooloolaba, Australia, Australia', 'Nathan Benderson Park (NBP), 5851 Nathan Benderson Circle, Sarasota, FL 34235., United States', 'Strathclyde Country Park, North Lanarkshire, Glasgow, Great Britain', 'Quijing, China', 'United States of America , Hawaii, Kohala Coast', 'Buffalo City, East London, South Africa', 'Spain, Vall de Cardener', ', .    ', 'Asian TriClub Championship, Hefei, China', 'Taizhou, Jiangsu Province, China, China', ', ,  ┬л┬╗', 'Buffalo, Gallagher Beach, Furhmann Blvd, United States', 'North American Pro Championship | St. George, Utah, USA', 'Weihai, Shandong, China, China', 'Tarzo - Revine Lago, Italy', 'Lausanee, Switzerland', 'Queenstown, New Zealand, New Zealand', 'Makuhari, Japan, Japan', 'Szombathlely, Hungary']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХрдИ рдореЗрдВ рджреЗрд╢ рдХрд╛ рджреЛрд╣рд░рд╛ рдЙрд▓реНрд▓реЗрдЦ рд╣реИ, рдФрд░ рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рдореБрдЭреЗ рдЗрди рд╢реЗрд╖ рдирд╛рдореЛрдВ рдХреЛ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдирд╛ рдерд╛ рдФрд░ рд╕рднреА рдХреЗ рд▓рд┐рдП рдорд╛рдирдХ рдкрддреЗ рдкреНрд░рд╛рдкреНрдд рд╣реБрдП рдереЗред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЗрди рдкрддреЛрдВ рд╕реЗ рдореИрдВрдиреЗ рдПрдХ рджреЗрд╢ рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рдФрд░ рдЗрд╕ рджреЗрд╢ рдХреЛ рдкрд┐рд╡рдЯ рдЯреЗрдмрд▓ рдореЗрдВ рдПрдХ рдирдП рдХреЙрд▓рдо рдореЗрдВ рд▓рд┐рдЦрд╛ред </font><font style="vertical-align: inherit;">рдЪреВрдВрдХрд┐, рдЬреИрд╕рд╛ рдХрд┐ рдореИрдВрдиреЗ рдХрд╣рд╛, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рднреВ-рднрд╛рдЧ рдХреЗ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рд╛рде рдХрд╛рдо рдХрд░рдирд╛ </font><font style="vertical-align: inherit;">рддреЗрдЬ рдирд╣реАрдВ рд╣реИ, рдореИрдВрдиреЗ рддреБрд░рдВрдд рд╕реНрдерд╛рди рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ - рдЕрдХреНрд╖рд╛рдВрд╢ рдФрд░ рджреЗрд╢рд╛рдВрддрд░ рдХреЛ рдмрдЪрд╛рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛ред </font><font style="vertical-align: inherit;">рд╡реЗ рдорд╛рдирдЪрд┐рддреНрд░ рдкрд░ рд╡рд┐рдЬрд╝реБрдЕрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдХреЗ рд▓рд┐рдП рдмрд╛рдж рдореЗрдВ рдХрд╛рдо рдЖрдПрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдЙрд╕рдХреЗ рдмрд╛рдж, </font><i><font style="vertical-align: inherit;">pyco.countries.get (name = '...')</font></i><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП </font><i><font style="vertical-align: inherit;">ред Alpha_3</font></i><font style="vertical-align: inherit;"> рдиреЗ рдирд╛рдо рд╕реЗ рджреЗрд╢ рдХреА рдЦреЛрдЬ рдХреА рдФрд░ рддреАрди рдЕрдВрдХреЛрдВ рдХреЗ рдХреЛрдб рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд┐рдпрд╛ред</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th>date</th>
<th>loc</th>
<th><u>country</u></th>
<th><u>latitude</u></th>
<th><u>longitude</u></th>
<th>...</th>
</tr>
<tr>
<td>0</td>
<td>Ironman Dubai Duathlon 70.3 2020</td>
<td>2020-07-02</td>
<td>Dubai, United Arab Emirates</td>
<td><u>United Arab Emirates</u></td>
<td><u>25.0657</u></td>
<td><u>55.1713</u></td>
<td>...</td>
</tr>
<tr>
<td>1</td>
<td>Ironman Dubai 70.3 2020</td>
<td>2020-02-07</td>
<td>Dubai, United Arab Emirates</td>
<td><u>United Arab Emirates</u></td>
<td><u>25.0657</u></td>
<td><u>55.1713</u></td>
<td>...</td>
</tr>
<tr>
<td>2</td>
<td>Israman Half 2020</td>
<td>2020-01-29</td>
<td>Israel, Eilat</td>
<td><u>Israel</u></td>
<td><u>29.5569</u></td>
<td><u>34.9498</u></td>
<td>...</td>
</tr>
<tr>
<td>3</td>
<td>Ironman Indian Wells La Quinta 70.3 2019</td>
<td>2019-12-08</td>
<td>Indian Wells/La Quinta, California, USA</td>
<td><u>United States of America</u></td>
<td><u>33.7238</u></td>
<td><u>-116.305</u></td>
<td>...</td>
</tr>
<tr>
<td>4</td>
<td>Ironman Taupo 70.3 2019</td>
<td>2019-12-07</td>
<td>New Zealand</td>
<td><u>New Zealand</u></td>
<td><u>-41.5001</u></td>
<td><u>172.834</u></td>
<td>...</td>
</tr>
<tr>
<td>5</td>
<td>Ironman Bahrain 70.3 2019</td>
<td>2019-12-07</td>
<td>Manama, Bahrain</td>
<td><u>Bahrain</u></td>
<td><u>26.2235</u></td>
<td><u>50.5822</u></td>
<td>...</td>
</tr>
<tr>
<td>6</td>
<td>Ironman Western Australia 2019</td>
<td>2019-12-01</td>
<td>Busselton, Western Australia</td>
<td><u>Australia</u></td>
<td><u>-33.6445</u></td>
<td><u>115.349</u></td>
<td>...</td>
</tr>
<tr>
<td>7</td>
<td>Ironman Mar del Plata 2019</td>
<td>2019-12-01</td>
<td>Mar del Plata, Argentina</td>
<td><u>Argentina</u></td>
<td><u>-37.9977</u></td>
<td><u>-57.5483</u></td>
<td>...</td>
</tr>
<tr>
<td>8</td>
<td>Ironman Cozumel 2019</td>
<td>2019-11-24</td>
<td>Cozumel, Mexico</td>
<td><u>Mexico</u></td>
<td><u>20.4318</u></td>
<td><u>-86.9203</u></td>
<td>...</td>
</tr>
<tr>
<td>9</td>
<td>Ironman Arizona 2019</td>
<td>2019-11-24</td>
<td>Tempe, Arizona, USA</td>
<td><u>United States of America</u></td>
<td><u>33.4255</u></td>
<td><u>-111.94</u></td>
<td>...</td>
</tr>
<tr>
<td>10</td>
<td>Ironman Xiamen 70.3 2019</td>
<td>2019-11-10</td>
<td>Xiamen, China</td>
<td><u>China</u></td>
<td><u>24.4758</u></td>
<td><u>118.075</u></td>
<td>...</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th>date</th>
<th>loc</th>
<th><u>country</u></th>
<th>latitude</th>
<th>longitude</th>
<th>...</th>
</tr>
<tr>
<td>0</td>
<td>Ironman Dubai Duathlon 70.3 2020</td>
<td>2020-07-02</td>
<td>Dubai, United Arab Emirates</td>
<td><u>ARE</u></td>
<td>25.0657</td>
<td>55.1713</td>
<td>...</td>
</tr>
<tr>
<td>1</td>
<td>Ironman Dubai 70.3 2020</td>
<td>2020-02-07</td>
<td>Dubai, United Arab Emirates</td>
<td><u>ARE</u></td>
<td>25.0657</td>
<td>55.1713</td>
<td>...</td>
</tr>
<tr>
<td>2</td>
<td>Israman Half 2020</td>
<td>2020-01-29</td>
<td>Israel, Eilat</td>
<td><u>ISR</u></td>
<td>29.5569</td>
<td>34.9498</td>
<td>...</td>
</tr>
<tr>
<td>3</td>
<td>Ironman Indian Wells La Quinta 70.3 2019</td>
<td>2019-12-08</td>
<td>Indian Wells/La Quinta, California, USA</td>
<td><u>USA</u></td>
<td>33.7238</td>
<td>-116.305</td>
<td>...</td>
</tr>
<tr>
<td>4</td>
<td>Ironman Taupo 70.3 2019</td>
<td>2019-12-07</td>
<td>New Zealand</td>
<td><u>NZL</u></td>
<td>-41.5001</td>
<td>172.834</td>
<td>...</td>
</tr>
<tr>
<td>5</td>
<td>Ironman Bahrain 70.3 2019</td>
<td>2019-12-07</td>
<td>Manama, Bahrain</td>
<td><u>BHR</u></td>
<td>26.2235</td>
<td>50.5822</td>
<td>...</td>
</tr>
<tr>
<td>6</td>
<td>Ironman Western Australia 2019</td>
<td>2019-12-01</td>
<td>Busselton, Western Australia</td>
<td><u>AUS</u></td>
<td>-33.6445</td>
<td>115.349</td>
<td>...</td>
</tr>
<tr>
<td>7</td>
<td>Ironman Mar del Plata 2019</td>
<td>2019-12-01</td>
<td>Mar del Plata, Argentina</td>
<td><u>ARG</u></td>
<td>-37.9977</td>
<td>-57.5483</td>
<td>...</td>
</tr>
<tr>
<td>8</td>
<td>Ironman Cozumel 2019</td>
<td>2019-11-24</td>
<td>Cozumel, Mexico</td>
<td><u>MEX</u></td>
<td>20.4318</td>
<td>-86.9203</td>
<td>...</td>
</tr>
<tr>
<td>9</td>
<td>Ironman Arizona 2019</td>
<td>2019-11-24</td>
<td>Tempe, Arizona, USA</td>
<td><u>USA</u></td>
<td>33.4255</td>
<td>-111.94</td>
<td>...</td>
</tr>
<tr>
<td>10</td>
<td>Ironman Xiamen 70.3 2019</td>
<td>2019-11-10</td>
<td>Xiamen, China</td>
<td><u>CHN</u></td>
<td>24.4758</td>
<td>118.075</td>
<td>...</td>
</tr>
</tbody></table></div></code><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреВрд░реА</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдХ рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХреНрд░рд┐рдпрд╛ рдЬрд┐рд╕реЗ рдкрд┐рд╡рдЯ рдЯреЗрдмрд▓ рдкрд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рд╡рд╣ рд╣реИ рдкреНрд░рддреНрдпреЗрдХ рджреМрдбрд╝ рдХреЗ рд▓рд┐рдП рджреВрд░реА рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛ред рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдЧрддрд┐ рдХреА рдЧрдгрдирд╛ рдХреЗ рд▓рд┐рдП рдпрд╣ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИред рдЯреНрд░рд╛рдпрдерд▓реЙрди рдореЗрдВ рдЪрд╛рд░ рдореБрдЦреНрдп рджреВрд░рд┐рдпрд╛рдБ рд╣реЛрддреА рд╣реИрдВ - рд╕реНрдкреНрд░рд┐рдВрдЯ, рдУрд▓рдВрдкрд┐рдХ, рд╕реЗрдореА-рдЖрдпрд░рди рдФрд░ рдЖрдпрд░рдиред рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рджреМрдбрд╝ рдХреЗ рдирд╛рдореЛрдВ рдореЗрдВ рдЖрдорддреМрд░ рдкрд░ рджреВрд░реА рдХрд╛ рд╕рдВрдХреЗрдд рд╣реЛрддрд╛ рд╣реИ - рдпреЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдкреНрд░рд┐рдВрдЯ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдУрд▓рдВрдкрд┐рдХ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рд╛рдл</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлреБрд▓</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд░реНрдб рд╣реИрдВ </font><font style="vertical-align: inherit;">ред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╡рд┐рднрд┐рдиреНрди рдЖрдпреЛрдЬрдХреЛрдВ рдХреЗ рдкрд╛рд╕ рджреВрд░рд┐рдпреЛрдВ рдХреЗ рдЕрдкрдиреЗ рдкрджрдирд╛рдо рд╣реИрдВред рдЖрдпрд░рдирдореИрди рдХрд╛ рдЖрдзрд╛, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">70.3 рдХреЗ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд░реВрдк рдореЗрдВ рдирд╛рдорд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ </font><font style="vertical-align: inherit;">- рджреВрд░реА рдореЗрдВ рдореАрд▓ рдХреА рд╕рдВрдЦреНрдпрд╛ рд╕реЗ, рдУрд▓рдВрдкрд┐рдХ - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5150</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд┐рд▓реЛрдореАрдЯрд░ рдХреА рд╕рдВрдЦреНрдпрд╛ (51.5) рд╕реЗ, рдФрд░ рд▓реЛрд╣реЗ рдХреЛ </font><i><font style="vertical-align: inherit;">рдкреВрд░реНрдг рдХреЗ</font></i><font style="vertical-align: inherit;"> рд░реВрдк рдореЗрдВ рдирд╛рдорд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╛, рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг рдХреА рдХрдореА рдХреЗ рд░реВрдк рдореЗрдВ - рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдпрд░рдирдореИрди рдПрд░рд┐рдЬрд╝реЛрдирд╛ 2019</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рдЖрдпрд░рдирдореИрди - рд╡рд╣ рд▓реЛрд╣реЗ рд╣реИ! </font><font style="vertical-align: inherit;">рдЪреБрдиреМрддреА рдореЗрдВ, рд▓реЛрд╣реЗ рдХреА рджреВрд░реА рдХреЛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рд╛рдВрдЧ рдХреЗ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд░реВрдк рдореЗрдВ рдирд╛рдорд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ </font><font style="vertical-align: inherit;">, рдФрд░ рдЕрд░реНрдз- </font><font style="vertical-align: inherit;">рд▓реЛрд╣реЗ рдХреА рджреВрд░реА </font><font style="vertical-align: inherit;">рдХреЛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдордзреНрдп рдХреЗ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд░реВрдк </font><font style="vertical-align: inherit;">рдореЗрдВ рдирд╛рдорд┐рдд </font><font style="vertical-align: inherit;">рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рд╣рдорд╛рд░реЗ рд░реВрд╕реА рдЖрдпрд░рдирд╕реНрдЯрд╛рд░ рдХрд╛ рдорддрд▓рдм </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">226 рдХреЗ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд░реВрдк рдореЗрдВ рднрд░рд╛ рд╣реБрдЖ рд╣реИ </font><font style="vertical-align: inherit;">, рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">113 рдХреЗ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд░реВрдк рдореЗрдВ рдЖрдзрд╛ </font><font style="vertical-align: inherit;">- рдХрд┐рд▓реЛрдореАрдЯрд░ рдХреА рд╕рдВрдЦреНрдпрд╛ рд╕реЗ, рд▓реЗрдХрд┐рди рдЖрдорддреМрд░ рдкрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреВрд░реНрдг</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдзреЗ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╢рдмреНрдж </font><font style="vertical-align: inherit;">рднреА рдореМрдЬреВрдж рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЕрдм рдпрд╣ рд╕рдм рдЬреНрдЮрд╛рди рд▓рд╛рдЧреВ рдХрд░реЗрдВ рдФрд░ рдирд╛рдореЛрдВ рдореЗрдВ рдореМрдЬреВрдж рдЦреЛрдЬрд╢рдмреНрджреЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╕рднреА рдЬрд╛рддрд┐рдпреЛрдВ рдХреЛ рдЪрд┐рд╣реНрдирд┐рдд рдХрд░реЗрдВред</font></font><br>
<br>
<pre><code class="python hljs">sprints = rs.loc[[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> rs.index <span class="hljs-keyword">if</span> <span class="hljs-string">'sprint'</span> <span class="hljs-keyword">in</span> rs.loc[i, <span class="hljs-string">'event'</span>].lower()]]<font></font>
olympics1 = rs.loc[[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> rs.index <span class="hljs-keyword">if</span> <span class="hljs-string">'olympic'</span> <span class="hljs-keyword">in</span> rs.loc[i, <span class="hljs-string">'event'</span>].lower()]]<font></font>
olympics2 = rs.loc[[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> rs.index <span class="hljs-keyword">if</span> <span class="hljs-string">'5150'</span> <span class="hljs-keyword">in</span> rs.loc[i, <span class="hljs-string">'event'</span>].lower()]]<font></font>
olympics = pd.concat([olympics1, olympics2])<font></font>
<span class="hljs-comment">#тАж   </span><font></font>
<font></font>
rsd = pd.concat([sprints, olympics, halfs, fulls]) <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдореЗрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрд░рдПрд╕рдбреА</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╣ рджреМрдбрд╝ рдХреА рдХреБрд▓ рд╕рдВрдЦреНрдпрд╛ рд╕реЗ 1 925 рдХреЗ рд░рд┐рдХреЙрд░реНрдб рдирд┐рдХрд▓рд╛, рдпрд╣ рд╣реИ рдХрд┐, рддреАрди рдФрд░, рдЗрд╕рд▓рд┐рдП рдХреБрдЫ рджреЛ рдорд╛рдирджрдВрдбреЛрдВ рдХреЗ рдиреАрдЪреЗ рдЧрд┐рд░ рдЧрдпрд╛ред </font><font style="vertical-align: inherit;">рдЖрдЗрдП рдЙрди рдкрд░ рдирдЬрд░ рдбрд╛рд▓рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="python hljs">rsd[rsd.duplicated(keep=<span class="hljs-literal">False</span>)][<span class="hljs-string">'event'</span>].sort_index()
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th><u>event</u></th>
<th>date</th>
<th>loc</th>
<th>country</th>
<th>latitude</th>
<th>longitude</th>
<th>...</th>
</tr>
<tr>
<td>38</td>
<td><u>Temiradam 113 Half 2019</u></td>
<td>2019-09-22</td>
<td>, </td>
<td>KAZ</td>
<td>43.6521</td>
<td>51.158</td>
<td>...</td>
</tr>
<tr>
<td>38</td>
<td><u>Temiradam 113 Half 2019</u></td>
<td>2019-09-22</td>
<td>, </td>
<td>KAZ</td>
<td>43.6521</td>
<td>51.158</td>
<td>...</td>
</tr>
<tr>
<td>65</td>
<td><u>Triway Olympic Sprint 2019</u></td>
<td>2019-09-08</td>
<td>, --</td>
<td>RUS</td>
<td>47.2214</td>
<td>39.7114</td>
<td>...</td>
</tr>
<tr>
<td>65</td>
<td><u>Triway Olympic Sprint 2019</u></td>
<td>2019-09-08</td>
<td>, --</td>
<td>RUS</td>
<td>47.2214</td>
<td>39.7114</td>
<td>...</td>
</tr>
<tr>
<td>82</td>
<td><u>Ironman Dun Laoghaire Full Swim 70.3 2019</u></td>
<td>2019-08-25</td>
<td>Ireland, Dun Laoghaire</td>
<td>IRL</td>
<td>53.2923</td>
<td>-6.13601</td>
<td>...</td>
</tr>
<tr>
<td>82</td>
<td><u>Ironman Dun Laoghaire Full Swim 70.3 2019</u></td>
<td>2019-08-25</td>
<td>Ireland, Dun Laoghaire</td>
<td>IRL</td>
<td>53.2923</td>
<td>-6.13601</td>
<td>...</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдпрд╣ рд╣реИред </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддреЗрдореАрд░рд╛рдо 113 рд╣рд╛рдл 2019</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдирд╛рдо рдХреА рдкрд╣рд▓реА рдЬреЛрдбрд╝реА рдореЗрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рд╛рдл</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">113</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджреЛрдиреЛрдВ рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдпрд╣ рд╡рд┐рд░реЛрдзрд╛рднрд╛рд╕ рдирд╣реАрдВ рд╣реИ, рдЙрдиреНрд╣реЗрдВ рджреЛрдиреЛрдВ рд╣рд┐рд╕реНрд╕реЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╣рдЪрд╛рдирд╛ рдЧрдпрд╛ред </font><font style="vertical-align: inherit;">рдЕрдЧрд▓рд╛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреНрд░рд╛рдпрд╡реЗ рдУрд▓рдВрдкрд┐рдХ рд╕реНрдкреНрд░рд┐рдВрдЯ 2019 рд╣реИ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рдЖрдк рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдпрд╣рд╛рдВ рднреНрд░рдорд┐рдд рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдУрд▓рдВрдкрд┐рдХ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдкреНрд░рд┐рдВрдЯ рд╣реИрдВ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рдЖрдк рд░реЗрд╕ рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЗ рд╕рд╛рде рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рджреЗрдЦрдХрд░ рдЗрд╕рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╕рдордп 1:09 рд╣реИред </font><font style="vertical-align: inherit;">рддреЛ рдпрд╣ рдПрдХ рд╕реНрдкреНрд░рд┐рдВрдЯ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреЛ рдУрд▓рдВрдкрд┐рдХ рд╕реВрдЪреА рд╕реЗ рд╣рдЯрд╛ рджреЗрдВред</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>place in group</th>
<th>swim</th>
<th>t1</th>
<th>bike</th>
<th>t2</th>
<th>run</th>
<th><u>result</u></th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td> </td>
<td>RUS</td>
<td>M</td>
<td>1</td>
<td>00:12:21</td>
<td>00:00:31</td>
<td>00:34:13</td>
<td>00:00:25</td>
<td>00:21:49</td>
<td><u>01:09:19</u></td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td> </td>
<td>RUS</td>
<td>M</td>
<td>2</td>
<td>00:12:21</td>
<td>00:00:28</td>
<td>00:34:15</td>
<td>00:00:26</td>
<td>00:23:07</td>
<td><u>01:10:38</u></td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td> </td>
<td>RUS</td>
<td>M</td>
<td>3</td>
<td>00:14:20</td>
<td>00:00:37</td>
<td>00:35:48</td>
<td>00:00:34</td>
<td>00:22:16</td>
<td><u>01:13:35</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">olympics.drop(<span class="hljs-number">65</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдпрд░рдирдореИрди рдбреБрди рд▓рд╛рдШреИрдпрд░ рдлреБрд▓ рд╕реНрд╡рд┐рдо 70.3 2019</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЛ рдЗрдВрдЯрд░рд╕реЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд╕рд╛рде рд╣реА рдХрд░реЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдВ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╕рдордп 4:00 рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рдЖрдзреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╣реИред </font><i><font style="vertical-align: inherit;">рдлреБрд▓</font></i><font style="vertical-align: inherit;"> рд╕реЗ рдЗрдВрдбреЗрдХреНрд╕ 85 рдХреЗ рд╕рд╛рде рд░рд┐рдХреЙрд░реНрдб рд╣рдЯрд╛рдПрдВ </font><font style="vertical-align: inherit;">ред</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>place in group</th>
<th>swim</th>
<th>t1</th>
<th>bike</th>
<th>t2</th>
<th>run</th>
<th><u>result</u></th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td>Brownlee, Alistair</td>
<td>GBR</td>
<td>MPRO</td>
<td>1</td>
<td>00:23:19</td>
<td>00:02:18</td>
<td>02:21:19</td>
<td>00:01:55</td>
<td>01:11:42</td>
<td><u>04:00:33</u></td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td>Smales, Elliot</td>
<td>GBR</td>
<td>MPRO</td>
<td>2</td>
<td>00:24:47</td>
<td>00:02:09</td>
<td>02:29:26</td>
<td>00:01:48</td>
<td>01:12:47</td>
<td><u>04:10:57</u></td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td>Bowden, Adam</td>
<td>GBR</td>
<td>MPRO</td>
<td>3</td>
<td>00:23:24</td>
<td>00:02:18</td>
<td>02:32:09</td>
<td>00:02:06</td>
<td>01:13:49</td>
<td><u>04:13:46</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">fulls.drop(<span class="hljs-number">85</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╣рдо рдореБрдЦреНрдп рдбреЗрдЯрд╛ рдлреНрд░реЗрдо рдореЗрдВ рджреВрд░реА рдХреА рдЬрд╛рдирдХрд╛рд░реА рд▓рд┐рдЦреЗрдВрдЧреЗ рдФрд░ рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ рдХреНрдпрд╛ рд╣реБрдЖ:</font></font><br>
<br>
<pre><code class="python hljs">rs[<span class="hljs-string">'dist'</span>] = <span class="hljs-string">''</span><font></font>
<font></font>
rs.loc[sprints.index,<span class="hljs-string">'dist'</span>] = <span class="hljs-string">'sprint'</span>
rs.loc[olympics.index,<span class="hljs-string">'dist'</span>] = <span class="hljs-string">'olympic'</span>
rs.loc[halfs.index,<span class="hljs-string">'dist'</span>] = <span class="hljs-string">'half'</span>
rs.loc[fulls.index,<span class="hljs-string">'dist'</span>] = <span class="hljs-string">'full'</span><font></font>
<font></font>
rs.sample(<span class="hljs-number">10</span>)
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th><u>group</u></th>
<th>place in group</th>
<th>...</th>
<th>country raw</th>
<th><u>group raw</u></th>
</tr>
<tr>
<td>...</td>
<td>566</td>
<td>M</td>
<td>Vladimir Kozar</td>
<td>SVK</td>
<td><u>M40-44</u></td>
<td>8</td>
<td>...</td>
<td>SVK</td>
<td><u>MOpen 40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>8</td>
<td>M</td>
<td>HANNES COOL</td>
<td>BEL</td>
<td><u>MPRO</u></td>
<td>11</td>
<td>...</td>
<td>BEL</td>
<td><u>MPRO M</u></td>
</tr>
<tr>
<td>...</td>
<td>445</td>
<td>F</td>
<td>Ileana Sodani</td>
<td>USA</td>
<td><u>F45-49</u></td>
<td>4</td>
<td>...</td>
<td>USA</td>
<td><u>F45-49 F</u></td>
</tr>
<tr>
<td>...</td>
<td>227</td>
<td>F</td>
<td>JARLINSKA Bozena</td>
<td>POL</td>
<td><u>F45-49</u></td>
<td>2</td>
<td>...</td>
<td>POL</td>
<td><u>FK45-49</u></td>
</tr>
<tr>
<td>...</td>
<td>440</td>
<td>F</td>
<td>Celine Orrigoni</td>
<td>FRA</td>
<td><u>F40-44</u></td>
<td>6</td>
<td>...</td>
<td>FRA</td>
<td><u>F40-44 F</u></td>
</tr>
<tr>
<td>...</td>
<td>325</td>
<td>M</td>
<td>Vladimir Eckert</td>
<td>SVK</td>
<td><u>M40-44</u></td>
<td>6</td>
<td>...</td>
<td>SVK</td>
<td><u>MOpen 40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>139</td>
<td>F</td>
<td>ATRASZKIEWICZ Magda</td>
<td>POL</td>
<td><u>F40-44</u></td>
<td>2</td>
<td>...</td>
<td>POL</td>
<td><u>FK40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>18</td>
<td>M</td>
<td>Marijn de Jonge</td>
<td>NLD</td>
<td><u>MPRO</u></td>
<td>18</td>
<td>...</td>
<td>NED</td>
<td><u>Mpro</u></td>
</tr>
<tr>
<td>...</td>
<td>574</td>
<td>M</td>
<td>Luca Andalo</td>
<td>ITA</td>
<td><u>M40-44</u></td>
<td>9</td>
<td>...</td>
<td>ITA</td>
<td><u>MOpen 40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>67</td>
<td>M</td>
<td>URBANKIEWICZ Aleksandra</td>
<td>POL</td>
<td><u>M35-39</u></td>
<td>1</td>
<td>...</td>
<td>POL</td>
<td><u>MK35-39</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд╛рдБрдЪ рдХрд░реЗрдВ рдХрд┐ рдХреЛрдИ рдЦреБрд▓реА рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ рдирд╣реАрдВ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="python hljs">len(rs[rs[<span class="hljs-string">'dist'</span>] == <span class="hljs-string">''</span>])
</code></pre><br>
<code><b>Out:</b> 0<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ рд╣рдорд╛рд░реЗ рд╕рдорд╕реНрдпрд╛рдЧреНрд░рд╕реНрдд, рдЕрд╕реНрдкрд╖реНрдЯ рд▓реЛрдЧреЛрдВ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ:</font></font><br>
<br>
<pre><code class="python hljs">rs.loc[[<span class="hljs-number">38</span>,<span class="hljs-number">65</span>,<span class="hljs-number">82</span>],[<span class="hljs-string">'event'</span>,<span class="hljs-string">'dist'</span>]]
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th><u>dist</u></th>
</tr>
<tr>
<td>38</td>
<td>Temiradam 113 Half 2019</td>
<td><u>half</u></td>
</tr>
<tr>
<td>65</td>
<td>Triway Olympic Sprint 2019</td>
<td><u>sprint</u></td>
</tr>
<tr>
<td>82</td>
<td>Ironman Dun Laoghaire Full Swim 70.3 2019</td>
<td><u>half</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдм рдХреБрдЫ рдареАрдХ рд╣реИред </font><font style="vertical-align: inherit;">рдПрдХ рдирдИ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕рд╣реЗрдЬреЗрдВ:</font></font><br>
<br>
<pre><code class="python hljs">pkl.dump(rs, open(<span class="hljs-string">r'D:\tri\summary5.pkl'</span>, <span class="hljs-string">'wb'</span>))
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдпреБ рд╕рдореВрд╣</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╡рд╛рдкрд╕ рд░реЗрд╕рд┐рдВрдЧ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкрд░ рдЬрд╛рдПрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдкреНрд░рддрд┐рднрд╛рдЧреА рдХреЗ рд▓рд┐рдВрдЧ, рджреЗрд╢ рдФрд░ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд┐рдпрд╛ рд╣реИ, рдФрд░ рдЙрдиреНрд╣реЗрдВ рдПрдХ рдорд╛рдирдХ рд░реВрдк рдореЗрдВ рд▓рд╛рдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рджреЛ рдФрд░ рдХреЙрд▓рдо рдмрдиреЗ рд░рд╣реЗ - рд╕рдореВрд╣ рдФрд░ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдирд╛рдо рд╣реАред </font><font style="vertical-align: inherit;">рд╕рдореВрд╣реЛрдВ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЯреНрд░рд╛рдпрдерд▓реЙрди рдореЗрдВ, рдкреНрд░рддрд┐рднрд╛рдЧрд┐рдпреЛрдВ рдХреЛ рдЖрдпреБ рд╕рдореВрд╣реЛрдВ рджреНрд╡рд╛рд░рд╛ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рдиреЗ рдХреА рдкреНрд░рдерд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдкреЗрд╢реЗрд╡рд░реЛрдВ рдХрд╛ рдПрдХ рд╕рдореВрд╣ рднреА рдЕрдХреНрд╕рд░ рдмрд╛рд╣рд░ рдЦрдбрд╝рд╛ рд╣реЛрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдСрдлрд╕реЗрдЯ рдкреНрд░рддреНрдпреЗрдХ рдРрд╕реЗ рд╕рдореВрд╣ рдореЗрдВ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╣реИ - рдкреНрд░рддреНрдпреЗрдХ рд╕рдореВрд╣ рдореЗрдВ рдкрд╣рд▓реЗ рддреАрди рд╕реНрдерд╛рдиреЛрдВ рд╕реЗ рд╕рдореНрдорд╛рдирд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╕рдореВрд╣реЛрдВ рдореЗрдВ, рдпреЛрдЧреНрдпрддрд╛ рдХреЗ рд▓рд┐рдП рдЪреИрдВрдкрд┐рдпрдирд╢рд┐рдк рдХреЗ рд▓рд┐рдП рдЪрдпрди рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдХреЛрдиреБ рдкрд░ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рднреА рд░рд┐рдХреЙрд░реНрдбреЛрдВ рдХреЛ рдорд┐рд▓рд╛рдПрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдЖрдо рддреМрд░ рдкрд░ рдХреМрди рд╕реЗ рд╕рдореВрд╣ рдореМрдЬреВрдж рд╣реИрдВред</font></font><br>
<br>
<pre><code class="python hljs">rd = pkl.load(open(<span class="hljs-string">r'D:\tri\details2.pkl'</span>, <span class="hljs-string">'rb'</span>))<font></font>
ar = pd.concat(rd)<font></font>
ar[<span class="hljs-string">'group'</span>].unique()
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рдХрд┐ рд╕рдореВрд╣реЛрдВ рдХреА рдПрдХ рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдереА - 581ред рд╕реМ рдмреЗрддрд░рддреАрдм рдврдВрдЧ рд╕реЗ рдЪрдпрдирд┐рдд рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ: </font><font style="vertical-align: inherit;">
рдЪрд▓реЛ рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдЙрдирдореЗрдВ рд╕реЗ рдХреМрди рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╣реИрдВ:</font></font><br>
<code>['MSenior', 'FAmat.', 'M20', 'M65-59', 'F25-29', 'F18-22', 'M75-59', 'MPro', 'F24', 'MCORP M', 'F21-30', 'MSenior 4', 'M40-50', 'FAWAD', 'M16-29', 'MK40-49', 'F65-70', 'F65-70', 'M12-15', 'MK18-29', 'M50up', 'FSEMIFINAL 2 PRO', 'F16', 'MWhite', 'MOpen 25-29', 'F', 'MPT TRI-2', 'M16-24', 'FQUALIFIER 1 PRO', 'F15-17', 'FSEMIFINAL 2 JUNIOR', 'FOpen 60-64', 'M75-80', 'F60-69', 'FJUNIOR A', 'F17-18', 'FAWAD BLIND', 'M75-79', 'M18-29', 'MJUN19-23', 'M60-up', 'M70', 'MPTS5', 'F35-40', "M'S PT1", 'M50-54', 'F65-69', 'F17-20', 'MP4', 'M16-29', 'F18up', 'MJU', 'MPT4', 'MPT TRI-3', 'MU24-39', 'MK35-39', 'F18-20', "M'S", 'F50-55', 'M75-80', 'MXTRI', 'F40-45', 'MJUNIOR B', 'F15', 'F18-19', 'M20-29', 'MAWAD PC4', 'M30-37', 'F21-30', 'Mpro', 'MSEMIFINAL 1 JUNIOR', 'M25-34', 'MAmat.', 'FAWAD PC5', 'FA', 'F50-60', 'FSenior 1', 'M80-84', 'FK45-49', 'F75-79', 'M&lt;23', 'MPTS3', 'M70-75', 'M50-60', 'FQUALIFIER 3 PRO', 'M9', 'F31-40', 'MJUN16-19', 'F18-19', 'M PARA', 'F35-44', 'MParaathlete', 'F18-34', 'FA', 'FAWAD PC2', 'FAll Ages', 'M PARA', 'F31-40', 'MM85', 'M25-39']<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'group'</span>].value_counts()[:<span class="hljs-number">30</span>]
</code></pre><br>
<code><b>Out:</b><br>
M40-44 199157<br>
M35-39 183738<br>
M45-49 166796<br>
M30-34 154732<br>
M50-54 107307<br>
M25-29 88980<br>
M55-59 50659<br>
F40-44 48036<br>
F35-39 47414<br>
F30-34 45838<br>
F45-49 39618<br>
MPRO 38445<br>
F25-29 31718<br>
F50-54 26253<br>
M18-24 24534<br>
FPRO 23810<br>
M60-64 20773<br>
M 12799<br>
F55-59 12470<br>
M65-69 8039<br>
F18-24 7772<br>
MJUNIOR 6605<br>
F60-64 5067<br>
M20-24 4580<br>
FJUNIOR 4105<br>
M30-39 3964<br>
M40-49 3319<br>
F 3306<br>
M70-74 3072<br>
F20-24 2522<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдкрдХреЛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдЗрди рдкрд╛рдВрдЪ рд╡рд░реНрд╖реЛрдВ рдХреЗ рд╕рдореВрд╣реЛрдВ, рдЕрд▓рдЧ рд╕реЗ рдкреБрд░реБрд╖реЛрдВ рдХреЗ рд▓рд┐рдП рдФрд░ рдЕрд▓рдЧ рд╕реЗ рдорд╣рд┐рд▓рд╛рдУрдВ рдХреЗ рд▓рд┐рдП, рд╕рд╛рде рд╣реА рдкреЗрд╢реЗрд╡рд░ рд╕рдореВрд╣ рд╣реИрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MPRO</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FPRO</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рддреЛ рд╣рдорд╛рд░рд╛ рдорд╛рдирдХ рд╣реЛрдЧрд╛:</font></font><br>
<br>
<pre><code class="python hljs">ag = [<span class="hljs-string">'MPRO'</span>, <span class="hljs-string">'M18-24'</span>, <span class="hljs-string">'M25-29'</span>, <span class="hljs-string">'M30-34'</span>, <span class="hljs-string">'M35-39'</span>, <span class="hljs-string">'M40-44'</span>, <span class="hljs-string">'M45-49'</span>, <span class="hljs-string">'M50-54'</span>, <span class="hljs-string">'M55-59'</span>, <span class="hljs-string">'M60-64'</span>,  <span class="hljs-string">'M65-69'</span>, <span class="hljs-string">'M70-74'</span>, <span class="hljs-string">'M75-79'</span>, <span class="hljs-string">'M80-84'</span>, <span class="hljs-string">'M85-90'</span>, <span class="hljs-string">'FPRO'</span>, <span class="hljs-string">'F18-24'</span>, <span class="hljs-string">'F25-29'</span>, <span class="hljs-string">'F30-34'</span>, <span class="hljs-string">'F35-39'</span>, <span class="hljs-string">'F40-44'</span>,   <span class="hljs-string">'F45-49'</span>, <span class="hljs-string">'F50-54'</span>, <span class="hljs-string">'F55-59'</span>, <span class="hljs-string">'F60-64'</span>, <span class="hljs-string">'F65-69'</span>, <span class="hljs-string">'F70-74'</span>, <span class="hljs-string">'F75-79'</span>, <span class="hljs-string">'F80-84'</span>, <span class="hljs-string">'F85-90'</span>]
<span class="hljs-comment">#ag тАУ age group</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рд╕реЗрдЯ рд▓рдЧрднрдЧ 95% рд╕рднреА рдлрд╝рд┐рдирд┐рд╢рд░реНрд╕ рдХреЛ рдХрд╡рд░ рдХрд░рддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдмреЗрд╢рдХ, рд╣рдо рд╕рднреА рд╕рдореВрд╣реЛрдВ рдХреЛ рдЗрд╕ рдорд╛рдирдХ рдкрд░ рдирд╣реАрдВ рд▓рд╛ рдкрд╛рдПрдВрдЧреЗред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рд╣рдо рдЙрди рд▓реЛрдЧреЛрдВ рдХреА рддрд▓рд╛рд╢ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдЙрдирдХреЗ рд╕рдорд╛рди рд╣реИрдВ рдФрд░ рдХрдо рд╕реЗ рдХрдо рдПрдХ рд╣рд┐рд╕реНрд╕рд╛ рджреЗрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рдЕрдкрд░рдХреЗрд╕ рдХреЛ рд▓рд╛рдПрдВрдЧреЗ рдФрд░ рд░рд┐рдХреНрдд рд╕реНрдерд╛рди рд╣рдЯрд╛рдПрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдБ рдХреНрдпрд╛ рд╣реБрдЖ: </font><font style="vertical-align: inherit;">
рдЙрдиреНрд╣реЗрдВ рд╣рдорд╛рд░реЗ рдорд╛рдирдХ рдореЗрдВ рдмрджрд▓реЗрдВред</font></font><br>
<code>['F25-29F', 'F30-34F', 'F30-34-34', 'F35-39F', 'F40-44F', 'F45-49F', 'F50-54F', 'F55-59F', 'FAG:FPRO', 'FK30-34', 'FK35-39', 'FK40-44', 'FK45-49', 'FOPEN50-54', 'FOPEN60-64', 'MAG:MPRO', 'MK30-34', 'MK30-39', 'MK35-39', 'MK40-44', 'MK40-49', 'MK50-59', 'M40-44', 'MM85-89', 'MOPEN25-29', 'MOPEN30-34', 'MOPEN35-39', 'MOPEN40-44', 'MOPEN45-49', 'MOPEN50-54', 'MOPEN70-74', 'MPRO:', 'MPROM', 'M0-44"']<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">fix = { <span class="hljs-string">'F25-29F'</span>: <span class="hljs-string">'F25-29'</span>, <span class="hljs-string">'F30-34F'</span> : <span class="hljs-string">'F30-34'</span>, <span class="hljs-string">'F30-34-34'</span>: <span class="hljs-string">'F30-34'</span>, <span class="hljs-string">'F35-39F'</span>: <span class="hljs-string">'F35-39'</span>, <span class="hljs-string">'F40-44F'</span>: <span class="hljs-string">'F40-44'</span>, <span class="hljs-string">'F45-49F'</span>: <span class="hljs-string">'F45-49'</span>, <span class="hljs-string">'F50-54F'</span>: <span class="hljs-string">'F50-54'</span>, <span class="hljs-string">'F55-59F'</span>: <span class="hljs-string">'F55-59'</span>, <span class="hljs-string">'FAG:FPRO'</span>: <span class="hljs-string">'FPRO'</span>, <span class="hljs-string">'FK30-34'</span>: <span class="hljs-string">'F30-34'</span>,      <span class="hljs-string">'FK35-39'</span>: <span class="hljs-string">'F35-39'</span>, <span class="hljs-string">'FK40-44'</span>: <span class="hljs-string">'F40-44'</span>, <span class="hljs-string">'FK45-49'</span>: <span class="hljs-string">'F45-49'</span>, <span class="hljs-string">'FOPEN50-54'</span>: <span class="hljs-string">'F50-54'</span>, <span class="hljs-string">'FOPEN60-64'</span>: <span class="hljs-string">'F60-64'</span>, <span class="hljs-string">'MAG:MPRO'</span>: <span class="hljs-string">'MPRO'</span>, <span class="hljs-string">'MK30-34'</span>: <span class="hljs-string">'M30-34'</span>, <span class="hljs-string">'MK30-39'</span>: <span class="hljs-string">'M30-39'</span>, <span class="hljs-string">'MK35-39'</span>: <span class="hljs-string">'M35-39'</span>, <span class="hljs-string">'MK40-44'</span>: <span class="hljs-string">'M40-44'</span>, <span class="hljs-string">'MK40-49'</span>: <span class="hljs-string">'M40-49'</span>, <span class="hljs-string">'MK50-59'</span>: <span class="hljs-string">'M50-59'</span>, <span class="hljs-string">'M40-44'</span>: <span class="hljs-string">'M40-44'</span>, <span class="hljs-string">'MM85-89'</span>: <span class="hljs-string">'M85-89'</span>, <span class="hljs-string">'MOPEN25-29'</span>: <span class="hljs-string">'M25-29'</span>, <span class="hljs-string">'MOPEN30-34'</span>: <span class="hljs-string">'M30-34'</span>, <span class="hljs-string">'MOPEN35-39'</span>: <span class="hljs-string">'M35-39'</span>, <span class="hljs-string">'MOPEN40-44'</span>: <span class="hljs-string">'M40-44'</span>, <span class="hljs-string">'MOPEN45-49'</span>: <span class="hljs-string">'M45-49'</span>, <span class="hljs-string">'MOPEN50-54'</span>: <span class="hljs-string">'M50-54'</span>, <span class="hljs-string">'MOPEN70-74'</span>: <span class="hljs-string">'M70- 74'</span>, <span class="hljs-string">'MPRO:'</span> :<span class="hljs-string">'MPRO'</span>, <span class="hljs-string">'MPROM'</span>: <span class="hljs-string">'MPRO'</span>, <span class="hljs-string">'M0-44"'</span> : <span class="hljs-string">'M40-44'</span>}
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╣рдо рдЕрдкрдиреЗ рдкрд░рд┐рд╡рд░реНрддрди рдХреЛ рдореБрдЦреНрдп рдбреЗрдЯрд╛ рдлрд╝реНрд░реЗрдо </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ar рдкрд░</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">, рд▓реЗрдХрд┐рди рдкрд╣рд▓реЗ </font><font style="vertical-align: inherit;">рдирдП </font><i><font style="vertical-align: inherit;">рд╕рдореВрд╣ рдХреЗ рдХрдЪреНрдЪреЗ</font></i><font style="vertical-align: inherit;"> рдХреЙрд▓рдо </font><font style="vertical-align: inherit;">рдореЗрдВ рдореВрд▓ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдореВрд╣</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдорд╛рдиреЛрдВ </font><font style="vertical-align: inherit;">рдХреЛ </font><font style="vertical-align: inherit;">рд╕рд╣реЗрдЬрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'group raw'</span>] = ar[<span class="hljs-string">'group'</span>]
</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдореВрд╣</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рдХреЙрд▓рдо рдореЗрдВ, </font><font style="vertical-align: inherit;">рд╣рдо рдХреЗрд╡рд▓ рдЙрди рдорд╛рдиреЛрдВ рдХреЛ рдЫреЛрдбрд╝рддреЗ рд╣реИрдВ рдЬреЛ рд╣рдорд╛рд░реЗ рдорд╛рдирдХ рдХрд╛ рдЕрдиреБрдкрд╛рд▓рди рдХрд░рддреЗ рд╣реИрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╣рдо рдЕрдкрдиреЗ рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреА рд╕рд░рд╛рд╣рдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="python hljs">len(ar[(ar[<span class="hljs-string">'group'</span>] != ar[<span class="hljs-string">'group raw'</span>])&amp;(ar[<span class="hljs-string">'group'</span>]!=<span class="hljs-string">''</span>)])
</code></pre><br>
<code><b>Out:</b> 273<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдбреЗрдврд╝ рд▓рд╛рдЦ рдХреЗ рд╕реНрддрд░ рдкрд░ рдмрд╕ рдереЛрдбрд╝рд╛ рд╕рд╛ред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдЬрдм рддрдХ рдЖрдк рдХреЛрд╢рд┐рд╢ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗ рддрдм рддрдХ рдЖрдкрдХреЛ рдкрддрд╛ рдирд╣реАрдВ рдЪрд▓реЗрдЧрд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЪрдпрдирд┐рдд 10 рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддреЗ рд╣реИрдВ: </font><font style="vertical-align: inherit;">рдбреЗрдЯрд╛ рдлреНрд░реЗрдо рдХреЗ рдирдП рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рд╕рд╣реЗрдЬреЗрдВ, рдЗрд╕реЗ </font><i><font style="vertical-align: inherit;">рдЖрд░рдбреА</font></i><font style="vertical-align: inherit;"> рд╢рдмреНрджрдХреЛрд╢ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж </font><font style="vertical-align: inherit;">ред</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th><u>group</u></th>
<th>place in group</th>
<th>...</th>
<th>country raw</th>
<th><u>group raw</u></th>
</tr>
<tr>
<td>...</td>
<td>566</td>
<td>M</td>
<td>Vladimir Kozar</td>
<td>SVK</td>
<td><u>M40-44</u></td>
<td>8</td>
<td>...</td>
<td>SVK</td>
<td><u>MOpen 40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>8</td>
<td>M</td>
<td>HANNES COOL</td>
<td>BEL</td>
<td><u>MPRO</u></td>
<td>11</td>
<td>...</td>
<td>BEL</td>
<td><u>MPRO M</u></td>
</tr>
<tr>
<td>...</td>
<td>445</td>
<td>F</td>
<td>Ileana Sodani</td>
<td>USA</td>
<td><u>F45-49</u></td>
<td>4</td>
<td>...</td>
<td>USA</td>
<td><u>F45-49 F</u></td>
</tr>
<tr>
<td>...</td>
<td>227</td>
<td>F</td>
<td>JARLINSKA Bozena</td>
<td>POL</td>
<td><u>F45-49</u></td>
<td>2</td>
<td>...</td>
<td>POL</td>
<td><u>FK45-49</u></td>
</tr>
<tr>
<td>...</td>
<td>440</td>
<td>F</td>
<td>Celine Orrigoni</td>
<td>FRA</td>
<td><u>F40-44</u></td>
<td>6</td>
<td>...</td>
<td>FRA</td>
<td><u>F40-44 F</u></td>
</tr>
<tr>
<td>...</td>
<td>325</td>
<td>M</td>
<td>Vladimir Eckert</td>
<td>SVK</td>
<td><u>M40-44</u></td>
<td>6</td>
<td>...</td>
<td>SVK</td>
<td><u>MOpen 40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>139</td>
<td>F</td>
<td>ATRASZKIEWICZ Magda</td>
<td>POL</td>
<td><u>F40-44</u></td>
<td>2</td>
<td>...</td>
<td>POL</td>
<td><u>FK40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>18</td>
<td>M</td>
<td>Marijn de Jonge</td>
<td>NLD</td>
<td><u>MPRO</u></td>
<td>18</td>
<td>...</td>
<td>NED</td>
<td><u>Mpro</u></td>
</tr>
<tr>
<td>...</td>
<td>574</td>
<td>M</td>
<td>Luca Andalo</td>
<td>ITA</td>
<td><u>M40-44</u></td>
<td>9</td>
<td>...</td>
<td>ITA</td>
<td><u>MOpen 40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>67</td>
<td>M</td>
<td>URBANKIEWICZ Aleksandra</td>
<td>POL</td>
<td><u>M35-39</u></td>
<td>1</td>
<td>...</td>
<td>POL</td>
<td><u>MK35-39</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">pkl.dump(rd, open(<span class="hljs-string">r'D:\tri\details3.pkl'</span>, <span class="hljs-string">'wb'</span>))</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд╛рдо</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рдЖрдЗрдП рдирд╛рдореЛрдВ рдХрд╛ рдЦреНрдпрд╛рд▓ рд░рдЦреЗрдВред </font><font style="vertical-align: inherit;">рдЖрдЗрдП рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЬрд╛рддрд┐рдпреЛрдВ рд╕реЗ рдЪреБрдирд┐рдВрджрд╛ 100 рдирд╛рдо рджреЗрдЦреЗрдВ:</font></font><br>
<br>
<pre><code class="python hljs">list(ar[<span class="hljs-string">'name'</span>].sample(<span class="hljs-number">100</span>))
</code></pre><br>
<code><b>Out: </b>['Case, Christine', 'Van der westhuizen, Wouter', 'Grace, Scott', 'Sader, Markus', 'Schuller, Gunnar', 'Juul-Andersen, Jeppe', 'Nelson, Matthew', '  ', 'Westman, Pehr', 'Becker, Christoph', 'Bolton, Jarrad', 'Coto, Ricardo', 'Davies, Luke', 'Daniltchev, Alexandre', 'Escobar Labastida, Emmanuelle', 'Idzikowski, Jacek', 'Fairaislova Iveta', 'Fisher, Kulani', 'Didenko, Viktor', 'Osborne, Jane', 'Kadralinov, Zhalgas', 'Perkins, Chad', 'Caddell, Martha', 'Lynaire PARISH', 'Busing, Lynn', 'Nikitin, Evgeny', 'ANSON MONZON, ROBERTO', 'Kaub, Bernd', 'Bank, Morten', 'Kennedy, Ian', 'Kahl, Stephen', 'Vossough, Andreas', 'Gale, Karen', 'Mullally, Kristin', 'Alex FRASER', 'Dierkes, Manuela', 'Gillett, David', 'Green, Erica', 'Cunnew, Elliott', 'Sukk, Gaspar', 'Markina Veronika', 'Thomas KVARICS', 'Wu, Lewen', 'Van Enk, W.J.J', 'Escobar, Rosario', 'Healey, Pat', 'Scheef, Heike', 'Ancheta, Marlon', 'Heck, Andreas', 'Vargas Iii, Raul', 'Seferoglou, Maria', 'chris GUZMAN', 'Casey, Timothy', 'Olshanikov Konstantin', 'Rasmus Nerrand', 'Lehmann Bence', 'Amacker, Kirby', 'Parks, Chris', 'Tom, Troy', 'Karlsson, Ulf', 'Halfkann, Dorothee', 'Szabo, Gergely', 'Antipov Mikhail', 'Von Alvensleben, Alvo', 'Gruber, Peter', 'Leblanc, Jean-Philippe', 'Bouchard, Jean-Francois', 'Marchiotto MASSIMO', 'Green, Molly', 'Alder, Christoph', 'Morris, Huw', 'Deceur, Marc', 'Queenan, Derek', 'Krause, Carolin', 'Cockings, Antony', 'Ziehmer Chris', 'Stiene, John', 'Chmet Daniela', 'Chris RIORDAN', 'Wintle, Mel', ' ', 'GASPARINI CHRISTIAN', 'Westbrook, Christohper', 'Martens, Wim', 'Papson, Chris', 'Burdess, Shaun', 'Proctor, Shane', 'Cruzinha, Pedro', 'Hamard, Jacques', 'Petersen, Brett', 'Sahyoun, Sebastien', "O'Connell, Keith", 'Symoshenko, Zhan', 'Luternauer, Jan', 'Coronado, Basil', 'Smith, Alex', 'Dittberner, Felix', 'N?sman, Henrik', 'King, Malisa', 'PUHLMANN Andre']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдЬрдЯрд┐рд▓ рд╣реИред рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╣рд▓рд╛ рдирд╛рдо рдЕрдВрддрд┐рдо рдирд╛рдо, рдЕрдВрддрд┐рдо рдирд╛рдо рдкрд╣рд▓рд╛ рдирд╛рдо, рдЕрдВрддрд┐рдо рдирд╛рдо, рдкрд╣рд▓рд╛ рдирд╛рдо, рдЕрдВрддрд┐рдо рдирд╛рдо, рдкрд╣рд▓рд╛ рдирд╛рдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдЖрджрд┐ред рдпрд╣ рдПрдХ рдЕрд▓рдЧ рдХреНрд░рдо рд╣реИ, рдПрдХ рдЕрд▓рдЧ рд░рдЬрд┐рд╕реНрдЯрд░, рдХрд╣реАрдВ рдПрдХ рд╡рд┐рднрд╛рдЬрдХ рд╣реИ - рдПрдХ рдЕрд▓реНрдкрд╡рд┐рд░рд╛рдоред рдХрдИ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рднреА рд╣реИрдВ рдЬрд┐рдирдореЗрдВ рд╕рд┐рд░рд┐рд▓рд┐рдХ рдЬрд╛рддрд╛ рд╣реИред рдПрдХрд░реВрдкрддрд╛ рднреА рдирд╣реАрдВ рд╣реИ, рдФрд░ рдРрд╕реЗ рдкреНрд░рд╛рд░реВрдк рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"рдЕрдВрддрд┐рдо рдирд╛рдо рдкреНрд░рдердо рдирд╛рдо", "рдкреНрд░рдердо рдирд╛рдо рдЕрдВрддрд┐рдо рдирд╛рдо", "рдкреНрд░рдердо рдирд╛рдо рдордзреНрдп рдирд╛рдо рдЕрдВрддрд┐рдо рдирд╛рдо", "рдЕрдВрддрд┐рдо рдирд╛рдо рдкреНрд░рдердо рдирд╛рдо рдордзреНрдп рдирд╛рдо"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдордзреНрдп рдирд╛рдо рд▓реИрдЯрд┐рди рд╡рд░реНрддрдиреА рдореЗрдВ рднреА рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдФрд░ рдпрд╣рд╛рдБ, рд╡реИрд╕реЗ, рдПрдХ рдФрд░ рд╕рдорд╕реНрдпрд╛ рдкреИрджрд╛ рд╣реЛрддреА рд╣реИ - рд▓рд┐рдкреНрдпрдВрддрд░рдгред рдпрд╣ рднреА рдзреНрдпрд╛рди рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдЬрд╣рд╛рдВ рдХреЛрдИ рдордзреНрдп рдирд╛рдо рдирд╣реАрдВ рд╣реИ, рд░рд┐рдХреЙрд░реНрдб рджреЛ рд╢рдмреНрджреЛрдВ рддрдХ рд╕реАрдорд┐рдд рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╣рд┐рд╕реНрдкреИрдирд┐рдХреНрд╕ рдХреЗ рд▓рд┐рдП, рдирд╛рдо рдкреНрд▓рд╕ рдЙрдкрдирд╛рдо рдореЗрдВ рдЖрдорддреМрд░ рдкрд░ рддреАрди рдпрд╛ рдЪрд╛рд░ рд╢рдмреНрдж рд╣реЛрддреЗ рд╣реИрдВред рдбрдЪ рдореЗрдВ рдЙрдкрд╕рд░реНрдЧ рд╡реИрди рд╣реИ, рдЪреАрдиреА рдФрд░ рдХреЛрд░рд┐рдпрд╛рдИ рд▓реЛрдЧреЛрдВ рдХреЗ рдкрд╛рд╕ рдЖрдорддреМрд░ рдкрд░ рддреАрди рд╢рдмреНрдж рднреА рд╣реЛрддреЗ рд╣реИрдВред рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рдЖрдкрдХреЛ рдХрд┐рд╕реА рддрд░рд╣ рдЗрд╕ рдкреВрд░реЗ рд░рд┐рдмрд╛рд╕ рдХреЛ рдЕрдирд╕реБрдирд╛ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдЗрд╕реЗ рдЕрдзрд┐рдХрддрдо рд░реВрдк рдореЗрдВ рдорд╛рдирдХреАрдХреГрдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдПрдХ рдирд┐рдпрдо рдХреЗ рд░реВрдк рдореЗрдВ, рдПрдХ рджреМрдбрд╝ рдХреЗ рднреАрддрд░, рдирд╛рдо рдкреНрд░рд╛рд░реВрдк рд╕рднреА рдХреЗ рд▓рд┐рдП рд╕рдорд╛рди рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рддреНрд░реБрдЯрд┐рдпрд╛рдВ рднреА рд╣реИрдВ рдХрд┐ рд╣рдо, рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╕рдВрднрд╛рд▓ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗред рдЪрд▓рд┐рдП рдирдП рдХреЙрд▓рдо </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд╛рдо рдХрдЪреНрдЪреЗ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рдореМрдЬреВрджрд╛ рдорд╛рдиреЛрдВ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдХреЗ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'name raw'</span>] = ar[<span class="hljs-string">'name'</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд╡рд┐рд╢рд╛рд▓ рдмрд╣реБрдордд рд▓реИрдЯрд┐рди рдореЗрдВ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдкрд╣рд▓реА рдЪреАрдЬ рдЬреЛ рдореИрдВ рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдВ, рд╡рд╣ рд╣реИ рдЯреНрд░рд╛рдВрд╕рд▓реЗрдЯред </font><font style="vertical-align: inherit;">рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рдкреНрд░рддрд┐рднрд╛рдЧреА рдХреЗ рдирд╛рдо рдореЗрдВ рдХреМрди рд╕реЗ рд╡рд░реНрдг рд╢рд╛рдорд┐рд▓ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред</font></font><br>
<br>
<pre><code class="python hljs">set( <span class="hljs-string">''</span>.join(ar[<span class="hljs-string">'name'</span>].unique()))
</code></pre><br>
<code><b>Out: </b>[' ', '!', '"', '#', '&amp;', "'", '(', ')', '*', '+', ',', '-', '.', '/', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', ':', ';', '&gt;', '?', '@', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', '[', '\\', ']', '^', '_', '`', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', '|', '\x7f', '\xa0', '┬д', '┬ж', '┬з', '', '┬л', '\xad', '', '┬░', '┬▒', '┬╡', '┬╢', '┬╖', '┬╗', '', '╨Ж', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '╤Ф', '╤Ц', '╤Ю', 'тАУ', 'тАФ', 'тАШ', 'тАЩ', 'тАЪ', 'тАЬ', 'тАЭ', 'тАЮ', 'тАа', 'тАб', 'тАж', 'тА░', 'тА║', '']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХреЗрд╡рд▓ рд╡рд╣рд╛рдБ рдХреНрдпрд╛ рд╣реИ! </font><font style="vertical-align: inherit;">рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЕрдХреНрд╖рд░реЛрдВ рдФрд░ рд░рд┐рдХреНрдд рд╕реНрдерд╛рди рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдЕрднреА рднреА рд╡рд┐рднрд┐рдиреНрди рдЖрдЙрдЯрд▓реИрдВрдбрд┐рд╢ рд╡рд░реНрдгреЛрдВ рдХрд╛ рдПрдХ рд╕рдореВрд╣ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрдирдореЗрдВ рд╕реЗ, рдЕрд╡рдзрд┐ 'ред', 'рд╣рд╛рдЗрдлрд╝рди' - ', рдФрд░ рдПрдкреЛрд╕реНрдЯреНрд░реЛрдлрд╝ "'" рдХреЛ рдорд╛рдиреНрдп рдорд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдХрд┐ рдЧрд▓рддреА рд╕реЗ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрд╣ рджреЗрдЦрд╛ рдЧрдпрд╛ рдХрд┐ рдХрдИ рдЬрд░реНрдорди рдФрд░ рдиреЙрд░реНрд╡реЗрдЬрд┐рдпрди рдирд╛рдореЛрдВ рдФрд░ рдЙрдкрдирд╛рдореЛрдВ рдореЗрдВ рдПрдХ рдкреНрд░рд╢реНрди рдЪрд┐рд╣реНрди рд╣реИ? 'ред </font><font style="vertical-align: inherit;">рд╡реЗ, рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ, рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рд▓реИрдЯрд┐рди рд╡рд░реНрдгрдорд╛рд▓рд╛ рдХреЗ рдкрд╛рддреНрд░реЛрдВ рдХреА рдЬрдЧрд╣ рд▓реЗ рд░рд╣реЗ рд╣реИрдВ - '?', 'рдП', 'рдУ', 'рдпреВ',? </font><font style="vertical-align: inherit;">рдФрд░ рдЕрдиреНрдпред рдпрд╣рд╛рдВ рдЙрджрд╛рд╣рд░рдг рд╣реИрдВ: </font><font style="vertical-align: inherit;">
рдЕрд▓реНрдкрд╡рд┐рд░рд╛рдо, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ рдмрд╣реБрдд рдмрд╛рд░ рд╣реЛрддрд╛ рд╣реИ, рдмрд╕ рдХреБрдЫ рд╡рд┐рднрд╛рдЬрдХреЛрдВ рдкрд░ рдЕрдкрдирд╛рдпрд╛ рдЧрдпрд╛ рдПрдХ рд╡рд┐рднрд╛рдЬрдХ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдЕрд╕реНрд╡реАрдХрд╛рд░реНрдп рдХреА рд╢реНрд░реЗрдгреА рдореЗрдВ рднреА рдЖрдПрдЧрд╛ред </font><font style="vertical-align: inherit;">рд╕рдВрдЦреНрдпрд╛ рдирд╛рдореЛрдВ рдореЗрдВ рдирд╣реАрдВ рджрд┐рдЦрдиреА рдЪрд╛рд╣рд┐рдПред</font></font><br>
<code>Pierre-Alexandre Petit, Jean-louis Lafontaine, Faris Al-Sultan, Jean-Francois Evrard, Paul O'Mahony, Aidan O'Farrell, John O'Neill, Nick D'Alton, Ward D'Hulster, Hans P.J. Cami, Luis E. Benavides, Maximo Jr. Rueda, Prof. Dr. Tim-Nicolas Korf, Dr. Boris Scharlowsk, Eberhard Gro?mann, Magdalena Wei?, Gro?er Axel, Meyer-Szary Krystian, Morten Halkj?r, RASMUSSEN S?ren Balle<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">bs = [s <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> symbols <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> (s.isalpha() <span class="hljs-keyword">or</span> s <span class="hljs-keyword">in</span> <span class="hljs-string">" . - ' ? ,"</span>)] <span class="hljs-comment">#bs тАУ bad symbols</span><font></font>
<font></font>
bs<font></font>
</code></pre><br>
<code><b>Out: </b>['!', '"', '#', '&amp;', '(', ')', '*', '+', '/', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', ':', ';', '&gt;', '@', '[', '\\', ']', '^', '_', '`', '|', '\x7f', '\xa0', '┬д', '┬ж', '┬з', '', '┬л', '\xad', '', '┬░', '┬▒', '┬╢', '┬╖', '┬╗', 'тАУ', 'тАФ', 'тАШ', 'тАЩ', 'тАЪ', 'тАЬ', 'тАЭ', 'тАЮ', 'тАа', 'тАб', 'тАж', 'тА░', 'тА║', '']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рдЗрди рд╕рднреА рдкрд╛рддреНрд░реЛрдВ рдХреЛ рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдХрд╛рд▓ рджреЗрдВрдЧреЗ рдХрд┐ рд╡реЗ рдХрд┐рддрдиреА рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> bs:<font></font>
    ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.replace(s, <span class="hljs-string">''</span>)<font></font>
<font></font>
corr = ar[ar[<span class="hljs-string">'name'</span>] != ar[<span class="hljs-string">'name raw'</span>]]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2,184 рдРрд╕реЗ рд░рд┐рдХреЙрд░реНрдб рд╣реИрдВ, рдпрд╛рдиреА рдХреБрд▓ рд╕рдВрдЦреНрдпрд╛ рдХрд╛ рдХреЗрд╡рд▓ 0.15% - рдмрд╣реБрдд рдХрдоред </font><font style="vertical-align: inherit;">рдЖрдЗрдП рдЙрдирдореЗрдВ рд╕реЗ 100 рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓реЗрдВ:</font></font><br>
<br>
<pre><code class="python hljs">list(corr[<span class="hljs-string">'name raw'</span>].sample(<span class="hljs-number">100</span>))
</code></pre><br>
<code><b>Out:</b> ['Scha┬╢ffl, Ga?nter', 'Howard, Brian &amp;', 'Chapiewski, Guilherme (Gc)', 'Derkach 1svd_mail_ru', 'Parker H1 Lauren', 'Leal le?n, Yaneri', 'TencA, David', 'Cortas La?pez, Alejandro', 'Strid, Bja┬╢rn', '(Crutchfield) Horan, Katie', 'Vigneron, Jean-Michel.Vigneron@gmail.Com', '\xa0', 'Telahr, JтАаrgen', 'StтАЭrmer, Melanie', 'Nagai B1 Keiji', 'Rinc?n, Mariano', 'Arkalaki, Angela (Evangelia)', 'Barbaro B1 Bonin Anna G:Charlotte', 'Ra?esch, Ja┬╢rg', "CAVAZZI NICCOLO\\'", 'DтАЮnzel, Thomas', 'Ziska, Steffen (Gerhard)', 'Kobilica B1 Alen', 'Mittelholcz, Bala', 'Jimanez Aguilar, Juan Antonio', 'Achenza H1 Giovanni', 'Reppe H2 Christiane', 'Filipovic B2 Lazar', 'Machuca Ka?hnel, Ruban Alejandro', 'Gellert (Silberprinz), Christian', 'Smith (Guide), Matt', 'Lenatz H1 Benjamin', 'Da┬╢llinger, Christian', 'Mc Carthy B1 Patrick Donnacha G:Bryan', 'Fa┬╢llmer, Chris', 'Warner (Rivera), Lisa', 'Wang, Ruijia (Ray)', 'Mc Carthy B1 Donnacha', 'Jones, Nige (Paddy)', 'SchтАЭler, Christoph', '\xa0', 'Holthaus, Adelhard (Allard)', 'Mi;Arro, Ana', 'Dr: Koch Stefan', '\xa0', '\xa0', 'Ziska, Steffen (Gerhard)', 'Albarraca\xadn Gonza?lez, Juan Francisco', 'Ha┬╢fling, Imke', 'Johnston, Eddie (Edwin)', 'Mulcahy, Bob (James)', 'Gottschalk, BjтАЭrn', '\xa0', 'Gretsch H2 Kendall', 'Scorse, Christopher (Chris)', 'KielтАЪbasa, Pawel', 'Kalan, Magnus', 'Roderick "eric" SIMBULAN', 'Russell;, Mark', 'ROPES AND GRAY TEAM 3', 'Andrade, H?┬жCTOR DANIEL', 'Landmann H2 Joshua', 'Reyes Rodra\xadguez, Aithami', 'Ziska, Steffen (Gerhard)', 'Ziska, Steffen (Gerhard)', 'Heuza, Pierre', 'Snyder B1 Riley Brad G:Colin', 'Feldmann, Ja┬╢rg', 'Beveridge H1 Nic', 'FAGES`, perrine', 'Frank", Dieter', 'Saarema┬дel, Indrek', 'Betancort Morales, AridaтАУy', 'Ridderberg, Marie_Louise', '\xa0', 'Ka┬╢nig, Johannes', 'W Van(der Klugt', 'Ziska, Steffen (Gerhard)', 'Johnson, Nick26', 'Heinz JOHNER03', 'Ga┬╢rg, Andra', 'Maruo B2 Atsuko', 'Moral Pedrero H1 Eva Maria', '\xa0', 'MATUS SANTIAGO Osc1r', 'Stenbrink, Bja┬╢rn', 'Wangkhan, Sm1.Thaworn', 'Pullerits, Ta┬╢nu', 'Clausner, 8588294149', 'Castro Miranda, Josa Ignacio', 'La┬╢fgren, Pontuz', 'Brown, Jann ( Janine )', 'Ziska, Steffen (Gerhard)', 'Koay, Sa┬╢ren', 'Ba┬╢hm, Heiko', 'Oleksiuk B2 Vita', 'G Van(de Grift', 'Scha┬╢neborn, Guido', 'Mandez, A?lvaro', 'Garca\xada Fla?rez, Daniel']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдмрд╣реБрдд рд╢реЛрдз рдХреЗ рдмрд╛рдж, рдпрд╣ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛ рдЧрдпрд╛: рд╕рднреА рд╡рд░реНрдгрдорд╛рд▓рд╛ рд╡рд░реНрдгреЛрдВ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП, рд╕рд╛рде рд╣реА рд╕рд╛рде рдПрдХ рд╕реНрдкреЗрд╕, рдПрдХ рд╣рд╛рдЗрдлрди, рдПрдХ рдПрдкреЙрд╕реНрдЯреНрд░реЙрдлреА рдФрд░ рдПрдХ рдкреНрд░рд╢реНрди рдЪрд┐рд╣реНрди, рдПрдХ рдЕрд▓реНрдкрд╡рд┐рд░рд╛рдо, рдПрдХ рдЕрд╡рдзрд┐ рдФрд░ рдПрдХ '\ xa0' рдкреНрд░рддреАрдХ рдФрд░ рд░рд┐рдХреНрдд рд╕реНрдерд╛рди рдХреЗ рд╕рд╛рде, рдФрд░ рдЦрд╛рд▓реА рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдЕрдиреНрдп рд╕рднреА рд╡рд░реНрдгреЛрдВ рдХреЛ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВред рд╡рд╣ рд╣реИ, рдмрд╕ рд╣рдЯрд╛рдПрдВред</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name raw'</span>]<font></font>
<font></font>
<span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> symbols:
    <span class="hljs-keyword">if</span> s.isalpha() <span class="hljs-keyword">or</span> s <span class="hljs-keyword">in</span> <span class="hljs-string">" - ? '"</span>:        
        <span class="hljs-keyword">continue</span>        
    <span class="hljs-keyword">if</span> s <span class="hljs-keyword">in</span> <span class="hljs-string">".,\xa0"</span>:<font></font>
        ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.replace(s, <span class="hljs-string">' '</span>)       
    <span class="hljs-keyword">else</span>:<font></font>
        ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.replace(s, <span class="hljs-string">''</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдлрд┐рд░ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕реНрдерд╛рдиреЛрдВ рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛рдПрдВ:</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.split().str.join(<span class="hljs-string">' '</span>)<font></font>
ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.strip() <span class="hljs-comment">#   </span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рджреЗрдЦрддреЗ рд╣реИ рдХреНрдпрд╛ рд╣реБрдЖ:</font></font><br>
<br>
<pre><code class="python hljs">ar.loc[corr.index].sample(<span class="hljs-number">10</span>)
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th><u>name</u></th>
<th>country</th>
<th>...</th>
<th><u>name raw</u></th>
</tr>
<tr>
<td>63</td>
<td>64</td>
<td>M</td>
<td><u>Curzillat B MARANO Annouck GJulie</u></td>
<td>FRA</td>
<td>...</td>
<td><u>Curzillat B1 MARANO Annouck G:Julie</u></td>
</tr>
<tr>
<td>425</td>
<td>426</td>
<td>M</td>
<td><u>Naranjo Quintero Cndido</u></td>
<td>ESP</td>
<td>...</td>
<td><u>Naranjo Quintero, CтАбndido</u></td>
</tr>
<tr>
<td>1347</td>
<td>1348</td>
<td>F</td>
<td><u>Chang Margaret Peggy</u></td>
<td>USA</td>
<td>...</td>
<td><u>Chang, Margaret (Peggy)</u></td>
</tr>
<tr>
<td>790</td>
<td>791</td>
<td>M</td>
<td><u>Gonzalez Ruben</u></td>
<td>PRI</td>
<td>...</td>
<td><u>Gonzalez`, Ruben</u></td>
</tr>
<tr>
<td>1562</td>
<td>1563</td>
<td>M</td>
<td><u>Garcia Hernandez Elias</u></td>
<td>MEX</td>
<td>...</td>
<td><u>Garcia Hernandez/, Elias</u></td>
</tr>
<tr>
<td>50</td>
<td>51</td>
<td>M</td>
<td><u>Reppe H Christiane</u></td>
<td>DEU</td>
<td>...</td>
<td><u>Reppe H2 Christiane</u></td>
</tr>
<tr>
<td>528</td>
<td>529</td>
<td>M</td>
<td><u>Ho Shihken</u></td>
<td>TWN</td>
<td>...</td>
<td><u>Ho, ShihтАФken</u></td>
</tr>
<tr>
<td>819</td>
<td>820</td>
<td>M</td>
<td><u>Elmously A R Abdelrahman</u></td>
<td>EGY</td>
<td>...</td>
<td><u>Elmously, A.R. (Abdelrahman)</u></td>
</tr>
<tr>
<td>249</td>
<td>250</td>
<td>F</td>
<td><u>boyer Isabelle</u></td>
<td>THA</td>
<td>...</td>
<td><u>`boyer, Isabelle</u></td>
</tr>
<tr>
<td>744</td>
<td>745</td>
<td>M</td>
<td><u>Garcaa Morales Pedro Luciano</u></td>
<td>ESP</td>
<td>...</td>
<td><u>Garca┬мa Morales, Pedro Luciano</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рднреА рдзреНрдпрд╛рди рджрд┐рдпрд╛ рдЧрдпрд╛ рдХрд┐ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдкреНрд░рд╢реНрдирд╡рд╛рдЪрдХ рдЪрд┐рдиреНрд╣ рд╡рд╛рд▓реЗ рдирд╛рдо рд╣реИрдВред</font></font><br>
<br>
<pre><code class="python hljs">qmon = ar[(ar[<span class="hljs-string">'name'</span>].str.replace(<span class="hljs-string">'?'</span>, <span class="hljs-string">''</span>).str.strip() == <span class="hljs-string">''</span>)&amp;(ar[<span class="hljs-string">'name'</span>]!=<span class="hljs-string">''</span>)] <span class="hljs-comment">#qmon тАУ question mark only names</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЙрдирдореЗрдВ рд╕реЗ 3,429 рд╣реИрдВред рдпрд╣ рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ: </font><font style="vertical-align: inherit;">рдПрдХ рд╣реА рдорд╛рдирдХ рдкрд░ рдирд╛рдо рд▓рд╛рдиреЗ рдХрд╛ рд╣рдорд╛рд░рд╛ рд▓рдХреНрд╖реНрдп рд╕рдорд╛рди рдирд╛рдореЛрдВ рдХреЛ рд╕рдорд╛рди рджрд┐рдЦрдирд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЕрд▓рдЧ-рдЕрд▓рдЧ рддрд░реАрдХреЛрдВ рд╕реЗ рдЕрд▓рдЧ рд╣реИред </font><font style="vertical-align: inherit;">рдХреЗрд╡рд▓ рдкреНрд░рд╢реНрдирд╡рд╛рдЪрдХ рдЪрд┐рд╣реНрдиреЛрдВ рд╡рд╛рд▓реЗ рдирд╛рдореЛрдВ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╡реЗ рдХреЗрд╡рд▓ рд╡рд░реНрдгреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рднрд┐рдиреНрди рд╣реЛрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣ рдкреВрд░реНрдг рд╡рд┐рд╢реНрд╡рд╛рд╕ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ рдХрд┐ рд╕рдорд╛рди рд╕рдВрдЦреНрдпрд╛ рд╡рд╛рд▓реЗ рдирд╛рдо рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╕рдорд╛рди рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рд╣рдо рдЙрди рд╕рднреА рдХреЛ рдПрдХ рдЦрд╛рд▓реА рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рднрд╡рд┐рд╖реНрдп рдореЗрдВ рд╡рд┐рдЪрд╛рд░ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th><u>name</u></th>
<th>country</th>
<th>group</th>
<th>place in group</th>
<th>...</th>
<th>country raw</th>
<th>group raw</th>
<th><u>name raw</u></th>
</tr>
<tr>
<td>818</td>
<td>819</td>
<td>M</td>
<td><u>???? ???</u></td>
<td>JPN</td>
<td>M45-49</td>
<td>177</td>
<td>...</td>
<td>JPN</td>
<td>M45-49</td>
<td><u>????, ???</u></td>
</tr>
<tr>
<td>1101</td>
<td>1102</td>
<td>M</td>
<td><u>?? ??</u></td>
<td>JPN</td>
<td>M50-54</td>
<td>159</td>
<td>...</td>
<td>JPN</td>
<td>M50-54</td>
<td><u>??, ??</u></td>
</tr>
<tr>
<td>162</td>
<td>163</td>
<td>M</td>
<td><u>? ??</u></td>
<td>CHN</td>
<td>M30-34</td>
<td>22</td>
<td>...</td>
<td>CHN</td>
<td>M30-34</td>
<td><u>?, ??</u></td>
</tr>
<tr>
<td>1271</td>
<td>1272</td>
<td>F</td>
<td><u>???? ????</u></td>
<td>JPN</td>
<td>F50-54</td>
<td>15</td>
<td>...</td>
<td>JPN</td>
<td>F50-54</td>
<td><u>????, ????</u></td>
</tr>
<tr>
<td>552</td>
<td>553</td>
<td>M</td>
<td><u>??? ??</u></td>
<td>JPN</td>
<td>M25-29</td>
<td>30</td>
<td>...</td>
<td>JPN</td>
<td>M25-29</td>
<td><u>???, ??</u></td>
</tr>
<tr>
<td>423</td>
<td>424</td>
<td>M</td>
<td><u>??? ????</u></td>
<td>JPN</td>
<td>M55-59</td>
<td>24</td>
<td>...</td>
<td>JPN</td>
<td>M55-59</td>
<td><u>???, ????</u></td>
</tr>
<tr>
<td>936</td>
<td>937</td>
<td>F</td>
<td><u>?? ??</u></td>
<td>JPN</td>
<td>F50-54</td>
<td>7</td>
<td>...</td>
<td>JPN</td>
<td>F50-54</td>
<td><u>??, ??</u></td>
</tr>
<tr>
<td>244</td>
<td>245</td>
<td>M</td>
<td><u>? ??</u></td>
<td>KOR</td>
<td>M50-54</td>
<td>30</td>
<td>...</td>
<td>KOR</td>
<td>M50-54</td>
<td><u>?, ??</u></td>
</tr>
<tr>
<td>627</td>
<td>628</td>
<td>M</td>
<td><u>? ?</u></td>
<td>CHN</td>
<td>M40-44</td>
<td>94</td>
<td>...</td>
<td>CHN</td>
<td>M40-44</td>
<td><u>?, ?</u></td>
</tr>
<tr>
<td>194</td>
<td>195</td>
<td>M</td>
<td><u>?????? ?????</u></td>
<td>RUS</td>
<td></td>
<td>188</td>
<td>...</td>
<td>RUS</td>
<td>M</td>
<td><u>?????? ?????</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar.loc[qmon.index, <span class="hljs-string">'name'</span>] = <span class="hljs-string">''</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреА рдХреБрд▓ рд╕рдВрдЦреНрдпрд╛ рдЬрд╣рд╛рдВ рдирд╛рдо рд░рд┐рдХреНрдд рд╕реНрдЯреНрд░рд┐рдВрдЧ 3,454 рд╣реИред рдЗрддрдирд╛ рдирд╣реАрдВ - рд╣рдо рдЬреАрд╡рд┐рдд рд░рд╣реЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдЕрдм рдЬрдм рд╣рдореЗрдВ рдЕрдирд╛рд╡рд╢реНрдпрдХ рдкрд╛рддреНрд░реЛрдВ рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдорд┐рд▓ рдЧрдпрд╛ рд╣реИ, рддреЛ рд╣рдо рд▓рд┐рдкреНрдпрдВрддрд░рдг рдХреЗ рд▓рд┐рдП рдЖрдЧреЗ рдмрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдкрд╣рд▓реЗ рд╕рдм рдХреБрдЫ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓рд╛рдПрдВ рддрд╛рдХрд┐ рджреЛрд╣рд░рд╛ рдХрд╛рдо рди рдХрд░реЗрдВред</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.lower()
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдЧрд▓рд╛, рдПрдХ рд╢рдмреНрджрдХреЛрд╢ рдмрдирд╛рдПрдВ:</font></font><br>
<br>
<pre><code class="python hljs">trans = {<span class="hljs-string">''</span>:<span class="hljs-string">'a'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'b'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'v'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'g'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'d'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'e'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'e'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'zh'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'z'</span>,  <span class="hljs-string">''</span>:<span class="hljs-string">'i'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'y'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'k'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'l'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'m'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'n'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'o'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'p'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'r'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'s'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'t'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'u'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'f'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'kh'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'ts'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'ch'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'sh'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'shch'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">''</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'y'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">''</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'e'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'yu'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'ya'</span>, <span class="hljs-string">'╤Ф'</span>:<span class="hljs-string">'e'</span>, <span class="hljs-string">'╤Ц'</span>: <span class="hljs-string">'i'</span>,<span class="hljs-string">'╤Ю'</span>:<span class="hljs-string">'w'</span>,<span class="hljs-string">'┬╡'</span>:<span class="hljs-string">'m'</span>}
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕рдореЗрдВ рддрдерд╛рдХрдерд┐рдд рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рд╕рд┐рд░рд┐рд▓рд┐рдХ рд╡рд░реНрдгрдорд╛рд▓рд╛ рдХреЗ рдЕрдХреНрд╖рд░ рднреА рд╢рд╛рдорд┐рд▓ рдереЗ - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">',', '' ',' the '</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдЬреЛ рдмреЗрд▓рд╛рд░реВрд╕реА рдФрд░ рдпреВрдХреНрд░реЗрдиреА рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рд╕рд╛рде рд╣реА рд╕рд╛рде рдЧреНрд░реАрдХ рдЕрдХреНрд╖рд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">' ┬╡ 'рднреА</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рдкрд░рд┐рд╡рд░реНрддрди рд▓рд╛рдЧреВ рдХрд░реЗрдВ:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> trans:<font></font>
    ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.replace(s, trans[s])
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм, рдХрд╛рдо рдХреЗ рдирд┐рдЪрд▓реЗ рдорд╛рдорд▓реЗ рд╕реЗ, рд╣рдо рд╕рдм рдХреБрдЫ рдкрд░рд┐рдЪрд┐рдд рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдЕрдиреБрд╡рд╛рдж рдХрд░реЗрдВрдЧреЗ, рдЬрд╣рд╛рдВ рдкрд╣рд▓рд╛ рдФрд░ рдЕрдВрддрд┐рдо рдирд╛рдо рдмрдбрд╝реЗ рдЕрдХреНрд╖рд░ рд╕реЗ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.title()
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рджреЗрдЦрддреЗ рд╣реИ рдХреНрдпрд╛ рд╣реБрдЖред</font></font><br>
<br>
<pre><code class="python hljs">ar[ar[<span class="hljs-string">'name raw'</span>].str.lower().str[<span class="hljs-number">0</span>].isin(trans.keys())].sample(<span class="hljs-number">10</span>)
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th><u>name</u></th>
<th>...</th>
<th>country raw</th>
<th>name raw</th>
</tr>
<tr>
<td>99</td>
<td>100</td>
<td>M</td>
<td><u>Nikolay Golovkin</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>95</td>
<td>96</td>
<td>M</td>
<td><u>Maksim Vasilevich Chubakov</u></td>
<td>...</td>
<td>RUS</td>
<td>  </td>
</tr>
<tr>
<td>325</td>
<td>326</td>
<td>F</td>
<td><u>Ganieva Aygul</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>661</td>
<td>662</td>
<td>M</td>
<td><u>Maksut Nizamutdinov</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>356</td>
<td>357</td>
<td>F</td>
<td><u>Kolobanova Svetlana</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>117</td>
<td>118</td>
<td>M</td>
<td><u>Guskov Vladislav</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>351</td>
<td>352</td>
<td>M</td>
<td><u>Kolesnikov Dmitriy</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>92</td>
<td>93</td>
<td>M</td>
<td><u>Kuznetsov Oleg</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>50</td>
<td>51</td>
<td>M</td>
<td><u>Khoraykin Maksim</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>6</td>
<td>7</td>
<td>M</td>
<td><u>Brylev Aleksey</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдВрдд рдореЗрдВ, рдЕрджреНрд╡рд┐рддреАрдп рд╡рд░реНрдгреЛрдВ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ:</font></font><br>
<br>
<pre><code class="python hljs">set( <span class="hljs-string">''</span>.join(ar[<span class="hljs-string">'name'</span>].unique()))
</code></pre><br>
<code><b>Out:</b> [' ', "'", '-', '?', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J','K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рдм рд╕рд╣реА рд╣реИред </font><font style="vertical-align: inherit;">рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╕реБрдзрд╛рд░реЛрдВ рдиреЗ 1,253,882 рдпрд╛ 89% рд░рд┐рдХреЙрд░реНрдб рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд┐рдпрд╛, рдЕрджреНрд╡рд┐рддреАрдп рдирд╛рдореЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ 660,207 рд╕реЗ рдШрдЯрдХрд░ 599,186 рд╣реЛ рдЧрдИ, рдЕрд░реНрдерд╛рдд 61 рд╣рдЬрд╛рд░ рдпрд╛ рд▓рдЧрднрдЧ 10%ред </font><font style="vertical-align: inherit;">рд╡рд╛рд╣! </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╢рдмреНрджрдХреЛрд╢ рдореЗрдВ рд╡рд╛рдкрд╕ рдЕрднрд┐рд▓реЗрдЦреЛрдВ рдХреЗ рд╕рдВрдШ рдХрд╛ рдЕрдиреБрд╡рд╛рдж рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдПрдХ рдирдИ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕рд╣реЗрдЬреЗрдВ </font><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<pre><code class="python hljs">pkl.dump(rd, open(<span class="hljs-string">r'D:\tri\details4.pkl'</span>, <span class="hljs-string">'wb'</span>))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╣рдореЗрдВ рдЖрджреЗрд╢ рдмрд╣рд╛рд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдЕрд░реНрдерд╛рддреН, рд╕рднреА рд░рд┐рдХреЙрд░реНрдб рдЗрд╕ рддрд░рд╣ рджрд┐рдЦреЗрдВрдЧреЗ - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╣рд▓рд╛ рдирд╛рдо рдЕрдВрддрд┐рдо рдирд╛рдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдВрддрд┐рдо рдирд╛рдо рдкрд╣рд▓рд╛ рдирд╛рдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред рдХреМрди рд╕рд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рд╣реИред рд╕рдЪ рд╣реИ, рдирд╛рдо рдФрд░ рдЙрдкрдирд╛рдо рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХреБрдЫ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдореЗрдВ рдордзреНрдп рдирд╛рдо рднреА рд╣реЛрддреЗ рд╣реИрдВред рдФрд░ рдРрд╕рд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдПрдХ рд╣реА рд╡реНрдпрдХреНрддрд┐ рдХреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдореЗрдВ рдЕрд▓рдЧ-рдЕрд▓рдЧ рддрд░реАрдХреЗ рд╕реЗ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реЛ - рдХрд╣реАрдВ рдордзреНрдп рдирд╛рдо рдХреЗ рд╕рд╛рде, рдХрд╣реАрдВ рдмрд┐рдирд╛ред рдЗрд╕рд╕реЗ рдЙрд╕рдХреА рдкрд╣рдЪрд╛рди рдмрд╛рдзрд┐рдд рд╣реЛрдЧреА, рдЗрд╕рд▓рд┐рдП рдмреАрдЪ рдХрд╛ рдирд╛рдо рд╣рдЯрд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВред рдкреБрд░реБрд╖реЛрдВ рдХреЗ рд▓рд┐рдП рдкреЗрдЯреНрд░реЛрдирд╛рдорд┐рдХреНрд╕ рдореЗрдВ рдЖрдорддреМрд░ рдкрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"hiv"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ рдорд╣рд┐рд▓рд╛рдУрдВ рдХреЗ рд▓рд┐рдП </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"vna" рд╣реЛрддрд╛ рд╣реИ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред рд▓реЗрдХрд┐рди рдЕрдкрд╡рд╛рдж рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ilyich, Ilyinichna, Nikitich, Nikitichna</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред рд╕рдЪ рд╣реИ, рдРрд╕реЗ рдмрд╣реБрдд рдХрдо рдЕрдкрд╡рд╛рдж рд╣реИрдВред рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рд╣реА рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдПрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рднреАрддрд░ рдирд╛рдореЛрдВ рдХрд╛ рдкреНрд░рд╛рд░реВрдк рд╕реНрдерд╛рдпреА рдорд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП, рд╕рдВрд░рдХреНрд╖рдХ рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдЙрд╕ рджреМрдбрд╝ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╡реЗ рдореМрдЬреВрдж рд╣реИрдВред рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, </font><font style="vertical-align: inherit;">рд╕реНрддрдВрдн </font><i><font style="vertical-align: inherit;">рдирд╛рдо</font></i><font style="vertical-align: inherit;"> рдореЗрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"vich"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"vna"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрдВрд╢реЛрдВ рдХреА рдХреБрд▓ рд╕рдВрдЦреНрдпрд╛ </font><i><font style="vertical-align: inherit;">рдЬреНрдЮрд╛рдд </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд░реЗрдВ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдореЗрдВ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреА рдХреБрд▓ рд╕рдВрдЦреНрдпрд╛ рдХреЗ рд╕рд╛рде рдЙрдирдХреА рддреБрд▓рдирд╛ рдХрд░реЗрдВред рдпрджрд┐ рдпреЗ рд╕рдВрдЦреНрдпрд╛ рдХрд░реАрдм рд╣реИрдВ, рддреЛ рдПрдХ рдордзреНрдп рдирд╛рдо рд╣реИ, рдЕрдиреНрдпрдерд╛ рдирд╣реАрдВред рд╕рдЦреНрдд рдореИрдЪ рдХреА рддрд▓рд╛рд╢ рдХрд░рдирд╛ рдЕрдиреБрдЪрд┐рдд рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рджреМрдбрд╝ рдореЗрдВ рдЬрд╣рд╛рдВ рдордзреНрдпрдо рдирд╛рдо рджрд░реНрдЬ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╡рд┐рджреЗрд╢реА рднрд╛рдЧ рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рд╡реЗ рдЙрд╕рдХреЗ рдмрд┐рдирд╛ рджрд░реНрдЬ рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗред рдРрд╕рд╛ рднреА рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдкреНрд░рддрд┐рднрд╛рдЧреА рдЕрдкрдиреЗ рдордзреНрдп рдирд╛рдо рдХреЛ рдмрддрд╛рдирд╛ рдирд╣реАрдВ рдЪрд╛рд╣рддрд╛ рдерд╛ рдпрд╛ рдирд╣реАрдВ рднреВрд▓ рд╕рдХрддрд╛ рдерд╛ред рджреВрд╕рд░реА рдУрд░, "рд╡рд┐рдЪ" рдореЗрдВ рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдЙрдкрдирд╛рдо рднреА рд╣реИрдВ, рдЙрдирдореЗрдВ рд╕реЗ рдХрдИ рдмреЗрд▓рд╛рд░реВрд╕ рдФрд░ рдЕрдиреНрдп рджреЗрд╢реЛрдВ рдореЗрдВ рд╕реНрд▓рд╛рд╡ рд╕рдореВрд╣ рдХреА рднрд╛рд╖рд╛рдУрдВ рдХреЗ рд╕рд╛рде рд╣реИрдВред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдордиреЗ рд▓рд┐рдкреНрдпрдВрддрд░рдг рдХрд┐рдпрд╛ред рд▓рд┐рдкреНрдпрдВрддрд░рдг рд╕реЗ рдкрд╣рд▓реЗ рдпрд╣ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдирд╛ рд╕рдВрднрд╡ рдерд╛, рд▓реЗрдХрд┐рди рдлрд┐рд░ рдПрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рдпрд╛рдж рдХрд░рдиреЗ рдХрд╛ рдореМрдХрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдордзреНрдп рдирд╛рдо рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╢реБрд░реВ рдореЗрдВ рдпрд╣ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд▓реИрдЯрд┐рди рдореЗрдВ рд╣реИред рддреЛ рд╕рдм рдареАрдХ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕рд▓рд┐рдП, рд╣рдо рдЙрди рд╕рднреА рдкреНрд░реЛрдЯреЛрдХреЙрд▓реЛрдВ рдХреА рддрд▓рд╛рд╢ рдХрд░реЗрдВрдЧреЗ рдЬрд┐рдирдореЗрдВ </font><font style="vertical-align: inherit;">рдХреЙрд▓рдо рдореЗрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"vich"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"vna"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЯреБрдХрдбрд╝реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рд╣реИ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд╛рдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдореЗрдВ рдХреБрд▓ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХрд╛ 50% рд╕реЗ рдЕрдзрд┐рдХ рд╣реИред</font></font><br>
<br>
<pre><code class="python hljs">wp = {} <span class="hljs-comment">#wp тАУ with patronymic </span><font></font>
<font></font>
<span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> rd:<font></font>
    nvich = (<span class="hljs-string">''</span>.join(rd[e][<span class="hljs-string">'name'</span>])).count(<span class="hljs-string">'vich'</span>) <font></font>
    nvna = (<span class="hljs-string">''</span>.join(rd[e][<span class="hljs-string">'name'</span>])).count(<span class="hljs-string">'vna'</span>)
    <span class="hljs-keyword">if</span> nvich + nvna &gt; <span class="hljs-number">0.5</span>*len(rd[e]):<font></font>
        wp[e] = rd[e]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдРрд╕реЗ 29 рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдФрд░ рдпрд╣ рджрд┐рд▓рдЪрд╕реНрдк рд╣реИ рдХрд┐ рдЕрдЧрд░ 50% рдХреЗ рдмрдЬрд╛рдп рд╣рдо 20% рдпрд╛ рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрдд 70% рд▓реЗрддреЗ рд╣реИрдВ, рддреЛ рдкрд░рд┐рдгрд╛рдо рдирд╣реАрдВ рдмрджрд▓реЗрдЧрд╛, рд╡рд╣реА 29 рд╣реЛрдВрдЧреЗред рдЗрд╕рд▓рд┐рдП рд╣рдордиреЗ рд╕рд╣реА рд╡рд┐рдХрд▓реНрдк рдмрдирд╛рдпрд╛ред </font><font style="vertical-align: inherit;">рддрджрдиреБрд╕рд╛рд░, 20% рд╕реЗ рдХрдо - рдЙрдкрдирд╛рдореЛрдВ рдХрд╛ рдкреНрд░рднрд╛рд╡, 70% рд╕реЗ рдЕрдзрд┐рдХ - рдордзреНрдп рдирд╛рдореЛрдВ рдХреЗ рдмрд┐рдирд╛ рд╡реНрдпрдХреНрддрд┐рдЧрдд рд░рд┐рдХреЙрд░реНрдб рдХрд╛ рдкреНрд░рднрд╛рд╡ред </font><font style="vertical-align: inherit;">рдзреБрд░реА рддрд╛рд▓рд┐рдХрд╛ рдХреА рдорджрдж рд╕реЗ рджреЗрд╢ рдХреА рдЬрд╛рдБрдЪ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рдХрд┐ рдЙрдирдореЗрдВ рд╕реЗ 25 рд░реВрд╕ рдореЗрдВ рдереЗ, 4 рдЕрдмрдХрд╛рдЬрд╝рд┐рдпрд╛ рдореЗрдВред </font><font style="vertical-align: inherit;">
рдЖрдЧреЗ рдмрдврд╝рддреЗ рд░рд╣рдирд╛ред </font><font style="vertical-align: inherit;">рд╣рдо рдХреЗрд╡рд▓ рддреАрди рдШрдЯрдХреЛрдВ рдХреЗ рд╕рд╛рде рд░рд┐рдХреЙрд░реНрдб рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд░реЗрдВрдЧреЗ, рд╡рд╣ рдпрд╣ рд╣реИ рдХрд┐, рдЬрд╣рд╛рдБ рдХреЛрдИ рдирд╛рдо рд╣реИ (рд╕рдВрднрд╡рддрдГ) рдЕрдВрддрд┐рдо рдирд╛рдо, рдкрд╣рд▓рд╛ рдирд╛рдо рдФрд░ рдордзреНрдп рдирд╛рдоред</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>...</th>
<th>name raw</th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td>Yaroslav <u>Stanislavovich</u> Pavlishchev</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td>Vladimir <u>Vasilevich</u> Perezhigin</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td>Vladislav <u>Evgenevich</u> Litvinchuk</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>3</td>
<td>4</td>
<td>M</td>
<td>Sergey <u>Gennadevich</u> Gavrilenko</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>M</td>
<td>Ivan <u>Markovich</u> Markin</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>5</td>
<td>6</td>
<td>M</td>
<td>Nikolay <u>Evgenevich</u> Sokolov</td>
<td>RUS</td>
<td>...</td>
<td>Nikolay Evgenevich Sokolov</td>
</tr>
<tr>
<td>6</td>
<td>7</td>
<td>M</td>
<td>Aram <u>Pavlovich</u> Kukhtiev</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>7</td>
<td>8</td>
<td>M</td>
<td>Andrey <u>Anatolevich</u> Andreev</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>8</td>
<td>9</td>
<td>M</td>
<td>Denis <u>Valerevich</u> Bulgakov</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>9</td>
<td>10</td>
<td>M</td>
<td>Aleksandr <u>Ivanovich</u> Kuts</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">sum_n3w = <span class="hljs-number">0</span> <span class="hljs-comment"># sum name of 3 words</span>
sum_nnot3w = <span class="hljs-number">0</span> <span class="hljs-comment"># sum name not of 3 words</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> wp: <font></font>
    sum_n3w += len([n <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> wp[e][<span class="hljs-string">'name'</span>] <span class="hljs-keyword">if</span> len(n.split()) == <span class="hljs-number">3</span>])<font></font>
    sum_nnot3w += len(wp[e]) - n3w<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рддрд░рд╣ рдХреЗ рд░рд┐рдХреЙрд░реНрдб рдХрд╛ рдмрд╣реБрдордд 86% рд╣реИред </font><font style="vertical-align: inherit;">рдЕрдм рдЙрди рддреАрди рдШрдЯрдХреЛрдВ рдХреЛ рдХреЙрд▓рдо </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">name0, name1, name2</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> wp:<font></font>
    ind3 = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> rd[e].index <span class="hljs-keyword">if</span> len(rd[e].loc[i,<span class="hljs-string">'name'</span>].split()) == <span class="hljs-number">3</span>]<font></font>
    rd[e][<span class="hljs-string">'name0'</span>] = <span class="hljs-string">''</span>
    rd[e][<span class="hljs-string">'name1'</span>] = <span class="hljs-string">''</span>
    rd[e][<span class="hljs-string">'name2'</span>] = <span class="hljs-string">''</span>
    rd[e].loc[ind3, <span class="hljs-string">'name0'</span>] = rd[e].loc[ind3,<span class="hljs-string">'name'</span>].str.split().str[<span class="hljs-number">0</span>]<font></font>
    rd[e].loc[ind3, <span class="hljs-string">'name1'</span>] = rd[e].loc[ind3,<span class="hljs-string">'name'</span>].str.split().str[<span class="hljs-number">1</span>]<font></font>
    rd[e].loc[ind3, <span class="hljs-string">'name2'</span>] = rd[e].loc[ind3,<span class="hljs-string">'name'</span>].str.split().str[<span class="hljs-number">2</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣рд╛рдВ рдПрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИ: </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдВ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рдпрд╣ рд╕реНрдкрд╖реНрдЯ рд╣реИ рдХрд┐ рджреЛ рдШрдЯрдХреЛрдВ рдХреА рд░рд┐рдХреЙрд░реНрдбрд┐рдВрдЧ рд╕рдВрд╕рд╛рдзрд┐рдд рдирд╣реАрдВ рд╣реБрдИ рд╣реИред </font><font style="vertical-align: inherit;">рдЕрдм, рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдХрд┐рд╕ рд╕реНрддрдВрдн рдХрд╛ рдордзреНрдп рдирд╛рдо рд╣реИред </font><font style="vertical-align: inherit;">рдХреЗрд╡рд▓ рджреЛ </font><i><font style="vertical-align: inherit;">рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ</font></i><font style="vertical-align: inherit;"> - </font><i><font style="vertical-align: inherit;">name1, name2</font></i><font style="vertical-align: inherit;"> , рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдкрд╣рд▓реЗ рд╕реНрдерд╛рди рдкрд░ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдПрдХ рдмрд╛рд░ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЗрд╕рдХреЗ рдмрд┐рдирд╛ рдПрдХ рдирдпрд╛ рдирд╛рдо рдПрдХрддреНрд░ рдХрд░реЗрдВрдЧреЗред</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>name</th>
<th><u>name0</u></th>
<th><u>name1</u></th>
<th><u>name2</u></th>
<th>...</th>
<th>name raw</th>
</tr>
<tr>
<td>0</td>
<td>Lekomtsev Denis Nikolaevich</td>
<td><u>Lekomtsev</u></td>
<td><u>Denis</u></td>
<td><u>Nikolaevich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>1</td>
<td>Ivanov Andrey Aleksandrovich</td>
<td><u>Ivanov</u></td>
<td><u>Andrey</u></td>
<td><u>Aleksandrovich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>2</td>
<td>Ivanov Evgeniy Vasilevich</td>
<td><u>Ivanov</u></td>
<td><u>Evgeniy</u></td>
<td><u>Vasilevich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>3</td>
<td>Setepov Vladislav</td>
<td></td>
<td></td>
<td></td>
<td>...</td>
<td> </td>
</tr>
<tr>
<td>4</td>
<td>Mishanin Sergey Yurevich</td>
<td><u>Mishanin</u></td>
<td><u>Sergey</u></td>
<td><u>Yurevich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>5</td>
<td>Baranov Andrey Aleksandrovich</td>
<td><u>Baranov</u></td>
<td><u>Andrey</u></td>
<td><u>Aleksandrovich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>6</td>
<td>Nakaryakov Dmitriy Valerevich</td>
<td><u>Nakaryakov</u></td>
<td><u>Dmitriy</u></td>
<td><u>Valerevich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>7</td>
<td>Tretyakov Dmitriy Valentinovich</td>
<td><u>Tretyakov</u></td>
<td><u>Dmitriy</u></td>
<td><u>Valentinovich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>8</td>
<td>Kuznetsov Stanislav Vladimirovich</td>
<td><u>Kuznetsov</u></td>
<td><u>Stanislav</u></td>
<td><u>Vladimirovich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>9</td>
<td>Dubrovin Maksim Sergeevich</td>
<td><u>Dubrovin</u></td>
<td><u>Maksim</u></td>
<td><u>Sergeevich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>10</td>
<td>Karpov Anatoliy Sergeevich</td>
<td><u>Karpov</u></td>
<td><u>Anatoliy</u></td>
<td><u>Sergeevich</u></td>
<td>...</td>
<td>  </td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> wp:    <font></font>
    n1=(<span class="hljs-string">''</span>.join(rd[e][<span class="hljs-string">'name1'</span>])).count(<span class="hljs-string">'vich'</span>)+(<span class="hljs-string">''</span>.join(rd[e][<span class="hljs-string">'name1'</span>])).count(<span class="hljs-string">'vna'</span>)<font></font>
    n2=(<span class="hljs-string">''</span>.join(rd[e][<span class="hljs-string">'name2'</span>])).count(<span class="hljs-string">'vich'</span>)+(<span class="hljs-string">''</span>.join(rd[e][<span class="hljs-string">'name2'</span>])).count(<span class="hljs-string">'vna'</span>)<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (n1 &gt; n2):<font></font>
        rd[e][<span class="hljs-string">'new name'</span>] = rd[e][<span class="hljs-string">'name0'</span>] + <span class="hljs-string">' '</span> + rd[e][<span class="hljs-string">'name2'</span>]
    <span class="hljs-keyword">else</span>:<font></font>
        rd[e][<span class="hljs-string">'new name'</span>] = rd[e][<span class="hljs-string">'name0'</span>] + <span class="hljs-string">' '</span> + rd[e][<span class="hljs-string">'name1'</span>]
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>name</th>
<th>name0</th>
<th>name1</th>
<th>name2</th>
<th><u>new name</u></th>
<th>name raw</th>
</tr>
<tr>
<td>0</td>
<td>Gorik Pavel Vladimirovich</td>
<td>Gorik</td>
<td>Pavel</td>
<td>Vladimirovich</td>
<td><u>Gorik Pavel</u></td>
<td>  </td>
</tr>
<tr>
<td>1</td>
<td>Korobov Oleg Anatolevich</td>
<td>Korobov</td>
<td>Oleg</td>
<td>Anatolevich</td>
<td><u>Korobov Oleg</u></td>
<td>  </td>
</tr>
<tr>
<td>2</td>
<td>Pavlishchev Yaroslav Stanislavovich</td>
<td>Pavlishchev</td>
<td>Yaroslav</td>
<td>Stanislavovich</td>
<td><u>Pavlishchev Yaroslav</u></td>
<td>  </td>
</tr>
<tr>
<td>3</td>
<td>Fedorov Nikolay Nikolaevich</td>
<td>Fedorov</td>
<td>Nikolay</td>
<td>Nikolaevich</td>
<td><u>Fedorov Nikolay</u></td>
<td>  </td>
</tr>
<tr>
<td>4</td>
<td>Medvedev Andrey Aleksandrovich</td>
<td>Medvedev</td>
<td>Andrey</td>
<td>Aleksandrovich</td>
<td><u>Medvedev Andrey</u></td>
<td>  </td>
</tr>
<tr>
<td>5</td>
<td>Popov Sergey Eduardovich</td>
<td>Popov</td>
<td>Sergey</td>
<td>Eduardovich</td>
<td><u>Popov Sergey</u></td>
<td>  </td>
</tr>
<tr>
<td>6</td>
<td>Dumchev Andrey Viktorovich</td>
<td>Dumchev</td>
<td>Andrey</td>
<td>Viktorovich</td>
<td><u>Dumchev Andrey</u></td>
<td>  </td>
</tr>
<tr>
<td>7</td>
<td>Trusov Mikhail Vladimirovich</td>
<td>Trusov</td>
<td>Mikhail</td>
<td>Vladimirovich</td>
<td><u>Trusov Mikhail</u></td>
<td>  </td>
</tr>
<tr>
<td>8</td>
<td>Demichev Yuriy Anatolevich</td>
<td>Demichev</td>
<td>Yuriy</td>
<td>Anatolevich</td>
<td><u>Demichev Yuriy</u></td>
<td>  </td>
</tr>
<tr>
<td>9</td>
<td>Pushkin Boris Sergeevich</td>
<td>Pushkin</td>
<td>Boris</td>
<td>Sergeevich</td>
<td><u>Pushkin Boris</u></td>
<td>  </td>
</tr>
<tr>
<td>10</td>
<td>Lando Aleksandr Borisovich</td>
<td>Lando</td>
<td>Aleksandr</td>
<td>Borisovich</td>
<td><u>Lando Aleksandr</u></td>
<td>  </td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм, рдирдП рдирд╛рдо рдХреЛ рдореБрдЦреНрдп рдХреЙрд▓рдо </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд╛рдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реЗ рд╕рд╛рд╡рдзрд╛рдиреАрдкреВрд░реНрд╡рдХ рдЕрд╕рд╛рдЗрди </font><i><font style="vertical-align: inherit;">рдХрд░реЗрдВ</font></i><font style="vertical-align: inherit;"> , рдЬрд╣рд╛рдВ рдпрд╣ рдЦрд╛рд▓реА рдирд╣реАрдВ рд╣реИ, рдФрд░ рд╕рд╣рд╛рдпрдХ рдХреЙрд▓рдо рдХреЛ рд╣рдЯрд╛ рджреЗрдВред</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> wp:<font></font>
    ind = rd[e][rd[e][<span class="hljs-string">'new name'</span>].str.strip() != <span class="hljs-string">''</span>].index<font></font>
    rd[e].loc[ind, <span class="hljs-string">'name'</span>] = rd[e].loc[ind, <span class="hljs-string">'new name'</span>]<font></font>
    rd[e] = rd[e].drop(columns = [<span class="hljs-string">'name0'</span>,<span class="hljs-string">'name1'</span>,<span class="hljs-string">'name2'</span>,<span class="hljs-string">'new name'</span>])
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th><u>name</u></th>
<th>country</th>
<th>...</th>
<th>name raw</th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td><u>Yaroslav Pavlishchev</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td><u>Vladimir Perezhigin</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td><u>Vladislav Litvinchuk</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>3</td>
<td>4</td>
<td>M</td>
<td><u>Sergey Gavrilenko</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>M</td>
<td><u>Ivan Markin</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>5</td>
<td>6</td>
<td>M</td>
<td><u>Nikolay Sokolov</u></td>
<td>RUS</td>
<td>...</td>
<td>Nikolay Evgenevich Sokolov</td>
</tr>
<tr>
<td>6</td>
<td>7</td>
<td>M</td>
<td><u>Aram Kukhtiev</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>7</td>
<td>8</td>
<td>M</td>
<td><u>Andrey Andreev</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>8</td>
<td>9</td>
<td>M</td>
<td><u>Denis Bulgakov</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>9</td>
<td>10</td>
<td>M</td>
<td><u>Aleksandr Kuts</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>10</td>
<td>11</td>
<td>M</td>
<td><u>Aleksandr Lando</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддреЛ рд╡рд╣ рд╕рдм рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдордиреЗ 2,035 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХрд╛ рд╕рдВрдкрд╛рджрди рдХрд┐рдпрд╛ред </font><font style="vertical-align: inherit;">рдмреБрд░рд╛ рдирд╣реАрдВред </font><font style="vertical-align: inherit;">рдмрдЪрд╛рдпрд╛ред</font></font><br>
<br>
<pre><code class="python hljs">pkl.dump(rd, open(<span class="hljs-string">r'D:\tri\details5.pkl'</span>, <span class="hljs-string">'wb'</span>))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рдЖрдкрдХреЛ рдирд╛рдореЛрдВ рдХреЛ рдЙрд╕реА рдХреНрд░рдо рдореЗрдВ рд▓рд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣реА рд╣реИ, рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХрд┐ рд╕рднреА рдкреНрд░реЛрдЯреЛрдХреЙрд▓реЛрдВ рдореЗрдВ рдкрд╣рд▓реЗ рдирд╛рдо рдХреЗ рдмрд╛рдж рдЕрдВрддрд┐рдо рдирд╛рдо, рдпрд╛ рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрдд - рдкрд╣рд▓рд╛ рдЕрдВрддрд┐рдо рдирд╛рдо, рдлрд┐рд░ рдкрд╣рд▓рд╛ рдирд╛рдо, рд╕рднреА рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдореЗрдВ рднреАред </font><font style="vertical-align: inherit;">рдХрд┐рд╕ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ, рдЕрдм рд╣рдо рдкрддрд╛ рд▓рдЧрд╛рдПрдВрдЧреЗред </font><font style="vertical-align: inherit;">рд╕реНрдерд┐рддрд┐ рдЗрд╕ рддрдереНрдп рд╕реЗ рдереЛрдбрд╝реА рдЬрдЯрд┐рд▓ рд╣реИ рдХрд┐ рдкреВрд░рд╛ рдирд╛рдо рджреЛ рд╕реЗ рдЕрдзрд┐рдХ рд╢рдмреНрджреЛрдВ рд╕реЗ рдорд┐рд▓рдХрд░ рдмрдирд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рднрд▓реЗ рд╣реА рд╣рдордиреЗ рдмреАрдЪ рдХрд╛ рдирд╛рдо рд╣рдЯрд╛ рджрд┐рдпрд╛ рд╣реЛред</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'nwin'</span>] = ar[<span class="hljs-string">'name'</span>].str.count(<span class="hljs-string">' '</span>) + <span class="hljs-number">1</span> <span class="hljs-comment"># nwin тАУ number of words in name</span>
ar.loc[ar[<span class="hljs-string">'name'</span>] == <span class="hljs-string">''</span>,<span class="hljs-string">'nwin'</span>] = <span class="hljs-number">0</span>
<span class="hljs-number">100</span>*ar[<span class="hljs-string">'nwin'</span>].value_counts()/len(ar)
</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдХ рдирд╛рдо рдореЗрдВ рд╢рдмреНрджреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рд░рд┐рдХреЙрд░реНрдбреНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛ рд░рд┐рдХреЙрд░реНрдбреНрд╕ (%) </font><font style="vertical-align: inherit;">рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдмреЗрд╢рдХ, рд╡рд┐рд╢рд╛рд▓ рдмрд╣реБрдордд (91%) рджреЛ рд╢рдмреНрдж рд╣реИрдВ - рд╕рд┐рд░реНрдл рдПрдХ рдирд╛рдо рдФрд░ рдПрдХ рдЙрдкрдирд╛рдоред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рддреАрди рдФрд░ рдЪрд╛рд░ рд╢рдмреНрджреЛрдВ рд╡рд╛рд▓реА рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдВ рднреА рдмрд╣реБрдд рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЖрдЗрдП рдирдЬрд░ рдбрд╛рд▓рддреЗ рд╣реИрдВ рдРрд╕реЗ рд░рд┐рдХреЙрд░реНрдбреНрд╕ рдХреА рд░рд╛рд╖реНрдЯреНрд░реАрдпрддрд╛ рдкрд░:</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>   </th>
<th> </th>
<th>  (%)</th>
</tr>
<tr>
<td>2</td>
<td>1285270</td>
<td>90.74426</td>
</tr>
<tr>
<td>3</td>
<td>102220</td>
<td>7.217066</td>
</tr>
<tr>
<td>4</td>
<td>22420</td>
<td>1.582925</td>
</tr>
<tr>
<td>0</td>
<td>3454</td>
<td>0.243864</td>
</tr>
<tr>
<td>5</td>
<td>2385</td>
<td>0.168389</td>
</tr>
<tr>
<td>6</td>
<td>469</td>
<td>0.033113</td>
</tr>
<tr>
<td>1</td>
<td>80</td>
<td>0.005648</td>
</tr>
<tr>
<td>7</td>
<td>57</td>
<td>0.004024</td>
</tr>
<tr>
<td>8</td>
<td>5</td>
<td>0.000353</td>
</tr>
<tr>
<td>10</td>
<td>4</td>
<td>0.000282</td>
</tr>
<tr>
<td>9</td>
<td>1</td>
<td>0.000071</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar[ar[<span class="hljs-string">'nwin'</span>] &gt;= <span class="hljs-number">3</span>][<span class="hljs-string">'country'</span>].value_counts()[:<span class="hljs-number">12</span>]
</code></pre><br>
<code><b>Out: </b><br>
ESP 28435<br>
MEX 10561<br>
USA 7608<br>
DNK 7178<br>
BRA 6321<br>
NLD 5748<br>
DEU 4310<br>
PHL 3941<br>
ZAF 3862<br>
ITA 3691<br>
BEL 3596<br>
FRA 3323<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдареАрдХ рд╣реИ, рдкрд╣рд▓реЗ рд╕реНрдерд╛рди рдкрд░ рд╕реНрдкреЗрди рд╣реИ, рджреВрд╕рд░реЗ рдореЗрдВ - рдореИрдХреНрд╕рд┐рдХреЛ, рдПрдХ рд╣рд┐рд╕реНрдкреИрдирд┐рдХ рджреЗрд╢, рд╕рдВрдпреБрдХреНрдд рд░рд╛рдЬреНрдп рдЕрдореЗрд░рд┐рдХрд╛ рд╕реЗ рдЖрдЧреЗ, рдЬрд╣рд╛рдВ рдРрддрд┐рд╣рд╛рд╕рд┐рдХ рд░реВрдк рд╕реЗ рдмрд╣реБрдд рд╕рд╛рд░реЗ рд╣рд┐рд╕реНрдкреИрдирд┐рдХ рднреА рд╣реИрдВред рдмреНрд░рд╛рдЬреАрд▓ рдФрд░ рдлрд┐рд▓реАрдкреАрдВрд╕ рднреА рд╕реНрдкреЗрдирд┐рд╢ (рдФрд░ рдкреБрд░реНрддрдЧрд╛рд▓реА) рдирд╛рдо рд╣реИрдВред рдбреЗрдирдорд╛рд░реНрдХ, рдиреАрджрд░рд▓реИрдВрдб, рдЬрд░реНрдордиреА, рджрдХреНрд╖рд┐рдг рдЕрдлреНрд░реАрдХрд╛, рдЗрдЯрд▓реА, рдмреЗрд▓реНрдЬрд┐рдпрдо рдФрд░ рдлреНрд░рд╛рдВрд╕ рдПрдХ рдФрд░ рдорд╛рдорд▓рд╛ рд╣реИ, рдмрд╕ рдХрднреА-рдХрднреА рдЙрдкрдирд╛рдо рдХреЗ рд▓рд┐рдП рдХрд┐рд╕реА рдкреНрд░рдХрд╛рд░ рдХрд╛ рдЙрдкрд╕рд░реНрдЧ рдЖрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рджреЛ рд╕реЗ рдЕрдзрд┐рдХ рд╢рдмреНрдж рд╣реИрдВред рдЗрди рд╕рднреА рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдорддреМрд░ рдкрд░ рдирд╛рдо рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ рд╢рдмреНрдж рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рджреЛ, рддреАрди рдХрд╛ рдЙрдкрдирд╛рдоред рдмреЗрд╢рдХ, рдЗрд╕ рдирд┐рдпрдо рдХреЗ рдЕрдкрд╡рд╛рдж рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╣рдо рдЙрдиреНрд╣реЗрдВ рдЕрдм рд╕рдВрд╕рд╛рдзрд┐рдд рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗред рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдХреНрд░рдо рд╣реИ: рдирд╛рдо-рдЙрдкрдирд╛рдо рдпрд╛ рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрддред рдпрд╣ рдХреИрд╕реЗ рдХрд░рдирд╛ рд╣реИ? рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╡рд┐рдЪрд╛рд░ рдореБрдЭреЗ рд╣реБрдЖ: рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЙрдкрдирд╛рдо рдХреА рд╡рд┐рд╡рд┐рдзрддрд╛ рдЖрдорддреМрд░ рдкрд░ рдирд╛рдореЛрдВ рдХреА рд╡рд┐рд╡рд┐рдзрддрд╛ рд╕реЗ рдмрд╣реБрдд рдЕрдзрд┐рдХ рд╣реИред рдпрд╣ рдПрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдврд╛рдВрдЪреЗ рдХреЗ рднреАрддрд░ рднреА рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред рджреВрд╕рд░реЗ,рдкрд╣рд▓реЗ рдирд╛рдо рдХреА рд▓рдВрдмрд╛рдИ рдЖрдорддреМрд░ рдкрд░ рдЕрдВрддрд┐рдо рдирд╛рдо (рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдЧреИрд░-рд╕рдВрдпреБрдХреНрдд рдЕрдВрддрд┐рдо рдирд╛рдореЛрдВ рдХреЗ рд▓рд┐рдП) рдХреА рд▓рдВрдмрд╛рдИ рд╕реЗ рдХрдо рд╣реИред рд╣рдо рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЖрджреЗрд╢ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрди рдорд╛рдирджрдВрдбреЛрдВ рдХреЗ рд╕рдВрдпреЛрдЬрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреВрд░реНрдг рдирд╛рдо рдореЗрдВ рдкрд╣рд▓реЗ рдФрд░ рдЕрдВрддрд┐рдо рд╢рдмреНрдж рдЪреБрдиреЗрдВ:</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'new name'</span>] = ar[<span class="hljs-string">'name'</span>]<font></font>
ind = ar[ar[<span class="hljs-string">'nwin'</span>] &lt; <span class="hljs-number">2</span>].index<font></font>
ar.loc[ind, <span class="hljs-string">'new name'</span>] = <span class="hljs-string">'. .'</span> <span class="hljs-comment">#  ,   str.split()   </span>
ar[<span class="hljs-string">'wfin'</span>] = ar[<span class="hljs-string">'new name'</span>].str.split().str[<span class="hljs-number">0</span>] <span class="hljs-comment">#fwin  тАУ first word in name</span>
ar[<span class="hljs-string">'lwin'</span>] = ar[<span class="hljs-string">'new name'</span>].str.split().str[<span class="hljs-number">-1</span>]<span class="hljs-comment">#lfin тАУ last word in name</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рдВрдпреБрдХреНрдд </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдбреЗрдЯрд╛ рдлреНрд░реЗрдо рдХреЛ </font><font style="vertical-align: inherit;">рд╡рд╛рдкрд╕ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдбрд┐рдХреНрд╢рдирд░реА рдореЗрдВ </font><font style="vertical-align: inherit;">рдХрдирд╡рд░реНрдЯ рдХрд░реЗрдВ </font><font style="vertical-align: inherit;">рддрд╛рдХрд┐ рдирдП рдХреЙрд▓рдо </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nwin, ns0, ns</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреНрд░рддреНрдпреЗрдХ рд░реЗрд╕ рдХреЗ рдбреЗрдЯрд╛ рдлреНрд░реЗрдо рдореЗрдВ рдЖ рдЬрд╛рдПрдВред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдмрд╛рдж, рд╣рдо рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреА рд╕рдВрдЦреНрдпрд╛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреНрд░рдердо </font><i><font style="vertical-align: inherit;">рдирд╛рдо рдЕрдВрддрд┐рдо рдирд╛рдо"</font></i><font style="vertical-align: inherit;"> рдФрд░ рд╣рдорд╛рд░реА рдорд╛рдирджрдВрдб рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд░рд┐рд╡рд░реНрд╕ рдСрд░реНрдбрд░ рдХреЗ рд╕рд╛рде рдкреНрд░реЛрдЯреЛрдХреЙрд▓ </font><font style="vertical-align: inherit;">рдХреА рд╕рдВрдЦреНрдпрд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рд╣рдо рдХреЗрд╡рд▓ рдЙрди рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВрдЧреЗ рдЬрд╣рд╛рдБ рдкреВрд░реНрдг рдирд╛рдо рдореЗрдВ рджреЛ рд╢рдмреНрдж рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЙрд╕реА рд╕рдордп, рдирд╛рдо (рдкрд╣рд▓рд╛ рдирд╛рдо) рдХреЛ рдПрдХ рдирдП рдХреЙрд▓рдо рдореЗрдВ рд╕рд╣реЗрдЬреЗрдВ:</font></font><br>
<br>
<pre><code class="python hljs">name_surname = {}<font></font>
surname_name = {}<font></font>
<font></font>
<span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> rd:<font></font>
    d = rd[e][rd[e][<span class="hljs-string">'nwin'</span>] == <span class="hljs-number">2</span>]<font></font>
<font></font>
    <span class="hljs-keyword">if</span> len(d[<span class="hljs-string">'fwin'</span>].unique()) &lt; len(d[<span class="hljs-string">'lwin'</span>].unique()) <span class="hljs-keyword">and</span> len(<span class="hljs-string">''</span>.join(d[<span class="hljs-string">'fwin'</span>])) &lt; len(<span class="hljs-string">''</span>.join(d[<span class="hljs-string">'lwin'</span>])):<font></font>
        name_surname[e] = d<font></font>
        rd[e][<span class="hljs-string">'first name'</span>] = rd[e][<span class="hljs-string">'fwin'</span>]<font></font>
<font></font>
    <span class="hljs-keyword">if</span> len(d[<span class="hljs-string">'fwin'</span>].unique()) &gt; len(d[<span class="hljs-string">'lwin'</span>].unique()) <span class="hljs-keyword">and</span> len(<span class="hljs-string">''</span>.join(d[<span class="hljs-string">'fwin'</span>])) &gt; len(<span class="hljs-string">''</span>.join(d[<span class="hljs-string">'lwin'</span>])):<font></font>
        surname_name[e] = d<font></font>
        rd[e][<span class="hljs-string">'first name'</span>] = rd[e][<span class="hljs-string">'lwin'</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдирд┐рдореНрди рдирд┐рдХрд▓рд╛: рдСрд░реНрдбрд░ </font><font style="vertical-align: inherit;">рдлрд░реНрд╕реНрдЯ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреЗрдо рд▓рд╛рд╕реНрдЯ рдиреЗрдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 244 рдкреНрд░реЛрдЯреЛрдХреЙрд▓, рдСрд░реНрдбрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рд╛рд╕реНрдЯ рдиреЗрдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдлрд░реНрд╕реНрдЯ - 1,508 рдкреНрд░реЛрдЯреЛрдХреЙрд▓ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рддрджрдиреБрд╕рд╛рд░, рд╣рдо рдЙрд╕ рдкреНрд░рд╛рд░реВрдк рдХрд╛ рдиреЗрддреГрддреНрд╡ рдХрд░реЗрдВрдЧреЗ рдЬреЛ рдЕрдзрд┐рдХ рд╕рд╛рдорд╛рдиреНрдп рд╣реИред </font><font style="vertical-align: inherit;">рд░рд╛рд╢рд┐ рдХреБрд▓ рд░рд╛рд╢рд┐ рд╕реЗ рдХрдо рд╣реЛ рдЧрдИ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдордиреЗ рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рджреЛ рдорд╛рдирджрдВрдбреЛрдВ рдХреА рдкреВрд░реНрддрд┐ рдХреЗ рд▓рд┐рдП рдЬрд╛рдБрдЪ рдХреА, рдФрд░ рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рд╕рдЦреНрдд рдЕрд╕рдорд╛рдирддрд╛ рдХреЗ рд╕рд╛рде рднреАред </font><font style="vertical-align: inherit;">рдРрд╕реЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИрдВ рдЬрд┐рдирдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ рдорд╛рдкрджрдВрдб рдкреВрд░рд╛ рд╣реЛрддрд╛ рд╣реИ, рдпрд╛ рдпрд╣ рд╕рдВрднрд╡ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╕рдВрднрд╛рд╡рдирд╛ рдирд╣реАрдВ рд╣реИ рдХрд┐ рд╕рдорд╛рдирддрд╛ рд╣реЛред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдпрд╣ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдорд╣рддреНрд╡рд╣реАрди рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдкреНрд░рд╛рд░реВрдк рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм, рдпрд╣ рдорд╛рдирддреЗ рд╣реБрдП рдХрд┐ рд╣рдордиреЗ рдЖрджреЗрд╢ рдХреЛ рдкрд░реНрдпрд╛рдкреНрдд рд░реВрдк рд╕реЗ рдЙрдЪреНрдЪ рд╕рдЯреАрдХрддрд╛ рдХреЗ рд╕рд╛рде рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рд╣реИ, рдЬрдмрдХрд┐ рдпрд╣ рди рднреВрд▓реЗрдВ рдХрд┐ рдпрд╣ 100% рд╕рдЯреАрдХ рдирд╣реАрдВ рд╣реИ, рд╣рдо рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╣рд▓реЗ рдирд╛рдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЙрд▓рдо рд╕реЗ рд╕рдмрд╕реЗ рд▓реЛрдХрдкреНрд░рд┐рдп рдирд╛рдо рдЦреЛрдЬреЗрдВ </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="python hljs">vc = ar[<span class="hljs-string">'first name'</span>].value_counts()
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬреЛ рд╕реМ рд╕реЗ рдЕрдзрд┐рдХ рдмрд╛рд░ рдорд┐рд▓ рдЪреБрдХреЗ рд╣реИрдВ рдЙрдиреНрд╣реЗрдВ рд▓реЗрдВ:</font></font><br>
<br>
<pre><code class="python hljs">pfn=vc[vc&gt;<span class="hljs-number">100</span>] <span class="hljs-comment">#pfn тАУ popular first names</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЙрдирдореЗрдВ рд╕реЗ 1,673 рдереЗред рдпрд╣рд╛рдВ рдЙрдирдореЗрдВ рд╕реЗ рдкрд╣рд▓реЗ рд╕реМ рд╣реИрдВ, рдЬрд┐рдиреНрд╣реЗрдВ рд▓реЛрдХрдкреНрд░рд┐рдпрддрд╛ рдХреЗ рдЕрд╡рд░реЛрд╣реА рдХреНрд░рдо рдореЗрдВ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: </font><font style="vertical-align: inherit;">
рдЕрдм, рдЗрд╕ рд╕реВрдЪреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рд╣рдо рд╕рднреА рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЪрд▓реЗрдВрдЧреЗ рдФрд░ рддреБрд▓рдирд╛ рдХрд░реЗрдВрдЧреЗ рдЬрд╣рд╛рдВ рдЕрдзрд┐рдХ рдореИрдЪ рд╣реИрдВ - рдирд╛рдо рдХреЗ рдкрд╣рд▓реЗ рд╢рдмреНрдж рдореЗрдВ рдпрд╛ рдЖрдЦрд┐рд░реА рдореЗрдВред рд╣рдо рдХреЗрд╡рд▓ рджреЛ-рд╢рдмреНрдж рдирд╛рдореЛрдВ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВрдЧреЗред рдпрджрд┐ рдЕрдВрддрд┐рдо рд╢рдмреНрдж рдХреЗ рд╕рд╛рде рдЕрдзрд┐рдХ рдорд┐рд▓рд╛рди рд╣реИрдВ, рддреЛ рдЖрджреЗрд╢ рд╕рд╣реА рд╣реИ, рдпрджрд┐ рдкрд╣рд▓реЗ рдХреЗ рд╕рд╛рде, рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╡рд┐рдкрд░реАрдд рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрд╣рд╛рдВ рд╣рдо рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЕрдзрд┐рдХ рдЖрд╢реНрд╡рд╕реНрдд рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЖрдк рдЗрд╕ рдЬреНрдЮрд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рдкрд╛рд╕ рдХреЗ рд╕рд╛рде рд▓реЛрдХрдкреНрд░рд┐рдп рдирд╛рдореЛрдВ рдХреА рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реВрдЪреА рдореЗрдВ рдЙрдирдХреЗ рдЕрдЧрд▓реЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдирд╛рдореЛрдВ рдХреА рд╕реВрдЪреА рдЬреЛрдбрд╝ рджреЗрдВрдЧреЗред рд╣рдо рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рддреНрд░реБрдЯрд┐рдпреЛрдВ рд╕реЗ рдмрдЪрдиреЗ рдФрд░ рдЙрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдзрд┐рдХ рд╡реНрдпрд╛рдкрдХ рд╕реВрдЪреА рддреИрдпрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬреЛ рд╕реВрдЪреА рдореЗрдВ рдХреБрдЫ рдореИрдЪ рд╣реИрдВ рдФрд░ рдЬрд┐рдиреНрд╣реЗрдВ рдЪрдХреНрд░ рдХреЗ рдЕрдВрдд рдХреЗ рдкрд╛рд╕ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реВрдЪреА рд╕реЗ рдирд╛рдореЛрдВ рдХреА рдШрдЯрдирд╛ рдХреА рдЖрд╡реГрддреНрддрд┐ рджреНрд╡рд╛рд░рд╛ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкреВрд░реНрд╡-рдкреНрд░рдХрд╛рд░ рдХрд░рддреЗ рд╣реИрдВред</font></font><br>
<code>['Michael', 'David', 'Thomas', 'John', 'Daniel', 'Mark', 'Peter', 'Paul', 'Christian', 'Robert', 'Martin', 'James', 'Andrew', 'Chris', 'Richard', 'Andreas', 'Matthew', 'Brian', 'Patrick', 'Scott', 'Kevin', 'Stefan', 'Jason', 'Eric', 'Christopher', 'Alexander', 'Simon', 'Mike', 'Tim', 'Frank', 'Stephen', 'Steve', 'Andrea', 'Jonathan', 'Markus', 'Marco', 'Adam', 'Ryan', 'Jan', 'Tom', 'Marc', 'Carlos', 'Jennifer', 'Matt', 'Steven', 'Jeff', 'Sergey', 'William', 'Aleksandr', 'Sarah', 'Alex', 'Jose', 'Andrey', 'Benjamin', 'Sebastian', 'Ian', 'Anthony', 'Ben', 'Oliver', 'Antonio', 'Ivan', 'Sean', 'Manuel', 'Matthias', 'Nicolas', 'Dan', 'Craig', 'Dmitriy', 'Laura', 'Luis', 'Lisa', 'Kim', 'Anna', 'Nick', 'Rob', 'Maria', 'Greg', 'Aleksey', 'Javier', 'Michelle', 'Andre', 'Mario', 'Joseph', 'Christoph', 'Justin', 'Jim', 'Gary', 'Erik', 'Andy', 'Joe', 'Alberto', 'Roberto', 'Jens', 'Tobias', 'Lee', 'Nicholas', 'Dave', 'Tony', 'Olivier', 'Philippe']<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">sbpn = pd.DataFrame(columns = [<span class="hljs-string">'event'</span>, <span class="hljs-string">'num pop names'</span>], index=range(len(rd))) <span class="hljs-comment"># sbpn - sorted by popular names</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(rd)):<font></font>
    e = list(rd.keys())[i]<font></font>
    sbpn.loc[i, <span class="hljs-string">'event'</span>] = e<font></font>
    sbpn.loc[i, <span class="hljs-string">'num pop names'</span>] = len(set(pfn).intersection(rd[e][<span class="hljs-string">'first name'</span>]))<font></font>
<font></font>
sbnp=sbnp.sort_values(by = <span class="hljs-string">'num pop names'</span>,ascending=<span class="hljs-literal">False</span>)<font></font>
sbnp = sbnp.reset_index(drop=<span class="hljs-literal">True</span>) 
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th>num pop names</th>
</tr>
<tr>
<td>0</td>
<td>Ironman World Championship 70.3 2016</td>
<td>811</td>
</tr>
<tr>
<td>1</td>
<td>Ironman World Championship 2019</td>
<td>781</td>
</tr>
<tr>
<td>2</td>
<td>Ironman World Championship 70.3 2015</td>
<td>778</td>
</tr>
<tr>
<td>3</td>
<td>Ironman Mallorca 70.3 2014</td>
<td>776</td>
</tr>
<tr>
<td>4</td>
<td>Ironman World Championship 2018</td>
<td>766</td>
</tr>
<tr>
<td>5</td>
<td>Challenge Roth Long 2019</td>
<td>759</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td>1917</td>
<td>Challenge Gran Canaria Olympic 2019</td>
<td>0</td>
</tr>
<tr>
<td>1918</td>
<td>Challenge Gran Canaria Middle 2017</td>
<td>0</td>
</tr>
<tr>
<td>1919</td>
<td>Challenge Forte Village-Sardinia Sprint 2017</td>
<td>0</td>
</tr>
<tr>
<td>1920</td>
<td>ITU European Cup Kuopio Sprint 2007</td>
<td>0</td>
</tr>
<tr>
<td>1921</td>
<td>ITU World Cup Madeira Olympic 2002</td>
<td>0</td>
</tr>
</tbody></table></div></code><br>
<br>
<pre><code class="python hljs">tofix = []<font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(rd)):<font></font>
    e = sbpn.loc[i, <span class="hljs-string">'event'</span>]<font></font>
<font></font>
    <span class="hljs-keyword">if</span> len(set(list(rd[e][<span class="hljs-string">'fwin'</span>])).intersection(pfn)) &gt; len(set(list(rd[e][<span class="hljs-string">'lwin'</span>])).intersection(pfn)):<font></font>
        tofix.append(e)<font></font>
        pfn = list(set(pfn + list(rd[e][<span class="hljs-string">'fwin'</span>])))
    <span class="hljs-keyword">else</span>:<font></font>
        pfn = list(set(pfn + list(rd[e][<span class="hljs-string">'lwin'</span>])))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
235 рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдереЗред рдпрд╣реА рд╣реИ, рдЙрд╕реА рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬреЛ рдкрд╣рд▓реЗ рд╕рдиреНрдирд┐рдХрдЯрди (244) рдореЗрдВ рд╣реБрдЖ рдерд╛ред рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдореИрдВрдиреЗ рдЪреБрдирд┐рдВрджрд╛ рд░реВрдк рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рд╕реЗ рдкрд╣рд▓реЗ рддреАрди рд░рд┐рдХреЙрд░реНрдбреЛрдВ рдХреЛ рджреЗрдЦрд╛, рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд┐рдпрд╛ рдХрд┐ рд╕рдм рдХреБрдЫ рд╕рд╣реА рдерд╛ред рдпрд╣ рднреА рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рд╕реЙрд░реНрдЯрд┐рдВрдЧ рдХреЗ рдкрд╣рд▓реЗ рдЪрд░рдг рдореЗрдВ рдХреНрд▓рд╛рд╕ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреЗрдо рд╕рд░рдиреЗрдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реЗ 36 рдЭреВрдареА рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдВ рджреАрдВ </font><font style="vertical-align: inherit;">рдФрд░ рдХреНрд▓рд╛рд╕ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреЗрдо рдХреЗ рдирд╛рдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реЗ 2 рдЭреВрдареЗ </font><font style="vertical-align: inherit;">ред рдореИрдВрдиреЗ рдкреНрд░рддреНрдпреЗрдХ рд╕реЗ рдкрд╣рд▓реЗ рддреАрди рд░рд┐рдХреЙрд░реНрдб рдХреЛ рджреЗрдЦрд╛, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рджреВрд╕рд░реЗ рдЪрд░рдг рдиреЗ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдХрд╛рдо рдХрд┐рдпрд╛ред рдЕрдм, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рдЙрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛ рд╣реБрдЖ рд╣реИ рдЬрд╣рд╛рдВ рдЧрд▓рдд рдХреНрд░рдо рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> tofix:<font></font>
    ind = rd[e][rd[e][<span class="hljs-string">'nwin'</span>] &gt; <span class="hljs-number">1</span>].index<font></font>
    rd[e].loc[ind,<span class="hljs-string">'name'</span>] = rd[e].loc[ind,<span class="hljs-string">'name'</span>].str.split(n=<span class="hljs-number">1</span>).str[<span class="hljs-number">1</span>] + <span class="hljs-string">' '</span> +                   rd[e].loc[ind,<span class="hljs-string">'name'</span>].str.split(n=<span class="hljs-number">1</span>).str[<span class="hljs-number">0</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣рд╛рдБ рд╡рд┐рднрд╛рдЬрди рдореЗрдВ, рд╣рдордиреЗ рдкреИрд░рд╛рдореАрдЯрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЯреБрдХрдбрд╝реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рд╕реАрдорд┐рдд рдХрд┐рдпрд╛ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рддрд░реНрдХ рдпрд╣ рд╣реИ: рдПрдХ рдирд╛рдо рдПрдХ рд╢рдмреНрдж рд╣реИ, рдПрдХ рдкреВрд░реНрдг рдирд╛рдо рдореЗрдВ рдкрд╣рд▓рд╛ред </font><font style="vertical-align: inherit;">рдмрд╛рдХреА рд╕рдм рдПрдХ рдЙрдкрдирд╛рдо рд╣реИ (рдХрдИ рд╢рдмреНрджреЛрдВ рд╕реЗ рдорд┐рд▓рдХрд░ рдмрдирд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ)ред </font><font style="vertical-align: inherit;">рдмрд╕ рдЙрдиреНрд╣реЗрдВ рд╕реНрд╡реИрдк рдХрд░реЗрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╣рдо рдЕрдирд╛рд╡рд╢реНрдпрдХ рд╕реНрддрдВрднреЛрдВ рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛рддреЗ рд╣реИрдВ рдФрд░ рдмрдЪрд╛рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> rd:<font></font>
    rd[e] = rd[e].drop(columns = [<span class="hljs-string">'new name'</span>, <span class="hljs-string">'first name'</span>, <span class="hljs-string">'fwin'</span>,<span class="hljs-string">'lwin'</span>, <span class="hljs-string">'nwin'</span>])<font></font>
<font></font>
pkl.dump(rd, open(<span class="hljs-string">r'D:\tri\details6.pkl'</span>, <span class="hljs-string">'wb'</span>))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкрд░рд┐рдгрд╛рдо рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВред </font><font style="vertical-align: inherit;">рдПрдХ рджрд░реНрдЬрди рд╕реЗ рдЕрдзрд┐рдХ рддрдп рд░рд┐рдХреЙрд░реНрдбреНрд╕: </font><font style="vertical-align: inherit;">рдХреБрд▓ 108 рд╣рдЬрд╛рд░ рд░рд┐рдХреЙрд░реНрдбреНрд╕ рддрдп рдХрд┐рдП рдЧрдПред </font><font style="vertical-align: inherit;">рдЕрджреНрд╡рд┐рддреАрдп рдкреВрд░реНрдг рдирд╛рдореЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ 598 рд╕реЗ рдШрдЯрдХрд░ 547 рд╣рдЬрд╛рд░ рд╣реЛ рдЧрдИред </font><font style="vertical-align: inherit;">рдареАрдХ! </font><font style="vertical-align: inherit;">рд╕реНрд╡рд░реВрдкрдг рдХреЗ рд╕рд╛рдеред</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th><u>name</u></th>
<th>country</th>
<th>group</th>
<th>...</th>
<th><u>name raw</u></th>
</tr>
<tr>
<td>188</td>
<td>189</td>
<td>M</td>
<td><u>Azhel Dmitriy</u></td>
<td>BLR</td>
<td></td>
<td>...</td>
<td><u> </u></td>
</tr>
<tr>
<td>96</td>
<td>97</td>
<td>M</td>
<td><u>Bostina Cristian</u></td>
<td>ROU</td>
<td></td>
<td>...</td>
<td><u>Cristian Bostina</u></td>
</tr>
<tr>
<td>1757</td>
<td>1758</td>
<td>M</td>
<td><u>Lowe Jonathan</u></td>
<td>AUS</td>
<td>M30-34</td>
<td>...</td>
<td><u>Jonathan LOWE</u></td>
</tr>
<tr>
<td>599</td>
<td>600</td>
<td>M</td>
<td><u>Baerwald Manuel</u></td>
<td>DEU</td>
<td></td>
<td>...</td>
<td><u>Manuel BAERWALD</u></td>
</tr>
<tr>
<td>657</td>
<td>658</td>
<td>M</td>
<td><u>Krumdieck Ralf</u></td>
<td>DEU</td>
<td></td>
<td>...</td>
<td><u>Ralf KRUMDIECK</u></td>
</tr>
<tr>
<td>354</td>
<td>355</td>
<td>F</td>
<td><u>Knapp Samantha</u></td>
<td>USA</td>
<td>F30-34</td>
<td>...</td>
<td><u>Samantha Knapp</u></td>
</tr>
<tr>
<td>375</td>
<td>376</td>
<td>M</td>
<td><u>Rintalaulaja Mika</u></td>
<td>FIN</td>
<td>M40-44</td>
<td>...</td>
<td><u>Mika Rintalaulaja</u></td>
</tr>
<tr>
<td>1304</td>
<td>1305</td>
<td>M</td>
<td><u>Dee Jim</u></td>
<td>USA</td>
<td>M50-54</td>
<td>...</td>
<td><u>Jim DEE</u></td>
</tr>
<tr>
<td>178</td>
<td>179</td>
<td>M</td>
<td><u>Halibert Greg</u></td>
<td>FRA</td>
<td></td>
<td>...</td>
<td><u>GREG HALIBERT</u></td>
</tr>
<tr>
<td>2740</td>
<td>2741</td>
<td>F</td>
<td><u>Comia Marissa</u></td>
<td>USA</td>
<td>F45-49</td>
<td>...</td>
<td><u>Marissa COMIA</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рднрд╛рдЧ 3. рдЕрдзреВрд░реЗ рдбреЗрдЯрд╛ рдХреА рд╡рд╕реВрд▓реА</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд▓рд╛рдкрддрд╛ рдбреЗрдЯрд╛ рдХреЛ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдЧреЗ рдмрдврд╝реЗрдВред </font><font style="vertical-align: inherit;">рдФрд░ рдРрд╕реЗ рд╣реИрдВред</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреЗрд╢</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рджреЗрд╢ рд╕реЗ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЙрди рд╕рднреА рд░рд┐рдХреЙрд░реНрдбреЛрдВ рдХреЛ рдЦреЛрдЬреЗрдВ рдЬрд┐рдирдореЗрдВ рджреЗрд╢ рдХрд╛ рд╕рдВрдХреЗрдд рдирд╣реАрдВ рд╣реИ:</font></font><br>
<br>
<pre><code class="python hljs">arnc = ar[ar[<span class="hljs-string">'country'</span>] == <span class="hljs-string">''</span>] <span class="hljs-comment">#arnc тАУ all records with no country</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЙрдирдореЗрдВ рд╕реЗ 3,221 рд╣реИрдВред рдпрд╣рд╛рдВ 10 рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╣реИрдВ:</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th><u>country</u></th>
<th>group</th>
<th>...</th>
<th>country raw</th>
</tr>
<tr>
<td>...</td>
<td>1633</td>
<td>M</td>
<td>Guerrero Pla Angel</td>
<td></td>
<td>M30-34</td>
<td>...</td>
<td>E</td>
</tr>
<tr>
<td>...</td>
<td>258</td>
<td>M</td>
<td>Bellm Mathias</td>
<td></td>
<td>M35-39</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>655</td>
<td>M</td>
<td>Moratto Alessio</td>
<td></td>
<td>M40-44</td>
<td>...</td>
<td>I</td>
</tr>
<tr>
<td>...</td>
<td>1317</td>
<td>M</td>
<td>Solari Jean-Jacques</td>
<td></td>
<td>M50-54</td>
<td>...</td>
<td>TAH</td>
</tr>
<tr>
<td>...</td>
<td>1311</td>
<td>F</td>
<td>Duranel Isabelle</td>
<td></td>
<td>F40-44</td>
<td>...</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>1012</td>
<td>M</td>
<td>Endler Maximilian</td>
<td></td>
<td>M40-44</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>284</td>
<td>M</td>
<td>Schreiner Jorg</td>
<td></td>
<td>M40-44</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>14</td>
<td>M</td>
<td>Butturini Jacopo</td>
<td></td>
<td></td>
<td>...</td>
<td>ITU</td>
</tr>
<tr>
<td>...</td>
<td>204</td>
<td>M</td>
<td>Lindner Thomas</td>
<td></td>
<td>M40-44</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>1168</td>
<td>M</td>
<td>Gramke Peter</td>
<td></td>
<td>M45-49</td>
<td>...</td>
<td>D</td>
</tr>
</tbody></table></div></code><br>
<br>
<pre><code class="python hljs">nnc = arnc[<span class="hljs-string">'name'</span>].unique() <span class="hljs-comment">#nnc - names with no country</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдХ рджреЗрд╢ рдХреЗ рдмрд┐рдирд╛ рд░рд┐рдХреЙрд░реНрдб рдХреЗ рдмреАрдЪ рдЕрджреНрд╡рд┐рддреАрдп рдирд╛рдореЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ 3 051 рд╣реИред рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдпрд╣ рд╕рдВрдЦреНрдпрд╛ рдХрдо рд╣реЛ рд╕рдХрддреА рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐ рдЯреНрд░рд╛рдпрдерд▓реЙрди рдореЗрдВ рд▓реЛрдЧ рд╢рд╛рдпрдж рд╣реА рдХрднреА рдХреЗрд╡рд▓ рдПрдХ рд╣реА рджреМрдбрд╝ рддрдХ рд╕реАрдорд┐рдд рд╣реЛрддреЗ рд╣реИрдВ, рд╡реЗ рдЖрдорддреМрд░ рдкрд░ рдкреНрд░рддрд┐рдпреЛрдЧрд┐рддрд╛рдУрдВ рдореЗрдВ рд╕рдордп-рд╕рдордп рдкрд░, рдХрдИ рдмрд╛рд░ рдПрдХ рд╕реАрдЬрди рдореЗрдВ, рд╡рд░реНрд╖ рд╕реЗ рд╡рд░реНрд╖ рддрдХ, рд▓рдЧрд╛рддрд╛рд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдореЗрдВ рднрд╛рдЧ рд▓реЗрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдбреЗрдЯрд╛ рдореЗрдВ рдХрдИ рдирд╛рдореЛрдВ рдХреЗ рд▓рд┐рдП, рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рд░рд┐рдХреЙрд░реНрдб рд╣реЛрдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИред </font><font style="vertical-align: inherit;">рджреЗрд╢ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЙрди рдирд╛рдореЛрдВ рдХреЗ рд╕рд╛рде рд░рд┐рдХреЙрд░реНрдб рдЦреЛрдЬрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ, рдЬрд┐рдирдореЗрдВ рджреЗрд╢ рдХрд╛ рд╕рдВрдХреЗрдд рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред</font></font><br>
<br>
<pre><code class="python hljs">arwc = ar[ar[<span class="hljs-string">'country'</span>] != <span class="hljs-string">''</span>] <span class="hljs-comment">#arwc тАУ all records with country</span>
nwc = arwc[<span class="hljs-string">'name'</span>].unique() <span class="hljs-comment">#nwc тАУ names with country</span>
tofix = set(nnc).intersection(nwc)</code></pre><br>
<code><b>Out:</b> ['Kleber-Schad Ute Cathrin', 'Sellner Peter', 'Pfeiffer Christian', 'Scholl Thomas', 'Petersohn Sandra', 'Marchand Kurt', 'Janneck Britta', 'Angheben Riccardo', 'Thiele Yvonne', 'Kie?Wetter Martin', 'Schymik Gerhard', 'Clark Donald', 'Berod Brigitte', 'Theile Markus', 'Giuliattini Burbui Margherita', 'Wehrum Alexander', 'Kenny Oisin', 'Schwieger Peter', 'Grosse Bianca', 'Schafter Carsten', 'Breck Dirk', 'Mautes Christoph', 'Herrmann Andreas', 'Gilbert Kai', 'Steger Peter', 'Jirouskova Jana', 'Jehrke Michael', 'Valentine David', 'Reis Michael', 'Wanka Michael', 'Schomburg Jonas', 'Giehl Caprice', 'Zinser Carsten', 'Schumann Marcus', 'Magoni Livio', 'Lauden Yann', 'Mayer Dieter', 'Krisa Stefan', 'Haberecht Bernd', 'Schneider Achim', 'Gibanel Curto Antonio', 'Miranda Antonio', 'Juarez Pedro', 'Prelle Gerrit', 'Wuste Kay', 'Bullock Graeme', 'Hahner Martin', 'Kahl Maik', 'Schubnell Frank', 'Hastenteufel Marco', тАж]<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЙрдирдореЗрдВ рд╕реЗ 2,236 рдереЗ, рдпрд╛рдиреА рд▓рдЧрднрдЧ рддреАрди рдЪреМрдерд╛рдИред </font><font style="vertical-align: inherit;">рдЕрдм, рдЗрд╕ рд╕реВрдЪреА рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдирд╛рдо рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рджреЗрд╢ рдХреЛ рдЙрди рдЕрднрд┐рд▓реЗрдЦреЛрдВ рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬрд╣рд╛рдВ рдпрд╣ рд╣реИред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдРрд╕рд╛ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдПрдХ рд╣реА рдирд╛рдо рдХрдИ рд░рд┐рдХреЙрд░реНрдб рдФрд░ рд╡рд┐рднрд┐рдиреНрди рджреЗрд╢реЛрдВ рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рдпрд╛ рддреЛ рдирд╛рдо рд╣реИ, рдпрд╛ рд╢рд╛рдпрдж рд╡реНрдпрдХреНрддрд┐ рдЪрд▓рд╛ рдЧрдпрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рд╣рдо рдкрд╣рд▓реЗ рдЙрди рд▓реЛрдЧреЛрдВ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд░рддреЗ рд╣реИрдВ рдЬрд╣рд╛рдВ рд╕рдм рдХреБрдЫ рдЕрджреНрд╡рд┐рддреАрдп рд╣реИред</font></font><br>
<br>
<pre><code class="python hljs">fix = {}<font></font>
<font></font>
<span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> tofix:<font></font>
    nr = arwc[arwc[<span class="hljs-string">'name'</span>] == n] <font></font>
	<font></font>
    <span class="hljs-keyword">if</span> len(nr[<span class="hljs-string">'country'</span>].unique()) == <span class="hljs-number">1</span>:<font></font>
        fix[n] = nr[<span class="hljs-string">'country'</span>].iloc[<span class="hljs-number">0</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдХ рдкрд╛рд╢ рдореЗрдВ рдмрдирд╛ рд╣реБрдЖред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди, рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ, рдпрд╣ рд▓рдВрдмреЗ рд╕рдордп рддрдХ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ - рд▓рдЧрднрдЧ рддреАрди рдорд┐рдирдЯред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдЕрдзрд┐рдХ рдкрд░рд┐рдорд╛рдгреЛрдВ рдХрд╛ рдХреНрд░рдо рдерд╛, рддреЛ рдЖрдкрдХреЛ рд╕рдВрднрд╡рддрдГ рд╡реЗрдХреНрдЯрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рд╕рд╛рде рдЖрдирд╛ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">2,013 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ рдереАрдВ, рдпрд╛ 90% рдХреНрд╖рдорддрд╛ рдереАред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдРрд╕реЗ рдирд╛рдо рдЬрд┐рдирдХреЗ рд▓рд┐рдП рдЕрд▓рдЧ-рдЕрд▓рдЧ рджреЗрд╢ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд░рд┐рдХреЙрд░реНрдб рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрд╕ рджреЗрд╢ рдХреЛ рд▓реЗрдВ рдЬреЛ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдмрд╛рд░ рд╣реЛрддрд╛ рд╣реИред</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">if</span> n <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> fix:<font></font>
    nr = arwc[arwc[<span class="hljs-string">'name'</span>] == n]<font></font>
    vc = nr[<span class="hljs-string">'country'</span>].value_counts()    <font></font>
	<font></font>
    <span class="hljs-keyword">if</span> vc[<span class="hljs-number">0</span>] &gt; vc[<span class="hljs-number">1</span>]:<font></font>
        fix[n] = vc.index[<span class="hljs-number">0</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдореИрдЪ 2,208 рдирд╛рдореЛрдВ рдпрд╛ рд╕рднреА рд╕рдВрднрд╛рд╡рд┐рдд рд▓реЛрдЧреЛрдВ рдХреЗ 99% рдХреЗ рд▓рд┐рдП рдкрд╛рдП рдЧрдПред </font><font style="vertical-align: inherit;">
рд╣рдо рдпреЗ рдкрддреНрд░рд╛рдЪрд╛рд░ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ:</font></font><br>
<code>{'Kleber-Schad Ute Cathrin': 'DEU', 'Sellner Peter': 'AUT', 'Pfeiffer Christian': 'AUT', 'Scholl Thomas': 'DEU', 'Petersohn Sandra': 'DEU', 'Marchand Kurt': 'BEL', 'Janneck Britta': 'DEU', 'Angheben Riccardo': 'ITA', 'Thiele Yvonne': 'DEU', 'Kie?Wetter Martin': 'DEU', 'Clark Donald': 'GBR', 'Berod Brigitte': 'FRA', 'Theile Markus': 'DEU', 'Giuliattini Burbui Margherita': 'ITA', 'Wehrum Alexander': 'DEU', 'Kenny Oisin': 'IRL', 'Schwieger Peter': 'DEU', 'Schafter Carsten': 'DEU', 'Breck Dirk': 'DEU', 'Mautes Christoph': 'DEU', 'Herrmann Andreas': 'DEU', 'Gilbert Kai': 'DEU', 'Steger Peter': 'AUT', 'Jirouskova Jana': 'CZE', 'Jehrke Michael': 'DEU', 'Wanka Michael': 'DEU', 'Giehl Caprice': 'DEU', 'Zinser Carsten': 'DEU', 'Schumann Marcus': 'DEU', 'Magoni Livio': 'ITA', 'Lauden Yann': 'FRA', 'Mayer Dieter': 'DEU', 'Krisa Stefan': 'DEU', 'Haberecht Bernd': 'DEU', 'Schneider Achim': 'DEU', 'Gibanel Curto Antonio': 'ESP', 'Juarez Pedro': 'ESP', 'Prelle Gerrit': 'DEU', 'Wuste Kay': 'DEU', 'Bullock Graeme': 'GBR', 'Hahner Martin': 'DEU', 'Kahl Maik': 'DEU', 'Schubnell Frank': 'DEU', 'Hastenteufel Marco': 'DEU', 'Tedde Roberto': 'ITA', 'Minervini Domenico': 'ITA', 'Respondek Markus': 'DEU', 'Kramer Arne': 'DEU', 'Schreck Alex': 'DEU', 'Bichler Matthias': 'DEU', тАж}<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> fix:<font></font>
    ind = arnc[arnc[<span class="hljs-string">'name'</span>] == n].index<font></font>
    ar.loc[ind, <span class="hljs-string">'country'</span>] = fix[n]</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th><u>country</u></th>
<th>group</th>
<th>...</th>
<th>country raw</th>
</tr>
<tr>
<td>...</td>
<td>1633</td>
<td>M</td>
<td>Guerrero Pla Angel</td>
<td><u>ESP</u></td>
<td>M30-34</td>
<td>...</td>
<td>E</td>
</tr>
<tr>
<td>...</td>
<td>258</td>
<td>M</td>
<td>Bellm Mathias</td>
<td><u>DEU</u></td>
<td>M35-39</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>655</td>
<td>M</td>
<td>Moratto Alessio</td>
<td><u>ITA</u></td>
<td>M40-44</td>
<td>...</td>
<td>I</td>
</tr>
<tr>
<td>...</td>
<td>1317</td>
<td>M</td>
<td>Solari Jean-Jacques</td>
<td><u>PYF</u></td>
<td>M50-54</td>
<td>...</td>
<td>TAH</td>
</tr>
<tr>
<td>...</td>
<td>1311</td>
<td>F</td>
<td>Duranel Isabelle</td>
<td><u>FRA</u></td>
<td>F40-44</td>
<td>...</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>1012</td>
<td>M</td>
<td>Endler Maximilian</td>
<td><u>DEU</u></td>
<td>M40-44</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>284</td>
<td>M</td>
<td>Schreiner Jorg</td>
<td><u>DEU</u></td>
<td>M40-44</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>14</td>
<td>M</td>
<td>Butturini Jacopo</td>
<td><u>HRV</u></td>
<td></td>
<td>...</td>
<td>ITU</td>
</tr>
<tr>
<td>...</td>
<td>204</td>
<td>M</td>
<td>Lindner Thomas</td>
<td><u>DEU</u></td>
<td>M40-44</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>1168</td>
<td>M</td>
<td>Gramke Peter</td>
<td><u>DEU</u></td>
<td>M45-49</td>
<td>...</td>
<td>D</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдорд╛рд░реЗ рд╕реБрдзрд╛рд░реЛрдВ рдХреЗ рдмрд╛рдж, рдмрд┐рдирд╛ рдХрд┐рд╕реА рджреЗрд╢ рдХреЗ рд░рд┐рдХреЙрд░реНрдб рдХреА рд╕рдВрдЦреНрдпрд╛ рдШрдЯрдХрд░ 909 рд╣реЛ рдЧрдИ, рдпрд╛рдиреА рддреАрди рдЧреБрдирд╛ рд╕реЗ рдЕрдзрд┐рдХред </font><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдБрдХрд┐ рдХреБрд▓ 2,208 рдХреА рд╕рдВрдЦреНрдпрд╛ рдбреЗрдврд╝ рдорд┐рд▓рд┐рдпрди рдХреА рдкреГрд╖реНрдарднреВрдорд┐ рдХреЗ рдореБрдХрд╛рдмрд▓реЗ рдЗрддрдиреА рдмрдбрд╝реА рдирд╣реАрдВ рд╣реИ, рдлрд┐рд░ рднреА рдпрд╣ рдЕрдЪреНрдЫрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдореЗрд╢рд╛ рдХреА рддрд░рд╣, рд╣рдо рд╕рдВрдпреБрдХреНрдд рдбреЗрдЯрд╛ рдлреНрд░реЗрдо рдХрд╛ рдЕрдиреБрд╡рд╛рдж </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рд╡рд╛рдкрд╕ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд╛рдВ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╢рдмреНрджрдХреЛрд╢ </font><font style="vertical-align: inherit;">рдФрд░ рдЙрд╕реЗ рд╕рд╣реЗрдЬреЗрдВред</font></font><br>
<br>
<pre><code class="python hljs">pkl.dump(rd, open(<span class="hljs-string">r'D:\tri\details7.pkl'</span>, <span class="hljs-string">'wb'</span>))
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдордВрдЬрд╝рд┐рд▓</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬреИрд╕рд╛ рдХрд┐ рджреЗрд╢реЛрдВ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдРрд╕реЗ рд░рд┐рдХреЙрд░реНрдб рд╣реИрдВ рдЬрд┐рдирдореЗрдВ рдкреНрд░рддрд┐рднрд╛рдЧреА рдХреЗ рд▓рд┐рдВрдЧ рдХрд╛ рд╕рдВрдХреЗрдд рдирд╣реАрдВ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </font></font><br>
<br>
<pre><code class="python hljs">ar[ar[<span class="hljs-string">'sex'</span>] == <span class="hljs-string">''</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЙрдирдореЗрдВ рд╕реЗ 2,538 рд╣реИрдВред рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рдХреБрдЫ, рд▓реЗрдХрд┐рди рдлрд┐рд░ рд╕реЗ рд╣рдо рдФрд░ рднреА рдХрдо рдмрдирд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдореВрд▓ рдорд╛рдиреЛрдВ рдХреЛ рдПрдХ рдирдП рдХреЙрд▓рдо рдореЗрдВ рд╕рд╣реЗрдЬреЗрдВред</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'sex raw'</span>] =ar[<span class="hljs-string">'sex'</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЙрди рджреЗрд╢реЛрдВ рдХреЗ рд╡рд┐рдкрд░реАрдд рдЬрд╣рд╛рдВ рд╣рдордиреЗ рдЕрдиреНрдп рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдирд╛рдо рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХреА, рдпрд╣рд╛рдВ рд╕рдм рдХреБрдЫ рдереЛрдбрд╝рд╛ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реИред </font><font style="vertical-align: inherit;">рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐ рдбреЗрдЯрд╛ рддреНрд░реБрдЯрд┐рдпреЛрдВ рд╕реЗ рднрд░рд╛ рд╣реИ рдФрд░ рдХрдИ рдирд╛рдо (рдХреБрд▓ 2 101) рд╣реИрдВ рдЬреЛ рджреЛрдиреЛрдВ рд▓рд┐рдВрдЧреЛрдВ рдХреЗ рдирд┐рд╢рд╛рди рдХреЗ рд╕рд╛рде рдкрд╛рдП рдЬрд╛рддреЗ рд╣реИрдВред</font></font><br>
<br>
<pre><code class="python hljs">arws = ar[(ar[<span class="hljs-string">'sex'</span>] != <span class="hljs-string">''</span>)&amp;(ar[<span class="hljs-string">'name'</span>] != <span class="hljs-string">''</span>)] <span class="hljs-comment">#arws тАУ all records with sex</span>
snds = arws[arws.duplicated(subset=<span class="hljs-string">'name'</span>,keep=<span class="hljs-literal">False</span>)]<span class="hljs-comment">#sndsтАУsingle name different sex</span>
snds = snds.drop_duplicates(subset=[<span class="hljs-string">'name'</span>,<span class="hljs-string">'sex'</span>], keep = <span class="hljs-string">'first'</span>)<font></font>
snds = snds.sort_values(by=<span class="hljs-string">'name'</span>)<font></font>
snds = snds[snds.duplicated(subset = <span class="hljs-string">'name'</span>, keep=<span class="hljs-literal">False</span>)]<font></font>
<font></font>
snds</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th><u>sex</u></th>
<th><u>name</u></th>
<th>country</th>
<th><u>group</u></th>
<th>...</th>
<th>country raw</th>
<th>group raw</th>
<th>sex raw</th>
</tr>
<tr>
<td>...</td>
<td>428</td>
<td><u>F</u></td>
<td><u>Aagaard Ida</u></td>
<td>NOR</td>
<td><u>F40-44</u></td>
<td>...</td>
<td>NOR</td>
<td>F40-44</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>718</td>
<td><u>M</u></td>
<td><u>Aagaard Ida</u></td>
<td>NOR</td>
<td><u>M40-44</u></td>
<td>...</td>
<td>NOR</td>
<td>M40-44</td>
<td>M</td>
</tr>
<tr>
<td></td>
<td>740</td>
<td><u>M</u></td>
<td><u>Aarekol Tove Aase</u></td>
<td>NOR</td>
<td><u>M50-54</u></td>
<td>...</td>
<td>NOR</td>
<td>M50-54</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>520</td>
<td><u>F</u></td>
<td><u>Aarekol Tove Aase</u></td>
<td>NOR</td>
<td><u>F50-54</u></td>
<td>...</td>
<td>NOR</td>
<td>F50-54</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>665</td>
<td><u>F</u></td>
<td><u>Aaroy Torunn</u></td>
<td>NOR</td>
<td><u>F40-44</u></td>
<td>...</td>
<td>NOR</td>
<td>F40-44</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>1591</td>
<td><u>M</u></td>
<td><u>Aaroy Torunn</u></td>
<td>NOR</td>
<td><u>M40-44</u></td>
<td>...</td>
<td>NOR</td>
<td>M40-44</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>70</td>
<td><u>M</u></td>
<td><u>Aberg Cobo Dolores</u></td>
<td>ARG</td>
<td><u>FPRO</u></td>
<td>...</td>
<td>ARG</td>
<td>FPRO</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>1258</td>
<td><u>F</u></td>
<td><u>Aberg Cobo Dolores</u></td>
<td>ARG</td>
<td><u>F30-34</u></td>
<td>...</td>
<td>ARG</td>
<td>F30-34</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>1909</td>
<td><u>F</u></td>
<td><u>Aboulfaida Zineb</u></td>
<td>MAR</td>
<td><u>F35-39</u></td>
<td>...</td>
<td>MAR</td>
<td>F35-39</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>340</td>
<td><u>M</u></td>
<td><u>Aboulfaida Zineb</u></td>
<td>MAR</td>
<td><u>M35-39</u></td>
<td>...</td>
<td>MAR</td>
<td>M35-39</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>63</td>
<td><u>F</u></td>
<td><u>Abram Felicity</u></td>
<td>AUS</td>
<td><u>FPRO</u></td>
<td>...</td>
<td>AUS</td>
<td>FPRO</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>38</td>
<td><u>M</u></td>
<td><u>Abram Felicity</u></td>
<td>AUS</td>
<td><u>FJUNIOR</u></td>
<td>...</td>
<td>AUS</td>
<td>FJUNIOR</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>134</td>
<td><u>M</u></td>
<td><u>Abramowski Jannicke</u></td>
<td>DEU</td>
<td><u>FPRO</u></td>
<td>...</td>
<td>GER</td>
<td>FPRO</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>323</td>
<td><u>F</u></td>
<td><u>Abramowski Jannicke</u></td>
<td>DEU</td>
<td><u>F25-29</u></td>
<td>...</td>
<td>GER</td>
<td>F25-29</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>21</td>
<td><u>M</u></td>
<td><u>Abrosimova Anastasia</u></td>
<td>RUS</td>
<td><u>FPRO</u></td>
<td>...</td>
<td>RUS</td>
<td>FPRO</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>177</td>
<td><u>F</u></td>
<td><u>Abrosimova Anastasia</u></td>
<td>RUS</td>
<td><u>FPRO</u></td>
<td>...</td>
<td>RUS</td>
<td>FPRO</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>188</td>
<td><u>M</u></td>
<td><u>Abysova Irina</u></td>
<td>RUS</td>
<td><u>FPRO</u></td>
<td>...</td>
<td>RUS</td>
<td>FPRO</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>60</td>
<td><u>F</u></td>
<td><u>Abysova Irina</u></td>
<td>RUS</td>
<td><u>FPRO</u></td>
<td>...</td>
<td>RUS</td>
<td>FPRO</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>312</td>
<td><u>M</u></td>
<td><u>Acaron Fabiola</u></td>
<td>PRI</td>
<td><u>FJUNIOR</u></td>
<td>...</td>
<td>PUR</td>
<td>FJUNIOR</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>294</td>
<td><u>F</u></td>
<td><u>Acaron Fabiola</u></td>
<td>PRI</td>
<td><u>F45-49</u></td>
<td>...</td>
<td>PUR</td>
<td>F45-49</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>1500</td>
<td><u>M</u></td>
<td><u>Achampong Benjamin</u></td>
<td>GBR</td>
<td><u>M35-39</u></td>
<td>...</td>
<td>GBR</td>
<td>M35-39</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>749</td>
<td><u>F</u></td>
<td><u>Achampong Benjamin</u></td>
<td>GBR</td>
<td><u>M35-39</u></td>
<td>...</td>
<td>GBR</td>
<td>M35-39</td>
<td>F</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рд╛рдВ, рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ, рдпреВрдирд┐рд╕реЗрдХреНрд╕ (рдпрд╛ androgynous) рдирд╛рдо рд╣реИрдВ, рдЬреЛ рдХрд┐ рд▓рдбрд╝рдХреЛрдВ рдФрд░ рд▓рдбрд╝рдХрд┐рдпреЛрдВ рджреЛрдиреЛрдВ рдХреЗ рдирд╛рдо рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдФрд░ рдПрд╢рд┐рдпрд╛рдИ рдПрдерд▓реАрдЯреЛрдВ рдХреЗ рд▓рд┐рдП рдирд╛рдо рд╕реЗ рд▓рд┐рдВрдЧ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░рдирд╛ рдЖрдо рддреМрд░ рдкрд░ рдореБрд╢реНрдХрд┐рд▓ рд╣реИ - рд╢рд╛рдпрдж рдореЗрд░реЗ рдкрд╛рд╕ рдкрд░реНрдпрд╛рдкреНрдд рдЬреНрдЮрд╛рди рдирд╣реАрдВ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХрд░рдирд╛ рдХрдард┐рди рд╣реИ рдХрд┐ рдЗрд░рд┐рдирд╛ рдпрд╛ рдЕрдирд╛рд╕реНрддрд╛рд╕рд┐рдпрд╛ рдирд╛рдо рдПрдХ рдкреБрд░реБрд╖ рдХрд╛ рдерд╛, рдФрд░ рдмреЗрдВрдЬрд╛рдорд┐рди рдХреЛ рдПрдХ рдорд╣рд┐рд▓рд╛ рдХрд╣рд╛ рдЬрд╛рддрд╛ рдерд╛ред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХреБрдЫ рдмрд┐рдВрджреБ рдкрд░ рдореИрдВрдиреЗ рдкрд╛рдпрд╛ рдХрд┐ рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИрдВ рдЬрд┐рдирдореЗрдВ рд╕рднреА рдкреНрд░рддрд┐рднрд╛рдЧрд┐рдпреЛрдВ рдХреЛ рдПрдХ рд▓рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдЪрд┐рд╣реНрдирд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред</font></font><br>
<br>
<pre><code class="python hljs">rss = [rd[e] <span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> rd <span class="hljs-keyword">if</span> len(rd[e][rd[e][<span class="hljs-string">'sex'</span>] != <span class="hljs-string">''</span>][<span class="hljs-string">'sex'</span>].unique()) == <span class="hljs-number">1</span>] <span class="hljs-comment">#rss тАУ races with single sex</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЙрдирдореЗрдВ рд╕реЗ 633 рд╣реИрдВред рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдХрд╛рдлреА рд╕рдВрднрд╡ рд╣реИ, рд╕рд┐рд░реНрдл рдорд╣рд┐рд▓рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдЕрд▓рдЧ рд╕реЗ, рдкреБрд░реБрд╖реЛрдВ рдХреЗ рд▓рд┐рдП рдЕрд▓рдЧ рд╕реЗ рдПрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ред рд▓реЗрдХрд┐рди рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐ рдЗрдирдореЗрдВ рд╕реЗ рд▓рдЧрднрдЧ рд╕рднреА рдкреНрд░реЛрдЯреЛрдХреЙрд▓реЛрдВ рдореЗрдВ рджреЛрдиреЛрдВ рд▓рд┐рдВрдЧреЛрдВ рдХреЗ рдЖрдпреБ рд╕рдореВрд╣ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ (рдкреБрд░реБрд╖ рдЖрдпреБ рд╕рдореВрд╣ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдорд╣рд┐рд▓рд╛ рдХреЗ </font><font style="vertical-align: inherit;">рд╕рд╛рде рд╢реБрд░реВ рд╣реЛрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">- рдкрддреНрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдл рдХреЗ рд╕рд╛рде</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: </font><font style="vertical-align: inherit;">рдпрд╣ рдЕрдкреЗрдХреНрд╖рд┐рдд рд╣реИ рдХрд┐ рдЖрдпреБ рд╕рдореВрд╣ рдХрд╛ рдирд╛рдо </font><font style="vertical-align: inherit;">рдкреБрд░реБрд╖реЛрдВ рдХреЗ рд▓рд┐рдП </font><i><font style="vertical-align: inherit;">M</font></i><font style="vertical-align: inherit;"> рдЕрдХреНрд╖рд░ рд╕реЗ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">рдФрд░ </font><font style="vertical-align: inherit;">рдорд╣рд┐рд▓рд╛рдУрдВ рдХреЗ рд▓рд┐рдП </font><i><font style="vertical-align: inherit;">F</font></i><font style="vertical-align: inherit;"> рдЕрдХреНрд╖рд░ рдХреЗ рд╕рд╛рде </font><font style="vertical-align: inherit;">ред рдкрд┐рдЫрд▓реЗ рджреЛ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ, </font><i><font style="vertical-align: inherit;">рд╕реЗрдХреНрд╕</font></i><font style="vertical-align: inherit;"> рдХреЙрд▓рдо рдореЗрдВ рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХреЗ рдмрд╛рд╡рдЬреВрдж</font></font><br>
<br>
<code>'ITU World Cup Tiszaujvaros Olympic 2002'<br>
<div class="scrollable-table"><table>
<tbody><tr>
<th>place</th>
<th><u>sex</u></th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>...</th>
<th>country raw</th>
<th><u>group raw</u></th>
<th>name raw</th>
</tr>
<tr>
<td>76</td>
<td><u>M</u></td>
<td>Dederko Ewa</td>
<td>POL</td>
<td>FPRO</td>
<td>...</td>
<td>POL</td>
<td><u>FPRO</u></td>
<td>Dederko Ewa</td>
</tr>
<tr>
<td>84</td>
<td><u>M</u></td>
<td>Chenevier Giunia</td>
<td>ITA</td>
<td>FPRO</td>
<td>...</td>
<td>ITA</td>
<td><u>FPRO</u></td>
<td>Chenevier Giunia</td>
</tr>
<tr>
<td>36</td>
<td><u>M</u></td>
<td>O'Grady Graham</td>
<td>NZL</td>
<td>MPRO</td>
<td>...</td>
<td>NZL</td>
<td><u>MPRO</u></td>
<td>O'Grady Graham</td>
</tr>
<tr>
<td>23</td>
<td><u>M</u></td>
<td>Danek Michal</td>
<td>CZE</td>
<td>MPRO</td>
<td>...</td>
<td>CZE</td>
<td><u>MPRO</u></td>
<td>Danek Michal</td>
</tr>
<tr>
<td>74</td>
<td><u>M</u></td>
<td>Peon Carole</td>
<td>FRA</td>
<td>FPRO</td>
<td>...</td>
<td>FRA</td>
<td><u>FPRO</u></td>
<td>Peon Carole</td>
</tr>
<tr>
<td>48</td>
<td><u>M</u></td>
<td>Hechenblaickner Daniel</td>
<td>AUT</td>
<td>MPRO</td>
<td>...</td>
<td>AUT</td>
<td><u>MPRO</u></td>
<td>Hechenblaickner Daniel</td>
</tr>
<tr>
<td>70</td>
<td><u>M</u></td>
<td>Blatchford Liz</td>
<td>GBR</td>
<td>FPRO</td>
<td>...</td>
<td>GBR</td>
<td><u>FPRO</u></td>
<td>Blatchford Liz</td>
</tr>
<tr>
<td>1</td>
<td><u>M</u></td>
<td>Walton Craig</td>
<td>AUS</td>
<td>MPRO</td>
<td>...</td>
<td>AUS</td>
<td><u>MPRO</u></td>
<td>Walton Craig</td>
</tr>
<tr>
<td>20</td>
<td><u>M</u></td>
<td>Hobor Peter</td>
<td>HUN</td>
<td>MPRO</td>
<td>...</td>
<td>HUN</td>
<td><u>MPRO</u></td>
<td>Hobor Peter</td>
</tr>
<tr>
<td>56</td>
<td><u>M</u></td>
<td>Kaldau Szabolcs</td>
<td>HUN</td>
<td>MPRO</td>
<td>...</td>
<td>HUN</td>
<td><u>MPRO</u></td>
<td>Kaldau Szabolcs</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдореВрд╣ рдХрд╛ рдирд╛рдо рдЕрднреА рднреА рд╕рджрд╕реНрдп рдХреЗ рд▓рд┐рдВрдЧ рдХрд╛ рд╕рд╣реА рд╡рд░реНрдгрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓рдЧ рд░рд╣рд╛ рдерд╛ред </font><font style="vertical-align: inherit;">рдХрдИ рдирдореВрдирд╛ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рд╣рдо рдпрд╣ рдзрд╛рд░рдгрд╛ рдмрдирд╛рддреЗ рд╣реИрдВ рдХрд┐ рд╕рдореВрд╣ рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдЗрдВрдЧрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рд▓рд┐рдВрдЧ рдХреЛ рдЧрд▓рдд рддрд░реАрдХреЗ рд╕реЗ рдЗрдВрдЧрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЙрди рд╕рднреА рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЛ рдЦреЛрдЬреЗрдВ рдЬрд╣рд╛рдБ рд╕рдореВрд╣ рдирд╛рдо рдХрд╛ рдкрд╣рд▓рд╛ рдЕрдХреНрд╖рд░ рд▓рд┐рдВрдЧ рд╕реЗ рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рд╕рдореВрд╣ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдореВрд╣</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЗ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдирд╛рдо рдХреЛ </font><i><font style="vertical-align: inherit;">рдХрдЪреНрдЪрд╛</font></i><font style="vertical-align: inherit;"> рд▓реЗрдВрдЧреЗ </font><font style="vertical-align: inherit;">, рдХреНрдпреЛрдВрдХрд┐ рдорд╛рдирдХреАрдХрд░рдг рдХреЗ рджреМрд░рд╛рди рдХрдИ рд░рд┐рдХреЙрд░реНрдб рдПрдХ рд╕рдореВрд╣ рдХреЗ рдмрд┐рдирд╛ рдЫреЛрдбрд╝ рджрд┐рдП рдЧрдП рдереЗ, рд▓реЗрдХрд┐рди рдЕрдм рд╣рдореЗрдВ рдХреЗрд╡рд▓ рдкрд╣рд▓реЗ рдЕрдХреНрд╖рд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдорд╛рдирдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд╣реАрдВ рд╣реИред</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'grflc'</span>] = ar[<span class="hljs-string">'group raw'</span>].str.upper().str[<span class="hljs-number">0</span>] <span class="hljs-comment">#grflc тАУ group raw first letter capital</span>
grncs = ar[(ar[<span class="hljs-string">'grflc'</span>].isin([<span class="hljs-string">'M'</span>,<span class="hljs-string">'F'</span>]))&amp;(ar[<span class="hljs-string">'sex'</span>]!=ar[<span class="hljs-string">'grflc'</span>])] <span class="hljs-comment">#grncs тАУ group raw not consistent with sex</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рддрд░рд╣ рдХреЗ 26 161 рд░рд┐рдХреЙрд░реНрдб рд╣реИрдВред </font><font style="vertical-align: inherit;">рдареАрдХ рд╣реИ, рдЪрд▓реЛ рд▓рд┐рдВрдЧ рдХреЛ рдЖрдпреБ рд╕рдореВрд╣ рдХреЗ рдирд╛рдо рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╕рд╣реА рдХрд░реЗрдВ:</font></font><br>
<br>
<pre><code class="python hljs">ar.loc[grncs.index, <span class="hljs-string">'sex'</span>] = grncs[<span class="hljs-string">'grflc'</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдЗрдП рдкрд░рд┐рдгрд╛рдо рдХреЛ рджреЗрдЦреЗрдВ: </font><font style="vertical-align: inherit;">рдЕрдЪреНрдЫрд╛ред </font><font style="vertical-align: inherit;">рд▓рд┐рдВрдЧ рдХреЗ рдмрд┐рдирд╛ рдЕрдм рдХрд┐рддрдиреЗ рд░рд┐рдХреЙрд░реНрдб рдмрдЪреЗ рд╣реИрдВ?</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th><u>sex</u></th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>...</th>
<th>country raw</th>
<th><u>group raw</u></th>
<th><u>sex raw</u></th>
<th>grflc</th>
</tr>
<tr>
<td>...</td>
<td>59</td>
<td><u>F</u></td>
<td>Ueda Ai</td>
<td>JPN</td>
<td>FPRO</td>
<td>...</td>
<td>JPN</td>
<td><u>FPRO</u></td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>50</td>
<td><u>F</u></td>
<td>Zemanova Lenka</td>
<td>CZE</td>
<td>FPRO</td>
<td>...</td>
<td>CZE</td>
<td><u>FPRO</u></td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>83</td>
<td><u>F</u></td>
<td>Spearing Kyleigh</td>
<td>USA</td>
<td>FPRO</td>
<td>...</td>
<td>USA</td>
<td><u>FPRO</u></td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>63</td>
<td><u>F</u></td>
<td>Abysova Irina</td>
<td>RUS</td>
<td>FPRO</td>
<td>...</td>
<td>RUS</td>
<td><u>FPRO</u></td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>57</td>
<td><u>F</u></td>
<td>Knapp Anja</td>
<td>DEU</td>
<td>FPRO</td>
<td>...</td>
<td>GER</td>
<td><u>FPRO</u></td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>68</td>
<td><u>M</u></td>
<td>Matthews Andrew</td>
<td>GBR</td>
<td>M30-34</td>
<td>...</td>
<td>GBR</td>
<td><u>M30-34</u></td>
<td><u>F</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>46</td>
<td><u>F</u></td>
<td>Rappaport Summer</td>
<td>USA</td>
<td>FPRO</td>
<td>...</td>
<td>USA</td>
<td><u>FPRO</u></td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>60</td>
<td><u>F</u></td>
<td>Reid Aileen</td>
<td>IRL</td>
<td>FPRO</td>
<td>...</td>
<td>IRL</td>
<td><u>FPRO</u></td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>142</td>
<td><u>F</u></td>
<td>Mcdowall Edwina</td>
<td>GBR</td>
<td>F45-49</td>
<td>...</td>
<td>GBR</td>
<td><u>F45-49</u></td>
<td></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>141</td>
<td><u>M</u></td>
<td>O'Bray Luke</td>
<td>GBR</td>
<td>M30-34</td>
<td>...</td>
<td>GBR</td>
<td><u>M30-34</u></td>
<td></td>
<td>M</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar[(ar[<span class="hljs-string">'sex'</span>] == <span class="hljs-string">''</span>)&amp;(ar[<span class="hljs-string">'name'</span>] != <span class="hljs-string">''</span>)]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдмрд┐рд▓реНрдХреБрд▓ рдПрдХ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ! </font><font style="vertical-align: inherit;">
рдареАрдХ рд╣реИ, рд╕рдореВрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЗрдВрдЧрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд▓реЗрдХрд┐рди, рдЬрд╛рд╣рд┐рд░ рд╣реИ, рдпрд╣ рдПрдХ рдорд╣рд┐рд▓рд╛ рд╣реИред рдПрдорд┐рд▓реА рдПрдХ рдорд╣рд┐рд▓рд╛ рдирд╛рдо рд╣реИ, рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдЗрд╕ рдкреНрд░рддрд┐рднрд╛рдЧреА (рдпрд╛ рдЙрд╕рдХрд╛ рдирд╛рдо) рдПрдХ рд╕рд╛рд▓ рдкрд╣рд▓реЗ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЧрдпрд╛, рдФрд░ рдЙрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдореЗрдВ рд▓рд┐рдВрдЧ рдФрд░ рд╕рдореВрд╣ рдХрд╛ рд╕рдВрдХреЗрдд рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">
рдпрд╣рд╛рдВ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ * рдФрд░ рдЖрдЧреЗ рдмрдврд╝реЗрдВред</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th><u>sex</u></th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>...</th>
<th>country raw</th>
<th><u>group raw</u></th>
<th><u>sex raw</u></th>
<th>grflc</th>
</tr>
<tr>
<td>London Triathlon Olympic 2019</td>
<td>672</td>
<td></td>
<td>Stather Emily</td>
<td>GBR</td>
<td></td>
<td>...</td>
<td>GBR</td>
<td><u>unknown</u></td>
<td></td>
<td>U</td>
</tr>
</tbody></table></div></code><br><font style="vertical-align: inherit;"></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th><u>sex</u></th>
<th>name</th>
<th>country</th>
<th><u>group</u></th>
<th>...</th>
<th>country raw</th>
<th>group raw</th>
<th><u>sex raw</u></th>
<th>grflc</th>
</tr>
<tr>
<td>Ironman Staffordshire 70.3 2018</td>
<td>1859</td>
<td><u>F</u></td>
<td>Stather Emily</td>
<td>GBR</td>
<td><u>F40-44</u></td>
<td>...</td>
<td>GBR</td>
<td>F40-44</td>
<td><u>F</u></td>
<td>F</td>
</tr>
</tbody></table></div></code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar.loc[arns.index, <span class="hljs-string">'sex'</span>] = <span class="hljs-string">'F'</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╕рднреА рд░рд┐рдХреЙрд░реНрдб рд▓рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рд╣реИрдВред </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рдРрд╕рд╛ рдХрд░рдирд╛ рдЧрд▓рдд рд╣реИ - рдмрд╛рд░-рдмрд╛рд░ рд░рди рдХреЗ рд╕рд╛рде, рдпрджрд┐ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЗрдВ рдХреБрдЫ рдкрд╣рд▓реЗ рдмрджрд▓рддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдирд╛рдо рд░реВрдкрд╛рдВрддрд░рдг рдореЗрдВ, рддреЛ рд▓рд┐рдВрдЧ рдХреЗ рдмрд┐рдирд╛ рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рд░рд┐рдХреЙрд░реНрдб рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдЙрдирдореЗрдВ рд╕реЗ рд╕рднреА рдорд╣рд┐рд▓рд╛ рдирд╣реАрдВ рд╣реЛрдВрдЧреЗ, рдПрдХ рддреНрд░реБрдЯрд┐ рд╣реЛрдЧреАред рдЗрд╕рд▓рд┐рдП, рдЖрдкрдХреЛ рдпрд╛ рддреЛ рдХрд┐рд╕реА рдЕрдиреНрдп рдирд╛рдо рдФрд░ рд▓рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдПрдХ рдкреНрд░рддрд┐рднрд╛рдЧреА рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднрд╛рд░реА рддрд░реНрдХ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░рдиреЗ рд╣реЛрдВрдЧреЗ, рдЬреИрд╕реЗ рдХрд┐ рдХрд┐рд╕реА рджреЗрд╢ рдХреЛ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдФрд░ рдЗрд╕рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХреИрд╕реЗ рдХрд░реЗрдВ, рдпрд╛, рдЕрдирд╛рд╡рд╢реНрдпрдХ рд░реВрдк рд╕реЗ рдЬрдЯрд┐рд▓ рди рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрд╕ рддрд░реНрдХ рдореЗрдВ рдПрдХ рдЬрд╛рдВрдЪ рдЬреЛрдбрд╝реЗрдВ рдХреЗрд╡рд▓ рдПрдХ рд░рд┐рдХреЙрд░реНрдб рдорд┐рд▓рд╛ рд╣реИ рдФрд░ рдирд╛рдо рдРрд╕рд╛ рд╣реИ рдФрд░ рдРрд╕рд╛ рд╣реИ, рдЕрдиреНрдпрдерд╛ рдПрдХ рдЕрдкрд╡рд╛рдж рдХреЛ рдлреЗрдВрдХ рджреЗрдВ рдЬреЛ рдкреВрд░реЗ рд▓реИрдкрдЯреЙрдк рдХреЛ рд░реЛрдХ рджреЗрдЧрд╛, рдЖрдк рдпреЛрдЬрдирд╛ рд╕реЗ рд╡рд┐рдЪрд▓рди рдиреЛрдЯрд┐рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред</font></font></i><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">if</span> len(arns) == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> arns[<span class="hljs-string">'name'</span>].iloc[<span class="hljs-number">0</span>] == <span class="hljs-string">'Stather Emily'</span>:<font></font>
    ar.loc[arns.index, <span class="hljs-string">'sex'</span>] = <span class="hljs-string">'F'</span>
<span class="hljs-keyword">else</span>:
    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">'Different scenario!'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдРрд╕рд╛ рд▓рдЧреЗрдЧрд╛ рдХрд┐ рдпрд╣ рд╢рд╛рдВрдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐ рд╕реБрдзрд╛рд░ рдЗрд╕ рдзрд╛рд░рдгрд╛ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИрдВ рдХрд┐ рд╕рдореВрд╣ рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдЗрдВрдЧрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдФрд░ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдпрд╣ рд╣реИред </font><font style="vertical-align: inherit;">рдЬреНрдпрд╛рджрд╛рддрд░ рд╣рдореЗрд╢рд╛ред </font><font style="vertical-align: inherit;">рд▓рдЧрднрдЧред </font><font style="vertical-align: inherit;">рдлрд┐рд░ рднреА, рдХрдИ рд╡рд┐рд╕рдВрдЧрддрд┐рдпреЛрдВ рдХреЛ рдЧрд▓рддреА рд╕реЗ рджреЗрдЦрд╛ рдЧрдпрд╛ рдерд╛, рддреЛ рдЕрдм рдЪрд▓реЛ рдЙрди рд╕рднреА рдХреЛ, рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдпрд╛ рдЬрд┐рддрдирд╛ рд╕рдВрднрд╡ рд╣реЛ рдЙрддрдирд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред </font><font style="vertical-align: inherit;">рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдкрд╣рд▓реЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рддрдереНрдп рдерд╛ рдХрд┐ рд▓рд┐рдВрдЧ рдиреЗ рдкреБрд░реБрд╖ рдФрд░ рдорд╣рд┐рд▓рд╛ рдирд╛рдореЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рд╡рд┐рдЪрд╛рд░реЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдирд╛рдо рдХреЗ рдЕрдиреБрд░реВрдк рдирд╣реАрдВ рдерд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреБрд░реБрд╖ рдФрд░ рдорд╣рд┐рд▓рд╛ рд░рд┐рдХреЙрд░реНрдб рдкрд░ рд╕рднреА рдирд╛рдо рдЦреЛрдЬреЗрдВред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдВ, рдирд╛рдо рдХреЛ рдирд╛рдо рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдордЭрд╛ рдЬрд╛рддрд╛ рд╣реИ, рди рдХрд┐ рдкреВрд░рд╛ рдирд╛рдо, рдпрд╛рдиреА рдмрд┐рдирд╛ рдЙрдкрдирд╛рдо рдХреЗ, рдЬрд┐рд╕реЗ рдЕрдВрдЧреНрд░реЗрдЬреА рдореЗрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╣рд▓рд╛ рдирд╛рдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'fn'</span>] = ar[<span class="hljs-string">'name'</span>].str.split().str[<span class="hljs-number">-1</span>] <span class="hljs-comment">#fn тАУ first name</span>
mfn = list(ar[ar[<span class="hljs-string">'sex'</span>] == <span class="hljs-string">'M'</span>][<span class="hljs-string">'fn'</span>].unique()) <span class="hljs-comment">#mfn тАУ male first names</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХреБрд▓ 32,508 рдкреБрд░реБрд╖ рдирд╛рдо рд╕реВрдЪреАрдмрджреНрдз рд╣реИрдВред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдВ 50 рд╕рдмрд╕реЗ рд▓реЛрдХрдкреНрд░рд┐рдп рд╣реИрдВ:</font></font><br>
<code>['Michael', 'David', 'Thomas', 'John', 'Daniel', 'Mark', 'Peter', 'Paul', 'Christian', 'Robert', 'Martin', 'James', 'Andrew', 'Chris', 'Richard', 'Andreas', 'Matthew', 'Brian', 'Kevin', 'Patrick', 'Scott', 'Stefan', 'Jason', 'Eric', 'Alexander', 'Christopher', 'Simon', 'Mike', 'Tim', 'Frank', 'Stephen', 'Steve', 'Jonathan', 'Marco', 'Markus', 'Adam', 'Ryan', 'Tom', 'Jan', 'Marc', 'Carlos', 'Matt', 'Steven', 'Jeff', 'Sergey', 'William', 'Aleksandr', 'Andrey', 'Benjamin', 'Jose']<br>
</code><br>
<br>
<pre><code class="python hljs">ffn = list(ar[ar[<span class="hljs-string">'sex'</span>] == <span class="hljs-string">'F'</span>][<span class="hljs-string">'fn'</span>].unique()) <span class="hljs-comment">#ffn тАУ female first names</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХрдо рдорд╣рд┐рд▓рд╛рдПрдВ - 14 423. рд╕рдмрд╕реЗ рд▓реЛрдХрдкреНрд░рд┐рдп: </font><font style="vertical-align: inherit;">
рдЕрдЪреНрдЫрд╛, рдпрд╣ рддрд╛рд░реНрдХрд┐рдХ рд▓рдЧ рд░рд╣рд╛ рд╣реИред </font><font style="vertical-align: inherit;">рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдЪреМрд░рд╛рд╣реЗ рд╣реИрдВ рдпрд╛ рдирд╣реАрдВред</font></font><br>
<code>['Jennifer', 'Sarah', 'Laura', 'Lisa', 'Anna', 'Michelle', 'Maria', 'Andrea', 'Nicole', 'Jessica', 'Julie', 'Elizabeth', 'Stephanie', 'Karen', 'Christine', 'Amy', 'Rebecca', 'Susan', 'Rachel', 'Anne', 'Heather', 'Kelly', 'Barbara', 'Claudia', 'Amanda', 'Sandra', 'Julia', 'Lauren', 'Melissa', 'Emma', 'Sara', 'Katie', 'Melanie', 'Kim', 'Caroline', 'Erin', 'Kate', 'Linda', 'Mary', 'Alexandra', 'Christina', 'Emily', 'Angela', 'Catherine', 'Claire', 'Elena', 'Patricia', 'Charlotte', 'Megan', 'Daniela']<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">mffn = set(mfn).intersection(ffn) <span class="hljs-comment">#mffn тАУ male-female first names</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╡рд╣рд╛рдБ рд╣реИред </font><font style="vertical-align: inherit;">рдФрд░ рдЙрдирдореЗрдВ рд╕реЗ 2,811 рд╣реИрдВред рдЖрдЗрдП рдЙрдиреНрд╣реЗрдВ рдЕрдзрд┐рдХ рдмрд╛рд░реАрдХреА рд╕реЗ рджреЗрдЦреЗрдВред </font><font style="vertical-align: inherit;">рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рдЗрди рдирд╛рдореЛрдВ рдХреЗ рд╕рд╛рде рдХрд┐рддрдиреЗ рд░рд┐рдХреЙрд░реНрдб рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="python hljs">armfn = ar[ar[<span class="hljs-string">'fn'</span>].isin(mffn)] <span class="hljs-comment">#armfn тАУ all records with male-female names</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
725 562 рд╣реИрдВред рдпрд╣ рдЖрдзрд╛ рд╣реИ! </font><font style="vertical-align: inherit;">рдпрд╣ рдЖрд╢реНрдЪрд░реНрдпрдЬрдирдХ рд╣реИ! </font><font style="vertical-align: inherit;">рд▓рдЧрднрдЧ 37,000 рдЕрджреНрд╡рд┐рддреАрдп рдирд╛рдо рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЖрдзреЗ рд░рд┐рдХреЙрд░реНрдб рдореЗрдВ рдХреБрд▓ 2,800 рд╣реИрдВред рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рдпреЗ рдирд╛рдо рдХреНрдпрд╛ рд╣реИрдВ, рдЬреЛ рд╕рдмрд╕реЗ рд▓реЛрдХрдкреНрд░рд┐рдп рд╣реИрдВред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рдирдпрд╛ рдбреЗрдЯрд╛ рдлрд╝реНрд░реЗрдо рдмрдирд╛рдПрдВ рдЬрд╣рд╛рдВ рдпреЗ рдирд╛рдо рд╕реВрдЪрдХ рд╣реЛрдВрдЧреЗ:</font></font><br>
<br>
<pre><code class="python hljs">df = pd.DataFrame(armfn[<span class="hljs-string">'fn'</span>].value_counts())<font></font>
df = df.rename(columns={<span class="hljs-string">'fn'</span>:<span class="hljs-string">'total'</span>})
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдЙрдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдХреЗ рд╕рд╛рде рдХрд┐рддрдиреЗ рдкреБрд░реБрд╖ рдФрд░ рдорд╣рд┐рд▓рд╛ рд░рд┐рдХреЙрд░реНрдб рд╣реИрдВред</font></font><br>
<br>
<pre><code class="python hljs">df[<span class="hljs-string">'M'</span>] = armfn[armfn[<span class="hljs-string">'sex'</span>] == <span class="hljs-string">'M'</span>][<span class="hljs-string">'fn'</span>].value_counts()<font></font>
df[<span class="hljs-string">'F'</span>] = armfn[armfn[<span class="hljs-string">'sex'</span>] == <span class="hljs-string">'F'</span>][<span class="hljs-string">'fn'</span>].value_counts()
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>total</th>
<th>M</th>
<th>F</th>
</tr>
<tr>
<td>Michael</td>
<td>20648</td>
<td>20638</td>
<td>10</td>
</tr>
<tr>
<td>David</td>
<td>18493</td>
<td>18485</td>
<td>8</td>
</tr>
<tr>
<td>Thomas</td>
<td>12746</td>
<td>12740</td>
<td>6</td>
</tr>
<tr>
<td>John</td>
<td>11634</td>
<td>11632</td>
<td>2</td>
</tr>
<tr>
<td>Daniel</td>
<td>11045</td>
<td>11041</td>
<td>4</td>
</tr>
<tr>
<td>Mark</td>
<td>10968</td>
<td>10965</td>
<td>3</td>
</tr>
<tr>
<td>Peter</td>
<td>10692</td>
<td>10691</td>
<td>1</td>
</tr>
<tr>
<td>Paul</td>
<td>9616</td>
<td>9614</td>
<td>2</td>
</tr>
<tr>
<td>Christian</td>
<td>8863</td>
<td>8859</td>
<td>4</td>
</tr>
<tr>
<td>Robert</td>
<td>8666</td>
<td>8664</td>
<td>2</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддреЛ ... рдпрд╣ рд╕рдВрджрд┐рдЧреНрдз рд▓рдЧ рд░рд╣рд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЬрд╣рд╛рдБ рддрдХ рдореБрдЭреЗ рдкрддрд╛ рд╣реИ, рдпреЗ рд╕рднреА рдирд╛рдо рдкреБрд▓реНрд▓рд┐рдВрдЧ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдЙрдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдХреЗ рд╕рд╛рде рдорд╣рд┐рд▓рд╛ рд░рд┐рдХреЙрд░реНрдб рдХреА рдХреБрдЫ рдЫреЛрдЯреА рдорд╛рддреНрд░рд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпреЗ рд╕рдВрднрд╡рддрдГ рдбреЗрдЯрд╛ рддреНрд░реБрдЯрд┐рдпрд╛рдВ рд╣реИрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдЗрдП рдирдЬрд░ рдбрд╛рд▓рддреЗ рд╣реИрдВ рдорд╣рд┐рд▓рд╛ рдирд╛рдореЛрдВ рдкрд░ред</font></font><br>
<br>
<pre><code class="python hljs">df.sort_values(by = <span class="hljs-string">'F'</span>, ascending=<span class="hljs-literal">False</span>)
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>total</th>
<th>M</th>
<th>F</th>
</tr>
<tr>
<td>Jennifer</td>
<td>3652</td>
<td>3</td>
<td>3649</td>
</tr>
<tr>
<td>Sarah</td>
<td>3288</td>
<td>4</td>
<td>3284</td>
</tr>
<tr>
<td>Laura</td>
<td>2636</td>
<td>3</td>
<td>2633</td>
</tr>
<tr>
<td>Lisa</td>
<td>2618</td>
<td>2</td>
<td>2616</td>
</tr>
<tr>
<td>Anna</td>
<td>2563</td>
<td>10</td>
<td>2553</td>
</tr>
<tr>
<td>Michelle</td>
<td>2373</td>
<td>1</td>
<td>2372</td>
</tr>
<tr>
<td>Maria</td>
<td>2555</td>
<td>386</td>
<td>2169</td>
</tr>
<tr>
<td>Andrea</td>
<td>4323</td>
<td>2235</td>
<td>2088</td>
</tr>
<tr>
<td>Nicole</td>
<td>2025</td>
<td>6</td>
<td>2019</td>
</tr>
<tr>
<td>Julie</td>
<td>1938</td>
<td>2</td>
<td>1936</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд╣реАред рд▓рдЧрднрдЧред </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдВрдбреНрд░рд┐рдпрд╛</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдЬреЛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдПрдХ androgynous рдирд╛рдо рд╣реИ, рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд╛рд░рд┐рдпрд╛</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реЗ рдереЛрдбрд╝рд╛ рдХрдо рд╣реИ </font><font style="vertical-align: inherit;">, рдХрд┐рд╕реА рдХрд╛рд░рдг </font><font style="vertical-align: inherit;">рд╕реЗ </font><font style="vertical-align: inherit;">рдмрд╛рд╣рд░ рдЦрдбрд╝реЗ рд╣реЛ рдЬрд╛рдУ </font><font style="vertical-align: inherit;">ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рдордд рднреВрд▓реЛ рдХрд┐ рд╣рдо рдмрд╣реБрдд рдЕрд▓рдЧ-рдЕрд▓рдЧ рджреЗрд╢реЛрдВ рдХреЗ рд▓реЛрдЧреЛрдВ рдХреЗ рдбреЗрдЯрд╛ рдкрд░ рд╢реЛрдз рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдХреЛрдИ рднреА рджреБрдирд┐рдпрд╛ рднрд░ рдореЗрдВ рдХрд╣ рд╕рдХрддрд╛ рд╣реИред рд╡рд┐рднрд┐рдиреНрди рд╕рдВрд╕реНрдХреГрддрд┐рдпреЛрдВ рдореЗрдВ, рдПрдХ рд╣реА рдирд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЕрд▓рдЧ-рдЕрд▓рдЧ рддрд░реАрдХреЛрдВ рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣рд╛рдБ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИред </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд░реЗрди</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдорд╛рд░реА рд╕реВрдЪреА рдореЗрдВ рд╕рдмрд╕реЗ рд▓реЛрдХрдкреНрд░рд┐рдп рдорд╣рд┐рд▓рд╛ рдирд╛рдореЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИ, рд▓реЗрдХрд┐рди рджреВрд╕рд░реА рддрд░рдл </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд░реЗрди</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдирд╛рдо рд╣реИ </font><font style="vertical-align: inherit;">, рдЬреЛ рдЙрд╕реА рддрд░рд╣ рд╕реЗ рдЕрдиреБрд╡рд╛рдж рдореЗрдВ рд▓рд┐рдЦрд╛ рдЬрд╛рдПрдЧрд╛, рд▓реЗрдХрд┐рди рдпрд╣ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдкреБрд░реБрд╖реЛрдВ рдХреЗ рд▓рд┐рдП рд╣реИред рд╕реМрднрд╛рдЧреНрдп рд╕реЗ, рдПрдХ рдкреИрдХреЗрдЬ рд╣реИ рдЬреЛ рдЗрд╕ рд╡рд┐рд╢реНрд╡ рдЬреНрдЮрд╛рди рдХреЛ рдзрд╛рд░рдг рдХрд░рддрд╛ рд╣реИред рдЗрд╕реЗ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рд┐рдВрдЧ-рдЕрдиреБрдорд╛рдирдХ</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдЗрд╕ рддрд░рд╣ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> gender_guesser.detector <span class="hljs-keyword">as</span> gg<font></font>
<font></font>
d = gg.Detector()<font></font>
d.get_gender(<span class="hljs-string">u'Oleg'</span>)</code></pre><br>
<code><b>Out:</b> 'male'<br>
</code><br>
<br>
<pre><code class="python hljs">d.get_gender(<span class="hljs-string">u'Evgeniya'</span>)
</code></pre><br>
<code><b>Out:</b> 'female'<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рдмрдХреБрдЫ рдареАрдХ рд╣реИред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдЕрдЧрд░ рдЖрдк </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдВрдбреНрд░рд┐рдпрд╛</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдирд╛рдо рдХреА рдЬрд╛рдВрдЪ рдХрд░рддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">, рддреЛ рд╡рд╣ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд╣рд┐рд▓рд╛ рдХреЛ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рднреА рдмрд╛рд╣рд░ рдХрд░ рджреЗрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">, рдЬреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕рдЪ рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рд╕рдЪ рд╣реИ, рдПрдХ рд░рд╛рд╕реНрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдЖрдк </font><font style="vertical-align: inherit;">рдбрд┐рдЯреЗрдХреНрдЯрд░ </font><font style="vertical-align: inherit;">рдХреА </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд╛рдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдВрдкрддреНрддрд┐ рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">, рддреЛ рд╕рднреА рдЕрд╕реНрдкрд╖реНрдЯрддрд╛ рд╡рд╣рд╛рдВ рджрд┐рдЦрд╛рдИ рджреЗрддреА рд╣реИред</font></font><br>
<br>
<pre><code class="python hljs">d.names[<span class="hljs-string">'Andrea'</span>]
</code></pre><br>
<code><b>Out: </b>{'female': ' 4 4 3 4788 64 579 34 1 7 ',<br>
 'mostly_female': '5 6 7 ',<br>
 'male': ' 7 '}<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рд╛рдБ, рдпрд╣ рд╣реИ рдХрд┐ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_gender</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЖрдкрдХреЛ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛ рд╡рд┐рдХрд▓реНрдк рджреЗрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдпрд╣ рдмрд╣реБрдд рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЕрдиреНрдп рдирд╛рдореЛрдВ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ:</font></font><br>
<br>
<pre><code class="python hljs">d.names[<span class="hljs-string">'Maria'</span>]
</code></pre><br>
<code><b>Out:</b> {'female': '686 6 A 85986 A BA 3B98A75457 6 ',<br>
 'mostly_female': ' BBC A 678A9 '}<br>
</code><br>
<br>
<pre><code class="python hljs">d.names[<span class="hljs-string">'Oleg'</span>]
</code></pre><br>
<code><b>Out:</b> {'male': ' 6 2 99894737 3 '}<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣реА рд╣реИ, </font><font style="vertical-align: inherit;">рдкреНрд░рддреНрдпреЗрдХ рдирд╛рдо рдХреЗ рд▓рд┐рдП </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд╛рдореЛрдВ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреА рд╕реВрдЪреА </font><font style="vertical-align: inherit;">рдПрдХ рдпрд╛ рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рдХреБрдВрдЬреА-рдореВрд▓реНрдп рд╡рд╛рд▓реЗ рдЬреЛрдбрд╝реЗ рд╕реЗ рдореЗрд▓ рдЦрд╛рддреА рд╣реИ, рдЬрд╣рд╛рдВ рдХреБрдВрдЬреА - рдпрд╣ рд╕реЗрдХреНрд╕ рд╣реИ: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреБрд░реБрд╖, рдлреЗрдореЗрд▓реЗ, рдЬреНрдпрд╛рджрд╛рддрд░_рдореИрд▓, рдЬреНрдпрд╛рджрд╛рддрд░_рдлреНрд▓реЗрдмреА, рдПрдВрдбреА</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдФрд░ рдореВрд▓реНрдп - рд╕рдВрдмрдВрдзрд┐рдд рджреЗрд╢ рдХреЗ рдореВрд▓реНрдпреЛрдВ рдХреА рд╕реВрдЪреА: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,2,3 ... .. 9ABC</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рджреЗрд╢ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="python hljs">d.COUNTRIES</code></pre><br>
<code><b>Out:</b> ['great_britain', 'ireland', 'usa', 'italy', 'malta', 'portugal', 'spain', 'france', 'belgium', 'luxembourg', 'the_netherlands', 'east_frisia', 'germany', 'austria', 'swiss', 'iceland', 'denmark', 'norway', 'sweden', 'finland', 'estonia', 'latvia', 'lithuania', 'poland', 'czech_republic', 'slovakia', 'hungary', 'romania', 'bulgaria', 'bosniaand', 'croatia', 'kosovo', 'macedonia', 'montenegro', 'serbia', 'slovenia', 'albania', 'greece', 'russia', 'belarus', 'moldova', 'ukraine', 'armenia', 'azerbaijan', 'georgia', 'the_stans', 'turkey', 'arabia', 'israel', 'china', 'india', 'japan', 'korea', 'vietnam', 'other_countries']<br>
</code> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдореБрдЭреЗ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕рдордЭ рдореЗрдВ рдирд╣реАрдВ рдЖрдпрд╛ рдХрд┐ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╕реВрдЪреА рдореЗрдВ рдЕрд▓реНрдлрд╝рд╛рдиреНрдпреВрдореЗрд░рд┐рдХ рдЕрд░реНрде рдпрд╛ рдЙрдирдХреА рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ рдХреНрдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд╣реАрдВ рдерд╛, рдХреНрдпреЛрдВрдХрд┐ рдореИрдВрдиреЗ рдХреЗрд╡рд▓ рдЙрди рдирд╛рдореЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЦреБрдж рдХреЛ рд╕реАрдорд┐рдд рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛, рдЬрд┐рдирдХреА рд╕реНрдкрд╖реНрдЯ рд╡реНрдпрд╛рдЦреНрдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣реА рд╣реИ, рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдПрдХ рдХреБрдВрдЬреА-рдореВрд▓реНрдп рдЬреЛрдбрд╝реА рд╣реИ рдФрд░ рдХреБрдВрдЬреА </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреБрд░реБрд╖</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд╣рд┐рд▓рд╛ рд╣реИ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рд╣рдорд╛рд░реЗ рдбреЗрдЯрд╛рдлреНрд░реЗрдо рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдирд╛рдо рдХреЗ рд▓рд┐рдП, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рд┐рдВрдЧ-рдЕрдиреБрдорд╛рдирдХ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреА рдЕрдкрдиреА рд╡реНрдпрд╛рдЦреНрдпрд╛ рд▓рд┐рдЦреЗрдВ </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="python hljs">df[<span class="hljs-string">'sex from gg'</span>] = <span class="hljs-string">''</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> df.index:
    <span class="hljs-keyword">if</span> n <span class="hljs-keyword">in</span> list(d.names.keys()):<font></font>
        options = list(d.names[n].keys())<font></font>
        <span class="hljs-keyword">if</span> len(options) == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> options[<span class="hljs-number">0</span>] == <span class="hljs-string">'male'</span>:<font></font>
            df.loc[n, <span class="hljs-string">'sex from gg'</span>] = <span class="hljs-string">'M'</span>
        <span class="hljs-keyword">if</span> len(options) == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> options[<span class="hljs-number">0</span>] == <span class="hljs-string">'female'</span>:<font></font>
            df.loc[n, <span class="hljs-string">'sex from gg'</span>] = <span class="hljs-string">'F'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ 1,150 рдирд╛рдореЛрдВ рдореЗрдВ рдмрджрд▓ рдЧрдпрд╛ред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдВ рд╕рдмрд╕реЗ рд▓реЛрдХрдкреНрд░рд┐рдп рд╣реИрдВ рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдКрдкрд░ рдЪрд░реНрдЪрд╛ рдХрд░ рдЪреБрдХреЗ рд╣реИрдВ: </font><font style="vertical-align: inherit;">рдареАрдХ рд╣реИ, рдмреБрд░рд╛ рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рдЕрдм рдЗрд╕ рддрд░реНрдХ рдХреЛ рд╕рднреА рдЕрднрд┐рд▓реЗрдЦреЛрдВ рдкрд░ рд▓рд╛рдЧреВ рдХрд░реЗрдВред</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>total</th>
<th>M</th>
<th>F</th>
<th>sex from gg</th>
</tr>
<tr>
<td>Michael</td>
<td>20648</td>
<td>20638</td>
<td>10</td>
<td>M</td>
</tr>
<tr>
<td>David</td>
<td>18493</td>
<td>18485</td>
<td>8</td>
<td>M</td>
</tr>
<tr>
<td>Thomas</td>
<td>12746</td>
<td>12740</td>
<td>6</td>
<td>M</td>
</tr>
<tr>
<td>John</td>
<td>11634</td>
<td>11632</td>
<td>2</td>
<td>M</td>
</tr>
<tr>
<td>Daniel</td>
<td>11045</td>
<td>11041</td>
<td>4</td>
<td>M</td>
</tr>
<tr>
<td>Mark</td>
<td>10968</td>
<td>10965</td>
<td>3</td>
<td>M</td>
</tr>
<tr>
<td>Peter</td>
<td>10692</td>
<td>10691</td>
<td>1</td>
<td>M</td>
</tr>
<tr>
<td>Paul</td>
<td>9616</td>
<td>9614</td>
<td>2</td>
<td>M</td>
</tr>
<tr>
<td>Christian</td>
<td>8863</td>
<td>8859</td>
<td>4</td>
<td></td>
</tr>
<tr>
<td>Robert</td>
<td>8666</td>
<td>8664</td>
<td>2</td>
<td>M</td>
</tr>
</tbody></table></div></code><br>
 <code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>total</th>
<th>M</th>
<th>F</th>
<th>sex from gg</th>
</tr>
<tr>
<td>Jennifer</td>
<td>3652</td>
<td>3</td>
<td>3649</td>
<td>F</td>
</tr>
<tr>
<td>Sarah</td>
<td>3288</td>
<td>4</td>
<td>3284</td>
<td>F</td>
</tr>
<tr>
<td>Laura</td>
<td>2636</td>
<td>3</td>
<td>2633</td>
<td>F</td>
</tr>
<tr>
<td>Lisa</td>
<td>2618</td>
<td>2</td>
<td>2616</td>
<td>F</td>
</tr>
<tr>
<td>Anna</td>
<td>2563</td>
<td>10</td>
<td>2553</td>
<td>F</td>
</tr>
<tr>
<td>Michelle</td>
<td>2373</td>
<td>1</td>
<td>2372</td>
<td>F</td>
</tr>
<tr>
<td>Maria</td>
<td>2555</td>
<td>386</td>
<td>2169</td>
<td></td>
</tr>
<tr>
<td>Andrea</td>
<td>4323</td>
<td>2235</td>
<td>2088</td>
<td></td>
</tr>
<tr>
<td>Nicole</td>
<td>2025</td>
<td>6</td>
<td>2019</td>
<td>F</td>
</tr>
<tr>
<td>Julie</td>
<td>1938</td>
<td>2</td>
<td>1936</td>
<td></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">all_names = ar[<span class="hljs-string">'fn'</span>].unique()<font></font>
<font></font>
male_names = []<font></font>
female_names = []<font></font>
<font></font>
<span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> all_names:
    <span class="hljs-keyword">if</span> n <span class="hljs-keyword">in</span> list(d.names.keys()):<font></font>
        options = list(d.names[n].keys())<font></font>
        <span class="hljs-keyword">if</span> len(options) == <span class="hljs-number">1</span>:
            <span class="hljs-keyword">if</span> options[<span class="hljs-number">0</span>] == <span class="hljs-string">'male'</span>:<font></font>
                male_names.append(n)<font></font>
            <span class="hljs-keyword">if</span> options[<span class="hljs-number">0</span>] == <span class="hljs-string">'female'</span>:<font></font>
                female_names.append(n)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдорд┐рд▓рд╛ 7 091 рдкреБрд░реБрд╖ рдирд╛рдо рдФрд░ 5 054 рдорд╣рд┐рд▓рд╛ред </font><font style="vertical-align: inherit;">рдкрд░рд┐рд╡рд░реНрддрди рд▓рд╛рдЧреВ рдХрд░реЗрдВ:</font></font><br>
<br>
<pre><code class="python hljs">tofixm = ar[ar[<span class="hljs-string">'fn'</span>].isin(male_names)]<font></font>
ar.loc[tofixm.index, <span class="hljs-string">'sex'</span>] = <span class="hljs-string">'M'</span>
tofixf = ar[ar[<span class="hljs-string">'fn'</span>].isin(female_names)]<font></font>
ar.loc[tofixf.index, <span class="hljs-string">'sex'</span>] = <span class="hljs-string">'F'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рдкрд░рд┐рдгрд╛рдо рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="python hljs">ar[ar[<span class="hljs-string">'sex'</span>]!=ar[<span class="hljs-string">'sex raw'</span>]]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рд╣реА 30,352 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ (рд╕рдореВрд╣ рдХреЗ рдирд╛рдо рд╕реЗ рд╕реБрдзрд╛рд░ рдХреЗ рд╕рд╛рде)ред </font><font style="vertical-align: inherit;">рд╣рдореЗрд╢рд╛ рдХреА рддрд░рд╣, 10 рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╡рд╛рд▓реЗ: </font><font style="vertical-align: inherit;">рдЕрдм рд╣рдореЗрдВ рдпрдХреАрди рд╣реИ рдХрд┐ рд╣рдордиреЗ рд▓рд┐рдВрдЧ рдХреА рд╕рд╣реА рдкрд╣рдЪрд╛рди рдХрд░ рд▓реА рд╣реИ, рд╣рдо рдорд╛рдирдХ рд╕рдореВрд╣реЛрдВ рдХреЛ рднреА рд▓рд╛рдЗрди рдореЗрдВ рд▓рд╛рдПрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рд╡реЗ рдХрд╣рд╛рдВ рд╕реЗ рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддреЗ:</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th><u>sex</u></th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>...</th>
<th>country raw</th>
<th>group raw</th>
<th><u>sex raw</u></th>
<th>grflc</th>
</tr>
<tr>
<td>...</td>
<td>37</td>
<td><u>F</u></td>
<td>Pilz Christiane</td>
<td>DEU</td>
<td>FPRO</td>
<td>...</td>
<td>GER</td>
<td>FPRO</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>92</td>
<td><u>F</u></td>
<td>Brault Sarah-Anne</td>
<td>CAN</td>
<td>FPRO</td>
<td>...</td>
<td>CAN</td>
<td>FPRO</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>96</td>
<td><u>F</u></td>
<td>Murphy Susanna</td>
<td>IRL</td>
<td>FPRO</td>
<td>...</td>
<td>IRL</td>
<td>FPRO</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>105</td>
<td><u>F</u></td>
<td>Spoelder Romy</td>
<td>NLD</td>
<td></td>
<td>...</td>
<td>NED</td>
<td>FJUNIOR</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>424</td>
<td><u>M</u></td>
<td>Watson Tom</td>
<td>GBR</td>
<td>M40-44</td>
<td>...</td>
<td>GBR</td>
<td>M40-44</td>
<td><u>F</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>81</td>
<td><u>F</u></td>
<td>Morel Charlotte</td>
<td>FRA</td>
<td></td>
<td>...</td>
<td>FRA</td>
<td>FJUNIOR</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>65</td>
<td><u>F</u></td>
<td>Selekhova Olga</td>
<td>RUS</td>
<td></td>
<td>...</td>
<td>RUS</td>
<td>FU23</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>166</td>
<td><u>F</u></td>
<td>Keat Rebekah</td>
<td>AUS</td>
<td></td>
<td>...</td>
<td>AUS</td>
<td>FJUNIOR</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>119</td>
<td><u>F</u></td>
<td>Eim Nina</td>
<td>DEU</td>
<td></td>
<td>...</td>
<td>GER</td>
<td>FQUALтАж</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>73</td>
<td><u>F</u></td>
<td>Sukhoruchenkova Evgenia</td>
<td>RUS</td>
<td>FPRO</td>
<td>...</td>
<td>RUS</td>
<td>FPRO</td>
<td><u>M</u></td>
<td>F</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'gfl'</span>] = ar[<span class="hljs-string">'group'</span>].str[<span class="hljs-number">0</span>]<font></font>
gncws = ar[(ar[<span class="hljs-string">'sex'</span>] != ar[<span class="hljs-string">'gfl'</span>]) &amp; (ar[<span class="hljs-string">'group'</span>]!=<span class="hljs-string">''</span>)]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4,248 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБред </font><font style="vertical-align: inherit;">рдкрд╣рд▓рд╛ рдЕрдХреНрд╖рд░ рдмрджрд▓реЗрдВ:</font></font><br>
<br>
<pre><code class="python hljs">ar.loc[gncws.index, <span class="hljs-string">'group'</span>] = ar.loc[gncws.index, <span class="hljs-string">'sex'</span>] + ar.loc[gncws.index, <span class="hljs-string">'group'</span>].str[<span class="hljs-number">1</span>:].index, <span class="hljs-string">'sex'</span>]
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th><u>sex</u></th>
<th>name</th>
<th>country</th>
<th><u>group</u></th>
<th>...</th>
<th>country raw</th>
<th><u>group raw</u></th>
<th>sex raw</th>
</tr>
<tr>
<td>...</td>
<td>803</td>
<td><u>F</u></td>
<td>Kenney Joelle</td>
<td>USA</td>
<td><u>F35-39</u></td>
<td>...</td>
<td>USA</td>
<td><u>M35-39</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>1432</td>
<td><u>M</u></td>
<td>Holmberg Henriette Gorm</td>
<td>DNK</td>
<td><u>M45-49</u></td>
<td>...</td>
<td>DEN</td>
<td><u>F45-49</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>503</td>
<td><u>M</u></td>
<td>Tai Oy Leen</td>
<td>MYS</td>
<td><u>M40-44</u></td>
<td>...</td>
<td>MAS</td>
<td><u>F40-44</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>236</td>
<td><u>F</u></td>
<td>Dissanayake Aruna</td>
<td>LKA</td>
<td><u>F25-29</u></td>
<td>...</td>
<td>SRI</td>
<td><u>M25-29</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>1349</td>
<td><u>F</u></td>
<td>Delos Reyes Joshua Rafaelle</td>
<td>PHL</td>
<td><u>F18-24</u></td>
<td>...</td>
<td>PHI</td>
<td><u>M18-24</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>543</td>
<td><u>F</u></td>
<td>Vandekendelaere Janique</td>
<td>BEL</td>
<td><u>F50-54</u></td>
<td>...</td>
<td>BEL</td>
<td><u>M50-54</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>1029</td>
<td><u>M</u></td>
<td>Provost Shaun</td>
<td>USA</td>
<td><u>M25-29</u></td>
<td>...</td>
<td>USA</td>
<td><u>F25-29</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>303</td>
<td><u>F</u></td>
<td>Torrens Vadell Macia</td>
<td>ESP</td>
<td><u>F30-34</u></td>
<td>...</td>
<td>ESP</td>
<td><u>M30-34</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>1338</td>
<td><u>F</u></td>
<td>Suarez Renan</td>
<td>BOL</td>
<td><u>F35-39</u></td>
<td>...</td>
<td>BOL</td>
<td><u>M35-39</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>502</td>
<td><u>F</u></td>
<td>Everlo Linda</td>
<td>NLD</td>
<td><u>F30-34</u></td>
<td>...</td>
<td>NED</td>
<td><u>M30-34</u></td>
<td>M</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╢рд╛рдпрдж, рдХрд╣реАрдВ рди рдХрд╣реАрдВ рд╕реБрдзрд╛рд░ рдЧрд▓рдд рд╣реЛ рдЧрдП, рд▓реЗрдХрд┐рди рд╣рд░ рдХреЛрдИ рдЬрд▓реНрджреА рд╕реЛрдЪрддрд╛ рд╣реИ рдХрд┐ рдЙрдиреНрд╣реЛрдВрдиреЗ рдиреБрдХрд╕рд╛рди рд╕реЗ рдЬреНрдпрд╛рджрд╛ рдЕрдЪреНрдЫрд╛ рдХрд┐рдпрд╛ред </font><font style="vertical-align: inherit;">рдЖрдВрдХрдбрд╝реЛрдВ рдХреЗ рд▓рд┐рдП, рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рд╕реЗрдХреНрд╕ рдХреА рдмрд╣рд╛рд▓реА рдХреЗ рд╕рд╛рде рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдХрд╛рд░реНрдпрд╢реАрд▓ рдХреЙрд▓рдо рд╣рдЯрд╛рддреЗ рд╣реИрдВ, рд╢рдмреНрджрдХреЛрд╢ рдореЗрдВ рдЕрдиреБрд╡рд╛рдж рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рд╕рд╣реЗрдЬрддреЗ рд╣реИрдВред</font></font><br>
<br>
<pre><code class="python hljs">pkl.dump(rd, open(<span class="hljs-string">r'D:\tri\details8.pkl'</span>, <span class="hljs-string">'wb'</span>))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдзреВрд░рд╛ рдбреЗрдЯрд╛ рдХреА рд╡рд╕реВрд▓реА рдХреЗ рд╕рд╛рде, рдпрд╣ рд╕рдм рд╣реИред</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреБрд▓реЗрдЯрд┐рди рдЕрдкрдбреЗрдЯ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдкреБрд░реБрд╖реЛрдВ рдФрд░ рдорд╣рд┐рд▓рд╛рдУрдВ рдХреА рд╕рдВрдЦреНрдпрд╛, рдЖрджрд┐ рдкрд░ рдЕрджреНрдпрддрди рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рд╕рд╛рд░рд╛рдВрд╢ рддрд╛рд▓рд┐рдХрд╛ рдХреЛ рдЕрджреНрдпрддрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдиреА рд╣реБрдИ рд╣реИред </font></font><br>
<br>
<pre><code class="python hljs">rs[<span class="hljs-string">'total raw'</span>] = rs[<span class="hljs-string">'total'</span>]<font></font>
rs[<span class="hljs-string">'males raw'</span>] = rs[<span class="hljs-string">'males'</span>]<font></font>
rs[<span class="hljs-string">'females raw'</span>] = rs[<span class="hljs-string">'females'</span>]<font></font>
rs[<span class="hljs-string">'rus raw'</span>] = rs[<span class="hljs-string">'rus'</span>]<font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> rs.index:<font></font>
    e = rs.loc[i,<span class="hljs-string">'event'</span>]<font></font>
    rs.loc[i,<span class="hljs-string">'total'</span>] = len(rd[e])<font></font>
    rs.loc[i,<span class="hljs-string">'males'</span>] = len(rd[e][rd[e][<span class="hljs-string">'sex'</span>] == <span class="hljs-string">'M'</span>])<font></font>
    rs.loc[i,<span class="hljs-string">'females'</span>] = len(rd[e][rd[e][<span class="hljs-string">'sex'</span>] == <span class="hljs-string">'F'</span>])<font></font>
    rs.loc[i,<span class="hljs-string">'rus'</span>] = len(rd[e][rd[e][<span class="hljs-string">'country'</span>] == <span class="hljs-string">'RUS'</span>])<font></font>
<font></font>
len(rs[rs[<span class="hljs-string">'total'</span>] != rs[<span class="hljs-string">'total raw'</span>]])</code></pre><br>
<code><b>Out:</b> 288<br>
</code><br>
<br>
<pre><code class="python hljs">len(rs[rs[<span class="hljs-string">'males'</span>] != rs[<span class="hljs-string">'males raw'</span>]])
</code></pre><br>
<code><b>Out:</b>962<br>
</code><br>
<br>
<pre><code class="python hljs">len(rs[rs[<span class="hljs-string">'females'</span>] != rs[<span class="hljs-string">'females raw'</span>]])
</code></pre><br>
<code><b>Out:</b> 836<br>
</code><br>
<br>
<pre><code class="python hljs">len(rs[rs[<span class="hljs-string">'rus'</span>] != rs[<span class="hljs-string">'rus raw'</span>]])
</code></pre><br>
<code><b>Out:</b> 8<br>
</code><br>
<br>
<pre><code class="python hljs">pkl.dump(rs, open(<span class="hljs-string">r'D:\tri\summary6.pkl'</span>, <span class="hljs-string">'wb'</span>))
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рднрд╛рдЧ 4. рдирдореВрдирд╛</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рдЯреНрд░рд╛рдпрдерд▓реЙрди рдмрд╣реБрдд рд▓реЛрдХрдкреНрд░рд┐рдп рд╣реИред </font><font style="vertical-align: inherit;">рд╕реАрдЬрд╝рди рдХреЗ рджреМрд░рд╛рди, рдХрдИ рдЦреБрд▓реА рдкреНрд░рддрд┐рдпреЛрдЧрд┐рддрд╛рдПрдВ рд╣реЛрддреА рд╣реИрдВ рдЬрд┐рдирдореЗрдВ рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдПрдерд▓реАрдЯ, рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдПрдореЗрдЪреНрдпреЛрд░, рднрд╛рдЧ рд▓реЗрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдкрд░ рд╣рдореЗрд╢рд╛ рд╕реЗ рдРрд╕рд╛ рдирд╣реАрдВ рдерд╛ред </font><font style="vertical-align: inherit;">1990 рдХреЗ рдмрд╛рдж рд╕реЗ рд╣рдорд╛рд░реЗ рдбреЗрдЯрд╛ рдореЗрдВ рд░рд┐рдХреЙрд░реНрдб рд╣реИрдВред </font><font style="vertical-align: inherit;">Tristats.ru рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реНрдХреНрд░реЙрд▓ рдХрд░рддреЗ рд╣реБрдП, рдореИрдВрдиреЗ рджреЗрдЦрд╛ рдХрд┐ рд╣рд╛рд▓ рдХреЗ рд╡рд░реНрд╖реЛрдВ рдореЗрдВ рдмрд╣реБрдд рдЕрдзрд┐рдХ рджреМрдбрд╝реЗрдВ рд╣реИрдВ, рдФрд░ рдкрд╣рд▓реЗ рдореЗрдВ рдмрд╣реБрдд рдХрдо рд╣реИрдВред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдЕрдм рдЬрдм рд╣рдорд╛рд░рд╛ рдбреЗрдЯрд╛ рддреИрдпрд╛рд░ рд╣реЛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЖрдк рдЗрд╕реЗ рдФрд░ рдХрд░реАрдм рд╕реЗ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджрд╕ рд╕рд╛рд▓ рдХреА рдЕрд╡рдзрд┐</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреНрд░рддреНрдпреЗрдХ рд╡рд░реНрд╖ рдореЗрдВ рджреМрдбрд╝ рдФрд░ рдлрд┐рдирд┐рд╢рд░реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреА рдЧрдгрдирд╛ рдХрд░реЗрдВ:</font></font><br>
<br>
<pre><code class="python hljs">rs[<span class="hljs-string">'year'</span>] = pd.DatetimeIndex(rs[<span class="hljs-string">'date'</span>]).year<font></font>
years = range(rs[<span class="hljs-string">'year'</span>].min(),rs[<span class="hljs-string">'year'</span>].max())<font></font>
rsy = pd.DataFrame(columns = [<span class="hljs-string">'races'</span>, <span class="hljs-string">'finishers'</span>, <span class="hljs-string">'rus'</span>, <span class="hljs-string">'RUS'</span>], index = years) <span class="hljs-comment">#rsy тАУ races summary by year</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> rsy.index:<font></font>
    rsy.loc[y,<span class="hljs-string">'races'</span>] = len(rs[rs[<span class="hljs-string">'year'</span>] == y])<font></font>
    rsy.loc[y,<span class="hljs-string">'finishers'</span>] = sum(rs[rs[<span class="hljs-string">'year'</span>] == y][<span class="hljs-string">'total'</span>])<font></font>
    rsy.loc[y,<span class="hljs-string">'rus'</span>] =  sum(rs[rs[<span class="hljs-string">'year'</span>] == y][<span class="hljs-string">'rus'</span>])<font></font>
    rsy.loc[y,<span class="hljs-string">'RUS'</span>] = len(rs[(rs[<span class="hljs-string">'year'</span>] == y)&amp;(rs[<span class="hljs-string">'country'</span>] == <span class="hljs-string">'RUS'</span>)])
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>year</th>
<th>races</th>
<th>finishers</th>
<th>rus</th>
<th>RUS</th>
</tr>
<tr>
<td>1990</td>
<td>1</td>
<td>286</td>
<td>5</td>
<td>0</td>
</tr>
<tr>
<td>1991</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>1992</td>
<td>1</td>
<td>317</td>
<td>3</td>
<td>0</td>
</tr>
<tr>
<td>1993</td>
<td>2</td>
<td>887</td>
<td>3</td>
<td>0</td>
</tr>
<tr>
<td>1994</td>
<td>2</td>
<td>128</td>
<td>3</td>
<td>0</td>
</tr>
<tr>
<td>1995</td>
<td>3</td>
<td>731</td>
<td>7</td>
<td>0</td>
</tr>
<tr>
<td>1996</td>
<td>3</td>
<td>776</td>
<td>6</td>
<td>0</td>
</tr>
<tr>
<td>1997</td>
<td>3</td>
<td>403</td>
<td>11</td>
<td>0</td>
</tr>
<tr>
<td>1998</td>
<td>4</td>
<td>583</td>
<td>21</td>
<td>0</td>
</tr>
<tr>
<td>1999</td>
<td>10</td>
<td>1106</td>
<td>26</td>
<td>0</td>
</tr>
<tr>
<td>2000</td>
<td>10</td>
<td>1231</td>
<td>29</td>
<td>0</td>
</tr>
<tr>
<td>2001</td>
<td>11</td>
<td>1992</td>
<td>32</td>
<td>0</td>
</tr>
<tr>
<td>2002</td>
<td>21</td>
<td>2249</td>
<td>100</td>
<td>0</td>
</tr>
<tr>
<td>2003</td>
<td>30</td>
<td>3152</td>
<td>158</td>
<td>0</td>
</tr>
<tr>
<td>2004</td>
<td>19</td>
<td>5488</td>
<td>128</td>
<td>1</td>
</tr>
<tr>
<td>2005</td>
<td>16</td>
<td>3024</td>
<td>244</td>
<td>1</td>
</tr>
<tr>
<td>2006</td>
<td>29</td>
<td>6210</td>
<td>369</td>
<td>1</td>
</tr>
<tr>
<td>2007</td>
<td>44</td>
<td>12153</td>
<td>444</td>
<td>1</td>
</tr>
<tr>
<td>2008</td>
<td>43</td>
<td>13830</td>
<td>369</td>
<td>1</td>
</tr>
<tr>
<td>2009</td>
<td>49</td>
<td>27047</td>
<td>478</td>
<td>1</td>
</tr>
<tr>
<td>2010</td>
<td>47</td>
<td>26528</td>
<td>366</td>
<td>1</td>
</tr>
<tr>
<td>2011</td>
<td>77</td>
<td>45412</td>
<td>848</td>
<td>5</td>
</tr>
<tr>
<td>2012</td>
<td>96</td>
<td>75590</td>
<td>1055</td>
<td>4</td>
</tr>
<tr>
<td>2013</td>
<td>98</td>
<td>86617</td>
<td>2165</td>
<td>9</td>
</tr>
<tr>
<td>2014</td>
<td>135</td>
<td>138018</td>
<td>3188</td>
<td>11</td>
</tr>
<tr>
<td>2015</td>
<td>164</td>
<td>172375</td>
<td>4846</td>
<td>15</td>
</tr>
<tr>
<td>2016</td>
<td>192</td>
<td>178630</td>
<td>7541</td>
<td>27</td>
</tr>
<tr>
<td>2017</td>
<td>238</td>
<td>185473</td>
<td>8825</td>
<td>42</td>
</tr>
<tr>
<td>2018</td>
<td>278</td>
<td>203031</td>
<td>10954</td>
<td>54</td>
</tr>
<tr>
<td>2019</td>
<td>293</td>
<td>220901</td>
<td>13354</td>
<td>59</td>
</tr>
</tbody></table></div></code><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RUS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - рд░реВрд╕ рдореЗрдВ рджреМрдбрд╝ред </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rus</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - рд░реВрд╕ рд╕реЗ рдлрд┐рдирд┐рд╢рд░ред </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣рд╛рдБ рдпрд╣ рдПрдХ рдЪрд╛рд░реНрдЯ рдкрд░ рдХреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИ:</font></font><br>
<img src="https://habrastorage.org/webt/nx/yg/4s/nxyg4syvd0x-0f16nxl1ucvhyma.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЕрд╡рдзрд┐ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдФрд░ рдЕрдВрдд рдореЗрдВ рджреМрдбрд╝ рдФрд░ рдкреНрд░рддрд┐рднрд╛рдЧрд┐рдпреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЗрд╡рд▓ рдЕрд╕рдВрдЧрдд рд╣реИред 2011 рдореЗрдВ рджреМрдбрд╝ рдХреА рдХреБрд▓ рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦрдиреАрдп рд╡реГрджреНрдзрд┐ рд╣реБрдИ, рдЬрдмрдХрд┐ рд░реВрд╕ рдореЗрдВ рд╢реБрд░реВ рд╣реЛрдиреЗ рдХреА рд╕рдВрдЦреНрдпрд╛ рднреА рдмрдврд╝ рдЬрд╛рддреА рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдкреНрд░рддрд┐рднрд╛рдЧрд┐рдпреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рд╡реГрджреНрдзрд┐ 2009 рдореЗрдВ рд╡рд╛рдкрд╕ рджреЗрдЦреА рдЬрд╛ рд╕рдХрддреА рд╣реИред рдпрд╣ рдкреНрд░рддрд┐рднрд╛рдЧрд┐рдпреЛрдВ рдХреЗ рдмреАрдЪ рдмрдврд╝реА рд╣реБрдИ рд░реБрдЪрд┐ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ, рдЕрд░реНрдерд╛рддреН, рдорд╛рдВрдЧ рдореЗрдВ рд╡реГрджреНрдзрд┐, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рджреЛ рд╕рд╛рд▓ рдмрд╛рдж рдЖрдкреВрд░реНрддрд┐ рдореЗрдВ рд╡реГрджреНрдзрд┐ рд╣реБрдИ рд╣реИ, рдЕрд░реНрдерд╛рддреН рд╢реБрд░реВ рдХреА рд╕рдВрдЦреНрдпрд╛ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рдордд рднреВрд▓реЛ рдХрд┐ рдбреЗрдЯрд╛ рдкреВрд░рд╛ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдХреБрдЫ, рдФрд░ рд╕рдВрднрд╡рддрдГ рдХрдИ рджреМрдбрд╝ рдЧрд╛рдпрдм рд╣реИрдВред рдЗрд╕ рддрдереНрдп рдХреЗ рдХрд╛рд░рдг рдХрд┐ рдЗрд╕ рдбреЗрдЯрд╛ рдХреЛ рдЗрдХрдЯреНрдард╛ рдХрд░рдиреЗ рдХреА рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗрд╡рд▓ 2010 рдореЗрдВ рд╢реБрд░реВ рд╣реБрдИ рдереА, рдЬреЛ рдЗрд╕ рдХреНрд╖рдг рдореЗрдВ рдЧреНрд░рд╛рдл рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЫрд▓рд╛рдВрдЧ рднреА рд╕рдордЭрд╛ рд╕рдХрддреА рд╣реИред рдЗрд╕рд▓рд┐рдП, рдЖрдЧреЗ рдХреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП, рдореИрдВрдиреЗ рдкрд┐рдЫрд▓реЗ 10 рд╕рд╛рд▓ рд▓реЗрдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛ред рдпрд╣ рдПрдХ рд▓рдВрдмреА рдЕрд╡рдзрд┐ рд╣реИ,рдХрдИ рд╡рд░реНрд╖реЛрдВ рдореЗрдВ рдХрд┐рд╕реА рднреА рдЯреНрд░реЗрдВрдб рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЬрдмрдХрд┐ рд╡рд╣рд╛рдВ рди рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдХрдо, рдореБрдЦреНрдп рд░реВрдк рд╕реЗ 90 рдХреЗ рджрд╢рдХ рдФрд░ 2000 рдХреЗ рджрд╢рдХ рдХреА рд╢реБрд░реБрдЖрдд рд╕реЗ рдкреЗрд╢реЗрд╡рд░ рдкреНрд░рддрд┐рдпреЛрдЧрд┐рддрд╛рдПрдВред</font></font><br>
<br>
<pre><code class="python hljs">rs = rs[(rs[<span class="hljs-string">'year'</span>]&gt;=<span class="hljs-number">2010</span>)&amp;(rs[<span class="hljs-string">'year'</span>]&lt;= <span class="hljs-number">2019</span>)]
</code></pre><br>
<img src="https://habrastorage.org/webt/ck/p4/qf/ckp4qfjucrjhl7kvu-0fyv_ilbc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЪрдпрдирд┐рдд рдЕрд╡рдзрд┐ рдореЗрдВ, 84% рджреМрдбрд╝ рдФрд░ 94% рдлрд┐рдирд┐рд╢рд░реНрд╕ рдЧрд┐рд░ рдЧрдПред</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдореЗрдЪреНрдпреЛрд░ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕рд▓рд┐рдП, рдЪрдпрдирд┐рдд рдкреНрд░рд╛рд░рдВрдн рдореЗрдВ рднрд╛рдЧ рд▓реЗрдиреЗ рд╡рд╛рд▓реЗ рдЕрдзрд┐рдХрд╛рдВрд╢ рднрд╛рдЧ рд╢реМрдХрд┐рдпрд╛ рдПрдерд▓реАрдЯ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЙрдирд╕реЗ рдЕрдЪреНрдЫреЗ рдЖрдБрдХрдбрд╝реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдИрдорд╛рдирджрд╛рд░реА рд╕реЗ, рдпрд╣ рдореЗрд░реЗ рд▓рд┐рдП рдореБрдЦреНрдп рд░реБрдЪрд┐ рдереА, рдХреНрдпреЛрдВрдХрд┐ рдореИрдВ рдЦреБрдж рдЗрд╕ рддрд░рд╣ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рднрд╛рдЧ рд▓реЗрддрд╛ рд╣реВрдВ, рд▓реЗрдХрд┐рди рд╕реНрддрд░ рдореЗрдВ рдпрд╣ рдУрд▓рдВрдкрд┐рдХ рдЪреИрдВрдкрд┐рдпрди рд╕реЗ рдмрд╣реБрдд рджреВрд░ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдкреЗрд╢реЗрд╡рд░ рдкреНрд░рддрд┐рдпреЛрдЧрд┐рддрд╛рдПрдВ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдЪрдпрдирд┐рдд рдЕрд╡рдзрд┐ рдореЗрдВ рд╣реБрдИрдВред рд╢реМрдХрд┐рдпрд╛ рдФрд░ рдкреЗрд╢реЗрд╡рд░ рджреМрдбрд╝ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреЗрддрдХреЛрдВ рдХреЛ рдорд┐рд╢реНрд░рдг рдирд╣реАрдВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдмрд╛рдж рд╡рд╛рд▓реЗ рдХреЛ рд╡рд┐рдЪрд╛рд░ рд╕реЗ рд╣рдЯрд╛рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдЙрдирдХреА рдкрд╣рдЪрд╛рди рдХреИрд╕реЗ рдХрд░реЗрдВ? рдЧрддрд┐ рд╕реЗред рд╣рдо рдЙрдирдХрд╛ рд╣рд┐рд╕рд╛рдм рд▓рдЧрд╛рддреЗ рд╣реИрдВред рдбреЗрдЯрд╛ рддреИрдпрд╛рд░ рдХрд░рдиреЗ рдХреЗ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЪрд░рдгреЛрдВ рдореЗрдВ рд╕реЗ, рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдерд╛ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рджреМрдбрд╝ рдкрд░ рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХреА рджреВрд░реА рд╣реИ - рд╕реНрдкреНрд░рд┐рдВрдЯ, рдУрд▓рдВрдкрд┐рдХ, рдЖрдзрд╛, рд▓реЛрд╣рд╛ред рдЙрдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдХреЗ рд▓рд┐рдП, рдЪрд░рдгреЛрдВ рдХрд╛ рд▓рд╛рдн рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ - рддреИрд░рд╛рдХреА, рд╕рд╛рдЗрдХрд┐рд▓ рдЪрд▓рд╛рдирд╛ рдФрд░ рджреМрдбрд╝рдирд╛ред рдпрд╣ рд╕реНрдкреНрд░рд┐рдВрдЯ рдХреЗ рд▓рд┐рдП 0.75 + 20 + 5, рдУрд▓рдВрдкрд┐рдХ рдХреЗ рд▓рд┐рдП 1.5 + 40 + 10, рд╣рд╛рдл рдФрд░ 3 рдХреЗ рд▓рд┐рдП 1.9 + 90 + 21.1 рд╣реИредрд▓реЛрд╣реЗ рдХреЗ рд▓рд┐рдП 8 + 180 + 42.2ред рдмреЗрд╢рдХ, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдХрд┐рд╕реА рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ рд▓рд┐рдП, рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдВрдЦреНрдпрд╛ рджреМрдбрд╝ рд╕реЗ рдЬрд╛рддрд┐ рдореЗрдВ рднрд┐рдиреНрди рд░реВрдк рд╕реЗ рдПрдХ рдкреНрд░рддрд┐рд╢рдд рддрдХ рд╣реЛ рд╕рдХрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рдХреЛрдИ рдЬрд╛рдирдХрд╛рд░реА рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдорд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рд╕рдм рдХреБрдЫ рд╕рдЯреАрдХ рдерд╛ред</font></font><br>
<br>
<pre><code class="python hljs">rs[<span class="hljs-string">'km'</span>] = <span class="hljs-string">''</span><font></font>
<font></font>
rs.loc[rs[<span class="hljs-string">'dist'</span>] == <span class="hljs-string">'sprint'</span>, <span class="hljs-string">'km'</span>] = <span class="hljs-number">0.75</span>+<span class="hljs-number">20</span>+<span class="hljs-number">5</span>
rs.loc[rs[<span class="hljs-string">'dist'</span>] == <span class="hljs-string">'olympic'</span>, <span class="hljs-string">'km'</span>] = <span class="hljs-number">1.5</span>+<span class="hljs-number">40</span>+<span class="hljs-number">10</span>
rs.loc[rs[<span class="hljs-string">'dist'</span>] == <span class="hljs-string">'half'</span>, <span class="hljs-string">'km'</span>] = <span class="hljs-number">1.9</span>+<span class="hljs-number">90</span>+<span class="hljs-number">21.1</span>
rs.loc[rs[<span class="hljs-string">'dist'</span>] == <span class="hljs-string">'full'</span>, <span class="hljs-string">'km'</span>] = <span class="hljs-number">3.8</span>+<span class="hljs-number">180</span>+<span class="hljs-number">42.2</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рджреМрдбрд╝ рдХреЗ рд▓рд┐рдП рдФрд╕рдд рдФрд░ рдЕрдзрд┐рдХрддрдо рдЧрддрд┐ рдХреА рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдВ рдЕрдзрд┐рдХрддрдо рдЙрд╕ рдПрдерд▓реАрдЯ рдХреА рдФрд╕рдд рдЧрддрд┐ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдиреЗ рдкрд╣рд▓рд╛ рд╕реНрдерд╛рди рдЬреАрддрд╛ рдерд╛ред</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> index, row <span class="hljs-keyword">in</span> rs.iterrows():<font></font>
    e = row[<span class="hljs-string">'event'</span>]<font></font>
    rd[e][<span class="hljs-string">'th'</span>] = pd.TimedeltaIndex(rd[e][<span class="hljs-string">'result'</span>]).seconds/<span class="hljs-number">3600</span>
    rd[e][<span class="hljs-string">'v'</span>] = rs.loc[i, <span class="hljs-string">'km'</span>] / rd[e][<span class="hljs-string">'th'</span>]<font></font>
<font></font>
<span class="hljs-keyword">for</span> index, row <span class="hljs-keyword">in</span> rs.iterrows():<font></font>
    e = row[<span class="hljs-string">'event'</span>]<font></font>
    rs.loc[index,<span class="hljs-string">'vmax'</span>] = rd[e][<span class="hljs-string">'v'</span>].max()<font></font>
    rs.loc[index,<span class="hljs-string">'vavg'</span>] = rd[e][<span class="hljs-string">'v'</span>].mean()
</code></pre><br>
<img src="https://habrastorage.org/webt/81/6k/pe/816kpel94nzs-hsp9dphfdhtq3g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдареАрдХ рд╣реИ, рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд▓рдЧрднрдЧ 15 рдХрд┐рдореА / рдШрдВрдЯрд╛ рдФрд░ 30 рдХрд┐рдореА / рдШрдВрдЯрд╛ рдХреЗ рдмреАрдЪ рдвреЗрд░ рдореЗрдВ рдЧрддрд┐ рдХрд╛ рдПрдХ рдмрдбрд╝рд╛ рд╣рд┐рд╕реНрд╕рд╛ рдЗрдХрдЯреНрдард╛ рд╣реБрдЖ рд╣реИ, рд▓реЗрдХрд┐рди рдкреВрд░реА рддрд░рд╣ рд╕реЗ "рдмреНрд░рд╣реНрдорд╛рдВрдбреАрдп" рдореВрд▓реНрдпреЛрдВ рдХреА рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рд╕рдВрдЦреНрдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдФрд╕рдд рдЧрддрд┐ рд╕реЗ рдХреНрд░рдордмрджреНрдз рдХрд░реЗрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдЙрдирдореЗрдВ рд╕реЗ рдХрд┐рддрдиреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="python hljs">rs = rs.sort_values(by=<span class="hljs-string">'vavg'</span>)
</code></pre><br>
<img src="https://habrastorage.org/webt/aa/wi/ws/aawiwsx0kcmhzyq3y3ezcm_fy0o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣рд╛рдВ рд╣рдордиреЗ рдкреИрдорд╛рдирд╛ рдмрджрд▓ рджрд┐рдпрд╛ рдФрд░ рд╣рдо рд╕реАрдорд╛ рдХрд╛ рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдФрд╕рдд рдЧрддрд┐ рдХреЗ рд▓рд┐рдП рдпрд╣ рд▓рдЧрднрдЧ 17 рдХрд┐рдореА / рдШрдВрдЯрд╛ рд╕реЗ 27 рдХрд┐рдореА / рдШрдВрдЯрд╛, рдЕрдзрд┐рдХрддрдо рдХреЗ рд▓рд┐рдП - 18 рдХрд┐рдореА / рдШрдВрдЯрд╛ рд╕реЗ 32 рдХрд┐рдореА / рдШрдВрдЯрд╛ рддрдХ рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдмрд╣реБрдд рдХрдо рдФрд░ рдмрд╣реБрдд рдЙрдЪреНрдЪ рдФрд╕рдд рдЧрддрд┐ рдХреЗ рд╕рд╛рде "рдкреВрдВрдЫ" рд╣реИрдВред рдХрдо рдЧрддрд┐ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ </font><font style="vertical-align: inherit;">, </font><font style="vertical-align: inherit;">рдЬреИрд╕реЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреЛрд░реНрд╢рдореИрди</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬреИрд╕реА рдЪрд░рдо рдкреНрд░рддрд┐рдпреЛрдЧрд┐рддрд╛рдУрдВ рдХреЗ рдЕрдиреБрд░реВрдк </font><font style="vertical-align: inherit;">, рдФрд░ рдЙрдЪреНрдЪ </font><font style="vertical-align: inherit;">рдЧрддрд┐ </font><font style="vertical-align: inherit;">рд░рджреНрдж рддреИрд░рд╛рдХреА рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЬрд╣рд╛рдВ рд╕реНрдкреНрд░рд┐рдВрдЯ рдХреЗ рдмрдЬрд╛рдп рдПрдХ рд╕реБрдкрд░ рд╕реНрдкреНрд░рд┐рдВрдЯ, рдпрд╛ рдмрд╕ рдЧрд▓рдд рдбреЗрдЯрд╛ рдерд╛ред рдПрдХ рдЕрдиреНрдп рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд┐рдВрджреБ </font><i><font style="vertical-align: inherit;">рдПрдХреНрд╕</font></i><font style="vertical-align: inherit;"> рдЕрдХреНрд╖ рдХреЗ рд╕рд╛рде </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1200</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдЪрд┐рдХрдиреА рдХрджрдо рд╣реИ</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдФрд░ рдЗрд╕рдХреЗ рдмрд╛рдж рдХреА рдФрд╕рдд рдЧрддрд┐ рдХреЗ рдЙрдЪреНрдЪ рдореВрд▓реНрдпред </font><font style="vertical-align: inherit;">рд╡рд╣рд╛рдВ рдЖрдк рдЧреНрд░рд╛рдл рдХреЗ рдкрд╣рд▓реЗ рджреЛ-рддрд┐рд╣рд╛рдИ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдФрд╕рдд рдФрд░ рдЕрдзрд┐рдХрддрдо рдЧрддрд┐ рдХреЗ рдмреАрдЪ рдХрд╛рдлреА рдЫреЛрдЯрд╛ рдЕрдВрддрд░ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЬрд╛рд╣рд┐рд░ рд╣реИ, рдпрд╣ рдПрдХ рдкреЗрд╢реЗрд╡рд░ рдкреНрд░рддрд┐рдпреЛрдЧрд┐рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЙрдиреНрд╣реЗрдВ рдЕрдзрд┐рдХ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рднреЗрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдФрд╕рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХрддрдо рдЧрддрд┐ рдХреЗ рдЕрдиреБрдкрд╛рдд рдХреА рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдкреЗрд╢реЗрд╡рд░ рдкреНрд░рддрд┐рдпреЛрдЧрд┐рддрд╛рдУрдВ рдореЗрдВ рдЬрд╣рд╛рдВ рдХреЛрдИ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд▓реЛрдЧ рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рд╕рднреА рдкреНрд░рддрд┐рднрд╛рдЧрд┐рдпреЛрдВ рдХреЗ рдкрд╛рд╕ рд╢рд╛рд░реАрд░рд┐рдХ рдлрд┐рдЯрдиреЗрд╕ рдХрд╛ рдПрдХ рдЙрдЪреНрдЪ рд╕реНрддрд░ рд╣реЛрддрд╛ рд╣реИ, рдпрд╣ рдЕрдиреБрдкрд╛рдд рдиреНрдпреВрдирддрдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред</font></font><br>
<br>
<pre><code class="python hljs">rs[<span class="hljs-string">'vmdbva'</span>] = rs[<span class="hljs-string">'vmax'</span>]/rs[<span class="hljs-string">'vavg'</span>] <span class="hljs-comment">#vmdbva - v max divided by v avg</span>
rs = rs.sort_values(by=<span class="hljs-string">'vmdbva'</span>)
</code></pre><br>
<img src="https://habrastorage.org/webt/li/cv/pr/licvprwpcx3zlws5pjufo0dxhcm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рдЧреНрд░рд╛рдл рдкрд░, рдкрд╣рд▓реА рддрд┐рдорд╛рд╣реА рдмрд╣реБрдд рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рд╕рд╛рдордиреЗ рдЖрддреА рд╣реИ: рдФрд╕рдд рд╕реЗ рдЕрдзрд┐рдХрддрдо рдЧрддрд┐ рдХрд╛ рдЕрдиреБрдкрд╛рдд рдЫреЛрдЯрд╛, рдЙрдЪреНрдЪ рдФрд╕рдд рдЧрддрд┐, рдкреНрд░рддрд┐рднрд╛рдЧрд┐рдпреЛрдВ рдХреА рдПрдХ рдЫреЛрдЯреА рд╕рдВрдЦреНрдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рдПрдХ рдкреЗрд╢реЗрд╡рд░ рдкреНрд░рддрд┐рдпреЛрдЧрд┐рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рд░реЗ рд░рдВрдЧ рдХреА рд╡рдХреНрд░ рдкрд░ рдХрджрдо рд▓рдЧрднрдЧ 1.2 рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдЕрдкрдиреЗ рдирдореВрдиреЗ рдореЗрдВ рдХреЗрд╡рд▓ 1.2 рд╕реЗ рдЕрдзрд┐рдХ рдЕрдиреБрдкрд╛рдд рдореВрд▓реНрдп рдХреЗ рд╕рд╛рде рд░рд┐рдХреЙрд░реНрдб рдЫреЛрдбрд╝ рджреЗрдВрдЧреЗред</font></font><br>
<br>
<pre><code class="python hljs">rs = rs[rs[<span class="hljs-string">'vmdbva'</span>] &gt; <span class="hljs-number">1.2</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо atypical рдХрдо рдФрд░ рдЙрдЪреНрдЪ рдЧрддрд┐ рдХреЗ рд╕рд╛рде рд░рд┐рдХреЙрд░реНрдб рднреА рдирд┐рдХрд╛рд▓рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдореЗрдВ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреНрдпрд╛ рдкреНрд░рддреНрдпреЗрдХ рджреВрд░реА рдХреЗ рд▓рд┐рдП рдЯреНрд░рд╛рдЗрдерд▓реЙрди "рд╡рд┐рд╢реНрд╡ рд░рд┐рдХреЙрд░реНрдб" рдХрд░ рд░рд╣реЗ рд╣реИрдВ? </font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2019 рдХреЗ рд▓рд┐рдП рдЕрд▓рдЧ-рдЕрд▓рдЧ рджреВрд░реА рд╕реЗ рдЧреБрдЬрд░рдиреЗ рдХрд╛ рд░рд┐рдХреЙрд░реНрдб рд╕рдордп рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд┐рдпрд╛ред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдЖрдк рдЙрдиреНрд╣реЗрдВ рдордзреНрдпрдо рдЧрддрд┐ рд╕реЗ рдЧрд┐рдирддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рд╕рдмрд╕реЗ рддреЗрдЬ 33 рдХрд┐рдореА / рдШрдВрдЯрд╛ рд╕реЗ рдЕрдзрд┐рдХ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рддреЛ рд╣рдо рдЙрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВрдЧреЗ рдЬрд╣рд╛рдВ рдФрд╕рдд рдЧрддрд┐ рдЕрдзрд┐рдХ рд╣реИ, рдЕрдорд╛рдиреНрдп рд╣реИ, рдФрд░ рдЙрдиреНрд╣реЗрдВ рд╡рд┐рдЪрд╛рд░ рд╕реЗ рд╣рдЯрд╛ рджреЗрдВред</font></font><br>
<br>
<pre><code class="python hljs">rs = rs[(rs[<span class="hljs-string">'vavg'</span>] &gt; <span class="hljs-number">17</span>)&amp;(rs[<span class="hljs-string">'vmax'</span>] &lt; <span class="hljs-number">33</span>)]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣рд╛рдБ рдХреНрдпрд╛ рд░рд╣рддрд╛ рд╣реИ: </font></font><br>
<img src="https://habrastorage.org/webt/t1/dk/_p/t1dk_pixaznwxlfsunkxpx5yfum.png"><br>
<img src="https://habrastorage.org/webt/qk/9u/4a/qk9u4anxmpnwehsdhckfn64ucvw.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╕рдм рдХреБрдЫ рдХрд╛рдлреА рд╕рдЬрд╛рддреАрдп рджрд┐рдЦрддрд╛ рд╣реИ рдФрд░ рд╕рд╡рд╛рд▓ рдирд╣реАрдВ рдЙрдард╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕ рд╕рднреА рдЪрдпрди рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╣рдордиреЗ 1922 рдХреЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдореЗрдВ 777, рдпрд╛ 40% рдЦреЛ рджрд┐рдпрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕реА рд╕рдордп, рдлрд┐рдирд┐рд╢рд░реЛрдВ рдХреА рдХреБрд▓ рд╕рдВрдЦреНрдпрд╛ рдЗрддрдиреА рдХрдо рдирд╣реАрдВ рд╣реБрдИ - рдХреЗрд╡рд▓ 13% рддрдХред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕рд▓рд┐рдП, 1,231,772 рдлрд┐рдирд┐рд╢рд░реЛрдВ рдХреЗ рд╕рд╛рде 1,145 рджреМрдбрд╝ рдмрд╛рдХреА рд╣реИрдВред </font><font style="vertical-align: inherit;">рдпрд╣ рдирдореВрдирд╛ рдореЗрд░реЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдФрд░ рджреГрд╢реНрдп рдХреЗ рд▓рд┐рдП рд╕рд╛рдордЧреНрд░реА рдмрди рдЧрдпрд╛ред</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рднрд╛рдЧ 5. рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдФрд░ рджреГрд╢реНрдп</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рдХрд╛рд░реНрдп рдореЗрдВ, рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдФрд░ рд╡рд┐рдЬрд╝реБрдЕрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдЙрдЪрд┐рдд рд╕рд░рд▓рддрдо рднрд╛рдЧ рдереЗред </font><font style="vertical-align: inherit;">рд╣рд┐рдорд╢реИрд▓ рдХреА рдиреЛрдХ, рдкрд╛рдиреА рдХреЗ рдиреАрдЪреЗ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╕рд┐рд░реНрдл рдбреЗрдЯрд╛ рдХреА рддреИрдпрд╛рд░реА рдереАред </font><font style="vertical-align: inherit;">рд╡рд┐рд╢реНрд▓реЗрд╖рдг, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╛рдВрдбрд╛ рд╢реНрд░реГрдВрдЦрд▓рд╛</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрд░ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдЕрдВрдХрдЧрдгрд┐рддреАрдп рдСрдкрд░реЗрд╢рди рдерд╛, рдЬреЛ </font><font style="vertical-align: inherit;">рдФрд╕рдд, рдлрд╝рд┐рд▓реНрдЯрд░рд┐рдВрдЧ рдХреА рдЧрдгрдирд╛ рдХрд░рддрд╛ рд╣реИ - рдпрд╣ рд╕рдм рдкреНрд░рд╛рдердорд┐рдХ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╛рдВрдбрд╛</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЙрдкрдХрд░рдг рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">рдФрд░ рдЙрдкрд░реЛрдХреНрдд рдХреЛрдб рдЙрджрд╛рд╣рд░рдгреЛрдВ рд╕реЗ рднрд░рд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдмрджрд▓реЗ рдореЗрдВ, рд╡рд┐рдЬрд╝реБрдЕрд▓рд╛рдЗрдЬрд╝реЗрд╢рди, рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рд╕рдмрд╕реЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд╛рдирдХ matplotlib</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЦреЗрддреЛрдВ рдореЗрдВ рдкреНрд░рдпреБрдХреНрдд </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╛рдЬрд┐рд╢, рдмрд╛рд░, рдкрд╛рдИ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рдХреБрдЫ рд╕реНрдерд╛рдиреЛрдВ рдкрд░, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдореБрдЭреЗ рддрд╛рд░реАрдЦреЛрдВ рдФрд░ рдЪрд┐рддреНрд░рд▓реЗрдЦреЛрдВ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдХреБрд▓реНрд╣рд╛рдбрд╝рд┐рдпреЛрдВ рдХреЗ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреЗ рд╕рд╛рде рдЯрд┐рдВрдХрд░ рдХрд░рдирд╛ рдкрдбрд╝рд╛, рд▓реЗрдХрд┐рди рдпрд╣ рдРрд╕рд╛ рдХреБрдЫ рдирд╣реАрдВ рд╣реИ рдЬреЛ рдпрд╣рд╛рдВ рдПрдХ рд╡рд┐рд╕реНрддреГрдд рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП рдЖрдХрд░реНрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдХреЗрд╡рд▓ рдПрдХ рд╣реА рдмрд╛рдд рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░рдиреЗ рд▓рд╛рдпрдХ рд╣реИ рдЬрд┐рдпреЛрдбреЗрдЯрд╛ рдХреА рдкреНрд░рд╕реНрддреБрддрд┐ред </font><font style="vertical-align: inherit;">рдХрдо рд╕реЗ рдХрдо рдпрд╣ рдирд╣реАрдВ рд╣реИ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matplotlib</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">geodata</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреНрд░рддреНрдпреЗрдХ рджреМрдбрд╝ рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ рд╕реНрдерд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╣реИред </font><font style="vertical-align: inherit;">рдмрд╣реБрдд рд╢реБрд░реБрдЖрдд рдореЗрдВ, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд┐рдпреЛрдлрд╛рдИ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ </font><i><font style="vertical-align: inherit;">рд╣реБрдП,</font></i><font style="vertical-align: inherit;"> рд╣рдордиреЗ рдкреНрд░рддреНрдпреЗрдХ рд╕реНрдерд╛рди рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рдХреА рдЧрдгрдирд╛ рдХреАред </font><font style="vertical-align: inherit;">рдПрдХ рд╣реА рд╕реНрдерд╛рди рдкрд░ рдкреНрд░рддрд┐рд╡рд░реНрд╖ рдХрдИ рджреМрдбрд╝ рдЖрдпреЛрдЬрд┐рдд рдХреА рдЬрд╛рддреА рд╣реИрдВред </font><font style="vertical-align: inherit;">
рдореЗрдВ geodata рдкреНрд░рддрд┐рдкрд╛рджрди рдХреЗ рд▓рд┐рдП рдПрдХ рдмрд╣реБрдд рд╣реА рдЖрд╕рд╛рди рдЙрдкрдХрд░рдг </font><i><font style="vertical-align: inherit;">рдЕрдЬрдЧрд░</font></i><font style="vertical-align: inherit;"> рд╣реИ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><i><font style="vertical-align: inherit;">folium</font></i></a><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдВ рджреЗрдЦрд┐рдП рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ:</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th>date</th>
<th>country</th>
<th><u>latitude</u></th>
<th><u>longitude</u></th>
<th>loc</th>
<th>тАж</th>
</tr>
<tr>
<td>0</td>
<td>Ironman Indian Wells La Quinta 70.3 2019</td>
<td>2019-12-08</td>
<td>USA</td>
<td><u>33.7238</u></td>
<td><u>-116.305</u></td>
<td>Indian Wells/La Quinta, California, USA</td>
<td>тАж</td>
</tr>
<tr>
<td>1</td>
<td>Ironman Taupo 70.3 2019</td>
<td>2019-12-07</td>
<td>NZL</td>
<td><u>-41.5001</u></td>
<td><u>172.834</u></td>
<td>New Zealand</td>
<td>тАж</td>
</tr>
<tr>
<td>2</td>
<td>Ironman Western Australia 2019</td>
<td>2019-12-01</td>
<td>AUS</td>
<td><u>-33.6445</u></td>
<td><u>115.349</u></td>
<td>Busselton, Western Australia</td>
<td>тАж</td>
</tr>
<tr>
<td>3</td>
<td>Ironman Mar del Plata 2019</td>
<td>2019-12-01</td>
<td>ARG</td>
<td><u>-37.9977</u></td>
<td><u>-57.5483</u></td>
<td>Mar del Plata, Argentina</td>
<td>тАж</td>
</tr>
<tr>
<td>4</td>
<td>Ironman Cozumel 2019</td>
<td>2019-11-24</td>
<td>MEX</td>
<td><u>20.4318</u></td>
<td><u>-86.9203</u></td>
<td>Cozumel, Mexico</td>
<td>тАж</td>
</tr>
<tr>
<td>5</td>
<td>Ironman Arizona 2019</td>
<td>2019-11-24</td>
<td>USA</td>
<td><u>33.4255</u></td>
<td><u>-111.94</u></td>
<td>Tempe, Arizona, USA</td>
<td>тАж</td>
</tr>
<tr>
<td>6</td>
<td>Ironman Xiamen 70.3 2019</td>
<td>2019-11-10</td>
<td>CHN</td>
<td><u>24.4758</u></td>
<td><u>118.075</u></td>
<td>Xiamen, China</td>
<td>тАж</td>
</tr>
<tr>
<td>7</td>
<td>Ironman Turkey 70.3 2019</td>
<td>2019-11-03</td>
<td>TUR</td>
<td><u>36.8633</u></td>
<td><u>31.0578</u></td>
<td>Belek, Antalya, Turkey</td>
<td>тАж</td>
</tr>
<tr>
<td>8</td>
<td>Ironman Florida 2019</td>
<td>2019-11-02</td>
<td>USA</td>
<td><u>30.1766</u></td>
<td><u>-85.8055</u></td>
<td>Panama City Beach, Florida, USA</td>
<td>тАж</td>
</tr>
<tr>
<td>9</td>
<td>Ironman Marrakech 70.3 2019</td>
<td>2019-10-27</td>
<td>MAR</td>
<td><u>31.6258</u></td>
<td><u>-7.98916</u></td>
<td>Marrakech, Morocco</td>
<td>тАж</td>
</tr>
<tr>
<td>10</td>
<td>Ironman Waco 70.3 2019</td>
<td>2019-10-27</td>
<td>USA</td>
<td><u>31.5493</u></td>
<td><u>-97.1467</u></td>
<td>Waco, Texas, USA</td>
<td>тАж</td>
</tr>
</tbody></table></div></code><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><i><font style="vertical-align: inherit;"></font></i></a><font style="vertical-align: inherit;"></font><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> folium<font></font>
<font></font>
m = folium.Map() <font></font>
folium.Marker([<span class="hljs-string">'55.7522200'</span>, <span class="hljs-string">'37.6155600'</span>], popup=<span class="hljs-string">''</span>).add_to(m)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ рд╣рдореЗрдВ рдмреГрд╣рд╕реНрдкрддрд┐ рд▓реИрдкрдЯреЙрдк рдореЗрдВ рдПрдХ рдЗрдВрдЯрд░реЗрдХреНрдЯрд┐рд╡ рдорд╛рдирдЪрд┐рддреНрд░ рдорд┐рд▓рддрд╛ рд╣реИред </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jc/hp/fs/jchpfspvaahnnbvwtgwx2wqkppu.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм, рд╣рдорд╛рд░реЗ рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдПред </font><font style="vertical-align: inherit;">рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рдЕрдкрдиреЗ рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рдХреЗ рд╕рдВрдпреЛрдЬрди рд╕реЗ рдПрдХ рдирдпрд╛ рдХреЙрд▓рдо рд╢реБрд░реВ рдХрд░реЗрдВрдЧреЗ:</font></font><br>
<br>
<pre><code class="python hljs">rs[<span class="hljs-string">'coords'</span>] = rs[<span class="hljs-string">'latitude'</span>].astype(str) + <span class="hljs-string">', '</span> + rs[<span class="hljs-string">'longitude'</span>].astype(str)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХреА рдЕрдиреВрдареА рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coords</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 291. рд╣реИрдВ рдФрд░ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕реНрдерд▓ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">loc</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 324, рдЬрд┐рд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдХреБрдЫ рдирд╛рдо рдереЛрдбрд╝рд╛ рднрд┐рдиреНрди рд╣реЛрддреЗ рд╣реИрдВ, рдЬрдмрдХрд┐ рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рд╡реЗ рдПрдХ рд╣реА рдмрд┐рдВрджреБ рдХреЗ рдЕрдиреБрд░реВрдк рд╣реИрдВред </font><font style="vertical-align: inherit;">рдпрд╣ рдбрд░рд╛рд╡рдирд╛ рдирд╣реАрдВ рд╣реИ, рд╣рдо </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдордиреНрд╡рдпрдХреЛрдВ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджреНрд╡рд╛рд░рд╛ рд╡рд┐рд╢рд┐рд╖реНрдЯрддрд╛ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВрдЧреЗ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рд╣рдо рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рд╕реНрдерд╛рди рдореЗрдВ (рдЕрджреНрд╡рд┐рддреАрдп рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рдХреЗ рд╕рд╛рде) рдкреВрд░реЗ рд╕рдордп рдореЗрдВ рдХрд┐рддрдиреЗ рдЖрдпреЛрдЬрди рд╣реБрдП рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="python hljs">vc = rs[<span class="hljs-string">'coords'</span>].value_counts()<font></font>
<font></font>
vc</code></pre><br>
<code><b>Out:</b><br>
43.7009358, 7.2683912 22<br>
43.5854823, 39.723109 20<br>
29.03970805, -13.636291 16<br>
47.3723941, 8.5423328 16<br>
59.3110918, 24.420907 15<br>
51.0834196, 10.4234469 15<br>
54.7585694, 38.8818137 14<br>
20.4317585, -86.9202745 13<br>
52.3727598, 4.8936041 12<br>
41.6132925, 2.6576102 12<br>
... ...<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рдПрдХ рдирдХреНрд╢рд╛ рдмрдирд╛рдПрдВ, рдФрд░ рд╕рд░реНрдХрд┐рд▓ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрд╕ рдкрд░ рдорд╛рд░реНрдХрд░ рдЬреЛрдбрд╝реЗрдВ, рдЬрд┐рд╕рдХрд╛ рддреНрд░рд┐рдЬреНрдпрд╛ рд╕реНрдерд╛рди рдкрд░ рдЖрдпреЛрдЬрд┐рдд рдШрдЯрдирд╛рдУрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░реЗрдЧрд╛ред </font><font style="vertical-align: inherit;">рдорд╛рд░реНрдХрд░реЛрдВ рдХреЗ рд╕реНрдерд╛рди рдХреЗ рдирд╛рдо рдХреЗ рд╕рд╛рде рдорд╛рд░реНрдХрд░ рдЬреЛрдбрд╝реЗрдВред</font></font><br>
<br>
<pre><code class="python hljs">m = folium.Map(location=[<span class="hljs-number">25</span>,<span class="hljs-number">10</span>], zoom_start=<span class="hljs-number">2</span>)<font></font>
<font></font>
<span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> rs[<span class="hljs-string">'coords'</span>].unique():<font></font>
    row = [r[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> rs.iterrows() <span class="hljs-keyword">if</span> r[<span class="hljs-number">1</span>][<span class="hljs-string">'coords'</span>] == c][<span class="hljs-number">0</span>]    <font></font>
    folium.Circle([row[<span class="hljs-string">'latitude'</span>], row[<span class="hljs-string">'longitude'</span>]], <font></font>
					popup=(row[<span class="hljs-string">'location'</span>]+<span class="hljs-string">'\n('</span>+str(vc[c])+<span class="hljs-string">' races)'</span>), <font></font>
					radius = <span class="hljs-number">10000</span>*int(vc[c]), <font></font>
					color=<span class="hljs-string">'darkorange'</span>, <font></font>
					fill=<span class="hljs-literal">True</span>, <font></font>
					stroke=<span class="hljs-literal">True</span>, <font></font>
					weight=<span class="hljs-number">1</span>).add_to(m)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХрд┐рдпрд╛ рд╣реБрдЖред </font><font style="vertical-align: inherit;">рдЖрдк рдкрд░рд┐рдгрд╛рдо рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ch/d4/gj/chd4gj0qbyjrzyjikpmslgesw0i.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рддрд┐рднрд╛рдЧрд┐рдпреЛрдВ рдХреА рдкреНрд░рдЧрддрд┐</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдорд╛рд░реНрдЧрджрд░реНрд╢рдХ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдПрдХ рдФрд░ рдЕрдиреБрд╕реВрдЪреА рдкрд░ рдХрд╛рдо рднреА рдЧреИрд░-рддреБрдЪреНрдЫ рдерд╛ред рдпрд╣ рдкреНрд░рддрд┐рднрд╛рдЧрд┐рдпреЛрдВ рдХрд╛ рдирд╡реАрдирддрдо рдкреНрд░рдЧрддрд┐ рдЧреНрд░рд╛рдл рд╣реИред рдпрд╣рд╛рдБ рдпрд╣ рд╣реИ: </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/rf/ca/jq/rfcajquw4qluhsw9wuhicbgk7rm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЪрд▓реЛ рдЗрд╕рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рддреЗ рд╣реИрдВ, рдЙрд╕реА рд╕рдордп рдореИрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореИрдЯрд▓рдкреЛрдЯрд▓рд┐рдм</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ, рдкреНрд░рддрд┐рдкрд╛рджрди рдХреЗ рд▓рд┐рдП рдХреЛрдб рджреВрдВрдЧрд╛ </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="python hljs">fig = plt.figure()<font></font>
fig.set_size_inches(<span class="hljs-number">10</span>, <span class="hljs-number">6</span>)<font></font>
<font></font>
ax = fig.add_axes([<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>])<font></font>
<font></font>
b = ax.bar(exp,numrecs, color = <span class="hljs-string">'navajowhite'</span>)<font></font>
<font></font>
ax1 = ax.twinx()<font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(exp_samp)):<font></font>
    ax1.plot(exp_samp[i], vproc_samp[i], <span class="hljs-string">'.'</span>)<font></font>
	<font></font>
p, = ax1.plot(exp, vpm, <span class="hljs-string">'o-'</span>,markersize=<span class="hljs-number">8</span>, linewidth=<span class="hljs-number">2</span>, color=<span class="hljs-string">'C0'</span>)<font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(exp)):
    <span class="hljs-keyword">if</span> i &lt; len(exp)<span class="hljs-number">-1</span> <span class="hljs-keyword">and</span> (vpm[i] &lt; vpm[i+<span class="hljs-number">1</span>]):<font></font>
        ax1.text(x = exp[i]+<span class="hljs-number">0.1</span>, y = vpm[i]<span class="hljs-number">-0.2</span>, s = <span class="hljs-string">'{0:3.1f}%'</span>.format(vpm[i]),size=<span class="hljs-number">12</span>)
    <span class="hljs-keyword">else</span>:<font></font>
        ax1.text(x = exp[i]+<span class="hljs-number">0.1</span>, y = vpm[i]+<span class="hljs-number">0.1</span>, s = <span class="hljs-string">'{0:3.1f}%'</span>.format(vpm[i]),size=<span class="hljs-number">12</span>)<font></font>
<font></font>
ax.legend((b,p), (<span class="hljs-string">' '</span>, <span class="hljs-string">''</span>),loc=<span class="hljs-string">'center right'</span>)<font></font>
ax.set_xlabel(<span class="hljs-string">'   '</span>)<font></font>
ax.set_ylabel(<span class="hljs-string">''</span>)<font></font>
ax1.set_ylabel(<span class="hljs-string">'%     '</span>)<font></font>
ax.set_xticks(np.arange(<span class="hljs-number">1</span>, <span class="hljs-number">11</span>, step=<span class="hljs-number">1</span>))<font></font>
ax.set_yticks(np.arange(<span class="hljs-number">0</span>, <span class="hljs-number">230000</span>, step=<span class="hljs-number">25000</span>))<font></font>
ax1.set_ylim(<span class="hljs-number">97.5</span>,<span class="hljs-number">103.5</span>)<font></font>
ax.yaxis.set_label_position(<span class="hljs-string">"right"</span>)<font></font>
ax.yaxis.tick_right()<font></font>
ax1.yaxis.set_label_position(<span class="hljs-string">"left"</span>)<font></font>
ax1.yaxis.tick_left()      <font></font>
<font></font>
plt.show()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рдЙрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдбреЗрдЯрд╛ рдХреА рдЧрдгрдирд╛ рдХреИрд╕реЗ рдХреА рдЧрдИред </font><font style="vertical-align: inherit;">рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЖрдкрдХреЛ рдЙрди рдкреНрд░рддрд┐рднрд╛рдЧрд┐рдпреЛрдВ рдХреЗ рдирд╛рдо рдЪреБрдирдирд╛ рдерд╛ рдЬреЛ рдХрдо рд╕реЗ рдХрдо рджреЛ рджреМрдбрд╝ рдореЗрдВ рдФрд░ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдХреИрд▓реЗрдВрдбрд░ рд╡рд░реНрд╖реЛрдВ рдореЗрдВ рд╕рдорд╛рдкреНрдд рд╣реБрдП, рдФрд░ рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рдкреЗрд╢реЗрд╡рд░ рдирд╣реАрдВ рд╣реИрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд▓рд┐рдП, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддрд┐рдерд┐</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдирд╛рдордХ рдПрдХ рдирдпрд╛ рдХреЙрд▓рдо рднрд░реЗрдВ </font><font style="vertical-align: inherit;">, рдЬреЛ рджреМрдбрд╝ рдХреА рддрд╛рд░реАрдЦ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░реЗрдЧрд╛ред </font><font style="vertical-align: inherit;">рд╣рдореЗрдВ рдЗрд╕ рддрд┐рдерд┐ рд╕реЗ рдПрдХ рд╡рд░реНрд╖ рдХреА рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА, рд╣рдо рдХреЙрд▓рдо </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд░реНрд╖</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдмрдирд╛рдПрдВрдЧреЗ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЪреВрдВрдХрд┐ рд╣рдо рджреМрдбрд╝ рдореЗрдВ рдФрд╕рдд рдЧрддрд┐ рдХреЗ рд╕рд╛рдкреЗрдХреНрд╖ рдкреНрд░рддреНрдпреЗрдХ рдПрдерд▓реАрдЯ рдХреА рдЧрддрд┐ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ, рд╣рдо рддреБрд░рдВрдд рдирдП рдХреЙрд▓рдо </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vproc</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рдЗрд╕ рдЧрддрд┐ рдХреА рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">- рдФрд╕рдд рдХреЗ рдкреНрд░рддрд┐рд╢рдд рдХреЗ рд░реВрдк рдореЗрдВ рдЧрддрд┐ред</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> index, row <span class="hljs-keyword">in</span> rs.iterrows():<font></font>
    e = row[<span class="hljs-string">'event'</span>]<font></font>
    rd[e][<span class="hljs-string">'date'</span>] = row[<span class="hljs-string">'date'</span>]<font></font>
    rd[e][<span class="hljs-string">'year'</span>] = row[<span class="hljs-string">'year'</span>]<font></font>
    rd[e][<span class="hljs-string">'vproc'</span>] = <span class="hljs-number">100</span> * rd[e][<span class="hljs-string">'v'</span>] / rd[e][<span class="hljs-string">'v'</span>].mean()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣рд╛рдБ рдЕрдм рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреНрдпрд╛ рджрд┐рдЦрддреЗ рд╣реИрдВ: </font><font style="vertical-align: inherit;">
рдЕрдЧрд▓рд╛, рд╕рднреА рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рдПрдХ рдПрдХрд▓ рдбреЗрдЯрд╛ рдлреНрд░реЗрдо рдореЗрдВ рд╕рдВрдпреЛрдЬрд┐рдд рдХрд░реЗрдВред</font></font><br>
<code>'   Sprint 2019'</code><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>...</th>
<th>th</th>
<th>v</th>
<th><u>date</u></th>
<th><u>year</u></th>
<th><u>vproc</u></th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td>Shalev Aleksey</td>
<td>RUS</td>
<td>...</td>
<td>1.161944</td>
<td>22.161128</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>130.666668</u></td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td>Nikolaev Artem</td>
<td>RUS</td>
<td>...</td>
<td>1.228611</td>
<td>20.958625</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>123.576458</u></td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td>Kuchierskiy Aleksandr</td>
<td>RUS</td>
<td>...</td>
<td>1.255556</td>
<td>20.508850</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>120.924485</u></td>
</tr>
<tr>
<td>3</td>
<td>4</td>
<td>F</td>
<td>Korchagina Mariya</td>
<td>RUS</td>
<td>...</td>
<td>1.297222</td>
<td>19.850107</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>117.040401</u></td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>M</td>
<td>Solodov Ivan</td>
<td>RUS</td>
<td>...</td>
<td>1.298056</td>
<td>19.837364</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>116.965263</u></td>
</tr>
<tr>
<td>5</td>
<td>6</td>
<td>M</td>
<td>Bukin Sergey</td>
<td>RUS</td>
<td>...</td>
<td>1.300278</td>
<td>19.803461</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>116.765365</u></td>
</tr>
<tr>
<td>6</td>
<td>7</td>
<td>M</td>
<td>Lavrentev Dmitriy</td>
<td>RUS</td>
<td>...</td>
<td>1.300278</td>
<td>19.803461</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>116.765365</u></td>
</tr>
<tr>
<td>7</td>
<td>8</td>
<td>M</td>
<td>Dolgov Petr</td>
<td>RUS</td>
<td>...</td>
<td>1.321667</td>
<td>19.482976</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>114.875719</u></td>
</tr>
<tr>
<td>8</td>
<td>9</td>
<td>M</td>
<td>Bezruchenko Mikhailn</td>
<td>RUS</td>
<td>...</td>
<td>1.345000</td>
<td>19.144981</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>112.882832</u></td>
</tr>
<tr>
<td>9</td>
<td>10</td>
<td>M</td>
<td>Ryazantsev Dmitriy</td>
<td>RUS</td>
<td>...</td>
<td>1.359444</td>
<td>18.941561</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>111.683423</u></td>
</tr>
<tr>
<td>10</td>
<td>11</td>
<td>M</td>
<td>Ibragimov Ramil</td>
<td>RUS</td>
<td>...</td>
<td>1.376389</td>
<td>18.708375</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>110.308511</u></td>
</tr>
</tbody></table></div></code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar = pd.concat(rd)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рддрд┐рднрд╛рдЧреА рдХреЗ рд▓рд┐рдП, рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рдХреИрд▓реЗрдВрдбрд░ рд╡рд░реНрд╖ рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдЫреЛрдбрд╝реЗрдВрдЧреЗ:</font></font><br>
<br>
<pre><code class="python hljs">ar1 = ar.drop_duplicates(subset = [<span class="hljs-string">'name'</span>,<span class="hljs-string">'year'</span>], keep=<span class="hljs-string">'first'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдЧреЗ, рдЗрди рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЗ рд╕рднреА рдЕрдиреВрдареЗ рдирд╛рдореЛрдВ рд╕реЗ, рд╣рдо рдкрд╛рддреЗ рд╣реИрдВ рдХрд┐ рдХрдо рд╕реЗ рдХрдо рджреЛ рдмрд╛рд░ рд╣реЛрддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="python hljs">nvc = ar1[<span class="hljs-string">'name'</span>].value_counts()<font></font>
names = list(nvc[nvc &gt; <span class="hljs-number">1</span>].index)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЙрдирдореЗрдВ рд╕реЗ 219,890 рд╣реИрдВред рдЖрдЗрдП рдЗрд╕ рд╕реВрдЪреА рд╕реЗ рдкреНрд░реЛ-рдПрдерд▓реАрдЯреЛрдВ рдХреЗ рдирд╛рдо рд╣рдЯрд╛рдПрдВ:</font></font><br>
<br>
<pre><code class="python hljs">pro_names = ar[ar[<span class="hljs-string">'group'</span>].isin([<span class="hljs-string">'MPRO'</span>,<span class="hljs-string">'FPRO'</span>])][<span class="hljs-string">'name'</span>].unique()<font></font>
names = list(set(names) - set(pro_names))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рд╛рде рд╣реА 2010 рд╕реЗ рдкрд╣рд▓реЗ рдкреНрд░рджрд░реНрд╢рди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдПрдерд▓реАрдЯреЛрдВ рдХреЗ рдирд╛рдоред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдкрд┐рдЫрд▓реЗ 10 рд╡рд░реНрд╖реЛрдВ рдореЗрдВ рдирдореВрдирд╛ рдХрд┐рдП рдЬрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЬреЛ рдбреЗрдЯрд╛ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛ рдерд╛, рдЙрд╕реЗ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВред </font><font style="vertical-align: inherit;">рдЙрдиреНрд╣реЗрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rsa</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (рджреМрдбрд╝ рд╕рд╛рд░рд╛рдВрд╢ рд╕рднреА) рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rda</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (рджреМрдбрд╝ рд╡рд┐рд╡рд░рдг рд╕рднреА) </font><font style="vertical-align: inherit;">рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдореЗрдВ рд░рдЦреЗрдВ </font><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<pre><code class="python hljs">rdo = {} <font></font>
<font></font>
<span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> rda:    
    <span class="hljs-keyword">if</span> rsa[rsa[<span class="hljs-string">'event'</span>] == e][<span class="hljs-string">'year'</span>].iloc[<span class="hljs-number">0</span>] &lt; <span class="hljs-number">2010</span>:<font></font>
        rdo[e] = rda[e]<font></font>
<font></font>
aro = pd.concat(rdo)<font></font>
old_names = aro[<span class="hljs-string">'name'</span>].unique()<font></font>
names = list(set(names) - set(old_names))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ рдЕрдВрдд рдореЗрдВ, рд╣рдо рдРрд╕реЗ рдирд╛рдо рдкрд╛рддреЗ рд╣реИрдВ рдЬреЛ рдПрдХ рд╣реА рджрд┐рди рдореЗрдВ рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рдмрд╛рд░ рд╣реЛрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╣рдо рдЕрдкрдиреЗ рдирдореВрдиреЗ рдореЗрдВ рдкреВрд░реНрдг рдирд╛рдореЛрдВ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреЛ рдХрдо рдХрд░рддреЗ рд╣реИрдВред</font></font><br>
<br>
<pre><code class="python hljs">namesakes = ar[ar.duplicated(subset = [<span class="hljs-string">'name'</span>,<span class="hljs-string">'date'</span>], keep = <span class="hljs-literal">False</span>)][<span class="hljs-string">'name'</span>].unique()<font></font>
names = list(set(names) - set(namesakes))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕рд▓рд┐рдП 198,075 рдирд╛рдо рдмрд╛рдХреА рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╕рдВрдкреВрд░реНрдг рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ, рд╣рдо рдХреЗрд╡рд▓ рдкрд╛рдП рдЧрдП рдирд╛рдореЛрдВ рдХреЗ рд╕рд╛рде рд░рд┐рдХреЙрд░реНрдб рдХрд╛ рдЪрдпрди рдХрд░рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="python hljs">ars = ar[ar[<span class="hljs-string">'name'</span>].isin(names)] <span class="hljs-comment">#ars тАУ all recrds selected</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм, рдкреНрд░рддреНрдпреЗрдХ рд░рд┐рдХреЙрд░реНрдб рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдПрдерд▓реАрдЯ рдХреЗ рдХрд░рд┐рдпрд░ рдореЗрдВ рдпрд╣ рдХрд┐рд╕ рд╡рд░реНрд╖ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ - рдкрд╣рд▓рд╛, рджреВрд╕рд░рд╛, рддреАрд╕рд░рд╛ рдпрд╛ рджрд╕рд╡рд╛рдВред </font><font style="vertical-align: inherit;">рд╣рдо рд╕рднреА рдирд╛рдореЛрдВ рд╕реЗ рдПрдХ рд▓реВрдк рдмрдирд╛рддреЗ рд╣реИрдВ рдФрд░ рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВред</font></font><br>
<br>
<pre><code class="python hljs">ars[<span class="hljs-string">'exp'</span>] = <span class="hljs-string">''</span> <span class="hljs-comment">#exp тАУ experience, counted in years of racing, starts from 1.</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> names:    <font></font>
    ind = ars[ars[<span class="hljs-string">'name'</span>] == n].index <font></font>
    yos = ars.loc[ind, <span class="hljs-string">'year'</span>].min() <span class="hljs-comment">#yos тАУ year of start</span>
    ars.loc[ind, <span class="hljs-string">'exp'</span>] = ars.loc[ind, <span class="hljs-string">'year'</span>] - yos + <span class="hljs-number">1</span> 
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣рд╛рдБ рдХреНрдпрд╛ рд╣реБрдЖ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ: </font><font style="vertical-align: inherit;">
рдЬрд╛рд╣рд┐рд░ рд╣реИ, рдирд╛рдо рдЕрднреА рднреА рдмрдиреЗ рд░рд╣реЗред </font><font style="vertical-align: inherit;">рдпрд╣ рдЕрдкреЗрдХреНрд╖рд┐рдд рд╣реИ, рд▓реЗрдХрд┐рди рдбрд░рд╛рд╡рдирд╛ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдо рд╕рдм рдХреБрдЫ рдФрд╕рдд рдХрд░реЗрдВрдЧреЗ, рдФрд░ рдЗрддрдиреЗ рд╕рд╛рд░реЗ рдирд╣реАрдВ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рдЕрдЧрд▓рд╛, рд╣рдо рдЧреНрд░рд╛рдлрд╝ рдХреЗ рд▓рд┐рдП рд╕рд░рдгрд┐рдпрд╛рдБ рдмрдирд╛рддреЗ рд╣реИрдВ:</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>тАж</th>
<th>th</th>
<th>v</th>
<th>date</th>
<th><u>year</u></th>
<th>vproc</th>
<th><u>exp</u></th>
</tr>
<tr>
<td>тАж</td>
<td>633</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>RUS</td>
<td>M40-44</td>
<td>тАж</td>
<td>5.356111</td>
<td>21.097397</td>
<td>2014-08-31</td>
<td><u>2014</u></td>
<td>106.036879</td>
<td><u>1</u></td>
</tr>
<tr>
<td>тАж</td>
<td>302</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>RUS</td>
<td>M40-44</td>
<td>тАж</td>
<td>11.236389</td>
<td>20.113223</td>
<td>2015-08-30</td>
<td><u>2015</u></td>
<td>108.231254</td>
<td><u>2</u></td>
</tr>
<tr>
<td>тАж</td>
<td>522</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>RUS</td>
<td>M40-44</td>
<td>тАж</td>
<td>10.402778</td>
<td>21.724967</td>
<td>2016-07-17</td>
<td><u>2016</u></td>
<td>111.265107</td>
<td><u>3</u></td>
</tr>
<tr>
<td>тАж</td>
<td>25</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>RUS</td>
<td>M40-44</td>
<td>тАж</td>
<td>10.910833</td>
<td>20.713358</td>
<td>2017-09-23</td>
<td><u>2017</u></td>
<td>112.953644</td>
<td><u>4</u></td>
</tr>
<tr>
<td>тАж</td>
<td>23</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>RUS</td>
<td>M40-44</td>
<td>тАж</td>
<td>4.700000</td>
<td>24.042553</td>
<td>2017-06-03</td>
<td><u>2017</u></td>
<td>120.565211</td>
<td><u>4</u></td>
</tr>
<tr>
<td>тАж</td>
<td>42</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>RUS</td>
<td>M40-44</td>
<td>тАж</td>
<td>4.599167</td>
<td>24.569668</td>
<td>2018-06-17</td>
<td><u>2018</u></td>
<td>124.579862</td>
<td><u>5</u></td>
</tr>
<tr>
<td>тАж</td>
<td>90</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>NOR</td>
<td></td>
<td>тАж</td>
<td>14.069167</td>
<td>16.063496</td>
<td>2018-08-04</td>
<td><u>2018</u></td>
<td>100.001834</td>
<td><u>5</u></td>
</tr>
<tr>
<td>тАж</td>
<td>86</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>RUS</td>
<td>M45-49</td>
<td>тАж</td>
<td>9.820556</td>
<td>23.012955</td>
<td>2019-08-03</td>
<td><u>2019</u></td>
<td>118.375766</td>
<td><u>6</u></td>
</tr>
</tbody></table></div></code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">exp = [] <font></font>
vpm = [] <span class="hljs-comment">#vpm тАУ v proc mean</span>
numrecs = [] <span class="hljs-comment">#number of records</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(ars[<span class="hljs-string">'exp'</span>].min(), ars[<span class="hljs-string">'exp'</span>].max() + <span class="hljs-number">1</span>): <font></font>
    exp.append(x)<font></font>
    vpm.append(ars[ars[<span class="hljs-string">'exp'</span>] == x][<span class="hljs-string">'vproc'</span>].mean())<font></font>
    numrecs.append(len(ars[ars[<span class="hljs-string">'exp'</span>] == x]))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣реА рд╣реИ, рдЗрд╕рдХрд╛ рдПрдХ рдЖрдзрд╛рд░ рд╣реИ: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/c4/_p/u6/c4_pu61ixkiscputxq1qhfm84eg.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм, рдЗрд╕реЗ рдЙрди рдмрд┐рдВрджреБрдУрдВ рдХреЗ рд╕рд╛рде рд╕рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЬреЛ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЗ рдЕрдиреБрд░реВрдк рд╣реИрдВ, рд╣рдо 1000 рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдирд╛рдо рдЪреБрдиреЗрдВрдЧреЗ рдФрд░ рдЙрдирдХреЗ рд▓рд┐рдП рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЗ рд╕рд╛рде рд╕рд░рдгрд┐рдпреЛрдВ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░реЗрдВрдЧреЗред</font></font><br>
<br>
<pre><code class="python hljs">names_samp = random.sample(names,<span class="hljs-number">1000</span>)<font></font>
ars_samp = ars[ars[<span class="hljs-string">'name'</span>].isin(names_samp)]<font></font>
<font></font>
ars_samp = ars_samp.reset_index(drop = <span class="hljs-literal">True</span>)<font></font>
exp_samp = []<font></font>
vproc_samp = []<font></font>
<font></font>
<span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> names_samp:<font></font>
    nr = ars_samp[ars_samp[<span class="hljs-string">'name'</span>] == n]<font></font>
    nr = nr.sort_values(<span class="hljs-string">'exp'</span>)<font></font>
    exp_samp.append(list(nr[<span class="hljs-string">'exp'</span>]))<font></font>
    vproc_samp.append(list(nr[<span class="hljs-string">'vproc'</span>]))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдирдореВрдиреЗ рд╕реЗ рд░реЗрдЦрд╛рдВрдХрди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд▓реВрдк рдЬреЛрдбрд╝реЗрдВред</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(exp_samp)):<font></font>
    ax1.plot(exp_samp[i], vproc_samp[i], <span class="hljs-string">'.'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╕рдм рдХреБрдЫ рддреИрдпрд╛рд░ рд╣реИ: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uj/0h/ee/uj0hee9v0tujesawdjz41fmfp0u.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рдпрд╣ рдореБрд╢реНрдХрд┐рд▓ рдирд╣реАрдВ рд╣реИред рд▓реЗрдХрд┐рди рдПрдХ рд╕рдорд╕реНрдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдПрдХ рдЪрдХреНрд░ рдореЗрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХреНрд╕рдк</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрдиреБрднрд╡ рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП </font><font style="vertical-align: inherit;">, рд╕рднреА рдирд╛рдо, рдЬреЛ рд▓рдЧрднрдЧ 200 рд╣рдЬрд╛рд░ рд╣реИрдВ, рдЖрда рдШрдВрдЯреЗ рд▓рдЧрддреЗ рд╣реИрдВред рдореБрдЭреЗ рдЫреЛрдЯреЗ рдирдореВрдиреЛрдВ рдкрд░ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЛ рдбреАрдмрдЧ рдХрд░рдирд╛ рдкрдбрд╝рд╛, рдФрд░ рдлрд┐рд░ рд░рд╛рдд рдХреЗ рд▓рд┐рдП рдЧрдгрдирд╛ рдЪрд▓рд╛рдПрдВред рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ, рдпрд╣ рдПрдХ рдмрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдкреНрд░рдХрд╛рд░ рдХреА рддреНрд░реБрдЯрд┐ рдкрд╛рддреЗ рд╣реИрдВ рдпрд╛ рдХреБрдЫ рдмрджрд▓рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдФрд░ рдЖрдкрдХреЛ рдЗрд╕реЗ рдлрд┐рд░ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рддрдирд╛рд╡ рд╢реБрд░реВ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рдФрд░ рдЗрд╕рд▓рд┐рдП, рдЬрдм рдореИрдВ рд╢рд╛рдо рдХреЛ рдПрдХ рд░рд┐рдкреЛрд░реНрдЯ рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд░рдиреЗ рдЬрд╛ рд░рд╣рд╛ рдерд╛, рддреЛ рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рдХрд┐ рдлрд┐рд░ рд╕реЗ рд╕рдм рдХреБрдЫ рдлрд┐рд░ рд╕реЗ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рдерд╛ред рд╕реБрдмрд╣ рддрдХ рдЗрдВрддрдЬрд╛рд░ рдХрд░рдирд╛ рдореЗрд░реА рдпреЛрдЬрдирд╛рдУрдВ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдирд╣реАрдВ рдерд╛, рдФрд░ рдореИрдВ рдЧрдгрдирд╛ рдХреЛ рддреЗрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд░рд╛рд╕реНрддрд╛ рддрд▓рд╛рд╢рдиреЗ рд▓рдЧрд╛ред рд╕рдорд╛рдирд╛рдВрддрд░ рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛ рдЧрдпрд╛ред </font><i><font style="vertical-align: inherit;">рдорд▓реНрдЯреАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рд╕рд╛рде рдРрд╕рд╛ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдорд┐рд▓рд╛</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рд╡рд┐рдВрдбреЛрдЬ рдкрд░ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдПрдХ рдЕрд▓рдЧ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рд╕рдорд╛рдирд╛рдВрддрд░ рдХрд╛рд░реНрдп рдХрд╛ рдореБрдЦреНрдп рддрд░реНрдХ рдбрд╛рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">workers.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдлрд╝рд╛рдЗрд▓:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> pickle <span class="hljs-keyword">as</span> pkl<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">worker</span>(<span class="hljs-params">args</span>):</span>
    names = args[<span class="hljs-number">0</span>]<font></font>
    ars=args[<span class="hljs-number">1</span>]<font></font>
    num=args[<span class="hljs-number">2</span>]<font></font>
    ars = ars.sort_values(by=<span class="hljs-string">'name'</span>)<font></font>
    ars = ars.reset_index(drop=<span class="hljs-literal">True</span>)  <font></font>
<font></font>
    <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> names:   <font></font>
        ind = ars[ars[<span class="hljs-string">'name'</span>] == n].index <font></font>
        yos = ars.loc[ind, <span class="hljs-string">'year'</span>].min()<font></font>
        ars.loc[ind, <span class="hljs-string">'exp'</span>] = ars.loc[ind, <span class="hljs-string">'year'</span>] - yos + <span class="hljs-number">1</span>                      <font></font>
<font></font>
    <span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\par\prog'</span> + str(num) + <span class="hljs-string">'.pkl'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:<font></font>
        pkl.dump(ars,f)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдирд╛рдо рдХреЗ рдПрдХ рд╣рд┐рд╕реНрд╕реЗ рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░ рд░рд╣рд╛ рд╣реИ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЗ рдирд╛рдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рднрд╛рдЧ datafreyma </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧрд┐рд░рдлреНрддрд╛рд░реА</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЗрд╡рд▓ рдЗрди рдирд╛рдореЛрдВ рдХреЗ рд╕рд╛рде, рдФрд░ рд╕рдорд╛рдирд╛рдВрддрд░ рдХрд╛рд░реНрдпреЛрдВ рдХреА рдХреНрд░рдо рд╕рдВрдЦреНрдпрд╛ - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдВрдЦреНрдпрд╛</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рдХрдореНрдкреНрдпреВрдЯреЗрд╢рди рдХреЛ рдбреЗрдЯрд╛ рдлрд╝реНрд░реЗрдо рдореЗрдВ рд▓рд┐рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░, рдЖрдЦрд╝рд┐рд░рдХрд╛рд░, рдбреЗрдЯрд╛ рдлрд╝реНрд░реЗрдо рдХреЛ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд▓рд┐рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд╛рд░реНрдпрдХрд░реНрддрд╛ рдХреЛ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЙрд▓ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд▓реИрдкрдЯреЙрдк рдореЗрдВ </font><font style="vertical-align: inherit;">, рд╣рдо рддрджрдиреБрд╕рд╛рд░ рддрд░реНрдХ рддреИрдпрд╛рд░ рдХрд░рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="python hljs">num_proc = <span class="hljs-number">8</span> <span class="hljs-comment">#number of processors</span><font></font>
args = []<font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(num_proc):<font></font>
    step = int(len(names_samp)/num_proc) + <span class="hljs-number">1</span>
    names_i = names_samp[i*step:min((i+<span class="hljs-number">1</span>)*step, len(names_samp))]<font></font>
    ars_i = ars[ars[<span class="hljs-string">'name'</span>].isin(names_i)]<font></font>
    args.append([names_i, ars_i, i])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рд╕рдорд╛рдирд╛рдВрддрд░ рдХрдВрдкреНрдпреВрдЯрд┐рдВрдЧ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> Pool
<span class="hljs-keyword">import</span> workers<font></font>
<font></font>
<span class="hljs-keyword">if</span> __name__ ==  <span class="hljs-string">'__main__'</span>:     <font></font>
    p=Pool(processes = num_proc)<font></font>
    p.map(workers.worker,args)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ рдЕрдВрдд рдореЗрдВ рд╣рдо рдлрд╛рдЗрд▓реЛрдВ рд╕реЗ рдкрд░рд┐рдгрд╛рдо рдкрдврд╝рддреЗ рд╣реИрдВ рдФрд░ рдкреВрд░реЗ рдбреЗрдЯрд╛ рдлреНрд░реЗрдо рдореЗрдВ рд╡рд╛рдкрд╕ рдЯреБрдХрдбрд╝реЗ рдЗрдХрдЯреНрдард╛ рдХрд░рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="python hljs">ars=pd.DataFrame(columns = ars.columns)<font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(num_proc):
    <span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\par\prog'</span>+str(i)+<span class="hljs-string">'.pkl'</span>, <span class="hljs-string">'rb'</span>) <span class="hljs-keyword">as</span> f:    <font></font>
        arsi = pkl.load(f)<font></font>
        print(len(arsi))<font></font>
        ars = pd.concat([ars, arsi])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рдкреНрд░рдХрд╛рд░, 40 рдорд┐рдирдЯ рдХрд╛ рддреНрд╡рд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рдерд╛, рдФрд░ 11 рдорд┐рдирдЯ рдореЗрдВ рдЧрдгрдирд╛ рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 8 рдШрдВрдЯреЗ рдХреЗ рдмрдЬрд╛рдп рдФрд░ рдЙрд╕ рд╢рд╛рдо рдПрдХ рд░рд┐рдкреЛрд░реНрдЯ рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд░рдирд╛ред рдЙрд╕реА рд╕рдордп рдореИрдВрдиреЗ рд╕реАрдЦрд╛ рдХрд┐ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдЬрдЧрд░</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рдХреИрд╕реЗ рд╕рдорд╛рдирд╛рдВрддрд░ рдХрд┐рдпрд╛ рдЬрд╛рдП </font><font style="vertical-align: inherit;">, рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдХрд╛рдо рдЖрдПрдЧрд╛ред рдпрд╣рд╛рдВ, рддреНрд╡рд░рдг рдХреЗрд╡рд▓ рдХреЛрд░ рдХреЗ 8 рдЧреБрдирд╛ рд╕реЗ рдЕрдзрд┐рдХ рд╣реЛрдиреЗ рдХреЗ рдХрд╛рд░рдг рдирд┐рдХрд▓рд╛, рдЗрд╕ рддрдереНрдп рдХреЗ рдХрд╛рд░рдг рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдХрд╛рд░реНрдп рдиреЗ рдПрдХ рдЫреЛрдЯреЗ рдбреЗрдЯрд╛ рдлрд╝реНрд░реЗрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛, рдЬреЛ рддреЗрдЬреА рд╕реЗ рдЦреЛрдЬ рдХрд░рддрд╛ рд╣реИред рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ, рдЕрдиреБрдХреНрд░рдорд┐рдХ рдЧрдгрдирд╛ рдЗрд╕ рддрд░рд╣ рд╕реЗ рддреЗрдЬ рд╣реЛ рд╕рдХрддреА рд╣реИ, рд▓реЗрдХрд┐рди рд╕рд╡рд╛рд▓ рдпрд╣ рд╣реИ рдХрд┐ рдЖрдк рдХреИрд╕реЗ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рддреЗ рд╣реИрдВ? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рд╛рд▓рд╛рдБрдХрд┐, рдореИрдВ рд╢рд╛рдВрдд рдирд╣реАрдВ рд╣реЛ рд╕рдХрд╛ рдФрд░ рдкреНрд░рдХрд╛рд╢рди рдХреЗ рдмрд╛рдж рднреА рдореИрдВ рд▓рдЧрд╛рддрд╛рд░ рдЗрд╕ рдмрд╛рдд рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░ рд░рд╣рд╛ рдерд╛ рдХрд┐ рд╡реИрд╢реНрд╡реАрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рдЧрдгрдирд╛ рдХреИрд╕реЗ рдХреА рдЬрд╛рдП, рдпрд╛рдиреА </font><i><font style="vertical-align: inherit;">рдкрд╛рдВрдбрд╛ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдбреЗрдЯрд╛</font></i><font style="vertical-align: inherit;"> рдлреНрд░реЗрдо рдХреЗ рдкреВрд░реЗ рд╕реНрддрдВрднреЛрдВ рдкрд░ рд╕рдВрдЪрд╛рд▓рдиред</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕ рддрд░рд╣ рдХреА рдЧрдгрдирд╛ рдХрд┐рд╕реА рднреА рд╕рдорд╛рдирд╛рдВрддрд░ рдЪрдХреНрд░ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рддреЗрдЬреА рд╕реЗ рдкрд░рд┐рдорд╛рдг рдХрд╛ рдПрдХ рдХреНрд░рдо рд╣реИ, рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдПрдХ рд╕реБрдкрд░рдХреНрд▓рд╕реНрдЯрд░ рдкрд░ рднреАред </font><font style="vertical-align: inherit;">рдФрд░ рд╕рд╛рде рдЖ рдЧрдпрд╛ред </font><font style="vertical-align: inherit;">рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рд╣реИ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдирд╛рдо рдХреЗ рд▓рд┐рдП рдХреИрд░рд┐рдпрд░ рдХреА рд╢реБрд░реБрдЖрдд рдХрд╛ рд╡рд░реНрд╖ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрдд рдЖрд╡рд╢реНрдпрдХ рд╣реИ - рдкреНрд░рддреНрдпреЗрдХ рд╡рд░реНрд╖ рдХреЗ рд▓рд┐рдП рдЗрд╕рдореЗрдВ рднрд╛рдЧ рд▓реЗрдиреЗ рд╡рд╛рд▓реЗ рдкреНрд░рддрд┐рднрд╛рдЧрд┐рдпреЛрдВ рдХреЛ рдвреВрдВрдврдирд╛ред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рд╣рдорд╛рд░реЗ рдирдореВрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд╡рд░реНрд╖ рдХреЗ рд╕рднреА рдирд╛рдореЛрдВ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдпрд╣ 2010 рд╣реИред рддрджрдиреБрд╕рд╛рд░, рд╣рдо рдЗрд╕ рд╡рд░реНрд╖ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрди рдирд╛рдореЛрдВ рдХреЗ рд╕рд╛рде рд╕рднреА рд░рд┐рдХреЙрд░реНрдбреЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЕрдЧрд▓рд╛, рд╣рдо рдЕрдЧрд▓реЗ рд╡рд░реНрд╖ - 2011 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд▓реЗрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдлрд┐рд░ рд╕реЗ рд╣рдо рдЗрд╕ рд╡рд░реНрд╖ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рд╕рднреА рдирд╛рдореЛрдВ рдХреЛ рдвреВрдВрдврддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╣рдо рдЙрдирд╕реЗ рдХреЗрд╡рд▓ рдЕрдирдкреНрд░реЛрд╕реЗрд╕реНрдб рд▓реЗрддреЗ рд╣реИрдВ, рдЬреЛ рдХрд┐ 2010 рдореЗрдВ рдирд╣реАрдВ рдорд┐рд▓реЗ рдереЗ рдФрд░ 2011 рдореЗрдВ рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдП рдЧрдП рд╣реИрдВред </font><font style="vertical-align: inherit;">рдФрд░ рдЗрд╕реА рддрд░рд╣ рдмрд╛рдХреА рд╕рд╛рд▓ рдХреЗ рд▓рд┐рдПред </font><font style="vertical-align: inherit;">рдПрдХ рд╣реА рдЪрдХреНрд░, рд▓реЗрдХрд┐рди рджреЛ рд▓рд╛рдЦ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдпреЛрдВ рдирд╣реАрдВ, рд▓реЗрдХрд┐рди рдХреБрд▓ рдиреМред</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> range(ars[<span class="hljs-string">'year'</span>].min(),ars[<span class="hljs-string">'year'</span>].max()):<font></font>
    arsynp = ars[(ars[<span class="hljs-string">'exp'</span>] == <span class="hljs-string">''</span>) &amp; (ars[<span class="hljs-string">'year'</span>] == y)] <span class="hljs-comment">#arsynp - all records selected for year not processed</span>
    namesy = arsynp[<span class="hljs-string">'name'</span>].unique()<font></font>
    ind = ars[ars[<span class="hljs-string">'name'</span>].isin(namesy)].index<font></font>
    ars.loc[ind, <span class="hljs-string">'exp'</span>] = ars.loc[ind,<span class="hljs-string">'year'</span>] - y + <span class="hljs-number">1</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдЪрдХреНрд░ рдХреЗрд╡рд▓ рдХреБрдЫ рд╕реЗрдХрдВрдб рдореЗрдВ рдкреВрд░рд╛ рд╣реЛрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдФрд░ рдХреЛрдб рдЕрдзрд┐рдХ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рд╣реЛ рдЧрдпрд╛ред</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд┐рд╖реНрдХрд░реНрд╖</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЦреИрд░, рдЖрдЦрд┐рд░рдХрд╛рд░, рдмрд╣реБрдд рд╕рд╛рд░рд╛ рдХрд╛рдо рдкреВрд░рд╛ рд╣реЛ рдЧрдпрд╛ рд╣реИред рдореЗрд░реЗ рд▓рд┐рдП, рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдЕрдкрдиреА рддрд░рд╣ рдХрд╛ рдкрд╣рд▓рд╛ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдерд╛ред рдЬрдм рдореИрдВрдиреЗ рдЗрд╕реЗ рд▓рд┐рдпрд╛, рддреЛ рдореБрдЦреНрдп рд▓рдХреНрд╖реНрдп рдЕрдЬрдЧрд░ рдФрд░ рдЗрд╕рдХреЗ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдЕрднреНрдпрд╛рд╕ рдХрд░рдирд╛ рдерд╛ред рдпрд╣ рдХрд╛рд░реНрдп рдкреВрд░реНрдг рд╕реЗ рдЕрдзрд┐рдХ рд╣реИред рдФрд░ рдкрд░рд┐рдгрд╛рдо рд╕реНрд╡рдпрдВ рдХрд╛рдлреА рдкреНрд░рд╕реНрддреБрдд рдХрд░рдиреЗ рдпреЛрдЧреНрдп рдереЗред рдкреВрд░рд╛ рд╣реЛрдиреЗ рдкрд░ рдореИрдВрдиреЗ рдЕрдкрдиреЗ рд▓рд┐рдП рдХреНрдпрд╛ рдирд┐рд╖реНрдХрд░реНрд╖ рдирд┐рдХрд╛рд▓реЗ? </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╣рд▓рд╛:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдбреЗрдЯрд╛ рдЕрдкреВрд░реНрдг рд╣реИред рдпрд╣ рд╢рд╛рдпрдж рд▓рдЧрднрдЧ рдХрд┐рд╕реА рднреА рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП рд╕рдЪ рд╣реИред рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдЕрдЧрд░ рд╡реЗ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕рдВрд░рдЪрд┐рдд рд╣реИрдВ, рдФрд░ рдпрд╣ рдЕрдХреНрд╕рд░ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЖрдкрдХреЛ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреА рдЧрдгрдирд╛ рд╢реБрд░реВ рдХрд░рдиреЗ рдФрд░ рд░реБрдЭрд╛рдиреЛрдВ рдХреА рдЦреЛрдЬ рд╢реБрд░реВ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЙрдирдХреЗ рд╕рд╛рде рдЯрд┐рдВрдХрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд░рд╣рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИ - рддреНрд░реБрдЯрд┐рдпреЛрдВ, рдЖрдЙрдЯрд▓реЗрдпрд░, рдорд╛рдирдХреЛрдВ рд╕реЗ рд╡рд┐рдЪрд▓рди, рдЖрджрд┐ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВред </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреВрд╕рд░рд╛:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд┐рд╕реА рднреА рдХрд╛рд░реНрдп рдХрд╛ рдПрдХ рд╣рд▓ рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рдПрдХ рдирд╛рд░реЗ рдХреА рддрд░рд╣ рд╣реИ, рд▓реЗрдХрд┐рди рдЕрдХреНрд╕рд░ рдпрд╣ рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рд╕рд┐рд░реНрдл рдЗрддрдирд╛ рд╣реИ рдХрд┐ рдпрд╣ рд╕рдорд╛рдзрд╛рди рдЗрддрдирд╛ рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдбреЗрдЯрд╛ рдореЗрдВ рд╣реА рдирд╣реАрдВ рд╣реИ, рдмрд▓реНрдХрд┐ рдмреЙрдХреНрд╕ рдХреЗ рдмрд╛рд╣рд░ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдмреЛрд▓рдирд╛ рд╣реИред рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ - рдКрдкрд░ рд╡рд░реНрдгрд┐рдд рдкреНрд░рддрд┐рднрд╛рдЧрд┐рдпреЛрдВ рдХреЗ рдирд╛рдореЛрдВ рдХрд╛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг, рдпрд╛ рд╡реЗрдмрд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░реИрдкрд┐рдВрдЧред </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддреАрд╕рд░рд╛:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдбреЛрдореЗрди рдЬреНрдЮрд╛рди рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред рдЗрд╕рд╕реЗ рдбреЗрдЯрд╛ рдХреЛ рдмреЗрд╣рддрд░ рддрд░реАрдХреЗ рд╕реЗ рддреИрдпрд╛рд░ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛрдЧрд╛, рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдЕрдорд╛рдиреНрдп рдпрд╛ рдЧреИрд░-рдорд╛рдирдХ рдбреЗрдЯрд╛ рдХреЛ рд╣рдЯрд╛рдХрд░, рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреА рддреНрд░реБрдЯрд┐рдпреЛрдВ рд╕реЗ рдмрдЪреЗрдВ, рдРрд╕реА рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдЬреЛ рдбреЗрдЯрд╛ рдореЗрдВ рдирд╣реАрдВ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЗрд╕ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдВ рджреВрд░реА, рд╕рдореБрджрд╛рдп рдореЗрдВ рд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдП рдЧрдП рдлрд╝реЙрд░реНрдо рдореЗрдВ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╕реНрддреБрдд рдХрд░рддреЗ рд╣реИрдВ, рдЬрдмрдХрд┐ рдмреЗрд╡рдХреВрдл, рдЧрд▓рдд рдирд┐рд╖реНрдХрд░реНрд╖ рд╕реЗ рдмрдЪрддреЗ рд╣реИрдВред </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪреМрдерд╛: </font></font></b><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">рдЕрдЬрдЧрд░</font></i><font style="vertical-align: inherit;"> рдореЗрдВ рдХрд╛рдо рдХрд░рдирд╛</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдПрдХ рд╕рдореГрджреНрдз рд╕реЗрдЯ рд╣реИред рдХрднреА-рдХрднреА рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдХреБрдЫ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реЛрдЪрдиреЗ рд▓рд╛рдпрдХ рд╣реИ, рдЖрдк рдЦреЛрдЬрдирд╛ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ - рдпрд╣ рдкрд╣рд▓реЗ рд╕реЗ рдореМрдЬреВрдж рд╣реИред рдпрд╣ рд╕рд┐рд░реНрдл рдорд╣рд╛рди рд╣реИ! рдЗрд╕ рдпреЛрдЧрджрд╛рди рдХреЗ рд▓рд┐рдП рд░рдЪрдирд╛рдХрд╛рд░реЛрдВ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЙрдкрдХрд░рдг рд╣реИ рдХрд┐ рдпрд╣рд╛рдБ рдХрд╛рдо рдореЗрдВ рдЖрдпрд╛ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдзрдиреНрдпрд╡рд╛рдж: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реЗрд▓реЗрдирд┐рдпрдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> scraping, рдЖрдИрдПрд╕рдУ рдорд╛рдирдХ рдХреЗ рдЕрдиреБрд╕рд╛рд░, рджреЗрд╢ рдХреЛрдб рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП pycountry рдХреЗ рд▓рд┐рдП </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреЗрд╢ рдХреЛрдб (datahub)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдУрд▓рд┐рдВрдкрд┐рдХ рдХреЛрдб рдХреЗ рд▓рд┐рдП, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">geopy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрддрд╛, рдкрд░ рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">folium</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - geodata, рдХреЗ рджреГрд╢реНрдп рдХреЗ рд▓рд┐рдП </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рд┐рдВрдЧ-guesser</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдирд╛рдореЛрдВ рдореЗрдВ рд╕реЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг, рдХреЗ рд▓рд┐рдП - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрд╣реБ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - рд╕рдорд╛рдирд╛рдВрддрд░ рдХрдВрдкреНрдпреВрдЯрд┐рдВрдЧ, рдХреЗ рд▓рд┐рдП </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matplotlib</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">numpy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдФрд░ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╛рдВрдбрд╛</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - рдЗрд╕рдХреЗ рдмрд┐рдирд╛ рд╡рд╣рд╛рдБ рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣реАрдВ рдирд╣реАрдВ рд╣реИред</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╛рдВрдЪрд╡рд╛рдВ:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡реИрд╢реНрд╡реАрдХрд░рдг рд╣рдорд╛рд░рд╛ рд╕рдм рдХреБрдЫ рд╣реИред рдирд┐рд░реНрдорд┐рдд </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрдВрдбреЛрдВ рдХреЗ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рд╛рдзрдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдмреЗрд╣рдж рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ </font><font style="vertical-align: inherit;">, рдпрд╣ рдмрд╣реБрдд рдкреНрд░рднрд╛рд╡реА рд╣реИред рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ, рдЬреНрдпрд╛рджрд╛рддрд░ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдЬрдм рд░рд┐рдХреЙрд░реНрдб рдХреА рд╕рдВрдЦреНрдпрд╛ рджрд╕рд┐рдпреЛрдВ рд╣рдЬрд╛рд░реЛрдВ рд╕реЗ рд╢реБрд░реВ рд╣реЛрддреА рд╣реИ, рддреЛ рдпрд╣ рдХреМрд╢рд▓ рдмрд╕ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЫрдареА:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрднрд╛рд▓рдирд╛ рдПрдХ рдмреБрд░рд╛ рд╡рд┐рдЪрд╛рд░ рд╣реИред рдХрд┐рд╕реА рднреА рдореИрдиреБрдЕрд▓ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ - рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдпрд╣ рдкреИрдорд╛рдиреЗ рдкрд░ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рдЕрд░реНрдерд╛рддреН, рдЬрдм рдбреЗрдЯрд╛ рдХреА рдорд╛рддреНрд░рд╛ рдХрдИ рдмрд╛рд░ рдмрдврд╝ рдЬрд╛рддреА рд╣реИ, рддреЛ рдореИрдиреНрдпреБрдЕрд▓ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рд╕рдордп рдЕрд╕реНрд╡реАрдХрд╛рд░реНрдп рдореВрд▓реНрдпреЛрдВ рддрдХ рдмрдврд╝ рдЬрд╛рдПрдЧрд╛, рдФрд░ рджреВрд╕рд░реА рдмрд╛рдд, рдЦрд░рд╛рдм рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рд╣реЛрдЧреА - рдЖрдк рдХреБрдЫ рднреВрд▓ рдЬрд╛рдПрдВрдЧреЗ, рдЖрдк рдХрд╣реАрдВ рди рдХрд╣реАрдВ рдЧрд▓рддреА рдХрд░реЗрдВрдЧреЗред ред рд╕рдм рдХреБрдЫ рдХреЗрд╡рд▓ рдкреНрд░реЛрдЧреНрд░рд╛рдореЗрдЯрд┐рдХ рд╣реИ, рдЕрдЧрд░ рдХреБрдЫ рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рд╕рдорд╛рдзрд╛рди рдХреЗ рд▓рд┐рдП рд╕рд╛рдорд╛рдиреНрдп рдорд╛рдирдХ рд╕реЗ рдмрд╛рд╣рд░ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рдареАрдХ рд╣реИ, рдпрд╣ рдареАрдХ рд╣реИ, рдЖрдк рдбреЗрдЯрд╛ рдХреЗ рдХреБрдЫ рд╣рд┐рд╕реНрд╕реЗ рдХрд╛ рддреНрдпрд╛рдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЕрднреА рднреА рдЕрдзрд┐рдХ рдкреНрд▓рд╕рд╕ рд╣реЛрдВрдЧреЗред </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╛рддрд╡реАрдВ:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрдб рдХреЛ рдХрд╛рд░реНрдп рдХреНрд░рдо рдореЗрдВ рд░рдЦрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдЕрдзрд┐рдХ рд╕реНрдкрд╖реНрдЯ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ! рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдЬрдм рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдХреЛрдб рдЖрддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдЗрд╕ рдХреЛрдб рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд░рдирд╛ рд╣реИ, рддреЛ рдпрд╣рд╛рдВ рд╕рдм рдХреБрдЫ рдЗрддрдирд╛ рд╕рдЦреНрдд рдирд╣реАрдВ рд╣реИред рдореИрдВрдиреЗ рдмреГрд╣рд╕реНрдкрддрд┐ рдиреЛрдЯрдмреБрдХ рдореЗрдВ рдХрд╛рдо рдХрд┐рдпрд╛, рдФрд░ рдЗрд╕ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ, рдореЗрд░реА рд░рд╛рдп рдореЗрдВ, рдмрд╕ рдЕрднрд┐рдиреНрди рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдЙрддреНрдкрд╛рдж рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред рдпрд╣ рд▓рд╛рдЗрди-рдмрд╛рдп-рд▓рд╛рдЗрди, рдЯреБрдХрдбрд╝реЗ-рдЯреБрдХрдбрд╝реЗ рд▓реЙрдиреНрдЪ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЗрд╕рдХреЗ рдлрд╛рдпрджреЗ рд╣реИрдВ - рдпрд╣ рддреЗрдЬ рд╣реИ: рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рд╡рд┐рдХрд╛рд╕, рдбрд┐рдмрдЧрд┐рдВрдЧ рдФрд░ рдирд┐рд╖реНрдкрд╛рджрдиред рд▓реЗрдХрд┐рди рдЕрдХреНрд╕рд░ рдкреНрд░рд▓реЛрднрди рд╕рд┐рд░реНрдл рд╕рдВрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдмрдирд╛рдирд╛ рдпрд╛ рдореЗрдВ рд░реИрдкрд┐рдВрдЧ рдХреЗ рдмрдЬрд╛рдп рдХреБрдЫ рд▓рд╛рдЗрди рд╣реИ рдФрд░ рдЬрд▓реНрджреА рд╕реЗ рдПрдХ рдирдпрд╛ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреАрдИрдПрдлрд╝</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред рдмреЗрд╢рдХ, рдЗрд╕ рддрд░рд╣ рдХреЗ рдкреНрд░рд▓реЛрднрди рд╕реЗ рдмрдЪрдирд╛ рдЪрд╛рд╣рд┐рдПред рдПрдХ рдЕрдЪреНрдЫреЗ рдХреЛрдб рдХреЗ рд▓рд┐рдП рдкреНрд░рдпрд╛рд╕ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ "рдЦреБрдж рдХреЗ рд▓рд┐рдП", рдХрдо рд╕реЗ рдХрдо рдХреНрдпреЛрдВрдХрд┐ рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдПрдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП рд▓реЙрдиреНрдЪ рдХрдИ рдмрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╕рдордп рдХрд╛ рдирд┐рд╡реЗрд╢ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рднрд╡рд┐рд╖реНрдп рдореЗрдВ рднреБрдЧрддрд╛рди рдХрд░реЗрдЧрд╛ред рдФрд░ рдЖрдк рдкрд░реАрдХреНрд╖рдг рдХреЛ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реИрдкрдЯреЙрдк рдкрд░ рднреА, рдорд╣рддреНрд╡рдкреВрд░реНрдг рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рдЪреЗрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдФрд░ рдЕрдкрд╡рд╛рджреЛрдВ рдХреЛ рдлреЗрдВрдХрддреЗ рд╣реБрдП - рдпрд╣ рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рд╣реИред </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдард╡рд╛рдВ:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрдзрд┐рдХ рдмрд╛рд░ рдмрдЪрд╛рдПрдВред рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдг рдкрд░, рдореИрдВрдиреЗ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдПрдХ рдирдпрд╛ рд╕рдВрд╕реНрдХрд░рдг рд╕рд╣реЗрдЬрд╛ред рдХреБрд▓ рдорд┐рд▓рд╛рдХрд░, рд╡реЗ рд▓рдЧрднрдЧ 10. рдереЗред рдпрд╣ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЬрдм рдПрдХ рддреНрд░реБрдЯрд┐ рдХрд╛ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рддреЛ рдпрд╣ рдЬрд▓реНрджреА рд╕реЗ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдХрд┐рд╕ рдЪрд░рдг рдореЗрдВ рд╣реБрдЖред рд╕рд╛рде рд╣реА, рдореИрдВрдиреЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрдЪреНрдЪреЗ рдХреЗ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд░реВрдк рдореЗрдВ рдЪрд┐рд╣реНрдирд┐рдд рдХреЙрд▓рдо рдореЗрдВ рд╕реНрд░реЛрдд рдбреЗрдЯрд╛ рдХреЛ рдмрдЪрд╛рдпрд╛ </font><font style="vertical-align: inherit;">- рдпрд╣ рдЖрдкрдХреЛ рдкрд░рд┐рдгрд╛рдо рдХреЛ рдЬрд▓реНрджреА рд╕реЗ рдЬрд╛рдВрдЪрдиреЗ рдФрд░ рд╡рд┐рд╕рдВрдЧрддрд┐ рдХреЛ рджреЗрдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреМрд╡рд╛рдВ:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдордп рдФрд░ рдкрд░рд┐рдгрд╛рдо рдХреЗ рдирд┐рд╡реЗрд╢ рдХреЛ рдорд╛рдкрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред рдХреБрдЫ рд╕реНрдерд╛рдиреЛрдВ рдкрд░, рдореБрдЭреЗ рдбреЗрдЯрд╛ рдХреЛ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рд▓рдВрдмрд╛ рд╕рдордп рд▓рдЧрд╛, рдЬреЛ рдХреБрд▓ рдкреНрд░рддрд┐рд╢рдд рдХрд╛ рдПрдХ рдЕрдВрд╢ рдмрдирд╛рддреЗ рд╣реИрдВред рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдЗрд╕рд╕реЗ рдХреЛрдИ рдорддрд▓рдм рдирд╣реАрдВ рдерд╛, рдЖрдкрдХреЛ рдмрд╕ рдЙрдиреНрд╣реЗрдВ рдлреЗрдВрдХрдирд╛ рдерд╛, рдФрд░ рдпрд╣ рд╕рдмред рдФрд░ рдореИрдВ рдРрд╕рд╛ рдХрд░реВрдВрдЧрд╛ рдпрджрд┐ рдпрд╣ рдПрдХ рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╣реИ, рди рдХрд┐ рдПрдХ рдСрдЯреЛ-рдкреНрд░рд╢рд┐рдХреНрд╖рдгред рдпрд╣ рдЖрдкрдХреЛ рдкрд░рд┐рдгрд╛рдо рдХреЛ рдмрд╣реБрдд рддреЗрдЬрд╝реА рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред рдкреЗрд░реЗрдЯреЛ рд╕рд┐рджреНрдзрд╛рдВрдд рдпрд╣рд╛рдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ - 80% рдкрд░рд┐рдгрд╛рдо 20% рд╕рдордп рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ рдЖрдЦрд┐рд░ рдХрд╛:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рддрд░рд╣ рдХреА рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдкрд░ рдХрд╛рдо рдХреНрд╖рд┐рддрд┐рдЬ рдХреЛ рд╡реНрдпрд╛рдкрдХ рдмрдирд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрдЪреНрдЫрд╛ рд╕реЗ, рдЖрдк рдХреБрдЫ рдирдпрд╛ рд╕реАрдЦрддреЗ рд╣реИрдВ - рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЕрдЬреАрдм рджреЗрд╢реЛрдВ рдХреЗ рдирд╛рдо - рдЬреИрд╕реЗ рдкрд┐рдЯрдХреЗрд░реНрди рджреНрд╡реАрдк, рдХрд┐ рд╕реНрд╡рд┐рдЯреНрдЬрд░рд▓реИрдВрдб рдХреЗ рд▓рд┐рдП рдЖрдИрдПрд╕рдУ рдХреЛрдб CHE рд╣реИ, рд▓реИрдЯрд┐рди рд╕реЗ "рдХрдиреНрдлреЗрдбреЗрд░реЗрдЯрд┐рдпреЛ рд╣реЗрд▓реНрд╡реЗрдЯрд┐рдХрд╛", рд╕реНрдкреЗрдирд┐рд╢ рдирд╛рдо рдХреНрдпрд╛ рд╣реИ, рдареАрдХ рд╣реИ, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЯреНрд░рд╛рдпрдерд▓реЙрди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ - рд░рд┐рдХреЙрд░реНрдб, рдЙрдирдХреЗ рдорд╛рд▓рд┐рдХ, рджреМрдбрд╝ рдХреЗ рд╕реНрдерд╛рди, рдШрдЯрдирд╛рдУрдВ рдХрд╛ рдЗрддрд┐рд╣рд╛рд╕ рдФрд░ рдЗрд╕реА рддрд░рд╣ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╢рд╛рдпрдж рдХрд╛рдлреА рд╣реИред </font><font style="vertical-align: inherit;">рдмрд╕ рдЗрддрдирд╛ рд╣реАред </font><font style="vertical-align: inherit;">рдЕрдВрдд рддрдХ рдкрдврд╝рдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рдХреЛ рдзрдиреНрдпрд╡рд╛рдж!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi500150/index.html">рдЖрд░рдУрдПрд╕ рдФрд░ рдиреНрдпреВрд░рд▓ рдЧреНрд░рд┐рдб рднрд┐рдЦрд╛рд░реА рд░реЛрдмреЛрдЯ</a></li>
<li><a href="../hi500152/index.html">рдореИрдВрдиреЗ 1 рд╕реА: рдЙрджреНрдпрдо рдореЗрдВ рдкреАрдУрдПрд╕-рдЯрд░реНрдорд┐рдирд▓ рдФрд░ рдПрдлрдЖрд░ рдЖрдИрдХреЗрдПрдордПрдо-рдЯрдЪ рдХреЛ рдХреИрд╕реЗ рдПрдХреАрдХреГрдд рдХрд┐рдпрд╛</a></li>
<li><a href="../hi500154/index.html">рдЧреЛрдкрдиреАрдп рдорд╢реАрди рд╕реАрдЦрдирд╛ред PySyft рд▓рд╛рдЗрдмреНрд░реЗрд░реА</a></li>
<li><a href="../hi500158/index.html">Redux рдХреЗ рд╕рд╛рде SwiftUI рдЗрдВрдЯрд░реИрдХреНрд╢рди</a></li>
<li><a href="../hi500160/index.html">рджреГрд╢реНрдп рддрддреНрд╡</a></li>
<li><a href="../hi500164/index.html">рдЯреНрдпреВрдЯрд░: рдкреЗрд╢реЗ рдХреА рд▓рд╛рдЧрдд</a></li>
<li><a href="../hi500170/index.html">рдиреЗрдЯрд╡рд░реНрдХ рд╕рд┐рдореНрдпреБрд▓реЗрдЯрд░ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдПрдирдПрд╕ -3ред рдЕрдзреНрдпрд╛рдп 6</a></li>
<li><a href="../hi500178/index.html">рдПрдВрдбреНрд░рдпреВ рдЕрди рдХреА рдХрд┐рддрд╛рдм, рдкреИрд╢рди рдлреЙрд░ рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ, рдЕрдзреНрдпрд╛рдп 38 рдФрд░ 39 рдХрд╛ рдЕрдиреБрд╡рд╛рдж</a></li>
<li><a href="../hi500184/index.html">рдбреЗрд╡рд┐рдб рдУ'рдмреНрд░рд╛рдпрди (рдПрдХреНрд╕рд░рд╕): рдореЗрдЯреНрд░рд┐рдХреНрд╕! рдореЗрдЯреНрд░рд┐рдХреНрд╕! рдореЗрдЯреНрд░рд┐рдХреНрд╕! рднрд╛рдЧ 2</a></li>
<li><a href="../hi500186/index.html">HackTheBoxред OpenAdmin рдХрд╛ рд╡реЙрдХрдереНрд░реВред рдиреИрдиреЛ рдореЗрдВ OpenNetAdmin рдФрд░ GTFOBins рдореЗрдВ RCE</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>