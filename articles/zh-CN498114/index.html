<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ’†ğŸ½ ğŸ“« ğŸšŒ ä¸€åƒç´ æ”»å‡»ã€‚æˆ–å¦‚ä½•æ¬ºéª—ç¥ç»ç½‘ç»œ ğŸ§‘ğŸ¼ ğŸ‘©â€ğŸš€ ğŸ‘‰ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="è®©æˆ‘ä»¬ç†Ÿæ‚‰ä¸€ä¸‹ç¥ç»ç½‘ç»œä¸­çš„ä¸€ç§æ”»å‡»ï¼Œè¿™ç§æ”»å‡»å¯¼è‡´åˆ†ç±»é”™è¯¯ä¸”å¤–éƒ¨å½±å“æœ€å°ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œç¥ç»ç½‘ç»œå°±æ˜¯æ‚¨ã€‚æ­¤åˆ»ï¼Œæ‚¨åœ¨å–ä¸€æ¯é¦™æµ“å’–å•¡çš„åŒæ—¶ï¼Œå¯¹çŒ«çš„å›¾åƒè¿›è¡Œåˆ†ç±»çš„å‡†ç¡®ç‡é«˜è¾¾90ï¼…ä»¥ä¸Šï¼Œç”šè‡³æ²¡æœ‰æ€€ç–‘â€œå•åƒç´ æ”»å‡»â€ä¼šå°†æ‚¨æ‰€æœ‰çš„â€œçŒ«â€å˜æˆå¡è½¦ã€‚
 
 ç°åœ¨æˆ‘ä»¬å°†æš‚åœï¼Œå°†å’–å•¡ç§»åˆ°ä¸€è¾¹ï¼Œå¯¼å…¥æˆ‘ä»¬éœ€è¦çš„æ‰€æœ‰åº“ï¼Œå¹¶åˆ†æè¿™ç§åƒ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ä¸€åƒç´ æ”»å‡»ã€‚æˆ–å¦‚ä½•æ¬ºéª—ç¥ç»ç½‘ç»œ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/498114/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®©æˆ‘ä»¬ç†Ÿæ‚‰ä¸€ä¸‹ç¥ç»ç½‘ç»œä¸­çš„ä¸€ç§æ”»å‡»ï¼Œè¿™ç§æ”»å‡»å¯¼è‡´åˆ†ç±»é”™è¯¯ä¸”å¤–éƒ¨å½±å“æœ€å°ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œç¥ç»ç½‘ç»œå°±æ˜¯æ‚¨ã€‚æ­¤åˆ»ï¼Œæ‚¨åœ¨å–ä¸€æ¯é¦™æµ“å’–å•¡çš„åŒæ—¶ï¼Œå¯¹çŒ«çš„å›¾åƒè¿›è¡Œåˆ†ç±»çš„å‡†ç¡®ç‡é«˜è¾¾90ï¼…ä»¥ä¸Šï¼Œç”šè‡³æ²¡æœ‰æ€€ç–‘â€œå•åƒç´ æ”»å‡»â€ä¼šå°†æ‚¨æ‰€æœ‰çš„â€œçŒ«â€å˜æˆå¡è½¦ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨æˆ‘ä»¬å°†æš‚åœï¼Œå°†å’–å•¡ç§»åˆ°ä¸€è¾¹ï¼Œå¯¼å…¥æˆ‘ä»¬éœ€è¦çš„æ‰€æœ‰åº“ï¼Œå¹¶åˆ†æè¿™ç§åƒç´ æ”»å‡»çš„å·¥ä½œæ–¹å¼ã€‚</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™ç§æ”»å‡»çš„ç›®çš„æ˜¯ä½¿ç®—æ³•ï¼ˆç¥ç»ç½‘ç»œï¼‰ç»™å‡ºé”™è¯¯çš„ç­”æ¡ˆã€‚</font><font style="vertical-align: inherit;">ä¸‹é¢æˆ‘ä»¬å°†é€šè¿‡å‡ ç§ä¸åŒçš„å·ç§¯ç¥ç»ç½‘ç»œæ¨¡å‹æ¥çœ‹åˆ°è¿™ä¸€ç‚¹ã€‚</font><font style="vertical-align: inherit;">ä½¿ç”¨å¤šç»´æ•°å­¦ä¼˜åŒ–çš„æ–¹æ³•ä¹‹ä¸€-å¾®åˆ†è¿›åŒ–ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†å¯ä»¥æ”¹å˜å›¾åƒçš„ç‰¹æ®Šåƒç´ ï¼Œä»è€Œä½¿ç¥ç»ç½‘ç»œå¼€å§‹é”™è¯¯åœ°å¯¹è¯¥å›¾åƒè¿›è¡Œåˆ†ç±»ï¼ˆå°½ç®¡äº‹å®æ˜¯è¯¥ç®—æ³•è¾ƒæ—©åœ°æ­£ç¡®ä¸”é«˜ç²¾åº¦åœ°â€œè¯†åˆ«â€äº†åŒä¸€å›¾åƒï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯¼å…¥åº“ï¼š</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># Python Libraries</span><font></font>
%matplotlib inline<font></font>
<span class="hljs-keyword">import</span> pickle
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> matplotlib
<span class="hljs-keyword">from</span> keras.datasets <span class="hljs-keyword">import</span> cifar10
<span class="hljs-keyword">from</span> keras <span class="hljs-keyword">import</span> backend <span class="hljs-keyword">as</span> K<font></font>
<font></font>
<span class="hljs-comment"># Custom Networks</span>
<span class="hljs-keyword">from</span> networks.lenet <span class="hljs-keyword">import</span> LeNet
<span class="hljs-keyword">from</span> networks.pure_cnn <span class="hljs-keyword">import</span> PureCnn
<span class="hljs-keyword">from</span> networks.network_in_network <span class="hljs-keyword">import</span> NetworkInNetwork
<span class="hljs-keyword">from</span> networks.resnet <span class="hljs-keyword">import</span> ResNet
<span class="hljs-keyword">from</span> networks.densenet <span class="hljs-keyword">import</span> DenseNet
<span class="hljs-keyword">from</span> networks.wide_resnet <span class="hljs-keyword">import</span> WideResNet
<span class="hljs-keyword">from</span> networks.capsnet <span class="hljs-keyword">import</span> CapsNet<font></font>
<font></font>
<span class="hljs-comment"># Helper functions</span>
<span class="hljs-keyword">from</span> differential_evolution <span class="hljs-keyword">import</span> differential_evolution
<span class="hljs-keyword">import</span> helper<font></font>
<font></font>
matplotlib.style.use(<span class="hljs-string">'ggplot'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯¹äºæˆ‘ä»¬çš„å®éªŒï¼Œæˆ‘ä»¬å°†åŠ è½½CIFAR-10æ•°æ®é›†ï¼Œå…¶ä¸­åŒ…å«åˆ†ä¸º10ç±»çš„çœŸå®ä¸–ç•Œå›¾åƒã€‚</font></font><br>
<br>
<pre><code class="python hljs">(x_train, y_train), (x_test, y_test) = cifar10.load_data()<font></font>
<font></font>
class_names = [<span class="hljs-string">'airplane'</span>, <span class="hljs-string">'automobile'</span>, <span class="hljs-string">'bird'</span>, <span class="hljs-string">'cat'</span>, <span class="hljs-string">'deer'</span>, <span class="hljs-string">'dog'</span>, <span class="hljs-string">'frog'</span>, <span class="hljs-string">'horse'</span>, <span class="hljs-string">'ship'</span>, <span class="hljs-string">'truck'</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬é€šè¿‡ç´¢å¼•æŸ¥çœ‹ä»»ä½•å›¾åƒã€‚</font><font style="vertical-align: inherit;">ä¾‹å¦‚ï¼Œè¿™åŒ¹é©¬ã€‚</font></font><br>
<br>
<pre><code class="python hljs">image_id = <span class="hljs-number">99</span> <span class="hljs-comment"># Image index in the test set</span><font></font>
helper.plot_image(x_test[image_id])<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/gp/k9/gw/gpk9gwtmh-_e8e5jcni2vhcej70.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å°†ä¸å¾—ä¸å¯»æ‰¾å¯ä»¥æ”¹å˜ç¥ç»ç½‘ç»œå“åº”çš„éå¸¸å¼ºå¤§çš„åƒç´ ï¼Œè¿™æ„å‘³ç€æ˜¯æ—¶å€™ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥æ›´æ”¹å›¾åƒçš„ä¸€ä¸ªæˆ–å¤šä¸ªåƒç´ äº†ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">perturb_image</span>(<span class="hljs-params">xs, img</span>):</span>
    <span class="hljs-comment"># If this function is passed just one perturbation vector,</span>
    <span class="hljs-comment"># pack it in a list to keep the computation the same</span>
    <span class="hljs-keyword">if</span> xs.ndim &lt; <span class="hljs-number">2</span>:<font></font>
        xs = np.array([xs])<font></font>
    <font></font>
    <span class="hljs-comment"># Copy the image n == len(xs) times so that we can </span>
    <span class="hljs-comment"># create n new perturbed images</span>
    tile = [len(xs)] + [<span class="hljs-number">1</span>]*(xs.ndim+<span class="hljs-number">1</span>)<font></font>
    imgs = np.tile(img, tile)<font></font>
    <font></font>
    <span class="hljs-comment"># Make sure to floor the members of xs as int types</span><font></font>
    xs = xs.astype(int)<font></font>
    <font></font>
    <span class="hljs-keyword">for</span> x,img <span class="hljs-keyword">in</span> zip(xs, imgs):
        <span class="hljs-comment"># Split x into an array of 5-tuples (perturbation pixels)</span>
        <span class="hljs-comment"># i.e., [[x,y,r,g,b], ...]</span>
        pixels = np.split(x, len(x) // <span class="hljs-number">5</span>)
        <span class="hljs-keyword">for</span> pixel <span class="hljs-keyword">in</span> pixels:
            <span class="hljs-comment"># At each pixel's x,y position, assign its rgb value</span><font></font>
            x_pos, y_pos, *rgb = pixel<font></font>
            img[x_pos, y_pos] = rgb<font></font>
    <font></font>
    <span class="hljs-keyword">return</span> imgs
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€æ¢ç©¶ç«Ÿ ï¼Ÿï¼</font><font style="vertical-align: inherit;">å°†æˆ‘ä»¬åæ ‡ä¸ºï¼ˆ16ï¼Œ16ï¼‰çš„é©¬åŒ¹çš„ä¸€ä¸ªåƒç´ æ›´æ”¹ä¸ºé»„è‰²ã€‚</font></font><br>
<br>
<pre><code class="python hljs">image_id = <span class="hljs-number">99</span> <span class="hljs-comment"># Image index in the test set</span>
pixel = np.array([<span class="hljs-number">16</span>, <span class="hljs-number">16</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>]) <span class="hljs-comment"># pixel = x,y,r,g,b</span>
image_perturbed = perturb_image(pixel, x_test[image_id])[<span class="hljs-number">0</span>]<font></font>
<font></font>
helper.plot_image(image_perturbed)<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/qj/sf/li/qjsflidtymruwiuotebu0r7siby.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†æ¼”ç¤ºæ”»å‡»ï¼Œæ‚¨éœ€è¦åœ¨æˆ‘ä»¬çš„CIFAR-10æ•°æ®é›†ä¸Šä¸‹è½½ç¥ç»ç½‘ç»œçš„é¢„è®­ç»ƒæ¨¡å‹ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å°†ä½¿ç”¨lenetå’Œresnetè¿™ä¸¤ä¸ªæ¨¡å‹ï¼Œä½†æ˜¯æ‚¨å¯ä»¥é€šè¿‡å–æ¶ˆæ³¨é‡Šç›¸åº”çš„ä»£ç è¡Œæ¥ä½¿ç”¨å…¶ä»–æ¨¡å‹è¿›è¡Œå®éªŒã€‚</font></font><br>
<br>
<pre><code class="python hljs">lenet = LeNet()<font></font>
resnet = ResNet()<font></font>
<font></font>
models = [lenet, resnet]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 åŠ è½½æ¨¡å‹åï¼Œæœ‰å¿…è¦è¯„ä¼°æ¯ä¸ªæ¨¡å‹çš„æµ‹è¯•å›¾åƒï¼Œä»¥ç¡®ä¿æˆ‘ä»¬ä»…æ”»å‡»æ­£ç¡®åˆ†ç±»çš„å›¾åƒã€‚</font><font style="vertical-align: inherit;">ä¸‹é¢çš„ä»£ç æ˜¾ç¤ºæ¯ä¸ªæ¨¡å‹çš„ç²¾åº¦å’Œå‚æ•°æ•°é‡ã€‚</font></font><br>
<br>
<pre><code class="python hljs">network_stats, correct_imgs = helper.evaluate_models(models, x_test, y_test)<font></font>
<font></font>
correct_imgs = pd.DataFrame(correct_imgs, columns=[<span class="hljs-string">'name'</span>, <span class="hljs-string">'img'</span>, <span class="hljs-string">'label'</span>, <span class="hljs-string">'confidence'</span>, <span class="hljs-string">'pred'</span>])<font></font>
<font></font>
network_stats = pd.DataFrame(network_stats, columns=[<span class="hljs-string">'name'</span>, <span class="hljs-string">'accuracy'</span>, <span class="hljs-string">'param_count'</span>])<font></font>
<font></font>
network_stats<font></font>
Evaluating lenet<font></font>
Evaluating resnet<font></font>
<font></font>
Out[<span class="hljs-number">11</span>]:<font></font>
<font></font>
<font></font>
	name        accuracy    param_count<font></font>
<span class="hljs-number">0</span>      lenet        <span class="hljs-number">0.748</span>       <span class="hljs-number">62006</span>
<span class="hljs-number">1</span>      resnet       <span class="hljs-number">0.9231</span>      <span class="hljs-number">470218</span><font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 æ‰€æœ‰è¿™äº›æ”»å‡»å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼šWhiteBoxå’ŒBlackBoxã€‚å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«åœ¨äºï¼Œåœ¨ç¬¬ä¸€ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½å¯é åœ°äº†è§£äº†æ‰€è¦å¤„ç†çš„ç®—æ³•å’Œæ¨¡å‹ã€‚å¯¹äºBlackBoxï¼Œæˆ‘ä»¬éœ€è¦çš„åªæ˜¯è¾“å…¥ï¼ˆå›¾åƒï¼‰å’Œè¾“å‡ºï¼ˆè¢«åˆ†é…ç»™ä¸€ä¸ªç±»çš„æ¦‚ç‡ï¼‰ã€‚ä¸€åƒç´ æ”»å‡»æŒ‡çš„æ˜¯BlackBoxã€‚</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬è€ƒè™‘æ”»å‡»å•ä¸ªåƒç´ çš„ä¸¤ç§æ–¹æ³•ï¼šæ— é’ˆå¯¹æ€§å’Œé’ˆå¯¹æ€§ã€‚åœ¨ç¬¬ä¸€ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çŒ«çš„ç¥ç»ç½‘ç»œå±äºå“ªä¸€ç±»ç»å¯¹ä¸é‡è¦ï¼Œæœ€é‡è¦çš„æ˜¯ï¼Œä¸å±äºçŒ«çš„ç±»ã€‚å½“æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„çŒ«æˆä¸ºå¡è½¦è€Œåªæœ‰å¡è½¦æ—¶ï¼Œå¯ä»¥åº”ç”¨æœ‰é’ˆå¯¹æ€§çš„æ”»å‡»ã€‚</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½†æ˜¯ï¼Œå¦‚ä½•æ‰¾åˆ°å…¶åƒç´ å˜åŒ–ä¼šå¯¼è‡´å›¾åƒç±»åˆ«å˜åŒ–çš„åƒç´ å‘¢ï¼Ÿå¦‚ä½•é€šè¿‡æ›´æ”¹å¯èƒ½æˆåŠŸçš„ä¸€ä¸ªåƒç´ æ¥æ‰¾åˆ°åƒç´ ï¼Ÿè®©æˆ‘ä»¬å°è¯•å°†è¿™ä¸ªé—®é¢˜è¡¨è¿°ä¸ºä¼˜åŒ–é—®é¢˜ï¼Œä½†æ˜¯åªèƒ½ç”¨éå¸¸ç®€å•çš„è¯æ¥è¡¨è¿°ï¼šå¯¹äºéç›®æ ‡æ”»å‡»ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿å¯¹æ‰€éœ€ç±»çš„ä¿¡ä»»æœ€å°åŒ–ï¼Œè€Œå¯¹äºç›®æ ‡ç±»ï¼Œåº”ä½¿å¯¹ç›®æ ‡ç±»çš„ä¿¡ä»»æœ€å¤§åŒ–ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿›è¡Œæ­¤ç±»æ”»å‡»æ—¶ï¼Œå¾ˆéš¾ä½¿ç”¨æ¢¯åº¦ä¼˜åŒ–åŠŸèƒ½ã€‚å¿…é¡»ä½¿ç”¨ä¸ä¾èµ–äºå‡½æ•°å¹³æ»‘åº¦çš„ä¼˜åŒ–ç®—æ³•ã€‚</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å›æƒ³ä¸€ä¸‹ï¼Œå¯¹äºæˆ‘ä»¬çš„å®éªŒï¼Œæˆ‘ä»¬ä½¿ç”¨CIFAR-10æ•°æ®é›†ï¼Œå…¶ä¸­åŒ…å«å¤§å°ä¸º32 x 32åƒç´ çš„çœŸå®ä¸–ç•Œå›¾åƒï¼Œåˆ†ä¸º10ç±»ã€‚</font><font style="vertical-align: inherit;">è¿™æ„å‘³ç€æˆ‘ä»¬å…·æœ‰ä»0åˆ°31çš„æ•´æ•°ç¦»æ•£å€¼å’Œä»0åˆ°255çš„é¢œè‰²å¼ºåº¦ï¼Œå¹¶ä¸”è¯¥å‡½æ•°ä¸ä¼šå¾ˆå¹³æ»‘ï¼Œè€Œæ˜¯å‚å·®ä¸é½ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vs/0k/mv/vs0kmvtq35lowxplx0rsq2-kppw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä½¿ç”¨å·®åˆ†è¿›åŒ–ç®—æ³•ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½†æ˜¯å›åˆ°ä»£ç å¹¶ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°è¿”å›æ¨¡å‹å¯é æ€§çš„æ¦‚ç‡ã€‚</font><font style="vertical-align: inherit;">å¦‚æœç›®æ ‡ç±»æ˜¯æ­£ç¡®çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦æœ€å°åŒ–æ­¤å‡½æ•°ï¼Œä»¥ä¾¿æ¨¡å‹å¯ä»¥ç¡®å®šå¦ä¸€ä¸ªç±»ï¼ˆè¿™æ˜¯ä¸æ­£ç¡®çš„ï¼‰ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">predict_classes</span>(<span class="hljs-params">xs, img, target_class, model, minimize=True</span>):</span>
    <span class="hljs-comment"># Perturb the image with the given pixel(s) x and get the prediction of the model</span><font></font>
    imgs_perturbed = perturb_image(xs, img)<font></font>
    predictions = model.predict(imgs_perturbed)[:,target_class]<font></font>
    <span class="hljs-comment"># This function should always be minimized, so return its complement if needed</span>
    <span class="hljs-keyword">return</span> predictions <span class="hljs-keyword">if</span> minimize <span class="hljs-keyword">else</span> <span class="hljs-number">1</span> - predictions<font></font>
<font></font>
image_id = <span class="hljs-number">384</span>
pixel = np.array([<span class="hljs-number">16</span>, <span class="hljs-number">13</span>,  <span class="hljs-number">25</span>, <span class="hljs-number">48</span>, <span class="hljs-number">156</span>])<font></font>
model = resnet<font></font>
<font></font>
true_class = y_test[image_id, <span class="hljs-number">0</span>]<font></font>
prior_confidence = model.predict_one(x_test[image_id])[true_class]<font></font>
confidence = predict_classes(pixel, x_test[image_id], true_class, model)[<span class="hljs-number">0</span>]<font></font>
<font></font>
print(<span class="hljs-string">'Confidence in true class'</span>, class_names[true_class], <span class="hljs-string">'is'</span>, confidence)<font></font>
print(<span class="hljs-string">'Prior confidence was'</span>, prior_confidence)<font></font>
helper.plot_image(perturb_image(pixel, x_test[image_id])[<span class="hljs-number">0</span>])<font></font>
<font></font>
Confidence <span class="hljs-keyword">in</span> true <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">bird</span> <span class="hljs-title">is</span> 0.00018887444
<span class="hljs-title">Prior</span> <span class="hljs-title">confidence</span> <span class="hljs-title">was</span> 0.70661753
</span></code></pre><br>
<img src="https://habrastorage.org/webt/re/g3/yn/reg3ync4qxac0hxb5wrr0jus_je.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å°†éœ€è¦ä¸‹ä¸€ä¸ªå‡½æ•°æ¥ç¡®è®¤æ”»å‡»æˆåŠŸçš„æ ‡å‡†ï¼Œå½“æ›´æ”¹è¶³ä»¥æ¬ºéª—æ¨¡å‹æ—¶ï¼Œå®ƒå°†è¿”å›Trueã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">attack_success</span>(<span class="hljs-params">x, img, target_class, model, targeted_attack=False, verbose=False</span>):</span>
    <span class="hljs-comment"># Perturb the image with the given pixel(s) and get the prediction of the model</span><font></font>
    attack_image = perturb_image(x, img)<font></font>
    confidence = model.predict(attack_image)[<span class="hljs-number">0</span>]<font></font>
    predicted_class = np.argmax(confidence)<font></font>
    <font></font>
    <span class="hljs-comment"># If the prediction is what we want (misclassification or </span>
    <span class="hljs-comment"># targeted classification), return True</span>
    <span class="hljs-keyword">if</span> verbose:<font></font>
        print(<span class="hljs-string">'Confidence:'</span>, confidence[target_class])
    <span class="hljs-keyword">if</span> ((targeted_attack <span class="hljs-keyword">and</span> predicted_class == target_class) <span class="hljs-keyword">or</span>
        (<span class="hljs-keyword">not</span> targeted_attack <span class="hljs-keyword">and</span> predicted_class != target_class)):
        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
    <span class="hljs-comment"># <span class="hljs-doctag">NOTE:</span> return None otherwise (not False), due to how Scipy handles its callback function</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æˆåŠŸæ ‡å‡†å‡½æ•°çš„å·¥ä½œã€‚</font><font style="vertical-align: inherit;">ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬å‡è®¾æ˜¯éç›®æ ‡æ”»å‡»ã€‚</font></font><br>
<br>
<pre><code class="python hljs">image_id = <span class="hljs-number">541</span>
pixel = np.array([<span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">185</span>, <span class="hljs-number">36</span>, <span class="hljs-number">215</span>])<font></font>
model = resnet<font></font>
<font></font>
true_class = y_test[image_id, <span class="hljs-number">0</span>]<font></font>
prior_confidence = model.predict_one(x_test[image_id])[true_class]<font></font>
success = attack_success(pixel, x_test[image_id], true_class, model, verbose=<span class="hljs-literal">True</span>)<font></font>
<font></font>
print(<span class="hljs-string">'Prior confidence'</span>, prior_confidence)<font></font>
print(<span class="hljs-string">'Attack success:'</span>, success == <span class="hljs-literal">True</span>)<font></font>
helper.plot_image(perturb_image(pixel, x_test[image_id])[<span class="hljs-number">0</span>])<font></font>
Confidence: <span class="hljs-number">0.07460087</span>
Prior confidence <span class="hljs-number">0.50054216</span>
Attack success: <span class="hljs-literal">True</span>
</code></pre><br>
<img src="https://habrastorage.org/webt/vh/qb/vp/vhqbvpxy3blhf-krbwmmtezadbu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨æ˜¯æ—¶å€™å°†æ‰€æœ‰è°œé¢˜æ”¶é›†åˆ°ä¸€å¼ å›¾ç‰‡ä¸­äº†ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å°†å¯¹Scipyä¸­çš„å·®åˆ†è¿›åŒ–çš„å®ç°è¿›è¡Œå°‘é‡ä¿®æ”¹ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">attack</span>(<span class="hljs-params">img_id, model, target=None, pixel_count=<span class="hljs-number">1</span>, 
           maxiter=<span class="hljs-number">75</span>, popsize=<span class="hljs-number">400</span>, verbose=False</span>):</span>
    <span class="hljs-comment"># Change the target class based on whether this is a targeted attack or not</span>
    targeted_attack = target <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>
    target_class = target <span class="hljs-keyword">if</span> targeted_attack <span class="hljs-keyword">else</span> y_test[img_id, <span class="hljs-number">0</span>]<font></font>
    <font></font>
    <span class="hljs-comment"># Define bounds for a flat vector of x,y,r,g,b values</span>
    <span class="hljs-comment"># For more pixels, repeat this layout</span>
    bounds = [(<span class="hljs-number">0</span>,<span class="hljs-number">32</span>), (<span class="hljs-number">0</span>,<span class="hljs-number">32</span>), (<span class="hljs-number">0</span>,<span class="hljs-number">256</span>), (<span class="hljs-number">0</span>,<span class="hljs-number">256</span>), (<span class="hljs-number">0</span>,<span class="hljs-number">256</span>)] * pixel_count<font></font>
    <font></font>
    <span class="hljs-comment"># Population multiplier, in terms of the size of the perturbation vector x</span>
    popmul = max(<span class="hljs-number">1</span>, popsize // len(bounds))<font></font>
    <font></font>
    <span class="hljs-comment"># Format the predict/callback functions for the differential evolution algorithm</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">predict_fn</span>(<span class="hljs-params">xs</span>):</span>
        <span class="hljs-keyword">return</span> predict_classes(xs, x_test[img_id], target_class, <font></font>
                               model, target <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>)<font></font>
    <font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">callback_fn</span>(<span class="hljs-params">x, convergence</span>):</span>
        <span class="hljs-keyword">return</span> attack_success(x, x_test[img_id], target_class, <font></font>
                              model, targeted_attack, verbose)<font></font>
    <font></font>
    <span class="hljs-comment"># Call Scipy's Implementation of Differential Evolution</span><font></font>
    attack_result = differential_evolution(<font></font>
        predict_fn, bounds, maxiter=maxiter, popsize=popmul,<font></font>
        recombination=<span class="hljs-number">1</span>, atol=<span class="hljs-number">-1</span>, callback=callback_fn, polish=<span class="hljs-literal">False</span>)<font></font>
<font></font>
    <span class="hljs-comment"># Calculate some useful statistics to return from this function</span>
    attack_image = perturb_image(attack_result.x, x_test[img_id])[<span class="hljs-number">0</span>]<font></font>
    prior_probs = model.predict_one(x_test[img_id])<font></font>
    predicted_probs = model.predict_one(attack_image)<font></font>
    predicted_class = np.argmax(predicted_probs)<font></font>
    actual_class = y_test[img_id, <span class="hljs-number">0</span>]<font></font>
    success = predicted_class != actual_class<font></font>
    cdiff = prior_probs[actual_class] - predicted_probs[actual_class]<font></font>
<font></font>
    <span class="hljs-comment"># Show the best attempt at a solution (successful or not)</span><font></font>
    helper.plot_image(attack_image, actual_class, class_names, predicted_class)<font></font>
<font></font>
    <span class="hljs-keyword">return</span> [model.name, pixel_count, img_id, actual_class, predicted_class, success, cdiff, prior_probs, predicted_probs, attack_result.x]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨è¯¥åˆ†äº«ç ”ç©¶ï¼ˆæ”»å‡»ï¼‰çš„ç»“æœï¼Œçœ‹çœ‹ä»…æ”¹å˜ä¸€ä¸ªåƒç´ å¦‚ä½•å°†é’è›™å˜æˆç‹—ï¼Œå°†çŒ«å˜æˆé’è›™ï¼Œå°†æ±½è½¦å˜æˆé£æœºã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œå…è®¸æ›´æ”¹çš„å›¾åƒç‚¹è¶Šå¤šï¼ŒæˆåŠŸæ”»å‡»ä»»ä½•å›¾åƒçš„å¯èƒ½æ€§å°±è¶Šé«˜ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ga/mc/r2/gamcr2jr7fgitczf7wevptkafwa.png"><img src="https://habrastorage.org/webt/hc/df/xg/hcdfxgdnndfgcug3bb4hn9ij6xk.png"><img src="https://habrastorage.org/webt/qn/l_/zj/qnl_zjqfyz67jemvl5fewdbvvii.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½¿ç”¨resnetæ¨¡å‹æ¼”ç¤ºå¯¹é’è›™å›¾åƒçš„æˆåŠŸæ”»å‡»ã€‚</font><font style="vertical-align: inherit;">ç»è¿‡å‡ æ¬¡è¿­ä»£ï¼Œæˆ‘ä»¬åº”è¯¥å¯¹ç­çº§çš„çœŸæ­£å‡å°‘å……æ»¡ä¿¡å¿ƒã€‚</font></font><br>
<br>
<pre><code class="python hljs">image_id = <span class="hljs-number">102</span>
pixels = <span class="hljs-number">1</span> <span class="hljs-comment"># Number of pixels to attack</span><font></font>
model = resnet<font></font>
<font></font>
_ = attack(image_id, model, pixel_count=pixels, verbose=<span class="hljs-literal">True</span>)<font></font>
<font></font>
Confidence: <span class="hljs-number">0.9938618</span>
Confidence: <span class="hljs-number">0.77454716</span>
Confidence: <span class="hljs-number">0.77454716</span>
Confidence: <span class="hljs-number">0.77454716</span>
Confidence: <span class="hljs-number">0.77454716</span>
Confidence: <span class="hljs-number">0.77454716</span>
Confidence: <span class="hljs-number">0.53226393</span>
Confidence: <span class="hljs-number">0.53226393</span>
Confidence: <span class="hljs-number">0.53226393</span>
Confidence: <span class="hljs-number">0.53226393</span>
Confidence: <span class="hljs-number">0.4211318</span>
</code></pre><br>
<img src="https://habrastorage.org/webt/a2/bw/rh/a2bwrhij-hnpjshjqcpmigtisyi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™äº›æ˜¯éé’ˆå¯¹æ€§æ”»å‡»çš„ç¤ºä¾‹ï¼Œç°åœ¨æˆ‘ä»¬å°†è¿›è¡Œé’ˆå¯¹æ€§æ”»å‡»ï¼Œå¹¶é€‰æ‹©æˆ‘ä»¬å¸Œæœ›æ¨¡å‹å¯¹å›¾åƒè¿›è¡Œåˆ†ç±»çš„ç±»åˆ«ã€‚</font><font style="vertical-align: inherit;">è¯¥ä»»åŠ¡æ¯”ä¸Šä¸€ä¸ªä»»åŠ¡è¦å¤æ‚å¾—å¤šï¼Œå› ä¸ºæˆ‘ä»¬å°†ä½¿ç¥ç»ç½‘ç»œå°†èˆ¹çš„å›¾åƒåˆ†ç±»ä¸ºæ±½è½¦ï¼Œå°†é©¬çš„å›¾åƒåˆ†ç±»ä¸ºçŒ«ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yr/n5/sw/yrn5swb3-4bqoyfujgxz6dfdome.png"><img src="https://habrastorage.org/webt/li/cp/iy/licpiypraj8dcsuxolvh2etbdde.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸‹é¢æˆ‘ä»¬å°†å°è¯•è®©lenetå°†èˆ¹çš„å›¾åƒåˆ†ç±»ä¸ºæ±½è½¦ã€‚</font></font><br>
<br>
<pre><code class="python hljs">image_id = <span class="hljs-number">108</span>
target_class = <span class="hljs-number">1</span> <span class="hljs-comment"># Integer in range 0-9</span>
pixels = <span class="hljs-number">3</span><font></font>
model = lenet<font></font>
<font></font>
print(<span class="hljs-string">'Attacking with target'</span>, class_names[target_class])<font></font>
_ = attack(image_id, model, target_class, pixel_count=pixels, verbose=<span class="hljs-literal">True</span>)<font></font>
Attacking <span class="hljs-keyword">with</span> target automobile<font></font>
Confidence: <span class="hljs-number">0.044409167</span>
Confidence: <span class="hljs-number">0.044409167</span>
Confidence: <span class="hljs-number">0.044409167</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.081972085</span>
Confidence: <span class="hljs-number">0.081972085</span>
Confidence: <span class="hljs-number">0.081972085</span>
Confidence: <span class="hljs-number">0.081972085</span>
Confidence: <span class="hljs-number">0.1537778</span>
Confidence: <span class="hljs-number">0.1537778</span>
Confidence: <span class="hljs-number">0.1537778</span>
Confidence: <span class="hljs-number">0.22246778</span>
Confidence: <span class="hljs-number">0.23916133</span>
Confidence: <span class="hljs-number">0.25238588</span>
Confidence: <span class="hljs-number">0.25238588</span>
Confidence: <span class="hljs-number">0.25238588</span>
Confidence: <span class="hljs-number">0.44560355</span>
Confidence: <span class="hljs-number">0.44560355</span>
Confidence: <span class="hljs-number">0.44560355</span>
Confidence: <span class="hljs-number">0.5711696</span>
</code></pre><br>
<img src="https://habrastorage.org/webt/xi/ym/pn/xiympn3dd-xburofpy5tl34yybu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¤„ç†äº†å•ä¸ªæ”»å‡»æ¡ˆä¾‹åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œResNetçš„ä½“ç³»ç»“æ„æ”¶é›†ç»Ÿè®¡ä¿¡æ¯ï¼Œéå†æ¯ä¸ªæ¨¡å‹ï¼Œæ›´æ”¹æ¯ä¸ªå›¾åƒçš„1ã€3æˆ–5ä¸ªåƒç´ ã€‚</font><font style="vertical-align: inherit;">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†æœ€ç»ˆç»“è®ºï¼Œè€Œä¸ä¼šæ‰“æ‰°è¯»è€…ç†Ÿæ‚‰æ¯æ¬¡è¿­ä»£ï¼Œå› ä¸ºè¿™éœ€è¦å¤§é‡æ—¶é—´å’Œè®¡ç®—èµ„æºã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">attack_all</span>(<span class="hljs-params">models, samples=<span class="hljs-number">500</span>, pixels=(<span class="hljs-params"><span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span></span>), targeted=False, 
               maxiter=<span class="hljs-number">75</span>, popsize=<span class="hljs-number">400</span>, verbose=False</span>):</span><font></font>
    results = []<font></font>
    <span class="hljs-keyword">for</span> model <span class="hljs-keyword">in</span> models:<font></font>
        model_results = []<font></font>
        valid_imgs = correct_imgs[correct_imgs.name == model.name].img<font></font>
        img_samples = np.random.choice(valid_imgs, samples, replace=<span class="hljs-literal">False</span>)<font></font>
        <font></font>
        <span class="hljs-keyword">for</span> pixel_count <span class="hljs-keyword">in</span> pixels:
            <span class="hljs-keyword">for</span> i, img_id <span class="hljs-keyword">in</span> enumerate(img_samples):<font></font>
                print(<span class="hljs-string">'\n'</span>, model.name, <span class="hljs-string">'- image'</span>, img_id, <span class="hljs-string">'-'</span>, i+<span class="hljs-number">1</span>, <span class="hljs-string">'/'</span>, len(img_samples))<font></font>
                targets = [<span class="hljs-literal">None</span>] <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> targeted <span class="hljs-keyword">else</span> range(<span class="hljs-number">10</span>)<font></font>
                <font></font>
                <span class="hljs-keyword">for</span> target <span class="hljs-keyword">in</span> targets:
                    <span class="hljs-keyword">if</span> targeted:<font></font>
                        print(<span class="hljs-string">'Attacking with target'</span>, class_names[target])
                        <span class="hljs-keyword">if</span> target == y_test[img, <span class="hljs-number">0</span>]:
                            <span class="hljs-keyword">continue</span><font></font>
                    result = attack(img_id, model, target, pixel_count, <font></font>
                                    maxiter=maxiter, popsize=popsize, <font></font>
                                    verbose=verbose)<font></font>
                    model_results.append(result)<font></font>
                    <font></font>
        results += model_results<font></font>
        helper.checkpoint(results, targeted)<font></font>
    <span class="hljs-keyword">return</span> results<font></font>
<font></font>
untargeted = attack_all(models, samples=<span class="hljs-number">100</span>, targeted=<span class="hljs-literal">False</span>)<font></font>
<font></font>
targeted = attack_all(models, samples=<span class="hljs-number">10</span>, targeted=<span class="hljs-literal">False</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†æµ‹è¯•ç½‘ç»œä¿¡èª‰çš„å¯èƒ½æ€§ï¼Œå¼€å‘äº†ä¸€ç§ç®—æ³•ï¼Œå¹¶æµ‹é‡äº†å…¶å¯¹æ¨¡å¼è¯†åˆ«è§£å†³æ–¹æ¡ˆçš„é¢„æµ‹è´¨é‡çš„å½±å“ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬çœ‹çœ‹æœ€ç»ˆç»“æœã€‚</font></font><br>
<br>
<pre><code class="python hljs">untargeted, targeted = helper.load_results()<font></font>
<font></font>
columns = [<span class="hljs-string">'model'</span>, <span class="hljs-string">'pixels'</span>, <span class="hljs-string">'image'</span>, <span class="hljs-string">'true'</span>, <span class="hljs-string">'predicted'</span>, <span class="hljs-string">'success'</span>, <span class="hljs-string">'cdiff'</span>, <span class="hljs-string">'prior_probs'</span>, <span class="hljs-string">'predicted_probs'</span>, <span class="hljs-string">'perturbation'</span>]<font></font>
<font></font>
untargeted_results = pd.DataFrame(untargeted, columns=columns)<font></font>
targeted_results = pd.DataFrame(targeted, columns=columns)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸‹è¡¨æ˜¾ç¤ºï¼Œä½¿ç”¨ç²¾åº¦ä¸º0.9231çš„ResNetç¥ç»ç½‘ç»œï¼Œæ›´æ”¹å›¾åƒçš„å‡ ä¸ªåƒç´ ï¼Œæˆ‘ä»¬è·å¾—äº†å¾ˆå¥½çš„æˆåŠŸæ”»å‡»å›¾åƒç™¾åˆ†æ¯”ï¼ˆattack_success_rateï¼‰ã€‚</font></font><br>
<br>
<pre><code class="python hljs">helper.attack_stats(targeted_results, models, network_stats)<font></font>
Out[<span class="hljs-number">26</span>]:<font></font>
	model	accuracy   pixels	attack_success_rate<font></font>
<span class="hljs-number">0</span>	resnet	<span class="hljs-number">0.9231</span>	    <span class="hljs-number">1</span>	        <span class="hljs-number">0.144444</span>
<span class="hljs-number">1</span>	resnet	<span class="hljs-number">0.9231</span>	    <span class="hljs-number">3</span>	        <span class="hljs-number">0.211111</span>
<span class="hljs-number">2</span>	resnet	<span class="hljs-number">0.9231</span>	    <span class="hljs-number">5</span>	        <span class="hljs-number">0.222222</span><font></font>
<font></font>
helper.attack_stats(untargeted_results, models, network_stats)<font></font>
Out[<span class="hljs-number">27</span>]:<font></font>
	model	accuracy   pixels	attack_success_rate<font></font>
<span class="hljs-number">0</span>	resnet	<span class="hljs-number">0.9231</span>	   <span class="hljs-number">1</span>	        <span class="hljs-number">0.34</span>
<span class="hljs-number">1</span>	resnet	<span class="hljs-number">0.9231</span>	   <span class="hljs-number">3</span>	        <span class="hljs-number">0.79</span>
<span class="hljs-number">2</span>	resnet	<span class="hljs-number">0.9231</span>	   <span class="hljs-number">5</span>	        <span class="hljs-number">0.79</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨å®éªŒä¸­ï¼Œæ‚¨å¯ä»¥è‡ªç”±ä½¿ç”¨äººå·¥ç¥ç»ç½‘ç»œçš„å…¶ä»–ä½“ç³»ç»“æ„ï¼Œå› ä¸ºç›®å‰æœ‰å¾ˆå¤šä½“ç³»ç»“æ„ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ta/lw/tv/talwtvpnwkzp2od0p-8q9o28eli.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¥ç»ç½‘ç»œç”¨æ— å½¢çš„çº¿ç¨‹åŒ…å›´äº†ç°ä»£ä¸–ç•Œã€‚é•¿æœŸä»¥æ¥ï¼Œäººä»¬å·²ç»å‘æ˜äº†æœåŠ¡ï¼Œåœ¨è¿™äº›æœåŠ¡ä¸­ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨AIï¼ˆäººå·¥æ™ºèƒ½ï¼‰æ¥æ¥æ”¶ç»è¿‡å¤„ç†çš„ç…§ç‰‡ï¼Œè¿™äº›ç…§ç‰‡åœ¨é£æ ¼ä¸Šä¸ä¼Ÿå¤§è‰ºæœ¯å®¶çš„ä½œå“ç›¸ä¼¼ï¼Œè€Œå¦‚ä»Šï¼Œç®—æ³•æœ¬èº«å¯ä»¥ç»˜åˆ¶å›¾ç‰‡ï¼Œåˆ›ä½œéŸ³ä¹æ°ä½œï¼Œç¼–å†™ä¹¦ç±ç”šè‡³ç”µå½±è„šæœ¬ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¸å¦‚è®¡ç®—æœºè§†è§‰ï¼Œé¢éƒ¨è¯†åˆ«ï¼Œæ— äººé©¾é©¶è½¦è¾†ï¼Œç–¾ç—…è¯Šæ–­ç­‰é¢†åŸŸ-åšå‡ºé‡è¦å†³ç­–ä¸”æ— æƒçŠ¯é”™ï¼Œå¹²æ‰°ç®—æ³•çš„æ“ä½œå°†å¯¼è‡´ç¾éš¾æ€§åæœã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€åƒç´ æ”»å‡»æ˜¯æ¬ºéª—æ”»å‡»çš„ä¸€ç§æ–¹æ³•ã€‚</font><font style="vertical-align: inherit;">ä¸ºäº†æµ‹è¯•ç½‘ç»œä¿¡èª‰çš„å¯èƒ½æ€§ï¼Œå¼€å‘äº†ä¸€ç§ç®—æ³•ï¼Œå¹¶æµ‹é‡äº†å…¶å¯¹æ¨¡å¼è¯†åˆ«è§£å†³æ–¹æ¡ˆçš„é¢„æµ‹è´¨é‡çš„å½±å“ã€‚</font><font style="vertical-align: inherit;">ç»“æœè¡¨æ˜ï¼Œæ‰€åº”ç”¨çš„ç¥ç»ç½‘ç»œå·ç§¯ç»“æ„æ˜“å—ä¸“é—¨è®­ç»ƒçš„â€œä¸€åƒç´ æ”»å‡»â€ç®—æ³•çš„å½±å“ï¼Œè¯¥ç®—æ³•ä¼šæ›¿æ¢ä¸€ä¸ªåƒç´ ï¼Œä»è€Œä½¿è¯†åˆ«ç®—æ³•å¤±å»ä¿¡èª‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ¬æ–‡ç”±</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alexander Andronic</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adrey Cherny-Tkach</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½œä¸º</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®ä¹ çš„ä¸€éƒ¨åˆ†</font><b><font style="vertical-align: inherit;">ç¼–å†™</font></b><font style="vertical-align: inherit;">ã€‚</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN498094/index.html">æˆ‘ä»¬å¦‚ä½•å°†å…¬å¸å†…éƒ¨çš„æ‰€æœ‰å†…éƒ¨æ²Ÿé€šè½¬ç§»åˆ°åœ¨çº¿</a></li>
<li><a href="../zh-CN498096/index.html">å†…å­˜æ¼”ç¤ºå¦‚ä½•é€‚åˆ256å­—èŠ‚</a></li>
<li><a href="../zh-CN498100/index.html">è®¾è®¡Kubernetesé›†ç¾¤ï¼šåº”è¯¥æœ‰å¤šå°‘ä¸ªï¼Ÿ</a></li>
<li><a href="../zh-CN498104/index.html">å¦‚ä½•ä»100,000ç¾å…ƒå¼€å‘ç½‘ç«™</a></li>
<li><a href="../zh-CN498110/index.html">â€œå½“æµç¨‹ä¸­çš„å·¨å¤§å˜åŒ–æ¿€åŠ±å›¢é˜Ÿæ—¶è¯¥æ€ä¹ˆåŠã€‚â€ æˆä¸ºå›¢é˜Ÿè´Ÿè´£äººçš„åç«¯å·¥ç¨‹å¸ˆçš„ç»éªŒ</a></li>
<li><a href="../zh-CN498118/index.html">è¿œç¨‹ä¼šè®®ï¼šJUG Ru Groupçš„åœ¨çº¿è½¬å‹</a></li>
<li><a href="../zh-CN498120/index.html">æ„å»ºæ—¶é—´ä¼˜åŒ–-ç¬¬1éƒ¨åˆ†</a></li>
<li><a href="../zh-CN498122/index.html">å¦‚ä½•åœ¨è¿œç¨‹ç«™ç‚¹ä¸Šè¿›è¡Œæµ‹è¯•ï¼Œä»¥å…ç ´åäº§å“å’Œæ‚¨çš„ç”Ÿæ´»</a></li>
<li><a href="../zh-CN498124/index.html">æŠ€æœ¯æ”¯æŒç”µæŠ¥ï¼šå·¥å…·å’Œé™·é˜±</a></li>
<li><a href="../zh-CN498126/index.html">äºšé©¬é€Šå¦‚ä½•è¯•å›¾è®©äººä»¬è´­ä¹°...æ›´å°‘</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>