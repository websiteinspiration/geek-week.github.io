<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ–ï¸ ğŸ”§ ğŸ† Nano-Neuron-ãƒã‚·ãƒ³ãŒã€Œå­¦ç¿’ã€ã™ã‚‹æ–¹æ³•ã‚’ç¤ºã™7ã¤ã®å˜ç´”ãªJavaScripté–¢æ•° ğŸ™‡ğŸ» ğŸ“© ğŸŒ½</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ãƒŠãƒãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³ã¯ã€ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®æ¦‚å¿µã‹ã‚‰ã®ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³ã®ç°¡ç•¥åŒ–ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã™ã€‚ãƒŠãƒãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³ã¯æœ€ã‚‚å˜ç´”ãªã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œã—ã€æ¸©åº¦ã‚’æ‘‚æ°ã‹ã‚‰è¯æ°ã«å¤‰æ›ã™ã‚‹ã‚ˆã†ã«ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã•ã‚Œã¦ã„ã¾ã™ã€‚
 

NanoNeuron.jsã‚³ãƒ¼ãƒ‰ã¯ã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã€äºˆæ¸¬ã€ãƒ¢ãƒ‡ãƒ«ã‹ã‚‰ã®ä¿¡å·ã®é †æ–¹å‘ãŠã‚ˆã³é€†æ–¹...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Nano-Neuron-ãƒã‚·ãƒ³ãŒã€Œå­¦ç¿’ã€ã™ã‚‹æ–¹æ³•ã‚’ç¤ºã™7ã¤ã®å˜ç´”ãªJavaScripté–¢æ•°</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/479220/"><p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒŠãƒãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³</font></font></strong></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯</font><font style="vertical-align: inherit;">ã€ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®æ¦‚å¿µã‹ã‚‰ã®ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³ã®</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç°¡ç•¥åŒ–</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã™ã€‚</font><font style="vertical-align: inherit;">ãƒŠãƒãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³ã¯æœ€ã‚‚å˜ç´”ãªã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œã—ã€æ¸©åº¦ã‚’æ‘‚æ°ã‹ã‚‰è¯æ°ã«å¤‰æ›ã™ã‚‹ã‚ˆã†ã«ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã•ã‚Œã¦ã„ã¾ã™ã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NanoNeuron.js</font></font></strong></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ¼ãƒ‰</font><font style="vertical-align: inherit;">ã¯ã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã€äºˆæ¸¬ã€ãƒ¢ãƒ‡ãƒ«ã‹ã‚‰ã®ä¿¡å·ã®é †æ–¹å‘ãŠã‚ˆã³é€†æ–¹å‘ã®ä¼æ’­ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹7ã¤ã®å˜ç´”ãªJavaScripté–¢æ•°ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã‚‰ã®é–¢æ•°ã‚’ä½œæˆã™ã‚‹ç›®çš„ã¯ã€çµå±€ã®ã¨ã“ã‚ã€ãƒã‚·ãƒ³ãŒã€Œå­¦ç¿’ã€ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦æœ€å°é™ã®åŸºæœ¬çš„ãªèª¬æ˜ï¼ˆç›´æ„Ÿï¼‰ã‚’èª­è€…ã«æä¾›ã™ã‚‹ã“ã¨ã§ã—ãŸã€‚ã‚³ãƒ¼ãƒ‰ã¯ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¾ã›ã‚“ã€‚ã“ã¨ã‚ã–ã«ã‚ã‚‹ã‚ˆã†ã«ã€å˜ç´”ãªã€Œãƒãƒ‹ãƒ©ã€JavaScripté–¢æ•°ã ã‘ã§ã™ã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã‚Œã‚‰ã®é–¢æ•°ã¯ã€</font><font style="vertical-align: inherit;">æ©Ÿæ¢°å­¦ç¿’ã®å®Œå…¨ãªã‚¬ã‚¤ãƒ‰ã§</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚ã‚Š</font><strong><font style="vertical-align: inherit;">ã¾ã›ã‚“</font></strong><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å¤šãã®æ©Ÿæ¢°å­¦ç¿’ã®æ¦‚å¿µãŒçœç•¥ã¾ãŸã¯ç°¡ç•¥åŒ–ã•ã‚Œã¦ã„ã¾ã™ï¼</font><font style="vertical-align: inherit;">ã“ã®å˜ç´”åŒ–ã¯å”¯ä¸€ã®ç›®çš„ã§è¨±å¯ã•ã‚Œã¾ã™ã€‚ã¤ã¾ã‚Š</font><font style="vertical-align: inherit;">ã€æ©Ÿæ¢°ãŒåŸç†çš„ã«ã€Œå­¦ç¿’ã€ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦</font><font style="vertical-align: inherit;">æœ€ã‚‚</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŸºæœ¬çš„ãª</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç†è§£ã¨ç›´æ„Ÿã‚’</font><font style="vertical-align: inherit;">èª­è€…ã«æä¾›</font><font style="vertical-align: inherit;">ã™ã‚‹ã“ã¨ã§ã™ã€‚ãã®çµæœã€ã€Œæ©Ÿæ¢°å­¦ç¿’ã®ãƒã‚¸ãƒƒã‚¯ã€ã¯ã€Œæ©Ÿæ¢°å­¦ç¿’ã®æ•°å­¦ã€ã¨ã—ã¦èª­è€…ã«ã¾ã™ã¾ã™èã“ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</font></font></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/98d/6c4/69e/98d6c469e1facbf97154fe29f698cd12.png" alt="ãƒŠãƒãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³"></p><a name="habracut"></a><br>
<h2 id="chto-vyuchit-nash-nano-neyron"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒŠãƒãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³ãŒã€Œå­¦ç¿’ã€ã™ã‚‹ã‚‚ã®</font></font></h2><br>
<p>, ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> </a>. -      .         .          -.       -            .      <strong></strong>          .</p><br>
<p>,           :</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/9fa/2e8/8b5/9fa2e88b5a7324c8b9fc359b274ba091.png" alt="æ‘‚æ°ã‹ã‚‰è¯æ°"></p><br>
<p>     -      ...</p><br>
<h3 id="model-nano-neyrona"> -</h3><br>
<p>   ,    -.         <code>x</code>  <code>y</code>,    : <code>y = w * x + b</code>.  ,  - â€”  ,         <code>XY</code>.</p><br>
<p> <code>w</code>  <code>b</code>  <strong></strong> . -       .   -   ,   -       ().</p><br>
<p> ,  -      â€”    .      <code>predict()</code>,    <code>x</code>      <code>y</code>  .  .</p><br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">NanoNeuron</span>(<span class="hljs-params">w, b</span>) </span>{
  <span class="hljs-keyword">this</span>.w = w;
  <span class="hljs-keyword">this</span>.b = b;
  <span class="hljs-keyword">this</span>.predict = <span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> x * <span class="hljs-keyword">this</span>.w + <span class="hljs-keyword">this</span>.b;<font></font>
  }<font></font>
}</code></pre><br>
<p>_(â€¦ â€¦ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> </a>  ,  ?)_</p><br>
<h3 id="konvertaciya-gradusov-celsiya-v-gradusy-farengeyta">     </h3><br>
<p>           : <code>f = 1.8 * c + 32</code>,  <code>c</code> â€”      <code>f</code> â€”    .</p><br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">celsiusToFahrenheit</span>(<span class="hljs-params">c</span>) </span>{
  <span class="hljs-keyword">const</span> w = <span class="hljs-number">1.8</span>;
  <span class="hljs-keyword">const</span> b = <span class="hljs-number">32</span>;
  <span class="hljs-keyword">const</span> f = c * w + b;
  <span class="hljs-keyword">return</span> f;<font></font>
};</code></pre><br>
<p>   ,   -     .      (),   <code>w = 1.8</code>  <code>b = 32</code>     .</p><br>
<p>      .     Â«Â»  - Â«Â»: </p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/68b/0d6/8bc/68b0d68bcc7be00ec9526867b2fcecf3.png" alt="æ‘‚æ°ã‹ã‚‰è¯æ°ã¸ã®å¤‰æ›"></p><br>
<h3 id="generirovanie-dannyh"> </h3><br>
<p>        (<code>x</code>)      ( <code>w</code>  <code>b</code>),     (<code>y</code>).           .     ,       (<code>x</code>  <code>y</code>),      <code>x</code>  <code>y</code>  ( <code>w</code>  <code>b</code>).</p><br>
<p>         .      <strong></strong>      <strong></strong> .     - <code>celsiusToFahrenheit()</code>.            <code>x</code>  <code>y</code>. ,  <code>x = 2</code>,  <code>y = 35,6</code>   .</p><br>
<blockquote>  ,  ,  -  <em></em>,   <em>c</em>. ,        Â« Â» --&gt; Â« Â».</blockquote><p>         -.                  Â«Â»,   Â«Â»  Â«Â»    .</p><br>
<blockquote>,      Â«   â€”   Â».  -     Â«Â»,  5Â°C   1000Â°F,                 <strong></strong> 5Â°C.         ,         .</blockquote><p>. .</p><br>
<p>        ,   -          ,        . </p><br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generateDataSets</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// xTrain -&gt; [0, 1, 2, ...],</span>
  <span class="hljs-comment">// yTrain -&gt; [32, 33.8, 35.6, ...]</span>
  <span class="hljs-keyword">const</span> xTrain = [];
  <span class="hljs-keyword">const</span> yTrain = [];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> x = <span class="hljs-number">0</span>; x &lt; <span class="hljs-number">100</span>; x += <span class="hljs-number">1</span>) {
    <span class="hljs-keyword">const</span> y = celsiusToFahrenheit(x);<font></font>
    xTrain.push(x);<font></font>
    yTrain.push(y);<font></font>
  }<font></font>
<font></font>
  <span class="hljs-comment">// xTest -&gt; [0.5, 1.5, 2.5, ...]</span>
  <span class="hljs-comment">// yTest -&gt; [32.9, 34.7, 36.5, ...]</span>
  <span class="hljs-keyword">const</span> xTest = [];
  <span class="hljs-keyword">const</span> yTest = [];
  <span class="hljs-comment">//   0.5    1,       </span>
  <span class="hljs-comment">//   ,       .</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> x = <span class="hljs-number">0.5</span>; x &lt; <span class="hljs-number">100</span>; x += <span class="hljs-number">1</span>) {
    <span class="hljs-keyword">const</span> y = celsiusToFahrenheit(x);<font></font>
    xTest.push(x);<font></font>
    yTest.push(y);<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">return</span> [xTrain, yTrain, xTest, yTest];<font></font>
}</code></pre><br>
<h3 id="ocenka-pogreshnosti-predskazaniy">  </h3><br>
<p>    (, , ),      -  .    //  ,  -   .    ,        <code>5</code>  <code>2</code>.</p><br>
<p>   -   ()    <code>y</code>    <code>prediction</code>    :</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/8d8/e50/ac1/8d8e50ac12d03614e65975f7b5d36931.png" alt="äºˆæ¸¬ã‚³ã‚¹ãƒˆ"></p><br>
<p>       ,      .      ,    .        ,    ,    <code>(1 - 2) ^ 2</code>   <code>(2 - 1) ^ 2</code>.   <code>2</code>    ,            (  ).</p><br>
<p>        :</p><br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">predictionCost</span>(<span class="hljs-params">y, prediction</span>) </span>{
  <span class="hljs-keyword">return</span> (y - prediction) ** <span class="hljs-number">2</span> / <span class="hljs-number">2</span>; <span class="hljs-comment">// i.e. -&gt; 235.6</span>
}</code></pre><br>
<h3 id="pryamoe-rasprostranenie-signala">  </h3><br>
<p>                 <code>xTrain</code>  <code>yTrain</code>     ()  .</p><br>
<p> -   - Â«Â»,     ( ).   -       .          /     .     ,    <code>w</code>  <code>b</code>      ,       - Â«Â»     .</p><br>
<p>   -     :</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/575/db3/e0a/575db3e0a0c872b29582147e41231344.png" alt="å¹³å‡è²»ç”¨"></p><br>
<p> <code>m</code> â€”    (     <code>100</code>  ).</p><br>
<p>       :</p><br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">forwardPropagation</span>(<span class="hljs-params">model, xTrain, yTrain</span>) </span>{
  <span class="hljs-keyword">const</span> m = xTrain.length;
  <span class="hljs-keyword">const</span> predictions = [];
  <span class="hljs-keyword">let</span> cost = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; m; i += <span class="hljs-number">1</span>) {
    <span class="hljs-keyword">const</span> prediction = nanoNeuron.predict(xTrain[i]);<font></font>
    cost += predictionCost(yTrain[i], prediction);<font></font>
    predictions.push(prediction);<font></font>
  }<font></font>
  <span class="hljs-comment">//     .</span><font></font>
  cost /= m;<font></font>
  <span class="hljs-keyword">return</span> [predictions, cost];<font></font>
}</code></pre><br>
<h3 id="obratnoe-rasprostranenie-signala">  </h3><br>
<p>,      -       (    ),       ?</p><br>
<p>      .    â€”     -      <code>w</code>  <code>b</code> ,    -       - .</p><br>
<p>       .    â€”  <strong> </strong>,            ,      (      ).</p><br>
<p>   -      (.  ).       <code>w</code>  <code>b</code>        ,    ,   -        .</p><br>
<p> â€”     ,       . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">MathIsFun</a> â€”  ,      .</p><br>
<p> ,                  â€”  ,       <code>x</code>  <code>y</code>,   ,           <code>x</code>  <code>y</code>  <em>      </em>.</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/66d/bfd/49a/66dbfd49aaf1ced48d7f6b5917fddb12.svg" alt="å¾®åˆ†å‹¾é…"></p><br>
<p><em>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">MathIsFun</a></em></p><br>
<p>,   ,  ,    <code>(x=2, y=4)</code>    ,    <code></code>  <code></code>,     .   ,     ,        .</p><br>
<p>     <code>averageCost</code>   <code>w</code>  <code>b</code>    :</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/4cc/bda/ba1/4ccbdaba120c399c1528e2bc38cf0efd.png" alt="dW"></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/e02/0cb/125/e020cb125449849009a9f565a32ff46f.png" alt="dB"></p><br>
<p> <code>m</code> â€”    (     <code>100</code>  ).</p><br>
<p><em>      ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"></a>.</em></p><br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">backwardPropagation</span>(<span class="hljs-params">predictions, xTrain, yTrain</span>) </span>{
  <span class="hljs-keyword">const</span> m = xTrain.length;
  <span class="hljs-comment">//           'w'  'b'.</span>
  <span class="hljs-comment">//      0.</span>
  <span class="hljs-keyword">let</span> dW = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">let</span> dB = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; m; i += <span class="hljs-number">1</span>) {<font></font>
    dW += (yTrain[i] - predictions[i]) * xTrain[i];<font></font>
    dB += yTrain[i] - predictions[i];<font></font>
  }<font></font>
  <span class="hljs-comment">//    .</span><font></font>
  dW /= m;<font></font>
  dB /= m;<font></font>
  <span class="hljs-keyword">return</span> [dW, dB];<font></font>
}</code></pre><br>
<h3 id="trenirovka-modeli"> </h3><br>
<p>  ,   /    -     (  ).    ,     <code>w</code>  <code>b</code>  - (  ),    .   ,            ,       ,          .         . /     ,   ,   ,    .</p><br>
<p>,   <em></em>       .  -    <code>trainModel()</code>.   Â«Â»    -:</p><br>
<ul>
<li>    (<code>epochs</code>)      -,   ,</li>
<li>     (<code>xTrain</code>  <code>yTrain</code>  )  ,</li>
<li>   Â«Â»   ()   <code>alpha</code>,      .</li>
</ul><br>
<p>    <code>alpha</code>.  -  ()    <code>dW</code>  <code>dB</code>,        . ,         (      <code>dW</code>  <code>dB</code>).              (      <code>dW</code>  <code>dB</code>).        <code>alpha</code>,        (  ). ,        <code>alpha</code>,      ,    <em></em>  ,    .</p><br>
<p>   Â«Â»,       Â«-Â» ,     , ,        ,    Â«-Â»             .</p><br>
<p>      <code>w</code>  <code>b</code>  :</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/c7b/db8/84f/c7bdb884f2a940d62332246cdbcb44bc.png" alt="w"></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/b57/622/0ab/b576220ab6515d44255ef56699077bab.png" alt="b"></p><br>
<p>     :</p><br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">trainModel</span>(<span class="hljs-params">{model, epochs, alpha, xTrain, yTrain}</span>) </span>{
  <span class="hljs-comment">//     -.  .</span>
  <span class="hljs-keyword">const</span> costHistory = [];<font></font>
<font></font>
  <span class="hljs-comment">//    () </span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> epoch = <span class="hljs-number">0</span>; epoch &lt; epochs; epoch += <span class="hljs-number">1</span>) {
    <span class="hljs-comment">//   .</span>
    <span class="hljs-keyword">const</span> [predictions, cost] = forwardPropagation(model, xTrain, yTrain);<font></font>
    costHistory.push(cost);<font></font>
<font></font>
    <span class="hljs-comment">//   .</span>
    <span class="hljs-keyword">const</span> [dW, dB] = backwardPropagation(predictions, xTrain, yTrain);<font></font>
<font></font>
    <span class="hljs-comment">//    -,    .</span><font></font>
    nanoNeuron.w += alpha * dW;<font></font>
    nanoNeuron.b += alpha * dB;<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">return</span> costHistory;<font></font>
}</code></pre><br>
<h3 id="soberem-vse-funkcii-vmeste">   </h3><br>
<p>      .</p><br>
<p>   -.    -     ,     <code>w</code>  <code>b</code>.     <code>w</code>  <code>b</code>  .</p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> w = <span class="hljs-built_in">Math</span>.random(); <span class="hljs-comment">// i.e. -&gt; 0.9492</span>
<span class="hljs-keyword">const</span> b = <span class="hljs-built_in">Math</span>.random(); <span class="hljs-comment">// i.e. -&gt; 0.4570</span>
<span class="hljs-keyword">const</span> nanoNeuron = <span class="hljs-keyword">new</span> NanoNeuron(w, b);</code></pre><br>
<p>     .</p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> [xTrain, yTrain, xTest, yTest] = generateDataSets();</code></pre><br>
<p>         (<code>0.0005</code>)   <code>70000</code> .      ,    .</p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> epochs = <span class="hljs-number">70000</span>;
<span class="hljs-keyword">const</span> alpha = <span class="hljs-number">0.0005</span>;
<span class="hljs-keyword">const</span> trainingCostHistory = trainModel({<span class="hljs-attr">model</span>: nanoNeuron, epochs, alpha, xTrain, yTrain});</code></pre><br>
<p>,         .  ,         ,   .   ,   - .     ,   ,     (     <code>alpha</code>).</p><br>
<pre><code class="javascript hljs"><span class="hljs-built_in">console</span>.log(<span class="hljs-string">'  :'</span>, trainingCostHistory[<span class="hljs-number">0</span>]); <span class="hljs-comment">// i.e. -&gt; 4694.3335043</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'  :'</span>, trainingCostHistory[epochs - <span class="hljs-number">1</span>]); <span class="hljs-comment">// i.e. -&gt; 0.0000024</span></code></pre><br>
<p>         .   <code>x</code>   ( ). ,    .</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/191/860/d6f/191860d6f0cd8cf7d24127f04f779462.png" alt="ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ—ãƒ­ã‚»ã‚¹"></p><br>
<p>   ,   Â«Â»  -. ,   <code>w</code>  <code>b</code>        <code>celsiusToFahrenheit()</code> (<code>w = 1.8</code>  <code>b = 32</code>),     -  .</p><br>
<pre><code class="javascript hljs"><span class="hljs-built_in">console</span>.log(<span class="hljs-string">' -:'</span>, {<span class="hljs-attr">w</span>: nanoNeuron.w, <span class="hljs-attr">b</span>: nanoNeuron.b}); <span class="hljs-comment">// i.e. -&gt; {w: 1.8, b: 31.99}</span></code></pre><br>
<p> , -     <code>celsiusToFahrenheit()</code>.</p><br>
<p>        -   ,       .              .   ,  -                (     ). </p><br>
<pre><code class="javascript hljs">[testPredictions, testCost] = forwardPropagation(nanoNeuron, xTest, yTest);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'   :'</span>, testCost); <span class="hljs-comment">// i.e. -&gt; 0.0000023</span></code></pre><br>
<p>,   Â«-Â»    Â«Â»              ,    ,      Â«Â».           ,        .</p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> tempInCelsius = <span class="hljs-number">70</span>;
<span class="hljs-keyword">const</span> customPrediction = nanoNeuron.predict(tempInCelsius);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`- "",  <span class="hljs-subst">${tempInCelsius}</span>Â°C   :`</span>, customPrediction); <span class="hljs-comment">// -&gt; 158.0002</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'  :'</span>, celsiusToFahrenheit(tempInCelsius)); <span class="hljs-comment">// -&gt; 158</span></code></pre><br>
<p> !   ,  - â€” ,    :)</p><br>
<p> !</p><br>
<h2 id="kak-zapustit-i-protestirovat-nano-neyron">    -</h2><br>
<p>      - :</p><br>
<pre><code class="bash hljs">git <span class="hljs-built_in">clone</span> https://github.com/trekhleb/nano-neuron.git
<span class="hljs-built_in">cd</span> nano-neuron</code></pre><br>
<pre><code class="bash hljs">node ./NanoNeuron.js</code></pre><br>
<h2 id="upuschennye-koncepcii"> </h2><br>
<p>          .</p><br>
<p><strong>     </strong></p><br>
<p>       .                    70/30.          .      (, ),              90/10  95/5. </p><br>
<p><strong>  </strong></p><br>
<p>    ,   -  .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"></a>  .        .</p><br>
<p>    ,  -      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> </a>,    .</p><br>
<p><strong>  </strong></p><br>
<p>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">  </a>.</p><br>
<p><strong> </strong></p><br>
<p>    ()    ,     <code>for</code>.              ,  Python  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">Numpy</a>.</p><br>
<p><strong>  </strong></p><br>
<p> ,     -  .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> </a>.                 .</p><br>
<p><strong> </strong></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šå¸¸ã€ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³ã®å‡ºåŠ›å€¤ã¯ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ã‚·ãƒ§ãƒ³é–¢æ•°ã‚’é€šéã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¯ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sigmoid</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReLU</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãªã©ã®æ©Ÿèƒ½ã‚’ä½¿ç”¨ã§ãã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja479202/index.html">C ++ã¨æ•°å€¤ãƒ¡ã‚½ãƒƒãƒ‰ï¼šè¿‘ä¼¼ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³ã‚³ãƒ¼ãƒˆç©åˆ†</a></li>
<li><a href="../ja479210/index.html">2020å¹´1æœˆ1æ—¥ã‹ã‚‰æµ·å¤–ã®ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ãƒˆã‚¢ã§ã®è³¼å…¥ã¯ã©ã†ãªã‚Šã¾ã™ã‹</a></li>
<li><a href="../ja479214/index.html">ãƒ¢ã‚¹ã‚¯ãƒ¯ã®é–‹ç™ºè€…å‘ã‘ã®ä»Šå¾Œã®ç„¡æ–™ã‚¤ãƒ™ãƒ³ãƒˆã®é¸æŠï¼ƒ2</a></li>
<li><a href="../ja479216/index.html">ã‚»ã‚«ãƒ³ãƒ‰ã‚¦ã‚£ãƒ³ãƒ‰ãƒ‘ãƒ³ãƒ‰ãƒ©DXL 3000ã€ã¾ãŸã¯è‡ªåˆ†ã®ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªã‚’ã­ã˜è¾¼ã‚€æ–¹æ³•</a></li>
<li><a href="../ja479218/index.html">å†™çœŸã‚’æ¼«ç”»ã«å¤‰ãˆã‚‹ãƒœãƒƒãƒˆã‚’ä½œã‚‹æ–¹æ³•ï¼šãƒ€ãƒŸãƒ¼ã®ãŸã‚ã®ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã®èª¬æ˜</a></li>
<li><a href="../ja479222/index.html">ãƒ¢ãƒã‚¤ãƒ«ï¼ƒ325é–‹ç™ºè€…å‘ã‘ã®èˆˆå‘³æ·±ã„è³‡æ–™ã®ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆï¼ˆ12æœˆ2ã€œ8æ—¥ï¼‰</a></li>
<li><a href="../ja479226/index.html">Habråˆ†æï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒHabrã‹ã‚‰ã‚®ãƒ•ãƒˆã¨ã—ã¦æ³¨æ–‡ã™ã‚‹ã‚‚ã®</a></li>
<li><a href="../ja479232/index.html">Spring Bootã§ã®MQ JMSã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™º</a></li>
<li><a href="../ja479234/index.html">OpenStreetMap No. 488ã®ä¸–ç•Œã‹ã‚‰ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ï¼ˆ11/19/2019-11/25/2019ï¼‰</a></li>
<li><a href="../ja479236/index.html">ã‚­ãƒ“ãƒ¼ã€‚Androidç”¨ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½œæˆã—ã€é­”æ³•ã¯ãªã„</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>