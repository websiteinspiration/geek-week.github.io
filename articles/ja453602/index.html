<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⤴️ 🚄 🙃 データベースはKubernetesにありますか？ 🧛🏾 👩🏽‍✈️ 💡</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="どういうわけか、IT業界は何らかの理由で、賛成と反対の2つの条件付きキャンプに分かれていることが歴史的に起こりました。さらに、論争の対象は完全に恣意的である可能性があります。どちらのOSが良いですか：WinまたはLinux？ AndroidまたはiOSスマートフォンの場合すべてをクラウドに保管するか...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>データベースはKubernetesにありますか？</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/itsumma/blog/453602/"><img src="https://habrastorage.org/webt/iq/xw/bx/iqxwbxcjzz4tipitwhcc-_mqe5q.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
どういうわけか、IT業界は何らかの理由で、賛成と反対の2つの条件付きキャンプに分かれていることが歴史的に起こりました。さらに、論争の対象は完全に恣意的である可能性があります。どちらのOSが良いですか：WinまたはLinux？ AndroidまたはiOSスマートフォンの場合すべてをクラウドに保管するか、コールドRAIDストレージにアップロードしてネジを金庫に入れますか？ PHPシュニックにはプログラマーと呼ばれる権利がありますか？これらの論争は、時として、本質的に排他的に存在するものであり、スポーツへの関心以外に根拠がない。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たまたま起こったのは、コンテナと、Dockerと条件付きk8を備えたこの愛されているすべてのキッチンの出現で、バックエンドのさまざまな領域での新しい機会の「使用」と「反対」の論争が始まりました。 （このディスカッションでは、ほとんどの場合Kubernetesがオーケストラとして示されますが、この楽器の選択は重要ではありません。代わりに、最も便利で使い慣れていると思われる他の楽器を代用することができます。）</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、それは、それは同じコインの両面についての単純な議論になるようです。</font><font style="vertical-align: inherit;">永遠の対立Win vs Linuxと同じくらい無意味で無慈悲で、その間に適切な人々が自分自身のためにかなり存在しています。</font><font style="vertical-align: inherit;">これは、コンテナー化がそれほど単純ではない場合です。</font><font style="vertical-align: inherit;">通常、このような論争には正しい側面はありませんが、データベースを格納するための「適用」または「適用しない」コンテナの場合、すべてが逆さまになります。</font><font style="vertical-align: inherit;">ある意味では、そのようなアプローチの支持者と反対者の両方が正しいからです。</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">明るい面</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「こんにちは、窓の外の2k19！」という1つのフレーズでブライトサイドの議論を簡単に説明できます。もちろんポピュリズムのように聞こえますが、状況を詳細に掘り下げると、利点があります。それらを分析します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
大規模なWebプロジェクトがあるとします。最初はマイクロサービスアプローチに基づいて構築することもできますが、ある時点で進化的な方法で彼に到達しました。これは実際にはあまり重要ではありません。私たちのプロジェクトを個別のマイクロサービス、構成されたオーケストレーション、負荷分散、スケーリングに分散させました。そして今、明確な良心をもって、倒れたサーバーを持ち上げるのではなく、ハンブラー効果の間にハンモックでモヒートを飲みます。しかし、すべてのアクションは一貫している必要があります。多くの場合、アプリケーション自体のみがコンテナ化されます-コード。コードの他に何があるか？</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そう、データ。プロジェクトの中心となるのはデータです。MySQL、Postgre、MongoDBなどの一般的なDBMS、または検索に使用されるストレージ（ElasticSearch）、キャッシュ用のKey-Valueストレージ（redisなど）のいずれかになります。現在は、クエリの記述が不十分なためにデータベースがクラッシュした場合の曲がったバックエンド実装オプションについて説明します。代わりに、クライアントの負荷がかかった状態でこのデータベースにフォールトトレランスを提供する方法について説明します。結局のところ、アプリケーションをコンテナ化し、それを自由にスケーリングして任意の数の着信要求を処理できるようにすると、当然、データベースの負荷が増加します。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、データベースとデータベースが回転するサーバーにアクセスするためのチャネルは、コンテナー化された美しいバックエンドの針の目となります。同時に、コンテナの仮想化の主な動機は構造の移動性と柔軟性であり、これにより、利用可能なインフラストラクチャ全体でピーク負荷の分散を可能な限り効率的に編成することが可能になります。つまり、システムのすべての利用可能な要素をコンテナ化してロールに入れないと、非常に深刻な間違いを犯します。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーション自体だけでなく、データストレージを担当するサービスもクラスタ化する方がはるかに論理的です。独立して機能し、k8sのWebサーバーの負荷を分散してクラスタリングおよびデプロイする場合、データ同期の問題は既に解決されています。たとえば、ある種のメディアまたはブログプラットフォームを例にとると、投稿に対する同じコメントです。いずれの場合も、ExternalServiceとしてのデータベースの仮想的な表現でさえ、クラスター内を開始します。問題は、データベース自体がまだクラスター化されていないことです。キューブにデプロイされたWebサーバーは、個別にローテーションする静的な戦闘ベースから変更に関する情報を取得します。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
キャッチを感じますか？負荷を分散し、メインWebサーバーのフォールを回避するために、k8sまたはSwarmを使用しますが、データベースではこれを行いません。しかし結局のところ、データベースがクラッシュした場合、クラスター化されたインフラストラクチャ全体では意味がありません。データベースへのアクセスエラーを返す空のWebページの使用は何ですか。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのため、通常のようにWebサーバーだけでなく、データベースインフラストラクチャもクラスタ化する必要があります。このようにして初めて、同じ構造の要素が1つのチームで完全に機能することを保証できますが、同時に互いに独立しています。同時に、負荷がかかっているバックエンドの半分が「崩壊」しても、残りは存続し、クラスター内のデータベース同期システムとクラスターの無限のスケーリングと展開の可能性は、必要な容量にすばやく到達するのに役立ちます-データセンターにラックがあります。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、クラスターに分散されたデータベースモデルを使用すると、この同じデータベースを必要な場所に移動できます。グローバルサービスについて話している場合、サンフランシスコ地域のどこかでWebクラスターをひねり、同時にモスクワ地域のデータベースにアクセスするときにパッケージを駆動することは、その逆です。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、データベースのコンテナー化により、システムのすべての要素を同じ抽象化レベルで構築できます。これにより、管理者が積極的に関与することなく、開発者がコードから直接このシステムを制御できるようになります。開発者は、新しいサブプロジェクト用に個別のDBMSが必要だと思っていました-簡単です！ yamlファイルを書き込み、クラスターにアップロードすれば完了です。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、内部操作は大幅に簡略化されています。教えてください、チームの新しいメンバーが仕事のために戦闘データベースに手を押し込んだ瞬間に何回目を細めましたか？実際、どれが現在回転していますか？もちろん、私たち全員が大人で、どこかに新しいバックアップがあり、さらに-おばあちゃんのキュウリと古いスキー板のある棚の後ろに-別のバックアップがあります。これは、オフィスが火事になったためです。しかし、それでも、戦闘インフラストラクチャ、そしてもちろん、戦闘データベースへのアクセス権を持つチームの新しいメンバーが登場するたびに、周りの誰にとっても有効なバケツになります。まあ、初心者は誰が知っているでしょう、たぶん彼は目を細めていますか？怖い、同意する。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンテナー化、そして実際、プロジェクトの分散物理データベーストポロジは、そのような有効な瞬間を回避するのに役立ちます。</font><font style="vertical-align: inherit;">初心者を信用しませんか？</font><font style="vertical-align: inherit;">はい </font><font style="vertical-align: inherit;">仕事のために彼自身のクラスターを持ち上げ、残りのデータベースクラスターから切断します-手動プッシュによる同期と2つのキーの同期ローテーション（1人のチームリーダー、2人目の管理者）。</font><font style="vertical-align: inherit;">そして、誰もが幸せです。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして今こそ、データベースのコンテナー化の反対者たちの立場を変える時です。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">暗黒面</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データベースをコンテナ化して1つの中央サーバーでローテーションし続ける必要がない理由を主張して、正統派のレトリックに屈することはなく、「祖父がハードウェア上でデータベースをオンにしたなら、私たちはやります！」代わりに、コンテナ化が実際に具体的な利益をもたらす状況を考えてみましょう。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンテナ内のベースが本当に必要なプロジェクトは、片手で数えることができるので、フライス盤の最高のオペレータではないことを認めなければなりません。ほとんどの場合、k8やDocker Swarmの使用でさえ冗長です-テクノロジーの一般的な誇大宣伝の性質と、性別の面ではすべてがクラウドとコンテナに駆り立てられる「最も強力な」ツールであるため、これらのツールに頼ることがよくあります。さて、今はファッショナブルで誰もがそれをしているので。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
少なくとも半分の場合、プロジェクトでkubernetisまたはdockerを使用することは冗長です。問題は、クライアントのインフラストラクチャのサービスを提供するために雇われたすべてのチームまたはアウトソーシング企業がこれを認識しているわけではないことです。悪い-コンテナが課されたとき、それはクライアントに一定量の硬貨で上昇するからです。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般的に、docker / mafia cubeは、これらのインフラストラクチャの問題を外部委託しているクライアントを愚かに押しつぶしているという意見があります。実際、クラスターを操作するには、これを実行でき、実装されたソリューションのアーキテクチャーを一般的に理解しているエンジニアが必要です。私たちはかつて共和国版のケースについて説明しました-そこで私たちはクライアントチームにkubernetisの現実で働くように訓練しました、そして誰もが満足しました。そしてそれはまともだった。多くの場合、k8の「実装者」はクライアントのインフラストラクチャを人質に取ります。今では、すべてがどのように機能するかを理解しているだけで、クライアント側に専門家はいません。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようにして、アウトソーシングにWebサーバーの一部だけでなく、データベースのメンテナンスも提供するとします。 DBは心臓であり、心臓の喪失はあらゆる生物にとって致命的であると述べました。要するに、見通しは最良ではありません。そのため、誇大広告であるkubernetisの代わりに、多くのプロジェクトが通常のAWSの関税に狂わず、ウェブサイト/プロジェクトの負荷に関するすべての問題を解決します。しかし、AWSはもはやファッショナブルではなく、披露はお金よりも高価です-残念ながら、IT環境でも。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
はいおそらく、プロジェクトには実際にクラスタリングが必要ですが、ステートレスアプリケーションですべてが明らかな場合、クラスター化されたデータベースのネットワーク接続の適切なプロビジョニングをどのように構成できますか？</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
k8sへの移行のように見えるシームレスなエンジニアリングソリューションについて話している場合、主な問題はクラスター化されたデータベースでのデータ複製です。一部のDBMSは、最初は個々のインスタンス間でのデータの配布に非常に忠実です。他の多くはそれほど歓迎されていません。そして、かなり頻繁に、私たちのプロジェクトにDBMSを選択する際の主な議論は、最小限のリソースとエンジニアリングコストで複製する能力ではありません。特に、プロジェクトが元々マイクロサービスとして計画されていなかったが、単にこの方向に発展した場合。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ネットワークドライブの速度について話す必要はありません-それらは遅いです。それら。まだ、実際の可能性はありません。その場合、DBMSインスタンスをどこかにアップグレードすることはできません。たとえば、プロセッサの容量やRAMの空き容量などです。仮想化ディスクサブシステムのパフォーマンスがすぐに発生します。したがって、DBMSは、近接する独自のマシンセットに釘付けにする必要があります。または、予想される予備のデータの同期を十分に高速に分離する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
仮想FSのテーマの継続：残念ながら、Dockerボリュームは手間がかかりません。一般に、長期的に信頼できるデータストレージなどの場合は、可能な限り単純な技術スキームを使用したいと思います。また、FSコンテナーから親ホストFSに新しい抽象化レイヤーを追加すること自体がリスクです。しかし、コンテナ化サポートシステムの運用において、これらのレイヤー間でデータを送信することも困難である場合、それは本当に災害です。現在、進歩的な人類に知られている問題のほとんどは根絶されているようです。しかし、ご存じのとおり、メカニズムが複雑になればなるほど、簡単に壊れてしまいます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらすべての「冒険」に照らして、データベースを1か所に保持する方がはるかに収益性が高く、簡単です。アプリケーションのコンテナー化が必要な場合でも、アプリケーションを単独でスピンさせ、ディストリビューションゲートウェイを介して、データベースとの同時通信を受信します。一つの場所へ。</font><font style="vertical-align: inherit;">このアプローチにより、エラーや誤同期の可能性が最小限に抑えられます。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは何に向かっていますか？</font><font style="vertical-align: inherit;">さらに、データベースのコンテナ化は、本当に必要な場合に適しています。</font><font style="vertical-align: inherit;">完全なアプリベースを詰め込んで、20のマイクロサービスがあるかのようにひねることはできません。これは機能しません。</font><font style="vertical-align: inherit;">そして、これは明確に理解されなければなりません。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">出力の代わりに</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「データベースを仮想化するかどうか」というわかりやすい結論を待っている場合は、残念ですが、ここにはありません。</font><font style="vertical-align: inherit;">インフラストラクチャソリューションを作成するときは、流行や進歩によって導かれるのではなく、まず第一に常識によるものだからです。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kubernetisに付属する原則とツールが完全に適合するプロジェクトがあり、そのようなプロジェクトでは、少なくともバックエンド領域に平和がもたらされます。</font><font style="vertical-align: inherit;">また、コンテナ化を必要としないプロジェクトもありますが、通常のサーバーインフラストラクチャです。これは、プロジェクトが落ちるため、基本的にマイクロサービスクラスターモデルに再スケーリングできないためです。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja453588/index.html">陛下の粘土についての作品。パート4-シリコーン</a></li>
<li><a href="../ja453590/index.html">自分だけのSaaS</a></li>
<li><a href="../ja453592/index.html">生計を立ててゲームを作る：11 Levelordのヒント</a></li>
<li><a href="../ja453596/index.html">詐欺師とEDS-すべてが非常に悪い</a></li>
<li><a href="../ja453598/index.html">Япония: страна настолько здравого смысла, что он для нас местами иррационален</a></li>
<li><a href="../ja453608/index.html">Pythonhosted.orgがRoskomnadzorによって誤ってブロックされた</a></li>
<li><a href="../ja453610/index.html">SD-WAN事業の売り方</a></li>
<li><a href="../ja453612/index.html">雲の中のサッカー-ファッションか必需品か？</a></li>
<li><a href="../ja453614/index.html">ローカル（オフライン）npmリポジトリ</a></li>
<li><a href="../ja453616/index.html">連邦法「電子署名について」（63-FZ）の何が問題になっており、どのように修正しますか</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>