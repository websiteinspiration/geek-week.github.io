<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕚 🤷🏼 🎋 IPv6 - vous vous trompez 🗃️ 👌🏼 🙃</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il y a beaucoup d'idées fausses et de mythes autour d'IPv6. Souvent, les hébergeurs comprennent mal comment l'utiliser et pensent des approches obsolè...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>IPv6 - vous vous trompez</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vdsina/blog/488406/"><img src="https://habrastorage.org/webt/gg/-1/kx/gg-1kxivqjrehg1_oidyoqkphos.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a beaucoup d'idées fausses et de mythes autour d'IPv6. Souvent, les hébergeurs comprennent mal comment l'utiliser et pensent des approches obsolètes du monde de l'IPv4. Par exemple, ayant des octillions d'adresses IPv6, l'hébergeur vend des adresses aux clients individuellement, au lieu d'allouer un réseau à part entière / 64, comme indiqué dans les recommandations. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il arrive que les hébergeurs attribuent des adresses IPv6 à différents clients au sein du même réseau / 64. Dans le même temps, les grands services, tels que Google, perçoivent toutes les adresses dans la plage / 64 comme un seul client. En conséquence, les clients peuvent souffrir en raison des activités d'un partenaire.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La disponibilité des adresses IPv6 vous permet d'attribuer des adresses externes complètes à des ressources internes, telles que des conteneurs ou des clients VPN. </font><font style="vertical-align: inherit;">Pour ce faire, l'hôte doit fournir au client un réseau routé distinct. </font><font style="vertical-align: inherit;">Malheureusement, presque personne ne peut le faire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet article, nous analyserons les principales erreurs dans l'utilisation des fournisseurs IPv6.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Histoire: RFC 3177</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 En 2001, les recommandations sur l'attribution des adresses recommandées (désolé pour la tautologie, c'est important) pour mettre en évidence:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ 48 en général</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ 64 si derrière un et un seul sous-réseau</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ 128 si un et un seul appareil</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le document offensant RFC 2119, qui régit l'application de divers niveaux de respect obligatoire des instructions, définit «recommandé» comme suit: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
les mots «devrait» ou «recommandé» signifient qu'il peut y avoir des raisons raisonnables dans certaines circonstances de ne pas agir de cette manière, cependant, le choix d'une ligne de comportement différente doit être une décision équilibrée prise avec une pleine compréhension des conséquences. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peut-être que personne n'avait une compréhension complète des conséquences à ce moment-là, peut-être que «certaines circonstances» n'étaient pas définies, mais, d'une manière ou d'une autre, tout le monde a suivi les recommandations.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En général, au moment de la rédaction du document, le trafic IPv6 était extrêmement rare et se trouvait, pour la plupart, dans les instituts et les réseaux personnels de passionnés curieux. </font><font style="vertical-align: inherit;">Certains problèmes réels ont commencé à s'accumuler et à être analysés, mais cela a pris beaucoup de temps. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Repenser a commencé en 2005. </font><font style="vertical-align: inherit;">Enfin, ces recommandations ont été dépréciées en 2011.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conscience du problème: RFC 6177</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La nouvelle politique d'adressage indique explicitement que / 48 n'est qu'un souhait, pas une exigence. Aucune indication de nombres spécifiques n'est donnée, cependant, il est indiqué que / 64 ou plus court fonctionne dans des conditions normales. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La logique principale en recommandant la taille de l'émission du bloc / 48 au consommateur final poursuivait trois objectifs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Premièrement, l'espace d'adressage attribué devrait être suffisant pour les besoins des consommateurs et facilement extensible, sans squat d'haltères. Oui, c'est exactement ce qu'il dit, uniquement dans la version anglaise - sautez à travers des cerceaux. L'une des raisons importantes pour passer à IPv6 est de changer la taille de destination existante de "adresse unique" en "sous-réseaux multiples".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deuxièmement, le changement de fournisseur aurait dû se dérouler avec un minimum de problèmes. </font><font style="vertical-align: inherit;">Si vous pouvez enregistrer l'ancien schéma d'adresses de sous-réseau lors du déplacement vers un nouvel espace d'adressage, cela économisera beaucoup de travail </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
. Troisièmement, l'allocation du bloc / 48 devrait couvrir l'augmentation des besoins de l'espace d'adressage d'un consommateur en développement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien que toutes ces conditions soient remplies, il est devenu évident que la recommandation / 48 était, pour le moins, redondante.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pin / 64 comme unités d'émission</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus de l'ordre de distribution, il y avait d'autres points. </font><font style="vertical-align: inherit;">Il s'est avéré que de nombreuses fonctionnalités d'IPv6 ne fonctionnent pas si le préfixe réseau n'est pas / 64. </font><font style="vertical-align: inherit;">À savoir, ils ne fonctionnent pas:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Découverte de voisins (ND)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Découverte du quartier sécurisé (SEND)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">certaines parties de Mobile IPv6</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Multihébergement de site par intermédiation IPv6</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">beaucoup de petites choses différentes</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un facteur supplémentaire était le fait que de nombreuses technologies en cours de conception reposaient précisément sur un tel préfixe de réseau. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Non seulement la menace de briser la nouvelle norme a été la raison de la rédaction de nouvelles recommandations. </font><font style="vertical-align: inherit;">Deux opinions de validité douteuse étaient également très populaires. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, de nombreux appareils implémentent le routage IPv6 par programme, avec des béquilles et des vélos, et ne sont donc pas prêts pour une transition complète vers celui-ci. </font><font style="vertical-align: inherit;">Une augmentation possible du retard due à cela peut augmenter plusieurs fois, sinon un ordre de grandeur. </font><font style="vertical-align: inherit;">La définition par défaut du sous-réseau / 64 réduirait considérablement ces délais. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deuxièmement, le passage à une nouvelle norme est toujours pénible pour le support technique et les administrateurs système. </font><font style="vertical-align: inherit;">Un seul préfixe / 64 était censé réduire cette douleur à une valeur acceptable.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La situation sur les fronts</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme cela s'est déjà produit plus tôt en 2001, la recommandation / 64 est perçue par de nombreux grands acteurs Internet comme une norme. D'une part, c'est bon, d'autre part, pas si bon. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour de nombreux systèmes de classification, par exemple, pour la reconnaissance du spam, toutes les adresses d'un bloc seront considérées comme appartenant à un spammeur. En théorie, cela devrait faciliter la vie de l'utilisateur, au contraire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Souvent, les prestataires ne se soucient pas de choses comme l'apprentissage des pratiques courantes. Les adresses peuvent être émises selon n'importe quel principe, au moins même selon l'horoscope. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe plusieurs problèmes typiques, et tous découlent de la violation des recommandations par le fournisseur d'une part, et de la stricte adhésion à celles-ci par d'autres organisations d'autre part.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'émission d'adresses d'un bloc à plusieurs utilisateurs peut entraîner le fait qu'ils seront tous considérés comme un utilisateur réel, par exemple, des machines du réseau de l'organisation. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si plusieurs personnes de ce bloc commencent à rechercher des chats en même temps, Google peut décider que ce botnet enverra des demandes d'escroquerie de recherche ou d'autres choses pas très bonnes. De son point de vue, ce n'est qu'un utilisateur. Le résultat logique est un captcha de plus en plus compliqué. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous le savez, c'est la réponse la plus inoffensive à une arnaque hypothétique.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La situation inverse est la délivrance à un utilisateur d'adresses d'adresses provenant de différents blocs. </font><font style="vertical-align: inherit;">Si les utilisateurs de ces blocs tombent dans la liste noire de quelqu'un, alors les adresses d'un utilisateur honnête tomberont avec eux. </font><font style="vertical-align: inherit;">Histoire particulièrement intéressante: certaines de vos adresses ont été interdites par un réseau publicitaire, certaines ont été interdites par un autre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, d'autres surprises désagréables sont possibles. </font><font style="vertical-align: inherit;">Par exemple, vous avez reçu le bloc / 64, mais il s'agit d'un bloc dynamique, en tant qu'adresse dynamique - aujourd'hui 2001: DA8: 1D01: FA13 :: / 64, demain 2001: DA8: 1D01: FC15 :: / 64. </font><font style="vertical-align: inherit;">De nouvelles aventures chaque jour! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a une chance considérable de rencontrer diverses combinaisons de ces problèmes et d'autres râteaux incurvés de manière fantaisiste dans l'appendice.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Émettez IPv6 depuis notre serveur</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous avons des millions d'adresses IP, alors pourquoi ne pas donner de vraies adresses IP, par exemple, aux clients VPN afin qu'ils se rendent sur Internet sans NAT et puissent accepter les connexions entrantes du monde. </font><font style="vertical-align: inherit;">Cela semble génial, mais dans la pratique, ce n'est pas si facile. </font><font style="vertical-align: inherit;">Cela nécessitera un réseau IPv6 distinct acheminé </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">via l'</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adresse IP attribuée à l'interface du serveur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Supposons qu'un serveur se voit attribuer une adresse </font></font><code>2a01:baba::c0fee:dead/64</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, alors les clients VPN auront besoin d'un réseau séparé, tel </font></font><code>2a01:baba:fafa:0f0f::/64</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que routé via l'adresse </font></font><code>2a01:baba::c0fee:dead/64</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malheureusement, très peu de fournisseurs d'hébergement ont les outils nécessaires pour émettre de tels réseaux aux clients, c'est pourquoi vous devez utiliser des béquilles comme </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ND Proxy</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La lecture des recommandations de l'IETF n'est pas l'activité la plus intéressante, mais elle est extrêmement utile. </font><font style="vertical-align: inherit;">Les remplir de longues soirées d'hiver ne vaut clairement pas la peine, mais aussi négliger de lire des sections qui sont importantes pour vous est également indésirable. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous choisissez un fournisseur, assurez-vous qu'il partage ce point de vue. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous devez comprendre que la mauvaise approche de l'attribution des adresses ne nuit pas au fournisseur et, pour la plupart des contrats, elle ne peut même pas être la base d'une compensation. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, cela peut s'avérer être un facteur clé pour vous, même si vous ne le soupçonnez pas encore.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/9fa/cf4/a34/9facf4a348ef01048b4eb5e16ae66daa.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr488386/index.html">Cas d'application des outils d'analyse d'anomalies de réseau: attaques via des plug-ins de navigateur</a></li>
<li><a href="../fr488388/index.html">Reconnexion et authentification HTTP de base</a></li>
<li><a href="../fr488390/index.html">Comment se faire des amis de Telegram Bot avec OpenId Connect</a></li>
<li><a href="../fr488392/index.html">Images prêtes pour la production pour k8s</a></li>
<li><a href="../fr488404/index.html">Des jeux à attendre en 2020</a></li>
<li><a href="../fr488408/index.html">Passerelle IoT Ethernet-RS485 STM32</a></li>
<li><a href="../fr488410/index.html">7 leçons que j'ai apprises en dix ans de développement</a></li>
<li><a href="../fr488412/index.html">Création d'un bot Discord basé sur discord.js</a></li>
<li><a href="../fr488416/index.html">SLAE - Examen expert de sécurité Linux Assembly</a></li>
<li><a href="../fr488418/index.html">Authentification de l'API REST avec Spring Security et MongoDB</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>