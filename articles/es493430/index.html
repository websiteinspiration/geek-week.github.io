<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíõ üå•Ô∏è üì† Arquitectura de red para aplicaciones web üêπ üö£üèº üëÖ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Quiero compartir con ustedes un enfoque que he estado utilizando durante muchos a√±os en el desarrollo de aplicaciones, incluidas las aplicaciones web....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Arquitectura de red para aplicaciones web</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/493430/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quiero compartir con ustedes un enfoque que he estado utilizando durante muchos a√±os en el desarrollo de aplicaciones, incluidas las aplicaciones web. </font><font style="vertical-align: inherit;">Muchos desarrolladores de aplicaciones de escritorio, servidores y dispositivos m√≥viles est√°n familiarizados con este enfoque. </font><font style="vertical-align: inherit;">es fundamental cuando se compilan tales aplicaciones, sin embargo, est√° muy mal representado en la web, aunque definitivamente hay personas que desean utilizar este enfoque. </font><font style="vertical-align: inherit;">Adem√°s, el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">editor de VS Code est√° escrito</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre este enfoque </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dj/ju/vy/djjuvyjprjf_nnnb0bv34ymklkc.png" alt="Arquitectura pura"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado de aplicar este enfoque, se deshar√° de un marco espec√≠fico. </font><font style="vertical-align: inherit;">Puede cambiar f√°cilmente la biblioteca de vistas dentro de su aplicaci√≥n, por ejemplo React, Preact, Vue, Mithril sin tener que volver a escribir la l√≥gica de negocios y, en la mayor√≠a de los casos, incluso las vistas. </font><font style="vertical-align: inherit;">Si tiene una aplicaci√≥n en Angular 1, puede traducirla f√°cilmente a Angular 2+, React, Svelte, WebComponents o incluso a su biblioteca de presentaciones. </font><font style="vertical-align: inherit;">Si tiene una aplicaci√≥n en Angular 2+, pero no tiene especialistas, puede transferir f√°cilmente la aplicaci√≥n a una biblioteca m√°s popular sin tener que reescribir la l√≥gica empresarial. </font><font style="vertical-align: inherit;">Pero al final, olv√≠date por completo del problema de la migraci√≥n del marco al marco. </font><font style="vertical-align: inherit;">¬øQu√© tipo de magia es esta?</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øQu√© es la arquitectura limpia?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para entender esto, es mejor leer el libro </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de Martin Robert "Arquitectura limpia¬ª</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">por Robert C.Martin "Arquitectura limpia¬ª</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Un breve extracto del cual se da en el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">art√≠culo como referencia</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las ideas principales incrustadas en la arquitectura:</font></font><br>
<br>
<ol>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Independencia del marco. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La arquitectura no depende de la existencia de ninguna biblioteca. </font><font style="vertical-align: inherit;">Esto le permite utilizar el marco como una herramienta, en lugar de exprimir su sistema dentro de sus limitaciones.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testabilidad </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las reglas comerciales se pueden probar sin una interfaz de usuario, base de datos, servidor web o cualquier otro componente externo.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Independencia de la IU. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La interfaz de usuario se puede cambiar f√°cilmente sin cambiar el resto del sistema. </font><font style="vertical-align: inherit;">Por ejemplo, la interfaz web puede ser reemplazada por la consola, sin cambiar las reglas de negocio.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Independencia de la base de datos. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puede intercambiar Oracle o SQL Server por MongoDB, BigTable, CouchDB u otra cosa. </font><font style="vertical-align: inherit;">Sus reglas de negocio no est√°n relacionadas con la base de datos.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Independencia de cualquier servicio externo. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De hecho, sus reglas comerciales simplemente no saben nada sobre el mundo exterior.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las ideas descritas en este libro durante muchos a√±os han sido la base para construir aplicaciones complejas en varios campos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta flexibilidad se logra dividiendo la aplicaci√≥n en capas de Servicio, Repositorio, Modelo. </font><font style="vertical-align: inherit;">Agregu√© el enfoque MVC a Clean Architecture y obtuve las siguientes capas:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ver</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : muestra datos al cliente, en realidad visualiza el estado de la l√≥gica al cliente.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controlador</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : es responsable de interactuar con el usuario a trav√©s de IO (entrada-salida).</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servicio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : es responsable de la l√≥gica empresarial y su reutilizaci√≥n entre componentes.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Repositorio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : responsable de recibir datos de fuentes externas, como una base de datos, api, almacenamiento local, etc.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modelos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : es responsable de transferir datos entre capas y sistemas, as√≠ como de la l√≥gica de procesamiento de estos datos.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El prop√≥sito de cada capa se discute a continuaci√≥n.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øQui√©n es arquitectura pura?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El desarrollo web ha recorrido un largo camino, desde simples secuencias de comandos jquery hasta el desarrollo de grandes aplicaciones de SPA. Y ahora las aplicaciones web se han vuelto tan grandes que la cantidad de l√≥gica empresarial se ha vuelto comparable o incluso superior a las aplicaciones m√≥viles, de escritorio y de servidor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para los desarrolladores que escriben aplicaciones complejas y grandes, as√≠ como tambi√©n transfieren la l√≥gica empresarial del servidor a las aplicaciones web para ahorrar en el costo de los servidores, Clean Architecture ayudar√° a organizar el c√≥digo y escalar sin problemas a gran escala.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al mismo tiempo, si su tarea es solo el dise√±o y la animaci√≥n de las p√°ginas de destino, entonces Clean Architecture simplemente no tiene d√≥nde insertar. </font><font style="vertical-align: inherit;">Si su l√≥gica de negocios est√° en el back-end y su tarea es obtener los datos, mostrarlos al cliente y procesar el clic en el bot√≥n, entonces no sentir√° la flexibilidad de Clean Architecture, pero puede ser un excelente trampol√≠n para el crecimiento explosivo de la aplicaci√≥n.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øD√≥nde ya se aplica?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La arquitectura pura no est√° vinculada a ning√∫n marco, plataforma o lenguaje de programaci√≥n en particular. </font><font style="vertical-align: inherit;">Durante d√©cadas, se ha utilizado para escribir aplicaciones de escritorio. </font><font style="vertical-align: inherit;">Su implementaci√≥n de referencia se puede encontrar en los marcos para aplicaciones de servidor Asp.Net Core, Java Spring y NestJS. </font><font style="vertical-align: inherit;">Tambi√©n es muy popular al escribir aplicaciones iOs y Android. </font><font style="vertical-align: inherit;">Pero en el desarrollo web, apareci√≥ en una forma extremadamente infructuosa en los marcos angulares. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como yo mismo no solo soy Typecript, sino tambi√©n un desarrollador de C #, por ejemplo, tomar√© la implementaci√≥n de referencia de esta arquitectura para Asp.Net Core. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ hay una aplicaci√≥n de muestra simplificada:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aplicaci√≥n de muestra en Asp.Net Core</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">    <span class="hljs-comment">/**
     * View
     */</span><font></font>
<font></font>
    @model WebApplication1.Controllers.Profile<font></font>
<font></font>
    &lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">text</span>-<span class="hljs-title">center</span>"&gt;
        &lt;<span class="hljs-title">h1</span>&gt;  @<span class="hljs-title">Model</span>.<span class="hljs-title">FirstName</span>&lt;/<span class="hljs-title">h1</span>&gt;
    &lt;/<span class="hljs-title">div</span>&gt;

    /**
     * <span class="hljs-title">Controller</span>
     */

    <span class="hljs-title">public</span> <span class="hljs-title">class</span> <span class="hljs-title">IndexController</span> : <span class="hljs-title">Controller</span>
    </span>{
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> int _counter = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">private</span> readonly IUserProfileService _userProfileService;<font></font>
<font></font>
        <span class="hljs-keyword">public</span> IndexController(IUserProfileService userProfileService)<font></font>
        {<font></font>
            _userProfileService = userProfileService;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">public</span> async Task&lt;IActionResult&gt; Index()<font></font>
        {<font></font>
            <span class="hljs-keyword">var</span> profile = await <span class="hljs-keyword">this</span>._userProfileService.GetProfile(_counter);
            <span class="hljs-keyword">return</span> View(<span class="hljs-string">"Index"</span>, profile);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">public</span> async Task&lt;IActionResult&gt; AddCounter()<font></font>
        {<font></font>
            _counter += <span class="hljs-number">1</span>;
            <span class="hljs-keyword">var</span> profile = await <span class="hljs-keyword">this</span>._userProfileService.GetProfile(_counter);
            <span class="hljs-keyword">return</span> View(<span class="hljs-string">"Index"</span>, profile);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * Service
     */</span><font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">IUserProfileService</span>
    </span>{<font></font>
        Task&lt;Profile&gt; GetProfile(long id);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfileService</span> : <span class="hljs-title">IUserProfileService</span>
    </span>{
        <span class="hljs-keyword">private</span> readonly IUserProfileRepository _userProfileRepository;<font></font>
<font></font>
        <span class="hljs-keyword">public</span> UserProfileService(IUserProfileRepository userProfileRepository)<font></font>
        {<font></font>
            <span class="hljs-keyword">this</span>._userProfileRepository = userProfileRepository;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">public</span> async Task&lt;Profile&gt; GetProfile(long id)<font></font>
        {<font></font>
            <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>._userProfileRepository.GetProfile(id);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * Repository
     */</span><font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">IUserProfileRepository</span>
    </span>{<font></font>
        Task&lt;Profile&gt; GetProfile(long id);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfileRepository</span> : <span class="hljs-title">IUserProfileRepository</span>
    </span>{
        <span class="hljs-keyword">private</span> readonly DBContext _dbContext;
        <span class="hljs-keyword">public</span> UserProfileRepository(DBContext dbContext)<font></font>
        {<font></font>
            <span class="hljs-keyword">this</span>._dbContext = dbContext;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">public</span> async Task&lt;Profile&gt; GetProfile(long id)<font></font>
        {<font></font>
            <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>._dbContext<font></font>
                .Set&lt;Profile&gt;()<font></font>
                .FirstOrDefaultAsync((entity) =&gt; entity.Id.Equals(id));<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * Model
     */</span><font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Profile</span>
    </span>{
        <span class="hljs-keyword">public</span> long Id { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
        <span class="hljs-keyword">public</span> string FirstName { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
        <span class="hljs-keyword">public</span> string Birthdate { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }<font></font>
    }<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si no comprende que no dice nada malo, lo analizaremos en partes de cada fragmento. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se da un ejemplo para una aplicaci√≥n Asp.Net Core, pero para Java Spring, WinForms, Android, React la arquitectura y el c√≥digo ser√°n los mismos, solo cambiar√° el idioma y el trabajo con la vista (si corresponde).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aplicaci√≥n web</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El √∫nico marco que intent√≥ usar Clean Architecture fue Angular. </font><font style="vertical-align: inherit;">Pero result√≥ horrible, que en 1, que en 2+. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y hay muchas razones para esto:</font></font><br>
<br>
<ol>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Marco monol√≠tico angular. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y este es su principal problema. </font><font style="vertical-align: inherit;">Si no le gusta algo, tiene que ahogarse a diario y no hay nada que pueda hacer al respecto. </font><font style="vertical-align: inherit;">No solo hay muchos problemas en √©l, sino que tambi√©n contradice la ideolog√≠a de la arquitectura pura.</font></font></li>
<li><b>   DI.</b>     ,            Javascript.</li>
<li><b>  .</b>        JSX.       ,           6,      .                .</li>
<li><b> .</b>      Rollup   ES2015   2        4 ,   angular       9.</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y muchos m√°s problemas. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En general, hasta la tecnolog√≠a moderna angular funciona con un retraso de 5 a√±os en relaci√≥n con React.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero, ¬øqu√© pasa con otros marcos? </font><font style="vertical-align: inherit;">React, Vue, Preact, Mithril y otros son bibliotecas de presentaci√≥n exclusivas y no proporcionan ninguna arquitectura ... pero ya tenemos la arquitectura ... ¬°queda por ensamblar todo en un todo!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Empezamos a crear una aplicaci√≥n.</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consideraremos Pure Architecture por el ejemplo de una aplicaci√≥n ficticia que est√© lo m√°s cerca posible de una aplicaci√≥n web real. </font><font style="vertical-align: inherit;">Esta es una oficina en la compa√±√≠a de seguros que muestra el perfil del usuario, los eventos asegurados, las tarifas de seguro propuestas y las herramientas para trabajar con estos datos. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fy/sj/jf/fysjjf8fyz7rq0tzeaboesysuxw.jpeg" alt="Prototipo de aplicaci√≥n"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el ejemplo, solo se implementar√° una peque√±a parte de lo funcional, pero desde all√≠ puede comprender d√≥nde y c√≥mo colocar el resto de lo funcional. </font><font style="vertical-align: inherit;">Comencemos a crear la aplicaci√≥n desde la capa Controlador y conectemos la capa Vista al final. </font><font style="vertical-align: inherit;">Y en el curso de la creaci√≥n, consideramos cada capa con m√°s detalle.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Patr√≥n controlador</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controlador</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : es responsable de la interacci√≥n del usuario con la aplicaci√≥n. </font><font style="vertical-align: inherit;">Puede ser un clic en un bot√≥n en una p√°gina web, una aplicaci√≥n de escritorio, una aplicaci√≥n m√≥vil o ingresar un comando en una consola Linux, o una solicitud de red, o cualquier otro evento IO que ingrese a la aplicaci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El controlador m√°s simple en una arquitectura limpia es el siguiente:</font></font><br>
<br>
<pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleController</span> </span>{ <span class="hljs-comment">// extends React.Component&lt;object, object&gt;</span><font></font>
<font></font>
    <span class="hljs-keyword">public</span> todos: string[] = []; <span class="hljs-comment">//  </span><font></font>
<font></font>
    <span class="hljs-keyword">public</span> addTodo(todo: string): <span class="hljs-keyword">void</span> { <span class="hljs-comment">//    </span>
        <span class="hljs-keyword">this</span>.todos.push(todo);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> removeTodo(index: number): <span class="hljs-keyword">void</span> { <span class="hljs-comment">//    </span>
        <span class="hljs-keyword">this</span>.todos.splice(index, <span class="hljs-number">1</span>);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// public render(): JSX.Element {...} // view injection</span><font></font>
<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Su tarea es recibir un evento del usuario e iniciar procesos comerciales. </font><font style="vertical-align: inherit;">En el caso ideal, el controlador no sabe nada sobre View, y luego puede reutilizarse entre plataformas, como Web, React-Native o Electron. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora escribamos un controlador para nuestra aplicaci√≥n. </font><font style="vertical-align: inherit;">Su tarea es obtener un perfil de usuario, tarifas disponibles y ofrecer la mejor tarifa al usuario:</font></font><br>
<br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageController. </font><font style="vertical-align: inherit;">Controlador con l√≥gica empresarial</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPageControlle</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> userProfile: any = {};
    <span class="hljs-keyword">public</span> insuranceCases: any[] = [];
    <span class="hljs-keyword">public</span> tariffs: any[] = [];
    <span class="hljs-keyword">public</span> bestTariff: any = {};<font></font>
<font></font>
    constructor() {<font></font>
        <span class="hljs-keyword">this</span>.activate();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.requestUserProfile();
        <span class="hljs-keyword">this</span>.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestUserProfile(): Promise&lt;<span class="hljs-keyword">void</span>&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/user-profile"</span>);
            <span class="hljs-keyword">this</span>.userProfile = await response.json();
            <span class="hljs-keyword">this</span>.findBestTariff();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;<span class="hljs-keyword">void</span>&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/tariffs"</span>);
            <span class="hljs-keyword">this</span>.tariffs = await response.json();
            <span class="hljs-keyword">this</span>.findBestTariff();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> findBestTariff(): <span class="hljs-keyword">void</span> { <span class="hljs-comment">//    </span>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.userProfile &amp;&amp; <span class="hljs-keyword">this</span>.tariffs) {
            <span class="hljs-keyword">this</span>.bestTariff = <span class="hljs-keyword">this</span>.tariffs.find((tarif: any) =&gt; {
                <span class="hljs-keyword">return</span> tarif.ageFrom &lt;= <span class="hljs-keyword">this</span>.userProfile.age &amp;&amp; <span class="hljs-keyword">this</span>.userProfile.age &lt; tarif.ageTo;<font></font>
            });<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...   ,   ,
     *  ,    
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tenemos un controlador normal sin una arquitectura limpia, si lo heredamos de React.Component obtenemos un componente funcional con l√≥gica. </font><font style="vertical-align: inherit;">Muchos desarrolladores de aplicaciones web escriben, pero este enfoque tiene muchos inconvenientes importantes. </font><font style="vertical-align: inherit;">La principal es la incapacidad de reutilizar la l√≥gica entre componentes. </font><font style="vertical-align: inherit;">Despu√©s de todo, la tarifa recomendada se puede mostrar no solo en su cuenta personal, sino tambi√©n en la p√°gina de destino y en muchos otros lugares para atraer a un cliente al servicio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para poder reutilizar la l√≥gica entre componentes, es necesario colocarla en una capa especial llamada Servicio.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Patr√≥n de servicio</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servicio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : responsable de toda la l√≥gica empresarial de la aplicaci√≥n. </font><font style="vertical-align: inherit;">Si el Controlador necesitaba recibir, procesar y enviar algunos datos, lo hace a trav√©s del Servicio. </font><font style="vertical-align: inherit;">Si varios controladores necesitan la misma l√≥gica, funcionan con el Servicio. </font><font style="vertical-align: inherit;">Pero la capa de servicio en s√≠ misma no debe saber nada sobre la capa de controlador y vista y el entorno en el que funciona. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pasemos la l√≥gica del controlador al servicio e implementemos el servicio en el controlador:</font></font><br>
<br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageController. </font><font style="vertical-align: inherit;">Controlador sin l√≥gica empresarial</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilService } from "./UserProfilService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffService } from "./TariffService";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPageController</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> userProfile: any = {};
    <span class="hljs-keyword">public</span> insuranceCases: any[] = [];
    <span class="hljs-keyword">public</span> tariffs: any[] = [];
    <span class="hljs-keyword">public</span> bestTariff: any = {};<font></font>
<font></font>
    <span class="hljs-comment">//    </span>
    <span class="hljs-keyword">private</span> readonly userProfilService: UserProfilService = <span class="hljs-keyword">new</span> UserProfilService();
    <span class="hljs-keyword">private</span> readonly tarifService: TariffService = <span class="hljs-keyword">new</span> TariffService();<font></font>
<font></font>
    constructor() {<font></font>
        <span class="hljs-keyword">this</span>.activate();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.requestUserProfile();
        <span class="hljs-keyword">this</span>.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestUserProfile(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">//     </span>
            <span class="hljs-keyword">this</span>.userProfile = await <span class="hljs-keyword">this</span>.userProfilService.getUserProfile();
            <span class="hljs-keyword">this</span>.bestTariff = await <span class="hljs-keyword">this</span>.tarifService.findBestTariff(<span class="hljs-keyword">this</span>.userProfile);<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">//     </span>
            <span class="hljs-keyword">this</span>.tariffs = await <span class="hljs-keyword">this</span>.tarifService.getTariffs();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...   ,   ,
     *  ,    
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilService. </font><font style="vertical-align: inherit;">Servicio para trabajar con perfil de usuario</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilService</span> </span>{
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;any&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/user-profile"</span>);
        <span class="hljs-keyword">return</span> await response.json();<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servicio Arancelario. </font><font style="vertical-align: inherit;">Servicio para trabajar con tarifas.</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffService</span> </span>{
    <span class="hljs-comment">//  </span>
    <span class="hljs-keyword">public</span> async getTariffs(): Promise&lt;any&gt; {
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/tariffs"</span>);
        <span class="hljs-keyword">return</span> await response.json();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//    </span>
    <span class="hljs-keyword">public</span> async findBestTariff(userProfile: any): Promise&lt;any&gt; {
        <span class="hljs-keyword">const</span> tariffs = await <span class="hljs-keyword">this</span>.getTariffs();
        <span class="hljs-keyword">return</span> tariffs.find((tarif: any) =&gt; {
            <span class="hljs-keyword">return</span> tarif.ageFrom &lt;= userProfile.age &amp;&amp;<font></font>
                userProfile.age &lt; tarif.ageTo;<font></font>
        });<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...       
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora, si varios controladores necesitan obtener un perfil de usuario o tarifas, pueden reutilizar la misma l√≥gica de los servicios. </font><font style="vertical-align: inherit;">En los servicios, lo principal es no olvidarse de los principios S√ìLIDOS y que cada servicio es responsable de su √°rea de responsabilidad. </font><font style="vertical-align: inherit;">En este caso, un servicio es responsable de trabajar con el perfil del usuario, y otro servicio es responsable de trabajar con las tarifas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero, ¬øqu√© sucede si la fuente de datos cambia, por ejemplo, fetch puede cambiar a websocket o grps o la base de datos, y los datos reales deben reemplazarse por datos de prueba? </font><font style="vertical-align: inherit;">Y en general, ¬øpor qu√© la l√≥gica de negocios necesita saber algo sobre una fuente de datos? </font><font style="vertical-align: inherit;">Para resolver estos problemas, hay una capa de repositorio.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Patr√≥n de repositorio</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Repositorio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : responsable de la comunicaci√≥n con el almac√©n de datos. </font><font style="vertical-align: inherit;">El almacenamiento puede ser un servidor, base de datos, memoria, almacenamiento local, almacenamiento de sesiones o cualquier otro almacenamiento. </font><font style="vertical-align: inherit;">Su tarea es abstraer la capa de Servicio de la implementaci√≥n de almacenamiento espec√≠fica. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hagamos solicitudes de red de los servicios en el repositorio, mientras que el controlador no cambia:</font></font><br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilService. </font><font style="vertical-align: inherit;">Servicio para trabajar con perfil de usuario</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilRepository } from "./UserProfilRepository";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilService</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilRepository: UserProfilRepository =
        <span class="hljs-keyword">new</span> UserProfilRepository();<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;any&gt; {
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.userProfilRepository.getUserProfile();<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilRepository. </font><font style="vertical-align: inherit;">Servicio para trabajar con almacenamiento de perfil de usuario</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilRepository</span> </span>{
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;any&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/user-profile"</span>);
        <span class="hljs-keyword">return</span> await response.json();<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servicio Arancelario. </font><font style="vertical-align: inherit;">Servicio para trabajar con tarifas.</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffRepository } from "./TariffRepository";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffService</span> </span>{<font></font>
    <font></font>
    <span class="hljs-keyword">private</span> readonly tarifRepository: TariffRepository = <span class="hljs-keyword">new</span> TariffRepository();<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getTariffs(): Promise&lt;any&gt; {
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.tarifRepository.getTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//    </span>
    <span class="hljs-keyword">public</span> async findBestTariff(userProfile: any): Promise&lt;any&gt; {
        <span class="hljs-comment">//    </span>
        <span class="hljs-keyword">const</span> tariffs = await <span class="hljs-keyword">this</span>.tarifRepository.getTariffs();
        <span class="hljs-keyword">return</span> tariffs.find((tarif: any) =&gt; {
            <span class="hljs-keyword">return</span> tarif.ageFrom &lt;= userProfile.age &amp;&amp;<font></font>
                userProfile.age &lt; tarif.ageTo;<font></font>
        });<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...       
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TariffRepository. </font><font style="vertical-align: inherit;">Repositorio para trabajar con almacenamiento de tarifas</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffRepository</span> </span>{
    <span class="hljs-comment">//  </span>
    <span class="hljs-keyword">public</span> async getTariffs(): Promise&lt;any&gt; {
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/tariffs"</span>);
        <span class="hljs-keyword">return</span> await response.json();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora es suficiente escribir una solicitud de datos una vez y cualquier servicio podr√° reutilizar esta solicitud. </font><font style="vertical-align: inherit;">M√°s adelante veremos un ejemplo de c√≥mo redefinir el repositorio sin tocar el c√≥digo de servicio e implementar el repositorio mocha para las pruebas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el servicio UserProfilService, puede parecer que no es necesario y el controlador puede acceder directamente al repositorio de datos, pero esto no es as√≠. </font><font style="vertical-align: inherit;">En cualquier momento, los requisitos pueden aparecer o cambiar en la capa empresarial, se puede requerir una solicitud adicional o se pueden enriquecer los datos. </font><font style="vertical-align: inherit;">Por lo tanto, incluso cuando no hay l√≥gica en la capa de servicio, se debe preservar la cadena Controlador - Servicio - Repositorio. </font><font style="vertical-align: inherit;">Esta es una contribuci√≥n a tu ma√±ana. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es hora de averiguar qu√© tipo de repositorio se configura, si son correctos. </font><font style="vertical-align: inherit;">La capa Modelos es responsable de esto.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modelos: DTO, Entidades, ViewModels</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modelos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : es responsable de la descripci√≥n de las estructuras con las que funciona la aplicaci√≥n. </font><font style="vertical-align: inherit;">Dicha descripci√≥n ayuda enormemente a los nuevos desarrolladores de proyectos a comprender con qu√© est√° trabajando la aplicaci√≥n. </font><font style="vertical-align: inherit;">Adem√°s, es muy conveniente usarlo para construir bases de datos o validar datos almacenados en el modelo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los modelos se dividen en diferentes patrones seg√∫n el tipo de uso:</font></font><br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entidades</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : son responsables de trabajar con la base de datos y son una estructura que repite una tabla o documento en la base de datos.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DTO (objeto de transferencia de datos)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : se utilizan para transferir datos entre diferentes capas de la aplicaci√≥n.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ViewModel</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : contiene informaci√≥n previamente preparada necesaria para mostrar en la vista.</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agregue el modelo de perfil de usuario y otros modelos a la aplicaci√≥n, y deje que las otras capas sepan que ahora estamos trabajando no con un objeto abstracto, sino con un perfil muy espec√≠fico:</font></font><br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageController. </font><font style="vertical-align: inherit;">En lugar de cualquiera, se utilizan los modelos descritos.</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilService } from "./UserProfilService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffService } from "./TariffService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { InsuranceCaseDto } from "./InsuranceCasesDto";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPageController</span> </span>{<font></font>
<font></font>
    <span class="hljs-comment">/**
     *          
     *          .
     */</span>
    <span class="hljs-keyword">public</span> userProfile: UserProfileDto = <span class="hljs-keyword">new</span> UserProfileDto();
    <span class="hljs-keyword">public</span> insuranceCases: InsuranceCaseDto[] = [];
    <span class="hljs-keyword">public</span> tariffs: TariffDto[] = [];
    <span class="hljs-keyword">public</span> bestTariff: TariffDto | <span class="hljs-keyword">void</span> = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;<font></font>
<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilService: UserProfilService = <span class="hljs-keyword">new</span> UserProfilService();
    <span class="hljs-keyword">private</span> readonly tarifService: TariffService = <span class="hljs-keyword">new</span> TariffService();<font></font>
<font></font>
    constructor() {<font></font>
        <span class="hljs-keyword">this</span>.activate();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.requestUserProfile();
        <span class="hljs-keyword">this</span>.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestUserProfile(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.userProfile = await <span class="hljs-keyword">this</span>.userProfilService.getUserProfile();
            <span class="hljs-keyword">this</span>.bestTariff = await <span class="hljs-keyword">this</span>.tarifService.findBestTariff(<span class="hljs-keyword">this</span>.userProfile);<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.tariffs = await <span class="hljs-keyword">this</span>.tarifService.getTariffs();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...   ,   ,
     *  ,    
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilService. </font><font style="vertical-align: inherit;">En lugar de cualquiera, especifique el modelo devuelto</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilRepository } from "./UserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilService</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilRepository: UserProfilRepository =
        <span class="hljs-keyword">new</span> UserProfilRepository();<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.userProfilRepository.getUserProfile();<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servicio Arancelario. </font><font style="vertical-align: inherit;">En lugar de cualquiera, especifique el modelo devuelto</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffRepository } from "./TariffRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffService</span> </span>{<font></font>
    <font></font>
    <span class="hljs-keyword">private</span> readonly tarifRepository: TariffRepository = <span class="hljs-keyword">new</span> TariffRepository();<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getTariffs(): Promise&lt;TariffDto[]&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.tarifRepository.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//  </span>
    <span class="hljs-keyword">public</span> async findBestTariff(userProfile: UserProfileDto): Promise&lt;TariffDto | <span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">const</span> tariffs = await <span class="hljs-keyword">this</span>.tarifRepository.requestTariffs();
        <span class="hljs-keyword">return</span> tariffs.find((tarif: TariffDto) =&gt; {
            <span class="hljs-comment">//  userProfile.age  userProfile.getAge()</span>
            <span class="hljs-keyword">const</span> age = userProfile.getAge();
            <span class="hljs-keyword">return</span> age &amp;&amp;<font></font>
                tarif.ageFrom &lt;= age &amp;&amp;<font></font>
                age &lt; tarif.ageTo;<font></font>
        });<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...       
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilRepository. </font><font style="vertical-align: inherit;">En lugar de cualquiera, especifique el modelo devuelto</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilRepository</span> </span>{
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/user-profile"</span>);
        <span class="hljs-keyword">return</span> await response.json();<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TariffRepository. </font><font style="vertical-align: inherit;">En lugar de cualquiera, especifique el modelo devuelto</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffRepository</span> </span>{
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;TariffDto[]&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/tariffs"</span>);
        <span class="hljs-keyword">return</span> await response.json();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfileDto. </font><font style="vertical-align: inherit;">Un modelo con una descripci√≥n de los datos con los que trabajamos.</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfileDto</span> </span>{ <span class="hljs-comment">// &lt;--      </span>
    <span class="hljs-keyword">public</span> firstName: string | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">public</span> lastName: string | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">public</span> birthdate: Date | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    <span class="hljs-keyword">public</span> getAge(): number | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.birthdate) {
            <span class="hljs-keyword">const</span> ageDifMs = Date.now() - <span class="hljs-keyword">this</span>.birthdate.getTime();
            <span class="hljs-keyword">const</span> ageDate = <span class="hljs-keyword">new</span> Date(ageDifMs);
            <span class="hljs-keyword">return</span> Math.abs(ageDate.getUTCFullYear() - <span class="hljs-number">1970</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> getFullname(): string | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">return</span> [
            <span class="hljs-keyword">this</span>.firstName ?? <span class="hljs-string">""</span>,
            <span class="hljs-keyword">this</span>.lastName ?? <span class="hljs-string">""</span><font></font>
        ]<font></font>
            .join(<span class="hljs-string">" "</span>)<font></font>
            .trim() || <span class="hljs-literal">null</span>;<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TarifaDto. </font><font style="vertical-align: inherit;">Un modelo con una descripci√≥n de los datos con los que trabajamos.</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffDto</span> </span>{
    <span class="hljs-keyword">public</span> ageFrom: number = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">public</span> ageTo: number = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">public</span> price: number = <span class="hljs-number">0</span>;<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora, sin importar en qu√© capa de la aplicaci√≥n nos encontremos, sabemos exactamente con qu√© datos estamos trabajando. Adem√°s, debido a la descripci√≥n del modelo, encontramos un error en nuestro servicio. En la l√≥gica del servicio, se us√≥ la propiedad userProfile.age, que en realidad no existe, pero tiene una fecha de nacimiento. Y para calcular la edad, debe llamar al m√©todo de modelo userProfile.getAge (). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero hay un problema. Si intentamos utilizar los m√©todos del modelo que proporcion√≥ el repositorio actual, obtendremos una excepci√≥n. El caso es que los m√©todos </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">response.json ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON.parse ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No devuelve nuestro modelo, sino un objeto JSON, que de ninguna manera est√° asociado con nuestro modelo. </font><font style="vertical-align: inherit;">Puede verificar esto si ejecuta el comando userProfile instanceof UserProfileDto, obtiene una declaraci√≥n falsa. </font><font style="vertical-align: inherit;">Para convertir los datos recibidos de una fuente externa al modelo descrito, hay un proceso de deserializaci√≥n de datos.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deserializaci√≥n de datos</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deserializaci√≥n</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : el proceso de restaurar la estructura necesaria a partir de una secuencia de bytes. </font><font style="vertical-align: inherit;">Si los datos contienen informaci√≥n no especificada en los modelos, se ignorar√°. </font><font style="vertical-align: inherit;">Si hay informaci√≥n en los datos que contradice la descripci√≥n del modelo, se producir√° un error de deserializaci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y lo m√°s interesante aqu√≠ es que al dise√±ar el ES2015 y agregar la palabra clave de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">clase</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">olvidaron agregar deserializaci√≥n ... El hecho de que en todos los idiomas est√° listo para usar, en ES2015 simplemente olvidaron ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para resolver este problema, escrib√≠ una biblioteca para la deserializaci√≥n </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">serializable TS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , un art√≠culo sobre el cual se puede </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">leer en este enlace</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">El prop√≥sito de esto es devolver la funcionalidad perdida.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agregue soporte de deserializaci√≥n en el modelo y la deserializaci√≥n misma al repositorio:</font></font><br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TariffRepository. </font><font style="vertical-align: inherit;">Agregar un proceso de deserializaci√≥n</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilRepository</span> </span>{
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; {
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/user-profile"</span>);
        <span class="hljs-keyword">const</span> object = await response.json();
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> UserProfileDto().fromJSON(object); <span class="hljs-comment">//  </span><font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TariffRepository. </font><font style="vertical-align: inherit;">Agregar un proceso de deserializaci√≥n</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffRepository</span> </span>{
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;TariffDto[]&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/tariffs"</span>);
        <span class="hljs-keyword">const</span> objects: object[] = await response.json();
        <span class="hljs-keyword">return</span> objects.map((object: object) =&gt; {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> TariffDto().fromJSON(object); <span class="hljs-comment">//  </span><font></font>
        });<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ProfileDto. </font><font style="vertical-align: inherit;">Agregar soporte de deserializaci√≥n</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { Serializable, jsonProperty } from "ts-serializable";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfileDto</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Serializable</span> </span>{ <span class="hljs-comment">// &lt;--    </span><font></font>
<font></font>
    @jsonProperty(String, <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;--  </span>
    <span class="hljs-keyword">public</span> firstName: string | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    @jsonProperty(String, <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;--  </span>
    <span class="hljs-keyword">public</span> lastName: string | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    @jsonProperty(Date, <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;--  </span>
    <span class="hljs-keyword">public</span> birthdate: Date | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    <span class="hljs-keyword">public</span> getAge(): number | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.birthdate) {
            <span class="hljs-keyword">const</span> ageDifMs = Date.now() - <span class="hljs-keyword">this</span>.birthdate.getTime();
            <span class="hljs-keyword">const</span> ageDate = <span class="hljs-keyword">new</span> Date(ageDifMs);
            <span class="hljs-keyword">return</span> Math.abs(ageDate.getUTCFullYear() - <span class="hljs-number">1970</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> getFullname(): string | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">return</span> [
            <span class="hljs-keyword">this</span>.firstName ?? <span class="hljs-string">""</span>,
            <span class="hljs-keyword">this</span>.lastName ?? <span class="hljs-string">""</span><font></font>
        ]<font></font>
            .join(<span class="hljs-string">" "</span>)<font></font>
            .trim() || <span class="hljs-literal">null</span>;<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TarifaDto. </font><font style="vertical-align: inherit;">Agregar soporte de deserializaci√≥n</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { Serializable, jsonProperty } from "ts-serializable";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffDto</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Serializable</span> </span>{ <span class="hljs-comment">// &lt;--    </span><font></font>
<font></font>
    @jsonProperty(Number, <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;--  </span>
    <span class="hljs-keyword">public</span> ageFrom: number = <span class="hljs-number">0</span>;<font></font>
<font></font>
    @jsonProperty(Number, <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;--  </span>
    <span class="hljs-keyword">public</span> ageTo: number = <span class="hljs-number">0</span>;<font></font>
<font></font>
    @jsonProperty(Number, <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;--  </span>
    <span class="hljs-keyword">public</span> price: number = <span class="hljs-number">0</span>;<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora, en todas las capas de la aplicaci√≥n, puede estar absolutamente seguro de que estamos trabajando con los modelos que esperamos. </font><font style="vertical-align: inherit;">En la vista, el controlador y otras capas, puede llamar a los m√©todos del modelo descrito.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øPara qu√© sirven Serializable y jsonProperty?</font></font></b>
                        <div class="spoiler_text">        Serializable ‚Äî         Ecmascript       Typescript.      jsonProperty         ,       Typescript            uniontypes.            .<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora tenemos una aplicaci√≥n casi terminada. </font><font style="vertical-align: inherit;">Es hora de probar la l√≥gica escrita en las capas Controlador, Servicio y Modelos. </font><font style="vertical-align: inherit;">Para hacer esto, necesitamos devolver datos de prueba especialmente preparados en la capa de Repositorio en lugar de una solicitud real al servidor. </font><font style="vertical-align: inherit;">Pero c√≥mo reemplazar el repositorio sin tocar el c√≥digo que entra en producci√≥n. </font><font style="vertical-align: inherit;">Hay un patr√≥n de inyecci√≥n de dependencia para esto.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inyecci√≥n de dependencia - Inyecci√≥n de dependencia</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inyecci√≥n de dependencias</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : inyecta dependencias en las capas Contoller, Servicio, Repositorio y le permite anular estas dependencias fuera de estas capas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el programa, la capa del controlador depende de la capa de servicio, y depende de la capa del repositorio. En la forma actual, las capas mismas causan sus dependencias a trav√©s de la creaci√≥n de instancias. Y para redefinir la dependencia, la capa necesita establecer esta dependencia desde el exterior. Hay muchas formas de hacer esto, pero la m√°s popular es pasar la dependencia como par√°metro en el constructor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego, crear un programa con todas las dependencias se ver√° as√≠:</font></font><br>
<pre><code class="actionscript hljs"><span class="hljs-keyword">var</span> programm = <span class="hljs-keyword">new</span> IndexPageController(<span class="hljs-keyword">new</span> ProfileService(<span class="hljs-keyword">new</span> ProfileRepository()));
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De acuerdo, se ve horrible. </font><font style="vertical-align: inherit;">Incluso teniendo en cuenta que solo hay dos dependencias en el programa, ya se ve horrible. </font><font style="vertical-align: inherit;">Qu√© decir sobre los programas en los que cientos y miles de dependencias. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para resolver el problema, necesita una herramienta especial, pero para esto necesita encontrarla. </font><font style="vertical-align: inherit;">Si recurrimos a la experiencia de otras plataformas, por ejemplo, Asp.Net Core, entonces el registro de dependencias se produce en la etapa de inicializaci√≥n del programa y se ve as√≠:</font></font><br>
<pre><code class="actionscript hljs">DI.register(IProfileService,ProfileService);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
y luego, al crear el controlador, el propio marco crear√° e implementar√° esta dependencia. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero hay tres problemas importantes:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuando se transcribe el Script mecanografiado en Javascript, no quedan rastros de las interfaces.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todo lo que cay√≥ en el cl√°sico DI permanece en √©l para siempre. </font><font style="vertical-align: inherit;">Es muy dif√≠cil limpiarlo durante la refactorizaci√≥n. </font><font style="vertical-align: inherit;">Y en una aplicaci√≥n web, debe guardar cada byte.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Casi todas las bibliotecas de vistas no usan DI, y los dise√±adores de controladores est√°n ocupados con los par√°metros.</font></font></li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En aplicaciones web, DI se usa solo en Angular 2+. </font><font style="vertical-align: inherit;">En Angular 1, al registrar dependencias, en lugar de una interfaz, se utiliz√≥ una cadena; en InversifyJS, se utiliza Symbol en lugar de la interfaz. </font><font style="vertical-align: inherit;">Y todo esto se implementa tan terriblemente que es mejor tener muchas novedades como en el primer ejemplo de esta secci√≥n que estas soluciones. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para resolver los tres problemas, se invent√≥ mi propio DI y la soluci√≥n me ayud√≥ a encontrar el marco Java Spring y su decorador con cable autom√°tico. </font><font style="vertical-align: inherit;">La descripci√≥n de c√≥mo funciona esta DI se puede </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">encontrar en el art√≠culo en el enlace</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el repositorio de GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es hora de aplicar la DI resultante en nuestra aplicaci√≥n.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Poniendolo todo junto</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para implementar DI en todas las capas, agregaremos un decorador de reflexi√≥n, lo que har√° que el mecanografiado genere metainformaci√≥n adicional sobre los tipos de dependencia. </font><font style="vertical-align: inherit;">En el controlador donde necesita llamar a las dependencias, colgaremos el decorador con cable autom√°tico. </font><font style="vertical-align: inherit;">Y en el lugar donde se inicializa el programa, determinamos en qu√© entorno qu√© dependencia se implementar√°. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para el repositorio UserProfilRepository, cree el mismo repositorio, pero con datos de prueba en lugar de la solicitud real. </font><font style="vertical-align: inherit;">Como resultado, obtenemos el siguiente c√≥digo:</font></font><br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Main.ts. </font><font style="vertical-align: inherit;">Ubicaci√≥n de inicializaci√≥n del programa</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { override } from "first-di";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilRepository } from "./UserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { MockUserProfilRepository } from "./MockUserProfilRepository";</span><font></font>
<font></font>
<span class="hljs-keyword">if</span> (process.env.NODE_ENV === <span class="hljs-string">"test"</span>) {
    <span class="hljs-comment">//         </span>
    <span class="hljs-keyword">override</span>(UserProfilRepository, MockUserProfilRepository);<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageController. </font><font style="vertical-align: inherit;">Dependencia a trav√©s del decorador con cable</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilService } from "./UserProfilService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffService } from "./TariffService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { InsuranceCaseDto } from "./InsuranceCasesDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { autowired } from "first-di";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPageController</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> userProfile: UserProfileDto = <span class="hljs-keyword">new</span> UserProfileDto();
    <span class="hljs-keyword">public</span> insuranceCases: InsuranceCaseDto[] = [];
    <span class="hljs-keyword">public</span> tariffs: TariffDto[] = [];
    <span class="hljs-keyword">public</span> bestTariff: TariffDto | <span class="hljs-keyword">void</span> = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;<font></font>
<font></font>
    @autowired() <span class="hljs-comment">//  </span>
    <span class="hljs-keyword">private</span> readonly userProfilService!: UserProfilService;<font></font>
<font></font>
    @autowired() <span class="hljs-comment">//  </span>
    <span class="hljs-keyword">private</span> readonly tarifService!: TariffService;<font></font>
<font></font>
    constructor() {<font></font>
        <span class="hljs-comment">//     , ..  </span>
        <span class="hljs-keyword">this</span>.activate();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.requestUserProfile();
        <span class="hljs-keyword">this</span>.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestUserProfile(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.userProfile = await <span class="hljs-keyword">this</span>.userProfilService.getUserProfile();
            <span class="hljs-keyword">this</span>.bestTariff = await <span class="hljs-keyword">this</span>.tarifService.findBestTariff(<span class="hljs-keyword">this</span>.userProfile);<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.tariffs = await <span class="hljs-keyword">this</span>.tarifService.getTariffs();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...   ,   ,
     *  ,    
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilService. </font><font style="vertical-align: inherit;">Introducci√≥n a la reflexi√≥n y la generaci√≥n de dependencia.</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilRepository } from "./UserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection <span class="hljs-comment">//  typescript  </span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilService</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilRepository: UserProfilRepository;<font></font>
<font></font>
    constructor(userProfilRepository: UserProfilRepository) {<font></font>
        <span class="hljs-comment">//    </span>
        <span class="hljs-keyword">this</span>.userProfilRepository = userProfilRepository;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; {
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.userProfilRepository.getUserProfile();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servicio Arancelario. </font><font style="vertical-align: inherit;">Introducci√≥n a la reflexi√≥n y la generaci√≥n de dependencia.</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffRepository } from "./TariffRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection <span class="hljs-comment">//  typescript  </span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffService</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> readonly tarifRepository: TariffRepository;<font></font>
<font></font>
    constructor(tarifRepository: TariffRepository) {<font></font>
        <span class="hljs-comment">//    </span>
        <span class="hljs-keyword">this</span>.tarifRepository = tarifRepository;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getTariffs(): Promise&lt;TariffDto[]&gt; {
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.tarifRepository.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async findBestTariff(userProfile: UserProfileDto): Promise&lt;TariffDto | <span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">const</span> tariffs = await <span class="hljs-keyword">this</span>.tarifRepository.requestTariffs();
        <span class="hljs-keyword">return</span> tariffs.find((tarif: TariffDto) =&gt; {
            <span class="hljs-keyword">const</span> age = userProfile.getAge();
            <span class="hljs-keyword">return</span> age &amp;&amp;<font></font>
                tarif.ageFrom &lt;= age &amp;&amp;<font></font>
                age &lt; tarif.ageTo;<font></font>
        });<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...       
     */</span><font></font>
}<font></font>
<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilRepository. </font><font style="vertical-align: inherit;">Introduciendo la generaci√≥n de reflexi√≥n</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection <span class="hljs-comment">//  typescript  </span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilRepository</span> </span>{
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; {
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/user-profile"</span>);
        <span class="hljs-keyword">const</span> object = await response.json();
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> UserProfileDto().fromJSON(object);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MockUserProfilRepository. </font><font style="vertical-align: inherit;">Nuevo repositorio para pruebas</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection <span class="hljs-comment">//  typescript  </span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MockUserProfilRepository</span> </span>{ <span class="hljs-comment">//   </span>
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; {
        <span class="hljs-keyword">const</span> profile = <span class="hljs-keyword">new</span> UserProfileDto();<font></font>
        profile.firstName = <span class="hljs-string">""</span>;<font></font>
        profile.lastName = <span class="hljs-string">""</span>;<font></font>
        profile.birthdate = <span class="hljs-keyword">new</span> Date(Date.now() - <span class="hljs-number">1.5e12</span>);
        <span class="hljs-keyword">return</span> Promise.resolve(profile); <span class="hljs-comment">//   </span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TariffRepository. </font><font style="vertical-align: inherit;">Introduciendo la generaci√≥n de reflexi√≥n</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection <span class="hljs-comment">//  typescript  </span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffRepository</span> </span>{
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;TariffDto[]&gt; {
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/tariffs"</span>);
        <span class="hljs-keyword">const</span> objects: object[] = await response.json();
        <span class="hljs-keyword">return</span> objects.map((object: object) =&gt; {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> TariffDto().fromJSON(object);<font></font>
        });<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora, en cualquier parte del programa, existe la oportunidad de cambiar la implementaci√≥n de cualquier l√≥gica. </font><font style="vertical-align: inherit;">En nuestro ejemplo, en lugar de una solicitud de perfil de usuario real al servidor en el entorno de prueba, se utilizar√°n los datos de prueba. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la vida real, los reemplazos se pueden encontrar en cualquier lugar, por ejemplo, puede cambiar la l√≥gica en un servicio, implementar el servicio anterior en producci√≥n y, en la refactorizaci√≥n, ya es nuevo. </font><font style="vertical-align: inherit;">Realice pruebas A / B con l√≥gica empresarial, cambie la base de datos basada en documentos a relacional y, en general, cambie la solicitud de red a sockets web. </font><font style="vertical-align: inherit;">Y todo esto sin detener el desarrollo para reescribir la soluci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es hora de ver el resultado del programa. </font><font style="vertical-align: inherit;">Hay una capa de Vista para esto.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vista de implementaci√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La capa Vista es responsable de presentar los datos que est√°n contenidos en la capa Controlador al usuario. </font><font style="vertical-align: inherit;">En el ejemplo, usar√© React para esto, pero en su lugar puede haber cualquier otro, por ejemplo Preact, Svelte, Vue, Mithril, WebComponent o cualquier otro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para hacer esto, simplemente herede nuestro controlador de React.Component y agregue un m√©todo de representaci√≥n con la representaci√≥n de la vista:</font></font><br>
<br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Main.ts. </font><font style="vertical-align: inherit;">Comienza a dibujar un componente Reaccionar</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { override } from "first-di";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilRepository } from "./UserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { MockUserProfilRepository } from "./MockUserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserPageController } from "./UserPageController";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> React from "react";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { render } from "react-dom";</span><font></font>
<font></font>
<span class="hljs-keyword">if</span> (process.env.NODE_ENV === <span class="hljs-string">"test"</span>) {
    <span class="hljs-comment">//         </span>
    <span class="hljs-keyword">override</span>(UserProfilRepository, MockUserProfilRepository);<font></font>
}<font></font>
<font></font>
render(React.createElement(UserPageController), document.body);<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageController. </font><font style="vertical-align: inherit;">Hereda de React.Component y agrega un m√©todo de representaci√≥n</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilService } from "./UserProfilService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffService } from "./TariffService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { InsuranceCaseDto } from "./InsuranceCasesDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { autowired } from "first-di";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> React from "react";</span><font></font>
<font></font>
<span class="hljs-comment">//    React.Component</span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPageController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span>&lt;<span class="hljs-title">object</span>, <span class="hljs-title">object</span>&gt; </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> userProfile: UserProfileDto = <span class="hljs-keyword">new</span> UserProfileDto();
    <span class="hljs-keyword">public</span> insuranceCases: InsuranceCaseDto[] = [];
    <span class="hljs-keyword">public</span> tariffs: TariffDto[] = [];
    <span class="hljs-keyword">public</span> bestTariff: TariffDto | <span class="hljs-keyword">void</span> = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;<font></font>
<font></font>
    @autowired()<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilService!: UserProfilService;<font></font>
<font></font>
    @autowired()<font></font>
    <span class="hljs-keyword">private</span> readonly tarifService!: TariffService;<font></font>
<font></font>
    <span class="hljs-comment">//   </span><font></font>
    constructor(props: object, context: object) {<font></font>
        <span class="hljs-keyword">super</span>(props, context);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//     </span>
    <span class="hljs-keyword">public</span> componentDidMount(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.activate();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.requestUserProfile();
        <span class="hljs-keyword">this</span>.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestUserProfile(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.userProfile = await <span class="hljs-keyword">this</span>.userProfilService.getUserProfile();
            <span class="hljs-keyword">this</span>.bestTariff = await <span class="hljs-keyword">this</span>.tarifService.findBestTariff(<span class="hljs-keyword">this</span>.userProfile);
            <span class="hljs-keyword">this</span>.forceUpdate(); <span class="hljs-comment">//  view   </span>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.tariffs = await <span class="hljs-keyword">this</span>.tarifService.getTariffs();
            <span class="hljs-keyword">this</span>.forceUpdate(); <span class="hljs-comment">//  view   </span>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//   view</span>
    <span class="hljs-keyword">public</span> render(): JSX.Element {
        <span class="hljs-keyword">return</span> (<font></font>
            &lt;&gt;<font></font>
                &lt;div className=<span class="hljs-string">"user"</span>&gt;<font></font>
                    &lt;div className=<span class="hljs-string">"user-name"</span>&gt;<font></font>
                         : {<span class="hljs-keyword">this</span>.userProfile.getFullname()}<font></font>
                    &lt;/div&gt;<font></font>
                    &lt;div className=<span class="hljs-string">"user-age"</span>&gt;<font></font>
                        : {<span class="hljs-keyword">this</span>.userProfile.getAge()}<font></font>
                    &lt;/div&gt;<font></font>
                &lt;/div&gt;<font></font>
                &lt;div className=<span class="hljs-string">"tarifs"</span>&gt;<font></font>
                    {<span class="hljs-comment">/*    */</span>}<font></font>
                &lt;/div&gt;<font></font>
            &lt;/&gt;<font></font>
        );<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...   ,   ,
     *  ,    
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al agregar solo dos l√≠neas y una plantilla de presentaci√≥n, nuestro controlador se convirti√≥ en un componente de reacci√≥n con l√≥gica de trabajo.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øPor qu√© se llama forceUpdate en lugar de setState?</font></font></b>
                        <div class="spoiler_text">     forceUpdate  ,   setState.          setState, Redux, mobX  .,          .  React  Preact  forceUpdate,   ChangeDetectorRef.detectChanges(),  Mithril  redraw   .         Observable   ,    MobX  Angular,   .         .<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero incluso en una implementaci√≥n de este tipo, result√≥ que est√°bamos vinculados a la biblioteca React con su ciclo de vida, la implementaci√≥n de la vista y el principio de invalidar la vista, lo que contradice el concepto de Arquitectura limpia. </font><font style="vertical-align: inherit;">Y la l√≥gica y el dise√±o est√°n en el mismo archivo, lo que complica el trabajo paralelo de la fuente y el desarrollador.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Separaci√≥n de controlador y vista</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para resolver ambos problemas, colocamos la capa de vista en un archivo separado y, en lugar del componente Reaccionar, hacemos el componente base que abstraer√° nuestro controlador de una biblioteca de presentaci√≥n espec√≠fica. </font><font style="vertical-align: inherit;">Al mismo tiempo, describimos los atributos que puede tomar el componente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recibimos los siguientes cambios:</font></font><br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageView. </font><font style="vertical-align: inherit;">Llevaron la vista a un archivo separado</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserPageOptions, UserPageController } from "./UserPageController";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> React from "react";</span><font></font>
<font></font>
export <span class="hljs-keyword">const</span> userPageView = &lt;P <span class="hljs-keyword">extends</span> UserPageOptions, S&gt;(<font></font>
    ctrl: UserPageController&lt;P, S&gt;,<font></font>
    props: P<font></font>
): JSX.Element =&gt; (<font></font>
    &lt;&gt;<font></font>
        &lt;div className=<span class="hljs-string">"user"</span>&gt;<font></font>
            &lt;div className=<span class="hljs-string">"user-name"</span>&gt;<font></font>
                 : {ctrl.userProfile.getFullname()}<font></font>
            &lt;/div&gt;<font></font>
            &lt;div className=<span class="hljs-string">"user-age"</span>&gt;<font></font>
                : {ctrl.userProfile.getAge()}<font></font>
            &lt;/div&gt;<font></font>
        &lt;/div&gt;<font></font>
        &lt;div className=<span class="hljs-string">"tarifs"</span>&gt;<font></font>
            {<span class="hljs-comment">/*    */</span>}<font></font>
        &lt;/div&gt;<font></font>
    &lt;/&gt;<font></font>
);<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageOptions. </font><font style="vertical-align: inherit;">Tomar vista y reaccionar a un archivo separado</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilService } from "./UserProfilService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffService } from "./TariffService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { InsuranceCaseDto } from "./InsuranceCasesDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { autowired } from "first-di";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { BaseComponent } from "./BaseComponent";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { userPageView } from "./UserPageview";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserPageOptions</span> </span>{<font></font>
    param1?: number;<font></font>
    param2?: string;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//    BaseComponent</span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPageController</span>&lt;<span class="hljs-title">P</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">UserPageOptions</span>, <span class="hljs-title">S</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseComponent</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> userProfile: UserProfileDto = <span class="hljs-keyword">new</span> UserProfileDto();
    <span class="hljs-keyword">public</span> insuranceCases: InsuranceCaseDto[] = [];
    <span class="hljs-keyword">public</span> tariffs: TariffDto[] = [];
    <span class="hljs-keyword">public</span> bestTariff: TariffDto | <span class="hljs-keyword">void</span> = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;<font></font>
<font></font>
    <span class="hljs-comment">//  </span>
    <span class="hljs-keyword">public</span> readonly view = userPageView;<font></font>
<font></font>
    @autowired()<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilService!: UserProfilService;<font></font>
<font></font>
    @autowired()<font></font>
    <span class="hljs-keyword">private</span> readonly tarifService!: TariffService;<font></font>
<font></font>
    <span class="hljs-comment">//  </span><font></font>
    constructor(props: P, context: S) {<font></font>
        <span class="hljs-keyword">super</span>(props, context);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//   componentDidMount, . BaseComponent</span>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.requestUserProfile();
        <span class="hljs-keyword">this</span>.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestUserProfile(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.userProfile = await <span class="hljs-keyword">this</span>.userProfilService.getUserProfile();
            <span class="hljs-keyword">this</span>.bestTariff = await <span class="hljs-keyword">this</span>.tarifService.findBestTariff(<span class="hljs-keyword">this</span>.userProfile);
            <span class="hljs-keyword">this</span>.forceUpdate();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.tariffs = await <span class="hljs-keyword">this</span>.tarifService.getTariffs();
            <span class="hljs-keyword">this</span>.forceUpdate();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...   ,   ,
     *  ,    
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Componente base </font><font style="vertical-align: inherit;">Un componente que nos abstrae de un marco particular.</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> React from "react";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BaseComponent</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; </span>{<font></font>
<font></font>
    <span class="hljs-comment">//  view</span>
    <span class="hljs-keyword">public</span> view?: (ctrl: <span class="hljs-keyword">this</span>, props: P) =&gt; JSX.Element;<font></font>
<font></font>
    constructor(props: P, context: S) {<font></font>
        <span class="hljs-keyword">super</span>(props, context);
        <span class="hljs-comment">//    </span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//      </span>
    <span class="hljs-keyword">public</span> componentDidMount(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.activate &amp;&amp; <span class="hljs-keyword">this</span>.activate();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//      </span>
    <span class="hljs-keyword">public</span> shouldComponentUpdate(<font></font>
        nextProps: Readonly&lt;P&gt;,<font></font>
        nextState: Readonly&lt;S&gt;,<font></font>
        nextContext: any<font></font>
    ): boolean {<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.update(nextProps, nextState, nextContext);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> componentWillUnmount(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.dispose();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-comment">//   </span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> update(nextProps: Readonly&lt;P&gt;, nextState: Readonly&lt;S&gt;, nextContext: any): boolean {
        <span class="hljs-comment">//   </span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> dispose(): <span class="hljs-keyword">void</span> {
        <span class="hljs-comment">//   </span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//   view</span>
    <span class="hljs-keyword">public</span> render(): React.ReactElement&lt;object&gt; {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.view) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.view(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.props);<font></font>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> React.createElement(<span class="hljs-string">"div"</span>, {}, <span class="hljs-string">"  "</span>);<font></font>
        }<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora nuestra vista est√° en un archivo separado, y el controlador no sabe nada al respecto, excepto que lo est√°. Tal vez no deber√≠a inyectar la vista a trav√©s de la propiedad del controlador, sino hacerlo a trav√©s del decorador como lo hace Angular, pero este es un tema para pensar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El componente b√°sico tambi√©n contiene una abstracci√≥n del ciclo de vida del marco. Son diferentes en todos los marcos, pero est√°n en todos los marcos. Angular es ngOnInit, ngOnChanges, ngOnDestroy. En React and Preact, este es componentDidMount, shouldComponentUpdate, componentWillUnmount. En Vue, esto se crea, actualiza, destruye. En Mithril es oncreate, onupdate, onremove. En WebComponents, esto est√° conectadoCallback, attributeChangedCallback, desconectadoCallback. Y as√≠ en todas las bibliotecas. La mayor√≠a incluso tiene la misma interfaz o una similar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s, ahora los componentes de la biblioteca se pueden ampliar con su propia l√≥gica para su posterior reutilizaci√≥n entre todos los componentes. </font><font style="vertical-align: inherit;">Por ejemplo, la introducci√≥n de herramientas para an√°lisis, monitoreo, registro, etc.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nos fijamos en el resultado</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solo queda evaluar lo que sucedi√≥. </font><font style="vertical-align: inherit;">Todo el programa tiene la siguiente forma final:</font></font><br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Main.ts. </font><font style="vertical-align: inherit;">El archivo desde el cual se inicia el programa</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { override } from "first-di";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilRepository } from "./UserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { MockUserProfilRepository } from "./MockUserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserPageController } from "./UserPageController";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> React from "react";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { render } from "react-dom";</span><font></font>
<font></font>
<span class="hljs-keyword">if</span> (process.env.NODE_ENV === <span class="hljs-string">"test"</span>) {
    <span class="hljs-keyword">override</span>(UserProfilRepository, MockUserProfilRepository);<font></font>
}<font></font>
<font></font>
render(React.createElement(UserPageController), document.body);<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageView. </font><font style="vertical-align: inherit;">Representaci√≥n de uno de los componentes del programa.</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserPageOptions, UserPageController } from "./UserPageController";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> React from "react";</span><font></font>
<font></font>
export <span class="hljs-keyword">const</span> userPageView = &lt;P <span class="hljs-keyword">extends</span> UserPageOptions, S&gt;(<font></font>
    ctrl: UserPageController&lt;P, S&gt;,<font></font>
    props: P<font></font>
): JSX.Element =&gt; (<font></font>
    &lt;&gt;<font></font>
        &lt;div className=<span class="hljs-string">"user"</span>&gt;<font></font>
            &lt;div className=<span class="hljs-string">"user-name"</span>&gt;<font></font>
                 : {ctrl.userProfile.getFullname()}<font></font>
            &lt;/div&gt;<font></font>
            &lt;div className=<span class="hljs-string">"user-age"</span>&gt;<font></font>
                : {ctrl.userProfile.getAge()}<font></font>
            &lt;/div&gt;<font></font>
        &lt;/div&gt;<font></font>
        &lt;div className=<span class="hljs-string">"tarifs"</span>&gt;<font></font>
            {<span class="hljs-comment">/*    */</span>}<font></font>
        &lt;/div&gt;<font></font>
    &lt;/&gt;<font></font>
);<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageController. </font><font style="vertical-align: inherit;">La l√≥gica de uno de los componentes para la interacci√≥n del usuario.</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilService } from "./UserProfilService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffService } from "./TariffService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { InsuranceCaseDto } from "./InsuranceCasesDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { autowired } from "first-di";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { BaseComponent } from "./BaseComponent";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { userPageView } from "./UserPageview";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserPageOptions</span> </span>{<font></font>
    param1?: number;<font></font>
    param2?: string;<font></font>
}<font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPageController</span>&lt;<span class="hljs-title">P</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">UserPageOptions</span>, <span class="hljs-title">S</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseComponent</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> userProfile: UserProfileDto = <span class="hljs-keyword">new</span> UserProfileDto();
    <span class="hljs-keyword">public</span> insuranceCases: InsuranceCaseDto[] = [];
    <span class="hljs-keyword">public</span> tariffs: TariffDto[] = [];
    <span class="hljs-keyword">public</span> bestTariff: TariffDto | <span class="hljs-keyword">void</span> = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;<font></font>
<font></font>
    <span class="hljs-keyword">public</span> readonly view = userPageView;<font></font>
<font></font>
    @autowired()<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilService!: UserProfilService;<font></font>
<font></font>
    @autowired()<font></font>
    <span class="hljs-keyword">private</span> readonly tarifService!: TariffService;<font></font>
<font></font>
    <span class="hljs-comment">//   componentDidMount, . BaseComponent</span>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.requestUserProfile();
        <span class="hljs-keyword">this</span>.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestUserProfile(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.userProfile = await <span class="hljs-keyword">this</span>.userProfilService.getUserProfile();
            <span class="hljs-keyword">this</span>.bestTariff = await <span class="hljs-keyword">this</span>.tarifService.findBestTariff(<span class="hljs-keyword">this</span>.userProfile);
            <span class="hljs-keyword">this</span>.forceUpdate();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.tariffs = await <span class="hljs-keyword">this</span>.tarifService.getTariffs();
            <span class="hljs-keyword">this</span>.forceUpdate();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...   ,   ,
     *  ,    
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Componente base </font><font style="vertical-align: inherit;">Clase base para todos los componentes del programa.</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> React from "react";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BaseComponent</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> view?: (ctrl: <span class="hljs-keyword">this</span>, props: P) =&gt; JSX.Element;<font></font>
<font></font>
    constructor(props: P, context: S) {<font></font>
        <span class="hljs-keyword">super</span>(props, context);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> componentDidMount(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.activate &amp;&amp; <span class="hljs-keyword">this</span>.activate();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> shouldComponentUpdate(<font></font>
        nextProps: Readonly&lt;P&gt;,<font></font>
        nextState: Readonly&lt;S&gt;,<font></font>
        nextContext: any<font></font>
    ): boolean {<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.update(nextProps, nextState, nextContext);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> componentWillUnmount(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.dispose();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-comment">//   </span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> update(nextProps: Readonly&lt;P&gt;, nextState: Readonly&lt;S&gt;, nextContext: any): boolean {
        <span class="hljs-comment">//   </span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> dispose(): <span class="hljs-keyword">void</span> {
        <span class="hljs-comment">//   </span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> render(): React.ReactElement&lt;object&gt; {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.view) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.view(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.props);<font></font>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> React.createElement(<span class="hljs-string">"div"</span>, {}, <span class="hljs-string">"  "</span>);<font></font>
        }<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilService. </font><font style="vertical-align: inherit;">Servicio para reutilizar la l√≥gica entre componentes para trabajar con un perfil de usuario</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilRepository } from "./UserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilService</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilRepository: UserProfilRepository;<font></font>
<font></font>
    constructor(userProfilRepository: UserProfilRepository) {<font></font>
        <span class="hljs-keyword">this</span>.userProfilRepository = userProfilRepository;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; {
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.userProfilRepository.getUserProfile();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servicio Arancelario. </font><font style="vertical-align: inherit;">Servicio para reutilizar l√≥gica entre componentes para trabajar con tarifas</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffRepository } from "./TariffRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffService</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> readonly tarifRepository: TariffRepository;<font></font>
<font></font>
    constructor(tarifRepository: TariffRepository) {<font></font>
        <span class="hljs-keyword">this</span>.tarifRepository = tarifRepository;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getTariffs(): Promise&lt;TariffDto[]&gt; {
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.tarifRepository.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async findBestTariff(userProfile: UserProfileDto): Promise&lt;TariffDto | <span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">const</span> tariffs = await <span class="hljs-keyword">this</span>.tarifRepository.requestTariffs();
        <span class="hljs-keyword">return</span> tariffs.find((tarif: TariffDto) =&gt; {
            <span class="hljs-keyword">const</span> age = userProfile.getAge();
            <span class="hljs-keyword">return</span> age &amp;&amp;<font></font>
                tarif.ageFrom &lt;= age &amp;&amp;<font></font>
                age &lt; tarif.ageTo;<font></font>
        });<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...       
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilRepository. </font><font style="vertical-align: inherit;">Repositorio para recibir un perfil del servidor, verificarlo y validarlo</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilRepository</span> </span>{
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; {
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/user-profile"</span>);
        <span class="hljs-keyword">const</span> object = await response.json();
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> UserProfileDto().fromJSON(object);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">MockUserProfilRepository.         </b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection <span class="hljs-comment">//  typescript  </span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MockUserProfilRepository</span> </span>{ <span class="hljs-comment">//   </span>
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; {
        <span class="hljs-keyword">const</span> profile = <span class="hljs-keyword">new</span> UserProfileDto();<font></font>
        profile.firstName = <span class="hljs-string">""</span>;<font></font>
        profile.lastName = <span class="hljs-string">""</span>;<font></font>
        profile.birthdate = <span class="hljs-keyword">new</span> Date(Date.now() - <span class="hljs-number">1.5e12</span>);
        <span class="hljs-keyword">return</span> Promise.resolve(profile); <span class="hljs-comment">//   </span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">TariffRepository.      ,    </b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection <span class="hljs-comment">//  typescript  </span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffRepository</span> </span>{
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;TariffDto[]&gt; {
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/tariffs"</span>);
        <span class="hljs-keyword">const</span> objects: object[] = await response.json();
        <span class="hljs-keyword">return</span> objects.map((object: object) =&gt; {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> TariffDto().fromJSON(object);<font></font>
        });<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">UserProfileDto.           </b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { Serializable, jsonProperty } from "ts-serializable";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfileDto</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Serializable</span> </span>{<font></font>
<font></font>
    @jsonProperty(String, <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">public</span> firstName: string | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    @jsonProperty(String, <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">public</span> lastName: string | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    @jsonProperty(Date, <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">public</span> birthdate: Date | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    <span class="hljs-keyword">public</span> getAge(): number | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.birthdate) {
            <span class="hljs-keyword">const</span> ageDifMs = Date.now() - <span class="hljs-keyword">this</span>.birthdate.getTime();
            <span class="hljs-keyword">const</span> ageDate = <span class="hljs-keyword">new</span> Date(ageDifMs);
            <span class="hljs-keyword">return</span> Math.abs(ageDate.getUTCFullYear() - <span class="hljs-number">1970</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> getFullname(): string | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">return</span> [
            <span class="hljs-keyword">this</span>.firstName ?? <span class="hljs-string">""</span>,
            <span class="hljs-keyword">this</span>.lastName ?? <span class="hljs-string">""</span><font></font>
        ]<font></font>
            .join(<span class="hljs-string">" "</span>)<font></font>
            .trim() || <span class="hljs-literal">null</span>;<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">TariffDto.           </b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { Serializable, jsonProperty } from "ts-serializable";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffDto</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Serializable</span> </span>{<font></font>
<font></font>
    @jsonProperty(Number, <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">public</span> ageFrom: number = <span class="hljs-number">0</span>;<font></font>
<font></font>
    @jsonProperty(Number, <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">public</span> ageTo: number = <span class="hljs-number">0</span>;<font></font>
<font></font>
    @jsonProperty(Number, <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">public</span> price: number = <span class="hljs-number">0</span>;<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, obtuvimos una aplicaci√≥n escalable modular con una cantidad muy peque√±a de repetitivo (1 componente b√°sico, 3 l√≠neas para implementar dependencias por clase) y una sobrecarga muy baja (en realidad solo para implementar dependencias, todo lo dem√°s es l√≥gico). </font><font style="vertical-align: inherit;">Adem√°s, no estamos vinculados a ninguna biblioteca de presentaci√≥n. </font><font style="vertical-align: inherit;">Cuando Angular 1 muri√≥, muchos comenzaron a reescribir aplicaciones en React. </font><font style="vertical-align: inherit;">Cuando los desarrolladores de Angular 2 se agotaron, muchas compa√±√≠as comenzaron a sufrir debido a la velocidad de desarrollo. </font><font style="vertical-align: inherit;">Cuando React muera nuevamente, tendr√° que reescribir las soluciones vinculadas a su marco y ecosistema. </font><font style="vertical-align: inherit;">Pero con Chita Architecture puede olvidarse de atar el marco.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øCu√°l es la ventaja sobre Redux?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para entender la diferencia, veamos c√≥mo se comporta Redux cuando la aplicaci√≥n crece. </font></font><br>
<img src="https://habrastorage.org/webt/jj/i9/cc/jji9ccsijjqancrthtv9gpudc48.png" alt="Redux"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como puede ver en el diagrama, con el crecimiento de las aplicaciones de Redux escaladas verticalmente, la Tienda y el n√∫mero de Reductores tambi√©n aumenta y se convierte en un cuello de botella. Y la cantidad de gastos generales para reconstruir la Tienda y encontrar el Reductor correcto est√° comenzando a exceder la carga √∫til. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede verificar la relaci√≥n entre gastos generales y carga √∫til en una aplicaci√≥n de tama√±o mediano con una simple prueba.</font></font><br>
<pre><code class="actionscript hljs">let create = <span class="hljs-keyword">new</span> Function([
<span class="hljs-string">"return {"</span>,<font></font>
...new Array(<span class="hljs-number">100</span>).fill(<span class="hljs-number">1</span>).map((val, ind) =&gt; `param${ind}:${ind},`),
<span class="hljs-string">"}"</span>
].join(<span class="hljs-string">""</span>));<font></font>
<font></font>
let obj1 = create();<font></font>
<font></font>
console.time(<span class="hljs-string">"store recreation time"</span>);<font></font>
let obj2 = {<font></font>
    ...obj1,<font></font>
    param100: <span class="hljs-number">100</span> ** <span class="hljs-number">2</span><font></font>
}<font></font>
console.timeEnd(<span class="hljs-string">"store recreation time"</span>);<font></font>
<font></font>
console.time(<span class="hljs-string">"clear logic"</span>);<font></font>
let val = <span class="hljs-number">100</span> ** <span class="hljs-number">2</span>;<font></font>
console.timeEnd(<span class="hljs-string">"clear logic"</span>);<font></font>
<font></font>
console.log(obj2, val);<font></font>
<font></font>
<span class="hljs-comment">// store recreation time: 0.041015625ms</span>
<span class="hljs-comment">// clear logic: 0.0048828125ms</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Volver a crear la Tienda en 100 propiedades tom√≥ 8 veces m√°s tiempo que la l√≥gica misma. Con 1000 elementos, esto ya es 50 veces m√°s. Adem√°s, una acci√≥n del usuario puede generar toda una cadena de acciones, cuya llamada es dif√≠cil de atrapar y depurar. Ciertamente, puede argumentar que 0.04 ms para recrear la Tienda es muy peque√±o y no se ralentizar√°. Pero 0.04 ms est√° en el procesador Core i7 y para una acci√≥n. Dado que los procesadores m√≥viles m√°s d√©biles y el hecho de que una sola acci√≥n del usuario puede generar docenas de acciones, todo esto lleva al hecho de que los c√°lculos no caben en 16 ms y se crea la sensaci√≥n de que la aplicaci√≥n se est√° ralentizando. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comparemos c√≥mo crece la aplicaci√≥n Clean Architecture:</font></font><br>
<img src="https://habrastorage.org/webt/oz/eg/uk/ozegukclnowpqlzdnckk3pfkckc.png" alt="Arquitectura pura"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como se puede ver debido a la separaci√≥n de la l√≥gica y las responsabilidades entre las capas, la aplicaci√≥n se escala horizontalmente. </font><font style="vertical-align: inherit;">Si alg√∫n componente necesita procesar los datos, recurrir√° al servicio correspondiente sin tocar los servicios no relacionados con su tarea. </font><font style="vertical-align: inherit;">Despu√©s de recibir los datos, solo se volver√° a dibujar un componente. </font><font style="vertical-align: inherit;">La cadena de procesamiento de datos es muy corta y obvia, y para un m√°ximo de 4 saltos de c√≥digo, puede encontrar la l√≥gica necesaria y depurarla. </font><font style="vertical-align: inherit;">Adem√°s, si dibujamos una analog√≠a con un muro de ladrillos, entonces podemos eliminar cualquier ladrillo de este muro y reemplazarlo por otro sin afectar la estabilidad de este muro.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonus 1: funcionalidad mejorada de los componentes del framework</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Una ventaja adicional era la capacidad de complementar o cambiar el comportamiento de los componentes de la biblioteca de presentaci√≥n. </font><font style="vertical-align: inherit;">Por ejemplo, una reacci√≥n en caso de un error en la vista no representa la aplicaci√≥n completa, si se realiza una peque√±a revisi√≥n:</font></font><br>
<pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BaseComponent</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; </span>{<font></font>
<font></font>
    ...<font></font>
<font></font>
    public render(): React.ReactElement&lt;object&gt; {<font></font>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.view) {
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.view(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.props);<font></font>
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> React.createElement(<span class="hljs-string">"div"</span>, {}, <span class="hljs-string">"  "</span>);<font></font>
            }<font></font>
        } <span class="hljs-keyword">catch</span> (e) {
            <span class="hljs-keyword">return</span> React.createElement(
                <span class="hljs-string">"div"</span>,<font></font>
                { style: { color: <span class="hljs-string">"red"</span> } },<font></font>
                `    : ${e}`<font></font>
            );<font></font>
        }<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora la reacci√≥n no dibujar√° solo el componente en el que ocurri√≥ el error. </font><font style="vertical-align: inherit;">De la misma manera simple, puede agregar monitoreo, an√°lisis y otros nishtyaki.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonus 2: Validaci√≥n de datos</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s de describir datos y transferir datos entre capas, los modelos tienen un gran margen de oportunidad. </font><font style="vertical-align: inherit;">Por ejemplo, si conecta la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">biblioteca de validaci√≥n de clase</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , simplemente colgando los decoradores, puede validar los datos en estos modelos, incluidos </font><font style="vertical-align: inherit;">con un poco de refinamiento, puede validar formularios web.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonus 3: Crear entidades</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s, si necesita trabajar con una base de datos local, puede conectar la biblioteca de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tipos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y sus modelos se convertir√°n en entidades mediante las cuales se generar√° y ejecutar√° la base de datos.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gracias por la atenci√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si le gust√≥ el art√≠culo o el enfoque, haga clic en Me gusta y no tenga miedo de experimentar. </font><font style="vertical-align: inherit;">Si es un experto en Redux y no le gusta la disidencia, explique en los comentarios c√≥mo escala, prueba y valida los datos en su aplicaci√≥n.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es493418/index.html">¬øPor qu√© el aprendizaje autom√°tico utiliza datos "sint√©ticos"?</a></li>
<li><a href="../es493420/index.html">Mi manera de presentar a los estudiantes de secundaria a Python</a></li>
<li><a href="../es493424/index.html">Implementamos conversiones de c√≥digo Python</a></li>
<li><a href="../es493426/index.html">Organizaci√≥n de c√≥digo en microservicios y mi enfoque de usar arquitectura hexagonal y DDD</a></li>
<li><a href="../es493428/index.html">"No daremos lugar a teor√≠as de conspiraci√≥n". Hable sobre conferencias de ML con personas de compa√±√≠as de ciencia y TI</a></li>
<li><a href="../es493432/index.html">¬øPor qu√© no comenzar una carrera en una peque√±a empresa que no es de TI?</a></li>
<li><a href="../es493436/index.html">Programa para cambiar los derechos de acceso y el registro de nombres de archivo / directorio en Bash</a></li>
<li><a href="../es493438/index.html">Mostrar resultados de b√∫squeda y problemas de rendimiento</a></li>
<li><a href="../es493440/index.html">Influencer Marketing en China: en qu√© se basa y qu√© pueden ofrecer los influencers en el contexto de emergencias</a></li>
<li><a href="../es493442/index.html">Recordatorio de PPE</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>