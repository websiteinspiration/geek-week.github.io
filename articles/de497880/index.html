<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🦍 ♏️ 👨🏿‍🌾 Produktion von Material Icons für MacOSX Home Assistant auf Electron 🈴 👃🏾 👦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In der ersten Serie habe ich mit dem Home Assistant ein Smart Home gebraut. Dabei habe ich mich in den Home Assistant verliebt und darüber nachgedacht...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Produktion von Material Icons für MacOSX Home Assistant auf Electron</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497880/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ersten Serie habe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ich mit dem Home Assistant ein Smart Home gebraut. Dabei habe ich mich in den Home Assistant verliebt und darüber nachgedacht, eine Desktop-Anwendung für dieses System zu schreiben. Home Assitant hat eine wunderbare webbasierte Oberfläche und es schien vernünftig, sie in Electron zu verpacken, um ein schönes Dock-Symbol, native Benachrichtigungen, eine Menüleiste für den schnellen Zugriff und andere Null-Konferenzen zu erhalten. Home Assistant für alles, was verwendet werden kann Materialsymbole: für Dashboards, für Status, für Schaltflächen, für alles. Dies bedeutet, dass Sie den gesamten Satz von Materialsymbolen in die Electron-Anwendung ziehen müssen.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Electron verwendet die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nativeImage-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> API, um mit Bildern zu arbeiten </font><font style="vertical-align: inherit;">, die im Jahr 2020 keine Vektorformate akzeptiert und nur PNG und JPG verwendet. JPG ist für uns nicht geeignet, da die Komprimierungsartefakte für die Symbole tödlich sind. Sie benötigen also einen Ort, an dem das Format in PNG übertragen werden kann. Klettern auf die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Home - </font><font style="vertical-align: inherit;">Site von Material Symbolen für</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> etwa 15 Minuten war ich für ein fertiges Paket von Material Icons für MacOSX Schnitt suche in in verschiedenen Größen png und unter verschiedenen dpi ... Es ist schwer , </font><font style="vertical-align: inherit;">warum zu sagen, aber sie nicht veröffentlicht so etwas gibt. Muss unabhängig produzieren. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Home Assistant</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bietet an, in Konfigurationssymbolen Symbole im Format „mdi: home-cirlce“ zu deklarieren - den Namen des Symbols ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">von hier aus)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) mit der Ersetzung des ersten Zeichens '-' durch ':'. </font><font style="vertical-align: inherit;">Ersetzen Sie "-" =&gt; ":" Wir konvertieren programmgesteuert, um näher am Original zu sein, und haben die Zeichen ":" in den Dateinamen nicht verwendet. </font><font style="vertical-align: inherit;">Der erste Ort, an dem ich die Symbole anschrauben wollte, war das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Home Assistant-Dashboard-Menü</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Für die Menüleiste verwendet macosx Bilder mit 16 x 16 Pixeln und @ 2 für die Netzhaut (vielleicht mehr, @ 2 war genug auf meiner Mohnblume). </font><font style="vertical-align: inherit;">Ich muss also zwei Dateien für jedes Symbol aus dem Materialsatz abrufen:</font></font><br>
<br>
<pre><code class="bash hljs">mdi-icon-name16.png<font></font>
mdi-icon-name16@2.png<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dem Namen wurde eine Größe hinzugefügt, damit das Hinzufügen neuer Bildgrößen das Gehen in Zukunft nicht beeinträchtigt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die endgültigen Schriftarten werden normalerweise aus SVG-Bildern gesammelt. Dies führte zu zwei Aufgaben: 1 - Finden von SVG-Materialsymbolen, 2 - Automatisieren des Schneidens für&gt; 5000 Dateien. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die native Site war immer noch nützlich, dort fand ich den Befehl „npm install</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mdi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ font. " </font><font style="vertical-align: inherit;">Durch zufälliges Ersetzen von svg anstelle von font durch den Befehl „npm install</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mdi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ svg ”Wir haben den gesamten Satz von Materialsymbolen ordentlich im selben Verzeichnis node_modules / @ mdi / svg / svg / mit Namen wie mdi-icon-name.svg. </font><font style="vertical-align: inherit;">Der bekannte ImageMagick zeigte eine extrem niedrige Qualität der resultierenden Bilder, das Dienstprogramm svg2png funktionierte noch schlechter. </font><font style="vertical-align: inherit;">Der gute Stackoverflow deutete jedoch darauf hin, dass </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inkscape</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diese Aufgabe </font><font style="vertical-align: inherit;">mit einem solchen Befehl </font><font style="vertical-align: inherit;">bewältigen </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">würde</font></a></font><br>
<br>
<pre><code class="bash hljs">inkscape -w 16 -h 16 node_modules/@mdi/svg/svg/ab-testing.svg \<font></font>
    -o images/mdi-ab-testing16.png</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Ergebnis erwies sich als zufriedenstellend. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/h7/u5/3w/h7u53wlvlxmjfgh5gf8hdkcrajm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine genauere Untersuchung ergab jedoch, dass solche Symbole im Dunklen Modus langweilig aussehen: Auf der </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ag/k_/tj/agk_tjmhekpylck8-0y9nv2w6fc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apple-Website wurde ein spezielles </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vorlagenformat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erfunden </font><font style="vertical-align: inherit;">, mit dem die Bilder ohne große Schwierigkeiten invertiert werden können, wenn das Schicksal sie in den Dunklen Modus versetzt. </font><font style="vertical-align: inherit;">Die Rolle solcher Dateien ist ein PNG-Bild, in dem alle Pixel schwarz sind und das Symbol selbst transparent gezeichnet ist (auf dem Alphakanal). </font><font style="vertical-align: inherit;">Gleichzeitig kann Electron solche Bilder aufnehmen, wenn der Name eine „Vorlage“ enthält. </font><font style="vertical-align: inherit;">Also müssen zwei weitere Dateien mit Symbolen hinzugefügt werden, zwei weitere mit Vorlagensymbolen. Wir erhalten diesen Satz für jedes Symbol:</font></font><br>
<br>
<pre><code class="bash hljs">mdi-icon-name16.png<font></font>
mdi-icon-name16@2.png<font></font>
mdi-icon-name16Template.png<font></font>
mdi-icon-name16Template@2.png<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inkscape kann mit dem Alpha-Kanal von der Konsole aus keine Wunder vollbringen, aber es ist einfach, von ImageMagick aus zu konvertieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir machen in drei Schritten:</font></font><br>
<br>
<pre><code class="bash hljs">inkscape -w 16 -h 16 \<font></font>
    node_modules/@mdi/svg/svg/ab-testing.svg \<font></font>
    -o images/mdi-ab-testing16.png<font></font>
convert -size 16x16 xc:none images/background16.png<font></font>
convert -verbose -composite images/background16.png \<font></font>
    images/mdi-ab-testing16.png -compose CopyAlpha \<font></font>
    menuicons/ab-testingTemplate16.png</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1 - Erstellen eines Bitmap-Bildes aus einem Vektor </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2 - Erstellen eines transparenten Bildes für Schritt 3 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3 - Erstellen einer Datei mit der Übertragung von Graustufen auf den Alphakanal </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bereits mit den Symbolen des Vorlagenmenüs im Dunkelmodus sah es so aus. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mj/g4/w7/mjg4w7raoh9flq3szdvkgllte9a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ok, das Ziel ist erreicht. </font><font style="vertical-align: inherit;">Das Skript destilliert alle Bilder in den gewünschten Formaten</font></font><br>
<br>
<pre><code class="bash hljs">
<span class="hljs-comment">#!/bin/sh -x</span><font></font>
<font></font>
<span class="hljs-built_in">set</span> -e<font></font>
<font></font>
<span class="hljs-comment"># Run 'npm install @mdi/svg' beforehead</span>
MDISVG_PATH=<span class="hljs-string">'node_modules/@mdi/svg/svg/'</span><font></font>
<font></font>
<span class="hljs-comment">#Put inkscape and convert into PATH</span>
PATH=<span class="hljs-variable">$PATH</span>:/Applications/Inkscape.app/Contents/MacOS/<font></font>
<font></font>
mkdir -p images<font></font>
convert -size 32x32 xc:none images/background16@2x.png<font></font>
convert -size 16x16 xc:none images/background16.png<font></font>
<font></font>
SIZES=<span class="hljs-string">"
16,16
32,16@2x
"</span>
FILES=`ls <span class="hljs-variable">${MDISVG_PATH}</span> |grep svg`
<span class="hljs-keyword">for</span> SVG <span class="hljs-keyword">in</span> <span class="hljs-variable">$FILES</span>; <span class="hljs-keyword">do</span>
    BASE=$(basename <span class="hljs-string">"<span class="hljs-variable">$SVG</span>"</span> | sed <span class="hljs-string">'s/\.[^\.]*$//'</span>)
    <span class="hljs-keyword">for</span> PARAMS <span class="hljs-keyword">in</span> <span class="hljs-variable">$SIZES</span>; <span class="hljs-keyword">do</span>
        SIZE=$(<span class="hljs-built_in">echo</span> <span class="hljs-variable">$PARAMS</span> | cut -d, -f1)<font></font>
        LABEL=$(<span class="hljs-built_in">echo</span> <span class="hljs-variable">$PARAMS</span> | cut -d, -f2)<font></font>
        inkscape -w <span class="hljs-variable">$SIZE</span> -h <span class="hljs-variable">$SIZE</span> <span class="hljs-string">"<span class="hljs-variable">$MDISVG_PATH</span>/<span class="hljs-variable">$SVG</span>"</span> \<font></font>
            -o <span class="hljs-string">"images/mdi-<span class="hljs-variable">${BASE}</span><span class="hljs-variable">${LABEL}</span>"</span>.png<font></font>
        convert -verbose \<font></font>
            -composite images/background<span class="hljs-variable">${LABEL}</span>.png <span class="hljs-string">"images/mdi-<span class="hljs-variable">${BASE}</span><span class="hljs-variable">${LABEL}</span>"</span>.png \<font></font>
            -compose CopyAlpha \<font></font>
            <span class="hljs-string">"images/<span class="hljs-variable">${BASE}</span>Template<span class="hljs-variable">${LABEL}</span>"</span>.png
    <span class="hljs-keyword">done</span>
<span class="hljs-keyword">done</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir warten ein paar Stunden, bis&gt; 20.000 Bilder vom Band </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
laufen </font><font style="vertical-align: inherit;">... </font><font style="vertical-align: inherit;">PS Dies sind nicht die einzigen Abenteuer bei der Arbeit mit Electron, ich werde über weitere Abenteuer schreiben, sobald sie abgeschlossen sind ...</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de497870/index.html">Computerviren: eine Geschichte von harmlosen Hausspionen bis hin zu Bankkartendieben</a></li>
<li><a href="../de497872/index.html">Ungewöhnliche und ganz offensichtliche Faktoren, die den Verkehr von Unternehmensnetzwerken und die Arbeit von Anbietern beeinflussen</a></li>
<li><a href="../de497874/index.html">David Heinemeyer Hansson (Basecamp, ReWork, Ruby on Rails) über die Funktionsweise</a></li>
<li><a href="../de497876/index.html">[Lesezeichen] Arbeiten mit Bildern im Web</a></li>
<li><a href="../de497878/index.html">Installieren Sie die GPL-Version von HPL mit OpenBLAS</a></li>
<li><a href="../de497882/index.html">Wie bekomme ich ein Interview oder warum bist du nicht eingestellt?</a></li>
<li><a href="../de497886/index.html">IOS-Feldvalidierung - schnell und einfach</a></li>
<li><a href="../de497890/index.html">Microsoft 365 Virtual Training Day: Tauchen Sie in Microsoft-Teams ein</a></li>
<li><a href="../de497894/index.html">Microsoft Azure Virtual Training Day: Modernes Data Warehouse</a></li>
<li><a href="../de497896/index.html">Wir bewahren die Sicht an einem entfernten Standort mit einem Projektor anstelle eines Monitors - einige nicht offensichtliche Nuancen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>