<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëßüèø üíñ ‚åõÔ∏è Bagaimana Ryuk ransomware yang menyerang perusahaan üíô üëÅÔ∏è üòò</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ryuk adalah salah satu opsi ransomware paling terkenal dalam beberapa tahun terakhir. Sejak pertama kali muncul di musim panas 2018, ia telah menyusun...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Bagaimana Ryuk ransomware yang menyerang perusahaan</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497696/"><img src="https://habrastorage.org/webt/wc/6r/b3/wc6rb3xxu-e_aw_mg1pxcy_23yq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ryuk adalah salah satu opsi ransomware paling terkenal dalam beberapa tahun terakhir. </font><font style="vertical-align: inherit;">Sejak pertama kali muncul di musim panas 2018, ia telah menyusun </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">daftar korban yang mengesankan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , terutama di lingkungan bisnis, yang merupakan target utama serangannya.</font></font><a name="habracut"></a><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Informasi umum</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dokumen ini berisi analisis opsi ransomware Ryuk, serta bootloader yang bertanggung jawab untuk mengunduh malware ke sistem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ryuk ransomware pertama kali muncul pada musim panas 2018. Salah satu perbedaan antara Ryuk dan ransomware lainnya adalah bertujuan untuk menyerang lingkungan perusahaan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada pertengahan 2019, kelompok-kelompok kejahatan cyber menyerang sejumlah besar perusahaan Spanyol dengan bantuan cryptor ini. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/x5/ax/et/x5axetxacru5kb7h6er1vagmdqy.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. </font></font><br>
</i><br>
<img src="https://habrastorage.org/webt/oc/kn/ee/ockneevf4elmwczdwsmimtsvnuk.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar </font></font><br>
</i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">1: Kutipan dari El Confidencial mengenai serangan Ryuk ransomware [1] </font></i><i><font style="vertical-align: inherit;">2: Kutipan dari El Pa√≠s tentang serangan Ryuk ransomware [2]</font></i></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Tahun ini, Ryuk menyerang sejumlah besar perusahaan di berbagai negara. Seperti yang Anda lihat pada gambar di bawah ini, Jerman, Cina, Aljazair, dan India paling menderita.</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Membandingkan jumlah serangan dunia maya, kita dapat melihat bahwa jutaan pengguna dipengaruhi oleh Ryuk dan sejumlah besar data dikompromikan, mengakibatkan kerusakan ekonomi yang serius. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-p/4u/y-/-p4uy-fnectlv0mqwtvupfa--vc.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 3: Ilustrasi aktivitas global Ryuk. </font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/sq/oe/hm/sqoehmto6enrwgz6kjt4_sdpgz0.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 4: 16 negara yang paling terpengaruh oleh Ryuk </font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/qj/1_/d2/qj1_d2eze5bigcd0gqvvrwiw9ns.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 5: Jumlah pengguna yang diserang oleh Ryuk ransomware (dalam jutaan)</font></font><br>
</i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Menurut prinsip operasi ancaman seperti itu, ransomware ini setelah enkripsi menunjukkan kepada korban pemberitahuan tebusan yang harus dibayarkan dalam bitcoin ke alamat yang ditentukan untuk memulihkan akses ke file yang dienkripsi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malware ini telah berubah sejak pertama kali muncul.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Varian ancaman ini dianalisis dalam dokumen ini ditemukan selama upaya untuk meluncurkan serangan pada Januari 2020. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena kerumitannya, malware ini sering dikaitkan dengan penjahat cyber terorganisir, juga dikenal sebagai kelompok APT. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagian dari kode Ryuk memiliki kemiripan yang nyata dengan kode dan struktur kriptografer Hermes terkenal lainnya, yang dengannya mereka memiliki sejumlah fungsi yang identik. Itulah sebabnya Ryuk awalnya dikaitkan dengan kelompok Korea Utara Lazarus, yang pada saat itu diduga berada di belakang ransomware Hermes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya, CrowdStrike's Falcon X mencatat bahwa Ryuk sebenarnya diciptakan oleh WIZARD SPIDER [4].</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada beberapa bukti yang mendukung asumsi ini. Pertama, ransomware ini diiklankan di situs exploit.in, yang merupakan pasar malware Rusia yang terkenal dan sebelumnya dikaitkan dengan beberapa grup APT Rusia. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fakta ini mengecualikan teori bahwa Ryuk dapat dikembangkan oleh kelompok Lazarus APT, sebagai ini tidak cocok dengan cara kelompok itu bertindak.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain itu, Ryuk disebut-sebut sebagai enkripsi yang tidak akan bekerja pada sistem Rusia, Ukraina, dan Belarusia. Perilaku ini ditentukan oleh fungsi yang ditemukan di beberapa versi Ryuk, di mana ia memeriksa bahasa sistem di mana enkripsi ini berjalan dan menghentikan operasinya jika sistem memiliki bahasa Rusia, Ukraina atau Belarusia. Akhirnya, ketika melakukan analisis ahli dari mesin yang diretas oleh kelompok WIZARD SPIDER, beberapa "artefak" ditemukan yang seharusnya digunakan dalam pengembangan Ryuk sebagai varian dari ransomware Hermes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sisi lain, para ahli Gabriela Nicolao dan Luciano Martins menyarankan bahwa cryptographer mungkin telah dikembangkan oleh tim APT CryptoTech [5].</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini mengikuti fakta bahwa beberapa bulan sebelum kemunculan Ryuk, grup ini memposting informasi di forum situs yang sama yang mereka kembangkan versi baru dari ransomware Hermes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beberapa pengguna forum bertanya-tanya apakah CryptoTech benar-benar menciptakan Ryuk. </font><font style="vertical-align: inherit;">Setelah itu, kelompok ini membela diri dan menyatakan bahwa mereka memiliki bukti bahwa mereka telah mengembangkan 100% dari enkripsi ini.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Karakteristik</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kita mulai dengan bootloader, yang tugasnya adalah mengidentifikasi sistem di mana ia berada, sehingga Anda dapat menjalankan versi "yang benar" dari enkripsi Ryuk. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hash bootloader adalah sebagai berikut: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MD5 A73130B0E379A989CBA3D695A157A495 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SHA256 EF231EE1A2481B7E627921468E79BB4369CCFAEB19A575748DD2B664ABC4F469 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Salah satu fitur dari </font><font style="vertical-align: inherit;">boot </font><font style="vertical-align: inherit;">ini tidak berisi fitur apa pun yang tidak memiliki </font><font style="vertical-align: inherit;">boot </font><font style="vertical-align: inherit;">pada bootloadan - tidak ada fitur pada bootloader ini - tidak ada fitur pada </font><font style="vertical-align: inherit;">boot ini </font><font style="vertical-align: inherit;">- tidak ada fitur untuk bootload pembuat malware ini tidak memasukkan informasi apa pun di dalamnya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terkadang mereka memasukkan data yang salah untuk membuat pengguna berpikir bahwa ia diduga meluncurkan aplikasi yang sah. </font><font style="vertical-align: inherit;">Namun, seperti yang akan kita lihat nanti, jika infeksi tidak melibatkan interaksi dengan pengguna (seperti halnya dengan enkripsi ini), maka penyerang tidak menganggap perlu untuk menggunakan meta-data. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rj/zx/yu/rjzxyuaec1nfxajxzwufks4hb0w.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. </font><font style="vertical-align: inherit;">6:</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sampel </font><i><font style="vertical-align: inherit;">data meta Sampel</font></i><font style="vertical-align: inherit;"> dikompilasi dalam format 32-bit sehingga dapat dijalankan pada sistem 32-bit dan 64-bit.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Vektor penetrasi</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sampel yang mengunduh dan meluncurkan Ryuk memasuki sistem kami melalui koneksi jarak jauh, dan parameter akses diperoleh berkat serangan RDP awal. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pt/jd/bj/ptjdbj8ce7mgfuy8vowq8gogitm.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 7: Serang Registry</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Penyerang berhasil masuk ke sistem dari jarak jauh. Setelah itu, ia membuat file yang dapat dieksekusi dengan sampel kami. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
File yang dapat dieksekusi ini diblokir oleh solusi antivirus sebelum diluncurkan. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ez/gj/gq/ezgjgq4iagc2lep3pebhom5cox0.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 8: Memblokir sampel </font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/tg/zv/-k/tgzv-keet96r81465eywpeahn8a.jpeg"><br>
<img src="https://habrastorage.org/webt/c_/0j/wz/c_0jwzu0madpx1t-pmfdznt-xny.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gbr. 9: Contoh Kunci</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ketika file jahat diblokir, penyerang mencoba mengunduh versi terenkripsi dari file yang dapat dieksekusi, yang juga diblokir. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/za/f8/mh/zaf8mhwwbu4rr9u_elmazc9cmns.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 10: Satu set sampel yang mencoba dijalankan oleh penyerang</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Akhirnya, ia mencoba mengunduh file jahat lain melalui konsol terenkripsi</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShell untuk memotong perlindungan anti-virus. </font><font style="vertical-align: inherit;">Tapi dia juga diblokir. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lw/4b/mj/lw4bmjqpqtkf1zrqhhe0zb-4rzm.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. </font><font style="vertical-align: inherit;">11: PowerShell dengan konten berbahaya yang diblokir </font></font><br>
</i><br>
<img src="https://habrastorage.org/webt/eu/dj/he/eudjheox40zpaop3cphprkuc-5c.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Gambar. </font><font style="vertical-align: inherit;">12: PowerShell dengan konten berbahaya yang diblokir</font></font><br>
 </i><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Bootloader</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketika dieksekusi, ia menulis file ReadMe ke folder </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% temp%</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang merupakan khas dari Ryuk. File ini - permintaan tebusan, yang berisi alamat e-mail domain protonmail, yang cukup umum di keluarga malware ini: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">msifelabem1981@protonmail.com </font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/qt/pg/zm/qtpgzmcdohk4siulk9nuayvwhqm.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/bk/wa/u9/bkwau9on8kixa8bsmiikectemqu.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar. 13: Persyaratan penukaran</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Selama pelaksanaan bootloader, Anda dapat melihat bahwa ia meluncurkan beberapa file yang dapat dieksekusi dengan nama acak. Mereka disimpan dalam folder </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PUBLIC</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tersembunyi </font><font style="vertical-align: inherit;">, tetapi jika opsi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Tampilkan file dan folder tersembunyi"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak aktif dalam sistem operasi </font><font style="vertical-align: inherit;">, mereka akan tetap tersembunyi. Selain itu, file-file ini 64-bit tidak seperti file induknya, yaitu 32-bit.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8b/ko/z3/8bkoz3_hgnilr-2i7sytnv5g2ik.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/fe/fb/z-/fefbz-5_yiuoiftotqmnei2hrvq.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 14: File yang dapat dieksekusi diluncurkan oleh sampel</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Seperti yang Anda lihat pada gambar di atas, Ryuk meluncurkan icacls.exe, yang akan digunakan untuk memodifikasi semua ACL (daftar kontrol akses), sehingga menjamin akses dan mengubah flag. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Itu mendapat akses penuh di bawah semua pengguna ke semua file di perangkat (/ T) terlepas dari kesalahan (/ C) dan tanpa menampilkan pesan apa pun (/ Q). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mf/bt/nc/mfbtnclxe4usjepbuizjzknslmu.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. Gambar 15: Opsi eksekusi untuk icacls.exe diluncurkan oleh sampel.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Penting untuk dicatat bahwa Ryuk memeriksa versi Windows yang sedang berjalan. Untuk melakukan ini, ia </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
memeriksa versi menggunakan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetVersionExW</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , di mana ia memeriksa nilai flag </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lpVersionInformation</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menunjukkan apakah versi Windows saat ini lebih lama dari </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows XP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lc/iv/yv/lcivyvqvjmm8jximv35wbo_v8ps.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/g8/t_/da/g8t_dabeoemyz2v0u93a8ivfilk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bergantung pada apakah Anda menjalankan versi yang lebih baru dari Windows XP, bootloader akan menulis ke folder pengguna lokal - dalam hal ini, folder </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Public%</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gg/gr/at/gggrateobojjggmubdykjordzy4.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 17: Memeriksa versi sistem operasi</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
File yang direkam adalah Ryuk. Kemudian meluncurkannya, mengirimkan alamatnya sendiri sebagai parameter. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hh/0f/ct/hh0fctenv0yqswmtw9rhmhjjwv0.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 18: Menjalankan Ryuk melalui ShellExecute</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Hal pertama yang dilakukan Ryuk adalah mendapatkan parameter input. Kali ini ada dua parameter input (file yang dapat dieksekusi itu sendiri dan alamat dropper), yang digunakan untuk menghapus jejak mereka sendiri. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1r/wu/vo/1rwuvoxtlg3lmusyoiem1v-e3da.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/op/wf/f7/opwff7lstsb0iq-nbvfqipywy6y.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 19: Membuat proses</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda juga dapat melihat bahwa begitu dia meluncurkan file yang dapat dieksekusi, dia menghapus dirinya sendiri, sehingga tidak meninggalkan jejak keberadaannya di folder tempat dia dieksekusi. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tp/ui/af/tpuiafv8uy2rmzsuememmnkaxxa.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. </font><font style="vertical-align: inherit;">20: penghapusan file</font></font></i><br>
 <br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. RYUK</font></font></h4><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1 Kehadiran</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ryuk, seperti malware lainnya, mencoba untuk tetap berada di sistem selama mungkin. Seperti yang ditunjukkan di atas, salah satu cara untuk mencapai tujuan ini adalah dengan diam-diam membuat dan menjalankan file yang dapat dieksekusi. Untuk ini, praktik paling umum adalah memodifikasi kunci registri </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CurrentVersion \ Run</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam hal ini, Anda dapat melihat bahwa untuk tujuan ini, file yang dapat dieksekusi pertama </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VWjRF.exe</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
(nama file dihasilkan secara acak) meluncurkan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cmd.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sd/8b/g2/sd8bg232guhntext0cy-exeh3be.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/nn/og/fo/nnogfoscybmwjhn9xnwd0gw7118.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 21: Menjalankan file VWjRF.exe</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Kemudian perintah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RUN</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dimasukkan </font><font style="vertical-align: inherit;">dengan nama " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">svchos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Jadi, jika Anda ingin memeriksa kunci registri kapan saja, Anda dapat dengan mudah tidak melihat perubahan ini, mengingat kesamaan nama ini dengan svchost. Berkat kunci ini, Ryuk memastikan keberadaannya dalam sistem. Jika sistem belum terinfeksi maka ketika Anda reboot sistem, executable akan mencoba lagi </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ta/my/42/tamy42jg8mihxlgmxgzfjzqvfui.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar 22:. sampel memastikan kehadiran kunci registri</font></font><br>
</i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Kita juga dapat melihat bahwa executable ini berhenti dua layanan: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
" </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">audioendpointbuilder</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ", yang, seperti namanya, cocok sistem audio, </font></font><br>
<br>
<img src="https://habrastorage.org/webt/h-/28/g8/h-28g8z69elv6rzdsjo2xuvrok4.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar 23: Contoh menghentikan layanan audio sistem</font></font><br>
</i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
dan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sams</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, yang merupakan layanan manajemen akun. Menghentikan kedua layanan ini adalah karakteristik Ryuk. Dalam hal ini, jika sistem terhubung ke sistem SIEM, enkripsi mencoba menghentikan pengiriman </font><font style="vertical-align: inherit;">peringatan apa pun </font><font style="vertical-align: inherit;">ke </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIEM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dengan demikian, ia membela langkah selanjutnya, karena beberapa layanan SAM tidak akan dapat memulai pekerjaan mereka dengan benar setelah Ryuk dieksekusi. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wj/fn/l1/wjfnl14it7llrkny9xpfvrs30di.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 24: Sampel menghentikan layanan Samss </font></font></i><br>
 <br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.2 Keistimewaan</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Secara umum, Ryuk dimulai dengan gerakan horizontal di dalam jaringan atau diluncurkan oleh program jahat lainnya, seperti </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Emotet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trickbot</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang dalam kasus peningkatan hak istimewa mentransfer hak-hak tinggi ini ke penyandi.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di muka, sebagai awal dari proses implementasi, kita melihat bahwa ia menjalankan proses </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImpersonateSelf</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang berarti bahwa konten keamanan token akses akan ditransfer ke stream, di mana ia akan segera diterima menggunakan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetCurrentThread</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9y/nm/ut/9ynmutmaqq2wovbdswheiipajcc.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 25: Memanggil Meniru Diri</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Kemudian kita melihat bahwa itu akan mengaitkan token akses dengan aliran. Kami juga melihat bahwa salah satu flag adalah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DesiredAccess</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang dapat digunakan untuk mengontrol akses yang akan dimiliki stream. Dalam hal ini, nilai yang akan diterima edx harus </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TOKEN_ALL_ACESS,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TOKEN_WRITE yang</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lain </font><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ui/vc/a_/uivca_yeyyvr5m-hwyolmei6k3u.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/tm/gy/yg/tmgyygvshjspnungxwqitl_jqm0.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 26: Membuat token aliran</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Kemudian akan digunakan</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SeDebugPrivilege</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> juga akan membuat panggilan untuk mendapatkan hak debugging Debug sehubungan dengan streaming, sebagai akibatnya, dengan menetapkan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PROCESS_ALL_ACCESS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , itu akan dapat mengakses setiap proses yang diperlukan. Sekarang, mengingat bahwa penyandinya sudah memiliki aliran yang disiapkan, itu hanya tinggal melanjutkan ke tahap akhir. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/0m/lf/ki/0mlfkifvdv7hk7rizfyus_7oco4.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 27: Memanggil SeDebugPrivilege dan fungsi peningkatan hak</font></font><br>
 </i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Di satu sisi, kami memiliki LookupPrivilegeValueW, yang memberi kami informasi yang diperlukan tentang hak istimewa yang ingin kami tingkatkan. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ts/wd/db/tswddbwi0jyghyqjpniu6rphmpe.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 28: Meminta informasi tentang hak istimewa untuk eskalasi mereka</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Di sisi lain, kami memiliki </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AdjustTokenPrivileges</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang memungkinkan kami untuk mendapatkan hak yang diperlukan untuk aliran kami. Dalam hal ini, yang paling penting adalah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewState.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang benderanya akan memberikan hak istimewa. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ki/sx/pa/kisxpam9ymp6ivk8remgfwfx4aq.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/9m/0s/sa/9m0ssakqkkjd4wzm4wqfav-mn7g.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. Gambar 29: Menetapkan hak untuk token </font></font></i><br>
 <br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.3 Penyebaran</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Di bagian ini, kami akan menunjukkan bagaimana sampel melakukan proses penyebaran yang disebutkan sebelumnya dalam laporan ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tujuan utama dari proses implementasi, serta eskalasi, adalah untuk mendapatkan akses ke </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">salinan bayangan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Untuk melakukan ini, ia perlu bekerja dengan aliran dengan hak yang lebih tinggi dari pengguna lokal. Segera setelah dia mendapatkan hak yang lebih tinggi, dia akan menghapus salinan dan membuat perubahan pada proses lain untuk membuatnya tidak mungkin untuk kembali ke titik pemulihan sebelumnya dalam sistem operasi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti biasanya dengan malware jenis ini, ia menggunakan </font><b><font style="vertical-align: inherit;">CreateToolHelp32Snapshot</font></b><font style="vertical-align: inherit;"> untuk menyelesaikan implementasinya</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, sehingga diperlukan snapshot dari proses yang sedang berjalan dan mencoba mengakses proses ini menggunakan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenProcess</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Segera setelah dia mendapatkan akses ke proses, dia juga membuka token dengan informasinya untuk mendapatkan parameter proses. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dc/do/xz/dcdoxzczq1ti1kf5fu_5y_rikc8.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Gambar </font><i><font style="vertical-align: inherit;">30: Menerima proses dari komputer</font></i><font style="vertical-align: inherit;"> Kita dapat secara dinamis melihat bagaimana ia menerima daftar proses yang berjalan dalam 140002D9C rutin menggunakan CreateToolhelp32Snapshot. Setelah menerimanya, ia menelusuri daftar, mencoba membuka proses satu per satu menggunakan OpenProcess hingga ia dapat melakukannya. Dalam hal ini, proses pertama yang bisa dia buka adalah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"taskhost.exe"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/k0/24/og/k024ogcd6ioxwnjbfuhjuefrce4.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 31: Eksekusi dinamis dari suatu prosedur untuk mendapatkan proses</font></font></i><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kita dapat melihat bahwa dia kemudian membaca token dari proses, sehingga </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenProcessToken</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan </font><i><font style="vertical-align: inherit;">Gambar</font></i><font style="vertical-align: inherit;"> " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">20008</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8j/zl/kn/8jzlkngsiwxlyol93ozqx8ebjrm.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. 32: Membaca informasi proses token</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ini juga memeriksa bahwa proses di mana ia akan tertanam bukanlah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">csrss.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">explorer.exe, lsaas.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau bahwa ia memiliki seperangkat izin </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">otoritas NT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hr/xr/9k/hrxr9kefgjfbtsex5awxtlqmjcm.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. Gambar 33: Proses yang dikecualikan.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Kita dapat secara dinamis melihat bagaimana pengecekan pertama kali menggunakan informasi proses token di </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">140002D9C</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk mengetahui apakah akun yang haknya digunakan untuk menjalankan proses adalah akun </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AUTHORITY NT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<img src="https://habrastorage.org/webt/4v/_v/-c/4v_v-cloz4ndee9gs0qbihghn9k.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 34: Memeriksa AUTHORITY NT</font></font></i><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dan kemudian, di luar prosedur, ia memeriksa bahwa itu bukan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">csrss.exe, explorer.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lsaas.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wa/uy/gg/wauyggzhisvonm1cyqr3cahfdc0.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 35: Memeriksa OTORITAS NT</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Setelah ia mengambil snapshot dari proses, membuka proses dan memverifikasi bahwa tidak ada satupun yang dikecualikan, ia siap untuk menuliskan proses yang akan diimplementasikan ke dalam memori. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk melakukan ini, ia pertama-tama mencadangkan suatu wilayah dalam memori ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VirtualAllocEx</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), menulis padanya ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WriteProcessmemory</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) dan membuat aliran ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CreateRemoteThread</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Untuk bekerja dengan fungsi-fungsi ini, ia menggunakan PID dari proses yang dipilih, yang sebelumnya ia peroleh menggunakan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CreateToolhelp32Snapshot</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<img src="https://habrastorage.org/webt/s7/zp/pl/s7zpplpua6q4w1mgpurwvgtzyxy.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 36: Kode Embed</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Di sini kita dapat mengamati secara dinamis bagaimana ia menggunakan proses PID untuk memanggil fungsi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VirtualAllocEx. </font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/7n/k1/j-/7nk1j-saztq--oxfo2xwzyiowgk.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. Gambar 37: Menjalankan VirtualAllocEx </font></font></i><br>
 <br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.4 Enkripsi</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Pada bagian ini, kita akan melihat bagian dari sampel ini terkait dengan enkripsi. Pada gambar berikut, Anda dapat melihat dua rutinitas yang disebut " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LoadLibrary_EncodeString</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " dan " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encode_Func</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ", yang bertanggung jawab untuk melakukan prosedur enkripsi. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/o5/iu/1r/o5iu1rimo3qfnbgpnl4mvwcpwug.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 38: Prosedur Enkripsi</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Pada awalnya kita dapat melihat bagaimana ia memuat string yang nantinya akan digunakan untuk menghilangkan semua yang dibutuhkan: impor, DLL, perintah, file, dan CSP. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/du/x6/te/dux6tehj_i7jcqkupvfdb3hlcfw.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 39: Rantai deobfusiasi</font></font></i><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gambar berikut ini menunjukkan impor pertama yang di-deobfuscates dalam register R4, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LoadLibrary</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ini akan digunakan nanti untuk memuat DLL yang diperlukan. Kita juga dapat melihat baris lain dalam register R12, yang digunakan bersama dengan baris sebelumnya untuk melakukan deobfusiasi. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/la/oo/to/laootohjrpgt3fa-yeetqz6rxzo.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 40: Deobfuscasi dinamis.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dia terus memuat perintah yang akan dijalankannya nanti untuk menonaktifkan cadangan, memulihkan titik, dan mode boot aman. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ce/qt/le/ceqtleaezfngmfgtrlhpgxl-vbw.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 41: Mengunduh perintah</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Kemudian memuat lokasi di mana ia akan menjatuhkan 3 file: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows.bat, run.sct,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">start.bat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ef/wj/9f/efwj9fcrtd5vai-3jjp6kblwsu0.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/jx/sg/sa/jxsgsaqyu0omqswv0-eseu5aeok.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/yq/g4/ur/yqg4urwb1wqlo52wgoocuccbi00.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/i2/fc/2t/i2fc2t2mcj6qrwau7gikqb4ohf4.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 42: Lokasi File</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketiga file ini digunakan untuk memeriksa hak istimewa yang dimiliki masing-masing lokasi. Jika hak istimewa yang diperlukan tidak tersedia, Ryuk menghentikan eksekusi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Itu terus memuat baris yang sesuai dengan tiga file. Yang pertama, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DECRYPT_INFORMATION.html</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , berisi informasi yang diperlukan untuk memulihkan file. Yang kedua, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PUBLIC</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , berisi kunci publik RSA. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vf/w1/do/vfw1doq6ayau0i8pkniuc-rd5mk.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 43: String DECRYPT INFORMATION.html</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ketiga, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UNIQUE_ID_DO_NOT_REMOVE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , berisi kunci terenkripsi yang akan digunakan dalam rutinitas berikutnya untuk melakukan enkripsi. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/u_/1l/s1/u_1ls1stszk23gkrsh2mwonnvgi.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 44: ID UNIK TIDAK MENGHAPUS String</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Akhirnya, ini memuat perpustakaan yang diperlukan bersama dengan impor yang diperlukan dan CSP ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microsoft Enhanced RSA</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penyedia Kriptografi AES</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7d/b9/q1/7db9q1wjr1k_y1bfsefiewsc-6g.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 45: Mengunduh pustaka</font></font></i><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Setelah semua deobfusiasi selesai, ia melanjutkan untuk melakukan tindakan yang diperlukan untuk enkripsi: beralih ke semua drive logis, lakukan apa yang dimuat dalam subrutin sebelumnya, perkuat keberadaan dalam sistem, letakkan file RyukReadMe.html, enkripsi, iterate semua drive jaringan, beralih ke perangkat yang ditemukan dan enkripsi mereka. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semuanya dimulai dengan mengunduh " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cmd.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " dan menulis kunci publik RSA. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_n/me/r-/_nmer-jvdpleozaujmoemqo7u9s.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 46: Mempersiapkan Enkripsi</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Kemudian mengambil semua drive logis menggunakan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetLogicalDrives</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan menonaktifkan semua cadangan, titik pemulihan, dan mode boot aman.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fa/ov/f8/faovf8myihdrkrtulhzcu_50e8q.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 47: Menonaktifkan alat pemulihan</font></font></i><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Setelah itu, ia memperkuat kehadirannya di sistem, seperti yang kita lihat di atas, dan menulis file </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RyukReadMe.html</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pertama </font><font style="vertical-align: inherit;">ke </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TEMP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/x8/7u/at/x87uatt-xtzmrn0un3-jqt5o0hw.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Gambar </font><i><font style="vertical-align: inherit;">48: Menerbitkan notifikasi pembelian kembali.</font></i><font style="vertical-align: inherit;"> Pada gambar berikut, Anda dapat melihat bagaimana ia membuat file, mengunduh konten, dan menulisnya: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vu/5o/2n/vu5o2nliyrqgsmugbe9jpx0-1mc.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar. Gambar 49: Mengunduh dan merekam konten file.</font></font></i><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Agar dapat melakukan tindakan yang sama pada semua perangkat, ia menggunakan </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
" </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">icacls.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " seperti yang kami tunjukkan di atas. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bd/6a/qb/bd6aqbnkrrba-polrck91kh53w0.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 50: Menggunakan icalcls.exe</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan akhirnya, ia mulai mengenkripsi file dengan pengecualian file "* .exe", "* .dll", file sistem, dan lokasi lain yang ditentukan sebagai daftar putih terenkripsi. </font><font style="vertical-align: inherit;">Untuk ini, ia menggunakan impor: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CryptAcquireContextW</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (di mana penggunaan AES dan RSA ditunjukkan), </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CryptDeriveKey, CryptGenKey</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CryptDestroyKey</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dll. </font><font style="vertical-align: inherit;">Suatu upaya juga sedang dilakukan untuk memperluas efeknya pada perangkat jaringan yang terdeteksi menggunakan WNetEnumResourceW dan kemudian mengenkripsi mereka. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9j/yn/mj/9jynmjtzu26dwvfg3ugrthcxo0o.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. </font><font style="vertical-align: inherit;">51: Enkripsi File Sistem</font></font></i><br>
 <br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. Impor dan bendera terkait</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berikut ini adalah tabel yang mencantumkan impor dan bendera paling relevan yang digunakan oleh sampel:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ri/bn/he/ribnhe9istspdndifpecxgnzljc.jpeg"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7. IOC</font></font></h4><br>
<img src="https://habrastorage.org/webt/bf/gu/cr/bfgucrrkqw-l2jurn09ovgljhas.jpeg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Referensi</font></font></b><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">users \ Public \ run.sct</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menu Mulai \ Program \ Startup \ start.bat AppData \ Roaming \ Microsoft \ Windows \ Start</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menu \ ProgramsStartup \ start.bat</font></font></li>
</ul><br>
<br>
<img src="https://habrastorage.org/webt/ld/od/e2/ldode2_iiqa4jqw4ol46ch5dov4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Laporan teknis ransomware Ryuk disusun oleh pakar lab antivirus PandaLabs.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8. Referensi</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. "Everis y Prisa Radio sufren un grave ciberataque que secuestra sus sistemas." Https: // www. elconfidencial.com/tecnologia/2019-11-04/ everis-la-ser-ciberataque-ransomware-15_2312019 /, Publicada el 04/11/2019. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. ‚ÄúUn virus de ruso ataca a importantes empresas espa√±olas.‚Äù Https: //elpais.com/tecnologia / 2019/11/04 / actualidad / 1572897654_ 251312.html, Publicada el 04/11/2019. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. "Makalah VB2019: pembalasan Shinigami: ekor panjang malware Ryuk." Https://securelist.com/ story-of-the-tahun-2019-kota-di bawah ransomware-siege / 95456 /, Publicada el 11 / </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
12/2019 4. "Berburu Game Besar dengan Ryuk: Ransomware Lucrativebased lain." Https: // www. crowstrike.com/blog/big-game-hunting-with-ryuk-another-lucrative-targeted-ransomware/, Publicada el 01/10/2019.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5. "Kertas VB2019: pembalasan Shinigami: ekor panjang malware Ryuk." Https: // www. </font><font style="vertical-align: inherit;">virusbulletin.com/virusbulletin/2019/10/ vb2019-paper-shinigamis-revenge-long-tail-r</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id497680/index.html">Telegram Anda sepertinya mengalir</a></li>
<li><a href="../id497682/index.html">Pavel Klemenkov, NVIDIA: Kami mencoba untuk mempersempit kesenjangan antara apa yang dapat dilakukan oleh seorang ilmuwan data dan apa yang harus dia lakukan.</a></li>
<li><a href="../id497684/index.html">Hype curve: apa teknologi IT berada pada puncaknya dan apa yang akan tetap stabil permintaannya</a></li>
<li><a href="../id497686/index.html">Bahan implan pembunuh bakteri</a></li>
<li><a href="../id497688/index.html">Bagaimana Cara Kerja Sekolah Malam Kubernetes</a></li>
<li><a href="../id497700/index.html">Mitaps online mingguan untuk dukungan dan DevOps, keamanan, dan robot mulai 17 April</a></li>
<li><a href="../id497702/index.html">Lima tren dalam penyimpanan data yang harus Anda perhatikan di tahun 2020</a></li>
<li><a href="../id497708/index.html">Kami mengundang Anda ke serangkaian webinar Fujitsu pada bulan April dan Mei</a></li>
<li><a href="../id497714/index.html">Bagaimana melindungi proses dan ekstensi kernel pada macOS</a></li>
<li><a href="../id497724/index.html">Mempersiapkan server untuk menerbitkan aplikasi web dengan Python</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>