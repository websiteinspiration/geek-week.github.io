<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßëüèæ‚Äçü§ù‚ÄçüßëüèΩ üôçüèº ‚ôªÔ∏è Aprendizaje autom√°tico: d√≥nde comenzar o c√≥mo construir el primer modelo üéØ ‚ôâÔ∏è ‚ö™Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Como la primera tarea para el aprendizaje autom√°tico, tomamos algo claro y simple, por ejemplo, un pron√≥stico del costo de la vivienda. El conjunto de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Aprendizaje autom√°tico: d√≥nde comenzar o c√≥mo construir el primer modelo</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/505516/"><img src="https://habrastorage.org/webt/cn/mg/fr/cnmgfrvs-ej5ldlqz9cmmdjdcrk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como la primera tarea para el aprendizaje autom√°tico, tomamos algo claro y simple, por ejemplo, un pron√≥stico del costo de la vivienda. El conjunto de datos listo se puede encontrar en el sitio web de kaggle. En los primeros pasos de la capacitaci√≥n, no debe tomar conjuntos de datos con una gran cantidad de variables, por ejemplo, "Precios de la vivienda: T√©cnicas de regresi√≥n avanzadas" consta de 80 variables y regresi√≥n avanzada, nos detendremos en "Ventas de viviendas en King County, EE. UU." Con 21 par√°metros. Descargue los datos y analice la descripci√≥n provista. Fecha disponible, precio, n√∫mero de dormitorios, ba√±os, √°rea total y habitable, n√∫mero de pisos, evaluaci√≥n de vista, vista al mar, evaluaci√≥n del estado general, grado (evaluaci√≥n de construcci√≥n y dise√±o), √°rea sobre y debajo del nivel del suelo, a√±o de construcci√≥n, a√±o de la √∫ltima reparaci√≥n, c√≥digo de √°rea, coordenadas (longitud y latitud), datos sobre el √°rea de casas de 15 vecinos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, hemos elegido una tarea y estamos listos para comenzar a resolverla. La soluci√≥n incluir√° dos etapas: an√°lisis de datos y construcci√≥n de modelos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Trabajar con datos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Divaguemos y notemos por separado la importancia del an√°lisis de datos. Actualmente, todos los algoritmos m√°s o menos populares ya est√°n escritos en forma de bibliotecas y la construcci√≥n directa del modelo se reduce a varias l√≠neas de c√≥digo, por ejemplo, k vecinos m√°s cercanos de sklearn en python:</font></font><a name="habracut"></a><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn .neighbors <span class="hljs-keyword">import</span> KNeighborsClassifier<font></font>
clf_KNN = KNeighborsClassifier()       <span class="hljs-comment"># </span>
clf_KNN.fit(X_train, Y_train)          <span class="hljs-comment"># </span>
Y_KNN = clf_KNN.predict(X_test)        <span class="hljs-comment">#    </span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solo cuatro l√≠neas de c√≥digo para obtener el resultado. Entonces, ¬øcu√°l es la dificultad? La dificultad radica en obtener el mismo X_train, los datos que se alimentan a la entrada del modelo. El conocido principio ‚Äúbasura en‚Äù = ‚Äúbasura en‚Äù (ingl√©s Garbage in - garbage out (GIGO)) en el modelado funciona por m√°s del 100% y la calidad de la soluci√≥n obtenida para el problema de aprendizaje autom√°tico depender√° en gran medida del trabajo con datos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y ahora, ¬°a la batalla! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para el an√°lisis de datos usaremos pandas, para comprender y evaluar "a simple vista" usamos gr√°ficos simples de seaborn. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Importamos las bibliotecas, leemos los datos, derivamos varios registros de la matriz de datos, observamos los tipos de datos y las omisiones en ellos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C√≥digo y fuera</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns<font></font>
df = pd.read_csv(<span class="hljs-string">'‚Ä¶/train.csv'</span>)<font></font>
df.head(<span class="hljs-number">5</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/1q/cy/og/1qcyogx0fmdgtibrhx1l2b5mdty.png"><br>
<br>
<pre><code class="python hljs">df.info()</code></pre><br>
<pre><code class="plaintext hljs">RangeIndex: 21613 entries, 0 to 21612<font></font>
Data columns (total 21 columns):<font></font>
id 21613 non-null int64<font></font>
date 21613 non-null object<font></font>
price 21613 non-null float64<font></font>
bedrooms 21613 non-null int64<font></font>
bathrooms 21613 non-null float64<font></font>
sqft_living 21613 non-null int64<font></font>
sqft_lot 21613 non-null int64<font></font>
floors 21613 non-null float64<font></font>
waterfront 21613 non-null int64<font></font>
view 21613 non-null int64<font></font>
condition 21613 non-null int64<font></font>
grade 21613 non-null int64<font></font>
sqft_above 21613 non-null int64<font></font>
sqft_basement 21613 non-null int64<font></font>
yr_built 21613 non-null int64<font></font>
yr_renovated 21613 non-null int64<font></font>
zipcode 21613 non-null int64<font></font>
lat 21613 non-null float64<font></font>
long 21613 non-null float64<font></font>
sqft_living15 21613 non-null int64<font></font>
sqft_lot15 21613 non-null int64<font></font>
dtypes: float64(5), int64(15), object(1)<font></font>
memory usage: 3.5+ MB</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La matriz de datos consta de 21613 registros sin espacios en los datos y contiene solo 1 fecha de campo de texto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trabajaremos con cada signo con m√°s detalle y comenzaremos con el m√°s simple: desechar la identificaci√≥n (no contiene informaci√≥n √∫til), el c√≥digo postal (el c√≥digo del √°rea donde se encuentra la casa) y las coordenadas (lat y long), ya que solo nos familiarizamos con el aprendizaje autom√°tico y la conversi√≥n correcta de la ubicaci√≥n geogr√°fica. Los datos son demasiado espec√≠ficos para un especialista novato.</font></font><br>
<br>
<pre><code class="python hljs">df=df.drop([<span class="hljs-string">'id'</span>,<span class="hljs-string">'zipcode'</span>,<span class="hljs-string">'lat'</span>,<span class="hljs-string">'long'</span>], axis=<span class="hljs-number">1</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora veamos la fecha del anuncio. El formato de fecha se establece en AAAAMMDDTT000000, en general, tambi√©n podr√≠a eliminarse del conjunto de datos, pero tenemos los campos a√±o de construcci√≥n (a√±o_construido) y a√±o de √∫ltima reparaci√≥n (a√±o_renovado), que se especifican en el formato de a√±o (a√±oaaa), que no es muy informativo. Usando la fecha de anuncio, puede convertir el a√±o en antig√ºedad por sustracci√≥n (a√±o de anuncio - a√±o de construcci√≥n / a√±o de reparaci√≥n). Observamos que el a√±o de reparaci√≥n es 0 para algunas casas, y suponiendo que esto significa que no hay reparaci√≥n del edificio, reemplazamos los ceros en el a√±o de reparaci√≥n con el a√±o de construcci√≥n, primero asegur√°ndonos de que los datos no contengan registros incorrectos donde el a√±o de reparaci√≥n sea menor que el a√±o de construcci√≥n:</font></font><br>
<br>
<pre><code class="python hljs">df[(df[<span class="hljs-string">'yr_renovated'</span>]&lt;df[<span class="hljs-string">'yr_built'</span>])&amp;df[<span class="hljs-string">'yr_renovated'</span>]!=<span class="hljs-number">0</span>]</code></pre><br>
<img src="https://habrastorage.org/webt/l7/wo/ii/l7woii1rk3buxzexbab2i4uokmq.png"><br>
<br>
<pre><code class="python hljs">df.loc[df[<span class="hljs-string">'yr_renovated'</span>]==<span class="hljs-number">0</span>, [<span class="hljs-string">'yr_renovated'</span>]]=df[<span class="hljs-string">'yr_built'</span>]<font></font>
df[<span class="hljs-string">'yr_built'</span>]=df[<span class="hljs-string">'date'</span>].str[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>].astype(int)-df[<span class="hljs-string">'yr_built'</span>]<font></font>
df[<span class="hljs-string">'yr_renovated'</span>]=df[<span class="hljs-string">'date'</span>].str[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>].astype(int)-df[<span class="hljs-string">'yr_renovated'</span>]<font></font>
df=df.drop(<span class="hljs-string">'date'</span>, axis=<span class="hljs-number">1</span>)<font></font>
df.head(<span class="hljs-number">5</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/4z/za/uw/4zzauwyidq18e0lq_8x5-up5e88.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Analizaremos el precio con el siguiente par√°metro y usaremos el "diagrama de caja" para esto. Un cuadro de bigote es un gr√°fico simple y conveniente que muestra una distribuci√≥n de probabilidad unidimensional o, m√°s simplemente, la concentraci√≥n de datos. Dibuja la mediana (la l√≠nea en el centro), los cuartiles superior e inferior (lados de la caja), los bordes de la muestra estad√≠sticamente significativa ("bigote") y los valores at√≠picos (puntos detr√°s del "bigote"). Es f√°cil de entender a partir de la imagen en la distribuci√≥n normal (derecha). El gr√°fico le permite evaluar r√°pidamente d√≥nde se encuentra la mayor√≠a de los datos (50% est√°n dentro del cuadro), su simetr√≠a (desplazamiento medio a un lado del cuadro y / o la longitud del "bigote") y el grado de dispersi√≥n - varianza (tama√±o del cuadro, tama√±o del bigote y el n√∫mero de puntos) emisiones).</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bi/bh/uw/bibhuwyeeexpszcl7sahfpdo8le.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es posible construir una distribuci√≥n de solo esta caracter√≠stica en toda la matriz, pero ser√° m√°s informativo usar 2 ejes, por ejemplo, el precio y el n√∫mero de dormitorios, que a su vez tambi√©n mostrar√° la presencia de una conexi√≥n entre los signos:</font></font><br>
<br>
<pre><code class="python hljs">sns.boxplot(y=<span class="hljs-string">'price'</span>, data=df)			<span class="hljs-comment"># price</span>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'bedrooms'</span>, data=df)	<span class="hljs-comment">#price &amp; bedrooms</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Precio y habitaciones: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/za/oh/ta/zaohtajsfsedoz8lagkzjto-oa0.png"><br>
<br>
<img src="https://habrastorage.org/webt/fn/em/4g/fnem4gwwbubwzkrhi25i4ly3j4k.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El gr√°fico muestra inmediatamente la presencia de valores extremos de precio y habitaciones (¬°imag√≠nese una casa con 33 habitaciones! J). La presencia de tales valores (tambi√©n llamados valores at√≠picos) en el precio del atributo objetivo a menudo conduce a la reentrenamiento del modelo, ya que dar√°n un gran error, que los algoritmos intentan minimizar. Se puede ver en el gr√°fico que la mayor√≠a (si se calcula - 93.22%) se encuentra en el rango de 0-1mn, y m√°s de 2 millones - solo 198 valores (0.92%). Puede deshacerse del 1% del conjunto de datos casi sin dolor, por lo tanto, al haber llamado una vista simple de 217 registros, haberlos ordenado previamente por precio, veremos la marca de precio deseada de 1 965 000 y eliminaremos todo lo que est√© por encima de este precio.</font></font><br>
<br>
<pre><code class="python hljs">df.sort_values (by=<span class="hljs-string">'price'</span>, ascending=<span class="hljs-literal">False</span>).head(<span class="hljs-number">217</span>) <font></font>
df=df[df[<span class="hljs-string">'price'</span>]&lt;=<span class="hljs-number">1965000</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pensemos un poco sobre el letrero de las habitaciones. </font><font style="vertical-align: inherit;">Vemos 13 casas con dormitorios = 0, as√≠ como un registro extra√±o de una casa con 33 dormitorios. </font><font style="vertical-align: inherit;">Haremos lo mismo que con el precio, eliminando ceros de los bedroms (y ba√±os al mismo tiempo):</font></font><br>
<br>
<pre><code class="python hljs">df=df[(df[<span class="hljs-string">'bedrooms'</span>]!=<span class="hljs-number">0</span>)&amp;(df[<span class="hljs-string">'bathrooms'</span>]!=<span class="hljs-number">0</span>)]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Con respecto a la casa con 33 habitaciones, considerando el precio, podemos suponer que se trata de un error tipogr√°fico y en realidad de 3 habitaciones. Compare la superficie habitable de esta casa (1620) con la superficie habitable promedio de las casas de 3 habitaciones (1798.2), lo cual es probablemente nuestra suposici√≥n, por lo tanto, simplemente cambie este valor a 3 y vuelva a construir el diagrama de caja anterior:</font></font><br>
<br>
<pre><code class="python hljs">df.loc[df[<span class="hljs-string">'bedrooms'</span>]==<span class="hljs-number">33</span>,[<span class="hljs-string">'bedrooms'</span>]]=<span class="hljs-number">3</span> 
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'bedrooms'</span>, data=df)</code></pre><br>
<img src="https://habrastorage.org/webt/qi/wd/fs/qiwdfscthapolbucfyjqy-uoggc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pues mucho mejor. </font><font style="vertical-align: inherit;">Del mismo modo, las habitaciones miran los ba√±os. </font><font style="vertical-align: inherit;">Eliminamos valores cero, no hay otros valores extremos en el campo:</font></font><br>
<br>
<pre><code class="python hljs">sns.boxplot(y=<span class="hljs-string">'bathrooms'</span>, x=<span class="hljs-string">'bedrooms'</span>, data=df)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En los campos sqft_living, floors, waterfront, view, condition, grade, sqft_living15 tambi√©n todos los valores son m√°s o menos reales, no los tocaremos:</font></font><br>
<br>
<pre><code class="python hljs">plt.rcParams[<span class="hljs-string">'figure.figsize'</span>]=<span class="hljs-number">2</span>,<span class="hljs-number">3</span> 			<span class="hljs-comment"># </span>
sns.boxplot(y=<span class="hljs-string">'sqft_living'</span>, data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'floors'</span>,color=<span class="hljs-string">'#2ecc71'</span>, data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'sqft_living15'</span>,color=<span class="hljs-string">'#9b59b6'</span>, data=df) <font></font>
plt.rcParams[<span class="hljs-string">'figure.figsize'</span>]=<span class="hljs-number">4</span>,<span class="hljs-number">4</span>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'waterfront'</span>, data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'view'</span> , data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'condition'</span> , data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'grade'</span> , data=df)</code></pre><br>
<img src="https://habrastorage.org/webt/oq/uw/h8/oquwh8x-cln4tbaz9xrzqyk9szs.png"><br>
<br>
<img src="https://habrastorage.org/webt/yl/ns/bz/ylnsbzq_kx2dtvrvjy8iytxudve.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero con sqft_lot y sqft_lot15 necesitas encontrar algo y, debido a los grandes valores, el logaritmo es bastante adecuado:</font></font><br>
<br>
<pre><code class="python hljs">df[<span class="hljs-string">'sqft_lot'</span>]=np.log(df[<span class="hljs-string">'sqft_lot'</span>])<font></font>
df[<span class="hljs-string">'sqft_lot15'</span>]=np.log(df[<span class="hljs-string">'sqft_lot15'</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sqft_lot antes y despu√©s: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yr/up/g2/yrupg24jwmfsptci9hf8uaq6wmu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sqft_above y sqft_basement son los componentes de sqft_living, por lo que tampoco los tocaremos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Con esto, terminaremos con un an√°lisis preliminar y veremos el mapa de correlaciones:</font></font><br>
<br>
<pre><code class="python hljs">sns.heatmap(df.corr(),  cmap = <span class="hljs-string">'viridis'</span>,annot = <span class="hljs-literal">True</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/ny/yi/uq/nyyiuqa9zbilc9l6gqzljfe35xu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de examinar el mapa de correlaci√≥n, vemos que a veces los atributos est√°n fuertemente correlacionados entre s√≠, por lo que eliminamos algunos de los atributos con alta correlaci√≥n: sqft_lot15 (leave sqft_lot), yr_built (leave yr_renovated), sqft_above (sqft_living). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esto completa el trabajo con los datos y procede a la creaci√≥n del modelo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Modelado </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En esta parte, construiremos 2 modelos: regresi√≥n lineal y √°rbol de decisi√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos los modelos que necesitamos est√°n contenidos en la biblioteca sklearn. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primero, separamos la variable objetivo del resto de los datos de entrenamiento, y tambi√©n dividimos las muestras en entrenamiento (70%) y prueba (30%, en las cuales verificaremos c√≥mo funciona el modelo):</font></font><br>
<br>
<pre><code class="python hljs">Y=df[<span class="hljs-string">'price'</span>]<font></font>
X=df.drop (<span class="hljs-string">'price'</span>,axis=<span class="hljs-number">1</span>) 
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<font></font>
X_train, X_test, Y_train, Y_test  = train_test_split(X, Y, test_size = <span class="hljs-number">0.3</span>, shuffle = <span class="hljs-literal">True</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s, desde sklearn, para evaluar el modelo, cargamos 3 m√©tricas: mean_absolute_error (error absoluto medio), mean_squared_error (desviaci√≥n est√°ndar), r2_score (coeficiente de determinaci√≥n):</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> mean_absolute_error, mean_squared_error, r2_score</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comencemos con la regresi√≥n lineal:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LinearRegression<font></font>
LR = LinearRegression() 				<span class="hljs-comment"># </span>
LR.fit(X_train, Y_train)				<span class="hljs-comment"># </span>
Y_LR = LR.predict(X_test)				<span class="hljs-comment">#       </span>
<span class="hljs-keyword">print</span> (<span class="hljs-string">'MAE:'</span>, round (mean_absolute_error(Y_test, Y_LR),<span class="hljs-number">3</span>))		<span class="hljs-comment">#</span>
<span class="hljs-keyword">print</span> (<span class="hljs-string">'‚àöMSE:'</span>, round (mean_squared_error(Y_test, Y_LR)**(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>),<span class="hljs-number">3</span>))
<span class="hljs-keyword">print</span> (<span class="hljs-string">'R2_score:'</span>, round (r2_score(Y_test, Y_LR),<span class="hljs-number">3</span>))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MAE: 124477.452 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚àöMSE 175205.645 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
R2_score: 0.627 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Årbol de </font><font style="vertical-align: inherit;">decisi√≥n </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.tree <span class="hljs-keyword">import</span> DecisionTreeRegressor<font></font>
TR = DecisionTreeRegressor()				<span class="hljs-comment"># </span>
TR.fit(X_train, Y_train)				<span class="hljs-comment"># </span>
Y_TR=TR.predict(X_test)  				<span class="hljs-comment">#   </span>
<span class="hljs-keyword">print</span> (<span class="hljs-string">'MAE:'</span>, round (mean_absolute_error(Y_test, Y_TR),<span class="hljs-number">3</span>))		<span class="hljs-comment">#</span>
<span class="hljs-keyword">print</span> (<span class="hljs-string">'‚àöMSE:'</span>, round (mean_squared_error(Y_test, Y_TR)**(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>),<span class="hljs-number">3</span>))
<span class="hljs-keyword">print</span> (<span class="hljs-string">'R2_score:'</span>, round (r2_score(Y_test, Y_TR),<span class="hljs-number">3</span>))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MAE: 151734.906 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚àöMSE 220856.721 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
R2_score: 0.407 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seg√∫n las m√©tricas, podemos concluir que la regresi√≥n lineal mostr√≥ el mejor resultado, por lo que es m√°s l√≥gico elegirlo. Sin embargo, no preguntamos en qu√© consiste el error del modelo, si el modelo est√° reentrenado, etc. Es muy probable que fue el reentrenamiento lo que llev√≥ al deterioro del resultado de DecisionTreeRegressor, ya que ni siquiera limitamos la profundidad del √°rbol en los par√°metros del modelo. Podemos verificar esto f√°cilmente clasificando la profundidad de los √°rboles en un ciclo corto:</font></font><br>
<br>
<pre><code class="python hljs">dep,score=[],[]
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>,<span class="hljs-number">16</span>):<font></font>
    TR = DecisionTreeRegressor(max_depth=i)<font></font>
    TR.fit(X_train, Y_train)<font></font>
    Y_TR=TR.predict(X_test)<font></font>
    dep.append(i)<font></font>
    score.append(mean_squared_error(Y_test, Y_TR)**(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>))	<span class="hljs-comment">#  ‚àöMSE</span>
		plt.rcParams[<span class="hljs-string">'figure.figsize'</span>]=<span class="hljs-number">6</span>,<span class="hljs-number">3</span>
		plt.plot(dep, score)</code></pre><br>
<img src="https://habrastorage.org/webt/ar/fn/yt/arfnytm068lhpknk_ifnpshupgq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviamente, el mejor indicador est√° en max_depth = 7 y, al observar las m√©tricas (MAE: 124861.441, ‚àöMSE 175322.737, R2_score: 0.626), queda claro que un modelo con tal restricci√≥n es similar a una regresi√≥n lineal en la calidad. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n podemos intentar evaluar qu√© atributos fueron m√°s importantes para el modelo para el pron√≥stico de costos: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/x1/qx/qw/x1qxqwlhqbfotpp45hhyr4nz0uc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
seg√∫n el gr√°fico, est√° claro que la calificaci√≥n afecta m√°s el costo: una evaluaci√≥n subjetiva general de la casa por parte de la compa√±√≠a de bienes ra√≠ces (que, por cierto, indica la competencia de la evaluaci√≥n :-))), en segundo lugar est√° el √°rea de la casa, y en tercer lugar, el a√±o de la √∫ltima reparaci√≥n. Los indicadores consideraron el n√∫mero de dormitorios, ba√±os y pisos que el modelo consider√≥ insignificantes para el pron√≥stico.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para comprender mejor los resultados, calculamos el error promedio en%; de acuerdo con la regresi√≥n lineal, el error promedio es del 27.5%, es decir, el modelo comete un poco m√°s de error que un cuarto cuando pronostica el costo de una casa, que es bastante. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øSe pueden mejorar los resultados? </font><font style="vertical-align: inherit;">S√≠, por supuesto, en la etapa actual solo hemos recibido una soluci√≥n b√°sica: alg√∫n punto de partida para la comparaci√≥n ser√°n modelos mejores o peores que podamos crear utilizando m√©todos m√°s sofisticados o utilizando un procesamiento de datos m√°s complejo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solo tocamos un poco el tema del reciclaje y no tocamos en absoluto en qu√© consiste el error del modelo y muchos otros aspectos de la creaci√≥n del modelo. </font><font style="vertical-align: inherit;">Como regla general, se utilizan varios m√©todos de validaci√≥n del modelo para responder estas preguntas y encontrar la soluci√≥n √≥ptima, pero escribiremos sobre esto en los siguientes art√≠culos.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es505498/index.html">C√≥mo resolvemos el problema de la memoria de pila no inicializada en Windows</a></li>
<li><a href="../es505502/index.html">Omnichannel en servicio al cliente: ¬øqu√© buscar y c√≥mo hacer todo bien?</a></li>
<li><a href="../es505506/index.html">√âl no muerde: c√≥mo hacer que los robots industriales sean seguros para los trabajadores</a></li>
<li><a href="../es505508/index.html">No solo tecnolog√≠a no tripulada: el futuro de la industria automotriz</a></li>
<li><a href="../es505510/index.html">Racionalizaci√≥n de la API de Check Point con Python SDK</a></li>
<li><a href="../es505522/index.html">Monetizaci√≥n en juegos en l√≠nea: c√≥mo usar la experiencia de otra persona para sus propias necesidades</a></li>
<li><a href="../es505528/index.html">Lo m√°s importante en Wi-Fi 6. No, en serio.</a></li>
<li><a href="../es505530/index.html">Google hace su procesador, y AMD se est√° preparando para destruir Qualcomm</a></li>
<li><a href="../es505532/index.html">Canales de Telegram sobre desarrollo de juegos: parte 2</a></li>
<li><a href="../es505536/index.html">C√≥mo cocinar el seguimiento de llamadas: experiencia cian</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>