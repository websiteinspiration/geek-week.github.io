<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèÇüèª üòÆ ü§õüèø Faltungsneurales Netzwerk und seine Integration in iOS (Teil 1) üëª üßõüèΩ üéÖüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mittel zur Umsetzung.
 
 Verschiedene Algorithmen f√ºr maschinelles Lernen sind in viele Programmiersprachen auf hoher Ebene integriert. Das beliebtest...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Faltungsneurales Netzwerk und seine Integration in iOS (Teil 1)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500998/"><img src="https://habrastorage.org/webt/ob/i9/sq/obi9sqkryjcwn5txcjgdvc0fcoi.jpeg"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mittel zur Umsetzung.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Verschiedene Algorithmen f√ºr maschinelles Lernen sind in viele Programmiersprachen auf hoher Ebene integriert. Das beliebteste und am schnellsten wachsende von ihnen ist Python. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TensorFlow ist eine offene Softwarebibliothek f√ºr maschinelles Lernen, die von Google entwickelt wurde, um die Probleme beim Aufbau und Training eines neuronalen Netzwerks zu l√∂sen, um Bilder automatisch zu finden und zu klassifizieren und so die Qualit√§t der menschlichen Wahrnehmung zu erreichen. Die Haupt-API f√ºr die Arbeit mit der Bibliothek ist f√ºr Python implementiert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Keras ist eine offene neuronale Netzwerkbibliothek. Es ist ein Add-On f√ºr die Frameworks TensorFlow und Theano. Es zielt auf die operative Arbeit mit Deep-Learning-Netzwerken ab und ist kompakt, modular und erweiterbar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die neueste Version von Python 3.7.2 wird als Interpreter ausgew√§hlt. Die Entwicklungsumgebung ist PyCharm Community. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datenaufbereitung.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In der modernen Welt ist es f√ºr die meisten KI-Aufgaben nicht erforderlich, den Datensatz manuell zu erfassen. Es gibt viele Ressourcen, in denen nach der Registrierung vorgefertigte Datens√§tze heruntergeladen werden k√∂nnen. Ein Datensatz mit zehn Ziffern in Geb√§rdensprache wurde ausgew√§hlt (Abb. 1). </font></font><br>
<img src="https://habrastorage.org/webt/_-/wd/e7/_-wde7b_bdaeuj-ge5tk6fkymxi.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abb. 1. - Zahlen in Geb√§rdensprache.</font></font><br>
<br>
<a name="habracut"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Algorithmus muss das Vorhandensein einer Geste auf dem Foto erkennen und mit einer Zahl von 0 bis 9 klassifizieren. Bevor Sie die Architektur des neuronalen Netzwerks erstellen, m√ºssen Sie Daten f√ºr das Training vorbereiten. Zun√§chst werden die Daten des Geb√§rdensprachendatensatzes heruntergeladen. Die erste Datei enth√§lt 2063 Schwarzwei√übilder mit Zahlen in Geb√§rdensprache. Bilder haben eine Gr√∂√üe von 64x64 Pixel. Die zweite Datei enth√§lt eine Beschriftung (Vektor), die dem Bild entspricht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Pixelwerte in den Bildern sind normalisiert und liegen im Intervall (0,1). Sie k√∂nnen sie sofort verwenden, um in das neuronale Netzwerk einzutreten. Das optimalste Ergebnis wird jedoch erzielt, wenn Sie das Standardisierungsverfahren befolgen. Nach seiner Ausf√ºhrung werden die Regeln f√ºr jede Pixelmatrix erf√ºllt: Der </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durchschnittswert in der Matrix ist Null. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Die Streuung in der Matrix ist Eins.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fotos werden standardisiert und zu einem neuen Array hinzugef√ºgt, um sie anschlie√üend mit vorherigen Daten zu kombinieren ( </font></font><br>
<img src="https://habrastorage.org/webt/ad/m6/wd/adm6wdbpvyip5kyp_4glxau1j50.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abb. </font><font style="vertical-align: inherit;">2). </font><font style="vertical-align: inherit;">Abb. 2. - Das Verfahren zum Laden und Verarbeiten von Bildern. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neuronale Netzwerkarchitektur.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Network_sign_lang.py - Die Hauptprojektdatei, in der das neuronale Netzwerk beschrieben wird. Zu Beginn des Skripts werden mehrere globale Variablen des neuronalen Netzwerks beschrieben (Abb. 3). </font></font><br>
<img src="https://habrastorage.org/webt/ug/wo/ll/ugwollmtjdgakxjrkjaycuq7bog.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abb. 3. - Globale Optionen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Batch_size - Die Anzahl der Bilder, die f√ºr jede Iteration in das neuronale Netzwerk eingespeist werden. Num_classes - Die Anzahl der Klassen, die das Modell vorhersagen wird. Img_size - Die Gr√∂√üe der Bilder, die der Eingabeebene zugef√ºhrt werden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Funktion train_test_split () aus der Sklearn-Bibliothek wird in das Projekt importiert, teilt die X- und y-Arrays im Verh√§ltnis 80:20 in Trainings- und Testbeispiele auf und mischt die Daten nach dem Zufallsprinzip, sodass sie nicht nach Klassen sortiert werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anschlie√üend wird das Modell initialisiert (Abb. 4) und die erste Schicht von Conv2D hinzugef√ºgt. Bilder vom Xtrain-Array werden eingegeben, die Dimension des Ausgaberaums wird angegeben - 64, der Faltungskern - 4x4, der Faltungsschritt und die Aktivierungsfunktion der ReLU-Schicht. </font></font><br>
<img src="https://habrastorage.org/webt/7z/3p/jw/7z3pjw8oimjgvt7n4nde4jgivao.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abb. 4. - Neurales Netzwerk</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da neuronale Netze typischerweise eine viel gr√∂√üere Anzahl von Trainingsdaten verwenden, ist das konstruierte Modell anf√§llig f√ºr Umschulungen. Um dies zu vermeiden, wird eine effektive Regularisierungsmethode wie Dropout verwendet. Diese Schicht schlie√üt den angegebenen Prozentsatz an zuf√§lligen Neuronen aus, so dass es keine √úberlastung zwischen den Schichten gibt. Die Zahl 0,5 bedeutet, dass der Algorithmus bei jeder Charge die H√§lfte der zuf√§lligen Neuronen ausschlie√üt. Die zweite Hauptschicht √§hnelt ebenfalls der ersten - Faltungsschicht. (Conv2D) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die n√§chste ist die Pooling-Schicht (MaxPooling2D). Es dient als weiterer Filter f√ºr die Modellausgabe. Da sich die Bedeutung des Bildes bei horizontaler oder vertikaler Anzeige der Zahlen nicht √§ndert, sollte das neuronale Netzwerk sie gleich klassifizieren.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Abflachungsschicht dient als Verbindung zwischen den vom Algorithmus erhaltenen Daten und dem Ausgabevektor mit der Vorhersage. Die letzte Schicht des Netzwerks ist die dichte Schicht mit Sofmax-Aktivierungsfunktion. Mit dieser Funktion k√∂nnen Sie einen normalisierten Wahrscheinlichkeitsvektor f√ºr jede Klasse erhalten, wobei die Summe der Wahrscheinlichkeiten gleich eins ist.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als N√§chstes m√ºssen Sie das erstellte Modell kompilieren, indem Sie die folgenden Parameter angeben: Metrik, Verlustfunktion und Optimierer. Als Metrik wird die Genauigkeit gew√§hlt - der Prozentsatz der korrekt klassifizierten Beispiele. Die Verlustfunktion ist kategorial_kreuzentropie. Optimierungsalgorithmus - Adam. Vor Beginn des Trainings werden mehrere R√ºckrufe hinzugef√ºgt. EarlyStopping - Beendet das Lernen des neuronalen Netzwerks, wenn seine Genauigkeit mit den Epochen des Lernens nicht mehr zunimmt. ModelCheckpoint - speichert die besten Modellgewichte zur sp√§teren Verwendung in einer Datei. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Training des neuronalen Netzwerks beginnt mit dem Speichern von Daten √ºber seinen Prozess in der historischen Variablen. Validation_split - Nimmt zehn Prozent der Trainingsdaten zur Validierung, was eine weitere M√∂glichkeit zur Regularisierung darstellt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Gr√∂√üe der Trainingsstichprobe betr√§gt 1965 Beispiele, die Teststichprobe 547 und die Validierungsstichprobe 219. Nach Abschluss des Trainingsprozesses wird ein Diagramm der Abh√§ngigkeit der erhaltenen Genauigkeit von den Trainings- und Testdaten erstellt (Abb. 5). </font></font><br>
<img src="https://habrastorage.org/webt/ip/fj/0t/ipfj0t4yibt6ogcdlddvuuqbksu.jpeg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abb.5. - Trainingsplan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Grafik zeigt, dass das Modell in der 15. √Ñra gespeichert wurde (mit der gr√∂√üten Genauigkeit und der kleinsten L√ºcke zwischen Xtrain und Xtest). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der n√§chste Schritt besteht darin, die resultierenden neuronalen Netze in ein anderes Skript zu laden, um ihre Funktion zu √ºberpr√ºfen. Die Werte der Metriken in den Testdaten werden angezeigt (Abb. 6). </font></font><br>
<img src="https://habrastorage.org/webt/yy/gk/pw/yygkpwatefnnhsps263xk54futk.jpeg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abb. 6. - √úberpr√ºfung der Leistung des Modells.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Basierend auf den Ergebnissen der Metriken k√∂nnen wir schlie√üen, dass sich die Modelle nicht stark unterscheiden. </font><font style="vertical-align: inherit;">Je niedriger der Verlustfunktionsindex ist, desto sicherer sind die Vorhersagen des Algorithmus. </font><font style="vertical-align: inherit;">Die Genauigkeit oder Wiedergabetreue des Modells gibt den Prozentsatz der korrekt klassifizierten Fotos an. Je h√∂her es ist, desto besser ist das neuronale Netzwerk. </font><font style="vertical-align: inherit;">Folglich ist es logischer, das erste Modell zu verwenden, das als Ergebnis eines vorzeitigen Abbruchs der Bildung erhalten wurde. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden im n√§chsten Teil √ºber die Datenvorverarbeitung und die Integration eines neuronalen Netzwerks eines bestimmten Formats in eine iOS-Anwendung sprechen.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de500984/index.html">Schlechter Apfel oder Happy Radio Day, Geeks</a></li>
<li><a href="../de500986/index.html">√úberwachung im Rechenzentrum: Wie wir das alte BMS durch ein neues ersetzt haben. Teil 3</a></li>
<li><a href="../de500992/index.html">Wie ist Performance Management in den besten IT-Unternehmen</a></li>
<li><a href="../de500994/index.html">F√ºhren Sie Ameise. Lauf</a></li>
<li><a href="../de500996/index.html">So werden Sie in sechs Monaten oder noch schneller DevOps-Ingenieur. Teil 1. Einf√ºhrung</a></li>
<li><a href="../de501000/index.html">Codegenerierung in Go am Beispiel des Erstellens eines Clients f√ºr die Datenbank</a></li>
<li><a href="../de501002/index.html">Umka: Neue statisch typisierte Skriptsprache</a></li>
<li><a href="../de501004/index.html">Tu es. Arbeit</a></li>
<li><a href="../de501006/index.html">Wir sind Freunde STM32 mit LCD-Anzeige 1604 am I2C-Bus (HAL-Bibliothek)</a></li>
<li><a href="../de501008/index.html">Dominos Pflaster</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>