<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👲🏽 💭 🧝🏻 ISA does not forgive mistakes 🗨️ 🙎🏼 🧑🏻‍🤝‍🧑🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="–X86 is a historical misunderstanding, - the master and in 80 did not lose polemic enthusiasm. 
 “Actually, she owns 95% of the server market,” I repl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ISA does not forgive mistakes</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/huawei/blog/503194/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">–X86 is a historical misunderstanding, - the master and in 80 did not lose polemic enthusiasm. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
“Actually, she owns 95% of the server market,” I replied sluggishly. I didn’t want to argue on a hundred times hackneyed topic </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- And I’m already confused in these prefixes, - the academician did not relent. - 15 bytes per instruction, this is unthinkable! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Well, not ice, of course. But who is better? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Yes, anyone, at least ARM-a. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
“I still don’t understand.” Additions with multiplications should be? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Should. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- And shifts with logical operations? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Yes. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- And downloads with saves too. What is the difference in how they are called and encoded?</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As usual, I realized the correctness of the teacher much later. When I sat down to write a decoder of commands in a dreary winter evening in order to somehow amuse myself. I managed to portray a simple decoder for ARM on VHDL (and I know it so-so) in a couple of days. True, I repent, I had a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cheat sheet.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :) </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zz/6g/sh/zz6gsh4coxuhsz_nnnip5wxlgsi.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For X86 it was not possible for a week, or for two, or for a month ... Even for the basic set.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The difference here is not only in RISC (Reduced Instruction Set Computing) for ARM and CISC (Complex Instruction Set) for X86. The difference is rather in the path of historical development. More than 40 years ago, and it all began in 1978, the X86 ISA (Instruction Set Architecture) was quite a compact set of commands with its own internal logic. But time passed, bus capacity increased, registers expanded (including SIMD), and the number of teams was constantly growing. Then one guy made an interesting </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">attempt to</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> simply count the number of instructions in X86. Whether he was too lazy to open the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">manual</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and count them, either he knew about the existence of “nameless” opcodes (teams that don't even have a name), or he believed in the omnipotence of logic. It is easy to understand that logic turned out to be powerless. :) By the way, I tried to find a graph of the growth in the number of X86 instructions by year (or by generation). I couldn’t yet (maybe someone has it?). But I found here such a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">picture</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<img src="https://habrastorage.org/webt/-v/t6/ni/-vt6ni8guqbh8kv0obshqd5dnnm.jpeg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To be honest, I don’t know how many instructions there are in the X86 ISA. But I remember well all those that I invested in the development myself, without realizing that every new bit in ISA is labeled “keep forever”. And there were several thousand “creators” like me at Intel. And the bits in order to encode all their fantasies were constantly lacking. :) All new prefixes were added to the existing command set: REX, VEX ... The last four-byte (EVEX) extension was introduced for the AVX-512. By the way, the whole set of ARM commands (even taking into account </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SVE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) is removed in these same 4 bytes. ARM initially went the other way, building its command system on the basic principles of simplicity, compactness and extensibility.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The difference can be understood if we switch from the point of view of the programmer to the point of view of circuit designer. And it is known that the transistor is a great thing, but it switches slowly and dissipates energy shamelessly. And other things being equal, it would be better if there were fewer of them. Now, take a look at </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the decoding algorithm for x86 instructions</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (the problem I was trying to solve). </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/lk/0v/3s/lk0v3s92ryuppxkgwwd2h1yvaak.jpeg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And as they say, feel the difference in the input paths (front end) for ARM and X86. Here it can be argued that the front end is a very small part of the kernel, only about 10%. Yes, but do not forget that all this logic is multiplied by the number of cores on the chip. And this is serious.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Another consideration is that the front end is just the part that is responsible for backward compatibility. You can safely shovel or even throw back end. Intel, by the way, took advantage of this in the early 2000s, replacing the NetBurst (P4) architecture with Core-M (P3). But the front end can not be greatly reduced. Although sometimes I really want to, because of the existing X86 ISA, about 20% is now used. The rest are remnants of the past.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Another disadvantage of the huge length of instructions is the relatively frequent misses in the instruction cache. Roughly speaking, with an equal size of caches, the number of misses will be the greater, the greater the length of the instruction. Of course, the size of the caches can be increased. But then again, these are transistors that might not have been if the instructions were shorter. For the same reason, I am very wary of various kinds of VLIW (Very Long Instruction World) architectures. However, they also have the disadvantage that it is very difficult for them to develop compilers. Until now, I deliberately avoided the topic of compilers, since I never developed them myself. I would like to listen to what knowledgeable people will say about the delights of developing compilers for RISC, CISC and VLIW.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And yet, despite the huge accumulated load of legacy, and perhaps thanks to him, the X86 developers were right in the main. </font><font style="vertical-align: inherit;">The principle of backward compatibility has been adhered to in architecture from the very beginning. </font><font style="vertical-align: inherit;">All existing software works on the new hardware out of the box. </font><font style="vertical-align: inherit;">This is what made it possible to build such a deep and developed ecosystem around architecture. </font><font style="vertical-align: inherit;">And it remains only to take off the hat before the engineers of Intel and AMD, who, despite the not at all perfect ISA design, have maintained leadership in the server segment for many years. </font><font style="vertical-align: inherit;">However, the legacy load is getting harder.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en503176/index.html">Implementation of an algorithm for determining the width of an object using an ultrasonic rangefinder and encoders in RobotC language</a></li>
<li><a href="../en503178/index.html">Apple Mac and fancy devices. LTO, SAS, Fiber Channel, eSATA</a></li>
<li><a href="../en503182/index.html">"I am the first blind developer in my company." Part 1</a></li>
<li><a href="../en503184/index.html">We invite you to the online meeting Zabbix</a></li>
<li><a href="../en503192/index.html">oVirt in 2 hours. Part 4. Basic operations</a></li>
<li><a href="../en503196/index.html">450 free courses from the Ivy League</a></li>
<li><a href="../en503200/index.html">YOLOv4 - the most accurate real-time neural network on the Microsoft COCO dataset</a></li>
<li><a href="../en503204/index.html">How to flash Xiaomi Redmi 4 Prime / Pro / Premium on Android 10</a></li>
<li><a href="../en503208/index.html">When is the best time to invest?</a></li>
<li><a href="../en503210/index.html">Can phishing sites be eradicated?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>