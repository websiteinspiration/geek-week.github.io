<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘ğŸ¼ ğŸ˜ ğŸ‘¨ğŸ½â€ğŸ¨ GitLab CI: 6 fitur dari rilis terbaru yang telah kami tunggu-tunggu ğŸ¤© ğŸ¾ ğŸ”Ÿ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Di era CI / CD di mana-mana, kita dihadapkan dengan berbagai alat terkait, termasuk sistem CI. Namun, GitLab-lah yang paling dekat dengan kami, benar-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>GitLab CI: 6 fitur dari rilis terbaru yang telah kami tunggu-tunggu</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/491888/"><img src="https://habrastorage.org/webt/gw/s2/_l/gws2_lpk_xse3zwysoxi7yhgedi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di era CI / CD di mana-mana, kita dihadapkan dengan berbagai alat terkait, termasuk sistem CI. Namun, GitLab-lah yang paling dekat dengan kami, benar-benar "asli". Dia mendapatkan popularitas terkemuka di industri secara keseluruhan *. Para pengembang produk tidak ketinggalan ketertarikan yang tumbuh dalam penggunaannya, secara teratur memuaskan komunitas pengembang dan insinyur DevOps dengan versi baru. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/le/lp/fl/lelpfl_26qkmpjz5qf5cjq4bbd0.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bulan repositori GitLab dan agregasi tag</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GitLab adalah kasus ketika pengembangan aktif membawa banyak fitur baru dan menarik. Jika bagi pengguna potensial, ini hanyalah salah satu faktor dalam memilih alat, untuk yang sudah ada, situasinya adalah sebagai berikut: jika Anda belum memperbarui instalasi GitLab Anda pada bulan lalu, maka dengan probabilitas tinggi Anda melewatkan sesuatu yang menarik. Termasuk pembaruan keamanan yang muncul secara berkala. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentang yang paling signifikan - yaitu diminta oleh para insinyur dan pelanggan DevOps kami - inovasi dalam rilis terbaru edisi Komunitas GitLab, dan artikel ini akan dibahas.</font></font><a name="habracut"></a><br>
<br>
<i>*   5  ,  Â«GitLabÂ»,   : Â«,   GitHub?Â».     â€” ,  Google Trends <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a>  5-    Â«gitlabÂ»   .     Â«Â»  ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a>.     ,   ,     Â«Â»   .</i><br>
<br>
<h2>â„–1: needs</h2><br>
<ul>
<li>     job'.</li>
<li>    GitLab: 12.2.</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a>.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pikir </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><code>dependencies</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ini yang Anda butuhkan? Mungkin, kami bukan satu-satunya yang melakukan kesalahan dalam menetapkan arahan ini ... Diperlukan untuk membuat daftar pekerjaan sebelumnya, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artefak</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> yang diperlukan. Itu adalah artefak, dan bukan ketergantungan pada kinerja tugas sebelumnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Misalkan terjadi bahwa dalam satu tahap ada pekerjaan yang tidak perlu dilakukan, tetapi untuk beberapa alasan tidak ada kemungkinan atau hanya keinginan untuk membawa mereka ke tahap yang terpisah (kemalasan adalah mesin kemajuan, tetapi jangan terbawa). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Situasi: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_u/sa/k1/_usak1lrpdqpjtxln69r3ktc5ag.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang Anda lihat, stage </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deploy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> berisi tombol untuk meluncurkan produksi dan stage, dan </font><i><font style="vertical-align: inherit;">tes Selenium</font></i><font style="vertical-align: inherit;"> job</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk beberapa alasan tidak dieksekusi. </font><font style="vertical-align: inherit;">Sederhana saja: ia menunggu sampai semua pekerjaan dari tahap sebelumnya berhasil diselesaikan. </font><font style="vertical-align: inherit;">Namun, dalam kerangka pipeline yang sama, kita tidak perlu menggunakan stage sekarang untuk menjalankan tes (dipompa keluar sebelumnya tidak dalam tag). </font><font style="vertical-align: inherit;">Apa yang harus dilakukan? </font><font style="vertical-align: inherit;">Kalau begitu datanglah ke </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kebutuhan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> penyelamatan </font><font style="vertical-align: inherit;">! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami hanya mencantumkan pekerjaan yang diperlukan sebelumnya untuk menjalankan tes kami:</font></font><br>
<br>
<pre><code class="plaintext hljs">  needs:<font></font>
    - To production (Cluster 1)<font></font>
    - To production (Cluster 2)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... dan kami mendapatkan pekerjaan, yang secara otomatis dipanggil setelah hanya pekerjaan yang terdaftar dieksekusi: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jm/9y/8z/jm9y8zesapj3neflq_xmn7er70i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mudah, bukan? </font><font style="vertical-align: inherit;">Tetapi begitu saya berharap bahwa arahan akan bekerja seperti ini </font></font><code>dependencies</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2: meluas</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Penambahan anchor dan alias YAML.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Diperkenalkan sejak GitLab 11.3.</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docs.gitlab.com/ce/ci/yaml/#extends</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bosan membaca gulungan </font></font><code>.gitlab-ci.yaml</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? Prinsip kode reuse hilang? Maka Anda sudah mencoba dan mungkin berhasil membawa milik Anda </font></font><code>.gitlab-ci.yaml</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ke keadaan seperti ini:</font></font><br>
<br>
<pre><code class="plaintext hljs">.base_deploy: &amp;base_deploy<font></font>
  stage: deploy<font></font>
  script:<font></font>
    - my_deploy_command.sh<font></font>
  variables:<font></font>
    CLUSTER: "default-cluster"<font></font>
    MY_VAR: "10"<font></font>
<font></font>
Deploy Test:<font></font>
  &lt;&lt;: *base_deploy<font></font>
  environment:<font></font>
    url: test.example.com<font></font>
    name: test<font></font>
<font></font>
Deploy Production:<font></font>
  &lt;&lt;: *base_deploy<font></font>
  environment:<font></font>
    url: production.example.com<font></font>
    name: production<font></font>
  variables:<font></font>
    CLUSTER: "prod-cluster"<font></font>
    MY_VAR: "10"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kedengarannya bagus? Namun, jika Anda melihat lebih dekat, sesuatu menarik perhatian Anda ... Mengapa kami mengubah produksi tidak hanya </font></font><code>variables.CLUSTER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, tetapi juga ditentukan untuk kedua kalinya </font></font><code>variables.MY_VAR=10</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? Haruskah variabel ini diambil </font></font><code>base_deploy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? Ternyata itu seharusnya tidak: YAML bekerja sehingga, mendefinisikan ulang apa yang diterima dari jangkar, itu </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak memperluas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> konten bidang yang cocok, tetapi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menggantinya</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Oleh karena itu, kami dipaksa untuk membuat daftar variabel yang sudah diketahui kami dalam paragraf yang cocok. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ya, "ekspansi" adalah kata yang tepat: inilah yang disebut sebagai fitur yang dimaksud. </font></font><code>Extends</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mereka memungkinkan kita tidak hanya menulis ulang bidang, seperti yang terjadi dengan jangkar, tetapi untuk melakukan penggabungan yang cerdas untuk itu:</font></font><br>
<br>
<pre><code class="plaintext hljs">.base_deploy: <font></font>
  stage: deploy<font></font>
  script:<font></font>
    - my_deploy_command.sh<font></font>
  variables:<font></font>
    CLUSTER: "default-cluster"<font></font>
    MY_VAR: "10"<font></font>
<font></font>
Deploy Production:<font></font>
  extends: .base_deploy<font></font>
  environment:<font></font>
    url: production.example.com<font></font>
    name: production<font></font>
  variables:<font></font>
    CLUSTER: "prod-cluster"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini, di pekerjaan akhir </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deploy Production</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan ada variabel </font></font><code>MY_VAR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dengan nilai default dan yang diganti </font></font><code>CLUSTER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tampaknya ini adalah hal yang sepele, tetapi bayangkan: Anda memiliki satu </font></font><code>base_deploy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan 20 sirkuit yang dikerahkan dengan cara yang sama. </font><font style="vertical-align: inherit;">Mereka perlu diteruskan ke orang lain </font></font><code>cluster</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>environment.name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sambil mempertahankan seperangkat variabel tertentu atau bidang yang cocok lainnya ... Kesenangan kecil ini memungkinkan kita untuk mengurangi deskripsi penyebaran rangkaian rangkaian dev sebanyak 2-3 kali.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3: termasuk</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kami membagi YAML besar menjadi beberapa dan menggunakan kembali dalam proyek lain.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Diperkenalkan pada Core sejak versi 11.4.</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docs.gitlab.com/ce/ci/yaml/#include</font></font></a></li>
</ul><br>
<code>.gitlab-ci.yaml</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">masih terlihat </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seperti instruksi lipat untuk penyedot debu dalam 20 bahasa (yang Anda hanya mengerti yang asli) apakah</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sulit ketika Anda harus berurusan dengan salah satu bagiannya tanpa mengubah dalam menghadapi pekerjaan yang tidak diketahui yang dihadapi dalam perjalanan? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Teman pemrograman lama akan membantu </font></font><code>include</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">stages:<font></font>
  - test<font></font>
  - build<font></font>
  - deploy<font></font>
<font></font>
variables:<font></font>
  VAR_FOR_ALL: 42<font></font>
<font></font>
include:<font></font>
  - local: .gitlab/ci/test.yml<font></font>
  - local: .gitlab/ci/build.yml<font></font>
  - local: .gitlab/ci/deploy-base.yml<font></font>
  - local: .gitlab/ci/deploy-production.yml</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Itu </font><font style="vertical-align: inherit;">Sekarang kami dengan berani mengedit penyebaran dalam produksi, sementara penguji sibuk memodifikasi file mereka, yang bahkan kita tidak melihatnya. </font><font style="vertical-align: inherit;">Selain itu, ini membantu menghindari penggabungan konflik: tidak selalu menyenangkan untuk memahami kode orang lain. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi bagaimana jika kita mengetahui pipa 20 proyek kita secara terus menerus, dapatkah kita menjelaskan logika masing-masing pekerjaan darinya? </font><font style="vertical-align: inherit;">Bagaimana ini akan membantu kami? </font><font style="vertical-align: inherit;">Bagi mereka yang telah mencapai pencerahan dalam penggunaan kembali kode dan untuk semua yang memiliki banyak proyek serupa, Anda dapat:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">using </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">include: file</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - termasuk file GitLab CI dari repositori lain dari instance GitLab yang sama,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dengan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">meliputi: templat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - koleksi </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">templat GitLab yang sudah jadi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dengan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">meliputi: remote</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - file eksternal (dapat diakses melalui HTTPS).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selusin jenis proyek yang sama dengan kode yang berbeda, tetapi digunakan dengan cara yang sama - dengan mudah dan tanpa mempertahankan CI terbaru di semua repositori! </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh penggunaan praktis </font></font><code>include</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">juga diberikan dalam </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artikel ini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nomor 4: hanya / kecuali referensi</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kondisi komprehensif, termasuk perubahan variabel dan file.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Karena ini adalah seluruh keluarga fungsi, beberapa bagian mulai muncul di GitLab 10.0, sementara yang lain (misalnya, </font></font><code>changes</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">mulai muncul di </font><font style="vertical-align: inherit;">11.4.</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docs.gitlab.com/ce/ci/yaml/#onlyexcept-advanced</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kadang-kadang bagi saya tampaknya ini bukan saluran pipa mendengarkan kita, tetapi kita dia. </font><font style="vertical-align: inherit;">Alat manajemen yang sangat baik adalah </font></font><code>only</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ </font></font><code>except</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- sekarang terintegrasi. </font><font style="vertical-align: inherit;">Apa artinya ini? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam kasus yang paling sederhana (dan mungkin yang paling menyenangkan), lewati tahapan:</font></font><br>
<br>
<pre><code class="plaintext hljs">Tests:<font></font>
  only:<font></font>
    - master<font></font>
  except:<font></font>
    refs:<font></font>
    - schedules<font></font>
    - triggers<font></font>
    variables:<font></font>
    - $CI_COMMIT_MESSAGE =~ /skip tests/</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam contoh pekerjaan, ini hanya berjalan di cabang master, tetapi tidak dapat dipicu oleh jadwal atau pemicu (GitLab berbagi pemanggilan dan pemicu API, meskipun ini pada dasarnya adalah API yang sama). </font><font style="vertical-align: inherit;">Pekerjaan tidak akan dieksekusi jika ada passphrase </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tes lewati</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dalam pesan komit </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Misalnya, kesalahan ketik dalam </font></font><code>README.md</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proyek atau dokumentasi telah </font><font style="vertical-align: inherit;">diperbaiki </font><font style="vertical-align: inherit;">- mengapa menunggu hasil tes? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Hei, 2020 ada di luar!" </font><font style="vertical-align: inherit;">Mengapa saya setiap kali harus menjelaskan kepada kotak besi bahwa tidak perlu melakukan tes ketika mengubah dokumentasi? " </font><font style="vertical-align: inherit;">Dan sungguh: </font></font><code>only:changes</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ini memungkinkan Anda untuk menjalankan tes ketika mengubah file hanya di direktori tertentu. </font><font style="vertical-align: inherit;">Contohnya:</font></font><br>
<br>
<pre><code class="plaintext hljs">  only:<font></font>
    refs:<font></font>
      - master<font></font>
      - merge_requests<font></font>
    changes:<font></font>
      - "front/**/*"<font></font>
      - "jest.config.js"<font></font>
      - "package.json"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan untuk tindakan sebaliknya - mis. </font><font style="vertical-align: inherit;">jangan lari - ya </font></font><code>except:changes</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nomor 5: aturan</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aturan pekerjaan individu.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Diperkenalkan di GitLab 12.3.</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docs.gitlab.com/ce/ci/yaml/#rules</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Arahan ini sangat mirip dengan yang sebelumnya </font></font><code>only:*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, tetapi dengan perbedaan penting: ini memungkinkan Anda untuk mengontrol parameter </font></font><code>when</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Misalnya, jika Anda tidak ingin sepenuhnya menghapus kemungkinan memulai pekerjaan. </font><font style="vertical-align: inherit;">Anda cukup meninggalkan tombol, yang, jika diinginkan, akan dipanggil secara independen, tanpa meluncurkan pipa baru atau tanpa membuat komit.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># 6: environment: auto_stop_in</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hentikan lingkungan jika tidak ada kegiatan.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Diperkenalkan di GitLab 12.8.</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docs.gitlab.com/ce/ci/yaml/#enautauto_stop_in</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami belajar tentang peluang ini tepat sebelum penerbitan artikel dan belum memiliki cukup waktu untuk mencobanya dalam praktik, tetapi ini jelas merupakan "hal yang sama" yang sangat diharapkan dalam beberapa proyek. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat menentukan parameter di lingkungan GitLab </font></font><code>on_stop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ini sangat berguna ketika Anda ingin membuat dan menghapus lingkungan secara dinamis, misalnya, untuk setiap cabang. Pekerjaan yang ditandai dengan k </font></font><code>on_stop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dieksekusi, misalnya, ketika penggabungan MR ada di cabang master atau ketika MR ditutup (atau bahkan hanya dengan mengklik tombol), yang karenanya lingkungan yang tidak perlu dihapus secara otomatis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semuanya nyaman, logis, berfungsi ... jika bukan karena faktor manusia. Banyak pengembang menggabungkan MR bukan dengan mengklik tombol di GitLab, tetapi secara lokal via </font></font><code>git merge</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Anda dapat memahaminya: nyaman! Namun dalam hal ini, logikanya</font></font><code>on_stop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itu tidak berhasil, kami telah mengumpulkan lingkungan yang terlupakan ... Di sinilah yang lama ditunggu-tunggu berguna </font></font><code>auto_stop_in</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonus: gubuk sementara saat tidak ada peluang yang cukup</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terlepas dari semua ini (dan banyak lainnya), fungsi baru yang dituntut dari GitLab, sayangnya, kadang-kadang kondisi untuk memenuhi suatu pekerjaan tidak mungkin digambarkan dalam kerangka kemampuan yang tersedia saat ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GitLab tidak sempurna, tetapi menyediakan alat dasar untuk membangun jalur pipa impian ... jika Anda siap untuk melampaui DSL sederhana, terjun ke dunia scripting. </font><font style="vertical-align: inherit;">Berikut adalah beberapa solusi dari pengalaman kami, yang sama sekali tidak berpura-pura benar atau direkomendasikan secara ideologis, tetapi disajikan lebih untuk menunjukkan kemungkinan yang berbeda dengan kurangnya fungsionalitas API bawaan.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solusi No. 1: luncurkan dua pekerjaan dengan satu tombol</font></font></h3><br>
<pre><code class="plaintext hljs">script:<font></font>
  - &gt; <font></font>
    export CI_PROD_CL1_JOB_ID=`curl -s -H "PRIVATE-TOKEN: ${GITLAB_API_TOKEN}" \ <font></font>
      "https://gitlab.domain/api/v4/projects/${CI_PROJECT_ID}/pipelines/${CI_PIPELINE_ID}/jobs" | \<font></font>
      jq '[.[] | select(.name == "Deploy (Cluster 1)")][0] | .id'`<font></font>
  - &gt; <font></font>
    export CI_PROD_CL2_JOB_ID=`curl -s -H "PRIVATE-TOKEN: ${GITLAB_API_TOKEN}" \ <font></font>
      "https://gitlab.domain/api/v4/projects/${CI_PROJECT_ID}/pipelines/${CI_PIPELINE_ID}/jobs" | \<font></font>
      jq '[.[] | select(.name == "Deploy (Cluster 2)")][0] | .id'`<font></font>
  - &gt; <font></font>
    curl -s --request POST -H "PRIVATE-TOKEN: ${GITLAB_API_TOKEN}" \ <font></font>
      "https://gitlab.domain/api/v4/projects/${CI_PROJECT_ID}/jobs/$CI_PROD_CL1_JOB_ID/play"<font></font>
  - &gt; <font></font>
    curl -s --request POST -H "PRIVATE-TOKEN: ${GITLAB_API_TOKEN}" \ <font></font>
      "https://gitlab.domain/api/v4/projects/${CI_PROJECT_ID}/jobs/$CI_PROD_CL2_JOB_ID/play"<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan mengapa tidak, jika Anda benar-benar menginginkannya?</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solusi No. 2: transfer diubah dalam file MR rb untuk rubocop di dalam gambar</font></font></h3><br>
<pre><code class="plaintext hljs">Rubocop:<font></font>
  stage: test<font></font>
  allow_failure: false<font></font>
  script:<font></font>
    ...<font></font>
    - export VARFILE=$(mktemp)<font></font>
    - export MASTERCOMMIT=$(git merge-base origin/master HEAD)<font></font>
    - echo -ne 'CHANGED_FILES=' &gt; ${VARFILE}<font></font>
    - if [ $(git --no-pager diff --name-only ${MASTERCOMMIT} | grep '.rb$' | wc -w |awk '{print $1}') -gt 0 ]; then<font></font>
        git --no-pager diff --name-only ${MASTERCOMMIT} | grep '.rb$' |tr '\n' ' ' &gt;&gt; ${VARFILE} ;<font></font>
      fi<font></font>
    - if [ $(wc -w ${VARFILE} | awk '{print $1}') -gt 1 ]; then<font></font>
        werf --stages-storage :local run rails-dev --docker-options="--rm --user app --env-file=${VARFILE}" -- bash -c /scripts/rubocop.sh ;<font></font>
      fi<font></font>
    - rm ${VARFILE}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak ada gambar di dalamnya </font></font><code>.git</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, jadi saya harus keluar untuk memeriksa hanya file yang diubah. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan: Ini bukan situasi yang sangat standar dan upaya putus asa untuk mematuhi banyak kondisi masalah, deskripsi yang tidak termasuk dalam ruang lingkup artikel ini.</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penanganan # 3: pemicu untuk memulai pekerjaan dari repositori lain saat diluncurkan</font></font></h3><br>
<pre><code class="plaintext hljs">  before_script:<font></font>
    - |<font></font>
      echo '### Trigger review: infra'<font></font>
      curl -s -X POST \<font></font>
        -F "token=$REVIEW_TOKEN_INFRA" \<font></font>
        -F "ref=master" \<font></font>
        -F "variables[REVIEW_NS]=$CI_ENVIRONMENT_SLUG" \<font></font>
        -F "variables[ACTION]=auto_review_start" \<font></font>
        https://gitlab.example.com/api/v4/projects/${INFRA_PROJECT_ID}/trigger/pipeline</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tampaknya hal yang sederhana dan perlu (dalam dunia layanan-mikro) meluncurkan perangkat-layanan lain ke dalam rangkaian yang baru dibuat sebagai ketergantungan. </font><font style="vertical-align: inherit;">Tapi itu bukan, karena itu, diperlukan panggilan API dan fitur yang sudah dikenal (dijelaskan di atas):</font></font><br>
<br>
<pre><code class="plaintext hljs">  only:<font></font>
    refs:<font></font>
    - triggers<font></font>
    variables:<font></font>
    - $ACTION == "auto_review_start"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Catatan:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pekerjaan pada pemicu dirancang untuk dikaitkan dengan meneruskan variabel ke API, mirip dengan contoh No. 1. </font><font style="vertical-align: inherit;">Lebih logis untuk mengimplementasikan ini pada API dengan nama pekerjaan disahkan.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ya, fungsinya ada dalam versi komersial (EE) dari GitLab, tetapi kami tidak mempertimbangkannya.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesimpulan</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GitLab mencoba mengikuti tren, secara bertahap menerapkan fitur yang menyenangkan dan diminati oleh komunitas DevOps. </font><font style="vertical-align: inherit;">Mereka cukup mudah digunakan, dan ketika fitur dasar tidak cukup, mereka selalu dapat diperluas dengan skrip. </font><font style="vertical-align: inherit;">Dan jika kita melihat ternyata ternyata tidak begitu elegan dan nyaman untuk mendukung ... itu masih menunggu rilis baru GitLab - atau untuk </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">membantu proyek dengan kontribusi kami</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baca juga di blog kami:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perakitan dan penyebaran jenis layanan microser yang sama dengan werf dan GitLab CI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ";</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JUnit di GitLab CI dengan Kubernetes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ";</font></font></li>
<li> Â«<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">werf â€”    CI/CD  Kubernetes (   )</a>Â» <i>( ; 27  2019  DevOpsConf)</i>;</li>
<li> Â«<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">       GitLab CI</a>Â»;</li>
<li> Â«<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">GitLab CI       production</a>Â».</li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id491876/index.html">MosQA # 2 - bahan dari mitap dan mencari semua bendera dari pencarian</a></li>
<li><a href="../id491880/index.html">5 tahap pengelakan adopsi sertifikasi ISO / IEC 27001. Marah</a></li>
<li><a href="../id491882/index.html">Otomatiskan input ke SecureCRT menggunakan skrip</a></li>
<li><a href="../id491884/index.html">Manajemen pengetahuan holistik di sebuah perusahaan IT</a></li>
<li><a href="../id491886/index.html">KnowledgeConf 2020 Online: menerapkan manajemen pengetahuan langkah-demi-langkah</a></li>
<li><a href="../id491890/index.html">Drive Anatomy: SSD</a></li>
<li><a href="../id491896/index.html">Bagaimana kami di Cyan meningkatkan produk melalui penelitian pengalaman pengguna</a></li>
<li><a href="../id491900/index.html">Fleksibilitas dan otomatisasi dalam pembelajaran mesin</a></li>
<li><a href="../id491902/index.html">Menulis editor WYSIWYG sederhana dengan ProseMirror</a></li>
<li><a href="../id491904/index.html">Cara menulis kode Python yang aman. Makanan Kushal Das</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>