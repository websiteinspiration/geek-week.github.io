<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⏱️ 📳 🛰️ Und wieder Qbot - eine neue Art von Banking-Trojanern 😶 🗒️ 🤾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wir haben eine weitere neue Art von Qbot entdeckt und rückentwickelt - komplexe, weithin bekannte Malware, die Daten sammelt, mit denen Sie Finanzbetr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Und wieder Qbot - eine neue Art von Banking-Trojanern</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/varonis/blog/486790/"><img src="https://habrastorage.org/webt/cj/7x/id/cj7xidsu1_9bkjmliahsaf1axbs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben eine weitere neue Art von Qbot entdeckt und rückentwickelt - komplexe, weithin bekannte Malware, die Daten sammelt, mit denen Sie Finanzbetrug begehen können. Hier einige Beispiele für die Daten, die Qbot sammelt: Browser-Cookies, Zertifikatinformationen, Tastenanschläge, Login-Passwort-Paare und andere Anmeldeinformationen sowie Daten aus offenen Sitzungen in Webanwendungen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Sicherheitsforschungsteam von Varonis reagierte 2019 auf mehrere Fälle von Qbot-Infektionen, hauptsächlich in den USA. Es scheint, dass die Qbot-Entwickler nicht untätig waren: Sie haben neue Stämme mit neuen Funktionen erstellt und gleichzeitig die Fähigkeit verbessert, die Erkennung durch Teams zu verhindern, die für die Informationssicherheit verantwortlich sind.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einen früheren Stamm von Qbot beschrieben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und dessen TTP (Taktiken, Techniken und Verfahren) diskutiert. </font><font style="vertical-align: inherit;">Die neue Sorte unterscheidet sich von der vorherigen in zwei Hauptdetails:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Anstatt zu versuchen, die Kennwörter eines Domänenbenutzers zu erraten, verwendet dieser Stamm einen bereits gefährdeten Benutzer, um eine Karte der verfügbaren Netzwerkordner zu erstellen. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es sendet die Opferdaten an den FTP-Server, anstatt HTTP-POST-Anforderungen zu verwenden.</font></font></li>
</ul><br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erkennung</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einer unserer Kunden bat um Hilfe, nachdem er </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der Varonis Cybersecurity-Plattform mitgeteilt hatte,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dass sich das Benutzerkonto atypisch verhält und auf eine ungewöhnliche Anzahl von Netzwerkknoten zugreift. </font><font style="vertical-align: inherit;">Dann machte der Kunde auf die Protokolle der Antivirenlösung auf dem Gerät aufmerksam, von dem aus auf diesen Zugriff zugegriffen wurde, und bemerkte unverarbeitete Benachrichtigungen über die infizierte Datei, die ungefähr zur gleichen Zeit angezeigt wurden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Rohdateien befanden sich im temporären Ordner des Benutzerprofils und hatten die Erweiterungen </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.vbs</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.zip</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Varonis-Forensik-Team half dem Benutzer beim Abrufen von Proben der infizierten Dateien, und das Sicherheitsforschungsteam analysierte und stellte fest, dass dies eine </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">neue Variante von Qbot war</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie arbeitet er?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben die infizierte Datei in unserem Labor gestartet und ähnliche Anzeichen dafür gefunden, dass sie mit denen in unserer </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vorherigen Studie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> schädlich war </font><font style="vertical-align: inherit;">- Implementierung des Prozesses „explorer.exe“, Verbindung mit derselben URL, dieselben Mechanismen, um eine ständige Präsenz in der Registrierung sicherzustellen, und auf der Festplatte und dieselbe Ersatzkopie der Datei mit "calc.exe". </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Stamm enthielt eine verschlüsselte Konfigurationsdatei mit der falschen Erweiterung ".dll". Mithilfe einer dynamischen Analyse des Prozesses explorer.exe haben wir festgestellt, dass der Schlüssel zum Entschlüsseln der verschlüsselten RC4-Konfigurationsdatei der SHA1-Hash der eindeutigen Zeichenfolge ist, die die Malware für jedes Gerät erstellt (wir wissen, dass dies kein zufälliger Zeichensatz ist, wie dies bei der vorherigen Qbot-Variante der Fall war gleiche Leitung für dasselbe Gerät).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier sind die Konfigurationsdaten, die wir für unser Gerät dekodiert haben: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/eu/_z/it/eu_zitvq4rphqklbvmserhft8d8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Konfiguration enthält die folgenden Daten:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installationszeit;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeit des letzten Anrufs von C2; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">externe IP des Opfers; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Liste der vom Opfer umgebenen Netzwerkordner. </font></font></li>
</ul><br>
<h3><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phase I: Bootloader </font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dateinamen: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JVC_82633.vbs</font></font></strong><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
SHA1: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f38ed9fec9fe4e6451645724852aa2da9fce1be9</font></font></strong><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wie in der vorherigen Version verwendete diese Variante von Qbot die VBS-Datei, um die wichtigsten schädlichen Module herunterzuladen.</font></font><br>
<br>
<h3><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phase II: Sicherstellung einer ständigen Präsenz im System und Implementierung in Prozessen</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Genau wie im vorherigen Beispiel startet der Bootloader die Kernelmodule der Malware und stellt die Konstanz ihrer Anwesenheit im Betriebssystem sicher. </font><font style="vertical-align: inherit;">Diese Version kopiert sich selbst in </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
% Appdata% \ Roaming \ Microsoft \ {Benutzerdefinierte Zeichenfolge} anstelle von% Appdata% \ Roaming \ {Benutzerdefinierte Zeichenfolge}, aber die Registrierungsschlüsselwerte und geplanten Aufgaben bleiben unverändert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Hauptnutzlast ist in alle aktiven Prozesse eingebettet, die im Auftrag des Benutzers ausgeführt werden.</font></font><br>
<br>
<h3><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phase III: Datendiebstahl - Pfad zum Hacker Server</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem sichergestellt wurde, dass das System vorhanden ist, versucht die Malware, über den URI content.bigflimz.com eine Verbindung zu ihrem C2-Server herzustellen. </font><font style="vertical-align: inherit;">Diese Version sammelt Daten, die für ihre Zwecke wichtig sind, vom Computer des Opfers und sendet sie über FTP mit fest codierten Anmelde- und Kennworteinstellungen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Server enthielt verschlüsselte Daten, die von Opfern mit dem folgenden Namensprinzip gesammelt wurden: „Artikel 1 - 6 Zeichen und danach weitere 6 Ziffern * - * POSIX-Zeit * .zip“. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben den angegebenen FTP-Server geöffnet und diesen Ordner mit den folgenden Inhalten gefunden: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kp/vf/zc/kpvfzcujonqtqvzb2lc9antejxe.png"><br>
<br>
<img src="https://habrastorage.org/webt/sk/cn/a4/skcna4gadyaviscreyowp7c-2e8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir konnten die Zip-Dateien noch nicht entschlüsseln, um festzustellen, welche Daten gestohlen wurden.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wiederherstellung und Wiederherstellung</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da wir nur ein infiziertes Gerät gefunden haben, lauteten unsere Empfehlungen:</font></font><br>
<br>
<ol>
<li>         ,        ,    ; </li>
<li>         ,   ,        IP-,    ;</li>
<li>      Varonis,     .</li>
</ol></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de486790/">https://habr.com/ru/post/de486790/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de486778/index.html">SSO zur Microservice-Architektur. Wir benutzen Keycloak. Teilenummer 1</a></li>
<li><a href="../de486780/index.html">Frontend-Entwicklung im Unternehmen: Was es ist und wie es effektiv gemacht werden kann</a></li>
<li><a href="../de486782/index.html">UI / UX - Design. Trends und Prognosen für 2020</a></li>
<li><a href="../de486784/index.html">Die Lumiere-Brüder haben nie geträumt</a></li>
<li><a href="../de486788/index.html">Webinar „Fernüberwachung und Gerätediagnose. Winnum CNC Solution Fallstudien »</a></li>
<li><a href="../de486792/index.html">Der Weg des Roboters zum eisigen Satelliten eines anderen Planeten beginnt in den Tiefen der Antarktis</a></li>
<li><a href="../de486794/index.html">Die Prozesse menschlicher Neuronen zeigten eine unerwartete Rechenfähigkeit</a></li>
<li><a href="../de486798/index.html">Gibt es ein GameDev in Sachalin? Ende</a></li>
<li><a href="../de486800/index.html">Kassandra. Wie man nicht stirbt, wenn man nur Oracle kennt</a></li>
<li><a href="../de486802/index.html">Menschen treffen auf Empfehlungssysteme. Faktorisierung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>