<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🗓️ 🍘 ☘️ Keras深層学習モデルをPython Webアプリケーションとしてデプロイする 🌉 🤛🏼 👩🏻‍🤝‍👨🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="記事の翻訳は、「PythonでのWeb開発者」というコースの学生のために特別に準備されました。
 
 
 
 クールな機械学習プロジェクトを作成することも、他の人がそれを見ることができるようにする必要がある場合は別のことです。もちろん、プロジェクト全体をGitHubに置くこともできますが、祖父母はあ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Keras深層学習モデルをPython Webアプリケーションとしてデプロイする</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/477402/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事の翻訳は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「PythonでのWeb開発者」</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">というコースの学生のために特別に準備さ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">れました</font></a><font style="vertical-align: inherit;">。</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/vz/ii/2j/vzii2j88n5_-t9hihzrz276v7ho.png"><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 クールな機械学習プロジェクトを作成することも、他の人がそれを見ることができるようにする必要がある場合は別のことです。もちろん、プロジェクト全体をGitHubに置くこともできますが、祖父母はあなたが何をしたかをどのように理解しますか？いいえ、ディープラーニングモデルを世界中の誰でも利用できるWebアプリケーションとして展開する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、Kerasで訓練された再帰型ニューラルネットワークを使用し、ユーザーが新しい特許注釈を作成できるようにするWebアプリケーションの作成方法を学びます。このプロジェクトは、記事</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">「例によるリカレントニューラルネットワーク」の</font></a><font style="vertical-align: inherit;">作業に基づいています</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ただし、RNNが現在どのように構築されているかを知る必要はありません。</font><font style="vertical-align: inherit;">現時点では、これをブラックボックスと見なします。最初のシーケンスを設定すると、完全に新しい特許アノテーションが表示され、ブラウザで表示できます。</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常、データアナリストはモデルを開発し、フロントエンドがモデルを世界に公開します。</font><font style="vertical-align: inherit;">このプロジェクトでは、両方の役割を果たし、Web開発に突入する必要があります（ほとんど完全にPythonですが）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このプロジェクトでは、いくつかのツールを組み合わせる必要があります。</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Flask</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：Pythonで基本的なWebアプリケーションを作成します。</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keras</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">事前トレーニング済みのリカレント</font></a><font style="vertical-align: inherit;">ニューラルネットワークのデプロイ</font></font></li>
<li><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jinja</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テンプレートエンジンのテンプレート</font><font style="vertical-align: inherit;">。</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Webページを作成するための</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">HTML</font></a><font style="vertical-align: inherit;">および</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最終的に、トレーニングされた再帰型ニューラルネットワークを使用して、完全に新しい特許注釈を作成できるWebアプリケーションが得られます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/l_/oc/2j/l_oc2jgyuokd3kvrsk2pn87bhis.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのプロジェクトコードは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で入手でき</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプローチ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
目標は、できるだけ早くWebアプリケーションをデプロイすることでした。</font><font style="vertical-align: inherit;">このため、Pythonでアプリケーションを作成できるFlaskを選択しました。</font><font style="vertical-align: inherit;">私はスタイルをいじるのが好きではないので（既に見たことがあると思います）、サードパーティのソースからほとんどすべてのCSSをコピーして貼り付けます。</font><font style="vertical-align: inherit;">この</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kerasチームからは、基本を学ぶために有用であった、と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この記事では、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">便利なガイドです。</font></font><br>
<blockquote><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一般的に、このプロジェクトは私の設計原則を満たしています。すばやく機能するプロトタイプを作成し（必要なだけコードをコピーして貼り付け）、同じことを繰り返すだけで製品を改善できます。</font></font></i></blockquote><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Flaskの基本的なWebアプリケーション </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Python Webアプリケーションを作成する最も速い方法は、Flask（http://flask.pocoo.org/）を使用することです。</font><font style="vertical-align: inherit;">独自のアプリケーションを作成するには、以下を使用できます。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask<font></font>
app = Flask(__name__)<font></font>
<font></font>
<span class="hljs-meta">@app.route("/")</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">hello</span>():</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">"&lt;h1&gt;Not Much Going On Here&lt;/h1&gt;"</span>
app.run(host=<span class="hljs-string">'0.0.0.0'</span>, port=<span class="hljs-number">50000</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このコードを実行すると、独自のアプリケーションがlocalhost：50000に表示されます。</font><font style="vertical-align: inherit;">もちろん、さらに何かが必要なため、通常は同じことを行うより複雑な関数を使用します。これは、ブラウザーからの要求を処理し、一部のコンテンツをHTML形式で提供します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザー入力フォーム</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーがアプリケーションのメインページに移動すると、3つのオプションがあるフォームが表示されます。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RNNのソースシーケンスを入力するか、ランダムに生成します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RNN予測の「多様性」の選択。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RNNから出力される単語数の選択。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pythonでフォームを作成するには、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wtforms</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用し</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">以下の作成用のコードが表示されます。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> wtforms <span class="hljs-keyword">import</span> (Form, TextField, validators, SubmitField, <font></font>
DecimalField, IntegerField)<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReusableForm</span>(<span class="hljs-params">Form</span>):</span>
    <span class="hljs-string">"""User entry form for entering specifics for generation"""</span>
    <span class="hljs-comment"># Starting seed</span>
    seed = TextField(<span class="hljs-string">"Enter a seed string or 'random':"</span>, validators=[<font></font>
                     validators.InputRequired()])<font></font>
    <span class="hljs-comment"># Diversity of predictions</span>
    diversity = DecimalField(<span class="hljs-string">'Enter diversity:'</span>, default=<span class="hljs-number">0.8</span>,<font></font>
                             validators=[validators.InputRequired(),<font></font>
                                         validators.NumberRange(min=<span class="hljs-number">0.5</span>, max=<span class="hljs-number">5.0</span>,<font></font>
                                         message=<span class="hljs-string">'Diversity must be between 0.5 and 5.'</span>)])
    <span class="hljs-comment"># Number of words</span>
    words = IntegerField(<span class="hljs-string">'Enter number of words to generate:'</span>,<font></font>
                         default=<span class="hljs-number">50</span>, validators=[validators.InputRequired(),<font></font>
                                                 validators.NumberRange(min=<span class="hljs-number">10</span>, max=<span class="hljs-number">100</span>, <font></font>
                                                 message=<span class="hljs-string">'Number of words must be between 10 and 100'</span>)])
    <span class="hljs-comment"># Submit button</span>
    submit = SubmitField(<span class="hljs-string">"Enter"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを使用して、以下に示すフォームを作成しました（のスタイルを使用</font></font><code>main.css</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ja/mc/2j/jamc2jeigbqz87z4flruuzuzp4e.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーが正しい情報を入力したことを確認するには、コードをチェックインする必要があります。</font><font style="vertical-align: inherit;">たとえば、すべてのフィールドが入力されていること、および多様性パラメーターの値が0.5から5の間であることを確認します。開始するには、これらの条件を満たす必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wz/wy/e2/wzwye2lrn8rrnfdp1lemj9hf4p4.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">入力されたデータが正しいことを確認中にエラーが発生しました。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
このフォームはのテンプレートを使用して処理され</font></font><code>Flask</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パターン</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テンプレートは、すでに準備された「フレーム」を含むファイルであり、特定の方法で埋める必要があるだけです。</font><font style="vertical-align: inherit;">Flask Webアプリケーションの場合、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jinja</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テンプレートライブラリ</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用して、</font><font style="vertical-align: inherit;">PythonコードをHTMLドキュメントに変換</font><font style="vertical-align: inherit;">でき</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">たとえば、メイン関数では、フォームの内容をというテンプレートに送信します</font></font><code>index.html</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> render_template<font></font>
<font></font>
<span class="hljs-comment"># Home page</span>
<span class="hljs-meta">@app.route("/", methods=['GET', 'POST'])</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">home</span>():</span>
    <span class="hljs-string">"""Home page of app with form"""</span>
    <span class="hljs-comment"># Create form</span><font></font>
    form = ReusableForm(request.form)<font></font>
<font></font>
    <span class="hljs-comment"># Send template information to index.html</span>
    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">'index.html'</span>, form=form)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーがメインページに移動すると、アプリケーションが</font></font><code>index.html</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォームから入力</font><font style="vertical-align: inherit;">を提供し</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">テンプレートは、構文を使用してPython変数を参照する完全なHTML構造</font></font><code>{{variable}}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>RNN Patent Writing<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/static/css/main.css"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"shortcut icon"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/static/images/lstm.ico"</span>&gt;</span><font></font>
  <font></font>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span>Writing Novel Patent Abstracts with Recurrent Neural Networks<span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><font></font>
<font></font>
    {% block content %}<font></font>
    {% for message in form.seed.errors %}<font></font>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flash"</span>&gt;</span>{{ message }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><font></font>
    {% endfor %}<font></font>
<font></font>
    {% for message in form.diversity.errors %}<font></font>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flash"</span>&gt;</span>{{ message }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><font></font>
    {% endfor %}<font></font>
<font></font>
    {% for message in form.words.errors %}<font></font>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flash"</span>&gt;</span>{{ message }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><font></font>
    {% endfor %}<font></font>
<font></font>
    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">method</span>=<span class="hljs-string">post</span>&gt;</span><font></font>
<font></font>
      {{ form.seed.label }}<font></font>
      {{ form.seed }}<font></font>
<font></font>
      {{ form.diversity.label }}<font></font>
      {{ form.diversity }}<font></font>
<font></font>
      {{ form.words.label }}<font></font>
      {{ form.words }}<font></font>
<font></font>
      {{ form.submit }}<font></font>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><font></font>
    {% endblock %}<font></font>
<font></font>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フォームでエラーが発生した場合（検証できない入力）、エラーメッセージが点滅します。</font><font style="vertical-align: inherit;">さらに、フォームは上記のファイルのように表示されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーが情報を入力して</font></font><code>submit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><code>POST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-要求）</font><font style="vertical-align: inherit;">を押すと</font><font style="vertical-align: inherit;">、情報が正しければ、入力データを対応する関数にリダイレクトして、トレーニングされたRNNを使用して予測を行います。</font><font style="vertical-align: inherit;">つまり、変更する必要があります</font></font><code>home()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> request
<span class="hljs-comment"># User defined utility functions</span>
<span class="hljs-keyword">from</span> utils <span class="hljs-keyword">import</span> generate_random_start, generate_from_seed<font></font>
<font></font>
<span class="hljs-comment"># Home page</span>
<span class="hljs-meta">@app.route("/", methods=['GET', 'POST'])</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">home</span>():</span>
    <span class="hljs-string">"""Home page of app with form"""</span><font></font>
    <font></font>
    <span class="hljs-comment"># Create form</span><font></font>
    form = ReusableForm(request.form)<font></font>
<font></font>
    <span class="hljs-comment"># On form entry and all conditions met</span>
    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">'POST'</span> <span class="hljs-keyword">and</span> form.validate():
        <span class="hljs-comment"># Extract information</span>
        seed = request.form[<span class="hljs-string">'seed'</span>]<font></font>
        diversity = float(request.form[<span class="hljs-string">'diversity'</span>])<font></font>
        words = int(request.form[<span class="hljs-string">'words'</span>])
        <span class="hljs-comment"># Generate a random sequence</span>
        <span class="hljs-keyword">if</span> seed == <span class="hljs-string">'random'</span>:
            <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">'random.html'</span>, <font></font>
                                   input=generate_random_start(model=model, <font></font>
                                                               graph=graph, <font></font>
                                                               new_words=words, <font></font>
                                                               diversity=diversity))<font></font>
        <span class="hljs-comment"># Generate starting from a seed sequence</span>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">'seeded.html'</span>, <font></font>
                                   input=generate_from_seed(model=model, <font></font>
                                                            graph=graph, <font></font>
                                                            seed=seed, <font></font>
                                                            new_words=words, <font></font>
                                                            diversity=diversity))<font></font>
    <span class="hljs-comment"># Send template information to index.html</span>
    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">'index.html'</span>, form=form)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、ユーザーがクリック</font></font><code>submit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">して入力した情報が正しい場合、入力データに応じて、入力は</font></font><code>generate_random_start</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">またはに</font><font style="vertical-align: inherit;">送信されます</font></font><code>generate_from_seed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これらの関数は、Kerasのトレーニング済みモデルを使用して、</font><font style="vertical-align: inherit;">ユーザー定義の</font><font style="vertical-align: inherit;">パラメーター</font></font><code>diversity</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">とで</font><font style="vertical-align: inherit;">新しい特許を作成し</font></font><code>num_words</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">この関数の出力は、ランダムにテンプレートに送信される</font></font><code>random.html</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">か</font></font><code>seeded.html</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Webページとして表示されます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keras事前トレーニング済みモデルを使用した予測の作成</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パラメータに</font></font><code>model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、次のように読み込まれる事前トレーニング済みのKerasモデルが含まれています。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> keras.models <span class="hljs-keyword">import</span> load_model
<span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">load_keras_model</span>():</span>
    <span class="hljs-string">"""Load in the pre-trained model"""</span>
    <span class="hljs-keyword">global</span> model<font></font>
    model = load_model(<span class="hljs-string">'../models/train-embeddings-rnn.h5'</span>)
    <span class="hljs-comment"># Required for model to work</span>
    <span class="hljs-keyword">global</span> graph<font></font>
    graph = tf.get_default_graph()<font></font>
    <font></font>
load_keras_model()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（実際、</font><font style="vertical-align: inherit;">次のような</font><font style="vertical-align: inherit;">バイパス</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パス</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">があります</font></font><code>tf.get_default_graph()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2つの関数</font></font><code>util</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あるコード</font><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">を完全には表示しません</font><font style="vertical-align: inherit;">。これは、トレーニング済みのモデルKerasをパラメーターと一緒に格納して予測を行うことを理解する必要があるためです。特許アノテーション。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの関数はどちらも、フォーマット済みのHTMLを含むPythonで文字列を返します。この行は、Webページとして表示される別のテンプレートに送信されます。たとえば、以下に</font></font><code>generate_random_start</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">送信されるフォーマット済みHTMLを返します</font></font><code>random.html</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Random Starting Abstract
    <span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><font></font>
<font></font>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/static/css/main.css"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"shortcut icon"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/static/images/lstm.ico"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/"</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span><font></font>
        {% block content %}<font></font>
        {{input|safe}}<font></font>
        {% endblock %}<font></font>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでも、テンプレートエンジン</font></font><code>Jinja</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用して</font><font style="vertical-align: inherit;">、フォーマットされたHTMLファイルを表示します。</font><font style="vertical-align: inherit;">Python文字列は既にHTMLに翻訳されているので、それを表示するために必要なのは使用</font></font><code>{{input|safe}}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><code>input</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python変数は</font><font style="vertical-align: inherit;">どこ</font><font style="vertical-align: inherit;">ですか）だけです。</font><font style="vertical-align: inherit;">その後</font></font><code>main.css</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、他のHTMLページと同様に、このページにスタイルを追加できます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仕事の結果</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この関数は</font></font><code>generate_random_start</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ランダムな特許アノテーションを入力シーケンスとして選択し、それに基づいて予測を行います。次に、入力シーケンス、RNN生成出力、および実際の出力を表示します</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z_/2y/6q/z_2y6q7q7xalfmwihsw3ohxwuza.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。ランダムな入力シーケンスに基づく出力。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
この関数</font></font><code>generate_from_seed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、ユーザーが入力した初期シーケンスを受け入れ、それに基づいて予測を作成します。出力は次のとおりです</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vd/4t/xw/vd4txwgqdyresaxrd5a0midnosm.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。ユーザー入力シーケンスに基づく出力。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果は常に論理的なシーケンスを形成するわけではありませんが、それにもかかわらず、ニューラルネットワークが英語の基本に精通していることを示しています。</font><font style="vertical-align: inherit;">彼女は前の50に基づいて次の各単語を予測し、それによって説得力のある注釈を選択するように訓練されました。</font><font style="vertical-align: inherit;">パラメータによっては、</font></font><code>diversity</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">出力が完全にランダムまたは周期的になる場合があります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーションの起動</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーションを自分で開始するには、リポジトリをダウンロードし、デプロイメントがあるディレクトリに移動してと入力するだけ</font></font><code>run_keras_server.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">アプリケーションはで入手できます</font></font><code>localhost:10000</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自宅のWi-Fiの設定に応じて、IPアドレスを使用してネットワーク上の任意のコンピューターからアプリケーションにアクセスできるはずです。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次のステップ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パソコンで実行するウェブアプリケーションは、友人や家族と共有するのに最適です。</font><font style="vertical-align: inherit;">ただし、ホームネットワーク上のすべての人に開くことはお勧めしません。</font><font style="vertical-align: inherit;">後で、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS EC2に</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーションをデプロイする方法を学び</font><font style="vertical-align: inherit;">、最終的にそれを世界に示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーションを改善するには、スタイル（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.css内</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）を変更し、場合によっては、事前トレーニング済みの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネットワーク</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を選択する機能などのパラメーターを追加します</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">個人プロジェクトの素晴らしい点は、好きなだけ開発できることです。</font><font style="vertical-align: inherit;">アプリケーションを操作したい場合は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リポジトリ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">ダウンロードして</font><font style="vertical-align: inherit;">開始してください。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hu/z9/up/huz9upmw2zstf5wdojoflzsrxey.gif"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論 </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、Kerasの事前トレーニング済みディープラーニングモデルをウェブアプリケーションとしてデプロイする方法を学びました。</font><font style="vertical-align: inherit;">これには、リカレントニューラルネットワーク、Webアプリケーション、テンプレート、HTML、CSS、そしてもちろん</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">など、さまざまなテクノロジーの統合が必要でした</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは基本的なアプリケーションですが、比較的少ない労力でディープラーニングを使用してWebアプリケーションを作成できることを示しています。</font><font style="vertical-align: inherit;">ウェブアプリケーションの形でディープラーニングモデルをデプロイできたと言う人はほとんどいませんが、この記事の手順に従うと、その1人になることができます。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja477388/index.html">NILFS2-/ホーム向けの防弾ファイルシステム</a></li>
<li><a href="../ja477390/index.html">Kubernetesでのネットワーク遅延のデバッグ</a></li>
<li><a href="../ja477392/index.html">オープンマイク：バックエンド。スピーカー募集</a></li>
<li><a href="../ja477396/index.html">コースへの登録方法...最後に移動</a></li>
<li><a href="../ja477400/index.html">プロダクトマネージャーの職業について：理想を達成する方法？</a></li>
<li><a href="../ja477404/index.html">C ++でオブジェクトを頻繁に作成および削除する問題</a></li>
<li><a href="../ja477406/index.html">テクニカルサポートとサポート。雇用市場と給与に関する素晴らしい研究。2年間で何が変わったのですか？</a></li>
<li><a href="../ja477408/index.html">JavaFXチュートリアル：高度なレイアウト</a></li>
<li><a href="../ja477414/index.html">データエンジニア-21世紀の最もセクシーな職業</a></li>
<li><a href="../ja477416/index.html">ハッシュはいつ有害か</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>