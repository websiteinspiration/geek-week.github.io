<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕵🏾 🆖 👐🏼 Arduinoの洗車パート2.5（ソースコード、写真なし） 🔋 ➕ 💯</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="リクエストに応じて、洗車のソースコード全体をarduinoに投稿します。
 
 説明については、洗車時のArduinoおよび洗車時のArduino、パート2を参照してください。
 
 UPD：
 catのみのソースコード。CCNetプロトコルを使用してarduinoやCashCodeのような請求書受...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Arduinoの洗車パート2.5（ソースコード、写真なし）</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483410/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リクエストに応じて、洗車のソースコード全体をarduinoに投稿します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
説明については、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">洗車</font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">時のArduino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">洗車</font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">時のArduino、パート2を</font></a><font style="vertical-align: inherit;">参照してください</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UPD：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
catのみのソースコード。</font><font style="vertical-align: inherit;">CCNetプロトコルを使用してarduinoやCashCodeのような請求書受領者と通信することに興味がある人のみを対象としています。</font><font style="vertical-align: inherit;">ところで、無駄に時間を無駄にしないでください。</font></font><br>
<a name="habracut"></a><br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;SPI.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;Ethernet.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;SoftwareSerial.h&gt;</span></span>
<span class="hljs-comment">//#include &lt;MFRC522.h&gt;</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;EEPROM.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span>
<span class="hljs-comment">//#include &lt;avr/wdt.h&gt;</span>
<span class="hljs-comment">//#include "ICMPPing.h"</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> POLYNOMIAL 0x08408</span><font></font>
<font></font>
<span class="hljs-keyword">uint8_t</span> reset[] = {<span class="hljs-number">0x02</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0xB3</span>};
<span class="hljs-keyword">uint8_t</span> ack[] = {<span class="hljs-number">0x02</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0C2</span>, <span class="hljs-number">0x82</span>};
<span class="hljs-keyword">uint8_t</span> poll[] = {<span class="hljs-number">0x02</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x81</span>};
<span class="hljs-keyword">uint8_t</span> enable[]={<span class="hljs-number">0x02</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0xC1</span>};
<span class="hljs-comment">/*
uint8_t stack[] = {0x02, 0x03, 0x06, 0x35, 0xEC, 0xE4};
uint8_t sec[] = {0x02, 0x03, 0x09, 0x32, 0x00, 0x00, 0x00, 0x26, 0x1F};
uint8_t GetSt[]={0x02, 0x03, 0x06, 0x31, 0xC8, 0xA2};
uint8_t Ident[]={0x02, 0x03, 0x06, 0x37, 0xFE, 0xC7};
uint8_t GetBT[]={0x02, 0x03, 0x06, 0x41, 0x4F, 0xD1};
uint8_t Return[]={0x02, 0x03, 0x06, 0x36, 0x77, 0xD6};
uint8_t Hold[]={0x02, 0x03, 0x06, 0x38, 0x09, 0x3F};
uint8_t ExtBD[]={0x02, 0x03, 0x06, 0x3A, 0x1B, 0x1C};
uint8_t ReqSt[]={0x02, 0x03, 0x06, 0x60, 0xC4, 0xE1};
uint8_t DiBT[]={0x02, 0x03, 0x0C, 0x34, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x17, 0x0C};*/</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> max7219_reg_decodeMode 0x09</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> max7219_reg_intensity 0x0a</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> max7219_reg_scanLimit 0x0b</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> max7219_reg_shutdown 0x0c</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> max7219_reg_displayTest 0x0f</span><font></font>
<font></font>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> alf[] = {<span class="hljs-number">0</span>,
  <span class="hljs-number">28</span>, <span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">28</span>, <span class="hljs-comment">// 0</span>
  <span class="hljs-number">8</span>, <span class="hljs-number">24</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">28</span>,<span class="hljs-comment">// 1</span>
  <span class="hljs-number">28</span>, <span class="hljs-number">34</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">16</span>, <span class="hljs-number">32</span>, <span class="hljs-number">62</span>, <span class="hljs-comment">// 2</span>
  <span class="hljs-number">28</span>, <span class="hljs-number">34</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">34</span>, <span class="hljs-number">28</span>, <span class="hljs-comment">//3</span>
  <span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">62</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>,
  <span class="hljs-number">62</span>, <span class="hljs-number">32</span>, <span class="hljs-number">32</span>, <span class="hljs-number">60</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">60</span>,
  <span class="hljs-number">28</span>, <span class="hljs-number">32</span>, <span class="hljs-number">32</span>, <span class="hljs-number">60</span>, <span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">28</span>,
  <span class="hljs-number">62</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">16</span>, <span class="hljs-number">32</span>, <span class="hljs-number">32</span>,
  <span class="hljs-number">28</span>, <span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">28</span>, <span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">28</span>,
  <span class="hljs-number">28</span>, <span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">30</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">28</span><font></font>
};<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DIN 16</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CS 17</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CLK 18</span><font></font>
<font></font>
<span class="hljs-comment">//#define RST_PIN 8</span>
<span class="hljs-comment">//#define SS_PIN 9</span><font></font>
<font></font>
<span class="hljs-comment">//MFRC522 mfrc522(SS_PIN, RST_PIN); // Create MFRC522 instance MISO 12, MOSI 11, SCK 13</span>
<span class="hljs-comment">//byte admin_key[][4] = { { 0x99, 0x3C, 0x16, 0xDB }, { 0x16, 0x95, 0x59, 0x7B }, { 0x46, 0x93, 0xF1, 0x74 }, { 0x03, 0x1F, 0x17, 0xDB }};</span><font></font>
<font></font>
<span class="hljs-keyword">void</span>(* resetFunc) (<span class="hljs-keyword">void</span>) = <span class="hljs-number">0</span>;<font></font>
<font></font>
<span class="hljs-function">SoftwareSerial <span class="hljs-title">mySerial</span><span class="hljs-params">(<span class="hljs-number">14</span>, <span class="hljs-number">15</span>)</span></span>; <span class="hljs-comment">// RX, TX</span><font></font>
<font></font>
byte system100[]={<span class="hljs-number">92</span>, <span class="hljs-number">53</span>, <span class="hljs-number">96</span>, <span class="hljs-number">34</span>};
<span class="hljs-comment">//IPAddress pingAddr(192,168,1,1); //  DNS</span>
<span class="hljs-comment">//SOCKET pingSocket = 0;</span>
<span class="hljs-comment">//int timePing = 0;</span>
<span class="hljs-comment">//int pingFAIL = 0; //  </span>
<span class="hljs-comment">//ICMPPing ping(pingSocket, (uint16_t)random(0, 255));</span><font></font>
<font></font>
<span class="hljs-comment">//EthernetClient client;</span>
<span class="hljs-function">EthernetServer <span class="hljs-title">server</span><span class="hljs-params">(<span class="hljs-number">80</span>)</span></span>;
<span class="hljs-keyword">char</span> SAM; <span class="hljs-comment">// </span><font></font>
<font></font>
<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> timeCount=<span class="hljs-number">0</span>;
<span class="hljs-keyword">bool</span> waitACK=<span class="hljs-number">0</span>;
<span class="hljs-keyword">char</span> count=<span class="hljs-number">0</span>;
<span class="hljs-keyword">char</span> LNG=<span class="hljs-number">6</span>;
<span class="hljs-keyword">uint8_t</span> c;
<span class="hljs-keyword">uint8_t</span> z1=<span class="hljs-number">0</span>;
<span class="hljs-keyword">uint8_t</span> z2=<span class="hljs-number">0</span>;
<span class="hljs-keyword">uint8_t</span> old=<span class="hljs-number">1</span>;<font></font>
<font></font>
<span class="hljs-keyword">char</span> rele=<span class="hljs-number">0</span>;
<span class="hljs-keyword">char</span> rOld=<span class="hljs-number">0</span>;<font></font>
<font></font>
<span class="hljs-keyword">bool</span> keydown=<span class="hljs-number">0</span>;<font></font>
<font></font>
<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> timeAllRele=<span class="hljs-number">1000</span>;
<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> timeRele=<span class="hljs-number">0</span>;
<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> lightOff=<span class="hljs-number">0</span>;
<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> sendPoll=<span class="hljs-number">0</span>;
<span class="hljs-keyword">char</span> posPay; <span class="hljs-comment">// </span>
<span class="hljs-keyword">char</span> posErr; <span class="hljs-comment">// </span>
<span class="hljs-keyword">char</span> clientline[<span class="hljs-number">100</span>];<font></font>
<font></font>
<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> resetTime;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-comment">//wdt_enable(WDTO_8S);</span>
  <span class="hljs-comment">//delay(2000);</span>
  <span class="hljs-comment">//if(EEPROM.read(30)==1) { EEPROM.write(30, 0); resetFunc(); }</span>
  <span class="hljs-comment">//EEPROM.write(30, 1);</span><font></font>
  <font></font>
  pinMode(DIN,OUTPUT); pinMode(CS,OUTPUT); pinMode(CLK,OUTPUT); digitalWrite(CS, HIGH);<font></font>
  initLed();<font></font>
  pinMode(<span class="hljs-number">2</span>, OUTPUT); pinMode(<span class="hljs-number">3</span>, OUTPUT); pinMode(<span class="hljs-number">4</span>, OUTPUT); pinMode(<span class="hljs-number">5</span>, OUTPUT); pinMode(<span class="hljs-number">6</span>, OUTPUT); pinMode(<span class="hljs-number">7</span>, OUTPUT); digitalWrite(<span class="hljs-number">7</span>, HIGH); <span class="hljs-comment">//</span><font></font>
    <font></font>
  pinMode (A5, INPUT); <span class="hljs-comment">//</span>
  <span class="hljs-keyword">if</span>(EEPROM.read(<span class="hljs-number">10</span>)==<span class="hljs-number">255</span> &amp;&amp; EEPROM.read(<span class="hljs-number">11</span>)==<span class="hljs-number">255</span>) { EEPROM.write(<span class="hljs-number">10</span>, <span class="hljs-number">0</span>); EEPROM.write(<span class="hljs-number">11</span>, <span class="hljs-number">0</span>); } <span class="hljs-comment">//     </span><font></font>
<font></font>
  posPay=EEPROM.read(<span class="hljs-number">99</span>);
  <span class="hljs-keyword">if</span>(posPay&lt;<span class="hljs-number">0</span> || posPay&gt;<span class="hljs-number">99</span>) { EEPROM.write(<span class="hljs-number">99</span>, <span class="hljs-number">0</span>); posPay=<span class="hljs-number">0</span>; }<font></font>
  posErr=EEPROM.read(<span class="hljs-number">199</span>);
  <span class="hljs-keyword">if</span>(posErr&lt;<span class="hljs-number">0</span> || posErr&gt;<span class="hljs-number">99</span>) { EEPROM.write(<span class="hljs-number">199</span>, <span class="hljs-number">0</span>); posErr=<span class="hljs-number">0</span>; }<font></font>
  <font></font>
  SAM=EEPROM.read(<span class="hljs-number">0</span>);<font></font>
  Serial.begin(<span class="hljs-number">9600</span>);<font></font>
  Serial.print(SAM, DEC); Serial.print(<span class="hljs-string">" "</span>); Serial.print(posPay, DEC); Serial.print(<span class="hljs-string">" "</span>); Serial.print(posErr, DEC);Serial.println(<span class="hljs-string">" begin"</span>);<font></font>
  <font></font>
  byte mac[] = { <span class="hljs-number">0xDE</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xED</span>-SAM };
  <span class="hljs-comment">//byte gate[]={192, 168, 1, 1};</span>
  <span class="hljs-comment">//byte mask[]={255,255,255,0};</span>
  <span class="hljs-function">IPAddress <span class="hljs-title">ip</span><span class="hljs-params">(<span class="hljs-number">192</span>, <span class="hljs-number">168</span>, <span class="hljs-number">1</span>, <span class="hljs-number">100</span>+SAM)</span></span>;<font></font>
  Ethernet.begin(mac, ip);<span class="hljs-comment">//, gate, gate, mask</span><font></font>
  server.begin();<font></font>
  delay(<span class="hljs-number">200</span>);<font></font>
  Serial.print(<span class="hljs-string">"server is at "</span>);<font></font>
  Serial.println(Ethernet.localIP());<font></font>
  <font></font>
  mySerial.begin(<span class="hljs-number">9600</span>);<font></font>
  delay(<span class="hljs-number">200</span>);<font></font>
  <font></font>
  rOld=EEPROM.read(<span class="hljs-number">9</span>);
  <span class="hljs-keyword">if</span>(rOld&lt;<span class="hljs-number">0</span> || rOld&gt;<span class="hljs-number">8</span>) EEPROM.write(<span class="hljs-number">9</span>, <span class="hljs-number">0</span>); <span class="hljs-comment">// </span>
    <span class="hljs-keyword">else</span> setRele(rOld);<font></font>
  resetTime=millis();<font></font>
 <span class="hljs-comment">// mfrc522.PCD_Init();// Init MFRC522</span><font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-comment">//if(millis()-resetTime&gt;600000) resetFunc(); //  10 </span>
  <span class="hljs-keyword">if</span>(millis()-sendPoll&gt;<span class="hljs-number">200</span>) { sendCCNET(poll);} <span class="hljs-comment">//   //wdt_reset();  </span><font></font>
<font></font>
<span class="hljs-comment">/*if (Serial.available()) {
    char s=Serial.read(); //int pay=Serial.parseInt();
    if(s=='0') { Serial.print("RESET"); sendCCNET(reset); waitACK=1; count=0; }
    if(s=='1') { printNumber(100); EEPROM.write(100+posPay, 4); posPay++; EEPROM.write(99, posPay); }
    if(s=='3') { sendInfo(); }
}
  if(millis()-timePing&gt;10000)
  {
    timePing=millis();
    ICMPEchoReply echoReply = ping(pingAddr, 2);
    if (echoReply.status == SUCCESS) pingFAIL=0; else { Serial.println("pingFAIL"); if(++pingFAIL&gt;3) resetFunc(); }
    //initLed();
  }*/</span><font></font>
  <font></font>
  <span class="hljs-keyword">int</span> key = analogRead (<span class="hljs-number">5</span>);
  <span class="hljs-comment">//Serial.println(key);</span>
  <span class="hljs-keyword">if</span>(keydown &amp;&amp; key&lt;<span class="hljs-number">20</span>) keydown=<span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span>(key&gt;<span class="hljs-number">300</span> &amp;&amp; key&lt;<span class="hljs-number">315</span> &amp;&amp; !keydown) setRele(<span class="hljs-number">6</span>); <span class="hljs-comment">//</span>
  <span class="hljs-keyword">if</span>(key&gt;<span class="hljs-number">330</span> &amp;&amp; key&lt;<span class="hljs-number">400</span> &amp;&amp; !keydown) setRele(<span class="hljs-number">0</span>);<span class="hljs-comment">//</span>
  <span class="hljs-keyword">if</span>(!keydown &amp;&amp; rele==<span class="hljs-number">0</span> &amp;&amp; (EEPROM.read(<span class="hljs-number">10</span>)&gt;<span class="hljs-number">0</span> || EEPROM.read(<span class="hljs-number">11</span>)&gt;<span class="hljs-number">0</span>))<font></font>
  {<font></font>
    <span class="hljs-keyword">if</span>(key&gt;<span class="hljs-number">920</span> &amp;&amp; key&lt;<span class="hljs-number">980</span>) setRele(<span class="hljs-number">1</span>);
    <span class="hljs-keyword">if</span>(key&gt;<span class="hljs-number">810</span> &amp;&amp; key&lt;<span class="hljs-number">870</span>) setRele(<span class="hljs-number">2</span>);
    <span class="hljs-keyword">if</span>(key&gt;<span class="hljs-number">720</span> &amp;&amp; key&lt;<span class="hljs-number">780</span>) setRele(<span class="hljs-number">3</span>);
    <span class="hljs-keyword">if</span>(key&gt;<span class="hljs-number">600</span> &amp;&amp; key&lt;<span class="hljs-number">640</span>) setRele(<span class="hljs-number">4</span>);
    <span class="hljs-keyword">if</span>(key&gt;<span class="hljs-number">420</span> &amp;&amp; key&lt;<span class="hljs-number">480</span>) setRele(<span class="hljs-number">5</span>);<font></font>
  }<font></font>
 <font></font>
  <span class="hljs-keyword">if</span>(rele&gt;<span class="hljs-number">0</span> &amp;&amp; rele&lt;=<span class="hljs-number">5</span> &amp;&amp; (millis()-timeRele)&gt;timeAllRele) { <span class="hljs-keyword">if</span>(printNumber(<span class="hljs-number">-1</span>)==<span class="hljs-number">0</span>) setRele(<span class="hljs-number">0</span>); timeRele+=timeAllRele; }
  <span class="hljs-keyword">if</span>(lightOff&gt;<span class="hljs-number">0</span> &amp;&amp; (millis()-lightOff)&gt;<span class="hljs-number">10000</span>) { digitalWrite(<span class="hljs-number">7</span>, HIGH); lightOff=<span class="hljs-number">0</span>; } <span class="hljs-comment">//</span><font></font>
<font></font>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> sock = <span class="hljs-number">0</span>; sock &lt; MAX_SOCK_NUM; sock++) {<font></font>
    EthernetClient sclient = server.available_(sock);<font></font>
    <span class="hljs-keyword">if</span> (sclient) myserver(sclient);
    <span class="hljs-comment">//serverWorks2(sclient);</span><font></font>
  }<font></font>
   <font></font>
  delay(<span class="hljs-number">30</span>);
  <span class="hljs-comment">// Look for new cards</span>
 <span class="hljs-comment">// if ( mfrc522.PICC_IsNewCardPresent() &amp;&amp; mfrc522.PICC_ReadCardSerial()) dump_byte_array(mfrc522.uid.uidByte, mfrc522.uid.size);</span><font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sendCCNET</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> *com)</span>
</span>{
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">char</span> i=<span class="hljs-number">0</span>; i&lt;com[<span class="hljs-number">2</span>]; i++) mySerial.write(com[i]);
  <span class="hljs-keyword">if</span>(com[<span class="hljs-number">3</span>]!=<span class="hljs-number">0</span>) { waitACK=<span class="hljs-number">1</span>; count=<span class="hljs-number">0</span>; sendPoll=millis(); }
  <span class="hljs-keyword">while</span>(waitACK)<font></font>
  {<font></font>
    <span class="hljs-keyword">if</span>(millis()-sendPoll&gt;<span class="hljs-number">300</span>) waitACK=<span class="hljs-number">0</span>; <span class="hljs-comment">// .   </span>
    <span class="hljs-keyword">if</span>(mySerial.available()) {<font></font>
      c=mySerial.read();<font></font>
      <span class="hljs-keyword">if</span>(count==<span class="hljs-number">2</span>) LNG=c;
      <span class="hljs-keyword">if</span>(count==<span class="hljs-number">3</span>) z1=c;
      <span class="hljs-keyword">if</span>(count==<span class="hljs-number">4</span>) z2=c;<font></font>
      count++;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span>(count&lt;LNG) <span class="hljs-keyword">continue</span>;<font></font>
    <font></font>
    waitACK=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span>(z1&gt;<span class="hljs-number">0</span> &amp;&amp; z1&lt;<span class="hljs-number">255</span>) sendCCNET(ack);
    <span class="hljs-keyword">if</span>(z1==<span class="hljs-number">0x10</span> || z1==<span class="hljs-number">0x11</span> || z1==<span class="hljs-number">0x12</span>) { sendCCNET(reset); } <span class="hljs-comment">//Serial.print("POWER UP RESET ");</span>
    <span class="hljs-keyword">if</span>(z1==<span class="hljs-number">0x19</span>) { sendCCNET(enable); } <span class="hljs-comment">//Serial.print("DISABLED ENABLE ");</span>
    <span class="hljs-keyword">if</span>(z1==<span class="hljs-number">70</span>) { sendCCNET(reset); } <span class="hljs-comment">//Serial.print("PAUSE RESET ");</span><font></font>
      <font></font>
    <span class="hljs-keyword">if</span>(old!=z1)<font></font>
    {<font></font>
      <span class="hljs-comment">/*Serial.print(z1, HEX); Serial.print(" "); Serial.println(z2, HEX);
      if(z1==0x14) Serial.println("IDLING");
      
      if(z1==0x00) Serial.println("ACK"); if(z1==0xFF) Serial.println("NAK");
      if(z1==0x13) Serial.println("INIT"); if(z1==0x15) Serial.println("ACCEPTING");
      if(z1==0x17) Serial.println("STACKING"); if(z1==0x30) Serial.println("INVALID COMMAND");
      if(z1==0x41) Serial.println("DROP CASSETTE FULL");
      if(z1==0x44) Serial.println("JAM IN STACKER"); if(z1==0x42) Serial.println("DROP CASSETTE REMOVED");
      if(z1==0x47) { Serial.print("Generic Failure codes "); Serial.println(z2, HEX); sendInfo("err", String(z2)); }
      if(z1==0x1C) { Serial.print("Generic rejecting code "); Serial.println(z2, HEX); sendInfo("err", String(z2)); } */</span><font></font>
     <font></font>
      <span class="hljs-keyword">if</span>(z1&gt;<span class="hljs-number">0x20</span> &amp;&amp; z1&lt;<span class="hljs-number">0x81</span> &amp;&amp; posErr&lt;<span class="hljs-number">100</span>) { EEPROM.write(<span class="hljs-number">200</span>+posErr, z1==<span class="hljs-number">0x47</span> || z1==<span class="hljs-number">0x1C</span> ? z2 : z1); posErr++; EEPROM.write(<span class="hljs-number">199</span>, posErr); } <span class="hljs-comment">// sendInfo("err", String(z1));</span><font></font>
    }<font></font>
    old=z1;<font></font>
      <font></font>
    <span class="hljs-keyword">if</span>(z1==<span class="hljs-number">0x81</span>) { Serial.print(<span class="hljs-string">"PACKED, STACKED."</span>); Serial.println(z2); <span class="hljs-keyword">int</span> pay=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span>(z2==<span class="hljs-number">2</span>) pay=<span class="hljs-number">10</span>; <span class="hljs-keyword">if</span>(z2==<span class="hljs-number">3</span>) pay=<span class="hljs-number">50</span>; <span class="hljs-keyword">if</span>(z2==<span class="hljs-number">4</span>) pay=<span class="hljs-number">100</span>; <span class="hljs-keyword">if</span>(z2==<span class="hljs-number">5</span>) pay=<span class="hljs-number">500</span>; <span class="hljs-keyword">if</span>(z2==<span class="hljs-number">6</span>) pay=<span class="hljs-number">1000</span>; <span class="hljs-keyword">if</span>(z2==<span class="hljs-number">7</span>) pay=<span class="hljs-number">5000</span>;
       <span class="hljs-keyword">if</span>(pay&gt;<span class="hljs-number">0</span>) { printNumber(pay); <span class="hljs-keyword">if</span>(posPay&lt;<span class="hljs-number">100</span>) { EEPROM.write(<span class="hljs-number">100</span>+posPay, z2); posPay++; EEPROM.write(<span class="hljs-number">99</span>, posPay);}<font></font>
       z2=<span class="hljs-number">0</span>; }<font></font>
    }<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setRele</span><span class="hljs-params">(<span class="hljs-keyword">char</span> r)</span>
</span>{
  <span class="hljs-keyword">if</span>(r &amp;&amp; r!=rOld) { rOld=r; delay(<span class="hljs-number">30</span>); <span class="hljs-keyword">return</span>; } <span class="hljs-comment">//</span><font></font>
  rele=r;<font></font>
  keydown=<span class="hljs-number">1</span>;
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">char</span> i=<span class="hljs-number">1</span>;i&lt;<span class="hljs-number">6</span>;i++) digitalWrite(i+<span class="hljs-number">1</span>, HIGH);
  <span class="hljs-keyword">if</span>(r==<span class="hljs-number">6</span>) r=<span class="hljs-number">1</span>; <span class="hljs-comment">//</span>
  <span class="hljs-keyword">if</span>(r) { digitalWrite(r+<span class="hljs-number">1</span>, LOW); timeRele=millis(); timeAllRele=<span class="hljs-number">60000</span>/EEPROM.read(r); }<font></font>
  EEPROM.write(<span class="hljs-number">9</span>, r);<font></font>
  delay(<span class="hljs-number">20</span>);<font></font>
  initLed();<font></font>
  <span class="hljs-keyword">if</span>(r==<span class="hljs-number">0</span> &amp;&amp; (posPay&gt;<span class="hljs-number">5</span> || posErr&gt;<span class="hljs-number">5</span>)) sendInfo();<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setCommand</span><span class="hljs-params">(byte command, byte value)</span>
</span>{<font></font>
  digitalWrite(CS, LOW);<font></font>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">4</span>; i++) { shiftOut(DIN,CLK, MSBFIRST, command); shiftOut(DIN,CLK, MSBFIRST, value); }<font></font>
  digitalWrite(CS, HIGH);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">initLed</span><span class="hljs-params">()</span>
</span>{<font></font>
  setCommand(max7219_reg_scanLimit, <span class="hljs-number">0x07</span>);<font></font>
  setCommand(max7219_reg_decodeMode, <span class="hljs-number">0x00</span>); <span class="hljs-comment">// using an led matrix (not digits)</span>
  setCommand(max7219_reg_shutdown, <span class="hljs-number">0x01</span>); <span class="hljs-comment">// not in shutdown mode</span>
  setCommand(max7219_reg_displayTest, <span class="hljs-number">0x00</span>); <span class="hljs-comment">// no display test</span>
  setCommand(max7219_reg_intensity, <span class="hljs-number">1</span>);
  <span class="hljs-keyword">int</span> n=printNumber(<span class="hljs-number">0</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">printNumber</span><span class="hljs-params">(<span class="hljs-keyword">int</span> add)</span>
</span>{
  <span class="hljs-keyword">int</span> n=EEPROM.read(<span class="hljs-number">10</span>)+EEPROM.read(<span class="hljs-number">11</span>)*<span class="hljs-number">256</span>;
  <span class="hljs-keyword">if</span>(add!=<span class="hljs-number">0</span>) { n+=add; EEPROM.write(<span class="hljs-number">10</span>, n%<span class="hljs-number">256</span>); EEPROM.write(<span class="hljs-number">11</span>, n&gt;&gt;<span class="hljs-number">8</span>); }
  <span class="hljs-keyword">int</span> k;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> i=<span class="hljs-number">1</span>; i&lt;=<span class="hljs-number">8</span>; i++)<font></font>
  {<font></font>
   digitalWrite(CS, LOW);<font></font>
   <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> j=<span class="hljs-number">3</span>; j&gt;=<span class="hljs-number">0</span>; j--) { k=n/<span class="hljs-built_in">pow</span>(<span class="hljs-number">10</span>,j); shiftOut(DIN,CLK, MSBFIRST,i); shiftOut(DIN,CLK, MSBFIRST,alf[i+(k%<span class="hljs-number">10</span>)*<span class="hljs-number">8</span>]); }<font></font>
   digitalWrite(CS, HIGH);<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span>(n&gt;<span class="hljs-number">0</span>) { digitalWrite(<span class="hljs-number">7</span>, LOW); lightOff=<span class="hljs-number">0</span>; } <span class="hljs-keyword">else</span> lightOff=millis(); <span class="hljs-comment">//</span>
  <span class="hljs-keyword">return</span> n;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">myserver</span><span class="hljs-params">(EthernetClient client)</span>
</span>{
  <span class="hljs-comment">//EthernetClient client = server.available();</span><font></font>
    <font></font>
  <span class="hljs-keyword">int</span> index = <span class="hljs-number">0</span>;<font></font>
  Serial.println(<span class="hljs-string">"new client"</span>);
  <span class="hljs-keyword">while</span> (client.available()) {
      <span class="hljs-keyword">char</span> c = client.read();
      <span class="hljs-keyword">if</span>(index&lt;<span class="hljs-number">99</span>) clientline[index] = c;<font></font>
      index++;<font></font>
        <span class="hljs-comment">//Serial.print(c);</span><font></font>
  }<font></font>
      <font></font>
    <span class="hljs-comment">//Serial.println(clientline);</span>
  <span class="hljs-keyword">char</span> *t;<font></font>
  t=<span class="hljs-built_in">strstr</span>(clientline, <span class="hljs-string">"timer"</span>);
  <span class="hljs-keyword">if</span> (t!=<span class="hljs-literal">NULL</span>) { t+=<span class="hljs-number">5</span>; <span class="hljs-keyword">char</span> timer=*t; t+=<span class="hljs-number">2</span>; <span class="hljs-keyword">int</span> value=(*t<span class="hljs-number">-48</span>)*<span class="hljs-number">10</span>; t++; value+=*t<span class="hljs-number">-48</span>; EEPROM.write(timer<span class="hljs-number">-48</span>, value);<font></font>
             Serial.print(<span class="hljs-string">"timer "</span>); Serial.print(timer); Serial.print(<span class="hljs-string">" value "</span>); Serial.println(value, DEC);<font></font>
          }<font></font>
  t=<span class="hljs-built_in">strstr</span>(clientline, <span class="hljs-string">"pay"</span>);
  <span class="hljs-keyword">if</span> (t!=<span class="hljs-literal">NULL</span>) { t+=<span class="hljs-number">4</span>; <span class="hljs-keyword">int</span> value=(*t<span class="hljs-number">-48</span>)*<span class="hljs-number">100</span>; t++; value+=(*t<span class="hljs-number">-48</span>)*<span class="hljs-number">10</span>; t++; value+=*t<span class="hljs-number">-48</span>; printNumber(value);<font></font>
           Serial.print(<span class="hljs-string">"pay is "</span>); Serial.println(value, DEC);<font></font>
        }<font></font>
  <span class="hljs-keyword">if</span>(<span class="hljs-built_in">strstr</span>(clientline, <span class="hljs-string">"reset"</span>)!=<span class="hljs-literal">NULL</span>) resetFunc(); <span class="hljs-comment">// setup(); //</span>
  <span class="hljs-keyword">if</span>(<span class="hljs-built_in">strstr</span>(clientline, <span class="hljs-string">"water"</span>)!=<span class="hljs-literal">NULL</span>) digitalWrite(<span class="hljs-number">2</span>, LOW); <span class="hljs-comment">//</span>
  <span class="hljs-keyword">if</span>(<span class="hljs-built_in">strstr</span>(clientline, <span class="hljs-string">"pena"</span>)!=<span class="hljs-literal">NULL</span>) digitalWrite(<span class="hljs-number">3</span>, LOW); <span class="hljs-comment">//</span>
  <span class="hljs-keyword">if</span>(<span class="hljs-built_in">strstr</span>(clientline, <span class="hljs-string">"vosk"</span>)!=<span class="hljs-literal">NULL</span>) digitalWrite(<span class="hljs-number">4</span>, LOW); <span class="hljs-comment">//</span>
  t=<span class="hljs-built_in">strstr</span>(clientline, <span class="hljs-string">"box"</span>); <span class="hljs-keyword">if</span>(t!=<span class="hljs-literal">NULL</span>) { t+=<span class="hljs-number">4</span>; EEPROM.write(<span class="hljs-number">0</span>, *t<span class="hljs-number">-48</span>); } <span class="hljs-comment">// setup(); resetFunc(); } //  </span>
  client.println(<span class="hljs-string">"HTTP/1.1 200 OK"</span>); client.println(<span class="hljs-string">"Content-Type: text/html"</span>); client.println(<span class="hljs-string">"Connection: close"</span>); client.println();<font></font>
  client.println(<span class="hljs-string">"&lt;!DOCTYPE HTML&gt;"</span>); client.println(<span class="hljs-string">"&lt;html&gt;"</span>);<font></font>
  client.print(<span class="hljs-string">"box is "</span>); client.print(EEPROM.read(<span class="hljs-number">0</span>)); client.println(<span class="hljs-string">"&lt;br /&gt;"</span>);<font></font>
  client.print(<span class="hljs-string">"cashcode is "</span>); client.print(z1, HEX); client.println(<span class="hljs-string">"&lt;br /&gt;"</span>);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt; <span class="hljs-number">6</span>; j++) {<font></font>
         client.print(<span class="hljs-string">"timer "</span>); client.print(j); client.print(<span class="hljs-string">" is "</span>); client.print(EEPROM.read(j)); client.println(<span class="hljs-string">"&lt;br /&gt;"</span>);<font></font>
        }<font></font>
  client.println(<span class="hljs-string">"&lt;/html&gt;"</span>);<font></font>
  delay(<span class="hljs-number">100</span>);
  <span class="hljs-comment">// close the connection:</span><font></font>
  client.stop();<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">char</span> <span class="hljs-title">sendInfo</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-comment">//if(!posErr &amp;&amp; !posPay) return 0;</span><font></font>
  EthernetClient client;<font></font>
  <span class="hljs-keyword">char</span> j;<font></font>
  String out=<span class="hljs-string">"sam="</span>+String(EEPROM.read(<span class="hljs-number">0</span>))+<span class="hljs-string">"&amp;pka="</span>+String(EEPROM.read(<span class="hljs-number">13</span>)); <span class="hljs-comment">//pka</span>
  <span class="hljs-keyword">if</span>(posPay)<font></font>
  {<font></font>
      out+=<span class="hljs-string">"&amp;pays="</span>;
      <span class="hljs-keyword">for</span>(j=<span class="hljs-number">0</span>; j&lt;posPay; j++) { out+=String(EEPROM.read(<span class="hljs-number">100</span>+j))+<span class="hljs-string">"-"</span>; }<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">if</span>(posErr)<font></font>
  {<font></font>
      out+=<span class="hljs-string">"&amp;errs="</span>;
      <span class="hljs-keyword">for</span>(j=<span class="hljs-number">0</span>; j&lt;posErr; j++) { out+=String(EEPROM.read(<span class="hljs-number">200</span>+j))+<span class="hljs-string">"-"</span>; }<font></font>
  }<font></font>
  <font></font>
  <span class="hljs-keyword">if</span> (client.connect(system100, <span class="hljs-number">80</span>) || client.connect(system100, <span class="hljs-number">80</span>) || client.connect(<span class="hljs-string">"www.host.ru"</span>, <span class="hljs-number">80</span>))<font></font>
  {<font></font>
    Serial.println(<span class="hljs-string">"GET /control/sinh/get_money.php?"</span>+out+<span class="hljs-string">" HTTP/1.1"</span>);<font></font>
    client.println(<span class="hljs-string">"GET /control/sinh/get_money.php?"</span>+out+<span class="hljs-string">" HTTP/1.1"</span>);<font></font>
    <font></font>
    client.println(<span class="hljs-string">"Host: www.host.ru"</span>);<font></font>
    client.println(<span class="hljs-string">"Connection: keep-alive"</span>);<font></font>
    client.println();<font></font>
  } <span class="hljs-keyword">else</span> { Serial.println(<span class="hljs-string">"connection failed"</span>); <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>; }<font></font>
<font></font>
  delay(<span class="hljs-number">100</span>);
  <span class="hljs-keyword">char</span> chr13=<span class="hljs-number">0</span>;
  <span class="hljs-keyword">bool</span> ok=<span class="hljs-number">0</span>;
  <span class="hljs-keyword">char</span> c;<font></font>
  <font></font>
  <span class="hljs-keyword">while</span> (client.available())<font></font>
  {<font></font>
    c=client.read();<font></font>
    Serial.print(c);<font></font>
    <span class="hljs-keyword">if</span>(chr13==<span class="hljs-number">2</span> &amp;&amp; c==<span class="hljs-string">'o'</span>) ok=<span class="hljs-number">1</span>; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(c==<span class="hljs-number">13</span>) chr13++; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(c!=<span class="hljs-number">10</span>) chr13=<span class="hljs-number">0</span>;<font></font>
  }<font></font>
  client.stop();<font></font>
  <font></font>
  <span class="hljs-comment">//if(!ok) return (0);</span><font></font>
  <font></font>
  posPay=<span class="hljs-number">0</span>; EEPROM.write(<span class="hljs-number">99</span>, posPay);<font></font>
  posErr=<span class="hljs-number">0</span>; EEPROM.write(<span class="hljs-number">199</span>, posErr);
  <span class="hljs-keyword">return</span> (<span class="hljs-number">1</span>);<font></font>
}</code></pre></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja483396/index.html">システムアナリストをゼロから育てた方法</a></li>
<li><a href="../ja483400/index.html">Pythonで進行状況を追跡する</a></li>
<li><a href="../ja483402/index.html">AMDは、CES 2020で64コアデスクトップRyzen Threadripper 3990X、Radeon RX 5600グラフィックカード、およびモバイルCPUを発表しました</a></li>
<li><a href="../ja483406/index.html">製品のゲーミフィケーション</a></li>
<li><a href="../ja483408/index.html">Jupyter Notebookで5分で生産性を向上</a></li>
<li><a href="../ja483414/index.html">膝関節の半月板-それは何ですか、なぜですか、損傷している場合はどのように治療されますか？</a></li>
<li><a href="../ja483416/index.html">Powershellを使用してプロセスを自動化しようとしています</a></li>
<li><a href="../ja483418/index.html">チケットシステム：3つの無料OTRSをどのように支払ったのですか？</a></li>
<li><a href="../ja483424/index.html">DBA：PostgreSQLデータベース間でのSEQUENCE値の転送</a></li>
<li><a href="../ja483426/index.html">金曜日タブ調査</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>