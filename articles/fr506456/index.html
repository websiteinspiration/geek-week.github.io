<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏿‍⚕️ 🧐 🏇 Nous recevons et analysons le signal radio du terminal de paiement via SDR ✌🏻 ♨️ 👊🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr. 
 
 Récemment, j'ai eu l'occasion de tester un terminal de paiement avec possibilité de paiement sans contact. Eh bien, puisque le paie...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Nous recevons et analysons le signal radio du terminal de paiement via SDR</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/506456/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonjour, Habr. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Récemment, j'ai eu l'occasion de tester un terminal de paiement avec possibilité de paiement sans contact. </font><font style="vertical-align: inherit;">Eh bien, puisque le paiement est sans contact, le signal est transmis par radio, et bien sûr, je ne pouvais pas abandonner la tentation de regarder avec le récepteur SDR quel type de données est transmis et reçu pendant le paiement. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/of/lx/nc/oflxncgb4c_qvhq6ptvxadvfyf8.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Photo (c) Verifone</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Pour ceux qui sont intéressés par la façon dont cela fonctionne, quelques détails sous la coupe.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il convient de noter tout de suite que je n'ai pas de description officielle du protocole d'échange d'un terminal avec une carte, ces données ne sont généralement distribuées qu'aux entreprises partenaires après la signature du NDA, mais personne ne nous interdit d'écouter l'air et de faire des hypothèses. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alors, commençons.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spectre du signal</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Commençons par la chose la plus simple: démarrez le récepteur, allumez le terminal, effectuez le paiement et voyez ce qui est en ondes. </font><font style="vertical-align: inherit;">La recherche du signal s'avère élémentaire, un énorme pic est visible à une fréquence de 13,56 MHz: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wo/-h/l7/wo-hl75zr6ratqupuvl9ohw8wsg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le niveau du signal n'est pas surprenant, car il devrait suffire pour une communication inductive avec une carte qui n'a pas sa propre source d'alimentation. </font><font style="vertical-align: inherit;">Comme Google le suggère, 13,56 MHz est la fréquence standard des appareils RFID. </font><font style="vertical-align: inherit;">La symétrie du signal suggère l'utilisation possible de la modulation AM. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant que le signal est trouvé, il est facile de le regarder plus en détail et de voir les différentes phases de paiement: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/p8/c-/cp/p8c-cpgkrxw7rq-uhs4jt0ms_hi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
considérez-les plus en détail.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Mode veille</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce mode, le terminal ne rayonne rien, seul le logo de la banque ou du magasin est affiché à l'écran.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Demande de paiement et attente de la carte</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le caissier initie un paiement d'un certain montant. </font><font style="vertical-align: inherit;">À ce stade, le terminal passe en mode veille de paiement. </font><font style="vertical-align: inherit;">Le paiement par carte peut se faire soit à l'aide d'une bande magnétique, soit en insérant une carte, soit par la méthode sans contact qui nous intéresse. </font><font style="vertical-align: inherit;">Pour déterminer quand la carte a été apportée au terminal, une demande est envoyée toutes les 0.12s. </font><font style="vertical-align: inherit;">De courtes parcelles sous forme de lignes verticales sur le spectre, sous une forme agrandie, ressemblent à ceci: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hl/bc/yv/hlbcyvjnx9wrtvr2d1n5bedlvdi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On voit clairement que les données sont répétées. </font><font style="vertical-align: inherit;">Le bloc de données («à l'œil», 24 ou 32 bits) contient très probablement un masque de bits contenant les formats de carte pris en charge par ce lecteur. </font><font style="vertical-align: inherit;">Au moins pour les autres cartes (par exemple, le transport), le lecteur ne «répond» pas.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Échange de données avec la carte</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsqu'une carte est détectée, son contrôleur envoie en réponse ses données - probablement le numéro de carte et les informations de service. </font><font style="vertical-align: inherit;">Il n'y a pas d'alimentation dans la carte elle-même, donc la réponse de celle-ci est très faible en puissance. </font><font style="vertical-align: inherit;">Comme vous pouvez le voir, pour chaque demande de terminal, la carte envoie une réponse, la «radio» entre eux est assez active: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ms/vq/cs/msvqcsmzk4qkowdclpxauf9melg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
le signal accru reçu de la carte ressemble à ceci:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vt/t4/lf/vtt4lfrsq2vh9glkdfwcxcxses8.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Vérification de la carte</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque les données de la carte sont reçues, le terminal vérifie probablement les clés de cryptage sur la carte, le processus prend environ 0,6 s. </font><font style="vertical-align: inherit;">Le module RFID est actuellement désactivé. </font><font style="vertical-align: inherit;">Peut-être que le terminal demande le statut de la carte en ligne.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Retrait de la carte en attente</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au moment où le terminal lit toutes les données et vérifie la carte, le message «retirer la carte» s'affiche à l'écran, toutes les 5 ms le terminal vérifie si la carte est en place: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bi/vl/wp/bivlwp5c5uhb-etgpva3gfc0tfg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
on voit les mêmes messages, la réponse de la carte est également visible. </font><font style="vertical-align: inherit;">Dans une vue agrandie, vous pouvez montrer le moment où la carte a cessé de répondre: la </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jd/rj/bh/jdrjbhqexfxncf0z3k5743rw8zq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
réponse de la carte elle-même, soit dit en passant, est assez simple et courte, "à l'œil nu", pas plus de 24 bits: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/n_/b_/l_/n_b_l_8-zlnpokvhf98w0cpq5va.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
à ce moment, l'échange radio se termine, et avec toutes les données reçues, le terminal envoie une demande de paiement à pot. </font><font style="vertical-align: inherit;">Une réponse vient de la banque, et si le paiement est réussi, nous recevons nos marchandises.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, au niveau binaire, tout est assez simple. Le protocole RFID utilise la modulation d'amplitude conventionnelle, pas de science fusée. Mais bien sûr, le travail principal est effectué à un niveau logique, vérifier la carte et effectuer un paiement est un processus assez compliqué, qui implique également le cryptage. Pour ceux qui souhaitent étudier le sujet plus en détail, vous pouvez trouver des commentaires utiles des utilisateurs </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rizorko</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lil_Toady</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dans lesquels vous pouvez trouver des liens vers des normes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enfin, vous pouvez répondre à la question qui intéresse probablement beaucoup: est-il possible de retirer secrètement de l'argent de la carte de quelqu'un d'autre à une grande distance. A en juger par l'analyse du signal radio, on peut dire que c'est très peu probable. Tout d'abord, la carte elle-même n'a pas d'alimentation intégrée - pour que son processeur fonctionne, la force du champ doit être </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assez</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gros. La distance de lecture normale de la carte est de 2-3 cm, afin de l'augmenter à au moins 100 cm, l'intensité du champ doit être au troisième degré supérieure à cette différence. Le deuxième point reçoit une réponse de la carte - son signal est très faible, et il n'est pas facile non plus de le recevoir à grande distance (et n'oubliez pas que la longueur d'onde avec une fréquence de 13 MHz est d'environ 20 mètres, et les antennes courtes à de telles longueurs d'onde sont inefficaces). Enfin, n'oubliez pas les aspects organisationnels - chaque terminal de paiement est lié au compte bancaire d'une personne morale, et s'il y a des plaintes concernant le débit des fonds, ce compte peut simplement être bloqué. Soit dit en passant, le terminal lui-même a un identifiant unique, et s'il est constamment lié à différents comptes, cela sera également suspect. En général, bien que la lecture théoriquement à distance de la RFID puisse être possible,A en juger par</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans cet article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , il n'y a eu aucun cas réel de tels retraits. </font><font style="vertical-align: inherit;">Et enfin, la limite des paiements sans contact est très faible, donc le «profit» ne correspondra probablement pas au risque et au coût de l'équipement.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr506442/index.html">Tick ​​Tuck</a></li>
<li><a href="../fr506444/index.html">Défis futurs</a></li>
<li><a href="../fr506450/index.html">Expérience de l'utilisation de la technologie Rutoken pour l'enregistrement et l'autorisation des utilisateurs dans le système (partie 1)</a></li>
<li><a href="../fr506452/index.html">Comment protéger votre site public avec ESNI</a></li>
<li><a href="../fr506454/index.html">Pour ce qu'un bim-manager obtient 100 000 et comment le devenir</a></li>
<li><a href="../fr506460/index.html">Différences entre le cerveau masculin et féminin: les femmes codent-elles mieux?</a></li>
<li><a href="../fr506462/index.html">Poussoirs et tachers - comment j'ai testé tout ce que j'ai trouvé</a></li>
<li><a href="../fr506472/index.html">Protection des entreprises pour les entrepreneurs Internet: où ouvrir une entreprise et un compte, que rechercher</a></li>
<li><a href="../fr506478/index.html">Installation et configuration de RTKRCV (RTKLIB) sur Windows 10 à l'aide de WSL</a></li>
<li><a href="../fr506480/index.html">2008 vs 2020: comment le comportement des investisseurs évolue pendant la crise</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>