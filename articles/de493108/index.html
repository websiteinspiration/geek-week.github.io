<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë≤üèø üë®üèø‚Äçüåæ üëΩ Cloudflare w√§hlt AMD-Prozessoren f√ºr Edgeserver der zehnten Generation aus üêà üîß üíô</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="T√§glich passieren mehr als eine Milliarde eindeutige IP-Adressen das Cloudflare-Netzwerk. Es bedient mehr als 11 Millionen HTTP-Anfragen pro Sekunde. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Cloudflare w√§hlt AMD-Prozessoren f√ºr Edgeserver der zehnten Generation aus</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/493108/"><img src="https://habrastorage.org/getpro/habr/post_images/536/952/a76/536952a764f14e82b44b8765e9c63737.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
T√§glich passieren mehr als eine Milliarde eindeutige IP-Adressen das Cloudflare-Netzwerk. Es bedient mehr als 11 Millionen HTTP-Anfragen pro Sekunde. Es befindet sich in einer Entfernung von nicht mehr als 100 ms von 95% der Internetbev√∂lkerung. Unser Netzwerk umfasst 200 St√§dte in mehr als 90 L√§ndern, und unser Engineering-Team hat eine extrem schnelle und zuverl√§ssige Infrastruktur aufgebaut. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir sind sehr stolz auf unsere Arbeit und setzen uns daf√ºr ein, das Internet besser und sicherer zu machen. Cloudflare-Ingenieure, deren Arbeit sich auf Hardware bezieht, sind mit Servern und ihren Komponenten bestens vertraut, um die besten Ger√§te zu verstehen und auszuw√§hlen, um deren Effizienz zu maximieren.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unser Software-Stack verarbeitet High-Load-Computing und ist stark von der CPU-Geschwindigkeit abh√§ngig. Deshalb m√ºssen unsere Ingenieure die Effizienz und Zuverl√§ssigkeit von Cloudflare auf allen Ebenen des Stacks st√§ndig optimieren. </font><font style="vertical-align: inherit;">Auf der Serverseite besteht der einfachste Weg darin, die Rechenleistung durch Hinzuf√ºgen von CPU-Kernen zu erh√∂hen. </font><font style="vertical-align: inherit;">Je mehr Kerne in einen Server passen, desto mehr Daten k√∂nnen verarbeitet werden. </font><font style="vertical-align: inherit;">Dies ist wichtig f√ºr uns, da die Vielfalt unserer Produkte und Kunden im Laufe der Zeit zunimmt und das Wachstum der Anforderungen erfordert, dass Server die Produktivit√§t steigern. </font><font style="vertical-align: inherit;">Um ihre Produktivit√§t zu steigern, mussten wir die Dichte der Kerne erh√∂hen - und genau das haben wir erreicht. </font><font style="vertical-align: inherit;">Nachfolgend finden Sie Details zu Prozessordaten f√ºr Server, die wir seit 2015 bereitstellen, einschlie√ülich der Anzahl der Kerne:</font></font><br>
<a name="habracut"></a><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--- ---.</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gen 6</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gen 7</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gen 8</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gen 9</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arbeitsbeginn</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2015</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2016</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2017</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2018</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zentralprozessor</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel Xeon E5-2630 v3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel Xeon E5-2630 v4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel Xeon Silver 4116</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel Xeon Platinum 6162</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Physische Kerne</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 8</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 10</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 12</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 24</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TDP</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 85W</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 85W</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 85W</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 150W</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TDP pro Kern</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10,65 W.</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8,50 W.</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7,08W</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6,25 W.</font></font></td>
</tr>
</tbody></table></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Jahr 2018 haben wir mit der 9. Generation einen gro√üen Sprung in der Gesamtzahl der Kerne pro Server gemacht. </font><font style="vertical-align: inherit;">Die Umweltbelastung wurde im Vergleich zur 8. Generation um 33% reduziert, was uns die M√∂glichkeit gab, das Volumen und die Rechenleistung pro Rack zu erh√∂hen. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Designanforderungen f√ºr </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Thermal Design Power</font></a><font style="vertical-align: inherit;"> (TDP) </font><font style="vertical-align: inherit;">werden </font><font style="vertical-align: inherit;">erw√§hnt, um zu betonen, dass auch unsere Energieeffizienz im Laufe der Zeit gewachsen ist. </font><font style="vertical-align: inherit;">Dieser Indikator ist wichtig f√ºr uns: Erstens wollen wir weniger Kohlenstoff in die Atmosph√§re abgeben; </font><font style="vertical-align: inherit;">Zweitens m√∂chten wir die Energie von Rechenzentren optimal nutzen. </font><font style="vertical-align: inherit;">Aber wir wissen, wonach wir streben m√ºssen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unsere wichtigste definierende Metrik ist die Anzahl der Anforderungen pro Watt. Wir k√∂nnen die Anzahl der Anfragen pro Sekunde erh√∂hen, indem wir Kerne hinzuf√ºgen, aber wir m√ºssen innerhalb unseres Energiebudgets bleiben. Wir sind durch die Energieinfrastruktur von Rechenzentren begrenzt, die uns zusammen mit unseren ausgew√§hlten Energieverteilungsmodulen eine bestimmte Obergrenze f√ºr jedes Server-Rack gibt. Das Hinzuf√ºgen von Servern zu einem Rack erh√∂ht den Stromverbrauch. Die Betriebskosten werden dramatisch steigen, wenn wir √ºber die Begrenzung der Energie pro Rack hinausgehen und neue Racks hinzuf√ºgen m√ºssen. Wir m√ºssen die Rechenleistung erh√∂hen und im gleichen Energiebereich bleiben, was die Anzahl der Anforderungen pro Watt erh√∂ht - unsere Schl√ºsselmetrik.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie vielleicht erraten haben, haben wir den Energieverbrauch in der Entwurfsphase sorgf√§ltig untersucht. </font><font style="vertical-align: inherit;">Die obige Tabelle zeigt, dass wir keine Zeit damit verschwenden sollten, energieintensivere CPUs einzusetzen, wenn die TDP pro Kern h√∂her ist als die aktuelle Generation - dies wirkt sich negativ auf unsere Metrik aus, die Anzahl der Anforderungen pro Watt. </font><font style="vertical-align: inherit;">Wir haben die betriebsbereiten Systeme f√ºr unsere Generation X auf dem Markt sorgf√§ltig gepr√ºft und eine Entscheidung getroffen. </font><font style="vertical-align: inherit;">Wir wechseln von unserer Schaltung mit 48 Intel Xeon Platinum 6162-Kernen und zwei Sockeln zu einem 48-Kern AMD EPYC 7642 mit einem Sockel.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/d3c/162/8f5/d3c1628f5dfb45681f0fb25abce76b3e.jpg"><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--- ---.</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AMD</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zentralprozessor</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xeon Platinum 6162</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPYC 7642</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikroarchitektur</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Skylake" </font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "Zen 2"</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code Name</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Skylake SP"</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Rom" </font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prozesstechnik</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">14nm</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7nm</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kerne</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 24</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">48</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Frequenz</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,9 GHz</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2,4 GHz</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L3 Cache / Socket</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">24 x 1,375 MB</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16 x 16 MB</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speicher / Sockel</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6 Kan√§le, bis zu DDR4-2400</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8 Kan√§le bis DDR4-3200</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TDP</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 150W</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">225W</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PCIe / Socket</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">48 Fahrspuren</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">128 Fahrspuren</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IST EIN</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x86-64</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x86-64</font></font></td>
</tr>
</tbody></table></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aus den Spezifikationen geht hervor, dass der Chip von AMD es uns erm√∂glicht, die gleiche Anzahl von Kernen zu belassen, wodurch die TDP gesenkt wird. </font><font style="vertical-align: inherit;">In der 9. Generation betrug die TDP pro Kern 6,25 Watt und in der X. Generation 4,69 Watt. </font><font style="vertical-align: inherit;">Ein R√ºckgang von 25%. </font><font style="vertical-align: inherit;">Aufgrund der Frequenzerh√∂hung und m√∂glicherweise einer einfacheren Schaltung mit einem einzigen Sockel k√∂nnen wir davon ausgehen, dass sich der AMD-Chip als besser erweisen wird. </font><font style="vertical-align: inherit;">W√§hrend wir verschiedene Tests und Simulationen durchf√ºhren, um zu verstehen, wie viel besser AMD sein wird.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Zwischenzeit stellen wir fest, dass TDP eine vereinfachte Metrik aus den Herstellerspezifikationen ist, die wir in den fr√ºhen Phasen des Serverdesigns und der CPU-Auswahl verwendet haben. </font><font style="vertical-align: inherit;">Eine schnelle Google-Suche zeigt, dass AMD und Intel unterschiedliche Ans√§tze zur Definition von TDP verfolgen, weshalb diese Spezifikation nicht zuverl√§ssig ist. </font><font style="vertical-align: inherit;">Der tats√§chliche Stromverbrauch der CPU und vor allem der Stromverbrauch des Servers werden bei der endg√ºltigen Entscheidung wirklich verwendet.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vorbereitung auf das √ñkosystem</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zu Beginn unserer Reise zur Auswahl des n√§chsten Prozessors haben wir eine gro√üe Auswahl an CPUs verschiedener Hersteller untersucht, die f√ºr unseren Software-Stack und unsere Services (geschrieben in C, LuaJIT und Go) gut geeignet sind. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In einem Artikel in unserem Blog</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> haben wir bereits eine Reihe von Tools zur Geschwindigkeitsmessung ausf√ºhrlich beschrieben </font><font style="vertical-align: inherit;">. In diesem Fall haben wir denselben Satz verwendet. Dadurch k√∂nnen wir die Effizienz der CPU in angemessener Zeit bewerten. Danach k√∂nnen unsere Ingenieure beginnen, unsere Programme an einen bestimmten Prozessor anzupassen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben verschiedene Prozessoren mit einer Vielzahl von Kernen, Sockeln und Frequenzen getestet. Da dieser Artikel beschreibt, warum wir uns f√ºr den AMD EPYC 7642 entschieden haben, konzentrieren sich alle Grafiken in diesem Blog auf die Leistung von AMD-Prozessoren im Vergleich zum Intel Xeon Platinum 6162 von</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unsere 9. Generation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Ergebnisse entsprechen Messungen des Betriebs eines Servers mit jeder Prozessorvariante - dh mit zwei 24-Kern-Prozessoren von Intel oder mit einem 48-Kern-Prozessor von AMD (Server f√ºr Intel mit zwei Sockeln und Server f√ºr AMD EPYC mit einem). </font><font style="vertical-align: inherit;">Im BIOS legen wir die Parameter fest, die den Arbeitsservern entsprechen. </font><font style="vertical-align: inherit;">Dies sind 3,03 GHz f√ºr AMD und 2,5 GHz f√ºr Intel. </font><font style="vertical-align: inherit;">Wir gehen davon aus, dass AMD bei gleicher Anzahl von Kernen 21% bessere Ergebnisse erzielen wird als Intel.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kryptographie</font></font></h2><br>
<img src="https://habrastorage.org/getpro/habr/post_images/eb4/843/287/eb484328713741f6688d81c15a9c5920.png"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/598/82b/416/59882b416feabd9eea86ea9d99d1e1df.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr AMD sieht es vielversprechend aus. </font><font style="vertical-align: inherit;">Bei der Kryptografie mit √∂ffentlichen Schl√ºsseln funktioniert es um 18% besser. </font><font style="vertical-align: inherit;">Mit einem symmetrischen Schl√ºssel verliert es f√ºr die AES-128-GCM-Verschl√ºsselungsoptionen, zeigt sich aber im Allgemeinen vergleichbar.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kompression</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf Edgeservern komprimieren wir viele Daten, um Bandbreite zu sparen und die Geschwindigkeit der Inhaltsbereitstellung zu erh√∂hen. </font><font style="vertical-align: inherit;">Wir leiten Daten durch die Bibliotheken zlib und brotli C. </font><font style="vertical-align: inherit;">Alle Tests fanden in der HTML-Datei blog.cloudflare.com im Speicher statt. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/fdc/bf7/ae1/fdcbf7ae1109d02a45b2ca40fe353376.png"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/ccc/427/983/ccc427983ceb85dbf63bab614850692f.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AMD gewann bei Verwendung von gzip durchschnittlich 29%. </font><font style="vertical-align: inherit;">Bei brotli sind die Ergebnisse bei Tests mit Qualit√§t 7, die wir f√ºr die dynamische Komprimierung verwenden, noch besser. </font><font style="vertical-align: inherit;">Beim brotli-9-Test tritt ein starker Abfall auf - wir f√ºhren dies auf die Tatsache zur√ºck, dass Brotli viel Speicher verbraucht und den Cache √ºberl√§uft. </font><font style="vertical-align: inherit;">AMD gewinnt jedoch mit gro√üem Vorsprung. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Viele unserer Dienstleistungen sind in Go geschrieben. </font><font style="vertical-align: inherit;">In den folgenden Diagrammen √ºberpr√ºfen wir die Kryptografie- und Komprimierungsraten von Go with RegExp in 32-KB-Zeilen mithilfe der Zeichenfolgenbibliothek.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gehen Sie Kryptographie</font></font></h3><br>
<img src="https://habrastorage.org/getpro/habr/post_images/78a/ab0/495/78aab0495309cefee6f30bac835ee961.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Komprimierung durchf√ºhren</font></font></h3><br>
<img src="https://habrastorage.org/getpro/habr/post_images/f99/2cb/95d/f992cb95d4913a2d19808d4bd15b5b54.png"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/850/e7c/f55/850e7cf5586f693dd14d62f70510f681.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gehen Sie regexp</font></font></h3><br>
<img src="https://habrastorage.org/getpro/habr/post_images/b58/798/6cb/b587986cbab94ca7087364a949f09aa4.png"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/444/e76/f72/444e76f72c1ec2e93c4cae0c5bd386f2.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gehen Sie Saiten</font></font></h3><br>
<img src="https://habrastorage.org/getpro/habr/post_images/3e9/984/19a/3e998419adb450f598e0f3d82de01aa1.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AMD zeigt die besten Ergebnisse in allen Tests mit Go, mit Ausnahme des ECDSA P256-Zeichens, wo es 38% zur√ºckliegt - was seltsam ist, wenn man bedenkt, dass es in C 24% bessere Ergebnisse zeigte. </font><font style="vertical-align: inherit;">Es lohnt sich herauszufinden, was dort vor sich geht. </font><font style="vertical-align: inherit;">Aber im Allgemeinen gewinnt AMD nicht viel, zeigt aber immer noch die besten Ergebnisse.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Luajit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir verwenden oft LuaJIT im Stapel. </font><font style="vertical-align: inherit;">Dies ist der Klebstoff, der alle Teile von Cloudflare h√§lt. </font><font style="vertical-align: inherit;">Und wir freuen uns, dass AMD hier gewonnen hat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen zeigen Tests, dass EPYC 7642 besser abschneidet als zwei Xeon Platinum 6162. AMD verliert bei zwei Tests - zum Beispiel AES-128-GCM und Go OpenSSL ECDSA-P256 Sign -, gewinnt jedoch bei allen anderen durchschnittlich um 25% .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Workload-Simulation</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach unseren Express-Tests haben wir den Server durch eine weitere Reihe von Simulationen gef√ºhrt, bei denen die synthetische Last auf den Software-Edge-Stack angewendet wird. Hier simulieren wir eine Arbeitslast von Skripten mit verschiedenen Arten von Abfragen, die in der realen Arbeit zu finden sind. Anforderungen variieren in Bezug auf Datenvolumen, HTTP- oder HTTPS-Protokolle, WAF, Workers-Quellen und andere von einer Vielzahl von Variablen. Nachfolgend finden Sie einen Vergleich des Durchsatzes der beiden CPUs f√ºr die Arten von Anforderungen, die wir am h√§ufigsten finden.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/594/dbb/4cf/594dbb4cf570a1c22ff666d592884ef7.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Ergebnisse im Diagramm werden anhand der Basisindikatoren der 9. Generation von Maschinen mit Intel-Prozessoren gemessen, die entlang der x-Achse auf einen Wert von 1,0 normiert sind. </font><font style="vertical-align: inherit;">Wenn wir beispielsweise einfache Anfragen von 10 KiB √ºber HTTPS annehmen, k√∂nnen wir feststellen, dass AMD in Bezug auf die Anzahl der Anfragen pro Sekunde 1,5-mal besser ist als Intel. </font><font style="vertical-align: inherit;">Im Durchschnitt schnitt AMD bei den angegebenen Tests 34% besser ab als Intel. </font><font style="vertical-align: inherit;">Wenn man bedenkt, dass die TDP f√ºr einen einzelnen AMD EPYC 7642 225 W und f√ºr zwei Intel-Prozessoren - 300 W - betr√§gt, stellt sich heraus, dass AMD in Bezug auf ‚ÄûAnforderungen pro Watt‚Äú 2-mal bessere Ergebnisse zeigt als Intel!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zu diesem Zeitpunkt haben wir uns eindeutig f√ºr die Option eines einzelnen Sockels f√ºr AMD EPYC 7642 als zuk√ºnftige CPUs f√ºr die Generation X entschieden. Wir waren sehr interessiert zu wissen, wie sich AMD EPYC-Server in der realen Arbeit verhalten, und haben sofort mehrere Server an einige gesendet von Rechenzentren.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Echte Arbeit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das erste war nat√ºrlich, den Server auf die Arbeit unter realen Bedingungen vorzubereiten. </font><font style="vertical-align: inherit;">Alle Maschinen in unserer Flotte arbeiten mit denselben Prozessen und Dienstleistungen, was es zu einer gro√üartigen Gelegenheit macht, die Leistung korrekt zu vergleichen. </font><font style="vertical-align: inherit;">Wie in den meisten Rechenzentren sind mehrere Servergenerationen bereitgestellt, und wir stellen unsere Server in Clustern zusammen, sodass jede Klasse Server mit ungef√§hr derselben Generation enth√§lt. </font><font style="vertical-align: inherit;">In einigen F√§llen kann dies dazu f√ºhren, dass die Nutzungskurven zwischen den Clustern variieren. </font><font style="vertical-align: inherit;">Aber nicht bei uns. </font><font style="vertical-align: inherit;">Unsere Ingenieure haben die CPU-Auslastung f√ºr alle Generationen optimiert, sodass sich die CPU-Auslastung normalerweise nicht von den anderen unterscheidet, unabh√§ngig davon, ob die CPU √ºber 8 oder 24 Kerne auf einem bestimmten Computer verf√ºgt.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/9b9/ea2/a9b/9b9ea2a9b8b70ad4e6e8f3b4e72200a3.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Grafik zeigt unseren Kommentar zur √Ñhnlichkeit der Nutzung - es gibt keinen signifikanten Unterschied zwischen der Verwendung von AMD-CPUs in Gen X-Servern und der Verwendung von Intel-Prozessoren in Gen 9-Servern. Dies bedeutet, dass sowohl Test- als auch Core-Server gleicherma√üen geladen sind. Fein. Genau das erreichen wir in der Arbeit unserer Server, und das brauchen wir f√ºr einen ehrlichen Vergleich. Die beiden folgenden Grafiken zeigen die Anzahl der Anforderungen, die von einem CPU-Kern und allen Kernen auf Serverebene verarbeitet wurden. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/075/8a6/91c/0758a691c0287281bd4c70bc1625d631.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abfragen an den </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/0a2/c5d/206/0a2c5d206c83c98cc06b910118a03a17.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Server Abfragen an den Server</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist ersichtlich, dass AMD im Durchschnitt 23% mehr Anfragen verarbeitet. Gar nicht so schlecht! Wir haben oft in unserem Blog √ºber M√∂glichkeiten geschrieben, die Leistung von Gen 9 zu steigern. Und hier haben wir die gleiche Anzahl von Kernen, aber AMD macht mehr Arbeit mit weniger Energie. Unmittelbar aus den Spezifikationen f√ºr die Anzahl der Kerne und die TDP ist ersichtlich, dass AMD mehr Geschwindigkeit bei h√∂herer Energieeffizienz liefert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie bereits erw√§hnt, ist TDP jedoch keine Standardspezifikation und nicht f√ºr alle Hersteller gleich. Schauen wir uns also den tats√§chlichen Energieverbrauch an. Indem wir den Energieverbrauch des Servers parallel zur Anzahl der Anforderungen pro Sekunde messen, erhalten wir die folgende Grafik:</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/eac/f1a/a0f/eacf1aa0fcbee9f35c376bf52a7f37d1.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durch die Anzahl der pro Watt ausgegebenen Anforderungen pro Sekunde ist der Gen X-Server auf AMD-Prozessoren 28% effizienter. Man h√§tte mehr erwarten k√∂nnen, da die TDP von AMD um 25% niedriger ist. Es sollte jedoch beachtet werden, dass die TDP ein mehrdeutiges Merkmal ist. Wir haben gesehen, dass der tats√§chliche Energieverbrauch von AMD bei einer Frequenz weit √ºber der Basis fast mit der angegebenen TDP √ºbereinstimmt. Intel hat das nicht. Dies ist ein weiterer Grund, warum TDP keine verl√§ssliche Sch√§tzung des Energieverbrauchs ist. Intel-CPUs in unseren Gen 9-Servern sind in das Multicode-System integriert, w√§hrend AMD-CPUs in Standard-1U-Formfaktorservern arbeiten. Dies spricht nicht f√ºr AMD, da Multinode-Server eine h√∂here Dichte bei geringerem Stromverbrauch pro Knoten bieten sollten. AMD √ºbertraf Intel jedoch hinsichtlich des Energieverbrauchs pro Knoten.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei den meisten Vergleichen von Spezifikationen, Testsimulationen und realer Arbeit erwies sich die Konfiguration von 1P AMD EPYC 7642 als viel besser als die von 2P Intel Xeon 6162. Unter bestimmten Bedingungen kann AMD 36% besser funktionieren, und wir glauben, dass wir durch die Optimierung von Hardware und Programmen Wir k√∂nnen eine solche Verbesserung kontinuierlich erreichen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es stellt sich heraus, dass AMD gewonnen hat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zus√§tzliche Grafiken zeigen die durchschnittliche Verz√∂gerung und die p99-Verz√∂gerung im NGINX-Betrieb f√ºr 24 Stunden. </font><font style="vertical-align: inherit;">Im Durchschnitt liefen AMD-Prozesse 25% schneller. </font><font style="vertical-align: inherit;">Bei p99 l√§uft es je nach Tageszeit 20-50% schneller.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Hardware- und Leistungsingenieure von Cloudflare f√ºhren umfangreiche Tests und Untersuchungen durch, um die beste Serverkonfiguration f√ºr unsere Kunden auszuw√§hlen. Wir arbeiten gerne hier, weil wir solch gro√üartige Aufgaben l√∂sen k√∂nnen und Ihnen auch dabei helfen k√∂nnen, Ihre Probleme mit Diensten wie serverlosem Edge-Computing und einer Reihe von L√∂sungen f√ºr Sicherheitsprobleme zu l√∂sen, insbesondere Magic Transit, Argo Tunnel und DDoS-Schutz . Alle Server im Cloudflare-Netzwerk sind f√ºr einen zuverl√§ssigen Betrieb konfiguriert, und wir versuchen immer, jede n√§chste Servergeneration besser als die vorherige zu machen. Wir glauben, dass AMD EPYC 7642 die Antwort auf die Frage nach der Auswahl von Prozessoren f√ºr Gen X ist.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mithilfe des Cloudflare Workers-Dienstes stellen Entwickler ihre Anwendungen in unserem Netzwerk bereit und expandieren weltweit. Wir sind stolz darauf, unseren Kunden die M√∂glichkeit zu bieten, sich auf das Schreiben von Code zu konzentrieren, w√§hrend wir an Sicherheit und Zuverl√§ssigkeit in der Cloud arbeiten. Umso mehr freuen wir uns, Ihnen heute mitteilen zu k√∂nnen, dass ihre Arbeit auf unseren Servern der Generation X mit AMD EPYC-Prozessoren der zweiten Generation bereitgestellt wird. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/7de/304/54d/7de30454d5b87e7a32fceda1e3f7ca49.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPYC 7642-Prozessoren mit dem Codenamen ‚ÄûRome‚Äú [Rom]</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Mit dem EPYC 7642 von AMD konnten wir unsere Geschwindigkeit erh√∂hen und den Ausbau des Netzwerks auf neue St√§dte erleichtern. Rom wurde nicht an einem Tag erbaut, aber bald wird es vielen von Ihnen n√§her sein.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In den letzten Jahren haben wir mit vielen x86-Chips von Intel und AMD sowie mit Prozessoren von ARM experimentiert. </font><font style="vertical-align: inherit;">Wir gehen davon aus, dass diese CPU-Hersteller in Zukunft mit uns zusammenarbeiten werden, um gemeinsam ein verbessertes Internet aufzubauen.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de493096/index.html">F√ºgen Sie ein dunkles Thema in iOS hinzu</a></li>
<li><a href="../de493098/index.html">Stellen Sie den ASA VPN-Lastausgleichscluster bereit</a></li>
<li><a href="../de493100/index.html">Wie das Finden einfacher Wege Startups hilft, aggressives Wachstum zu erzielen</a></li>
<li><a href="../de493102/index.html">Globale Automatisierungstrends: RPA-Entwicklung</a></li>
<li><a href="../de493106/index.html">Wie viel ist neu im Dutzend des Teufels?</a></li>
<li><a href="../de493110/index.html">Delegieren in der Fernarbeit - ein Leitfaden f√ºr Teamleiter und mehr</a></li>
<li><a href="../de493112/index.html">So starten Sie ein neues Unternehmen in 6 Monaten statt in 3 Jahren</a></li>
<li><a href="../de493114/index.html">Wie Data Engineer Daten beobachtete</a></li>
<li><a href="../de493116/index.html">"Mehr Interaktivit√§t!" oder Wie war TeamLead Conf 2020?</a></li>
<li><a href="../de493118/index.html">√úbersicht √ºber die Speicher-Tagging-Erweiterung (Armv8.5-A)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>