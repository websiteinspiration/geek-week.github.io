<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💗 🏀 👎🏾 VoximplantとDialogflowに基づいてGoogle通話スクリーニングを行う 👩‍🎤 🖕🏻 🖋️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Googleが米国でPixelスマートフォン向けに公開した通話スクリーニング機能について聞いたことがあるか、読んだことがあるかもしれません。アイデアは素晴らしいです-着信を受けると、仮想アシスタントが話し始めますが、この会話はチャットの形で表示され、いつでもアシスタントの代わりに話し始めることができ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>VoximplantとDialogflowに基づいてGoogle通話スクリーニングを行う</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/Voximplant/blog/468725/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/vw/-r/19/vw-r19phrw9n5inmek0ntdxd0eo.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Googleが米国でPixelスマートフォン向けに公開した通話スクリーニング機能について聞いたことがあるか、読んだことがあるかもしれません。</font><font style="vertical-align: inherit;">アイデアは素晴らしいです-着信を受けると、仮想アシスタントが話し始めますが、この会話はチャットの形で表示され、いつでもアシスタントの代わりに話し始めることができます。</font><font style="vertical-align: inherit;">これは、ほとんど</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の通話がスパムである</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最近では非常に便利です</font><font style="vertical-align: inherit;">が、連絡先リストに含まれていない誰かからの重要な通話を見逃したくない場合があります。</font><font style="vertical-align: inherit;">唯一の難点は、この機能はPixelスマートフォンと米国でのみ利用できることです。</font><font style="vertical-align: inherit;">さて、それらを克服するための障害が存在しますよね？</font><font style="vertical-align: inherit;">したがって、VoximplantとDialogflowを使用してそのような決定を行う方法を伝えることにしました。</font><font style="vertical-align: inherit;">猫をお願いします。</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">建築</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VoximplantとDialogflowがどのように機能するかを説明するのに時間を無駄にしないことをお勧めします。必要に応じて、インターネットで情報を簡単に見つけることができます。それでは、コールスクリーニングの概念そのものについて理解しましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
毎日使用する電話番号があり、重要な電話を受けているとします。この場合、2番目の番号が必要です。これは、メール、名刺、オンラインフォームへの記入時など、どこにでも表示されます。この番号は自然言語処理システム（この場合はDialogflow）に接続され、必要に応じて通話をメインの番号に転送します。ダイアグラムの形式では、次のようになります（画像をクリックできます）。</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/et/kf/qf/etkfqfpoxq2bwlgicp2bd0kqges.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アーキテクチャを理解すれば、実装を取り上げることができますが、1つの注意点があり</font><font style="vertical-align: inherit;">ます。Dialogflowと着信サブスクライバーの間のダイアログを表示する</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モバイル</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーションを作成</font><font style="vertical-align: inherit;">せず、ダイアログのレンダラーを備えた</font><font style="vertical-align: inherit;">シンプルな</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Web</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーションを</font><font style="vertical-align: inherit;">作成して、</font><font style="vertical-align: inherit;">通話スクリーニングの動作を視覚的に示すことです。</font><font style="vertical-align: inherit;">このアプリケーションでは、着信ボタンを押して着信サブスクライバーに接続するインターベンブボタンがあり、後者が自分で話すことを決定した場合。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実装</font></font></h2><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voximplantアカウントに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ログインし</font><font style="vertical-align: inherit;">、スクリーニングなどの新しいアプリケーションを作成</font><font style="vertical-align: inherit;">し</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/19/ah/ur/19ahurbifa0izkqvcmjlzghfaz8.jpeg" width="500"></div><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「番号」セクション</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">
開き</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">、</font></a><font style="vertical-align: inherit;">仲介者として機能する番号を購入します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/8l/vy/jp/8lvyjpmjd53b3bfcp4uk9otd6yu.jpeg" width="600"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、スクリーニングアプリケーションの[Numbers]セクションの[Available]タブに移動します。ここには、購入したばかりの番号が表示されます。 「アタッチ」ボタンを使用してアプリケーションにアタッチします-表示されるウィンドウで、すべてデフォルト値のままにして「アタッチ」をクリックします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーションの内部で、[スクリプト]タブに移動してmyscreeningスクリプトを作成します。このスクリプトでは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to use Dialogflow Connectorの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを使用します</font><font style="vertical-align: inherit;">。この場合、発信者とアシスタントの間のダイアログを「見る」必要があるため、コードはわずかに変更されます。すべてのコードは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取得でき</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意：サーバー変数の値をngrokサーバーの名前に変更する必要があります（ngrokの詳細は少し低くなります）。また、31行目の値を置き換えます。電話番号はメインの番号（たとえば、個人の携帯電話番号）であり、voximplant番号は最近購入した番号です。</font></font><br>
 <br>
<pre><code class="javascript hljs">outbound_call = VoxEngine.callPSTN(“YOUR PHONE NUMBER”, “VOXIMPLANT NUMBER”)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
callPSTN通話は、会話に割り込んで、着信した発信者と個人的にチャットすることを決定したときに発生します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スクリプトを保存したら、購入した番号にバインドする必要があります。これを行うには、アプリケーション内で、「ルーティング」タブに移動して、新しいルールを作成します-右上隅の「新しいルール」ボタン。名前（たとえば、allcalls）を指定し、デフォルトのマスク（。*-これは、すべての着信呼び出しがこのルールに対して選択されたスクリプトによって処理されることを意味します）のままにして、myscreeningスクリプトを指定します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/pj/ph/vi/pjphvix6tz0bdkvws287hqrhly4.jpeg" width="600"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ルールを保存します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これ以降、電話番号はスクリプトに関連付けられます。</font><font style="vertical-align: inherit;">最後に行うことは、ボットをアプリケーションに接続することです。</font><font style="vertical-align: inherit;">これを行うには、[Dialogflowコネクター]タブに移動し、右上隅にある[Dialogflowエージェントの追加]ボタンをクリックして、DialogflowエージェントのJSONファイルをアップロードします。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/au/6m/78/au6m78kmtwelulba2huvqhrt4rc.jpeg" width="500"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">test</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">などのエージェントが必要な場合は、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">github.com</font></a><font style="vertical-align: inherit;"> / </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">aylarov</font></a><font style="vertical-align: inherit;"> / </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">callscreening</font></a><font style="vertical-align: inherit;"> / </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">tree</font></a><font style="vertical-align: inherit;"> / </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">master</font></a><font style="vertical-align: inherit;"> / </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">dialogflowの</font></a><font style="vertical-align: inherit;">リンクから</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">入手でき</font></a><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">彼にあまり要求しないでください。これは、好きなようにやり直して結果を大胆に共有できる自由な例にすぎません:)</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NodeJSのシンプルなバックエンド</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
：のは、例えば、これは、ノード上の簡単なバックエンドを配備してみましょう</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/aylarov/callscreening/tree/master/nodejs</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
これを実行するために2つのコマンドだけを必要とし、通常のアプリケーションです。</font></font><br>
<br>
<pre><code class="bash hljs">npm install<font></font>
node index.js<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サーバーはマシンのポート3000で起動するため、Voximplantクラウドに接続するには、ngrokユーティリティを使用します。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ngrok</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">をインストールし</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">たら</font></a><font style="vertical-align: inherit;">、次のコマンドで実行し</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="bash hljs">ngrok http 3000</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ngrokがローカルサーバー用に生成したドメイン名が表示されます。それをコピーして、サーバー変数に置き換えます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">お客様</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クライアントアプリケーションは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ここから取得</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">できる単純なチャットのように見え</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのファイルをWebサーバー上のディレクトリにコピーするだけで機能します。</font><font style="vertical-align: inherit;">script.jsファイルで、サーバー変数をngrokドメイン名に置き換え、呼び出し先変数を購入した番号に置き換えます。</font><font style="vertical-align: inherit;">ファイルを保存し、ブラウザでアプリケーションを起動します。</font><font style="vertical-align: inherit;">すべてが順調であれば、開発者パネルにWebSocket接続が表示されます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デモ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このビデオでは、アプリケーションの動作を確認できます。</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/i9jz0fChNeM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS [介入]ボタンをクリックすると、発信者は私の電話番号に転送され、[切断]をクリックすると...になります。</font><font style="vertical-align: inherit;">確かに、通話は切断されます。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja468713/index.html">法的暗号通貨交換プロジェクト</a></li>
<li><a href="../ja468715/index.html">AviasalesのReactテスト開発経験</a></li>
<li><a href="../ja468719/index.html">UnixライクなOS開発-シェル。まとめ（9）</a></li>
<li><a href="../ja468721/index.html">Retentioneering：PythonとPandasの製品分析ツールをオープンソースでどのように書いたか</a></li>
<li><a href="../ja468723/index.html">JSデザインパターン：オブジェクト作成パターン</a></li>
<li><a href="../ja468727/index.html">Lenovo ThinkShield：企業のPCセキュリティを保護する強力なオプションとサービスのスイート</a></li>
<li><a href="../ja468729/index.html">CIのgithubアクションとnpmの自動公開を適用します</a></li>
<li><a href="../ja468731/index.html">スコットアーロンソンによる優れた量子エクセレンスFAQ</a></li>
<li><a href="../ja468735/index.html">音楽VKontakteをダウンロード</a></li>
<li><a href="../ja468737/index.html">本のレビュー：「ライフ3.0。人工知能の時代の男になること」</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>