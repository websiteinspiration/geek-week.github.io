<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐮 🏴󠁧󠁢󠁥󠁮󠁧󠁿 👩🏿‍🚒 Beste SQL-Interviewfragen mit mittlerer Schwierigkeit 🦖 💇🏽 👩🏽‍🤝‍👩🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die ersten 70% des SQL-Kurses scheinen ziemlich einfach zu sein. Schwierigkeiten beginnen bei den restlichen 30%.
 
 Von 2015 bis 2019 habe ich vier I...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Beste SQL-Interviewfragen mit mittlerer Schwierigkeit</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dcmiran/blog/500360/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die ersten 70% des SQL-Kurses scheinen ziemlich einfach zu sein. Schwierigkeiten beginnen bei den restlichen 30%.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Von 2015 bis 2019 habe ich vier Interviews für die Positionen eines Datenanalysten und Datenanalysespezialisten in mehr als einem Dutzend Unternehmen durchgeführt. Nach einem weiteren erfolglosen Interview im Jahr 2017 - als ich über komplexe SQL-Fragen verwirrt war - begann ich, ein Problembuch mit SQL-Fragen mittlerer und hoher Komplexität zu erstellen, um mich besser auf Interviews vorzubereiten. Dieser Leitfaden hat sich in der letzten Runde der Interviews im Jahr 2019 als nützlich erwiesen. Im vergangenen Jahr habe ich diesen Leitfaden mit ein paar Freunden geteilt und dank der zusätzlichen Freizeit aufgrund einer Pandemie habe ich ihn poliert und dieses Dokument zusammengestellt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt viele großartige SQL-Tutorials für Anfänger. Meine Favoriten sind</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interaktive SQL-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select Star SQL- </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Kurse der Codecademy</font></a><font style="vertical-align: inherit;"> von Zi Chung Kao. </font><font style="vertical-align: inherit;">In Wirklichkeit sind die ersten 70% des SQL-Kurses recht einfach, und die eigentlichen Schwierigkeiten beginnen bei den verbleibenden 30%, die in den Anfängerhandbüchern nicht behandelt werden. </font><font style="vertical-align: inherit;">Bei Interviews für Datenanalysten und Datenanalysespezialisten in Technologieunternehmen werden daher häufig Fragen zu diesen 30% gestellt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Überraschenderweise habe ich keine erschöpfende Quelle für solche Probleme mit mittlerem Schwierigkeitsgrad gefunden, deshalb habe ich diesen Leitfaden zusammengestellt.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist nützlich für Interviews, erhöht aber gleichzeitig Ihre Effektivität in Ihren aktuellen und zukünftigen Jobs. </font><font style="vertical-align: inherit;">Persönlich glaube ich, dass einige der genannten SQL-Vorlagen auch für ETL-Systeme nützlich sind, auf denen Berichterstellungstools und Datenanalysefunktionen ausgeführt werden, um Trends zu identifizieren.</font></font><br>
<br>
<blockquote><h1><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inhalt</font></font></a></h1><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">     </a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">        SQL</a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  </a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">№ 1.     </a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">№ 2.   </a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">№ 3.     ( )</a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> 1</a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> 2</a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> 3</a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">№ 4.  </a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">№ 5.  </a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">№ 6.   </a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   </a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">№ 1.     </a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">№ 2.        ( )</a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> 1</a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> 2</a></li>
</ul></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">     </a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">№ 1. </a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">№ 2.   ( )</a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> 1</a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> 2</a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">№ 3.  </a></li>
</ul></li>
</ul></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie müssen verstehen, dass sie bei Interviews mit Datenanalysten und Datenanalysten nicht nur Fragen zu SQL stellen. Weitere häufig verwendete Themen sind die Diskussion früherer Projekte, A / B-Tests, die Entwicklung von Metriken und offene Analyseprobleme. Vor ungefähr drei Jahren veröffentlichte Quora </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipps</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zum Vorstellungsgespräch für eine Position als Produktanalyst auf Facebook. Dort wird dieses Thema ausführlicher besprochen. Wenn Ihnen jedoch die Verbesserung Ihrer SQL-Kenntnisse in Ihrem Interview hilft, ist dieser Leitfaden die Zeit wert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Zukunft kann ich den Code aus diesem Handbuch auf eine Site wie </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Select Star SQL</font></a><font style="vertical-align: inherit;"> portieren</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">um das Schreiben von SQL-Anweisungen zu vereinfachen - und das Ergebnis der Codeausführung in Echtzeit anzuzeigen. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fügen Sie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> der Plattform optional Fragen als Probleme hinzu, um sich auf </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">LeetCode-</font></a><font style="vertical-align: inherit;"> Interviews vorzubereiten </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">In der Zwischenzeit wollte ich dieses Dokument nur veröffentlichen, damit die Leute diese Informationen jetzt kennenlernen können.</font></font><br>
<br>
<a name="1"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Annahmen getroffen und wie man das Handbuch verwendet</font></font></h1><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Annahmen zu Kenntnissen der SQL-Sprache:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es wird davon ausgegangen, dass Sie über Grundkenntnisse in SQL verfügen. </font><font style="vertical-align: inherit;">Sie verwenden es wahrscheinlich häufig bei der Arbeit, möchten aber Ihre Fähigkeiten in Themen wie Selbstassoziationen und Fensterfunktionen verbessern. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verwendung dieses Handbuchs:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Da in einem Interview häufig eine Tafel oder ein virtuelles Notizbuch verwendet wird (ohne den Code zu kompilieren), empfehle ich, Bleistift und Papier zu nehmen und Lösungen für jedes Problem aufzuschreiben und nach Abschluss Ihre Notizen mit den Antworten zu vergleichen. </font><font style="vertical-align: inherit;">Oder erarbeiten Sie Ihre Antworten mit einem Freund, der als Interviewer fungiert!</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kleinere Syntaxfehler spielen bei einem Interview mit einem Whiteboard oder Notizblock keine große Rolle. </font><font style="vertical-align: inherit;">Aber sie können den Interviewer ablenken, also versuchen Sie im Idealfall, ihre Anzahl zu reduzieren, um alle Aufmerksamkeit auf die Logik zu konzentrieren.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die gegebenen Antworten sind nicht unbedingt die einzige Möglichkeit, jedes Problem zu lösen. </font><font style="vertical-align: inherit;">Fühlen Sie sich frei, Kommentare mit zusätzlichen Lösungen zu schreiben, die Sie diesem Handbuch hinzufügen können!</font></font></li>
</ul><br>
<a name="2"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipps zum Lösen komplexer Aufgaben in SQL-Interviews</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zunächst Standardtipps für alle Programmierinterviews ...</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hören Sie sich die Beschreibung des Problems genau an und wiederholen Sie dem Interviewer die Essenz des Problems</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formulieren Sie einen Grenzfall, um zu demonstrieren, dass Sie das Problem wirklich verstehen (d. H. Eine Zeile, die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nicht</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in der endgültigen SQL-Abfrage enthalten ist, die Sie schreiben werden).</font></font><br>
</li>
<li>(    )     ,     —     :     ,             <br>
<ul>
<li>,      ,     </li>
</ul></li>
<li>  SQL,   ,     .      ,      .</li>
</ol><br>
<a name="3"></a><h1>   </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einige der hier aufgeführten Probleme stammen aus alten Periscope-Blogeinträgen (die größtenteils von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sean Cook</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> um 2014 verfasst wurden, obwohl seine Urheberschaft nach der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fusion von SiSense mit Periscope</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aus den Materialien entfernt worden zu sein scheint </font><font style="vertical-align: inherit;">) sowie aus Diskussionen über StackOverflow. </font><font style="vertical-align: inherit;">Falls erforderlich, werden die Quellen am Anfang jeder Frage markiert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf dem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select Star SQL finden Sie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auch eine gute </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auswahl an Denksportaufgaben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ergänzende Ausgaben dieses Dokuments. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bitte beachten Sie, dass diese Fragen keine wörtlichen Kopien von Fragen aus meinen eigenen Interviews sind und nicht in den Unternehmen verwendet wurden, in denen ich gearbeitet oder gearbeitet habe.</font></font><br>
<br>
<a name="4"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selbstassoziationsaufgaben</font></font></h1><br>
<a name="5"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nr. 1. Prozentuale Änderung von Monat zu Monat</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kontext: Es ist</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oft hilfreich zu wissen, wie sich eine Schlüsselmetrik von Monat zu Monat ändert, z. B. die monatliche Zielgruppe aktiver Benutzer. </font><font style="vertical-align: inherit;">Nehmen wir an, wir haben eine Tabelle </font></font><code>logins</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in dieser Form:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">user_id | </font><font style="vertical-align: inherit;">Datum |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| --------- | ------------ |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">2018-07-01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">234 | </font><font style="vertical-align: inherit;">2018-07-02 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">2018-07-02 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">2018-07-02 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">... | </font><font style="vertical-align: inherit;">... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">234 | </font><font style="vertical-align: inherit;">2018-10-04 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ziel</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Ermittlung der monatlichen prozentualen Änderung in der monatlichen Zielgruppe der aktiven Benutzer (MAU). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lösung: </font></font></b><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Diese Lösung enthält wie die anderen Codeblöcke in diesem Dokument Kommentare zu SQL-Syntaxelementen, die sich zwischen verschiedenen SQL-Varianten unterscheiden können, und andere Hinweise.)</font></font></i> <br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> mau <span class="hljs-keyword">AS</span> <font></font>
(<font></font>
  <span class="hljs-keyword">SELECT</span> 
   <span class="hljs-comment">/* 
    *       
    *  , .&nbsp;.   ,    . 
    *    ,   
    *
    *  Postgres  DATE_TRUNC(),   
    *      SQL   
    * . https://www.postgresql.org/docs/9.0/functions-datetime.html#FUNCTIONS-DATETIME-TRUNC
    */</span> 
    DATE_TRUNC(<span class="hljs-string">'month'</span>, <span class="hljs-built_in">date</span>) month_timestamp,
    <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> user_id) mau
  <span class="hljs-keyword">FROM</span> <font></font>
    logins <font></font>
  <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
    DATE_TRUNC(<span class="hljs-string">'month'</span>, <span class="hljs-built_in">date</span>)<font></font>
  )<font></font>
 <font></font>
 <span class="hljs-keyword">SELECT</span> 
    <span class="hljs-comment">/*
    *    SELECT      . 
    * 
    *        ,   
    *    ,   , 
    *        ..
    */</span> <font></font>
    a.month_timestamp previous_month, <font></font>
    a.mau previous_mau, <font></font>
    b.month_timestamp current_month, <font></font>
    b.mau current_mau, <font></font>
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-number">100.0</span>*(b.mau - a.mau)/a.mau,<span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> percent_change 
 <span class="hljs-keyword">FROM</span><font></font>
    mau a <font></font>
 <span class="hljs-keyword">JOIN</span> 
    <span class="hljs-comment">/*
    *   `ON b.month_timestamp = a.month_timestamp + interval '1 month'` 
    */</span>
    mau b <span class="hljs-keyword">ON</span> a.month_timestamp = b.month_timestamp - <span class="hljs-built_in">interval</span> <span class="hljs-string">'1 month'</span> </code></pre><br>
<a name="6"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nr. 2. Baumstruktur markieren</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kontext:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Angenommen, Sie haben eine Tabelle </font></font><code>tree</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit zwei Spalten: Die erste gibt die Knoten an und die zweite die übergeordneten Knoten.</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Knoten übergeordnet</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
12</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2 5</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3 5</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4 3</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5 NULL </font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgabe:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schreiben Sie SQL so, dass wir jeden Knoten als inner, root oder leaf oder leaf bezeichnen, sodass wir für die obigen Werte Folgendes erhalten:</font></font><br>
<br>
<pre><code class="sql hljs">node    label  <font></font>
1       Leaf<font></font>
2       Inner<font></font>
3       Inner<font></font>
4       Leaf<font></font>
5       Root</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(Hinweis: Weitere Informationen zur Terminologie der baumartigen Datenstruktur finden Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Es ist jedoch nicht erforderlich, um dieses Problem zu lösen!) </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lösung: </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bestätigung:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fabian Hoffman schlug diese allgemeinere Lösung am 2. Mai 2020 vor. </font><font style="vertical-align: inherit;">Danke Fabian</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> join_table <span class="hljs-keyword">AS</span><font></font>
(<font></font>
    <span class="hljs-keyword">SELECT</span> <font></font>
        cur.node, <font></font>
        cur.parent, <font></font>
        <span class="hljs-keyword">COUNT</span>(next.node) <span class="hljs-keyword">AS</span> num_children
    <span class="hljs-keyword">FROM</span> <font></font>
        tree cur<font></font>
    <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> 
        tree <span class="hljs-keyword">next</span> <span class="hljs-keyword">ON</span> (next.parent = cur.node)
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <font></font>
        cur.node, <font></font>
        cur.parent<font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span><font></font>
    node,<font></font>
    <span class="hljs-keyword">CASE</span>
        <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">parent</span> <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">"Root"</span>
        <span class="hljs-keyword">WHEN</span> num_children = <span class="hljs-number">0</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">"Leaf"</span>
        <span class="hljs-keyword">ELSE</span> <span class="hljs-string">"Inner"</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> label
<span class="hljs-keyword">FROM</span> 
    join_table </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alternative Lösung ohne explizite Zusammenhänge: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Danksagung:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> William Chardgin machte am 2. Mai 2020 auf die Notwendigkeit aufmerksam, </font></font><code>WHERE parent IS NOT NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dass diese Lösung </font></font><code>Leaf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stattdessen zurückkehrt </font></font><code>NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Danke William!</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <font></font>
    node,<font></font>
    <span class="hljs-keyword">CASE</span> 
        <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">parent</span> <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Root'</span>
        <span class="hljs-keyword">WHEN</span> node <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> 
            (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">parent</span> <span class="hljs-keyword">FROM</span> tree <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">parent</span> <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>) <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Leaf'</span>
        <span class="hljs-keyword">WHEN</span> node <span class="hljs-keyword">IN</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">parent</span> <span class="hljs-keyword">FROM</span> tree) <span class="hljs-keyword">AND</span> <span class="hljs-keyword">parent</span> <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Inner'</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> label 
 <span class="hljs-keyword">from</span> 
    tree</code></pre><br>
<a name="7"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nr. 3. Benutzerbindung pro Monat (mehrere Teile)</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Danksagung:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Diese Aufgabe wurde vom SiSense Blog - </font><font style="vertical-align: inherit;">Artikel angepasst, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">„Verwenden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> von Self-Verbänden </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">zu berechnen Retention,</font></a><font style="vertical-align: inherit;"> Outflow und Reaktivierung </font><font style="vertical-align: inherit;">. </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">“</font></a></font><br>
<br>
<a name="8"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teil 1</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kontext:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Angenommen, wir haben Statistiken zur Benutzerautorisierung auf einer Site in der Tabelle </font></font><code>logins</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">user_id | </font><font style="vertical-align: inherit;">Datum |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| --------- | ------------ |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">2018-07-01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">234 | </font><font style="vertical-align: inherit;">2018-07-02 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">2018-07-02 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">2018-07-02 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">... | </font><font style="vertical-align: inherit;">... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">234 | </font><font style="vertical-align: inherit;">2018-10-04 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgabe:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schreiben Sie eine Anfrage, die die Anzahl der beibehaltenen Benutzer pro Monat erhält. </font><font style="vertical-align: inherit;">In unserem Fall ist dieser Parameter definiert als die Anzahl der Benutzer, die sich in diesem und im vorherigen Monat beim System angemeldet haben. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entscheidung:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> 
    DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) month_timestamp, 
    <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> a.user_id) retained_users 
 <span class="hljs-keyword">FROM</span> <font></font>
    logins a <font></font>
 <span class="hljs-keyword">JOIN</span> 
    logins b <span class="hljs-keyword">ON</span> a.user_id = b.user_id 
        <span class="hljs-keyword">AND</span> DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) = DATE_TRUNC(<span class="hljs-string">'month'</span>, b.date) + 
                                             <span class="hljs-built_in">interval</span> <span class="hljs-string">'1 month'</span>
 <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
    date_trunc(<span class="hljs-string">'month'</span>, a.date)</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bestätigung:</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Tom Moertel wies darauf hin, dass das Vor-Duplizieren von user_id vor dem Selbstbeitritt die Lösung effizienter macht, und schlug den folgenden Code vor. </font><font style="vertical-align: inherit;">Danke Tom! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alternative Lösung:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> DistinctMonthlyUsers <span class="hljs-keyword">AS</span> (
  <span class="hljs-comment">/*
  *     ** , 
  *  
  */</span>
    <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span>
      DATE_TRUNC(<span class="hljs-string">'MONTH'</span>, a.date) <span class="hljs-keyword">AS</span> month_timestamp,<font></font>
      user_id<font></font>
    <span class="hljs-keyword">FROM</span> logins<font></font>
  )<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span><font></font>
  CurrentMonth.month_timestamp month_timestamp,<font></font>
  <span class="hljs-keyword">COUNT</span>(PriorMonth.user_id) <span class="hljs-keyword">AS</span> retained_user_count
<span class="hljs-keyword">FROM</span> 
    DistinctMonthlyUsers <span class="hljs-keyword">AS</span> CurrentMonth
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> 
    DistinctMonthlyUsers <span class="hljs-keyword">AS</span> PriorMonth
  <span class="hljs-keyword">ON</span>
    CurrentMonth.month_timestamp = PriorMonth.month_timestamp + <span class="hljs-built_in">INTERVAL</span> <span class="hljs-string">'1 MONTH'</span>
    <span class="hljs-keyword">AND</span> 
    CurrentMonth.user_id = PriorMonth.user_id</code></pre><br>
<a name="9"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teil 2</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgabe:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Jetzt übernehmen wir die vorherige Aufgabe, die Anzahl der zurückbehaltenen Benutzer pro Monat zu berechnen - und stellen sie auf den Kopf. </font><font style="vertical-align: inherit;">Wir werden eine Anfrage schreiben, um Benutzer zu zählen </font><font style="vertical-align: inherit;">, die diesen Monat </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nicht</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf die Website zurückgekehrt sind. </font><font style="vertical-align: inherit;">Das heißt, "verlorene" Benutzer. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entscheidung:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> 
    DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) month_timestamp, 
    <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> b.user_id) churned_users 
<span class="hljs-keyword">FROM</span> <font></font>
    logins a <font></font>
<span class="hljs-keyword">FULL</span> <span class="hljs-keyword">OUTER</span> <span class="hljs-keyword">JOIN</span> 
    logins b <span class="hljs-keyword">ON</span> a.user_id = b.user_id 
        <span class="hljs-keyword">AND</span> DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) = DATE_TRUNC(<span class="hljs-string">'month'</span>, b.date) + 
                                         <span class="hljs-built_in">interval</span> <span class="hljs-string">'1 month'</span>
<span class="hljs-keyword">WHERE</span> 
    a.user_id <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> 
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
    DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bitte beachten Sie, dass dieses Problem auch mit </font></font><code>LEFT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder </font><font style="vertical-align: inherit;">behoben werden kann </font></font><code>RIGHT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<a name="10"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teil 3</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinweis: Dies ist</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wahrscheinlich eine schwierigere Aufgabe, als Ihnen bei einem echten Interview angeboten wird. </font><font style="vertical-align: inherit;">Stellen Sie sich das eher wie ein Puzzle vor - oder Sie können überspringen und mit der nächsten Aufgabe fortfahren. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kontext</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Wir haben also zwei frühere Probleme gut gelöst. </font><font style="vertical-align: inherit;">Unter den Bedingungen der neuen Aufgabe haben wir jetzt eine Tabelle mit verlorenen Benutzern </font></font><code>user_churns</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Wenn der Benutzer im letzten Monat aktiv war, dann aber nicht aktiv war, wird er in die Tabelle für diesen Monat eingetragen. </font><font style="vertical-align: inherit;">So sieht es aus </font></font><code>user_churns</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">user_id | </font><font style="vertical-align: inherit;">month_date |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| --------- | ------------ |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">2018-05-01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">234 | </font><font style="vertical-align: inherit;">2018-05-01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">2018-05-01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">12 | </font><font style="vertical-align: inherit;">2018-05-01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">... | </font><font style="vertical-align: inherit;">... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">234 | </font><font style="vertical-align: inherit;">2018-10-01 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgabe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Jetzt möchten Sie eine Kohortenanalyse durchführen, dh eine Analyse der Gesamtheit der aktiven Benutzer, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die in der Vergangenheit reaktiviert wurden</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Erstellen Sie mit diesen Benutzern eine Tabelle. </font><font style="vertical-align: inherit;">Sie können Tabellen verwenden </font></font><code>user_churns</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font><font style="vertical-align: inherit;">eine Kohorte erstellen </font></font><code>logins</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">In Postgres ist der aktuelle Zeitstempel über zugänglich </font></font><code>current_timestamp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entscheidung:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> user_login_data <span class="hljs-keyword">AS</span> <font></font>
(<font></font>
    <span class="hljs-keyword">SELECT</span> 
        DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) month_timestamp,<font></font>
        a.user_id,<font></font>
        <span class="hljs-comment">/* 
        *   ,    SQL,   , 
        *      SELECT   HAVING.
        *       .  
        */</span> 
        <span class="hljs-keyword">MAX</span>(b.month_date) <span class="hljs-keyword">as</span> most_recent_churn, 
        <span class="hljs-keyword">MAX</span>(DATE_TRUNC(<span class="hljs-string">'month'</span>, c.date)) <span class="hljs-keyword">as</span> most_recent_active 
     <span class="hljs-keyword">FROM</span> <font></font>
        logins a<font></font>
     <span class="hljs-keyword">JOIN</span> <font></font>
        user_churns b <font></font>
            <span class="hljs-keyword">ON</span> a.user_id = b.user_id <span class="hljs-keyword">AND</span> DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) &gt; b.month_date 
     <span class="hljs-keyword">JOIN</span><font></font>
        logins c <font></font>
            <span class="hljs-keyword">ON</span> a.user_id = c.user_id 
            <span class="hljs-keyword">AND</span> 
            DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) &gt; DATE_TRUNC(<span class="hljs-string">'month'</span>, c.date)
     <span class="hljs-keyword">WHERE</span> 
        DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) = DATE_TRUNC(<span class="hljs-string">'month'</span>, <span class="hljs-keyword">current_timestamp</span>)
     <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
        DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date),<font></font>
        a.user_id<font></font>
     <span class="hljs-keyword">HAVING</span> 
        most_recent_churn &gt; most_recent_active</code></pre><br>
<a name="11"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nr. 4. Zunehmende Summe</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bestätigung:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Diese Aufgabe wurde aus dem SiSense-Blogartikel </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cash Flow Modeling in SQL übernommen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kontext:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Angenommen, wir haben eine Tabelle </font></font><code>transactions</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in dieser Form:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">Datum | </font><font style="vertical-align: inherit;">cash_flow |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ------------ | ----------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-01 | </font><font style="vertical-align: inherit;">-1000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-02 | </font><font style="vertical-align: inherit;">-100 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-03 | </font><font style="vertical-align: inherit;">50 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">... | </font><font style="vertical-align: inherit;">... |</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wo </font></font><code>cash_flow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ist der Umsatz abzüglich der Kosten für jeden Tag. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ziel:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schreiben Sie eine Anfrage, um </font><font style="vertical-align: inherit;">jeden Tag </font><font style="vertical-align: inherit;">eine </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">laufende Summe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für den Cashflow </font><font style="vertical-align: inherit;">zu erhalten, </font><font style="vertical-align: inherit;">so dass Sie am Ende eine Tabelle in dieser Form erhalten:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">Datum | </font><font style="vertical-align: inherit;">cumulative_cf |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ------------ | --------------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-01 | </font><font style="vertical-align: inherit;">-1000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-02 | </font><font style="vertical-align: inherit;">-1100 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-03 | </font><font style="vertical-align: inherit;">-1050 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">... | </font><font style="vertical-align: inherit;">... |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entscheidung:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> 
    a.date <span class="hljs-built_in">date</span>, 
    <span class="hljs-keyword">SUM</span>(b.cash_flow) <span class="hljs-keyword">as</span> cumulative_cf 
<span class="hljs-keyword">FROM</span><font></font>
    transactions a<font></font>
<span class="hljs-keyword">JOIN</span> b <font></font>
    transactions b <span class="hljs-keyword">ON</span> a.date &gt;= b.date 
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <font></font>
    a.date <font></font>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> 
    <span class="hljs-built_in">date</span> <span class="hljs-keyword">ASC</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine alternative Lösung mit einer Fensterfunktion (effizienter!):</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> 
    <span class="hljs-built_in">date</span>, 
    <span class="hljs-keyword">SUM</span>(cash_flow) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">date</span> <span class="hljs-keyword">ASC</span>) <span class="hljs-keyword">as</span> cumulative_cf 
<span class="hljs-keyword">FROM</span><font></font>
    transactions <font></font>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> 
    <span class="hljs-built_in">date</span> <span class="hljs-keyword">ASC</span></code></pre><br>
<a name="12"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nr. 5. Gleitender Durchschnitt</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bestätigung:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Diese Aufgabe wurde aus dem SiSense-Blogartikel </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moving Averages in MySQL und SQL Server übernommen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinweis: Der</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gleitende Durchschnitt kann auf verschiedene Arten berechnet werden. </font><font style="vertical-align: inherit;">Hier verwenden wir den vorherigen Durchschnitt. </font><font style="vertical-align: inherit;">Somit ist die Metrik für den siebten Tag des Monats der Durchschnitt der vorherigen sechs Tage und für sich. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kontext</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Angenommen, wir haben eine Tabelle </font></font><code>signups</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in dieser Form:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">Datum | </font><font style="vertical-align: inherit;">sign_ups |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ------------ | ---------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-01 | </font><font style="vertical-align: inherit;">10 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-02 | </font><font style="vertical-align: inherit;">20 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-03 | </font><font style="vertical-align: inherit;">50 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">... | </font><font style="vertical-align: inherit;">... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-10-01 | </font><font style="vertical-align: inherit;">35 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgabe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Schreiben Sie eine Anfrage, um einen gleitenden 7-Tage-Durchschnitt der täglichen Registrierungen zu erhalten. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entscheidung:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <font></font>
  a.date, <font></font>
  <span class="hljs-keyword">AVG</span>(b.sign_ups) average_sign_ups 
<span class="hljs-keyword">FROM</span> <font></font>
  signups a <font></font>
<span class="hljs-keyword">JOIN</span> 
  signups b <span class="hljs-keyword">ON</span> a.date &lt;= b.date + <span class="hljs-built_in">interval</span> <span class="hljs-string">'6 days'</span> <span class="hljs-keyword">AND</span> a.date &gt;= b.date
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
  a.date</code></pre><br>
<a name="13"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nr. 6. Mehrere Verbindungsbedingungen</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bestätigung:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Diese Aufgabe wurde aus dem SiSense-Blogartikel </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">„Analysieren Ihrer E-Mail mit SQL“ übernommen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kontext:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nehmen wir an, unsere Tabelle </font></font><code>emails</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enthält E-Mails, die von der Adresse gesendet </font></font><code>zach@g.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und dort empfangen wurden:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">id | </font><font style="vertical-align: inherit;">Betreff | </font><font style="vertical-align: inherit;">von | </font><font style="vertical-align: inherit;">zu | </font><font style="vertical-align: inherit;">Zeitstempel |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ---- | ---------- | -------------- | -------------- | --- ------------------ |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">Yosemite | </font><font style="vertical-align: inherit;">zach@g.com | </font><font style="vertical-align: inherit;">thomas@g.com | </font><font style="vertical-align: inherit;">2018-01-02 12:45:03 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">Big Sur | </font><font style="vertical-align: inherit;">sarah@g.com | </font><font style="vertical-align: inherit;">thomas@g.com | </font><font style="vertical-align: inherit;">2018-01-02 16:30:01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">Yosemite | </font><font style="vertical-align: inherit;">thomas@g.com | </font><font style="vertical-align: inherit;">zach@g.com | </font><font style="vertical-align: inherit;">2018-01-02 16:35:04 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">Laufen | </font><font style="vertical-align: inherit;">jill@g.com | </font><font style="vertical-align: inherit;">zach@g.com | </font><font style="vertical-align: inherit;">2018-01-03 08:12:45 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">Yosemite | </font><font style="vertical-align: inherit;">zach@g.com | </font><font style="vertical-align: inherit;">thomas@g.com | </font><font style="vertical-align: inherit;">2018-01-03 14:02:01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">6 | </font><font style="vertical-align: inherit;">Yosemite | </font><font style="vertical-align: inherit;">thomas@g.com | </font><font style="vertical-align: inherit;">zach@g.com | </font><font style="vertical-align: inherit;">2018-01-03 15:01:05 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">.. | </font><font style="vertical-align: inherit;">.. | </font><font style="vertical-align: inherit;">.. | </font><font style="vertical-align: inherit;">.. | </font><font style="vertical-align: inherit;">.. |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgabe:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schreiben Sie eine Anfrage, um die Antwortzeit für jeden an (( </font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) gesendeten </font><font style="vertical-align: inherit;">Brief ( </font><font style="vertical-align: inherit;">) zu erhalten </font></font><code>zach@g.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Fügen Sie keine Briefe an andere Adressen hinzu. </font><font style="vertical-align: inherit;">Angenommen, jeder Thread hat ein eindeutiges Thema. </font><font style="vertical-align: inherit;">Beachten Sie, dass der Thread möglicherweise mehrere Roundtrip-Buchstaben zwischen </font></font><code>zach@g.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und anderen Empfängern enthält. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entscheidung:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <font></font>
    a.id, <font></font>
    <span class="hljs-keyword">MIN</span>(b.timestamp) - a.timestamp <span class="hljs-keyword">as</span> time_to_respond 
<span class="hljs-keyword">FROM</span> <font></font>
    emails a <font></font>
<span class="hljs-keyword">JOIN</span><font></font>
    emails b <font></font>
        <span class="hljs-keyword">ON</span> <font></font>
            b.subject = a.subject <font></font>
        <span class="hljs-keyword">AND</span> <font></font>
            a.to = b.from<font></font>
        <span class="hljs-keyword">AND</span> <font></font>
            a.from = b.to <font></font>
        <span class="hljs-keyword">AND</span> <font></font>
            a.timestamp &lt; b.timestamp <font></font>
 <span class="hljs-keyword">WHERE</span> 
    a.to = <span class="hljs-string">'zach@g.com'</span> 
 <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
    a.id </code></pre><br>
<a name="14"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgaben für Fensterfunktionen</font></font></h1><br>
<a name="15"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nr. 1. Suchen Sie die Kennung mit dem Maximalwert</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kontext:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Angenommen, wir haben eine Tabelle </font></font><code>salaries</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit Daten zu Abteilungen und Mitarbeitergehältern im folgenden Format:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  depname | </font><font style="vertical-align: inherit;">empno | </font><font style="vertical-align: inherit;">Gehalt |     </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
----------- + ------- + -------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 entwickeln | </font><font style="vertical-align: inherit;">11 | </font><font style="vertical-align: inherit;">5200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 entwickeln | </font><font style="vertical-align: inherit;">7 | </font><font style="vertical-align: inherit;">4200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 entwickeln | </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">4500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 entwickeln | </font><font style="vertical-align: inherit;">8 | </font><font style="vertical-align: inherit;">6000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 entwickeln | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">5200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Personal | </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">3500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Personal | </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">3900 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Vertrieb | </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">4800 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Vertrieb | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">5000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Vertrieb | </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">4800 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgabe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Schreiben Sie eine Anfrage, um </font></font><code>empno</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">das höchste Gehalt zu erhalten. </font><font style="vertical-align: inherit;">Stellen Sie sicher, dass Ihre Lösung Fälle mit gleichen Gehältern behandelt! </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entscheidung:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> max_salary <span class="hljs-keyword">AS</span> (
    <span class="hljs-keyword">SELECT</span> 
        <span class="hljs-keyword">MAX</span>(salary) max_salary
    <span class="hljs-keyword">FROM</span> <font></font>
        salaries<font></font>
    )<font></font>
<span class="hljs-keyword">SELECT</span> <font></font>
    s.empno<font></font>
<span class="hljs-keyword">FROM</span> <font></font>
    salaries s<font></font>
<span class="hljs-keyword">JOIN</span> 
    max_salary ms <span class="hljs-keyword">ON</span> s.salary = ms.max_salary</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alternative Lösung mit </font></font><code>RANK()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> sal_rank <span class="hljs-keyword">AS</span> 
  (<span class="hljs-keyword">SELECT</span> <font></font>
    empno, <font></font>
    <span class="hljs-keyword">RANK</span>() <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>) rnk
  <span class="hljs-keyword">FROM</span> <font></font>
    salaries)<font></font>
<span class="hljs-keyword">SELECT</span> <font></font>
  empno<font></font>
<span class="hljs-keyword">FROM</span><font></font>
  sal_rank<font></font>
<span class="hljs-keyword">WHERE</span> 
  rnk = <span class="hljs-number">1</span>;</code></pre><br>
<a name="16"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nr. 2. Mittelwert und Rangfolge mit einer Fensterfunktion (mehrere Teile)</font></font></h2><br>
<a name="17"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teil 1</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kontext</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Angenommen, wir haben eine Tabelle </font></font><code>salaries</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in diesem Format:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  depname | </font><font style="vertical-align: inherit;">empno | </font><font style="vertical-align: inherit;">Gehalt |     </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
----------- + ------- + -------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 entwickeln | </font><font style="vertical-align: inherit;">11 | </font><font style="vertical-align: inherit;">5200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 entwickeln | </font><font style="vertical-align: inherit;">7 | </font><font style="vertical-align: inherit;">4200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 entwickeln | </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">4500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 entwickeln | </font><font style="vertical-align: inherit;">8 | </font><font style="vertical-align: inherit;">6000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 entwickeln | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">5200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Personal | </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">3500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Personal | </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">3900 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Vertrieb | </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">4800 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Vertrieb | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">5000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Vertrieb | </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">4800 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgabe:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schreiben Sie eine Abfrage, die dieselbe Tabelle zurückgibt, jedoch mit einer neuen Spalte, in der das durchschnittliche Gehalt für die Abteilung angezeigt wird. </font><font style="vertical-align: inherit;">Wir würden einen Tisch wie diesen erwarten:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  depname | </font><font style="vertical-align: inherit;">empno | </font><font style="vertical-align: inherit;">Gehalt | </font><font style="vertical-align: inherit;">avg_salary |     </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
----------- + ------- + -------- + ------------ +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 entwickeln | </font><font style="vertical-align: inherit;">11 | </font><font style="vertical-align: inherit;">5200 | </font><font style="vertical-align: inherit;">5020 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 entwickeln | </font><font style="vertical-align: inherit;">7 | </font><font style="vertical-align: inherit;">4200 | </font><font style="vertical-align: inherit;">5020 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 entwickeln | </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">4500 | </font><font style="vertical-align: inherit;">5020 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 entwickeln | </font><font style="vertical-align: inherit;">8 | </font><font style="vertical-align: inherit;">6000 | </font><font style="vertical-align: inherit;">5020 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 entwickeln | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">5200 | </font><font style="vertical-align: inherit;">5020 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Personal | </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">3500 | </font><font style="vertical-align: inherit;">3700 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Personal | </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">3900 | </font><font style="vertical-align: inherit;">3700 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Vertrieb | </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">4800 | </font><font style="vertical-align: inherit;">4867 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Vertrieb | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">5000 | </font><font style="vertical-align: inherit;">4867 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Vertrieb | </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">4800 | </font><font style="vertical-align: inherit;">4867 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entscheidung:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <font></font>
    *, <font></font>
    <span class="hljs-comment">/*
    * AVG() is a Postgres command, but other SQL flavors like BigQuery use 
    * AVERAGE()
    */</span> 
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(salary),<span class="hljs-number">0</span>) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> depname) avg_salary
<span class="hljs-keyword">FROM</span>
    salaries</code></pre><br>
<a name="18"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teil 2</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgabe:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schreiben Sie eine Abfrage, die eine Spalte mit der Position jedes Mitarbeiters im Arbeitszeitblatt basierend auf seinem Gehalt in seiner Abteilung hinzufügt, wobei der Mitarbeiter mit dem höchsten Gehalt Position 1 erhält. Wir würden eine Tabelle in dieser Form erwarten:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  depname | </font><font style="vertical-align: inherit;">empno | </font><font style="vertical-align: inherit;">Gehalt | </font><font style="vertical-align: inherit;">Gehalt_Rang |     </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
----------- + ------- + -------- + ------------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 entwickeln | </font><font style="vertical-align: inherit;">11 | </font><font style="vertical-align: inherit;">5200 | </font><font style="vertical-align: inherit;">2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 entwickeln | </font><font style="vertical-align: inherit;">7 | </font><font style="vertical-align: inherit;">4200 | </font><font style="vertical-align: inherit;">5 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 entwickeln | </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">4500 | </font><font style="vertical-align: inherit;">4 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 entwickeln | </font><font style="vertical-align: inherit;">8 | </font><font style="vertical-align: inherit;">6000 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 entwickeln | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">5200 | </font><font style="vertical-align: inherit;">2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Personal | </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">3500 | </font><font style="vertical-align: inherit;">2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Personal | </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">3900 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Vertrieb | </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">4800 | </font><font style="vertical-align: inherit;">2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Vertrieb | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">5000 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Vertrieb | </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">4800 | </font><font style="vertical-align: inherit;">2 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entscheidung:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <font></font>
    *, <font></font>
    <span class="hljs-keyword">RANK</span>() <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> depname <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>) salary_rank
 <span class="hljs-keyword">FROM</span>  
    salaries </code></pre><br>
<a name="19"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andere Aufgaben mittlerer und hoher Schwierigkeit</font></font></h1><br>
<a name="20"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nr. 1. Histogramme</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kontext:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nehmen wir an, wir haben eine Tabelle, </font></font><code>sessions</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in der jede Zeile eine Video-Streaming-Sitzung mit einer Länge in Sekunden darstellt:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">session_id | </font><font style="vertical-align: inherit;">length_seconds |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ------------ | ---------------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">23 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">453 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">27 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">.. | </font><font style="vertical-align: inherit;">.. |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgabe:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schreiben Sie eine Abfrage, um die Anzahl der Sitzungen zu berechnen, die in Intervallen von fünf Sekunden abfallen, d. H. Für das obige Fragment lautet das Ergebnis ungefähr so:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">Eimer | </font><font style="vertical-align: inherit;">count |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| --------- | ------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">20-25 | </font><font style="vertical-align: inherit;">2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">450-455 | </font><font style="vertical-align: inherit;">1 |</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die maximale Punktzahl zählt für die richtigen Zeilenbeschriftungen ("5-10" usw.). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lösung:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> bin_label <span class="hljs-keyword">AS</span> 
(<span class="hljs-keyword">SELECT</span> <font></font>
    session_id, <font></font>
    <span class="hljs-keyword">FLOOR</span>(length_seconds/<span class="hljs-number">5</span>) <span class="hljs-keyword">as</span> bin_label 
 <span class="hljs-keyword">FROM</span><font></font>
    sessions <font></font>
 )<font></font>
 <span class="hljs-keyword">SELECT</span> 
    CONCATENTATE(<span class="hljs-keyword">STR</span>(bin_label*<span class="hljs-number">5</span>), <span class="hljs-string">'-'</span>, <span class="hljs-keyword">STR</span>(bin_label*<span class="hljs-number">5</span>+<span class="hljs-number">5</span>)) <span class="hljs-keyword">bucket</span>, 
    <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> session_id) <span class="hljs-keyword">count</span> 
 <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <font></font>
    bin_label<font></font>
 <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> 
    bin_label <span class="hljs-keyword">ASC</span> </code></pre><br>
<a name="21"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nr. 2. Querverbindung (mehrere Teile)</font></font></h2><br>
<a name="22"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teil 1</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kontext:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nehmen wir an, wir haben eine Tabelle, </font></font><code>state_streams</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in der der Name des Staates und die Gesamtzahl der Stunden für das Streaming vom Videohosting in jeder Zeile angegeben sind:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">Zustand | </font><font style="vertical-align: inherit;">total_streams |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ------- | --------------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NC | </font><font style="vertical-align: inherit;">34569 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">SC | </font><font style="vertical-align: inherit;">33999 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">CA | </font><font style="vertical-align: inherit;">98324 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">MA | </font><font style="vertical-align: inherit;">19345 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">.. | </font><font style="vertical-align: inherit;">.. |</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(Tatsächlich haben aggregierte Tabellen dieses Typs normalerweise eine Datumsspalte, die wir jedoch für diese Aufgabe ausschließen.) </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgabe:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schreiben Sie eine Abfrage, um Statuspaare mit einer Gesamtzahl von Threads innerhalb von tausend voneinander abzurufen. </font><font style="vertical-align: inherit;">Für das obige Snippet möchten wir etwas sehen wie:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">state_a | </font><font style="vertical-align: inherit;">state_b |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| --------- | --------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NC | </font><font style="vertical-align: inherit;">SC |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">SC | </font><font style="vertical-align: inherit;">NC |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entscheidung:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span>
    a.state <span class="hljs-keyword">as</span> state_a, <font></font>
    b.state <span class="hljs-keyword">as</span> state_b 
 <span class="hljs-keyword">FROM</span>   <font></font>
    state_streams a<font></font>
 <span class="hljs-keyword">CROSS</span> <span class="hljs-keyword">JOIN</span> <font></font>
    state_streams b <font></font>
 <span class="hljs-keyword">WHERE</span> 
    <span class="hljs-keyword">ABS</span>(a.total_streams - b.total_streams) &lt; <span class="hljs-number">1000</span>
    <span class="hljs-keyword">AND</span> 
    a.state &lt;&gt; b.state </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zur Information können Cross-Joins auch ohne explizite Angabe von Joins geschrieben werden:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span>
    a.state <span class="hljs-keyword">as</span> state_a, <font></font>
    b.state <span class="hljs-keyword">as</span> state_b 
 <span class="hljs-keyword">FROM</span>   <font></font>
    state_streams a, state_streams b <font></font>
 <span class="hljs-keyword">WHERE</span> 
    <span class="hljs-keyword">ABS</span>(a.total_streams - b.total_streams) &lt; <span class="hljs-number">1000</span>
    <span class="hljs-keyword">AND</span> 
    a.state &lt;&gt; b.state </code></pre><br>
<a name="23"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teil 2</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinweis:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dies ist eher eine Bonusfrage als eine wirklich wichtige SQL-Vorlage. </font><font style="vertical-align: inherit;">Sie können es überspringen! </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgabe:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wie kann ich SQL aus einer früheren Lösung ändern, um Duplikate zu entfernen? </font><font style="vertical-align: inherit;">Zum Beispiel das Beispiel des gleichen Tisches, um zu dämpfen </font></font><code>NC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>SC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">es gab nur ein Mal, nicht zwei. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entscheidung:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span>
    a.state <span class="hljs-keyword">as</span> state_a, <font></font>
    b.state <span class="hljs-keyword">as</span> state_b 
 <span class="hljs-keyword">FROM</span>   <font></font>
    state_streams a, state_streams b <font></font>
 <span class="hljs-keyword">WHERE</span> 
    <span class="hljs-keyword">ABS</span>(a.total_streams - b.total_streams) &lt; <span class="hljs-number">1000</span>
    <span class="hljs-keyword">AND</span> 
    a.state &gt; b.state </code></pre><br>
<a name="24"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nr. 3. Erweiterte Berechnungen</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bestätigung:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Diese Aufgabe wurde aus einer </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diskussion</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> über eine Frage übernommen, die ich in StackOverflow gestellt habe (mein Spitzname ist zthomas.nc). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinweis: Dies ist</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wahrscheinlich eine schwierigere Aufgabe, als Ihnen bei einem echten Interview angeboten wird. </font><font style="vertical-align: inherit;">Stellen Sie es sich eher wie ein Puzzle vor - oder Sie können es überspringen! </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kontext:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Angenommen, wir haben eine Tabelle </font></font><code>table</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dieser Art, in der </font></font><code>user</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verschiedene Werte einer Klasse </font><font style="vertical-align: inherit;">demselben Benutzer entsprechen können </font></font><code>class</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">Benutzer | </font><font style="vertical-align: inherit;">Klasse |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ------ | ------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">a |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">b |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">b |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">b |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">a |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Problem:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Angenommen, es gibt nur zwei mögliche Werte für eine Klasse. </font><font style="vertical-align: inherit;">Schreiben Sie eine Abfrage, um die Anzahl der Benutzer in jeder Klasse zu berechnen. </font><font style="vertical-align: inherit;">In diesem Fall können Benutzer mit beiden Labels </font></font><code>a</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muss auf die Klasse verweisen </font></font><code>b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für unsere Stichprobe erhalten wir folgendes Ergebnis:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">Klasse | </font><font style="vertical-align: inherit;">count |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ------- | ------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">a | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">b | </font><font style="vertical-align: inherit;">2 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entscheidung:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> usr_b_sum <span class="hljs-keyword">AS</span> <font></font>
(<font></font>
    <span class="hljs-keyword">SELECT</span> 
        <span class="hljs-keyword">user</span>, 
        <span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">class</span> = <span class="hljs-string">'b'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) num_b
    <span class="hljs-keyword">FROM</span> 
        <span class="hljs-keyword">table</span>
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
        <span class="hljs-keyword">user</span><font></font>
), <font></font>
<font></font>
usr_class_label <span class="hljs-keyword">AS</span> <font></font>
(<font></font>
    <span class="hljs-keyword">SELECT</span> 
        <span class="hljs-keyword">user</span>, 
        <span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> num_b &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'b'</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'a'</span> <span class="hljs-keyword">END</span> <span class="hljs-keyword">class</span> 
    <span class="hljs-keyword">FROM</span> <font></font>
        usr_b_sum<font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span> 
    <span class="hljs-keyword">class</span>, 
    <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> <span class="hljs-keyword">user</span>) <span class="hljs-keyword">count</span> 
<span class="hljs-keyword">FROM</span><font></font>
    usr_class_label<font></font>
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
    <span class="hljs-keyword">class</span> 
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> 
    <span class="hljs-keyword">class</span> <span class="hljs-keyword">ASC</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine alternative Lösung verwendet Anweisungen </font></font><code>SELECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in den Bedienern </font></font><code>SELECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>UNION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> 
    <span class="hljs-string">"a"</span> <span class="hljs-keyword">class</span>,
    <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> user_id) - <font></font>
        (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> user_id) <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">class</span> = <span class="hljs-string">'b'</span>) <span class="hljs-keyword">count</span> 
<span class="hljs-keyword">UNION</span>
<span class="hljs-keyword">SELECT</span> 
    <span class="hljs-string">"b"</span> <span class="hljs-keyword">class</span>,<font></font>
    (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> user_id) <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">class</span> = <span class="hljs-string">'b'</span>) <span class="hljs-keyword">count</span> </code></pre></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de500346/index.html">Probleme mit DNS in Kubernetes. Öffentliche Obduktion</a></li>
<li><a href="../de500348/index.html">COVID-19-Pandemie mit den Augen eines Mathematikers oder warum das klassische SEIRD-Modell nicht funktioniert</a></li>
<li><a href="../de500352/index.html">Wie bekomme ich ein Praktikum auf Facebook und bekomme ein Angebot in London? Stellen Sie einem Facebook-Ingenieur eine Frage</a></li>
<li><a href="../de500354/index.html">Eine neue Methode zum Verfolgen von Daten in Google Tag Manager - Serverseitiges Tagging</a></li>
<li><a href="../de500356/index.html">Direkte Dateiübertragung zwischen Geräten über WebRTC</a></li>
<li><a href="../de500364/index.html">Erweiterung des Schullernportals auf Moodle und BigBlueButton</a></li>
<li><a href="../de500368/index.html">Generieren vorhersagbarer Zufallssequenzen: ein anderer Ansatz zur Permutation</a></li>
<li><a href="../de500370/index.html">10 nützliche englischsprachige Podcasts für Programmierer, die es wert sind, 2020 abonniert zu werden</a></li>
<li><a href="../de500378/index.html">Effektive Informationssuche bei der Arbeit</a></li>
<li><a href="../de500380/index.html">Fernverarbeitung personenbezogener Daten: Risiken und mögliche Folgen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>