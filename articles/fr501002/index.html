<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤵🏻 👨‍🚀 👩🏻‍🚒 Umka: nouveau langage de script typé statiquement 🍼 🌴 🕡</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La première version du langage de script embarquable typé Umka que j'ai développé vient de sortir . Il vise à combiner la flexibilité des langages de ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Umka: nouveau langage de script typé statiquement</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/501002/"><img src="https://habrastorage.org/webt/dq/ug/mf/dqugmfwxgaoxca2y4b5rtckcpyu.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La première version du langage de script embarquable typé </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Umka</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que j'ai développé vient de sortir </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Il vise à combiner la flexibilité des langages de script familiers avec la protection contre les erreurs de type au stade de la compilation en bytecode. </font><font style="vertical-align: inherit;">L'idée principale du langage - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">explicite vaut mieux qu'implicite</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - est empruntée au "Zen de Python", cependant, il devrait acquérir ici un sens légèrement différent et plus évident. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quelles que soient les impressions privées et subjectives qui m'ont poussé à entreprendre le développement de la langue, j'espère que le plan n'était pas naïf. </font><font style="vertical-align: inherit;">Sous la coupe, je parlerai brièvement des capacités de la langue et des motifs de sa création.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les motifs</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La première vertu du typage dynamique est généralement appelée raccourcissement du cycle de développement / débogage et gain de temps du programmeur. Au risque de déplaire au public, je dois admettre que ma propre expérience ne le confirme nullement. Chaque fois après une correction mineure de mon script de formation de réseau de neurones en Python, je dois attendre que Python, NumPy, PyTorch se chargent, lire un grand tableau de données à partir de fichiers, le transférer vers le GPU, commencer le traitement - et seulement ensuite découvrir que PyTorch s'attendait à un tenseur de taille (1, 1 , m, n, 3) au lieu de (1, m, n, 3).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'admets volontiers que beaucoup de gens préfèrent les langues typées dynamiquement pour leurs raisons personnelles. </font><font style="vertical-align: inherit;">Il est même possible que la tendance ou l'hostilité au typage dynamique soit un phénomène du même ordre que l'attitude envers les olives et le jus de tomate. </font><font style="vertical-align: inherit;">Les tentatives d'une étude objective de cette question conduisent apparemment à </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">des résultats peu concluants</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le même temps, la popularité de TypeScript, l'introduction d'annotations de type en Python, les discussions animées sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reddit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Habré</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous font penser que l'identification réelle des langages de script avec des langages typés dynamiquement n'est pas du tout un dogme, mais une coïncidence, et un langage de script typé statiquement a parfaitement le droit d'exister. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y avait donc une langue nommée d'après un chat nommé d'après un ours.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Langue</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La syntaxe de la</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> langue dans son ensemble a été inspirée par Go. Des exemples de constructions de syntaxe peuvent être trouvés sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la page du projet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Lors de la déclaration de variables, une notation abrégée avec inférence de type peut être utilisée. Il convient de noter l'écart par rapport aux règles Go dans la syntaxe des pointeurs. Les créateurs de Go se sont </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plaints</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que suivre littéralement l'exemple C s'est avéré être une complication inutile de la syntaxe ici et qu'il serait plus raisonnable d'introduire un opérateur de déréférencement postfix comme Pascal à la </font></font><code>p^</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">place </font></font><code>*p</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. C'est exactement ce qu'a fait Umka. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Traducteur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Umka se compile en bytecode, qui est ensuite exécuté par la machine virtuelle de pile. Toutes les vérifications de type sont effectuées au stade de la compilation. Les données de la pile ne contiennent plus aucune information de type. Le traducteur se présente sous la forme d'une bibliothèque dynamique avec sa propre API et un petit "wrapper" - le fichier exécutable. Le code source est écrit en C99 et porté sur différentes plateformes. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les versions</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour le processeur x86-64 (Windows et Linux) sont </font><font style="vertical-align: inherit;">maintenant disponibles </font><font style="vertical-align: inherit;">. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gestion de la mémoire</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fait jusqu'à présent sur la base de compteurs de référence. Si le langage suscite de l'intérêt et que des tentatives sont faites pour l'utiliser, il sera judicieux d'organiser un garbage collector plus avancé. Le langage prend en charge les types de données composites classiques (tableaux et structures) placés sur la pile et les tableaux dynamiques placés sur le tas. Tout tableau ou structure classique peut également être placé sur le tas avec un appel explicite </font></font><code>new()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
 <br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le polymorphisme est</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fourni par des interfaces de style Go. Il n'y a pas de concepts de classe, d'objet et d'héritage. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Multitâche</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est basé sur le concept de «fibres» - des flux simplifiés qui s'exécutent dans la même machine virtuelle et se provoquent clairement. </font><font style="vertical-align: inherit;">En substance, cela est synonyme de coroutines. </font><font style="vertical-align: inherit;">Étant donné que la logique d'utilisation de ces coroutines s'écarte légèrement de la tradition Go et se rapproche de Lua et Wren, il est logique de donner un exemple de code:</font></font><br>
<br>
<pre><code class="plaintext hljs">fn childFunc(parent: std.Fiber, buf: ^int) {<font></font>
    for i := 0; i &lt; 5; i++ {<font></font>
        std.println("Child : i=" + std.itoa(i) + " buf=" + std.itoa(buf^))<font></font>
        buf^ = i * 3<font></font>
        fibercall(parent)<font></font>
    }<font></font>
}<font></font>
<font></font>
fn parentFunc() {<font></font>
    a := 0<font></font>
    child := fiberspawn(childFunc, &amp;a)    <font></font>
    for i := 0; i &lt; 10; i++ {<font></font>
        std.println("Parent: i=" + std.itoa(i) + " buf=" + std.itoa(a))<font></font>
        a = i * 7<font></font>
        if fiberalive(child) {<font></font>
            fibercall(child)<font></font>
        }<font></font>
    }    <font></font>
    fiberfree(child)<font></font>
}<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemples</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme exemple de base démontrant les capacités du langage, je recommande de regarder </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un programme de rendu pour les scènes tridimensionnelles</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> basé sur le tracé de rayons inverses. </font><font style="vertical-align: inherit;">Il s'agit de récursions très utilisées de façon organique, d'interfaces, de tableaux dynamiques; </font><font style="vertical-align: inherit;">un peu plus artificiel - multitâche. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un exemple d'incorporation du traducteur Umka dans un projet C est le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">code source du wrapper exécutable du</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> traducteur lui-même. </font><font style="vertical-align: inherit;">Il y a aussi un exemple d'extension de langage Umka avec des fonctions externes en C.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/82/4o/kq/824okq49dag6uf4zkifgh40v4h0.png" alt="image"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr500984/index.html">Bad Apple ou Happy Radio Day, geeks</a></li>
<li><a href="../fr500986/index.html">Surveillance dans le centre de données: comment nous avons changé l'ancien BMS en un nouveau. 3e partie</a></li>
<li><a href="../fr500992/index.html">Comment est la gestion de la performance dans les meilleures entreprises informatiques</a></li>
<li><a href="../fr500994/index.html">Exécutez la fourmi. Courir</a></li>
<li><a href="../fr500996/index.html">Comment devenir ingénieur DevOps en six mois ou plus vite. Partie 1. Introduction</a></li>
<li><a href="../fr501004/index.html">Fais le. Travail</a></li>
<li><a href="../fr501006/index.html">Nous sommes amis STM32 avec écran LCD 1604 sur bus I2C (bibliothèque HAL)</a></li>
<li><a href="../fr501008/index.html">Pavage Dominos</a></li>
<li><a href="../fr501010/index.html">Linux Kernel TLS et Nginx</a></li>
<li><a href="../fr501012/index.html">Comment je cherchais un moteur enfant pour un blog</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>