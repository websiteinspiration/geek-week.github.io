<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍🚀 👩‍🚀 🥟 Harus cepat. Sinkronisasi Email IMAP cepat 👨‍👩‍👧‍👧 ✍🏿 🕷️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo! Saya Ilya. Dua tahun lalu, saya bergabung dengan klien seluler IMAP. Versi aplikasi yang lebih lama mengunduh daftar surat untuk waktu yang lama...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Harus cepat. Sinkronisasi Email IMAP cepat</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/492074/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Halo! Saya Ilya. Dua tahun lalu, saya bergabung dengan klien seluler IMAP. Versi aplikasi yang lebih lama mengunduh daftar surat untuk waktu yang lama dan menghabiskan banyak lalu lintas untuk memperbarui kotak surat. Muncul pertanyaan tentang mengoptimalkan pekerjaan dengan protokol dan tentang kemampuan protokol ini secara umum. Saya tidak tahu apa-apa tentang protokol dan terjun membaca dokumentasi. Ternyata selama ini klien menggunakan protokol tanpa istirahat dan sama sekali tidak memperhitungkan fitur implementasi. Fitur-fitur ini membantu mempercepat unduhan surat sebanyak 2 hingga 3 kali. Tentang apa itu IMAP dan apa chip untuk mengoptimalkannya nanti di artikel saya.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya tidak akan menyelami protokol terlalu dalam. </font><font style="vertical-align: inherit;">Sebuah artikel dari kategori “Saya ingin membaca artikel ini dua tahun yang lalu.” </font><font style="vertical-align: inherit;">Guru IMAP tidak mungkin menemukan informasi baru untuk diri mereka sendiri. </font><font style="vertical-align: inherit;">Artikel ini bergantung pada deskripsi protokol dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RFC 3501</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Koneksi server</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IMAP adalah protokol stateful. </font><font style="vertical-align: inherit;">Ini adalah penemuan bagi saya, sebelum itu saya belum melihat atau bekerja dengan protokol semacam itu. </font><font style="vertical-align: inherit;">Pertimbangkan skema bekerja dengan server.&nbsp;</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/311/882/30f/31188230f96d5252e2a974ebe843786d.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita mulai, dan yang paling penting, dengan contoh-contoh. </font><font style="vertical-align: inherit;">Pertama, Anda perlu membuat koneksi ke server. </font><font style="vertical-align: inherit;">Untuk melakukan ini, gunakan perpustakaan openSSL.</font></font><br>
<br>
<pre><code class="bash hljs">openssl s_client -connect imap.server.com:993 -crlf&nbsp;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hebat, koneksi dibuat dan Anda dapat mengamati respons OK dengan garis yang dimulai dengan respons KAPABILITAS</font></font><br>
<br>
<pre><code class="bash hljs">OK [CAPABILITY IMAP4rev1 LITERAL+ SASL-IR LOGIN-REFERRALS ID ENABLE IDLE&nbsp; SPECIAL-USE AUTH=PLAIN AUTH=LOGIN]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lembar contekan yang</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nyaman </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">untuk</font></a><font style="vertical-align: inherit;"> masing </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">-</font></a><font style="vertical-align: inherit;"> masing KAPABILITAS </font><font style="vertical-align: inherit;">, di mana semua kemungkinan nilai KAPABILITAS ditulis dengan tautan ke RFC. </font><font style="vertical-align: inherit;">Misalnya, IMAP4rev1 memberi tahu klien bahwa server berfungsi sesuai dengan standar IMAP4, dan IDLE memberi sinyal bahwa Anda dapat berlangganan perubahan yang terjadi di kotak surat.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Otorisasi server</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah terhubung ke server, Anda harus pergi ke kotak surat Anda. </font><font style="vertical-align: inherit;">Ini dilakukan dengan menggunakan perintah LOGIN.</font></font><br>
<br>
<pre><code class="bash hljs">a1 LOGIN email pass</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jadi, berhenti, masuk, saya mengerti, dan apa ini? </font><font style="vertical-align: inherit;">-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mungkin Anda bertanya. </font><font style="vertical-align: inherit;">Dan ini adalah tag tim. </font><font style="vertical-align: inherit;">Untuk kepentingan klien, tag harus berbeda, karena responsnya datang dengan tag yang sama dengan permintaan, yang berarti bahwa tag tersebut dapat dicocokkan untuk penguraian antar tim. </font><font style="vertical-align: inherit;">Server juga dapat mengembalikan respons dengan tanda bintang di awal, seperti * OK, ini disebut respons yang tidak ditandai. </font><font style="vertical-align: inherit;">Pada dasarnya, jawaban seperti itu dikembalikan untuk tim yang mengharapkan beberapa entitas dalam respons, misalnya, DAFTAR.&nbsp;</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Permintaan Daftar Folder</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk meminta daftar surat dalam folder, Anda harus mencari tahu folder-folder ini terlebih dahulu. </font><font style="vertical-align: inherit;">Ini dilakukan oleh perintah LIST. </font><font style="vertical-align: inherit;">Perintah ini mengembalikan daftar folder di server.</font></font><br>
<br>
<pre><code class="bash hljs">A2 LIST «» *<font></font>
* LIST (\HasNoChildren \Trash) «/» Trash<font></font>
* LIST (\HasNoChildren \Sent) «/» Sent<font></font>
* LIST (\HasNoChildren \Drafts) «/» Drafts<font></font>
* LIST (\HasNoChildren \Junk) «/» Junk<font></font>
* LIST (\HasNoChildren) «/» INBOX<font></font>
A2 OK List completed (0.001 + 0.000 + 0.001 secs).</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parameter pertama dalam perintah ini adalah namespace. Jika server mendukung namespace, maka nilainya dapat diminta menggunakan kueri NAMESPACE. Namespace standar terlihat seperti string kosong. Selanjutnya, parameter wildcard mulai digunakan. Dengan itu, kita dapat memberi tahu server folder mana yang harus kita kembalikan. Sebagai contoh, kita bisa mendapatkan: cabang folder pohon, hanya root, atau hanya semuanya, seperti pada contoh di atas. Lebih baik tidak melakukan ini, karena siapa yang tahu berapa banyak folder yang dimiliki pengguna di dalam kotak. Penulis protokol merekomendasikan menggunakan "%" - dalam hal ini Anda akan mendapatkan semua folder tingkat atas dari kotak surat.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dari jawabannya, kami memahami bahwa ini adalah jawaban yang tidak ditandai di mana setiap baris adalah folder Anda di dalam kotak. </font><font style="vertical-align: inherit;">Pada awalnya ada bendera tempat kita membaca meta-informasi folder, misalnya, dalam contoh semua folder tidak memiliki keturunan dan beberapa folder tujuan khusus (seperti Sampah, Sampah, dll.). </font><font style="vertical-align: inherit;">Selanjutnya adalah karakter pemisah folder. </font><font style="vertical-align: inherit;">Simbol ini digunakan untuk subfolder. </font><font style="vertical-align: inherit;">Misalnya, untuk keturunan folder Sampah, namanya akan terlihat seperti "Sampah / Folder Baru". </font><font style="vertical-align: inherit;">Setelah semua folder, server akan kembali kepada kami dengan tag yang kami tetapkan untuk perintah dan waktu eksekusi dari perintah ini.&nbsp;&nbsp;</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pemilihan folder</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya sesuai dengan skema, kita harus memilih folder dari mana kita akan mengencangkan pesan kita. </font><font style="vertical-align: inherit;">Ini dilakukan dengan menggunakan perintah SELECT.</font></font><br>
<br>
<pre><code class="bash hljs">4 SELECT INBOX<font></font>
* FLAGS (\Answered \Flagged \Deleted \Seen \Draft <span class="hljs-variable">$Forwarded</span> <span class="hljs-variable">$MDNSent</span>)<font></font>
* OK [PERMANENTFLAGS (\Answered \Flagged \Deleted \Seen \Draft <span class="hljs-variable">$Forwarded</span> <span class="hljs-variable">$MDNSent</span> \*)] Flags permitted.<font></font>
* 16337 EXISTS<font></font>
* 2 RECENT<font></font>
* OK [UNSEEN 6037] First unseen.<font></font>
* OK [UIDVALIDITY 1532079879] UIDs valid<font></font>
* OK [UIDNEXT 17412] Predicted next UID<font></font>
* OK [HIGHESTMODSEQ 21503] Highest<font></font>
4 OK [READ-WRITE] Select completed (0.015 + 0.000 + 0.014 secs).</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketika Anda memilih folder, semua informasi tentang itu dikembalikan. </font><font style="vertical-align: inherit;">Mari kita mulai.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jawab dengan bendera yang diizinkan di dalam folder untuk surat.&nbsp;&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jawab dengan tanda bahwa klien dapat berubah selamanya</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Balas dengan jumlah huruf dalam folder</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jawabannya adalah dengan jumlah surat terbaru, yaitu surat-surat yang kami terima di antara pilihan folder</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Balas dengan jumlah pesan yang belum dibaca</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nah, untuk sekarang, mari kita bahas ini. </font><font style="vertical-align: inherit;">Sisa informasi yang tidak kita butuhkan.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Minta surat</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang hal yang paling menarik adalah permintaan surat. </font><font style="vertical-align: inherit;">Anda harus sangat berhati-hati di sini, terutama pada klien seluler. </font><font style="vertical-align: inherit;">Setuju, kecil kemungkinan bahwa ketika Anda memasukkan aplikasi Anda akan menerima ribuan pesan dari server ke database Anda. </font><font style="vertical-align: inherit;">Selain itu, tidak masuk akal untuk mengunduh seluruh surat, karena mungkin tidak praktis untuk menampilkan, misalnya, daftar semua surat. </font><font style="vertical-align: inherit;">Misalnya, untuk menampilkan huruf pengguna dengan cepat, kami hanya akan meminta "amplop". </font><font style="vertical-align: inherit;">Dalam amplop ini kami ingin melihat: pengirim, penerima, subjek surat dan tanggal pengiriman. </font><font style="vertical-align: inherit;">Kami akan memuat 10 posting pertama.</font></font><br>
<br>
<pre><code class="bash hljs">5 FETCH 16337:16327 (ENVELOPE)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kolon menyebutkan segmen dari jumlah huruf yang ingin kami terima, dan dalam tanda kurung apa yang ingin kami baca dari surat-surat ini, dalam hal ini, amplop surat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya akan memberikan jawabannya dalam bentuk singkat:</font></font><br>
<br>
<pre><code class="bash hljs">* 16334 FETCH (ENVELOPE (<span class="hljs-string">"Sat, 07 Sep 2019 23:07:48 +0000"</span> <span class="hljs-string">"Hello from Fabric.io"</span> ((<span class="hljs-string">"Fabric"</span> NIL <span class="hljs-string">"notifier"</span> <span class="hljs-string">"fabric.io"</span>)) ((<span class="hljs-string">"Fabric"</span> NIL <span class="hljs-string">"notifier"</span> <span class="hljs-string">"fabric.io"</span>)) ((<span class="hljs-string">"Fabric"</span> NIL <span class="hljs-string">"notifier"</span> <span class="hljs-string">"fabric.io"</span>)) ((NIL NIL <span class="hljs-string">"me"</span> <span class="hljs-string">"me@mail"</span>)) NIL NIL NIL <span class="hljs-string">"&lt;5d7438441b07c_2d872ad30967b9646405c6@answers-notifier2012.mail&gt;"</span>))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jelas bahwa tidak ada yang jelas. </font><font style="vertical-align: inherit;">Dan masalahnya adalah bahwa format amplop ditentukan oleh </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RFC 2822.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Saya tidak akan mempertimbangkannya dalam artikel ini. </font><font style="vertical-align: inherit;">Amplop ini memiliki semua informasi yang diperlukan: tanggal penerimaan surat, subjek surat, pengirim, penerima, dan bahkan messageId. </font><font style="vertical-align: inherit;">Kliennya gunakan untuk menampilkan percakapan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, kami dapat menunjukkan informasi dasar kepada pengguna tentang surat itu, tetapi bagaimana dengan badannya? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kita dapat segera mengunduh seluruh isi surat itu, terlepas dari ukurannya, ini tentu saja tidak lama tetapi tetap mahal melalui jaringan dan memori. </font><font style="vertical-align: inherit;">Omong-omong, ini dilakukan dengan perintah FETCH yang sama.&nbsp;</font></font><br>
<br>
<pre><code class="bash hljs">6 FETCH 16337:16327 (BODY[])&nbsp;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Coba perintah seperti itu di kotak masuk Anda, dan Anda akan mengerti apa yang saya maksud dengan "mahal", bahkan dengan 10 pesan kami mendapatkan respons yang cukup banyak dengan benar-benar semua informasi tentang surat itu. Berbicara tentang dia. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seberapa sering Anda mengunduh sumber surat di klien mana pun yang Anda kenal untuk melihat tampilannya dalam bentuk aslinya? Jika tidak, mari kita ambil surat ujian darinya. Di dalamnya, saya menambahkan gambar langsung ke surat dan gambar sebagai lampiran. Simpan dalam format eml, lalu buka dengan editor teks apa pun. Bergantung pada klien, Anda akan menerima berbagai sumber surat, tetapi secara umum mereka akan serupa.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita mulai dengan tajuk email:</font></font><br>
<br>
<pre><code class="bash hljs">Return-Path: &lt;myemail&gt;<font></font>
Delivered-To:myemail<font></font>
Received: from localhost (localhost [127.0.0.1])<font></font>
	byimap.server.com (imap.server.com) with ESMTP id 6C2BE2A0363<font></font>
	<span class="hljs-keyword">for</span> &lt;myemail&gt;; Sun,&nbsp; 8 Sep 2019 23:41:29 +0300 (MSK)<font></font>
X-Virus-Scanned: amavisd-new at imap.server.com<font></font>
Received: from imap.server.com ([127.0.0.1])<font></font>
	by localhost ( imap.server.com [127.0.0.1]) (amavisd-new, port 10026)<font></font>
	with ESMTP id abx8HQQT_k5A <span class="hljs-keyword">for</span> &lt;myemail&gt;;<font></font>
	Sun,&nbsp; 8 Sep 2019 23:41:29 +0300 (MSK)<font></font>
Mime-Version: 1.0<font></font>
Date: Sun, 08 Sep 2019 20:41:28 +0000<font></font>
Content-Type: multipart/mixed;<font></font>
&nbsp;boundary=»--=_Part_722_554093397.1567975288»<font></font>
Message-ID: &lt;9e4e3872e603eac2c20f26bb1d65548d&gt;<font></font>
From: <span class="hljs-string">"Me"</span> &lt;myemail&gt;<font></font>
Subject: Hey, Habr!<font></font>
To: myemail<font></font>
X-Priority: 3 (Normal)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semua meta-informasi dijelaskan di header surat, dari siapa, kepada siapa, kapan, jenis konten pesan, subjek dan prioritas surat itu. </font><font style="vertical-align: inherit;">Bidang batas menunjukkan batas surat itu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lebih memahami apa artinya ini.</font></font><br>
<br>
<pre><code class="bash hljs">----=_Part_722_554093397.1567975288<font></font>
Content-Type: multipart/related;<font></font>
&nbsp;boundary=»--=_Part_583_946112260.1567975288»<font></font>
----=_Part_583_946112260.1567975288<font></font>
Content-Type: multipart/alternative;<font></font>
&nbsp;boundary=»--=_Part_881_599167713.1567975288»<font></font>
----=_Part_881_599167713.1567975288<font></font>
Content-Type: text/plain; charset=«utf-8»<font></font>
Content-Transfer-Encoding: quoted-printable<font></font>
----=_Part_881_599167713.1567975288<font></font>
Content-Type: text/html; charset=«utf-8»<font></font>
Content-Transfer-Encoding: quoted-printable<font></font>
&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=3D<span class="hljs-string">"Content-Type"</span> content=3D<span class="hljs-string">"t=
ext/html; charset=3Dutf-8"</span> /&gt;&lt;/head&gt;&lt;body&gt;&lt;div data-crea=3D<span class="hljs-string">"font-wrapper"</span>=<font></font>
&nbsp;style=3D«font-family: XO Tahion; font-size: 16px; direction: ltr»&gt; &lt;img =<font></font>
src=3D<span class="hljs-string">"cid:jua-uid-q1nz1guinitrcfd3-1567975257318"</span>&gt;&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt; &lt;b=<font></font>
r&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;<font></font>
----=_Part_881_599167713.1567975288--<font></font>
----=_Part_583_946112260.1567975288<font></font>
Content-Type: image/jpeg; name=«2018-09-04 22.46.36.jpg»<font></font>
Content-Disposition: inline; filename=«2018-09-04 22.46.36.jpg»<font></font>
Content-ID: &lt;jua-uid-q1nz1guinitrcfd3-1567975257318&gt;<font></font>
Content-Transfer-Encoding: base64</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setiap batas adalah batas yang biasa dari sebuah tulisan. </font><font style="vertical-align: inherit;">Mereka mulai dengan dua tanda hubung "-". </font><font style="vertical-align: inherit;">Batas penutupan memiliki dua tanda hubung ini pada akhirnya. </font><font style="vertical-align: inherit;">Ini dijelaskan secara lebih rinci dalam </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RFC1341.</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ini dapat disebut bagian utama surat, bagian surat dan jenis MIME mereka dijelaskan di sini.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tentang Jenis MIME</font></font></b><div class="spoiler_text">MIME-   ,     MIME (<i>Multipurpose Internet Mail Extensions) </i>     email .&nbsp;<br>
<br>
<ul>
<li>multipart/mixed         ,             .&nbsp;</li>
</ul><br>
<ul>
<li>multipart/related  ,     ,     ,&nbsp;</li>
</ul><br>
<ul>
<li>multipart/alternative   ,       , ,   text/plain  text/html,       .&nbsp;</li>
</ul><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami tidak memiliki teks sederhana di sini, jadi lebih logis untuk mengambil representasi html. Dalam html-representasi ini hanya ada gambar, dengan parameter Content-Disposition: inline, yaitu, ia terletak langsung di badan surat, dan tidak dalam dokumen yang dilampirkan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tautan ke gambar ini tidak cukup sederhana. Ini dijelaskan oleh parameter Content-ID, yang sama dengan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jua-uid-q1nz1guinitrcfd3-1567975257318</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ini adalah tautan ke bagian selanjutnya dari surat itu - sebuah gambar yang dikodekan dalam basis-64. Untuk menyelamatkanku, aku tidak memasukkan semua kode base-64. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagian terakhir surat itu berbentuk&nbsp;</font></font><br>
<br>
<pre><code class="bash hljs">----=_Part_722_554093397.1567975288<font></font>
Content-Type: image/png; name=«2018-07-02 11.08.23 pm.png»<font></font>
Content-Disposition: attachment; filename=«2018-07-02 11.08.23 pm.png»<font></font>
Content-Transfer-Encoding: base64</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
yang sudah memiliki Content-Disposition bukan inline, seperti gambar di atas, tetapi lampiran. </font><font style="vertical-align: inherit;">Gambar ini seharusnya hanya pergi ke panel lampiran file, dengan cara itu juga dikodekan dalam basis-64 dan memiliki ukuran besar. </font><font style="vertical-align: inherit;">Di sini menjadi jelas bahwa Anda tidak boleh sekali lagi memuat seluruh isi surat jika kami hanya ingin menunjukkan informasi dasar.&nbsp;</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kembali ke protokol</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah mengerjakan surat-surat itu, Anda harus menutup folder yang dipilih dan mengucapkan selamat tinggal kepada server. </font><font style="vertical-align: inherit;">Untuk menutup folder, kita harus memasukkan perintah TUTUP. </font><font style="vertical-align: inherit;">Ya, sangat sederhana</font></font><br>
<br>
<pre><code class="bash hljs"><font></font>
7 CLOSE<font></font>
7 OK Close completed (0.001 + 0.000 secs).<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ngomong-ngomong, jika Anda bekerja dengan konsol secara paralel dengan saya dan membaca artikel, maka peristiwa yang tidak begitu menyenangkan bisa terjadi, server dapat menutup koneksi Anda dengan batas waktu. </font><font style="vertical-align: inherit;">Ini sepenuhnya normal, dan setiap server memiliki batas waktu sendiri, misalnya, kami memiliki 30 menit.&nbsp;</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oleh karena itu, disarankan untuk melakukan perintah NOOP di latar belakang</font></font><br>
<br>
<pre><code class="bash hljs">1 NOOP<font></font>
1 OK NOOP completed (0.001 + 0.000 secs).</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secara harfiah tidak melakukan apa-apa, tetapi memungkinkan Anda untuk menjaga koneksi tanpa batas waktu sebanyak yang kita butuhkan. </font><font style="vertical-align: inherit;">Jika saat ini Anda memilih folder, NOOP dapat berfungsi sebagai permintaan berkala untuk perubahan pada folder ini&nbsp;</font></font><br>
<br>
<pre><code class="bash hljs">1 NOOP<font></font>
* 16472 EXPUNGE<font></font>
* 16471 EXPUNGE<font></font>
* 16472 EXISTS<font></font>
* 1 RECENT<font></font>
1 OK NOOP completed (0.004 + 0.000 + 0.003 secs).</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini, sebagai respons, kami diberitahu dua pesan yang dihapus, satu pesan baru dan jumlah pesan di folder ini adalah 16 472. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya juga mencatat bahwa Anda hanya dapat bekerja dengan satu folder yang dipilih, tidak ada kerja paralel di sini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nah, pada akhirnya, tutup sesi dengan server dan kami akan mengucapkan selamat tinggal padanya.</font></font><br>
<br>
<pre><code class="bash hljs">8 LOGOUT<font></font>
* BYE Logging out<font></font>
8 OK Logout completed (0.001 + 0.000 secs).</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami melihat jawaban BYE yang sedih tanpa tanda, yang berarti ini saatnya untuk menyelesaikan pekerjaan.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sinkronisasi cepat dengan CONDSOTORE dan QRESYNC</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat menggunakan operasi NOOP untuk melacak perubahan dalam kotak di folder yang dipilih. Tetapi bagaimana jika kita ingin mengetahui apa yang telah berubah di folder saat kita bekerja dengan yang lain? Opsi yang paling jelas adalah memilah-milah semua huruf di penyimpanan lokal, apakah itu cache atau database, dan membandingkan dengan apa yang akan dikembalikan oleh server. Di satu sisi, ini memang solusi, dan di beberapa server itu akan menjadi satu-satunya yang benar. Di sisi lain, kami ingin menunjukkan surat secepat yang umumnya dimungkinkan oleh protokol. Untungnya, server kami mendukung ekstensi protokol seperti CONDSTORE dan QRESYNC, yang ditambahkan ke </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RFC7162</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Yang pertama menambahkan nomor 63-bit khusus ke pesan dan folder, yang disebut mod-sequence, yang meningkat dengan setiap operasi pada surat ini. Mod-urutan tertinggi di antara semua pesan ditambahkan ke folder. Akibatnya, setiap kali Anda terhubung ke folder di server yang mendukung CONDSTORE, kami dapat dengan mudah mengetahui apakah ada sesuatu yang berubah atau tidak, hanya dengan membandingkan nilai mod-sequence untuk folder lokal dan server. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain itu, ekstensi ini menambahkan parameter tambahan untuk perintah STORE dan FETCH - CHANGEDSINCE mod-sequence dan UNCHANGEDSINCE mod-sequence, yang memungkinkan Anda untuk melakukan operasi jika urutan mod dari pesan yang dikirimkan masing-masing lebih besar dan lebih kecil dari ini. Mari kita lihat sebuah contoh.</font></font><br>
<br>
<pre><code class="bash hljs">FETCH 17221:17241 (UID) (CHANGEDSINCE 0)<font></font>
* OK [HIGHESTMODSEQ 22746] Highest<font></font>
* 17222 FETCH (UID 18319 MODSEQ (22580))<font></font>
* 17223 FETCH (UID 18320 MODSEQ (22601))<font></font>
* 17224 FETCH (UID 18324 MODSEQ (22607))<font></font>
* 17225 FETCH (UID 18325 MODSEQ (22604))<font></font>
* 17226 FETCH (UID 18326 MODSEQ (22608))<font></font>
* 17227 FETCH (UID 18327 MODSEQ (22614))<font></font>
* 17228 FETCH (UID 18328 MODSEQ (22613))<font></font>
* 17229 FETCH (UID 18336 MODSEQ (22628))<font></font>
* 17230 FETCH (UID 18338 MODSEQ (22628))<font></font>
* 17231 FETCH (UID 18340 MODSEQ (22628)<font></font>
* 17232 FETCH (UID 18341 MODSEQ (22628))<font></font>
* 17221 FETCH (UID 18318 MODSEQ (22583))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya mensimulasikan situasi di mana kita masuk ke kotak surat dan tidak tahu apa-apa tentang itu sebelumnya, yaitu, urutan mod lokal kami adalah 0. Seperti yang Anda lihat, server mengembalikan kepada kami secara umum semua pesan yang ada di kotak surat, karena sebelumnya kami tidak menerima apa pun dan tidak tahu apa-apa tentang kotak itu. Menanggapi permintaan surat UID dari CHANGEDSINCE, respons yang tidak bertanda OK juga dilengkapi dengan HIGHESTMODESEQ yang sekarang akan kami simpan, dan untuk setiap pesan MODSEQ kami. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami akan </font><font style="vertical-align: inherit;">melakukan </font><font style="vertical-align: inherit;">beberapa operasi dengan kotak surat: tambahkan huruf baru, ubah benderanya. Mari kita membuat permintaan baru tetapi dengan urutan mod sebelumnya</font></font><br>
<br>
<pre><code class="bash hljs">1 fetch 17221:* (UID FLAGS) (CHANGEDSINCE 22746)<font></font>
* 17267 FETCH (UID 18378 FLAGS () MODSEQ (22753))<font></font>
* 17270 FETCH (UID 18381 FLAGS (\Seen) MODSEQ (22754))<font></font>
* 17271 FETCH (UID 18382 FLAGS () MODSEQ (22751))<font></font>
* 17273 FETCH (UID 18384 FLAGS () MODSEQ (22750))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
dan kami sudah melihat perbedaannya, alih-alih mengeluarkan 20 komunitas lama dan baru yang baru saja tiba (tanda bintang pada 17221: * berarti mengambil huruf dari angka 17221 semaksimal mungkin) kami menerima surat yang MODSEQ-nya lebih besar daripada yang sebelumnya. Ini sangat membantu untuk menyinkronkan folder yang belum pernah kami kunjungi selama beberapa waktu dan mendapatkan semacam surat yang diubah, alih-alih mencoba semua yang mungkin. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tampaknya, jauh lebih baik? Tetapi QRESYNC membuat operasi sinkronisasi lebih cepat, ini memungkinkan Anda untuk menentukan parameter MODSEQ dan pesan UID yang kita kenal tepat saat pemilihan folder. Mari kita jelaskan dengan sebuah contoh. Pertama, QRESYNC harus diaktifkan dengan perintah ENABLE.&nbsp;</font></font><br>
<br>
<pre><code class="bash hljs">1 ENABLE QRESYNC<font></font>
* ENABLED QRESYNC<font></font>
1 OK Enabled (0.001 + 0.000 secs).<font></font>
1 SELECT INBOX (QRESYNC (0 0))<font></font>
* FLAGS (\Answered \Flagged \Deleted \Seen \Draft <span class="hljs-variable">$Forwarded</span> <span class="hljs-variable">$MDNSent</span>)<font></font>
* OK [PERMANENTFLAGS (\Answered \Flagged \Deleted \Seen \Draft <span class="hljs-variable">$Forwarded</span> <span class="hljs-variable">$MDNSent</span> \*)] Flags permitted.<font></font>
* 17271 EXISTS<font></font>
* 0 RECENT<font></font>
* OK [UNSEEN 17241] First unseen.<font></font>
* OK [UIDVALIDITY 1532079879] UIDs valid<font></font>
* OK [UIDNEXT 18385] Predicted next UID<font></font>
* OK [HIGHESTMODSEQ 22754] Highest<font></font>
1 OK [READ-WRITE] Select completed (0.001 + 0.000 secs).</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
karena kami tidak tahu apa-apa tentang folder itu sebelumnya, server hanya mengembalikan informasi tentang folder itu kepada kami, tanpa nugget perubahannya. Misalkan kita menanyakan dua puluh pesan pertama dan mengingat UID mereka dan juga HIGHESTMODESEQ. Kami meninggalkan folder, mengirim pesan kepada diri sendiri, menghapus pesan, mengubah tanda dan kembali dengan informasi sebelumnya tentang folder</font></font><br>
<br>
<pre><code class="bash hljs">1 CLOSE<font></font>
1 OK Close completed (0.001 + 0.000 secs).<font></font>
1 SELECT INBOX (QRESYNC (1532079879 22754 18300:18385))<font></font>
* FLAGS (\Answered \Flagged \Deleted \Seen \Draft <span class="hljs-variable">$Forwarded</span> <span class="hljs-variable">$MDNSent</span>)<font></font>
* OK [PERMANENTFLAGS (\Answered \Flagged \Deleted \Seen \Draft <span class="hljs-variable">$Forwarded</span> <span class="hljs-variable">$MDNSent</span> \*)] Flags permitted.<font></font>
* 17271 EXISTS<font></font>
* 0 RECENT<font></font>
* OK [UNSEEN 17241] First unseen.<font></font>
* OK [UIDVALIDITY 1532079879] UIDs valid<font></font>
* OK [UIDNEXT 18386] Predicted next UID<font></font>
* OK [HIGHESTMODSEQ 22757] Highest<font></font>
* VANISHED (EARLIER) 18380<font></font>
* 17269 FETCH (UID 18383 FLAGS () MODSEQ (22757))<font></font>
* 17271 FETCH (UID 18385 FLAGS () MODSEQ (22755))<font></font>
1 OK [READ-WRITE] Select completed (0.001 + 0.000 secs).</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan sekarang, ketika memilih folder yang diubah, kami segera mendapatkan nugget perubahan, dalam bentuk respons VANISHED (EARLIER) untuk pesan yang dihapus, dan FETCH untuk pesan yang ditambahkan atau diubah. Sekarang lebih mudah untuk menyinkronkan folder jika pengguna belum mengunjunginya untuk waktu yang lama. Ini adalah cara yang sangat keren jika Anda memiliki banyak pesan yang disimpan secara lokal di dalam cache dan Anda tidak ingin membandingkannya dengan pesan di server. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parameter pertama dari permintaan ini adalah UIDVALIDITY, yang pada dasarnya digunakan untuk memverifikasi bahwa uid yang Anda terima sebelumnya tidak berubah dalam folder. Ini dapat terjadi jika server mengubah sesi dari setiap sesi ke sesi untuk semua pesan atau folder dihapus dan folder dengan nama yang sama dibuat di tempatnya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parameter kedua adalah HIGHESTMODSEQ yang diketahui oleh kami dan yang terakhir adalah interval UID yang diketahui, mereka dapat ditulis sebagai titik dua, jika intervalnya berkelanjutan, atau dipisahkan oleh koma.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesimpulan</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam contoh saya, saya menemukan sebuah situasi di mana ketidaktahuan area subjek mengarah pada operasi aplikasi yang salah dan suboptimal. </font><font style="vertical-align: inherit;">Saya tidak membahas semua opsi yang mungkin untuk menggunakan protokol dengan artikel ini. </font><font style="vertical-align: inherit;">Tetapi saya berharap untuk pengembang IMAP klien selanjutnya informasi di atas akan bermanfaat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IMAP memiliki banyak hal menarik. </font><font style="vertical-align: inherit;">Perintah untuk sinkronisasi cepat hanyalah permulaan, pada kenyataannya, Anda dapat lebih mengoptimalkan berbagai perintah IMAP, tergantung pada kemampuan server, dan membuat bekerja dengan email lebih cepat, lebih ekonomis pada jaringan dan memori, dan umumnya lebih menyenangkan. </font><font style="vertical-align: inherit;">Tapi saya akan membicarakannya nanti.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id492058/index.html">ROS2 vs ROS1. Menginstal ROS2 di Ubuntu 18.04</a></li>
<li><a href="../id492060/index.html">Bagaimana menyelesaikan? "ECONNREFUSED - koneksi ditolak oleh server"</a></li>
<li><a href="../id492062/index.html">Templat server backend Golang - bagian 1 (server HTTP)</a></li>
<li><a href="../id492066/index.html">Mengapa Event Sourcing adalah antipattern untuk interaksi microservices</a></li>
<li><a href="../id492068/index.html">S7 Group membuka departemen "Teknologi Informasi dalam Penerbangan" di MIPT</a></li>
<li><a href="../id492076/index.html">Contoh arsitektur heksagonal di Jawa</a></li>
<li><a href="../id492078/index.html">Materi yang paling penting dan berguna pada coronavirus COVID-19</a></li>
<li><a href="../id492082/index.html">Cara menyederhanakan pengelolaan perangkat rumah dan mengamankannya (berbagi ide tentang Rumah Pintar Kauri)</a></li>
<li><a href="../id492086/index.html">Coronavirus vs Rusia IT-bisnis: apakah perusahaan siap untuk memindahkan karyawan ke lokasi yang jauh?</a></li>
<li><a href="../id492088/index.html">Menguji mesin game Amazon Lumberyard. Pendekatan dan Alat</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>