<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üê• ü§öüèΩ ‚õ∫Ô∏è C√≥mo mejorar el trabajo con Microsoft Remote Desktop üíï üé∂ üôáüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Quiero compartir algunos consejos sobre c√≥mo configurar una conexi√≥n remota a estaciones de trabajo a trav√©s de RDP. Te dir√© c√≥mo actualizar el antigu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>C√≥mo mejorar el trabajo con Microsoft Remote Desktop</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/501132/"><img src="https://habrastorage.org/webt/dx/s8/wi/dxs8wiugrbhaov1gzied15gldk8.png" align="left"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quiero compartir algunos consejos sobre c√≥mo configurar una conexi√≥n remota a estaciones de trabajo a trav√©s de RDP. Te dir√© c√≥mo actualizar el antiguo RPC-HTTP a UDP, alabar y rega√±ar a Windows 10 y AVC, encontrar√© una soluci√≥n a varios problemas t√≠picos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Creemos que Remote Desktop Gateway (RDGW) se utiliza para la conexi√≥n, y las estaciones de trabajo act√∫an como servidores. Usar RDGW es muy conveniente porque la puerta de enlace se convierte en un punto de entrada com√∫n para todos los clientes. Esto permite controlar mejor el acceso, mantener registros de las conexiones y su duraci√≥n. Incluso si la VPN le permite conectarse directamente a m√°quinas en funcionamiento, esta no es la mejor opci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RDGW es r√°pido, f√°cil de configurar y Let's Encrypt y win-acme resuelven f√°cilmente el problema con un certificado de confianza.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hay tres protocolos de transporte a trav√©s de los cuales el cliente puede conectarse al servidor: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RPC-HTTP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">malo</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><font color="orange"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mejor</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTP + UDP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><font color="green"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">excelente</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por servidor nos referimos a una m√°quina que funciona, por un cliente - hogar. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lo primero para comenzar es convertir "malo" en "excelente".</font></font><br>
<a name="habracut"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Actualizar RPC-HTTP a HTTP</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La conexi√≥n a una sesi√≥n usando RPC-HTTP es f√°cil de determinar por la apariencia de la tira de conexi√≥n. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7w/-0/aa/7w-0aativt247pvbumddqkf4epg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No hay un √≠cono de calidad de conexi√≥n (m√°s abajo), lo que significa que estamos usando el viejo RPC envuelto en TLS, esto es muy lento. </font><font style="vertical-align: inherit;">El punto, por supuesto, no est√° solo en el contenedor: el protocolo en s√≠ cambia con cada versi√≥n del sistema operativo, los c√≥decs y los algoritmos de empaquetado de im√°genes cambian. </font><font style="vertical-align: inherit;">Cuanto m√°s fresco sea el protocolo, mejor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øQu√© hacer?</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows XP o Vista</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En XP, puede elevar el protocolo de 5.1 a 7. El </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hotfix windowsxp-kb969084-x86.exe.</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
En Vista, de 6 a 7. El hotfix tiene el mismo n√∫mero, los </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">archivos windows6.0-kb969084-x64.msu o Windows6.0-KB969084-x86. .msu</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Pero RDP 7 no funciona sobre HTTP y UDP. Solo actualizar el cliente y el servidor a Windows 7 y m√°s tarde ser√° de ayuda. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows 7</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Primero debe actualizar el protocolo a RDP 8.1 y luego habilitarlo. El soporte se agrega mediante actualizaciones que se agrupan en un solo paquete de descarga: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.microsoft.com/en-US/download/details.aspx?id=40986</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Windows6.1-KB2574819-v2-x64.msu </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
windows6.1-kb2592687-x64.msu </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows6.1-KB2830477-x64.msu </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows6.1-KB2857650-x64.msu </font></font><br>
<s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows6.1-KB2913751-x64.msu</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (reemplazado por kb2923545)</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">windows6.1-kb2923545-x64.msu</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Para que obtenga el cliente mstsc.exe nuevo y la compatibilidad con RDP 8.1 para el lado del servidor del sistema operativo. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fue: se </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yx/37/pl/yx37plxdymw73eubymzh1v0zgzm.png"><br>
<br>
<img src="https://habrastorage.org/webt/r1/kh/ip/r1khiphuyrmxmmodab_ecjiktiq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
convirti√≥ en: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rt/9v/dj/rt9vdjdnfmus27h9nyn7ctpyp7g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
despu√©s de eso, el protocolo debe activarse con la clave de registro (para esto puede usar la plantilla adm incluida con Windows 7).</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-type">HKEY_LOCAL_MACHINE</span>\<span class="hljs-type">SOFTWARE</span>\<span class="hljs-type">Policies</span>\<span class="hljs-type">Microsoft</span>\<span class="hljs-type">Windows</span> <span class="hljs-type">NT</span>\<span class="hljs-type">Terminal</span> <span class="hljs-type">Services</span>]<font></font>
<span class="hljs-string">"fServerEnableRDP8"</span>=dword:<span class="hljs-number">00000001</span><font></font>
 <font></font>
[<span class="hljs-type">HKEY_LOCAL_MACHINE</span>\<span class="hljs-type">SOFTWARE</span>\<span class="hljs-type">Wow6432Node</span>\<span class="hljs-type">Policies</span>\<span class="hljs-type">Microsoft</span>\<span class="hljs-type">Windows</span> <span class="hljs-type">NT</span>\<span class="hljs-type">Terminal</span> <span class="hljs-type">Services</span>]<font></font>
<span class="hljs-string">"fServerEnableRDP8"</span>=dword:<span class="hljs-number">00000001</span><font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Habilite el soporte de transporte UDP en la directiva de grupo. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bg/_t/ds/bg_tdse5uudrekmylffvhh_gqzq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Reiniciamos el servidor con Windows 7. El mismo caso cuando es posible que deba reiniciar dos veces: el valor en el registro debe establecerse antes de que se active RDP, y la Pol√≠tica de grupo se aplica m√°s tarde. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si todo </font><font style="vertical-align: inherit;">
funcion√≥ </font><font style="vertical-align: inherit;">, cuando se conecte al servidor, aparecer√° un icono de calidad de conexi√≥n (como en un tel√©fono para una red m√≥vil) en la barra de sesi√≥n: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8b/_0/ok/8b_0okltugyxpizhhcydchtsve8.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows 8 y posterior. El</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> protocolo funciona de f√°brica.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Actualizar HTTP a HTTP + UDP</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si su red no es propensa a la p√©rdida de paquetes, UDP dram√°ticamente (para CAD - dr√°sticamente) mejora la capacidad de respuesta del servidor al usar </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FEC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para reducir la retransmisi√≥n, as√≠ como al cambiar la confirmaci√≥n de entrega de paquetes de la pila del sistema TCP / IP al nivel de protocolo RDP-UDP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se conecta una sesi√≥n de control principal a trav√©s de HTTP desde cada cliente (tambi√©n se transmite un teclado / mouse en este canal), m√°s una o m√°s sesiones UDP para transmitir una imagen u otros canales virtuales.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solo tocaremos la punta del iceberg. Hay 3 versiones diferentes del protocolo RDP-UDP. Adem√°s, UDP puede funcionar en dos modos: UDP-R (confiable) y UDP-L (con p√©rdida). Nada pasa simplemente con Microsoft. Pero como nada depende de nosotros aqu√≠, solo tenga en cuenta: cuanto m√°s nuevo es el sistema operativo, el tema utiliza un protocolo m√°s moderno. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el exterior, RDP-UDP est√° envuelto en Datagram Transport Layer Security (DTLS) RFC4347, como puede ver abriendo Wireshark. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
M√°s detalles en los documentos: </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[MS-RDPEMT]: Protocolo de escritorio remoto: Extensi√≥n </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de transporte m√∫ltiple [MS-RDPEUDP]: Protocolo de escritorio remoto: Extensi√≥n de transporte UDP </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[MS-RDPEUDP2]: Protocolo de escritorio remoto: Extensi√≥n de transporte UDP Versi√≥n 2</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Donde sea incorrecto, correcto de nada.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øQu√© necesitas para habilitar UDP? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RDP-UDP es compatible a partir de RDP 8. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El puerto udp / 3389 debe estar abierto en el cliente. Si lo cerr√≥ con un firewall local, ACL en el conmutador o un firewall externo, el puerto debe estar abierto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para el servidor de Remote Desktop Gateway al puerto tcp / 443, abra udp / 3391. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El puerto se puede cambiar, as√≠ es como est√° configurado: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/o6/n0/w3/o6n0w3fmookrhmxaqomyx8wretk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
para Windows 7, NLA (Autenticaci√≥n de nivel de red) debe estar habilitado. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nt/kz/ny/ntkznyeqsvsh3msad2u59_rxcck.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se puede habilitar en la directiva de grupo </font></font><br>
<br>
<img src="https://habrastorage.org/webt/my/hj/sw/myhjswie2h7znzjoamnhf6clzq4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
o mediante el registro</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-type">HKEY_LOCAL_MACHINE</span>\<span class="hljs-type">SYSTEM</span>\<span class="hljs-type">CurrentControlSet</span>\<span class="hljs-type">Control</span>\<span class="hljs-type">Terminal</span> <span class="hljs-type">Server</span>\<span class="hljs-type">WinStations</span>\<span class="hljs-type">RDP</span>-<span class="hljs-type">Tcp</span>]<font></font>
<span class="hljs-string">"SecurityLayer"</span>=dword:<span class="hljs-number">00000001</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cu√°l es la conexi√≥n no est√° clara. Pero sin NLA en 7-ke no funciona, en versiones m√°s recientes de NLA para trabajo UDP no es necesario. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de establecer una sesi√≥n a trav√©s de HTTP, el cliente y el servidor </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">intentan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> negociar una conexi√≥n UDP. Si hay p√©rdida o retraso de paquetes, la sesi√≥n UDP no se iniciar√°. El algoritmo exacto de falla de negociaci√≥n UDP no se entiende completamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si todo est√° configurado, luego de conectarse, haga clic en el bot√≥n de calidad del enlace. La ventana indicar√° que UDP se negocia. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/d7/y4/jx/d7y4jx5ubs4i9zop5myyzg21oyo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la puerta de enlace, se ve as√≠: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oc/ld/7n/ocld7nbslu8dt_fjahnvd-zqvso.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows 10</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si tiene Windows 10 tanto en el servidor como en el cliente, esta es la opci√≥n m√°s r√°pida y sin problemas. Microsoft est√° finalizando activamente RDP, y en las √∫ltimas versiones 10 puede contar con una buena velocidad. Los colegas no pudieron detectar la diferencia entre Citrix y Windows 10 RDP en la velocidad de AutoCAD. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hay un buen art√≠culo sobre la evoluci√≥n de los c√≥decs RDP basados ‚Äã‚Äãen AVC en Windows 10 </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remote Desktop Protocol (RDP) 10 AVC / H.264 Las mejoras AVC / H.264 en Windows 10 y Windows Server 2016 La vista previa t√©cnica de</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
AVC con codificaci√≥n de hardware se puede ver en el registro de eventos (consulte el art√≠culo anterior para obtener m√°s detalles) ):</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kf/4_/_n/kf4__nmejj4amr9nctpufhwfb6a.png"><br>
<br>
<img src="https://habrastorage.org/webt/ld/rn/ld/ldrnldvgbclldmcr2f8pxoztfxo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solo noto que todav√≠a hay un problema de distorsi√≥n incluso con h.264 4: 4: 4. </font><font style="vertical-align: inherit;">Inmediatamente te llama la atenci√≥n si trabajas en PowerShell ISE: el texto del error se muestra con una distorsi√≥n desagradable. </font><font style="vertical-align: inherit;">Adem√°s, todo est√° bien en la captura de pantalla y en la foto. </font><font style="vertical-align: inherit;">Magia. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n un signo indirecto del trabajo de AVC de vez en cuando aparecen cuadrados verdes en las esquinas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AVC y la codificaci√≥n de hardware en versiones nuevas deber√≠an funcionar de forma inmediata, pero la pol√≠tica de grupo nunca es superflua: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pn/hc/uo/pnhcuobl3frw-p4pfodd9xr_tsa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
dado que AVC est√° codificada en hardware con una tarjeta de video, es una buena idea actualizar los controladores de video.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acerca de los problemas</font></font></h1><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XP y Vista</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Si el problema ocurre en Windows XP o Vista, intente actualizar primero el protocolo a la versi√≥n 7 (escrito al principio del art√≠culo). Aseg√∫rese de habilitar el soporte de CredSSP. Microsoft ya ha eliminado art√≠culos en el sitio, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pero Internet lo recuerda</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si no ayuda, "el m√©dico habla a la morgue, luego a la morgue". Lo que el sistema operativo ha experimentado en los √∫ltimos 15 a√±os es mejor ni siquiera pensarlo. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NLA</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
A veces ayuda a deshabilitar NLA en el servidor. No funcion√≥ la causa, los autos caseros son todos diferentes. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NTLM</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Algunos clientes intentan iniciar sesi√≥n con NTLMv1. Los motivos son diferentes, pero puede solucionarlo en el cliente de esta manera:</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-type">HKEY_LOCAL_MACHINE</span>\<span class="hljs-type">SYSTEM</span>\<span class="hljs-type">CurrentControlSet</span>\<span class="hljs-type">Control</span>\<span class="hljs-type">Lsa</span>]<font></font>
<span class="hljs-string">"LmCompatibilityLevel"</span>=dword:<span class="hljs-number">00000003</span><font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se requiere reiniciar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">es joven y no</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tiene miedo de nada, entonces hay una soluci√≥n m√°s radical: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deshabilitar la vinculaci√≥n de canales</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en la puerta de enlace de escritorio remoto</font></font><br>
<br>
<pre><code class="powershell hljs">HKLM\Software\Microsoft\Windows NT\CurrentVersion\TerminalServerGateway\Config\Core<font></font>
<span class="hljs-built_in">Type</span>: REG_DWORD<font></font>
Name: EnforceChannelBinding<font></font>
Value: <span class="hljs-number">0</span> (Decimal)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No tienes que hacer esto. </font><font style="vertical-align: inherit;">Pero lo hicimos. </font><font style="vertical-align: inherit;">:-) Para un cliente que insisti√≥ (no est√° mal, insisti√≥) que NTLMv1 en las estaciones de trabajo que necesitaba. </font><font style="vertical-align: inherit;">No s√©, tal vez hay servidores en NT4 sin SP todav√≠a en funcionamiento. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deshabilitar RDP 8+ en Windows 10</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Si todo lo dem√°s falla y las ideas se agotan, puede usar la clave no documentada para degradar el protocolo RDP a la versi√≥n 7.</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-type">HKEY_CURRENT_USER</span>\<span class="hljs-type">Software</span>\<span class="hljs-type">Microsoft</span>\<span class="hljs-type">Terminal</span> <span class="hljs-type">Server</span> <span class="hljs-type">Client</span>]<font></font>
<span class="hljs-string">"RDGClientTransport"</span>=dword:<span class="hljs-number">00000001</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No lo hice yo mismo y no te aconsejo. Pero para alguien, escriben que ayuda. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
componente </font><b><font style="vertical-align: inherit;">DrWeb</font></b><font style="vertical-align: inherit;"> Dr.Web SpIDerGate puede prohibir la conexi√≥n. En este caso, se devuelve un error: </font></font><br>
<img src="https://habrastorage.org/webt/fs/76/zj/fs76zj-otc0v-v_qxkkwa0gviwo.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
en las estad√≠sticas de Dr.Web habr√° una entrada: </font></font><br>
<img src="https://habrastorage.org/webt/ik/fe/qy/ikfeqyljaepzhnieksw4qsomh6y.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
en los comentarios de este art√≠culo, un empleado de Dr.Web me contact√≥ y nuestro problema se resolvi√≥ en la pr√≥xima actualizaci√≥n de las bases de datos antivirus. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si tiene el mismo error, es mejor contactar al soporte. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como soluci√≥n temporal, puede agregar la URL de su RDGW a las excepciones: </font></font><br>
<img src="https://habrastorage.org/webt/7c/do/k-/7cdok-2f6-4f2jj-bhlmjwqd2tq.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
y solo si no ayud√≥ a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deshabilitar completamente el componente SpIDer Gate</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proxy del sistema</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Conoc√≠ una computadora fuera de servicio de alguna compa√±√≠a donde un TMG local estaba registrado como un proxy del sistema y la conexi√≥n a RDGW no funcionaba. Esto se puede solucionar as√≠:</font></font><br>
<br>
<pre><code class="powershell hljs">netsh winhttp show proxy &amp;&amp; netsh winhttp reset proxy</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cambiar dise√±os de teclado</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
A veces vienen dise√±os adicionales. </font><font style="vertical-align: inherit;">Puede deshabilitar el reenv√≠o de dise√±o desde el cliente</font></font><br>
<pre><code class="powershell hljs">[<span class="hljs-type">HKLM</span>\<span class="hljs-type">System</span>\<span class="hljs-type">CurrentControlSet</span>\<span class="hljs-type">Control</span>\<span class="hljs-type">Keyboard</span> <span class="hljs-type">Layout</span>]<font></font>
<span class="hljs-string">"IgnoreRemoteKeyboardLayout"</span>=dword:<span class="hljs-number">00000001</span></code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Problemas de DPI El</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
escalado proviene de la m√°quina del cliente, y si cuesta 125% en una computadora port√°til dom√©stica, ser√° lo mismo en una m√°quina que funcione. </font><font style="vertical-align: inherit;">En los servidores, esto se puede desactivar, pero en las estaciones de trabajo no pude encontrar c√≥mo. </font><font style="vertical-align: inherit;">Pero la tienda de aplicaciones de Windows 10 tiene un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cliente "moderno"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede configurar DPI en √©l:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ig/dz/sm/igdzsmxjjsxc7bsmrixgkbachpm.png"><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√≥mo monitorear una puerta de enlace con RDGW</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hay un contador de rendimiento "Puerta de enlace TS \ Conexiones actuales", que es un poco defectuoso si no hay conexiones o si el servidor no se ha reiniciado durante mucho tiempo. Muestra exactamente el n√∫mero de conexiones, pero como recordamos, para HTTP + UDP hay al menos dos, y tal vez m√°s. Por lo tanto, este no es un indicador completamente objetivo del n√∫mero de conexiones de los empleados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hay una clase WMI Win32_TSGatewayConnection. Su contenido corresponde a lo que ve en la secci√≥n Supervisi√≥n de la Puerta de enlace de escritorio remoto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Con √©l, el n√∫mero de conexiones se puede calcular con mayor precisi√≥n:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-WmiObject</span> <span class="hljs-literal">-class</span> <span class="hljs-string">"Win32_TSGatewayConnection"</span> <span class="hljs-literal">-namespace</span> <span class="hljs-string">"root\cimv2\TerminalServices"</span> <font></font>
|?{<span class="hljs-variable">$_</span>.transportprotocol <span class="hljs-operator">-ne</span> <span class="hljs-number">2</span>}|<span class="hljs-built_in">select</span> username,connectedresource|<span class="hljs-built_in">sort</span> username|<span class="hljs-built_in">Get-Unique</span> <span class="hljs-literal">-AsString</span>| <span class="hljs-built_in">measure</span>|<span class="hljs-built_in">select</span> <span class="hljs-literal">-ExpandProperty</span> count<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solo por diversi√≥n, hay una utilidad </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analizador de pantalla remota</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">La versi√≥n gratuita no me mostr√≥ nada √∫til, pero de repente ser√° √∫til para alguien. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pero, ¬øqu√© pasa con el ajuste fino, ajustando unas pocas docenas de par√°metros de sesi√≥n? </font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El principio de Pareto es apropiado aqu√≠: el 20% de los esfuerzos rinden el 80% del resultado. </font><font style="vertical-align: inherit;">Si est√° listo para invertir su tiempo en el 20% restante del resultado, excelente. </font><font style="vertical-align: inherit;">Solo tenga en cuenta que cuando lee un art√≠culo sobre la configuraci√≥n de un protocolo en Windows 7, no sabe sobre qu√© protocolo escribi√≥ el autor: 7, 8 u 8.1. </font><font style="vertical-align: inherit;">Cuando lee sobre Windows 10 sin especificar una versi√≥n, los problemas son los mismos. </font><font style="vertical-align: inherit;">Por ejemplo, escriben que en versiones nuevas de Windows 10, el c√≥dec AVC / h.264 ha cambiado a RDPGFX_CODECID_AVC444 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y en Windows Server 2016, RDPGFX_CODECID_AVC444 permanece.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De todos estos consejos, usamos solo dos configuraciones:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Color de 16 bits, puede leerlo en el art√≠culo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rendimiento de MS RDP / Uso de ancho de banda</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deshabilitar </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">suavizado de fuente suavizado de fuente: i: 0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en el art√≠culo anterior o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hosts de sesi√≥n de escritorio remoto de optimizaci√≥n de rendimiento</font></font></a></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dudo que den un resultado tangible. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As√≠ que hemos llegado al final del art√≠culo. </font><font style="vertical-align: inherit;">Quer√≠a ser m√°s bajo, pero result√≥ como siempre. </font><font style="vertical-align: inherit;">Me alegra que estos consejos ayuden a alguien a ahorrar tiempo o mejorar la configuraci√≥n de su infraestructura.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es501118/index.html">Hurra (Oh no) - udalenka</a></li>
<li><a href="../es501120/index.html">¬øQu√© es un centro de datos de Google Ads?</a></li>
<li><a href="../es501126/index.html">Problema n.o 38: capacitaci√≥n en TI: problemas y desaf√≠os actuales de empresas l√≠deres</a></li>
<li><a href="../es501128/index.html">¬øPor qu√© el desarrollo de realidad virtual no le conviene?</a></li>
<li><a href="../es501130/index.html">Halt and Catch Fire: un equipo que merece una adaptaci√≥n</a></li>
<li><a href="../es501134/index.html">C√≥mo el equipo de control de calidad de GitLab utiliza la herramienta de rendimiento de GitLab</a></li>
<li><a href="../es501138/index.html">10 eventos en l√≠nea a los que puedes asistir el 2 de mayo</a></li>
<li><a href="../es501140/index.html">Aumento de la lealtad del analizador de datos del servidor en iOS</a></li>
<li><a href="../es501142/index.html">¬øEst√°s usando un teclado num√©rico?</a></li>
<li><a href="../es501144/index.html">¬øEs posible hackear el cerebro con sonido?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>