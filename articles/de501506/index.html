<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧘🏾 👩🏽‍💻 👨‍🏭 Über GDI-Lecks und die Bedeutung des Glücks 💚 🤵🏾 👩🏿‍🔬</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Im Mai 2019 wurde ich gebeten, mir einen potenziell gefährlichen Chrome-Fehler anzusehen. Zuerst diagnostizierte ich ihn als unwichtig und verschwende...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Über GDI-Lecks und die Bedeutung des Glücks</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/501506/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e75/586/6da/e755866da35a13300e4fde55ebfd100b.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Mai 2019 wurde ich gebeten, mir einen potenziell gefährlichen Chrome-Fehler anzusehen. Zuerst diagnostizierte ich ihn als unwichtig und verschwendete auf diese Weise zwei Wochen. Später, als ich zur Untersuchung zurückkehrte, wurde sie zur Hauptursache für den Absturz des Browserprozesses im Chrome Beta-Kanal. Hoppla </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Am 6. Juni, an dem Tag, an dem ich meinen Fehler bei der Interpretation der Abflugdaten bemerkte, wurde der Fehler als ReleaseBlock-Stable markiert. Dies bedeutete, dass wir für die meisten Nutzer erst dann eine neue Version von Chrome veröffentlichen können, wenn wir herausgefunden haben, was los ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Absturz tritt auf, weil uns die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GDI-Objekte (Graphics Device Interface)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ausgegangen </font><font style="vertical-align: inherit;">sind, wir aber nicht wussten, um welche Art von GDI-Objekten es sich handelt. Die Diagnosedaten gaben keine Hinweise darauf, wo das Problem lag, und wir konnten es nicht neu erstellen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Viele Leute aus unserem Team haben am 6. und 7. Juni hart an diesem Fehler gearbeitet, sie haben ihre Theorien getestet, sind aber nicht weitergekommen. Am 8. Juni beschloss ich, meine E-Mails zu überprüfen, und Chrome stürzte sofort ab. Es war </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der gleiche Fehler</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was für eine Ironie. Während ich nach Änderungen suchte und Absturzberichte untersuchte, um herauszufinden, was dazu führen könnte, dass der Chrome-Browserprozess GDI-Objekte verliert, stieg die Anzahl der GDI-Objekte in meinem Browser unaufhaltsam an und überschritt am Morgen des 8. Juni die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">magische Anzahl von 10.000</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Zu diesem Zeitpunkt ist eine der Speicherzuweisungsvorgänge für das GDI-Objekt fehlgeschlagen, und der Browser ist absichtlich abgestürzt. Es war ein unglaubliches Glück.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie den Fehler reproduzieren können, können Sie ihn zwangsläufig beheben. </font><font style="vertical-align: inherit;">Ich musste nur herausfinden, wie ich diesen Fehler verursacht habe, danach können wir ihn beseitigen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Für den Anfang eine kurze Geschichte des Problems</font></font></h2><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a10/aba/273/a10aba273e79a9fc534a6d436c21f8de.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn wir versuchen, Speicher für ein GDI-Objekt zuzuweisen, überprüfen wir an den meisten Stellen im Chromium-Code zunächst, ob diese Zuordnung erfolgreich war. Wenn es nicht möglich war, Speicher zuzuweisen, schreiben wir einige Informationen auf den Stapel und führen absichtlich einen Absturz durch, wie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in diesem Quellcode zu sehen ist</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Der Fehler wird absichtlich verursacht, da wir, wenn wir keinen Speicher für GDI-Objekte zuweisen können, nicht auf dem Bildschirm rendern können. Es ist besser, ein Problem zu melden (wenn Absturzberichte aktiviert sind) und den Prozess neu zu starten, als eine leere Benutzeroberfläche anzuzeigen. Standardmäßig können Sie bis zu 10.000 GDI-Objekte pro Prozess erstellen. In der Regel werden nur einige Hundert verwendet. Wenn wir diese Grenze überschritten haben, ist etwas völlig schief gelaufen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn wir einen der Absturzberichte erhalten, der den Speicherzuordnungsfehler für das GDI-Objekt angibt, haben wir einen Aufrufstapel und alle möglichen anderen nützlichen Informationen. </font><font style="vertical-align: inherit;">Fein! </font><font style="vertical-align: inherit;">Das Problem ist jedoch, dass solche Crash-Dumps nicht unbedingt mit dem Fehler zusammenhängen. </font><font style="vertical-align: inherit;">Dies liegt daran, dass der Code, der das Leck von GDI-Objekten verursacht, und der Code, der den Fehler meldet, möglicherweise nicht derselbe Code sind. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das heißt, wir haben ungefähr zwei Arten von Code:</font></font><br>
<br>
<blockquote><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">void GoodCode () {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   auto x = AllocateGDIObject ();</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   if (! x)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     CollectGDIUsageAndDie ();</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   UseGDIObject (x);</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   FreeGDIObject (x);</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
void BadCode () {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   auto x = AllocateGDIObject ();</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   UseGDIObject (x);</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}}</font></font></pre></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der gute Code bemerkt, dass die Speicherzuweisung fehlgeschlagen ist, und meldet dies. Der schlechte Code ignoriert die Abstürze und verschüttet Objekte, wodurch guter Code "ersetzt" wird, sodass er die Verantwortung übernimmt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chrom enthält mehrere Millionen Codezeilen. Wir wussten nicht, welche Funktion einen Fehler aufwies, und wir wussten nicht einmal, welche </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Art von</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GDI-Objekten </font><font style="vertical-align: inherit;">undicht waren. Einer meiner </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kollegen fügte Code hinzu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , der den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prozessumgebungsblock</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vor dem Absturz umging </font><font style="vertical-align: inherit;">, um die Anzahl der GDI-Objekte jedes Typs zu ermitteln. Bei allen aufgezählten Typen (Gerätekontexte, Bereiche, Bitmaps, Paletten, Pinsel, Federn und Unbekannt) wurde die Anzahl jedoch nicht überschritten. Es ist komisch.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es stellte sich heraus, dass sich die Objekte, für die wir direkt Speicher zuweisen, in dieser Tabelle befinden, aber keine vom Kernel in unserem Namen erstellten Objekte vorhanden sind und sie irgendwo im Windows-Objektmanager vorhanden sind. </font><font style="vertical-align: inherit;">Dies bedeutete, dass </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GDIView</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für dieses Problem genauso blind ist wie wir (außerdem ist GDIView nur nützlich, wenn ein Fehler lokal abgespielt wird). </font><font style="vertical-align: inherit;">Weil wir Cursor durchgesickert sind und Cursor USER32-Objekte sind, an die GDI-Objekte angehängt sind; </font><font style="vertical-align: inherit;">Der Speicher für diese GDI-Objekte wird vom Kernel zugewiesen, und wir konnten nicht sehen, was passiert ist.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fehlinterpretation</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unsere Funktion </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CollectGDIUsageAndDie hat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> einen sehr lebendigen Namen, und ich denke, Sie werden mir darin zustimmen. Sehr ausdrucksvoll. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Problem ist, dass zu viele Aktionen ausgeführt werden. CollectGDIUsageAndDie überprüfte etwa ein Dutzend verschiedene Arten von Speicherzuordnungsfehlern für GDI-Objekte. Aufgrund der Einbettung des Codes erhielten sie dieselbe Fehlersignatur - alle stürzten in die Hauptfunktionen ab und wurden zusammengeführt. Daher hat einer meiner Kollegen mit Bedacht </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eine Änderung vorgenommen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und verschiedene Prüfungen in separate (nicht integrierte) Funktionen aufgeteilt. Dank dessen konnten wir jetzt auf den ersten Blick verstehen, welche Prüfung fehlgeschlagen ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Leider führte dies dazu, dass wir anfingen, </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Absturzberichte</font></a><font style="vertical-align: inherit;"> von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CrashIfExcessiveHandles zu erhalten</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich sagte zuversichtlich: "Dies ist nicht die Ursache des Fehlers, sondern lediglich eine Änderung der Signatur." </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber ich habe mich getäuscht. </font><font style="vertical-align: inherit;">Dies war die Ursache für den Fehler </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> die Änderung der Signatur. </font><font style="vertical-align: inherit;">Hoppla </font><font style="vertical-align: inherit;">Umständliche Analyse, Dawson. </font><font style="vertical-align: inherit;">Keine Cookies für Sie.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zurück zu unserer Geschichte</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zu diesem Zeitpunkt wusste ich bereits, dass etwas, das ich am 7. Juni tat, fast 10.000 GDI-Objekte pro Tag verwendete. </font><font style="vertical-align: inherit;">Wenn ich das verstehen könnte, würde ich das Rätsel lösen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0c0/b8e/9ee/0c0b8e9ee9f5afdfff26391eb2e360f8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Windows Task-Manager verfügt über eine zusätzliche </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GDI-</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Objektspalte </font><font style="vertical-align: inherit;">, in der Sie Lecks finden können. Am 7. Juni arbeitete ich von zu Hause aus und stellte eine Verbindung zu meiner Arbeitsmaschine her. Diese Spalte wurde auf der Arbeitsmaschine aktiviert, da ich Tests durchgeführt und versucht habe, das Absturzszenario zu reproduzieren. In der Zwischenzeit gab </font><font style="vertical-align: inherit;">es jedoch Lecks von GDI-Objekten </font><font style="vertical-align: inherit;">im Browser auf meinem </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Heimcomputer</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Hauptaufgabe, für die ich den Browser zu Hause verwendet habe, besteht darin, mithilfe der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CRD-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Anwendung </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">(Chrome Remote Desktop)</font></a><font style="vertical-align: inherit;"> eine Verbindung zu einem funktionierenden Computer </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">herzustellen</font></a><font style="vertical-align: inherit;"> . Also schaltete ich die Spalte GDI-Objekte auf dem Heimcomputer ein und begann zu experimentieren. Bald bekam ich die Ergebnisse.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tatsächlich zeigt die Zeitleiste des Fehlers, dass von dem Moment „Ich hatte einen Fehler“ (14:00) bis „Es ist irgendwie mit der CRD verbunden“ und dann bis zum „Fall in Cursorn“ nur 35 Minuten vergangen sind. Ich habe bereits gesagt, wie viel einfacher es ist, Fehler zu untersuchen, wenn Sie sie lokal abspielen können. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es stellte sich heraus, dass jedes Mal, wenn eine CRD-Anwendung (oder eine Chrome-Anwendung?) Die Cursor änderte, sechs GDI-Objekte verloren gingen. Wenn Sie während der Arbeit mit Chrome Remote Desktop die Maus über den gewünschten Teil des Bildschirms bewegen, können Hunderte von GDI-Objekten pro Minute und Tausende pro Stunde auslaufen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach einem Monat ohne Fortschritte bei der Lösung dieses Problems verwandelte es sich plötzlich von einem nicht entfernbaren in eine einfache Korrektur. Ich habe schnell einen Fixentwurf geschrieben und dann hat einer meiner Kollegen (ich habe an diesem Fehler nicht gearbeitet) </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einen echten Fix erstellt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Es wurde am 10. Juni um 11:16 Uhr heruntergeladen und um 13:00 Uhr veröffentlicht. </font><font style="vertical-align: inherit;">Nach einigen Zusammenführungen verschwand der Fehler.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das ist alles?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben den Fehler behoben und es ist großartig, aber es ist viel wichtiger, dass solche Fehler nie wieder auftreten. </font><font style="vertical-align: inherit;">Natürlich ist es richtig, C ++ ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAII</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">-Objekte für die Ressourcenverwaltung zu verwenden </font><font style="vertical-align: inherit;">, aber in diesem Fall war der Fehler in der WebCursor-Klasse enthalten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn es um Speicherlecks geht, gibt es eine zuverlässige Reihe von Systemen. </font><font style="vertical-align: inherit;">Microsoft verfügt über </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Heap-Snapshots</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Chromium über </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Heap-Profilerstellung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für Benutzerversionen und einen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leck-Eliminator</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auf Testmaschinen. </font><font style="vertical-align: inherit;">Es scheint jedoch, dass Lecks von GDI-Objekten der Aufmerksamkeit beraubt wurden. </font><font style="vertical-align: inherit;">Der Prozessinformationsblock enthält unvollständige Informationen, einige GDI-Objekte können nur im Kernelmodus aufgelistet werden, und es gibt keinen einzigen Punkt zum Zuweisen und Freigeben von Speicher für Objekte, die die Ablaufverfolgung erleichtern können. </font><font style="vertical-align: inherit;">Dies war nicht das erste Leck von GDI-Objekten, mit dem ich mich befassen musste, und es wird nicht das letzte sein, da es keinen zuverlässigen Weg gibt, sie zu verfolgen. </font><font style="vertical-align: inherit;">Hier sind meine Empfehlungen für die folgenden Windows-Versionen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Machen Sie den Prozess, bei dem die Anzahl </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aller</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Arten von GDI-Objekten ermittelt wird, trivial, ohne PEB dunkel lesen zu müssen (und ohne Cursor zu ignorieren).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erstellen Sie eine unterstützte Methode zum Abfangen und </font><font style="vertical-align: inherit;">Verfolgen </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aller</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Vorgänge zum Erstellen und Zerstören von GDI-Objekten für eine zuverlässige Nachverfolgung. </font><font style="vertical-align: inherit;">auch für diejenigen, die indirekt erstellt wurden</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reflektieren Sie dies alles in der Dokumentation</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das ist alles. </font><font style="vertical-align: inherit;">Eine solche Verfolgung ist nicht einmal schwierig zu implementieren, da GDI-Objekte notwendigerweise so begrenzt sind, dass der Speicher nicht begrenzt ist. </font><font style="vertical-align: inherit;">Es wäre großartig, wenn die Verwendung dieser seltsamen, aber unvermeidlichen GDI-Objekte sicherer wäre. </font><font style="vertical-align: inherit;">Aber bitte. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> können Sie die Diskussion über Reddit lesen. </font><font style="vertical-align: inherit;">Das Thema auf Twitter beginnt </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de501494/index.html">Kein Gramm für die Seele: die Geschichte der gescheiterten Kryptowährung Durov</a></li>
<li><a href="../de501496/index.html">Comet Lake, Abschluss der Iteration</a></li>
<li><a href="../de501498/index.html">Wie viel C ++ - Code muss geschrieben werden, um den HTTP-Header für die Autorisierung mit easy_parser von RESTinio zu analysieren?</a></li>
<li><a href="../de501500/index.html">Visueller Hack: Was bedroht und wie Sie sich vor Spionage schützen können</a></li>
<li><a href="../de501502/index.html">New Lab Digital Synthesis setzt Harris Book fort und hilft bei der Erstellung von FPGA-Videospielen</a></li>
<li><a href="../de501508/index.html">Verdammt altes CRM</a></li>
<li><a href="../de501510/index.html">Ein neuer Blick auf die Fullstack-Entwicklung mit dem Ruby on Rails-Framework</a></li>
<li><a href="../de501516/index.html">Lassen Sie uns das Vakuum ausschalten ?! Alexey Lesovsky</a></li>
<li><a href="../de501520/index.html">C # 8 und Nullgültigkeit. Wie leben wir damit?</a></li>
<li><a href="../de501522/index.html">Kostenlose Skillbox-Webinare: Schreiben von Spielen in PHP, Unity und Unreal Engine</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>