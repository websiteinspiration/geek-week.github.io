<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôÜüèª üëäüèø üë©üèΩ‚Äçü§ù‚Äçüë®üèø New Year greetings and COVID-19: how hackers use the news ‚è≠Ô∏è ‚öìÔ∏è üßõüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cybercriminals often use the latest news and events to send malicious files. In connection with the coronavirus pandemic, many APT groups, including G...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>New Year greetings and COVID-19: how hackers use the news</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/498504/"><img src="https://habrastorage.org/webt/nw/js/q8/nwjsq8rr7fp5mcl-ujst7i5ngmc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cybercriminals often use the latest news and events to send malicious files. </font><font style="vertical-align: inherit;">In connection with the coronavirus pandemic, many APT groups, including Gamaredon, SongXY, TA428, Lazarus, Konni, Winnti, began to use this topic in their campaigns. </font><font style="vertical-align: inherit;">One recent example of such activity is the attacks of the South Korean group Higaisa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PT Expert Security Center experts </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">detected and analyzed</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> malicious files created by Higaisa.</font></font><a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Example 1: fake WHO report</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first World Health Organization (WHO) notifications of the spread of coronavirus appeared in early March. Within a few days, Higaisa participants began to send letters with a malicious file. For concealment, a legitimate WHO report file in PDF format was used. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The infection began with the file 20200308-sitrep-48-covid-19.pdf.lnk: The </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/c98/c48/73a/c98c4873ae459ddac180afb3bd9a2fdd.png" alt="image"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contents of the LNK file The</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
file is a .lnk shortcut with the icon of the PDF document. When you try to open, the cmd.exe / c command is executed with the following command line:</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/90a/eeb/30d/90aeeb30d7b9c0318217197725f072ed.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Running findstr.exe retrieves the Base64 load at the end of the LNK file, which is then decoded using CertUtil.exe (msioa.exe). </font><font style="vertical-align: inherit;">The decoding result is a CAB archive that is unpacked into the same% tmp% folder and contains several files, including the malware installation script, the original WHO report file (as a decoy), and the installer payload.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Example 2: New Year's greetings</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The second sample analyzed is an RTF file with New Year's greetings: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/c71/fc6/beb/c71fc6beb1993e97648fb4a71368f1fd.png" alt="image"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A document with a congratulatory text The</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
document was created using the popular Royal Road RTF (or 8.t) builder exploiting the CVE-2018-0798 vulnerability in the Microsoft Equation Editor. This builder is not publicly available, but is </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">widely distributed</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> among Chinese APT groups, including TA428, Goblin Panda, IceFog, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SongXY</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . The name 8.t is due to the fact that a malicious document during operation creates a file named 8.t in the temporary folder containing the encrypted payload.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a result of exploiting the vulnerability, the file% APPDATA% \ microsoft \ word \ startup \ intel.wll is created. This is a DLL dropper that will be loaded the next time you start Microsoft Word. Its payload consists of two files:% ALLUSERSPROFILE% \ TotalSecurity \ 360ShellPro.exe and% ALLUSERSPROFILE% \ TotalSecurity \ utils \ FileSmasher.exe. Files are encrypted using xor 0x1A. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/38c/19f/863/38c19f8634ff6c802793d6c57906f560.png" alt="image"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The main function of the dropper intel.wll (fragment)</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Next, there is a fixation in the system. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This file is not the only similar object of authorship Higaisa. So, Tencent analysts </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">were recorded</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">distribution of malicious executable files with the names Happy-new-year-2020.scr and 2020-New-Year-Wishes-For-You.scr during the same period. </font><font style="vertical-align: inherit;">In this case, the source files are executable, and the bait is present in the form of a greeting JPG card, which is unpacked and opened in the default viewer: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/648/412/bc5/648412bc5c9e45c4128e66345f4b47e1.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The structure of these threats, minus the exploitation of CVE-2018-0798, is almost identical to the RTF document. </font><font style="vertical-align: inherit;">SCR files are droppers, the payload is decrypted using xor 0x1A and unpacked into a subfolder in% ALLUSERSPROFILE%.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A study by Positive Technologies analysts revealed the evolution of the Higaisa malware. </font><font style="vertical-align: inherit;">At the same time, the structure of the tools used (droppers, loaders) remains largely unchanged. </font><font style="vertical-align: inherit;">To complicate the detection, attackers vary individual details, such as the URL of the control server, the parameters of the RC4 key, legitimate files used for SideLoading, and libraries for HTTP interaction.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The full report is available </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></blockquote></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en498492/index.html">Honey, we kill bureaucracy: how digitalization is changing the dialogue between suppliers and X5</a></li>
<li><a href="../en498494/index.html">JEP 360: Sealed Types (Preview)</a></li>
<li><a href="../en498496/index.html">Announcement of the online mitap PiterJS # 46: performance, complex UI components and CSS-in-TS</a></li>
<li><a href="../en498498/index.html">Investigation: what is higher than thread priorities in Windows?</a></li>
<li><a href="../en498500/index.html">What to see in quarantine? A selection of materials from Technostream (part 1)</a></li>
<li><a href="../en498510/index.html">X. An overview of the boxed version of telephony and connecting to a remote site</a></li>
<li><a href="../en498512/index.html">Fighting traffic jams in a small town for a small budget: results of 6 months of the project</a></li>
<li><a href="../en498516/index.html">Postman - AutoMetrica Metrics in AppMetrica</a></li>
<li><a href="../en498518/index.html">A simplified approach to calculating the date of availability of custom-made production</a></li>
<li><a href="../en498520/index.html">Algorithms for post-processing of text field recognition results</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>