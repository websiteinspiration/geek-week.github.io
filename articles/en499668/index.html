<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤵🏼 🤛🏻 🖕🏻 Road to Hell JavaScript Dependencies 🖍️ 👨🏼‍🏭 ⛴️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Each JavaScript project begins with good intentions, namely that its creators promise themselves not to use too many NPM packages during its developme...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Road to Hell JavaScript Dependencies</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/499668/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Each JavaScript project begins with good intentions, namely that its creators promise themselves not to use too many NPM packages during its development. But even if the developers make considerable efforts to keep this promise, NPM packages gradually penetrate their projects. File size </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grows over time. And with the </font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">installation of dependencies, a real horror occurs, expressed in additions and deletions of packages, especially noticeable with the next PR ... </font><font style="vertical-align: inherit;">
"Everything is fine," says the team leader. The rest of the team nods in agreement. What else to do? We all enjoy the fact that the JavaScript ecosystem is alive and well. We do not need to reinvent the wheel every time and try to solve the problems that have already been solved by the open source community.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/be/cf/ky/becfkyhkcfavrlygimyyrliz9t4.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suppose you are going to make a blog and want to use Gatsby.js. </font><font style="vertical-align: inherit;">Try adding this site generator based on your project. </font><font style="vertical-align: inherit;">Now, congratulations. </font><font style="vertical-align: inherit;">Your project just had 19,000 additional dependencies. </font><font style="vertical-align: inherit;">This is normal? </font><font style="vertical-align: inherit;">How complex can a JavaScript dependency tree become? </font><font style="vertical-align: inherit;">How does a dependency tree turn into hell? </font><font style="vertical-align: inherit;">Let's figure it out.</font></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is a JavaScript package?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NPM (Node Package Manager, Node Package Manager) stores the largest package registry in the world. </font><font style="vertical-align: inherit;">These are JavaScript packages. </font><font style="vertical-align: inherit;">NPM is more than RubyGems, PyPi, and Maven combined. </font><font style="vertical-align: inherit;">This conclusion can be made on the basis of the analysis of the data of the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Module Counts</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> project </font><font style="vertical-align: inherit;">, which monitors the number of packages in popular registries.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/259/d83/158/259d831584b0a9a5d1fd6226e3f799b0.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data on the number of packages in popular registries</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
You might think that very large amounts of code are represented on this graph. </font><font style="vertical-align: inherit;">The way it is. </font><font style="vertical-align: inherit;">In order to turn a project into an NPM package, this package must have a file</font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Such a package can be sent to the NPM registry.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is package.json?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here are the tasks it solves </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It lists the packages that your project depends on (this is a list of project dependencies).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In it, using the rules of semantic versioning, versions of dependency packages that your project can use are set.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It allows you to reproduce the environment necessary for the package to work, and, as a result, simplifies the transfer of the project to other developers.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A file </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">can be thought of as a file </font></font><code>README</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pumped with steroids. </font><font style="vertical-align: inherit;">Here you can describe the dependencies of your package, here you can write scripts that are executed during the assembly and testing of the project. </font><font style="vertical-align: inherit;">The same file contains information about the project version specified by its developer and a description of the project. </font><font style="vertical-align: inherit;">We are particularly interested in the possibility </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">of specifying project dependencies. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perhaps the fact that the project dependencies are indicated in this file looks somewhat alarming. </font><font style="vertical-align: inherit;">Imagine that there is a package that depends on another package, and this other package depends on another package. </font><font style="vertical-align: inherit;">Such a chain of dependencies can be arbitrarily long. </font><font style="vertical-align: inherit;">For this reason, installing the only package, Gatsby.js, means equipping the project with 19,000 additional dependencies.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dependency types in package.json</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order to better understand how project dependency lists grow over time, let's talk about the different types of dependencies that a project may have. </font><font style="vertical-align: inherit;">Namely, the </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">following sections can be found that describe various dependencies:</font></font><br>
<br>
<ul>
<li><code>dependencies</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - these are ordinary dependencies, the functionality of which is used in the project, and which are accessed from its code.</font></font></li>
<li><code>devDependencies</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- these are development dependencies. </font><font style="vertical-align: inherit;">For example, the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prettier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> library </font><font style="vertical-align: inherit;">used to format code.</font></font></li>
<li><code>peerDependencies</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - if dependencies are written to this section, the package developer thereby informs the one who will install it that he will need a specific version of the package specified in this section.</font></font></li>
<li><code>optionalDependencies</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - they list optional dependencies, such, the inability to install which will not violate the installation process of the package.</font></font></li>
<li><code>bundledDependencies</code> —    ,    .     ,    NPM,    ,             .</li>
</ul><br>
<h2><font color="#3AC1EF">   package-lock.json</font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We all know that the file </font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, in the course of work on the project, constantly undergoes changes. Something is removed from it, something is added to it. This is especially noticeable when viewing PR containing an updated version of this file. We often take it for granted. A file is </font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">automatically generated every time a file </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or folder </font><font style="vertical-align: inherit;">changes </font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. This allows you to maintain the contents of the dependency tree exactly as it was when you installed the project dependencies. This allows, when installing the project, to reproduce the dependency tree. This solves the problem of having different versions of the same package from different developers. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consider a project whose dependencies include React. The corresponding entry is available at </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. If you look at the file</font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> of this project, then you can see something like the following:</font></font><br>
<br>
<pre><code class="javascript hljs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"react"</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"version"</span>: <span class="hljs-string">"16.13.0"</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"resolved"</span>: <span class="hljs-string">"https://registry.npmjs.org/react/-/react-16.13.0.tgz"</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"integrity"</span>: <span class="hljs-string">"sha512-TSavZz2iSLkq5/oiE7gnFzmURKZMltmi193rm5HEoUDAXpzT9Kzw6oNZnGoai/4+fUnm7FqS5dwgUL34TujcWQ=="</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"requires"</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"loose-envify"</span>: <span class="hljs-string">"^1.1.0"</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"object-assign"</span>: <span class="hljs-string">"^4.1.1"</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"prop-types"</span>: <span class="hljs-string">"^15.6.2"</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A file </font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is a large list of project dependencies. </font><font style="vertical-align: inherit;">Here are the dependency versions, paths (URIs) to the modules, hashes used to verify the integrity of the module and the packages needed by this module. </font><font style="vertical-align: inherit;">If you read this file, you can find records of all the packages that React needs. </font><font style="vertical-align: inherit;">This is where the real hell of dependencies lies. </font><font style="vertical-align: inherit;">Everything that the project needs is described here.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Understanding Gatsby.js dependencies</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How is it that, having established only one dependency, we add as many as 19,000 dependencies to the project? </font><font style="vertical-align: inherit;">It's all about dependency dependencies. </font><font style="vertical-align: inherit;">That is why we have what we have:</font></font><br>
<br>
<pre><code class="bash hljs">$ npm install --save gatsby<font></font>
<font></font>
...<font></font>
<font></font>
+ gatsby@2.19.28<font></font>
added 1 package from 1 contributor, removed 9 packages, updated 10 packages and audited 19001 packages <span class="hljs-keyword">in</span> 40.382s
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you look in </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, there you can find only one dependency. But if you look at it </font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, it turns out that in front of us is an almost 14-kilobyte monster. A more detailed answer about what all those lines of code that fall into mean </font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, can be found in the file </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the Gatsby.js repository</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . There are a lot of direct dependencies, namely, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">according to npm calculations</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , 132. If each of these dependencies has at least one more dependency, then the total number of project dependencies will double - and it will have 264 dependencies. Of course, in the real world this is not so. Each direct project dependency has more than 1 inherent dependency. As a result, the list of project dependencies is very long.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, we’ll take an interest in how many times the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lodash</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> library is used as a dependency for other packages </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="bash hljs">$ npm ls lodash<font></font>
example-js-package@1.0.0<font></font>
└─┬ gatsby@2.19.28<font></font>
&nbsp;&nbsp;├─┬ @babel/core@7.8.6<font></font>
&nbsp;&nbsp;│ ├─┬ @babel/generator@7.8.6<font></font>
&nbsp;&nbsp;│ │ └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;│ ├─┬ @babel/types@7.8.6<font></font>
&nbsp;&nbsp;│ │ └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;│ └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;├─┬ @babel/traverse@7.8.6<font></font>
&nbsp;&nbsp;│ └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;├─┬ @typescript-eslint/parser@2.22.0<font></font>
&nbsp;&nbsp;│ └─┬ @typescript-eslint/typescript-estree@2.22.0<font></font>
&nbsp;&nbsp;│ &nbsp; └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;├─┬ babel-preset-gatsby@0.2.29<font></font>
&nbsp;&nbsp;│ └─┬ @babel/preset-env@7.8.6<font></font>
&nbsp;&nbsp;│ &nbsp; ├─┬ @babel/plugin-transform-block-scoping@7.8.3<font></font>
&nbsp;&nbsp;│ &nbsp; │ └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;│ &nbsp; ├─┬ @babel/plugin-transform-classes@7.8.6<font></font>
&nbsp;&nbsp;│ &nbsp; │ └─┬ @babel/helper-define-map@7.8.3<font></font>
&nbsp;&nbsp;│ &nbsp; │ &nbsp; └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;│ &nbsp; ├─┬ @babel/plugin-transform-modules-amd@7.8.3<font></font>
&nbsp;&nbsp;│ &nbsp; │ └─┬ @babel/helper-module-transforms@7.8.6<font></font>
&nbsp;&nbsp;│ &nbsp; │ &nbsp; └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;│ &nbsp; └─┬ @babel/plugin-transform-sticky-regex@7.8.3<font></font>
&nbsp;&nbsp;│ &nbsp; &nbsp; └─┬ @babel/helper-regex@7.8.3<font></font>
&nbsp;&nbsp;│ &nbsp; &nbsp; &nbsp; └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fortunately, most of these dependencies are represented by the same version of lodash. </font><font style="vertical-align: inherit;">And with this approach, there </font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">will be only one lodash library folder. </font><font style="vertical-align: inherit;">True, this is usually not quite the case. </font><font style="vertical-align: inherit;">Sometimes different packages need different versions of the same package. </font><font style="vertical-align: inherit;">That is why a lot of jokes appeared about the huge size of the folder </font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">In our case, however, everything is not so bad:</font></font><br>
<br>
<pre><code class="bash hljs">$ du -sh node_modules<font></font>
200M&nbsp; &nbsp; node_modules<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
200 megabytes is not so bad. </font><font style="vertical-align: inherit;">I saw how the size of this folder easily reaches 700 MB. </font><font style="vertical-align: inherit;">If you are interested in learning which modules take up the most space, you can run the following command:</font></font><br>
<br>
<pre><code class="bash hljs">$ du -sh ./node_modules/* | sort -nr | grep <span class="hljs-string">'\dM.*'</span><font></font>
&nbsp;17M&nbsp; &nbsp; ./node_modules/rxjs<font></font>
8.4M&nbsp; &nbsp; ./node_modules/@types<font></font>
7.4M&nbsp; &nbsp; ./node_modules/core-js<font></font>
6.8M&nbsp; &nbsp; ./node_modules/@babel<font></font>
5.4M&nbsp; &nbsp; ./node_modules/gatsby<font></font>
5.2M&nbsp; &nbsp; ./node_modules/eslint<font></font>
4.8M&nbsp; &nbsp; ./node_modules/lodash<font></font>
3.6M&nbsp; &nbsp; ./node_modules/graphql-compose<font></font>
3.6M&nbsp; &nbsp; ./node_modules/@typescript-eslint<font></font>
3.5M&nbsp; &nbsp; ./node_modules/webpack<font></font>
3.4M&nbsp; &nbsp; ./node_modules/moment<font></font>
3.3M&nbsp; &nbsp; ./node_modules/webpack-dev-server<font></font>
3.2M&nbsp; &nbsp; ./node_modules/caniuse-lite<font></font>
3.1M&nbsp; &nbsp; ./node_modules/graphql<font></font>
...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yes, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rxjs</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is an insidious package. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here is a simple command that helps reduce the size of the folder </font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and simplify its structure:</font></font><br>
<br>
<pre><code class="bash hljs">$ npm dedup<font></font>
moved 1 package and audited 18701 packages <span class="hljs-keyword">in</span> 4.622s<font></font>
<font></font>
51 packages are looking <span class="hljs-keyword">for</span> funding<font></font>
&nbsp;&nbsp;run `npm fund` <span class="hljs-keyword">for</span> details<font></font>
<font></font>
found 0 vulnerabilities<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
During </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deduplication,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> npm tries to simplify the structure of the dependency tree by finding the dependencies used by other dependencies and moving them so that they can be shared. This applies to our lodash example. Many packages are used </font></font><code>lodash @4.17.15</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, as a result, to ensure their operability, it is enough to install this version of the library only once. Of course, this is the situation that we get into from the very beginning, only by establishing dependencies. If in the process of working on a project </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">add new dependencies, it is recommended sometimes to remember the team </font></font><code>npm dedup</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. If you use the yarn package manager, there a similar command looks like </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yarn dedupe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">But, in fact, there is no need for it, since dependency optimization is performed automatically when the command is executed </font></font><code>yarn install</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dependency Visualization</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Interested in a graphical representation of the dependencies of your project? </font><font style="vertical-align: inherit;">If so, you can create such a presentation using special tools. </font><font style="vertical-align: inherit;">Let's consider some of them. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The following is a dependency visualization result obtained using </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">npm.anvaka.com/</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dfb/f5d/373/dfbf5d37377bd62f4ea5cf422de62c74.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dependency visualization using npm.anvaka.com.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Here you can see the dependencies of the Gatsby.js project package dependencies. The result is similar to a huge web. The Gatsby.js project has so many dependencies that this “web” almost “hung” my browser.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Now</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , if interested, a link to this diagram. It can be presented in 3D-form.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here is a visualization made using</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> npm.broofa.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/285/cd6/c52/285cd6c52a00d9e87a7bc2095df6023f.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A fragment of a dependency visualization made using npm.broofa.com</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
This is similar to a flowchart. </font><font style="vertical-align: inherit;">She, for Gatsby.js, turns out to be very complicated. </font><font style="vertical-align: inherit;">You can take a look at it</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Circuit elements can be colored based on estimates from</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> npms.io</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">You can upload your own file to the site</font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Package Phobia</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tool</font><font style="vertical-align: inherit;">allows you to find out how much space it needs before installing a package.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/25c/d26/ae4/25cd26ae4fc708f0c6900c5ad3a5dead.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Package Information Received Using Package Phobia</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Here you can find out about the size of the published package, and how much disk space it will take after installation.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bottom line: with great power comes great responsibility</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the end, I want to say that JavaScript and NPM are great tools. </font><font style="vertical-align: inherit;">The good thing is that modern developers have the opportunity to use a huge set of dependencies. </font><font style="vertical-align: inherit;">Running the command </font></font><code>npm install</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in order to save yourself from writing a couple of lines of code is so easy that sometimes we forget about the consequences. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now that you have read up to this point, you should have a more complete understanding of the features of the npm-project dependency tree structure. </font><font style="vertical-align: inherit;">If you add a library to the project that is very large, or if you just explore the dependencies of your project, you can always take advantage of what we have discussed here and analyze the dependencies. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dear readers!</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Do you want to use as few dependencies as possible in your npm projects?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/a_/bs/aa/a_bsaactpbr8fltzymtkhqbw1d4.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en499656/index.html">PID temperature controller simulation</a></li>
<li><a href="../en499658/index.html">A man-laborer instead of a tester? Is it worth it to study Selenium in 2020?</a></li>
<li><a href="../en499662/index.html">Root-of-Trust for IoT and Other IoT Security Trends</a></li>
<li><a href="../en499664/index.html">Porting APIs to TypeScript as a Problem Solver</a></li>
<li><a href="../en499666/index.html">PEP 572 (Assignment Expressions in python 3.8)</a></li>
<li><a href="../en499670/index.html">Я перехожу на JavaScript</a></li>
<li><a href="../en499674/index.html">Another step to optical computers</a></li>
<li><a href="../en499676/index.html">90+ useful tools for Kubernetes: deployment, management, monitoring, security and more</a></li>
<li><a href="../en499680/index.html">Learning Kubernetes: Basic May 14-16, Advanced May 18-20</a></li>
<li><a href="../en499682/index.html">What can I get at the hackathon, except for a cash prize?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>