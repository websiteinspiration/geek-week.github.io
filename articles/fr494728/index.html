<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💈 💇🏼 💩 La méthode d'automatisation de rideau la plus abordable 🤞🏼 💾 👩🏻‍🚒</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il n'y a aucun moyen de suivre le développement de systèmes domotiques modernes de grandes marques, mais le prix et une certaine fonctionnalité vous f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>La méthode d'automatisation de rideau la plus abordable</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/494728/"><img src="https://habrastorage.org/webt/p6/ip/wz/p6ipwzm2sefywfiutbglbhcxm5k.jpeg"> <br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Il n'y a aucun moyen de suivre le développement de systèmes domotiques modernes de grandes marques, mais le prix et une certaine fonctionnalité vous font appliquer vos compétences aux appareils électroménagers faits maison. Je n'ai pas fait exception, la technique et le travail avec les logiciels sont désormais plus accessibles, ESC, Arduino, STM et d'autres innombrables plates-formes proposées offrent des opportunités pour résoudre presque tous les problèmes techniques. Il n'y a pas si longtemps, j'ai déménagé dans un nouvel appartement à la périphérie de la ville, un hall donnant sur un terrain vague et un chantier abandonné sur lequel les faisans marchaient en hiver, tout change rapidement et se construit, une maison a grandi à l'extérieur de la fenêtre, une fenêtre à travers la fenêtre.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/eq/tc/t4/eqtct4djbagxt9aplif8jng14ng.jpeg"><br>
 <a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le manque de désir de devenir le sujet de l'attention de quelqu'un d'autre a poussé à couper les rideaux automatiques. Donc, ce que je voulais des rideaux, le premier, lever et baisser en fonction de l'heure fixée, le contrôle, y compris via Internet, bien que ce dernier était nécessaire pour la mise en œuvre de la commande vocale. En conséquence, Internet a beaucoup de choses intéressantes, mais comme je suis faible en programmation, je ne pouvais pas comprendre de nombreuses solutions, et toutes ne répondaient pas aux exigences. La décision de le faire par moi-même est venue progressivement, ici, j'ai graduellement marché sur tous les râteaux mais je suis quand même arrivé aux résultats. Des volets roulants ont été achetés, la vieille caméra rotative CCTV prise de l'objet a été démontée, j'en ai extrait deux moteurs pas à pas Nooname-Chinese dont je ne trouvais pas les caractéristiques sur Internet.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/5u/tl/2u/5utl2u6o5uqvcybtxrfmbzyxn4w.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir traité les moteurs, j'ai utilisé nodemcu pour les contrôler, qui envoie des signaux pour contrôler l'unité de puissance au pilote ln298n, un simple croquis fonctionne sur la plate-forme Blynk, la position initiale du rideau est comptée à partir du signal du commutateur à lames, un certain nombre d'étapes sont prises vers la position inférieure. Le temps de montée et de descente diffère en quelques secondes et est d'une minute et demie, assez lentement, mais sans son! La carte a un module wifi intégré, et la plate-forme de clignotement a permis la synchronisation avec l'heure, selon le fuseau horaire, en conséquence, un widget a permis de simplifier le circuit autant que possible. Le contrôle vocal est effectué sur l'assistant de Dusya, alors que j'utilise le téléphone comme plate-forme, il y a des fausses alarmes périodiques, non critiques, à l'avenir il sera possible de remplacer la plate-forme (si je le comprends) et de remplacer le microphone, il y a des idées.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ny/c6/pg/nyc6pgibynw3djkievv9_9cde9i.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/ik/cd/ok/ikcdokcux-_kcqnqufapdwiwbfo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quelques mois de fonctionnement se sont écoulés, tout fonctionne, ne saute pas de pas, je ne fais plus attention aux rideaux, tu ne peux pas dire à propos de mon chat, ils lui causent un intérêt constant. </font><font style="vertical-align: inherit;">Quels sont les inconvénients, les rideaux ne fonctionnent pas en l'absence d'Internet (paiement pour une mise en œuvre abordable), il n'y a pas de retour, jusqu'à ce que je m'en rende compte, on ne sait pas dans quelle position les rideaux sont ouverts ou fermés. </font><font style="vertical-align: inherit;">Bien que ce ne soit pas fatal si les rideaux sont ouverts ou fermés et que l'on commande de nouveau, rien ne se passera. </font><font style="vertical-align: inherit;">Dans tous les cas, la mise en œuvre est justifiée sur la base du prix du marché en vigueur. </font><font style="vertical-align: inherit;">Eh bien, comme on dit, tout va bien!</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/x1lB_Mf90WY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/8E-6TJkelRQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici le code pour esp:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> BLYNK_PRINT Serial</span>
<span class="hljs-meta">#include &lt;ESP8266WiFi.h&gt;</span>
<span class="hljs-meta">#include &lt;BlynkSimpleEsp8266.h&gt;</span><font></font>
<font></font>
<span class="hljs-meta">#include &lt;ESP8266mDNS.h&gt;</span>
<span class="hljs-meta">#include &lt;WiFiUdp.h&gt;</span>
<span class="hljs-meta">#include &lt;ArduinoOTA.h&gt; //OTA   OTA-</span><font></font>
<font></font>
<span class="hljs-meta">#include &lt;AccelStepper.h&gt;</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> motor1 D1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> motor2 D2</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> motor3 D3</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> motor4 D4</span>
<span class="hljs-function">AccelStepper <span class="hljs-title">Stepper1</span>(<span class="hljs-params"><span class="hljs-number">4</span>, D1, D2, D3, D4</span>)</span>; <font></font>
<font></font>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> buttonPin = D5;  <span class="hljs-comment">//     </span>
<span class="hljs-comment">//unsigned long runTime1; //     Arduino, </span>
unsigned <span class="hljs-keyword">long</span> runTime2;
<span class="hljs-keyword">int</span> current = <span class="hljs-number">20800</span>;<span class="hljs-comment">// -    </span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> newZeroPoint = <span class="hljs-literal">true</span>; <span class="hljs-comment">//  ,      ,    .</span><font></font>
<font></font>
<span class="hljs-keyword">char</span> auth[] = <span class="hljs-string">""</span>;
<span class="hljs-keyword">char</span> ssid[] = <span class="hljs-string">""</span>;
<span class="hljs-keyword">char</span> pass[] = <span class="hljs-string">""</span>;<font></font>
   <font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span>(<span class="hljs-params"></span>)</span> {<font></font>
 Serial.begin(<span class="hljs-number">9600</span>);<font></font>
  Blynk.begin(auth, ssid, pass);<font></font>
  <font></font>
  pinMode(buttonPin, INPUT);<font></font>
  pinMode(motor1, OUTPUT);<font></font>
  pinMode(motor2, OUTPUT);<font></font>
  pinMode(motor3, OUTPUT);<font></font>
  pinMode(motor4, OUTPUT);<font></font>
  <font></font>
<font></font>
  ArduinoOTA.setHostname(<span class="hljs-string">"ESP8266-00002"</span>); <span class="hljs-comment">//OTA    </span>
  <span class="hljs-comment">//ArduinoOTA.setPassword((const char *)"0000"); //OTA      </span>
  ArduinoOTA.begin(); <span class="hljs-comment">//OTA  OTA</span><font></font>
        <font></font>
 Stepper1.setMaxSpeed(<span class="hljs-number">200</span>);     <span class="hljs-comment">//      (/)</span>
Stepper1.setAcceleration(<span class="hljs-number">180</span>); <span class="hljs-comment">//  (/^2)</span><font></font>
  <font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ZeroPoint</span>(<span class="hljs-params"></span>)</span>{
  <span class="hljs-keyword">if</span> (newZeroPoint)
  <span class="hljs-comment">//   .</span>
        <span class="hljs-keyword">if</span> (digitalRead(buttonPin)) <font></font>
      {<font></font>
          <span class="hljs-comment">//   ,       .</span>
          Stepper1.setCurrentPosition(<span class="hljs-number">0</span>);<font></font>
          newZeroPoint = <span class="hljs-literal">false</span>;
          <span class="hljs-comment">//Serial.println("true");</span>
      } <span class="hljs-keyword">else</span><font></font>
      {<font></font>
        <span class="hljs-comment">//     ,       .</span>
        <span class="hljs-keyword">if</span> (Stepper1.distanceToGo() == <span class="hljs-number">0</span>) {Stepper1.moveTo(Stepper1.currentPosition() + <span class="hljs-number">1000</span>);}<font></font>
        Stepper1.run();<font></font>
        <span class="hljs-comment">//Serial.println("false");</span><font></font>
      }<font></font>
  }<font></font>
 BLYNK_WRITE(V0)<font></font>
{<font></font>
  <span class="hljs-keyword">int</span> button = param.asInt(); <span class="hljs-comment">// read button  </span>
  <span class="hljs-keyword">if</span> (button == <span class="hljs-number">1</span>){ Stepper1.move(-Stepper1.currentPosition());}  <font></font>
}   <font></font>
      <font></font>
BLYNK_WRITE(V1)<font></font>
{<font></font>
  <span class="hljs-keyword">int</span> button = param.asInt(); <span class="hljs-comment">// read button  </span>
  <span class="hljs-keyword">if</span> (button == <span class="hljs-number">1</span>){<font></font>
    <font></font>
 Stepper1.moveTo(-current);<font></font>
 Stepper1.run();<font></font>
 } <font></font>
}<font></font>
BLYNK_WRITE(V2)<font></font>
{<font></font>
  <span class="hljs-keyword">int</span> button = param.asInt(); <span class="hljs-comment">// read button  </span>
  <span class="hljs-keyword">if</span> (button == <span class="hljs-number">1</span>){<font></font>
  Stepper1.stop();}<font></font>
 } <font></font>
     <font></font>
 <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Out</span>(<span class="hljs-params"></span>)<span class="hljs-comment">//             </span></span><font></font>
 {<font></font>
  <span class="hljs-keyword">if</span> (Stepper1.run())<font></font>
  runTime2 = millis(); <font></font>
  <span class="hljs-keyword">if</span> (millis() - runTime2 &gt; <span class="hljs-number">5000</span>) <font></font>
  {runTime2 = millis();<font></font>
  digitalWrite (<span class="hljs-number">5</span>, LOW);<font></font>
  digitalWrite (<span class="hljs-number">4</span>, LOW);<font></font>
  digitalWrite (<span class="hljs-number">0</span>, LOW);<font></font>
  digitalWrite (<span class="hljs-number">2</span>, LOW);<font></font>
    }<font></font>
}<font></font>
 <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
  Blynk.run();<font></font>
 Stepper1.run();<font></font>
    ZeroPoint(); <font></font>
    Out();<font></font>
    ArduinoOTA.handle();       <font></font>
   <font></font>
}</code></pre></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr494718/index.html">Nouvelles du monde d'OpenStreetMap n ° 504 (10.03.2020-16.03.2020)</a></li>
<li><a href="../fr494720/index.html">Ma feuille de triche par pandas</a></li>
<li><a href="../fr494722/index.html">La première version d'aperçu de Microsoft PowerShell 7.1 pour Windows, Linux et macOS</a></li>
<li><a href="../fr494724/index.html">ADAM-6700 - Module de communication d'objets Linux universel</a></li>
<li><a href="../fr494726/index.html">Exploitation du thème du coronavirus dans les menaces SI</a></li>
<li><a href="../fr494730/index.html">Entretien avec Amusa Buminasan</a></li>
<li><a href="../fr494732/index.html">Le responsable de la bibliothèque JS la plus populaire a été condamné à une peine d'emprisonnement pour un accident mortel en raison de sa faute</a></li>
<li><a href="../fr494736/index.html">Ce que le blog de l'éditeur raconte sur les tendances de la communauté informatique</a></li>
<li><a href="../fr494738/index.html">Ansible n'est pas pour vous. Sergey Pechenko</a></li>
<li><a href="../fr494748/index.html">Montre DOOM sur ESP32. Partie 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>