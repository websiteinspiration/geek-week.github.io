<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💠 ☺️ 🐃 La journalisation et le suivi des requêtes sont les meilleures pratiques. Rapport Yandex 🎣 📮 🤴🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Yandex.Market a une grande architecture de microservices. La demande de navigateur de la page principale du marché donne lieu à des dizaines de demand...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>La journalisation et le suivi des requêtes sont les meilleures pratiques. Rapport Yandex</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/489048/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yandex.Market a une grande architecture de microservices. </font><font style="vertical-align: inherit;">La demande de navigateur de la page principale du marché donne lieu à des dizaines de demandes intégrées dans différents services (backends) qui sont développées par différentes personnes. </font><font style="vertical-align: inherit;">Dans un tel système, il peut être difficile de comprendre pour quelle raison la demande est tombée ou a pris beaucoup de temps à traiter.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/_l1qP0DyBcA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anatoly Ostrovsky </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">megatolya</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">explique comment son équipe a résolu ce problème et partage des pratiques spécifiques au marché, mais généralement pertinentes pour tout excellent service. Son rapport est basé sur sa propre expérience de déploiement d'un nouveau marché dans un temps assez court. Pendant plusieurs années, Tolya a dirigé l'équipe de développement d'interfaces sur le marché, et maintenant il s'est orienté vers les véhicules sans pilote.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Tous nos marchés sont construits selon des principes généraux. Il s'agit d'un grand système unique. Mais si nous parlons de l'interface, du point de vue de l'utilisateur, les applications sont complètement différentes. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xf/cx/bk/xfcxbk6d4xsoxdb3l7clfzw5yza.jpeg"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le même temps, nos frontends vont à de nombreux backends. Parfois, ces backends sont similaires les uns aux autres (différentes instances de la même application). Et parfois, ils sont uniques au service (facturation spéciale). La structure d'un tel système peut être considérée comme une architecture de microservice classique. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a toujours un problème dans un grand service - il est difficile de comprendre ce qui s'y passe exactement. Ou, par exemple, ce qui se passe au moment où une erreur de paiement se produit avec l'utilisateur. Supposons que cela se soit passé chez lui hier, et aujourd'hui, nous devons comprendre ce qui s'est passé.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/b3/nz/p2/b3nzp2buowpixe2wnv1-r-ymj7m.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le backend 2 peut «graver» soit pour un produit spécifique, soit à un moment précis, soit pour des utilisateurs spécifiques. Nous devons être en mesure de répondre à toutes les situations. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pv/wu/-w/pvwu-wguspmalhce4hxtbvhqznu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons de nombreux backends et, comme je l'ai dit, ils peuvent marcher seuls. Si cela est présenté sous la forme d'un graphique, cela se révélera plutôt déroutant. Dans la vraie vie, il peut y avoir des centaines de microservices. Imaginez combien de connexions il y aura entre eux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a plusieurs étapes pour plonger dans ce sujet. Je vais parler brièvement de chacun d'eux.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qu/nf/hq/qunfhq8cdqgbtqtmikv0maf1tpc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, convenez avec vos collègues du backend d'un système de marquage de demande commun - il est plus facile de les trouver plus tard. </font><font style="vertical-align: inherit;">Ensuite, vous devez pouvoir reproduire rapidement le problème. </font><font style="vertical-align: inherit;">Supposons qu'une erreur de paiement se soit produite - essayez de comprendre rapidement comment elle s'est produite et dans quel backend. </font><font style="vertical-align: inherit;">Stockez les journaux non seulement dans des fichiers, mais également dans la base de données afin de pouvoir effectuer des agrégations. </font><font style="vertical-align: inherit;">Et, bien sûr, une partie importante du processus concerne les graphiques et la surveillance. </font><font style="vertical-align: inherit;">Ensuite, dans l'ordre.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Système d'identification des demandes unifié</font></font></h2><br>
<img src="https://habrastorage.org/webt/1z/lc/cl/1zlccllwyct_nesu28sa4kh0za0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est l'un des outils les plus simples pour comprendre ce qui se passe avec le service. Convenez avec vos collègues que, par exemple, votre frontend génère une sorte de demande d'identification (la variable requestId dans l'image), puis la jette dans tous les endopoints des backends. Et le backend lui-même ne réinvente rien. Il prend le requestId qui est arrivé et le transmet plus loin dans les requêtes à ses backends. En même temps, il peut spécifier son préfixe, de sorte que parmi le requestId identique, il serait possible de trouver ce backend particulier. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oh/qo/sk/ohqoskth2c-8o9h2btju58-tg04.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, lorsque vous avalez vos journaux, puis, en vous assurant que vos journaux indiquent, par exemple, que le backend est de cinq cents, il peut y avoir deux options. Vous allez soit donner cet identifiant de demande à vos collègues et ils le regarderont dans leurs journaux, ou vous verrez par vous-même.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pq/cf/1m/pqcf1m-t3srhcoorgfwnnpohbqg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tous nos journaux sont marqués avec un tel identifiant afin non seulement de comprendre ce qui s'est passé et à quel moment, mais aussi de garder le contexte de cette demande. </font><font style="vertical-align: inherit;">Il est asynchrone, il peut par la suite ajouter quelque chose au journal. </font><font style="vertical-align: inherit;">Et si vous mordez à la demande, rien de bon n'en sortira.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">boucle</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour reproduire le problème, nous utilisons l'utilitaire cURL. Il s'agit d'un utilitaire de console qui effectue des requêtes réseau - http et https. cURL prend en charge de nombreux autres protocoles, mais lors du développement Web, il est plus facile de supposer qu'il s'agit d'un outil pour travailler avec les requêtes http. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/75/mr/uh/75mruhc0hnm0q7qtllafjtnz8ak.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour vous familiariser avec l'équipe cURL, vous pouvez vous rendre sur n'importe quel site, puis aller sur Réseau et copier toute demande sous forme de cURL. Le résultat est une si grande ligne: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jl/mn/fx/jlmnfxdobmhcqctl-uviygpzij8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
si vous essayez de le comprendre, alors il n'y a rien à craindre. Essayons de le démonter. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/j5/88/xz/j588xz0r-jh48xp1rphfqoljlvk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici une demande à market.yandex.ru. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gv/6v/_d/gv6v_dz188tviqfjs5siyf9lt8e.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un User-Agent a été ajouté ici, ce qui prend déjà beaucoup de place.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1j/a_/sd/1ja_sdx_in4dcwudr64xjdezf98.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, le reste est constitué de cookies. Il y en a beaucoup dans le code Yandex. Sous forme sérialisée, ils ont un look très redoutable. En fait, il n'y a rien d'autre à part eux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À quoi sert cURL? Si vous l'avez copié sur vous-même et l'avez exécuté, vous avez vu la même page market.yandex.ru que moi - seul l'ordinateur sur lequel il s'exécutait serait différent. Bien sûr, certains effets secondaires pourraient donner des différences dans les adresses IP, mais en général, ce seraient les mêmes demandes. Nous reproduirions le même scénario. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lh/gd/sg/lhgdsguqkolxs1vrjusxnshjnmg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de ne pas inventer de telles requêtes cURL à chaque fois, vous pouvez utiliser le format-curl npm-package.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yj/in/fk/yjinfkjpv0bgzbhfmi8shr7qyno.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il prend tous les paramètres de requête que la fonction prend habituellement - c'est-à-dire, dans ce cas, uniquement les en-têtes et l'URL. </font><font style="vertical-align: inherit;">Mais il sait aussi interroger, corps, etc. Et la sortie est juste une chaîne avec une requête cURL. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xx/4l/h8/xx4lh8tvvwmvzw1-aflbg7ophvq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par conséquent, tous nos journaux dans l'environnement de développement contiennent également des demandes cURL. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wu/iq/f6/wuiqf6p5bzxdgiom430q364yuw4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons même enregistré les demandes cURL de backend directement dans le navigateur pour voir immédiatement comment nous allons à nos backends sans regarder la console du navigateur. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/0o/l3/ay/0ol3ay03w7toau9tyabduyiu1-m.jpeg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Veuillez noter que les demandes cURL impliquent le transfert de cookies de session - c'est mauvais. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous m'avez rejeté votre demande cURL sur market.yandex.ru, je pourrais entrer dans votre marché et tout autre service Yandex sous votre identifiant. </font><font style="vertical-align: inherit;">Par conséquent, nous ne stockons ces demandes nulle part et nous les enregistrons uniquement dans des bancs de test pour nous-mêmes - ces données ne peuvent pas être divulguées.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clickhouse</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, je vais parler des journaux structurés. Ici, je garderai à l'esprit la base de données ClickHouse spécifique, mais vous pouvez en choisir une. ClickHouse est un SGBD en colonnes, il est plus pratique de sélectionner parmi une énorme quantité de données et de prendre de gros morceaux de données. C'est bien parce que vous pouvez y sauvegarder une grande partie du journal et ensuite, par exemple, faire une sorte d'agrégation d'un milliard d'enregistrements. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rx/yq/hx/rxyqhxvdpvjetfh9jmkw4hfkwvu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce cas, l'exemple de sélection ClickHouse est du SQL brut. Ici, nous montrons le nombre de demandes de codes d'état pour aujourd'hui. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oi/5v/je/oi5vje-sgh204x5-w1fjywdjyk8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conséquence, nous aurons 180 mille deux cent sept cinq cents, et les codes de statut restants, par exemple, ne nous intéressent pas. Mais comment pouvons-nous utiliser cela de façon intéressante?</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ed/r6/gp/edr6gpqetfffuhjo6uc2hwznb4s.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous pouvons dire que le rapport de deux cents au rapport du nombre total de réponses est l'indicateur de niveau de service, qui répond à la question de savoir comment notre application fonctionne en termes de codes de statut. Bien que simple, il parle déjà de quelque chose. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/y3/vr/vq/y3vrvqez5ghx9umed2htpzgeurm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur la base de notre indicateur, nous pouvons proposer le premier SLI, c'est-à-dire, par exemple, que 99% de nos demandes devraient être OK. Et ici, nous pouvons comparer que nous avons effectué notre SLI. S'ils ne l'avaient pas terminé, nous aurions pu essayer de distinguer soit certaines dernières demandes qui auraient été cinq cents, soit tout simplement des éléments critiques. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hf/0i/vf/hf0ivf6posnoebmrwayqz4wni5c.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, les erreurs de paiement sont critiques pour nous, mais dans ce cas, elles retourneront zéro - c'est une chance :) </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5c/0i/yh/5c0iyhrkfdxbgd0psywb7jvv8si.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment vous assurer que vos journaux sont sous cette forme pratique et peuvent être pris via SQL?</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7b/7m/hx/7b7mhxhtlyos6qbomnnm2p6xcko.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est un sujet pour un gros rapport séparé, et tout dépend de votre infrastructure. </font><font style="vertical-align: inherit;">Mais il semble qu'il y ait deux façons. </font><font style="vertical-align: inherit;">Premièrement: soumettez les métadonnées directement à l'exécution, directement à la base de données. </font><font style="vertical-align: inherit;">Nous le faisons différemment, dans la deuxième manière: nous suivons le fichier journal et soumettons des morceaux soit dans la base de données ou dans un endroit intermédiaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela fonctionne pour nous plutôt en plusieurs couches - nous envoyons des journaux d'une instance spécifique à un serveur de stockage distant de ces journaux.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Demande de trace</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il n'y a pas de concept de «traçage des requêtes». Ce terme a été inventé par Google. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/au/mc/cf/aumccfspkkp7eieqgesgk8awnn4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous recherchez sur Internet le «traçage des requêtes», vous verrez la commande traceroute. C'est peut-être similaire au suivi des requêtes. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/w0/no/pv/w0nopvgiuihtlc2x8b7fdist7lm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a même un programme console, et ici je l'ai exécuté pour le site bringly.ru (un service que nous avons développé au printemps dernier). Cela aide à comprendre quel type de machines et de serveurs la requête traverse avant d'arriver à l'équilibreur, qui répondra soit par la mise en page, soit par autre chose. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9g/n9/ax/9gn9axljm2rabdxvowa3p8gsjec.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici notre équilibreur. Par traçage de requêtes, nous ne voulons pas dire cela, mais tout ce qui se passe à l'intérieur de notre équilibreur - comment la demande se déroule plus loin dans notre application node.js.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fh/rh/rr/fhrhrr6j0ujdnvdivmn0dwobnlc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous voyons cela sous la forme d'une chronologie, où l'heure horizontale est affichée, et la séquence verticale des demandes. Dans ce cas, nous avons une demande à la fiche produit, où l'on peut voir qu'il s'agit d'une demande au backend de notre autorisation. Après sa décision, trois longues files d'attente sont allées - il s'agit d'une demande à notre backend principal pour un panier, une carte de produit et des produits similaires. Nous avons donc une trace. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/m8/sl/4a/m8sl4atplnknyq_5wefl8b2wgw0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, vous voyez la même demande d'autorisation, puis le backend est parti. Dans ce cas, le backend ne se comporte pas de manière très optimale, car il a de nombreuses requêtes consécutives sur sa base de données. Probablement, une telle requête pourrait être optimisée.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ru/ah/bz/ruahbzfg8qzvgzi1s2gbexvm0og.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et voici un exemple de trace, lorsque nous ne sommes allés dans aucun backend, mais avons immédiatement donné le statut 500. Comment une telle trace nous est-elle utile? </font><font style="vertical-align: inherit;">Nous n'avons pas à déranger nos collègues. </font><font style="vertical-align: inherit;">Nous avons l'identifiant de cette demande, nous pouvons donc regarder nous-mêmes dans les journaux et comprendre ce qui se passe. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wq/nm/0g/wqnm0gw9rgznoe7rswqshty_u1a.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici la situation inverse. </font><font style="vertical-align: inherit;">Backend a dit que quelque chose n'allait pas et a en même temps écrit dans les méta-informations ce qui s'est exactement passé - une sorte de trace de pile est apparue. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uc/lb/ck/uclbck5ju2ri2l2qyhjxkwnvxpk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment se faire le même outil? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La chose la plus importante ici est la base de données. </font><font style="vertical-align: inherit;">Si vous avez le plus simple «INSERT INTO» dans la base de données de certaines actions avec le service, plus tard, vous pouvez au moins utiliser SQL pour trouver les événements nécessaires. </font><font style="vertical-align: inherit;">Et si nécessaire, vous pouvez créer une interface pour cela.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Graphiques</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est un sujet très intéressant, je ne m'y attarderai pas en détail aujourd'hui, bien sûr, :) </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mo/tc/5p/motc5p8irltrzn7aqlsffemkdza.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parlons de la journalisation. </font><font style="vertical-align: inherit;">Nous avons beaucoup de graphiques, nous les regardons lorsque nous déployons quelque chose - et dans les temps, il y a un tel bruit. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lo/vn/ku/lovnkuij1s2d39nszmdwvwsde78.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les graphiques aident à voir visuellement que quelque chose ne va pas. </font><font style="vertical-align: inherit;">Et puis vous devez toujours regarder les journaux et comprendre ce qui ne va pas avec eux. </font><font style="vertical-align: inherit;">Dans ce cas, la montée subite immédiatement après la libération signifie au moins qu'une telle libération doit être annulée immédiatement.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">surveillance</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une partie encore plus importante et un degré plus élevé d'immersion dans ce sujet est la surveillance. Par surveillance, je comprends, d'une part, la surveillance automatique des graphiques et, d'autre part, les règles automatisées de surveillance de quelque chose. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wn/1f/r9/wn1fr9r0fnzl-r4kbkgbj3pwz6w.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous surveillons le rapport de cinq cents au nombre total de réponses par minute. Nous surveillons également quatre cents, la présence d'une charge sur le service, en vérifiant le bouton de contrôle de santé, qui tire le bouton ping de chacun des backends, etc.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j0/be/ts/j0betsujurv192dkwhrvk_cvegk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, nous avons des tableaux de bord de surveillance que nous incluons sur les écrans à proximité des postes de travail. </font><font style="vertical-align: inherit;">On voit donc immédiatement lequel de la surveillance "rougir". </font><font style="vertical-align: inherit;">Par exemple, ici c'est l'un des principaux, où le frontend et notre backend principal sont visibles. </font><font style="vertical-align: inherit;">Ici, vous pouvez voir que certains contrôles s'allument sur le backend. </font><font style="vertical-align: inherit;">Cela signifie qu'à ce moment, la personne responsable de ce service recevra un message sur Telegram, ou peut-être même l'appellera - cela dépend des paramètres de surveillance.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sommaire</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un seul requestId vous aidera à trouver plus facilement les problèmes dans un service composé de plusieurs applications. </font><font style="vertical-align: inherit;">La cURL correcte vous permettra de reproduire plus précisément les problèmes et de voir comment vous-même, par exemple, envoyer des données au backend. </font><font style="vertical-align: inherit;">Les journaux structurés vous permettront de créer SLI, et ils sont plus pratiques à utiliser que les journaux de texte standard. </font><font style="vertical-align: inherit;">Et n'oubliez pas de suivre les graphiques et d'effectuer un suivi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je recommande de lire </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le livre</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Site Reliability Engineering de Google si vous êtes intéressé par les infrastructures.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr489038/index.html">Le livre "Java Concurrency in Practice"</a></li>
<li><a href="../fr489040/index.html">Contact Center AI: un tiers dans une conversation est très bien</a></li>
<li><a href="../fr489042/index.html">Grande réouverture de la boutique: chargement de données dans Android à l'aide de coroutine</a></li>
<li><a href="../fr489044/index.html">Physique du texte. Partie 1. Symboles</a></li>
<li><a href="../fr489046/index.html">GAZ66 Monster Truck sans conducteur 1/16</a></li>
<li><a href="../fr489050/index.html">Windows vs Sysmon</a></li>
<li><a href="../fr489058/index.html">Ensembles de réseaux de neurones avec PyTorch et Sklearn</a></li>
<li><a href="../fr489060/index.html">Analyse: quelle est la différence entre les investissements à haut risque et les investissements à faible risque</a></li>
<li><a href="../fr489062/index.html">Incroyable performances parallèles d'E / S Apache Parquet en Python</a></li>
<li><a href="../fr489068/index.html">Immortalité numérique - une approche d'ingénierie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>