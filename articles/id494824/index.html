<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸŠ â—ï¸ ğŸ¯ Bagaimana sistem konten halaman Turbo diatur: skema, fakta, dan sedikit sejarah ğŸ‘‘ âš—ï¸ ğŸ™†ğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Menurut TelecomDaily , hampir 30% pengguna Internet seluler di Rusia setiap hari mengalami masalah mengunduh situs. Namun, alasannya mungkin tidak han...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Bagaimana sistem konten halaman Turbo diatur: skema, fakta, dan sedikit sejarah</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/494824/"><img src="https://habrastorage.org/webt/hq/a5/mv/hqa5mvtylx0m3ns_yixifxt1qw8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menurut </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TelecomDaily</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , hampir 30% pengguna Internet seluler di Rusia setiap hari mengalami masalah mengunduh situs. Namun, alasannya mungkin tidak hanya dalam cakupan tidak merata, tetapi juga terlalu banyak "berat" halaman. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami tidak dapat mempengaruhi kualitas koneksi, tetapi untuk membantu webmaster menyederhanakan konten situs, membuatnya lebih mudah - mengapa tidak? Jadi, teknologi halaman Turbo muncul di Yandex: sistem konten kami melewati semua yang diperlukan untuk penempatan, dan itu mengubah data ini menjadi bahan yang mudah dan cepat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagaimana cara kerja sihir ini? Apa jalur data sebelum menjadi halaman Turbo penuh? Nama saya Stas Makeev, saya memimpin pengembangan halaman teknologi Turbo. Sekarang saya akan mencoba menjelaskan semuanya.</font></font><br>
 <a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tapi pertama-tama, ini sedikit ringkasan sehingga Anda tidak tersesat ketika saya mulai mempelajari detailnya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Keuntungan utama sistem halaman Turbo adalah konversi data yang cepat dari bentuk aslinya ke bentuk akhir: bahan situs berita paling diminati pada menit-menit pertama setelah publikasi, dan kartu barang toko online harus segera diperbarui dan selalu sesuai dengan status ketersediaan saat ini. Parameter penting kedua adalah keandalan: sistem konten harus se-stabil mungkin, mampu bertahan dari gangguan server individual atau bahkan seluruh pusat data. Dan, tentu saja, penting untuk mencegah beban berlebih pada host mitra kami yang terhubung ke halaman Turbo. Artinya, ketika merancang layanan, perlu entah bagaimana menemukan keseimbangan antara kecepatan pemrosesan data dan peningkatan jumlah permintaan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pemilik situs memiliki beberapa cara untuk terhubung ke sistem:</font></font><br>
<br>
<ul>
<li>  . : YML â€”  -, RSS â€“   ;</li>
<li>   API:          (    );</li>
<li> : -       .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sistem konten menyimpan hasil kerjanya dalam penyimpanan khusus tipe "nilai kunci" (penyimpanan nilai kunci atau penyimpanan KV), di mana kuncinya adalah URL dari situs asli, dan nilai menyimpan konten halaman Turbo. </font><font style="vertical-align: inherit;">Segera setelah data memasuki penyimpanan KV ini, halaman Turbo berikutnya segera tersedia untuk pencarian pengguna, dan dalam layanan Yandex dokumen yang sesuai memiliki ikon khusus dengan roket. </font><font style="vertical-align: inherit;">Juga, untuk mempercepat pekerjaan, kami menyimpan gambar dan video dalam CDN kami. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skema kerja umum yang sangat sederhana terlihat seperti ini:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ao/mq/u5/aomqu5polx3u8fse71spyit1eam.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagaimana semua ini dimulai</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Versi pertama dari sistem konten disusun dengan cukup sederhana: setiap beberapa menit, sesuai jadwal, program yang sama diluncurkan pada server cloud internal Yandex. </font><font style="vertical-align: inherit;">Itu terdiri dari beberapa langkah, masing-masing dijalankan berikutnya setelah data sebelumnya siap untuk semua umpan yang kita tahu:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daftar umpan RSS telah diunduh, parser dokumen diluncurkan;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">daftar gambar diekstraksi dari hasil parser;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gambar belum di-cache dimuat ke CDN;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dokumen yang diproses dituangkan ke dalam repositori KV.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skema semacam itu bekerja dengan sempurna ketika sistem menangani beberapa ribu umpan RSS agak ringan dari kantor berita (secara keseluruhan - informasi tentang kurang dari 100.000 dokumen). Tetapi dengan meningkatnya jumlah feed, masalah dengan cepat ditemukan: setiap langkah membutuhkan waktu yang semakin lama, penundaan antara tampilan dokumen baru di sumber asli dan tampilan dalam mode Turbo meningkat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami berhasil mengendalikan situasi dengan bantuan berbagai trik: pertama-tama, kami memilih langkah pertama (mengunduh RSS feed + parser dokumen) ke dalam proses terpisah. Yaitu, ketika satu sedang memproses gambar untuk iterasi sebelumnya, proses lainnya sudah mengunduh feed untuk yang berikutnya. Setelah beberapa waktu, menjadi jelas: dalam bentuk ini, sistem ini sangat sulit untuk diukur. Kami membutuhkan sesuatu yang pada dasarnya baru.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memproses RSS, API, dan YML dalam sistem konten baru</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Masalah utama dari sistem konten lama adalah bahwa semua data diproses dalam satu bagian: tidak ada transisi ke langkah berikutnya sampai setiap dokumen melewati yang sebelumnya. </font><font style="vertical-align: inherit;">Untuk menghilangkannya, diputuskan untuk membangun saluran pipa tertentu: biarkan umpan dan dokumen individual diproses sebebas mungkin. </font><font style="vertical-align: inherit;">Semua langkah dipisahkan menjadi kubus layanan terpisah - di tingkat atas, skema berubah menjadi seperti ini:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/g6/lp/xd/g6lpxdauqtwxm9alh-mrgyf_wro.png"><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kubus pertama mengunduh umpan RSS dan meneruskannya;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang kedua - mengambil feed satu per satu, mem-parsing isinya. </font><font style="vertical-align: inherit;">Di pintu keluar - pisahkan dokumen;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang ketiga - mengambil dokumen satu per satu, memproses gambar dan video, merekam semua yang ada di penyimpanan KV.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Umpan yang sama dapat didaftarkan tidak hanya di Turbo, tetapi juga di layanan kami yang lain - di Berita atau di Pasar, misalnya. Jika masing-masing dari mereka mengunduh data sendiri, beban pada server webmaster akan beberapa kali lebih tinggi daripada yang diizinkan. Bagaimana benar? Unduh umpan satu kali, dan kemudian distribusikan konten ke semua layanan konsumen - Yandex.Robot melakukan ini. Kami menggunakan layanannya untuk mengunduh konten: kami mengambil dari Yandex.Webmaster daftar RSS dan YML feed terdaftar di Turbo, transfer ke Robot dan berlangganan hasil unduhan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada data yang diterima, mulai parser. Untuk jaga-jaga, izinkan saya mengingatkan Anda: umpan RSS hanyalah sebuah file dalam format ".XML", dapat diakses oleh URL statis di host mitra. File ini berisi informasi tentang semua pembaruan di situs - dokumen mana yang baru, yang diubah. Hanya informasi paling mutakhir dalam beberapa jam terakhir adalah umpan ideal: tidak lebih dari 100 dokumen per beberapa ratus kilobyte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gigitan realitas: terkadang file ada di dalam umpan untuk waktu yang sangat lama dan tidak pernah berubah. Bagaimana menghindari pemrosesan ulang dalam kasus seperti itu? Kami menghitung hash dari setiap dokumen, menyimpannya di database, dan tidak melakukan apa pun hingga hash berubah.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Memproses umpan YML dan API dari sudut pandang sistem konten praktis tidak berbeda dari berinteraksi dengan RSS: untuk YML, kami memulai parser lain, dan data yang dikirimkan melalui API diperoleh langsung dari Yandex.Webmaster.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/re/hh/gz/rehhgz4wtfo8nqylaexh74z5dga.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pemrosesan gambar dan video</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dokumen yang diterima pada output parser hampir siap untuk ditulis ke penyimpanan KV. </font><font style="vertical-align: inherit;">Satu-satunya hal yang harus dilakukan sebelum mengirim adalah untuk memproses gambar dan video: cache di CDN dan ganti tautan dalam dokumen. </font><font style="vertical-align: inherit;">Di sini kita kembali ke Robot untuk bantuan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama-tama, kami memeriksa setiap gambar dan video: apakah mereka ada di CDN? </font><font style="vertical-align: inherit;">Jika semuanya sudah di-cache, ganti tautan dan kirim dokumen yang diperbarui ke repositori KV. </font><font style="vertical-align: inherit;">Jika tidak:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kami mengirim daftar URL yang hilang ke Robot untuk perencanaan dan pengunduhan;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dokumen itu sendiri dalam penyimpanan sementara, jadi setelah beberapa saat coba periksa lagi.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kubus lain saat ini menerima hasil unduhan, mengunggah data ke CDN dan memperbarui basis data. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam skema seperti itu, masalah penting lain yang berkaitan dengan perencanaan dapat diselesaikan: robot memahami seberapa cepat mungkin untuk mengunduh data dari host yang berbeda, dan tidak memungkinkan kelebihan beban. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2n/g4/oz/2ng4oz6c5ocn3jjbld4armtcewk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lintasan khas yang diikuti oleh dokumen baru:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokumen muncul di umpan.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Robot mengunduh feed;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parser menemukan dokumen baru dan mengirimkannya lebih lanjut;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kami memeriksa bahwa gambar-gambar dari dokumen tidak disebutkan dalam database, memesan unduhan, dokumen dikirim ke penyimpanan sementara (Penundaan). </font><font style="vertical-align: inherit;">Sementara dokumen ada di sana, Robot mengunduh gambar, mereka di-cache di CDN, dan tautan muncul di database;</font></font></li>
<li>       ,    CDN,      KV-. </li>
<li> :    ,       Delay.</li>
</ul><br>
<h3></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada cara lain untuk terhubung ke halaman Turbo, yang webmaster tidak perlu melakukan apa pun - Autoparser. </font><font style="vertical-align: inherit;">Itu membangun halaman Turbo berdasarkan sumber data dari situs konten. </font><font style="vertical-align: inherit;">Anda dapat terhubung, melihat contoh halaman jadi, mengkonfigurasi iklan dan analitik di Yandex.Webmaster. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kesulitan utama yang dihadapi AutoParser adalah untuk mengenali dengan markup HTML informasi dasar apa yang harus digunakan ketika membangun halaman Turbo. </font><font style="vertical-align: inherit;">Untuk melakukan ini, kami memiliki beberapa proses offline yang mencoba memahami dengan tepat cara mem-parsing host tertentu. </font><font style="vertical-align: inherit;">Saya akan fokus pada dua yang utama:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pertama</font></font></b>     RSS-    HTML-  .  â€”    ,       RSS- (    ),   .   ,    .        CatBoost  ,   ,      .     ,          , , .  ,          .  ,     ,  ,        HTML     . ?  :     .  â€“    ,    .</li>
<li><b></b>   :            ..  ,    ,   ,          ,   â€”  .       â€”   .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ngomong-ngomong, satu lagi kendala sering - banyak situs memblokir kemampuan untuk mengunduh gambar dengan robot di robots.txt. Sayangnya, tidak mungkin untuk mengatasi masalah ini, dan Autoparser tidak tersedia untuk halaman tersebut. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Akibatnya, skema lengkap sistem konten terlihat seperti ini: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ll/jx/-a/lljx-adtt8ykngcnfnutykobxr4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sistem ini ternyata dapat diskalakan dengan baik: sekarang sejumlah besar sumber daya digunakan untuk melayani basis data, autoparser, dan komponen lain dari sistem (hanya kubus yang bertanggung jawab untuk penguraian RSS, YML dan API menggunakan lebih dari 300 prosesor core), dan dalam hal peningkatan beban tidak akan terlalu sulit untuk menghubungkan kapasitas tambahan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terima kasih sudah membaca sampai akhir! Saya harap, setelah materi ini, dalam karya halaman Turbo Anda akan mendapatkan lebih banyak logika dan lebih sedikit sihir (omong-omong, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">di sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- bahkan lebih detail tentang halaman Turbo). </font><font style="vertical-align: inherit;">Jika ada sesuatu yang masih tidak dapat dipahami, tulis di komentar - kami masih berhubungan.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id494808/index.html">Analis produk: apa fungsinya, berapa banyak yang ia hasilkan, apa manfaat yang dihasilkan bisnis</a></li>
<li><a href="../id494810/index.html">Pengantar 3D: Dasar-Dasar Three.js</a></li>
<li><a href="../id494814/index.html">Apakah Slurm bermanfaat?</a></li>
<li><a href="../id494818/index.html">Cara memilih terminal perdagangan untuk bekerja di bursa</a></li>
<li><a href="../id494820/index.html">Bagaimana Spesifikasi Catu Daya Intel ATX12VO Akan Mengubah Masa Depan</a></li>
<li><a href="../id494826/index.html">Menjadi "baru" atau tidak menjadi ...</a></li>
<li><a href="../id494830/index.html">ViennaNET: satu set perpustakaan untuk backend</a></li>
<li><a href="../id494838/index.html">Modem GSM / 3G / 4G dalam sistem tertanam menggunakan modem Quectel EC21 LTE dan Proyek Yocto sebagai contoh</a></li>
<li><a href="../id494848/index.html">15 wanita yang telah memberikan kontribusi besar untuk astronomi</a></li>
<li><a href="../id494850/index.html">Konfigurasikan Microsoft Windows Server 2016/2019 untuk menyediakan layanan DHCP untuk VXLAN (DFA)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>