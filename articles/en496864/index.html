<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍👨‍👧‍👦 🧗🏽 🍾 Audit Wallets in CryptoNote 🎸 👨🏽‍🚀 ↪️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="An audit of a cryptocurrency wallet is an opportunity for a third party (the “auditor”) to see the transactions of this wallet and calculate its corre...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Audit Wallets in CryptoNote</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/496864/"><img src="https://habrastorage.org/webt/ho/f8/ke/hof8key466f4lng25pcqotu0soo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An audit of a cryptocurrency wallet is an opportunity for a third party (the “auditor”) to see the transactions of this wallet and calculate its correct current balance without the right to spend money. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The article discusses various ways of providing such an opportunity in the cryptocurrency protocol CryptoNote 2.0 [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ], where the audit is only partially implemented: using a tracking key, you can recognize incoming transactions, but to recognize outgoing transactions you need a full set of keys. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The material is intended for readers who are familiar with the topic of blockchain and “classic” cryptocurrencies, as well as with the basics of cryptography on elliptic curves.</font></font><br>
<a name="habracut"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Content</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">1. </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">2.       </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">3.       CryptoNote</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">4.  1/3. Bytecoin Auditable Coins</a><br>
  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">4.1. tx.version &lt; amethyst, legacy address</a><br>
  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">4.2. tx.version ≥ amethyst</a><br>
  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">4.3. tx.version ≥ amethyst, legacy address</a><br>
  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">4.4. tx.version ≥ amethyst, amethyst address</a><br>
  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">4.5.    CryptoNote  Bytecoin Amethyst</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">5.  2/3.    CryptoNote  Anton Sokolov</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">6.  3/3.      </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">7. </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="></a><br>
<br>
<br>
<a name="a1"></a><h1>1. </h1><br>
<h3>  CryptoNote?</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oddly enough, most of those interested in blockchain technology have not heard anything about CryptoNote, and this despite the fact that this technology has become the basis for more than 300 forks, the most famous of which is Monero. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In 2014, mentions appeared in the cryptocurrency environment [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">] about a project called Bytecoin. The project was not a fork of Bitcoin or another open source project and had a completely new code base, which was extremely unusual for that time. Its main concept was to implement a privacy technology called CryptoNote. Privacy was provided by two mechanisms: stealth addresses and mixing of inputs using a ring signature (it was also called at that time “mixer on the blockchain”). Since at that time Zcash existed only in theory, the technology turned out to be very competitive and caused a great resonance in the cryptocurrency community.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Soon, a group of enthusiasts who showed interest in one of the first forks of this technology, and then seized the initiative in this fork, with their energetic actions managed to attract the greatest attention to technology both among the community and among investors. </font><font style="vertical-align: inherit;">This fork was called BitMonero [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ], but pretty soon it was renamed Monero. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the future, both projects - Bytecoin and Monero - developed in technologically different ways: if Bytecoin remained a closed anonymous project, then Monero turned into a large community-driven project with a very large number of participants and developers. </font><font style="vertical-align: inherit;">However, they are both a development of CryptoNote technology.</font></font><br>
<br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The concept of audit and its application</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unlike the classic “pseudonymous” blockchain such as Bitcoin, in which anyone, by scanning the blockchain, can trivially calculate the balances of any address, in a private blockchain, in particular in CryptoNote, this task is hardly feasible without additional knowledge. Firstly, thanks to the technology of stealth addresses, there are no references to any addresses in the blockchain (this property is usually referred to as </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">anonymity</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Secondly, due to the fact that due to the ring signature, the transaction input does not indicate one specific output of the parent transaction, but rather, in general, indicates many possible outputs, it is also not possible to track the movement of funds (this property is called </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untraceability</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the traditional understanding of private cryptocurrency, these properties are necessary, but there are special cases where the wallet owner may want to disclose the history of his transactions and the current wallet balance to a third party, while guaranteeing that it is impossible for a third party to spend money. This may be necessary, for example, to exchanges, for interaction with regulators or checking authorities. In addition, this may be important for various funds that would like to be able to be transparent to a specific group of individuals or to be fully public.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Speaking formally, an audit of wallets means an opportunity for a third party (“auditor”) to see the transactions of this wallet and calculate its correct current balance without transferring the right to spend funds. </font><font style="vertical-align: inherit;">In the original version of CryptoNote, audit was only partially implemented: using a tracking key, you can recognize incoming transactions, but to recognize outgoing transactions, you need a full set of keys.</font></font><br>
<br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">About the author and purpose of publication</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The author of this material is one of the main developers of the Zano project - a project based on CryptoNote, which has been developing for several years with the same hands that wrote the original technology code. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Our team is now considering adding a wallet audit to the project and conducting research on this topic in order to choose the best option. </font><font style="vertical-align: inherit;">The author wants to introduce the results of some of these studies to readers in this article.</font></font><br>
<br>
<br>
<a name="a2"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Basic information about cryptography on elliptic curves</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The CryptoNote protocol uses an elliptic curve from the ed25519 public key digital signature scheme [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recall the main parameters of this curve and give additional definitions.</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fixed a large prime </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">q</span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-4"><span class="MJXp-mn" id="MJXp-Span-5" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-6" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-7">255</span></span></span><span class="MJXp-mo" id="MJXp-Span-8" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-9">19</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.194ex" height="2.884ex" viewBox="0 -970.7 5680.7 1241.8" role="img" focusable="false" style="vertical-align: -0.63ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-71" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3D" x="738" y="0"></use><g transform="translate(1794,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-35" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-35" x="1001" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2212" x="3678" y="0"></use><g transform="translate(4679,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-39" x="500" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-1">q = 2^{255}-19</script>.<br>
         <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-10"><span class="MJXp-msubsup" id="MJXp-Span-11"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12" style="margin-right: 0.05em;">F</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-13" style="vertical-align: -0.4em;">q</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.483ex" height="2.634ex" viewBox="0 -755.5 1069.1 1134.2" role="img" focusable="false" style="vertical-align: -0.88ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-46" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-71" x="910" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2">F_q</script>    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-14"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.07ex" height="1.884ex" viewBox="0 -540.2 460.5 811.3" role="img" focusable="false" style="vertical-align: -0.63ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-71" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3">q</script>.</li>
<li>     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-16"><span class="MJXp-msubsup" id="MJXp-Span-17"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18" style="margin-right: 0.05em;">F</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-19" style="vertical-align: -0.4em;">q</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.483ex" height="2.634ex" viewBox="0 -755.5 1069.1 1134.2" role="img" focusable="false" style="vertical-align: -0.88ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-46" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-71" x="910" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4">F_q</script>,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-20"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21">E</span><span class="MJXp-mrow" id="MJXp-Span-22"><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-msubsup" id="MJXp-Span-24"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25" style="margin-right: 0.05em;">F</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-26" style="vertical-align: -0.4em;">q</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.421ex" height="2.759ex" viewBox="0 -809.3 2334.1 1188" role="img" focusable="false" style="vertical-align: -0.88ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-45" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2F" x="764" y="0"></use><g transform="translate(1265,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-46" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-71" x="910" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-5">E/F_q</script>:<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-27"><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-29"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-31" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-33"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-35" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-36" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-37">1</span><span class="MJXp-mo" id="MJXp-Span-38" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">d</span><span class="MJXp-msubsup" id="MJXp-Span-40"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-42" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-45" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.163ex" height="2.759ex" viewBox="0 -916.9 9542.4 1188" role="img" focusable="false" style="vertical-align: -0.63ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2212" x="0" y="0"></use><g transform="translate(778,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32" x="809" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2B" x="2027" y="0"></use><g transform="translate(3027,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32" x="706" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3D" x="4259" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-31" x="5315" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2B" x="6038" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-64" x="7038" y="0"></use><g transform="translate(7562,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32" x="809" y="513"></use></g><g transform="translate(8588,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32" x="706" y="513"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-6">−x^2+y^2= 1 +dx^2y^2</script><br>
 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-46"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47">d</span><span class="MJXp-mo" id="MJXp-Span-48" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-49" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-50">121665</span><span class="MJXp-mrow" id="MJXp-Span-51"><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-53">121666</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.234ex" height="2.634ex" viewBox="0 -809.3 9142.6 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3D" x="801" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2212" x="1857" y="0"></use><g transform="translate(2636,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-31" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-36" x="1501" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-36" x="2002" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-35" x="2502" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2F" x="5639" y="0"></use><g transform="translate(6139,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-31" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-36" x="1501" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-36" x="2002" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-36" x="2502" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-7">d = −121665/121666</script> (   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-54"><span class="MJXp-msubsup" id="MJXp-Span-55"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56" style="margin-right: 0.05em;">F</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-57" style="vertical-align: -0.4em;">q</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.483ex" height="2.634ex" viewBox="0 -755.5 1069.1 1134.2" role="img" focusable="false" style="vertical-align: -0.88ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-46" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-71" x="910" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8">F_q</script>    ).<br>
      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-58"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.509ex" viewBox="0 -540.2 572.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9">x</script>  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-60"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="1.884ex" viewBox="0 -540.2 497.5 811.3" role="img" focusable="false" style="vertical-align: -0.63ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-79" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10">y</script>.</li>
<li>      ,      : <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-62"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63">F</span><span class="MJXp-mo" id="MJXp-Span-64" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65">A</span><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67">B</span><span class="MJXp-mo" id="MJXp-Span-68" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-69" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">C</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.956ex" height="2.634ex" viewBox="0 -809.3 5578.2 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-46" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-28" x="749" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-41" x="1139" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2C" x="1889" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-42" x="2334" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-29" x="3094" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3D" x="3761" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-43" x="4817" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11">F(A, B) = C</script>,   «»,    ,  ,    (    [<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">6</a>]).       ,  ,     ,           ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-71"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">E</span><span class="MJXp-mo" id="MJXp-Span-73" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75" style="margin-right: 0.05em;">F</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-76" style="vertical-align: -0.4em;">q</span></span><span class="MJXp-mo" id="MJXp-Span-77" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.068ex" height="2.759ex" viewBox="0 -809.3 2612.6 1188" role="img" focusable="false" style="vertical-align: -0.88ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-45" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-28" x="764" y="0"></use><g transform="translate(1154,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-46" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-71" x="910" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-29" x="2223" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12">E(F_q)</script>.<br>
   (  ): <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-78"><span class="MJXp-mi" id="MJXp-Span-79">#</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80">E</span><span class="MJXp-mo" id="MJXp-Span-81" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-82"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83" style="margin-right: 0.05em;">F</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-84" style="vertical-align: -0.4em;">q</span></span><span class="MJXp-mo" id="MJXp-Span-85" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-86" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-87"><span class="MJXp-mn" id="MJXp-Span-88" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-89" style="vertical-align: 0.5em;">c</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.902ex" height="2.759ex" viewBox="0 -809.3 5985.7 1188" role="img" focusable="false" style="vertical-align: -0.88ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-23" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-45" x="833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-28" x="1598" y="0"></use><g transform="translate(1987,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-46" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-71" x="910" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-29" x="3056" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3D" x="3723" y="0"></use><g transform="translate(4780,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-63" x="707" y="557"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-6C" x="5687" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-13">\# E(F_q)=2^cl</script>,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-91"><span class="MJXp-mrow" id="MJXp-Span-92"><span class="MJXp-mo" id="MJXp-Span-93" style="margin-left: 0.278em; margin-right: 0.278em;"></span></span><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-95">3</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.15ex" height="2.384ex" viewBox="0 -809.3 2217.2 1026.6" role="img" focusable="false" style="vertical-align: -0.505ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3D" x="660" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-33" x="1716" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-14"> = 3</script> ()  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-96"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">l</span><span class="MJXp-mo" id="MJXp-Span-98" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-99"><span class="MJXp-mn" id="MJXp-Span-100" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-101" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-102">252</span></span></span><span class="MJXp-mo" id="MJXp-Span-103" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-104">27742317777372353535851937790883648493</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="54.666ex" height="2.634ex" viewBox="0 -970.7 23536.7 1134.2" role="img" focusable="false" style="vertical-align: -0.38ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-6C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3D" x="576" y="0"></use><g transform="translate(1632,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-35" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32" x="1001" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2B" x="3516" y="0"></use><g transform="translate(4517,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-37" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-37" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-34" x="1501" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32" x="2002" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-33" x="2502" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-31" x="3003" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-37" x="3503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-37" x="4004" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-37" x="4504" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-37" x="5005" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-33" x="5505" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-37" x="6006" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32" x="6506" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-33" x="7007" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-35" x="7507" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-33" x="8008" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-35" x="8508" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-33" x="9009" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-35" x="9509" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-38" x="10010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-35" x="10510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-31" x="11011" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-39" x="11511" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-33" x="12012" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-37" x="12512" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-37" x="13013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-39" x="13513" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-30" x="14014" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-38" x="14514" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-38" x="15015" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-33" x="15515" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-36" x="16016" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-34" x="16516" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-38" x="17017" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-34" x="17517" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-39" x="18018" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-33" x="18518" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-15">l=2^{252}+27742317777372353535851937790883648493</script>.</li>
<li>      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-105"><span class="MJXp-mo" id="MJXp-Span-106" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107">x</span><span class="MJXp-mo" id="MJXp-Span-108" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">y</span><span class="MJXp-mo" id="MJXp-Span-110" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.328ex" height="2.634ex" viewBox="0 -809.3 2294.2 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-78" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2C" x="962" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-79" x="1407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-29" x="1904" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-16">(x, y)</script>.     ,   ,            <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="1.884ex" viewBox="0 -540.2 497.5 811.3" role="img" focusable="false" style="vertical-align: -0.63ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-79" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-17">y</script>,   256- .<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.509ex" viewBox="0 -540.2 572.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-18">x</script>-,      (. ),       ,       ,  <nobr><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-115"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="1.884ex" viewBox="0 -540.2 497.5 811.3" role="img" focusable="false" style="vertical-align: -0.63ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-79" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-19">y</script>-</nobr>.</li>
<li>    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">G</span><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-120" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121">x</span><span class="MJXp-mo" id="MJXp-Span-122" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-124">4</span><span class="MJXp-mrow" id="MJXp-Span-125"><span class="MJXp-mo" id="MJXp-Span-126" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-127">5</span><span class="MJXp-mo" id="MJXp-Span-128" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.394ex" height="2.634ex" viewBox="0 -809.3 6197.2 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-47" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3D" x="1064" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-28" x="2120" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-78" x="2510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2C" x="3082" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2212" x="3527" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-34" x="4306" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2F" x="4806" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-35" x="5307" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-29" x="5807" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-20">G = (x, −4/5)</script>.   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="1.884ex" viewBox="0 -540.2 497.5 811.3" role="img" focusable="false" style="vertical-align: -0.63ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-79" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-21">y</script>-,     x  .</li>
<li> (. . 3)  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">G</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.827ex" height="2.134ex" viewBox="0 -809.3 786.5 918.9" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-47" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-22">G</script>    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.509ex" viewBox="0 -540.2 600.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-23">n</script>     (<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-135"><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0.267em; margin-right: 0.267em;">∗</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="1.384ex" viewBox="0 -540.2 500.5 596" role="img" focusable="false" style="vertical-align: 0.079ex; margin-bottom: -0.209ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2217" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-24">*</script>,   )   ,     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-137"><span class="MJXp-mrow" id="MJXp-Span-138"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-139">G</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.101ex" height="2.009ex" viewBox="0 -755.5 904.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAINB-47" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-25">\mathbf{G}</script>,   ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-140"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">E</span><span class="MJXp-mo" id="MJXp-Span-142" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-143"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144" style="margin-right: 0.05em;">F</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-145" style="vertical-align: -0.4em;">q</span></span><span class="MJXp-mo" id="MJXp-Span-146" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.068ex" height="2.759ex" viewBox="0 -809.3 2612.6 1188" role="img" focusable="false" style="vertical-align: -0.88ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-45" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-28" x="764" y="0"></use><g transform="translate(1154,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-46" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-71" x="910" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-29" x="2223" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-26">E(F_q)</script>:<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-147"><span class="MJXp-mi" id="MJXp-Span-148">#</span><span class="MJXp-mrow" id="MJXp-Span-149"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-150">G</span></span><span class="MJXp-mo" id="MJXp-Span-151" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi" id="MJXp-Span-152">#</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">E</span><span class="MJXp-mo" id="MJXp-Span-154" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156" style="margin-right: 0.05em;">F</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-157" style="vertical-align: -0.4em;">q</span></span><span class="MJXp-mo" id="MJXp-Span-158" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.139ex" height="2.759ex" viewBox="0 -809.3 6518.2 1188" role="img" focusable="false" style="vertical-align: -0.88ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-23" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAINB-47" x="833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3C" x="2015" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-23" x="3072" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-45" x="3905" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-28" x="4670" y="0"></use><g transform="translate(5059,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-46" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-71" x="910" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-29" x="6128" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-27">\#\mathbf{G} < \#E(F_q)</script>,<br>
 <br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-159"><span class="MJXp-mi" id="MJXp-Span-160">#</span><span class="MJXp-mrow" id="MJXp-Span-161"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-162">G</span></span><span class="MJXp-mo" id="MJXp-Span-163" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">l</span><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-166"><span class="MJXp-mn" id="MJXp-Span-167" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-168" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-169">252</span></span></span><span class="MJXp-mo" id="MJXp-Span-170" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-171">27742317777372353535851937790883648493</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="61.801ex" height="2.884ex" viewBox="0 -970.7 26608.8 1241.8" role="img" focusable="false" style="vertical-align: -0.63ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-23" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAINB-47" x="833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3D" x="2015" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-6C" x="3072" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3D" x="3648" y="0"></use><g transform="translate(4704,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-35" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32" x="1001" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2B" x="6589" y="0"></use><g transform="translate(7589,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-37" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-37" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-34" x="1501" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32" x="2002" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-33" x="2502" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-31" x="3003" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-37" x="3503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-37" x="4004" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-37" x="4504" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-37" x="5005" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-33" x="5505" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-37" x="6006" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32" x="6506" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-33" x="7007" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-35" x="7507" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-33" x="8008" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-35" x="8508" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-33" x="9009" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-35" x="9509" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-38" x="10010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-35" x="10510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-31" x="11011" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-39" x="11511" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-33" x="12012" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-37" x="12512" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-37" x="13013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-39" x="13513" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-30" x="14014" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-38" x="14514" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-38" x="15015" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-33" x="15515" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-36" x="16016" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-34" x="16516" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-38" x="17017" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-34" x="17517" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-39" x="18018" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-33" x="18518" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-28">\#\mathbf{G}=l=2^{252}+27742317777372353535851937790883648493</script>.</li>
<li>  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-172"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.009ex" viewBox="0 -755.5 852.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-58" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-29">X</script> —    ,   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-174"><span class="MJXp-mrow" id="MJXp-Span-175"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-176">G</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.101ex" height="2.009ex" viewBox="0 -755.5 904.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAINB-47" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-30">\mathbf{G}</script>:<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-177"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">X</span><span class="MJXp-mo" id="MJXp-Span-179" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mrow" id="MJXp-Span-180"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-181">G</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.921ex" height="2.009ex" viewBox="0 -755.5 2980.1 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-58" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2208" x="1130" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAINB-47" x="2075" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-31">X \in \mathbf{G} </script></li>
<li>  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-182"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.509ex" viewBox="0 -540.2 572.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-32">x</script>,  ,    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-184"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.009ex" viewBox="0 -755.5 852.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-58" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-33">X</script> —    , :<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-186"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">X</span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">x</span><span class="MJXp-mo" id="MJXp-Span-190" style="margin-left: 0.267em; margin-right: 0.267em;">∗</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">G</span><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">x</span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-195" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-196">1</span><span class="MJXp-mo" id="MJXp-Span-197" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">l</span><span class="MJXp-mo" id="MJXp-Span-199" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-200">1</span><span class="MJXp-mo" id="MJXp-Span-201" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.82ex" height="2.634ex" viewBox="0 -809.3 10255.8 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-58" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3D" x="1130" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-78" x="2186" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2217" x="2981" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-47" x="3704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2C" x="4490" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-78" x="4935" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2208" x="5785" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-5B" x="6731" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-31" x="7009" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3B" x="7510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-6C" x="7955" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2212" x="8476" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-31" x="9476" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-5D" x="9977" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-34">X = x*G, x \in [1; l-1]</script> <br>
 ,     (. ),   256- .</li>
<li>  - <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">H</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.009ex" viewBox="0 -755.5 888.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-48" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-35">H</script> (       <code>cn_fast_hash</code>).   32-     :<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">H</span><span class="MJXp-mo" id="MJXp-Span-206" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mo" id="MJXp-Span-207" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mn" id="MJXp-Span-208">0</span><span class="MJXp-mo" id="MJXp-Span-209" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-210">1</span><span class="MJXp-msubsup" id="MJXp-Span-211"><span class="MJXp-mo" id="MJXp-Span-212" style="margin-left: 0em; margin-right: 0.05em;">}</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-213" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-214" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-215" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-216">0</span><span class="MJXp-mo" id="MJXp-Span-217" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-218"><span class="MJXp-mn" id="MJXp-Span-219" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-220" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-221">256</span></span></span><span class="MJXp-mo" id="MJXp-Span-222" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-223">1</span><span class="MJXp-mo" id="MJXp-Span-224" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.706ex" height="3.009ex" viewBox="0 -970.7 11068 1295.7" role="img" focusable="false" style="vertical-align: -0.755ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-48" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3A" x="1166" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-7B" x="1722" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-30" x="2223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2C" x="2723" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-31" x="3168" y="0"></use><g transform="translate(3669,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-7D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2217" x="707" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2192" x="4901" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-5B" x="6179" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-30" x="6458" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2C" x="6958" y="0"></use><g transform="translate(7403,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-35" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-36" x="1001" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2212" x="9288" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-31" x="10289" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-5D" x="10789" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-36">H:\{0, 1\}^* \to [0,2^{256}-1]</script></li>
<li>- <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-225"><span class="MJXp-msubsup" id="MJXp-Span-226"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227" style="margin-right: 0.05em;">H</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-228" style="vertical-align: -0.4em;">s</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.935ex" height="2.259ex" viewBox="0 -755.5 1263.5 972.7" role="img" focusable="false" style="vertical-align: -0.505ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-48" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-73" x="1175" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-37">H_s</script> (<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="1.509ex" viewBox="0 -540.2 469.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-73" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-38">s</script>  scalar)     ,  , ..   :<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-231"><span class="MJXp-msubsup" id="MJXp-Span-232"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233" style="margin-right: 0.05em;">H</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-234" style="vertical-align: -0.4em;">s</span></span><span class="MJXp-mo" id="MJXp-Span-235" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mo" id="MJXp-Span-236" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mn" id="MJXp-Span-237">0</span><span class="MJXp-mo" id="MJXp-Span-238" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-239">1</span><span class="MJXp-msubsup" id="MJXp-Span-240"><span class="MJXp-mo" id="MJXp-Span-241" style="margin-left: 0em; margin-right: 0.05em;">}</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-242" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-243" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-244" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-245">1</span><span class="MJXp-mo" id="MJXp-Span-246" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">l</span><span class="MJXp-mo" id="MJXp-Span-248" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-249">1</span><span class="MJXp-mo" id="MJXp-Span-250" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.41ex" height="2.634ex" viewBox="0 -809.3 10079.3 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-48" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-73" x="1175" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3A" x="1541" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-7B" x="2097" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-30" x="2598" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2C" x="3098" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-31" x="3543" y="0"></use><g transform="translate(4044,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-7D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2217" x="707" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2192" x="5276" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-5B" x="6554" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-31" x="6833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3B" x="7333" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-6C" x="7778" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2212" x="8299" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-31" x="9300" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-5D" x="9800" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-39">H_s:\{0,1\}^* \to [1; l-1]</script><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-251"><span class="MJXp-msubsup" id="MJXp-Span-252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253" style="margin-right: 0.05em;">H</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-254" style="vertical-align: -0.4em;">s</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.935ex" height="2.259ex" viewBox="0 -755.5 1263.5 972.7" role="img" focusable="false" style="vertical-align: -0.505ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-48" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-73" x="1175" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-40">H_s</script>      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">H</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.009ex" viewBox="0 -755.5 888.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-48" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-41">H</script>:<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-257"><span class="MJXp-msubsup" id="MJXp-Span-258"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-260" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-261" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mo" id="MJXp-Span-263" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-264" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mo" id="MJXp-Span-268" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-269"><span class="MJXp-mspace" id="MJXp-Span-270" style="width: 0.667em; height: 0em;"></span></span><span class="MJXp-mi" id="MJXp-Span-271"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mod</font></font></span><span class="MJXp-mspace" id="MJXp-Span-272" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-273" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l</font></font></span><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mn" id="MJXp-Span-277"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span><span class="MJXp-mo" id="MJXp-Span-278" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-279" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mn" id="MJXp-Span-280"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.983ex" height="2.634ex" viewBox="0 -809.3 13770.6 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-48" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-73" x="1175" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-28" x="1263" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-78" x="1652" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-29" x="2225" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3D" x="2892" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-48" x="3949" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-28" x="4837" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-78" x="5227" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-29" x="5799" y="0"></use><g transform="translate(7022,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-6D"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-6F" x="833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-64" x="1334" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-28" x="9246" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-6C" x="9635" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2212" x="10156" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-31" x="11157" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-29" x="11657" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2B" x="12269" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-31" x="13270" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-42">H_s(x)= H(x) \mod (l-1) + 1</script></li>
<li>- <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-281"><span class="MJXp-msubsup" id="MJXp-Span-282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-284" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.99ex" height="2.634ex" viewBox="0 -755.5 1287.5 1134.2" role="img" focusable="false" style="vertical-align: -0.88ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-48" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-70" x="1175" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-43">H_p</script> (<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="1.884ex" viewBox="-38.5 -540.2 542 811.3" role="img" focusable="false" style="vertical-align: -0.63ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-70" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-44">p</script>  point —  )       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-287"><span class="MJXp-mrow" id="MJXp-Span-288"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-289"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.101ex" height="2.009ex" viewBox="0 -755.5 904.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAINB-47" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-45">\mathbf{G}</script>,  ,   :<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-290"><span class="MJXp-msubsup" id="MJXp-Span-291"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-293" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-294" style="margin-left: 0.111em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></span><span class="MJXp-mo" id="MJXp-Span-295" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{</font></font></span><span class="MJXp-mn" id="MJXp-Span-296"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span><span class="MJXp-mo" id="MJXp-Span-297" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mn" id="MJXp-Span-298"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-299"><span class="MJXp-mo" id="MJXp-Span-300" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}</font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-301" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-302" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">→</font></font></span><span class="MJXp-mrow" id="MJXp-Span-303"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-304"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.38ex" height="2.759ex" viewBox="0 -809.3 7483.2 1188" role="img" focusable="false" style="vertical-align: -0.88ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-48" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-70" x="1175" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3A" x="1565" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-7B" x="2121" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-30" x="2622" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2C" x="3122" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-31" x="3567" y="0"></use><g transform="translate(4068,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-7D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2217" x="707" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2192" x="5300" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAINB-47" x="6578" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-46">H_p:\{0,1\}^* \to \mathbf{G}</script><br>
  -      ,  -,    256        (. . 4),  -,       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-305"><span class="MJXp-mrow" id="MJXp-Span-306"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-307"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.101ex" height="2.009ex" viewBox="0 -755.5 904.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAINB-47" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-47">\mathbf{G}</script> (. . 6).<br>
     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-308"><span class="MJXp-msubsup" id="MJXp-Span-309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-311" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.99ex" height="2.634ex" viewBox="0 -755.5 1287.5 1134.2" role="img" focusable="false" style="vertical-align: -0.88ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-48" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-70" x="1175" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-48">H_p</script>     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mo" id="MJXp-Span-314" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mo" id="MJXp-Span-316" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mo" id="MJXp-Span-317" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></span><span class="MJXp-mo" id="MJXp-Span-318" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></span><span class="MJXp-mo" id="MJXp-Span-319" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mo" id="MJXp-Span-321" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mo" id="MJXp-Span-323" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-324" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></span><span class="MJXp-mo" id="MJXp-Span-325" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></span><span class="MJXp-mo" id="MJXp-Span-326" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></span><span class="MJXp-mo" id="MJXp-Span-327" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-328" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.152ex" height="2.634ex" viewBox="0 -809.3 8246 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-48" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-28" x="888" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-48" x="1278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-28" x="2166" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2E" x="2556" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2E" x="3001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2E" x="3446" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-48" x="3891" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-28" x="4780" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-78" x="5169" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-29" x="5742" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2E" x="6131" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2E" x="6576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2E" x="7021" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-29" x="7467" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-29" x="7856" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-49">H(H(...H(x)...))</script>   ,         <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></span><span class="MJXp-mo" id="MJXp-Span-331" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∈</font></font></span><span class="MJXp-mrow" id="MJXp-Span-332"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-333"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.921ex" height="2.009ex" viewBox="0 -755.5 2980.1 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-58" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2208" x="1130" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAINB-47" x="2075" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-50">X \in \mathbf{G}</script>.<br>
 CryptoNote      ,     <code>ge_fromfe_frombytes_vartime</code>,      [<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">7</a>].<br>
 ,    256     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-334"><span class="MJXp-mrow" id="MJXp-Span-335"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-336"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.101ex" height="2.009ex" viewBox="0 -755.5 904.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAINB-47" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-51">\mathbf{G}</script> :<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o</font></font></span><span class="MJXp-mi" id="MJXp-Span-340"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mo" id="MJXp-Span-346" style="margin-left: 0.111em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></span><span class="MJXp-mo" id="MJXp-Span-347" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[</font></font></span><span class="MJXp-mn" id="MJXp-Span-348"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span><span class="MJXp-mo" id="MJXp-Span-349" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-350"><span class="MJXp-mn" id="MJXp-Span-351" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-352" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-353"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">256</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-354" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mn" id="MJXp-Span-355"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span><span class="MJXp-mo" id="MJXp-Span-356" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]</font></font></span><span class="MJXp-mo" id="MJXp-Span-357" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">→</font></font></span><span class="MJXp-mrow" id="MJXp-Span-358"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-359"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.469ex" height="3.009ex" viewBox="0 -970.7 11826.9 1295.7" role="img" focusable="false" style="vertical-align: -0.755ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-6F" x="361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-5F" x="847" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-70" x="1347" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-6F" x="1851" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-69" x="2336" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-6E" x="2682" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-74" x="3282" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3A" x="3921" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-5B" x="4478" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-30" x="4756" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2C" x="5257" y="0"></use><g transform="translate(5702,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-32"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-35" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-36" x="1001" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2212" x="7586" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-31" x="8587" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-5D" x="9087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2192" x="9644" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAINB-47" x="10922" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-52">to\_point : [0,2^{256}-1] \to \mathbf{G}</script> <br>
 CryptoNote - <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-360"><span class="MJXp-msubsup" id="MJXp-Span-361"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-363" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.99ex" height="2.634ex" viewBox="0 -755.5 1287.5 1134.2" role="img" focusable="false" style="vertical-align: -0.88ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-48" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-70" x="1175" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-53">H_p</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> implemented like this: </font></font><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-364"><span class="MJXp-msubsup" id="MJXp-Span-365"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-367" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-368" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mo" id="MJXp-Span-370" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o</font></font></span><span class="MJXp-mi" id="MJXp-Span-374"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mo" id="MJXp-Span-380" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mo" id="MJXp-Span-382" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mo" id="MJXp-Span-384" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-385" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.703ex" height="2.759ex" viewBox="0 -809.3 10636.1 1188" role="img" focusable="false" style="vertical-align: -0.88ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-48" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-70" x="1175" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-28" x="1287" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-78" x="1677" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-29" x="2249" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3D" x="2916" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-74" x="3973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-6F" x="4334" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-5F" x="4820" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-70" x="5320" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-6F" x="5824" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-69" x="6309" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-6E" x="6655" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-74" x="7255" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-28" x="7617" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-48" x="8006" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-28" x="8895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-78" x="9284" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-29" x="9857" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-29" x="10246" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-54">H_p(x) = to\_point( H(x) )</script></li>
</ol><br>
<br>
<a name="a3"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Accounting and balance calculation in CryptoNote</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recall how the funds are sent and the balance is calculated in the original version of the protocol. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alice, sending money to Bob, forms the outputs of her transaction as follows (Fig. 3.1).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><img src="https://habrastorage.org/webt/mj/z6/bw/mjz6bwx78zksvfmmwlbvtdxgc-w.png" alt="Fig.  3.1."><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">3.1. </font><font style="vertical-align: inherit;">Alice generates transaction exits by sending money to Bob</font></font></sub></td>
</tr>
</tbody></table></div><ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bob has a pair of private keys </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-386"><span class="MJXp-mo" id="MJXp-Span-387" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mo" id="MJXp-Span-389" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mo" id="MJXp-Span-391" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.061ex" height="2.634ex" viewBox="0 -809.3 2179.2 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-76" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2C" x="875" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-73" x="1320" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-29" x="1789" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-55">(v, s)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">It calculates its address as a pair of matching public keys</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-392"><span class="MJXp-mo" id="MJXp-Span-393" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-395" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-397" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.13ex" height="2.634ex" viewBox="0 -809.3 2639.2 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-56" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2C" x="1159" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-53" x="1604" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-29" x="2249" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-56">(V, S)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and publishes it or sends it to Alice.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alice picks a random secret transaction key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-398"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.049ex" height="1.509ex" viewBox="0 -540.2 451.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-72" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-57">r</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and calculates the public key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-400"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span><span class="MJXp-mo" id="MJXp-Span-402" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.738ex" height="2.134ex" viewBox="0 -809.3 3331.6 918.9" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-52" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3D" x="1037" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-72" x="2093" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-47" x="2545" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-58">R = r G</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">which writes to the special field extra transactions.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For each output, Alice calculates the stealth address (one-time destination key):</font></font><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-405"><span class="MJXp-msubsup" id="MJXp-Span-406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-408" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-409" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-410"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-412" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-413" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-416" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-418" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span><span class="MJXp-mo" id="MJXp-Span-420" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.973ex" height="2.634ex" viewBox="0 -809.3 9030 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-50" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-69" x="908" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3D" x="1264" y="0"></use><g transform="translate(2320,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-48" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-73" x="1175" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-28" x="3584" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-72" x="3973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-56" x="4425" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2C" x="5194" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-69" x="5640" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-29" x="5985" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-47" x="6375" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2B" x="7383" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-53" x="8384" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-59">P_i = H_s(rV, i)G + S</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">where </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-422"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.009ex" viewBox="0 -755.5 345.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-69" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-60">i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - serial number of the output.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alice signs and sends the transaction.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Third-party observer analyzing stealth addresses </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-424"><span class="MJXp-msubsup" id="MJXp-Span-425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-427" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-61-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.292ex" height="2.259ex" viewBox="0 -755.5 986.8 972.7" role="img" focusable="false" style="vertical-align: -0.505ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-50" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-69" x="908" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-61">P_i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, cannot say whether a particular output is intended for Bob, and cannot even determine whether different outputs with keys are intended </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-428"><span class="MJXp-msubsup" id="MJXp-Span-429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-431" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-62-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.292ex" height="2.259ex" viewBox="0 -755.5 986.8 972.7" role="img" focusable="false" style="vertical-align: -0.505ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-50" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-69" x="908" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-62">P_i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-432"><span class="MJXp-msubsup" id="MJXp-Span-433"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-435" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-63-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.402ex" height="2.634ex" viewBox="0 -755.5 1034.2 1134.2" role="img" focusable="false" style="vertical-align: -0.88ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-50" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-6A" x="908" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-63">P_j</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to one recipient. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To accept the money, Bob analyzes all transactions on the blockchain as follows (Fig. 3.2).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><img src="https://habrastorage.org/webt/t_/p9/jc/t_p9jchcutbmx6doaw1exxtfw2u.png" alt="Fig.  3.2."><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">3.2. </font><font style="vertical-align: inherit;">Bob checks transaction outputs to determine incoming transfers</font></font></sub></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Using your private key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-436"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-64-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.128ex" height="1.509ex" viewBox="0 -540.2 485.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-76" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-64">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bob computes for each output </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-438"><span class="MJXp-msubsup" id="MJXp-Span-439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-442"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">′</font></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-443" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-444"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-446" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-447" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span><span class="MJXp-mo" id="MJXp-Span-450" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-452" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span><span class="MJXp-mo" id="MJXp-Span-454" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-65-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.243ex" height="2.759ex" viewBox="0 -809.3 9146.2 1188" role="img" focusable="false" style="vertical-align: -0.88ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-50" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2032" x="1109" y="445"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-69" x="908" y="-430"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3D" x="1356" y="0"></use><g transform="translate(2413,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-48" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-73" x="1175" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-28" x="3676" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-76" x="4066" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-52" x="4551" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2C" x="5311" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-69" x="5756" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-29" x="6101" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-47" x="6491" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2B" x="7499" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-53" x="8500" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-65">P’_i = H_s(vR, i)G + S</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Where </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-456"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-66-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.009ex" viewBox="0 -755.5 345.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-69" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-66">i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - serial number of the output, </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-67-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.499ex" height="2.134ex" viewBox="0 -809.3 645.5 918.9" role="img" focusable="false" style="vertical-align: -0.255ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-53" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-67">S</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Bob's public spend-key). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-460"><span class="MJXp-msubsup" id="MJXp-Span-461"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-464"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">′</font></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-468" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-68-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.897ex" height="2.759ex" viewBox="0 -809.3 3399.9 1188" role="img" focusable="false" style="vertical-align: -0.88ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-50" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2032" x="1109" y="445"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-69" x="908" y="-430"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-3D" x="1356" y="0"></use><g transform="translate(2413,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-50" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-69" x="908" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-68">P’_i = P_i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, then this means that he is the recipient of this output and can spend it by calculating the corresponding secret key. Therefore, Bob increases the balance of his wallet by the value of this output. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To spend the output Bob is the recipient of and send Carol coins, he acts as follows.</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><img src="https://habrastorage.org/webt/ja/_r/0m/ja_r0m8cnbkjzqx9zpuztrxprus.png" alt="Fig.  3.3."><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">3.3. </font><font style="vertical-align: inherit;">Bob forms an entry for a new transaction using his own exit</font></font></sub></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. Bob using his secret keys </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-469"><span class="MJXp-mo" id="MJXp-Span-470" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mo" id="MJXp-Span-472" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mo" id="MJXp-Span-474" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-69-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.061ex" height="2.634ex" viewBox="0 -809.3 2179.2 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-76" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-2C" x="875" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMATHI-73" x="1320" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/496864/&amp;usg=ALkJrhhgTKR2ojC1Bhv-4oIjLmGYfJrP9g#MJMAIN-29" x="1789" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-69">(v, s)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">calculates the private key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-475"><span class="MJXp-msubsup" id="MJXp-Span-476"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-478" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-479" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-480"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-481" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-482" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-483" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span><span class="MJXp-mo" id="MJXp-Span-486" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-488" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-489" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-70-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-70">x_i = H_s(vR, i) + s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to stealth address </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-491"><span class="MJXp-msubsup" id="MJXp-Span-492"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-494" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-71-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-71">P_i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, i.e., such that </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-495"><span class="MJXp-msubsup" id="MJXp-Span-496"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-498" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-499" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-500"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-502" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-72-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-72">P_i = x_i G</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7. Bob calculates the key image:</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span><span class="MJXp-mo" id="MJXp-Span-506" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-507"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-508" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-509" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-510"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-512" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-513" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-514"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-516" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-517" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-73-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-73">I = x_i H_p(P_i)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and writes it, the face value and a link to the corresponding output in the input of his transaction for Carol. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It should be noted that, firstly, only the owner of the secret spend-key can calculate key image</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-518"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-74-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-74">s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (the correctness of this will be certified by a ring signature), and secondly, a third party will not be able to bind key image </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-75-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-75">I</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and corresponding stealth address </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-522"><span class="MJXp-msubsup" id="MJXp-Span-523"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-524" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-525" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-76-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-76">P_i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8. Bob reduces the balance of his wallet by the nominal value of the output used in paragraph 6. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
9. Bob forms the outputs in the transaction for Carol in accordance with paragraphs. </font><font style="vertical-align: inherit;">2-3. </font><font style="vertical-align: inherit;">Then signs the transaction and sends. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assuming Bob has lost the entire history of his operations, but still owns his secret keys</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-526"><span class="MJXp-mo" id="MJXp-Span-527" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-528"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mo" id="MJXp-Span-529" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-530"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mo" id="MJXp-Span-531" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-77-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-77">(v, s)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, then he will be able to restore the transaction history and calculate his current balance as follows (Fig. 3.4).</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/webt/cj/oy/mu/cjoymupyh7a-6ggpcxhefdo52oq.png" alt="Fig.  3.4."></div><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">3.4. </font><font style="vertical-align: inherit;">Bob determines his incoming and outgoing payments and calculates the balance</font></font></sub></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10. Bob scans the entire blockchain and analyzes all transactions for the presence of outputs addressed to him (see paragraph 5). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
11. When finding such an exit</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-532"><span class="MJXp-msubsup" id="MJXp-Span-533"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-535" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-78-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-78">P_i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Bob increases the balance of his wallet by the value of the face value. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then using your secret spend key</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-79-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-79">s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> computes the corresponding secret exit key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-538"><span class="MJXp-msubsup" id="MJXp-Span-539"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-541" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-80-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-80">x_i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (p. 6) and key image </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-542"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-81-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-81">I</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(paragraph 7). </font><font style="vertical-align: inherit;">Then writes key image,</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-544"><span class="MJXp-msubsup" id="MJXp-Span-545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-547" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-82-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-82">P_i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and other payment data in a table. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
12. If during further scanning of the blockchain, Bob finds in the input of some transaction the key image in the table, this will mean that this transaction was once formed by Bob. </font><font style="vertical-align: inherit;">Therefore, he will reduce the balance of his wallet by the value of the entry value. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By doing so, Bob will restore the current balance of his wallet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Please note that if third-party auditor Dan receives a secret key from Bob</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-83-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-83">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, then he will be able to recognize Bob's incoming transactions on the blockchain, however, without a secret key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-84-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-84">s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, he </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">will not be able to</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> recognize Bob's outgoing transactions, which means </font><font style="vertical-align: inherit;">that he </font><strong><font style="vertical-align: inherit;">will</font></strong><font style="vertical-align: inherit;"> also calculate the correct balance. </font><font style="vertical-align: inherit;">As will be shown later, in the case of direct spending of the exit by Bob without mixing, Den will be able to identify such a transaction as Bob's outgoing transfer, but in the general case this cannot be done. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thus, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to calculate the balance of Bob’s wallet, you need to know both secret keys</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-552"><span class="MJXp-mo" id="MJXp-Span-553" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mo" id="MJXp-Span-555" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mo" id="MJXp-Span-557" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-85-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-85">(v, s)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If Bob gives both of his private keys to auditor Dan</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-558"><span class="MJXp-mo" id="MJXp-Span-559" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mo" id="MJXp-Span-561" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mo" id="MJXp-Span-563" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-86-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-86">(v, s)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, this will be tantamount to transferring the funds themselves, since Den, possessing </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-87-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-87">s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">will be able to spend them. </font><font style="vertical-align: inherit;">Therefore, a full audit of wallets under the original CryptoNote protocol is not possible. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the following sections, we will consider options for modifying the protocol that have this capability. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Note that the secret key of the transaction</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-566"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-88-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-88">r</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It makes sense to save Alice (which is what happens in some implementations of the protocol). </font><font style="vertical-align: inherit;">Anyone who knows</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-568"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-89-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-89">r</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for some transaction, can check if the output is relevant </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-570"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-571"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-90-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-90">i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> this transaction to the given address </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-572"><span class="MJXp-mo" id="MJXp-Span-573" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-575" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-576"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-577" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-91-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-91">(V, S)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">simply repeating the calculations from clause 3:</font></font><br>
<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-578"><span class="MJXp-msubsup" id="MJXp-Span-579"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-582"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">′</font></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-583" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-584"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-586" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-587" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-590" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-591"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-592" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span><span class="MJXp-mo" id="MJXp-Span-594" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-92-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-92">P’_i = H_s(rV, i)G + S</script><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
and comparing the result with </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-596"><span class="MJXp-msubsup" id="MJXp-Span-597"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-599" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-93-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-93">P_i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alice can, for example, use this fact to prove that she transferred the money to Bob. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Calculate Destination Address</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-600"><span class="MJXp-mo" id="MJXp-Span-601" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-603" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-605" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-94-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-94">(V, S)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on exit, even knowing </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-606"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-95-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-95">r</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, you can’t.</font></font><br>
<br>
<br>
<a name="a4"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Option 1/3. </font><font style="vertical-align: inherit;">Bytecoin auditable coins</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At the time of its appearance, Bytecoin was the first and only implementation of the CryptoNote protocol, so it was characterized by all the features and limitations discussed in the previous section. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On February 7, 2019, developers released ([ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">20</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]) version 3.4.0 of Amethyst, which contains a number of improvements and changes to CryptoNote, which we will now consider. </font><font style="vertical-align: inherit;">Most of the information in this section was obtained by analyzing the source code of Bytecoin, since no official documentation was provided. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Within the scope of this article, the most interesting change was the ability for ordinary wallets to create special copies - auditable wallet (AW), with two properties:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AW cannot spend funds from the main wallet;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AW balance always coincides with the balance of the main wallet. </font><font style="vertical-align: inherit;">It is not possible to change the balance of the main wallet so that it does not affect the balance of AW.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, only the wallet addresses of new versions, the so-called amethyst addresses, have such functionality. </font><font style="vertical-align: inherit;">Backward compatibility is provided with existing addresses and accounts; they are now called legacy addresses. </font><font style="vertical-align: inherit;">The implementation of the new functionality became possible only in transactions of the new version, since the developers changed the format of the outputs, therefore, bytecoin networks currently circulate both old-format transactions and new ones. </font><font style="vertical-align: inherit;">Transactions of the new format also support two types of addresses: amethyst and legacy, so in the end we have three options for cryptographic schemes:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tx.version &lt;amethyst, legacy address;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tx.version ≥ amethyst, legacy address;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tx.version ≥ amethyst, amethyst address.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's consider them in more detail.</font></font><br>
<br>
<br>
<a name="a41"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.1. </font><font style="vertical-align: inherit;">tx.version &lt;amethyst, legacy address</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is the original CryptoNote scheme, but with deterministic generation. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-608"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-96-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-96">r</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wallet account represented by secret key.</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-610"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-97-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-97">s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and hash </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-612"><span class="MJXp-msubsup" id="MJXp-Span-613"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-615" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-98-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-98">v_s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Secret view key</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-616"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-99-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-99">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> deterministically generated as a function of </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-618"><span class="MJXp-msubsup" id="MJXp-Span-619"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-621" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-100-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-100">v_s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The secret key</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-622"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-101-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-101">r</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> transactions are now selected not by chance, but calculated using </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-624"><span class="MJXp-msubsup" id="MJXp-Span-625"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-627" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-102-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-102">v_s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span><span class="MJXp-mo" id="MJXp-Span-630" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-633" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-634" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-635"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-636" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-637" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-638" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-639"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-641" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-642" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-103-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-103">r = H_s(h_t, v_s)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">where </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-643"><span class="MJXp-msubsup" id="MJXp-Span-644"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-646" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-647" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mo" id="MJXp-Span-649" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mo" id="MJXp-Span-652" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mo" id="MJXp-Span-659" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mo" id="MJXp-Span-662" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-666"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mo" id="MJXp-Span-670" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-104-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-104">h_t = H(tx.inputs, tx.version)</script><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This eliminates the need for private keys. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-671"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-105-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-105">r</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in local storage for future needs, since for any transaction ever sent to the blockchain, such a key can be calculated using </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-673"><span class="MJXp-msubsup" id="MJXp-Span-674"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-676" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-106-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-106">v_s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The wallet balance is calculated similarly to the original CryptoNote (see section 3), that is, a secret spend-key is required to account for outgoing payments</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-677"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-678"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-107-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-107">s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">all</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> addresses that have ever been transferred to the </font><font style="vertical-align: inherit;">wallet are stored in the local wallet </font><font style="vertical-align: inherit;">, then it is possible to calculate the correct balance without involving a secret spend-key</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-679"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-680"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-108-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-108">s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the following way:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alice scans transactions on the blockchain and keeps track of incoming payments using a secret view key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-681"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-109-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-109">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, as described in section 3, and increases balance.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Also, for each output of each transaction, Alice goes through all the addresses </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-683"><span class="MJXp-mo" id="MJXp-Span-684" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-686" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-687"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-688" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-110-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-110">(V, S)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to which transfers have ever been made and calculates:</font></font><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-689"><span class="MJXp-msubsup" id="MJXp-Span-690"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-693"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">′</font></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-694" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-695"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-697" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-698" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-701" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-703" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-704"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span><span class="MJXp-mo" id="MJXp-Span-705" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-706"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-111-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-111">P’_i = H_s(rV, i)G + S</script><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-707"><span class="MJXp-msubsup" id="MJXp-Span-708"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-711"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">′</font></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-710"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-712" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-713"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-715" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-112-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-112">P’_i = P_i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, then this output is Alice's outgoing payment to the address </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-716"><span class="MJXp-mo" id="MJXp-Span-717" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-718"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-719" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-721" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-113-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-113">(V, S)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and it reduces balance.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So Alice will calculate the balance using only </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-722"><span class="MJXp-msubsup" id="MJXp-Span-723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-725" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-114-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-114">v_s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-115-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-115">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviously, this method is unreliable and impractical, since the absence in the indicated local storage of the address to which the transfer was actually carried out will lead to an overestimation of the balance. </font><font style="vertical-align: inherit;">Therefore, it is, rather, of theoretical interest.</font></font><br>
<br>
<br>
<a name="a42"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.2. </font><font style="vertical-align: inherit;">tx.version ≥ amethyst</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As noted above, since version 3.4.0 of Amethyst, Bytecoin has changed the format of transactions. </font><font style="vertical-align: inherit;">If tx.version ≥ amethyst, then the transaction outputs have a different format. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now, each output, in addition to the amount and the public key P </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , also contains an additional public key Q </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (indicated in the code as </font></font><code>encrypted_secret</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) and an additional byte containing the encrypted address type, amethyst or legacy (referred to in the code </font></font><code>encrypted_address_type)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. These structures are shown schematically in Fig. 4.2.</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4c6/098/1fa/4c60981faff2adfd5707a9fc1170a70e.png"></div><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">4.2. </font><font style="vertical-align: inherit;">Comparing the data structure for CryptoNote and Bytecoin Amethyst transaction exits</font></font></sub></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Thus, the size of each output increased by 33 bytes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For each output i, the address type is encoded and decoded as follows: </font><font style="vertical-align: inherit;">
where:</font></font><br>
<br>
<code>encrypted_address_type(i) = (H(o<sub>i</sub>) &amp; 255) xor address_tag</code><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-728"><span class="MJXp-msubsup" id="MJXp-Span-729"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-730" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-731" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-732" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mo" id="MJXp-Span-734" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-735"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-736" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-737" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-738" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-739"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-741" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-742" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-744" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-116-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-116">o_i = H(h_t, v_s, i)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(indicated in the code as </font></font><code>output_seed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
address_tag is 0 for legacy addresses and 1 for ametyst addresses.</font></font><br>
<br>
<br>
<a name="a43"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.3. </font><font style="vertical-align: inherit;">tx.version ≥ amethyst, legacy address</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The wallet account is also represented by a secret key. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-117-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-117">s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and hash </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-747"><span class="MJXp-msubsup" id="MJXp-Span-748"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-750" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-118-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-118">v_s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">on the basis of which a secret view key is generated deterministically </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-751"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-119-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-119">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alice sending money to Bob at his address</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-753"><span class="MJXp-mo" id="MJXp-Span-754" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-756" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-758" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-120-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-120">(V, S)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forms the outputs of its transaction as follows: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  1. Calculates</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-759"><span class="MJXp-msubsup" id="MJXp-Span-760"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-761" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-762" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-763" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mo" id="MJXp-Span-765" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mo" id="MJXp-Span-768" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-769"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-774"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mo" id="MJXp-Span-775" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-776"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mo" id="MJXp-Span-778" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-781"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mo" id="MJXp-Span-786" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-121-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-121">h_t = H(tx.inputs, tx.version)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, then for each exit </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-787"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-788"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-122-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-122">i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  2.</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-789"><span class="MJXp-msubsup" id="MJXp-Span-790"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-791" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-792" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-793" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-794"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-796" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-797" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-800" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-801" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-802"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-804" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-805" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-807" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-808"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-123-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-123">D_i = H_s(h_t, v_s, i)G</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(indicated in the code as </font></font><code>output_shared_secret</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  3.</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-809"><span class="MJXp-msubsup" id="MJXp-Span-810"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-811" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-812" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-813" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-815" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-816"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-818" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-819" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-820"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-822" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-823" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-824"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-825" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-826" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-827" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-829" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-830"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-124-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-124">P_i = S + H_s(D_i, h_t, i)G</script> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  4. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-831"><span class="MJXp-msubsup" id="MJXp-Span-832"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-834" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-835" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-836"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-838" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-839" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-840"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-841" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-842" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-843" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-844"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-846" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-847" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-849" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-125-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-125">Q_i = H_s(h_t, v_s, i)V</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (wherein </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-851"><span class="MJXp-msubsup" id="MJXp-Span-852"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-854" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-855" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-857"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-859" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-126-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-126">Q_i = v D_i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">however view key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-860"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-127-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-127">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recipient unknown) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  5. Pair</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-862"><span class="MJXp-mo" id="MJXp-Span-863" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-864"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-866" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-867" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-868"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-869" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-870" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-871" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-128-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-128">(P_i, Q_i)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - public exit keys </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-872"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-129-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-129">i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To accept the money, Bob analyzes all transactions as follows. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  6. For each transaction, calculates</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-874"><span class="MJXp-msubsup" id="MJXp-Span-875"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-877" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-878" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mo" id="MJXp-Span-880" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mo" id="MJXp-Span-883" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-889"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mo" id="MJXp-Span-890" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mo" id="MJXp-Span-893" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mo" id="MJXp-Span-901" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-130-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-130">h_t = H(tx.inputs, tx.version)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, then for each exit </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-902"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-131-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-131">i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  7.</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-904"><span class="MJXp-msubsup" id="MJXp-Span-905"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-907" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-908" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-909"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-911" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-912"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mn" id="MJXp-Span-913"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-914"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-916" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-132-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-132">D_i = v^{-1} Q_i</script><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  8. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-917"><span class="MJXp-msup" id="MJXp-Span-918"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-920" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">′</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-921" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-922"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-924" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-925" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-926"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-927" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-928" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-929" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-930"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-931" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-932" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-933" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-934"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-935" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-936" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-937" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-939" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-133-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-133">S’ = P_i — H_s(D_i, h_t, i) G</script> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  9. If </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-941"><span class="MJXp-msup" id="MJXp-Span-942"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-943" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-944" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">′</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-134-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-134">S’</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> matches the public key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-945"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-135-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-135">S</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bob, then this exit is intended for him and he increases the balance of his wallet by the corresponding face value. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To spend the output Bob is the recipient of and send Carol coins, he acts as follows. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  10. Using your secret keys</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-947"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-136-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-136">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-949"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-137-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-137">s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">calculates the secret part </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-951"><span class="MJXp-msubsup" id="MJXp-Span-952"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-954" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-138-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-138">P_i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-955"><span class="MJXp-msubsup" id="MJXp-Span-956"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-958" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-959" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-960"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-962" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-963"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mn" id="MJXp-Span-964"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-965"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-967" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-139-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-139">D_i = v^{-1} Q_i</script><br>
    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-968"><span class="MJXp-msubsup" id="MJXp-Span-969"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-971" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-972" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mo" id="MJXp-Span-974" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-975"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-977" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-978" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-979"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-981" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-982" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-983"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-985" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-986" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-988" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-140-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-140">x_i = s + H_s(D_i, h_t, i)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, it is easy to see that </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-989"><span class="MJXp-msubsup" id="MJXp-Span-990"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-991" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-992" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-993" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-994"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-996" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-141-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-141">P_i = x_i G</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(see paragraph 3). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  11. Bob calculates the key image:</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-998"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span><span class="MJXp-mo" id="MJXp-Span-1000" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1001"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1003" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-1004"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1005" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1006" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1007" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1008"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1010" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1011" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-142-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-142">I = x_i H_p(P_i)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and writes it, the face value and a link to the corresponding output in the input of his transaction for Carol. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  12. Bob reduces the balance of his wallet by the value of the output used. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  13. Bob forms the outputs in the transaction for Carol in accordance with </font><font style="vertical-align: inherit;">1-5. </font><font style="vertical-align: inherit;">Then signs the transaction and sends. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A feature of this scheme, unlike CryptoNote, is that anyone to whom Alice will transfer her secret hash</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1012"><span class="MJXp-msubsup" id="MJXp-Span-1013"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1015" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-143-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-143">v_s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, will be able to calculate the recipient address </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1016"><span class="MJXp-mo" id="MJXp-Span-1017" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-1019" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-1021" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-144-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-144">(V, S)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for any Alice transaction: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  14.</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1022"><span class="MJXp-msubsup" id="MJXp-Span-1023"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1025" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1026" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1027"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1028" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1029" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1030" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1031"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1033" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1034" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1035"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1037" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1038" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-1040" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-145-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-145">D_i = H_s(h_t, v_s, i) G</script><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fifteen. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1042"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-1044" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1045"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1047" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1048" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1049"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1051" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1052" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1053"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1054" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1055" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1056" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1057"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1059" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1060" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-1062" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-146-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-146">S = P_i — H_s(D_i, h_t, i) G</script> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  sixteen. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1064"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-1066" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1067"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1069" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1070" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1071"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1073" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1074" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1075"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1076" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1077" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1078" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1080"><span class="MJXp-mo" id="MJXp-Span-1081" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1082" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1083"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mn" id="MJXp-Span-1084"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1085"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1087" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-147-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-147">V = H_s(h_t, v_s, i)^{-1} Q_i</script><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, the problem in this case is the task of determining which transactions Alice generated and sent. </font><font style="vertical-align: inherit;">Without this information in p.p. </font><font style="vertical-align: inherit;">14-16 for arbitrary transactions will be obtained arbitrary useless data indistinguishable from real addresses</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1088"><span class="MJXp-mo" id="MJXp-Span-1089" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-1091" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-1093" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-148-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-148">(V, S)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">The coding algorithm may provide some help in this </font></font><code>encrypted_address_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, since for Alice’s transactions this field after decoding will have only valid values</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1094"><span class="MJXp-mo" id="MJXp-Span-1095" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{</font></font></span><span class="MJXp-mn" id="MJXp-Span-1096"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span><span class="MJXp-mo" id="MJXp-Span-1097" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mn" id="MJXp-Span-1098"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span><span class="MJXp-mo" id="MJXp-Span-1099" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-149-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-149">\{0, 1\}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">But, unfortunately, acceptable values ​​can also be obtained arbitrarily, and such a case cannot be distinguished. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since in this scheme the calculation of key image also requires knowledge of the secret spend-key</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-150-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-150">s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, then the audit problem, that is, calculating the exact balance of the wallet without transferring the rights to spend money, remains unresolved.</font></font><br>
<br>
<br>
<a name="a44"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.4. </font><font style="vertical-align: inherit;">tx.version ≥ amethyst, amethyst address</font></font></h3><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Constant h</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The operation of this cryptographic scheme requires the introduction of a new constant - the point </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1102"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1103"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-151-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-151">H</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">group element </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1104"><span class="MJXp-mrow" id="MJXp-Span-1105"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1106"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-152-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-152">\mathbf{G}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and the order of the point </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-153-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-153">H</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unknown. </font><font style="vertical-align: inherit;">In other words, this is some fixed public key, the secret part of which is guaranteed unknown and the probability of its finding is negligible:</font></font><br>
<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mo" id="MJXp-Span-1111" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-154-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-154">H = yG</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">where </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1114"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-155-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-155">y</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Is an unknown number. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, you can set</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1116"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1117"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-156-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-156">H</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">as proposed in [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]:</font></font><br>
<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mo" id="MJXp-Span-1120" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1122" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1123" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1124" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span><span class="MJXp-mo" id="MJXp-Span-1126" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-1127" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o</font></font></span><span class="MJXp-mi" id="MJXp-Span-1130"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mo" id="MJXp-Span-1136" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi" id="MJXp-Span-1139"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1143"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi" id="MJXp-Span-1144"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mo" id="MJXp-Span-1149" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span><span class="MJXp-mo" id="MJXp-Span-1151" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-1152" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-157-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-157">H = H_p(G) = to\_point( cn\_fast\_hash(G) )</script><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bytecoin developers do not calculate the constant, but set it numerically, without any indication of the nature of its origin: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bytecoin / src / crypto / crypto_helpers.hpp, line 67</font></font></a><pre><code class="cpp hljs"><span class="hljs-keyword">constexpr</span> P3 H{ge_p3{{<span class="hljs-number">7329926</span>, <span class="hljs-number">-15101362</span>, <span class="hljs-number">31411471</span>, <span class="hljs-number">7614783</span>, <span class="hljs-number">27996851</span>, <span class="hljs-number">-3197071</span>, <span class="hljs-number">-11157635</span>, <span class="hljs-number">-6878293</span>, <span class="hljs-number">466949</span>, <span class="hljs-number">-7986503</span>},    {<span class="hljs-number">5858699</span>, <span class="hljs-number">5096796</span>, <span class="hljs-number">21321203</span>, <span class="hljs-number">-7536921</span>, <span class="hljs-number">-5553480</span>, <span class="hljs-number">-11439507</span>, <span class="hljs-number">-5627669</span>, <span class="hljs-number">15045946</span>, <span class="hljs-number">19977121</span>, <span class="hljs-number">5275251</span>},    {<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>},    {<span class="hljs-number">23443568</span>, <span class="hljs-number">-5110398</span>, <span class="hljs-number">-8776029</span>, <span class="hljs-number">-4345135</span>, <span class="hljs-number">6889568</span>, <span class="hljs-number">-14710814</span>, <span class="hljs-number">7474843</span>, <span class="hljs-number">3279062</span>, <span class="hljs-number">14550766</span>, <span class="hljs-number">-7453428</span>}}};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, a search for this numerical sequence showed ([ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]) that they use the same constant as in Monero for RingCT, the calculation method of which and its justification were considered in [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Because the</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1153"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-158-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-158">H</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> belongs to the group </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1155"><span class="MJXp-mrow" id="MJXp-Span-1156"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1157"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-159-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-159">\mathbf{G}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, then we can say that </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1158"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-160-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-160">H</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> also spawns a group </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1160"><span class="MJXp-mrow" id="MJXp-Span-1161"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1162"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-161-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-161">\mathbf{G}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">as the base point </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1164"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-162-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-162">G</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It means that</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1165"><span class="MJXp-mi" id="MJXp-Span-1166"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∀</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mo" id="MJXp-Span-1168" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∈</font></font></span><span class="MJXp-mo" id="MJXp-Span-1169" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[</font></font></span><span class="MJXp-mn" id="MJXp-Span-1170"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span><span class="MJXp-mo" id="MJXp-Span-1171" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mo" id="MJXp-Span-1173" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mn" id="MJXp-Span-1174"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span><span class="MJXp-mo" id="MJXp-Span-1175" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]</font></font></span><span class="MJXp-mo" id="MJXp-Span-1176" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mo" id="MJXp-Span-1179" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∈</font></font></span><span class="MJXp-mrow" id="MJXp-Span-1180"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-1181"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-163-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-163"> \forall x \in [1,p-1], xH \in \mathbf{G}</script><br>
<br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Multiple unlinkable addresses</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the original CryptoNote, each wallet (that is, a set of secret keys) was associated with one public address, which was used to transfer funds to it. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The considered scheme allows generating an unlimited number of public addresses on the same set of secret keys. </font><font style="vertical-align: inherit;">Wherein:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">addresses are generated deterministically from the initial set of secrets;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">these addresses cannot be interconnected, i.e. </font><font style="vertical-align: inherit;">an outside observer will not be able to calculate that they belong to the same account;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verification of incoming transactions and accounting for </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1182"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-164-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-164">N</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> multiple addresses will be computationally easier than checking </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1184"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1185"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-165-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-165">N</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> accounts in the usual scheme.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wallet account represented by secret key. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1186"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-166-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-166">s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and hash </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1188"><span class="MJXp-msubsup" id="MJXp-Span-1189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1191" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-167-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-167">v_s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, as well as in the previous scheme. </font><font style="vertical-align: inherit;">However, based on the hash</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1192"><span class="MJXp-msubsup" id="MJXp-Span-1193"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1195" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-168-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-168">v_s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> now not only a secret view key is generated deterministically </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1196"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-169-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-169">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, but also an additional secret audit key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1198"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1199"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-170-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-170">a</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The process of generating the i-th address is as follows (Fig. 4.4.2).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/webt/fs/zs/mm/fszsmmq8ssss2a29wachfgumom8.png"></div><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">4.4.2. </font><font style="vertical-align: inherit;">Generation of amethyst addresses for the Bytecoin account (the calculated values ​​are highlighted in yellow, the disclosure of which does not threaten the disclosure of secret keys</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1200"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-171-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-171">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-172-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-172">s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1204"><span class="MJXp-msubsup" id="MJXp-Span-1205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1206" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1207" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-173-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-173">v_s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></sub></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  1. Calculated </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1208"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">δ</font></font></span><span class="MJXp-mo" id="MJXp-Span-1210" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1211"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1213" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1214" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span><span class="MJXp-mo" id="MJXp-Span-1216" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mo" id="MJXp-Span-1219" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-1221" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-174-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-174">\delta = H_s(A + sH, i)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1222"><span class="MJXp-mi" id="MJXp-Span-1223"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Δ</font></font></span><span class="MJXp-mo" id="MJXp-Span-1224" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">δ</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-175-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-175">\Delta = \delta G</script><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  2. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1227"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1228"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-1229" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span><span class="MJXp-mo" id="MJXp-Span-1231" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1233"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mo" id="MJXp-Span-1234" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mrow" id="MJXp-Span-1235"><span class="MJXp-mo" id="MJXp-Span-1236" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Δ</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-176-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-176">S = A + sH + Δ</script><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  3. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1237"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1238"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-1239" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-1242" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mo" id="MJXp-Span-1244" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span><span class="MJXp-mo" id="MJXp-Span-1246" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1247"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mo" id="MJXp-Span-1249" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mrow" id="MJXp-Span-1250"><span class="MJXp-mo" id="MJXp-Span-1251" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Δ</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1252" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-1253" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mo" id="MJXp-Span-1255" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span><span class="MJXp-mo" id="MJXp-Span-1257" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1259"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mo" id="MJXp-Span-1260" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-1261" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mrow" id="MJXp-Span-1262"><span class="MJXp-mo" id="MJXp-Span-1263" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">δ</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1264"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-177-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-177">V = vS = v(A + sH + Δ) = v(A + sH) + δV</script><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  4. pair </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1265"><span class="MJXp-mo" id="MJXp-Span-1266" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-1268" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-1270" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-1271" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mo" id="MJXp-Span-1272" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1273"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-1275" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-1277" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-178-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-178">(V, S) = (v S, S)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is an </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-179-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-179">i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The public address of this account. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Note that for the calculation it is enough to know the following values: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  •</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-180-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-180">A</script> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  • </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-181-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-181">V</script> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  • </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1284"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1286"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-182-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-182">s H</script> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  • </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mo" id="MJXp-Span-1289" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span><span class="MJXp-mo" id="MJXp-Span-1291" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mo" id="MJXp-Span-1294" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-183-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-183">v (A + s H)</script> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quantities </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1295"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-184-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-184">s H</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1298"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1299"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mo" id="MJXp-Span-1300" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span><span class="MJXp-mo" id="MJXp-Span-1302" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1303"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1304"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mo" id="MJXp-Span-1305" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-185-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-185">v (A + s H)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> are calculated when creating an account and are considered safe in the sense that knowing them, you cannot calculate </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-186-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-186">s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1308"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1309"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-187-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-187">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Generated addresses are stored locally in a container optimized for field search.</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1310"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-188-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-188">S</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formation of exits when sending funds</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alice sending money to Bob at his address </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1312"><span class="MJXp-mo" id="MJXp-Span-1313" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-1315" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-1317" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-189-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-189">(V, S)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> forms the outputs of its transaction as follows (Fig. 4.4.3).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ih/1m/p2/ih1mp2wrtbc8lw_vibkzoxoumqa.png"></div><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">4.4.3. </font><font style="vertical-align: inherit;">Formation of transaction outputs when sending funds to an Amethyst address</font></font></sub></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  1. Calculates </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1318"><span class="MJXp-msubsup" id="MJXp-Span-1319"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1321" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1322" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mo" id="MJXp-Span-1324" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1325"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mo" id="MJXp-Span-1327" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1329"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mo" id="MJXp-Span-1334" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mo" id="MJXp-Span-1337" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1340"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1343"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mo" id="MJXp-Span-1345" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-190-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-190">h_t = H(tx.inputs, tx.version)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, then for each exit </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-191-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-191">i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  2.</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1348"><span class="MJXp-msubsup" id="MJXp-Span-1349"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1350" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1351" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1352" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1353"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1354" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1355" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1356" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1357"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1359" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1360" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1361"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1363" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1364" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1365"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1367" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1368" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1369"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-1370" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-1371" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1372"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1374" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1375" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1376"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1377"><span class="MJXp-mo" id="MJXp-Span-1378" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1379" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1380"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mn" id="MJXp-Span-1381"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1382"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-192-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-192">P_i = H_s( H_p(h_t, v_s, i), h_t, i )^{-1} S</script> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  3. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1383"><span class="MJXp-msubsup" id="MJXp-Span-1384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1386" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1387" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1390" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1391" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1392"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1393" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1394" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1395" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1396"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1397" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1398" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1399" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1400"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1401" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1402" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1403" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-1405" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-1406" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1407"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1408" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1409" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1410" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1412"><span class="MJXp-mo" id="MJXp-Span-1413" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1414" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1415"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mn" id="MJXp-Span-1416"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1417"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-1418" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1421" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1422" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1423"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1424" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1425" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1426" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1427"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1428" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1429" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1430" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-1432" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-193-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-193">Q_i = H_s( H_p(h_t, v_s, i), h_t, i )^{-1} V + H_p(h_t, v_s, i)</script> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  4. Couple </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1433"><span class="MJXp-mo" id="MJXp-Span-1434" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1435"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1436" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1437" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1438" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1441" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1442" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-194-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-194">(P_i, Q_i)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - public exit keys </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1444"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-195-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-195">i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Accounting for Incoming Payments</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To accept the money, Bob analyzes all transactions as follows (Fig. 4.4.4.).</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/webt/er/o1/xd/ero1xd3psrxhdsq16kaxiyva3f0.png"></div><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">4.4.4. </font><font style="vertical-align: inherit;">Analysis of transaction outputs for incoming transfers</font></font></sub></td>
</tr>
</tbody></table></div><ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For each exit </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1446"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-196-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-196">i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">using a secret view key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1447"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1448"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-197-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-197">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bob computes:</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1449"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">K</font></font></span><span class="MJXp-mo" id="MJXp-Span-1451" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1452"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1454" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1455" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1456"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1458" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1459" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1460"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1461" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1462" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1463" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-1465" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-1466" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1467"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1468" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1469" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1470" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1471"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1472"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1473" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1474" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-198-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-198">K = H_p(h_t, v_s, i) = Q_i — v P_i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><code>output_shared_secret</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in code)</font></font></li>
<li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1475"><span class="MJXp-msup" id="MJXp-Span-1476"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1477" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1478" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">′</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1479" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1480"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1481" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1482" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1483" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">K</font></font></span><span class="MJXp-mo" id="MJXp-Span-1485" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1486"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1487" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1488" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1489" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-1491" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1492"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1493" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1494" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-199-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-199">S’ = H_s(K, h_t, i) P_i</script></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After which he tries to find </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1495"><span class="MJXp-msup" id="MJXp-Span-1496"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1498" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">′</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-200-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-200">S’</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in your address list. </font><font style="vertical-align: inherit;">If it finds, it means that this exit transfers money to Bob. </font><font style="vertical-align: inherit;">It increases the balance for the corresponding address.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This means that in order to correctly take into account incoming payments, in this scheme, in addition to the list of addresses or keys for generating them, you need to know the secret view key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-201-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-201">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formation of outgoing payments</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To spend a way out </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-202-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-202">i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">which Bob is the recipient, and send the coins to Carol, he acts as follows.</font></font><br>
<br>
<ol>
<li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1503"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1504"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">K</font></font></span><span class="MJXp-mo" id="MJXp-Span-1505" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1506"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1507" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1508" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1509" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1510"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1512" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1513" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1514"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1516" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1517" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-1519" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-1520" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1523" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1524" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1525"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1526"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1527" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1528" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-203-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-203">K = H_p(h_t, v_s, i) = Q_i — v P_i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><code>output_shared_secret</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in code)</font></font></li>
<li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1529"><span class="MJXp-msubsup" id="MJXp-Span-1530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1531" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1532" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1533" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1534"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1535" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1536" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1537" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1538"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">K</font></font></span><span class="MJXp-mo" id="MJXp-Span-1539" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1540"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1541" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1542" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1543" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1544"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1545"><span class="MJXp-mo" id="MJXp-Span-1546" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1547" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1548"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mn" id="MJXp-Span-1549"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-1550" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1551"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span><span class="MJXp-mo" id="MJXp-Span-1552" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1553"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">δ</font></font></span><span class="MJXp-mo" id="MJXp-Span-1554" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-204-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-204">x_i = H_s(K, h_t, i)^{-1} (a + \delta)</script></li>
<li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1555"><span class="MJXp-msubsup" id="MJXp-Span-1556"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1557" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1558" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1559" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1560"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1561" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1562" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1563"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span><span class="MJXp-mo" id="MJXp-Span-1564" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1565"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1566" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1567" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1568" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1569"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">K</font></font></span><span class="MJXp-mo" id="MJXp-Span-1570" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1571"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1573" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1574" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1576"><span class="MJXp-mo" id="MJXp-Span-1577" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1578" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1579"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mn" id="MJXp-Span-1580"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1581"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1582"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-205-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-205">X_i = x_i G + H_s(K, h_t, i)^{-1} s H</script></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Calculates key image </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1583"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1584"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span><span class="MJXp-mo" id="MJXp-Span-1585" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1586"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1588" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1589" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1590"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1591" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1592" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1593" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1595" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1596" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1597" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-206-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-206">I = x_i * H_p(X_i)</script></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bob reduces the balance related to his address </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-1600" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1601"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1602" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1603" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1604" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">K</font></font></span><span class="MJXp-mo" id="MJXp-Span-1606" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1607"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1608" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1609" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1610" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1611"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-1612" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1613"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1614" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1615" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-207-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-207">S = H_s(K, h_t, i) P_i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> by the nominal value of the corresponding output.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bob generates transaction outputs, signs it, and sends it.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is seen that to calculate the key image requires knowledge of not only the secret view key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1616"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1617"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-208-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-208">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, but also </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1618"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1619"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-209-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-209">a</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An important feature of this scheme is the </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ability to calculate a key image</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (and, therefore, take into account its outgoing payments, therefore, balance calculation) </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">without using a secret spend-key</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1621"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-210-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-210">s</script></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Audit Recipient Address Disclosure</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As well as the previous one, this cryptographic scheme allows you to extract recipient addresses from transaction outputs if the sender’s secret hash is known </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1622"><span class="MJXp-msubsup" id="MJXp-Span-1623"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1624" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1625" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-211-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-211">v_s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This happens as follows (Fig. 4.4.5).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/webt/an/mr/07/anmr07uvnutogvzorjoxdb2k-jw.png"></div><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">4.4.5. </font><font style="vertical-align: inherit;">Auditor possessing</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1626"><span class="MJXp-msubsup" id="MJXp-Span-1627"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1628" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1629" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-212-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-212">v_s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, restores information on incoming / outgoing payments, balance and addresses of recipients</font></font></sub></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suppose Alice passed </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1630"><span class="MJXp-msubsup" id="MJXp-Span-1631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1632" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1633" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-213-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-213">v_s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1634"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1635"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1636"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-214-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-214">s H</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Carol. </font><font style="vertical-align: inherit;">Then Carol:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recover secret keys </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1637"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1638"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-215-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-215">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1639"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1640"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-216-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-216">a</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, will restore Alice's address list.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Will scan the blockchain for each output. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1641"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-217-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-217">i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> each transaction will determine if it is an incoming payment, trying to find</font></font><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1643"><span class="MJXp-msup" id="MJXp-Span-1644"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1645" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1646" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">′</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1647" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1648"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1649" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1650" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1651" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1652"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1654" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1655" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1656"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1657"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1658" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1659" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1660" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1661"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1662" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1663" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1664" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-1666" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1667"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1668" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1669" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-218-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-218">S’ = H_s(Q_i — v P_i, h_t, i) P_i</script><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
among the addresses of Alice.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If it finds, then Carol will increase the balance of the corresponding address and, with </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1670"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1671"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-219-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-219">a</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1672"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1673"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-220-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-220">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, will compute key image (see above) and save it locally.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If Alice's key image is found among transaction inputs, then this will mean that this transaction is Alice's outgoing payment. </font><font style="vertical-align: inherit;">Carol will recover recipient addresses for all outputs of this transaction:</font></font><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1674"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1675"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-1676" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1677"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1678" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1679" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-1680"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1681" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1682" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1683" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1684"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1685" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1686" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1687" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1688"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1690" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1691" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1692"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1693" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1694" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1695" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-1697" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-1698" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1700" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1701" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1702" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1703"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-1704" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-221-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-221">S = P_i H_s(H_p(h_t, v_s, i), h_t, i)</script><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1705"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1706"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-1707" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mo" id="MJXp-Span-1708" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1709"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1710" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1711" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1712" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1713"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1714" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1715" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1716" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1717"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1718" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1719" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1720" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1721"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1722" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1723" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1724" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1725"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-1726" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-1727" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1729" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1730" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1731" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1732"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1733" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1734" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1735" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1736"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1737" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1738" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1739" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1740"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1741" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1742" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1743" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1744"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-1745" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-1746" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1749" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1750" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-1752" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-222-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-222">V = (Q_i — H_p(h_t, v_s, i)) H_s(H_p(h_t, v_s, i), h_t, i)</script><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
and reduce the balance of the corresponding Alice address by the value of the input value.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thus, revealing part of the account data, you can provide third parties with different levels of access to information. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To generate a list of your addresses: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  •</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1753"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1754"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-223-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-223">A</script> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  • </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1755"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1756"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-224-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-224">V</script> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  • </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1757"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1759"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-225-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-225">s H</script> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  • </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1760"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1761"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mo" id="MJXp-Span-1762" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1763"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span><span class="MJXp-mo" id="MJXp-Span-1764" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1765"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1766"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mo" id="MJXp-Span-1767" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-226-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-226">v (A + s H)</script> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To recognize only incoming payments: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  •</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1768"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1769"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-227-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-227">A</script> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  • </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1770"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1771"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-228-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-228">v</script> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  • </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1772"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1773"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-229-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-229">s H</script> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To audit, i.e. </font><font style="vertical-align: inherit;">calculate the balance at your addresses, without disclosing the addresses of the recipients: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  •</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1775"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1776"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-230-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-230">a</script> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  • </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1777"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1778"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-231-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-231">v</script> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  • </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1779"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1780"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1781"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-232-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-232">s H</script> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To audit, i.e. </font><font style="vertical-align: inherit;">calculate the balance at your addresses, and disclose the addresses of the recipients: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  •</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1782"><span class="MJXp-msubsup" id="MJXp-Span-1783"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1784" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1785" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-233-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-233">v_s</script> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  • </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1786"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1787"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1788"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-234-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-234">s H</script> <br>
<br>
<br>
<a name="a45"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.5. </font><font style="vertical-align: inherit;">Comparing CryptoNote and Bytecoin Amethyst Transaction Signatures</font></font></h3><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data Structures and Signature Sizes</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As noted above, the implementation of the ability to audit wallets without revealing a secret spend key required Bytecoin Amethyst developers to increase the size of the data transmitted in each transaction output: compared to the original protocol, one public key and 1 byte are transferred to identify the type of address. </font><font style="vertical-align: inherit;">Total 33 bytes per output. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In CryptoNote, each transaction is signed separately for a transaction. </font><font style="vertical-align: inherit;">For each public key</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1789"><span class="MJXp-msubsup" id="MJXp-Span-1790"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1791" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1792" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-235-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-235">P_i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> of some output to which this input refers, a pair of scalars is written in the signature </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1793"><span class="MJXp-mo" id="MJXp-Span-1794" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1795"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span><span class="MJXp-mo" id="MJXp-Span-1796" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1797"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></span><span class="MJXp-mo" id="MJXp-Span-1798" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-236-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-236">(r,c)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">total size of 64 bytes. </font><font style="vertical-align: inherit;">(An entry can refer to several exits, only one of which is real, and the rest serve to anonymize the transfer.) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thus, if the transaction</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1799"><span class="MJXp-msubsup" id="MJXp-Span-1800"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1801" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1802" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1803"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1804"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1806"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1807"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1808"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-237-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-237">N_{inputs}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> inputs, each of which refers to </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1809"><span class="MJXp-msubsup" id="MJXp-Span-1810"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1811" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1812" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1813"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1814"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1815"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1816"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1817"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1818"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-238-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-238">N_{mixins}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> outputs, the total size of the signature in bytes can be expressed as:</font></font><br>
<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1819"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1820"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-1821" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mn" id="MJXp-Span-1822"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">32</font></font></span><span class="MJXp-mo" id="MJXp-Span-1823" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-mn" id="MJXp-Span-1824"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span><span class="MJXp-mo" id="MJXp-Span-1825" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1826"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1827" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1828" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1829"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1830"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1831"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1832"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1833"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1834"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-1835" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1836"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1837" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1838" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1839"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1840"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1841"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1842"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1843"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1844"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-239-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-239">S = 32 * 2 * N_{mixins} * N_{inputs}</script><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The minimum signature size for a transaction is 64 bytes (one input that spends one output directly). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Bytecoin Amethyst, the entire transaction is signed, and the corresponding data structure is complicated (Fig. 4.5.1).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/webt/9a/y0/i3/9ay0i3bxfsdc8csebgj1qwiokcc.png"></div><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">4.5.1. </font><font style="vertical-align: inherit;">Comparing Transaction Signature Structure in CryptoNote and Bytecoin</font></font></sub></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For each transaction input, a period, two scalars and another </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1845"><span class="MJXp-msubsup" id="MJXp-Span-1846"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1847" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1848" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1849"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1850"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1851"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1852"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1853"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1854"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-240-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-240">N_{mixins}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scalars. </font><font style="vertical-align: inherit;">Another signature is also added to the entire signature. </font><font style="vertical-align: inherit;">Total, the total size of the signature in bytes can be expressed as:</font></font><br>
<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1855"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1856"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-1857" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mn" id="MJXp-Span-1858"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">32</font></font></span><span class="MJXp-mo" id="MJXp-Span-1859" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-mo" id="MJXp-Span-1860" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mo" id="MJXp-Span-1861" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mn" id="MJXp-Span-1862"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></span><span class="MJXp-mo" id="MJXp-Span-1863" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1864"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1865" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1866" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1867"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1868"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1869"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1870"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1871"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1872"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-1873" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-1874" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1875"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1876" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1877" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1878"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1879"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1880"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1881"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1882"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1883"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-1884" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mn" id="MJXp-Span-1885"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span><span class="MJXp-mo" id="MJXp-Span-1886" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-241-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-241">S = 32 * ((3 + N_{mixins}) * N_{inputs} + 1)</script><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The minimum signature size for a transaction is 160 bytes (one input that spends one output directly). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It can be seen that both functions grow in proportion to the product</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1887"><span class="MJXp-msubsup" id="MJXp-Span-1888"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1889" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1890" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1891"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1892"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1893"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1894"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1895"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1896"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-1897" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1898"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1899" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1900" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1901"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1902"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1903"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1904"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1905"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1906"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-242-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-242">N_{mixins} * N_{inputs} </script><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To compare the difference in transaction signature sizes more clearly, we calculate them for the most characteristic values </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1907"><span class="MJXp-msubsup" id="MJXp-Span-1908"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1909" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1910" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1911"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1912"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1913"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1914"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1915"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1916"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-243-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-243">N_{mixins}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1917"><span class="MJXp-msubsup" id="MJXp-Span-1918"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1919" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1920" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1921"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1922"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1923"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1924"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1925"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1926"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-244-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-244">N_{inputs}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and make a table (Fig. 4.5.2).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/webt/eo/gd/49/eogd49lmdbfd-slomfutofqayl8.png"></div><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">4.5.2. </font><font style="vertical-align: inherit;">The difference in the size of the Bytecoin transaction signature compared to CryptoNote (as a percentage of the size of the CryptoNote signature; the green is the gain in the size of the Bytecoin signature)</font></font></sub></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As you can easily see, in a situation where there is no mixing of outputs and there is a direct waste of funds (</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1927"><span class="MJXp-msubsup" id="MJXp-Span-1928"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1929" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1930" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1931"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1932"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1933"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1934"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1935"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1936"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-1937" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mn" id="MJXp-Span-1938"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-245-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-245">N_{mixins} = 1</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), or when one output is mixed (</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1939"><span class="MJXp-msubsup" id="MJXp-Span-1940"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1941" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1942" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1943"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1944"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1945"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1946"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1947"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1948"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-1949" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mn" id="MJXp-Span-1950"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-246-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-246">N_{mixins} = 2</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), Bytecoin's signature size is larger than CryptoNote up to 150%. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When mixing two outputs (</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1951"><span class="MJXp-msubsup" id="MJXp-Span-1952"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1953" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1954" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1955"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1956"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1957"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1958"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1959"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1960"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-1961" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mn" id="MJXp-Span-1962"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-247-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-247">N_{mixins} = 3</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) the sizes of signatures in one and the other scheme practically coincide. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
With a further increase in the number of mixed outputs, the size of the Bytecoin signature is smaller. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is worth noting that Bytecoin developers with the release of version 3.4.0 Amethyst in order to increase anonymity set the minimum number of mixed outputs to 3 [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]. </font><font style="vertical-align: inherit;">In such circumstances, the Bytecoin signature will have a smaller size.</font></font><br>
<br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The complexity of signature verification</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition to the size of the ring signature, which directly affects the size of the blockchain, another important characteristic is the computational complexity of its verification. It determines such important parameters of the cryptocurrency system as, for example, the speed of synchronization with the network of new nodes and the computational load on the network with a large flow of transactions. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The complexity of signing verification for CryptoNote and Bytecoin could be easily compared practically by simply writing a test that generates and then verifies a large number of signatures with given</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1963"><span class="MJXp-msubsup" id="MJXp-Span-1964"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1965" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1966" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1967"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1968"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1969"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1970"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1971"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1972"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-248-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-248">N_{mixins}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1973"><span class="MJXp-msubsup" id="MJXp-Span-1974"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1975" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1976" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1977"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1978"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1979"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1980"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1981"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1982"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-249-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-249">N_{inputs}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, however, since later in the article we will consider the schemes that have not yet been implemented in practice, but only proposed in theory, it will be logical to laborious and evaluate these schemes empirically, according to the number of cryptographic operations used. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CryptoNote and Bytecoin use several basic primitives (see section 2). </font><font style="vertical-align: inherit;">In the table in fig. </font><font style="vertical-align: inherit;">4.5.3. </font><font style="vertical-align: inherit;">the typical runtime of the most commonly used primitives is given on a modern middle-end computer with a Core i5-6500 processor (for comparison, the original source code compiled in Microsoft Visual Studio 2017 with all possible speed optimizations was used).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/webt/s2/wm/bi/s2wmbiwsgvn1qt5sgsywvazr5xs.png"></div><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">4.5.3. </font><font style="vertical-align: inherit;">The characteristic time of the main cryptographic operations</font></font></sub></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The results obtained from tests in Bytecoin and CryptoNote are in good agreement. </font><font style="vertical-align: inherit;">It is easy to see that the largest contribution will be made by the operation of multiplying the scalar by a point, and, to a lesser extent, the procedure for computing the hash function</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1983"><span class="MJXp-msubsup" id="MJXp-Span-1984"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1985" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1986" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-250-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-250">H_p</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, while the operations of adding two points and computing a hash function </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1987"><span class="MJXp-msubsup" id="MJXp-Span-1988"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1989" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1990" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-251-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-251">H_s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">will not significantly affect complexity. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consider the CryptoNote ring signature verification procedure (Fig. 4.5.4, the signature generation procedure was discussed in detail in [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ] and will not be considered here).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ft/mj/hl/ftmjhlnbs7t5gbuqjaxw9-so4ym.png"></div><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">4.5.4. </font><font style="vertical-align: inherit;">CryptoNote Ring Signature Verification Scheme</font></font></sub></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As already noted, in CryptoNote, each transaction input is signed separately, respectively, and each input is also checked separately. </font><font style="vertical-align: inherit;">Therefore, the verifier for each transaction input verifies the corresponding line (in the figure) of the signature as follows.</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For each pair of values </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1991"><span class="MJXp-msubsup" id="MJXp-Span-1992"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1993" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1994" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-252-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-252">r_j</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1995"><span class="MJXp-msubsup" id="MJXp-Span-1996"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1997" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1998" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-253-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-253">c_j</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> using key-image input </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1999"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-254-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-254">I</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and public key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2001"><span class="MJXp-msubsup" id="MJXp-Span-2002"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2003" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2004" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-255-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-255">P_j</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> of the next output to which this input refers, the values ​​are calculated:</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2005"><span class="MJXp-msubsup" id="MJXp-Span-2006"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2007" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2008" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2009" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2010"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2011" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2012" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2013"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span><span class="MJXp-mo" id="MJXp-Span-2014" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2015"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2016" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2017" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-2018"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2019" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2020" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-256-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-256">L_j = r_j G + c_j P_j</script><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2021"><span class="MJXp-msubsup" id="MJXp-Span-2022"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2023" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2024" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2025" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2026"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2027" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2028" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-2029"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2030" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2031" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2032" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2033"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2034" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2035" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2036" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-2037" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2038"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2039" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2040" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2041"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-257-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-257">R_j = r_j H_p(P_j) + c_j I</script><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(in this case, index j runs from 0 to </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2042"><span class="MJXp-msubsup" id="MJXp-Span-2043"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2044" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2045" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2046"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2047"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2048"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2049"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2050"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2051"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-258-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-258">N_{mixins}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The amount is calculated </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2052"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2053"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-259-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-259">c</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> of all </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2054"><span class="MJXp-msubsup" id="MJXp-Span-2055"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2056" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2057" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-260-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-260">c_j</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The hash is calculated </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2058"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2059"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></span><span class="MJXp-mo" id="MJXp-Span-2060" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">''</font></font></span><span class="MJXp-mo" id="MJXp-Span-2061" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2062"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2063" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2064" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2065" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2066"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2067"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi" id="MJXp-Span-2068"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2069"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2070"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2071"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2072"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2073"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2074"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi" id="MJXp-Span-2075"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2076"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2077"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2078"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2079"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span><span class="MJXp-mo" id="MJXp-Span-2080" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2081"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2082" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2083" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2084" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></span><span class="MJXp-mo" id="MJXp-Span-2085" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></span><span class="MJXp-mo" id="MJXp-Span-2086" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2087"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2088" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2089" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2090" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2092" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2093" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2094" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></span><span class="MJXp-mo" id="MJXp-Span-2095" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></span><span class="MJXp-mo" id="MJXp-Span-2096" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2097"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2098" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2099" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-261-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-261">c`=H_s(tx\_prefix\_hash, L_0 ... L_n, R_0 ... R_n</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
where </font></font><code>tx_prefix_hash</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is the hash of the prefix part of the transaction (without a signature).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Equality checked </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2101"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></span><span class="MJXp-mo" id="MJXp-Span-2102" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">''</font></font></span><span class="MJXp-mo" id="MJXp-Span-2103" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2104"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-262-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-262">c` = c</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">If it is, then the ring signature is considered valid.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let us estimate the number of scalar multiplication operations by a point and hash calculations </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2105"><span class="MJXp-msubsup" id="MJXp-Span-2106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2107" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2108" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-263-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-263">H_p</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Every calculation</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2109"><span class="MJXp-msubsup" id="MJXp-Span-2110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2111" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2112" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-264-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-264">L_j</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2113"><span class="MJXp-msubsup" id="MJXp-Span-2114"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2115" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2116" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-265-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-265">R_j</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">requires two scalar multiplications. </font><font style="vertical-align: inherit;">Number of pairs</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2117"><span class="MJXp-msubsup" id="MJXp-Span-2118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2119" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2120" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2121" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2122"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2123" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2124" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-266-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-266">L_j, R_j</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> corresponds to the number of outputs to be mixed </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2125"><span class="MJXp-msubsup" id="MJXp-Span-2126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2127" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2128" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2129"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2130"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2131"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2132"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2133"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2134"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-267-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-267">N_{mixins} </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for each entry. </font><font style="vertical-align: inherit;">Therefore, we have:</font></font><br>
<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2136"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O</font></font></span><span class="MJXp-mo" id="MJXp-Span-2137" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mo" id="MJXp-Span-2138" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-mo" id="MJXp-Span-2139" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-2140" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2142" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2143" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2144"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2145"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2146"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2147"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2148"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2149"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2150" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-mn" id="MJXp-Span-2151"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></span><span class="MJXp-mo" id="MJXp-Span-2152" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2153"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2154" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2155" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2156"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2157"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2158"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2159"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2160"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2161"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-268-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-268">O(*) = N_{inputs} * 4 * N_{mixins}</script><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this case, the hash function </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2162"><span class="MJXp-msubsup" id="MJXp-Span-2163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2164" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2165" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-269-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-269">H_p</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> used once per calculation </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2166"><span class="MJXp-msubsup" id="MJXp-Span-2167"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2168" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2169" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-270-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-270">R_j</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, hence:</font></font><br>
<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2171"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O</font></font></span><span class="MJXp-mo" id="MJXp-Span-2172" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2174" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2175" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2176" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-2177" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2178"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2179" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2180" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2181"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2182"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2183"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2184"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2185"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2186"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2187" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2188"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2189" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2190" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2191"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2192"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2193"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2194"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2195"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2196"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-271-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-271">O(H_p) = N_{inputs} * N_{mixins}</script><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now, consider the ring signature verification algorithm in Bytecoin Amethyst (Fig. 4.5.5).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/webt/g-/f_/2w/g-f_2wjgyllduo0y9zwqlwosdsu.png"></div><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">4.5.5. </font><font style="vertical-align: inherit;">Bytecoin Amethyst ring signature verification scheme</font></font></sub></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The entire signature is checked entirely, for all inputs at once. </font><font style="vertical-align: inherit;">It happens like this:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The prefix hash of the transaction is written to the hash buffer (without signature).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For each entry </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2197"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2198"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-272-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-272">i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (signature line in the figure):</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Calculated </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2199"><span class="MJXp-msubsup" id="MJXp-Span-2200"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2201" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2202" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-273-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-273">H_s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> according to all data of the hash buffer and the result is compared with the value </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2203"><span class="MJXp-msubsup" id="MJXp-Span-2204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2205" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2206" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-274-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-274">c_0</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. A signature is considered valid if equality is respected.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let us estimate the number of scalar multiplication operations by a point and hash calculations </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2207"><span class="MJXp-msubsup" id="MJXp-Span-2208"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2209" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2210" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-275-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-275">H_p</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Every calculation</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2211"><span class="MJXp-msubsup" id="MJXp-Span-2212"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2213" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2214" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-276-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-276">Y_j</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2215"><span class="MJXp-msubsup" id="MJXp-Span-2216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2217" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Z</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2218" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-277-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-277">Z_j</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> requires two scalar multiplications, plus calculation </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2220"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-278-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-278">X</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">requires three scalar multiplications. </font><font style="vertical-align: inherit;">Number of pairs</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2221"><span class="MJXp-msubsup" id="MJXp-Span-2222"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2223" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2224" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2225" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2226"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2227" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Z</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2228" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-279-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-279">Y_j, Z_j</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> corresponds to the number of outputs to be mixed </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2229"><span class="MJXp-msubsup" id="MJXp-Span-2230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2231" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2232" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2233"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2234"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2235"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2236"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2237"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2238"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-280-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-280">N_{mixins}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for each entry. </font><font style="vertical-align: inherit;">Therefore, we have:</font></font><br>
<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2240"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O</font></font></span><span class="MJXp-mo" id="MJXp-Span-2241" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mo" id="MJXp-Span-2242" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-mo" id="MJXp-Span-2243" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-2244" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2245"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2246" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2247" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2248"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2249"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2250"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2251"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2252"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2253"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2254" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-mo" id="MJXp-Span-2255" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mn" id="MJXp-Span-2256"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></span><span class="MJXp-mo" id="MJXp-Span-2257" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mn" id="MJXp-Span-2258"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></span><span class="MJXp-mo" id="MJXp-Span-2259" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2260"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2261" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2262" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2263"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2264"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2265"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2266"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2267"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2268"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2269" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-281-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-281">O(*) = N_{inputs} * (3 + 4 * N_{mixins})</script><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this case, the hash function </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2270"><span class="MJXp-msubsup" id="MJXp-Span-2271"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2272" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2273" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-282-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-282">H_p</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> used once per calculation </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2274"><span class="MJXp-msubsup" id="MJXp-Span-2275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2276" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Z</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2277" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-283-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-283">Z_j</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and once for calculating </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2279"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-284-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-284">B</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for each of the inputs, therefore:</font></font><br>
<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2281"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O</font></font></span><span class="MJXp-mo" id="MJXp-Span-2282" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2283"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2284" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2285" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2286" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-2287" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2288"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2289" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2290" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2291"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2292"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2293"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2294"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2295"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2296"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2297" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-mo" id="MJXp-Span-2298" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2300" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2301" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2302"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2303"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2304"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2305"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2306"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2307"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2308" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mn" id="MJXp-Span-2309"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span><span class="MJXp-mo" id="MJXp-Span-2310" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-285-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-285">O(H_p) = N_{inputs} * (N_{mixins} + 1)</script><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To visually compare the computational complexity of both algorithms on standard data, we introduce the following metric. </font><font style="vertical-align: inherit;">Add the number of scalar multiplication operations and calculation operations</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2311"><span class="MJXp-msubsup" id="MJXp-Span-2312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2313" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2314" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-286-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-286">H_p</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with weights proportional to the characteristic time taken to complete these operations:</font></font><br>
<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2316"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O</font></font></span><span class="MJXp-mo" id="MJXp-Span-2317" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2318"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2319"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2320"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2321"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2322"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l</font></font></span><span class="MJXp-mo" id="MJXp-Span-2323" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-2324" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mn" id="MJXp-Span-2325"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">130</font></font></span><span class="MJXp-mo" id="MJXp-Span-2326" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2327"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O</font></font></span><span class="MJXp-mo" id="MJXp-Span-2328" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mo" id="MJXp-Span-2329" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-mo" id="MJXp-Span-2330" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-2331" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mn" id="MJXp-Span-2332"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fifteen</font></font></span><span class="MJXp-mo" id="MJXp-Span-2333" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2334"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O</font></font></span><span class="MJXp-mo" id="MJXp-Span-2335" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2336"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2337" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2338" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2339" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-287-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-287">O(total) = 130 * O(*) + 15 * O(H_p)</script><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then compare the relative results for CryptoNote and Bytecoin in percent (Fig. 4.5.6).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/webt/l4/dn/oi/l4dnoideiqiud7hzhvjm8ruofqo.png"></div><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">4.5.6. </font><font style="vertical-align: inherit;">Computational complexity of Bytecoin Amethyst ring signature verification compared to CryptoNote (dependency on</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2340"><span class="MJXp-msubsup" id="MJXp-Span-2341"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2342" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2343" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2344"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2345"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2346"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2347"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2348"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2349"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-288-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-288">N_{inputs}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> missing)</font></font></sub></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As you can see, Bytecoin signature verification is a much more time-consuming operation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, as noted above, in Bytecoin from version 3.4.0 Amethyst, in order to increase anonymity, the minimum number of mixed outputs is set to 3 [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ], therefore, the worst practical value will not exceed 25% (in theory). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To summarize:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The size of each output is increased by the public key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2351"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-289-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-289">Q</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 32 bytes.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The size of the ring signature varies in comparison with the size of the CryptoNote signature depending on the number of outputs mixed (with a large number it turns out to be less):</font></font><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2352"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2353"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-2354" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mn" id="MJXp-Span-2355"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">32</font></font></span><span class="MJXp-mo" id="MJXp-Span-2356" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-mo" id="MJXp-Span-2357" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mo" id="MJXp-Span-2358" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mn" id="MJXp-Span-2359"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></span><span class="MJXp-mo" id="MJXp-Span-2360" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2361"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2362" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2363" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2364"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2365"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2366"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2367"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2368"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2369"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2370" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-2371" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2372"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2373" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2374" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2375"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2376"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2377"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2378"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2379"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2380"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2381" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mn" id="MJXp-Span-2382"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span><span class="MJXp-mo" id="MJXp-Span-2383" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-290-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-290">S = 32 * ((3 + N_{mixins}) * N_{inputs} + 1)</script></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Computational complexity is higher than in CryptoNote and significantly depends on the number of outputs to be mixed:</font></font><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2385"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O</font></font></span><span class="MJXp-mo" id="MJXp-Span-2386" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mo" id="MJXp-Span-2387" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-mo" id="MJXp-Span-2388" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-2389" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2390"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2391" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2392" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2393"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2394"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2395"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2396"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2397"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2398"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2399" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-mo" id="MJXp-Span-2400" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mn" id="MJXp-Span-2401"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></span><span class="MJXp-mo" id="MJXp-Span-2402" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mn" id="MJXp-Span-2403"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></span><span class="MJXp-mo" id="MJXp-Span-2404" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2405"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2406" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2407" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2408"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2409"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2410"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2411"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2412"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2413"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2414" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-291-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-291">O(*) = N_{inputs} * (3 + 4 * N_{mixins})</script><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2416"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O</font></font></span><span class="MJXp-mo" id="MJXp-Span-2417" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2419" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2420" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2421" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-2422" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2423"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2424" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2425" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2426"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2427"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2428"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2429"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2430"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2431"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2432" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-mo" id="MJXp-Span-2433" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2435" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2436" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2437"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2438"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2439"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2440"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2441"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2442"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2443" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mn" id="MJXp-Span-2444"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span><span class="MJXp-mo" id="MJXp-Span-2445" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-292-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-292">O(H_p) = N_{inputs} * (N_{mixins} + 1)</script></li>
</ol><br>
<br>
<br>
<a name="a5"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Option 2/3. </font><font style="vertical-align: inherit;">Audit Studies at CryptoNote by Anton Sokolov</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the fall of 2019, a series of essays [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">11</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">13</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">14</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">15</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">18</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ] about the audit problem in CryptoNote and possible ways to solve it authored by Anton Sokolov </font><font style="vertical-align: inherit;">was published on Medium.com </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">It theoretically considers several options for modifying the original protocol in such a way as to solve the audit task for a third party. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We consider the last of them [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">15</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ] as the most optimized. </font><font style="vertical-align: inherit;">We will abbreviate it as "AS". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Note: for consistency, spend keys will continue to be denoted by letters</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2447"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-293-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-293">s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2449"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-294-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-294">S</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, view keys in letters </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2451"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-295-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-295">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2452"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2453"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-296-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-296">V</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, despite the fact that in the original works are used </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2455"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-297-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-297">b</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2456"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2457"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-298-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-298">B</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2459"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-299-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-299">a</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2460"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2461"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-300-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-300">A</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> respectively.</font></font><br>
<br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Output Formation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The wallet account is represented by a set of three secret keys, not two, as in CryptoNote </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2462"><span class="MJXp-mo" id="MJXp-Span-2463" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2464"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mo" id="MJXp-Span-2465" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2466"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span><span class="MJXp-mo" id="MJXp-Span-2467" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2468"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></span><span class="MJXp-mo" id="MJXp-Span-2469" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-301-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-301">\{v, s, d\}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: view-, spend- and audit-keys, respectively. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A collection of three public keys</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2470"><span class="MJXp-mo" id="MJXp-Span-2471" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2472"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-2473" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2474"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-2475" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2476"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span><span class="MJXp-mo" id="MJXp-Span-2477" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-302-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-302">\{V, S, D\}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">represents the public address of this account. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alice, sending money to the bean, acts as follows (Fig. 5.1).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/webt/zg/om/i1/zgomi1yqmbjun5gni7zxl7atohw.png"></div><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">5.1. </font><font style="vertical-align: inherit;">Formation of transaction outputs in the AS scheme</font></font></sub></td>
</tr>
</tbody></table></div><ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bob publishes his address, so Alice knows his public keys </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2478"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2479"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-303-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-303">V</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2480"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2481"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-304-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-304">S</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2482"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2483"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-305-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-305">D</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Like CryptoNote, Alice picks a random secret transaction key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2484"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2485"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-306-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-306">r</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and calculates the public key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2486"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2487"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span><span class="MJXp-mo" id="MJXp-Span-2488" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2489"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2490"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-307-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-307">R = r G</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">which writes to the special field extra transactions.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For each output, Alice calculates not one, but two stealth addresses </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2491"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2492"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-308-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-308">P</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2493"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2494"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-309-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-309">T</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">The first is calculated similarly to CryptoNote:</font></font><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2495"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2496"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mo" id="MJXp-Span-2497" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2499" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2500" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2501" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2502"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2503"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-2504" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2505"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span><span class="MJXp-mo" id="MJXp-Span-2506" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2507"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-310-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-310">P = H_s(r V) G + S</script><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The second is different:</font></font><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2509"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></span><span class="MJXp-mo" id="MJXp-Span-2510" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2511"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2512" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2513" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2514" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2515"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2516"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span><span class="MJXp-mo" id="MJXp-Span-2517" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2518"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-311-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-311">T = H_s(r D) D</script><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The serial number of the output is not used in the original work, however, it is reasonable to assume that this is done for simplification and in practice it will be one of the function arguments </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2519"><span class="MJXp-msubsup" id="MJXp-Span-2520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2521" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2522" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-312-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-312">H_s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> similar to CryptoNote (see section 3).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alice signs and sends the transaction.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An outside observer will not be able to bind </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2523"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2524"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-313-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-313">P</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2525"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2526"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-314-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-314">T</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with Bob's address.</font></font><br>
<br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recognition of incoming payments and formation of inputs</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To accept and spend money, Bob acts as follows (Fig. 5.2).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/webt/jg/nr/n5/jgnrn5ch7oj8i5midkbzzeoe_eu.png"></div><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">5.2. </font><font style="vertical-align: inherit;">Definition of incoming transfers and formation of inputs for the transaction that spends them</font></font></sub></td>
</tr>
</tbody></table></div><ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Using your private view key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2527"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2528"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-315-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-315">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bob stealth address </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2529"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2530"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-316-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-316">P</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> compares each output with a point:</font></font><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2531"><span class="MJXp-msup" id="MJXp-Span-2532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2533" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2534" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">′</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2535" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2537" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2538" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2539" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2540"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2541"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span><span class="MJXp-mo" id="MJXp-Span-2542" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2543"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span><span class="MJXp-mo" id="MJXp-Span-2544" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2545"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-317-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-317">P’ = H_s(vR)G+S</script><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(this step is similar to CryptoNote)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In case equality is fulfilled, this means that this output is addressed to Bob. </font><font style="vertical-align: inherit;">He increases his balance by the value of the nominal output.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If necessary, transfer the funds received Carol, Bob, using their secret spend- and audit-keys </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2546"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2547"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-318-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-318">s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2549"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-319-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-319">d</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">computes </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">two</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> key image:</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2551"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-320-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-320">I</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2552"><span class="MJXp-mrow" id="MJXp-Span-2553"><span class="MJXp-munderover" id="MJXp-Span-2554"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2556" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¨</font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2555"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-321-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-321">\ddot I</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">The first is similar to CryptoNote:</font></font><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2557"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2558"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span><span class="MJXp-mo" id="MJXp-Span-2559" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2560"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mo" id="MJXp-Span-2561" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2562"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2563" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2564" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2565" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2566"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mo" id="MJXp-Span-2567" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-322-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-322">I = x * H_p(P)</script><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
and optional:</font></font><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2568"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2569"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mo" id="MJXp-Span-2570" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2571"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2572" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2573" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2574" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2575"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2576"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span><span class="MJXp-mo" id="MJXp-Span-2577" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2578"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-323-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-323">t = H_s(dR)d</script><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2579"><span class="MJXp-mrow" id="MJXp-Span-2580"><span class="MJXp-munderover" id="MJXp-Span-2581"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2583" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¨</font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2582"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2584" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2585"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2586"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2587" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2588" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2589" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2590"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mo" id="MJXp-Span-2591" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-324-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-324">\ddot I = t H_p(P)</script><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then he writes them, the face value and a link to the corresponding output into the input of his transaction for Carol.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Then Bob forms the transaction outputs for Carol, reduces his balance in proportion to the spent outputs, signs the transaction and sends.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you can see, here, as in CryptoNote, the third party - the Auditor - possessing only a secret view key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2592"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2593"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-325-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-325">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, can only recognize incoming transfers.</font></font><br>
<br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Audit</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If the Auditor also has a secret audit key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2595"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-326-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-326">d</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, then he will be able to recognize Bob's outgoing payments and calculate his balance as follows:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For each incoming payment, the Auditor will calculate and remember an additional key image </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2596"><span class="MJXp-mrow" id="MJXp-Span-2597"><span class="MJXp-munderover" id="MJXp-Span-2598"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2600" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¨</font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2599"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-327-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-327">\ddot I</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in local storage:</font></font><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2601"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2602"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mo" id="MJXp-Span-2603" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2605" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2606" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2607" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2608"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2609"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span><span class="MJXp-mo" id="MJXp-Span-2610" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2611"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-328-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-328">t = H_s(d R) d</script><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2612"><span class="MJXp-mrow" id="MJXp-Span-2613"><span class="MJXp-munderover" id="MJXp-Span-2614"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2616" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¨</font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2615"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2617" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2618"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2619"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2620" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2621" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2622" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2623"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mo" id="MJXp-Span-2624" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-329-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-329">\ddot I = t H_p(P)</script><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If in the inputs of any of the blockchain transactions an additional key image </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2625"><span class="MJXp-mrow" id="MJXp-Span-2626"><span class="MJXp-mo" id="MJXp-Span-2627" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ï</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-330-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-330">Ï</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If it coincides with one of the saved ones, this will mean that this transaction is Bob's outgoing payment. </font><font style="vertical-align: inherit;">The auditor will reduce the balance by the nominal value of the corresponding input.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thus, the Auditor, having a set of keys </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2628"><span class="MJXp-mo" id="MJXp-Span-2629" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2630"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mo" id="MJXp-Span-2631" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2632"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-2633" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2634"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></span><span class="MJXp-mo" id="MJXp-Span-2635" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-331-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-331">\{v, S, d\}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">will be able to recognize Bob's incoming and outgoing transfers on the blockchain and restore his correct balance. </font><font style="vertical-align: inherit;">At the same time, the Auditor will not be able to spend money, because </font><font style="vertical-align: inherit;">without secret spend key</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2636"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2637"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-332-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-332">s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> he will not be able to calculate the main key image </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2638"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2639"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-333-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-333">I</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The problem is solved.</font></font><br>
<br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ring signature</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Applying the ideas from [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ], the author managed to reduce the size of the signature compared to CryptoNote: now, for each input, only the signature is stored</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2640"><span class="MJXp-msubsup" id="MJXp-Span-2641"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2642" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2643" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2644"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2645"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2646"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2647"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2648"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2649"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2650" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mn" id="MJXp-Span-2651"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-334-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-334">N_{mixins} + 1</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> scalar (Fig. 5.3).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/webt/kn/yp/96/knyp961pqt2-r-noc4amogiuuia.png"></div><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">5.3. </font><font style="vertical-align: inherit;">Comparing Ring Signature Sizes in AS and CryptoNote</font></font></sub></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Thus, the signature size is almost halved. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consider the computational complexity of its verification. </font><font style="vertical-align: inherit;">The signature verification scheme is shown in Fig. </font><font style="vertical-align: inherit;">5.4.</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/webt/eh/4q/lb/eh4qlbaalytl00hc1r8xwutdzog.png"></div><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">5.4. </font><font style="vertical-align: inherit;">Ring signature verification scheme in AS</font></font></sub></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This algorithm is very similar in structure to that used in CryptoNote (see Fig. 4.5.4). </font><font style="vertical-align: inherit;">The check is carried out separately for each input and consists in sequentially calculating the values</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2652"><span class="MJXp-msubsup" id="MJXp-Span-2653"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2654" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2655" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-335-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-335">u_j</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2656"><span class="MJXp-msubsup" id="MJXp-Span-2657"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2658" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2659" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-336-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-336">L_j</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2660"><span class="MJXp-msubsup" id="MJXp-Span-2661"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2662" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2663" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-337-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-337">R_j</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2664"><span class="MJXp-msubsup" id="MJXp-Span-2665"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2666" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2667" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-338-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-338">c_j</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for all outputs used for mixing in this input. </font><font style="vertical-align: inherit;">As a result, the cycle of</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2668"><span class="MJXp-msubsup" id="MJXp-Span-2669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2670" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2671" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-339-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-339">c_j</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> should close and the value </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2672"><span class="MJXp-msubsup" id="MJXp-Span-2673"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2674" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2675" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2676"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mo" id="MJXp-Span-2677"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mn" id="MJXp-Span-2678"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-340-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-340">c_{n+1}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> must match </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2679"><span class="MJXp-msubsup" id="MJXp-Span-2680"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2681" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2682" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-341-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-341">c_0</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, in this case, the signature is considered valid. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The computational complexity of the algorithm is determined by six scalar multiplication operations and one calculation of the hash function</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2683"><span class="MJXp-msubsup" id="MJXp-Span-2684"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2685" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2686" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-342-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-342">H_p</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to iteration, the number which is the product </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2687"><span class="MJXp-msubsup" id="MJXp-Span-2688"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2689" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2690" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2691"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2692"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2693"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2694"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2695"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2696"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2697" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2698"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2699" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2700" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2701"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2702"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2703"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2704"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2705"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2706"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-343-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-343">N_{inputs} * N_{mixins}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comparison with CryptoNote by data and computational load</font></font></h3><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The size of the address increases by 50%, because </font><font style="vertical-align: inherit;">the address now represents a collection of three public keys:</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2707"><span class="MJXp-mo" id="MJXp-Span-2708" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2709"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-2710" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2711"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-2712" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2713"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span><span class="MJXp-mo" id="MJXp-Span-2714" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-344-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-344">\{V, S, D\}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">not two </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2715"><span class="MJXp-mo" id="MJXp-Span-2716" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2717"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-2718" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2719"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-2720" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-345-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-345">\{V, S\}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The encoded representation of the address will increase by about the same: for example, a standard Zano address containing two public keys takes 97 characters:</font></font><br>
<pre><code class="plaintext hljs">ZxD5UBX5PM3RTsEtTRd9ATUFxXyocoQzDRk3baVBahuWQJRK8QHTUT9GQM7jk7GoedK5B2nP4HxSPDpuLHvizpwj2q99bmz7t</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A similar Zano address containing three public keys will have a length of about 141 characters:</font></font><br>
<pre><code class="plaintext hljs">ZxD5UBX5PM3RTsEtTRd9ATUFxXyocoQzDRk3baVBahuWQJRK8QHTUT9GQM7jk7GoedK5B2nP4HxSPDpuLHvizpwjcenhnGbhpJFLk8vkhJywHCcht4d9EKA7CHHav1H6QPpB1cLsTvPfj</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The size of each output is increased by an additional stealth address </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2721"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2722"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-346-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-346">T</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 32 bytes.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The size of each input is increased by an additional key image </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2723"><span class="MJXp-mrow" id="MJXp-Span-2724"><span class="MJXp-munderover" id="MJXp-Span-2725"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-2727" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¨</font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2726"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-347-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-347">\ddot I</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 32 bytes.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The size of the ring signature is smaller than in CryptoNote:</font></font><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2729"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-2730" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mn" id="MJXp-Span-2731"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">32</font></font></span><span class="MJXp-mo" id="MJXp-Span-2732" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-mo" id="MJXp-Span-2733" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2735" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2736" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2737"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2738"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2739"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2740"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2741"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2742"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2743" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mn" id="MJXp-Span-2744"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span><span class="MJXp-mo" id="MJXp-Span-2745" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2746"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2747" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2748" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2749"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2750"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2751"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2752"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2753"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2754"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-348-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-348">S = 32 * (N_{mixins} + 1) N_{inputs}</script></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Computational complexity is higher than in CryptoNote:</font></font><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2755"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2756"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O</font></font></span><span class="MJXp-mo" id="MJXp-Span-2757" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mo" id="MJXp-Span-2758" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-mo" id="MJXp-Span-2759" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-2760" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2761"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2762" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2763" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2764"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2765"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2766"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2767"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2768"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2769"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2770" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-mn" id="MJXp-Span-2771"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></span><span class="MJXp-mo" id="MJXp-Span-2772" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2773"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2774" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2775" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2776"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2777"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2778"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2779"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2780"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2781"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-349-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-349">O(*) = N_{inputs} * 6 * N_{mixins}</script><br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2782"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2783"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O</font></font></span><span class="MJXp-mo" id="MJXp-Span-2784" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2785"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2786" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2787" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2788" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-2789" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2790"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2791" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2792" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2793"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2794"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2795"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2796"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2797"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2798"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2799" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2800"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2801" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2802" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2803"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2804"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2805"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2806"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2807"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2808"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-350-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-350">O(H_p) = N_{inputs} * N_{mixins}</script></li>
</ol><br>
<br>
<br>
<a name="a6"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. Option 3/3. </font><font style="vertical-align: inherit;">Audit through output mixing limit</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consider another way to implement auditing in CryptoNote.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mix_attr output attribute</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the Zano project, which is the successor to CryptoNote, the transaction output has an additional 8-bit mix_attr attribute, and a kernel rule restricting the use of outputs in mixing, depending on its value. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The structure of the outputs of CryptoNote and Bytecoin (Fig. 4.2) we can now supplement in this way (Fig. 6.1.).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/webt/8y/-o/-m/8y-o-mltqzfep_cq-kpo3ocrnfy.png"></div><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">6.1. </font><font style="vertical-align: inherit;">Comparing the data structure for CryptoNote, Zano, and Bytecoin Amethyst transaction outputs</font></font></sub></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The kernel rule restricting mixing according to mix_attr is this:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If mix_attr = 0, then there are no restrictions. </font><font style="vertical-align: inherit;">This output can be used to mix with other outputs in any combination. </font><font style="vertical-align: inherit;">This is the default value.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If mix_attr = 1, then this output can only be spent directly, without mixing, and cannot be used to mix with other outputs.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If mix_attr ≥ 2, then this output can be spent only when mixing others, while the total number of outputs used should not be less than the value of mix_attr.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The main feature of this innovation is paragraph 3, which allows one to increase untraceability (untraceability of bonds) by eliminating situations where the output already used in mixing is spent by its owner directly (this was described in detail in [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">19</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, in the context of this article, we will be interested in item 2, that is, the situation where mix_attr = 1 and the output marked in this way can only be spent directly. </font><font style="vertical-align: inherit;">This limitation is illustrated in fig. </font><font style="vertical-align: inherit;">6.2.</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ta/qs/_c/taqs_cs2drhdbvgpou1eq_jjkya.png"></div><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">6.2. </font><font style="vertical-align: inherit;">Limit illustration. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Above</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : input # 0 refers only to output # 0 with mix_attr = 1 (direct waste) - a valid situation. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bottom</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : input # 1 refers to three outputs: output # 2 with mix_attr = 1 and also to output # 1 and output # 3 - an invalid situation</font></font></sub></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Since output # 2 has mix_attr = 1, it cannot be mixed with other outputs, regardless of their mix_attr attribute values. </font><font style="vertical-align: inherit;">It can only be spent directly, as output # 0. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This feature can be used to organize an audit.</font></font><br>
<br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Audit with mix_attr = 1</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As noted in Section 3, if, under the original CryptoNote protocol, Auditor Dan receives a secret key from Bob </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2809"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2810"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-351-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-351">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, he will be able to recognize incoming transactions, but he will not be able to recognize outgoing transactions, so accurate calculation of the balance is impossible. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nevertheless, since Den will have complete information about Bob's unspent (UTXO) exits, he will be able to track the fact that some transaction in his inputs refers to Bob's UTXO. When using the mixing of other outputs, Den will not be able to determine whether this transaction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> spending </font><font style="vertical-align: inherit;">Bob's output, which is achieved through the use of a ring signature. However, if there is no mixing and Bob’s UTXO is spent directly, then Auditor Dan can be sure that this transaction is Bob’s outgoing payment. This is the idea of ​​this scheme.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suppose Alice sends a transaction to Bob, and Bob wants Auditor Dan to see the fact that Alice received the money and that they spent when Bob decided to spend it. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The scheme of work will look as follows (Fig. 6.3).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/webt/wo/7n/bw/wo7nbw8y-xgvkddpnx6lyyntsos.png"></div><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">6.3. </font><font style="vertical-align: inherit;">Auditor using a secret view key</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2811"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2812"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-352-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-352">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bob defines inbound and outbound transactions</font></font></sub></td>
</tr>
</tbody></table></div><ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bob tells Alice his public address </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2813"><span class="MJXp-mo" id="MJXp-Span-2814" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2815"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-2816" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2817"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-2818" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-353-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-353">(V, S)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and also asks her to set the mix_attr attribute to 1 in all the outputs addressed to him (below we will consider how this can be technically implemented).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bob gives auditor Dan his secret view key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2819"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2820"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-354-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-354">v</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alice sends Bob a transaction using the usual CryptoNote scheme. </font><font style="vertical-align: inherit;">In the outputs addressed to Bob, she sets mix_attr = 1.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dan scans all transactions on the blockchain and, using Bob's secret view key, checks for each exit </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2821"><span class="MJXp-msubsup" id="MJXp-Span-2822"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2823" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2824" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-2825"><span class="MJXp-munderover" id="MJXp-Span-2826"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2829" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-2830"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">?</font></font></span></span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-2827"><span class="MJXp-mo" id="MJXp-Span-2828" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2831"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2832" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-2834"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">′</font></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2833"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2835" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2836"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2837" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2838" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2839" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2840"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2841"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span><span class="MJXp-mo" id="MJXp-Span-2842" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2843"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mo" id="MJXp-Span-2844" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2845"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G</font></font></span><span class="MJXp-mo" id="MJXp-Span-2846" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2847"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-355-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-355">P_i \stackrel{?}{=} P’_i = H_s(v R, i) G + S</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Where </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2848"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2849"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-356-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-356">i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - serial number of the output, </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2850"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2851"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-357-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-357">S</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Bob's public spend-key). </font><font style="vertical-align: inherit;">If equality holds, then this output is addressed to Bob. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Den makes sure that mix_attr == 1, adds this output to the list and increases the balance by the value of the output.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dan also checks all the inputs of all transactions, and if one of the inputs refers to Bob's UTXO from the list, this means that this transaction is Bob's outgoing payment. </font><font style="vertical-align: inherit;">Due to the restriction mix_attr = 1, the input cannot mix other outputs, which means it spends Bob's output directly, and Den can be sure that this is Bob's outgoing payment. Den reduces the balance by the value of the input.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thus, Den will be able to calculate the correct balance of Bob’s wallet without gaining access to his secret spend-key </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2852"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2853"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-358-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-358">s</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Circuit features</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Feature 1. It is important that the sending party (Alice) set mix_attr to 1 when sending a transaction. If Alice does not do this, then the funds will come to Bob, but in the future, Den will not be able to clearly say whether Bob spent them or not, since any other user will be able to use this output to mix. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One solution is introducing a special type of address containing the same two public keys</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2854"><span class="MJXp-mo" id="MJXp-Span-2855" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2856"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span><span class="MJXp-mo" id="MJXp-Span-2857" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2858"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span><span class="MJXp-mo" id="MJXp-Span-2859" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-359-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-359">(V, S)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">but packaged in a different way from the standard. Alice, sending funds to an address of this type, will know about the need to set mix_attr = 1 for the corresponding outputs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Feature 2. The use of addresses of a special type does not oblige Alice to set the desired attribute value for the outputs. She can send funds without doing this, however, it will be immediately revealed by both Bob and the auditor Dan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Feature 3. In this scheme, audit capability is achieved at the price of the utmost reduction in untraceability. This does not present a particular problem if the audit opportunity is provided to an unlimited circle of people. For example, a charity fund can publish a donation address along with a secret view key, so anyone can act as an auditor and calculate the current balance of his wallet. It is important that in this case the anonymity of incoming transfers remains standard for CryptoNote (a large number of</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2860"><span class="MJXp-msubsup" id="MJXp-Span-2861"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2862" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2863" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2864"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2865"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2866"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2867"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2868"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2869"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-360-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-360">N_{mixins}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">However, the anonymity of outgoing payments will be limited by the inability to mix arbitrary outputs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is worth noting that in the case when the audit opportunity is provided to a narrow circle of people, in contrast to the example above, a decrease in untraceability may be an undesirable effect. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The big advantages of this option are ease of implementation and the absence of additional load on calculations and data.</font></font><br>
<br>
<br>
<a name="a7"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7. Conclusion</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We examined three options for adding the possibility of conducting an audit to the CryptoNote protocol: Bytecoin Amethyst, the theoretical AS scheme by Anton Sokolov, and the use of mix_attr (denoted by MA). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The relative change in ring signature size for all options except Bytecoin (BCN) is independent of</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2870"><span class="MJXp-msubsup" id="MJXp-Span-2871"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2872" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2873" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2874"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2875"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2876"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2877"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2878"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2879"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-361-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-361">N_{inputs}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">therefore consider </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2880"><span class="MJXp-msubsup" id="MJXp-Span-2881"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2882" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2883" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2884"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2885"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2886"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2887"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2888"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2889"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2890" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mn" id="MJXp-Span-2891"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-362-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-362">N_{inputs} = 1</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (minimum) and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2892"><span class="MJXp-msubsup" id="MJXp-Span-2893"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2894" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2895" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2896"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2897"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2898"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2899"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2900"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2901"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2902" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mn" id="MJXp-Span-2903"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-363-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-363">N_{inputs} = 3</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Fig. 7.1).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/webt/x8/s9/pm/x8s9pmx4mx3nilyi-lsto5ufsu4.png"></div><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">7.1. </font><font style="vertical-align: inherit;">Comparison of the sizes of the ring signature when</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2904"><span class="MJXp-msubsup" id="MJXp-Span-2905"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2906" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2907" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2908"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2909"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2910"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2911"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2912"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2913"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2914" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mn" id="MJXp-Span-2915"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-364-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-364">N_{inputs} = 1</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2916"><span class="MJXp-msubsup" id="MJXp-Span-2917"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2918" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2919" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2920"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2921"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2922"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2923"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2924"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2925"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2926" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mn" id="MJXp-Span-2927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-365-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-365">N_{inputs} = 3</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for all options considered</font></font></sub></td>
</tr>
</tbody></table></div><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2928"><span class="MJXp-msubsup" id="MJXp-Span-2929"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2930" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2931" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2932"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2933"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2934"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2935"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2936"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2937"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-366-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-366">N_{inputs}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - the number of entries in the transaction, </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2938"><span class="MJXp-msubsup" id="MJXp-Span-2939"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2940" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2941" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2942"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2943"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2944"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2945"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2946"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2947"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-367-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-367">N_{mixins}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- the number of outputs associated with each transaction input. </font><font style="vertical-align: inherit;">If</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2948"><span class="MJXp-msubsup" id="MJXp-Span-2949"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2950" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2951" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2952"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2953"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2954"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2955"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2956"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2957"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2958" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&gt;</font></font></span><span class="MJXp-mn" id="MJXp-Span-2959"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-368-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-368">N_{mixins} > 1</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this means that to increase </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untraceability,</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> each input refers to more than one output of some other transaction, and it is impossible to establish which one is real. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The best result is shown by the AS circuit, giving a reduction in the size of the ring signature in a wide range of the number of outputs to be mixed (</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2960"><span class="MJXp-msubsup" id="MJXp-Span-2961"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2962" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2963" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2964"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2965"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2966"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2967"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2968"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2969"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-369-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-369">N_{mixins}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">Bytecoin also gives good results when</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2970"><span class="MJXp-msubsup" id="MJXp-Span-2971"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2972" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2973" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2974"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2975"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2976"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2977"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2978"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2979"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2980" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">≥</font></font></span><span class="MJXp-mn" id="MJXp-Span-2981"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-370-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-370">N_{mixins} \ge 3</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (as already noted, a minimum number limit was introduced in Bytecoin Amethyst to increase untraceability </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2982"><span class="MJXp-msubsup" id="MJXp-Span-2983"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2984" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2985" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2986"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2987"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2988"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2989"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2990"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2991"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-371-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-371">N_{mixins}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">equal to 3). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The MA scheme does not offer any improvements in the size of the ring signature. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let us now compare the laboriousness of the ring signature verification procedure. </font><font style="vertical-align: inherit;">To do this, we will use the metric mentioned above, namely, we take the sum of the operations of the scalar product and the calculation of the hash function</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2992"><span class="MJXp-msubsup" id="MJXp-Span-2993"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2994" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2995" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-372-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-372">H_p</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with weights proportional to their runtime on a typical modern processor:</font></font><br>
<br>
<math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2996"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2997"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O</font></font></span><span class="MJXp-mo" id="MJXp-Span-2998" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3001"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3002"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3003"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l</font></font></span><span class="MJXp-mo" id="MJXp-Span-3004" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-3005" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mn" id="MJXp-Span-3006"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">130</font></font></span><span class="MJXp-mo" id="MJXp-Span-3007" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3008"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O</font></font></span><span class="MJXp-mo" id="MJXp-Span-3009" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mo" id="MJXp-Span-3010" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-mo" id="MJXp-Span-3011" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-3012" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mn" id="MJXp-Span-3013"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fifteen</font></font></span><span class="MJXp-mo" id="MJXp-Span-3014" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3015"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O</font></font></span><span class="MJXp-mo" id="MJXp-Span-3016" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-3017"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3018" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3019" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-3020" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-373-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-373">O(total) = 130 * O(*) + 15 * O(H_p)</script><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We have the following picture (Fig. 7.2).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/webt/pd/gg/-y/pdgg-yalim14da-t8qaszwz2hvq.png"></div><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">7.2. </font><font style="vertical-align: inherit;">Comparison of the increase in computational complexity of ring signature verification (</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3021"><span class="MJXp-msubsup" id="MJXp-Span-3022"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3023" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3024" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3025"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3026"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3027"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3028"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3029"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3030"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-3031" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mn" id="MJXp-Span-3032"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-374-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-374">N_{inputs} = 1</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></sub></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">With direct spending of funds (</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3033"><span class="MJXp-msubsup" id="MJXp-Span-3034"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3035" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3036" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3037"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3038"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3039"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3040"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3041"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3042"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-3043" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mn" id="MJXp-Span-3044"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-375-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-375">N_{mixins} = 1</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) AS and Bytecoin schemes require significantly more computation to verify the signature. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When mixing outputs (</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3045"><span class="MJXp-msubsup" id="MJXp-Span-3046"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3047" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3048" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3049"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3050"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3051"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3052"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3053"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3054"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-3055" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&gt;</font></font></span><span class="MJXp-mn" id="MJXp-Span-3056"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-376-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-376">N_{mixins} > 1</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) Bytecoin Amethyst scheme looks preferable to AS, however, the last considered MA option remains unsurpassed. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let us summarize the final result, taking into account factors such as an increase in the size of the address, inputs and outputs of transactions (Fig. 7.3).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td align="center"><div style="text-align:center;"><img src="https://habrastorage.org/webt/py/ta/jb/pytajbdn3ggbshximbjt7dzhl7m.png"></div><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">7.3. </font><font style="vertical-align: inherit;">Comparison of all considered schemes</font></font></sub></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bytecoin maintains the length of the address convenient for the end user, while the Anton Sokolov scheme increases it by 50%. This does not directly affect the blockchain size (although the sender address in encrypted form can be transmitted in extra transactions if the latter wishes, for example) and computational complexity, however, it does not significantly affect usability. In the MA scheme, the address size remains equal to 64 bytes; however, a way is required to distinguish audit addresses from normal ones. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Audit options for Bytecoin and AS include adding one point (32 bytes) to each transaction output, however, the input size remains unchanged only for Bytecoin.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is also worth noting that the Bytecoin Amethyst scheme has been implemented in the code for a long time and, judging by the lack of messages about problems that have passed since its implementation, it is well tested in practice. </font><font style="vertical-align: inherit;">However, it was not possible to find its public description in a strict form, therefore, there are no formal proofs of its correctness. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The AS scheme, on the contrary, is strictly described and proposed for discussion in the crypto community [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The MA scheme does not have a strictly described formal proof; however, due to its extreme simplicity, it seems unnecessary.</font></font><br>
<br>
<br>
<a name="al"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Literature</font></font></h1><ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nicolas van Saberhagen, CryptoNote v 2.0</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bytecoin announcement on bitcointalk.org forum</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bitmonero Announcement at bitcointalk.org</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bitmonero repository on Github</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bernstein et al. </font><font style="vertical-align: inherit;">"Ed25519: high-speed high-security signatures"</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Patientzero</font></font></a>, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">«     »</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">Shen Noether, «Understanding ge_fromfe_frombytes_vartime»</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">Shen Noether, MRL, «Ring confidential transactions»</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">,    H   Monero</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">Bytecoin blog — Auditable coins</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">Anton Sokolov, «Cryptonote auditability. How to append a wallet balance audit.»</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">Anton Sokolov, «Discussion for the auditable wallets Variant 1 and 2»</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">Anton Sokolov, «The unlinkable auditable Variant 3»</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">Anton Sokolov, «The auditable variant 4. Memory efficiency and security question.»</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">Anton Sokolov, «Multi-signature with LSAG. One more memory efficient approach to auditable wallets.»</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">Abe, Ohkubo, Suzuki, «1-out-of-n Signatures from a Variety of Keys» (AOS)</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">Anton Sokolov, «Cryptonote auditability and efficient scheme for anonymous key vector proof»</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anton Sokolov, “Practical approach for appending auditable wallets to the Cryptonote”</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Boolberry Solves CryptoNote Issues"</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“Bytecoin Amethyst Stable Release Extended Technical Description”</font></font></a></li>
</ol></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en496852/index.html">Smooth sorting</a></li>
<li><a href="../en496856/index.html">Smart home without remotes, but with a cube</a></li>
<li><a href="../en496858/index.html">FOSS News No. 11 - a review of free and open source software for April 6-12, 2020</a></li>
<li><a href="../en496860/index.html">First DI: First DI on Interfaces for Typescript Applications</a></li>
<li><a href="../en496862/index.html">Arduino Bubble Display</a></li>
<li><a href="../en496868/index.html">Small Space Symphony</a></li>
<li><a href="../en496870/index.html">Android declarative programming of client-server applications</a></li>
<li><a href="../en496872/index.html">New Hyperledger Fabric: Go SDK Software Model</a></li>
<li><a href="../en496874/index.html">We study the Mediastreamer2 VoIP engine. Part 9</a></li>
<li><a href="../en496876/index.html">The digest of fresh materials from the world of the front-end for the last week No. 410 (April 6 - 12, 2020)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>