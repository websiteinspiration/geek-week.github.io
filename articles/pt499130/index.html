<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üñêÔ∏è üîΩ üï∫ Engenharia reversa anti-bloqueio de publicidade BlockAdBlock üå∂Ô∏è üê´ ‚ñ´Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Se voc√™ usa bloqueadores de an√∫ncios, pode encontrar o BlockAdBlock . Este script detecta seu bloqueador e n√£o permite o acesso at√© o site. Mas eu me ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Engenharia reversa anti-bloqueio de publicidade BlockAdBlock</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/499130/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se voc√™ usa bloqueadores de an√∫ncios, pode encontrar o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BlockAdBlock</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Este script detecta seu bloqueador e n√£o permite o acesso at√© o site. </font><font style="vertical-align: inherit;">Mas eu me perguntava como isso funciona. </font><font style="vertical-align: inherit;">Como o anti-bloqueador detecta os bloqueadores? </font><font style="vertical-align: inherit;">E como os bloqueadores reagem a isso e como eles bloqueiam os anti-bloqueadores?</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hist√≥ria da engenharia reversa</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A primeira coisa que fiz foi olhar para </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o site deles</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">O BlockAdBlock oferece um configurador com configura√ß√µes: o intervalo de espera e a apar√™ncia do aviso, gerando diferentes </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vers√µes do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> script. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso me fez pensar em vers√µes. </font><font style="vertical-align: inherit;">E se ele n√£o podia ver uma vers√£o, e </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tudo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de uma vez? </font><font style="vertical-align: inherit;">Ent√£o eu fiz. </font><font style="vertical-align: inherit;">Voltei no tempo usando a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wayback Machine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Depois disso, baixei todas as vers√µes do BlockAdBlock e as misturei.</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lista de todas as vers√µes do BlockAdBlock, com sha1sum</font></font></h4><br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6d5eafab2ca816ccd049ad8f796358c0a7a43cf3 20151007203811.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
065b4aa813b219abbce76ad20a3216b3481b11bb 20151113115955.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d5dec97a775b2e563f3e4359e4f8f1c3645ba0e5 20160121132336.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8add06cbb79bc25114bd7a2083067ceea9fbb354 20160318193101.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8add06cbb79bc25114bd7a2083067ceea9fbb354 20160319042810.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8add06cbb79bc25114bd7a2083067ceea9fbb354 20160331051645.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8add06cbb79bc25114bd7a2083067ceea9fbb354 20160406061855.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8add06cbb79bc25114bd7a2083067ceea9fbb354 20160408025028.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
555637904dc9e4bfc6f08bdcae92f0ba0f443ebf 20160415083215.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20161120215354.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20170525201720.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20170606090847.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20170703211338.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20170707211652.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20170813090718.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20170915094808.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20171005180631.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20171019162109.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20171109101135.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20171127113945.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20171211042454.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20171227031408.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20180202000800.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20180412213253.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20180419060636.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20180530223228.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20180815042610.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20181029233809.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20181122190948.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20181122205748.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20190324081812.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20190420155244.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20190424200651.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20190903121933.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20200112084838.js</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apenas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seis</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vers√µes diferem entre si, e a √∫ltima delas se refere a 2016, embora alguns sites ainda usem o BlockAdBlock. </font><font style="vertical-align: inherit;">Isso √© √≥timo, porque ser√° o suficiente para fazermos engenharia reversa da √∫nica vers√£o e depois inverter as diferen√ßas. </font><font style="vertical-align: inherit;">Spoiler: veremos o desenvolvimento de id√©ias e at√© os remanescentes do c√≥digo de depura√ß√£o. </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Publiquei</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
todas as vers√µes </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Se voc√™ deseja examinar as diferen√ßas, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">neste reposit√≥rio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cada confirma√ß√£o √© uma nova vers√£o.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desembalar</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O c√≥digo do script n√£o √© minificado, mas compactado por um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JS-packer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de Dean Edwards com altera√ß√µes cosm√©ticas e sem nenhuma modifica√ß√£o da l√≥gica </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sup></a><a name="1_1"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">eval</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">p, a, c, k, e, d</span>) </span>{<font></font>
    e = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c</span>) </span>{
        <span class="hljs-keyword">return</span> (c &lt; a ? <span class="hljs-string">''</span> : e(<span class="hljs-built_in">parseInt</span>(c / a))) + ((c = c % a) &gt; <span class="hljs-number">35</span> ? <span class="hljs-built_in">String</span>.fromCharCode(c + <span class="hljs-number">29</span>) : c.toString(<span class="hljs-number">36</span>))<font></font>
    };<font></font>
    <span class="hljs-keyword">if</span> (!<span class="hljs-string">''</span>.replace(<span class="hljs-regexp">/^/</span>, <span class="hljs-built_in">String</span>)) {
        <span class="hljs-keyword">while</span> (c--) {<font></font>
            d[e(c)] = k[c] || e(c)<font></font>
        }<font></font>
        k = [<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
            <span class="hljs-keyword">return</span> d[e]<font></font>
        }];<font></font>
        e = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-string">'\\w+'</span><font></font>
        };<font></font>
        c = <span class="hljs-number">1</span><font></font>
    };<font></font>
    <span class="hljs-keyword">while</span> (c--) {
        <span class="hljs-keyword">if</span> (k[c]) {<font></font>
            p = p.replace(<span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">'\\b'</span> + e(c) + <span class="hljs-string">'\\b'</span>, <span class="hljs-string">'g'</span>), k[c])<font></font>
        }<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> p<font></font>
}(<span class="hljs-string">'0.1("2 3 4 5 6 7 8\'d. 9, h? a b c d e f g");i j=\'a\'+\'k\'+\'e\'+\'l\'+\'n\'+\'m\'+\'e\';'</span>,<span class="hljs-number">24</span>,<span class="hljs-number">24</span>,
<span class="hljs-string">'console|log|This|code|will|get|unpacked|then|eval|Cool||||||||huh|let|you|w|s||o'</span>.split(<span class="hljs-string">'|'</span>),<span class="hljs-number">0</span>,{}))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Felizmente, isso n√£o √© um problema para n√≥s. </font><font style="vertical-align: inherit;">O ponto fraco do empacotador √© que todo o c√≥digo durante a descompacta√ß√£o √© passado para </font></font><code>eval()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Se substituirmos </font></font><code>eval()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">por algo parecido </font></font><code>console.log()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, obteremos repentinamente todo o c√≥digo-fonte e o empacotador ser√° derrotado </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></sup></a><a name="2_2"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Feito isso para cada vers√£o, podemos examinar cada uma delas e ver quais fun√ß√µes foram adicionadas ao longo do tempo.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v1 :? </font><font style="vertical-align: inherit;">- novembro de 2015: roteiro inicial</font></font></h1><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√≥digo-fonte</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Vamos come√ßar com um estudo </font></font><code>20151007203811.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">publicado em novembro de 2015 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></sup></a><a name="3_3"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Embora essa primeira vers√£o n√£o bloqueie muito bem os bloqueadores, ela permite avaliar a arquitetura BlockAdBlock sem o lixo acumulado ao longo dos anos.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arquitetura</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em tr√™s frases:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BlockAdBlock √© um fechamento que retorna um objeto com tr√™s fun√ß√µes:</font></font><br>
<ul>
<li><code>bab()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> define a isca e chama um cheque </font></font><code>check</code> <br>
</li>
<li><code>check()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verifica se o bloqueador bloqueou a isca, causando </font></font><code>arm</code><br>
</li>
<li><code>arm()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobreposi√ß√£o</font></font></li>
</ul></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O ponto de entrada √© </font></font><code>bab()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iniciado ap√≥s um per√≠odo de tempo especificado.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tr√™s fun√ß√µes s√£o geradas com argumentos definidos no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">configurador BlockAdBlock</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O c√≥digo √© criado em torno de um fechamento atribu√≠do a um objeto global com um nome aleat√≥rio.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">var</span> randomID = <span class="hljs-string">''</span>,<font></font>
    e = <span class="hljs-string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'</span>;
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">12</span>; i++) randomID += <font></font>
    e.charAt(<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * e.length));
<span class="hljs-keyword">var</span> setTimeoutDelay = <span class="hljs-number">7</span>; <span class="hljs-comment">// Delay after which to call BlockAdBlock</span>
<span class="hljs-built_in">window</span>[<span class="hljs-string">''</span> + randomID + <span class="hljs-string">''</span>] = ...</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O autor forneceu uma randomiza√ß√£o completa para contornar o bloqueio est√°tico. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, retorna um objeto com tr√™s fun√ß√µes: </font></font><code>bab</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>check</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>arm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">window</span>[<span class="hljs-string">''</span> + randomID + <span class="hljs-string">''</span>] = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> eid = ...<font></font>
    return {<font></font>
        <span class="hljs-attr">bab</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">check, passed_eid</span>) </span>{},
        <span class="hljs-attr">check</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">checkPredicate, unused</span>) </span>{},
        <span class="hljs-attr">arm</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{}<font></font>
    }<font></font>
})();</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estes s√£o meus pr√≥prios nomes. </font><font style="vertical-align: inherit;">Todas as vari√°veis ‚Äã‚Äãs√£o minificadas e algumas s√£o ofuscadas. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O ponto de entrada √© </font></font><code>bab()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chamado </font></font><code>setTimeout()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="javascript hljs">setTimeout(<span class="hljs-string">'window[\'\' + randomID + \'\'] \
.bab(window[\'\' + randomID + \'\'].check, \
     window[\'\' + randomID + \'\'].bab_elementid)'</span>, setTimeoutDelay * <span class="hljs-number">1000</span>)</code></pre><br>
<code>bab_elementid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o usado em nenhuma vers√£o do c√≥digo. </font></font><code>setTimeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">passado como uma string. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um fechamento possui vari√°veis ‚Äã‚Äãexternas. </font><font style="vertical-align: inherit;">Dois deles s√£o usados ‚Äã‚Äãpara salvar o estado em um script:</font></font><br>
<br>
<ul>
<li><code>adblockDetected</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> igual a 1 se um bloqueador de an√∫ncios for detectado.</font></font><br>
</li>
<li><code>nagMode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Esta √© uma op√ß√£o de configura√ß√£o. </font><font style="vertical-align: inherit;">Se estiver instalado, o script n√£o bloqueia o acesso √† p√°gina, mas apenas o ativa uma vez.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outras vari√°veis ‚Äã‚Äãpara controlar a apar√™ncia e o comportamento s√£o definidas no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">configurador</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">var</span> eid = <span class="hljs-string">' ad_box'</span>, <span class="hljs-comment">// Name of the bait.</span>
    __u1 = <span class="hljs-number">1</span>, <span class="hljs-comment">// Unused.</span><font></font>
<font></font>
    <span class="hljs-comment">// Colors for the blockadblock prompt.</span>
    overlayColor = <span class="hljs-string">'#EEEEEE'</span>,<font></font>
    textColor = <span class="hljs-string">'#777777'</span>,<font></font>
    buttonBackgroundColor = <span class="hljs-string">'#adb8ff'</span>,<font></font>
    buttonColor = <span class="hljs-string">'#FFFFFF'</span>,<font></font>
<font></font>
    __u2 = <span class="hljs-string">''</span>, <span class="hljs-comment">// Unused.</span><font></font>
<font></font>
    <span class="hljs-comment">// Text to display when the blockadblock prompt is shown.</span>
    welcomeText = <span class="hljs-string">'Sorry for the interruption...'</span>,<font></font>
    primaryText = <span class="hljs-string">'It looks like you\'re using an ad blocker. That\'s okay.  Who doesn\'t?'</span>,<font></font>
    subtextText = <span class="hljs-string">'But without advertising-income, we can\'t keep making this site awesome.'</span>,<font></font>
    buttonText = <span class="hljs-string">'I understand, I have disabled my ad blocker.  Let me in!'</span>,<font></font>
<font></font>
    <span class="hljs-comment">// If 1, adblock was detected.</span>
    adblockDetected = <span class="hljs-number">0</span>,
    <span class="hljs-comment">// If 1, BlockAdBlock will only nag the visitor once, rather than block access.</span>
    nagMode = <span class="hljs-number">0</span>,<font></font>
<font></font>
    <span class="hljs-comment">// The blockadblock domain, reversed.</span>
    bab_domain = <span class="hljs-string">'moc.kcolbdakcolb'</span>;</code></pre><br>
<code>bab_domain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> definido aqui na tentativa de ofuscar o dom√≠nio BlockAdBlock.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bab: crie um banner de chamariz</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O principal m√©todo de trabalho com o BlockAdBlock √© criar "isca" ou "isca" a partir de elementos de publicidade que parecem banners reais. </font><font style="vertical-align: inherit;">Ele ent√£o verifica se o bloqueador est√° bloqueado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso cria um engodo: uma div falsa que finge ser um an√∫ncio, mas est√° oculta.</font></font><br>
<br>
<pre><code class="javascript hljs">bab: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">check, passed_eid</span>) </span>{
    <span class="hljs-comment">// Wait for the document to be ready.</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">document</span>.body == <span class="hljs-string">'undefined'</span>) {
        <span class="hljs-keyword">return</span><font></font>
    };<font></font>
<font></font>
    <span class="hljs-keyword">var</span> delay = <span class="hljs-string">'0.1'</span>, <font></font>
        passed_eid = eid ? eid : <span class="hljs-string">'banner_ad'</span>,<font></font>
        bait = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'DIV'</span>);<font></font>
        <font></font>
    bait.id = passed_eid;<font></font>
    bait.style.position = <span class="hljs-string">'absolute'</span>;<font></font>
    bait.style.left = <span class="hljs-string">'-999px'</span>;<font></font>
    bait.appendChild(<span class="hljs-built_in">document</span>.createTextNode(<span class="hljs-string">' '</span>));
    <span class="hljs-built_in">document</span>.body.appendChild(bait);<font></font>
    ...</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aparentemente, </font></font><code>passed_eid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pretende-se configurar o identificador da isca, mas n√£o √© usado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois disso, √© verificado se a isca foi removida pelo bloco de an√∫ncios.</font></font><br>
<br>
<pre><code class="javascript hljs">    ...<font></font>
    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (bait) {<font></font>
            check((bait.clientHeight == <span class="hljs-number">0</span>), delay);<font></font>
            check((bait.clientWidth == <span class="hljs-number">0</span>), delay);<font></font>
            check((bait.display == <span class="hljs-string">'hidden'</span>), delay);<font></font>
            check((bait.visibility == <span class="hljs-string">'none'</span>), delay);<font></font>
            check((bait.opacity == <span class="hljs-number">0</span>), delay);<font></font>
            check((bait.left &lt; <span class="hljs-number">1000</span>), delay);<font></font>
            check((bait.top &lt; <span class="hljs-number">1000</span>), delay)<font></font>
        } <span class="hljs-keyword">else</span> {<font></font>
            check(<span class="hljs-literal">true</span>, delay)<font></font>
        }<font></font>
    }, <span class="hljs-number">125</span>)<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se a isca n√£o existir mais, o elemento ser√° exclu√≠do (e iniciaremos a sobreposi√ß√£o). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A fun√ß√£o </font></font><code>check</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">funcionar√° se </font></font><code>Predicate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retornar um valor </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e iniciar </font></font><code>arm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="javascript hljs">check: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">checkPredicate, unused</span>) </span>{
    <span class="hljs-keyword">if</span> ((checkPredicate) &amp;&amp; (adblockDetected == <span class="hljs-number">0</span>)) {<font></font>
        adblockDetected = <span class="hljs-number">1</span>;
        <span class="hljs-built_in">window</span>[<span class="hljs-string">''</span> + randomID + <span class="hljs-string">''</span>].arm()<font></font>
    } <span class="hljs-keyword">else</span> {}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como o teste √© </font></font><code>check</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">acionado v√°rias vezes, como mostrado acima, √© </font></font><code>adblockDetected</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">definido como o primeiro teste correto para evitar disparos repetidos </font></font><code>arm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modo Grunhido</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O script possui uma fun√ß√£o chamada "modo nag": nesse modo, o BlockAdBlock diz apenas uma vez para desativar o bloqueador de an√∫ncios, mas n√£o o bloqueia toda vez que voc√™ o visita. </font><font style="vertical-align: inherit;">Isso √© feito configurando o item </font></font><code>localStorage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">na primeira visita. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se pud√©ssemos instalar esse elemento, poder√≠amos desativar o bloqueio para sempre? </font><font style="vertical-align: inherit;">Infelizmente, o BlockAdBlock verifica antecipadamente se o script foi configurado para o modo nag; portanto, esse m√©todo n√£o funcionar√° quando funcionar no modo padr√£o, ou seja, com bloqueio de acesso.</font></font><br>
<br>
<pre><code class="javascript hljs">arm: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (nagMode == <span class="hljs-number">1</span>) {
        <span class="hljs-keyword">var</span> babNag = sessionStorage.getItem(<span class="hljs-string">'babn'</span>);
        <span class="hljs-keyword">if</span> (babNag &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> <span class="hljs-comment">// Stop the script.</span>
        } <span class="hljs-keyword">else</span> {<font></font>
            sessionStorage.setItem(<span class="hljs-string">'babn'</span>, (<span class="hljs-built_in">Math</span>.random() + <span class="hljs-number">1</span>) * <span class="hljs-number">1000</span>)<font></font>
        }<font></font>
    };<font></font>
    ...</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Infelizmente, ele est√° </font></font><code>nagMode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instalado no configurador e, por padr√£o, √© igual </font></font><code>0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BlockAdBlock vers√£o 1</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os bloqueadores de an√∫ncios usam os chamados filtros: linhas de c√≥digo que podem bloquear solicita√ß√µes de rede e ocultar elementos na p√°gina. Ao criar elementos de isca, o BlockAdBlock inicia especificamente esses filtros. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com essa defesa simples, o BlockAdBlock √© eficaz contra todos os principais bloqueadores de an√∫ncios, como uBlock Origin, AdBlock Plus e Ghostery. Para combater isso, precisamos escrever nosso pr√≥prio filtro, que √© ativado apenas em sites que executam o BlockAdBlock. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escrever filtros para um bloqueador √© um</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pouco complicado. Precisamos de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">um filtro de conte√∫do</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que bloqueie elementos na p√°gina gerada ap√≥s o carregamento. Como a isca tem um identificador </font></font><code>banner_ad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, criamos uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exce√ß√£o para ocultar elementos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">marcado </font></font><code>#@#</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para todos os elementos </font></font><code>#</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com um identificador </font></font><code>banner_ad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e coloque-o na lista de filtros de usu√°rios do nosso bloqueador. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O resultado √© o seguinte:</font></font><br>
<br>
<pre><code class="javascript hljs">localhost#@# #banner_ad</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu tenho o host local aqui para demonstra√ß√£o. Voc√™ pode substitu√≠-lo pelo seu URL. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso desativa com sucesso o BlockAdBlock. </font><font style="vertical-align: inherit;">A solu√ß√£o pode parecer simples, mas h√° muito tempo trabalha com √™xito na </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lista de filtros Anti-AdBlock-Killer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vers√£o 2 (novembro de 2015 - janeiro de 2016): v√°rias melhorias</font></font></h1><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Diferen√ßa do </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">c√≥digo fonte </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v1 / v2</font></font></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cria√ß√£o de iscas: menos bugs</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
H√° um erro sutil na primeira vers√£o da cria√ß√£o da isca: a div criada n√£o tem conte√∫do; portanto, uma div √© gerada com uma altura de 0 e uma largura de 0. Mais tarde, o c√≥digo verifica se a div foi exclu√≠da, verificando sua altura e largura. </font><font style="vertical-align: inherit;">Mas como tinha altura zero, o BlockAdBlock sempre funcionou </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></sup></a><a name="4_4"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O erro de uma div vazia foi corrigido.</font></font><br>
<br>
<pre><code class="javascript hljs">bab: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">...</span>) </span>{<font></font>
    bait = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'DIV'</span>);<font></font>
    ...<font></font>
    bait.appendChild(<span class="hljs-built_in">document</span>.createTextNode(<span class="hljs-string">'√Ç '</span>));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma div filho √© criada com algum conte√∫do.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Detec√ß√£o de bloqueadores atrav√©s de banners gr√°ficos falsos</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesse m√©todo, criamos uma imagem falsa com um nome aleat√≥rio ativado </font></font><code>doubleclick.net</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Bloqueadores de an√∫ncios bloquear√£o a imagem, pensando que √© um banner de an√∫ncio. </font><font style="vertical-align: inherit;">Mas isso n√£o requer nenhuma altera√ß√£o no nosso filtro.</font></font><br>
<br>
<pre><code class="javascript hljs">bab: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">...</span>) </span>{<font></font>
    bait = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'DIV'</span>);<font></font>
    bait.innerHTML = <span class="hljs-string">'&lt;img src="http://doubleclick.net/'</span> + randomStr() + <span class="hljs-string">'.jpg"&gt;'</span>;<font></font>
    ...</code></pre><br>
<code>randomStr()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gera uma cadeia de comprimento arbitr√°rio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outra diferen√ßa not√°vel foi o uso de um temporizador, em </font></font><code>setInterval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vez de uma simples verifica√ß√£o √∫nica para ver se um gatilho est√° instalado. </font><font style="vertical-align: inherit;">Ele verifica novamente se o banner gr√°fico √© exibido e se seu atributo n√£o foi alterado </font></font><code>src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, verificando o conte√∫do da isca. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Novo </font></font><code>setInterval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e verifique a disponibilidade da imagem:</font></font><br>
<br>
<pre><code class="javascript hljs">    ...<font></font>
    checkCallback = setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (bait) {<font></font>
            check((bait.clientHeight == <span class="hljs-number">0</span>), delay);<font></font>
            check((bait.clientWidth == <span class="hljs-number">0</span>), delay);<font></font>
            check((bait.display == <span class="hljs-string">'hidden'</span>), delay);<font></font>
            check((bait.visibility == <span class="hljs-string">'none'</span>), delay);<font></font>
            check((bait.opacity == <span class="hljs-number">0</span>), delay);
            <span class="hljs-keyword">try</span> {<font></font>
                check((<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'banner_ad'</span>).innerHTML.indexOf(<span class="hljs-string">'click'</span>) == <span class="hljs-number">-1</span>), delay)<font></font>
            } <span class="hljs-keyword">catch</span> (e) {}<font></font>
        } <span class="hljs-keyword">else</span> {<font></font>
            check(<span class="hljs-literal">true</span>, delay)<font></font>
        }<font></font>
    }, <span class="hljs-number">1000</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por que </font></font><code>indexof ('click')</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? </font><font style="vertical-align: inherit;">Porque a fonte da imagem </font></font><code>src="doubleclick.net/abcdefg.jpg"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e verificamos se o fragmento da string √© preservado </font></font><code>click</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vers√£o 3 (novembro de 2015 - mar√ßo de 2016): isca generalizada</font></font></h1><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Diferen√ßa do </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">c√≥digo fonte </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v2 / v3</font></font></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cria√ß√£o de Iscas: Identificadores Aleat√≥rios</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A √∫nica altera√ß√£o nesta vers√£o, embora significativa, √© a apar√™ncia de identificadores aleat√≥rios para a isca. </font><font style="vertical-align: inherit;">O novo identificador √© retirado da lista de identificadores ao carregar a p√°gina e √© usado para a isca, que agora √© colocada no meio da p√°gina. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma longa lista de identificadores aleat√≥rios demonstra um bom conhecimento da √°rea de assunto.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">var</span> baitIDs = [
  <span class="hljs-string">"ad-left"</span>,
  <span class="hljs-string">"adBannerWrap"</span>,
  <span class="hljs-string">"ad-frame"</span>,
  <span class="hljs-string">"ad-header"</span>,
  <span class="hljs-string">"ad-img"</span>,
  <span class="hljs-string">"ad-inner"</span>,
  <span class="hljs-string">"ad-label"</span>,
  <span class="hljs-string">"ad-lb"</span>,
  <span class="hljs-string">"ad-footer"</span>,
  <span class="hljs-string">"ad-container"</span>,
  <span class="hljs-string">"ad-container-1"</span>,
  <span class="hljs-string">"ad-container-2"</span>,
  <span class="hljs-string">"Ad300x145"</span>,
  <span class="hljs-string">"Ad300x250"</span>,
  <span class="hljs-string">"Ad728x90"</span>,
  <span class="hljs-string">"AdArea"</span>,
  <span class="hljs-string">"AdFrame1"</span>,
  <span class="hljs-string">"AdFrame2"</span>,
  <span class="hljs-string">"AdFrame3"</span>,
  <span class="hljs-string">"AdFrame4"</span>,
  <span class="hljs-string">"AdLayer1"</span>,
  <span class="hljs-string">"AdLayer2"</span>,
  <span class="hljs-string">"Ads_google_01"</span>,
  <span class="hljs-string">"Ads_google_02"</span>,
  <span class="hljs-string">"Ads_google_03"</span>,
  <span class="hljs-string">"Ads_google_04"</span>,
  <span class="hljs-string">"DivAd"</span>,
  <span class="hljs-string">"DivAd1"</span>,
  <span class="hljs-string">"DivAd2"</span>,
  <span class="hljs-string">"DivAd3"</span>,
  <span class="hljs-string">"DivAdA"</span>,
  <span class="hljs-string">"DivAdB"</span>,
  <span class="hljs-string">"DivAdC"</span>,
  <span class="hljs-string">"AdImage"</span>,
  <span class="hljs-string">"AdDiv"</span>,
  <span class="hljs-string">"AdBox160"</span>,
  <span class="hljs-string">"AdContainer"</span>,
  <span class="hljs-string">"glinkswrapper"</span>,
  <span class="hljs-string">"adTeaser"</span>,
  <span class="hljs-string">"banner_ad"</span>,
  <span class="hljs-string">"adBanner"</span>,
  <span class="hljs-string">"adbanner"</span>,
  <span class="hljs-string">"adAd"</span>,
  <span class="hljs-string">"bannerad"</span>,
  <span class="hljs-string">" ad_box"</span>,
  <span class="hljs-string">" ad_channel"</span>,
  <span class="hljs-string">" adserver"</span>,
  <span class="hljs-string">" bannerid"</span>,
  <span class="hljs-string">"adslot"</span>,
  <span class="hljs-string">"popupad"</span>,
  <span class="hljs-string">"adsense"</span>,
  <span class="hljs-string">"google_ad"</span>,
  <span class="hljs-string">"outbrain-paid"</span>,
  <span class="hljs-string">"sponsored_link"</span>
];</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gera√ß√£o aleat√≥ria de ID</font></font></h4><br>
<pre><code class="javascript hljs">    randomBaitID = baitIDs[ <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * baitIDs.length) ],<font></font>
    ...<font></font>
    var passed_eid = randomBaitID;<font></font>
    bait = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'DIV'</span>);    <font></font>
    bait.id = passed_eid;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como isso funciona em cada inicializa√ß√£o, o identificador ser√° diferente a cada vez.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BlockAdBlock, terceira a √∫ltima vers√£o</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O BlockAdBlock explora o ponto cego dos bloqueadores de an√∫ncios: se um filtro ignorar todos os identificadores acima, ele tamb√©m ignorar√° os an√∫ncios reais. Assim, o BlockAdBlock </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for√ßa o bloqueador de an√∫ncios a se tornar in√∫til</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nos bloqueadores, podemos executar scripts arbitr√°rios antes de carregar a p√°gina. Voc√™ pode tentar remover o objeto BlockAdBlock antecipadamente. Mas, para isso, precisamos do nome do objeto BlockAdBlock, que √© randomizado cada vez que √© iniciado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O uBlock Origin adotou uma abordagem diferente. Como o c√≥digo √© executado por uma fun√ß√£o </font></font><code>eval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, podemos definir nossa pr√≥pria fun√ß√£o </font></font><code>eval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que bloquear√° a execu√ß√£o se encontrarmos o BlockAdBlock. Em JS, um objeto √© capaz disso </font></font><code>Proxy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: voc√™ pode substituir qualquer propriedade e m√©todo em qualquer objeto.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso pode ser contornado, n√£o passando a carga √∫til inicial do BlockAdBlock </font></font><code>eval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas usando-a diretamente, portanto, tamb√©m procuramos o ponto de entrada: a chamada </font></font><code>setTimeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Como √© </font></font><code>setTimeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">passado por uma string, n√£o por uma fun√ß√£o, verificamos essa string. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Implementa√ß√£o no uBlock Origin ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">origem</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> signatures = [<font></font>
    [ <span class="hljs-string">'blockadblock'</span> ],<font></font>
    [ <span class="hljs-string">'babasbm'</span> ],<font></font>
    [ <span class="hljs-regexp">/getItem\('babn'\)/</span> ],<font></font>
    [<font></font>
        <span class="hljs-string">'getElementById'</span>,
        <span class="hljs-string">'String.fromCharCode'</span>,
        <span class="hljs-string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'</span>,
        <span class="hljs-string">'charAt'</span>,
        <span class="hljs-string">'DOMContentLoaded'</span>,
        <span class="hljs-string">'AdBlock'</span>,
        <span class="hljs-string">'addEventListener'</span>,
        <span class="hljs-string">'doScroll'</span>,
        <span class="hljs-string">'fromCharCode'</span>,
        <span class="hljs-string">'&lt;&lt;2|r&gt;&gt;4'</span>,
        <span class="hljs-string">'sessionStorage'</span>,
        <span class="hljs-string">'clientWidth'</span>,
        <span class="hljs-string">'localStorage'</span>,
        <span class="hljs-string">'Math'</span>,
        <span class="hljs-string">'random'</span><font></font>
    ],<font></font>
];<font></font>
<span class="hljs-keyword">const</span> check = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s</span>) </span>{
    <span class="hljs-comment">// check for signature </span>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lista de assinaturas: definindo modelos de c√≥digo. </font><font style="vertical-align: inherit;">A fun√ß√£o </font></font><code>check</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verifica a sequ√™ncia ap√≥s </font></font><code>eval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a conformidade com esses padr√µes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proxy as</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fun√ß√µes </font></font><code>eval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>setTimeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">window</span>.eval = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(<span class="hljs-built_in">window</span>.eval, {
    <span class="hljs-attr">apply</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target, thisArg, args</span>) </span>{
        <span class="hljs-keyword">const</span> a = args[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> a !== <span class="hljs-string">'string'</span> || !check(a) ) {
            <span class="hljs-keyword">return</span> target.apply(thisArg, args);<font></font>
        } <font></font>
        <span class="hljs-comment">// BAB detected: clean up.</span>
        <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">document</span>.body ) {
            <span class="hljs-built_in">document</span>.body.style.removeProperty(<span class="hljs-string">'visibility'</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">let</span> el = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'babasbmsgx'</span>);
        <span class="hljs-keyword">if</span> ( el ) {<font></font>
            el.parentNode.removeChild(el);<font></font>
        }<font></font>
    }<font></font>
});<font></font>
<span class="hljs-built_in">window</span>.setTimeout = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(<span class="hljs-built_in">window</span>.setTimeout, {
    <span class="hljs-attr">apply</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target, thisArg, args</span>) </span>{
        <span class="hljs-keyword">const</span> a = args[<span class="hljs-number">0</span>];
        <span class="hljs-comment">// Check that the passed string is not the BAB entrypoint.</span>
        <span class="hljs-keyword">if</span> (
            <span class="hljs-keyword">typeof</span> a !== <span class="hljs-string">'string'</span> ||
            <span class="hljs-regexp">/\.bab_elementid.$/</span>.test(a) === <span class="hljs-literal">false</span><font></font>
        ) {<font></font>
            <span class="hljs-keyword">return</span> target.apply(thisArg, args);<font></font>
        }<font></font>
    }<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como agora estamos usando um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scriptlet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , um fragmento de c√≥digo personalizado especial executado pelo bloqueador, o filtro muda um pouco:</font></font><br>
<br>
<pre><code class="javascript hljs">localhost## +js(nobab)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por n√£o iniciar por padr√£o em todos os sites por motivos de desempenho, voc√™ deve atribu√≠-lo a cada site usando um script.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vers√£o 4 (janeiro de 2016 - abril de 2016): fun√ß√µes experimentais</font></font></h1><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diferen√ßa do </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">c√≥digo-fonte </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">v3 / v4</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
O m√©todo descrito para bloquear anti-bloqueadores foi desenvolvido em janeiro de 2016, de acordo com o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hist√≥rico de confirma√ß√µes do uBlock Origin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , e n√£o mudou conceitualmente desde o in√≠cio. </font><font style="vertical-align: inherit;">O BlockAdBlock nunca tentou contornar esse filtro alterando sua arquitetura. </font><font style="vertical-align: inherit;">Em vez disso, ele continuou a desenvolver novos recursos. </font><font style="vertical-align: inherit;">E quando vamos para a p√°gina BlockAdBlock, vemos uma guia interessante: "Voc√™ precisa de mais poder anti-bloqueio?" </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rs/0m/ea/rs0meawjau7ljt0-m6viiwoo4cq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Embora esses m√©todos de prote√ß√£o estejam dispon√≠veis apenas atrav√©s de uma guia especial, eles est√£o inclu√≠dos em todos os scripts e s√£o executados atrav√©s de vari√°veis ‚Äã‚Äãcom os nomes correspondentes. </font><font style="vertical-align: inherit;">A quarta vers√£o implementa dois m√©todos:</font></font><br>
<br>
<ul>
<li><code>aDefOne</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, "Prote√ß√£o espec√≠fica para sites do adsense"</font></font><br>
</li>
<li><code>aDefTwo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, "Recurso especial de seguran√ßa"</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Coment√°rios de depura√ß√£o aleat√≥rios</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Antes de me despedir de voc√™, devo mencionar mais uma coisa. </font><font style="vertical-align: inherit;">No processo de engenharia reversa, uma fun√ß√£o chamou minha aten√ß√£o: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depurando </font></font><code>console.log()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diretamente no c√≥digo!</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">consolelog</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-comment">// "Dev mode" check: developpers of BAB must set window.consolelog to 1.</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.consolelog == <span class="hljs-number">1</span>) {
        <span class="hljs-built_in">console</span>.log(e)<font></font>
    }<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso √© feito apenas se global </font></font><code>consolelog</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, por exemplo, estiver definido </font></font><code>window.consolelog = 1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os coment√°rios de depura√ß√£o est√£o dispon√≠veis apenas nesta vers√£o. </font><font style="vertical-align: inherit;">Se eu n√£o tivesse revertido todas as vers√µes, nunca as teria notado. </font><font style="vertical-align: inherit;">Eles fornecem informa√ß√µes valiosas sobre como o c√≥digo funciona.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seguran√ßa avan√ßada: AdSense</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos esses m√©todos especiais de prote√ß√£o s√£o codificados </font></font><code>check</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, n√£o </font></font><code>arm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">como, como sugere a arquitetura. </font><font style="vertical-align: inherit;">Talvez um novo desenvolvedor que n√£o esteja familiarizado com a base de c√≥digo tenha come√ßado a trabalhar no produto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se o AdSense estiver ativo na p√°gina, procuraremos an√∫ncios. </font><font style="vertical-align: inherit;">Se eles desaparecerem devido a um bloqueador, o BlockAdBlock ser√° ativado.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check</span>(<span class="hljs-params"></span>) </span>{<font></font>
    ...<font></font>
    var q = <span class="hljs-string">'ins.adsbygoogle'</span>,
        <span class="hljs-comment">// Selects all Google ads in the document.</span>
        adsbygoogleQuery = <span class="hljs-built_in">document</span>.querySelector(q);<font></font>
<font></font>
    <span class="hljs-keyword">if</span> ((adsbygoogleQuery) &amp;&amp; (adblockDetected == <span class="hljs-number">0</span>)) {
        <span class="hljs-comment">// Ads are not blocked, since the bait ad is still there,</span>
        <span class="hljs-comment">// and adblockDetected hasn't been set</span>
        <span class="hljs-keyword">if</span> (aDefOne == <span class="hljs-string">'yes'</span>) {<font></font>
            consolelog(<span class="hljs-string">'case2: standard bait says ads are NOT blocked.'</span>);
            <span class="hljs-keyword">var</span> adsbygoogle = <span class="hljs-string">'//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js'</span>;
            <span class="hljs-keyword">if</span> (scriptExists(adsbygoogle)) {<font></font>
                consolelog(<span class="hljs-string">'case2: And Adsense pre-exists.'</span>);
                <span class="hljs-keyword">if</span> (adsbygoogleQuery.innerHTML.replace(<span class="hljs-regexp">/\s/g</span>, <span class="hljs-string">''</span>).length == <span class="hljs-number">0</span>) {
                    <span class="hljs-comment">// The ad's content was cleared, so...</span>
                    consolelog(<span class="hljs-string">'case2: Ads are blocked.'</span>);
                    <span class="hljs-built_in">window</span>[<span class="hljs-string">''</span> + randomID + <span class="hljs-string">''</span>].arm()<font></font>
                }<font></font>
            }<font></font>
        };<font></font>
        adblockDetected = <span class="hljs-number">1</span><font></font>
    }<font></font>
    ...</code></pre><br>
<code>scriptExists</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verifica a p√°gina inteira em busca de um script com um determinado URL. </font><font style="vertical-align: inherit;">Nesse caso, o script do AdSense </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></sup></a><a name="5_5"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A URL do script √© comparada com todos os scripts da p√°gina. </font><font style="vertical-align: inherit;">Por algum motivo, o URL √© truncado para 15 caracteres.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">scriptExists</span>(<span class="hljs-params">href</span>) </span>{
    <span class="hljs-keyword">if</span> (href) href = href.substr(href.length - <span class="hljs-number">15</span>);
    <span class="hljs-keyword">var</span> scripts = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'script'</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = scripts.length; i--;) {
        <span class="hljs-keyword">var</span> src = <span class="hljs-built_in">String</span>(scripts[i].src);
        <span class="hljs-keyword">if</span> (src) src = src.substr(src.length - <span class="hljs-number">15</span>);
        <span class="hljs-keyword">if</span> (src === href) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><font></font>
    };<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
};</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prote√ß√£o Avan√ßada: Elemento Especial</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diferentemente do primeiro, esse m√©todo √© acompanhado por um aviso: "Teste ap√≥s a instala√ß√£o para garantir a compatibilidade com o site". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essa prote√ß√£o especial funciona apenas se um bloqueador n√£o for encontrado e n√£o houver script do AdSense na p√°gina. </font><font style="vertical-align: inherit;">Aqui est√° o trecho de c√≥digo relevante </font></font><code>check</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="javascript hljs">check: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">checkPredicate, unused</span>) </span>{
    <span class="hljs-keyword">if</span> ((checkPredicate) &amp;&amp; (adblockDetected == <span class="hljs-number">0</span>)) {
        <span class="hljs-comment">// Adblocker detected, arm</span>
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">var</span> q = <span class="hljs-string">'ins.adsbygoogle'</span>,<font></font>
            adsbygoogleQuery = <span class="hljs-built_in">document</span>.querySelector(q);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> ((adsbygoogleQuery) &amp;&amp; (adblockDetected == <span class="hljs-number">0</span>)) {
            <span class="hljs-keyword">if</span> (aDefOne == <span class="hljs-string">'yes'</span>) {
                <span class="hljs-comment">// Special defense one: AdSense defense (see above)</span><font></font>
            };<font></font>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (adblockDetected == <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">if</span> (aDefTwo == <span class="hljs-string">'yes'</span>) {
                    <span class="hljs-comment">// Special defense two: Special element defense</span><font></font>
                }<font></font>
            }<font></font>
        }<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O m√©todo pressup√µe que os propriet√°rios do site usem apenas o AdSense: se um script do AdSense n√£o existir, algo estar√° errado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por que houve um aviso? </font><font style="vertical-align: inherit;">Este m√©todo tenta ativar o script do AdSense. </font><font style="vertical-align: inherit;">Se n√£o carregar, provavelmente o bloqueador bloqueou a solicita√ß√£o de rede, portanto, o BlockAdBlock √© acionado. </font><font style="vertical-align: inherit;">Mas isso pode arruinar alguns sites, da√≠ o aviso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se o AdSense n√£o tiver sido carregado, a sobreposi√ß√£o ser√° iniciada.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">if</span> (aDefTwo == <span class="hljs-string">'yes'</span>) {
    <span class="hljs-comment">/* Add Google ad code to head.
        If it errors, the adblocker must have blocked the connection. */</span>
    <span class="hljs-keyword">var</span> googleAdCode = <span class="hljs-string">'//static.doubleclick.net/instream/ad_status.js'</span>;<font></font>
    consolelog(<span class="hljs-string">'case3: standard bait says ads are NOT blocked. Maybe ???\
      No Adsense is found. Attempting to add Google ad code to head...'</span>);
    <span class="hljs-keyword">var</span> script = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'script'</span>);<font></font>
    script.setAttribute(<span class="hljs-string">'type'</span>, <span class="hljs-string">'text/javascript'</span>);<font></font>
    script.setAttribute(<span class="hljs-string">'src'</span>, googleAdCode);<font></font>
    script.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-built_in">window</span>[<span class="hljs-string">''</span> + randomID + <span class="hljs-string">''</span>].arm()<font></font>
    };<font></font>
    adblockDetected = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span> (!scriptExists(googleAdCode)) {
        <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'head'</span>)[<span class="hljs-number">0</span>].appendChild(script)<font></font>
    };<font></font>
    adsbygoogleQuery = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">window</span>[<span class="hljs-string">''</span> + randomID + <span class="hljs-string">''</span>].check = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span><font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando ocorre uma falha no n√≠vel da rede, ela funciona </font></font><code>onerror</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">como se um bloqueador de an√∫ncios estivesse funcionando. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De fato, a maioria dos bloqueadores de an√∫ncios responde a isso e bloqueia a solicita√ß√£o. </font><font style="vertical-align: inherit;">Mas h√° um bloqueador que eu n√£o mencionei ainda. </font><font style="vertical-align: inherit;">Fale sobre o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">navegador Brave</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Admir√°vel Resposta do Navegador</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At√© agora, estudamos como o anti-bloqueio √© detectado no uBlock Origin. </font><font style="vertical-align: inherit;">E funciona, apenas um filtro espec√≠fico √© necess√°rio para cada site em que o BlockAdBlock est√° instalado. </font><font style="vertical-align: inherit;">O navegador Brave √© impressionante, pois detecta e ignora o BlockAdBlock de todas as vers√µes sem nenhuma a√ß√£o necess√°ria por parte do usu√°rio. </font><font style="vertical-align: inherit;">Para fazer isso, ele falsifica a solicita√ß√£o diretamente na camada de rede </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></sup></a><a name="6_6"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em vez de bloquear a solicita√ß√£o, </font></font><code>ad_status.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ela a ignora, mas </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">carrega o tamanho de 0 bytes de an√∫ncios do Google Ads</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Esse truque engana o BlockAdBlock, porque </font></font><code>onerror</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">funciona apenas se a solicita√ß√£o de rede falhar.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/2e/45/s7/2e45s7wv2nv9licuzwesiao2tkm.png"></div><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vers√£o 5 (mar√ßo de 2016 - novembro de 2016)</font></font></h1><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Diferen√ßa do </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">c√≥digo fonte </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v4 / v5</font></font></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prote√ß√£o avan√ßada: favoritos de spam</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A √∫nica altera√ß√£o nesta vers√£o √© que a segunda prote√ß√£o estendida foi reescrita, embora ainda siga o mesmo princ√≠pio b√°sico: verificar as solicita√ß√µes de rede que ser√£o bloqueadas pelo bloqueador. </font><font style="vertical-align: inherit;">Mas agora os favoritos est√£o sendo carregados, em vez do AdSense. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Brave evita esse ataque da mesma maneira. </font><font style="vertical-align: inherit;">Ele n√£o bloqueia solicita√ß√µes, mas cria imagens 1 √ó 1 falsas.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">if</span> (aDefTwo == <span class="hljs-string">'yes'</span>) {
    <span class="hljs-keyword">if</span> (! <span class="hljs-built_in">window</span>[<span class="hljs-string">''</span> + randomID + <span class="hljs-string">''</span>].ranAlready) {/
        <span class="hljs-keyword">var</span> favicons = [
            <span class="hljs-string">"//www.google.com/adsense/start/images/favicon.ico"</span>,
            <span class="hljs-string">"//www.gstatic.com/adx/doubleclick.ico"</span>,
            <span class="hljs-string">"//advertising.yahoo.com/favicon.ico"</span>,
            <span class="hljs-string">"//ads.twitter.com/favicon.ico"</span>,
            <span class="hljs-string">"//www.doubleclickbygoogle.com/favicon.ico"</span><font></font>
            ],<font></font>
            len = favicons.length,<font></font>
            img = favicons[<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * len)],<font></font>
        ...<font></font>
        baitImages(<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">2</span>) + <span class="hljs-number">1</span>); <span class="hljs-comment">// creates bait images</span>
        <span class="hljs-keyword">var</span> m = <span class="hljs-keyword">new</span> Image();<font></font>
        m.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<font></font>
            baitImages(<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">2</span>) + <span class="hljs-number">1</span>);<font></font>
            c.src = imgCopy;<font></font>
            baitImages(<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">2</span>) + <span class="hljs-number">1</span>)<font></font>
        };<font></font>
        c.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<font></font>
            adblockDetected = <span class="hljs-number">1</span>;<font></font>
            baitImages(<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">3</span>) + <span class="hljs-number">1</span>);
            <span class="hljs-built_in">window</span>[<span class="hljs-string">''</span> + randomID + <span class="hljs-string">''</span>].arm()<font></font>
        };<font></font>
        m.src = img;<font></font>
        baitImages(<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">3</span>) + <span class="hljs-number">1</span>);
        <span class="hljs-built_in">window</span>[<span class="hljs-string">''</span> + randomID + <span class="hljs-string">''</span>].ranAlready = <span class="hljs-literal">true</span><font></font>
    };<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A fun√ß√£o </font></font><code>baitImages</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pode ser chamada com freq√º√™ncia, com um n√∫mero aleat√≥rio de imagens, para ignorar bloqueadores est√°ticos.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vers√£o 6 (abril de 2016 - novembro de 2016): bloqueio corajoso</font></font></h1><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diferen√ßa de </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">c√≥digo-fonte </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">v5 / v6</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Os m√©todos BlockAdBlock, embora simples √† primeira vista, gradualmente se tornaram mais complexos e mais eficientes. </font><font style="vertical-align: inherit;">Mas o √∫ltimo inimigo invicto permaneceu: o navegador Brave.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prote√ß√£o Avan√ßada: Definindo um Favoricon Falsificado</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por que o BlockAdBlock mudou de tentativa de carregar um script para carregar imagens (favicons)? </font><font style="vertical-align: inherit;">A resposta est√° no c√≥digo adicionado √† prote√ß√£o por meio de favoritos de spam e ativado contra a prote√ß√£o do Brave. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verificando a resposta para uma imagem falsa:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">if</span> (aDefTwo == <span class="hljs-string">'yes'</span>) {<font></font>
    baitImages(<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">3</span>) + <span class="hljs-number">1</span>);
    <span class="hljs-comment">// earlier favicon code...</span>
    <span class="hljs-keyword">var</span> m = <span class="hljs-keyword">new</span> Image();
    <span class="hljs-keyword">if</span> ((aDefThree % <span class="hljs-number">3</span>) == <span class="hljs-number">0</span>) {<font></font>
        m.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span> ((m.width &lt; <span class="hljs-number">8</span>) &amp;&amp; (m.width &gt; <span class="hljs-number">0</span>)) {
                <span class="hljs-built_in">window</span>[<span class="hljs-string">''</span> + randomID + <span class="hljs-string">''</span>].arm()<font></font>
            }<font></font>
        }<font></font>
    };<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se o tamanho do favicon for menor que 8 √ó 8, provavelmente isso √© falso no navegador Brave. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com esse truque, o BlockAdBlock ignora o disfarce de Brave e outros bloqueadores que executam esse c√≥digo (a maioria, como o uBlock Origin, bloqueia-o primeiro). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s essa atualiza√ß√£o, no final de novembro de 2016, o BlockAdBlock desapareceu da Internet. </font><font style="vertical-align: inherit;">Embora seus ‚Äúm√©todos avan√ßados de seguran√ßa‚Äù funcionem, eles nunca foram ativados para a maioria dos usu√°rios. </font><font style="vertical-align: inherit;">Esta foi a √∫ltima atualiza√ß√£o. </font><font style="vertical-align: inherit;">A √∫ltima postagem no Twitter e no site foi publicada em algum lugar no final de 2017. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, o legado do BlockAdBlock continua vivo. </font><font style="vertical-align: inherit;">Embora seja trivial bloque√°-lo atualmente, esse script ainda √© usado por alguns sites modernos.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclus√£o</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quem vencer√° a corrida armamentista entre bloqueadores de an√∫ncios e anti-bloqueadores que bloqueiam an√∫ncios? S√≥ o tempo ir√° dizer. √Ä medida que a corrida armamentista se desenvolve, os anti-bloqueadores ter√£o que usar m√©todos mais sofisticados e c√≥digos especiais, como mostra a evolu√ß√£o do BlockAdBlock. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por outro lado, os bloqueadores t√™m a vantagem de sistemas est√°veis ‚Äã‚Äãe poderosas ferramentas de filtragem por meio de listas de filtros, al√©m de acesso ao JavaScript. Com esse sistema, basta uma pessoa entender como derrotar o inimigo - e atualizar a lista de filtros com novos sites. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao analisar a evolu√ß√£o do BlockAdBlock, bem como as v√°rias respostas dos bloqueadores de an√∫ncios, pudemos desenhar uma imagem de uma pequena guerra entre o BlockAdBlock e os bloqueadores. No processo, aprendemos quais m√©todos s√£o usados ‚Äã‚Äãnas hostilidades.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meu c√≥digo de engenharia reversa √© </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">publicado no GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Obrigado pela leitura.</font></font><br>
<br>
<hr><br>
<a name="1"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Se voc√™ quiser ter uma id√©ia de como isso funciona, tente colar o exemplo abaixo no console JS e, em seguida, observe o c√≥digo. </font><font style="vertical-align: inherit;">Se voc√™ est√° interessado em seu funcionamento interno, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui est√° o c√≥digo fonte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Return </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[voltar]</font></font></a><br>
<br>
<a name="2"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. N√£o acredita? </font><font style="vertical-align: inherit;">Tente mudar </font></font><code>eval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para </font></font><code>console.log</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">na primeira linha. </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[para retornar]</font></font></a><br>
<br>
<a name="3"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. O registro de data e hora diz </font></font><code>201510</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ent√£o talvez outubro. </font><font style="vertical-align: inherit;">Mas n√£o sabemos quando o script mudou. </font><font style="vertical-align: inherit;">Todos n√≥s sabemos:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2015-10, uma vers√£o foi salva: </font></font><code>20151007203811.js</code><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2015-11, h√° uma nova vers√£o: </font></font><code>20151113115955.js</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tanto quanto sabemos, o script pode ser alterado no dia anterior ao segundo registro de data e hora. </font><font style="vertical-align: inherit;">Assim, eu abordo de forma conservadora o namoro. </font><font style="vertical-align: inherit;">Return </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[voltar]</font></font></a><br>
<br>
<a name="4"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Durante a corre√ß√£o desse erro, foram desenvolvidos testes para a v1. </font><font style="vertical-align: inherit;">Return </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[voltar]</font></font></a><br>
<br>
<a name="5"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Obrigado a McStroyer no Reddit, que chamou a aten√ß√£o para isso. </font><font style="vertical-align: inherit;">Return </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[voltar]</font></font></a><br>
<br>
<a name="6"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. O componente Brave bloqueador de an√∫ncios est√° aberto, para que possamos examinar o c√≥digo-fonte para ter uma id√©ia de como ele funciona.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O m√©todo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResourceTypeToString</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avalia qual recurso est√° sendo interceptado.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O bloqueador de an√∫ncios corajoso no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ShouldStartRequest</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verifica </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se o recurso capturado corresponde √† regra de bloqueio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se apropriado, ele retorna um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recurso falso com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> base em um tipo anterior de recurso e relata uma solicita√ß√£o "bem-sucedida".</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agradecemos a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fran√ßois Marie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> por indicar o c√≥digo fonte do Brave. </font><font style="vertical-align: inherit;">Return </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[voltar]</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt499118/index.html">Como criar um v√≠deo viral</a></li>
<li><a href="../pt499120/index.html">[Bookmark] CSS: Usando recuo e recuo</a></li>
<li><a href="../pt499122/index.html">Como organizar o trabalho em condi√ß√µes em constante mudan√ßa: os cursos gratuitos anti-crise da Aktion</a></li>
<li><a href="../pt499126/index.html">Cora√ß√£o do desenvolvedor: Sony PlayStation 1 Devkits</a></li>
<li><a href="../pt499128/index.html">Apresentando a vers√£o mais recente de visualiza√ß√£o do Windows Terminal - 0.11</a></li>
<li><a href="../pt499134/index.html">4 etapas para aumentar o produto LTV atrav√©s da comunica√ß√£o com o usu√°rio</a></li>
<li><a href="../pt499136/index.html">#BeeFree, ou ... Beeline - voc√™ n√£o resistiu?</a></li>
<li><a href="../pt499138/index.html">Classifica√ß√£o topol√≥gica</a></li>
<li><a href="../pt499140/index.html">Gera√ß√£o sob controle: como controlar poderosos modelos de linguagem</a></li>
<li><a href="../pt499146/index.html">Uma maneira f√°cil de proteger seu Mikrotik de ataques</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>