<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧘🏿 👨🏻‍🎓 🚥 Réduisez la taille du modèle ML sans inscription ni SMS ⛺️ 🚠 👃🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Quiconque rencontre l'apprentissage automatique comprend que cela nécessite une puissance de calcul importante. Dans cet article, nous allons essayer ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Réduisez la taille du modèle ML sans inscription ni SMS</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/504354/"><img src="https://habrastorage.org/webt/u3/w2/jm/u3w2jmkqidenskb9-sgwysh2gy8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quiconque rencontre l'apprentissage automatique comprend que cela nécessite une puissance de calcul importante. Dans cet article, nous allons essayer d'appliquer l'algorithme développé au MIT pour compresser un réseau de neurones, ce qui réduira la dimension des poids du modèle entraîné et conduira à la fois à un apprentissage plus rapide et à un lancement plus rapide du modèle. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les réseaux de neurones se sont révélés être un excellent outil pour résoudre une grande variété de tâches, mais, malheureusement, leur utilisation nécessite une puissance de calcul importante, qui n'est peut-être pas encore dans une petite entreprise. Il existe de nombreux types de compression des réseaux de neurones qui peuvent être divisés en matériel, bas niveau et mathématiques, mais cet article discutera de la méthode développée au MIT en 2019 et travaillant directement avec le réseau de neurones lui-même.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette méthode est appelée «l'hypothèse du ticket gagnant». </font><font style="vertical-align: inherit;">En termes généraux, cela ressemble à ceci: Tout réseau de neurones entièrement connecté avec des poids initialisés de manière aléatoire contient un sous-réseau avec les mêmes poids, et un tel sous-réseau formé séparément peut être égal en précision au réseau d'origine. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une preuve formelle et un article complet peuvent être trouvés </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Nous sommes intéressés par la possibilité d'application pratique. </font><font style="vertical-align: inherit;">En bref, l'algorithme est le suivant:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous créons un modèle, initialisons au hasard ses paramètres</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apprentissage d'un réseau d'itérations j</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous supprimons les paramètres réseau qui ont la plus petite valeur (la tâche la plus simple consiste à définir une valeur de seuil)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous remettons les paramètres restants à leurs valeurs initiales, nous obtenons le sous-réseau dont nous avons besoin.</font></font></li>
</ol><br>
<a name="habracut"></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En théorie, cet algorithme doit être répété le nième nombre d'étapes, mais pour un exemple nous n'effectuerons qu'une seule itération. </font><font style="vertical-align: inherit;">Créez un réseau simple entièrement connecté à l'aide de tensorflow et Keras:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf
<span class="hljs-keyword">from</span> tensorflow <span class="hljs-keyword">import</span> keras<font></font>
<font></font>
model = keras.Sequential([<font></font>
    keras.layers.Flatten(input_shape=(<span class="hljs-number">28</span>, <span class="hljs-number">28</span>)),<font></font>
    keras.layers.Dense(<span class="hljs-number">300</span>, activation=<span class="hljs-string">'relu'</span>),<font></font>
    keras.layers.Dense(<span class="hljs-number">150</span>, activation=<span class="hljs-string">'relu'</span>),<font></font>
    keras.layers.Dense(<span class="hljs-number">10</span>, activation=<span class="hljs-string">'softmax'</span>)<font></font>
])<font></font>
<font></font>
model.compile(optimizer=<span class="hljs-string">'SGD'</span>,<font></font>
              loss=<span class="hljs-string">'sparse_categorical_crossentropy'</span>,<font></font>
              metrics=[<span class="hljs-string">'accuracy'</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous obtiendrons l'architecture de réseau suivante: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/t6/c_/cy/t6c_cypjz1pyzbzlebveqxseiag.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et nous la formerons sur l'ensemble de données de la mode MNIST de 60 000 images. </font><font style="vertical-align: inherit;">Sa précision sur les données de vérification sera égale à 0,8594. </font><font style="vertical-align: inherit;">Nous appliquons aux paramètres d'itération du réseau 1 de cet algorithme. </font><font style="vertical-align: inherit;">En code, cela ressemble à ceci:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#  </span>
threshold = <span class="hljs-number">0.001</span><font></font>
<font></font>
<span class="hljs-comment">#       np.array</span><font></font>
weights = model.weights<font></font>
weights = np.asarray(weights)<font></font>
<font></font>
<span class="hljs-comment">#    </span>
first_h_layer_weights = weights[<span class="hljs-number">1</span>]<font></font>
second_h_layer_weights = weights[<span class="hljs-number">3</span>]<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete_from_layers</span>(<span class="hljs-params">one_d_array, threshold</span>):</span><font></font>
    index = []<font></font>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(one_d_array.shape[<span class="hljs-number">0</span>]):
        <span class="hljs-comment">#   ,       </span>
        <span class="hljs-keyword">if</span> abs(one_d_array[i]) &lt;= threshold:<font></font>
            index.append(i)<font></font>
    <span class="hljs-comment">#    ,   </span><font></font>
    new_layer = np.delete(one_d_array, index)<font></font>
    <span class="hljs-keyword">return</span> new_layer<font></font>
<font></font>
new_layer_weights = delete_from_layers(second_h_layer_weights, threshold)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, après avoir exécuté ce code, nous nous débarrasserons des poids pratiquement inutilisés. </font><font style="vertical-align: inherit;">Deux choses méritent d'être notées: dans cet exemple, le seuil a été choisi empiriquement et cet algorithme ne peut pas être appliqué aux poids des couches d'entrée et de sortie. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir reçu de nouveaux poids, il est nécessaire de redéfinir le modèle d'origine, en supprimant l'excédent. </font><font style="vertical-align: inherit;">En conséquence, nous obtenons:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yd/yp/uo/ydypuoqyvx--8f5bgzjr-yee97q.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez remarquer que le nombre total de paramètres a diminué de près de 2 fois, ce qui signifie que lors de la formation du premier réseau, plus de la moitié des paramètres étaient tout simplement inutiles. </font><font style="vertical-align: inherit;">Dans le même temps, la précision du sous-réseau est de 0,8555, ce qui est un peu inférieur à celui du réseau principal. </font><font style="vertical-align: inherit;">Bien sûr, cet exemple est indicatif, généralement le réseau peut être réduit de 10 à 20% du nombre initial de paramètres. </font><font style="vertical-align: inherit;">Ici, même sans appliquer cet algorithme, il est clair que l'architecture d'origine a été choisie trop lourde. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conclusion, nous pouvons dire que cette technique n'est pas bien développée pour le moment, et dans les tâches réelles, une tentative d'optimiser les poids du modèle de cette manière ne peut que rallonger le processus d'apprentissage, mais l'algorithme lui-même a beaucoup de potentiel.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr504328/index.html">Cours de vote électronique à la Douma de Moscou 2019</a></li>
<li><a href="../fr504334/index.html">Насколько хорошо вы знаете JavaScript?</a></li>
<li><a href="../fr504344/index.html">Authentification - CUSTOM SETUP / AWS Amplify + React Native</a></li>
<li><a href="../fr504348/index.html">Monowheel: ce qui se passe pendant l'entraînement et comment accélérer ce processus</a></li>
<li><a href="../fr504352/index.html">Dix entreprises que Figma a aidé à atteindre de nouveaux résultats de conception et plus encore</a></li>
<li><a href="../fr504356/index.html">PHP 8 en huit morceaux de code</a></li>
<li><a href="../fr504358/index.html">PuppetConf 2016. Kubernetes pour les administrateurs système. Partie 2</a></li>
<li><a href="../fr504362/index.html">Chargez rapidement de grandes quantités de données dans Google Colab</a></li>
<li><a href="../fr504370/index.html">Office 365 et équipes Microsoft - Commodité de collaboration et impact sur la sécurité</a></li>
<li><a href="../hi486176/index.html">कॉर्पोरेट ईमेल पत्राचार मेमो</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>