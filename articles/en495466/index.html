<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ùáÔ∏è ‚ùî üîΩ Hacker traps. Detect hacking early with Canarytokens üíê üó°Ô∏è üßò</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Honey Tokens (English - ‚Äúhoney signs / signs / identifiers‚Äù) is one of the varieties of the Honeypot idea, a bait for intruders to detect the fact of ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Hacker traps. Detect hacking early with Canarytokens</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/495466/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Honey Tokens (English - ‚Äúhoney signs / signs / identifiers‚Äù) is one of the varieties of the Honeypot idea, a bait for intruders to detect the fact of a hack or to identify its source. </font><font style="vertical-align: inherit;">When the attacker has already entered the system, he is likely to perform actions unusual for the ordinary user. </font><font style="vertical-align: inherit;">This can be used as a way to detect hacking. </font><font style="vertical-align: inherit;">In this article, we will look at how easy it is to make your own triggers to detect hacking at an early stage. </font><font style="vertical-align: inherit;">Such traps are useful for system administrators and even ordinary users who are worried about the privacy of their data.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/xq/wk/ks/xqwkksjf6adatsv3lhu-am4ph6w.jpeg"></div></a><br>
<font color="#999999"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Before the invention of gas analyzers, miners took a canary with them to the mine. </font><font style="vertical-align: inherit;">Due to the small body and rapid metabolism, birds reacted to dangerous gases in the air much earlier and warned miners.</font></font></i></font><a name="habracut"></a><br>
<br>
<h3><font color="‚Äú#3AC1EF‚Äù"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why is this needed?</font></font></font></h3><br>
<img src="https://habrastorage.org/webt/ji/uf/cb/jiufcbwkepg-izswuadwxjkerxe.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The hacker, once in the new system, begins to look around, as a thief, having penetrated the apartment, begins to open all the boxes in search of jewelry. </font><font style="vertical-align: inherit;">The attacker does not know in advance which particular data is of value, but with a high probability he will check all possible options. </font><font style="vertical-align: inherit;">Therefore, it is important that the traps look like real data and are as attractive to the attacker as possible. </font><font style="vertical-align: inherit;">The sooner the owner notices that the trap is triggered, the sooner he will realize that he was hacked and will be able to respond.</font></font><br>
<br>
<h3><font color="‚Äú#3AC1EF‚Äù"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Canarytokens Service</font></font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canarytokens.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is an online service for conveniently creating your own markers (hanitokens) for hacking. </font><font style="vertical-align: inherit;">It supports several trigger options and allows you to generate a ready-made trigger with attached mail, where a notification will be sent if the trigger worked. </font></font><br>
<img src="https://habrastorage.org/webt/dt/as/lm/dtaslm6-vs_4c-cl6h5nqzlqh70.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The service is completely free, and a trigger can be generated instantly without registration. </font><font style="vertical-align: inherit;">There is also a self hosted version for those who prefer to keep secrets on their infrastructure. </font><font style="vertical-align: inherit;">Next, we will look at how each of the triggers works and at the end we will deploy our own canarytokens server in the Docker container.</font></font><br>
<br>
<h3><font color="‚Äú#3AC1EF‚Äù"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trigger when opening a .doc and pdf file</font></font></font></h3><br>
<img width="300" src="https://habrastorage.org/webt/x9/mw/tn/x9mwtnlqxhixsnu5o6fod1tgwao.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It will work if the document was opened by the program for viewing. </font><font style="vertical-align: inherit;">I use this trick very often. </font><font style="vertical-align: inherit;">On each computer and flash drive, I have documents with attractive names like Passwords.pdf or Bitcoins.doc. </font><font style="vertical-align: inherit;">I love to watch how accountants with curiosity examine all the files on the flash drive transferred to them. </font></font><br>
 &nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 I consider this trigger to be the most effective and useful for all categories of users, from information security professionals to beginners. </font><font style="vertical-align: inherit;">Almost no one knows that a PDF viewer can convey the fact of opening a file to the document owner. </font><font style="vertical-align: inherit;">Everyone comes across this.</font></font><br>
 &nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 There are several ways to catch the fact of opening a document. </font><font style="vertical-align: inherit;">Canarytokens uses a document-specific URL embedded in the document to verify the revoked SSL certificates (Certificate Revocation List). </font><font style="vertical-align: inherit;">As a result, the program goes to this address and the trigger fires.</font></font><br>
<br>
<h3><font color="‚Äú#3AC1EF‚Äù"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trigger via DNS resolve</font></font></font></h3><br>
<img width="500" src="https://habrastorage.org/webt/am/i1/wh/ami1whax3utfizv4zfgxuerxc9g.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is a very interesting trigger, the benefits of which are not immediately obvious. </font><font style="vertical-align: inherit;">It will work if someone asks for the IP address of the generated subdomain, which is specially generated so that it cannot be guessed by chance or twisted. </font><font style="vertical-align: inherit;">Thus, accidental operations are excluded. </font><font style="vertical-align: inherit;">This trigger is used for many of the techniques described below, including to detect the fact of opening a folder and as a trigger in the MS SQL database. </font><font style="vertical-align: inherit;">In fact, there are many options for using this trigger.</font></font><br>
<br>
<h3><font color="‚Äú#3AC1EF‚Äù"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">URL trigger</font></font></font></h3><br>
<img width="500" src="https://habrastorage.org/webt/60/mk/dn/60mkdnqqsqvla-5cc7-2nbkotrs.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this case, it is enough that a GET, POST or HEAD request is executed by reference. </font><font style="vertical-align: inherit;">This will trigger the trigger. </font><font style="vertical-align: inherit;">In addition to its usual use, it can also be used in scripts to check parsers that follow links to display previews of content. </font><font style="vertical-align: inherit;">So do, for example, instant messengers: just write a link in the input field that you clicked on from the messenger servers.</font></font><br>
<br>
<h3><font color="‚Äú#3AC1EF‚Äù"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Picture</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The classic 1x1 pixel image is known to everyone who tracks online advertising. </font><font style="vertical-align: inherit;">The trigger will work if a picture file has been uploaded. </font><font style="vertical-align: inherit;">Such a pixel can be inserted into any html page or in a letter. </font><font style="vertical-align: inherit;">It is convenient to call it from JS scripts on the page if the necessary condition has worked. </font><font style="vertical-align: inherit;">You can also replace the standard pixel with your own image.</font></font><br>
<br>
<h3><font color="‚Äú#3AC1EF‚Äù"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Email Trigger</font></font></font></h3><br>
<img width="300" src="https://habrastorage.org/webt/mo/4e/sm/mo4esmyilw_y8lzwqhhw2-kaemq.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If any letter arrives at the generated mailbox, the trigger will work. </font><font style="vertical-align: inherit;">It is convenient to use email addresses, contact lists, etc. to monitor the leakage of databases. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, you can add this address to your contact list and find out when your notebook on your phone will be merged by some application requesting access to your contact list . </font><font style="vertical-align: inherit;">It is also possible for all employees to add different trigger addresses to notebooks on a computer, phone, email client and keep track of where the contacts are coming from. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An e-mail address is specially generated that is not predictable, therefore, the probability of selection and accidental triggering of a trigger is excluded.</font></font><br>
<br>
<h3><font color="‚Äú#3AC1EF‚Äù"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows folder open trigger</font></font></font></h3><br>
<img width="100" src="https://habrastorage.org/webt/fp/zd/hx/fpzdhxc0olbpomnpgglqlhrd9f4.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Surely many saw a hidden desktop.ini file that is in every Windows folder. </font><font style="vertical-align: inherit;">It turns out he is not so simple. </font><font style="vertical-align: inherit;">In it, you can specify the address of the icon on the remote server, using UNC paths (these are the ones used for network drives and start with \\), while Windows will perform DNS resolve on the domain specified in the link to the icon and activate the trigger. </font><font style="vertical-align: inherit;">The desktop.ini file can be packed with other files into the archive, and it will work if the archive is unpacked.</font></font><br>
<br>
<h3><font color="‚Äú#3AC1EF‚Äù"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Site Cloning Trigger</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A simple script for web pages that works if the page is not open from your domain. </font><font style="vertical-align: inherit;">May be useful for detecting phishing.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.domain != <span class="hljs-string">"mydomain.com"</span>) {
    <span class="hljs-keyword">var</span> l = location.href;
    <span class="hljs-keyword">var</span> r = <span class="hljs-built_in">document</span>.referrer;
    <span class="hljs-keyword">var</span> m = <span class="hljs-keyword">new</span> Image();<font></font>
    m.src = <span class="hljs-string">"http://canarytokens.com/"</span>+
            <span class="hljs-string">"blablabla.jpg?l="</span>+
            <span class="hljs-built_in">encodeURI</span>(l) + <span class="hljs-string">"&amp;r="</span> + <span class="hljs-built_in">encodeURI</span>(r);<font></font>
}</code></pre><br>
<h3><font color="‚Äú#3AC1EF‚Äù"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trigger to run an EXE file or DLL</font></font></font></h3><br>
<img width="300" src="https://habrastorage.org/webt/co/3f/q5/co3fq5b-ivp-imere3zbbdcmmfe.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Allow to glue the trigger with an existing executable .exe file or library. </font><font style="vertical-align: inherit;">It is not detected by antiviruses. </font><font style="vertical-align: inherit;">It should be borne in mind that such a gluing can break some programs, so it's better to use something simple. </font><font style="vertical-align: inherit;">In fact, this is a long-known method used to spread trojans and viruses, only in our case the hidden functionality is completely harmless. </font><font style="vertical-align: inherit;">However, it should be borne in mind that the executable file can cause a greater alertness for the attacker, and also not run on his operating system.</font></font><br>
<br>
<h3><font color="‚Äú#3AC1EF‚Äù"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trigger for MS SQL</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MS SQL allows you to add a trigger to perform INSERT, SELECT, DELETE, etc. To trigger a trigger, use the same method as for a desktop.ini file, namely resolve a DNS name through UNC paths.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trigger example for MS SQL</font></font></b><div class="spoiler_text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--create a stored proc that'll ping canarytokens </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 CREATE proc ping_canarytoken </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 AS </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 BEGIN </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 declare</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">username</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> varchar (max), </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">base64</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> varchar (max), @tokendomain varchar (128), @unc varchar (128), </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">size</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> int </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">done</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> int </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">random</font></font></a> varchar(3);<br>
<br>
--setup the variables<br>
 set @tokendomain = 'qo2dd6tftntl1pej9j68v31k6.canarytokens.com';<br>
 set <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link">size</a> = 128;<br>
 set <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link">done</a> = 0;<br>
 set <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link">random</a> = cast(round(rand()*100,0) as varchar(2));<br>
 set <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link">random</a> = concat(<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link">random</a>, '.');<br>
 set <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link">username</a> = SUSER_SNAME();<br>
<br>
--loop runs until the UNC path is 128 chars or less<br>
 while <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link">done</a> &lt;= 0<br>
 begin<br>
 --convert username into base64<br>
 select <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link">base64</a> = (SELECT<br>
 CAST(N'' AS XML).value(<br>
 'xs:base64Binary(xs:hexBinary(sql:column(¬´bin¬ª)))'<br>
, 'VARCHAR(MAX)'<br>
 ) Base64Encoding<br>
 FROM (<br>
 SELECT CAST(<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link">username</a> AS VARBINARY(MAX)) AS bin<br>
 ) AS bin_sql_server_temp);<br>
<br>
--replace base64 padding as dns will choke on =<br>
 select <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link">base64</a> = replace(<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link">base64</a>,'=','-')<br>
<br>
--construct the UNC path<br>
 select @unc = concat('\\',@base64,'.',@random,@tokendomain,'\a')<br>
<br>
 ‚Äî if too big, trim the username and try again<br>
 if len(@unc) &lt;= <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link">size</a><br>
 set <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link">done</a> = 1<br>
 else<br>
 --trim from the front, to keep the username and lose domain details<br>
 select <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link">username</a> = substring(<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link">username</a>, 2, len(<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link">username</a>)-1)<br>
 end<br>
 exec master.dbo.xp_fileexist @unc;<br>
 END<br>
<br>
--add a trigger if data is altered<br>
 CREATE TRIGGER TRIGGER1<br>
 ON TABLE1<br>
 AFTER INSERT<br>
 AS<br>
 BEGIN<br>
 exec ping_canarytoken<br>
 end<br>
</div></div><br>
<h3><font color="‚Äú#3AC1EF‚Äù"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amazon Web Services Login Trigger</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The Amazon services API key should entice an attacker to check what‚Äôs in there. </font><font style="vertical-align: inherit;">If this API key is used for login, the trigger will fire. </font><font style="vertical-align: inherit;">In this case, of course, there is no data there.</font></font><br>
<br>
<h3><font color="‚Äú#3AC1EF‚Äù"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Other triggers</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The canarytokens.org service also supports other triggers, such as an SVN hook, web redirect, reading a QR code, Slack API key, and others. </font><font style="vertical-align: inherit;">They all use a similar principle, and if you wish, you can independently create your own trigger, having in your arsenal a DNS name, a link with a picture, a mailing address and API keys for popular services. </font><font style="vertical-align: inherit;">In addition to email notifications, Canarytokens can pull a web hook if a trigger fires. </font><font style="vertical-align: inherit;">The mechanisms of operation are described in the documentation.</font></font><br>
<br>
<h3><font color="‚Äú#3AC1EF‚Äù"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Canarytokens Native Server</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An experienced cracker, seeing in the source code the address canarytokens.org immediately guess about everything. </font><font style="vertical-align: inherit;">Therefore, for use in the company, it is better to deploy your own canarytokens instance so that all trigger addresses go to the company's internal domains and are indistinguishable from real internal services. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Developers provide a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ready-to-use Docker image</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The installation process is quite typical for any image, so we will not touch on this topic. </font><font style="vertical-align: inherit;">Let us dwell only on non-obvious points. </font><font style="vertical-align: inherit;">Before installing, you will have to edit the file </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">frontend.env</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">switchboard.env</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># ()       </span>
<span class="hljs-comment">#     IP-    Docker.        SSL-.</span><font></font>
CANARY_DOMAINS=example1.com,example2.com<font></font>
<font></font>
<span class="hljs-comment">#            PDF-</span>
<span class="hljs-comment">#    NS-          .</span>
<span class="hljs-comment">#   example3.com     example1.com  example2.com</span><font></font>
CANARY_NXDOMAINS=example3.com<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To send mail, I recommend using the Mailgun service, because Sendgrid is unstable.</font></font><br>
<br>
<h3><font color="‚Äú#3AC1EF‚Äù"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Such traps are really effective. </font><font style="vertical-align: inherit;">In my case, triggers with PDF files are especially helpful. </font><font style="vertical-align: inherit;">The service will be useful for both ordinary users and experienced pentesters. </font><font style="vertical-align: inherit;">Even a sophisticated attacker who knows about the existence of Hanipots and Hanitokens will not be able to resist the temptation to at least sober up the subdomain found in the documentation. </font><font style="vertical-align: inherit;">If you carefully and wisely use traps, you can detect an cracker at an early stage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
These techniques can be used on servers, desktop computers, file storages, and even on phones. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you want to deploy canarytokens in your own Docker instance, on our virtual machines Docker is installed in one click from the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">marketplace</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Additionally, we give a 15% discount on all servers using the </font><b><font style="vertical-align: inherit;">DONTPANIC</font></b><font style="vertical-align: inherit;"> promo code</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/iq/fi/b4/iqfib45pgphfrxv--zfemt0qnmw.jpeg"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en495456/index.html">Review of 14 fresh plugins for Figma that will help increase productivity while we all</a></li>
<li><a href="../en495458/index.html">How to write code when children run around you and ask: ‚ÄúWhat will you work for?‚Äù</a></li>
<li><a href="../en495460/index.html">A gas bubble 22,000 times the size of the Earth exploded on Uranus</a></li>
<li><a href="../en495462/index.html">.NET Core: x86_64 Intrinsics on Virtual Machines</a></li>
<li><a href="../en495464/index.html">Information message 404 - not only a mistake, but also a holiday</a></li>
<li><a href="../en495468/index.html">Price tag recognition algorithm that works even on data collection terminals</a></li>
<li><a href="../en495472/index.html">Switching to vegetarianism will not prevent people from becoming infected from diseases like COVID-19</a></li>
<li><a href="../en495474/index.html">DataGrip 2020.1: Launch configurations, export to Excel, results in the editor and more</a></li>
<li><a href="../en495476/index.html">Why the Atari DeepMind AI success is disappointing</a></li>
<li><a href="../en495478/index.html">Big and small data tester: trends, theory, my story</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>