<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ป ๐ ๐คฝ๐ผ ุจุฑูุฌุฉ ุบูุฑ ูุชุฒุงููุฉ ูู .NET: ุฃูุถู ุงูููุงุฑุณุงุช ๐ฒ ๐ค ๐ฅ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุฃุฏู ุธููุฑ async / ุงูุชุธุงุฑ ูู C # ุฅูู ุฅุนุงุฏุฉ ุชุนุฑูู ููููุฉ ูุชุงุจุฉ ุฑูุฒ ููุงุฒ ุจุณูุท ูุตุญูุญ. ูู ูุซูุฑ ูู ุงูุฃุญูุงู ุ ุจุงุณุชุฎุฏุงู ุงูุจุฑูุฌุฉ ุบูุฑ ุงููุชุฒุงููุฉ ุ ูุง ูููู ุงููุจุฑูุฌู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ุจุฑูุฌุฉ ุบูุฑ ูุชุฒุงููุฉ ูู .NET: ุฃูุถู ุงูููุงุฑุณุงุช</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/491236/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุฏู ุธููุฑ async / ุงูุชุธุงุฑ ูู C # ุฅูู ุฅุนุงุฏุฉ ุชุนุฑูู ููููุฉ ูุชุงุจุฉ ุฑูุฒ ููุงุฒ ุจุณูุท ูุตุญูุญ. ูู ูุซูุฑ ูู ุงูุฃุญูุงู ุ ุจุงุณุชุฎุฏุงู ุงูุจุฑูุฌุฉ ุบูุฑ ุงููุชุฒุงููุฉ ุ ูุง ูููู ุงููุจุฑูุฌูู ููุท ุจุญู ุงููุดุงูู ุงูุชู ูุงูุช ุชุชุนูู ุจุงูุฎููุท ุ ูููู ุฃูุถูุง ุชูุฏูู ูุดููุงุช ุฌุฏูุฏุฉ. ุงูุทุฑู ุงููุณุฏูุฏุฉ ูุงูุฑุญูุงุช ูุง ุชุฐูุจ ุฅูู ุฃู ููุงู - ุจู ูุตุจุญ ูู ุงูุตุนุจ ุชุดุฎูุตูุง. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bu/uz/8g/buuz8gok2hqubwnj1773hwimncq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏููุชุฑู ุฅููุงููู - ูุฑูู ุชุญููู ุงูุจุฑูุฌูุงุช ุ ูู ููุงูู ุ ููู ุชูููุฉ TechBide ู JetBrains Rider ุณุงุจูุฉ ูู ReSharper core: ููุงูู ุงูุจูุงูุงุช ุ ูุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ูุงูููุงูุงุช ุงููุชุนุฏุฏุฉ ุ ูุงููุชุญุฏุซ ุงูุนุงุฏู ูู ูุคุชูุฑ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DotNext</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุญุช ุงููุดูุฏ - ุชุณุฌูู ุงูููุฏูู ููุณุฎ ุงููุต ูุชูุฑูุฑ ุฏููุชุฑู ูู ูุคุชูุฑ DotNext 2019 Piter.</font></font><br>
<a name="habracut"></a><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/wM-h6P1BJRk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe> <br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฒูุฏ ูู ุงูุณุฑุฏ ููุงุจุฉ ุนู ุงููุชุญุฏุซ.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูุชุนุฏุฏุฉ ุงูุฎููุท ุฃู ุบูุฑ ุงููุชุฒุงููุฉ ุ ุบุงูุจูุง ูุง ูููุณุฑ ุดูุก ูุง. ูุฏ ูููู ุงูุณุจุจ ุงูุฌููุฏ ูุงูุนุฑู. ููุงุนุฏุฉ ุ ูุชุนุทู ุงูุณุจุงู ูุฑุฉ ูุงุญุฏุฉ ูู ุงูุฃูู ุ ุบุงูุจูุง ููุณ ูุญูููุง ุ ูููู ููุท ุนูู ุฎุงุฏู ุจูุงุก ุ ููุณุชุบุฑู ุงูุฃูุฑ ุนุฏุฉ ุฃูุงู ูููุจุถ ุนููู. ุฃูุง ูุชุฃูุฏ ูู ุฃู ูุฐุง ูููู ูุฃููู ูููุซูุฑูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุจุงููุธุฑ ุฅูู ุงูุดูุฑุฉ ุบูุฑ ุงููุชุฒุงููุฉ ุญุชู ูู ูุจู ุงููุทูุฑูู ุฐูู ุงูุฎุจุฑุฉ ุ ุฃุฌุฏ ููุณู ุฃููุฑ ูู ุฃู ุจุนุถ ุงูุฃุดูุงุก ูููู ูุชุงุจุชูุง ุซูุงุซ ูุฑุงุช ุฃูุตุฑ ูุฃูุซุฑ ุตุญุฉ.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐุง ูุดูุฑ ุฅูู ุฃู ุงููุดููุฉ ููุณุช ูู ุงููุงุณ ุ ูููู ูู ุงูุตู. </font><font style="vertical-align: inherit;">ูุณุชุฎุฏู ุงููุงุณ ุงูุฃุฏุงุฉ ููุฑูุฏูููุง ูุญู ูุดููุชูู. </font><font style="vertical-align: inherit;">ุชุญุชูู ุงูุฃุฏุงุฉ ููุณูุง ุนูู ุนุฏุฏ ูุจูุฑ ุฌุฏูุง ูู ุงููุฏุฑุงุช (ุฃุญูุงููุง ุฒุงุฆุฏุฉ ุนู ุงูุญุงุฌุฉ) ุ ูุงูุฅุนุฏุงุฏุงุช ุ ูุงูุณูุงู ุงูุถููู ุ ููุง ูุคุฏู ุฅูู ุญูููุฉ ุฃูู ูู ุงูุณูู ุฌุฏูุง ุงุณุชุฎุฏุงูู ุจุดูู ุบูุฑ ุตุญูุญ. </font><font style="vertical-align: inherit;">ุฏุนููุง ูุญุงูู ูุนุฑูุฉ ููููุฉ ุงุณุชุฎุฏุงู ุงููุชุฒุงูู / ุงูุงูุชุธุงุฑ ูุงูุนูู ูุน ูุตู </font></font><code>Task</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏุฑุงุณู ูู .NET.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎุทุฉ</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุดุงูู ูู ุงูุฃุณุงููุจ ุงูุชู ูุชู ุญููุง ุจุงุณุชุฎุฏุงู ุบูุฑ ูุชุฒุงูู / ุงูุชุธุงุฑ.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุซูุฉ ุนูู ุงูุชุตููู ุงููุซูุฑ ููุฌุฏู.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุฉ ูู ุงูุญูุงุฉ ุงููุงูุนูุฉ ุณูููู ุจุญููุง ุจุดูู ุบูุฑ ูุชุฒุงูู.</font></font></li>
</ul><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุบูุฑ ูุชุฒุงูู / ูู ุงูุชุธุงุฑ ุญู ุงููุดุงูู</font></font></h2><br>
<img src="https://habrastorage.org/webt/v1/ym/30/v1ym304jgxmwh_4kymlyqr4wddi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงุฐุง ูุญุชุงุฌ ุฅูู ูุฒุงููุฉ / ุงูุชุธุงุฑุ ูููุชุฑุถ ุฃู ูุฏููุง ููุฏูุง ูุนูู ูุน ุงูุฐุงูุฑุฉ ุงููุดุชุฑูุฉ ุงููุดุชุฑูุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุจุฏุงูุฉ ุงูุนูู ุ ูุฑุฃูุง ุงูุทูุจ ุ ูู ูุฐู ุงูุญุงูุฉ ุ ุงูููู ูู ูุงุฆูุฉ ุงูุชุธุงุฑ ุงูุญุธุฑ (ุนูู ุณุจูู ุงููุซุงู ุ ูู ุงูุฅูุชุฑูุช ุฃู ูู ุงููุฑุต) ุ ุจุงุณุชุฎุฏุงู ุทูุจ ุญุธุฑ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dequeue</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ุณูุชู ูุถุน ุนูุงูุฉ ุนูู ุทูุจุงุช ุงูุญุธุฑ ุจุงูููู ุงูุฃุญูุฑ ูู ุงูุตูุฑ ูุน ุฃูุซูุฉ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชุทูุจ ูุฐุง ุงูุฃุณููุจ ุงููุซูุฑ ูู ุณูุงุณู ุงูุนูููุงุช ุ ููู ุณูุณูุฉ ูุคุดุฑุงุช ุชุชุทูุจ ููุงุฑุฏ ุ ูุชูุดุฆ ุญูููุง ุนูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุฌุฏูู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ููู ูุฐู ููุณุช ุงููุดููุฉ ุงูุฑุฆูุณูุฉ. ูููุชุฑุถ ุฃู ุจุฅููุงู ุงูุฃุดุฎุงุต ุฅุนุงุฏุฉ ูุชุงุจุฉ ุฃูุธูุฉ ุงูุชุดุบูู ุจุญูุซ ุชุฏุนู ูุฐู ุงูุฃูุธูุฉ ูุงุฆุฉ ุฃูู ูููุงููู ุงูุณูุงุณู. ููู ุงููุดููุฉ ุงูุฑุฆูุณูุฉ ูู ุฃูู ูุง ูููู ุฃุฎุฐ ุจุนุถ ุงูุฎููุท. ุนูู ุณุจูู ุงููุซุงู ุ ูุฏูู ูุคุดุฑ ุชุฑุงุจุท ููุงุฌูุฉ ุงููุณุชุฎุฏู. ูุง ุชูุฌุฏ ุฃุทุฑ ุนูู ุนุงุฏูุฉ ููุงุณุจุฉ ููุงุฌูุฉ ุงููุณุชุฎุฏู ุญูุซ ูู ูููู ุงููุตูู ุฅูู ุงูุจูุงูุงุช ูู ุณูุณูุฉ ูุญุงุฏุซุงุช ูุงุญุฏุฉ ููุท ุญุชู ุงูุขู. ูุง ูููู ุญุธุฑ ูุคุดุฑ ุชุฑุงุจุท ูุงุฌูุฉ ุงููุณุชุฎุฏู. ูููู ูุง ูุชู ุญุธุฑู ุ ูุญุชุงุฌ ุฅูู ุฑูุฒ ุบูุฑ ูุชุฒุงูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ููุชุญุฏุซ ุนู ุงููููุฉ ุงูุซุงููุฉ. ุจุนุฏ ูุฑุงุกุฉ ุงูููู ุ ูุฌุจ ูุนุงูุฌุชู ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู. ุณููุนู ุฐูู ุจุงูุชูุงุฒู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฏ ุณูุน ุงููุซูุฑ ูููู ุฃู ุงูุชูุงุฒู ููุณ ูู ููุณ ุงูุชุฒุงูู. ูู ูุฐู ุงูุญุงูุฉ ุ ูุทุฑุญ ุงูุณุคุงู: ูู ูููู ููุชุฒุงูู ุฃู ูุณุงุนุฏ ูู ูุชุงุจุฉ ููุฏ ูุชูุงุฒู ุฃูุซุฑ ุฅุญูุงูุง ูุฌูุงูุง ูุฃุณุฑุนุ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงููููุฉ ุงูุฃุฎูุฑุฉ ูู ุงูุนูู ูุน ุงูุฐุงูุฑุฉ ุงููุดุชุฑูุฉ. </font><font style="vertical-align: inherit;">ูู ูุญุชุงุฌ ุฅูู ุณุญุจ ูุฐู ุงูุขููุฉ ูุน ุงูุฃููุงู ุ ุฃู ุงููุฒุงููุฉ ุฅูู ุฑูุฒ ุบูุฑ ูุชุฒุงูู ุ ุฃู ูููู ุชุฌูุจ ุฐูู ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑูุ </font><font style="vertical-align: inherit;">ูููู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุชุฒุงูู / ุงูุชุธุงุฑ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงููุณุงุนุฏุฉ ูู ูุฐุงุ</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุทุฑูู ุฅูู ุงูุชุฒุงูู / ุงูุชุธุงุฑ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ุชุทูุฑ ุงูุจุฑูุฌุฉ ุบูุฑ ุงููุชุฒุงููุฉ ุจุดูู ุนุงู ูู ุงูุนุงูู ููู .NET.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุชุตู ูุฑุฉ ุฃุฎุฑู</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function">Void <span class="hljs-title">Foo</span>(<span class="hljs-params"><span class="hljs-keyword">params</span>, Action callback</span>)</span> {โฆ}<font></font>
 <font></font>
<font></font>
<span class="hljs-function">Void <span class="hljs-title">OurMethod</span>(<span class="hljs-params"></span>)</span> {<font></font>
    โฆ<span class="hljs-comment">//synchronous code</span><font></font>
 <font></font>
    Foo(<span class="hljs-keyword">params</span>,() =&gt;{<font></font>
       โฆ<span class="hljs-comment">//asynchronous code;continuation</span><font></font>
    });<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุฏุฃุช ุงูุจุฑูุฌุฉ ุบูุฑ ุงููุชุฒุงููุฉ ูุน ุงูุงุณุชุฑุฌุงุนุงุช. </font><font style="vertical-align: inherit;">ุฃู ุฃูู ุชุญุชุงุฌ ุฃููุงู ุฅูู ุงุณุชุฏุนุงุก ุฌุฒุก ูู ุงูุฑูุฒ ุจุดูู ูุชุฒุงูู ุ ูุงูุฌุฒุก ุงูุซุงูู - ุจุดูู ุบูุฑ ูุชุฒุงูู. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ ุชูุฑุฃ ูู ููู ุ ูุนูุฏูุง ุชููู ุงูุจูุงูุงุช ุฌุงูุฒุฉ ุ ุณูุชู ุชุณููููุง ูู ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู. </font><font style="vertical-align: inherit;">ูุชู ุชูุฑูุฑ ูุฐุง ุงูุฌุฒุก ุบูุฑ ุงููุชุฒุงูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฑุฏ ุงุชุตุงู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุฒูุฏ ูู ุงูุงุณุชุฑุฌุงุนุงุช</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Foo</span>(<span class="hljs-params"><span class="hljs-keyword">params</span>, Action callback</span>)</span> {...} 
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Bar</span>(<span class="hljs-params">Action callback</span>)</span> {...}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Baz</span>(<span class="hljs-params">Action callback</span>)</span> {...}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">OurMethod</span>(<span class="hljs-params"></span>)</span> {<font></font>
    ... <span class="hljs-comment">//synchronous code</span><font></font>
    <font></font>
    Foo(<span class="hljs-keyword">params</span>, () =&gt; { <font></font>
      ... <span class="hljs-comment">//continuation 1 </span><font></font>
      Bar(() =&gt; {<font></font>
        <span class="hljs-comment">//continuation 2</span><font></font>
        Baz(() =&gt; {<font></font>
          <span class="hljs-comment">//continuation 3</span><font></font>
        }); <font></font>
      });<font></font>
    });<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุฐุง ุ ูู ุฑุฏ ุงุชุตุงู ูุงุญุฏ ููููู ุชุณุฌูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑุฏ ุงุชุตุงู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุขุฎุฑ </font><font style="vertical-align: inherit;">ุ ููููู ูู ุฎูุงูู ุชุณุฌูู ุฑุฏ ุงุชุตุงู ุซุงูุซ ุ ููู ุงูููุงูุฉ ูุชุญูู ูู ุดูุก ุฅูู </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑุฏ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงุชุตุงู </font><b><font style="vertical-align: inherit;">Call Hell</font></b><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bf/vq/8g/bfvq8gknishmtrdwaiixz6mzuvs.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑุฏ ุงูุงุชุตุงู: ุงุณุชุซูุงุกุงุช</font></font></h3><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Foo</span>(<span class="hljs-params"><span class="hljs-keyword">params</span>, Action onSuccess, Action onFailure</span>)</span> {...}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">OurMethod</span>(<span class="hljs-params"></span>)</span> {<font></font>
    ... <span class="hljs-comment">//synchronous code </span>
    Foo(<span class="hljs-keyword">params</span>, () =&gt; {<font></font>
      ... <span class="hljs-comment">//asynchronous code on success </span><font></font>
    },<font></font>
    () =&gt; {<font></font>
        ... <span class="hljs-comment">//asynchronous code on failure</span><font></font>
    }); <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููู ุชุนูู ูุน ุงูุงุณุชุซูุงุกุงุชุ ุนูู ุณุจูู ุงููุซุงู ุ ReSharper ุ ุนูุฏ ุงูุฑุฏ ุจุดูู ูููุตู ุนูู ุงูุงุณุชุซูุงุกุงุช ูุงูุชูููุฐ ุงูุฌูุฏ ุ ูุง ููุธูุฑ ุฃุฌูู ุฃุฌุฒุงุก ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ - ููุงู ุงุณุชุฏุนุงุกุงุช ูููุตูุฉ ูุญุงูุฉ ุงุณุชุซูุงุฆูุฉ ูุงุณุชูุฑุงุฑ ูุงุฌุญ. ูุงููุชูุฌุฉ ูู ูุฌุฑุฏ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑุฏ ุฌุญูู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูููู ููุณ ุฎุทููุง ุ ููููู ูุดุจู ุงูุดุฌุฑุฉ ุ ูุงูุฐู ูููู ุฃู ูููู ูุฑุจููุง ุชูุงููุง. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lg/hs/y3/lghsy31j9pke1do-8rpmcyuovfq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู .NET ุ ููุณูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุณููุจ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฑุฏ ุงูุงุชุตุงู ุงูุฃูู </font><i><font style="vertical-align: inherit;">ุจูููุฐุฌ ุงูุจุฑูุฌุฉ ุบูุฑ ุงููุชุฒุงูู</font></i><font style="vertical-align: inherit;"> (APM). ุณูุชู ุงุณุชุฏุนุงุก ุงูุทุฑููุฉ </font></font><code>AsyncCallback</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ููู ูู ุงูุฃุณุงุณ ููุณ ุงูุทุฑููุฉ </font></font><code>Action</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูููู ุงูููุฌ ูุญุชูู ุนูู ุจุนุถ ุงูููุฒุงุช. ุจุงุฏุฆ ุฐู ุจุฏุก ุ ูุฌุจ ุฃู ุชุจุฏุฃ ุงูุฃุณุงููุจ ุจูููุฉ "Begin" (ุงููุฑุงุกุฉ ูู ููู ูู BeginRead) ุ ูุงูุชู ุชูุฑุฌุน ุจุนุถูุง </font></font><code>AsyncResult</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ููุณู</font></font><code>AsyncResult</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ูุฐุง ูุนุงูุฌ ูุนุฑู ุฃู ุงูุนูููุฉ ูุฏ ุงูุชููุช ููุฏูู ุขููุฉ </font></font><code>WaitHandle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ููููู </font></font><code>WaitHandle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุงูุชุธุงุฑ ุ ูู ุงูุชุธุงุฑ ุงูุชูุงู ุงูุนูููุฉ ุจุดูู ุบูุฑ ูุชุฒุงูู. ูู ูุงุญูุฉ ุฃุฎุฑู ุ ููููู ุงูุงุชุตุงู </font></font><code>EndOperation</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุฃู ุฅุฌุฑุงุก </font></font><code>EndRead</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุนููู ุจุดูู ูุชุฒุงูู (ูุงูุฐู ูุดุจู ุฅูู ุญุฏ ุจุนูุฏ ุฎุงุตูุฉ </font></font><code>Task.Result</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐุง ุงูููุฌ ูุฏูู ุนุฏุฏ ูู ุงููุดุงูู. ุฃููุงู ุ ูุง ูุญูููุง ูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑุฏ ุงูุงุชุตุงู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ุซุงูููุง ุ ูุจูู ูู ุบูุฑ ุงููุงุถุญ ุชูุงููุง ูุง ูุฌุจ ูุนูู ูุน ุงูุงุณุชุซูุงุกุงุช. ุซุงูุซูุง ุ ููุณ ูู ุงููุงุถุญ ุนูู ุฃู ูุคุดุฑ ุชุฑุงุจุท ุณูุชู ุงุณุชุฏุนุงุก ุฑุฏ ุงูุงุชุตุงู ูุฐุง - ููุณ ูุฏููุง ุชุญูู ูู ุงูููุงููุฉ. ุฑุงุจุนุงู ุ ุงูุณุคุงู ุงูุฐู ูุทุฑุญ ููุณู ุ ููู ูููู ุงูุฌูุน ุจูู ุฃุฌุฒุงุก ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูุน ุงูุงุณุชุฑุฌุงุนุงุชุ </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mr/5z/xr/mr5zxr01ztmadod_fuetd3loqew.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงููููุฐุฌ ุงูุซุงูู ูุณูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุท ุบูุฑ ุงููุชุฒุงูู ุงููุงุฆู ุนูู ุงูุฃุญุฏุงุซ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ูุฐุง ูู ููุฌ ุฑุฏ ุงููุนู ุนูู ุฑุฏ ุงููุนู. ููุฑุฉ ุงูุทุฑููุฉ ูู ุฃููุง ููุฑุฑ ุฅูู ุงูุฃุณููุจ </font></font><code>OperationNameAsync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุถ ุงููุงุฆูุงุช ุงูุชู ุชุญุชูู ุนูู ุญุฏุซ ููุชูู ูุงูุงุดุชุฑุงู ูู ูุฐุง ุงูุญุฏุซ. ููุง ูุงุญุธุช ุ </font></font><code>BeginOperationName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุบููุฑุงุช ูู </font></font><code>OperationNameAsync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ูููู ุฃู ูุญุฏุซ ุงูุงุฑุชุจุงู ุนูุฏูุง ุชุฐูุจ ุฅูู ูุฆุฉ Socket ุ ุญูุซ ูุชู ูุฒุฌ ููุทูู: </font></font><code>ConnectAsync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>BeginConnect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฑุฌู ููุงุญุธุฉ ุฃูู ูุฌุจ ุนููู ุงูุงุชุตุงู ููุฅูุบุงุก </font></font><code>OperationNameAsyncCancel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ูุธุฑูุง ูุฃูู ูู .NET ูู ูุชู ุงูุนุซูุฑ ุนูู ูุฐุง ูู ุฃู ููุงู ุขุฎุฑ ุ ุนุงุฏุฉู ูุง ูุฑุณู ุงูุฌููุน </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s CancellationToken</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ูุจุงูุชุงูู ุ ุฅุฐุง ูุงุฌูุช ุนู ุทุฑูู ุงูุฎุทุฃ ุทุฑููุฉ ูู ุงูููุชุจุฉ ุชูุชูู ุจู </font></font><code>Async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุฃูุช ุจุญุงุฌุฉ ุฅูู ููู ุฃููุง ูุง ุชุนูุฏ ุจุงูุถุฑูุฑุฉ </font></font><code>Task</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูููู ููููู ุฅุฑุฌุงุน ุจููุฉ ููุงุซูุฉ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6s/w4/4u/6sw44uh3ljw5kwdkowtxylfz5xc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฎุฐ ุจุนูู ุงูุงุนุชุจุงุฑ ูููุฐุฌ ูุนุฑูู ูู Java ุจุงุณู</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุนููุฏ ุงูุขุฌูุฉ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูู JavaScript ุ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุนูุฏ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ููู .NET ุ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุงุฐุฌ ูููุฉ ุบูุฑ ูุชุฒุงููุฉ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูุจุนุจุงุฑุฉ ุฃุฎุฑู ุ "ููุงู". ุชูุชุฑุถ ูุฐู ุงูุทุฑููุฉ ุฃู ูุฏูู ุจุนุถ ูุงุฆู ุงูุญุณุงุจ ุ ูููููู ุฑุคูุฉ ุญุงูุฉ ูุฐุง ุงููุงุฆู (ููุฏ ุงูุชุดุบูู ุฃู ููุชูู). ูู .NET ุ ููุงู ูุง ูุณูู </font></font><code>RnToCompletion</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุตู ุงููุฑูุญ ูุญุงูุชูู: ุจุฏุงูุฉ ุงููููุฉ ูุฅููุงู ุงููููุฉ. ูุญุฏุซ ุฎุทุฃ ุดุงุฆุน ุนูุฏูุง ูุชู ุงุณุชุฏุนุงุก ุทุฑููุฉ ูู ูููุฉ </font></font><code>IsCompleted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ุชุคุฏู ุฅูู ุงุณุชูุฑุงุฑ ุงููุฌุงุญ ุ ูููู </font></font><code>RnToCompletion</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ </font></font><code>Canceled</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>Faulted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ูุจุงูุชุงูู ุ ูุฌุจ ุฃู ุชุฎุชูู ูุชูุฌุฉ ุงูููุฑ ุนูู "ุฅูุบุงุก" ูู ุชุทุจูู ูุงุฌูุฉ ุงููุณุชุฎุฏู ุนู ุนูุฏุฉ ุงูุงุณุชุซูุงุกุงุช (ุนูููุงุช ุงูุชูููุฐ). ูู .NET ุ ุชู ุงูุชูููุฒ: ุฅุฐุง ูุงู ุงูุชูููุฐ ูู ุฎุทุฃู ุงูุฐู ุชุฑูุฏ ุชุฃูููู ุ ุซู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูุบุงุก</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ุงูุนูููุฉ ุงููุณุฑูุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู .NET ุ ุชู ุชูุฏูู ููููู ุฃูุถูุง </font></font><code>TaskScheduler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ููู ููุน ูู ุงูุชุฌุฑูุฏ ุนูู ุฑุฃุณ ุณูุงุณู ุงูุฑุณุงุฆู ุงูุชู ุชุฎุจุฑ ุฃูู ูุชู ุชุดุบูู ุงููููุฉ. ูู ูุฐู ุงูุญุงูุฉ ุ ุชู ุชุตููู ุฏุนู ุงูุฅูุบุงุก ุนูู ูุณุชูู ุงูุชุตููู. ุชูุฑูุจุง ุฌููุน ุงูุนูููุงุช ูู ุงูููุชุจุฉ ูู .NET </font></font><code>CancellationToken</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ุชูุฑูุฑูุง. ูุง ูุนูู ูุฐุง ูุน ุฌููุน ุงููุบุงุช: ุนูู ุณุจูู ุงููุซุงู ุ ูู Kotlin ููููู ุงูุชุฑุงุฌุน ุนู ุงููููุฉ ุ ูููู ูู .NET ูุง ููููู ุฐูู. ูุฏ ูููู ุงูุญู ูู ุชูุณูู ุงููุณุคูููุฉ ุจูู ูู ูุงููุง ุจุฅูุบุงุก ุงููููุฉ ูุงููููุฉ ููุณูุง. ุนูุฏูุง ุชุชููู ูููุฉ ุ ูุง ููููู ุฅูุบุงุคูุง ุจุฎูุงู ุฐูู ุตุฑุงุญุฉ - ูุฌุจ ุฃู ุชููููุง </font></font><code>CancellationToken</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุณูุญ ูู </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงุฆู ุฎุงุต </font></font><code>TaskCompletionSoure</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุณูููุฉ ุชูููู ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงููุฏููุฉ ุงููุฑุชุจุทุฉ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงููููุฐุฌ ุบูุฑ ุงููุชุฒุงูู ุงููุงุฆู ุนูู ุงูุฃุญุฏุงุซ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฃู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุฐุฌ ุงูุจุฑูุฌุฉ ุบูุฑ ุงููุชุฒุงูู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ููุงู ูุณุชูุฏ ูุฌุจ ุนููู ูุฑุงุกุชู ุฅุฐุง ููุช ุชุจุฑูุฌ ูู ุงูููุงู. </font><font style="vertical-align: inherit;">ูุตู ุฌููุน ุงูุงุชูุงูุงุช ุงููุชุนููุฉ tasas. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ ุฃู ุทุฑููุฉ ุ ุฅุฑุฌุงุน ุงููููุฉ ุ ูุฌุจ ุฃู ุชุนูุฏูุง ูู ุญุงูุฉ ุชุดุบูู ุ ููุง ูุนูู ุฃููุง ูุง ูููู ุฃู ุชููู ูุฐูู </font></font><code>Created</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุจูููุง ูุฌุจ ุฃู ุชูุชูู ุฌููุน ูุฐู ุงูุนูููุงุช </font></font><code>Async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฌูุน ุจูู ุงูุงุณุชูุฑุงุฑูุฉ</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function">Task <span class="hljs-title">ourMethod</span>(<span class="hljs-params"></span>)</span> {
  <span class="hljs-keyword">return</span> Task.RunSynchronously(() =&gt;{<font></font>
    ... <span class="hljs-comment">//synchronous code</span><font></font>
  })<font></font>
  .ContinueWith(_ =&gt;{<font></font>
    Foo(); <span class="hljs-comment">//continuation 1</span><font></font>
  })<font></font>
  .ContinueWith(_ =&gt;{<font></font>
    Bar(); <span class="hljs-comment">//continuation 2</span><font></font>
  })<font></font>
  .ContinueWith(_ =&gt;{<font></font>
    Baz(); <span class="hljs-comment">//continuation 3</span><font></font>
  })<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃูุง ุจุงููุณุจุฉ ูููุฒูุฌ ุ ูุน ุงูุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฌุญูู ุฑุฏ ุงูุงุชุตุงู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูููู ุฃู ุชุธูุฑ ูู ุดูู ุฃูุซุฑ ุฎุทูุฉ ุ ุนูู ุงูุฑุบู ูู ูุฌูุฏ ูุทุน ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุชูุฑุฑุฉ ูุน ุงูุญุฏ ุงูุฃุฏูู ูู ุงูุชุบููุฑุงุช. </font><font style="vertical-align: inherit;">ูุจุฏู ุฃู ุงูุดูุฑุฉ ุชุชุญุณู ุจูุฐู ุงูุทุฑููุฉ ุ ูููู ููุงู ุฃูุถูุง ุนููุจ ููุง.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุฏุก ููุชุงุจุนุฉ ุงูููุงู</font></font></h3><br>
<pre><code class="cs hljs">Task.Factory.StartNew(Action, <font></font>
  TaskCreationOptions, <font></font>
  TaskScheduler, <font></font>
  CancellationToken<font></font>
)<font></font>
Task.ContinueWith(Action&lt;Task&gt;, <font></font>
  TaskContinuationOptions, <font></font>
  TaskScheduler, <font></font>
  CancellationToken<font></font>
)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนููุง ููุชูู ุฅูู ุซูุงุซ ูุนููุงุช ุฃุซูุงุก ุฅุทูุงู ุงููููุฉ ุงูููุงุณูุฉ: ุงูุฃููู ูู ุฎูุงุฑุงุช ุจุฏุก ุงููููุฉ ุ ูุงูุซุงููุฉ ูู </font></font><code>scheduler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชู ูุชู ุชุดุบูู ุงููููุฉ ุนูููุง ุ ูุงูุซุงูุซุฉ - </font></font><code>CancellationToken</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/w_/a4/fw/w_a4fwuiwflisfw-ifxqwtgnpxu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฎุจุฑู TaskScheduler ูู ุฃูู ุชุจุฏุฃ ุงููููุฉ ููู ูุงุฆู ููููู ุชุฌุงูุฒู ุจุดูู ูุณุชูู. ุนูู ุณุจูู ุงููุซุงู ุ ููููู ุชุฌุงูุฒ ุทุฑููุฉ </font></font><code>Queue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ุฅุฐุง ููุช ุจุฐูู </font></font><code>TaskScheduler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>thread pool</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุงูุฃุณููุจ </font></font><code>Queue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฃุฎุฐ ููุถูุน ูู </font></font><code>thread pool</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฑุณู ูููุชู ููุงู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅุฐุง ุงุณุชููุช </font></font><code>scheduler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูู ุงูุฎูุท ุงูุฑุฆูุณู ุ ูุฅูู ูุถุน ูู ุดูุก ูู ูุงุฆูุฉ ุงูุชุธุงุฑ ูุงุญุฏุฉ ุ ููุชู ุชูููุฐ ุงูููุงู ุจุงูุชุณูุณู ุนูู ุงูุฎูุท ุงูุฑุฆูุณู. ููุน ุฐูู ุ ูุฅู ุงููุดููุฉ ูู ุฃูู ูู .NET ููููู ุชูููุฐ ุงููููุฉ ุฏูู ุงููุฑูุฑ </font></font><code>TaskScheduler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ุงูุณุคุงู ุงูุฐู ูุทุฑุญ ููุณู: ููู ุชุญุณุจ NET ุซู ุงููููุฉ ุงูุชู ุชู ุชูุฑูุฑูุง ุฅูููุงุ ุนูุฏูุง ุชุจุฏุฃ ุงููููุฉ ูู </font></font><code>StartNew</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฏุงุฎู</font></font><code>Action</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ </font></font><code>ThreadStatic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><code>Current</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนุฑุถุช ูู ุชูู </font></font><code>TaskScheduler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชู ูุฏููุงูุง ููุง. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุฏู ูุฐุง ุงูุชุตููู ูุซูุฑูุง ููุฌุฏู ุฅูู ุญุฏ ูุง ุจุณุจุจ ุงูุณูุงู ุงูุถููู. ูุงูุช ููุงู ุญุงูุงุช ุนูุฏูุง </font></font><code>TaskScheduler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุญุชูุช ุนูู ุดูุฑุฉ ุบูุฑ ูุชุฒุงููุฉ ูุฑุซุช ูู ููุงู ูุง ุจุดูู ุนููู ููุบุงูุฉ </font></font><code>TaskScheduler.Current</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุชุฏุงุฎูุฉ ูุน ุฌุฏูู ุฒููู ุขุฎุฑ ุ ููุง ุฃุฏู ุฅูู ุทุฑูู ูุณุฏูุฏ. ูู ูุฐู ุงูุญุงูุฉ ุ ููููู ุงุณุชุฎุฏุงู ุงูุฎูุงุฑ </font></font><code>TaskCreationOption.HideScheduler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ูุฐุง ุฌุฑุณ ุฅูุฐุงุฑ ูููู ุฃู ูุฏููุง ุฎูุงุฑูุง ูุชุฌุงูุฒ </font></font><code>ThreadStatic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฅุนุฏุงุฏ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุดูุก ูู ููุณู ูุน ุงุณุชูุฑุงุฑ. ุงูุณุคุงู ุงูุฐู ูุทุฑุญ ููุณู: ูู ุฃูู ูุฃุชู </font></font><code>TaskScheduler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุณุชูุฑุงุฑุ ุจุงุฏุฆ ุฐู ุจุฏุก ุ ูุชู ุฃุฎุฐูุง ูู ุงูุทุฑููุฉ ุงูุชู ุจุฏุฃุช ุจูุง </font></font><code>Continuation</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ููุง ุฃููุง </font></font><code>TaskScheduler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฃุฎูุฐุฉ ูู ThreadStatic. ูู ุงูููู ุฃู </font><font style="vertical-align: inherit;">ุชุนูู ุงูุงุณุชูุฑุงุฑุงุช ุจุดูู ูุฎุชูู ุชูุงููุง ูู ุญุงูุฉ </font><font style="vertical-align: inherit;">ุนุฏู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุฒุงููุฉ / ุงูุงูุชุธุงุฑ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bt/-f/ne/bt-fnekfbdnfmn4n-u3zrvp7bdc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุชูู ุฅูู ุงููุนููุงุช </font></font><code>TaskCreationOptions</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>TaskContinuationOptions</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ูุดููุชูู ุงูุฑุฆูุณูุฉ ูู ุฃู ููุงู ุงููุซูุฑ ูููู. ุจุนุถ ูุฐู ุงููุนููุงุช ุชูุบู ุจุนุถูุง ุงูุจุนุถ ุ ูุงูุจุนุถ ุงูุขุฎุฑ ุญุตุฑู. ูููู ุงุณุชุฎุฏุงู ุฌููุน ูุฐู ุงููุนููุงุช ูู ุฌููุน ุงูุชุฑููุจุงุช ุงูููููุฉ ุ ูุฐูู ูู ุงูุตุนุจ ูุฑุงุนุงุฉ ูู ูุง ูููู ุฃู ูุญุฏุซ ูุน ุงูุดูู. ุจุนุถ ูุฐู ุงูุฎูุงุฑุงุช ุชุนูู ุจุดูู ุบูุฑ ููููู ุชูุงููุง. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ag/us/wh/aguswhpfaos0qjqvfopo_rr8aeo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูู ุณุจูู ุงููุซุงูุ ุงููุนููุงุช </font></font><code>ExecuteSynchronously</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>RunContinuationsAsynchronously</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูุซู ุฎูุงุฑูู ุชุทุจูู ููููุฉุ ูููู ูุง ุฅุฐุง ูุงู ุณูุชู ุฅุทูุงู ุงุณุชูุฑุงุฑ ูุชุฒุงูู ุฃู ุบูุฑ ูุชุฒุงูู ูุนุชูุฏ ุนูู ุงููุซูุฑ ูู ุงูุฃุดูุงุก ุงูุชู ุณูู ูุง ุชุนุฑู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jm/-c/zv/jm-czv9x4lhhmibfgxqxwjcvxqe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุซุงู ุขุฎุฑ: ุฃุทูููุง ุงููููุฉ ุ ุฃุทูููุง ุงูุงุณุชูุฑุงุฑูุฉ ูุฃุนุทููุง ูุนููุชูู ูู ููุช ูุงุญุฏ</font></font><code>TaskContinuations.ExecuteSynchronously</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุจุนุฏ ุฐูู ุจุฏุฃูุง ุงูุงุณุชูุฑุงุฑูุฉ ุจุดูู ุบูุฑ ูุชุฒุงูู. </font><font style="vertical-align: inherit;">ูู ุณูุชู ุชูููุฐู ูู ุงูููุฏุณ ููุณู ุญูุซ ุชูุชูู ุงููููุฉ ุงูุณุงุจูุฉ ุ ุฃู ุณูุชู ููููุง ุฅููู </font></font><code>thread pool</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ </font><font style="vertical-align: inherit;">ูู ูุฐู ุงูุญุงูุฉ ุ ุณูููู ููุงู ุฎูุงุฑ ุซุงูุซ: ูุนุชูุฏ.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vv/j6/8z/vvj68zu1keb_n50viyk4iqbydae.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TaskCompletionSource</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุฃูู </font></font><code>TaskCompletionSource</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ุนูุฏ ุฅูุดุงุก ูููุฉ ุ ููููู ุชุนููู </font></font><code>SetResult</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชูุฌุชูุง ูุชูููู ุงูุฃููุงุท ุงูุณุงุจูุฉ ุบูุฑ ุงููุชุฒุงููุฉ ูุน ุนุงูู ุงูููุงู. ููููู </font></font><code>TaskCompletionSource</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุทูุจ </font></font><code>tcs.Task</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุณุชูุชูู ูุฐู ุงููููุฉ ุฅูู ุญุงูุฉ </font></font><code>finish</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูุฏ ุงูุงุชุตุงู </font></font><code>tcs.SetResult</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ููุน ุฐูู ุ ุฅุฐุง ููุช ุจุชุดุบูู ูุฐุง ุนูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฌูุน ูุคุดุฑ ุงูุชุฑุงุจุท</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูุณูู ุชุญุตู ุนูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุทุฑูู ูุณุฏูุฏ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ุงูุณุคุงู ูู ุ ููุงุฐุง ุฅุฐุง ูู ููุชุจ ุฃู ุดูุก ุญุชู ุจุดูู ูุชุฒุงููุ </font></font><br>
<br>
<img src="https://habrastorage.org/webt/v5/g1/2b/v5g12bn0tycbshdrascqvi-hkug.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญู ููุดุฆ </font></font><code>TaskCompletionSource</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุจุฏุฃ ูููุฉ ุฌุฏูุฏุฉ ุ ููุฏููุง ุฎูุท ุซุงูู ูุจุฏุฃ ุดูุฆูุง ูุง ูู ูุฐู ุงููููุฉ. ูุฐูุจ ุฃูุซุฑ ูู ูุชููุน ููุงุฆุฉ ูููู ุซุงููุฉ. ุซู ุฎูุทูุง ุงูุฑุฆูุณู - ุฃุฎุถุฑ - ูุฐูุจ ุฅูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุงูุชุธุงุฑ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุฐุง ูู ุดูุก. ูุทูู ุงูููุฏุณ ุ ุงูููุฏุณ ูุนููุฉ ุ ูู ุงูุชุธุงุฑ ุฃู ูุชู ุงุณุชุฏุนุงุคู ุจุงุณุชูุฑุงุฑ</font></font><code>task.Wait</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูุฏูุง </font></font><code>tcs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุนุฑุถ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงูุฎูุท ุงูุฃุฒุฑู ูุตู ุฅูู </font></font><code>tcs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุซู ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู. </font><font style="vertical-align: inherit;">ุงุณุชูุงุฏูุง ุฅูู ุงูุงุนุชุจุงุฑุงุช ุงูุฏุงุฎููุฉ ูู .NET ุ </font></font><code>TaskCompletionSource</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุนุชูุฏ ุฃู ุงุณุชูุฑุงุฑ ุฐูู </font></font><code>tcs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ุฅุฌุฑุงุคู ุจุดูู ูุชุฒุงูู ุ ุฃู ูุจุงุดุฑุฉ ุนูู ููุณ ุงูููุฏุณ ุ ุซู </font></font><code>task.Wait</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชู ุชูููุฐ ุฐูู ุจุดูู ูุชุฒุงูู ุนูู ููุณ ุงูููุฏุณ. </font><font style="vertical-align: inherit;">ูุฐุง ุบุฑูุจ ููุบุงูุฉ ุ ุนูู ุงูุฑุบู ูู ุญูููุฉ ุฃููุง ูู ููุชุจ ุญุชู ูู ุฃู ููุงู </font></font><code>ExecuteSynchronously</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุฑุจูุง ุชููู ูุฐู ูู ูุดููุฉ ุฎูุท ุงูููุฏ ุงููุชุฒุงูู ูุบูุฑ ุงููุชุฒุงูู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uv/7z/go/uv7zgosoif24okbeyq7fffwdz8o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุดููุฉ ุฃุฎุฑู ูู ูุฐุง </font></font><code>TaskCompletionSource</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูู ุนูุฏูุง ูุชุตู </font></font><code>SetResult</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญุช </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูุง ููููู ุงุณุชุฏุนุงุก ุฑูุฒ ุนุดูุงุฆู ุ ูุฃูู ุชุญุช ุงูููู ููููู ุงูููุงู ุจุจุนุถ ุงูุฃูุดุทุฉ ุงูุญุจูุจูุฉ ุงูุตุบูุฑุฉ ููุท. </font><font style="vertical-align: inherit;">ุงุฑูุถ ุชุญุช ุจุนุถ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฅุฌุฑุงุกุงุช</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูู ุงููุณุชุญูู ุฃู ุชุฃุชู ูู ุญูุซ ุฃุชูุง. </font><font style="vertical-align: inherit;">ููููุฉ ุญู ูุฐู ุงููุดููุฉุ</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">var</span>  tcs  =  <span class="hljs-keyword">new</span>   TaskCompletionSource&lt;<span class="hljs-keyword">int</span>&gt;(<font></font>
       TaskContinuationsOptions.RunContinuationsAsynchronously  <font></font>
) ;<font></font>
<span class="hljs-keyword">lock</span>(mylock)<font></font>
{  <font></font>
    tcs.SetResult(O); <font></font>
});</code></pre><br><font style="vertical-align: inherit;"></font><code>TaskCompletionSource</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌุฏุฑ </font><font style="vertical-align: inherit;">
ุงุณุชุฎุฏุงูู </font><font style="vertical-align: inherit;">ููุท ูุชูููู </font><font style="vertical-align: inherit;">ุฑูุฒ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุงู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุณ </font><font style="vertical-align: inherit;">ูู ุงูููุชุจุงุช. </font><font style="vertical-align: inherit;">ูููู ุญู ูู ุดูุก ุขุฎุฑ ูู ุฎูุงู ุงูุงูุชุธุงุฑ. </font><font style="vertical-align: inherit;">ูู ูุฐู ุงูุญุงูุฉ ุ ูู ุงููุณุชุญุณู ุฏุงุฆููุง ูุตู ุงููุนููุฉ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"TaskCompletionSource.RunContinuationsAsynchronually"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ุชุญุชุงุฌ ุฏุงุฆููุง ุชูุฑูุจูุง ุฅูู ุชุดุบูู ูุชุงุจุนุฉ ุจุดูู ุบูุฑ ูุชุฒุงูู. </font><font style="vertical-align: inherit;">ูู ูุฐู ุงูุญุงูุฉ ุ </font></font><code>tcs.SetResult</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฏูู ุดูุก ูู ูุชู ุฅุทูุงู ุฃู ุดูุก ุชุญุชู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ap/_-/ab/ap_-abu8wjhwxr0edsvayrcc-6w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงุฐุง ูุฌุจ ุฃู ูุชู ุงูุงุณุชูุฑุงุฑ ุจุดูู ูุชุฒุงููุ </font><font style="vertical-align: inherit;">ูุฃูู </font></font><code>RunContinuationsAsynchronously</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุดูุฑ ุฅูู ูุง ููู </font></font><code>ContinueWith</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุณ ุฅูู ูุง ูููู. </font><font style="vertical-align: inherit;">ูู ุฃุฌู ุงูุงุฑุชุจุงุท ุจูุนุงููุฑูุง ุ ุชุญุชุงุฌ ุฅูู ูุชุงุจุฉ ูุง ููู: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qb/zj/6q/qbzj6q1fjhhqozii8yec5ok3pcy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุถุญ ูุฐุง ุงููุซุงู ููู ุฃู ุงููุนููุงุช ููุณุช ุจุฏูููุฉ ุ ูููู ุชุชูุงุทุน ูุน ุจุนุถูุง ุงูุจุนุถ ุ ูููู ุชูุฏู ุงูุชุนููุฏ ุงููุนุฑูู - ูู ุงูุตุนุจ ุฌุฏูุง ุงููุชุงุจุฉ.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุณูุณู ุงููุฑูู ูููุงูุฏูู ูุงูุทูู</font></font></h3><br>
<pre><code class="cs hljs">Task.Factory.StartNew(() =&gt; <font></font>
{<font></font>
  <span class="hljs-comment">//... some parent activity</span><font></font>
<font></font>
   Task.Factory.StartNew(() =&gt; {<font></font>
      <span class="hljs-comment">//... some child activity</span><font></font>
   })<font></font>
<font></font>
})<font></font>
.ContinueWith(...) <span class="hljs-comment">// donโt wait for child</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงู ุฎูุงุฑุงุช ุฃุฎุฑู ูุงุณุชุฎุฏุงู ุงููุนููุงุช. ุนูู ุณุจูู ุงููุซุงู ุ ููุดุฃ </font><font style="vertical-align: inherit;">ุชุณูุณู ูุฑูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจูู ุงููุงูุฏูู ูุงูุทูู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุนูุฏ ุชุดุบูู ูููุฉ ูุชุดุบูู ุฃุฎุฑู ุชุญุชูุง. ูู ูุฐู ุงูุญุงูุฉ ุ ุฅุฐุง ูุชุจุช </font></font><code>ContinueWith</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ </font></font><code>ContinueWith</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ุชูุชุธุฑ ุงููููุฉ ุงูุชู ุจุฏุฃุช ูู ุงูุฏุงุฎู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gw/se/28/gwse28nxykd4vfwt_chfw0qjt_w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅุฐุง ูุชุจุช </font></font><code>TaskCreationOptions.AttachedToParent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ </font></font><code>ContinueWith</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณูู ุชูุชุธุฑ. ููููู ุงุณุชุฎุฏุงู ูุฐู ุงูุฎุงุตูุฉ ูู ููุชุฌุงุชู. ุฃุนุชูุฏ ุฃู ูู ุดุฎุต ูููู ุฃู ูุฃุชู ุจูุซุงู ุญูุซ ููุฌุฏ ุชุณูุณู ูุฑูู ููููุงู ุ ูุน ุงููููุฉ ุงูุชู ุชูุชุธุฑ ุงููููุฉ ุงููุฑุนูุฉ ุ ูุงููููุฉ ุงููุฑุนูุฉ ูููุงููุง ุงููุฑุนูุฉ. ูุง ุญุงุฌุฉ ูููุชุงุจุฉ ูู ุฃู ููุงู </font></font><code>WaitForChildren</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุญุฏุซ ูุฐุง ุงูุงูุชุธุงุฑ ุจุดูู ุบูุฑ ูุชุฒุงูู. ุจูุนูู ุ ููุชูู ูุต ุงููููุฉ ุงูุฑุฆูุณูุฉ ุ ูุจุนุฏ ุฐูู ูุง ุชุนุชุจุฑ ุงููููุฉ ุงูุฑุฆูุณูุฉ ููุชููุฉ ุ ูุง ูุจุฏุฃ ุงุณุชูุฑุงุฑูุง ุญุชู ุชุนูู ุงูููุงู ุงููุฑุนูุฉ.</font></font><br>
<br>
<pre><code class="cs hljs">Task.Factory.StartNew(() =&gt; <font></font>
{<font></font>
  <span class="hljs-comment">//... some parent activity</span><font></font>
  Foo(); <font></font>
<font></font>
})<font></font>
.ContinueWith(...) <span class="hljs-comment">// still wait for child</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Foo</span>(<span class="hljs-params"></span>)</span> { <font></font>
   Task.Factory.StartNew(() =&gt; {<font></font>
      <span class="hljs-comment">//... parent task to attach is in ThreadStatic</span><font></font>
   }, TaskCreationOptions.AttachedToParent); <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฏ ุชููู ููุงู ูุดููุฉ ูู ููู ุงููููุฉ ูู ููุงู ูุง </font></font><code>ThreadStatic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุซู ุชุชู ุฅุถุงูุฉ ูู ุดูุก ุจุฏุฃุช ุจู </font></font><code>AttachedToParent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูู ูุฐู ุงููููุฉ ุงูุฑุฆูุณูุฉ ุ ููู ุฌุฑุณ ุฅูุฐุงุฑ.</font></font><br>
<br>
<pre><code class="cs hljs">Task.Factory.StartNew(() =&gt; <font></font>
{<font></font>
  <span class="hljs-comment">//... some parent activity</span><font></font>
<font></font>
  Foo();<font></font>
}, TaskCreationOptions.DenyChildAttach)<font></font>
.ContinueWith(...) <span class="hljs-comment">// donโt wait for child</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Foo</span>(<span class="hljs-params"></span>)</span> { <font></font>
   Task.Factory.StartNew(() =&gt; {<font></font>
      <span class="hljs-comment">//... some child activity</span><font></font>
   }, TaskCreationOptions.AttachedToParent); <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุงุญูุฉ ุฃุฎุฑู ุ ููุงู ุฎูุงุฑ ููุบู ุงูุฎูุงุฑ ุงูุณุงุจู </font></font><code>DenyChildAttach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุญุฏุซ ูุซู ูุฐุง ุงูุชุทุจูู ูู ูุซูุฑ ูู ุงูุฃุญูุงู.</font></font><br>
<br>
<pre><code class="cs hljs">Task.Run(() =&gt; <font></font>
{<font></font>
  <span class="hljs-comment">//... some parent activity</span><font></font>
<font></font>
  Foo(); <font></font>
<font></font>
})<font></font>
.ContinueWith(...) <span class="hljs-comment">//donโt wait for child</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Foo</span>(<span class="hljs-params"></span>)</span> { <font></font>
   Task.Factory.StartNew(() =&gt; {<font></font>
      <span class="hljs-comment">//... some child activity</span><font></font>
    }, TaskCreationOptions.AttachedToParent); <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃู </font></font><code>Task.Run</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐู ูู ุงูุทุฑููุฉ ุงูููุงุณูุฉ ููุจุฏุก ุ ูุงูุชู ุชุชุถูู ุงูุชุฑุงุถููุง </font></font><code>DenyChildAttach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุถูู </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงูุณูุงู ุงูุถููู ุงูุฐู ุชุถุนู </font></font><code>ThreadStatic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุนููุฏูุง. ุฃูุช ูุง ุชููู ููู ุชุนูู ุงููููุฉ ุ ูุฃูู ุชุญุชุงุฌ ุฅูู ูุนุฑูุฉ ุงูุณูุงู. ููุงู ูุดููุฉ ุฃุฎุฑู ูุฏ ุชูุดุฃ ุชุชุนูู ุจุญุงูุฉ ุงูุฎููู / ุนุฏู ุงูุชุฒุงูู. ูุฐุง ูุฃูู ูู ุญุงูุฉ ุนุฏู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุฒุงูู / ูู ุงูุชุธุงุฑ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุนุฏู ูุฌูุฏ ููุงู ุ ูููู ุงูุฅุฌุฑุงุกุงุช. ุงูุงุณุชูุฑุงุฑูุฉ ููุณุช ูููุฉ ุตุงุฏูุฉ ุ ุจู ุนูู. ุนูุฏ ูุชุงุจุฉ ุฑูุฒ ุบูุฑ ูุชุฒุงูู / ุงูุชุธุงุฑ ุ ูุง ุชุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงูู </font></font><code>AttachedToParent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฃูู ุชุฑุจุท ุงูููุงู ุตุฑุงุญุฉู ุจุงูุชุธุงุฑ ุงูุงูุชุธุงุฑ ุ ููุฐุง ูู ุงูููุฌ ุงูุตุญูุญ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/k7/q5/vg/k7q5vgi8h9qwvvo3akgzow8vu_q.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฏูู ุณุชุฉ ุฎูุงุฑุงุช ุญูู ููููุฉ ุจุฏุก ุงููุชุงุจุนุฉ. ููุฏ ุฃุทููุช ุงููููุฉ ุ ุฃุทููุช</font></font><code>ContinueWith</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุณุคุงู: ูุง ูู ุญุงูุฉ ูุฐุง ุงูุงุณุชูุฑุงุฑุ </font><font style="vertical-align: inherit;">ููุงู ุฎูุณ ุฅุฌุงุจุงุช ูุญุชููุฉ:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูุชู ุฅููุงู ุงููุชุงุจุนุฉ ุงูุนุงูุฉ ุจูุฌุงุญ ุ ุณูุญุฏุซ RunToCompletion ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณุชููู ุงููููุฉ ูู ุฎุทุฃ ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูุญุฏุซ ุงูุฅูุบุงุก ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููููุฉ ูู ุชุตู ุฅูู ุงูุงูุชูุงู ุนูู ุงูุฅุทูุงู ุ ูุณูู ุชููู ูู ููุน ูู ุงููุณูุงู ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฎูุงุฑ - "ูุนุชูุฏ".</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/5u/x5/1k/5ux51kwpr4aixg_2io3xroerxam.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุฐู ุงูุญุงูุฉ ุ ุณุชููู ุงููููุฉ ูู ุญุงูุฉ "ููุบุงุฉ" ุ ุนูู ุงูุฑุบู ูู ุนุฏู ูุฌูุฏ ูููุฉ "ููุบุงุฉ" ูู ุฃู ููุงู. </font><font style="vertical-align: inherit;">ููุง ูุฑูู ุญูู ุงูุงุณุชูุจุงู ููุง ููุนู ุฃู ุดูุก. </font><font style="vertical-align: inherit;">ุชููู ุงููุดููุฉ ูู ุฃูู ุนูุฏูุง ุชูุฑุฃ ููุฏ ุดุฎุต ุขุฎุฑ ูุน ุงููุซูุฑ ูู ุงูุฎูุงุฑุงุช - ุญุชู ูู ููุช ุชุนุฑู ูุฐู ุงูุฎูุงุฑุงุช ูุจู 10 ุฏูุงุฆู - ูุง ุฒูุช ุชูุณู ูุง ูุญุฏุซ ููุง. </font><font style="vertical-align: inherit;">ูุฐูู ูุง ุชูุชุจ.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูุบุงุก</font></font></h3><br>
<br>
<pre><code class="cs hljs">Task.Factory.StartNew(() =&gt; <font></font>
{<font></font>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> OperationCanceledException(); <font></font>
});<font></font>
<font></font>
                                                      Failed</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงููุนููุฉ ุงูุซุงูุซุฉ ูู ุจุฏุงูุฉ ุงููููุฉ ูู kancellation. </font><font style="vertical-align: inherit;">ุชูุชุจ </font></font><code>OperationCanceledException</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุฃู ุฅุฌุฑุงุก ุฎุงุต ูุถุน ุงููููุฉ ูู ุญุงูุฉ "ููุบุงุฉ". </font><font style="vertical-align: inherit;">ูู ูุฐู ุงูุญุงูุฉ ุ ุณุชููู ุงููููุฉ ูู ุงูุญุงูุฉ "ูุงุดูุฉ" ุ ูุฃู ุงูุฌููุน </font></font><code>OperationCanceledException</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุณูุง ูุชุณุงููู.</font></font><br>
<br>
<pre><code class="cs hljs">Task.Factory.StartNew(() =&gt; <font></font>
{<font></font>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> OperationCanceledException(cancellationToken); <font></font>
}, cancellationToken);<font></font>
<font></font>
                                                      Canceled</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููู ุชุชููู ูู ุงูููุงู ุจุงููููุฉ </font></font><code>Canceled</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุชุญุชุงุฌ ุฅูู ุฑูููุง </font></font><code>OperationCanceledException</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุน CancellationToken. </font><font style="vertical-align: inherit;">ูู ุงููุงูุน ุ ูุง ุชูุนู ูุฐุง ุตุฑุงุญุฉ ุฃุจุฏูุง ุ ูููู ุงูุนู ุฐูู ุจูุฐู ุงูุทุฑููุฉ:</font></font><br>
<br>
<pre><code class="cs hljs">Task.Factory.StartNew(() =&gt; <font></font>
{<font></font>
    cancellationToken.ThrowIfCancellationRequested(); <font></font>
}, cancellationToken);<font></font>
                                                       Canceled</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูู ุงูุถุฑูุฑู ุงูุชูููุฒ ุจูู ุงูุฅูุบุงุกุ </font><font style="vertical-align: inherit;">ูู ููุงู ูุง ุฏุงุฎู ุงููููุฉ ุ ุชุชุญูู ูู ุฃู ุดุฎุตูุง ูุง ุญุฐูู: ุฑูู ุงูุฅูุบุงุก ุ ุซู ุชูุชูู ุงููููุฉ ุฅูู ุงูุญุงูุฉ </font></font><code>Canceled</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุฃู ููุฑ ุฃุญุฏ ุงูุฃุดุฎุงุต ุนูู "ุฅูุบุงุก" ูู ููุช ุงูุชุดุบูู ูุฃูุบู ุงููููุฉ. </font><font style="vertical-align: inherit;">ุชูุชุฑุญ ููุงุฑุณุชูุง ูู JetBrains ุฃูู ูุณุช ุจุญุงุฌุฉ ุฅูู ุงูุชูููุฒ ุจูู ูุฐู ุงูุฑููุฒ ุงููููุฒุฉ. </font><font style="vertical-align: inherit;">ุฅุฐุง ุญุตูุช ุนูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OperationCanceledException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ููุน ุฎุงุต ูุญุฏุซ ุนูุฏ ุญุฏูุซ ุจุนุถ ุงูุฅูุบุงุก ุ ููููู ุชูููุฒู. </font><font style="vertical-align: inherit;">ูู ูุฐู ุงูุญุงูุฉ ุ ุชุญุชุงุฌ ููุท ุฅูู ุฅููุงู ุงููููุฉ ุจุดูู ุทุจูุนู ุ ููุง ุชูู ุจุชุณุฌูู ุงูุฏุฎูู ุ ูุนูุฏูุง ุชุชููู ุงูุชูููุฐ - ูู ุจุชุณุฌูู ุงูุฏุฎูู.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุฉ ุงูุนููู</font></font></h3><br>
<pre><code class="cs hljs">Task.Factory.StartNew(() =&gt; <font></font>
{<font></font>
    Foo();<font></font>
}, cancellationToken);<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Foo</span>(<span class="hljs-params"></span>)</span> { <font></font>
     Bar() {<font></font>
       ...<font></font>
          Baz() {<font></font>
             <span class="hljs-comment">//how to get cancellation token?</span><font></font>
          } <font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุชุฑุถ ุฃู ูุฏูู ูููุฉ ุนูููุฉ. ูุฐู </font></font><code>CancellationToken</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงููุนููุฉ ุงูุตุฑูุญุฉ ุงููุญูุฏุฉ ุงูุชู ูุงูุดูุงูุง. ูุฌุจ ุฃู ุชูุชูู ูู ูู ููุงู ูู ุฎูุงู ุฌููุน ุงูุชุณูุณูุงุช ุงููุฑููุฉ. ูุงุฐุง ุชูุนู ูู ุญุงูุฉ ูุฌูุฏ ุชุณูุณู ูุฑูู ุนููู ุชุญุชุงุฌ ุฅูู ุฅูุบุงุก ูููุชู ูู ููุงู ูุง ุ ุนูู ุฃุฏูู ูุณุชูู ุ ููุชุฎูุต ูู ุงูุงุณุชูุจุงูุ ููุงู ุญููุฉ ุฎุงุตุฉ ูุณุชุฎุฏููุง. ูุฏุนู </font></font><code>AsyncLocal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">static</span> AsyncLocal&lt;Cancelation&gt; asyncLocalCancellation;<font></font>
<font></font>
Task.Factory.StartNew(() =&gt; <font></font>
{<font></font>
     asyncLocalCancellation.Set(cancellationToken) <font></font>
    Foo();<font></font>
}, cancellationToken); <span class="hljs-comment">// use AsyncLocal to put cancellation int</span><font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Foo</span>(<span class="hljs-params"></span>)</span> { 
     <span class="hljs-function"><span class="hljs-keyword">async</span> <span class="hljs-title">Bar</span>(<span class="hljs-params"></span>)</span> {<font></font>
      ...<font></font>
         Baz() {<font></font>
             asyncLocalCancellation.Value.CheckForInterrupt(); <font></font>
         }<font></font>
   } <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐุง ูู ููุณู ุ </font></font><code>ThreadStatic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุท ุงูุฎุงุต </font></font><code>ThreadLocal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฐู ููุฌู ูู ุฑุญูุงุช ููุฏ ุบูุฑ ูุชุฒุงูู / ูู ุงูุชุธุงุฑ. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู ุดูุฑุชู ุบูุฑ ูุชุฒุงููุฉ ุ ููุฏูู ูุฐุง ุงูุฅูุบุงุก ุ ููููู ูุถุนูุง </font></font><code>AsyncLocal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ููู ููุงู ูุง ุนูู ูุณุชูู ุนููู ููููู ุฃู ุชููู " </font></font><code>CheckForInterrupt Throw If Cancellation Requested</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">". </font><font style="vertical-align: inherit;">ูุฑุฉ ุฃุฎุฑู ุ ูุฐู ูู ุงููุนููุฉ ุงููุญูุฏุฉ </font></font><code>CancellationToken</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชู ุชุญุชุงุฌ ุฅูู ุชุดููู ุงูุฑูุฒ ุจุงููุงูู ุ ูููู ุ ูู ุฑุฃูู ุ ุจุงููุณุจุฉ ููุนุธู ุงูููุงู ุ ุชุญุชุงุฌ ููุท ุฅูู ูุนุฑูุฉ ูุง ุญุฏุซ </font></font><code>OperationCanceledException</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ููู ูุฐุง ุงุณุชุฎูุงุต ุงุณุชูุชุงุฌ ููุต ุนูู: ุชู ุงูุฅูุบุงุก ุฃู ุงููุดู.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุนููุฏ ุงููุนุฑูู</font></font></h3><br>
<pre><code class="cs hljs">Task.Factory.StartNew(Action, <font></font>
    TaskCreationOptions, <font></font>
    TaskScheduler, <font></font>
    CancellationToken<font></font>
)<font></font>
                                                   JetBrains.Lifetimes<font></font>
<font></font>
lifetime.Start(TaskScheduler, Action) <span class="hljs-comment">//puts lifetime in AsyncLocal</span><font></font>
<font></font>
lifetime.StartMainRead(Action) <font></font>
lifetime.StartMainWrite(TaskScheduler, Action) <font></font>
lifetime.StartBackgroundRead(TaskScheduler, Action)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุง ูุงู ุงูุฑูุฒ ุฃูุซุฑ ุตุนูุจุฉ ูู ุงููุฑุงุกุฉ ุนูุฏ ุจุฏุก ุงููููุฉ ุ ุฒุงุฏ ุฎุทุฑ ุงูุฎุทุฃ. ุจุงููุธุฑ ุฅูู ุงูุฑูุฒ ุจุนุฏ ุนุงู ุ ุณุชูุณู ูุง ููุนูู ุ ูุฃู ููุงู ุนุฏุฏูุง ูุจูุฑูุง ูู ุงููุนููุงุช. ูููู ูุฏููุง ููุชุจุฉ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JetBrains.Lifetimes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุงูุชู ุชูุฏู ุนูุฑูุง ุนุตุฑููุง ุ ูุฅูุบุงุก ูุญุณูููุง ูุญุณููุง ุจุดูู ุฌูุฏ ุ ูุงูุฐู ุชู ูู ุฎูุงูู ุฅุนุงุฏุฉ ูุชุงุจุฉ ุทุฑููุฉ ุงูุจุฏุก ูุญู ูุดููุฉ ุชูุฑุงุฑ ุฃุฌุฒุงุก ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุ ููุง ูู ุงูุญุงู ูุน </font></font><code>Task.Factory.StartNew</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>TaskCreationOptions</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงู ุนุฏุฏ ุตุบูุฑ ูู ุงููุฌุฏููุงุช ุงูุชู ุชุณูุญ ูู ุจุฌุฏููุฉ ูููุฉ ูู ุณูุณูุฉ ุงููุญุงุฏุซุงุช ุงูุฑุฆูุณูุฉ ุจููู ูููุฑุงุกุฉ. ุฃู ุฃู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ุงููุฑุงุกุฉ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุณ ุดูุฆูุง ุชุฎุชุงุฑู ุจุดูู ุตุฑูุญ ุ ุจู ูู ุฌุฏููุฉ ุฎุงุตุฉ ุชููู ุจุฌุฏููุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุฎุงุตุฉ ุจู ูู ุงูููุถูุน ุงูุฑุฆูุณู ูุน </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ุงููุฑุงุกุฉ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุจุงูุฅุถุงูุฉ ุฅูู ุงูุฎูุท ุงูุฑุฆูุณู ูุน ููู ุงููุชุงุจุฉ ูุฎูุท ุงูุฎูููุฉ - ูุงูุขู ุฃุตุจุญุช ุงูุฃุณุงููุจ ุจุณูุทุฉ ุฌุฏูุง ูุจุฏุก ุงูุชุจุฏูู ุงูุนุดูุงุฆู. ูู ููุณ ุงูููุช ุ ูุชู ุฅูุบุงุก ุงูุฃุนูุงุฑ ุชููุงุฆููุง ูู ุฎูุงู </font></font><code>AsyncLocal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุจุณูุท ุงูุฑูุฒ ุจุดูู ูุจูุฑ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_h/1n/gu/_h1ngucdl-vvbpyyalkk_gwvapu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนููุง ูุฑู ููู </font><font style="vertical-align: inherit;">ูุญู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุฒุงูู / ุงูุชุธุงุฑ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุญู ูุฐู ุงููุดุงูู ุ ููุง ูู ุงููุดุงูู ุงูุชู </font><font style="vertical-align: inherit;">ุชูุฏููุง </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุฐุง ุงููุซุงู ุ ูุชู ุชูููุฐ ุฌุฒุก ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุจุดูู ูุชุฒุงูู ุ ุซู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุงูุชุธุงุฑ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุบูุฑ ุงููุชุฒุงููุฉ. ุฃููุงู ุ ูู ุงูุฌูุฏ ุฃู ููุงู ุนุฏุฏูุง ุฃูู ูู ุงูุฃุฌุฒุงุก ุงููุชูุฑุฑุฉ ูู ุงูุดูุฑุฉ ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุญุฉ ุงูุบูุงูุฉ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). ุซุงูููุง ุ ูู ุงูุฌูุฏ ุฃู ุงูุดูุฑุฉ ุบูุฑ ุงููุชุฒุงููุฉ ุชุดุจู ุฅูู ุญุฏ ูุจูุฑ ุงูุดูุฑุฉ ุงููุชุฒุงููุฉ ุ ููุฐุง ูู ุจุงูุถุจุท ูุง ูู ุบูุฑ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุฒุงูู / ููุชุธุฑ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ููููู ุงููุชุงุจุฉ ุจุดูู ุบูุฑ ูุชุฒุงูู ุจููุณ ุงูุทุฑููุฉ ุงูุชู ูุชุจุช ุจูุง ุจุดูู ูุชุฒุงูู ุ ุจุฏูู ุชูุงูู ุณูุงุณู ุงูุฑุณุงุฆู.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุง ูู ูุฐู ุงูุญุงูุฉ ุณููุดุฑ ุงููุชุฑุฌูุ ุณูุชู ุชูููุฐ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุชุฒุงููุฉ ุจุดูู ูุชุฒุงูู ุ ูุจุนุฏ ุฐูู </font></font><code>InnerAsync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูุชู </font><font style="vertical-align: inherit;">ุชูููุฐ ุงููููุฉ </font><font style="vertical-align: inherit;">ุจุดูู </font><font style="vertical-align: inherit;">ูุชุฒุงูู </font><font style="vertical-align: inherit;">ุ ูู ุฃูู ูุฃุชู ูุงุฆู GetAwaiter ุงูุฎุงุต. ูู ูุฐู ุงูุญุงูุฉ ุ ูุญู ููุชููู </font></font><code>TaskAwaiter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ููููู ูุชุงุจุฉ ุงูุชุธุงุฑู ูุฃู ุดูุก ุนูู ุงูุฅุทูุงู. ููุชูุฌุฉ ูุฐูู ุ ููุชุธุฑ ุงููููุฉ ูุฅููุงููุง </font></font><code>InnerAsync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชูููุฐูุง ุจุดูู ูุชุฒุงูู </font></font><code>continuationCode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ุฅุฐุง ูู ูููุฉ ุฅููุงูุ ุซู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">continuationCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููู ุงูููุฑุฑ ุนูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌุฏููุฉ ุงูุณูุงู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ูุฏ ูููู ุฐูู ุ ุนูู ุงูุฑุบู ูู ุฃูู ูุชุจุช ูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุงูุชุธุงุฑ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุณูุชู ุงุณุชุฏุนุงุก ูู ุดูุก ุจุดูู ูุชุฒุงูู.</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">async</span> Task <span class="hljs-title">MyFuncAsync</span>(<span class="hljs-params"></span>)</span> { <font></font>
  synchronousCode();<font></font>
   <span class="hljs-keyword">await</span> InnerAsync();
   <span class="hljs-keyword">await</span> Task.Yield(); <span class="hljs-comment">//guaranteed !IsCompleted </span><font></font>
   continuationCode();<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงู ุฎุฏุนุฉ ูุงุญุฏุฉ </font></font><code>Task.Yield</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ูุฐู ูููุฉ ุฎุงุตุฉ ุชุถูู ุฃู ุตุงุญุจูุง ูู ูุนูุฏ ุฅููู ุฏุงุฆููุง </font></font><code>IsCompleted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ููููุง ูุฐูู ุ </font></font><code>continuation</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุชู ุงุณุชุฏุนุงุคู ุจุดูู ูุชุฒุงูู ูู ูุฐุง ุงูููุงู. ุจุงููุณุจุฉ ููุคุดุฑ ุชุฑุงุจุท ูุงุฌูุฉ ุงููุณุชุฎุฏู ุ ูููู ุฃู ูููู ูุฐุง ููููุง ูุฃูู ูุง ุชุฃุฎุฐ ูุฐุง ุงูููุถูุน ููุชุฑุฉ ุทูููุฉ ูู ุงูููุช. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jg/jy/7d/jgjy7dh0cnbslfcyk4jpyapc9du.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููููุฉ ุงุฎุชูุงุฑ ุฎูุท ููุงุณุชูุฑุงุฑุ ุงูููุณูุฉ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุชุฒุงููุฉ / ุชูุชุธุฑ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู </font><font style="vertical-align: inherit;">: ุชูุชุจ ุฑูุฒ ุบูุฑ ูุชุฒุงูู ูุซู ุงููุชุฒุงูู. ุฅุฐุง ูุงู ูุฏูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฌูุน ุณูุงุณู ุฑุณุงุฆู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ </font><font style="vertical-align: inherit;">ููู ูููู </font><font style="vertical-align: inherit;">ููุงู ูุฑู ุจุงููุณุจุฉ ูู - ุณูุชู ุชูููุฐ </font><font style="vertical-align: inherit;">ุฑูุฒ </font><font style="vertical-align: inherit;">ุงุณุชูุฑุงุฑูุฉ ุนูู ุณูุณูุฉ ุฑุณุงุฆู ุฃุฎุฑู. ุจุบุถ ุงููุธุฑ ุนูุง ุฅุฐุง ูุงู ูุฏ </font></font><code>InnerAsync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชูู ุนูุฏูุง ููุช </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุธุฑ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฃู ูุง ุ ูุฃูุช ุจุญุงุฌุฉ ุฅูู ูู ุดูุก ูุชูููุฐู ุนูู ุณูุณูุฉ ูุงุฌูุฉ ุงููุณุชุฎุฏู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุขููุฉ ุงููููุฉ ููุฏ ุงูุงูุชุธุงุฑ ูู ููุง ููู: ูุชู ุฃุฎุฐูุง </font></font><code>static</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุทูู ุนูููุง</font></font><code>SynchronizationContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ูุชู ุฅูุดุงุคู </font></font><code>TaskScheduler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SynchronizationContext</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุดูุก ูุน ุทุฑููุฉ ุงููุดุฑ ุ ูุงูุชู ุชุดุจู ุฅูู ุญุฏ ูุจูุฑ ุงูุฃุณููุจ </font></font><code>Queue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูู ุงููุงูุน </font></font><code>TaskScheduler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุงูุฐู ูุงู ูู ููุช ุณุงุจู ุ ูุฅูู ูุฃุฎุฐ ุจุจุณุงุทุฉ </font></font><code>SynchronizationContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ุฎูุงู Post ูุคุฏู ูููุชู ุนููู.</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">async</span> Task <span class="hljs-title">MyFuncAsync</span>(<span class="hljs-params"></span>)</span> { <font></font>
  synchronousCode();<font></font>
<font></font>
    <span class="hljs-keyword">await</span> InnerAsync().ConfigureAwait(<span class="hljs-literal">false</span>);<font></font>
    continuationCode(); <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงู ุทุฑููุฉ ูุชุบููุฑ ูุฐุง ุงูุณููู ุจุงุณุชุฎุฏุงู ูุนููุฉ </font></font><code>ContinueOnCapturedContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุชุณูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุงุดูุฆุฒุงุฒ ุงูููุฌูุฏุฉ ูู .NET </font></font><code>ConfigureAwait</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูู ูุฐู ุงูุญุงูุฉ ุ ุชููู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (API) ุจุฅูุดุงุก ููุนูููู ุฎุงุต ุ ูุฎุชูู ุนู </font></font><code>TaskAwaiter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฐูู ุงูุฐู ูุบูุฑ ุงูุงุณุชูุฑุงุฑ ุ </font><font style="vertical-align: inherit;">ููุชู </font><font style="vertical-align: inherit;">ุชุดุบููู ุนูู ููุณ ูุคุดุฑ ุงูุชุฑุงุจุท ุ ููู ููุณ ุงูุณูุงู ุงูุฐู ุงูุชูุช </font></font><code>InnerAsync </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู </font><font style="vertical-align: inherit;">ุงูุทุฑููุฉ </font><font style="vertical-align: inherit;">ูุญูุซ ุงูุชูุช ุงููููุฉ.</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">async</span> Task <span class="hljs-title">MyFuncAsync</span>(<span class="hljs-params"></span>)</span> { <font></font>
  synchronousCode();<font></font>
<font></font>
    <span class="hljs-keyword">await</span> InnerAsync().ConfigureAwait(continueOnCapturedContext: <span class="hljs-literal">false</span>); <font></font>
    continuationCode(); <span class="hljs-comment">//code must be absolutely context-agnostic</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงู ูุฏุฑ ุบูุฑ ูุนููู ูู ุงููุตุงุฆุญ ุนูู ุงูุฅูุชุฑูุช: ุฅุฐุง ูุงู ูุฏูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุทุฑูู ูุณุฏูุฏ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูุงูุฑุฌุงุก ุชุดููู ูู ุฑูุฒ ConfigureAwait ุงูุฎุงุต ุจู ููู ุดูุก ุณูููู ุนูู ูุง ูุฑุงู. </font><font style="vertical-align: inherit;">ูุฐู ูู ุงูุทุฑููุฉ ุงูุฎุงุทุฆุฉ. </font></font><code>ConfigureAwait</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ุงุณุชุฎุฏุงููุง ูู ุงูุญุงูุงุช ุงูุชู ุชุฑูุฏ ูููุง ุชุญุณูู ุงูุฃุฏุงุก ููููุงู ุ ุฃู ูู ููุงูุฉ ุงูุทุฑููุฉ ุ ูู ุจุนุถ ุฃุณุงููุจ ุงูููุชุจุฉ.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌููุฏ</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">async</span> Task <span class="hljs-title">MyFuncAsync</span>(<span class="hljs-params"></span>)</span> { <span class="hljs-comment">//UI thread </span><font></font>
  synchronousCode();<font></font>
<font></font>
    <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">10</span>).ConfigureAwait(continueOnCapturedContext: <span class="hljs-literal">false</span>); <font></font>
    continuationCode();<font></font>
}<font></font>
myFuncAsync().Wait() <span class="hljs-comment">//on UI thread</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐุง </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุทุฑูู ูุณุฏูุฏ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุงุณููู </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูู ูุคุดุฑ ุชุฑุงุจุท ูุงุฌูุฉ ุงููุณุชุฎุฏู ุ ุงูุชุธุฑูุง ุนุดุฑ ุซูุงู ููุนููุง </font></font><code>Wait</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุธุฑูุง ููุง ููุช ุจู </font></font><code>Wait</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ </font></font><code>continuationCode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ูุชู ุฅุทูุงูู ูุทูููุง ุ </font></font><code>Wait</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐูู ูู ูุนูุฏ ุฃุจุฏูุง. </font><font style="vertical-align: inherit;">ูู ุฐูู ูุญุฏุซ ูู ุงูุจุฏุงูุฉ.</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">async</span> Task <span class="hljs-title">OnBluttionClick</span>(<span class="hljs-params"></span>)</span> { <span class="hljs-comment">//UI thread </span>
  <span class="hljs-keyword">int</span> v = Button.Text.ParseInt();<font></font>
<font></font>
    <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">10</span>).ConfigureAwait(continueOnCapturedContext: <span class="hljs-literal">false</span>); <font></font>
  Button.Text.Set((v+<span class="hljs-number">1</span>).ToString());<font></font>
}<font></font>
myFuncAsync().Wait() <span class="hljs-comment">//on UI thread</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุฎูู ุฃู ูุฐุง ูุดุงุท ุญูููู. ููุฑูุง ุนูู ุงูุฒุฑ ุ ูุฃุฎุฐู </font></font><code>Button.ParseInt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงูุชุธุฑูุง</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ููุชุจูุง </font></font><code>ConfigureAwait</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู: "ูู ูุถูู ูุง ุชุบูู ุฏูู ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงูุฎุงุต ุจูุง ุ ููู ุจุฅุฌุฑุงุก ุงููุชุงุจุนุฉ". ุงููุดููุฉ ูู ุฃููุง ูุฑูุฏ </font></font><code>ConfigureAwait</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃู ูุชู ุชูููุฐ </font><font style="vertical-align: inherit;">ุงูุฌุฒุก ุงูุซุงูู ุจุนุฏ ุฐูู </font><font style="vertical-align: inherit;">ุฃูุถูุง ูู ุณูุณูุฉ ูุงุฌูุฉ ุงููุณุชุฎุฏู ุ ูุฃู ูุฐู ูู ููุณูุฉ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุงูุชุธุงุฑ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ุฃู ุฃู ุงูุฑูุฒ ุบูุฑ ุงููุชุฒุงูู ูุดุจู ุงูุฑูุฒ ุงููุชุฒุงูู ุ ููุชู ุชุดุบููู ูู ููุณ ุงูุณูุงู. ูู ูุฐู ุงูุญุงูุฉ ุ ุจุงูุทุจุน ุ ุณูููู ููุงู ุฎุทุฃ. ูุฅูู ุฌุงูุจ </font></font><code>Button.Text.Set</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฐูู ุ ูููู ุฃู ูููู ููุงู ุฃู ุนุฏุฏ ูู ุงุณุชุฏุนุงุกุงุช ุงูุทุฑููุฉ ุงูุชู ุชูุชุฑุถ ุฃูุถูุง ุณูุงููุง. ูุงุฐุง ุชูุนู ูู ูุฐู ุงูุญุงูุฉุ ููููู ุงู ุชูุนููุง:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">async</span> Task <span class="hljs-title">MyFuncAsync</span>(<span class="hljs-params"></span>)</span> { <span class="hljs-comment">//UI thread </span><font></font>
  synchronousCode();<font></font>
<font></font>
    <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">10</span>).ConfigureAwait(continueOnCapturedContext: <span class="hljs-literal">false</span>); <font></font>
    continuationCode(); <span class="hljs-comment">//The same UI context</span><font></font>
}<font></font>
PumpUntil(() =&gt; task.IsCompleted);<font></font>
<span class="hljs-comment">//VS synchronization contexts always pump on any Wait</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงุณุชุฎุฏุงู ูุคุดุฑ ุชุฑุงุจุท ูุงุฌูุฉ ุงููุณุชุฎุฏู ุ ูุฌุจ ููุน ุงูููุงู ุจุฐูู </font></font><code>Wait</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูู ุณูุงุณู ุงูุฑุณุงุฆู ุงูุชู ุชุญุชูู ุนูู ูุงุฆูุฉ ุงูุชุธุงุฑ ุฑุณุงุฆู ูุดุชุฑูุฉ. ุจุฏูุงู ูู ุงูุนูู </font></font><code>Wait</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃู ุงููุชุงุจุฉ </font></font><code>ConfigureAwait</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ููููู ุถุฎ ูุงุฆูุฉ ุงูุชุธุงุฑ ุงูุฑุณุงุฆู ูุฐู ุ ููู ููุณ ุงูููุช ุ ุณูุชู ุถุฎ ุงููุชุณูุณูุฉ ุฃูุถูุง. ุฅุฐุง ูู ุชุชููู ูู ูุฒุฌ ุงูููุฏ ุงููุชุฒุงูู ูุบูุฑ ุงููุชุฒุงูู ุ ููุง ูุฌุจ ุนููู ูุฒุฌููุง. ูููู ูู ุจุนุถ ุงูุฃุญูุงู ูุง ูููู ุชุฌูุจ ุฐูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูู ุณุจูู ุงููุซุงู ุ ูุฏูู ุฑูุฒ ูุฏูู ุ ููุฌุจ ุนููู ูุฒุฌู ุ ุซู ุชุถุฎ ุชุฏูู ูุงุฌูุฉ ุงููุณุชุฎุฏู. ูุถุฎ Visual Studio ูุคุดุฑ ุชุฑุงุจุท ูุงุฌูุฉ ุงููุณุชุฎุฏู ุนูู ุงูุชููุนุงุช ุ ุญุชู ุฃูู </font></font><code>SynchronizationContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุบูุฑ ููููุงู. ุฅุฐุง ุฐูุจุช ุฅูู WaitHandle ุนูู ุฃู </font></font><code>Wait</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุนูุฏูุง ุชุนูู ุ ูุชู ุถุฎ ุชูุงุฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู. ูุจุงูุชุงูู ุ ูุฅููู ูุฎุชุงุฑูู ุจูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฌููุฏ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุงูุฃุนุฑุงู ูุตุงูุญ ุงูุนุฑู. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงูุจููุชูู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ูุฐู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ุบูุฑ ูุซุงููุฉ ุ ุฃู ุนูุฏูุง ุชุฌุฑู ุงุณุชูุฑุงุฑูุฉ ุนุดูุงุฆูุฉ ูู ููุงู ุนุดูุงุฆู ุ ูุฏ ุชููู ููุงู ูุฑูู ุฏูููุฉ. </font><font style="vertical-align: inherit;">ูุง ุชูุฌุฏ ุทุฑููุฉ ุฃุฎุฑู ุ ููุฃุณู. </font><font style="vertical-align: inherit;">ุงุฎูุท ุงูุฑููุฒ ุงููุชุฒุงููุฉ ูุบูุฑ ุงููุชุฒุงููุฉ. </font><font style="vertical-align: inherit;">ุฅุฐุง ูุงู ููุงู ุฃู ุดูุก ุ ูุชู ุชุฑุชูุจ ุงูุฑุงูุฏุฑ ุจุฃูููู ูู ุงูุฃูุงูู ุงููุฏููุฉ ุ ูุฐูู ูู ุจุนุถ ุงูุฃุญูุงู ุชููู ููุงู ูุฑูู ุฏูููุฉ ุฃูุถูุง.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุบููุฑ ุงูุณูุงู</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">async</span> Task <span class="hljs-title">MyFuncAsync</span>(<span class="hljs-params"></span>)</span> { <font></font>
  synchronousCode(); <span class="hljs-comment">// on initial context</span><font></font>
<font></font>
    <span class="hljs-keyword">await</span> myTaskScheduler;<font></font>
    continuationCode(); <span class="hljs-comment">//on scheduler context </span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงู ุทุฑููุฉ ุฃุฎุฑู ูุซูุฑุฉ ููุงูุชูุงู ูุงุณุชุฎุฏุงู ุบูุฑ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุฒุงูู / ุงูุชุธุงุฑ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ููููู ูุชุงุจุฉ </font></font><code>Awaiter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูู </font></font><code>scheduler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงูููุฒ ุนูู ุงูููุงุถูุน. </font><font style="vertical-align: inherit;">ูุฑุฃุช ุงูููุดูุฑุงุช ูู Visual Studio ุ ููุชุจูุง ููุชุฑุฉ ุทูููุฉ ุฌุฏูุง ุฃูู ููุณ ูู ุงูุฌูุฏ ุงูููุฒ ุฐูุงุจูุง ูุฅูุงุจูุง ูู ููุชุตู ุงูุทุฑููุฉ ุ ููููู ููุนููู ุฐูู ุงูุขู ุจุฃููุณูู. </font><font style="vertical-align: inherit;">ูุญุชูู Visual Studio ุนูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช (API) ุชูุชูู ุนูู ูุคุดุฑุงุช ุงูุชุฑุงุจุท ูู ุฎูุงู ุงูุฌุฏููุฉ. </font><font style="vertical-align: inherit;">ููุงุณุชุฎุฏุงู ุงูุนุงุฏู ุ ูุฅู ุงูููุงู ุจุฐูู ููุณ ุฌูุฏูุง.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุฒุงูู ุงูููุธู</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">async</span> Task <span class="hljs-title">MyFuncAsync</span>(<span class="hljs-params"></span>)</span> { <font></font>
  synchronousCode(); <span class="hljs-comment">// on initial context</span><font></font>
<font></font>
    <span class="hljs-keyword">await</span> Task.Factory.StartNew(() =&gt; {...}, myTaskScheduler);<font></font>
    continuationCode(); <span class="hljs-comment">//on initial context </span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุฃุฌู ุงูุงูุบูุงุณ ุงููุฑูุญ ูู ุงูุณูุงู ุงูุฌุฏูุฏ ูุงูุนูุฏุฉ ุฅูู ุงููุฏูู ุ ูุฌุจ ุจูุงุก ุจุนุถ ุงูููุงูุณุฉ ุงููููููุฉ ุฃู ุงูุชูุงุฒู ุงูููููู. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ ูู ุงูุณุชููุงุช ุ ุงุนุชุจุฑ ุนุงูู GoTo ุถุงุฑูุง ูุฃูู ุงูุชูู ุงูุจููุฉ. </font><font style="vertical-align: inherit;">ูุฐุง ููู ููุง. </font><font style="vertical-align: inherit;">ุงูููุฒ ุนูู ุงูุฎููุท ููุชูู ุงููููููุฉ. </font><font style="vertical-align: inherit;">ูู ุงููุซูุฑ ููุฏูุดุฉ ุฃู ุงุณุชุฎุฏุงู ุขูุฉ ุญุงูุฉ ุบูุฑ ูุชุฒุงููุฉ ูุจุฏู ููุฎุฑุฌ ุฌูุฏ. </font><font style="vertical-align: inherit;">ุฃู ุ ุญูุซ ูุชู ุงูุชูุงู ุงููููู ุงููุนุชุงุฏ ุงูุฎุงุต ุจู ุ ุชููุฒ ุนูู GoTo ุ ููููู ุงูุชูุงู ุจููุฉ ุงูุฎูุท: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุธุฑ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูู ุจุงูุชุฏุฎู ูู ุงูุชุณููุงุช. </font><font style="vertical-align: inherit;">ูุฐุง ูููู ุบุฑูุจ ููุงุฏุฑ ููุบุงูุฉ ุนูุฏูุง ุชุญุชุงุฌ ุฅูู ุงูููุงู ุจุฐูู. </font><font style="vertical-align: inherit;">ููุน ุฐูู ุ ูู ุงูุฃูุถู ุนูุฏูุง </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูุชุธุฑ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุนูุฏุฉ ุฅูู ููุณ ุงูุณูุงู. </font><font style="vertical-align: inherit;">ูุจุงูุชุงูู ุ ูู ูููู ูุชุฌูุน ูุคุดุฑ ุงูุชุฑุงุจุท ููุณ ูุคุดุฑ ุงูุชุฑุงุจุท ุ ูููู ููุณ ุงูุณูุงู ุงูุฐู ูุงู ุนููู ูู ุงูุฃุตู.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณููู ูุชุณูุณู</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงุฐุง </font><font style="vertical-align: inherit;">ูุง </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูุชุธุฑ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุชูููุฐ ุงูููุงุฒูุ </font><font style="vertical-align: inherit;">ุงูุชุธุงุฑ ุงูุชูููุฐ ูู ุงูุชูููุฐ ุงููุชุณูุณู. </font><font style="vertical-align: inherit;">ูู ูุฐู ุงูุญุงูุฉ ุ ูุจุฏุฃ ุงููููุฉ ุงูุฃููู ุ ููุชุธุฑูุง ุ ูุจุฏุฃ ุงููููุฉ ุงูุซุงููุฉ - ููุชุธุฑ. </font><font style="vertical-align: inherit;">ููุณ ูุฏููุง ููุงุฒูุฉ. </font><font style="vertical-align: inherit;">ุจุงููุณุจุฉ ููุนุธู ุงูุงุณุชุฎุฏุงูุงุช ุ ูุง ุญุงุฌุฉ ููุชูุงุฒู. </font><font style="vertical-align: inherit;">ุงูุชูุงุฒู ููุณู ุฃูุซุฑ ุชุนููุฏูุง ูู ุงูุชุณูุณู. </font><font style="vertical-align: inherit;">ุงูุฑูุฒ ุงูุชุณูุณูู ุฃุจุณุท ูู ุงูุชูุงุฒู ุ ุฅูู ุจุฏูููุฉ. </font><font style="vertical-align: inherit;">ูููู ูู ุจุนุถ ุงูุฃุญูุงู ุชุญุชุงุฌ ุฅูู ุชุดุบูู ุดูุก ูุง ูู ุฑูุฒ ูุชูุงุฒู ุ ูุชููู ุจุฐูู ุนูู ุงููุญู ุงูุชุงูู:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">async</span> Task <span class="hljs-title">MyAsync</span>(<span class="hljs-params"></span>)</span> {<font></font>
<font></font>
  <span class="hljs-keyword">var</span> task1 = StartTask1Async();
  <span class="hljs-keyword">await</span> task1;<font></font>
<font></font>
  <span class="hljs-keyword">var</span> task2 = StartTask2Async();
  <span class="hljs-keyword">await</span> task2; <font></font>
}</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุณููู ุงููุชุฒุงูู</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">async</span> Task <span class="hljs-title">MyAsync</span>(<span class="hljs-params"></span>)</span> {
  <span class="hljs-keyword">var</span> task1 = StartTask1Async();
  <span class="hljs-keyword">var</span> task2 = StartTask2Async();<font></font>
<font></font>
  <span class="hljs-keyword">await</span> task1;
  <span class="hljs-keyword">await</span> task2; <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุง ุชุจุฏุฃ ุงูููุงู ุจุงูุชูุงุฒู. </font><font style="vertical-align: inherit;">ูู ุงููุงุถุญ ุฃู ุงูุฃุณุงููุจ ูููู ุฃู ุชุฑุฌุน ุงููููุฉ ุนูู ุงูููุฑ ูู ุญุงูุฉ ุชุดุบูู ุ ููู ูููู ููุงู ููุงุฒูุฉ. </font><font style="vertical-align: inherit;">ุฏุนูุง ูููู ุฃู ููุชุง ุงููููุชูู ุชูููุงู ุจุฅุนุฏุงู. </font><font style="vertical-align: inherit;">ูุงูุชุธุฑุช ุงููููุฉ ุงูุฃููู ุ ุซู ูู ุฃูู ุงูุชุธุงุฑ ุฃููุนุช. </font><font style="vertical-align: inherit;">ุฃู ุจูุฌุฑุฏ ุฃู ุชูุชุจ </font></font><code>await task1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุช ุชููุน ููู ุชุนุงูุฌ </font></font><code>exception task2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูู ุงููุซูุฑ ููุงูุชูุงู ุ ูุฐุง ุฑูุฒ ุตุงูุญ ุชูุงููุง. </font><font style="vertical-align: inherit;">ููุฐุง ุงูุฑูุฒ ูู ุงูุฐู ูุงุฏ .NET ุฅูู ุญูููุฉ ุฃู ุณููู ุงูุนูู ูุน ุนูููุงุช ุงูุชูููุฐ ูุฏ ุชุบูุฑ ูู ุงูุฅุตุฏุงุฑ 4.5.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุนุงูุฌุฉ ุงูุงุณุชุซูุงุก</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">async</span> Task <span class="hljs-title">MyAsync</span>(<span class="hljs-params"></span>)</span> {
  <span class="hljs-keyword">var</span> task1 = StartTask1Async();
  <span class="hljs-keyword">var</span> task2 = StartTask2Async(); <font></font>
<font></font>
  <span class="hljs-keyword">await</span> task1;
  <span class="hljs-keyword">await</span> task2;<font></font>
<font></font>
  <span class="hljs-comment">// if task1 throws exception and task2 throws exception we only throw and</span>
  <span class="hljs-comment">// handle task1โs exception</span><font></font>
<font></font>
  <span class="hljs-comment">//4.0 -&gt; 4.5 framework: unhandled exceptions now donโt crush process</span>
  <span class="hljs-comment">//still visible in UnobservedExceptionHandler</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงูุณุงุจู ุ ูุงูุช ุนูููุงุช ุงูุชูููุฐ ุงูุชู ูู ุชุชู ูุนุงูุฌุชูุง ูู ุงูุชู ุฃููุช ุงูุนูููุฉ ุจุจุณุงุทุฉ ุ ูุฅุฐุง ูู ุชุชููู ูู ุชูููุฐ ุจุนุถ ุนูููุงุช ุงูุชูููุฐ </font></font><code>UnobservedExceptionHandler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(ููุฐุง ุฃูุถูุง ุจุนุถ ุงูุฅุฌุฑุงุกุงุช </font></font><code>static</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชู ููููู ุฅุฑูุงููุง ุจุงูููุงุนูุฏ) ุ ููู ูุชู ุชูููุฐ ูุฐู ุงูุนูููุฉ. ุงูุขู ูุฐุง ุฑูุฒ ุตุงูุญ ุชูุงูุง. ุนูู ุงูุฑุบู ูู ุฃู .NET ุบูุฑุช ุณููููุง ุ ุฅูุง ุฃููุง ุงุญุชูุธุช ุจุงูุฅุนุฏุงุฏ ูุฅุนุงุฏุฉ ุงูุณููู ูู ุงูุงุชุฌุงู ุงููุนุงูุณ.</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">async</span>  Task  <span class="hljs-title">MyAsync</span>(<span class="hljs-params">CancellationToken cancellationToken</span>)</span>  {  <font></font>
<font></font>
  <span class="hljs-keyword">await</span>  <span class="hljs-function">SomeTask1  <span class="hljs-title">Async</span>(<span class="hljs-params">cancellationToken</span>)</span>; <font></font>
 <font></font>
  <span class="hljs-keyword">await</span>  <span class="hljs-function">Some <span class="hljs-title">Task2Async</span>(<span class="hljs-params"> cancellation  Token</span>)</span>; 
  <span class="hljs-comment">//you should always pass use async API with cancelationToken  if possible </span><font></font>
} <font></font>
  <font></font>
<span class="hljs-keyword">try</span> { 
    <span class="hljs-keyword">await</span>  MyAsync( cancellation  Token); <font></font>
} <span class="hljs-keyword">catch</span> (OperationException e) { <span class="hljs-comment">// do nothing: OCE happened</span>
} <span class="hljs-keyword">catch</span> (Exception e) { <font></font>
    log.Error(e);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุธุฑ ููู ุชุณูุฑ ุนูููุฉ ุงูุชูููุฐ. </font><font style="vertical-align: inherit;">ูุฌุจ ุฅุฑุณุงู CancellationToken-s ุ ููู ุงูุถุฑูุฑู "ุชุดููู" CancellationToken-s ุฌููุน ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ. </font><font style="vertical-align: inherit;">ุงูุณููู ุงูุทุจูุนู ุบูุฑ ุงููุชุฒุงูู ูู ุฃูู ูุง ุชุญูู ูู ุฃู ููุงู </font></font><code>Task.Status ancellationToken</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุฃูุช ุชุนูู ุจุฑูุฒ ุบูุฑ ูุชุฒุงูู ุจููุณ ุงูุทุฑููุฉ ุงููุชุจุนุฉ ูุน ุงููุชุฒุงูู. </font><font style="vertical-align: inherit;">ุฃู ุฃูู ูู ุญุงูุฉ ุงูุฅูุบุงุก ุ ุณุชุญุตู ุนูู ุชูููุฐ ุ ููู ูุฐู ุงูุญุงูุฉ ุ ูุง ุชูุนู ุดูุฆูุง ุนูุฏ ุงุณุชูุงูู </font></font><code>OperationCanceledException</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงููุฑู ุจูู ุญุงูุฉ "ููุบุงุฉ" ู "ูุนูุจุฉ" ูู ุฃูู ูู ุชุชูู </font></font><code>OperationCanceledException</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ููู ุงูุชูููุฐ ุงููุนุชุงุฏ. </font><font style="vertical-align: inherit;">ููู ูุฐู ุงูุญุงูุฉ ุ ูููููุง ุงูุชุนูุฏ ุจุฐูู ุ ุชุญุชุงุฌ ููุท ุฅูู ุชูููุฐ ูุชูููุฐ ุงุณุชูุชุงุฌุงุช ุจูุงุกู ุนูู ุฐูู. </font><font style="vertical-align: inherit;">ุฅุฐุง ุจุฏุฃุช ุงููููุฉ ุจุดูู ุตุฑูุญ ุ ูู ุฎูุงู ุงููููุฉ ุ ููุช ูุฏ ุณุงูุฑ ุฌูุง </font></font><code>AggregateException</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ููู ุญุงูุฉ ุนุฏู ุงูุชุฒุงูู ุ ูู ุญุงูุฉ ููุงููู </font></font><code>AggregateException</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏุงุฆููุง ุจุฅููุงุก ุฃูู ุนูููุฉ ุฅุนุฏุงู ูุงูุช ููู (ูู ูุฐู ุงูุญุงูุฉ - </font></font><code>OperationCanceled</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงูุชูุฑูู</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุทุฑููุฉ ูุชุฒุงููุฉ</font></font></h3><br>
<pre><code class="cs hljs">DataTable&lt;File, ProcessedFile&gt; sharedMemory;<font></font>
<font></font>
<span class="hljs-comment">// in any thread</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">SynchronousWorker</span>(<span class="hljs-params">...</span>)</span> {<font></font>
  File f = blockingQueue.Dequeue(); <font></font>
  ProcessedFile p = ProcessInParallel(f);<font></font>
<font></font>
  <span class="hljs-keyword">lock</span> (_lock) { <font></font>
    sharedMemory.<span class="hljs-keyword">add</span>(f, p);<font></font>
  } <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูู ุณุจูู ุงููุซุงู ุ ูุนูู ุดูุทุงู ูู ReSharper - ูุญุฑุฑ ูุนูู ุนูู ุชูููู ุงูููู ููุงุจุฉ ุนูู. </font><font style="vertical-align: inherit;">ุฅุฐุง ุชู ูุชุญ ุงูููู ูู ุงููุญุฑุฑ ุ ูููุงู ุจุนุถ ุงููุดุงุท ุงูุฐู ูุถุนู ูู ูุงุฆูุฉ ุงูุชุธุงุฑ ุงูุญุธุฑ. </font></font><code>worker</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูุฑุฃ </font><font style="vertical-align: inherit;">ุนูููุชูุง </font><font style="vertical-align: inherit;">ูู ููุงู ุ ูุจุนุฏ ุฐูู ุชููู ุจุชูููุฐ ูุฌููุนุฉ ูู ุงูููุงู ุงููุฎุชููุฉ ูุน ูุฐุง ุงูููู ุ ุชููููู ุ ุชุญูู ุ ุชุจูู ุ ูุจุนุฏ ุฐูู ุชุชู ุฅุถุงูุฉ ูุฐู ุงููููุงุช </font></font><code>sharedMemory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุจุงุณุชุฎุฏุงู </font></font><code>sharedMemory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููู ุ ุชุนูู ุขููุงุช ุฃุฎุฑู ูุนู ุจุงููุนู.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุทุฑููุฉ ุบูุฑ ูุชุฒุงููุฉ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูุฏ ุฅุนุงุฏุฉ ูุชุงุจุฉ ุงูุฑูุฒ ุฅูู ุบูุฑ ูุชุฒุงูู ุ ุณูููู ุฃููุงู ุจุงุณุชุจุฏุงูู </font></font><code>void</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจู </font></font><code>async Task</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุชุฃูุฏ ูู ูุชุงุจุฉ ูููุฉ "Async" ูู ุงูููุงูุฉ. </font><font style="vertical-align: inherit;">ูุฌุจ ุฃู ุชูุชูู ุฌููุน ุงูุทุฑู ุบูุฑ ุงููุชุฒุงููุฉ ุจู Async - ูุฐู ุงุตุทูุงุญ.</font></font><br>
<br>
<pre><code class="cs hljs">DataTable&lt;File, ProcessedFile&gt; sharedMemory;
<span class="hljs-comment">// in any thread</span>
<span class="hljs-function"><span class="hljs-keyword">async</span> Task <span class="hljs-title">WorkerAsync</span>(<span class="hljs-params">...</span>)</span> {<font></font>
<font></font>
  File f = blockingQueue.Dequeue(); <font></font>
<font></font>
  ProcessedFile p = ProcessInParallel(f);<font></font>
<font></font>
  <span class="hljs-keyword">lock</span> (_lock) { <font></font>
    sharedMemory.<span class="hljs-keyword">add</span>(f, p);<font></font>
  } <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ุฐูู ุ ุชุญุชุงุฌ ุฅูู ุงูููุงู ุจุดูุก ูุง ูุฏููุง </font></font><code>blockingQueue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ูู ุงููุงุถุญ ุฃูู ุฅุฐุง ูุงู ููุงู ุจุฏุงุฆู ูุชุฒุงูู ุ ููุฌุจ ุฃู ูููู ููุงู ุจุฏุงุฆู ุบูุฑ ูุชุฒุงูู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-6/zk/8i/-6zk8ilnmdsonzd6zkafkcloqyi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุณูู ูุฐู ุงูุจุฏุงุฆูุฉ ุงูููุงุฉ: ุงููููุงุช ุงูุชู ุชุนูุด ูู ุงูุญุฒูุฉ </font></font><code>System.Threading.Channels</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ููููู ุฅูุดุงุก ูููุงุช ูููุงุฆู ุงูุชุธุงุฑ ุ ูุญุฏูุฏุฉ ูุบูุฑ ูุญุฏูุฏุฉ ุ ููููู ุงูุงูุชุธุงุฑ ุจุดูู ุบูุฑ ูุชุฒุงูู. ุนูุงูุฉ ุนูู ุฐูู ุ ููููู ุฅูุดุงุก ููุงุฉ ุจูููุฉ "ุตูุฑ" ุ ุฃู ุฃููุง ูู ุชุญุชูู ุนูู ูุฎุฒู ูุคูุช ุนูู ุงูุฅุทูุงู. ุชุณูู ูุฐู ุงููููุงุช ูููุงุช ุงูุงูุชูุงุก ููุชู ุงูุชุฑููุฌ ููุง ุจูุดุงุท ูู Go ู Kotlin. ููู ุญูุซ ุงููุจุฏุฃ ุ ุฅุฐุง ูุงู ูู ุงููููู ุงุณุชุฎุฏุงู ุงููููุงุช ูู ุฑูุฒ ุบูุฑ ูุชุฒุงูู ุ ููุฐุง ููุท ุฌูุฏ ุฌุฏูุง. ุฃู ุฃููุง ูุบูุฑ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุฅูู ุงูููุงุฉ ุญูุซ ุชูุฌุฏ ุทุฑู </font></font><code>ReadAsync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>WriteAsync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ProcessInParallel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ูุฌููุนุฉ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุชูุงุฒูุฉ ุงูุชู ุชููู ุจูุนุงูุฌุฉ ููู ูุชุญูููู ุฅูู</font></font><code>ProcessedFile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูู ูููู ุฃู ูุณุงุนุฏูุง ุงููุฒุงููุฉ ูู ุงููุชุงุจุฉ ููุณ ุฑูุฒูุง ุบูุฑ ูุชุฒุงูู ุ ูููู ุจุดูู ูุชูุงุฒู ุฃูุซุฑ ุชุนููุฏูุงุ</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุจุณูุท ุงูููุฏ ุงูููุงุฒู</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุฅุนุงุฏุฉ ูุชุงุจุฉ ุงูุฑูุฒ ุจูุฐู ุงูุทุฑููุฉ:</font></font><br>
<br>
<pre><code class="cs hljs">DataTable&lt;File, ProcessedFile&gt; sharedMemory;<font></font>
<font></font>
<span class="hljs-comment">// in any thread</span>
<span class="hljs-function"><span class="hljs-keyword">async</span> Task <span class="hljs-title">WorkerAsync</span>(<span class="hljs-params">...</span>)</span> {<font></font>
<font></font>
  File f = <span class="hljs-keyword">await</span> channel.ReadAsync();<font></font>
<font></font>
  ProcessedFile p = <span class="hljs-keyword">await</span> ProcessInParallelAsync(f);<font></font>
<font></font>
  <span class="hljs-keyword">lock</span> (_lock) { <font></font>
    sharedMemory.<span class="hljs-keyword">add</span>(f, p);<font></font>
  } <font></font>
}</code></pre><br>
<img src="https://habrastorage.org/webt/e0/zt/8u/e0zt8ud_8b4_wsiqsrd9_baalwy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููู ุชุจุฏู </font></font><code>ProcessInParallel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุฏููุง ููู. ุฃููุงู ุ ูููู ุจุชูุณูููุง ุฅูู lexemes ุ ููููู ุฃู ูููู ูุฏููุง ูููุชุงู ุจุงูุชูุงุฒู: ุจูุงุก ูุฎุงุจุฆ ุงูุจุญุซ ูุจูุงุก ุดุฌุฑุฉ ุจูุงุก ุงูุฌููุฉ. ุจุนุฏ ุฐูู ุชุฃุชู ูููุฉ "ุงูุจุญุซ ุนู ุงูุฃุฎุทุงุก ุงูุฏูุงููุฉ". ูู ุงูููู ููุง ุฃู ุชุดูู ูู ูุฐู ุงูููุงู ุฑุณููุง ุจูุงูููุง ูุง ุฏูุฑููุง ููุฌููุง. ุฃู ุฃูู ููููู ุชุดุบูู ุจุนุถ ุงูุฃุฌุฒุงุก ูู ุณูุงุณู ุฑุณุงุฆู ูุชูุงุฒูุฉ ุ ูุจุนุถูุง ูุง ูุณุชุทูุน ุฐูู ุ ูููุงู ุชุจุนูุงุช ูุงุถุญุฉ ูููููุฉ ุงูุชู ูุฌุจ ุฃู ุชูุชุธุฑ ููุงู ุฃุฎุฑู. ุชุญุตู ุนูู ุฑุณู ุจูุงูู ููุซู ูุฐู ุงูููุงู ุ ูุชุฑูุฏ ุฃู ุชุจุนุซุฑูุง ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู ุนูู ุทูู ุงูุฎููุท. ูู ูู ุงููููู ูุชุงุจุชูุง ุจุดูู ุฌููู ุจุฏูู ุฃุฎุทุงุกุ ูู ุฑูุฒูุง ุ ุชู ุญู ูุฐู ุงููุดููุฉ ุนุฏุฉ ูุฑุงุช ุ ูู ูู ูุฑุฉ ุจุทุฑููุฉ ูุฎุชููุฉ. ูุงุฏุฑุง ูุง ูุญุฏุซ ุนูุฏูุง ุชุชู ูุชุงุจุฉ ูุฐุง ุงูุฑูุฒ ุฏูู ุฃุฎุทุงุก.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xh/-h/3j/xh-h3jav69twzsqei3rrjbe2ymy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญุฏุฏ ุงูุฑุณู ุงูุจูุงูู ูููููุฉ ุนูู ุงููุญู ุงูุชุงูู: ุฏุนูุง ูููู ุฃู ูู ูููุฉ ููุง ููุงู ุฃุฎุฑู ุชุนุชูุฏ ุนูููุง ุ ุซู ุจุงุณุชุฎุฏุงู ูุงููุณ ExecuteBefore ููุชุจ ุงููููู ุงูุนุธูู ูุทุฑููุชูุง.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญููู ุงููููู ุงูุนุธูู</font></font></h3> <br>
<pre><code class="cs hljs">Dictionary&lt;Action&lt;ProcessedFile&gt;, Action&lt;ProcessedFile&gt;[]&gt; ExecuteBefore; <span class="hljs-function"><span class="hljs-keyword">async</span> Task&lt;ProcessedFile&gt; <span class="hljs-title">ProcessInParallelAsync</span>(<span class="hljs-params"></span>)</span> {
  <span class="hljs-keyword">var</span> res = <span class="hljs-keyword">new</span> ProcessedFile();<font></font>
<font></font>
<font></font>
  <span class="hljs-comment">// lots of work with toposort, locks, etc.</span><font></font>
<font></font>
  <span class="hljs-keyword">return</span> res; <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅุฐุง ููุช ุจุญู ูุฐู ุงููุดููุฉ ุจุดูู ูุจุงุดุฑ ุ ูุฃูุช ุจุญุงุฌุฉ ุฅูู ุฅุฌุฑุงุก ูุฑุฒ ุทูุจูููุฌู ููุฐุง ุงูุฑุณู ุงูุจูุงูู. </font><font style="vertical-align: inherit;">ุซู ุฎุฐ ูููุฉ ูุง ุชุญุชูู ุนูู ููุงู ุชุงุจุนุฉ ุ ููู ุจุชูููุฐูุง ุ ููู ุจุชุญููู ุงูุจููุฉ ุชุญุช ููู ุ ูุงุนุฑู ุฃู ููุงู ูุง ุชุญุชูู ุนูู ููุงู ุชุงุจุนุฉ. </font><font style="vertical-align: inherit;">ุงุฑูุถ ููุฒุนูู ุจุทุฑููุฉ ูุง </font></font><code>Task Runner</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ููุชุจูุง ุจุดูู ุฃูุซุฑ ุฅุญูุงูุง ููููุง: ุงููุฑุฒ ุงูุทูุจูููุฌู ููุฑุณู ุงูุจูุงูู + ุชูููุฐ ูุซู ูุฐู ุงูููุงู ุนูู ุฎููุท ูุฎุชููุฉ.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุบูุฑ ูุชุฒุงูู ูุณูู</font></font></h3><br>
<pre><code class="cs hljs">Dictionary&lt;Action&lt;ProcessedFile&gt;, Action&lt;ProcessedFile&gt;[]&gt; ExecuteBefore;
<span class="hljs-function"><span class="hljs-keyword">async</span> Task&lt;ProcessedFile&gt; <span class="hljs-title">ProcessInParallelAsync</span>(<span class="hljs-params"></span>)</span> {
  <span class="hljs-keyword">var</span> res = <span class="hljs-keyword">new</span> ProcessedFile();
  <span class="hljs-keyword">var</span> lazy = <span class="hljs-keyword">new</span> Dictionary&lt;Action&lt;ProcessedFile&gt;, Lazy&lt;Task&gt;&gt;(); 
  <span class="hljs-keyword">foreach</span> ((action, beforeList) <span class="hljs-keyword">in</span> ExecuteBefore)<font></font>
    lazy[action] = <span class="hljs-keyword">new</span> Lazy&lt;Task&gt;(<span class="hljs-keyword">async</span> () =&gt; <font></font>
    {<font></font>
      <span class="hljs-keyword">await</span> Task.WhenAll(beforeList.Select(b =&gt; lazy[b].Value)) 
      <span class="hljs-keyword">await</span> Task.Yield();<font></font>
      action(res);<font></font>
}<font></font>
  <span class="hljs-keyword">await</span> Task.WhenAll(lazy.Values.Select(l =&gt; l.Value)) 
  <span class="hljs-keyword">return</span> res;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงู ููุท ูุณูู </font></font><code>Async Lazy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ูููู ุจุฅูุดุงุก </font></font><code>ProcessedFile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุนูุงููุง ุงูุชู ูุฌุจ ุชูููุฐ ุงูุฅุฌุฑุงุกุงุช ุงููุฎุชููุฉ ุนูููุง. ุฏุนูุง ููุดุฆ ูุงููุณูุง: ุณูููู ุจุชูุณูู ูู ูุฑุญูุฉ ูู ูุฑุงุญููุง (Action ProcessedFile) ูู ุจุนุถ ุงูููุงู ุ ุฃู ุจุงูุฃุญุฑู ุ ุฅูู Lazy ูู Task ููุนูู ุนูู ุทูู ุงูุฑุณู ุงูุจูุงูู ุงูุฃุตูู. </font></font><code>action</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูููู </font><font style="vertical-align: inherit;">ูููุชุบูุฑ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฅุฌุฑุงุก</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุณู </font><font style="vertical-align: inherit;">ุ ููู ูุงุฆูุฉ ูุจู - ุชูู ุงูุฅุฌุฑุงุกุงุช ุงูุชู ูุฌุจ ุงูููุงู ุจูุง ูุจู ุนูููุง. ุซู ูู ุจุฅูุดุงุก </font></font><code>Lazy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู </font></font><code>action</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ููุชุจ ูู ุงููููุฉ </font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ูุฐูู ูุญู ููุชุธุฑ ูู ุงูููุงู ุงูุชู ูุฌุจ ุงูุฌุงุฒูุง ูุจููุง. ูู ูุงุฆูุฉ ูุจู ุ ุญุฏุฏ ุงููุงุฆูุฉ </font></font><code>Lazy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุฌูุฏุฉ ูู ูุฐุง ุงููุงููุณ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฑุฌู ููุงุญุธุฉ ุฃูู ููุง ูู ูุชู ุชูููุฐ ุฃู ุดูุก ุจุดูู ูุชุฒุงูู ุ ูุฐูู ูู ููุน ูุฐุง ุงูุฑูุฒ </font></font><code>ItemNotFoundException in Dictionary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ูููู ุจุชูููุฐ ุฌููุน ุงูููุงู ุงูุชู ูุงูุช ูุจููุง ุ ููููู ุจุงูุจุญุซ ุนู ุทุฑูู ุงูุนูู</font></font><code>Lazy Task</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุซู ูููู ุจุชูููุฐ ุนูููุง. </font><font style="vertical-align: inherit;">ูู ุงูููุงูุฉ ุ ูุง ุนููู ุณูู ุฃู ุชุทูุจ ูู ูู ูููุฉ ุฃู ุชุจุฏุฃ ุ ูุฅูุง ููู ุชุนุฑู ุฃุจุฏูุง ูุง ุฅุฐุง ูุงู ููุงู ุดูุก ูู ูุจุฏุฃ. </font><font style="vertical-align: inherit;">ูู ูุฐู ุงูุญุงูุฉ ุ ูู ูุจุฏุฃ ุดูุก. </font><font style="vertical-align: inherit;">ูุฐุง ูู ุงูุญู. </font><font style="vertical-align: inherit;">ุชุชู ูุชุงุจุฉ ูุฐู ุงูุทุฑููุฉ ูู 10 ุฏูุงุฆู ุ ููู ูุงุถุญุฉ ุชูุงููุง. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุงูุชุงูู ุ ุงุชุฎุฐ ุงูููุฏ ุบูุฑ ุงููุชุฒุงูู ูุฑุงุฑูุง ุ ุญูุซ ุงุญุชู ูู ุงูุจุฏุงูุฉ ุดุงุดุชูู ุจุฑูุฒ ุชูุงูุณู ูุนูุฏ. </font><font style="vertical-align: inherit;">ููุง ูู ุซุงุจุช ุชูุงูุง. </font><font style="vertical-align: inherit;">ุญุชู ุฃููู ูุง ุฃุณุชุฎุฏูู ุ ุจู </font></font><code>ConcurrentDictionary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุณุชุฎุฏูู ุงููุนุชุงุฏ </font></font><code>Dictionary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุฃููุง ูุง ููุชุจ ุฃู ุดูุก ุนููู ุจุดูู ุชูุงูุณู. </font><font style="vertical-align: inherit;">ููุฌุฏ ุฑูุฒ ุซุงุจุช ููุชุณู. </font><font style="vertical-align: inherit;">ูุญู ูุญู ูุดููุฉ ูุชุงุจุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุชูุงุฒูุฉ ุจุงุณุชุฎุฏุงู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุชุฒุงูู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจุดูู ุฌููู ุ ููุง ูุนูู - ุจุฏูู ุฃุฎุทุงุก.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฎูุต ูู ุงูุฃููุงู</font></font></h3><br>
<pre><code class="cs hljs">DataTable&lt;File, ProcessedFile&gt; sharedMemory;<font></font>
<font></font>
<span class="hljs-comment">// in any thread</span>
<span class="hljs-function"><span class="hljs-keyword">async</span> Task <span class="hljs-title">WorkerAsync</span>(<span class="hljs-params">...</span>)</span> {<font></font>
<font></font>
  File f = <span class="hljs-keyword">await</span> channel.ReadAsync();<font></font>
<font></font>
  ProcessedFile p = <span class="hljs-keyword">await</span> ProcessInParallelAsync(f);<font></font>
<font></font>
    <span class="hljs-keyword">lock</span> (_lock) {<font></font>
      sharedMemory.<span class="hljs-keyword">add</span>(f, p);<font></font>
   }<font></font>
 }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุณุชุญู ุงูุฃูุฑ ุนุฏู ุงูุงูุณุฌุงู ููุฐู ุงูุฃููุงูุ ุงูุขู ููุงู ูู ุฃููุงุน ุฃููุงู ูุชุฒุงููุฉ ุ ุฅุดุงุฑุงุช ุบูุฑ ูุชุฒุงููุฉ ุ ุฃู ูุญุงููุฉ ูุงุณุชุฎุฏุงู ุงูุจุฏุงุฆูุฉ ุงูููุฌูุฏุฉ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุชุฒุงููุฉ ูุบูุฑ ุงููุชุฒุงููุฉ. ูุจุฏู ุฃู ูุฐุง ุงูููููู ุฎุงุทุฆ ุ ูุฃูู ูุน ุงูููู ุ ุชุญูู ุดูุฆูุง ูู ุงูุชูููุฐ ุงููุชูุงุฒู. ูููุชูุง ูู ุชุฑุฌูุฉ ุงูุชูููุฐ ุงููุชูุงุฒู ุฅูู ูุชุณูุณู ุ ูุฃูู ุฃุณูู. ูุฅุฐุง ูุงูุช ุฃุจุณุท - ุฃุฎุทุงุก ุฃูู.</font></font><br>
<br>
<pre><code class="cs hljs">Channel&lt;Pair&lt;File, ProcessedFile&gt;&gt; output;
<span class="hljs-comment">// in any thread</span>
<span class="hljs-function"><span class="hljs-keyword">async</span> Task <span class="hljs-title">WorkerAsync</span>(<span class="hljs-params">...</span>)</span> {<font></font>
<font></font>
  File f = <span class="hljs-keyword">await</span> channel.ReadAsync();<font></font>
<font></font>
  ProcessedFile p = <span class="hljs-keyword">await</span> ProcessInParallelAsync(f);<font></font>
  <font></font>
  <span class="hljs-keyword">await</span> output.WriteAsync(); <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููููุง ุฅูุดุงุก ุจุนุถ ุงููููุงุช ููุถุน ููููู ูููู ูุนุงูุฌุฉ ุ ูููุงู </font></font><code>ReadAsync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฌุฑุงุกุงุช ุฃุฎุฑู ุณุชุนุงูุฌ </font><font style="vertical-align: inherit;">ูุฐู ุงูููุงุฉ </font><font style="vertical-align: inherit;">ุ ูุณุชูุนู ุฐูู ุจุงูุชุณูุณู. ููู ููุณู ุ ุจุงูุฅุถุงูุฉ ุฅูู ุญูุงูุฉ ุงููููู ุ ูููู ุจุดูู ุฃุณุงุณู ุจุชุฎุฒูู ุงููุตูู ุ ููู ููุงู ุชุตุจุญ ููู ุฌููุน ุงูุฎููุท ุงููุชุชุงููุฉ ูุชูุงุฒูุฉ. ููุณุชุจุฏู ูุฐุง ุจุดูู ุตุฑูุญ ุจุงูููุงุฉ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/q_/qe/mf/q_qemfc4mssz9shitqlekzee6nc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูููุฏุณุฉ ูู ููุง ููู: ูุชููู ุงูุนุงูููู ุงููููุงุช </font></font><code>input</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฑุณููููุง ูู ููุงู ูุง ุฅูู ุงููุนุงูุฌ ุ ูุงูุฐู ูุนุงูุฌ ุฃูุถูุง ูู ุดูุก ุจุงูุชุชุงุจุน ุ ููุง ููุฌุฏ ุชูุงุฒู. ูุจุฏู ุงูุฑูุฒ ุฃุณูู ุจูุซูุฑ. ุฃููู ุฃูู ูุง ูููู ูุนู ูู ุดูุก ุจูุฐู ุงูุทุฑููุฉ. ูุซู ูุฐู ุงูุจููุฉ ุ ุนูุฏูุง ููููู ุจูุงุก ุฃูุงุจูุจ ุงูุจูุงูุงุช ุ ูุง ุชุนูู ุฏุงุฆููุง.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7k/9j/sv/7k9jsvdwqbqrzgbejoozsk5lj_s.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฏ ูููู ูุฏูู ููุงุฉ ุซุงููุฉ ุชุฏุฎู ุฅูู ุงููุนุงูุฌ ุงูุฎุงุต ุจู ูููุณ ุงูุฑุณู ุงูุจูุงูู ุงูููุฌู ุบูุฑ ุงูุฏูุฑู ูุชููู ูู ุงููููุงุช ุ ูููู ุงูุฑุณู ุงูุจูุงูู ูุน ุฏูุฑุงุช. </font><font style="vertical-align: inherit;">ูุฐุง ูุซุงู ูุงูู ุฑููุงู ุฅููุฒุงุฑูู ูู KotlinConf ูู 2018. </font><font style="vertical-align: inherit;">ูุชุจ ูุซุงูุงู ุนูู Kotlin ูุน ูุฐู ุงููููุงุช ุ ููุงูุช ููุงู ุฏูุฑุงุช ููุงู ุ ูุชู ุฅุบูุงู ูุฐุง ุงููุซุงู. </font><font style="vertical-align: inherit;">ูุงูุช ุงููุดููุฉ ุฃูู ุฅุฐุง ูุงู ูุฏูู ูุซู ูุฐู ุงูุฏูุฑุงุช ูู ุงูุฑุณู ุงูุจูุงูู ุ ูุฅู ูู ุดูุก ูุตุจุญ ุฃูุซุฑ ุชุนููุฏูุง ูู ุงูุนุงูู ุบูุฑ ุงููุชุฒุงูู. </font><font style="vertical-align: inherit;">ุงููุขุฒู ุบูุฑ ุงููุชุฒุงููุฉ ุณูุฆุฉ ุญูุซ ูุตุนุจ ุญููุง ุฃูุซุฑ ูู ุงููุฒุงููุฉ ุนูุฏูุง ูููู ูุฏูู ูุฌููุนุฉ ูู ุงูุฎููุท ุ ููู ุงููุงุถุญ ูุง ูู ูุนูู. </font><font style="vertical-align: inherit;">ูุฐูู ุ ูู ุฃุฏุงุฉ ูุฌุจ ุงุณุชุฎุฏุงููุง ุจุดูู ุตุญูุญ.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฎุต</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฌูุจ ุงููุฒุงููุฉ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุบูุฑ ุงููุชุฒุงููุฉ.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฑูู ุงูุชุณูุณูู ุฃุจุณุท ูู ุงูุชูุงุฒู.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ุฃู ูููู ุงูุฑูุฒ ุบูุฑ ุงููุชุฒุงูู ุจุณูุทูุง ููุณุชุฎุฏู ุงูุญุฏ ุงูุฃุฏูู ูู ุงููุนููุงุช ูุณูุงููุง ุถููููุง ูุบูุฑ ุณูููู.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅุฐุง ููุช ูุฏ ุทูุฑุช ุนุงุฏุฉ ูุชุงุจุฉ ุฑูุฒ ูุชุฒุงูู ุ ูุญุชู ุฅุฐุง ูุงู ุงูุฑูุฒ ุบูุฑ ุงููุชุฒุงูู ูุดุงุจููุง ุฌุฏูุง ููุฑูุฒ ุงููุชุฒุงูู ุ ููู ุชุญุชุงุฌ ุฅูู ุณุญุจ ุงูุจุฏุงุฆู ููุงู ุ ูุงูุชู ุงุนุชุฏุช ุนูููุง ูู ุฑูุฒ ูุชุฒุงูู ูุซู </font></font><code>async mutex</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ุงุณุชุฎุฏู ุงูุฎูุงุตุงุช ุ ุฅู ุฃููู ุ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงูุจุฏุงุฆู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฃุฎุฑู </font><i><font style="vertical-align: inherit;">ูุชูุฑูุฑ ุงูุฑุณุงุฆู</font></i><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุฑูู ุงูุชุณูุณูู ุฃุจุณุท ูู ุงูุชูุงุฒู. ุฅุฐุง ูุงู ุจุฅููุงูู ูุชุงุจุฉ ุจููุชู ุจุญูุซ ุชุจุฏู ูุชุณูุณูุฉ ุ ุฏูู ุชุดุบูู ุฑูุฒ ููุงุฒู ูููู ุ ููู ุจูุชุงุจุฉ ุงูุจููุฉ ุจุงูุชุณูุณู.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุขุฎุฑ ุดูุก ุฑุฃููุงู ูู ุนุฏุฏ ูุจูุฑ ูู ุงูุฃูุซูุฉ ูุน ุงูููุงู. </font><font style="vertical-align: inherit;">ุนูุฏ ุชุตููู ุงููุธุงู ุงูุฎุงุต ุจู ุ ุญุงูู ุงูุงุนุชูุงุฏ ุจุดูู ุฃูู ุนูู ุงูุณูุงู ุงูุถููู. </font><font style="vertical-align: inherit;">ูุคุฏู ุงูุณูุงู ุงูุถููู ุฅูู ุณูุก ููู ููุง ูุญุฏุซ ูู ุงูุดูุฑุฉ ุ ูููููู ูุณูุงู ุงููุดุงูู ุงูุถูููุฉ ูู ุงูุณูุฉ. </font><font style="vertical-align: inherit;">ูุฅุฐุง ุนูู ุดุฎุต ุขุฎุฑ ุนูู ูุฐุง ุงูุฑูุฒ ูุฃุนุฏ ุดูุฆูุง ููู ุ ููุฏ ูุคุฏู ุฐูู ุฅูู ุตุนูุจุงุช ููุช ุชุนุฑููุง ุฐุงุช ูุฑุฉ ุ ููุง ูุนุฑู ุงููุจุฑูุฌ ุงูุฌุฏูุฏ ุจุณุจุจ ุงูุณูุงู ุงูุถููู. </font><font style="vertical-align: inherit;">ููุชูุฌุฉ ูุฐูู ุ ูุชููุฒ ุงูุชุตููู ุงูุถุนูู ุจุนุฏุฏ ูุจูุฑ ูู ุงููุนููุงุช ุ ููุฒูุฌูุง ูุณูุงููุง ุงูุถููู.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุฐุง ุชูุฑุฃ</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณุชูุฏ TAP</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูุฌูู ุบูุฑ ูุชุฒุงูู</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฏู ุงูุญูุงุฉ</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">medium.com/@elizarov/deadlocks-in-non-hierarchical-csp-e5910d137cc</font></font></a></li>
</ul><br>
<blockquote>     -10     .     DotNext   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> </a>.</blockquote></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar491218/index.html">ุฏูุฌ PVS-Studio ูู PlatformIO</a></li>
<li><a href="../ar491224/index.html">ุฃุชูุชุฉ ุฎุฏูุฉ ุงูุฅุฑุณุงู ุ ุฃู ููู ูููู ูุดุฑูุฉ ุฎุฏูุงุช ุฃู ุชููู ุชูุงููู ุงูููู ุจูุณุจุฉ 30ูช</a></li>
<li><a href="../ar491230/index.html">ููู ุฐูุจุช ุฅูู ุงููุฏุฑุณุฉ 21 ูุงููุดู ุนู ุงูุฃุณุฑุงุฑ</a></li>
<li><a href="../ar491232/index.html">RPA + ุงูุชุนูู ุงูุขูู = ุงูุฃุชูุชุฉ ุงูุฐููุฉ</a></li>
<li><a href="../ar491234/index.html">ุซูุงุซ ุญูู ููุนูู ูุน SOLIDWORKS ูููุฐุฌุฉ ุฃุฌุฒุงุก ุงูุทุจุงุนุฉ ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ</a></li>
<li><a href="../ar491238/index.html">ุชุญููู ุงูุดูุฑุฉ ุงููุฑุงุซูุฉ II</a></li>
<li><a href="../ar491240/index.html">ุงูุทุฑูู ุฅูู ุงูุบููู: ุฃูุณ ูุงูููู Adobe</a></li>
<li><a href="../ar491244/index.html">Ableton ุบูุฑ ูุทููุจ: ูู ุจุชูุตูู Ableton Push 2 ุจุญุงูู VCV</a></li>
<li><a href="../ar491246/index.html">ูุคุชูุฑ DEFCON 27. ุณูุงุฑุชู ูู ุณูุงุฑุชู. ุงูุฌุฒุก 2</a></li>
<li><a href="../ar491250/index.html">ูุตุงุจูุญ LED Gauss Basic</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>