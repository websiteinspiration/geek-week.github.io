<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶â üåª üï¥üèª Once again about 433 MHz transmitters and receivers ü•© ü§≥üèø üë®üèø‚Äçüöí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The simplest set of 433 MHz ISM receiver and transmitter has earned well-deserved popularity among electronics lovers. The kits are cheap (even in Chi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Once again about 433 MHz transmitters and receivers</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/491530/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The simplest set of </font><font style="vertical-align: inherit;">433 MHz </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ISM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> receiver and transmitter has </font><font style="vertical-align: inherit;">earned well-deserved popularity among electronics lovers. The kits are cheap (even in Chip-Deep you can buy them for 300 rubles, and on Ali, they say, generally for a fifty dollars), they are simple and reliable. In addition (which you probably do not suspect), this is the most long-range and penetrating method of wireless data exchange - a signal at a frequency of 433 MHz passes much better through obstacles and operates at a farther distance than in the popular 2.4 GHz band (433 MHz is </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">completely delayed by a</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wall of half a meter of concrete, and Wi-Fi is already dying by 10 centimeters). I admit that recently appeared </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">MBee-868</font></a><font style="vertical-align: inherit;"> modules</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Being equipped with an appropriate (directional) antenna, they ‚Äúshoot‚Äù further, but they are at least an order of magnitude more expensive, more difficult to connect, require energy-saving management and pre-configuration. </font><font style="vertical-align: inherit;">And in addition, the frequency of 868 MHz passes through obstacles twice as bad (although, of course, it is incomparably better than the frequency of 2.4 GHz). </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/a04/2bb/c3c/a042bbc3ca312c739041b507e7ca4b5e.png" width="500"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A lot has been written about 433 MHz transmitters and receivers (including on the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hub)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , of course. </font><font style="vertical-align: inherit;">However, it seems that no one knows how to correctly include this kit in the circuit for some strange reason. </font><font style="vertical-align: inherit;">When I once again read </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that the kit ‚Äú </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">took on 8 meters within line of sight, the 9th meter could not be mastered</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">", My patience snapped. </font><font style="vertical-align: inherit;">What other 8 meters ?! </font><font style="vertical-align: inherit;">At 40-50 I would have believed, although in reality, probably, the range is even greater.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is worth noting that I further solve the problem of creating a line for transferring arbitrary data, and not just controlling any smart sockets or motor model boats. My task is more complicated, but still the distance of reliable operation is much greater. Moreover, in such a task it is important not only and not so much the distance within the line of sight (it can serve only for comparison), but the ability to penetrate various obstacles.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
My kit works out of town at a distance of about 25-30 meters at an acute angle to the log wall, so that approximately one meter (in total) of walls and partitions, partially shielded by foil insulation, is in the signal path. At a much shorter distance, almost directly behind the wall, WiFi is already completely losing signal. In the city, the signal finishes from one end of a three-room city apartment to the other through two interior partitions, as well as from the balcony, where in a straight line between the transmitter and receiver at least 80 centimeters of brickwork and a plaster partition. I did not use any more expensive kit options mentioned in the above review.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An additional plus of the kit is that in pauses the transmitter does not consume anything, and without any special Sleep modes, simply by the principle of its device (the consumption current at rest is comparable to the collector leakage currents of a locked transistor, that is, about 100 nA). </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's see what the pitfalls are.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transmitter Connection</font></font></h2> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The transmitter (it is called FS1000A), as we see from its diagram below, is the simplest generator based on a 433 MHz SAW resonator. </font><font style="vertical-align: inherit;">The generator is assembled on transistor Q1, and the transistor Q2, on the basis of which digital data is supplied, is simply a key that connects the generator to power (to the GND bus) in the presence of a high level (logical unit) at the input. </font><font style="vertical-align: inherit;">Power can be from 5 to 12 volts, and, according to manufacturers, the higher the power, the farther the connection works.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/a21/50c/737/a2150c737eb648ed465e060aa2d178ae.png" width="400"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I have not noticed the fundamental advantages of increased nutrition as part of my task. Nevertheless, one should not neglect the fact that there are no special power requirements here, and with increased voltage the device will only work better. It is convenient to connect the transmitter directly to voltage from a 9-12 volt adapter, battery or a set of 6 batteries (Vin Arduino pin). With an unstabilized power supply, which can exceed 12 volts (as, for example, with batteries), I usually decouple the transmitter from the main circuit with a separate 9-volt stabilizer (you can use the simplest 78L09), and I do not see any difference in operation between the 9 and 12 volts. With Uno or Nano, you can use the built-in 5-volt stabilizer to power the controller itself and other circuits (for example, sensors)and for Mini (especially its cheap clones), I would advise you to put a separate 5-volt stabilizer, connecting it to the 5V pin.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It should be noted that recently transmitters have appeared that look somewhat non-standard (see. Fig. Below). It turned out that the absence of an L1 throttle (three-turn), from which only holes remained - a fiction, it was simply replaced by the corresponding SMD component. Worse in this option is different: sloppy printing can be misleading regarding the connection of data pins and power. The correct connection is shown in the figure, it is the same for all options:</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/db4/cfc/e17/db4cfce176c768cc5f3504edfbf91513.png" width="250"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The most striking thing in this matter is that when the data and power are mixed up, the transmitter continues to work over short distances! </font><font style="vertical-align: inherit;">If you look at the circuit, you will understand what it is: the Q2 base through the resistor is connected to the power supply, the transistor is always open, and does not affect the operation of the circuit. </font><font style="vertical-align: inherit;">A logical high level on the power bus just powers the generator at the right time. </font><font style="vertical-align: inherit;">The absurdities begin at some distance - it is clear that from a logical conclusion, the power source is bad.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Receiver connection</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When purchasing a receiver (it may be called MX-RM-5V or XD-RF-5V), pay attention to the length of the terminals - I somehow came across a whole batch with shortened pins, which caused the </font><font style="vertical-align: inherit;">receiver to fall out </font><font style="vertical-align: inherit;">of the standard </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PBS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> connector </font><font style="vertical-align: inherit;">at the slightest distortion and its I had to specifically attach to the board. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The receiver circuit is much more complicated (I will not play it, but you can find it, for example, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). It should receive and amplify a high-frequency signal, filter out the frequency of 433 MHz, isolate bursts and convert them to logical levels. The receiver has a tuning choke (in the middle of the board), but without accurate instruments for measuring the amplitude-frequency characteristics, I do not recommend twisting it - most likely, you will not improve anything, but only spoil it.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since already at a small distance the signal will be much less interference, it is clear that we must deal with interference on all fronts: and circuitry and software methods. Libraries do the last thing for us, but no matter what mathematics are used in software processing, it is advisable to do everything first so that the logical unit at the output appears only when a useful signal bursts and does not appear in the presence of interference. In other words, it would be nice to tune out to the maximum in advance from interference during reception.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The standard method of noise reduction, known in my time to every student who has assembled at least one radio or amplifier, is that for nodes that are sensitive to interference, it is necessary to make a separate power supply, isolated to the maximum from other circuits. You can do it in different ways: once you installed a separate zener diode, now they often isolate the power of a problem node with an LC filter (this is recommended, for example, for ADCs, see datasheets for AVR controllers). But in our conditions, when modern components are small and cheap, it is easier to just put a stabilizer separate from the rest on the receiver.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/bd3/85b/94a/bd385b94af583fa8c188053297965c1b.png" width="400"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A stabilizer, for example, of type LP2950-5.0 plus two necessary capacitors for it in the cheapest option (when both capacitors are ceramic, in the range of 1-3.3 microfarads) will add sixty maximum to the cost of your circuit. But I prefer not to save: at the output I put an ordinary ceramic, and at the input I put an electrolyte (10‚Äì100 ŒºF), moreover, solid-state (polymer) or tantalum. Ceramic capacitors can be dispensed with both there and there, if the input voltage of 7-12 volts comes from battery-batteries or from another analog stabilizer. Pulsed stabilized sources and the simplest unstabilized rectifiers require additional filtering. You can use cheap aluminum electrolyte if you put a ceramic 0.1 microfarad parallel to it,it is even better to put a series inductance at the input of several fractions or units of milligenri.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The stabilizer should be installed directly near the receiver, the length of the conductors should be minimal. Instead of the LP2950, ‚Äã‚Äãyou can take the LM2931 or similar with a small pass-through voltage (this is especially important if the circuit is powered by batteries - for a regular LM78L05, the input voltage should be at least 7.5, and preferably 8-9 volts).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comparing with the case of powering the receiver directly from Arduino, as recommended in all publications (I have not seen exceptions), you will be amazed at the effect obtained - the range and ability to penetrate through the walls immediately increases significantly. The receiver, together with the stabilizer, can be carried out in a separate small box for convenience. You can connect its output to the controller in the main body with any three-wire wire (two power supplies and a signal conductor) up to 3 meters long, and maybe more. This is more convenient because antennas are still needed, and according to the rules it will be better if they are parallel to each other in space, and large cases cannot always be placed so that the antennas stick out in the right orientation.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the simplest version, as antennas, you can do with scraps of single-core wire with a cross section of at least 0.5 mm and a length of 17 cm ¬± 1-3 mm. </font><font style="vertical-align: inherit;">Do not use stranded mounting wire! </font><font style="vertical-align: inherit;">More compact spiral antennas are on sale, but I personally have not tested their effectiveness. </font><font style="vertical-align: inherit;">The antenna tip of both the transmitter and the receiver is sealed into the corresponding hole in the corner of the board (make no mistake in the upgraded version of the transmitter - the word ANT is also out of place there, see fig. Above).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Generation and processing of transmitted data</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is the second major drawback of most reviews on our topic: the authors confine themselves to some local problem, without formulating it in a general way, like transferring arbitrary data in one package. As you understood from the description above, only a simple sequence of bits can be transmitted by our set. The standard </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VirtualWire</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> library </font><font style="vertical-align: inherit;">encodes them in a special way (each tetrad is encoded with 6 bits, a synchronization header is added in front, and a checksum for the entire packet is added) and turns the output into a more familiar sequence of bytes. But the programmer already has to deal with it on his own.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Further, we assume that the transmitter and receiver are connected to the Arduino. In addition to VirtualWire, in connection with the boom of ‚Äúsmart homes‚Äù, there are many other things like RC-Switch or RemoteSwitch, but they are focused on other tasks, and it is clearly not worth using them to transfer arbitrary data. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The maximum length of a single message in VirtualWire is 27 bytes (see the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). The transmission of one complete message (it is automatically supplemented with a signature 0xb38, a message length value and a checksum) at my chosen speed of 1200 bps is 0.35 seconds.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The more, by the way, the selected transmission speed, the transmission range will be less. From the experience of using RS-232, it is known that with increasing range, the permissible transmission speed exponentially decreases: at a speed of 19,200 an unshielded line runs for 15 meters, at 9600 - 150 meters, and at a speed of 1200 - more than a kilometer. It would be interesting to experimentally find out the nature of this dependence for our case, because a lot here depends on the mathematics used. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Initializing the transmitter in VirtualWire looks like this:</font></font><br>
<br>
<pre><code class="cpp hljs">. . . . .
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;VirtualWire.h&gt;</span></span><font></font>
. . . . .<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{<font></font>
  vw_setup(<span class="hljs-number">1200</span>); <span class="hljs-comment">//   VirtualWire</span>
  vw_set_tx_pin(<span class="hljs-number">10</span>);   <span class="hljs-comment">//   VirtualWire D10</span><font></font>
. . . . .<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will analyze the principles of data generation using a specific example. Let us have a remote temperature-humidity sensor. It gives values ‚Äã‚Äã(temperature and humidity variables) in the form of a real number with a sign (float). To make it easier to understand at the receiving end, we will all reduce to a positive integer with the number of decimal places at least 4, translate the bits individually into ASCII characters, transfer the resulting string, and perform reverse operations at the receiving end. Of course, you can simplify the task (for example, do without conversion to ASCII and shorten the numbers), but in this form it turns out to be the same for almost any kind of digital data, which simplifies disassembly when receiving. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In practice, it is convenient to use the String type to compose a message, something like this:</font></font><br>
<br>
<pre><code class="cpp hljs">. . . . .
<span class="hljs-comment">//    </span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ledPin 13 <span class="hljs-comment">//  (D13,  19 ATmega) </span></span>
<span class="hljs-keyword">char</span> msg[<span class="hljs-number">13</span>];
<span class="hljs-keyword">volatile</span> <span class="hljs-keyword">int</span> tmpr=<span class="hljs-number">0</span>;
<span class="hljs-keyword">volatile</span> <span class="hljs-keyword">int</span> hum=<span class="hljs-number">0</span>;<font></font>
. . . . .<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{<font></font>
  delay(<span class="hljs-number">1000</span>); <span class="hljs-comment">// 1 c</span>
<span class="hljs-keyword">float</span> temperature;
<span class="hljs-keyword">float</span> humidity;<font></font>
. . . . .  <span class="hljs-comment">//   temperature  humidity  </span>
<span class="hljs-comment">//       4 :</span>
  tmpr = temperature*<span class="hljs-number">10</span>+<span class="hljs-number">2731</span>; <span class="hljs-comment">//2731 =     </span>
<span class="hljs-comment">//    4 :</span>
  hum = humidity*<span class="hljs-number">10</span>+<span class="hljs-number">1000</span>; 
<span class="hljs-comment">//  :</span>
  digitalWrite (ledPin,HIGH); <span class="hljs-comment">//  ‚Äî  </span>
  String strMsg=<span class="hljs-string">"DAH"</span>; <span class="hljs-comment">// - </span>
  strMsg+=tmpr; <span class="hljs-comment">//  </span>
  strMsg+=hum; <span class="hljs-comment">// </span>
  strMsg.toCharArray(msg,<span class="hljs-number">12</span>); <span class="hljs-comment">//   , 12 ‚Äì  </span>
<span class="hljs-comment">//  :</span>
  vw_send((<span class="hljs-keyword">uint8_t</span> *)msg, <span class="hljs-built_in">strlen</span>(msg)); <span class="hljs-comment">//  </span>
  vw_wait_tx(); <span class="hljs-comment">//   </span>
  delay(<span class="hljs-number">500</span>); <span class="hljs-comment">// 500 </span>
  digitalWrite (ledPin, LOW); <span class="hljs-comment">//  ‚Äî  </span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you need to transfer more accurate numbers with a large number of digits, then you simply increase the length of the msg array. The global ‚Äúvolatile‚Äù variables tmpr and hum are needed if you average several readings, otherwise they can also be declared local inside the loop () function. The message, as you see, consists of converted temperature and humidity values, in ASCII strings of four bytes each, preceded by a string of three ‚ÄúDAH‚Äù characters (characters can be any other from the ASCII table). This is a signature that will allow you to distinguish this message from among the possible others sent by similar devices. Do not neglect the signature, even if you believe that other devices nearby in this range are not expected, at the same time it serves as an additional guarantee of the integrity of the received data.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Note also that when converting a string to an array, you must specify one character more than the total length of the message (3 + 4 + 4 = 11), this takes into account the zero character that closes the string. </font><font style="vertical-align: inherit;">And the size of the msg [] array must be specified with a margin and can be any, in this case from 13 to 27 bytes. </font><font style="vertical-align: inherit;">When transferring, it will still be sent exactly as much as the strlen (msg) function will return, that is, 11 bytes + a null character. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the receiving part, the resulting array of ASCII codes will have to be parsed. </font><font style="vertical-align: inherit;">But first you need to accept it. </font><font style="vertical-align: inherit;">To initialize the reception, the following actions are performed:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;VirtualWire.h&gt;</span></span>
<span class="hljs-keyword">char</span> str[<span class="hljs-number">5</span>];     ASCII  
  <span class="hljs-keyword">uint8_t</span> buf [VW_MAX_MESSAGE_LEN];  <span class="hljs-comment">//    </span>
  <span class="hljs-keyword">uint8_t</span> buflen = VW_MAX_MESSAGE_LEN;  <span class="hljs-comment">// max   </span><font></font>
. . . . .<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{<font></font>
  vw_set_rx_pin(<span class="hljs-number">2</span>); <span class="hljs-comment">//D2   VirtualWire</span>
  vw_setup(<span class="hljs-number">1200</span>); <span class="hljs-comment">//   VirtualWire</span><font></font>
. . . . .<font></font>
} <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Actually, the technique with parsing a line is this:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{<font></font>
  vw_rx_start();  <span class="hljs-comment">//  </span>
  buflen = VW_MAX_MESSAGE_LEN; <span class="hljs-comment">//    </span>
 <span class="hljs-keyword">if</span> (vw_have_message()) { <span class="hljs-comment">// </span>
 <span class="hljs-keyword">if</span> (vw_get_message(buf, &amp;buflen)) <span class="hljs-comment">//   </span><font></font>
  {<font></font>
    vw_rx_stop(); <span class="hljs-comment">//   :</span>
        <span class="hljs-keyword">for</span> (byte i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">3</span>; i++)  <span class="hljs-comment">//    </span>
                str[i]= buf[i]; <span class="hljs-comment">// </span>
                str[<span class="hljs-number">3</span>]=<span class="hljs-string">'\0'</span>;
      <span class="hljs-keyword">if</span> ((str[<span class="hljs-number">0</span>]==<span class="hljs-string">'D'</span>)&amp;&amp;(str[<span class="hljs-number">1</span>]==<span class="hljs-string">'A'</span>)&amp;&amp;(str[<span class="hljs-number">2</span>]==<span class="hljs-string">'H'</span>)) {
<span class="hljs-comment">// ,  </span>
       <span class="hljs-keyword">for</span> (byte i=<span class="hljs-number">3</span>;i&lt;<span class="hljs-number">7</span>;i++)  <span class="hljs-comment">//    </span>
                str[i<span class="hljs-number">-3</span>]= buf[i]; <span class="hljs-comment">//    </span>
      <span class="hljs-keyword">int</span> tmpr=atoi(str); <span class="hljs-comment">//   </span>
      tmpr=tmpr<span class="hljs-number">-2731</span>; <span class="hljs-comment">// 2731,     </span>
. . . . .<span class="hljs-comment">//    10    float,  </span>
. . . . . <span class="hljs-comment">//    -</span>
<span class="hljs-comment">// :</span>
      <span class="hljs-keyword">for</span> (byte i=<span class="hljs-number">7</span>;i&lt;<span class="hljs-number">11</span>;i++)  <span class="hljs-comment">//    </span>
                str[i<span class="hljs-number">-7</span>]= buf[i]; <span class="hljs-comment">//    </span>
      <span class="hljs-keyword">int</span> hh = atoi(str); <span class="hljs-comment">//   </span>
      hh=(hh<span class="hljs-number">-1000</span>)/<span class="hljs-number">10</span>;
      <span class="hljs-keyword">if</span> (hh&gt;<span class="hljs-number">99</span>) hh=<span class="hljs-number">99</span>; <span class="hljs-comment">//   %,  </span>
. . . . . <span class="hljs-comment">// -</span>
   } <span class="hljs-comment">//end   DAT</span>
  } <span class="hljs-comment">//end  </span>
 } <span class="hljs-comment">// </span>
} <span class="hljs-comment">// end loop</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I hope you now have fewer questions about using these cheap and easy-to-use devices.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en491518/index.html">News from the world of OpenStreetMap No. 501 (02/18/2020/24/02/2020)</a></li>
<li><a href="../en491520/index.html">Convert xls to xlsx and xml in C #</a></li>
<li><a href="../en491522/index.html">Why do women live longer</a></li>
<li><a href="../en491524/index.html">Stas Afanasyev. Juno. Pipelines based on io.Reader / io.Writer. Part 2</a></li>
<li><a href="../en491528/index.html">My experience is conducting 1000 interviews. Synopsis of the report by Yegor Bugaenko</a></li>
<li><a href="../en491532/index.html">Laravel + Docker + Gitlab. Where to begin</a></li>
<li><a href="../en491534/index.html">A Brief Guide to Using GDB</a></li>
<li><a href="../en491536/index.html">YouTube - Error. Please try again later. Playback ID: <...></a></li>
<li><a href="../en491538/index.html">Sprawl Lemmas for Regular and Context-Free Languages</a></li>
<li><a href="../en491540/index.html">Networks for a novice IT specialist. Mandatory base</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>