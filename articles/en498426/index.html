<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçü§ù‚Äçüë®üèº ‚åöÔ∏è üîç How we evacuated the duty shift of Yandex üë©üèæ‚Äçüî¨ üòÇ üêñ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When the work fits in one laptop and can be performed autonomously from other people, then there is no problem moving to a remote location - just stay...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>How we evacuated the duty shift of Yandex</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/498426/"><img src="https://habrastorage.org/webt/as/kx/qr/askxqrmenpitf9-j1es44_nly14.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When the work fits in one laptop and can be performed autonomously from other people, then there is no problem moving to a remote location - just stay at home in the morning. </font><font style="vertical-align: inherit;">But not everyone was so lucky. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Duty Shift is a team of Service Availability Specialists (SRE). </font><font style="vertical-align: inherit;">It includes duty administrators, developers, managers, as well as a common ‚Äúdashboard‚Äù of 26 LCD panels of 55 inches each. </font><font style="vertical-align: inherit;">The stability of the company's services and the speed of solving problems depend on the work of the shift on duty. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Today Dmitry Melikov</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tal10n</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, the shift supervisor, will talk about how they managed to transport equipment to their homes and establish new work processes in a matter of days. </font><font style="vertical-align: inherit;">I give him the floor.</font></font><br>
<br>
<a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- When you have an endless supply of time, you can comfortably move with anything anywhere. </font><font style="vertical-align: inherit;">But the rapid spread of coronavirus put us in completely different conditions. </font><font style="vertical-align: inherit;">Yandex employees were among the first to switch to remote work - even before the introduction of the self-isolation regime. </font><font style="vertical-align: inherit;">It happened like this. </font><font style="vertical-align: inherit;">On Thursday, March 12, I was asked to evaluate the opportunity to transfer the team‚Äôs work to home. </font><font style="vertical-align: inherit;">On Friday the 13th there was a recommendation to switch to remote work. </font><font style="vertical-align: inherit;">Everything was ready for us on the night of Tuesday, March 17: duty officers work at home, equipment was transported, missing software was written, processes were reconfigured. </font><font style="vertical-align: inherit;">And now I‚Äôll tell you how we did it. </font><font style="vertical-align: inherit;">But first you need to remember those tasks that are solved by the shift on duty.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Who we are</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yandex is a large company with hundreds of services. The stability of the search, voice assistant and all other products depends not only on the developers. The data center may interrupt the power supply. A worker may accidentally damage an optical cable while replacing asphalt. Or there may be a surge in user activity, which will require an urgent reallocation of power. Moreover, we all live in a large, complex infrastructure, and the release of one of the products may accidentally lead to the degradation of the other.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
26 panels in our open space are one and a half thousand alerts and more than one hundred charts and panels of our services. In fact, this is a huge diagnostic panel. An experienced duty administrator, looking at her, quickly understands the status of important nodes and can establish a direction for investigating a technological problem. This does not mean that a person should constantly look at all the devices: the automation itself will attract attention by sending a notification to the special interface of the person on duty, but without a visual panel, the solution to the problem may be delayed. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When problems arise, the attendant first assesses their priority. He then isolates the problem or minimizes its impact on users.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are several standard ways to isolate a problem. One of them is the degradation of services, when the administrator on duty disables some of the functions that users least notice. This allows you to temporarily reduce the load and figure out what happened. If there is a problem with the data center, then the attendant contacts the operation team, understands the problem, monitors the timing of its solution and, if necessary, connects specialized teams. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When the administrator on duty cannot isolate the problem that arose due to the release, he reports it to the service team - and the developers look for errors in the new code. If they are not able to figure it out, then the administrator attracts developers from other products or engineers for the availability of services.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I can talk for a long time about how everything is arranged with us, but I think that I have already conveyed the essence. </font><font style="vertical-align: inherit;">The duty shift coordinates the work of all services and controls global problems. </font><font style="vertical-align: inherit;">It is important for the administrator on duty to have a diagnostic panel in front of the eyes. </font><font style="vertical-align: inherit;">That's why when switching to remote work, you can‚Äôt just take and give everyone a laptop. </font><font style="vertical-align: inherit;">Charts and alerts do not fit on the screen. </font><font style="vertical-align: inherit;">What to do?</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Idea</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the office, all ten on-duty administrators work in shifts behind one dashboard, which includes 26 monitors, two computers, four NVIDIA Quadro NVS 810 video cards, two uninterruptible power supply units and several independent network accesses. But we needed to provide everyone with the opportunity to work at home. It just won‚Äôt work to assemble such a wall in the apartment (my wife will be especially happy about this), so we decided to create a portable version that can be brought and assembled at home. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We started experimenting with the configuration. We needed to fit all the devices on fewer displays, so the main requirement for the monitor was a high pixel density. Of the 4K monitors available in our environment, Lenovo P27u-10 was chosen for testing.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
From laptops they took a 16-inch MacBook Pro. </font><font style="vertical-align: inherit;">It has a fairly powerful graphics subsystem, necessary for rendering pictures on several 4K displays, and four universal Type-C connectors. </font><font style="vertical-align: inherit;">You may ask: why not a desktop? </font><font style="vertical-align: inherit;">Replacing a laptop with exactly the same from a warehouse is much easier and faster than assembling and configuring an identical system unit. </font><font style="vertical-align: inherit;">Yes, and it weighs less. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now it was necessary to understand how many monitors we could actually connect to the laptop. </font><font style="vertical-align: inherit;">And the problem here is not the number of connectors, we could find out only by testing the complete system.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/6i/oe/tn/6ioetnysrbrhlu7qi03q5uorozy.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testing</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We quite comfortably placed all the charts and alerts on four monitors and even connected them to a laptop, but we ran into a problem. Rendering 4 √ó 4K pixels on the connected monitors so loaded the video card that the laptop was discharged even while charging. Fortunately, the problem was solved with the help of the Lenovo ThinkPad Thunderbolt 3 Dock Gen 2 docking station. We managed to connect a monitor, power, and even a favorite mouse with a keyboard to the docking station.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But immediately another problem surfaced: the GPU puffed so much that the laptop overheated, which meant that the battery also overheated, which as a result went into protective mode and stopped taking charge. In general, this is a very useful mode that protects against dangerous situations. In some cases, the problem was solved with the help of a high-tech device - a ballpoint pen, placed under a laptop to improve ventilation. But this did not help everyone, so we also twisted the speed of a regular fan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There was another unpleasant feature. </font><font style="vertical-align: inherit;">All charts and alerts should be located in a strictly defined place. </font><font style="vertical-align: inherit;">Imagine that you are piloting a plane to land ‚Äî and here the speed indicators, altimeters, variometers, horizon indicators, compasses and position indicators begin to resize and jump to different places. </font><font style="vertical-align: inherit;">So we decided to make an application that will help with this. </font><font style="vertical-align: inherit;">In one evening, we wrote it on Electron.js, taking a ready-made </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for creating and managing windows. </font><font style="vertical-align: inherit;">We added a configuration handler and their periodic updating, as well as support for a limited number of monitors. </font><font style="vertical-align: inherit;">A little later, we added support for various setups.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assembly and delivery</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By Monday, helpdesk wizards had got 40 monitors, ten laptops, and as many docking stations for us. I don‚Äôt know how they did it, but thank you very much. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/y5/ig/_i/y5ig_i-32ogwdzgodtoghqxtkvs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It remained to carry all this to the apartments of duty administrators. And these are ten addresses in different parts of Moscow: south, east, center, and also Balashikha, to which there are 45 kilometers from the office (by the way, an intern from Serpukhov was also added later). It was necessary to somehow distribute all this between people, to build logistics.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I drove all the addresses on our Maps, there is still the opportunity to optimize the route between different points (I used the free beta version of the tool for couriers). </font><font style="vertical-align: inherit;">We broke up our team into four independent teams of two people, each got its own route. </font><font style="vertical-align: inherit;">My car was the most capacious, so I took the equipment for four employees at once. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/l0/fa/sl/l0faslaayow0ip3rkaglz9nfmhm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The entire delivery took a record three hours. </font><font style="vertical-align: inherit;">We left the office at ten in the evening on Monday. </font><font style="vertical-align: inherit;">At one in the morning I was already at home. </font><font style="vertical-align: inherit;">That same night we went on duty with new equipment.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is the result</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instead of one large diagnostic console, we collected ten relatively portable ones in the apartment of each person on duty. </font><font style="vertical-align: inherit;">Of course, it remained to settle down some little things. </font><font style="vertical-align: inherit;">For example, earlier we had one ‚Äúiron‚Äù telephone of the person on duty for notifications. </font><font style="vertical-align: inherit;">In the new conditions, this did not work, so we came up with ‚Äúvirtual phones‚Äù for those on duty (in fact, channels in the messenger). </font><font style="vertical-align: inherit;">There were other changes. </font><font style="vertical-align: inherit;">But the main thing is that in record time we managed to transfer not just people, reducing the risk of infection, but all our work at home without harm to the processes and stability of the products. </font><font style="vertical-align: inherit;">In this mode, we have been working for a month. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Below you will find photos of the real jobs of our attendants.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pc/mi/rj/pcmirjydwy5emc9qvy76fshoune.png"><br>
<br>
<img src="https://habrastorage.org/webt/jl/mm/v_/jlmmv_hymx3mh7aiyvda2noqbwk.png"><br>
<br>
<img src="https://habrastorage.org/webt/-b/5w/nz/-b5wnzqoyqixrodue2opshmjgnw.png"><br>
<br>
<img src="https://habrastorage.org/webt/xh/3u/wx/xh3uwxiartgspsynry7c9ufxfzs.png"><br>
<br>
<img src="https://habrastorage.org/webt/ll/a0/f0/lla0f0dinjjmlwsytvp7krxsbni.png"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en498406/index.html">How the personality of a brilliant young programmer was destroyed</a></li>
<li><a href="../en498410/index.html">Vivaldi for PC and Vivaldi for Android - Team game with score 3.0</a></li>
<li><a href="../en498412/index.html">Consciousness is simple or what's wrong with time</a></li>
<li><a href="../en498416/index.html">Yandex will automatically link the card to another account</a></li>
<li><a href="../en498418/index.html">Implementing WebRTC in a media server - practice and policy</a></li>
<li><a href="../en498428/index.html">WAL-G: new features and community expansion. Georgy Rylov</a></li>
<li><a href="../en498430/index.html">What happens to transport on April 22</a></li>
<li><a href="../en498436/index.html">GitLab CI / CD Guide for the (almost) Absolute Beginner</a></li>
<li><a href="../en498438/index.html">8 easy questions for internship mentors</a></li>
<li><a href="../en498440/index.html">Threat Spotlight: Neshta File Virus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>