<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚸 🕺 👨🏽‍🍳 تقليل بنسبة 60٪ في حجم تطبيق React الأصلي في بضع خطوات بسيطة 🚠 ✏️ 🎍</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="أعمل في Mutual . تعمل في البرازيل في مجال المساواة في الائتمان. نحن نساعد المقترضين والمقرضين على التواصل مع بعضهم البعض. الأول يبحث عن رهانات جيدة ، ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>تقليل بنسبة 60٪ في حجم تطبيق React الأصلي في بضع خطوات بسيطة</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/502422/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أعمل في </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mutual</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">تعمل في البرازيل في مجال المساواة في الائتمان. </font><font style="vertical-align: inherit;">نحن نساعد المقترضين والمقرضين على التواصل مع بعضهم البعض. </font><font style="vertical-align: inherit;">الأول يبحث عن رهانات جيدة ، بينما يبحث الأخير عن دخل يتجاوز ما يمكن للسوق أن يقدمه لهم. </font><font style="vertical-align: inherit;">يتم استخدام منتجاتنا من قبل مجموعة واسعة من المستخدمين ، ونحن نعمل في بلد كبير. </font><font style="vertical-align: inherit;">ونتيجة لذلك ، يتم تنزيل تطبيقات iOS و Android القائمة على React Native إلى أجهزة مختلفة جدًا.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/59/3g/lf/593glf1nnlud4u0pbaogbghegiy.jpeg"></a><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وتجدر الإشارة إلى أن الجزء الأكبر من المستخدمين يقومون بتثبيت التطبيقات على أجهزة الميزانية. </font><font style="vertical-align: inherit;">يمكننا استخلاص مثل هذه الاستنتاجات باستخدام البيانات من مكتبة Facebook </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">على مدار العام</font></a><font style="vertical-align: inherit;"> .</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">هذه المكتبة ، بعد أن تلقت معلومات حول طراز الجهاز ، تقارير في أي عام يعتبر هذا الجهاز هاتفًا رائدًا راقيًا. </font><font style="vertical-align: inherit;">على سبيل المثال ، الهاتف الأكثر شعبية بين مستخدمينا هو Samsung Galaxy A10. </font><font style="vertical-align: inherit;">هذا الهاتف ، على الرغم من أنه تم إصداره في عام 2019 ، يمكن اعتباره الرائد فقط في عام 2013. تحليل البيانات على أجهزة المستخدم ، يمكننا القول أنه يمكن التعرف على 85 ٪ من هذه الأجهزة كأجهزة متطورة فقط في عام 2015 أو قبل ذلك. </font><font style="vertical-align: inherit;">ولهذا السبب ، لدينا متطلبات خاصة لتحسين تطبيق الهاتف المحمول الخاص بنا. </font><font style="vertical-align: inherit;">الهدف من التحسين هو أنه حتى المستخدمين الذين لديهم أجهزة ضعيفة يمكنهم استخدام تطبيقنا بشكل مريح.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1e2/e6b/cf3/1e2e6bcf354e0ed85e47f70b1570dbba.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">النسبة المئوية للأجهزة التي يمكن التعرف عليها كرائدة في عام معين</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في هذا الصدد ، أولىنا اهتمامًا كبيرًا بحجم التطبيق. في حالة إصدار Android الخاص به ، كان 26.8 ميغابايت. على الرغم من أن هذا ليس حجمًا كبيرًا ، إلا أنه بالتأكيد أكبر من الحجم المتوسط ​​لتطبيقات المستخدمين. هذا الرقم ، وفقًا لـ Google Play Console ، هو 16.3 ميغابايت. يمكن أن يكون حجم التطبيق عاملاً حاسماً للمستخدمين ذوي خطط التعريفات المحدودة ، أو لأولئك الذين لديهم أجهزة ذاكرة منخفضة ، مما يجبر المستخدمين على اختيار التطبيقات التي سيقومون بتثبيتها بعناية. نتيجة لذلك ، يجب إلغاء تثبيت بعض التطبيقات. هذا مهم بشكل خاص في حالة التطبيق المتبادل ، حيث يدفع المقترضون أقساط شهرية من خلال هذا التطبيق. عندما يقوم المقترض بإلغاء تثبيت طلبنا ، فإن فرص قيامه بالدفع في الوقت المحدد تقل بشكل كبير.وهذا يؤثر بشكل مباشر على أرباح المستثمرين باستخدام منصتنا.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/72c/cea/78e/72ccea78ee7c05e86b626c0cf6ea45ef.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">حجم التطبيق المتبادل أكبر بكثير من متوسط ​​حجم</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
تطبيقات</font><i><font color="#999999"><font style="vertical-align: inherit;"> المستخدمين لدينا</font></font></i><font style="vertical-align: inherit;"> . ولا يؤثر حجم التطبيق على مستوى عمليات التثبيت فقط. يؤثر الحجم أيضًا على معدل التحويل لإعدادات التطبيق.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> إليك</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> مقالة جيدة حول هذا كتبها فريق Google Play. تتناول هذه المقالة أهمية حجم التطبيق. على وجه الخصوص ، تقول أن كل 6 ميغابايت إضافية من حجم ملف APK يقلل من معدل تحويل التثبيتات بنسبة 1 ٪.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يتحدثون أيضًا عن حقيقة أن هذا التأثير أقوى في البلدان النامية حيث أجهزة الميزانية هي القاعدة. أي أن تقليل حجم ملف APK بمقدار 10 ميجابايت في الأسواق الناشئة يتوافق مع زيادة في معدل تحويل المنشآت بنسبة 2.5٪ تقريبًا.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1c1/624/15d/1c162415de7e88ff4c5ed89853b6483b.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">زيادة معدل التحويل لعمليات التثبيت لكل 10 ميجا بايت من تقليل حجم ملف APK في بلدان مختلفة (وفقًا لبيانات Google الداخلية)</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
لقد تأثرنا كثيرًا بكيفية تأثير تقليل حجم التطبيق على مستوى عمليات إلغاء التثبيت ومعدل التحويل لإعدادات التطبيق. </font><font style="vertical-align: inherit;">ونتيجة لذلك ، بدأنا العمل بهدف تقليل حجم التطبيق قدر الإمكان ، مع مراعاة ملاءمته للمستخدمين. </font><font style="vertical-align: inherit;">كانت الخطوة الأولى في هذا المشروع هي تحليل</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> توصيات</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Google</font><font style="vertical-align: inherit;">الرسمية</font><font style="vertical-align: inherit;">لمطوري Android.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">حزمة تطبيقات Android</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
عند قراءة التوصيات ، تعلمنا أن أسهل طريقة لتقليل حجم التطبيق هي استخدام طريقة توزيع جديدة للتطبيق تسمى </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">حزمة تطبيقات Android</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (AAB). حتى تلك اللحظة ، قمنا بتوزيع التطبيق ، وجمع ملف </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">حزمة Android</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (APK) </font><font style="vertical-align: inherit;">القديم الجيد </font><font style="vertical-align: inherit;">، والذي يمكن تشغيله على معظم أجهزة Android ، وتحميله على Google Play Console. لكن حزمة AAB تحتوي فقط على التعليمات البرمجية والموارد المترجمة. ونتيجة لذلك ، عندما يتم تنزيله ، تكون Google مسؤولة عن إنشاء ملفات APK محسنة لأنواع مختلفة من الأجهزة ، مع مراعاة مواصفاتها وبنية وحدة المعالجة المركزية.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
اتضح أنه من خلال إجراء تغيير بسيط على عملية بناء المشروع ، هل يمكننا الحصول على تخفيض خطير في حجم التطبيق دون بذل المزيد من الجهد؟ هذا جيد جدا للحقيقة! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بعد أن قرأنا الوثائق ، قمنا فقط بتغيير نص بناء React Native Gradle بحيث يتم </font></font><code>assembleRelease</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تشغيله </font><font style="vertical-align: inherit;">بدلاً من البرنامج الحالي </font></font><code>bundleRelease</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. هذا كل ما نحتاجه لإنشاء ملف AAB. بعد إجراء المزيد من التعديلات على </font></font><code>supply</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تهيئة </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fastlane</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> فيما يتعلق بالتحميل التلقائي للمواد مباشرة إلى متجر Play ، انتقلنا إلى AAB ، وظهر إصدار جديد من تطبيقنا في Google Play Console.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أدى هذا التغيير وحده إلى تقليل حجم ملفات APK التي تم نقلها إلى أجهزة المستخدم. تراوح الانخفاض بين 9.1 و 12.4 ميجا بايت. كما اتضح ، فإن استخدام Android App Bundle هو تقنية فعالة تسمح ، في الواقع ، بتقليل حجم التطبيق.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9e5/feb/57b/9e5feb57bf54450425a6dc54da48f613.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ملف APK القديم وحزمة AAB الجديدة ، التي يؤدي استخدامها إلى حقيقة أن حجم التطبيق على الأجهزة المختلفة يمكن أن يكون من 14.4 إلى 17.7 ميغابايت</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
صحيح ، يجب أن تكون حذرًا هنا. </font><font style="vertical-align: inherit;">إذا كنت تستخدم React Native with</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hermes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، فقد تحتاج إلى تحديث تبعيتك</font></font><code>soloader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(انظر التفاصيل</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> هنا</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">خلاف ذلك ، هناك خطر من إعطاء المستخدم تطبيقًا يحتوي على خطأ فادح. </font><font style="vertical-align: inherit;">كنا محظوظين ، وتمكنا من تحديد هذه المشكلة أثناء اختبار الإصدار الأولي للمشروع. </font><font style="vertical-align: inherit;">لكن يمكن أن ينزلق الخطأ بسهولة إلى الإنتاج ، لأنه لا يظهر أثناء الاختبار المحلي أو عند إنشاء ملف APK.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تحسين موارد التطبيق باستخدام Android Size Analyzer</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
كان الاقتراح التالي لتحسين التطبيقات التي وجدناها في الوثائق هو استخدام </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Android Size Analyzer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">هذه أداة سطر أوامر تحلل تطبيقات Android وتبحث عن طرق لتقليل حجمها. </font><font style="vertical-align: inherit;">أطلقنا هذه الأداة باستخدام أمر من النموذج التالي:</font></font><br>
<br>
<pre><code class="javascript hljs">size-analyzer check-bundle [BUNDLE].aab
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ونتيجة لذلك ، حصلنا على قائمة بموارد التطبيق والصور الرائعة التي يمكننا تحسينها. </font><font style="vertical-align: inherit;">وقد أوصينا أيضًا بإعداد ProGuard.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ed0/a26/0b0/ed0a260b0a19878cf664c53ec54c9026.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تقرير محلل الحجم</font></font></font></i><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍ProGuard</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ProGuard هي أداة لضغط وتشويه وتحسين Java bytecode. </font><font style="vertical-align: inherit;">لم نستكشف بعد إمكانية استخدام هذه الأداة ، حيث علمنا أنها قد لا تكون متوافقة مع بعض مكتبات Android. </font><font style="vertical-align: inherit;">نظرًا لأننا سعينا لتقليل حجم تطبيقنا بأسرع وقت ممكن ، ولجعل هذا الأمر بسيطًا قدر الإمكان ، قررنا ترك طريقة التحسين هذه في المستقبل.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">appموارد التطبيق كبيرة</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بتشغيله </font></font><code>size-analyzer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مرة أخرى ، باستخدام المفتاح </font></font><code>-d</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، حصلنا على قائمة بموارد التطبيق ، مرتبة حسب حجمها. </font><font style="vertical-align: inherit;">نظرًا لأن هذه الأداة لا تعرف أي شيء عن كيفية عمل المستخدمين مع التطبيق ، فقد أتاحت لنا الفرصة لتحديد الموارد التي يجب إزالتها بشكل مستقل وأيها يجب تحميله ديناميكيًا في التطبيق.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/900/d84/262/900d84262161b1440fe03e0d8b0d4fab.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">قائمة بموارد التطبيق الكبيرة مرتبة حسب الحجم</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
أول وأكبر مورد في هذه القائمة هو حزمة JavaScript الأصلية المتفاعلة. </font><font style="vertical-align: inherit;">الآن لا يمكننا تقسيم هذه الحزمة وتحميلها ديناميكيًا. </font><font style="vertical-align: inherit;">ولكن في وقت لاحق سوف نفكر في ذلك. </font><font style="vertical-align: inherit;">يوجد أسفل القائمة ملفات الخطوط الكبيرة (TTF) وملفات الصور (JPG و PNG).</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagesصور غير ضرورية</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تم لفت انتباهنا على الفور إلى صور JPG الضخمة المستخدمة في </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Storybook</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">نستخدم هذا النظام لتطوير واختبار المكونات. </font><font style="vertical-align: inherit;">هذا هو 2 ميغا بايت من القمامة التي تقع في نسخة الإنتاج من المشروع. </font><font style="vertical-align: inherit;">خطأ مخزي! </font><font style="vertical-align: inherit;">عندما يحدث شيء من هذا القبيل ، نشعر وكأننا قمنا ببعض الغباء الشديد. </font><font style="vertical-align: inherit;">ولكن في عالم تطوير البرمجيات المعقد ، يرتكب الجميع الأخطاء. </font><font style="vertical-align: inherit;">أعتقد أنه إذا تحدثت عن أخطائك علنًا ، فسوف يساعد المطورين الآخرين على التعلم من هذه الأخطاء. </font><font style="vertical-align: inherit;">هناك احتمال أن ترتكب نفس الأخطاء إذا لم تقم بتحليل هيكل موارد التطبيق ، الذي يزداد حجمه تدريجيًا.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onts الخطوط</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بعد أن تخلصنا بسرعة من الصور غير الضرورية ، شرعنا في تحليل عناصر أخرى من قائمة الموارد. كان من الواضح أن هناك الكثير من الخطوط المضمنة فيه. بعد أن تحدثنا عن هذا مع مصممينا ، أخبرونا أن العديد من المكونات القديمة لا تختلف في الالتزام الصارم بكتيبات الطباعة. لذلك ، اكتشفنا المكونات التي يمكن إزالتها ، والتي يمكنك من خلالها استخدام الخطوط المحدثة المناسبة. بفضل هذا ، تمكنا من تقليل عدد الخطوط المستخدمة من ستة إلى أربعة.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
شيء آخر لاحظناه هو الحجم الهائل لملفات الخطوط نفسها. كان حجم كل منها حوالي 670 كيلوبايت. وهذا يعني أن أربعة خطوط في الحزمة غير المضغوطة تحتل 2.7 ميغابايت مذهلة. ولكن لحسن الحظ ، هناك أداة تسمى </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FontForge</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> تسمح لك بتحليل ملفات الخطوط وتعديلها بعمق. باستخدام هذه الأداة ، تمكنا من معرفة أن السبب الرئيسي للحجم الكبير لملفات الخطوط هو الأحرف السيريلية الممتدة والرموز الرمزية غير الضرورية. يمكننا إزالة كل هذا بأمان ، لأن جزء النص من طلبنا مكتوب بالكامل باللغة البرتغالية. بفضل هذا التغيير ، تمكنا من تقليل حجم ملفات الخطوط من 670 كيلوبايت إلى 70 كيلوبايت - بنسبة 90٪.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7d0/144/f9c/7d0144f9c3954dee6570347075fbe392.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أمثلة على بعض الحروف الرسومية المضمنة في خطوطنا ،</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
نظرًا لأننا تخلصنا من الخطوط غير الضرورية وقمنا بتحسين الخطوط المتبقية ، فقد تمكنا من تقليل حجم التطبيق بمقدار 3.8 ميجا بايت. </font><font style="vertical-align: inherit;">أدى هذا إلى انخفاض لطيف في الحجم الإجمالي لملف APK بمقدار 2 ميغابايت.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/52b/62c/a55/52b62ca55ea0178919421a1c08304adc.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">قائمة الخطوط وأحجامها قبل التحسين</font></font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/83e/374/6db/83e3746db754c475501170c6e4372c49.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">قائمة الخطوط وأحجامها بعد التحسين</font></font></font></i><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pt تحسين الصور</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بعد تحليل الصور التي لا تزال موجودة في التطبيق ، لاحظنا أن بعضها كبير جدًا. </font><font style="vertical-align: inherit;">لقد </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">عالجنا</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> العديد من هذه الصور باستخدام </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">أداة</font></a><font style="vertical-align: inherit;"> تحسين الرسومات </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">TinyPNG وشهدنا</font></a><font style="vertical-align: inherit;"> انخفاضًا كبيرًا في حجم هذه الصور. </font><font style="vertical-align: inherit;">بعد ذلك ، قررنا تحسين جميع صور JPG و PNG المستخدمة في التطبيق. </font><font style="vertical-align: inherit;">كان هناك 41 منهم.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aa5/8e9/9e6/aa58e99e6307077787f37d0d60fc59db.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الصورة قبل التحسين وبعده</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
أتاح لنا الفرصة لتقليل حجم الصور من 2.5 ميغابايت إلى 756 كيلوبايت ، أي بنسبة 70٪. </font><font style="vertical-align: inherit;">ومع ذلك ، نظرًا لحقيقة أن الصور لم يتم تحسينها مسبقًا ، فقد تم ضغطها أثناء إنشاء ملف APK النهائي. </font><font style="vertical-align: inherit;">اتضح أن التحسين أدى إلى انخفاض حجم التطبيق الذي قام المستخدم بتنزيله بمقدار 500 كيلوبايت فقط. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بعد ذلك ، أدركنا أننا استنفدنا بالفعل جميع إمكانيات التحسين السريع. </font><font style="vertical-align: inherit;">يتطلب الاستمرار في تحسين الموارد إما جهودًا كبيرة أو تحسينات طفيفة فقط.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تفاعل تحسين حزمة جافا سكريبت الأصلية</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بعد أن اكتشفنا موارد التطبيق الخاصة بمنصة Android ، حان الوقت لتحليل حزمة JavaScript. </font><font style="vertical-align: inherit;">يمكن اعتبار تحسين الحزمة فكرة جيدة لثلاثة أسباب. </font><font style="vertical-align: inherit;">أولاً ، يقلل من حجم ملف APK النهائي. </font><font style="vertical-align: inherit;">ثانيًا ، يؤدي هذا إلى إطلاق أسرع للتطبيق ، حيث يجب على الجهاز JS الظاهري معالجة رمز أقل. </font><font style="vertical-align: inherit;">أخيرًا ، والأهم من ذلك ، أنه يسرع تحديثات OTA التي نقوم بها عدة مرات في الأسبوع باستخدام </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CodePush</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">analy محلل حزمة وتحسين الشفرة</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
من أجل اتخاذ قرار بشأن كيفية تقليل حجم الحزمة ، أولاً ، كان عليك معرفة أكثر مكان في الحزمة. للقيام بذلك ، استخدمنا أداة مفتوحة المصدر ممتازة </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تتفاعل مع المحتوى الأصلي</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . بعد تحليل المشروع بمساعدته ، حصلنا على تصور حيث كان كل مجلد وكل تبعية للتطبيق موجودًا ، مما يشير إلى أحجام الكيانات المقابلة.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7f2/641/4c0/7f26414c02bec1a7cf7bcd6b901fb837.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">لقطة للمكتبات والمجلدات الخاصة بقاعدة التعليمات البرمجية للواجهة الأمامية لتطبيق Mutual مع إشارة إلى الأحجام</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
اكتشفنا أن الحجم الإجمالي للحزمة هو 5.49 ميجا بايت. يتم تمثيل 57.8 ٪ من هذا الحجم من خلال التبعيات من المجلد</font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، 27.5 ٪ - رمز التطبيق. ما تبقى ، لا يمكن تحديد الأداة المستخدمة من قبلنا. أثناء عملية تجميع الحزمة ، تم حذف الرمز غير المستخدم بالفعل ، لذلك ما رأيناه هو الرمز الذي يستخدمه التطبيق بالفعل. ولكن ، حتى مع مراعاة ذلك ، يمكنك دائمًا العثور على شيء يمكن تحسينه في الحزمة.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أكبر تبعية للمشروع هو</font></font><code>math.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. تنفذ هذه المكتبة ، كما يوحي اسمها ، العديد من العمليات الرياضية. ليس لدينا حاجة خاصة لهذه المكتبة لأننا نقوم بجميع الحسابات الهامة على الخادم ، وبعد ذلك نقوم ببساطة بإرسال النتائج إلى التطبيق. عندما نظرنا إلى رمز التطبيق ، اتضح أن المكتبة تستخدم فقط لإجراء بعض العمليات البسيطة. على الأرجح تم استخدامه من قبل مطور عمل على كود الخادم فقط بحكم العادة. لقد استخرجنا بسرعة الطرق المناسبة من المكتبة وقمنا ببنائها في قاعدة الكود الخاصة بنا ، للتخلص تمامًا من هذه التبعية. هذا يسمح بتقليل حجم الحزمة إلى 4.64 ميجا بايت. رفض مكتبة واحدة فقط سمح بتقليل حجم الباقة بنسبة 15.5٪!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
كما ذكرنا من قبل ، نستخدم Storybook لتطوير واختبار المكونات. صحيح ، يجب أن تكون القدرات المقابلة متاحة فقط في البيئات المحلية والمتوسطة. لا يحتاج المستخدمون النهائيون إلى ذلك. وبفضل هذا ، استخدمنا المتغير </font></font><code>ENVIRONMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">للتحكم في تضمين الجزء المقابل من التطبيق. على الرغم من أن هذا مناسب لتقييد الوصول ، إلا أن أداة الحزم لا يمكنها معرفة القيمة المكتوبة لهذا المتغير. بسبب هذا القيد ، سقطت جميع رموز Storybook في حزمة الإنتاج.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لإصلاح المشكلة ، قمنا بعزل استيراد هذا القسم في ملف واحد. ثم أنشأنا نسختين من هذا الملف: أحدهما يتضمن Storybook ، والآخر مخصص للإنتاج ، والذي يحتوي على تخطيط المكون فقط. للتبديل بين هذه الملفات عند إعداد نسخة الإنتاج من الحزمة ، قمنا بكتابة برنامج نصي يتم تنفيذه قبل إنشاء المشروع وتغيير ملف إلى آخر. بفضل هذه الطريقة ، تمكنا من إزالة رمز Storybook بالكامل من الإصدار الإنتاجي للتطبيق ، وإزالة كل من التبعية </font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">والرمز المعتاد فيما يتعلق بتكوين "قصص" Storybook.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/996/4cc/276/9964cc2769a8a23b3b18d5b0d273cfd9.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تم تحديث مجلد Storybook بنسختين من ملف الفهرس.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
قلل هذان التغييران حجم الحزمة من 5.49 ميغابايت إلى 4.2 ميغابايت. </font><font style="vertical-align: inherit;">هذا يعني أنه من بين أمور أخرى ، سيتم تحميل التطبيق بشكل أسرع وتحديث أسرع.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/034/06f/f53/03406ff53c8a918119c9febd41e6d752.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">كان حجم الحزمة النهائية 4.2 ميجا بايت.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
بعد كل هذه التحسينات ، قمنا مرة أخرى بتنزيل التطبيق في متجر Play. </font><font style="vertical-align: inherit;">تم إبلاغنا الآن أن حجم ملف APK النهائي سيكون في النطاق من 10.5 إلى 13.7 ميجابايت. </font><font style="vertical-align: inherit;">هذا ، بالنظر إلى حقيقة أن التطبيق كان في الأصل بحجم 26.8 ميغابايت ، يعني ببساطة انخفاضًا مذهلاً في حجم المشروع بنحو 60 ٪! </font><font style="vertical-align: inherit;">لذلك ، كما قلنا في مقال أعده فريق Google Play ، يمكننا أن نتوقع تمامًا أن معدل تحويل المنشآت سيزيد بنسبة 3.75٪.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/715/69e/cec/71569ececb25a15225a48cef54bfb254.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مقارنة بين إصدار APK الأصلي للتطبيق وإصدار AAB النهائي ، حيث يتم إجراء جميع التحسينات الموضحة أعلاه</font></font></font></i><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ملخص</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
نحن ، كمبرمجين موجهين للأعمال ، نعلم أن الشركات في بعض الأحيان ، من أجل تطوير أسرع للمشروع ، قد تستمر في زيادة ديونها التقنية. </font><font style="vertical-align: inherit;">هذا ينطبق بشكل خاص على الشركات الناشئة الصغيرة مثل Mutual ، الذين يحاولون العثور على مكانهم في السوق. </font><font style="vertical-align: inherit;">ولكن إذا لم تلاحظ هذا الدين ، يمكنك ارتكاب أخطاء مزعجة ، مثل إرسال 2 ميغابايت من صور الاختبار إلى الإنتاج واستخدام مكتبة ضخمة بلا مبرر. </font><font style="vertical-align: inherit;">لا ينبغي السماح للديون التقنية بالخروج عن السيطرة وتسبب المشاكل.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بالإضافة إلى ذلك ، غالبًا ما يحدث أن المطورين يفتقدون ببساطة الفرص المتاحة لهم لتحسين المشاريع. </font><font style="vertical-align: inherit;">لذلك ، يوصى أحيانًا بتحليل مشاريعك بشكل نقدي. </font><font style="vertical-align: inherit;">فقط للتحقق مما إذا كنت قد فقدت بعض الفرص لتحسين الحجم أو السرعة أو بعض الجوانب الأخرى للتطبيق بسرعة. </font><font style="vertical-align: inherit;">استغرق الأمر يومين فقط لتحليل التطبيق وتخطيط العمل وإجراء تحسينات على المشروع ، مما سمح لنا بتقليل حجم التطبيق بنسبة 60٪. </font><font style="vertical-align: inherit;">من الصعب التوصل إلى شيء آخر يمكن أن يؤدي إلى نفس النتائج في مثل هذا الوقت القصير. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">كيف يمكنك تحسين مشاريع React Native الخاصة بك؟</font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/a_/bs/aa/a_bsaactpbr8fltzymtkhqbw1d4.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar502412/index.html">Guilloche بطريقة مختلفة</a></li>
<li><a href="../ar502414/index.html">FOSS News No. 16 - مراجعة البرمجيات الحرة والمفتوحة المصدر من 11 إلى 17 مايو 2020</a></li>
<li><a href="../ar502416/index.html">استكمال SQL. الجزء 1. تعقيد التحليل. قصص حول إنهاء ملف ANTLR</a></li>
<li><a href="../ar502418/index.html">مراقب صورة ثلاثي الأبعاد</a></li>
<li><a href="../ar502420/index.html">يجد CSS للاهتمام في تصميم تويتر</a></li>
<li><a href="../ar502424/index.html">توقف عن استيراد حزم JavaScript كاملة</a></li>
<li><a href="../ar502428/index.html">جوليا النحوية</a></li>
<li><a href="../ar502430/index.html">أفضل ممارسات Kubernetes. اختبار الجدوى Kubernetes مع اختبارات الجاهزية والحيوية</a></li>
<li><a href="../ar502432/index.html">ملخص المواد الطازجة من عالم الواجهة الأمامية للأسبوع الماضي رقم 415 (11-17 مايو 2020)</a></li>
<li><a href="../ar502436/index.html">CI TeamCity - أتمتة عمليات بناء اختبار Android و UI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>