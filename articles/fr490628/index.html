<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§üüèø üôå ‚ÜñÔ∏è Que faire lorsque CSS bloque l'analyse des pages? üë©üèø‚ÄçüöÄ üÜë üï∫üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="R√©cemment, j'ai effectu√© un audit d'un site et preload/polyfillsuis tomb√© sur un sch√©ma que j'ai d√©j√† vu avec plusieurs clients. Aujourd'hui, l'utilis...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Que faire lorsque CSS bloque l'analyse des pages?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/490628/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©cemment, j'ai effectu√© un audit d'un site et </font></font><code>preload/polyfill</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">suis </font><font style="vertical-align: inherit;">tomb√© sur un sch√©ma </font><font style="vertical-align: inherit;">que j'ai d√©j√† vu avec plusieurs clients. </font><font style="vertical-align: inherit;">Aujourd'hui, l'utilisation de ce mod√®le auparavant populaire n'est pas recommand√©e. </font><font style="vertical-align: inherit;">Cependant, il est utile de l'examiner afin d'illustrer l'importance d'une utilisation prudente du m√©canisme de pr√©chargement des documents par les navigateurs Web. </font><font style="vertical-align: inherit;">Il est √©galement int√©ressant car il vous permet de d√©montrer un exemple r√©el de la fa√ßon dont l'ordre des √©l√©ments dans un document peut affecter les performances (c'est ce qui est discut√© dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ce</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> merveilleux article de Harry Roberts). </font><font style="vertical-align: inherit;">
Le mat√©riel, dont nous publions la traduction aujourd'hui, est consacr√© √† l'analyse de situations dans lesquelles une manipulation incorrecte et intempestive des ressources CSS affecte les performances des pages Web.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/j9/ku/dh/j9kudhouixuhlvhywk7misjih8w.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ä propos de loadCSS</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je suis un grand fan du groupe </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Filament</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ils sortent une quantit√© incroyable de grands projets. De plus, ils cr√©ent constamment des outils pr√©cieux et les partagent dans le but d'am√©liorer le Web. L'un de ces outils est </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">loadCSS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui a longtemps √©t√© l'outil m√™me que j'ai recommand√© √† tout le monde d'utiliser pour charger des ressources CSS non critiques. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien que cela ait maintenant chang√© (et que le Groupe Filament a publi√© un excellent </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur ce que ses employ√©s pr√©f√®rent utiliser ces jours-ci), je constate toujours, lorsque j'audite des sites, comment ils l' </font></font><code>loadCSS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilisent en production. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'un des mod√®les que j'ai rencontr√©s est le mod√®le</font></font><code>preload/polyfill</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">En utilisant cette approche, tous les fichiers avec des styles sont charg√©s en mode de pr√©chargement (l'attribut des </font></font><code>rel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">liens correspondants est d√©fini sur </font></font><code>preload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font><font style="vertical-align: inherit;">Apr√®s cela, lorsqu'ils sont pr√™ts √† utiliser, appliquez leurs √©v√©nements </font></font><code>onload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour les connecter √† la page.</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;link rel=<span class="hljs-string">"preload"</span> href=<span class="hljs-string">"path/to/mystylesheet.css"</span> <span class="hljs-keyword">as</span>=<span class="hljs-string">"style"</span> onload=<span class="hljs-string">"this.rel='stylesheet'"</span>&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">noscript</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"path/to/mystylesheet.css"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">noscript</span>&gt;</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âtant donn√© que tous les navigateurs ne prennent pas en charge la conception </font></font><code>&lt;a href="https://caniuse.com/#feat=link-rel-preload"&gt;&lt;link rel="preload"&gt;&lt;/a&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, le projet </font></font><code>loadCSS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">offre aux d√©veloppeurs un polyfill pratique, qui est ajout√© √† la page apr√®s la description des liens pertinents:</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;link rel=<span class="hljs-string">"preload"</span> href=<span class="hljs-string">"path/to/mystylesheet.css"</span> <span class="hljs-keyword">as</span>=<span class="hljs-string">"style"</span> onload=<span class="hljs-string">"this.rel='stylesheet'"</span>&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">noscript</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"path/to/mystylesheet.css"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">noscript</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-comment">/*! loadCSS rel=preload polyfill. [c]2017 Filament Group, Inc. MIT License */</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{ ... }());
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span></code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trouble dans les priorit√©s du r√©seau</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je n'ai jamais √©t√© un ardent fan de ce mod√®le. </font><font style="vertical-align: inherit;">Le pr√©chargement est un outil grossier. </font><font style="vertical-align: inherit;">Les mat√©riaux t√©l√©charg√©s √† l'aide de liens d'attributs </font></font><code>rel="preload"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se battent avec succ√®s avec d'autres mat√©riaux pour les ressources r√©seau. </font><font style="vertical-align: inherit;">L'utilisation </font></font><code>preload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">suppose que les feuilles de style qui se chargent de mani√®re asynchrone du fait qu'elles ne jouent pas un r√¥le critique dans la sortie d'une page re√ßoivent une tr√®s haute priorit√© des navigateurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'image suivante, extraite de WebPageTest, illustre tr√®s bien ce probl√®me. </font><font style="vertical-align: inherit;">Aux lignes 3 √† 6, vous pouvez voir le chargement asynchrone des fichiers CSS √† l'aide d'un mod√®le </font></font><code>preload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mais, alors que les d√©veloppeurs consid√®rent que ces fichiers ne sont pas si importants que leur t√©l√©chargement bloquerait le rendu, utilisez</font></font><code>preload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> signifie qu'ils seront charg√©s avant que le navigateur ne re√ßoive les ressources restantes.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8f9/07f/75a/8f907f75ae91cafe98091b00c2e7750e.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les fichiers CSS qui utilisent le mod√®le de pr√©chargement lorsqu'ils sont charg√©s arriveront dans le navigateur plus t√¥t que les autres ressources, m√™me si ce ne sont pas des ressources essentielles pour le rendu initial d'une page</font></font></font></i><br>
 <br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verrouillage de l'analyseur HTML</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les probl√®mes associ√©s √† la priorit√© de chargement des ressources sont d√©j√† suffisants pour √©viter d'utiliser le mod√®le dans la plupart des situations </font></font><code>preload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mais dans ce cas, la situation est aggrav√©e par la pr√©sence d'une autre feuille de style, qui est charg√©e de la mani√®re habituelle.</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;link rel=<span class="hljs-string">"stylesheet"</span> href=<span class="hljs-string">"path/to/main.css"</span> /&gt;<font></font>
&lt;link rel="preload" href="path/to/mystylesheet.css" as="style" onload="this.rel='stylesheet'"&gt;<font></font>
&lt;noscript&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;link rel="stylesheet" href="path/to/mystylesheet.css"&gt;<font></font>
&lt;/noscript&gt;<font></font>
&lt;script&gt;<font></font>
/*! loadCSS rel=preload polyfill. [c]2017 Filament Group, Inc. MIT License */<font></font>
(function(){ ... }());<font></font>
&lt;/script&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a les m√™mes probl√®mes lors de l'utilisation </font></font><code>preload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conduit au fait que les fichiers les plus importants ne sont pas prioritaires. Mais il est tout aussi important, et peut-√™tre moins √©vident, quel effet cela a sur la capacit√© du navigateur √† analyser la page. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encore une fois, cela a d√©j√† √©t√© </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√©crit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en d√©tail </font><font style="vertical-align: inherit;">, donc je recommande de lire ce mat√©riel afin de mieux comprendre ce qui se passe. Ici, je vais en parler bri√®vement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En r√®gle g√©n√©rale, le chargement des styles bloque le rendu des pages. Le navigateur doit interroger et analyser les styles afin de pouvoir afficher la page. Cependant, cela n'emp√™che pas le navigateur d'analyser le reste du code HTML. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les scripts, en revanche, bloquent l'analyseur s'ils ne sont pas marqu√©s comme </font></font><code>defer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou </font></font><code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âtant donn√© que le navigateur doit supposer que le script peut manipuler le contenu de la page elle-m√™me ou les styles qui lui sont appliqu√©s, il doit faire attention au moment de l'ex√©cution de ce script. </font><font style="vertical-align: inherit;">Si le navigateur sait qu'un certain code CSS est en cours de chargement, il attendra l'arriv√©e de ce code CSS, puis ex√©cutera le script. </font><font style="vertical-align: inherit;">Et comme le navigateur ne peut pas continuer d'analyser le document tant que le script n'est pas ex√©cut√©, cela signifie que les styles ne bloquent plus uniquement le rendu. </font><font style="vertical-align: inherit;">Ils emp√™chent le navigateur d'analyser le HTML. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce comportement est vrai pour les scripts externes et les scripts int√©gr√©s dans la page. </font><font style="vertical-align: inherit;">Si le CSS se charge, les scripts en ligne ne s'ex√©cutent pas jusqu'√† ce que ce CSS arrive dans le navigateur.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Etude de probl√®me</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La fa√ßon la plus compr√©hensible de visualiser ce probl√®me est d'utiliser les outils de d√©veloppement Chrome (j'aime vraiment le niveau auquel ces outils ont grandi). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parmi les outils Chrome, il y a un onglet </font></font><code>Performance</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec lequel vous pouvez enregistrer le profil de chargement de la page. Je recommande de ralentir artificiellement la connexion r√©seau afin que le probl√®me se manifeste plus clairement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce cas, j'ai test√© en utilisant la configuration r√©seau Fast 3G. Si vous regardez attentivement ce qui arrive au thread principal, vous pouvez comprendre que la demande de chargement du fichier CSS se produit au tout d√©but de l'analyse HTML (environ 1,7 seconde apr√®s le d√©but du chargement de la page).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/40b/881/a00/40b881a0060365bcbb5e4944b6784a2d.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un petit rectangle sous le bloc d'analyse HTML repr√©sente une demande de fichier CSS.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Pendant la prochaine p√©riode, qui est d'environ une seconde, le thread principal est inactif. </font><font style="vertical-align: inherit;">Ici, vous pouvez voir de petites √Æles d'activit√©s. </font><font style="vertical-align: inherit;">Il s'agit d'un d√©clenchement d'√©v√©nements indiquant l'ach√®vement du chargement des styles; c'est l'envoi par le m√©canisme de pr√©chargement de ressources d'autres requ√™tes. </font><font style="vertical-align: inherit;">Mais le navigateur arr√™te compl√®tement l'analyse HTML.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/059/fca/6f1/059fca6f1820ca9a3b841140ab912d4e.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous regardez la situation dans son ensemble, il s'av√®re qu'apr√®s le d√©but du chargement de CSS, le flux principal est inactif pendant plus de 1,1 seconde.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ainsi, 2,8 secondes se sont √©coul√©es, le style est charg√©, le navigateur le traite. </font><font style="vertical-align: inherit;">Ce n'est qu'alors que nous voyons le traitement du script int√©gr√©, puis le navigateur revient finalement √† l'analyse HTML.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/65a/a96/da2/65aa96da21d2e1ac6db4116ad54a8f80.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSS arrive dans environ 2,8 secondes, apr√®s quoi nous voyons que le navigateur continue d'analyser HTML</font></font></font></i><br>
 <br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firefox est une belle exception</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le comportement ci-dessus est courant pour Chrome, Edge et Safari. </font><font style="vertical-align: inherit;">Firefox est une belle exception √† la liste des navigateurs populaires. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tous les autres navigateurs suspendent l'analyse HTML, mais utilisent un analyseur proactif (un moyen de pr√©chargement des mat√©riaux) pour afficher le code des liens vers les ressources externes et pour r√©pondre aux demandes de chargement de ces ressources. </font><font style="vertical-align: inherit;">Firefox, cependant, va plus loin dans ce domaine: il </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">construit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sp√©culativement </font><font style="vertical-align: inherit;">une arborescence DOM, m√™me s'il s'attend √† ce que le script s'ex√©cute.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä moins que le script ne manipule le DOM, ce qui entra√Æne la n√©cessit√© de rejeter les r√©sultats de l'analyse sp√©culative, cette approche permet √† Firefox d'en profiter. Bien s√ªr, si le navigateur doit supprimer l'arborescence DOM sp√©culativement construite, cela signifie qu'en construisant cette arborescence, cela n'a rien fait d'utile. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit d'une approche int√©ressante. J'√©tais terriblement curieux de savoir √† quel point c'est efficace. Maintenant, cependant, il n'y a aucune information √† ce sujet dans Firefox Performance Profiler. L√†, vous ne pouvez pas savoir si l'analyseur sp√©culatif a fonctionn√©, s'il est n√©cessaire de refaire le travail qu'il a effectu√©, et s'il doit encore √™tre refait, comment cela affectera les performances.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai parl√© √† ceux qui sont responsables des outils de d√©veloppement de Firefox, et je peux dire qu'ils ont des id√©es int√©ressantes sur la fa√ßon de pr√©senter ces informations dans le profileur √† l'avenir. </font><font style="vertical-align: inherit;">J'esp√®re qu'ils r√©ussiront.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solution au probl√®me</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le cas du client, que j'ai mentionn√© au tout d√©but, la premi√®re √©tape pour r√©soudre ce probl√®me semblait extr√™mement simple: se d√©barrasser du mod√®le </font></font><code>preload/polyfill</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Le pr√©chargement de CSS non critiques est inutile. </font><font style="vertical-align: inherit;">Ici, vous devez passer √† l'utilisation d' </font></font><code>rel="preload"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un attribut </font><font style="vertical-align: inherit;">au lieu d' </font><font style="vertical-align: inherit;">un </font></font><code>media="print"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">C'est exactement ce que recommandent les experts du Groupe Filament. </font><font style="vertical-align: inherit;">Cette approche vous permet en outre de vous d√©barrasser compl√®tement du polyfill.</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;link rel=<span class="hljs-string">"stylesheet"</span> href=<span class="hljs-string">"/path/to/my.css"</span> media=<span class="hljs-string">"print"</span> onload=<span class="hljs-string">"this.media='all'"</span>&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela nous place d√©j√† dans une meilleure position: les priorit√©s du r√©seau sont d√©sormais bien mieux align√©es sur l'importance r√©elle des t√©l√©chargements. Et nous nous d√©barrassons √©galement du script int√©gr√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce cas, il existe encore un autre script int√©gr√© situ√© dans l'en-t√™te du document, sous la ligne qui initie la demande de chargement de CSS. Si vous d√©placez ce script de sorte qu'il se trouve devant la ligne de chargement du CSS, cela √©liminera le verrouillage de l'analyseur. Si vous analysez √† nouveau la page √† l'aide des outils de d√©veloppement Chrome, la diff√©rence sera compl√®tement √©vidente.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d16/c64/170/d16c64170a5ae365154626fc77eea21f.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avant d'apporter des modifications au code de la page, l'analyseur HTML s'est arr√™t√© √† la ligne 1939, apr√®s avoir rencontr√© un script int√©gr√©, et est rest√© ici pendant environ une seconde. Apr√®s l'optimisation, il a pu acc√©der √† la ligne 5281</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Auparavant, l'analyseur s'arr√™tait √† la ligne 1939 et attendait le chargement de CSS, mais maintenant il atteint la ligne 5281. L√†, √† la fin de la page, il y a un autre script int√©gr√© qui arr√™te √† nouveau l'analyseur.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit d'une solution rapide au probl√®me. Ce n'est pas l'option qui repr√©sente la solution finale au probl√®me. Changer l'ordre des √©l√©ments et se d√©barrasser du motif</font></font><code>preload/polyfill</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n'est que la premi√®re √©tape. Vous pouvez mieux r√©soudre ce probl√®me en incorporant du code CSS critique dans une page, plut√¥t que de le charger √† partir d'un fichier externe. Mod√®le</font></font><code>preload/polyfill</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Con√ßu pour √™tre utilis√© en plus du CSS en ligne. </font><font style="vertical-align: inherit;">Cela nous permet d'ignorer compl√®tement les probl√®mes li√©s aux scripts et de nous assurer que le navigateur, apr√®s la premi√®re demande, dispose de tous les styles n√©cessaires au rendu de la page. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais pour l'instant, il convient de noter que nous pouvons obtenir une bonne am√©lioration des performances en apportant de tr√®s petites modifications au projet concernant la fa√ßon dont les styles sont charg√©s et l'ordre des √©l√©ments dans le DOM.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sommaire</font></font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous utilisez un </font></font><code>loadCSS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mod√®le </font></font><code>preload/polyfill</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, acc√©dez au mod√®le de chargement de style </font></font><code>print</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous avez des styles externes qui sont charg√©s de la mani√®re habituelle (c'est-√†-dire en utilisant des liens r√©guliers vers des fichiers de ces styles), d√©placez tous les scripts int√©gr√©s qui peuvent √™tre d√©plac√©s au-dessus des liens pour charger des styles.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Int√©grez des styles critiques dans la page afin d'assurer le d√©marrage le plus rapide possible du rendu.</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chers lecteurs! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avez-vous rencontr√© des probl√®mes pour ralentir le rendu des pages en raison de CSS? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RUVDS f√©licite tous les professionnels de l'informatique le 8 mars! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette ann√©e, nous avons d√©cid√© de ne pas donner de tulipes et de ne pas faire de s√©lection de cadeaux geek. </font><font style="vertical-align: inherit;">Nous avons pris un chemin diff√©rent et cr√©√© la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">page IT is female</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour montrer la pr√©sence de femmes sp√©cialistes en informatique.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr490618/index.html">Goroutine Stack Buffers</a></li>
<li><a href="../fr490620/index.html">Quand j'entends les mots "restaur√© le r√©seau neuronal", je grimpe pour v√©rifier les sauvegardes</a></li>
<li><a href="../fr490622/index.html">Lutte contre les fuites de m√©moire dans les applications Web</a></li>
<li><a href="../fr490624/index.html">En-t√™te HTTP et contr√¥le du navigateur Web</a></li>
<li><a href="../fr490626/index.html">Un guide complet des attributs data- * HTML</a></li>
<li><a href="../fr490630/index.html">Chargement de tableaux NumPy √† partir du disque: comparaison de memmap () et Zarr / HDF5</a></li>
<li><a href="../fr490634/index.html">√âv√©nements num√©riques √† Moscou du 2 au 8 mars</a></li>
<li><a href="../fr490636/index.html">√âv√©nements num√©riques √† Saint-P√©tersbourg du 2 au 8 mars</a></li>
<li><a href="../fr490640/index.html">Surcharge en C ++. Partie III. Surcharge des instructions new / delete</a></li>
<li><a href="../fr490642/index.html">Plugin pour la surveillance des applications K8s DevOpsProdigy KubeGraf v1.3.0: nouvelle version et nouvelles fonctionnalit√©s</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>