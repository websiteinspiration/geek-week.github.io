<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤟🏿 🙌 ↖️ Que faire lorsque CSS bloque l'analyse des pages? 👩🏿‍🚀 🆑 🕺🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Récemment, j'ai effectué un audit d'un site et preload/polyfillsuis tombé sur un schéma que j'ai déjà vu avec plusieurs clients. Aujourd'hui, l'utilis...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Que faire lorsque CSS bloque l'analyse des pages?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/490628/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Récemment, j'ai effectué un audit d'un site et </font></font><code>preload/polyfill</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">suis </font><font style="vertical-align: inherit;">tombé sur un schéma </font><font style="vertical-align: inherit;">que j'ai déjà vu avec plusieurs clients. </font><font style="vertical-align: inherit;">Aujourd'hui, l'utilisation de ce modèle auparavant populaire n'est pas recommandée. </font><font style="vertical-align: inherit;">Cependant, il est utile de l'examiner afin d'illustrer l'importance d'une utilisation prudente du mécanisme de préchargement des documents par les navigateurs Web. </font><font style="vertical-align: inherit;">Il est également intéressant car il vous permet de démontrer un exemple réel de la façon dont l'ordre des éléments dans un document peut affecter les performances (c'est ce qui est discuté dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ce</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> merveilleux article de Harry Roberts). </font><font style="vertical-align: inherit;">
Le matériel, dont nous publions la traduction aujourd'hui, est consacré à l'analyse de situations dans lesquelles une manipulation incorrecte et intempestive des ressources CSS affecte les performances des pages Web.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/j9/ku/dh/j9kudhouixuhlvhywk7misjih8w.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">À propos de loadCSS</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je suis un grand fan du groupe </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Filament</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ils sortent une quantité incroyable de grands projets. De plus, ils créent constamment des outils précieux et les partagent dans le but d'améliorer le Web. L'un de ces outils est </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">loadCSS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui a longtemps été l'outil même que j'ai recommandé à tout le monde d'utiliser pour charger des ressources CSS non critiques. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien que cela ait maintenant changé (et que le Groupe Filament a publié un excellent </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur ce que ses employés préfèrent utiliser ces jours-ci), je constate toujours, lorsque j'audite des sites, comment ils l' </font></font><code>loadCSS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilisent en production. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'un des modèles que j'ai rencontrés est le modèle</font></font><code>preload/polyfill</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">En utilisant cette approche, tous les fichiers avec des styles sont chargés en mode de préchargement (l'attribut des </font></font><code>rel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">liens correspondants est défini sur </font></font><code>preload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font><font style="vertical-align: inherit;">Après cela, lorsqu'ils sont prêts à utiliser, appliquez leurs événements </font></font><code>onload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour les connecter à la page.</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;link rel=<span class="hljs-string">"preload"</span> href=<span class="hljs-string">"path/to/mystylesheet.css"</span> <span class="hljs-keyword">as</span>=<span class="hljs-string">"style"</span> onload=<span class="hljs-string">"this.rel='stylesheet'"</span>&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">noscript</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"path/to/mystylesheet.css"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">noscript</span>&gt;</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Étant donné que tous les navigateurs ne prennent pas en charge la conception </font></font><code>&lt;a href="https://caniuse.com/#feat=link-rel-preload"&gt;&lt;link rel="preload"&gt;&lt;/a&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, le projet </font></font><code>loadCSS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">offre aux développeurs un polyfill pratique, qui est ajouté à la page après la description des liens pertinents:</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;link rel=<span class="hljs-string">"preload"</span> href=<span class="hljs-string">"path/to/mystylesheet.css"</span> <span class="hljs-keyword">as</span>=<span class="hljs-string">"style"</span> onload=<span class="hljs-string">"this.rel='stylesheet'"</span>&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">noscript</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"path/to/mystylesheet.css"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">noscript</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-comment">/*! loadCSS rel=preload polyfill. [c]2017 Filament Group, Inc. MIT License */</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{ ... }());
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span></code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trouble dans les priorités du réseau</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je n'ai jamais été un ardent fan de ce modèle. </font><font style="vertical-align: inherit;">Le préchargement est un outil grossier. </font><font style="vertical-align: inherit;">Les matériaux téléchargés à l'aide de liens d'attributs </font></font><code>rel="preload"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se battent avec succès avec d'autres matériaux pour les ressources réseau. </font><font style="vertical-align: inherit;">L'utilisation </font></font><code>preload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">suppose que les feuilles de style qui se chargent de manière asynchrone du fait qu'elles ne jouent pas un rôle critique dans la sortie d'une page reçoivent une très haute priorité des navigateurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'image suivante, extraite de WebPageTest, illustre très bien ce problème. </font><font style="vertical-align: inherit;">Aux lignes 3 à 6, vous pouvez voir le chargement asynchrone des fichiers CSS à l'aide d'un modèle </font></font><code>preload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mais, alors que les développeurs considèrent que ces fichiers ne sont pas si importants que leur téléchargement bloquerait le rendu, utilisez</font></font><code>preload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> signifie qu'ils seront chargés avant que le navigateur ne reçoive les ressources restantes.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8f9/07f/75a/8f907f75ae91cafe98091b00c2e7750e.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les fichiers CSS qui utilisent le modèle de préchargement lorsqu'ils sont chargés arriveront dans le navigateur plus tôt que les autres ressources, même si ce ne sont pas des ressources essentielles pour le rendu initial d'une page</font></font></font></i><br>
 <br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verrouillage de l'analyseur HTML</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les problèmes associés à la priorité de chargement des ressources sont déjà suffisants pour éviter d'utiliser le modèle dans la plupart des situations </font></font><code>preload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mais dans ce cas, la situation est aggravée par la présence d'une autre feuille de style, qui est chargée de la manière habituelle.</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;link rel=<span class="hljs-string">"stylesheet"</span> href=<span class="hljs-string">"path/to/main.css"</span> /&gt;<font></font>
&lt;link rel="preload" href="path/to/mystylesheet.css" as="style" onload="this.rel='stylesheet'"&gt;<font></font>
&lt;noscript&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;link rel="stylesheet" href="path/to/mystylesheet.css"&gt;<font></font>
&lt;/noscript&gt;<font></font>
&lt;script&gt;<font></font>
/*! loadCSS rel=preload polyfill. [c]2017 Filament Group, Inc. MIT License */<font></font>
(function(){ ... }());<font></font>
&lt;/script&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a les mêmes problèmes lors de l'utilisation </font></font><code>preload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conduit au fait que les fichiers les plus importants ne sont pas prioritaires. Mais il est tout aussi important, et peut-être moins évident, quel effet cela a sur la capacité du navigateur à analyser la page. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encore une fois, cela a déjà été </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">écrit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en détail </font><font style="vertical-align: inherit;">, donc je recommande de lire ce matériel afin de mieux comprendre ce qui se passe. Ici, je vais en parler brièvement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En règle générale, le chargement des styles bloque le rendu des pages. Le navigateur doit interroger et analyser les styles afin de pouvoir afficher la page. Cependant, cela n'empêche pas le navigateur d'analyser le reste du code HTML. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les scripts, en revanche, bloquent l'analyseur s'ils ne sont pas marqués comme </font></font><code>defer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou </font></font><code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Étant donné que le navigateur doit supposer que le script peut manipuler le contenu de la page elle-même ou les styles qui lui sont appliqués, il doit faire attention au moment de l'exécution de ce script. </font><font style="vertical-align: inherit;">Si le navigateur sait qu'un certain code CSS est en cours de chargement, il attendra l'arrivée de ce code CSS, puis exécutera le script. </font><font style="vertical-align: inherit;">Et comme le navigateur ne peut pas continuer d'analyser le document tant que le script n'est pas exécuté, cela signifie que les styles ne bloquent plus uniquement le rendu. </font><font style="vertical-align: inherit;">Ils empêchent le navigateur d'analyser le HTML. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce comportement est vrai pour les scripts externes et les scripts intégrés dans la page. </font><font style="vertical-align: inherit;">Si le CSS se charge, les scripts en ligne ne s'exécutent pas jusqu'à ce que ce CSS arrive dans le navigateur.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Etude de problème</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La façon la plus compréhensible de visualiser ce problème est d'utiliser les outils de développement Chrome (j'aime vraiment le niveau auquel ces outils ont grandi). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parmi les outils Chrome, il y a un onglet </font></font><code>Performance</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec lequel vous pouvez enregistrer le profil de chargement de la page. Je recommande de ralentir artificiellement la connexion réseau afin que le problème se manifeste plus clairement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce cas, j'ai testé en utilisant la configuration réseau Fast 3G. Si vous regardez attentivement ce qui arrive au thread principal, vous pouvez comprendre que la demande de chargement du fichier CSS se produit au tout début de l'analyse HTML (environ 1,7 seconde après le début du chargement de la page).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/40b/881/a00/40b881a0060365bcbb5e4944b6784a2d.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un petit rectangle sous le bloc d'analyse HTML représente une demande de fichier CSS.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Pendant la prochaine période, qui est d'environ une seconde, le thread principal est inactif. </font><font style="vertical-align: inherit;">Ici, vous pouvez voir de petites îles d'activités. </font><font style="vertical-align: inherit;">Il s'agit d'un déclenchement d'événements indiquant l'achèvement du chargement des styles; c'est l'envoi par le mécanisme de préchargement de ressources d'autres requêtes. </font><font style="vertical-align: inherit;">Mais le navigateur arrête complètement l'analyse HTML.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/059/fca/6f1/059fca6f1820ca9a3b841140ab912d4e.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous regardez la situation dans son ensemble, il s'avère qu'après le début du chargement de CSS, le flux principal est inactif pendant plus de 1,1 seconde.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ainsi, 2,8 secondes se sont écoulées, le style est chargé, le navigateur le traite. </font><font style="vertical-align: inherit;">Ce n'est qu'alors que nous voyons le traitement du script intégré, puis le navigateur revient finalement à l'analyse HTML.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/65a/a96/da2/65aa96da21d2e1ac6db4116ad54a8f80.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSS arrive dans environ 2,8 secondes, après quoi nous voyons que le navigateur continue d'analyser HTML</font></font></font></i><br>
 <br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firefox est une belle exception</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le comportement ci-dessus est courant pour Chrome, Edge et Safari. </font><font style="vertical-align: inherit;">Firefox est une belle exception à la liste des navigateurs populaires. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tous les autres navigateurs suspendent l'analyse HTML, mais utilisent un analyseur proactif (un moyen de préchargement des matériaux) pour afficher le code des liens vers les ressources externes et pour répondre aux demandes de chargement de ces ressources. </font><font style="vertical-align: inherit;">Firefox, cependant, va plus loin dans ce domaine: il </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">construit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> spéculativement </font><font style="vertical-align: inherit;">une arborescence DOM, même s'il s'attend à ce que le script s'exécute.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À moins que le script ne manipule le DOM, ce qui entraîne la nécessité de rejeter les résultats de l'analyse spéculative, cette approche permet à Firefox d'en profiter. Bien sûr, si le navigateur doit supprimer l'arborescence DOM spéculativement construite, cela signifie qu'en construisant cette arborescence, cela n'a rien fait d'utile. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit d'une approche intéressante. J'étais terriblement curieux de savoir à quel point c'est efficace. Maintenant, cependant, il n'y a aucune information à ce sujet dans Firefox Performance Profiler. Là, vous ne pouvez pas savoir si l'analyseur spéculatif a fonctionné, s'il est nécessaire de refaire le travail qu'il a effectué, et s'il doit encore être refait, comment cela affectera les performances.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai parlé à ceux qui sont responsables des outils de développement de Firefox, et je peux dire qu'ils ont des idées intéressantes sur la façon de présenter ces informations dans le profileur à l'avenir. </font><font style="vertical-align: inherit;">J'espère qu'ils réussiront.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solution au problème</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le cas du client, que j'ai mentionné au tout début, la première étape pour résoudre ce problème semblait extrêmement simple: se débarrasser du modèle </font></font><code>preload/polyfill</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Le préchargement de CSS non critiques est inutile. </font><font style="vertical-align: inherit;">Ici, vous devez passer à l'utilisation d' </font></font><code>rel="preload"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un attribut </font><font style="vertical-align: inherit;">au lieu d' </font><font style="vertical-align: inherit;">un </font></font><code>media="print"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">C'est exactement ce que recommandent les experts du Groupe Filament. </font><font style="vertical-align: inherit;">Cette approche vous permet en outre de vous débarrasser complètement du polyfill.</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;link rel=<span class="hljs-string">"stylesheet"</span> href=<span class="hljs-string">"/path/to/my.css"</span> media=<span class="hljs-string">"print"</span> onload=<span class="hljs-string">"this.media='all'"</span>&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela nous place déjà dans une meilleure position: les priorités du réseau sont désormais bien mieux alignées sur l'importance réelle des téléchargements. Et nous nous débarrassons également du script intégré. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce cas, il existe encore un autre script intégré situé dans l'en-tête du document, sous la ligne qui initie la demande de chargement de CSS. Si vous déplacez ce script de sorte qu'il se trouve devant la ligne de chargement du CSS, cela éliminera le verrouillage de l'analyseur. Si vous analysez à nouveau la page à l'aide des outils de développement Chrome, la différence sera complètement évidente.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d16/c64/170/d16c64170a5ae365154626fc77eea21f.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avant d'apporter des modifications au code de la page, l'analyseur HTML s'est arrêté à la ligne 1939, après avoir rencontré un script intégré, et est resté ici pendant environ une seconde. Après l'optimisation, il a pu accéder à la ligne 5281</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Auparavant, l'analyseur s'arrêtait à la ligne 1939 et attendait le chargement de CSS, mais maintenant il atteint la ligne 5281. Là, à la fin de la page, il y a un autre script intégré qui arrête à nouveau l'analyseur.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit d'une solution rapide au problème. Ce n'est pas l'option qui représente la solution finale au problème. Changer l'ordre des éléments et se débarrasser du motif</font></font><code>preload/polyfill</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n'est que la première étape. Vous pouvez mieux résoudre ce problème en incorporant du code CSS critique dans une page, plutôt que de le charger à partir d'un fichier externe. Modèle</font></font><code>preload/polyfill</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conçu pour être utilisé en plus du CSS en ligne. </font><font style="vertical-align: inherit;">Cela nous permet d'ignorer complètement les problèmes liés aux scripts et de nous assurer que le navigateur, après la première demande, dispose de tous les styles nécessaires au rendu de la page. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais pour l'instant, il convient de noter que nous pouvons obtenir une bonne amélioration des performances en apportant de très petites modifications au projet concernant la façon dont les styles sont chargés et l'ordre des éléments dans le DOM.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sommaire</font></font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous utilisez un </font></font><code>loadCSS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">modèle </font></font><code>preload/polyfill</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, accédez au modèle de chargement de style </font></font><code>print</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous avez des styles externes qui sont chargés de la manière habituelle (c'est-à-dire en utilisant des liens réguliers vers des fichiers de ces styles), déplacez tous les scripts intégrés qui peuvent être déplacés au-dessus des liens pour charger des styles.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intégrez des styles critiques dans la page afin d'assurer le démarrage le plus rapide possible du rendu.</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chers lecteurs! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avez-vous rencontré des problèmes pour ralentir le rendu des pages en raison de CSS? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RUVDS félicite tous les professionnels de l'informatique le 8 mars! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette année, nous avons décidé de ne pas donner de tulipes et de ne pas faire de sélection de cadeaux geek. </font><font style="vertical-align: inherit;">Nous avons pris un chemin différent et créé la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">page IT is female</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour montrer la présence de femmes spécialistes en informatique.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr490618/index.html">Goroutine Stack Buffers</a></li>
<li><a href="../fr490620/index.html">Quand j'entends les mots "restauré le réseau neuronal", je grimpe pour vérifier les sauvegardes</a></li>
<li><a href="../fr490622/index.html">Lutte contre les fuites de mémoire dans les applications Web</a></li>
<li><a href="../fr490624/index.html">En-tête HTTP et contrôle du navigateur Web</a></li>
<li><a href="../fr490626/index.html">Un guide complet des attributs data- * HTML</a></li>
<li><a href="../fr490630/index.html">Chargement de tableaux NumPy à partir du disque: comparaison de memmap () et Zarr / HDF5</a></li>
<li><a href="../fr490634/index.html">Événements numériques à Moscou du 2 au 8 mars</a></li>
<li><a href="../fr490636/index.html">Événements numériques à Saint-Pétersbourg du 2 au 8 mars</a></li>
<li><a href="../fr490640/index.html">Surcharge en C ++. Partie III. Surcharge des instructions new / delete</a></li>
<li><a href="../fr490642/index.html">Plugin pour la surveillance des applications K8s DevOpsProdigy KubeGraf v1.3.0: nouvelle version et nouvelles fonctionnalités</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>