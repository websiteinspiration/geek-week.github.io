<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úåüèº üòä ‚õÑÔ∏è Was ist Windows PowerShell und was isst es? Teil 5: Zugriff auf externe Objekte üöµüèø üíΩ üòè</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Windows-Betriebssysteme unterst√ºtzen eine Vielzahl von Objektinfrastrukturen. Sie k√∂nnen Anwendungsprogrammierschnittstellen (APIs) verwenden, um auf ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Was ist Windows PowerShell und was isst es? Teil 5: Zugriff auf externe Objekte</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/498478/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/-b/i_/73/-bi_73lwdxmnzvtveeghrwvtqay.png"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows-Betriebssysteme unterst√ºtzen eine Vielzahl von Objektinfrastrukturen. </font><font style="vertical-align: inherit;">Sie k√∂nnen Anwendungsprogrammierschnittstellen (APIs) verwenden, um auf sie zuzugreifen. Die Entwicklung vollwertiger Anwendungen ist jedoch nicht immer gerechtfertigt. </font><font style="vertical-align: inherit;">PowerShell verf√ºgt √ºber spezielle Cmdlets, mit denen Sie interaktiv auf .NET-, COM-, WMI- (CIM) und ADSI-Objekte zugreifen k√∂nnen. </font><font style="vertical-align: inherit;">Im </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vierten Teil der Serie haben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wir die Grundlagen mit Schwerpunkt auf .NET Core-Klassen gelernt. Jetzt m√∂chten wir das Thema vertiefen und die Funktionen der PowerShell-Interaktion mit externen Objekten verstehen.</font></font><a name="habracut"></a><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inhaltsverzeichnis:</font></font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arbeiten mit JSON, XML und CSV </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arbeiten mit WMI und CIM </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arbeiten mit COM-Objekten </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arbeiten mit ADSI-Verzeichnisdienst </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formatieren der Ausgabe</font></font></a><br>
<br>
<a name="section1"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arbeiten Sie mit JSON, XML und CSV</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In PowerShell-Skripten m√ºssen Sie h√§ufig JSON-, XML- und CSV-Daten analysieren. Normalerweise tritt dieser Bedarf bei der Arbeit mit Internetdiensten oder mit Konfigurationsdateien auf. Einige Administratoren versuchen, Daten mit regul√§ren Ausdr√ºcken zu analysieren, aber es ist nicht erforderlich, solche Opfer zu bringen: PowerShell verf√ºgt au√üerdem √ºber spezielle Cmdlets f√ºr die Konvertierung in beide Richtungen.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ep/q6/tr/epq6trkxgw_sfw21p1wmfixyrfk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das JSON-Format erm√∂glicht die Beschreibung einer Vielzahl von Objekten und ist im Wesentlichen eine Hashtabelle, die verschachtelt werden kann. </font><font style="vertical-align: inherit;">Das entsprechende Konvertieren eines JSON-Objekts in ein .NET-Objekt mithilfe von PowerShell ist einfach. </font><font style="vertical-align: inherit;">Da Internetdienste normalerweise eine sehr lange Zeile anstelle einer sch√∂n formatierten Datei angeben, kann diese Konvertierung auch f√ºr die Arbeit im interaktiven Modus hilfreich sein. </font><font style="vertical-align: inherit;">Im folgenden Beispiel haben wir eine mehrzeilige Textvariable verwendet, um das JSON-Objekt zu beschreiben:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$user</span> = <span class="hljs-string">@"
{
   "firstName": "Ivan",
   "lastName": "Danko",
   "address": {
       "streetAddress": "Kremlin",
       "city": "Moscow"
   },
   "phoneNumbers": [
       "+7 495 1234567",
       "+7 499 1234567"
   ]
}
"@</span> | <span class="hljs-built_in">ConvertFrom-Json</span>
</code></pre><br>
<img src="https://habrastorage.org/webt/vu/2j/x6/vu2jx6vrks90qvsuoehs6ky43ke.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das umgekehrte Problem wird auf √§hnliche Weise gel√∂st:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$file</span> = <span class="hljs-built_in">Get-ChildItem</span> C:\Windows\System32\notepad.exe
<span class="hljs-variable">$file</span>.VersionInfo | <span class="hljs-built_in">ConvertTo-Json</span></code></pre><br>
<img src="https://habrastorage.org/webt/rd/tb/dq/rdtbdqlfwsepqmnggw_2uk7omkw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die resultierende Zeichenfolge im JSON-Format kann einfach √ºber das Netzwerk an eine andere Anwendung gesendet werden. </font><font style="vertical-align: inherit;">Dies kann beispielsweise ein RESTful-Service sein. </font><font style="vertical-align: inherit;">Die Arbeit mit den Cmdlets ConvertFrom-Csv, ConvertTo-Csv und ConvertTo-Xml erfolgt ungef√§hr auf die gleiche Weise. Wir empfehlen den Lesern, sie selbst zu studieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um mit XML und CSV arbeiten zu k√∂nnen, ben√∂tigen wir andere Cmdlets: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jz/hy/m7/jzhym7nqvb5id7fvdys9ao59meq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit diesen Tools m√ºssen Sie verstehen, dass beim Konvertieren eines Bin√§robjekts in ein Textformat nur der Wert seiner Eigenschaften gespeichert wird, nicht jedoch die Methoden. </font><font style="vertical-align: inherit;">Das Konvertieren von JSON-, XML- oder CSV-Daten in ein .NET-Objekt mit PowerShell ist nur m√∂glich, wenn es g√ºltig ist.</font></font><br>
<br>
<a name="section2"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arbeiten Sie mit WMI und CIM</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows Management Instrumentation (WMI) ist eine von Microsoft entwickelte und Windows-angepasste Implementierung des WBEM-Standards (Web-Based Enterprise Management). Es basiert auf der Idee, eine universelle L√∂sung f√ºr die √úberwachung der verteilten Informationsumgebung eines Unternehmens und die Verwaltung seiner Komponenten zu schaffen. Die WBEM-Datenstruktur basiert wiederum auf dem Common Information Model (CIM), das einen objektorientierten Ansatz zur Darstellung von Computersystemen implementiert. Die Weiterentwicklung und Unterst√ºtzung von WMI unter Windows wurde eingestellt. Microsoft empfiehlt die Verwendung eines √§hnlichen Mechanismus f√ºr die Verwaltung der Infrastruktur - CIM-Objekte. Um mit ihnen zu arbeiten, wurden in PowerShell 3.0 spezielle Cmdlets angezeigt, die wir parallel zu WMI-Gegenst√ºcken betrachten werden. Wenn der Code Cmdlet-Aufrufe f√ºr die Arbeit mit WMI enth√§lt, sollte er nach M√∂glichkeit neu geschrieben werden.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/h6/io/mw/h6iomwnjjrssdkl_tw7gi0mwjhm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Rahmen des CIM-Modells (es wird auch in WMI verwendet) werden die Betriebssystemdaten in Form von Klassen mit Eigenschaften und Methoden dargestellt. Die Klassen sind hierarchisch geordnet und nach Namespace-Technologie oder Verwaltungsbereich logisch verkn√ºpft. Es gibt einen Root-Root-Namespace mit Unterbereichen: CIMv2, Default, Secutiry und WMI. Zur eindeutigen Identifizierung einer Instanz einer Klasse (eines Objekts) und zur Beschreibung des Status der entsprechenden Ressource werden Klasseneigenschaften verwendet, die normalerweise schreibgesch√ºtzt sind. Methoden werden zum Verwalten der Ressource verwendet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf die Klasseninstanz kann √ºber den vollst√§ndigen Pfad zugegriffen werden, der die folgende Form hat:</font></font><br>
<br>
<pre><code class="powershell hljs">[\\<span class="hljs-type">ComputerName</span>\<span class="hljs-type">NameSpace</span>][:<span class="hljs-type">ClassName</span>][<span class="hljs-type">.KeyProperty1</span>=<span class="hljs-type">Value1</span>][,<span class="hljs-type">KeyProperty2</span>=<span class="hljs-type">Value2</span>]‚Ä¶]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dabei ist </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Computername der Name des Computers. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NameSpace - Namespace; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Klassenname - der Name der Klasse; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
KeyProperty1 = Wert1, KeyProperty2 = Wert2 - die Eigenschaften des Objekts und die Werte, anhand derer es identifiziert wird.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vor PowerShell gab es kein einfaches WMI-Tool. </font><font style="vertical-align: inherit;">Um auf die Objekte zugreifen zu k√∂nnen, mussten Sie ziemlich komplexe Programme in Hochsprachen (C ++, Visual Basic, Java Script) schreiben oder die WMIC-Shell (WMI Command Line, die ebenfalls eingestellt wird) in einer eigenen Sprache studieren. </font><font style="vertical-align: inherit;">√úber PowerShell k√∂nnen WMI-Objekte √ºber die Befehlszeile oder in Skripten auf den durchschnittlichen Benutzer zugegriffen werden. </font><font style="vertical-align: inherit;">Stellen Sie zun√§chst eine Verbindung zum WMI-Subsystem her und rufen Sie mithilfe des Cmdlets Get-WmiObject (alias gwmi) eine Liste der verf√ºgbaren Klassen ab. </font><font style="vertical-align: inherit;">Verwenden Sie das Cmdlet Get-CimClass, um eine Liste der CIM-Klassen abzurufen.</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-CimClass</span>
<span class="hljs-built_in">Get-WmiObject</span> <span class="hljs-literal">-List</span></code></pre><br>
<img src="https://habrastorage.org/webt/g7/1z/wz/g71zwzueejpnyrgwqkoqpxlwn7a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben die Klassen auf dem lokalen Computer aufgelistet, aber Sie k√∂nnen eine Verbindung zur Fernbedienung herstellen:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-CimClass</span> <span class="hljs-literal">-ComputerName</span> IP- 
<span class="hljs-built_in">Get-CimClass</span> <span class="hljs-literal">-ComputerName</span> _</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
oder</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-WmiObject</span> <span class="hljs-literal">-ComputerName</span> IP- <span class="hljs-literal">-List</span>
<span class="hljs-built_in">Get-WmiObject</span> <span class="hljs-literal">-ComputerName</span> _ <span class="hljs-literal">-List</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Standardm√§√üig stellen die Cmdlets Get-CimClass und Get-WmiObject eine Verbindung zum Namespace Root \ CIMV2 her, in dem eine gro√üe Anzahl von Klassen f√ºr die Verwaltung des Systems gespeichert ist. </font><font style="vertical-align: inherit;">Verwenden Sie den Parameter -Namespace, um den Namespace zu √§ndern:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-CimClass</span> <span class="hljs-literal">-Namespace</span> Root
<span class="hljs-built_in">Get-WmiObject</span> <span class="hljs-literal">-Namespace</span> Root <span class="hljs-literal">-List</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie den Namen der Klasse kennen, ist es nicht schwierig, Instanzen davon zu erhalten. </font><font style="vertical-align: inherit;">Der folgende Befehl gibt alle Instanzen von Win32_Service zur√ºck, d. H. </font><font style="vertical-align: inherit;">Auf dem lokalen Computer registrierte Dienste:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-WmiObject</span> Win32_Service</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie bei anderen Objekttypen wird mit Get-Member eine Liste der Eigenschaften und Methoden angezeigt. </font><font style="vertical-align: inherit;">Auf WMI-Objektmethoden kann direkt oder √ºber das Cmdlet Invoke-WmiMethod zugegriffen werden. </font><font style="vertical-align: inherit;">Sie k√∂nnen auch Cmdlets f√ºr WMI-Objekte zum Sortieren, Filtern, Gruppieren usw. verwenden.</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-WmiObject</span> Win32_Service | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/pq/rn/nk/pqrnnkbv1abfqzn5hlnsgunzamu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verwenden Sie das Cmdlet Get-CimInstance, um CIM-Objekte (Instanzen von Klassen) abzurufen. </font><font style="vertical-align: inherit;">Im Gegensatz zu WMI enthalten die resultierenden CIM-Objekte (resultierende Objekt- oder Klasseninstanzen) keine Klassenmethoden. </font><font style="vertical-align: inherit;">Da Sie eine Methode nicht direkt extrahieren k√∂nnen, m√ºssen Sie das Cmdlet Invoke-CimMethod aufrufen. </font><font style="vertical-align: inherit;">Betrachten Sie die Win32_Service-Klasse (auf dem System ausgef√ºhrte Dienste) und ihre Instanz f√ºr den Spooler-Dienst auf dem lokalen Computer:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-CimInstance</span> Win32_service <span class="hljs-literal">-filter</span> <span class="hljs-string">"Name='spooler'"</span> </code></pre><br>
<img src="https://habrastorage.org/webt/qm/jf/cz/qmjfcz-_u-le6js9tibb3qc5y2i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen wir uns die Struktur des resultierenden Objekts an:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-CimInstance</span> Win32_service <span class="hljs-literal">-filter</span> <span class="hljs-string">"Name='spooler'"</span> | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/t4/uo/ub/t4uoublc7mxrlb6khyrycfozod4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zu diesem Zeitpunkt sind die Vorteile von Cmdlets f√ºr die Arbeit mit CIM-Objekten nicht offensichtlich. </font><font style="vertical-align: inherit;">Sie beziehen sich haupts√§chlich auf Remote-Arbeit in einer verteilten Umgebung und werden im letzten Artikel der Reihe zur L√∂sung praktischer Verwaltungsprobleme ausf√ºhrlich er√∂rtert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt auch ein WMI-spezifisches Toolkit: die WMI Query Language (WQL), eine SQL-√§hnliche Abfragesprache. </font><font style="vertical-align: inherit;">Eine WQL-Abfrage zum Suchen nach allen Starts beim Starten eines Service-Systems sieht folgenderma√üen aus:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">select</span> * from win32_service <span class="hljs-built_in">where</span> startmode=<span class="hljs-string">"Auto"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In PowerShell werden sie wie folgt ausgef√ºhrt:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-WmiObject</span> <span class="hljs-literal">-Query</span> <span class="hljs-string">'select * from win32_service where startmode="Auto"'</span></code></pre><br>
<img src="https://habrastorage.org/webt/wc/y7/wf/wcy7wfk7619yx_9es0cjz9bi4vw.png"><br>
<br>
<a name="section3"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arbeiten Sie mit COM-Objekten</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Interaktion zwischen Anwendungen in Windows sicherzustellen, wurde eine Technologie zum Verkn√ºpfen und Einbetten von Objekten (Object Linking and Embedding oder OLE) entwickelt. Sp√§ter erschien die OLE-Automatisierungstechnologie, mit deren Hilfe Automatisierungsclientanwendungen Funktionen anderer Anwendungen aufrufen konnten - Automatisierungsserver. OLE und OLE Automation basierten auf der Kerntechnologie des Component Object Model (COM), das einen einzigen Bin√§rstandard f√ºr Softwarekomponenten bietet. Mit ihm erstellte und im Betriebssystem registrierte Objekte k√∂nnen in anderen Anwendungen mit ausf√ºhrbaren Dateien oder dynamischen Bibliotheken verwendet werden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Mitte der neunziger Jahre wurde anstelle von OLE ein anderer Begriff verwendet - ActiveX. </font><font style="vertical-align: inherit;">Vor dem Aufkommen der .NET-Plattform galt die ActiveX-Technologie als Schl√ºssel, und COM-Objekte werden immer noch aktiv zur Integration von Anwendungen in Windows verwendet. Viele Microsoft- und Drittanbieterprodukte sind Automatisierungsserver und bieten √ºber diese Zugriff auf ihre Dienste. </font><font style="vertical-align: inherit;">F√ºr den Zugriff auf Objekte wird ProgID verwendet - eine symbolische Kennung, die ihnen bei der Registrierung in der Windows-Registrierung zugewiesen wird. </font><font style="vertical-align: inherit;">Es hat die folgende Form:</font></font><br>
<br>
<pre><code class="powershell hljs">_..</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Version wird normalerweise nicht angegeben:</font></font><br>
<br>
<pre><code class="powershell hljs">_.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einige Beispiele f√ºr verf√ºgbare ProgIDs sind: InternetExplorer.Application (Internet Explorer-Anwendung), Word.Application (Microsoft Word-Anwendung), WScript.Shell (Shell-Klasse vom Windows Script Host- oder WSH-Script Server-Objektmodell). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie k√∂nnen eine Instanz des Objekts mit dem im vorherigen Artikel beschriebenen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cmdlet "Neues Objekt" erstellen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und dessen Struktur mit "Get-Member" </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">anzeigen</font></a><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span> = <span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-ComObject</span> WScript.Shell
<span class="hljs-variable">$myshell</span> | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/bk/s5/fh/bks5fhq3q-yhle1fwb4-vjkqpk0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr die Arbeit mit Objekten werden Eigenschaften und Methoden verwendet. </font><font style="vertical-align: inherit;">Um beispielsweise eine Verkn√ºpfung auf dem Desktop des Benutzers zu erstellen, m√ºssen Sie die CreateShortcut () -Methode aufrufen:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$link</span> = <span class="hljs-variable">$myshell</span>.CreateShortcut(<span class="hljs-string">"<span class="hljs-variable">$Home</span>\Desktop\Home.lnk"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beachten Sie, dass die Verkn√ºpfung auch ein COM-Objekt ist:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$link</span> | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/05/d8/4_/05d84_-mbzmfuffczrmr76khfyg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es bleibt uns √ºberlassen, seine Eigenschaften auszuf√ºllen und zu speichern:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$link</span>.TargetPath = <span class="hljs-variable">$Home</span>
<span class="hljs-variable">$link</span>.Save()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf diese Weise haben wir eine Verkn√ºpfung auf dem Desktop des aktiven Benutzers erstellt und analysieren nun die Arbeit mit externen Automatisierungsdiensten am Beispiel des Shell.Application COM-Objekts. </font><font style="vertical-align: inherit;">Damit k√∂nnen Sie einige Aktionen im Windows Explorer automatisieren:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span>=<span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-ComObject</span> Shell.Application</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
oder kurz:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span>=<span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-com</span> Shell.Application
<span class="hljs-variable">$myshell</span> | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/__/iu/qy/__iuqyjf29nliwugz-jybihkfj0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Shell.Application-Objekt verf√ºgt √ºber einige verschiedene Fensterverwaltungsmethoden. </font><font style="vertical-align: inherit;">Um beispielsweise den Inhalt eines bestimmten Verzeichnisses anzuzeigen, wird Explore () verwendet:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span>.Explore(<span class="hljs-string">"c:\"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Hilfesystem wird mit der Help () -Methode aufgerufen:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span>.Help()</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt auch drei Methoden zum Aufrufen von Suchdialogen: FindFiles (), FindComputer () und FindPrinter ().</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span>.FindFiles()
<span class="hljs-variable">$myshell</span>.FindComputer()
<span class="hljs-variable">$myshell</span>.FindPrinter()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie k√∂nnen den Programmstartdialog mit der FileRun () -Methode √∂ffnen. Um das Fenster zur Einstellung von Datum und Uhrzeit aufzurufen, ben√∂tigen Sie die SetTime () -Methode. </font><font style="vertical-align: inherit;">Es gibt beispielsweise Methoden zum Aufrufen des Einstellungsfensters der Taskleiste, Elemente der Systemsteuerung, die eine der verf√ºgbaren CPL-Dateien angeben, zum Verwalten ge√∂ffneter Fenster:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span>.MinimizeAll()
<span class="hljs-variable">$myshell</span>.UndoMinimizeAll()
<span class="hljs-variable">$myshell</span>.TileHorizontally()
<span class="hljs-variable">$myshell</span>.TileVertically()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit der Windows () -Methode k√∂nnen Sie im Explorer oder im Internet Explorer auf die Sammlung ge√∂ffneter Fenster zugreifen. </font><font style="vertical-align: inherit;">Sehen wir uns die Eigenschaften und Methoden an, die f√ºr diese Sammlung verf√ºgbar sind:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span>.Windows() | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/dq/ls/yo/dqlsyokgkrtk6rc-okuskmpwsvo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt andere n√ºtzliche COM-Objekte, deren Anzahl von der im System installierten Software abh√§ngt. </font><font style="vertical-align: inherit;">Das Hauptautomatisierungstool in Windows war einst der WSH-Skriptserver, dessen Objektmodell auch COM-Objekte enth√§lt: Entwickelt f√ºr die bereits erw√§hnten Netzwerkfunktionen von WScript.Network und WScript.Shell. </font><font style="vertical-align: inherit;">Letzteres erstellt nicht nur Verkn√ºpfungen auf dem Desktop, mit dessen Hilfe Sie beispielsweise Informationsfenster mit Meldungen und Schaltfl√§chen anzeigen, zwischen Anwendungen wechseln, Programme starten oder Tastenanschl√§ge simulieren k√∂nnen.</font></font><br>
<br>
<a name="section4"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arbeiten mit dem ADSI-Verzeichnisdienst</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen bezieht sich ein Katalog auf eine Informationsquelle, in der Daten zu einigen Objekten gespeichert sind. Mit Verzeichnisdienst ist ein Teil eines verteilten Computersystems gemeint, mit dem Sie auf gespeicherte Objekte zugreifen und diese bearbeiten k√∂nnen. Ein Verzeichnisdienst kann Daten zu Netzwerkobjekten und den Diensten, die diese bearbeiten, kombinieren. Er stellt einen einzigen Einstiegspunkt f√ºr die Interaktion mit Netzwerkressourcen dar. In einem heterogenen Computernetzwerk k√∂nnen viele solcher Dienste vorhanden sein: ein lokaler SAM (Security Account Manager) f√ºr Computer ohne Dom√§ne, Active Directory usw.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Interaktion mit verschiedenen Verzeichnisdiensten erfordert unterschiedliche Tools, was zu gewissen Unannehmlichkeiten f√ºhrt. Ab Windows 2000 hat Microsoft die ADSI-Technologie (Unified Active Directory Service Interface) f√ºr Betriebssysteme eingef√ºhrt, die nicht von einem bestimmten Netzwerkzugriffsprotokoll abh√§ngig sind. Um Objekte zu finden, wird ein Namespace f√ºr das Verzeichnis definiert. Da verschiedene Verzeichnisdienste unterschiedliche Benennungsmethoden verwenden, definiert ADSI eine Konvention, die jedes Objekt eindeutig identifiziert. Das Konzept der zweiteiligen Bindungszeichenfolgen oder ADsPath wird vorgestellt. Der erste Teil des Namens definiert den Verzeichnisdienst (ADSI-Anbieter) und der zweite den Speicherort des Objekts im Verzeichnis. Hier sind Beispiele f√ºr die Bezeichnung verschiedener ADSI-Anbieter: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LDAP: //</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wird f√ºr LDAP-basierte Verzeichnisdienste verwendet, einschlie√ülich </font><font style="vertical-align: inherit;">f√ºr Active Directory; </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WinNT: //</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wird f√ºr lokale Computer verwendet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt keine speziellen Cmdlets f√ºr die Arbeit mit ADSI in PowerShell. </font><font style="vertical-align: inherit;">Stattdessen wird der Cast-Operator [ADSI] gefolgt von einer Bindungszeichenfolge verwendet. </font><font style="vertical-align: inherit;">Um beispielsweise √ºber die Dom√§ne test.ru eine Verbindung zum Benutzer Ivanov herzustellen, ist die folgende Konstruktion erforderlich:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$user</span> = [<span class="hljs-type">ADSI</span>]<span class="hljs-string">"LDAP://CN=Ivanov,DC=TEST,DC=RU"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um mit lokalen Konten arbeiten zu k√∂nnen, m√ºssen Sie eine Verbindung zum Computer mit dem entsprechenden Namen herstellen (um eine Verbindung zum lokalen Computer herzustellen, verwenden Sie einfach den Punkt anstelle des Namens):</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$computer</span> = [<span class="hljs-type">ADSI</span>]<span class="hljs-string">"WinNT://."</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie beispielsweise einen neuen Benutzer, Ivanov, auf dem lokalen Computer:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$user</span> = <span class="hljs-variable">$computer</span>.Create(<span class="hljs-string">"user"</span>,<span class="hljs-string">"Ivanov"</span>)
<span class="hljs-variable">$user</span>.Put(<span class="hljs-string">"Description"</span>,<span class="hljs-string">"  PowerShell"</span>)
<span class="hljs-variable">$user</span>.SetInfo()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verbinden Sie sich jetzt damit:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$user1</span> = [<span class="hljs-type">ADSI</span>]<span class="hljs-string">"WinNT://./Ivanov,user"</span>
<span class="hljs-variable">$user1</span>.Description</code></pre><br>
<img src="https://habrastorage.org/webt/pb/9l/5m/pb9l5mpw09oocoetnw3x4iawzmm.png"><br>
<br>
<a name="section5"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ausgabeformatierung</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Interaktive Arbeit erfordert h√§ufig die Anzeige von Daten. In anderen Shells sind die Befehle und Dienstprogramme selbst mit der Formatierung der Ausgabe besch√§ftigt, aber bin√§re Objekte, die von Funktionen und Cmdlets zur√ºckgegeben werden, wissen normalerweise nicht, wie dies zu tun ist. In PowerShell wird die Ausgabe von vier speziellen Cmdlets formatiert, die Objekte durch die Pipeline f√ºhren. Detailliertere Informationen erhalten Sie mit Get-Help: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Format-Table</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> formatiert die Ausgabe in Form einer Tabelle, deren Spalten die Werte der Objekteigenschaften oder berechneten Werte enthalten. Die M√∂glichkeit, Daten zu gruppieren, wird unterst√ºtzt. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Format-List</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zeigt das Objekt als Liste von Eigenschaften an, von denen jede in einer neuen Zeile angezeigt wird. Die M√∂glichkeit, Daten zu gruppieren, wird unterst√ºtzt. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Format-benutzerdefiniert</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formate, die mithilfe einer benutzerdefinierten Ansicht ausgegeben werden; </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formatweit</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> formatiert Objekte in Form einer breiten Tabelle, in der nur eine Eigenschaft jedes Objekts angezeigt wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn keines der aufgelisteten Cmdlets aufgerufen wird, wird das Formatierungsmodul verwendet, das dem angezeigten Datentyp entspricht. Anzeigeregeln werden in Konfigurationsdateien im XML-Format mit der Erweiterung .ps1xml gespeichert, die sich im Verzeichnis $ PSHome befinden. Eine Liste von ihnen kann mit dem folgenden Befehl abgerufen werden:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">dir</span> <span class="hljs-variable">$pshome</span>\*format*.ps1xm</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das manuelle Bearbeiten von Konfigurationsdateien wird nicht empfohlen. Es ist besser, eigene Dateien zu erstellen und diese mit dem Cmdlet Update-FormatData in die Liste der heruntergeladenen Dateien aufzunehmen. Wenn der Standardformatierer f√ºr den gew√ºnschten Typ nicht definiert ist, zeigt PowerShell die Eigenschaften des Objekts auf dem Bildschirm in einer Liste an. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Damit ist die Beschreibung der Arbeit mit Objekten in PowerShell abgeschlossen. Der letzte Artikel der Reihe befasst sich mit der L√∂sung praktischer Probleme bei der Verwaltung einer verteilten Informationsumgebung eines Unternehmens. Darin sind alle beschriebenen Werkzeuge f√ºr uns n√ºtzlich. Das Hauptaugenmerk wird auf CIM-Objekten und deren Vergleich mit WMI liegen. Fr√ºhere Teile finden Sie unter den folgenden Links.</font></font><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> 1:   Windows PowerShell</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> 2:     Windows PowerShell</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> 3:      ,  </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> 4:   ,  </a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/iq/fi/b4/iqfib45pgphfrxv--zfemt0qnmw.jpeg"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de498458/index.html">Videoanrufe mit virtuellem Hintergrund und Open Source-Tools</a></li>
<li><a href="../de498462/index.html">Unendliche Schriftrolle mit Bannern oder Vorgehensweise mit drei Ansichten</a></li>
<li><a href="../de498466/index.html">Wie Laser und Sensoren die Richter nerv√∂s machen</a></li>
<li><a href="../de498472/index.html">Single Page Application Docker Image</a></li>
<li><a href="../de498476/index.html">Barrierefreiheit So machen Sie die Anwendung f√ºr Benutzer mit Behinderungen zug√§nglich</a></li>
<li><a href="../de498482/index.html">Situation: US-amerikanische Anbieter werden gebeten, Schwellenwerte f√ºr das Herunterladen von Daten zu entfernen - was letztendlich der Fall ist</a></li>
<li><a href="../de498484/index.html">Wi-Fi 6 und Huawei P40: Wo ist die Verbindung?</a></li>
<li><a href="../de498486/index.html">So erweitern Sie die englischsprachige Semantik f√ºr Suchmaschinenwerbung in einer engen Nische</a></li>
<li><a href="../de498490/index.html">Ein effektives Zertifizierungssystem, mit dem Sie ein besserer Marktf√ºhrer werden k√∂nnen</a></li>
<li><a href="../de498492/index.html">Schatz, wir t√∂ten B√ºrokratie: Wie die Digitalisierung den Dialog zwischen Lieferanten und X5 ver√§ndert</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>