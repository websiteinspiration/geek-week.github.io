<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕹️ 🏉 ⌚️ Create a simple table document using the ODF Toolkit 👩🏻‍🤝‍👨🏿 🤶🏻 💆🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you have a task to make a couple of simple reports, and your users use Open Office, then you do not need to use large reporting systems like Bird, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Create a simple table document using the ODF Toolkit</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500546/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you have a task to make a couple of simple reports, and your users use Open Office, then you do not need to use large reporting systems like Bird, Jasper or their analogues. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The ODF Toolkit is great for this task. </font></font></b><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ODF Toolkit</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , according to information from the official website, is a set of Java modules that allow you to create, scan or manipulate documents in the format of an open document (ISO / IEC 26300 == ODF). Unlike other approaches, which are based on runtime manipulations with heavy editors through the automation interface, the ODF Toolkit is lightweight and ideal for use on the server.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/qe/to/js/qetojs4lk0beo0y7vqpnlxymvb0.jpeg" alt="image"></div><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I work on a project to automate internal business processes and often users ask for reports on cumulative information, and due to the fact that Open Office is very common at the Agricultural Bank, Bird is used to build reports. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It allows you to generate any document format. </font><font style="vertical-align: inherit;">In principle, a great solution, simple, understandable, but it became interesting whether it is possible to implement the same thing inside Java. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So I met with the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ODF Toolkit. </font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I will describe a number of basic methods, you can learn more on the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">odftoolkit.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> project page. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So, let's start by creating a document:</font></font></b><br>
<br>
<pre><code class="java hljs">TextDocument doc = TextDocument.newTextDocument();</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After that, let's move on to creating a paragraph, and if it's Apache Poi (a similar library, but only for the word format), then it's a few lines, and here everything is quite concise:</font></font><br>
<br>
<pre><code class="java hljs">Paragraph subparagraphHeaderOne = doc.addParagraph(“”);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And if we want to assign the text in the next step, then we can use a similar construction:</font></font><br>
<br>
<pre><code class="java hljs">Paragraph subparagrafFilial = paragraphHeader.addParagraph(<span class="hljs-keyword">null</span>);</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An example of creating an Apache poi paragraph:</font></font></b><br>
<br>
<pre><code class="java hljs">XWPFParagraph paragraphHeader = xwpfDocument.createParagraph();<font></font>
   XWPFRun subpargraphHeader = paragraphHeader.createRun();<font></font>
        subpargraphHeader.setText(“”);<font></font>
        subpargraphHeader.addBreak();</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Personally, I am enthralled by such conciseness, but continue on. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Creating styles for a paragraph:</font></font></b><br>
<br>
<pre><code class="java hljs">OdfOfficeStyles styles = doc.getOrCreateDocumentStyles ();<font></font>
       OdfStyle style = styles.newStyle ( <span class="hljs-string">"Source Text"</span>, OdfStyleFamily.Paragraph );<font></font>
          style.setProperty ( OdfParagraphProperties.VerticalAlign, <span class="hljs-string">"#middle"</span>);<font></font>
          paragraph.getOdfElement().setStyleName(<span class="hljs-string">"Source Text"</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But there is a small problem, according to official documentation, style assignment happens like this:</font></font><br>
<br>
<pre><code class="java hljs">paragraph.setStyleName(<span class="hljs-string">"Source Text"</span>)</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/pq/dt/wg/pqdtwgtr62yr40idfn6immpgeea.jpeg" alt="image"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But unfortunately, it doesn’t work that way, which cost a certain amount of nerve cells and time to find a solution. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Creating a table:</font></font></b><br>
<br>
<pre><code class="java hljs">Table TableOne = doc.addTable( , );</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Working with cells is possible both by creating a new paragraph, and directly with the cell itself </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By creating a new paragraph:</font></font></b><br>
<br>
<pre><code class="java hljs">Paragraph cellOne = Paragraph.newParagraph(subparagraphTableOne.getCellByPosition(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>));<font></font>
 cellOne.appendTextContent(<span class="hljs-string">""</span>);</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Directly with a cell:</font></font></b><br>
<br>
<pre><code class="java hljs">Cell cellOne = subparagraphTableOne.getCellByPosition(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<font></font>
 cellOne.setStringValue(<span class="hljs-string">""</span>)</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Working with a table style and its borders: </font></font></b><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Create a border:</font></font></b><br>
<br>
<pre><code class="java hljs">Border border= <span class="hljs-keyword">new</span> Border(Color.WHITE, <span class="hljs-number">2</span>, StyleTypeDefinitions.SupportedLinearMeasure.PT);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first variable is the choice of the border to which the style will be applied:</font></font><br>
<br>
<pre><code class="java hljs">table.getRowByIndex(<span class="hljs-number">0</span>).getCellByIndex(<span class="hljs-number">1</span>).setBorders(StyleTypeDefinitions.CellBordersType.BOTTOM, border);</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the font style:</font></font></b><br>
<br>
<pre><code class="java hljs">Font font = <span class="hljs-keyword">new</span> Font(<span class="hljs-string">"Times New Roman"</span>, StyleTypeDefinitions.FontStyle.REGULAR, <span class="hljs-number">12</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I want to end this short review, if the project interests you, then the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">odftoolkit.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> project </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">website</font></a><font style="vertical-align: inherit;"> has a more advanced guide for working with this API. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I hope this article helps someone go the simpler way.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en500520/index.html">How to make your applications use around the world: 10 tips from CEO Wachanga</a></li>
<li><a href="../en500528/index.html">About the translation of "practice" / "practicality" without practice / practical</a></li>
<li><a href="../en500530/index.html">Canvas API Memo</a></li>
<li><a href="../en500538/index.html">Podcasts Rusbase, Medusa and KinoPoisk</a></li>
<li><a href="../en500542/index.html">Hack Age of Empires III to change shader quality settings</a></li>
<li><a href="../en500552/index.html">How to speed up code review</a></li>
<li><a href="../en500554/index.html">Golang backend server template - part 2 (REST API)</a></li>
<li><a href="../en500556/index.html">Two years of digital transformation in two months</a></li>
<li><a href="../en500558/index.html">A selection of articles on machine learning: case studies, guides and research for April 2020</a></li>
<li><a href="../en500562/index.html">Form design patterns. Book Review</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>