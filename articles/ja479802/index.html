<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘±ğŸ¿ ğŸ‘©ğŸ¿â€ğŸ¤â€ğŸ‘¨ğŸ¼ ğŸ¤·ğŸ¼ C ++ vtablesã€‚ãƒ‘ãƒ¼ãƒˆ1ï¼ˆåŸºæœ¬+å¤šé‡ç¶™æ‰¿ï¼‰ ğŸ˜Œ ğŸ‘¼ğŸ¿ ğŸŒ¬ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ã¿ãªã•ã‚“ã€ã“ã‚“ã«ã¡ã¯ï¼è¨˜äº‹ã®ç¿»è¨³ã¯ã€ã‚³ãƒ¼ã‚¹ã€ŒC ++ Developerã€ã®å­¦ç”Ÿã®ãŸã‚ã«ç‰¹åˆ¥ã«æº–å‚™ã•ã‚Œã¾ã—ãŸã€‚ã“ã®æ–¹å‘ã«ç™ºå±•ã™ã‚‹ã“ã¨ã¯èˆˆå‘³æ·±ã„ã§ã™ã‹ï¼Ÿ12æœˆ13æ—¥ã€ãƒ¢ã‚¹ã‚¯ãƒ¯æ™‚é–“ã®20:00ã«ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã§ãŠè¶Šã—ãã ã•ã„ã€‚ãƒã‚¹ã‚¿ãƒ¼ã‚¯ãƒ©ã‚¹ã€Œã‚°ãƒ¼ã‚°ãƒ«ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ã£ãŸç·´ç¿’ã€ã¸ï¼
 


 

 ,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>C ++ vtablesã€‚ãƒ‘ãƒ¼ãƒˆ1ï¼ˆåŸºæœ¬+å¤šé‡ç¶™æ‰¿ï¼‰</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/479802/"><p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¿ãªã•ã‚“ã€ã“ã‚“ã«ã¡ã¯ï¼</font><font style="vertical-align: inherit;">è¨˜äº‹ã®ç¿»è¨³ã¯ã€ã‚³ãƒ¼ã‚¹</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ŒC ++ Developerã€ã®</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å­¦ç”Ÿã®ãŸã‚ã«ç‰¹åˆ¥ã«æº–å‚™ã•ã‚Œã¾ã—ãŸ</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ã“ã®æ–¹å‘ã«ç™ºå±•ã™ã‚‹ã“ã¨ã¯èˆˆå‘³æ·±ã„ã§ã™ã‹ï¼Ÿ</font><font style="vertical-align: inherit;">12æœˆ13æ—¥ã€ãƒ¢ã‚¹ã‚¯ãƒ¯æ™‚é–“ã®20:00ã«ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã§ãŠè¶Šã—ãã ã•ã„ã€‚</font><font style="vertical-align: inherit;">ãƒã‚¹ã‚¿ãƒ¼ã‚¯ãƒ©ã‚¹</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€Œã‚°ãƒ¼ã‚°ãƒ«ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ã£ãŸç·´ç¿’ã€ã¸</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼</font></font></em></p><br>
<p><img src="https://habrastorage.org/webt/eh/lh/ox/ehlhoxzs1sz7v7xtni9lizjefxq.png"></p><br>
<p>    ,  clang  vtables (  )  RTTI (   ).        ,       .<a name="habracut"></a></p><br>
<p> ,          ,      ,   gdb.    ,        .   ,          .</p><br>
<blockquote><em></em>:      ,      ,       .       . </blockquote><p><img src="https://habrastorage.org/webt/40/po/du/40podustjhxkcl7_keexd9uea2e.png"></p><br>
<p>,   .</p><br>
<h2 id="chast-1---vtables---osnovy"> 1 â€” vtables â€” </h2><br>
<p>   :</p><br>
<pre><code class="plaintext hljs">#include &lt;iostream&gt;<font></font>
using namespace std;<font></font>
<font></font>
class NonVirtualClass {<font></font>
 public:<font></font>
  void foo() {}<font></font>
};<font></font>
<font></font>
class VirtualClass {<font></font>
 public:<font></font>
  virtual void foo() {}<font></font>
};<font></font>
<font></font>
int main() {<font></font>
  cout &lt;&lt; "Size of NonVirtualClass: " &lt;&lt; sizeof(NonVirtualClass) &lt;&lt; endl;<font></font>
  cout &lt;&lt; "Size of VirtualClass: " &lt;&lt; sizeof(VirtualClass) &lt;&lt; endl;<font></font>
}</code></pre><br>
<pre><code class="plaintext hljs">$ #    main.cpp<font></font>
$ clang++ main.cpp &amp;&amp; ./a.out<font></font>
Size of NonVirtualClass: 1<font></font>
Size of VirtualClass: 8</code></pre><br>
<p><code>NonVirtualClass</code>   1 ,    C++      .     .</p><br>
<p> <code>VirtualClass</code>  8   64- . ?      ,   vtable. vtables â€”    ,     .         ,   .</p><br>
<p>     ,   vtables,       gdb,  ,   :</p><br>
<pre><code class="plaintext hljs">#include &lt;iostream&gt;<font></font>
<font></font>
class Parent {<font></font>
 public:<font></font>
  virtual void Foo() {}<font></font>
  virtual void FooNotOverridden() {}<font></font>
};<font></font>
<font></font>
class Derived : public Parent {<font></font>
 public:<font></font>
  void Foo() override {}<font></font>
};<font></font>
<font></font>
int main() {<font></font>
  Parent p1, p2;<font></font>
  Derived d1, d2;<font></font>
<font></font>
  std::cout &lt;&lt; "done" &lt;&lt; std::endl;<font></font>
}</code></pre><br>
<pre><code class="plaintext hljs">$ #         ,  gdb<font></font>
$ clang++ -std=c++14 -stdlib=libc++ -g main.cpp &amp;&amp; gdb ./a.out<font></font>
...<font></font>
(gdb) #  gdb  -  C++<font></font>
(gdb) set print asm-demangle on<font></font>
(gdb) set print demangle on<font></font>
(gdb) #     main<font></font>
(gdb) b main<font></font>
Breakpoint 1 at 0x4009ac: file main.cpp, line 15.<font></font>
(gdb) run<font></font>
Starting program: /home/shmike/cpp/a.out<font></font>
<font></font>
Breakpoint 1, main () at main.cpp:15<font></font>
15    Parent p1, p2;<font></font>
(gdb) #    <font></font>
(gdb) n<font></font>
16    Derived d1, d2;<font></font>
(gdb) #    <font></font>
(gdb) n<font></font>
18    std::cout &lt;&lt; "done" &lt;&lt; std::endl;<font></font>
(gdb) #  p1, p2, d1, d2 -     ,   <font></font>
(gdb) p p1<font></font>
$1 = {_vptr$Parent = 0x400bb8 &lt;vtable for Parent+16&gt;}<font></font>
(gdb) p p2<font></font>
$2 = {_vptr$Parent = 0x400bb8 &lt;vtable for Parent+16&gt;}<font></font>
(gdb) p d1<font></font>
$3 = {&lt;Parent&gt; = {_vptr$Parent = 0x400b50 &lt;vtable for Derived+16&gt;}, &lt;No data fields&gt;}<font></font>
(gdb) p d2<font></font>
$4 = {&lt;Parent&gt; = {_vptr$Parent = 0x400b50 &lt;vtable for Derived+16&gt;}, &lt;No data fields&gt;}</code></pre><br>
<p>     :<br>
â€”   ,      ,     vtable;<br>
â€” vtable  p1  p2 . vtables â€”      ;<br>
â€” d1  d2  vtable-  Parent,    vtable Derived;<br>
â€”  vtables    16 (0x10)   vtable.     .</p><br>
<p>   gdb-,    vtables.     x,     .    300    ,   0x400b40.    ?     ,   vtable   0x400b50,      <code>vtable for Derived+16 (16 == 0x10)</code>.</p><br>
<pre><code class="plaintext hljs">(gdb) x/300xb 0x400b40<font></font>
0x400b40 &lt;vtable for Derived&gt;:  0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00<font></font>
0x400b48 &lt;vtable for Derived+8&gt;:    0x90    0x0b    0x40    0x00    0x00    0x00    0x00    0x00<font></font>
0x400b50 &lt;vtable for Derived+16&gt;:   0x80    0x0a    0x40    0x00    0x00    0x00    0x00    0x00<font></font>
0x400b58 &lt;vtable for Derived+24&gt;:   0x90    0x0a    0x40    0x00    0x00    0x00    0x00    0x00<font></font>
0x400b60 &lt;typeinfo name for Derived&gt;:   0x37    0x44    0x65    0x72    0x69    0x76    0x65    0x64<font></font>
0x400b68 &lt;typeinfo name for Derived+8&gt;: 0x00    0x36    0x50    0x61    0x72    0x65    0x6e    0x74<font></font>
0x400b70 &lt;typeinfo name for Parent+7&gt;:  0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00<font></font>
0x400b78 &lt;typeinfo for Parent&gt;: 0x90    0x20    0x60    0x00    0x00    0x00    0x00    0x00<font></font>
0x400b80 &lt;typeinfo for Parent+8&gt;:   0x69    0x0b    0x40    0x00    0x00    0x00    0x00    0x00<font></font>
0x400b88:   0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00<font></font>
0x400b90 &lt;typeinfo for Derived&gt;:    0x10    0x22    0x60    0x00    0x00    0x00    0x00    0x00<font></font>
0x400b98 &lt;typeinfo for Derived+8&gt;:  0x60    0x0b    0x40    0x00    0x00    0x00    0x00    0x00<font></font>
0x400ba0 &lt;typeinfo for Derived+16&gt;: 0x78    0x0b    0x40    0x00    0x00    0x00    0x00    0x00<font></font>
0x400ba8 &lt;vtable for Parent&gt;:   0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00<font></font>
0x400bb0 &lt;vtable for Parent+8&gt;: 0x78    0x0b    0x40    0x00    0x00    0x00    0x00    0x00<font></font>
0x400bb8 &lt;vtable for Parent+16&gt;:    0xa0    0x0a    0x40    0x00    0x00    0x00    0x00    0x00<font></font>
0x400bc0 &lt;vtable for Parent+24&gt;:    0x90    0x0a    0x40    0x00    0x00    0x00    0x00    0x00<font></font>
...</code></pre><br>
<blockquote>:    - (demangled) .    , _ZTV â€”    vtable, _ZTS â€”      (),  _ZTI  typeinfo.</blockquote><br>
<hr><br>
<p>  <code>vtable Parent</code>:</p><br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>0x400ba8</td>
<td>0x0</td>
<td>top_offset (   )</td>
</tr>
<tr>
<td>0x400bb0</td>
<td>0x400b78</td>
<td>  typeinfo for Parent (     )</td>
</tr>
<tr>
<td>0x400bb8</td>
<td>0x400aa0</td>
<td>  Parent::Foo() <em>(1)</em>. _vptr Parent  .</td>
</tr>
<tr>
<td>0x400bc0</td>
<td>0x400a90</td>
<td>  Parent::FooNotOverridden() <em>(2)</em></td>
</tr>
</tbody>
</table></div><br>
<p>  <code>vtable Derived</code>:</p><br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>0x400b40</td>
<td>0x0</td>
<td>top_offset (   )</td>
</tr>
<tr>
<td>0x400b48</td>
<td>0x400b90</td>
<td>  typeinfo for Derived (     )</td>
</tr>
<tr>
<td>0x400b50</td>
<td>0x400a80</td>
<td>  Derived::Foo() <em>(3)</em>.,_vptr Derived  .</td>
</tr>
<tr>
<td>0x400b58</td>
<td>0x400a90</td>
<td>  Parent::FooNotOverridden() ( ,    Parent)</td>
</tr>
</tbody>
</table></div><br>
<p>1:</p><br>
<pre><code class="plaintext hljs">(gdb) # ,       <font></font>
0x400aa0<font></font>
(gdb) info symbol 0x400aa0<font></font>
Parent::Foo() in section .text of a.out</code></pre><br>
<p>2:</p><br>
<pre><code class="plaintext hljs">(gdb) info symbol 0x400a90<font></font>
Parent::FooNotOverridden() in section .text of a.out</code></pre><br>
<p>3:</p><br>
<pre><code class="plaintext hljs">(gdb) info symbol 0x400a80<font></font>
Derived::Foo() in section .text of a.out</code></pre><br>
<p>,   vtable  Derived    +16   vtable?       .   ?   â€”  2 <em> sizeof(void</em>)   vtable.   typeinfo?     .</p><br>
<p>  â€”     typeinfo?</p><br>
<p><code>Parent</code>:</p><br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>0x400b78</td>
<td>0x602090</td>
<td>    type_info <em>(1)</em></td>
</tr>
<tr>
<td>0x400b80</td>
<td>0x400b69</td>
<td>,    <em>(2)</em></td>
</tr>
<tr>
<td>0x400b88</td>
<td>0x0</td>
<td>0     typeinfo</td>
</tr>
</tbody>
</table></div><br>
<p>   <code>typeinfo Derived</code>:</p><br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>0x400b90</td>
<td>0x602210</td>
<td>    type_info <em>(3)</em></td>
</tr>
<tr>
<td>0x400b98</td>
<td>0x400b60</td>
<td>,    <em>(4)</em></td>
</tr>
<tr>
<td>0x400ba0</td>
<td>0x400b78</td>
<td>   typeinfo Parent</td>
</tr>
</tbody>
</table></div><br>
<p>1:</p><br>
<pre><code class="plaintext hljs">(gdb) info symbol 0x602090<font></font>
vtable for __cxxabiv1::__class_type_info@@CXXABI_1.3 + 16 in section .bss of a.out</code></pre><br>
<p>2:</p><br>
<pre><code class="plaintext hljs">(gdb) x/s 0x400b69<font></font>
0x400b69 &lt;typeinfo name for Parent&gt;:    "6Parent"</code></pre><br>
<p>3:</p><br>
<pre><code class="plaintext hljs">(gdb) info symbol 0x602210<font></font>
vtable for __cxxabiv1::__si_class_type_info@@CXXABI_1.3 + 16 in section .bss of a.out</code></pre><br>
<p>4:</p><br>
<pre><code class="plaintext hljs">(gdb) x/s 0x400b60<font></font>
0x400b60 &lt;typeinfo name for Derived&gt;:   "7Derived"</code></pre><br>
<p>      __si_class_type_info,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>.</p><br>
<p>     gdb,     .  ,        , , ,     .   ,      2  3,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> 4</a>.</p><br>
<h2 id="chast-2---mnozhestvennoe-nasledovanie"> 2 â€”  </h2><br>
<p>      .      ,      vtable,       .</p><br>
<p>   ,   ,        .</p><br>
<p>    :</p><br>
<pre><code class="plaintext hljs">class Mother {<font></font>
 public:<font></font>
  virtual void MotherMethod() {}<font></font>
  int mother_data;<font></font>
};<font></font>
<font></font>
class Father {<font></font>
 public:<font></font>
  virtual void FatherMethod() {}<font></font>
  int father_data;<font></font>
};<font></font>
<font></font>
class Child : public Mother, public Father {<font></font>
 public:<font></font>
  virtual void ChildMethod() {}<font></font>
  int child_data;<font></font>
};</code></pre><br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th> Child</th>
</tr>
</thead>
<tbody>
<tr>
<td>_vptr$Mother</td>
</tr>
<tr>
<td>mother_data (+ )</td>
</tr>
<tr>
<td>_vptr$Father</td>
</tr>
<tr>
<td>father_data</td>
</tr>
<tr>
<td>child_data <em>(1)</em></td>
</tr>
</tbody>
</table></div><br>
<p> ,   2  vtable.     1  3  (Mother, Father  Child).        (   ),    ,     vtable Child   vtable Mother,    1 .</p><br>
<p>  Child      vtable    ? ,   Child     ,   Mother  Father,    ,   this       .        Child,     ,  Child â€”   ,     Mother/Father,   .</p><br>
<p><em>(1)      , ,   , ,  child_data     Father.   Â«tail paddingÂ»      .</em></p><br>
<p>  <code>vtable</code>:</p><br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>0x4008b8</td>
<td>0</td>
<td>top_offset (   )</td>
</tr>
<tr>
<td>0x4008c0</td>
<td>0x400930</td>
<td>  typeinfo for Child</td>
</tr>
<tr>
<td>0x4008c8</td>
<td>0x400800</td>
<td>Mother::MotherMethod(). _vptr$Mother  .</td>
</tr>
<tr>
<td>0x4008d0</td>
<td>0x400810</td>
<td>Child::ChildMethod()</td>
</tr>
<tr>
<td>0x4008d8</td>
<td>-16</td>
<td>top_offset (   )</td>
</tr>
<tr>
<td>0x4008e0</td>
<td>0x400930</td>
<td>  typeinfo for Child</td>
</tr>
<tr>
<td>0x4008e8</td>
<td>0x400820</td>
<td>Father::FatherMethod(). _vptr$Father  .</td>
</tr>
</tbody>
</table></div><br>
<p>    Child          Mother.      Father     this,    _vptr$Father  Child (3-    Child, .  ).</p><br>
<p> ,   Child c;: (void<em>)&amp;c != (void</em>)static_cast&lt;Father*&gt;(&amp;c).     , , ,        . </p><br>
<p>      .  ,    .</p><br>
<p>,  Child      Father?   :</p><br>
<pre><code class="plaintext hljs">class Mother {<font></font>
 public:<font></font>
  virtual void MotherFoo() {}<font></font>
};<font></font>
<font></font>
class Father {<font></font>
 public:<font></font>
  virtual void FatherFoo() {}<font></font>
};<font></font>
<font></font>
class Child : public Mother, public Father {<font></font>
 public:<font></font>
  void FatherFoo() override {}<font></font>
};</code></pre><br>
<p>  .     Father*   FatherFoo()  .      Child, ,      Child    this.   ,   ,     Child.      Child,    Father. -     this,    ?    ,    ?</p><br>
<p><em>     ,  ,      Mother   ,    this . Child ,     vtable Mother,  ,   Child    .</em></p><br>
<p> :    â€â€ (thunk),    this,    â€œâ€ .  -    vtable Father,     â€œâ€    vtable Child.</p><br>
<p> <code>vtable Child</code>:</p><br>
<pre><code class="plaintext hljs">0x4008e8 &lt;vtable for Child&gt;:    0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00<font></font>
0x4008f0 &lt;vtable for Child+8&gt;:  0x60    0x09    0x40    0x00    0x00    0x00    0x00    0x00<font></font>
0x4008f8 &lt;vtable for Child+16&gt;: 0x00    0x08    0x40    0x00    0x00    0x00    0x00    0x00<font></font>
0x400900 &lt;vtable for Child+24&gt;: 0x10    0x08    0x40    0x00    0x00    0x00    0x00    0x00<font></font>
0x400908 &lt;vtable for Child+32&gt;: 0xf8    0xff    0xff    0xff    0xff    0xff    0xff    0xff<font></font>
0x400910 &lt;vtable for Child+40&gt;: 0x60    0x09    0x40    0x00    0x00    0x00    0x00    0x00<font></font>
0x400918 &lt;vtable for Child+48&gt;: 0x20    0x08    0x40    0x00    0x00    0x00    0x00    0x00</code></pre><br>
<p> :</p><br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>0x4008e8</td>
<td>0</td>
<td>top_offset (!)</td>
</tr>
<tr>
<td>0x4008f0</td>
<td>0x400960</td>
<td>typeinfo for Child</td>
</tr>
<tr>
<td>0x4008f8</td>
<td>0x400800</td>
<td>Mother::MotherFoo()</td>
</tr>
<tr>
<td>0x400900</td>
<td>0x400810</td>
<td>Child::FatherFoo()</td>
</tr>
<tr>
<td>0x400908</td>
<td>-8</td>
<td>top_offset</td>
</tr>
<tr>
<td>0x400910</td>
<td>0x400960</td>
<td>typeinfo for Child</td>
</tr>
<tr>
<td>0x400918</td>
<td>0x400820</td>
<td>   Child::FatherFoo()</td>
</tr>
</tbody>
</table></div><br>
<p>:    ,  Child  2 vtables â€”    Mother  Child,    Father.  vtable Father, FatherFoo()   â€œâ€,   vtable Child    Child::FatherFoo().</p><br>
<p>    â€œâ€,  ?</p><br>
<pre><code class="plaintext hljs">(gdb) disas /m 0x400820, 0x400850<font></font>
Dump of assembler code from 0x400820 to 0x400850:<font></font>
15    void FatherFoo() override {}<font></font>
   0x0000000000400820 &lt;non-virtual thunk to Child::FatherFoo()+0&gt;:  push   %rbp<font></font>
   0x0000000000400821 &lt;non-virtual thunk to Child::FatherFoo()+1&gt;:  mov    %rsp,%rbp<font></font>
   0x0000000000400824 &lt;non-virtual thunk to Child::FatherFoo()+4&gt;:  sub    $0x10,%rsp<font></font>
   0x0000000000400828 &lt;non-virtual thunk to Child::FatherFoo()+8&gt;:  mov    %rdi,-0x8(%rbp)<font></font>
   0x000000000040082c &lt;non-virtual thunk to Child::FatherFoo()+12&gt;: mov    -0x8(%rbp),%rdi<font></font>
   0x0000000000400830 &lt;non-virtual thunk to Child::FatherFoo()+16&gt;: add    $0xfffffffffffffff8,%rdi<font></font>
   0x0000000000400837 &lt;non-virtual thunk to Child::FatherFoo()+23&gt;: callq  0x400810 &lt;Child::FatherFoo()&gt;<font></font>
   0x000000000040083c &lt;non-virtual thunk to Child::FatherFoo()+28&gt;: add    $0x10,%rsp<font></font>
   0x0000000000400840 &lt;non-virtual thunk to Child::FatherFoo()+32&gt;: pop    %rbp<font></font>
   0x0000000000400841 &lt;non-virtual thunk to Child::FatherFoo()+33&gt;: retq   <font></font>
   0x0000000000400842:  nopw   %cs:0x0(%rax,%rax,1)<font></font>
   0x000000000040084c:  nopl   0x0(%rax)</code></pre><br>
<p>    â€”  this   FatherFoo().       this,   Child? top_offset!</p><br>
<p><em> ,    ,   non-virtual thunk  ,         .   ,    ,     .</em></p><br>
<hr><br>
<p><em>   ,     3  4 .   !</em></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja479790/index.html">3ã¤ã®ã‚¤ãƒ³ã‚­ãƒ¥ãƒ™ãƒ¼ã‚¿ãƒ¼ãŒæœ€åˆã®å­¦ç”Ÿã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã‚³ãƒ¼ã‚¹ã‚’é–‹å‚¬</a></li>
<li><a href="../ja479792/index.html">Azure DataFactoryã¨IBM DataStageã®æ©Ÿèƒ½ã®å°ã•ãªæ¯”è¼ƒ</a></li>
<li><a href="../ja479794/index.html">ã€Œå­ä¾›ç”¨ã€ã®ãƒã‚¤ã‚¯ãƒ­ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã¨ãƒœãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ ã‚’çµ„ã¿åˆã‚ã›ã‚‹</a></li>
<li><a href="../ja479796/index.html">ã‚­ãƒ³ã‚°ã‚¹ãƒˆãƒ³ã®ã‚µãƒã‚¹ãƒ¬ãƒ™ãƒ«ã®è„…å¨</a></li>
<li><a href="../ja479800/index.html">ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãŒç°¡å˜ã«ãªã‚‹ã‚ˆã†ã«Cï¼ƒã§æ›¸ã„ã¦ã„ã¾ã™</a></li>
<li><a href="../ja479810/index.html">Natureã§ç§‘å­¦è¨˜äº‹ã‚’å…¬é–‹ã—ãŸæ–¹æ³•</a></li>
<li><a href="../ja479814/index.html">Active Directoryãƒ‡ãƒ¼ã‚¿ã®ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã®å•é¡Œ</a></li>
<li><a href="../ja479816/index.html">Pythonã®çµ„ã¿åˆã‚ã›è«–</a></li>
<li><a href="../ja479818/index.html">è‹±èªåŠ›ã‚’è©•ä¾¡ã™ã‚‹æ–¹æ³•</a></li>
<li><a href="../ja479820/index.html">ITãƒ„ãƒªãƒ¼ã®ä¸‹ã«ä½•ã‚’é…ç½®ã—ã¾ã™ã‹ï¼Ÿãƒã‚¤ãƒŠãƒªæ™‚è¨ˆ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>