<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé± ü§∏üèø üîΩ Qu'est-ce que Windows PowerShell et que mange-t-il? Partie 1: Caract√©ristiques cl√©s üõÄüèª üìü üî¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Historiquement, les utilitaires de ligne de commande sur les syst√®mes Unix sont mieux d√©velopp√©s que sur Windows, cependant, avec l'av√®nement d'une no...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Qu'est-ce que Windows PowerShell et que mange-t-il? Partie 1: Caract√©ristiques cl√©s</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/487876/"><font color="#999999"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Historiquement, les utilitaires de ligne de commande sur les syst√®mes Unix sont mieux d√©velopp√©s que sur Windows, cependant, avec l'av√®nement d'une nouvelle solution, la situation a chang√©. </font></font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShell permet aux administrateurs syst√®me d'automatiser la plupart des t√¢ches de routine. </font><font style="vertical-align: inherit;">Avec son aide, vous pouvez modifier les param√®tres, arr√™ter et d√©marrer les services, ainsi que r√©aliser la maintenance de la plupart des applications install√©es. </font><font style="vertical-align: inherit;">Il serait faux de percevoir la fen√™tre bleue comme un autre interpr√©teur de commandes. </font><font style="vertical-align: inherit;">Cette approche ne refl√®te pas l'essence des innovations propos√©es par Microsoft. </font><font style="vertical-align: inherit;">En fait, les possibilit√©s de Windows PowerShell sont beaucoup plus larges: dans une courte s√©rie d'articles, nous allons essayer de comprendre en quoi la solution Microsoft diff√®re des outils plus familiers.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/-b/i_/73/-bi_73lwdxmnzvtveeghrwvtqay.png"></a><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Principales caract√©ristiques&nbsp;</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien s√ªr, Windows PowerShell est principalement un interpr√©teur de commandes avec un langage de script, cr√©√© √† l'origine sur la base du .NET Framework, et plus tard sur le .NET Core. Contrairement aux shells qui acceptent et renvoient des donn√©es textuelles, Windows PowerShell fonctionne avec des classes .NET qui ont des propri√©t√©s et des m√©thodes. PowerShell vous permet d'ex√©cuter des commandes ordinaires et donne √©galement acc√®s aux objets COM, WMI et ADSI. Il utilise divers r√©f√©rentiels, tels que le syst√®me de fichiers ou le registre Windows, pour l'acc√®s auquel le soi-disant fournisseurs (prestataires). Il convient de noter la possibilit√© d'incorporer des composants PowerShell ex√©cutables dans d'autres applications pour impl√©menter diverses op√©rations, notamment via l'interface graphique. L'inverse est √©galement vrai: de nombreuses applications Windows donnent acc√®s √† leurs interfaces de gestion via PowerShell.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShell vous permet de:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modifiez les param√®tres du syst√®me d'exploitation;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G√©rer les services et les processus;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurer les r√¥les et composants du serveur;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installer le logiciel</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G√©rez les logiciels install√©s via des interfaces sp√©ciales;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Int√©grer des composants ex√©cutables dans des programmes tiers;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cr√©ez des scripts pour automatiser les t√¢ches d'administration;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Travailler avec le syst√®me de fichiers, le registre Windows, le magasin de certificats, etc.</font></font></li>
</ul><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shell et environnement de d√©veloppement</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe Windows PowerShell de deux mani√®res: en plus de l'√©mulateur de console avec un shell de commande, il existe un environnement de script int√©gr√© (ISE). </font><font style="vertical-align: inherit;">Pour acc√©der √† l'interface de ligne de commande, s√©lectionnez simplement le raccourci appropri√© dans le menu Windows ou ex√©cutez powershell.exe dans le menu Ex√©cuter. </font><font style="vertical-align: inherit;">Une fen√™tre bleue appara√Æt √† l'√©cran, avec des capacit√©s sensiblement diff√©rentes de celles de l'antidiluvian cmd.exe. </font><font style="vertical-align: inherit;">Il existe une saisie semi-automatique et d'autres fonctionnalit√©s famili√®res aux utilisateurs de shells de commande pour les syst√®mes Unix.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ds/gl/te/dsgltei5iog1igfonvgmqrprvpg.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour travailler avec le shell, vous devez vous rappeler certaines combinaisons de touches:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les fl√®ches haut et bas font d√©filer l'historique pour r√©p√©ter les commandes pr√©c√©demment saisies;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La fl√®che droite √† la fin de la ligne recycle la commande pr√©c√©dente caract√®re par caract√®re;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ctrl + D√©but supprime le texte tap√© de la position du curseur au d√©but de la ligne;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ctrl + Fin supprime le texte du curseur jusqu'√† la fin de la ligne.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F7 affiche une fen√™tre avec les commandes saisies et vous permet de s√©lectionner l'une d'entre elles. </font><font style="vertical-align: inherit;">La s√©lection de la souris, le copier-coller, le positionnement du curseur, la suppression, le retour arri√®re fonctionnent √©galement dans la console - tout comme nous le souhaitons.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/4z/dz/8y/4zdz8ycsabniuypzx-tloxc9vk4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShell ISE est un environnement de d√©veloppement √† part enti√®re qui prend en charge les onglets et la coloration syntaxique avec un √©diteur de code, un concepteur de commandes, un d√©bogueur int√©gr√© et d'autres joies de la programmation. </font><font style="vertical-align: inherit;">Si vous √©crivez un trait d'union dans l'√©diteur d'environnement de d√©veloppement apr√®s le nom de la commande, vous obtiendrez tous les param√®tres disponibles avec un type dans la liste d√©roulante. </font><font style="vertical-align: inherit;">Vous pouvez lancer PowerShell ISE via un raccourci dans le menu syst√®me ou en utilisant le fichier ex√©cutable powershell_ise.exe.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yp/4o/wo/yp4owoc2brcx0vrosfgjkkb_vz4.png"></div><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cmdlets&nbsp;</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans Windows PowerShell, le soi-disant applets de commande Ce sont des classes .NET sp√©cialis√©es qui contiennent diverses fonctionnalit√©s. Ils sont nomm√©s selon le principe ¬´Action-Object¬ª (ou ¬´Verb-Noun, si vous l'aimez plus¬ª), et une conjonction avec trait d'union ressemble au pr√©dicat et au sujet dans les phrases des langues naturelles. Par exemple, Get-Help signifie litt√©ralement ¬´Get-Help¬ª ou, dans le contexte de PowerShell: ¬´Show-Help¬ª. En fait, il s'agit d'un analogue de la commande man dans les syst√®mes Unix et les manuels de PowerShell doivent √™tre demand√©s de cette mani√®re, et non en appelant des applets de commande avec la cl√© --help ou /?. N'oubliez pas la documentation PowerShell en ligne: Microsoft l'a assez d√©taill√©e.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus de Get, d'autres verbes (et pas seulement des verbes √† proprement parler) sont utilis√©s dans les applets de commande pour indiquer les actions. Dans la liste ci-dessous, nous donnons quelques exemples: </font></font><br>
<br>
<code>Add</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- add; </font></font><br>
<code>Clear</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- nettoyer; </font></font><br>
<code>Enable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- activer; </font></font><br>
<code>Disable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- √©teindre; </font></font><br>
<code>New</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- cr√©er; </font></font><br>
<code>Remove</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- supprimer; </font></font><br>
<code>Set</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- demander; </font></font><br>
<code>Start</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- courir; </font></font><br>
<code>Stop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Arr√™tez; </font></font><br>
<code>Export</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- exportation; </font></font><br>
<code>Import</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- importation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe des applets de commande syst√®me, utilisateur et facultatives: √† la suite de l'ex√©cution, elles renvoient toutes un objet ou un tableau d'objets. Ils ne sont pas sensibles √† la casse, c'est-√†-dire du point de vue de l'interpr√©teur de commandes, il n'y a pas de diff√©rence entre Get-Help et get-help. Le caract√®re ';' est utilis√© pour la s√©paration, mais il n'est obligatoire de le d√©finir que si plusieurs applets de commande sont ex√©cut√©es sur la m√™me ligne.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les applets de commande Windows PowerShell sont regroup√©es en modules (NetTCPIP, Hyper-V, etc.), et l'applet de commande Get-Command existe pour rechercher par objet et action. </font><font style="vertical-align: inherit;">Vous pouvez afficher de l'aide comme ceci:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Help</span> <span class="hljs-built_in">Get-Command</span></code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gu/ek/ub/guekubdaoboz6eitvbzzqppmyvi.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par d√©faut, la commande affiche une br√®ve aide, mais si n√©cessaire, des param√®tres (arguments) sont transmis aux applets de commande. </font><font style="vertical-align: inherit;">En les utilisant, par exemple, vous pouvez obtenir une aide d√©taill√©e (param√®tre -Detailed) ou compl√®te (param√®tre -Full), ainsi que des exemples d'affichage (param√®tre -Examples):</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Help</span> <span class="hljs-built_in">Get-Command</span> <span class="hljs-literal">-Examples</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'aide de Windows PowerShell est mise √† jour avec l'applet de commande Update-Help. Si la ligne de commande est trop longue, les arguments de l'applet de commande peuvent √™tre transf√©r√©s √† la suivante en √©crivant le caract√®re de service `` '' et en appuyant sur Entr√©e - il suffit de terminer l'√©criture de la commande sur une ligne et de continuer sur une autre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici quelques exemples d'applets de commande courantes:&nbsp; </font></font><br>
<br>
<code>Get-Process</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- affiche les processus en cours d'ex√©cution dans le syst√®me; </font></font><br>
<code>Get-Service</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- montrer les services et leur statut; </font></font><br>
<code>Get-Content</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- afficher le contenu du fichier.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les applets de commande fr√©quemment utilis√©es et les utilitaires externes dans Windows PowerShell, il existe de courts synonymes - alias (de l'anglais Alias). </font><font style="vertical-align: inherit;">Par exemple, dir est un alias de Get-ChildItem. </font><font style="vertical-align: inherit;">La liste des synonymes contient des analogues de commandes des syst√®mes Unix (ls, ps, etc.), et l'applet de commande Get-Help est appel√©e par la commande help. </font><font style="vertical-align: inherit;">Une liste compl√®te des synonymes peut √™tre consult√©e √† l'aide de l'applet de commande Get-Alias:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/d-/p_/m-/d-p_m-vc7nnwcrq2weryyqbeb8o.png"></div><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scripts, fonctions, modules et langage PowerShell</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les scripts Windows PowerShell sont stock√©s sous forme de fichiers texte avec l'extension .ps1. Vous ne pouvez pas les lancer avec un double clic: vous devez cliquer avec le bouton droit sur le menu contextuel et s√©lectionner l'√©l√©ment "Ex√©cuter dans PowerShell". √Ä partir de la console, vous devrez soit sp√©cifier le chemin d'acc√®s complet au script, soit aller dans le r√©pertoire appropri√© et √©crire le nom du fichier. L'ex√©cution de scripts est √©galement limit√©e par la strat√©gie syst√®me, et pour v√©rifier les param√®tres actuels, vous pouvez utiliser l'applet de commande Get-ExecutionPolicy, qui donnera l'une des valeurs suivantes: </font></font><br>
<br>
<code>Restricted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- l'ex√©cution de script est interdite (par d√©faut); </font></font><br>
<code>AllSigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- seul le lancement de scripts sign√©s par un d√©veloppeur de confiance est autoris√©; </font></font><br>
<code>RemoteSigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- autoris√© √† ex√©cuter des scripts sign√©s et personnalis√©s; </font></font><br>
<code>Unrestricted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- autoris√© √† ex√©cuter tous les scripts.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'administrateur a deux options. Le plus s√ªr consiste √† signer des scripts, mais c'est une sorcellerie assez s√©rieuse - nous en parlerons dans les articles suivants. Maintenant, nous allons suivre la voie de la moindre r√©sistance et changer la politique:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Set-ExecutionPolicy</span> RemoteSigned</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/k7/da/gg/k7dagg4xwaerpartpet4k_5eaa4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour ce faire, PowerShell devra √™tre ex√©cut√© en tant qu'administrateur, bien qu'en utilisant un param√®tre sp√©cial, vous pouvez modifier la strat√©gie de l'utilisateur actuel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les scripts sont √©crits dans un langage de programmation orient√© objet, dont les commandes sont nomm√©es selon le m√™me principe que les applets de commande pr√©c√©demment discut√©es: ¬´Action-Object¬ª (¬´Verb-Noun¬ª). Son objectif principal est l'automatisation des t√¢ches d'administration, mais c'est un langage interpr√©t√© √† part enti√®re qui a toutes les constructions n√©cessaires: branchement conditionnel, boucles, variables, tableaux, objets, gestion des erreurs, etc. Tout √©diteur de texte convient √† l'√©criture de scripts, mais il est plus pratique de d√©marrer Windows PowerShell ISE.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez transmettre des param√®tres au script, les rendre obligatoires et √©galement d√©finir des valeurs par d√©faut. </font><font style="vertical-align: inherit;">De plus, Windows PowerShell vous permet de cr√©er des fonctions et de les appeler de la m√™me mani√®re que les applets de commande: pour cela, vous utilisez la construction Function et les accolades. </font><font style="vertical-align: inherit;">Un script avec des fonctions s'appelle un module et a l'extension .psm1. </font><font style="vertical-align: inherit;">Les modules doivent √™tre stock√©s dans des r√©pertoires d√©finis dans les variables d'environnement PowerShell. </font><font style="vertical-align: inherit;">Vous pouvez les visualiser √† l'aide de la commande suivante:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-ChildItem</span> Env:\PSModulePath | <span class="hljs-built_in">Format-Table</span> <span class="hljs-literal">-AutoSize</span></code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Convoyeurs</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le dernier exemple, nous avons utilis√© une conception famili√®re aux utilisateurs de shells pour les syst√®mes Unix. Dans Windows PowerShell, la barre verticale vous permet √©galement de transf√©rer la sortie d'une commande √† l'entr√©e d'une autre, mais il existe une diff√©rence significative dans la mise en ≈ìuvre du pipeline: il ne s'agit pas d'un jeu de caract√®res ou d'un texte. Les applets de commande int√©gr√©es ou les fonctions d√©finies par l'utilisateur renvoient des objets ou des tableaux d'objets et peuvent √©galement les recevoir √† l'entr√©e. Comme le shell Bourne et ses nombreux abonn√©s, PowerShell simplifie les t√¢ches complexes avec un pipeline. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'exemple le plus simple d'un pipeline ressemble √† ceci:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Service</span> | <span class="hljs-built_in">Sort-Object</span> <span class="hljs-literal">-property</span> Status</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zm/pm/l0/zmpml0zpq48xqcsbqga7c-lvkfo.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, la cmdlet Get-Service est ex√©cut√©e, puis tous les services qu'elle re√ßoit sont pass√©s √† la cmdlet Sort-Object pour √™tre tri√©s par la propri√©t√© Status. </font><font style="vertical-align: inherit;">L'argument auquel le r√©sultat de la section pr√©c√©dente du pipeline est transmis d√©pend de son type - il s'agit g√©n√©ralement d'un InputObject. </font><font style="vertical-align: inherit;">Ce probl√®me sera abord√© plus en d√©tail dans l'article consacr√© au langage de programmation PowerShell.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous le souhaitez, vous pouvez continuer la cha√Æne et transmettre le r√©sultat de Sort-Object √† une autre applet de commande (ils seront ex√©cut√©s de gauche √† droite). </font><font style="vertical-align: inherit;">Soit dit en passant, la conception famili√®re de Windows pour la sortie de pagination est √©galement disponible pour tous les Unixoids:&nbsp;</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Service</span> | <span class="hljs-built_in">Sort-Object</span> <span class="hljs-literal">-property</span> Status | more</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ex√©cution de t√¢ches en arri√®re-plan&nbsp;</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tr√®s souvent, vous devez ex√©cuter une certaine commande en arri√®re-plan afin de ne pas attendre le r√©sultat de son ex√©cution dans une session shell. </font><font style="vertical-align: inherit;">Dans Windows PowerShell, il existe plusieurs applets de commande pour ce cas: </font></font><br>
<br>
<code>Start-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- lancement d'une t√¢che en arri√®re-plan; </font></font><br>
<code>Stop-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- arr√™tez la t√¢che d'arri√®re-plan; </font></font><br>
<code>Get-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Afficher une liste des t√¢ches d'arri√®re-plan; </font></font><br>
<code>Receive-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- afficher le r√©sultat de la t√¢che d'arri√®re-plan; </font></font><br>
<code>Remove-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- suppression de la t√¢che d'arri√®re-plan; </font></font><br>
<code>Wait-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Transf√©rez la t√¢che d'arri√®re-plan vers la console. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour d√©marrer une t√¢che en arri√®re-plan, nous utilisons l'applet de commande Start-Job et indiquons entre crochets une commande ou un ensemble de commandes:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Start-Job</span> {<span class="hljs-built_in">Get-Service</span>}</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_l/v7/31/_lv731nqaggn7kyk7thfu1g4gzy.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les t√¢ches d'arri√®re-plan dans Windows PowerShell peuvent √™tre manipul√©es en connaissant leurs noms. </font><font style="vertical-align: inherit;">Tout d'abord, apprenez √† les afficher:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Job</span></code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/tu/r4/ha/tur4halfauj3kro8ajjersimf8o.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nous montrons le r√©sultat de Job1:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Receive-Job</span> Job1 | more</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zn/od/yz/znodyzk81wsadjjacvg9tmeis9g.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est assez simple.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ex√©cution de commandes √† distance</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShell vous permet d'ex√©cuter des commandes et des scripts non seulement sur le local, mais √©galement sur l'ordinateur distant, et m√™me sur tout un groupe de machines. </font><font style="vertical-align: inherit;">Il y a plusieurs moyens de le faire:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De nombreuses applets de commande ont un param√®tre </font></font><code>-ComputerName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais cette m√©thode √©chouera, par exemple, lors de la cr√©ation d'un pipeline;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'applet de commande </font></font><code>Enter-PSSession</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vous permet de cr√©er une session interactive sur une machine distante;&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ä l'aide de l'applet de commande, </font></font><code>Invoke-Command</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vous pouvez ex√©cuter des commandes ou des scripts sur un ou plusieurs ordinateurs distants.</font></font></li>
</ul><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Versions de PowerShell</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depuis sa premi√®re sortie en 2006, PowerShell a beaucoup chang√©. L'outil est disponible pour de nombreux syst√®mes fonctionnant sur diff√©rentes plates-formes mat√©rielles (x86, x86-64, Itanium, ARM): Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008/2008 R2, Windows 7, Windows 8, Windows 8.1, Windows RT, Windows RT 8.1, Windows Server 2012/2012 R2, Windows 10, Windows Server 2016, GNU / Linux et OS X. La derni√®re version 6.2 a √©t√© publi√©e le 10 janvier 2018. Les scripts √©crits pour les versions ant√©rieures sont plus susceptibles de fonctionner dans les versions ult√©rieures, mais il peut y avoir des probl√®mes avec le portage inverse, car au fil des ann√©es de d√©veloppement, un grand nombre de nouvelles applets de commande sont apparues dans PowerShell. Vous pouvez conna√Ætre la version du shell install√©e sur l'ordinateur √† l'aide de la propri√©t√© PSVersion de la variable int√©gr√©e $ PSVersionTable:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$PSVersionTable</span>.PSVersion</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ib/0o/8z/ib0o8zeqxrn7ye3ddykovsckmis.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez √©galement utiliser l'applet de commande:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Variable</span> <span class="hljs-literal">-Name</span> PSVersionTable ‚ÄìValueOnly</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3m/zc/r4/3mzcr4i_lettn4s_ulrqo_jpm8g.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La m√™me op√©ration est effectu√©e avec l'applet de commande Get-Host. </font><font style="vertical-align: inherit;">En fait, il existe de nombreuses options, mais pour les utiliser, vous devez apprendre le langage de programmation PowerShell, ce que nous ferons dans le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prochain article</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .&nbsp;</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sommaire&nbsp;</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Microsoft a r√©ussi √† cr√©er un shell de commande vraiment puissant avec un environnement int√©gr√© pratique pour d√©velopper des scripts. Il diff√®re des moyens qui nous sont familiers dans le monde Unix par une int√©gration profonde avec les syst√®mes d'exploitation Windows, ainsi que les logiciels pour eux et la plate-forme .NET Core. PowerShell peut √™tre appel√© un shell orient√© objet, car les applets de commande et les fonctions d√©finies par l'utilisateur renvoient des objets ou des tableaux d'objets et peuvent les recevoir √† l'entr√©e. Nous pensons que tous les administrateurs de serveur Windows devraient poss√©der cet outil: le temps est pass√© o√π ils pouvaient se passer de la ligne de commande. Un shell de console avanc√© est particuli√®rement n√©cessaire sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">notre VPS √† faible co√ªt ex√©cutant Windows Server Core</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais c'est une autre histoire.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> 2:     Windows PowerShell</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> 3:      ,  </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> 4:   ,  <br>
</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr487862/index.html">Combien co√ªte Nyasha?</a></li>
<li><a href="../fr487864/index.html">Passeports √©lectroniques: rejoignez la pratique mondiale ou courez le risque de fuite de donn√©es personnelles?</a></li>
<li><a href="../fr487868/index.html">Num√©risation de documents et reconnaissance de texte avec VisionKit et Vision Framework sur iOS</a></li>
<li><a href="../fr487872/index.html">Moulage de moules en silicone liquide √† la maison</a></li>
<li><a href="../fr487874/index.html">Intel NUC Chaco Canyon - Fonctionne l√† o√π vous en avez besoin</a></li>
<li><a href="../fr487878/index.html">5 questions SQL fr√©quemment pos√©es par les scientifiques des donn√©es pour les entretiens d'embauche</a></li>
<li><a href="../fr487882/index.html">Chrome bloquera automatiquement les publicit√©s vid√©o ennuyeuses</a></li>
<li><a href="../fr487884/index.html">5 choses que j'aimerais savoir avant de d√©velopper l'√©change</a></li>
<li><a href="../fr487888/index.html">CSRF chez Umbraco CMS</a></li>
<li><a href="../fr487890/index.html">Traduire la parole en texte sur iOS √† l'aide du framework Speech</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>