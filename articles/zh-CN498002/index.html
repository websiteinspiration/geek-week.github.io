<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📨 🔒 🕥 Z3袖珍指南 🧙 ⚱️ 💇</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="前言
 


 “人类的大脑是一个空的阁楼傻瓜做到了这一点：拖动必要和不必要的还有最后总会有你的时候不推有最必要的东西，反之亦然......一会儿。” 
 
 V.B. 利瓦诺夫（电影《夏洛克·福尔摩斯和沃森博士》）

 SMT . , , , , .. — , .
  
 

- x = Int(...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Z3袖珍指南</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/498002/"><h2 id="preambula"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前言</font></font></h2><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/599/b08/d8e/599b08d8ef8ca3b274bb4a36e5b0018e.jpg" alt="图片"></p><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“人类的大脑是一个空的阁楼傻瓜做到了这一点：拖动必要和不必要的还有最后总会有你的时候不推有最必要的东西，反之亦然......一会儿。” </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V.B. </font><font style="vertical-align: inherit;">利瓦诺夫（电影《夏洛克·福尔摩斯和沃森博士》）</font></font></blockquote><p>      SMT .     ,     ,        ,       ,   ..     — ,    .</p><a name="habracut"></a><br>
<h2 id="tipy-dannyh"> </h2><br>
<ul>
<li><p>x = Int('x')</p><br>
</li>
<li><p>y = Real('y')</p><br>
</li>
<li><p>z = Bool('z')</p><br>
</li>
<li><p>s = String('s')</p><br>
</li>
<li><p>x, y, z = Ints('x y z')</p><br>
</li>
<li><p>x, y, z = Reals('x y z')</p><br>
</li>
<li><p>x, y, z = Bools('x y z')</p><br>
</li>
<li><p>x, y, z = Strings('x y z')</p><br>
</li>
<li><p>v = BitVec('v', N) # N —  -</p><br>
</li>
<li><p>X = IntVector('X', N)</p><br>
</li>
<li><p>Y = RealVector('Y', N)</p><br>
</li>
<li><p>Z = BoolVector('Z', N)</p><br>
</li>
<li><p>A = Array('A', b, c) # b —  ,  —  </p><br>
</li>
<li><p>Select(A, i) #    A[i]</p><br>
</li>
<li><p>Store('A', i, a) #   A c a  i- </p><br>
</li>
<li><p>FloatingPoint = FP('fp', FPSort(ebits, sbits)) #  IEEE 754</p><br>
</li>
<li><p>v = BitVecVal(10, 32) # - 0x0000000a</p><br>
</li>
<li><p>str = StringVal("aaaaa")</p><br>
</li>
<li><p>c = Const(5, IntSort())</p><br>
</li>
</ul><br>
<h2 id="regulyarnye-vyrazheniya"> </h2><br>
<p>reg = Re('re')</p><br>
<p>re = Loop( reg, L, U ) # L —  , U —  </p><br>
<pre><code class="plaintext hljs">Ex:<font></font>
<font></font>
re = Loop( Re('a') , 2, 5)<font></font>
<font></font>
print( simplify( InRe( "aaaa", re ) ) )<font></font>
<font></font>
print( simplify( InRe( "a", re ) ) )<font></font>
<font></font>
Out:<font></font>
<font></font>
True<font></font>
<font></font>
False</code></pre><br>
<h2 id="operacii"></h2><br>
<h3 id="logicheskie-svyazki"> </h3><br>
<ul>
<li><p>And(a, b)</p><br>
</li>
<li><p>Not(a)</p><br>
</li>
<li><p>Or(a, b)</p><br>
</li>
<li><p>Xor(a, b)</p><br>
</li>
<li><p>Implies(a, b) # a == b   a  b</p><br>
</li>
</ul><br>
<h3 id="stroki"></h3><br>
<ul>
<li><p>PrefixOf(substr, str)</p><br>
</li>
<li><p>SuffixOf(substr, str)</p><br>
</li>
<li><p>Concat(str1, str2)</p><br>
</li>
<li><p>Length(str)</p><br>
</li>
</ul><br>
<h3 id="drugie-poleznye-funkcii">  </h3><br>
<ul>
<li>Sum(a, b, c)</li>
</ul><br>
<pre><code class="plaintext hljs">Out:<font></font>
<font></font>
0 + a + b + c</code></pre><br>
<ul>
<li>Product(a, b, c)</li>
</ul><br>
<pre><code class="plaintext hljs">Out:<font></font>
<font></font>
1 * a * b * c</code></pre><br>
<ul>
<li>Distinct(x, y)</li>
</ul><br>
<pre><code class="plaintext hljs">Out:<font></font>
<font></font>
x != y</code></pre><br>
<ul>
<li>simplify(Distinct(x, y, z), blast_distinct=True)</li>
</ul><br>
<pre><code class="plaintext hljs">Out:<font></font>
<font></font>
And(Not(x == y), Not(x == z), Not(y == z))</code></pre><br>
<ul>
<li>Extract(L, U, 'x') # L —  , U —  </li>
</ul><br>
<pre><code class="plaintext hljs">Ex:<font></font>
<font></font>
s = Solver()<font></font>
<font></font>
x = BitVec('x', 8)<font></font>
<font></font>
k = Extract(3, 0, x)<font></font>
<font></font>
s.add(k == BitVecVal(10,4))<font></font>
<font></font>
s.check()<font></font>
<font></font>
print(s.model())<font></font>
<font></font>
Out:<font></font>
<font></font>
x = 10</code></pre><br>
<ul>
<li><p>LShR(x, i) # x &gt;&gt; i</p><br>
</li>
<li><p>RotateLeft(a, i)</p><br>
</li>
<li><p>RotateRight(a, i)</p><br>
</li>
</ul><br>
<h2 id="solver">Solver</h2><br>
<p>SMT Solver —    .</p><br>
<p><strong>s = Solver()</strong></p><br>
<p><strong>s = SolverFor('proc')</strong> #    </p><br>
<ul>
<li><p>s.push/pop() # / </p><br>
</li>
<li><p>s.statistics() #    </p><br>
</li>
<li><p>s.assertions() #      </p><br>
</li>
<li><p>set_option() #    </p><br>
</li>
</ul><br>
<pre><code class="plaintext hljs">Ex:<font></font>
<font></font>
set_option(precision=10)    #    10    (        "?" )</code></pre><br>
<ul>
<li><p>s.check() #      (  3 : sat/unsat/unknown )</p><br>
</li>
<li><p>simplify() #  </p><br>
</li>
<li><p>s.sexpr() #    SMT-LIB2</p><br>
</li>
<li><p>s.model() #  </p><br>
</li>
<li><p>s.reset() #   </p><br>
</li>
</ul><br>
<h2 id="optimizacii"></h2><br>
<p>    t</p><br>
<p><strong>o = Optimize()</strong></p><br>
<ul>
<li><p>o.maximize(t)</p><br>
</li>
<li><p>o.minimize(t)</p><br>
</li>
</ul><br>
<pre><code class="plaintext hljs">Ex:<font></font>
<font></font>
x1, x2, x3, x4, x5, m = Reals('x1 x2 x3 x4 x5 m')<font></font>
<font></font>
o = Optimize()<font></font>
<font></font>
o.add(-5 * x1 - 5 * x2 + 0 * x3 + 0 * x4 + 20 * x5 == 2 )<font></font>
<font></font>
o.add( 0 * x1 +5 * x2 - 10 * x3 + 0 * x4 - 5 * x5 == 3 )<font></font>
<font></font>
o.add( 0 * x1 -5 * x2 + 0 * x3 - 15 * x4 + 15 * x5 == 1 )<font></font>
<font></font>
o.add( x1&gt;=0, x2&gt;=0, x3&gt;= 0, x4&gt;= 0, x5&gt;= 0)<font></font>
<font></font>
o.add( 0 * x1 -1 * x2 + 0 * x3 + 0 * x4 - 0.5 * x5 == m )<font></font>
<font></font>
h = o.maximize(m)<font></font>
<font></font>
if o.check() == sat:<font></font>
<font></font>
    print(o.lower(h))<font></font>
<font></font>
    print(o.model())<font></font>
<font></font>
Out:<font></font>
<font></font>
h =  -6/5<font></font>
[x3 = 0, x5 = 2/5, m = -6/5, x4 = 0, x1 = 1/5, x2 = 1]</code></pre><br>
<h2 id="ponyatie-celi"> </h2><br>
<p>Goal () —      .       .     .  ,      .</p><br>
<p>g = Goal()</p><br>
<p>g.add(...)</p><br>
<p> Goal</p><br>
<pre><code class="plaintext hljs">c = Context()<font></font>
<font></font>
g2 = g.translate(c)</code></pre><br>
<h2 id="taktiki"></h2><br>
<p>      .     .</p><br>
<ul>
<li><p>tactics() —   </p><br>
</li>
<li><p>tactic_description('tactic_name') —   </p><br>
</li>
</ul><br>
<pre><code class="plaintext hljs">Ex:<font></font>
<font></font>
g = Goal()<font></font>
<font></font>
x, y = Ints('x y')<font></font>
<font></font>
g.add(x == y + 1)<font></font>
<font></font>
t  = With(Tactic('add-bounds'), add_bound_lower=0, add_bound_upper=10)<font></font>
<font></font>
g2 = t(g)<font></font>
<font></font>
print(g2.as_expr())<font></font>
<font></font>
Out:<font></font>
<font></font>
And(x == y + 1, x &lt;= 10, x &gt;= 0, y &lt;= 10, y &gt;= 0)</code></pre><br>
<h3 id="kombinatory-taktik"> </h3><br>
<ul>
<li><p>Then(t, s) # t —  </p><br>
</li>
<li><p>OrElse(t, s) # s —  </p><br>
</li>
<li><p>Repeat(t)</p><br>
</li>
<li><p>TryFor(t, ms) # ms — </p><br>
</li>
<li><p>With(t, params) # params —   </p><br>
</li>
</ul><br>
<pre><code class="plaintext hljs">Ex:<font></font>
<font></font>
Then('simplify', 'nlsat').solver()</code></pre><br>
<h2 id="arifmetiki"></h2><br>
<h3 id="tablica-logik"> </h3><br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th></th>
<th> </th>
<th>Solver</th>
</tr>
</thead>
<tbody>
<tr>
<td>LIA</td>
<td>Linear Real Arithmetic</td>
<td>Dual Simplex</td>
</tr>
<tr>
<td>LRA</td>
<td>Linear Integer Arithmetic</td>
<td>Cuts + Branch</td>
</tr>
<tr>
<td>LIRA</td>
<td>Mixed Real/Integer</td>
<td>Cuts + Branch</td>
</tr>
<tr>
<td>IDL</td>
<td>Integer Difference Logic</td>
<td>Floyd-Warshall</td>
</tr>
<tr>
<td>RDL</td>
<td>Real Difference Logic</td>
<td>Bellman-Ford</td>
</tr>
<tr>
<td>UTVPI</td>
<td>Unit two-variable / inequality</td>
<td>Bellman-Ford</td>
</tr>
<tr>
<td>NRA</td>
<td>Polynomial Real Arithmetic</td>
<td>Model based CAD</td>
</tr>
<tr>
<td>NIA</td>
<td>Non-linear Integer Arithmetic</td>
<td>CAD + Branch</td>
</tr>
</tbody>
</table></div><br>
<h2 id="sovety"></h2><br>
<h3 id="reshateli-dlya-strok">  </h3><br>
<ul>
<li><p>s.set( "smt.string.solver","seq" )</p><br>
</li>
<li><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s.set（“ smt.string.solver”，“ z3str3”）</font></font></p><br>
</li>
</ul><br>
<h3 id="prinuditelnye-minimizacii"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">强制最小化</font></font></h3><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s.set（“ smt.core.minimize”，“ true”） </font></font></li>
</ul><br>
<h2 id="ssylki"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参考文献</font></font></h2><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我认为最令人愉快的描述</font></font></a></p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目录</font></font></a></p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SMT逻辑</font></font></a></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">示例：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">二</font></font></a></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN497988/index.html">反应应用程序性能分析</a></li>
<li><a href="../zh-CN497990/index.html">PostgreSQL：用C语言开发扩展（功能）</a></li>
<li><a href="../zh-CN497994/index.html">语言力学逃逸分析</a></li>
<li><a href="../zh-CN497996/index.html">您不想增强免疫力。还是人体的极端</a></li>
<li><a href="../zh-CN498000/index.html">在开发自己的游戏之前我想知道的事情</a></li>
<li><a href="../zh-CN498004/index.html">Docker容器中的工作站</a></li>
<li><a href="../zh-CN498006/index.html">选择专利律师</a></li>
<li><a href="../zh-CN498012/index.html">带有Qemu的Docker中的Mikrotik RouterOS</a></li>
<li><a href="../zh-CN498014/index.html">PyDERASN：随着我添加了大数据支持</a></li>
<li><a href="../zh-CN498018/index.html">微服务架构中的运营分析：帮助和提示Postgres FDW来帮助开发人员</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>