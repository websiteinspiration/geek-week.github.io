<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍🤝‍👨🏻 👩🏾‍🚒 🐧 Pythonの一般的なCLIライブラリの比較：クリック、セメント、火など 👬 🏝️ 💓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pythonはコンソールアプリケーションに最適な言語であり、これらのタスクのための多数のライブラリを強調しています。しかし、どのようなライブラリが存在しますか？そしてどちらをとるべきか？この資料は、コンソールの世界で人気の高いツールではなく、2番目の質問に答える試みを示しています。
 
 読みやすく...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Pythonの一般的なCLIライブラリの比較：クリック、セメント、火など</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466999/"><img src="https://habrastorage.org/webt/rp/ek/be/rpekben_u6jtlwru-flsslxk70e.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pythonはコンソールアプリケーションに最適な言語であり、これらのタスクのための多数のライブラリを強調しています。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しかし、どのようなライブラリが存在しますか？</font><font style="vertical-align: inherit;">そしてどちらをとるべきか？</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この資料は、コンソールの世界で人気の高いツールではなく、2番目の質問に答える試みを示しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
読みやすくするために、レビューは2つの投稿に分かれています。1つ目は最も人気のある6つのライブラリを比較し、2つ目は人気が低く、より具体的ですが、注目に値します。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各例では、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">todolib</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライブラリのコンソールユーティリティがPython 3.7 </font><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">記述されており</font><font style="vertical-align: inherit;">、タスクを作成、表示、タグ付け、削除できます。</font><font style="vertical-align: inherit;">残りは、特定のフレームワークでの実装の単純さを条件に追加されます。</font><font style="vertical-align: inherit;">タスク自体はjsonファイルに保存されます。jsonファイルは、別の呼び出しで保存されます-サンプルの追加条件。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これに加えて、実装ごとに簡単なテストが記述されます。</font><font style="vertical-align: inherit;">以下のフィクスチャを含むPytestは、テストフレームワークとして使用されました。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">@pytest.fixture(autouse=True)</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">db</span>(<span class="hljs-params">monkeypatch</span>):</span>
    <span class="hljs-string">"""
    monkeypatch     ,
          
    """</span>
    value = {<span class="hljs-string">"tasks"</span>: []}<font></font>
    monkeypatch.setattr(todolib.TodoApp, <span class="hljs-string">"get_db"</span>, <span class="hljs-keyword">lambda</span> _: value)
    <span class="hljs-keyword">return</span> value<font></font>
<font></font>
<span class="hljs-meta">@pytest.yield_fixture(autouse=True)</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">check</span>(<span class="hljs-params">db</span>):</span>
    <span class="hljs-string">"""      """</span>
    <span class="hljs-keyword">yield</span>
    <span class="hljs-keyword">assert</span> db[<span class="hljs-string">"tasks"</span>] <span class="hljs-keyword">and</span> db[<span class="hljs-string">"tasks"</span>][<span class="hljs-number">0</span>][<span class="hljs-string">"title"</span>] == <span class="hljs-string">"test"</span><font></font>
<font></font>
<span class="hljs-comment"># ,     </span>
EXPECTED = <span class="hljs-string">"Task 'test' created with number 1.\n"</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
原則として、上記のすべてはライブラリを実証するのに十分です。</font><font style="vertical-align: inherit;">完全なソースコードは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リポジトリで</font><font style="vertical-align: inherit;">入手でき</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">argparse</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
で</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">argparse</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">明確な利点を持っている-それが標準ライブラリであり、そのAPIを学ぶことは難しいことではありません：パーサーがあり、引数内の引数があります持っている</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タイプで</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アクション</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DEST</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デフォルト</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヘルプ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">そして、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブパーサー</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -引数とロジックの一部を別々のコマンドに分離する機能があります。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パーサー</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一見したところ、珍しいことではありませんが、パーサーはパーサーのようなものです。</font><font style="vertical-align: inherit;">しかし、私の意見では、他のライブラリと比較した場合、読みやすさは最高ではありません。</font><font style="vertical-align: inherit;">さまざまなコマンドの引数が1か所に記述されています。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソース</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_parser</span>():</span>
    parser = argparse.ArgumentParser(<span class="hljs-string">"Todo notes - argparse version"</span>)<font></font>
    parser.add_argument(<font></font>
        <span class="hljs-string">"--verbose"</span>, <span class="hljs-string">"-v"</span>, action=<span class="hljs-string">"store_true"</span>, help=<span class="hljs-string">"Enable verbose mode"</span><font></font>
    )<font></font>
    parser.add_argument(<span class="hljs-string">"--version"</span>, <span class="hljs-string">"-V"</span>, action=<span class="hljs-string">"store_true"</span>, help=<span class="hljs-string">"Show version"</span>)<font></font>
    subparsers = parser.add_subparsers(title=<span class="hljs-string">"Commands"</span>, dest=<span class="hljs-string">"cmd"</span>)<font></font>
<font></font>
    add = subparsers.add_parser(<span class="hljs-string">"add"</span>, help=<span class="hljs-string">"Add new task"</span>)<font></font>
    add.add_argument(<span class="hljs-string">"title"</span>, help=<span class="hljs-string">"Todo title"</span>)<font></font>
<font></font>
    show = subparsers.add_parser(<span class="hljs-string">"show"</span>, help=<span class="hljs-string">"Show tasks"</span>)<font></font>
    show.add_argument(<font></font>
        <span class="hljs-string">"--show-done"</span>, action=<span class="hljs-string">"store_true"</span>, help=<span class="hljs-string">"Include done tasks in the output"</span><font></font>
    )<font></font>
<font></font>
    done = subparsers.add_parser(<span class="hljs-string">"done"</span>, help=<span class="hljs-string">"Mark task as done"</span>)<font></font>
    done.add_argument(<span class="hljs-string">"number"</span>, type=int, help=<span class="hljs-string">"Task number"</span>)<font></font>
<font></font>
    remove = subparsers.add_parser(<span class="hljs-string">"remove"</span>, help=<span class="hljs-string">"Remove task"</span>)<font></font>
    remove.add_argument(<span class="hljs-string">"number"</span>, type=int, help=<span class="hljs-string">"Task number"</span>)<font></font>
<font></font>
    <span class="hljs-keyword">return</span> parser
</code></pre><br>
</div></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メイン</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、これも同じことです。引数を解析することを除いて、パーサーはこれ以上何もできません。そのため、ロジックは独立して1か所で記述する必要があります。</font><font style="vertical-align: inherit;">一方で-生きることが可能であり、もう一方ではより良い可能性がありますが、その方法はまだ明確ではありません。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD：</font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">気づいたように</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダー</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実際、サブパーサーはset_defaults（func = foo）を介して関数を設定できます。つまり、argparseを使用すると、メインを小さいサイズに短縮できます。</font><font style="vertical-align: inherit;">生活し、学びます。</font></font></i><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソース</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">raw_args=None</span>):</span>
    <span class="hljs-string">""" Argparse example entrypoint """</span><font></font>
    parser = get_parser()<font></font>
    args = parser.parse_args(raw_args)<font></font>
    logging.basicConfig()<font></font>
<font></font>
    <span class="hljs-keyword">if</span> args.verbose:<font></font>
        logging.getLogger(<span class="hljs-string">"todolib"</span>).setLevel(logging.INFO)
    <span class="hljs-keyword">if</span> args.version:<font></font>
        print(lib_version)<font></font>
        exit(<span class="hljs-number">0</span>)<font></font>
    cmd = args.cmd<font></font>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> cmd:<font></font>
        parser.print_help()<font></font>
        exit(<span class="hljs-number">1</span>)
    <span class="hljs-keyword">with</span> TodoApp.fromenv() <span class="hljs-keyword">as</span> app:
        <span class="hljs-keyword">if</span> cmd == <span class="hljs-string">"add"</span>:<font></font>
            task = app.add_task(args.title)<font></font>
            print(task, <span class="hljs-string">"created with number"</span>, task.number, end=<span class="hljs-string">".\n"</span>)
        <span class="hljs-keyword">elif</span> cmd == <span class="hljs-string">"show"</span>:<font></font>
            app.print_tasks(args.show_done)<font></font>
        <span class="hljs-keyword">elif</span> cmd == <span class="hljs-string">"done"</span>:<font></font>
            task = app.task_done(args.number)<font></font>
            print(task, <span class="hljs-string">"marked as done."</span>)
        <span class="hljs-keyword">elif</span> cmd == <span class="hljs-string">"remove"</span>:<font></font>
            task = app.remove_task(args.number)<font></font>
            print(task, <span class="hljs-string">"removed from list."</span>)
</code></pre><br>
</div></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テスト中</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーティリティの出力を確認するには、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">capsys</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィクスチャを</font><i><font style="vertical-align: inherit;">使用</font></i><font style="vertical-align: inherit;">します。これにより、stdoutおよびstderrからのテキストにアクセスできます。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_argparse</span>(<span class="hljs-params">capsys</span>):</span>
    todo_argparse.main([<span class="hljs-string">"add"</span>, <span class="hljs-string">"test"</span>])<font></font>
    out, _ = capsys.readouterr()<font></font>
    <span class="hljs-keyword">assert</span> out == EXPECTED
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">合計</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
利点-解析のための良い機会のセット、標準ライブラリ内のモジュールの存在。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
短所-argparseは引数のみを解析します。メインのロジックのほとんどは自分で作成する必要がありました。</font><font style="vertical-align: inherit;">また、テストで終了コードをテストする方法は明確ではありません。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Docopt</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docopt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は小さな（argparseを使用した2500と比較して600行未満）パーサーであり、GitHubの説明を引用することで笑顔になります。</font><font style="vertical-align: inherit;">docoptの主なアイデアは、たとえばdocstringのように、インターフェースをテキストで文字どおりに記述することです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同じgithubのdocopt&gt; 6700つ星で、少なくとも22千の他のプロジェクトで使用されています。</font><font style="vertical-align: inherit;">そして、これはpython実装でのみです！</font><font style="vertical-align: inherit;">docoptプロジェクトページには、CやPHPからCoffeeScript、さらにはRまで、さまざまな言語用の多くのオプションがあります。このようなクロスプラットフォームは、コードの簡潔さと単純さによってのみ説明できます。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パーサー</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
argparseと比較すると、このパーサーは大きな前進です。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-string">"""Todo notes on docopt.

Usage:
  todo_docopt [-v | -vv ] add &lt;task&gt;
  todo_docopt [-v | -vv ] show --show-done
  todo_docopt [-v | -vv ] done &lt;number&gt;
  todo_docopt [-v | -vv ] remove &lt;number&gt;
  todo_docopt -h | --help
  todo_docopt --version

Options:
  -h --help     Show help.
  -v --verbose  Enable verbose mode.
"""</span>
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メイン</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般に、すべてがargparseと同じですが、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">詳細に</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はいくつかの値（0-2）があり、引数へのアクセスは異なります：docoptは属性を持つ名前空間ではなく、コマンドの選択が示されるディクショナリのみを返します</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ifに</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">見られるように、彼女のブール値を通して</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソース</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv=None</span>):</span><font></font>
    args = docopt(__doc__, argv=argv, version=lib_version)<font></font>
    log.setLevel(levels[args[<span class="hljs-string">"--verbose"</span>]])<font></font>
    logging.basicConfig()<font></font>
    log.debug(<span class="hljs-string">"Arguments: %s"</span>, args)<font></font>
<font></font>
    <span class="hljs-keyword">with</span> TodoApp.fromenv() <span class="hljs-keyword">as</span> app:
        <span class="hljs-keyword">if</span> args[<span class="hljs-string">"add"</span>]:<font></font>
            task = app.add_task(args[<span class="hljs-string">"&lt;task&gt;"</span>])<font></font>
            print(task, <span class="hljs-string">"created with number"</span>, task.number, end=<span class="hljs-string">".\n"</span>)
        <span class="hljs-keyword">elif</span> args[<span class="hljs-string">"show"</span>]:<font></font>
            app.print_tasks(args[<span class="hljs-string">"--show-done"</span>])
        <span class="hljs-keyword">elif</span> args[<span class="hljs-string">"done"</span>]:<font></font>
            task = app.task_done(args[<span class="hljs-string">"&lt;number&gt;"</span>])<font></font>
            print(task, <span class="hljs-string">"marked as done."</span>)
        <span class="hljs-keyword">elif</span> args[<span class="hljs-string">"remove"</span>]:<font></font>
            task = app.remove_task(args[<span class="hljs-string">"&lt;number&gt;"</span>])<font></font>
            print(task, <span class="hljs-string">"removed from list."</span>)
</code></pre><br>
</div></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テスト中</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
argparseテストに似ています：</font></font><br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_docopt</span>(<span class="hljs-params">capsys</span>):</span>
    todo_docopt.main([<span class="hljs-string">"add"</span>, <span class="hljs-string">"test"</span>])<font></font>
    out, _ = capsys.readouterr()<font></font>
    <span class="hljs-keyword">assert</span> out == EXPECTED
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">合計</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
利点-パーサーのコードがはるかに少ないこと、コマンドと引数の記述と読み取りの容易さ、組み込みバージョン。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず短所、argparseと同じ-のロジックの多くの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主要な</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、あなたはテスト終了コードすることはできません。</font><font style="vertical-align: inherit;">さらに、docoptの現在のバージョン（0.6.2）はまだ安定しておらず、今後もそうなる可能性は低いです。プロジェクトは</font><font style="vertical-align: inherit;">2012年から2013年末まで</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">活発に</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">開発されており、最後のコミットは12月17日でした。</font><font style="vertical-align: inherit;">現時点で最も不愉快なのは、一部のdocopt常連がテスト中にDeprecationWarningを引き起こすことです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クリック</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クリックは</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> argparseやdocoptとは機能の数とデコレーターを介してコマンドとパラメーターを記述する方法</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">が</font></a><font style="vertical-align: inherit;">根本的に異なり、ロジック自体は大きな</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ではなく個別の関数に分離することが提案されています</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">著者は、Clickには多くの設定があると主張していますが、標準のパラメーターで十分です。</font><font style="vertical-align: inherit;">機能の中では、ネストされたコマンドとその遅延読み込みが強調されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロジェクトは非常に人気があります：8100個を超えるスターを持ち、少なくとも174千（！）個のプロジェクトで使用することに加えて、まだ開発中です：バージョン7.0が2018年秋にリリースされ、新しいコミットとマージリクエストがこの日に表示されます日。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パーサー</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ドキュメントページでは、私が見つかりました。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">confirmation_optionの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デコレータ</font><font style="vertical-align: inherit;">コマンドを実行する前に、ユーザーからの確認を求められます。</font><font style="vertical-align: inherit;">それを示すために、タスクのリスト全体をクリアするワイプコマンドが追加されました。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソース</font></font></b><div class="spoiler_text"><pre><code class="python hljs">levels = [logging.WARN, logging.INFO, logging.DEBUG]<font></font>
<font></font>
pass_app = click.make_pass_decorator(TodoApp)<font></font>
<font></font>
<font></font>
<span class="hljs-meta">@click.group()</span>
<span class="hljs-meta">@click.version_option(lib_version, prog_name="todo_click")</span>
<span class="hljs-meta">@click.option("-v", "--verbose", count=True)</span>
<span class="hljs-comment"># click   ,    </span>
<span class="hljs-meta">@click.option("--db", help="Path to the database file")</span>
<span class="hljs-meta">@click.pass_context</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">cli</span>(<span class="hljs-params">ctx, verbose, db</span>):</span>
    <span class="hljs-string">"""Todo notes - click version."""</span>
    level = levels[min(verbose, <span class="hljs-number">2</span>)]<font></font>
    logging.basicConfig(level=level)<font></font>
    logging.getLogger(<span class="hljs-string">"todolib"</span>).setLevel(level)<font></font>
    ctx.obj = TodoApp.fromenv(db)<font></font>
    atexit.register(ctx.obj.save)<font></font>
<font></font>
<font></font>
<span class="hljs-meta">@cli.command()</span>
<span class="hljs-meta">@click.argument("task")</span>
<span class="hljs-meta">@pass_app</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add</span>(<span class="hljs-params">app, task</span>):</span>
    <span class="hljs-string">""" Add new task. """</span><font></font>
    task = app.add_task(task)<font></font>
    click.echo(<span class="hljs-string">f"<span class="hljs-subst">{task}</span> created with number <span class="hljs-subst">{task.number}</span>."</span>)<font></font>
<font></font>
<font></font>
<span class="hljs-meta">@cli.command()</span>
<span class="hljs-meta">@click.option("--show-done", is_flag=True, help="Include done tasks")</span>
<span class="hljs-meta">@pass_app</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">show</span>(<span class="hljs-params">app, show_done</span>):</span>
    <span class="hljs-string">""" Show current tasks. """</span><font></font>
    app.print_tasks(show_done)<font></font>
<font></font>
<font></font>
<span class="hljs-meta">@cli.command()</span>
<span class="hljs-meta">@click.argument("number", type=int)</span>
<span class="hljs-meta">@pass_app</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">done</span>(<span class="hljs-params">app, number</span>):</span>
    <span class="hljs-string">""" Mark task as done. """</span><font></font>
    task = app.task_done(number)<font></font>
    click.echo(<span class="hljs-string">f"<span class="hljs-subst">{task}</span> marked as done."</span>)<font></font>
<font></font>
<font></font>
<span class="hljs-meta">@cli.command()</span>
<span class="hljs-meta">@click.argument("number", type=int)</span>
<span class="hljs-meta">@pass_app</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">remove</span>(<span class="hljs-params">app, number</span>):</span>
    <span class="hljs-string">""" Remove task from the list. """</span><font></font>
    task = app.remove_task(number)<font></font>
    click.echo(<span class="hljs-string">f"<span class="hljs-subst">{task}</span> removed from the list."</span>)<font></font>
<font></font>
<font></font>
<span class="hljs-meta">@cli.command()</span>
<span class="hljs-meta">@click.confirmation_option(prompt="Are you sure you want to remove database")</span>
<span class="hljs-meta">@pass_app</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wipe</span>(<span class="hljs-params">app</span>):</span>
    <span class="hljs-keyword">for</span> task <span class="hljs-keyword">in</span> app.list_tasks():<font></font>
        task.remove()<font></font>
</code></pre><br>
</div></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メイン</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでClickの主な利点に遭遇します。コマンドのロジックが機能によって分離されているため、メインにはほとんど何も残っていません。</font><font style="vertical-align: inherit;">また、環境変数から引数とパラメーターを受け取るライブラリーの機能も示します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:<font></font>
    cli(auto_envvar_prefix=<span class="hljs-string">"TODO"</span>)
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テスト中</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Clickの場合、</font><font style="vertical-align: inherit;">そのようなことのためのランナーを持つ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">click.testing</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モジュールがあるので、sys.stdoutをインターセプトする必要はありません</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">また</font><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CliRunner</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自体が出力をインターセプトする</font><font style="vertical-align: inherit;">だけでなく</font><font style="vertical-align: inherit;">、終了コードを確認することもできます。</font><font style="vertical-align: inherit;">このすべてがpytestを使用し、標準とすることにより取得することなく、テストクリックユーティリティにあなたを可能にする</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユニットテスト</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モジュール</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> click.testing
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_click</span>():</span><font></font>
    runner = click.testing.CliRunner()<font></font>
    result = runner.invoke(todo_click.cli, [<span class="hljs-string">"add"</span>, <span class="hljs-string">"test"</span>])
    <span class="hljs-keyword">assert</span> result.exit_code == <span class="hljs-number">0</span>
    <span class="hljs-keyword">assert</span> result.output == EXPECTED
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">合計</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはクリックができることのほんの一部です。</font><font style="vertical-align: inherit;">残りのAPIから-値の検証、ターミナルとの統合（色、ページャー、より少ない、進行状況バーなど）、結果のコールバック、オートコンプリートなど。</font><font style="vertical-align: inherit;">あなたは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彼らの例を見ることができ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
長所：あらゆる機会のための多くのツール、オリジナルであると同時に、チームを説明するための便利なアプローチ、テストの容易さ、アクティブなプロジェクトライフ。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
短所：「クリック」の欠点は何ですか？これは難しい質問です。</font><font style="vertical-align: inherit;">たぶん、彼は次のライブラリで何ができるのか知りませんか？</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">火</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fire</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、Googleからのコンソールインターフェース用の若い（2017年に登場した）ライブラリではなく、逐語的に引用して、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あらゆる</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Python </font><i><font style="vertical-align: inherit;">オブジェクト</font></i><font style="vertical-align: inherit;">からコンソールインターフェースを生成するためのライブラリです</font><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
とりわけ、fireはコードの開発とデバッグに役立ち、CLIで既存のコードを適応させるのに役立ち、bashからPythonへの移行を容易にし、インタラクティブな作業のための独自のREPLを持っていると述べられています。</font><font style="vertical-align: inherit;">様子を見よう？</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パーサーとメイン</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fire.Fireは実際には、任意のオブジェクト（モジュール、クラスインスタンス、コマンド名と対応する関数を含む辞書など）を受け入れることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちにとって重要なのは、Fireがクラスオブジェクトの転送を許可することです。</font><font style="vertical-align: inherit;">したがって、クラスコンストラクターはすべてのコマンドに共通の引数を受け入れ、そのメソッドと属性は個別のコマンドです。</font><font style="vertical-align: inherit;">これを使用します：</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソース</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Commands</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, db=None, verbose=False</span>):</span>
        level = logging.INFO <span class="hljs-keyword">if</span> verbose <span class="hljs-keyword">else</span> logging.WARNING<font></font>
        logging.basicConfig(level=level)<font></font>
        logging.getLogger(<span class="hljs-string">"todolib"</span>).setLevel(level)<font></font>
        self._app = todolib.TodoApp.fromenv(db)<font></font>
        atexit.register(self._app.save)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">version</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-keyword">return</span> todolib.__version__<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add</span>(<span class="hljs-params">self, task</span>):</span>
        <span class="hljs-string">"""Add new task."""</span><font></font>
        task = self._app.add_task(task)<font></font>
        print(task, <span class="hljs-string">"created with number"</span>, task.number, end=<span class="hljs-string">".\n"</span>)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">show</span>(<span class="hljs-params">self, show_done=False</span>):</span>
        <span class="hljs-string">""" Show current tasks. """</span><font></font>
        self._app.print_tasks(show_done)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">done</span>(<span class="hljs-params">self, number</span>):</span>
        <span class="hljs-string">""" Mark task as done. """</span><font></font>
        task = self._app.task_done(number)<font></font>
        print(task, <span class="hljs-string">"marked as done."</span>)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">remove</span>(<span class="hljs-params">self, number</span>):</span>
        <span class="hljs-string">""" Removes task from the list. """</span><font></font>
        task = self._app.remove_task(number)<font></font>
        print(task, <span class="hljs-string">"removed from the list."</span>)<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">args=None</span>):</span><font></font>
    fire.Fire(Commands, command=args)<font></font>
</code></pre><br>
</div></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インラインフラグ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fireには特別な構文を持つ独自のフラグがあり（「-」の後に渡す必要があります）、パーサーとアプリケーション全体の内部を確認できます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呼び出し例</font></font></b><div class="spoiler_text"><pre><code class="bash hljs">$ ./todo_fire.py show -- --trace<font></font>
Fire trace:<font></font>
1. Initial component<font></font>
2. Instantiated class <span class="hljs-string">"Commands"</span> (todo_fire.py:9)<font></font>
3. Accessed property <span class="hljs-string">"show"</span> (todo_fire.py:25)<font></font>
$ ./todo_fire.py -- --verbose | head -n 12 <span class="hljs-comment">#    , ,  Commands._app</span><font></font>
NAME<font></font>
    todo_fire.py -<font></font>
<font></font>
SYNOPSIS<font></font>
    todo_fire.py - GROUP | COMMAND<font></font>
<font></font>
GROUPS<font></font>
    GROUP is one of the following:<font></font>
<font></font>
     _app<font></font>
       Todo Application definition.<font></font>
$ ./todo_fire.py show -- --interactive<font></font>
Fire is starting a Python REPL with the following objects:<font></font>
Modules: atexit, fire, logging, todolib<font></font>
Objects: Commands, args, component, main, result, self, todo_fire.py, trace<font></font>
<font></font>
Python 3.7.4 (default, Aug 15 2019, 13:09:37) <font></font>
[GCC 7.4.0] on linux<font></font>
Type <span class="hljs-string">"help"</span>, <span class="hljs-string">"copyright"</span>, <span class="hljs-string">"credits"</span> or <span class="hljs-string">"license"</span> <span class="hljs-keyword">for</span> more information.<font></font>
(InteractiveConsole)<font></font>
&gt;&gt;&gt; self<font></font>
&lt;__main__.Commands object at 0x7fd0a6125bd0&gt;<font></font>
&gt;&gt;&gt; self._app.db<font></font>
{<span class="hljs-string">'tasks'</span>: [{<span class="hljs-string">'title'</span>: <span class="hljs-string">'test'</span>, <span class="hljs-string">'done'</span>: False}]}
</code></pre><br>
</div></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テスト中</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
main関数のテストはargparseとdocoptのテストに似ているので、ここでは要点がわかりません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同時に、Fireの内省的な性質により、Commandsクラスをすぐにテストすることも同様に可能であることは注目に値します。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">合計</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
火はクリックよりも興味深いツールです。</font><font style="vertical-align: inherit;">パーサーに多くのオプションをリストする必要はありません。構成は最小限で、デバッグ用のオプションがあり、ライブラリー自体</font><font style="vertical-align: inherit;">はクリックよりもアクティブに</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">開発され</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます（今夏60コミット）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
短所：クリックや他のパーサーよりもはるかに少ないことができます。</font><font style="vertical-align: inherit;">不安定なAPI（現在のバージョンは0.2.1）。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セメント</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cementは</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正確にはCLIライブラリではなく、コンソールアプリケーションのフレームワークですが、さまざまな統合を備えたスクリプトや複雑なアプリケーションに適していると主張されています。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パーサー</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cementのパーサーは異常に見えますが、パラメーターをよく見ると、おなじみのargparseが内部にあると推測するのは簡単です。</font><font style="vertical-align: inherit;">しかし、おそらくこれは最善の方法です-新しいパラメータを学ぶ必要はありません。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソース</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">from</span> cement <span class="hljs-keyword">import</span> Controller, ex
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Base</span>(<span class="hljs-params">Controller</span>):</span>
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Meta</span>:</span>
        label = <span class="hljs-string">"base"</span><font></font>
<font></font>
        arguments = [<font></font>
            (<font></font>
                [<span class="hljs-string">"-v"</span>, <span class="hljs-string">"--version"</span>],<font></font>
                {<span class="hljs-string">"action"</span>: <span class="hljs-string">"version"</span>, <span class="hljs-string">"version"</span>: <span class="hljs-string">f"todo_cement v<span class="hljs-subst">{todolib.__version__}</span>"</span>},<font></font>
            )<font></font>
        ]<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_default</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-string">"""Default action if no sub-command is passed."""</span><font></font>
        self.app.args.print_help()<font></font>
<font></font>
<span class="hljs-meta">    @ex(help="Add new task", arguments=[(["task"], {"help": "Task title"})])</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add</span>(<span class="hljs-params">self</span>):</span><font></font>
        title = self.app.pargs.task<font></font>
        self.app.log.debug(<span class="hljs-string">f"Task title: <span class="hljs-subst">{title!r}</span>"</span>)<font></font>
        task = self.app.todoobj.add_task(title)<font></font>
        print(task, <span class="hljs-string">"created with number"</span>, task.number, end=<span class="hljs-string">".\n"</span>)<font></font>
<font></font>
<span class="hljs-meta">    @ex(</span>
        help=<span class="hljs-string">"Show current tasks"</span>,<font></font>
        arguments=[<font></font>
            ([<span class="hljs-string">"--show-done"</span>], dict(action=<span class="hljs-string">"store_true"</span>, help=<span class="hljs-string">"Include done tasks"</span>))<font></font>
        ],<font></font>
    )<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">show</span>(<span class="hljs-params">self</span>):</span><font></font>
        self.app.todoobj.print_tasks(self.app.pargs.show_done)<font></font>
<font></font>
<span class="hljs-meta">    @ex(help="Mark task as done", arguments=[(["number"], {"type": int})])</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">done</span>(<span class="hljs-params">self</span>):</span><font></font>
        task = self.app.todoobj.task_done(self.app.pargs.number)<font></font>
        print(task, <span class="hljs-string">"marked as done."</span>)<font></font>
<font></font>
<span class="hljs-meta">    @ex(help="Remove task from the list", arguments=[(["number"], {"type": int})])</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">remove</span>(<span class="hljs-params">self</span>):</span><font></font>
        task = self.app.todoobj.remove_task(self.app.pargs.number)<font></font>
        print(task, <span class="hljs-string">"removed from the list."</span>)
</code></pre><br>
</div></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリとメイン</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
とりわけ、セメントは依然として例外で信号をラップします。</font><font style="vertical-align: inherit;">これは、SIGINT / SIGTERMのゼロコード出力でここに示されています。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソース</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TodoApp</span>(<span class="hljs-params">App</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, argv=None</span>):</span><font></font>
        super().__init__(argv=argv)<font></font>
        self.todoobj = <span class="hljs-literal">None</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">load_db</span>(<span class="hljs-params">self</span>):</span><font></font>
        self.todoobj = todolib.TodoApp.fromenv()<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">save</span>(<span class="hljs-params">self</span>):</span><font></font>
        self.todoobj.save()<font></font>
<font></font>
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Meta</span>:</span>
        <span class="hljs-comment"># application label</span>
        label = <span class="hljs-string">"todo_cement"</span>
        <span class="hljs-comment"># register handlers</span><font></font>
        handlers = [Base]<font></font>
        hooks = [(<span class="hljs-string">"post_setup"</span>, <span class="hljs-keyword">lambda</span> app: app.load_db()), (<span class="hljs-string">"pre_close"</span>, <span class="hljs-keyword">lambda</span> app: app.save())]
        <span class="hljs-comment"># call sys.exit() on close</span>
        close_on_exit = <span class="hljs-literal">True</span><font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span>
    <span class="hljs-keyword">with</span> TodoApp() <span class="hljs-keyword">as</span> app:
        <span class="hljs-keyword">try</span>:<font></font>
            app.run()<font></font>
        <span class="hljs-keyword">except</span> CaughtSignal <span class="hljs-keyword">as</span> e:
            <span class="hljs-keyword">if</span> e.signum <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> (signal.SIGINT, signal.SIGTERM):
                <span class="hljs-keyword">raise</span>
            app.log.debug(<span class="hljs-string">f"\n<span class="hljs-subst">{e}</span>"</span>)<font></font>
            app.exit_code = <span class="hljs-number">0</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メインのフェーズを読むと、オーバーライドされた__enter __ / __ exit__でtodolib.TodoAppのロードと保存を行うこともできますが、セメントフックを示すために、これらのフェーズは最終的に個別のメソッドに分離されました。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テスト中</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テストには、同じアプリケーションクラスを使用できます。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_cement</span>(<span class="hljs-params">capsys</span>):</span>
    <span class="hljs-keyword">with</span> todo_cement.TodoApp(argv=[<span class="hljs-string">"add"</span>, <span class="hljs-string">"test"</span>]) <span class="hljs-keyword">as</span> app:<font></font>
        app.run()<font></font>
        out, _ = capsys.readouterr()<font></font>
        <span class="hljs-keyword">assert</span> out == EXPECTED
        <span class="hljs-comment">#     jinja,      </span>
        <span class="hljs-keyword">assert</span> app.last_rendered <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">概要</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
長所：APIのセットはスイスのナイフのセットのようなもので、フックとプラグインによる拡張性、安定したインターフェースとアクティブな開発です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
短所：空のドキュメント。</font><font style="vertical-align: inherit;">小さなセメントベースのスクリプトは少し複雑に見えるかもしれません。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クレオ</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cleoは</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここに記載されている他のフレームワーク（GitHubで合計約400スター）ほど人気のフレームワークに</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">は</font></a><font style="vertical-align: inherit;">程遠いですが、Poetryが出力をフォーマットする方法を研究したとき、それを知ることができました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、Cleoは依存関係、virtualenv、およびアプリケーションビルドを管理するためのツールである、すでに述べた詩の作者のプロジェクトの1つです。</font><font style="vertical-align: inherit;">すでに複数回書かれているhabrの詩について、およびそのコンソール部分について-いいえ。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パーサー</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クレオは、セメントと同様に、オブジェクトの原則に基づいて構築されています。</font><font style="vertical-align: inherit;">コマンドはCommandクラスとそのdocstringを介して定義され、パラメーターはoption（）メソッドを介してアクセスされます。</font><font style="vertical-align: inherit;">さらに、テキストの出力に使用されるline（）メソッドは、スタイル（つまり、色）と、ボックスからの詳細フラグの数に基づく出力フィルタリングをサポートします。</font><font style="vertical-align: inherit;">クレオにもテーブル出力があります。</font><font style="vertical-align: inherit;">また、プログレスバー。</font><font style="vertical-align: inherit;">そして、まだ...一般的に、以下を参照してください：</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソース</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">from</span> cleo <span class="hljs-keyword">import</span> Command <span class="hljs-keyword">as</span> BaseCommand
<span class="hljs-comment"># cleo    clikit,         </span>
<span class="hljs-keyword">from</span> clikit.api.io <span class="hljs-keyword">import</span> flags <span class="hljs-keyword">as</span> verbosity<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Command</span>(<span class="hljs-params">BaseCommand</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><font></font>
        super().__init__()<font></font>
        self.todoapp = <span class="hljs-literal">None</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">handle</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-keyword">with</span> todolib.TodoApp.fromenv() <span class="hljs-keyword">as</span> app:<font></font>
            self.todoapp = app<font></font>
            self.do_handle()<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">do_handle</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-keyword">raise</span> NotImplementedError<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AddCommand</span>(<span class="hljs-params">Command</span>):</span>
    <span class="hljs-string">"""
    Add new task.

    add {task : Task to add}
    """</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">do_handle</span>(<span class="hljs-params">self</span>):</span>
        title = self.argument(<span class="hljs-string">"task"</span>)<font></font>
        task = self.todoapp.add_task(title)<font></font>
        <span class="hljs-comment"># will be printed only on "-vvv"</span>
        self.line(<span class="hljs-string">f"Title: <span class="hljs-subst">{title}</span>"</span>, style=<span class="hljs-string">"comment"</span>, verbosity=verbosity.DEBUG)<font></font>
        self.line(<span class="hljs-string">f"Task &lt;info&gt;<span class="hljs-subst">{task.title}</span>&lt;/&gt; created with number <span class="hljs-subst">{task.number}</span>."</span>)<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ShowCommand</span>(<span class="hljs-params">Command</span>):</span>
    <span class="hljs-string">"""
    Show current tasks.

    show {--show-done : Include tasks that are done.}
    """</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">do_handle</span>(<span class="hljs-params">self</span>):</span>
        tasks = self.todoapp.list_tasks(self.option(<span class="hljs-string">"show-done"</span>))
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> tasks:<font></font>
            self.line(<span class="hljs-string">"There is no TODOs."</span>, style=<span class="hljs-string">"info"</span>)<font></font>
        self.render_table(<font></font>
            [<span class="hljs-string">"Number"</span>, <span class="hljs-string">"Title"</span>, <span class="hljs-string">"Status"</span>],<font></font>
            [<font></font>
                [str(task.number), task.title, <span class="hljs-string">""</span> <span class="hljs-keyword">if</span> task.done <span class="hljs-keyword">else</span> <span class="hljs-string">"✘"</span>]
                <span class="hljs-keyword">for</span> task <span class="hljs-keyword">in</span> tasks<font></font>
            ],<font></font>
        )<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DoneCommand</span>(<span class="hljs-params">Command</span>):</span>
    <span class="hljs-string">"""
    Mark task as done.

    done {number : Task number}
    """</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">do_handle</span>(<span class="hljs-params">self</span>):</span>
        task = self.todoapp.task_done(int(self.argument(<span class="hljs-string">"number"</span>)))<font></font>
        self.line(<span class="hljs-string">f"Task &lt;info&gt;<span class="hljs-subst">{task.title}</span>&lt;/&gt; marked as done."</span>)<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RemoveCommand</span>(<span class="hljs-params">Command</span>):</span>
    <span class="hljs-string">"""
    Removes task from the list.

    remove {number : Task number}
    """</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">do_handle</span>(<span class="hljs-params">self</span>):</span>
        task = self.todoapp.remove_task(int(self.argument(<span class="hljs-string">"number"</span>)))<font></font>
        self.line(<span class="hljs-string">f"Task &lt;info&gt;<span class="hljs-subst">{task.title}</span>&lt;/&gt; removed from the list."</span>)
</code></pre><br>
</div></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メイン</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
必要なのは、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cleo.Application</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オブジェクトを作成し、</font><i><font style="vertical-align: inherit;">add_commandsに</font></i><font style="vertical-align: inherit;">コマンドを渡すことだけです。</font><font style="vertical-align: inherit;">テスト中に繰り返さないようにするため、これはすべてメインからコンストラクタに転送されました。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> cleo <span class="hljs-keyword">import</span> Application <span class="hljs-keyword">as</span> BaseApplication<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TodoApp</span>(<span class="hljs-params">BaseApplication</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>
        super().__init__(name=<span class="hljs-string">"ToDo app - cleo version"</span>, version=todolib.__version__)<font></font>
        self.add_commands(AddCommand(), ShowCommand(), DoneCommand(), RemoveCommand())<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">args=None</span>):</span><font></font>
    TodoApp().run(args=args)<font></font>
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テスト中</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cleoでコマンドをテストするため</font><s><font style="vertical-align: inherit;">に、</font></s><font style="vertical-align: inherit;">フレームワークの</font><font style="vertical-align: inherit;">すべての成人の</font><s><font style="vertical-align: inherit;">叔父の</font></s><font style="vertical-align: inherit;">ように</font><font style="vertical-align: inherit;">、I / Oをインターセプトしてコードを終了する</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CommandTester</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">があり</font><font style="vertical-align: inherit;">ます。</font></font><s><font style="vertical-align: inherit;"></font></s><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_cleo</span>():</span><font></font>
    app = todo_cleo.TodoApp()<font></font>
    command = app.find(<span class="hljs-string">"add"</span>)<font></font>
    tester = cleo.CommandTester(command)<font></font>
    tester.execute(<span class="hljs-string">"test"</span>)
    <span class="hljs-keyword">assert</span> tester.status_code == <span class="hljs-number">0</span>
    <span class="hljs-keyword">assert</span> tester.io.fetch_output() == <span class="hljs-string">"Task test created with number 0.\n"</span>
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">合計</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
長所：タイプヒントを含むオブジェクト構造。開発を簡素化します（多くのIDEとエディターはOOPコードとタイピングモジュールを適切にサポートしています）。引数だけでなくI / Oを操作するための十分な機能</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プラスまたはマイナス：I / O Cleo / CliKitとのみ互換性のある独自の冗長パラメーター。ロギングモジュールのカスタムハンドラーを作成することはできますが、cleoの開発に伴って維持するのが難しい場合があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
短所：明らかに-個人的な意見-若いAPI：フレームワークには、詩を除いて別の「大規模な」ユーザーが不足しており、Cleoは開発と並行して1つのニーズに合わせて開発します。ドキュメントが古くなっている場合があります（たとえば、ログレベルがclikitモジュールではなく、clikit.api.io.flagsにあるなど）。一般に、不十分でAPI全体を反映していません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cementと比較して、CleoはCLIに重点を置いており、デフォルトの出力での例外のフォーマット（デフォルトのスタックトレースを非表示にする）について考えたのは彼だけです。</font><font style="vertical-align: inherit;">しかし、彼-再び個人的な意見-は、APIの若さと安定性でセメントに負けました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最終的に</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この時点で、誰もがすでに自分の意見を持っていますが、それは良いことですが、結論は次のとおりです。何よりもClickが好きです。なぜなら、多くのものがあり、同時にアプリケーションの開発とテストが簡単だからです。</font><font style="vertical-align: inherit;">コードを最小限にしようとする場合は、Fireから始めてください。</font><font style="vertical-align: inherit;">スクリプトはMemcachedにアクセスする必要があり、jinjaと拡張性を使用してフォーマットします-セメントを取ると後悔しません。</font><font style="vertical-align: inherit;">ペットのプロジェクトがありますか、それとも他のことを試したいですか-クレオを見てください。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja466979/index.html">変数を使用してファイルの名前を変更する-Visual Studio Code</a></li>
<li><a href="../ja466983/index.html">テスラの経営に勝てない理由</a></li>
<li><a href="../ja466985/index.html">新しいC ++標準について</a></li>
<li><a href="../ja466987/index.html">非定型の「ls」またはlinuxoidの楽しみ方</a></li>
<li><a href="../ja466995/index.html">PVS-Studio統合用の警告次世代プラグインの構成</a></li>
<li><a href="../ja467003/index.html">1075カテゴリ（36000製品）の高速で便利な適応メニュー</a></li>
<li><a href="../ja467005/index.html">多項式を正しく着色する方法</a></li>
<li><a href="../ja467007/index.html">FLProg-カスタムコントローラーのプログラムへの独立した統合</a></li>
<li><a href="../ja467009/index.html">NotionとPythonを使用してホームライブラリを作成する</a></li>
<li><a href="../ja467011/index.html">データサイエンスを始めるために読むべきもの：本、辞書、コース</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>