<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👆🏾 👨🏿‍✈️ 🛵 Best Practices von Kubernetes. Zuordnung externer Dienste 👉🏿 🐛 🐼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Best Practices von Kubernetes. Erstellen kleiner Container 
 Best Practices für Kubernetes. Kubernetes-Organisation mit dem Kubernetes 
 Best Practice...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Best Practices von Kubernetes. Zuordnung externer Dienste</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/503612/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Best Practices von Kubernetes. Erstellen kleiner Container </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Best Practices für Kubernetes. Kubernetes-Organisation mit dem Kubernetes </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Best Practices-Namespace. Kubernetes-Lebensfähigkeitstest mit Bereitschafts- und Lebendigkeitstests Kubernetes </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Best Practices. Festlegen von Abfragen und Ressourcenbeschränkungen </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Best Practices für Kubernetes. Richtige Trennung von Terminate</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wenn Sie wie die meisten Menschen sind, verwenden Sie höchstwahrscheinlich Ressourcen, die außerhalb Ihres Clusters ausgeführt werden. Möglicherweise verwenden Sie die Taleo-API, um Textnachrichten zu senden oder Bilder mithilfe der Google Cloud Vision-API zu analysieren.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie denselben Endpunkt verwenden - den empfangsseitigen Anforderungsempfangspunkt in all Ihren Umgebungen und nicht vorhaben, Ihre Server an Kubernetes zu übertragen, ist es völlig normal, einen Endpunktdienst direkt in Ihrem Code zu haben. Es gibt jedoch viele andere Szenarien. In dieser Best Practices-Reihe von Kubernetes erfahren Sie, wie Sie mithilfe der in Kubernetes integrierten Mechanismen Dienste sowohl innerhalb als auch außerhalb des Clusters ermitteln. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein Beispiel für einen weit verbreiteten externen Dienst ist eine Datenbank, die außerhalb eines Kubernetes-Clusters ausgeführt wird. Im Gegensatz zu Cloud-Datenbanken wie dem Google Cloud Data Store oder Google Cloud Spanner, die einen Endpunkt für alle Zugriffsarten verwenden, verfügen die meisten Datenbanken über separate Endpunkte für unterschiedliche Umstände.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei Best Practices für die Verwendung herkömmlicher Datenbanken wie MySQL und MongoDB müssen Sie normalerweise eine Verbindung zu verschiedenen Komponenten für verschiedene Umgebungen herstellen. Möglicherweise verfügen Sie über eine große Maschine für Produktionsdaten und eine kleinere Maschine für eine Testumgebung. Jeder von ihnen hat seine eigene IP-Adresse oder seinen eigenen Domainnamen, aber Sie möchten Ihren Code wahrscheinlich nicht ändern, wenn Sie von einer Umgebung in eine andere wechseln. Anstatt diese Adressen fest zu codieren, können Sie den integrierten Kubernetes-Dienst verwenden, um externe DNS-basierte Dienste auf dieselbe Weise wie für native Kubernetes-Dienste zu ermitteln. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qg/lz/vj/qglzvjg0ysvnlejo7v6pvtqc1se.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angenommen, Sie führen die MongoDB-Datenbank in der Google Compute Engine aus. Sie werden in dieser hybriden Welt stecken bleiben, bis Sie es schaffen, sie auf einen Cluster zu übertragen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Glücklicherweise können Sie statische Dienste von Kubernetes verwenden, um Ihr Leben ein wenig einfacher zu gestalten. In diesem Beispiel habe ich mit dem Google Cloud Launcher einen MongoDB-Server erstellt. Da es im selben Netzwerk (oder Kubernetes VPC-Cluster) erstellt wurde, wird auf es über eine leistungsstarke interne IP-Adresse zugegriffen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/r3/ou/z8/r3ouz8pak0n-al5obbd6y81qkke.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist die Standardeinstellung in Google Cloud, sodass Sie nichts konfigurieren müssen. Nachdem Sie eine IP-Adresse haben, müssen Sie zunächst einen Dienst erstellen. Möglicherweise stellen Sie fest, dass für diesen Dienst keine Herdauswahl vorhanden ist. Das heißt, wir haben einen Dienst erstellt, der nicht weiß, wohin er Datenverkehr senden soll. Auf diese Weise können Sie manuell ein Endpunktobjekt erstellen, das Datenverkehr von diesem Dienst empfängt.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jo/tc/sr/jotcsra7vszs8kmlivxwl_awqsq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das folgende Codebeispiel zeigt, dass die Endpunkte die IP-Adresse für die Datenbank unter Verwendung des gleichen Mongonamens wie der Dienst bestimmen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/y9/dz/cb/y9dzcbounajojfgkqd-7osjcxka.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kubernetes verwendet alle IP-Adressen, um die Endpunkte so zu finden, als wären sie normale Kubernetes-Pods. Jetzt können Sie über eine einfache Verbindungszeichenfolge mit dem oben genannten Namen mongodb: // mongo auf die Datenbank zugreifen. Es ist jedoch überhaupt nicht erforderlich, IP-Adressen in Ihrem Code zu verwenden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn sich die IP-Adressen in Zukunft ändern, können Sie die Endpunkte einfach mit der neuen IP-Adresse aktualisieren, und Ihre Anwendungen müssen nicht weiter geändert werden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie eine Datenbank verwenden, die auf einem Host eines Drittanbieters gehostet wird, haben Ihnen die Eigentümer des Hosts höchstwahrscheinlich einen einheitlichen Ressourcen-ID-URI für die Verbindung bereitgestellt. Wenn Sie also eine IP-Adresse erhalten haben, können Sie einfach die vorherige Methode verwenden. Dieses Beispiel zeigt, dass ich zwei MongoDB-Datenbanken auf dem mLab-Host gehostet habe. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bd/er/w9/bderw9_a42oa_nap45ol_au_jla.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine davon ist eine Datenbank mit Entwicklern, die andere ist eine Produktionsdatenbank. Die Verbindungszeichenfolgen für diese Datenbanken lauten wie folgt: mLab bietet Ihnen einen dynamischen URI und einen dynamischen Port. Wie Sie sehen können, sind sie unterschiedlich. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fu/t9/v5/fut9v5yv1qtskdkx8tju2rmkmnq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um dies zu ignorieren, verwenden wir Kubernetes und stellen eine Verbindung zur Entwicklerdatenbank her. Sie können einen externen Kubernetes-Dienstnamen erstellen, der Ihnen einen statischen Dienst bereitstellt, der den Datenverkehr zum externen Dienst umleitet.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jo/63/u6/jo63u6uv1quvocf8fxh1bnv_6om.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Dienst führt eine einfache CNAME-Umleitung auf Kernelebene durch, die nur minimale Auswirkungen auf die Leistung hat. Dank dessen können Sie eine einfachere Verbindungszeichenfolge verwenden. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/es/ip/jm/esipjmsa8t8nagtrwu4slv55isa.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da der externe Name jedoch die CNAME-Umleitung verwendet, kann keine Portweiterleitung durchgeführt werden. Daher ist diese Lösung nur für statische Ports anwendbar und kann nicht mit dynamischen Ports verwendet werden. Die kostenlose kostenlose Stufe mLab stellt dem Benutzer jedoch standardmäßig eine dynamische Portnummer zur Verfügung, die Sie nicht ändern können. Dies bedeutet, dass Sie für dev und prod unterschiedliche Verbindungsbefehlszeilen benötigen. Die schlechte Nachricht ist, dass Sie die Portnummer fest codieren müssen. Wie bringt man die Portweiterleitung zum Laufen?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der erste Schritt besteht darin, die IP-Adresse vom URI abzurufen. Wenn Sie den Befehl nslookup, hostname oder ping the URI ausführen, können Sie die IP-Adresse der Datenbank abrufen. Wenn der Dienst gleichzeitig mehrere IP-Adressen an Sie zurückgibt, können alle diese Adressen an den Endpunkten des Objekts verwendet werden. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ox/ki/ox/oxkioxus5e4idcigbaufhqfyquk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beachten Sie, dass sich URI-IPs ohne vorherige Ankündigung ändern können. Daher ist es sehr riskant, sie in Produkten zu verwenden. Mit dieser IP-Adresse können Sie eine Verbindung zu einer entfernten Datenbank herstellen, ohne einen Port anzugeben. Somit führt der Kubernetes-Dienst die Portweiterleitung ziemlich transparent durch.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rs/iu/eo/rsiueor-lvslhr5vscjlowggkho.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durch das Zuordnen oder Zuordnen externer Ressourcen zu internen Ressourcen können Sie diese Dienste in Zukunft flexibel innerhalb des Clusters nutzen und gleichzeitig den Aufwand für das Refactoring minimieren. </font><font style="vertical-align: inherit;">Es erleichtert auch die Verwaltung und bietet Einblicke in die externen Services, die Ihr Unternehmen nutzt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wird sehr bald fortgesetzt ...</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/fvpq4jqtuZ8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein bisschen Werbung :)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vielen Dank für Ihren Aufenthalt bei uns. Gefällt dir unser Artikel? Möchten Sie weitere interessante Materialien sehen? Unterstützen Sie uns, indem Sie eine Bestellung </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">aufgeben</font></a><font style="vertical-align: inherit;"> oder Ihren Freunden </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloud-basiertes VPS für Entwickler ab 4,99 US-Dollar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> empfehlen </font><font style="vertical-align: inherit;">, ein </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einzigartiges Analogon von Einstiegsservern, das von uns für Sie erfunden wurde: </font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die ganze Wahrheit über VPS (KVM) E5-2697 v3 (6 Kerne) 10 GB DDR4 480 GB SSD 1 Gbit / s ab 19 $ oder wie teilt man den Server?</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Optionen sind mit RAID1 und RAID10, bis zu 24 Kernen und bis zu 40 GB DDR4 verfügbar). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R730xd 2-mal günstiger im Equinix Tier IV-Rechenzentrum in Amsterdam?</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nur wir haben </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x Intel TetraDeca-Core Xeon 2x E5-2697v3 2,6 GHz 14C 64 GB DDR4 4 x 960 GB SSD 1 Gbit / s 100 TV von 199 US-Dollar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in den Niederlanden!</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R420 - 2x E5-2430 2,2 GHz 6C 128 GB DDR3 2x960 GB SSD 1 Gbit / s 100 TB - ab 99 US-Dollar! </font></font></b></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lesen Sie mehr über</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> den Aufbau eines Infrastrukturgebäudes. </font><font style="vertical-align: inherit;">Klasse C mit Dell R730xd E5-2650 v4-Servern für 9.000 Euro für einen Cent?</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de503600/index.html">STM32MP1: U-Boot, Buildroot, Arch Linux und ein bisschen Debian</a></li>
<li><a href="../de503604/index.html">Sergey und "Programmieren ist besser als Sex"</a></li>
<li><a href="../de503606/index.html">Swift 5.3: Was ist neu?</a></li>
<li><a href="../de503608/index.html">Wie wir nach Virenfiltern gesucht haben</a></li>
<li><a href="../de503610/index.html">Warum nicht dein eigenes Lisp für das Web machen?</a></li>
<li><a href="../de503616/index.html">Wie wir einen Prototyp eines Roboter-Merchandisers erstellt haben und wie es weitergeht</a></li>
<li><a href="../de503620/index.html">Nachrichten aus der Welt von OpenStreetMap Nr. 512 (05.05.2020-11.05.2020)</a></li>
<li><a href="../de503624/index.html">Die Verdauung von frischen Materialien aus der Welt des Frontends für die letzte Woche Nr. 416 (18.-24. Mai 2020)</a></li>
<li><a href="../de503626/index.html">Testen. ISTQB-Zertifizierungsfehler oder lösen eine Million Beispiele</a></li>
<li><a href="../de503630/index.html">Augmented Reality Brille: Wo stehen wir jetzt?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>