<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßõ üîï ü§ó Root-of-Trust for IoT and Other IoT Security Trends üîû üõ§Ô∏è üßô</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The topic of information security is becoming increasingly relevant every year. The information security hub is in first place in the rating and secon...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Root-of-Trust for IoT and Other IoT Security Trends</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/499662/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The topic of information security is becoming increasingly relevant every year. The information security hub is in first place </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in the rating</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and second in the number of subscribers. However, the materials are mainly devoted to various network, web, cloud and other technologies traditionally considered in the context of security. And almost do not apply to embedded applications, especially with limited resources. While the number of the latter is more than orders of magnitude. In this article, we will look at some of the features and trends in the security of the Internet of things that have their origin in the development and distribution model.</font></font><br>
<img src="https://habrastorage.org/webt/y_/ms/gw/y_msgwijyou37b9shztfju944as.jpeg"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Development for embedded applications has always carried certain features, moreover, such that most "ordinary" programmers do not even think about it, and the concept of QA and the testing process in many cases are fundamentally different from what is generally understood. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One of the favorite and periodically discussed topics in the large IT channel in the Telegram </font></font></i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Embedded Group</font></font></i></a><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is ‚Äúwhy nobody understands embedded developers and pay so little? (against the background of "ordinary" programmers) ":) An</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
embedded system is a system that will work by being built directly into the device that it controls. A couple of photos for clarity: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zw/2l/jt/zw2ljt1kp3_jgef4dof4p6aanfi.jpeg"> <img src="https://habrastorage.org/webt/az/fi/92/azfi92h2leizojjmhkwbdibqoai.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The left image is taken from a </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Wikipedia</font></a><font style="vertical-align: inherit;"> article </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">about embedded systems</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, is an example of a large complex system. On the right is a photo from the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">review of the</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Redmond </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">smart home</font></a><font style="vertical-align: inherit;"> , everything is much simpler and more compact here, in fact the whole device is made on one chip with minimal binding. It is important that both devices function as complete devices (a single-board computer still needs a case and some peripherals). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a rule, a manufacturer company produces finished devices, which primarily includes hardware, and software, as a rule, is bundled and works only on this hardware. Almost no one would have the idea of ‚Äã‚Äãbuying a ‚Äúbare‚Äù smartphone without software, and then installing on the OS and the necessary applications, everything should work out of the box. As a result, developers often perform the entire spectrum of tasks for the development of devices, both software and hardware.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Another feature of development for embedded systems is that they almost always have much less resources, both in computing power and memory, data channel, as well as consumption. Most of the technologies familiar to many are impossible to run on such systems, even the OS is not everywhere. It is necessary to fit into the available resources and often save significantly. This also affects security - many standards from the Big World are not supported or are supported with restrictions. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C is still the most widely used language for developing embedded systems. It has a number of shortcomings in working with memory that directly affect security. To solve them, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rust</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> was developed </font><font style="vertical-align: inherit;">, it is gaining popularity (in the first place of your </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">favorite languages</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">on StackOverflow for several years, overtaking even Python and Kotlin, especially popular recently), but still far from the leader in applicability in embedded because of the supported systems and libraries. Higher-level languages ‚Äã‚Äãare rare for embedded systems and are likely to remain so soon.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An important feature of the development of embedded systems is the limitation of the hardware capabilities of the platform and SDK supplied by the manufacturer. It is simply impossible or extremely costly to implement many technologies on their own from scratch for a single project. Therefore, it is imperative that the chip manufacturer supports state-of-the-art security technologies. Until recently, so much attention was paid to this. For example, if the hardware AES appeared quite a long time ago at almost everyone, then many people still do not know how to support TLS / DTLS. The question is how to achieve this. I recently wrote about the new </font><font style="vertical-align: inherit;">Nordic </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zephyr SDK</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that solves this problem by integrating with a large project supported by the Linux Foundation. This is one approach. Below we will consider others.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As part of the consideration of the security of embedded systems, it is necessary to note a group of applications that fall under the requirements of functional safety standards: medicine, automotive, railway equipment, industrial automation. These are applications that directly affect the life and health of a person, as well as for systems that cannot be stopped (for example, a nuclear reactor). Here everything is clearly regulated at all stages of development and the potential for failure and the effect on the operation of the system as a whole are taken into account. Development is carried out on specialized hardware and software solutions, which in the future also need to be certified. As a result, it turns out long and expensive. Therefore, those who begin development do not think about it if there are no binding standards.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We recommend a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">series of articles</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on functional safety </font><font style="vertical-align: inherit;">for review </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition to the development issue, it is important to pay attention to the operating conditions of the systems. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a rule, large companies, manufacturers of cloud services care about the security of their services for a number of reasons:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">They are engaged in the development and support of the functioning of the service directly </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">They have much closer contact between developers and support engineers.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The equipment is directly accessible to engineers, even if in the clouds </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wide data transmission channels and high computational ability of the equipment allows the use of monitoring systems and detection of abnormal activity</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Devices of the Internet of things work in exactly the opposite way:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As a rule, they are the property of the end customer, and the end customer engineers, competencies, which in most cases are inferior for objective reasons, are engaged in the configuration and support.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The resources of each device are limited, both in terms of performance and data transfer. </font><font style="vertical-align: inherit;">As a result, a system for monitoring and detecting abnormal activity is practically impossible in this case.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For clarity, I will give a comparative table. </font><font style="vertical-align: inherit;">Immediately make a reservation that:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There are many software delivery and support options. </font><font style="vertical-align: inherit;">Only general groups are given for illustrative purposes.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The number of devices of the Internet of things is difficult to estimate accurately, since everyone understands something different under it, and there are also no good statistics on them.</font></font></li>
</ul><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servers and cloud solutions (SaaS and the like)</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">User devices (PCs, smartphones, etc.)</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Internet of things </font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Who is developing?</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solution provider</font></font></td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>  / ?</td>
<td> </td>
<td>      </td>
<td>    </td>
</tr>
<tr>
<td>  /?</td>
<td> </td>
<td>      </td>
<td>      </td>
</tr>
<tr>
<td> </td>
<td></td>
<td> ‚Äî </td>
<td></td>
</tr>
<tr>
<td> </td>
<td></td>
<td></td>
<td>,      </td>
</tr>
<tr>
<td></td>
<td>   ()</td>
<td>  </td>
<td>  (   )</td>
</tr>
<tr>
<td>   </td>
<td>     (Amazon, Google)  </td>
<td> 2019  :  ~<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">266 K</a>,  ~<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">1.37 </a></td>
<td>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">9 </a>  </td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a result, situations periodically happen that the devices were hacked, and nothing is known about this for objective reasons. </font><font style="vertical-align: inherit;">Unfortunately, this situation is not uncommon and can last for months, and sometimes for years. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The most famous hacks of embedded systems in recent years:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mirai botnet in 2016, working mainly on camcorders. </font><font style="vertical-align: inherit;">According to various estimates, the number of infected devices exceeded </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">380 thousand</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">His successor </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Satori</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in 2018 has already captured 700 thousand devices, focusing primarily on cryptocurrency miners.</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KRACK</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hit WPA2 Wi-Fi in 2017 (almost all Wi-Fi devices in the last 15 years) and its heir </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kr00k</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , with more than a billion devices in 2019.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In 2018, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bleedingbit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hit Texas Instruments BLE chips. </font><font style="vertical-align: inherit;">Officially, only a few access point models that used the CC26xx family were affected, and the problem itself was solved in the new version of the stack. </font><font style="vertical-align: inherit;">However, in this case, it is not taken into account that these chips are used in a much larger number of devices (the second-largest producer of BLE in the world, 16% of </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.9 billion</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for 2018).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Most hardware manufacturers release patches for their devices. </font><font style="vertical-align: inherit;">However, these corrections must still be applied on the devices themselves, which is difficult or in some cases impossible for devices of the Internet of things. </font><font style="vertical-align: inherit;">As a result, a significant part of the devices remains potentially vulnerable. </font><font style="vertical-align: inherit;">And they may never learn about this because of the lack of control and due attention to this issue.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Accordingly, it is necessary to use fundamentally different approaches to prevent vulnerabilities and eliminate the consequences for Internet of things devices. Security must lie in the platform itself from the very stage of its design and be carried out at all stages of development and operation of the end device, but at the same time be simple and inexpensive for mass implementation (at least with respect to functional security and TEE of powerful processors). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ARM in 2017 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">talked</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> about the security of embedded systems based on CryptoCell and Cortex-M33, however, serial samples of chips on the M33 appeared only last year. The presented technology is called Platform Security Architecture (PSA).</font></font><br>
<img src="https://habrastorage.org/webt/bd/hi/ka/bdhika6f1yyoha8a_uxu4txuu9w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The essence of the idea was to separate critical parts of the system (keys, rights, firmware) from potentially hackable components, both hardware and software, for systems where the full implementation of TEE is impossible or difficult. </font><font style="vertical-align: inherit;">The technology is primarily focused on Cortex-M, but is compatible with all Cortex-A / -R / -M families. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dv/bk/xq/dvbkxqeagkyugr3sbfi9ysuc-eu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Basically consider 4 stages of protection of devices of the Internet of things. </font><font style="vertical-align: inherit;">Consider them in sequence as they arise during the operation of the device. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kl/vp/-a/klvp-aw9grnb1jgdixtbzbb5zuu.png" height="32" width="32"> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Secure Boot</font></font></strong><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is verified that the firmware is genuine, has not been changed, and cannot be downgraded.</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/r0/ch/ni/r0chninoiqr9ey3telnjcv6muxg.png" height="32" width="32"> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Secure firmware update over the air (Secure FOTA)</font></font></strong><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Only authenticated and verified updates can be downloaded.</font></font></li>
<li>      (     )</li>
</ul><br>
<img src="https://habrastorage.org/webt/po/bb/td/pobbtd7ddtyft5azkk9fe7vkz-e.png" height="32" width="32"> <strong>    API</strong><br>
<ul>
<li>        ,      .</li>
<li> ¬´¬ª      API.</li>
<li>        ‚Äî    </li>
</ul><br>
<img src="https://habrastorage.org/webt/gk/fj/wg/gkfjwg_fbo7sr2gjk6l6eul3iu4.png" height="32" width="92"><strong>  </strong><br>
<ul>
<li>         </li>
<li>   (MITM)      </li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To protect the device, it is proposed to identify / verify data arriving at each stage. </font><font style="vertical-align: inherit;">The concept is based on the idea of ‚Äã‚Äãthe root of trust (Root-of-Trust, RoT). </font><font style="vertical-align: inherit;">The bottom line is that a certain identifier (key) is sewn into the device and a hardware procedure is going on to verify that the key is unique to the current platform and the executable code. </font><font style="vertical-align: inherit;">In the future, all important libraries use RoT for their own work. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/0a/ks/rj/0aksrjmxitkkj2gnd8k7_z3gitk.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Typically, this occurs in 3 main stages:</font></font><br>
<br>
<ol>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Providing trust: inclusion of the Root-of-Trust at the production stage in the chip structure. The</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
immutable chip identifier and the hardware root of trust provide basic security and unique identification of the device.</font></font></li>
<li><b> :   </b><br>
        ,       </li>
<li><b> :      </b><br>
 ,             2 . </li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The most common solution on the market is ARM's TrustZone. Quite a lot has been written about its implementation on Habr√©, since the technology itself was introduced for a long time. The most clearly in my opinion was summarized in one of the latest </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">publications</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the context of this article, it is worth noting that earlier TrustZone was the privilege of high-performance processors of the Cortex-A family. And over the past year, almost all manufacturers of crystal-based wireless systems have released </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cortex-M-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> based solutions </font><font style="vertical-align: inherit;">; the most popular is </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cortex-M33</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Speaking about information security, it is worth recalling the system of </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">general criteria</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Common Criteria), adopted both internationally and as a national standard. It allows you to determine the level of trust Evaluation Assurance Level (EAL) from 1 to 7 (EAL1 - EAL7), a higher figure indicates a higher level of security. To understand, the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">majority of</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">operating systems have an</font></a><font style="vertical-align: inherit;"> EAL4 or EAL4 + level </font><font style="vertical-align: inherit;">, LInux / Unix, EAL5 basically have </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">smart cards</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (banking, transport, including contactless), EAL6 allows you to use the solution in high-risk situations, EAL7 in extreme risk situations, for example, for </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unidirectional networks</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (data diodes). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In April of this year, the Cortex-M33 and M35P </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">were certified</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EAL6 +</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. This is a very high level that allows you to apply solutions in high-risk situations. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ARM TrustZone </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cryptocell</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the new Cortex-M33 / M23 provides secure key storage (including one with a unique hardware identifier), firmware checking, both during the download and update over the air, hardware encryption acceleration AES, SHA, ChaCha, ECC, in including with DMA (as a result, all data in Flash and RAM can be encrypted), random number generators (TRNG, PRNG).</font></font><br>
<img src="https://habrastorage.org/webt/zd/cc/yl/zdccyl5hdgn8dwwahqc-yizyd84.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It‚Äôs interesting to note that CryptoCell allows you to have several roots of trust for various tasks (for example, embed an additional RoT for a customer who wants to integrate a mass solution from the market into his closed IT system, for example, a bank without being tied to the main RoT from the manufacturer), as well as secure debugging (Secure Debug) with authorization rights.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The 300 series of CryptoCell is targeted specifically at low-power Internet of Things devices. The consumption of the new M33 is approximately 20-40% lower than that of the M4, given the loss in energy consumption for TrustZone's work of 20%, we have the same or lower consumption level than now. As a result, we can say that hardware security has come to the most massive budget segment with the Cortex-M33 / M23 and in the near future the number of products based on them will only increase. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TrustZone alternatives include </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenTitan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sponsored by Google. However, it is not yet widespread and focused on other applications than end devices of the Internet of things.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is worth noting that the hardware implementation of the root of trust is not a panacea and can also be hacked. An example is the recent story with </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . It is important to mention that in this case an error was found in ROM and one key was used for all generations of chipsets, therefore it can be reproduced. And even such an implementation greatly complicates the hack. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consider the 5 stages of the evolution of the implementation of Root-of-Trust in the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uBlox</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cellular communication </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">modules</font></a><font style="vertical-align: inherit;"> , developed in collaboration with the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kudelski Group</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. This is interesting from the point of view of the task, since their solutions differ significantly from the approaches of other companies. Cat-M Nb-IoT / LTE cellular modules belong to the transition classes between the 4th and 5th generations of LTE and are aimed at low-power LPWAN networks. In most cases, devices should work for years without human intervention. Modern solutions allow you to work 7-10 years on one battery (battery). The average life of the device often reaches 15 years. During this time, security requirements may change significantly, new threats will appear. Devices should work stably without human intervention for the entire service life. Accordingly, it is necessary to protect such devices taking into account the duration and nature of their work.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/5f/71/wd/5f71wd62tzpvyvj5jclyil1e_ue.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you can see on the structure, with each next generation, the root of trust changes its position. This is a key point affecting the security of the solution as a whole. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Options 1 and 3 are considered unreliable according to uBlox / Kudelski due to the software implementation of RoT and the most likely hack. Including for the case of making the root of trust in the external eSIM (eUICC), which provides sufficient protection for banking applications of entry-level </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EAL4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (keys in eUICC cannot be read or changed so that it does not become visible from the outside). However, this approach brings with it flaws and potential vulnerabilities arising from the fact that communication with an external component can be intercepted and potentially distort, the complexity of interaction at the initial stages of system initialization (bootloader verification), as well as</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">complicated programming mechanism</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> due to limited chip resources in UICC. In addition, the external module can be replaced or removed from the system (simply by changing the SIM card) and thereby leaving the entire system without a root of trust. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Therefore, the further development path is to integrate the root of trust in the protected area of ‚Äã‚Äãthe chip. This approach is consistent with ARM TrustZone CryptoCell Composition. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The version with the implementation of Root-of-Trust in a secure OS is the most common on the market and provides a level of security sufficient for most tasks. The most common solution on the market is ARM TrustZone (about it above), but without CryptoCell, which stores keys in a protected area.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The solution with protection integrated inside the chipset, to which there is practically no access from the outside, has the greatest protection. The current solution uses the built-in security element (Secure Element), certified according to the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EAL5 +</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> level </font><font style="vertical-align: inherit;">. This allows Common Criteria certification for the entire device as a whole, and also allows you to place SIM card functions and Mobile Network Operator (MNO) profiles within the device. This corresponds to the current level of security. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The next generation of the uBlox chipset is under development, where Secure Element will be integrated into the silicon of the modem chipset itself. This further reduces the attack surface and improves security to the highest level. It will be implemented through </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iUICC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Integrated Universal Integrated Circuit Card) - the next generation of UICC, in which the entire code and SIM identifier will be located inside the system on a chip, the standard has not yet been completed. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Findings:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">More and more manufacturers of electronic components develop and produce devices with security in mind, starting from the earliest stages of development. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Endpoint companies get security management tools right out of the box. </font><font style="vertical-align: inherit;">Attracting experts at the stage of developing tools allows you to avoid mistakes, as well as significantly reduce the cost of the solution as a whole.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The price tag for new solutions is often close to current solutions, but gives a fundamentally different level of protection, which also greatly simplifies the transition</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The growing number of devices providing a new level of security is only a matter of time.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In new secure element solutions, UICC is transferred inside the chip chip to increase security and hinder attacks</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modern solutions provide security levels up to EAL6 + sufficient for use in high-risk situations. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solutions of the EAL7 level are under development, however, they use technologies without a finally approved standard, therefore the term for their market availability is not defined.</font></font></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en499648/index.html">‚ÄúA game designer is always a gamer‚Äù: what does a specialist do, what skills are important</a></li>
<li><a href="../en499652/index.html">Is there life in development after the decree</a></li>
<li><a href="../en499654/index.html">How to implement CRM on a remote site and win?</a></li>
<li><a href="../en499656/index.html">PID temperature controller simulation</a></li>
<li><a href="../en499658/index.html">A man-laborer instead of a tester? Is it worth it to study Selenium in 2020?</a></li>
<li><a href="../en499664/index.html">Porting APIs to TypeScript as a Problem Solver</a></li>
<li><a href="../en499666/index.html">PEP 572 (Assignment Expressions in python 3.8)</a></li>
<li><a href="../en499668/index.html">Road to Hell JavaScript Dependencies</a></li>
<li><a href="../en499670/index.html">–Ø –ø–µ—Ä–µ—Ö–æ–∂—É –Ω–∞ JavaScript</a></li>
<li><a href="../en499674/index.html">Another step to optical computers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>