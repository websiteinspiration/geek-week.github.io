<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßîüèª ‚úñÔ∏è üåô Kode baris tunggal atau validasi Nethermind menggunakan PVS-Studio C # untuk Linux üë©üèæ‚Äçüî¨ ü§∞üèæ üìØ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Artikel ini didedikasikan untuk peluncuran uji beta PVS-Studio C # untuk Linux, serta plug-in untuk Rider. Untuk alasan yang luar biasa, menggunakan a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Kode baris tunggal atau validasi Nethermind menggunakan PVS-Studio C # untuk Linux</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/504320/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b64/5fc/72d/b645fc72ddcded21612bdc5e9fac2c78.png" alt="Gambar 1"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Artikel ini didedikasikan untuk peluncuran uji beta PVS-Studio C # untuk Linux, serta plug-in untuk Rider. </font><font style="vertical-align: inherit;">Untuk alasan yang luar biasa, menggunakan alat ini, kami memeriksa kode sumber produk Nethermind dan dalam artikel ini kita akan melihat kesalahan yang menarik dan terkadang lucu.</font></font><br>
<a name="habracut"></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nethermind</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah klien cepat untuk .NET Core Ethereum untuk Linux, Windows, MacOs. </font><font style="vertical-align: inherit;">Itu dapat digunakan dalam proyek ketika mengatur jaringan pribadi Ethereum atau dApps. </font><font style="vertical-align: inherit;">Nethermind adalah </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">open source yang</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> terletak di GitHub. </font><font style="vertical-align: inherit;">Proyek ini didirikan pada 2017 dan terus berkembang.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pengantar</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apakah Anda suka kerja manual? Misalnya, seperti menemukan kesalahan dalam kode program. Setuju, agak membosankan untuk membaca dan menganalisis situs yang Anda tulis atau seluruh proyek untuk mencari bug yang rumit. Nah, jika proyeknya kecil, katakanlah 5.000 baris, tetapi jika ukurannya sudah melebihi seratus ribu atau sejuta baris? Selain itu, ditulis oleh programmer yang berbeda dan kadang-kadang tidak dalam bentuk yang sangat mudah dicerna. Apa yang harus dilakukan dalam kasus ini? Apakah Anda benar-benar harus tidur di suatu tempat, di suatu tempat meremehkan dan 100% waktu Anda untuk menyadari semua kalimat tanpa akhir ini untuk memahami di mana kesalahan jahat ini? Saya ragu Anda ingin melakukan ini. Jadi apa yang harus dilakukan, mungkin ada cara modern untuk mengotomatisasi ini?</font></font><br>
<br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/34f/9eb/338/34f9eb3387d61eb4ebfa67f0dbccbef7.png" alt="Gambar 3"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan kemudian alat seperti penganalisa kode statis mulai bekerja. </font><font style="vertical-align: inherit;">Alat analisis statis adalah alat untuk mendeteksi cacat pada kode sumber program. </font><font style="vertical-align: inherit;">Keuntungan alat ini dibandingkan verifikasi manual adalah sebagai berikut:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hampir tidak menghabiskan waktu Anda mencari lokasi kesalahan (setidaknya itu pasti lebih cepat daripada mencari copy-paste yang gagal dengan mata Anda);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak lelah, tidak seperti orang yang setelah beberapa waktu mencari perlu istirahat;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mengetahui banyak pola kesalahan yang bahkan mungkin tidak disadari oleh seseorang; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menggunakan teknologi seperti: analisis aliran data, eksekusi simbolis, pencocokan pola, dan lainnya;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memungkinkan Anda untuk secara teratur dan kapan saja menganalisis;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dll.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentu saja, menggunakan penganalisa kode statis tidak menggantikan atau membatalkan ulasan kode. </font><font style="vertical-align: inherit;">Tetapi tinjauan kode menjadi lebih produktif dan bermanfaat. </font><font style="vertical-align: inherit;">Anda bisa fokus menemukan kesalahan tingkat tinggi, mentransfer pengetahuan, daripada melelahkan membaca kode untuk mencari kesalahan ketik. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda tertarik untuk membaca lebih banyak tentang hal itu, maka saya menyarankan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artikel berikut</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , serta artikel tentang </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">teknologi yang</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> digunakan dalam PVS-Studio.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio C # untuk Linux / macOS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saat ini, kami memindahkan penganalisis C # kami ke .NET Core, dan kami juga aktif mengembangkan plug-in untuk IDE Rider. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda tertarik, Anda dapat mendaftar untuk tes beta dengan mengisi formulir </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">di halaman ini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Instruksi pemasangan akan dikirimkan ke email Anda (jangan khawatir, itu sangat sederhana), serta lisensi untuk menggunakan penganalisa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti inilah tampilan Rider dengan plugin PVS-Studio:</font></font><br>
<br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/rp/p6/f_/rpp6f_9oohudg2ov2jt-hdu0yg0.png" alt="Gambar 4"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sedikit marah</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya ingin mengatakan bahwa di beberapa tempat sangat sulit untuk membaca kode sumber Nethermind, karena di dalamnya panjang 300-500 karakter cukup normal. </font><font style="vertical-align: inherit;">Ya, itu semua kode tanpa memformat dalam 1 baris. </font><font style="vertical-align: inherit;">Dan garis-garis ini, misalnya, mengandung beberapa operator ternary, dan operator logis, dan tidak ada apa pun di sana. </font><font style="vertical-align: inherit;">Secara umum, kenikmatan seperti dari musim terakhir dari permainan takhta. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya akan menjelaskan sedikit untuk memahami ruang lingkup. </font><font style="vertical-align: inherit;">Saya memiliki monitor UltraWide dengan panjang sekitar 82 sentimeter. </font><font style="vertical-align: inherit;">Jika Anda membuka IDE di dalamnya dalam layar penuh, maka itu akan muat sekitar 340 karakter. </font><font style="vertical-align: inherit;">Artinya, kalimat yang saya bicarakan tidak cocok. </font><font style="vertical-align: inherit;">Jika Anda ingin melihat tampilannya, saya meninggalkan tautan ke file di GitHub: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh 1</font></font></b><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">LogBlockAuthorNicely</span>(<span class="hljs-params">Block block, ISyncPeer syncPeer</span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">string</span> authorString = (block.Author == <span class="hljs-literal">null</span> ? <span class="hljs-literal">null</span> : <span class="hljs-string">"sealed by "</span> +<font></font>
(KnownAddresses.GoerliValidators.ContainsKey(block.Author) ?<font></font>
KnownAddresses.GoerliValidators[block.Author] : block.Author?.ToString())) ??<font></font>
(block.Beneficiary == <span class="hljs-literal">null</span> ? <span class="hljs-keyword">string</span>.Empty : <span class="hljs-string">"mined by "</span> +<font></font>
(KnownAddresses.KnownMiners.ContainsKey(block.Beneficiary) ?<font></font>
KnownAddresses.KnownMiners[block.Beneficiary] : block.Beneficiary?.ToString()));<font></font>
    <span class="hljs-keyword">if</span> (_logger.IsInfo)<font></font>
    {<font></font>
        <span class="hljs-keyword">if</span> (_logger.IsInfo) _logger.Info(<span class="hljs-string">$"Discovered a new block
<span class="hljs-subst">{<span class="hljs-keyword">string</span>.Empty.PadLeft(<span class="hljs-number">9</span> - block.Number.ToString().Length, <span class="hljs-string">'
'</span>)}</span><span class="hljs-subst">{block.ToString(Block.Format.HashNumberAndTx)}</span> <span class="hljs-subst">{authorString}</span>, sent by
<span class="hljs-subst">{syncPeer:s}</span>"</span>);<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Üí </font><b><font style="vertical-align: inherit;">Contoh </font></b></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tautan File </font></font></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">BuildTransitions</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    ...<font></font>
    releaseSpec.IsEip1283Enabled = (_chainSpec.Parameters.Eip1283Transition ??<font></font>
<span class="hljs-keyword">long</span>.MaxValue) &lt;= releaseStartBlock &amp;&amp;<font></font>
((_chainSpec.Parameters.Eip1283DisableTransition ?? <span class="hljs-keyword">long</span>.MaxValue) <font></font>
&gt; releaseStartBlock || (_chainSpec.Parameters.Eip1283ReenableTransition ??<font></font>
<span class="hljs-keyword">long</span>.MaxValue) &lt;= releaseStartBlock);           <font></font>
    ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Üí </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tautan ke file</font></font></a><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> 
<span class="hljs-title">Will_not_reject_block_with_bad_total_diff_but_will_reset_diff_to_null</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    ...<font></font>
    _syncServer = <span class="hljs-keyword">new</span> SyncServer(<span class="hljs-keyword">new</span> StateDb(), <span class="hljs-keyword">new</span> StateDb(), localBlockTree,<font></font>
NullReceiptStorage.Instance, <span class="hljs-keyword">new</span> BlockValidator(Always.Valid, <span class="hljs-keyword">new</span><font></font>
HeaderValidator(localBlockTree, Always.Valid, MainnetSpecProvider.Instance,<font></font>
LimboLogs.Instance), Always.Valid, MainnetSpecProvider.Instance, <font></font>
LimboLogs.Instance), Always.Valid, _peerPool, StaticSelector.Full, <font></font>
<span class="hljs-keyword">new</span> SyncConfig(), LimboLogs.Instance);<font></font>
    ...     <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Üí </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tautan ke file</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sekarang bayangkan ada kesalahan pada bagian seperti itu, apakah akan menyenangkan untuk mencarinya? </font><font style="vertical-align: inherit;">Saya yakin tidak, dan semua orang mengerti bahwa tidak mungkin menulis seperti itu. </font><font style="vertical-align: inherit;">Dan omong-omong, ada tempat serupa dengan kesalahan dalam proyek ini.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hasil Validasi</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kondisi yang tidak disukai 0</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kondisi 1</font></font></b><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> ReceiptsMessage <span class="hljs-title">Deserialize</span>(<span class="hljs-params"><span class="hljs-keyword">byte</span>[] bytes</span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">if</span> (bytes.Length == <span class="hljs-number">0</span> &amp;&amp; bytes[<span class="hljs-number">0</span>] == Rlp.OfEmptySequence[<span class="hljs-number">0</span>])
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ReceiptsMessage(<span class="hljs-literal">null</span>);<font></font>
    ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVS-Studio Warning: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3106</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kemungkinan indeks di luar batas. </font><font style="vertical-align: inherit;">Indeks '0' menunjuk di luar batas 'byte'. </font><font style="vertical-align: inherit;">Nethermind.Network ReceiptsMessageSerializer.cs 50 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk melihat kesalahan, pertimbangkan kasus ketika jumlah elemen dalam array adalah 0. Kemudian kondisi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">byte. Panjang == 0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kondisi </font><font style="vertical-align: inherit;">akan benar dan </font><i><font style="vertical-align: inherit;">indeksOutOfRangeException dari tipe 0</font></i><font style="vertical-align: inherit;"> akan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dilemparkan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ketika mengakses elemen array </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mereka ingin segera keluar dari metode ini jika array kosong atau elemen 0 sama dengan nilai tertentu, tetapi tampaknya mereka secara tidak sengaja mencampurkan "||" </font><font style="vertical-align: inherit;">dengan "&amp;&amp;". </font><font style="vertical-align: inherit;">Saya mengusulkan untuk memperbaiki masalah ini sebagai berikut:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> ReceiptsMessage <span class="hljs-title">Deserialize</span>(<span class="hljs-params"><span class="hljs-keyword">byte</span>[] bytes</span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">if</span> (bytes.Length == <span class="hljs-number">0</span> || bytes[<span class="hljs-number">0</span>] == Rlp.OfEmptySequence[<span class="hljs-number">0</span>])
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ReceiptsMessage(<span class="hljs-literal">null</span>);<font></font>
    ...<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kondisi 2</font></font></b><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DiscoverAll</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    ...<font></font>
    Type? GetStepType(Type[] typesInGroup)<font></font>
    {<font></font>
        Type? GetStepTypeRecursive(Type? contextType)<font></font>
        {<font></font>
            ...<font></font>
        }<font></font>
        ...<font></font>
        <span class="hljs-keyword">return</span> typesInGroup.Length == <span class="hljs-number">0</span> ? typesInGroup[<span class="hljs-number">0</span>] :<font></font>
               GetStepTypeRecursive(_context.GetType());<font></font>
    }<font></font>
    ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVS-Studio Warning: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3106</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kemungkinan indeks di luar batas. </font><font style="vertical-align: inherit;">Indeks '0' menunjuk di luar batas 'typesInGroup'. </font><font style="vertical-align: inherit;">Nethermind.Runner EthereumStepsManager.cs 70 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Situasi yang mirip dengan yang dijelaskan di atas terjadi. </font><font style="vertical-align: inherit;">Jika jumlah elemen dalam </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">typesInGroup</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sama dengan 0, maka saat mengakses elemen 0, pengecualian tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IndexOutOfRangeException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan </font><i><font style="vertical-align: inherit;">dilempar</font></i><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hanya dalam hal ini saya tidak mengerti apa yang diinginkan pengembang. </font><font style="vertical-align: inherit;">Kemungkinan besar, alih-alih </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">typesInGroup [0]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Anda harus menulis </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesalahan atau optimasi yang belum selesai?</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DeleteBlocks</span>(<span class="hljs-params">Keccak deletePointer</span>)</span><font></font>
{<font></font>
   ...<font></font>
   <span class="hljs-keyword">if</span> (currentLevel.BlockInfos.Length == <span class="hljs-number">1</span>)<font></font>
   {<font></font>
      shouldRemoveLevel = <span class="hljs-literal">true</span>;<font></font>
   }<font></font>
   <span class="hljs-keyword">else</span><font></font>
   {<font></font>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; currentLevel.BlockInfos.Length; i++)<font></font>
      {<font></font>
         <span class="hljs-keyword">if</span> (currentLevel.BlockInfos[<span class="hljs-number">0</span>].BlockHash == currentHash) <span class="hljs-comment">// &lt;=</span><font></font>
         {<font></font>
            currentLevel.BlockInfos = currentLevel.BlockInfos<font></font>
                                      .Where(bi =&gt; bi.BlockHash != currentHash)<font></font>
                                      .ToArray();<font></font>
            <span class="hljs-keyword">break</span>;<font></font>
         }<font></font>
      }<font></font>
   }<font></font>
   ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peringatan PVS-Studio: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3102</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Akses mencurigakan ke elemen objek 'currentLevel.BlockInfos' dengan indeks konstan di dalam satu loop. Nethermind.Blockchain BlockTree.cs 895 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada pandangan pertama, kesalahannya jelas - loop ini bertujuan untuk </font><font style="vertical-align: inherit;">mengulangi </font><font style="vertical-align: inherit;">elemen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">currentLevel.BlockInfos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tetapi ketika mengakses </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">currentLevel.BlockInfos [i], mereka</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menulis </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">currentLevel.BlockInfos [0]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Kami memperbaiki 0 pada </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan misi selesai. Tapi jangan buru-buru, mari kita cari tahu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang, kita </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Panjang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mengakses </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BlockHash dari</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> elemen nol. Jika sama dengan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">currentHash</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , maka kita ambil dari </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">currentLevel.BlockInfos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> semua elemen yang tidak sama</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">currentHash</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tulis untuk itu dan keluar dari loop. </font><font style="vertical-align: inherit;">Ternyata siklus itu berlebihan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya pikir sebelumnya ada algoritma yang mereka putuskan untuk ubah / optimalkan menggunakan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LINQ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tetapi ada yang tidak beres. </font><font style="vertical-align: inherit;">Sekarang, jika kondisinya salah, kita mendapatkan iterasi yang tidak berarti. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ngomong-ngomong, jika pengembang yang menulis ini akan menggunakan mode </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">analisis tambahan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , maka ia segera menyadari bahwa ada sesuatu yang salah dan akan memperbaiki semuanya dengan cepat. </font><font style="vertical-align: inherit;">Saat ini, saya akan menulis ulang kode seperti ini:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DeleteBlocks</span>(<span class="hljs-params">Keccak deletePointer</span>)</span><font></font>
{<font></font>
    ...<font></font>
    <span class="hljs-keyword">if</span> (currentLevel.BlockInfos.Length == <span class="hljs-number">1</span>)<font></font>
    {<font></font>
        shouldRemoveLevel = <span class="hljs-literal">true</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
        currentLevel.BlockInfos = currentLevel.BlockInfos<font></font>
                                  .Where(bi =&gt; bi.BlockHash != currentHash)<font></font>
                                  .ToArray();<font></font>
    }<font></font>
    ...<font></font>
}</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Referensi nol referensi negatif</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dereferencing 1</font></font></b><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Sign</span>(<span class="hljs-params">Transaction tx, <span class="hljs-keyword">int</span> chainId</span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">if</span> (_logger.IsDebug)<font></font>
        _logger?.Debug(<span class="hljs-string">$"Signing transaction: <span class="hljs-subst">{tx.Value}</span> to <span class="hljs-subst">{tx.To}</span>"</span>);<font></font>
    IBasicWallet.Sign(<span class="hljs-keyword">this</span>, tx, chainId);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peringatan PVS-Studio: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095 Objek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> '_logger' digunakan sebelum diverifikasi dengan null. Periksa baris: 118, 118. Nethermind.Wallet DevKeyStoreWallet.cs 118 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kesalahan dalam urutan yang salah. Pertama ada banding ke </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_logger.IsDebug</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan hanya setelah itu </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_logger diperiksa</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Karenanya, dalam kasus ketika </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_logger</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , kami mendapatkan pengecualian dari tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dereferencing 2</font></font></b><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">BuildNodeInfo</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    _nodeInfo = <span class="hljs-keyword">new</span> NodeInfo();<font></font>
    _nodeInfo.Name = ClientVersion.Description;<font></font>
    _nodeInfo.Enode = _enode.Info;                           <span class="hljs-comment">// &lt;=</span>
    <span class="hljs-keyword">byte</span>[] publicKeyBytes = _enode?.PublicKey?.Bytes;        <span class="hljs-comment">// &lt;=</span>
    _nodeInfo.Id = (publicKeyBytes == <span class="hljs-literal">null</span> ? Keccak.Zero :<font></font>
                   Keccak.Compute(publicKeyBytes)).ToString(<span class="hljs-literal">false</span>);<font></font>
    _nodeInfo.Ip = _enode?.HostIp?.ToString();<font></font>
    _nodeInfo.ListenAddress = <span class="hljs-string">$"<span class="hljs-subst">{_enode.HostIp}</span>:<span class="hljs-subst">{_enode.Port}</span>"</span>;<font></font>
    _nodeInfo.Ports.Discovery = _networkConfig.DiscoveryPort;<font></font>
    _nodeInfo.Ports.Listener = _networkConfig.P2PPort;<font></font>
    UpdateEthProtocolInfo();<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peringatan PVS-Studio: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095 Objek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> '_enode' digunakan sebelum diverifikasi dengan null. </font><font style="vertical-align: inherit;">Periksa baris: 55, 56. Nethermind.JsonRpc AdminModule.cs 55 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kesalahannya benar-benar mirip dengan yang dijelaskan di atas, hanya kali ini pelakunya adalah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_enode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya ingin menambahkan bahwa jika Anda lupa untuk memeriksa nol, maka ingat ini hanya ketika program Anda mogok. </font><font style="vertical-align: inherit;">Penganalisa akan mengingatkan Anda tentang ini dan semuanya akan baik-baik saja.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Salin-Tempel favorit kami</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kasus 1</font></font></b><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">Equals</span>(<span class="hljs-params"><span class="hljs-keyword">ref</span> UInt256 a, <span class="hljs-keyword">ref</span> UInt256 b</span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">return</span> a.s0 == b.s0 &amp;&amp; a.s1 == b.s1 &amp;&amp; a.s2 == b.s2 &amp;&amp; a.s2 == b.s2;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peringatan PVS-Studio: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3001</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ada sub-ekspresi identik 'a.s2 == b.s2' di sebelah kiri dan di sebelah kanan operator '&amp;&amp;'. </font><font style="vertical-align: inherit;">Nethermind.Dirichlet.Numerics UInt256.cs 1154 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini kondisi yang sama diperiksa 2 kali:</font></font><br>
<br>
<pre><code class="cs hljs">a.s2 == b.s2</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> memiliki bidang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s3</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , saya berasumsi bahwa ketika menyalin kita hanya lupa mengubah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s2</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ke </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s3</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ternyata parameter akan sama lebih sering dari yang diharapkan oleh pembuat kode. Pada saat yang sama, beberapa pengembang berpikir bahwa mereka tidak melakukan ini dan mulai mencari kesalahan di tempat yang sama sekali berbeda, menghabiskan banyak energi dan saraf. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Omong-omong, kesalahan dalam fungsi perbandingan umumnya klasik. Tampaknya, programmer, mengingat fungsi-fungsi seperti itu sederhana, berhubungan dengan tulisan mereka dengan sangat santai dan tanpa perhatian. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bukti</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Mengetahui hal ini, sekarang berhati-hatilah :)! </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kasus 2</font></font></b><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task&lt;ApiResponse&gt; 
<span class="hljs-title">PublishBlockAsync</span>(<span class="hljs-params">SignedBeaconBlock signedBlock,
                  CancellationToken cancellationToken</span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">bool</span> acceptedLocally = <span class="hljs-literal">false</span>;<font></font>
    ...<font></font>
    <span class="hljs-keyword">if</span> (acceptedLocally)<font></font>
    {<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ApiResponse(StatusCode.Success);<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ApiResponse(StatusCode.Success);<font></font>
    }<font></font>
    ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVS-Studio Warning: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3004</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pernyataan 'then' setara dengan pernyataan 'else'. Nethermind.BeaconNode BeaconNodeFacade.cs 177 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk nilai variabel apa pun yang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diterima</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> secara lokal, </font><font style="vertical-align: inherit;">metode ini mengembalikan yang sama. Sulit untuk mengatakan apakah itu kesalahan atau tidak. Misalkan seorang programmer menyalin sebuah baris dan lupa untuk mengubah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StatusCode. Berhasil</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan yang lain, maka ini adalah kesalahan nyata. Selain itu, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StatusCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> memiliki </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InternalError</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InvalidRequest</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Tetapi refactoring kode mungkin disalahkan dan kami tidak peduli tentang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diterima secara lokal</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dalam hal ini, kondisi menjadi tempat yang membuat Anda duduk dan berpikir apakah itu kesalahan atau tidak. </font><font style="vertical-align: inherit;">Jadi bagaimanapun, kasus ini sangat tidak menyenangkan. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kasus 3</font></font></b><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">TearDown</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    ...<font></font>
    <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> testResult <span class="hljs-keyword">in</span> _results)<font></font>
    {<font></font>
         <span class="hljs-keyword">string</span> message = <span class="hljs-string">$"<span class="hljs-subst">{testResult.Order}</span>. <span class="hljs-subst">{testResult.Name}</span> has "</span> 
               + <span class="hljs-string">$"<span class="hljs-subst">{(testResult.Passed ? <span class="hljs-string">"passed [+]"</span> : <span class="hljs-string">"failed [-]"</span>)}</span>"</span>;
         <span class="hljs-keyword">if</span> (testResult.Passed)<font></font>
         {<font></font>
               TestContext.WriteLine(message);<font></font>
         }<font></font>
         <span class="hljs-keyword">else</span><font></font>
         {<font></font>
               TestContext.WriteLine(message);<font></font>
         }<font></font>
     }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVS-Studio Warning: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3004</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pernyataan 'then' setara dengan pernyataan 'else'. </font><font style="vertical-align: inherit;">Nethermind.Overseer.Test TestBuilder.cs 46 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan lagi, kami tidak peduli untuk verifikasi, karena pada akhirnya kami mendapatkan hal yang sama. </font><font style="vertical-align: inherit;">Dan lagi-lagi kita duduk dan menderita, berpikir, tetapi apa yang ingin ditulis pengembang di sini. </font><font style="vertical-align: inherit;">Buang-buang waktu yang bisa dihindari dengan menggunakan analisis statis dan segera memperbaiki kode ambigu tersebut. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kasus 4</font></font></b><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Setup</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">if</span> (_decoderBuffer.ReadableBytes &gt; <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Exception(<span class="hljs-string">"decoder buffer"</span>);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_decoderBuffer.ReadableBytes &gt; <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Exception(<span class="hljs-string">"decoder buffer"</span>);<font></font>
    }<font></font>
    ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peringatan PVS-Studio: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3021</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ada dua pernyataan 'jika' dengan ekspresi kondisional yang identik. Pernyataan 'jika' pertama berisi pengembalian metode. Ini berarti bahwa pernyataan 'jika' yang kedua tidak masuk akal Nethermind.Network.Benchmark InFlowBenchmarks.cs 55 Tekan </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
saja </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ctrl + V</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lagi </font><font style="vertical-align: inherit;">. Kami menghapus kelebihan pemeriksaan dan semuanya baik-baik saja. Saya yakin bahwa jika beberapa kondisi lain penting di sini, maka semua orang akan menulis dalam satu </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jika</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> melalui operator logis I. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kasus 5</font></font></b><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">LogBlockAuthorNicely</span>(<span class="hljs-params">Block block, ISyncPeer syncPeer</span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">if</span> (_logger.IsInfo)<font></font>
    {<font></font>
        <span class="hljs-keyword">if</span> (_logger.IsInfo)<font></font>
        {<font></font>
            ...<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peringatan PVS-Studio: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3030</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pemeriksaan berulang. </font><font style="vertical-align: inherit;">Kondisi '_logger.IsInfo' sudah diverifikasi di baris 242. Nethermind.Synchronization SyncServer.cs 244 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan cara yang sama seperti dalam kasus keempat, pemeriksaan tambahan dilakukan. </font><font style="vertical-align: inherit;">Namun, perbedaannya adalah bahwa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_logger</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak hanya memiliki satu properti, tetapi juga, misalnya, ' </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bool IsError {get; </font><font style="vertical-align: inherit;">}</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> '. </font><font style="vertical-align: inherit;">Karenanya, kodenya mungkin terlihat seperti ini:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">LogBlockAuthorNicely</span>(<span class="hljs-params">Block block, ISyncPeer syncPeer</span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">if</span> (_logger.IsInfo)<font></font>
    {<font></font>
        <span class="hljs-keyword">if</span> (!_logger.IsError) <span class="hljs-comment">// &lt;=</span><font></font>
        {<font></font>
            ...<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nah, atau semua kesalahan kode refactoring dan hanya satu pemeriksaan tidak lagi diperlukan. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kasus 6</font></font></b><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">if</span> (missingParamsCount != <span class="hljs-number">0</span>)<font></font>
{<font></font>
    <span class="hljs-keyword">bool</span> incorrectParametersCount = missingParamsCount != <span class="hljs-number">0</span>; <span class="hljs-comment">// &lt;=</span>
    <span class="hljs-keyword">if</span> (missingParamsCount &gt; <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        ...<font></font>
    }<font></font>
    ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PVS-Studio: </font><font style="vertical-align: inherit;">Ekspresi V3022 'missingParamsCount! = 0' selalu benar. </font><font style="vertical-align: inherit;">Nethermind.JsonRpc JsonRpcService.cs 127 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Periksa kondisi (missingParamsCount! = 0) dan jika itu benar, maka kami menghitung lagi dan menetapkan hasilnya ke variabel. </font><font style="vertical-align: inherit;">Setuju bahwa ini adalah cara yang cukup orisinal untuk menulis yang benar.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cek membingungkan</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task&lt;<span class="hljs-keyword">long</span>&gt; 
<span class="hljs-title">DownloadHeaders</span>(<span class="hljs-params">PeerInfo bestPeer, 
                BlocksRequest blocksRequest, 
                CancellationToken cancellation</span>)</span><font></font>
{<font></font>
  ...<font></font>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; headers.Length; i++)<font></font>
  {<font></font>
    ...<font></font>
    BlockHeader currentHeader = headers[i];<font></font>
    ...<font></font>
    <span class="hljs-keyword">bool</span> isValid = i &gt; <span class="hljs-number">1</span> ? <font></font>
        _blockValidator.ValidateHeader(currentHeader, headers[i - <span class="hljs-number">1</span>], <span class="hljs-literal">false</span>):<font></font>
        _blockValidator.ValidateHeader(currentHeader, <span class="hljs-literal">false</span>);<font></font>
    ...<font></font>
    <span class="hljs-keyword">if</span> (HandleAddResult(bestPeer, <font></font>
                        currentHeader, <font></font>
                        i == <span class="hljs-number">0</span>,                              <span class="hljs-comment">// &lt;=</span><font></font>
                        _blockTree.Insert(currentHeader))) <font></font>
    {<font></font>
       headersSynced++;<font></font>
    }<font></font>
<font></font>
    ...<font></font>
  }<font></font>
  ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PVS-Studio: </font><font style="vertical-align: inherit;">Ekspresi </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">V3022</font></a><font style="vertical-align: inherit;"> 'i == 0' selalu salah. </font><font style="vertical-align: inherit;">Nethermind.Synchronization BlockDownloader.cs 192 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita mulai berurutan. </font><font style="vertical-align: inherit;">Saat menginisialisasi, variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diberi nilai 1. Selanjutnya, variabel hanya bertambah, oleh karena itu, nilai akan selalu diteruskan ke fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang mari kita lihat </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HandleAddResult</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">HandleAddResult</span>(<span class="hljs-params">PeerInfo peerInfo, 
                             BlockHeader block,
                             <span class="hljs-keyword">bool</span> isFirstInBatch, 
                             AddBlockResult addResult</span>)</span><font></font>
{<font></font>
    ...<font></font>
    <span class="hljs-keyword">if</span> (isFirstInBatch)<font></font>
    {<font></font>
        ...<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
        ...<font></font>
    }<font></font>
    ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini kita tertarik pada </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">isFirstInBatch</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Menilai dengan nama parameter ini, itu bertanggung jawab untuk apakah ada sesuatu yang pertama di pesta. </font><font style="vertical-align: inherit;">Hm, pertama. </font><font style="vertical-align: inherit;">Mari kita lihat lagi di atas dan melihat bahwa ada 2 panggilan menggunakan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cs hljs">BlockHeader currentHeader = headers[i];<font></font>
_blockValidator.ValidateHeader(currentHeader, headers[i - <span class="hljs-number">1</span>], <span class="hljs-literal">false</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jangan lupa bahwa dalam hal ini hitungannya adalah pada 1. Ternyata kita memiliki dua opsi: "pertama" berarti elemen pada indeks 1, atau di bawah simbol 0. Dalam kasus apa pun, pada saat yang sama </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">saya</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan sama dengan 1. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ternyata pemanggilan fungsi akan terlihat seperti ini:</font></font><br>
<br>
<pre><code class="cs hljs">HandleAddResult(bestPeer, currentHeader, <font></font>
                i == <span class="hljs-number">1</span>, _blockTree.Insert(currentHeader))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Atau seperti ini:</font></font><br>
<br>
<pre><code class="cs hljs">HandleAddResult(bestPeer, currentHeader, <font></font>
                i - <span class="hljs-number">1</span> == <span class="hljs-number">0</span>, _blockTree.Insert(currentHeader))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan lagi, jika pengembang terus menggunakan analisa statis, maka dia akan menulis kode ini dan melihat peringatan, akan segera memperbaikinya dan menikmati hidup. </font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sebuah prioritas ??</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Situasi 1</font></font></b><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> MemorySize<font></font>
{<font></font>
  <span class="hljs-keyword">get</span><font></font>
  {<font></font>
    <span class="hljs-keyword">int</span> unaligned = (Keccak == <span class="hljs-literal">null</span> ? MemorySizes.RefSize : <font></font>
        MemorySizes.RefSize + Keccak.MemorySize) <font></font>
        + (MemorySizes.RefSize + FullRlp?.Length <font></font>
                                 ?? MemorySizes.ArrayOverhead)   <span class="hljs-comment">// &lt;=</span><font></font>
        + (MemorySizes.RefSize + _rlpStream?.MemorySize <font></font>
                                 ?? MemorySizes.RefSize)         <span class="hljs-comment">// &lt;=</span><font></font>
        + MemorySizes.RefSize + (MemorySizes.ArrayOverhead + _data?.Length <font></font>
        * MemorySizes.RefSize ?? MemorySizes.ArrayOverhead) <font></font>
        + MemorySizes.SmallObjectOverhead + (Key?.MemorySize ?? <span class="hljs-number">0</span>);
    <span class="hljs-keyword">return</span> MemorySizes.Align(unaligned);<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peringatan PVS-Studio: </font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3123 Mungkin '??' </font><font style="vertical-align: inherit;">Operator bekerja dengan cara yang berbeda dari yang diharapkan. </font><font style="vertical-align: inherit;">Prioritasnya lebih rendah daripada prioritas operator lain di bagian kirinya. </font><font style="vertical-align: inherit;">Nethermind.Trie TrieNode.cs 43</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3123 Mungkin '??' </font><font style="vertical-align: inherit;">Operator bekerja dengan cara yang berbeda dari yang diharapkan. </font><font style="vertical-align: inherit;">Prioritasnya lebih rendah daripada prioritas operator lain di bagian kirinya. </font><font style="vertical-align: inherit;">Nethermind.Trie TrieNode.cs 44</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Penganalisa menyarankan Anda untuk memeriksa bagaimana kami menggunakan operator "??", dan untuk memahami apa masalahnya, saya mengusulkan untuk mempertimbangkan situasi berikut. </font><font style="vertical-align: inherit;">Kami melihat garis ini di sini:</font></font><br>
<br>
<pre><code class="cs hljs">(MemorySizes.RefSize + FullRlp?.Length ?? MemorySizes.ArrayOverhead)</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MemorySizes.RefSize</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MemorySizes.ArrayOverhead</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah konstanta:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MemorySizes</span><font></font>
{<font></font>
    ...<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> RefSize = <span class="hljs-number">8</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> ArrayOverhead = <span class="hljs-number">20</span>;<font></font>
    ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oleh karena itu, untuk kejelasan, saya mengusulkan untuk menulis ulang string, mengganti nilainya</font></font><br>
<br>
<pre><code class="cs hljs">(<span class="hljs-number">8</span> + FullRlp?.Length ?? <span class="hljs-number">20</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang anggap </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FullRlp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Maka </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(8 + nol)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan menjadi nol </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Selanjutnya, kita mendapatkan ekspresi ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null ?? 20</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), yang akan mengembalikan 20. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ternyata, asalkan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FullRlp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , nilai dari </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MemorySizes.ArrayOverhead</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan selalu dikembalikan, </font><font style="vertical-align: inherit;">terlepas dari apa yang disimpan di </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MemorySizes.RefSize.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fragmen pada baris di bawah ini mirip. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi pertanyaannya adalah, apakah pengembang menginginkan perilaku ini? Mari kita lihat baris berikut:</font></font><br>
<br>
<pre><code class="cs hljs">MemorySizes.RefSize + (MemorySizes.ArrayOverhead <font></font>
    + _data?.Length * MemorySizes.RefSize ?? MemorySizes.ArrayOverhead) </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini, seperti pada bagian yang dipertimbangkan di atas, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MemorySizes.RefSize</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ditambahkan ke ekspresi, tetapi </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
perhatikan bahwa setelah operator "+" pertama ada braket. </font><font style="vertical-align: inherit;">Ternyata </font><font style="vertical-align: inherit;">kita harus menambahkan beberapa ekspresi </font><font style="vertical-align: inherit;">ke </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MemorySizes.RefSize</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan jika itu </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , maka kita akan menambahkan yang lain. </font><font style="vertical-align: inherit;">Jadi kodenya akan terlihat seperti ini:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> MemorySize<font></font>
{<font></font>
  <span class="hljs-keyword">get</span><font></font>
  {<font></font>
    <span class="hljs-keyword">int</span> unaligned = (Keccak == <span class="hljs-literal">null</span> ? MemorySizes.RefSize : <font></font>
       MemorySizes.RefSize + Keccak.MemorySize) <font></font>
       + (MemorySizes.RefSize + (FullRlp?.Length <font></font>
                                 ?? MemorySizes.ArrayOverhead))    <span class="hljs-comment">// &lt;=</span><font></font>
       + (MemorySizes.RefSize + (_rlpStream?.MemorySize <font></font>
                                 ?? MemorySizes.RefSize))          <span class="hljs-comment">// &lt;=</span><font></font>
       + MemorySizes.RefSize + (MemorySizes.ArrayOverhead + _data?.Length <font></font>
       * MemorySizes.RefSize ?? MemorySizes.ArrayOverhead) <font></font>
       + MemorySizes.SmallObjectOverhead + (Key?.MemorySize ?? <span class="hljs-number">0</span>);
    <span class="hljs-keyword">return</span> MemorySizes.Align(unaligned);<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekali lagi, ini hanya asumsi, namun, jika pengembang menginginkan perilaku yang berbeda, maka Anda harus secara eksplisit menunjukkan ini:</font></font><br>
<br>
<pre><code class="cs hljs">((MemorySizes.RefSize + FullRlp?.Length) ?? MemorySizes.ArrayOverhead)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan kemudian, orang yang membaca kode ini tidak perlu mempelajari untuk waktu yang lama apa yang terjadi di sini dan apa yang diinginkan oleh programmer. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Situasi 2</font></font></b><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> Task&lt;JsonRpcResponse&gt; 
<span class="hljs-title">ExecuteAsync</span>(<span class="hljs-params">JsonRpcRequest request, 
             <span class="hljs-keyword">string</span> methodName,
             (MethodInfo Info, <span class="hljs-keyword">bool</span> ReadOnly</span>) method)</span><font></font>
{<font></font>
    <span class="hljs-keyword">var</span> expectedParameters = method.Info.GetParameters();
    <span class="hljs-keyword">var</span> providedParameters = request.Params;<font></font>
    ...<font></font>
    <span class="hljs-keyword">int</span> missingParamsCount = expectedParameters.Length <font></font>
            - (providedParameters?.Length ?? <span class="hljs-number">0</span>) <font></font>
            + providedParameters?.Count(<span class="hljs-keyword">string</span>.IsNullOrWhiteSpace) ?? <span class="hljs-number">0</span>; <span class="hljs-comment">// &lt;=</span>
    <span class="hljs-keyword">if</span> (missingParamsCount != <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        ...<font></font>
    }<font></font>
    ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peringatan PVS-Studio: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3123</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mungkin '??' </font><font style="vertical-align: inherit;">Operator bekerja dengan cara yang berbeda dari yang diharapkan. </font><font style="vertical-align: inherit;">Prioritasnya lebih rendah daripada prioritas operator lain di bagian kirinya. </font><font style="vertical-align: inherit;">Nethermind.JsonRpc JsonRpcService.cs 123 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan lagi, prioritas operasi adalah "??", oleh karena itu, seperti yang terakhir kali, kami mempertimbangkan situasinya. </font><font style="vertical-align: inherit;">Kami melihat garis ini di sini:</font></font><br>
<br>
<pre><code class="cs hljs">expectedParameters.Length <font></font>
            - (providedParameters?.Length ?? <span class="hljs-number">0</span>) <font></font>
            + providedParameters?.Count(<span class="hljs-keyword">string</span>.IsNullOrWhiteSpace) ?? <span class="hljs-number">0</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Misalkan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">disediakanParameters</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , maka untuk kejelasan, segera ganti segala sesuatu yang terkait denganParameter yang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">disediakan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font><font style="vertical-align: inherit;">gantilah nilai acak </font><font style="vertical-align: inherit;">sebagai gantiParameter yang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diharapkan. Panjang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-number">100</span> - (<span class="hljs-literal">null</span> ?? <span class="hljs-number">0</span>) + <span class="hljs-literal">null</span> ?? <span class="hljs-number">0</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang langsung terlihat bahwa ada dua pemeriksaan serupa, hanya dalam satu kasus ada tanda kurung, dan yang lain ada. Mari kita jalankan contoh ini. Pertama kita mendapatkan bahwa ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol ?? 0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) akan mengembalikan 0, kemudian kurangi 0 dari 100 dan dapatkan 100:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-number">100</span> + <span class="hljs-literal">null</span> ?? <span class="hljs-number">0</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang, alih-alih mengeksekusi " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null ?? 0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " dan akhirnya mendapatkan ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100 + 0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), kami menjadi sangat berbeda. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama akan dieksekusi ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100 + null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) dan kami mendapatkan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Kemudian memeriksa ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol ?? 0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), yang mengarah pada fakta bahwa nilai variabel missingParamsCount akan menjadi 0. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena kondisi selanjutnya adalah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">missingParamsCount sama dengan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nol, kita dapat mengasumsikan bahwa pengembang mencari perilaku ini. Dan saya akan mengatakan, mengapa tidak menaruh tanda kurung dan mengekspresikan pikiran saya secara eksplisit? Secara umum, ada kemungkinan bahwa pemeriksaan ini disebabkan oleh kesalahpahaman mengapa 0 kadang-kadang dikembalikan, dan ini tidak lebih dari penopang.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan lagi, kita membuang-buang waktu, meskipun kita mungkin tidak melakukan ini, gunakan mode </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">analisis tambahan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> saat menulis kode </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesimpulan</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai kesimpulan, saya berharap bahwa saya dapat menyampaikan kepada Anda bahwa penganalisa statis adalah teman Anda, dan bukan pengawas kejahatan yang hanya menunggu Anda melakukan kesalahan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perlu juga dicatat bahwa dengan menggunakan alat analisis sekali atau jarang menggunakannya, Anda tentu saja akan menemukan kesalahan dan beberapa dari mereka bahkan akan cepat diperbaiki, tetapi ada juga yang perlu Anda hancurkan. </font><font style="vertical-align: inherit;">Oleh karena itu, Anda perlu menggunakan penganalisa statis terus-menerus. </font><font style="vertical-align: inherit;">Kemudian Anda akan menemukan lebih banyak kesalahan dan memperbaikinya pada saat kode program ditulis dan Anda mengerti persis apa yang Anda coba lakukan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kebenaran sederhana adalah bahwa semua orang membuat kesalahan dan itu normal. </font><font style="vertical-align: inherit;">Kita semua belajar dari kesalahan, tetapi hanya dari mereka yang mampu memperhatikan dan memahami. </font><font style="vertical-align: inherit;">Karenanya, gunakan alat modern untuk mencari kesalahan ini, misalnya - PVS-Studio. </font><font style="vertical-align: inherit;">Terimakasih atas perhatiannya.</font></font><br>
<br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a></p><div style="text-align:center;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/eb2/f9c/3bb/eb2f9c3bb5f32f39239298d36431961c.png"></a></div><p></p><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda ingin berbagi artikel ini dengan audiens yang berbahasa Inggris, silakan gunakan tautan ke terjemahan: Nikolay Mironov. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kode baris tunggal atau periksa Nethermind menggunakan PVS-Studio C # untuk Linux</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id504296/index.html">Menghasilkan Cabang Acak dengan Python</a></li>
<li><a href="../id504306/index.html">Bagaimana perangkat keras Rusia dibuat untuk penyimpanan Aerodisk Vostok di Elbrus</a></li>
<li><a href="../id504310/index.html">Dikotomi data: memikirkan kembali hubungan dengan data dan layanan</a></li>
<li><a href="../id504312/index.html">Daftar terpadu program Rusia dan GPL. Lima sen saya</a></li>
<li><a href="../id504314/index.html">Implementasi docker pull dan docker push commands tanpa klien docker melalui permintaan HTTP</a></li>
<li><a href="../id504326/index.html">Evgeny Dikiy: "Secara lokal, Antartika paling tidak kotor, tetapi polusi global sangat terlihat di sini"</a></li>
<li><a href="../id504328/index.html">Pelajaran pemungutan suara elektronik di Moscow City Duma 2019</a></li>
<li><a href="../id504334/index.html">–ù–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –≤—ã –∑–Ω–∞–µ—Ç–µ JavaScript?</a></li>
<li><a href="../id504344/index.html">Otentikasi - CUSTOM SETUP / AWS Amplify + React Native</a></li>
<li><a href="../id504348/index.html">Monowheel: apa yang terjadi selama pelatihan, dan bagaimana mempercepat proses ini</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>