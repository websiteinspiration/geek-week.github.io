<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶Ñ ü•ï üëèüèª Modern solutions for building information security systems - network packet brokers (Network Packet Broker) üì® üë≠ üë©üèæ‚Äçüéì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Information security has separated from telecommunications into an independent industry with its own specifics and its equipment. But there is a littl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Modern solutions for building information security systems - network packet brokers (Network Packet Broker)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsol/blog/490252/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Information security has separated from telecommunications into an independent industry with its own specifics and its equipment. </font><font style="vertical-align: inherit;">But there is a little-known class of devices, which stands at the crossroads of telecom and infobeza - </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">brokers network packets</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Network Packet Broker), they also load balancers, specialized / monitoring switches, traffic aggregators, Security Delivery Platform, Network Visibility and so on. </font><font style="vertical-align: inherit;">And we, as a Russian developer and manufacturer of such devices, really want to talk more about them.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ou/dk/el/oudkelhe8ubdir4vk7nymlouoyo.png" alt="image" width="550" height="460"></div><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scope and tasks</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Network packet brokers are specialized devices that have found the greatest application in information security systems. As such, the class of devices is relatively new and small in the generally accepted network infrastructure compared to switches, routers, etc. The pioneer in the development of this type of device was the American company Gigamon. Currently, there are significantly more players in this market (including the well-known manufacturer of test systems - IXIA, who have such solutions), but only a narrow circle of professionals still knows about the existence of such devices. As noted above, even with the terminology there is no unequivocal certainty: the names range from ‚Äúa system for ensuring network transparency‚Äù to simple ‚Äúbalancers‚Äù.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When developing brokers of network packages, we were faced with the fact that, in addition to analyzing the directions of development of functionality and testing in laboratories / test zones, it is necessary to simultaneously explain to potential consumers the existence of this class of equipment, since not everyone knows about it. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As early as 15-20 years ago, there was little traffic in the network, and these were mostly unimportant data. But </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nielsen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Äôs </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">law</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> practically repeats </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">Moore</font></a><font style="vertical-align: inherit;"> ‚Äôs </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">law</font></a><font style="vertical-align: inherit;"> : Internet connection speed increases by 50% annually. The volume of traffic is also growing steadily (the graph shows the 2017 forecast from Cisco, source Cisco Visual Networking Index: Forecast and Trends, 2017‚Äì2022):</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/r-/od/hh/r-odhhtesby81f0fqenm_et-are.png" alt="image" width="768" height="300"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Along with speed, the importance of circulating information (this is a trade secret, and notorious personal data) and the overall performance of the infrastructure are increasing. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Accordingly, the information security industry also appeared. The industry responded to this with the advent of a whole range of devices for deep traffic analysis (DPI): from DDOS attack prevention systems to information security event management systems, including IDS, IPS, DLP, NBA, SIEM, Antimailware and so on. Typically, each of these tools is software installed on the server platform. Moreover, each program (analysis tool) is installed on its server platform: software manufacturers are different, and there are a lot of computing resources for analysis on L7.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When building an information security system, it is required to solve a number of basic tasks:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to transfer traffic from infrastructure to analysis systems? </font><font style="vertical-align: inherit;">(initially developed SPAN ports for this in the modern infrastructure are not enough in terms of quantity or performance)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">how to distribute traffic between different analysis systems?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">how to scale the system with the lack of performance of one instance of the analyzer to process the entire amount of traffic entering it?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to monitor 40G / 100G interfaces (and in the near future, 200G / 400G), since the analysis tools currently only support 1G / 10G / 25G interfaces?</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And the following related tasks:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">how to minimize inappropriate traffic, which does not need to be processed, but falls into the analysis tools and consumes their resources?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">how to handle encapsulated packets and packets with service marks of equipment, the preparation of which for analysis turns out to be either resource-intensive or impossible at all?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">how to exclude from the analysis part of the traffic that does not fall under the regulation of security policy (for example, manager traffic).</font></font></li>
</ul><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dv/u0/p2/dvu0p20eqotybc45qshr5n3zzb0.png" alt="image" width="550" height="460"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As everyone knows, demand creates supply, in response to these needs, network packet brokers began to develop.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">General Description of Network Packet Brokers</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Network packet brokers operate at the packet level, and in this they are similar to regular switches. The main difference from switches is that the rules for distributing and aggregating traffic in network packet brokers are completely determined by the settings. Network packet brokers do not have standards for constructing forwarding tables (MAC tables) and communication protocols with other switches (such as STP), and therefore the range of possible settings and understandable fields in them is much wider. The broker can evenly distribute traffic from one or more input ports to a given range of output ports with the function of uniform load on the output. You can set the rules for copying, filtering, classification, deduplication and traffic modification. These rules can be applied to different groups of input ports of the network packet broker,and also apply sequentially one after another in the device itself. An important advantage of a packet broker is the ability to process traffic at full flow rate and maintain session integrity (in the case of balancing traffic to several DPI systems of the same type).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saving the integrity of sessions consists in transferring all packets of a transport layer session (TCP / UDP / SCTP) to one port. This is important because DPI systems (usually the software running on a server connected to the output port of the packet broker) analyze the contents of traffic at the application level, and all packets sent / received by one application must go to the same analyzer instance . If packets from one session are lost or distributed between different DPI devices, then each individual DPI device will be in a situation similar to reading not whole text, but individual words from it. And, most likely, the text will not understand.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thus, being oriented towards information security systems, network packet brokers have functionality that helps connect DPI software systems to high-speed telecommunication networks and reduce the load on them: they carry out preliminary filtering, classification and preparation of traffic to simplify subsequent processing. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition, since brokers of network packets give out a wide list of statistics and often find themselves connected to various points of the network, they also find their place in diagnosing the health problems of the network infrastructure itself.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Basic features of network packet brokers</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The name ‚Äúspecialized / monitoring switches‚Äù arose from its basic purpose: to collect traffic from the infrastructure (usually using passive optical TAP couplers and / or SPAN ports) and distribute it between the analysis tools. Between heterogeneous systems, traffic is mirrored (duplicated), between homogeneous systems it is balanced. The basic functions usually include filtering by fields to L4 (MAC, IP, TCP / UDP port, etc.) and aggregating several lightly loaded channels into one (for example, for processing on one DPI system).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This functionality provides a solution to the basic problem - connecting DPI systems to the network infrastructure. Brokers of various manufacturers, limited by the basic functionality, provide processing of up to 32 100G interfaces per 1U (more interfaces do not physically fit on the 1U front panel). However, they do not allow reducing the load on the analysis tools, and for complex infrastructure they cannot even provide the requirements for the basic function: a session distributed over several tunnels (or equipped with MPLS tags) can be unbalanced for different analyzer instances and generally fall out of the analysis.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition to adding 40 / 100G interfaces and, as a result, increasing productivity, network packet brokers are actively developing in terms of providing fundamentally new features: from balancing nested tunnel headers to decrypting traffic. </font><font style="vertical-align: inherit;">Unfortunately, such models cannot boast terabit performance, but they allow you to build a really high-quality and technically ‚Äúbeautiful‚Äù information security system in which each analysis tool is guaranteed to receive only the information it needs in the most suitable form for analysis.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Advanced Network Packet Brokers</font></font></h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ut/tc/ek/uttcekss7ljjozpnwqxg5iv3o_y.png" alt="image" width="621" height="460"></div><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mentioned above </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">balancing on nested headers in tunneled traffic. </font></font></strong><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Why is it important? </font><font style="vertical-align: inherit;">Consider 3 aspects that can be critical together or individually:</font></font><br>
<br>
<ul>
<li>       .   ,         2 ,        3       .       ,            ;</li>
<li>       (, FTP  VoIP),      .     : , ,     .   ,        ,  ,     .           ,   ,          .           ,        ;</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">balancing in the presence of MPLS, VLAN, individual equipment tags, etc. </font><font style="vertical-align: inherit;">Not exactly tunnels, but nevertheless, equipment with basic functionality can understand this traffic not as IP and balance by MAC addresses, once again violating the balance or the integrity of the sessions.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The network packet broker parses the external headers and sequentially follows the pointers to the nested IP header itself and balances it. </font><font style="vertical-align: inherit;">As a result, there are significantly more threads (accordingly, you can unbalance more evenly and on a larger number of platforms), and the DPI system receives all session packets and all associated sessions of multisession protocols. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Modification of traffic. </font></font></strong><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One of the widest functions in terms of its capabilities, the number of subfunctions and their application options are numerous:</font></font><br>
<br>
<ul>
<li> payload,          .         ,        ,    . ,          (,  ,   ),  payload   ,      .  ,  payload ,     ‚Äì      ;</li>
<li>,    ,    .  ‚Äì         .                  ;</li>
<li>   : MPLS-, VLAN,    ;</li>
<li>  , ,  IP-    ;</li>
<li>    :  ,  ,     ..</li>
</ul><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Deduplication</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - cleaning of duplicate traffic packets transmitted to analysis tools. Duplicate packets most often arise due to the peculiarities of connecting to the infrastructure - traffic can go through several points of analysis and be mirrored with each of them. There is also repeated sending of TCP packets that have not reached, but if there are a lot of them, then these are more likely to be questions of monitoring the quality of the network, rather than information security in it. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Advanced filtering functions</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - from searching for specific values ‚Äã‚Äãat a given offset to signature analysis throughout the package. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. NetFlow / IPFIX generation</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - collection of a wide list of statistics on the passing traffic and its transmission to the analysis tools. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. Decryption of SSL traffic,</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It works provided that the certificate and keys are preloaded into the network packet broker. Nevertheless, this allows to significantly unload the analysis tools. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are many more useful and marketing features, but the main ones are perhaps listed.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The development of detection systems (intrusions, DDOS attacks) in their prevention systems, as well as the introduction of active DPI tools, required a change in the switching scheme from passive (via TAP or SPAN ports) to active (‚Äúinto the gap‚Äù). This circumstance increased the reliability requirements (because failure in this case leads to disruption of the entire network, and not only to loss of control over information security) and led to the replacement of optical couplers with optical bypass (in order to solve the problem of the dependence of network performance on system performance information security), but the basic functionality and requirements for it remained the same.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We have developed DS Integrity Network Packet Brokers with 100G, 40G and 10G interfaces from design and circuitry to embedded software. </font><font style="vertical-align: inherit;">Moreover, unlike other package brokers, the modification and balancing functions for the embedded tunnel headers are implemented in hardware, at full port speed.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sq/gi/-n/sqgi-nmjhretaxt79qv6iv_uhye.png" alt="image"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en490242/index.html">GSM Location service of SIM800x modules and its work with Yandex.Locator API</a></li>
<li><a href="../en490244/index.html">Python code optimization with ctypes</a></li>
<li><a href="../en490246/index.html">Kremlin Towers in Hydra's Embrace: Hydra 2020 Parallel and Distributed Computing Conference</a></li>
<li><a href="../en490248/index.html">Webinar ‚ÄúWinnum CNC: monitoring that works‚Äù</a></li>
<li><a href="../en490250/index.html">Horror Set.removeAll</a></li>
<li><a href="../en490254/index.html">Fuzzy math. Basics of fuzzy sets</a></li>
<li><a href="../en490260/index.html">New storage technologies: is there a breakthrough in 2020?</a></li>
<li><a href="../en490262/index.html">3D Printing: Quick Tips for Moving from a CAD Model to a Printed Object</a></li>
<li><a href="../en490264/index.html">Organization of autotests on the example of a mobile application for EDMS</a></li>
<li><a href="../en490266/index.html">Swearing in English, for which they will not beat (but this is not accurate)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>