<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😼 ⌛️ 🗂️ Einlösen ist die Königin: Varonis untersucht die schnell verbreitete Ransomware Ransomware „SaveTheQueen“ 🚣🏻 📅 🔊</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ein neuer Malware-Typ der Ransomware-Virenklasse verschlüsselt Dateien und fügt ihnen die Erweiterung .SaveTheQueen hinzu, die sich über den SYSVOL-Sy...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Einlösen ist die Königin: Varonis untersucht die schnell verbreitete Ransomware Ransomware „SaveTheQueen“</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/varonis/blog/488896/"><img src="https://habrastorage.org/webt/el/rj/ju/elrjju9x0zwjqu_8jtoeo4kkoem.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein neuer Malware-Typ der Ransomware-Virenklasse verschlüsselt Dateien und fügt ihnen die Erweiterung .SaveTheQueen hinzu, die sich über den SYSVOL-Systemnetzwerkordner auf Active Directory-Domänencontrollern verteilt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unsere Kunden sind kürzlich auf diese Malware gestoßen. </font><font style="vertical-align: inherit;">Wir geben unsere vollständige Analyse, ihre Ergebnisse und Schlussfolgerungen unten.</font></font><br>
<a name="habracut"></a><br>
<h2></h2><h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erkennung</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einer unserer Kunden hat uns kontaktiert, nachdem er auf eine neue Art von Ransomware-Ransomware gestoßen ist, die neuen verschlüsselten Dateien in ihrer Umgebung die Erweiterung ".SaveTheQueen" hinzugefügt hat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Während unserer Untersuchung oder vielmehr bei der Suche nach Infektionsquellen haben wir festgestellt, dass die Verteilung und Verfolgung infizierter Opfer mithilfe des </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SYSVOL-Netzwerkordners</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf dem Domänencontroller des Kunden erfolgt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SYSVOL ist der Schlüsselordner für jeden Domänencontroller, der zum Bereitstellen von Gruppenrichtlinienobjekten (Group Policy Objects, GPOs) sowie Anmelde- und Abmeldeskripts für Domänencomputer verwendet wird. </font><font style="vertical-align: inherit;">Der Inhalt dieses Ordners wird zwischen Domänencontrollern repliziert, um diese Daten auf den Standorten der Organisation zu synchronisieren. </font><font style="vertical-align: inherit;">Das Schreiben in SYSVOL erfordert hohe Domänenberechtigungen. Nach einer Gefährdung wird dieses Asset jedoch zu einem leistungsstarken Tool für Angreifer, die damit schnell und effizient böswillige Last in der Domäne verteilen können. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Varonis-Prüfungskette hat dazu beigetragen, Folgendes schnell zu identifizieren:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Das infizierte Benutzerkonto hat in SYSVOL eine Datei mit dem Namen "stündlich" erstellt</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In SYSVOL wurden viele Protokolldateien erstellt, die jeweils nach einem Domänengerätenamen benannt sind</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Viele verschiedene IPs haben auf die Stundendatei zugegriffen.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir kamen zu dem Schluss, dass die Protokolldateien verwendet wurden, um den Infektionsprozess auf neuen Geräten zu verfolgen, und dass "stündlich" eine geplante Aufgabe ist, bei der neue Geräte mithilfe des Powershell-Skripts böswillig geladen werden - Beispiele "v3" und "v4". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Angreifer hat wahrscheinlich Domänenadministratorrechte erhalten und verwendet, um Dateien in SYSVOL zu schreiben. </font><font style="vertical-align: inherit;">Auf infizierten Knoten startete der Angreifer PowerShell-Code, der eine Zeitplanaufgabe zum Öffnen, Entschlüsseln und Starten von Malware erstellte.</font></font><br>
<br>
<h2></h2><h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entschlüsselung</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben verschiedene Methoden ausprobiert, um die Proben ohne Erfolg zu entschlüsseln: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qj/mt/jz/qjmtjzhy4lefpwie9ik6_uialqy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir waren fast bereit aufzugeben, als wir beschlossen, die „Magic“ -Methode des großartigen </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Cyberchef-</font></a></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dienstprogramms von </font><font style="vertical-align: inherit;">GCHQ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auszuprobieren</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">"Magic" versucht, die Verschlüsselung der Datei zu erraten, indem Passwörter für verschiedene Arten der Verschlüsselung aufgezählt und die Entropie gemessen werden.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anmerkung des Übersetzers</font></font></b><div class="spoiler_text"> .<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   </a>.            ,     ,      </div></div><br>
<img src="https://habrastorage.org/webt/wv/ih/kp/wvihkp4ra_yhagocyuvcto9hk14.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Magic" stellte fest, dass ein Base64-codierter GZip-Packer verwendet wurde, dank dessen wir die Datei entpacken und den Injektionscode "Injector" finden konnten.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/f9/z3/xy/f9z3xydbmb-tbdoeui5-9zhsnai.png"><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dropper: „Es gibt eine Epidemie in der Gegend! </font><font style="vertical-align: inherit;">Half-Shot-Impfungen. </font><font style="vertical-align: inherit;">Maul-und Klauenseuche</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Dropper war eine reguläre .NET-Datei ohne Schutz. </font><font style="vertical-align: inherit;">Nachdem </font><font style="vertical-align: inherit;">wir </font><font style="vertical-align: inherit;">den Quellcode mit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DNSpy gelesen hatten, stellten</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wir fest, dass sein einziger Zweck darin bestand </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">, Shellcode</font></a><font style="vertical-align: inherit;"> in den Prozess winlogon.exe einzufügen.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7e/2p/mv/7e2pmvyemixm7gwgf38kgqg5gtu.png"><br>
<br>
<img src="https://habrastorage.org/webt/eo/l_/s3/eol_s38i7jfqzjlley-0v3xlsto.png"><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shellcode oder einfache Schwierigkeiten</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben das Hexacorn Autorwerkzeug - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">shellcode2exe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> um „Übersetzen“ der Shell - </font><font style="vertical-align: inherit;">Code in eine ausführbare Datei für das </font><font style="vertical-align: inherit;">Debuggen und Analyse. </font><font style="vertical-align: inherit;">Dann stellten wir fest, dass es sowohl auf 32-Bit- als auch auf 64-Bit-Computern funktionierte. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gg/up/we/ggupwetsxenylw_gov8ruzrapru.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Schreiben eines einfachen Shellcodes in nativer Übersetzung von Assembler kann schwierig sein. Das Schreiben eines vollständigen Shellcodes, der auf beiden Systemtypen ausgeführt wird, erfordert Elite-Kenntnisse. Daher haben wir begonnen, uns über die Raffinesse des Angreifers zu wundern. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als wir </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">den kompilierten Shellcode</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">x64dbg analysierten</font></a><font style="vertical-align: inherit;"> , stellten wir fest, dass </font><strong><font style="vertical-align: inherit;">die dynamischen .NET-Bibliotheken</font></strong><font style="vertical-align: inherit;"> geladen </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wurden</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wie clr.dll und mscoreei.dll. Dies erschien uns seltsam - normalerweise versuchen Angreifer, den Shellcode so klein wie möglich zu halten, indem sie die nativen Funktionen des Betriebssystems aufrufen, anstatt sie zu laden. </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Warum sollte jemand Windows-Funktionen in Shellcode einbetten müssen, anstatt sie bei Bedarf direkt aufzurufen?</font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wie sich herausstellte, hat der Autor der Malware diesen komplexen Shell-Code überhaupt nicht geschrieben - das Software-Merkmal dieser Aufgabe wurde verwendet, um ausführbare Dateien und Skripte in Shell-Code zu übersetzen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir fanden das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Donut-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tool </font><font style="vertical-align: inherit;">, mit dem wir einen ähnlichen Shellcode kompilieren konnten. Hier ist seine Beschreibung von GitHub:</font></font><br>
<br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Donut generiert x86- oder x64-Shellcode aus VBScript, JScript, EXE, DLL (einschließlich .NET-Assemblys). </font><font style="vertical-align: inherit;">Dieser Shellcode kann zur Ausführung im </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RAM </font><font style="vertical-align: inherit;">in jeden Windows-Prozess eingebettet werden </font><font style="vertical-align: inherit;">. </font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um unsere Theorie zu bestätigen, haben wir unseren eigenen Code mit Donut kompiliert und mit einem Beispiel verglichen - und ... ja, wir haben eine weitere Komponente des verwendeten Toolkits gefunden. </font><font style="vertical-align: inherit;">Danach konnten wir bereits die ursprüngliche ausführbare .NET-Datei extrahieren und analysieren.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Codeschutz </font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Datei wurde mit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ConfuserEx</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verschleiert </font><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ah/76/b9/ah76b96lg2aq_r50dkcp23_m_q0.png"><br>
<br>
<img src="https://habrastorage.org/webt/ls/gb/hj/lsgbhj0ogzjphutdng6aqodmb6i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ConfuserEx ist ein Open Source .NET-Projekt zum Schutz von Code vor anderen Designs. </font><font style="vertical-align: inherit;">Mit dieser Softwareklasse können Entwickler ihren Code vor Reverse Engineering schützen, indem sie beispielsweise Zeichen ersetzen, den Fluss von Steuerbefehlen maskieren und die Referenzmethode ausblenden. </font><font style="vertical-align: inherit;">Malware-Autoren verwenden Verschleierer, um eine Erkennung zu vermeiden und die Aufgabe des Reverse Engineering zu erschweren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dank </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ElektroKill Unpacker haben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wir den Code entpackt:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/or/0f/ii/or0fii9mxxkic3nv0-khahgb1nc.png"><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fazit - Nutzlast</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die aus den Transformationen resultierende Nutzlast ist ein sehr einfacher Ransomware-Virus. </font><font style="vertical-align: inherit;">Kein Mechanismus, um die Präsenz im System sicherzustellen, keine Verbindungen zur Kommandozentrale - nur die gute alte asymmetrische Verschlüsselung, um diese Opfer unlesbar zu machen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Hauptfunktion wählt die folgenden Zeilen als Parameter aus:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dateierweiterung zur Verwendung nach der Verschlüsselung (SaveTheQueen) </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> E-Mail des Autors zum Einfügen in die Lösegeldnotizdatei</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Öffentlicher Schlüssel zum Verschlüsseln von Dateien </font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/7_/dj/op/7_djopyggy3b51wnhrxj6iheu3k.png"><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Prozess selbst ist wie folgt:</font></font></strong><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Malware scannt lokale und zugeordnete Laufwerke auf dem Opfergerät</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wl/mf/fk/wlmffk3ai7tekxndrdys5k3yghc.png"><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sucht nach Verschlüsselungsdateien </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7p/8n/xz/7p8nxz-2jhgmoa9ta3rvft28xfm.png"><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Versuche, einen Prozess mit der zu verschlüsselnden Datei zu beenden.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Benennt die Datei mit der MoveFile-Funktion in "Source_file_name.SaveTheQueenING" um und verschlüsselt sie </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nachdem die Datei mit dem öffentlichen Schlüssel des Autors verschlüsselt wurde, benennt die Malware sie erneut um, jetzt in "Original_file_name.SaveTheQueen".</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine Datei wird mit einer Lösegeldforderung im selben Ordner aufgezeichnet</font></font><br>
<br>
<img src="https://habrastorage.org/webt/or/bg/1v/orbg1vgu3ierx5tsqn1rgchzifq.png"><br>
</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Basierend auf der Verwendung der nativen CreateDecryptor-Funktion scheint eine der Malware-Funktionen einen Entschlüsselungsmechanismus zu enthalten, für den ein privater Schlüssel als Parameter erforderlich ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Verschlüsselungsvirus </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verschlüsselt KEINE</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in den Verzeichnissen gespeicherten </font><strong><font style="vertical-align: inherit;">Dateien</font></strong><font style="vertical-align: inherit;"> : </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C: \ Windows </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C: \ Programme </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C: \ Programme (x86) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C: \ Benutzer \\ AppData </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C: \ inetpub </font><strong><font style="vertical-align: inherit;">Verschlüsselt</font></strong></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
auch </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NICHT die folgenden Dateitypen:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> EXE, DLL , MSI, ISO, SYS, CAB.</font></font><br>
<br>
<h2></h2><h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Zusammenfassung und Fazit</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trotz der Tatsache, dass der Ransomware-Virus selbst keine ungewöhnlichen Funktionen enthielt, nutzte der Angreifer Active Directory kreativ, um den Dropper zu verteilen, und die Malware selbst stellte uns während der Analyse interessante, wenn auch nicht komplizierte Hindernisse zur Verfügung. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir denken, der Autor der Malware ist:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich habe einen Ransomware-Virus mit einer integrierten Implementierung im winlogon.exe-Prozess sowie Funktionen zur </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dateiverschlüsselung und </font><font style="vertical-align: inherit;">-entschlüsselung geschrieben</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verkleidete den Schadcode mit ConfuserEx, konvertierte das Ergebnis mit Donut und versteckte zusätzlich den base64 Gzip-Dropper</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erhielt erhöhte Berechtigungen in der Domäne des Opfers und verwendete diese, um </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
verschlüsselte Malware und geplante Aufgaben in den SYSVOL-Netzwerkordner von Domänencontrollern </font><font style="vertical-align: inherit;">zu kopieren</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Startete ein PowerShell-Skript auf Domänengeräten, um Malware zu verbreiten und den Angriffsfortschritt in Protokolle in SYSVOL zu schreiben</font></font></li>
</ol><br>
<img src="https://habrastorage.org/webt/td/wo/lz/tdwolzyjqc7k6eafguk3anox89q.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie Fragen zu dieser Version des Ransomware-Virus oder zu anderen forensischen und Untersuchungen zu Informationssicherheitsvorfällen durch unsere Teams haben, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wenden Sie sich an uns</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder fordern Sie eine </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Live-Demonstration der Reaktion auf Angriffe an</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , bei der wir während der Q &amp; A-Sitzung immer Fragen beantworten.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de488880/index.html">DevOps-Bereich auf der DUMP2020-Konferenz. Freut euch / weint zusammen</a></li>
<li><a href="../de488884/index.html">Wird der 3D-Drucker meine persönliche Fabrik auf dem Balkon?</a></li>
<li><a href="../de488886/index.html">2019 laut Chrome</a></li>
<li><a href="../de488888/index.html">ThinkPad Notebook wird zum Robotergehirn</a></li>
<li><a href="../de488890/index.html">5 Tipps für Rekrutierungsstrategien für soziale Medien</a></li>
<li><a href="../de488898/index.html">Mitarbeiter einzustellen ist nicht gut. Und deins auch</a></li>
<li><a href="../de488904/index.html">Verwenden von SwiftLint Static Code Analyzer in iOS Mobile Banking-Anwendungen</a></li>
<li><a href="../de488908/index.html">KPI-Texter oder Merkmale der Bewertung der Arbeit von Remote-Autoren an Mitarbeitern und Freiberuflern</a></li>
<li><a href="../de488910/index.html">Das Buch „Liebe und Mathematik. Das Herz der verborgenen Realität</a></li>
<li><a href="../de488912/index.html">Python News Bitcoin Preisvorhersage</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>