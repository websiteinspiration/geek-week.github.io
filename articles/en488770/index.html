<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👐🏻 📢 👧🏼 Work with the KOMPAS-3D API → Lesson 17 → Text document 👇🏼 📷 🤳🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the previous lessons of the cycle, we examined in detail various means of working with text. KOMPAS allows you to create text documents. They diffe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Work with the KOMPAS-3D API → Lesson 17 → Text document</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ascon/blog/488770/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the previous lessons of the cycle, we examined in detail various means of working with text. </font><font style="vertical-align: inherit;">KOMPAS allows you to create text documents. </font><font style="vertical-align: inherit;">They differ from files created by a standard Windows notepad by the appearance of various types of main labels. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this lesson we will look at how to open an existing one, create a new one, close and save a text document in various formats. </font><font style="vertical-align: inherit;">Unfortunately, the API of interfaces of version 5 does not allow working with the contents of text documents, only with the contents of their title block. </font><font style="vertical-align: inherit;">Therefore, consideration of text documents is limited only to this lesson. </font><font style="vertical-align: inherit;">And on the next, we will return to graphic documents.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gf/ov/jn/gfovjnt_bko_re3ujpbc5fkidxy.png"><br>
<a name="habracut"></a><br>
<blockquote><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The content of the lesson series “Working with the KOMPAS-3D API”</font></font></h4><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The basics</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drawing design</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Correct connection to COMPASS</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Main inscription</font></font></a> </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Graphic primitives</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">    </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">      </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">   </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">,  </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">    </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> </a></li>
<li><b> </b></li>
</ol></blockquote><h2><font color="#00B2FF">  <b>ksDocumentTxt</b></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A text document is described by the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksDocumentTxt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">It can be prepared by two methods: a method </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DocumentTxt ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KompasObject</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and by the method ActiveDocumentTxt () of the same interface. </font><font style="vertical-align: inherit;">Both of these methods have no input parameters and, if successful, return the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksDocumentTxt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface </font><font style="vertical-align: inherit;">, and in case of an error, </font><font style="vertical-align: inherit;">return </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULL</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The only difference between them is that the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ActiveDocumentTxt ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">returns the interface of the currently active text document, and the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DocumentTxt ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method is an </font><font style="vertical-align: inherit;">interface that is not yet bound to any document. </font><font style="vertical-align: inherit;">Having received the interface, you can open an existing document or create a new one.</font></font><br>
<br>
<h2><font color="#00B2FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opening an existing document</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To open an existing text document using the method </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksOpenDocument</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksDocumentTxt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . The following is its prototype</font></font><br>
<br>
<pre><code class="plaintext hljs">BOOL ksOpenDocument (<font></font>
BSTR nameDoc,	//    <font></font>
BOOL regim	//<font></font>
);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">regim</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> parameter </font><font style="vertical-align: inherit;">sets the document editing mode. Its acceptable values ​​are given below: </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - visible mode (the document is displayed on the screen); </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - invisible mode (the document does not appear on the screen). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Invisible mode is used when you want to change the document so that the user does not see your actions. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If successful, the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksOpenDocument</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">returns </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and in case of an error, </font><font style="vertical-align: inherit;">returns </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Note: note that if the document you are opening is already open in KOMPAS, then the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksOpenDocument</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">will return </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . In this case, you will work with a previously open document.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The following is an example program that demonstrates opening an existing text document.</font></font><br>
<br>
<pre><code class="plaintext hljs">//     <font></font>
WideString wideStr = WideString(ExtractFileDir(Application-&gt;ExeName));<font></font>
wideStr += L"\\TextDocument.kdw";<font></font>
BSTR filePath = SysAllocString(wideStr.c_bstr());<font></font>
<font></font>
// <font></font>
DocumentTxtPtr documentTxt;<font></font>
documentTxt = static_cast&lt;DocumentTxtPtr&gt;(kompas-&gt;DocumentTxt());<font></font>
documentTxt-&gt;ksOpenDocument(filePath, 0);<font></font>
<font></font>
// <font></font>
documentTxt.Unbind();<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This example opens the document </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"TextDocument.kdw"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> located in the application directory. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Text document options ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksTextDocumentParam</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Text document options are described by the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksTextDocumentParam</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface </font><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It can be obtained using the method </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetParamStruct</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KompasObject</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . To do this, you need to pass the constant </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ko_TextDocumentParam</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as the only parameter to this method </font><font style="vertical-align: inherit;">. Consider the properties of this interface: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">author</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - a string with the name of the author of the document; </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comment</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - a string containing a comment on the document; </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fileName</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- The full path to the file with a raster image; </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mode</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - document editing mode. Valid values ​​are listed below: </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - visible mode (the document is displayed on the screen and visible to the user); </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - “blind” mode (the document is not visible to the user). This mode is usually used for covert work with multiple documents. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">type</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - the integer type of the document. Its valid values ​​are shown in the table below. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/im/au/01/imau01sxpaxf07wlrucbht6eu9i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now consider the methods of the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksTextDocumentParam</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface </font><font style="vertical-align: inherit;">. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Init ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - initializes the interface properties. It has no input parameters. In case of success, returns </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and in case of error - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetSheetParam ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - returns the sheet parameters interface. </font><font style="vertical-align: inherit;">It has no input parameters. </font><font style="vertical-align: inherit;">If the text document has sheets of standard size ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">type == lt_DocTxtStandart</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), then the method returns the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksStandartSheet</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">If the document has sheets of a non-standard size ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">type == ls_DocTxtUser</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksSheetSize</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface is </font><b><font style="vertical-align: inherit;">returned</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Both of these interfaces were covered in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lesson 2 of the</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cycle. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The other methods of the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksTextDocumentParam</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface </font><font style="vertical-align: inherit;">are related to the design of the document. </font><font style="vertical-align: inherit;">Since they do not allow you to change the design of the document (just read it), we will not consider them.</font></font><br>
<br>
<h2><font color="#00B2FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Document creation</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To create a new text document using the method </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksCreateDocument</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksDocumentTxt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The following is its prototype.</font></font><br>
<br>
<pre><code class="plaintext hljs">BOOL ksCreateDocument (<font></font>
LPDISPATCH par<font></font>
);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The only parameter of this method is the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksTextDocumentParam</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface </font><font style="vertical-align: inherit;">, which sets the parameters of the created document. </font><font style="vertical-align: inherit;">If successful, the method returns </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and in case of an error, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The following is the source code for a program demonstrating the creation of a new text document.</font></font><br>
<br>
<pre><code class="plaintext hljs">//  <font></font>
TextDocumentParamPtr textDocumentParam;<font></font>
textDocumentParam=static_cast&lt;TextDocumentParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextDocumentParam));<font></font>
textDocumentParam-&gt;Init();<font></font>
textDocumentParam-&gt;set_type(lt_DocTxtStandart);<font></font>
<font></font>
//  <font></font>
StandartSheetPtr standartSheet;<font></font>
standartSheet = static_cast&lt;StandartSheetPtr&gt;(textDocumentParam-&gt;GetSheetParam());<font></font>
standartSheet-&gt;set_format(ksFormatA4);<font></font>
<font></font>
// <font></font>
DocumentTxtPtr documentTxt;<font></font>
documentTxt = static_cast&lt;DocumentTxtPtr&gt;(kompas-&gt;DocumentTxt());<font></font>
documentTxt-&gt;ksCreateDocument(textDocumentParam);<font></font>
<font></font>
// <font></font>
standartSheet.Unbind();<font></font>
textDocumentParam.Unbind();<font></font>
documentTxt.Unbind();<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/dx/ku/op/dxkuopwqevlznzcxuq8ajbcdk4o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a result of the work of this program, a new text document will be created in KOMPAS. </font><font style="vertical-align: inherit;">It may seem that KOMPAS did not create any design for it, but this is not so. </font><font style="vertical-align: inherit;">It is necessary to click on the button “Display Design” on the COMPASS toolbar, as the main inscription appears. </font><font style="vertical-align: inherit;">The figure below shows a fragment of the KOMPAS window with the “Display Appearance” button and the created text document.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/r0/ew/3s/r0ew3sy4irvaq5rtnqzbb0kwtxs.png"><br>
<br>
<h2><font color="#00B2FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Number of sheets and title block</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Method </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksGetDocumentPagesCount ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksDocumentTxt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> returns the number of pages in the document. It has no input parameters. If </font><font style="vertical-align: inherit;">no document (open or created) is associated </font><font style="vertical-align: inherit;">with the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksDocumentTxt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface </font><font style="vertical-align: inherit;">, then the method returns </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zero</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Method </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetStamp ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksDocumentTxt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> returns the interface </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksStamp</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , describing the title block (considered at the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lessons). The method has no input parameters. The resulting </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksStamp</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface </font><font style="vertical-align: inherit;">describes the </font><b><font style="vertical-align: inherit;">title block of</font></b><font style="vertical-align: inherit;"> the first sheet of the document. </font><b><font style="vertical-align: inherit;">GetStampEx</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Method</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allows you to get the title block of any sheet of the document. </font><font style="vertical-align: inherit;">As the only parameter, it takes the sheet number, the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">title block</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface ( </font><b><font style="vertical-align: inherit;">ksStamp</font></b><font style="vertical-align: inherit;"> ) of which we want to get. </font><font style="vertical-align: inherit;">Numbering of sheets is from 1 (per unit).</font></font><br>
<br>
<h2><font color="#00B2FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Document closing</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To close a text document using the method </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksCloseDocument ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksDocumentTxt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">It has no input parameters and, if successful, returns true, and in case of an error, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Note that the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksCloseDocument ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">does not save the document.</font></font><br>
<br>
<h2><font color="#00B2FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saving a document</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Several methods are provided </font><font style="vertical-align: inherit;">
for saving a document in the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksDocumentTxt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksSaveDocument</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">saves the document at the specified path. As the only parameter, it takes a string containing the full path to the file to which the document should be saved. If successful, it returns </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and in case of an error, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . The file is saved in the version of the used KOMPAS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksSaveDocumentExEx</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">allows </font><b><font style="vertical-align: inherit;">you</font></b><font style="vertical-align: inherit;"> to choose in which version to save the document. The following is a prototype of this method.</font></font><br>
<br>
<pre><code class="plaintext hljs">BOOL ksSaveDocumentEx (<font></font>
BSTR fileName,	//   <font></font>
long saveMode	//  <font></font>
);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In contrast to the method </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksSaveDocument</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> here to add a parameter </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">saveMode</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Its valid values ​​are shown in the table below. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pr/d0/pd/prd0pdijfbdvjaf6detb1rbg5f0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If successful, the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksSaveDocumentExEx</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">returns </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and in case of an error, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SaveAsToRasterFormat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">saves the document in raster format. The following is its prototype:</font></font><br>
<br>
<pre><code class="plaintext hljs">BOOL SaveAsToRasterFormat (<font></font>
BSTR fileName,		//   <font></font>
LPDISPATCH rasterPar	//    <font></font>
);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saving parameters in raster format are set using the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksRasterFormatParam</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface </font><font style="vertical-align: inherit;">(discussed in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lesson 6 of the</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cycle). If successful, the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SaveAsToRasterFormat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">returns </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and in case of an error, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For interface </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksRasterFormatParam</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> need to use the method </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RasterFormatParam ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksDocumentTxt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . This method has no input parameters and returns the interface of the save parameters in a raster format. In case of an error, it returns </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULL</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><b><font style="vertical-align: inherit;">SaveAsToUncompressedRasterFormat</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Method</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">saves the document in raster format without compression. </font><font style="vertical-align: inherit;">It has the same prototype as the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SaveAsToRasterFormat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">If successful, the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SaveAsToUncompressedRasterFormat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">returns </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and in case of an error, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font color="#00B2FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Document Filling</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unfortunately, the version 5 interface API discussed in our article series does not contain the means to populate a text document. </font><font style="vertical-align: inherit;">To do this, you need to use the APIs of version 7 interfaces. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In this lesson we got acquainted with text documents. </font><font style="vertical-align: inherit;">API version 5 allows you to open, create and save text documents, but not edit their contents. </font><font style="vertical-align: inherit;">In subsequent tutorials in the series, we will no longer return to text documents. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To be continued, follow the news of the blog. </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/web/595/eee/f27/595eeef271b24830b3578751fcb52716.png"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sergey Norseev, Ph.D., author of the book "Application Development for COMPAS in Delphi."</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en488756/index.html">How to work with the Google Sheets API (Google Sheets API v4) in R using the new googlesheets4 package</a></li>
<li><a href="../en488758/index.html">DEFCON Conference 27. Internet Scam Recognition</a></li>
<li><a href="../en488762/index.html">Elegant asynchronous programming with promises</a></li>
<li><a href="../en488766/index.html">Art and Technology: University of Massachusetts Lowell</a></li>
<li><a href="../en488768/index.html">Bloody hell, or How to swear in English to be mistaken for a cultured person</a></li>
<li><a href="../en488776/index.html">Accessibility Enhancements in Visual Studio 2019 for Mac</a></li>
<li><a href="../en488778/index.html">Data structures: a list that can do everything *</a></li>
<li><a href="../en488780/index.html">Mozilla lost in the browser war, but still believes it could save the Internet</a></li>
<li><a href="../en488782/index.html">How do you like this dependency management option in Python?</a></li>
<li><a href="../en488784/index.html">Commercialization of free software improvements under Copyleft licenses</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>