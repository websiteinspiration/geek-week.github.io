<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐬 🎅🏾 🧜 Pythonでマルチスレッドとマルチプロセッシングを使用する理由、時期、方法 🏜️ ⬛️ 🍋</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="敬礼、ハブロフスク。現在、OTUSは機械学習コースのセットを公開しています。これに関連して、非常に興味深い「おとぎ話」を1つ翻訳しました。行け。
 
 
 
 むかしむかし、遠く、遠い銀河の中に… 
 
 砂漠の真ん中にある小さな村に、賢く力強い魔法使いが住んでいました。そして、彼らの名前はダンブル...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Pythonでマルチスレッドとマルチプロセッシングを使用する理由、時期、方法</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/501056/"><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">敬礼、ハブロフスク。</font><font style="vertical-align: inherit;">現在、OTUSは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機械学習</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コースのセットを公開し</font><font style="vertical-align: inherit;">ています。これに関連して、非常に興味深い「おとぎ話」を1つ翻訳しました。</font><font style="vertical-align: inherit;">行け。</font></font></i></b><br>
<br>
<img src="https://habrastorage.org/webt/mi/su/ev/misuevluvampqjc3br79pgtgscg.png"><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
むかしむかし、遠く、遠い銀河の中に… </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
砂漠の真ん中にある小さな村に、賢く力強い魔法使いが住んでいました。</font><font style="vertical-align: inherit;">そして、彼らの名前はダンブルダルフでした。</font><font style="vertical-align: inherit;">彼は賢明で強力だっただけでなく、遠くの国から来た人々が魔法使いに助けを求めるのを助けました。</font><font style="vertical-align: inherit;">私たちの物語は、一人の旅行者が魔法使いに魔法の巻物を持ってきたときに始まりました。</font><font style="vertical-align: inherit;">旅行者は巻物の内容を知りませんでした。彼が知っているのは、巻物のすべての秘密を誰かが明らかにできれば、これはダンブルダルフだということだけでした。</font></font><a name="habracut"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第1章：シングルスレッド、シングルプロセス</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あなたがまだ推測していないのであれば、私はプロセッサとその機能の類比を描きました。</font><font style="vertical-align: inherit;">私たちのウィザードはプロセッサーであり、スクロールはそれを習得するためのPythonの能力と知識につながるリンクのリストです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ウィザードが難なくリストを解読した最初の考えは、彼の忠実な友人（ギャリボーン？</font></font><br>
<br>
<pre><code class="python hljs">In [<span class="hljs-number">1</span>]:
<span class="hljs-keyword">import</span> urllib.request
<span class="hljs-keyword">from</span> concurrent.futures <span class="hljs-keyword">import</span> ThreadPoolExecutor<font></font>
In [<span class="hljs-number">2</span>]:<font></font>
urls = [<font></font>
  <span class="hljs-string">'http://www.python.org'</span>,
  <span class="hljs-string">'https://docs.python.org/3/'</span>,
  <span class="hljs-string">'https://docs.python.org/3/whatsnew/3.7.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/tutorial/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/library/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/reference/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/using/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/howto/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/installing/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/distributing/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/extending/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/c-api/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/faq/index.html'</span><font></font>
  ]<font></font>
In [<span class="hljs-number">3</span>]:<font></font>
%%time<font></font>
<font></font>
results = []<font></font>
<span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> urls:
    <span class="hljs-keyword">with</span> urllib.request.urlopen(url) <span class="hljs-keyword">as</span> src:<font></font>
        results.append(src)<font></font>
<font></font>
CPU times: user <span class="hljs-number">135</span> ms, sys: <span class="hljs-number">283</span> µs, total: <span class="hljs-number">135</span> ms<font></font>
Wall time: <span class="hljs-number">12.3</span> s<font></font>
In [ ]:<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、forループを使用してURLを1つずつ繰り返し、答えを読み取るだけです。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%%時間</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IPython</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の魔法の</font><font style="vertical-align: inherit;">おかげ</font><font style="vertical-align: inherit;">で、私は悲しいインターネットで約12秒かかったことがわかります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第2章：マルチスレッド</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ウィザードが彼の知恵で有名だったのには理由がなかったわけではなく、彼ははるかに効果的な方法をすぐに思いつくことができました。一人一人を順番に各場所に送る代わりに、信頼できる仲間のチームを集めて、それらを同時に世界のさまざまな部分に送りませんか？ウィザードは、彼らが持っているすべての知識を一度に統合することができます！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そうです、ループ内のリストを順番に見るのではなく、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マルチスレッド</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">して一度に複数のURLにアクセスできます。</font></font><br>
<br>
<pre><code class="python hljs">In [<span class="hljs-number">1</span>]:
<span class="hljs-keyword">import</span> urllib.request
<span class="hljs-keyword">from</span> concurrent.futures <span class="hljs-keyword">import</span> ThreadPoolExecutor<font></font>
In [<span class="hljs-number">2</span>]:<font></font>
urls = [<font></font>
  <span class="hljs-string">'http://www.python.org'</span>,
  <span class="hljs-string">'https://docs.python.org/3/'</span>,
  <span class="hljs-string">'https://docs.python.org/3/whatsnew/3.7.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/tutorial/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/library/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/reference/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/using/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/howto/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/installing/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/distributing/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/extending/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/c-api/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/faq/index.html'</span><font></font>
  ]<font></font>
In [<span class="hljs-number">4</span>]:<font></font>
%%time<font></font>
<font></font>
<span class="hljs-keyword">with</span> ThreadPoolExecutor(<span class="hljs-number">4</span>) <span class="hljs-keyword">as</span> executor:<font></font>
    results = executor.map(urllib.request.urlopen, urls)<font></font>
<font></font>
CPU times: user <span class="hljs-number">122</span> ms, sys: <span class="hljs-number">8.27</span> ms, total: <span class="hljs-number">130</span> ms<font></font>
Wall time: <span class="hljs-number">3.83</span> s<font></font>
In [<span class="hljs-number">5</span>]:<font></font>
%%time<font></font>
<font></font>
<span class="hljs-keyword">with</span> ThreadPoolExecutor(<span class="hljs-number">8</span>) <span class="hljs-keyword">as</span> executor:<font></font>
    results = executor.map(urllib.request.urlopen, urls)<font></font>
<font></font>
CPU times: user <span class="hljs-number">122</span> ms, sys: <span class="hljs-number">14.7</span> ms, total: <span class="hljs-number">137</span> ms<font></font>
Wall time: <span class="hljs-number">1.79</span> s<font></font>
In [<span class="hljs-number">6</span>]:<font></font>
%%time<font></font>
<font></font>
<span class="hljs-keyword">with</span> ThreadPoolExecutor(<span class="hljs-number">16</span>) <span class="hljs-keyword">as</span> executor:<font></font>
    results = executor.map(urllib.request.urlopen, urls)<font></font>
<font></font>
CPU times: user <span class="hljs-number">143</span> ms, sys: <span class="hljs-number">3.88</span> ms, total: <span class="hljs-number">147</span> ms<font></font>
Wall time: <span class="hljs-number">1.32</span> s<font></font>
In [ ]:<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ずっといい！ほとんど…魔法のようです。複数のスレッドを使用すると、多くのI / Oタスクを大幅に高速化できます。私の場合、URLの読み取りに費やされた時間のほとんどは、ネットワーク遅延によるものです。 I / Oに関連付けられたプログラムは、入力または出力のために、彼らの人生の大部分を待っています。これは、ネットワーク、データベース、ファイル、またはユーザーからの入力/出力です。ソースがデータをI / Oに転送する前にソースが前処理を実行する必要がある場合があるため、このようなI / Oには通常長い時間がかかります。たとえば、プロセッサは、ネットワーク接続がデータを送信するよりもはるかに速くカウントします（およその速度で）フラッシュと祖母のように）。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><code>multithreading</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Webページのクリーニングなどのタスクで非常に役立ちます。</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第3章：マルチプロセッシング</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
年が経つにつれ、良いウィザードの名声が高まり、それとともに1人の公平なダークウィザード（Sarmort？または多分Volandeman？）の羨望が高まりました。</font><font style="vertical-align: inherit;">計り知れない狡猾さと武装した嫉妬に武装したダークウィザードは、ダンブルダルフに恐ろしい呪いをかけました。</font><font style="vertical-align: inherit;">呪いが彼を追い抜いたとき、ダンブルダルフは彼を追い払うのにほんの少しの時間しかないことに気づきました。</font><font style="vertical-align: inherit;">必死で、彼は自分の呪文の本をじっくり調べて、すぐにうまくいくはずの反呪文を見つけました。</font><font style="vertical-align: inherit;">唯一の問題は、ウィザードが1,000,000未満のすべての素数の合計を計算する必要があることでした。もちろん奇妙な呪文ですが、私たちが持っているものです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ウィザードは、十分な時間があれば、値を計算することは簡単であることを知っていましたが、その贅沢はありませんでした。彼は偉大な魔法使いであるという事実にもかかわらず、彼は人間性に制限されており、一度に1つの数字しか単純さを確認できません。素数を次々と単純に足していくとしたら、時間がかかりすぎる。カウンタースペルを適用するまでに数秒しかなかったとき、彼は</font><font style="vertical-align: inherit;">何年も前に魔法の巻物から学んだ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マルチプロセッシング</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スペルを突然思い出しました</font><font style="vertical-align: inherit;">。この呪文により、彼は自分のコピー間で数字を分配し、同時にいくつかをチェックするために自分をコピーすることができます。そして結局、彼がする必要があるのは、彼と彼のコピーが発見する数を単に足すことだけです。</font></font><br>
<br>
<pre><code class="python hljs">In [<span class="hljs-number">1</span>]:
<span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> Pool<font></font>
In [<span class="hljs-number">2</span>]:
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">if_prime</span>(<span class="hljs-params">x</span>):</span>
    <span class="hljs-keyword">if</span> x &lt;= <span class="hljs-number">1</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
    <span class="hljs-keyword">elif</span> x &lt;= <span class="hljs-number">3</span>:
        <span class="hljs-keyword">return</span> x
    <span class="hljs-keyword">elif</span> x % <span class="hljs-number">2</span> == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> x % <span class="hljs-number">3</span> == <span class="hljs-number">0</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
    i = <span class="hljs-number">5</span>
    <span class="hljs-keyword">while</span> i**<span class="hljs-number">2</span> &lt;= x:
        <span class="hljs-keyword">if</span> x % i == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> x % (i + <span class="hljs-number">2</span>) == <span class="hljs-number">0</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
        i += <span class="hljs-number">6</span>
    <span class="hljs-keyword">return</span> x<font></font>
In [<span class="hljs-number">17</span>]:<font></font>
%%time<font></font>
<font></font>
answer = <span class="hljs-number">0</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1000000</span>):<font></font>
    answer += if_prime(i)<font></font>
<font></font>
CPU times: user <span class="hljs-number">3.48</span> s, sys: <span class="hljs-number">0</span> ns, total: <span class="hljs-number">3.48</span> s<font></font>
Wall time: <span class="hljs-number">3.48</span> s<font></font>
In [<span class="hljs-number">18</span>]:<font></font>
%%time<font></font>
<font></font>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-keyword">with</span> Pool(<span class="hljs-number">2</span>) <span class="hljs-keyword">as</span> p:<font></font>
        answer = sum(p.map(if_prime, list(range(<span class="hljs-number">1000000</span>))))<font></font>
<font></font>
CPU times: user <span class="hljs-number">114</span> ms, sys: <span class="hljs-number">4.07</span> ms, total: <span class="hljs-number">118</span> ms<font></font>
Wall time: <span class="hljs-number">1.91</span> s<font></font>
In [<span class="hljs-number">19</span>]:<font></font>
%%time<font></font>
<font></font>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-keyword">with</span> Pool(<span class="hljs-number">4</span>) <span class="hljs-keyword">as</span> p:<font></font>
        answer = sum(p.map(if_prime, list(range(<span class="hljs-number">1000000</span>))))<font></font>
<font></font>
CPU times: user <span class="hljs-number">99.5</span> ms, sys: <span class="hljs-number">30.5</span> ms, total: <span class="hljs-number">130</span> ms<font></font>
Wall time: <span class="hljs-number">1.12</span> s<font></font>
In [<span class="hljs-number">20</span>]:<font></font>
%%timeit<font></font>
<font></font>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-keyword">with</span> Pool(<span class="hljs-number">8</span>) <span class="hljs-keyword">as</span> p:<font></font>
        answer = sum(p.map(if_prime, list(range(<span class="hljs-number">1000000</span>))))<font></font>
<font></font>
<span class="hljs-number">729</span> ms ± <span class="hljs-number">3.02</span> ms per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)<font></font>
In [<span class="hljs-number">21</span>]:<font></font>
%%timeit<font></font>
<font></font>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-keyword">with</span> Pool(<span class="hljs-number">16</span>) <span class="hljs-keyword">as</span> p:<font></font>
        answer = sum(p.map(if_prime, list(range(<span class="hljs-number">1000000</span>))))<font></font>
<font></font>
<span class="hljs-number">512</span> ms ± <span class="hljs-number">39.8</span> ms per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)<font></font>
In [<span class="hljs-number">22</span>]:<font></font>
%%timeit<font></font>
<font></font>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-keyword">with</span> Pool(<span class="hljs-number">32</span>) <span class="hljs-keyword">as</span> p:<font></font>
        answer = sum(p.map(if_prime, list(range(<span class="hljs-number">1000000</span>))))<font></font>
<font></font>
<span class="hljs-number">518</span> ms ± <span class="hljs-number">13.3</span> ms per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)<font></font>
In [<span class="hljs-number">23</span>]:<font></font>
%%timeit<font></font>
<font></font>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-keyword">with</span> Pool(<span class="hljs-number">64</span>) <span class="hljs-keyword">as</span> p:<font></font>
        answer = sum(p.map(if_prime, list(range(<span class="hljs-number">1000000</span>))))<font></font>
<font></font>
<span class="hljs-number">621</span> ms ± <span class="hljs-number">10.5</span> ms per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)<font></font>
In [ ]:</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最新のプロセッサーには複数のコアがあるため、マルチプロセス処理モジュール</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">multiprocessing</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用してタスクを高速化できます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">プロセッサに関連付けられたタスクは、ほとんどの場合、プロセッサ上で計算（簡単な数学的計算、画像処理など）を実行するプログラムです。</font><font style="vertical-align: inherit;">計算を互いに独立して実行できる場合は、使用可能なプロセッサコア間で計算を分割する機会があり、それによって処理速度が大幅に向上します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あなたがしなければならないすべてはです：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">適用する関数を決定します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数が適用される要素のリストを準備します。</font></font></li>
<li>    <code>multiprocessing.Pool</code>. ,     <code>Pool()</code>,     .   <code>with</code> ,         .</li>
<li>     Pool    <code>map</code>.    map  ,    ,    .</li>
</ol><br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：関数は、並行して実行できるタスクを実行するように定義できます。たとえば、関数には、計算の結果をファイルに書き込むコードを含めることができます。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
では、なぜ我々は分離する必要があります</font></font><code>multiprocessing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>multithreading</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">？マルチスレッドを使用してプロセッサ上のタスクのパフォーマンスを向上させようとしたことがある場合、結果はまったく逆になります。ひどい！それがどのように起こったか見てみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ウィザードが人間の性質によって制限され、単位時間あたり1つの数値しか計算できないように、Pythonには</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グローバルインタープリターロック（GIL）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼ばれるものが付属してい</font><font style="vertical-align: inherit;">ます。 Pythonはあなたが好きなだけ多くのスレッドをスポーンさせてくれますが、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GIL</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これらのスレッドの1つだけが常に実行されるようにします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I / Oに関連するタスクの場合、この状況は完全に正常です。 1つのスレッドが1つのURLに要求を送信し、応答を待機する場合のみ、このスレッドを別のスレッドに置き換えることができます。これにより、別の要求が別のURLに送信されます。スレッドは応答を受信するまで何もする必要がないため、特定の時間に実行されているスレッドが1つだけであることは変わりません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロセッサ上で実行されるタスクの場合、複数のスレッドを持つことは、鎧の乳首と同じくらい役に立ちません。単位時間あたりに実行できるスレッドは1つだけなので、複数を生成する場合でも、それぞれに番号を割り当てて単純化を確認しますが、プロセッサは1つのスレッドのみで動作します。実際、これらの番号は1つずつチェックされます。また、複数のスレッドを処理するオーバーヘッドはパフォーマンスを低下させるのに役立ち</font></font><code>multithreading</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。これは、プロセッサーで実行</font><font style="vertical-align: inherit;">さ</font><font style="vertical-align: inherit;">れるタスクで</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">した</font><font style="vertical-align: inherit;">ときに観察でき</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この「制限」を回避するには、モジュールを使用します</font></font><code>multiprocessing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。スレッドを使用する代わりに、マルチプロセッシングは、あなたが言うようにいくつかのプロセスを使用します。各プロセスは独自の個人用インタープリターとメモリー空間を取得するため、GILはあなたを制限しません。実際、各プロセスは独自のプロセッサコアを使用し、独自の一意の番号で動作します。これは、他のプロセスの動作と同時に実行されます。なんて素敵なんだ！</font><font style="vertical-align: inherit;">通常のforループに比べて</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用</font></font><code>multiprocessing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すると</font><font style="vertical-align: inherit;">、CPUの負荷が高くなることに気づくかもしれません</font></font><code>multithreading</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これは、プログラムが1つのコアではなく複数のコアを使用しているために発生します。そして、これは良いです！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
覚えておいてください</font></font><code>multiprocessing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">複数のプロセスを管理するという独自のオーバーヘッドがあり、通常はマルチスレッドのコストよりも深刻です。 （マルチプロセッシングは別々のインタープリターを生成し、各メモリー領域を各プロセスに割り当てるため、そうです！）つまり、原則として、この方法でやりたい場合は、軽量バージョンのマルチスレッドを使用することをお勧めします（I / Oに関連するタスクについて覚えておいてください）。ただし、プロセッサでの計算がボトルネックになると、モジュールの時間になります</font></font><code>multiprocessing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。しかし、大きな力には大きな責任が伴うことを忘れないでください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロセッサーが単位時間あたりに処理できるよりも多くのプロセスを生成すると、パフォーマンスが低下し始めることがわかります。</font><font style="vertical-align: inherit;">これは、より多くのプロセスがあるため、オペレーティングシステムがプロセッサコア間でプロセスをシャッフルすることにより、より多くの作業を行う必要があるために発生します。</font><font style="vertical-align: inherit;">実際には、すべてを今日お話ししたよりもさらに複雑になる可能性がありますが、私は主なアイデアを伝えました。</font><font style="vertical-align: inherit;">たとえば、私のシステムでは、プロセス数が16になるとパフォーマンスが低下します。これは、プロセッサに論理コアが16しかないためです。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第4章：まとめ</font></font></h3><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I / Oに関連するタスクで</font></font><code>multithreading</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、パフォーマンスを向上させる</font><font style="vertical-align: inherit;">こと</font><font style="vertical-align: inherit;">ができます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I / Oに関連するタスク</font></font><code>multiprocessing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">では、生産性を向上させることもできますが、コストは原則としてを使用する場合よりも高くなり</font></font><code>multithreading</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python GILの存在により、プログラムでは常に1つのスレッドしか実行できないことが明らかになります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロセッサに関連するタスクでは、使用</font></font><code>multithreading</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">するとパフォーマンスが低下</font><font style="vertical-align: inherit;">する</font><font style="vertical-align: inherit;">可能性があります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロセッサ関連のタスクでは、使用</font></font><code>multiprocessing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">するとパフォーマンスが向上します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウィザードは素晴らしいです！</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それは私達が私達に紹介終了する場所である</font></font><code>multithreading</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>multiprocessing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pythonで</font><font style="vertical-align: inherit;">今日を</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">さあ、勝ちましょう！</font></font><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「グラフ分析とオープンデータの解析を使用したCOVID-19のモデリング。」</font><font style="vertical-align: inherit;">無料レッスン。</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja501044/index.html">馬鹿のために人々を拘束しないでください、またはエンジニアリングの背景を持つ人がセルタワーを焼くことができる理由（ビデオ）</a></li>
<li><a href="../ja501046/index.html">確かな利点について：会議のトップ10レポートC ++ Russia 2019 Piter</a></li>
<li><a href="../ja501048/index.html">OpenVPN上のリモートワークSMB組織の組織</a></li>
<li><a href="../ja501050/index.html">LabVIEW Community Editionをインストールしてアクティブ化します</a></li>
<li><a href="../ja501052/index.html">中国の宇宙船の復活</a></li>
<li><a href="../ja501058/index.html">Teamcenter Rapid Startソリューションは、産業機器メーカーが設計時間を25％削減するのに役立ちます</a></li>
<li><a href="../ja501060/index.html">JetBrains .NET Days Online、5月13〜14日</a></li>
<li><a href="../ja501062/index.html">PHPロシアの外国人スピーカーによる無料オンライン部分のすべてのレポートは、翻訳で表示できます。</a></li>
<li><a href="../ja501064/index.html">中国の実験船の飛行へ。インフォグラフィックとコラージュ。</a></li>
<li><a href="../ja501068/index.html">ディープフェイクとディープメディア：セキュリティの新たな戦場</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>