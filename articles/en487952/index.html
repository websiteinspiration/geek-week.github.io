<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✋🏾 🧑🏽‍🤝‍🧑🏼 👷🏼 Everything you wanted to know about scope in Python, but were embarrassed to ask 🏨 👉 ✊</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In anticipation of the start of a new thread on the course "Python Developer" , we decided to talk about scope in Python. What came of this? - Read th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Everything you wanted to know about scope in Python, but were embarrassed to ask</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/487952/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In anticipation of the start of a new thread on the course </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Python Developer"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , we decided to talk about scope in Python. </font><font style="vertical-align: inherit;">What came of this? </font><font style="vertical-align: inherit;">- Read the material below.</font></font></i><br>
 <br>
<img src="https://habrastorage.org/webt/cn/j6/vg/cnj6vg7ccptaiwngx4ghv5lktps.png"><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Today we will talk about important theoretical foundations that must be understood and remembered in order to write competent, readable and beautiful code. </font><font style="vertical-align: inherit;">We will talk about the scope of variables. </font><font style="vertical-align: inherit;">This article will be useful not only for beginners, but also for experienced programmers who came to Python from another language and want to understand its mechanics.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Scopes determine in which part of the program we can work with a particular variable, and from which the variable is “hidden”. </font><font style="vertical-align: inherit;">It is extremely important to understand how to use only those values ​​and variables that we need, and how the language interpreter behaves. </font><font style="vertical-align: inherit;">We’ll also see how to circumvent the restrictions imposed by scope on actions with variables. </font><font style="vertical-align: inherit;">In Python, there are as many as 3 scopes:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Local</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Global</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nonlocal</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The last, nonlocal scope, was added in Python 3. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usually, we are talking about scope when familiar with functions. </font><font style="vertical-align: inherit;">Using their example, we will consider the work of the scope of variables.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Local scope</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consider a function that displays a list </font></font><code>some_list</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">element by element:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">print_list</span>(<span class="hljs-params">some_list</span>):</span><font></font>
    <span class="hljs-keyword">for</span> element <span class="hljs-keyword">in</span> some_list:<font></font>
        print(element)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here </font></font><code>element</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>some_list</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">are local variables that are visible only inside the function, and which cannot be used outside it with the values ​​that were assigned to them inside the function during its operation. </font><font style="vertical-align: inherit;">That is, if we call in the main body of the program </font></font><code>print(element)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, we get an error:</font></font><br>
<br>
<pre><code class="python hljs">NameError: name <span class="hljs-string">'element'</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> defined</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now we will do the following:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">print_list</span>(<span class="hljs-params">some_list</span>):</span><font></font>
    <span class="hljs-keyword">for</span> element <span class="hljs-keyword">in</span> some_list:<font></font>
        print(element) <font></font>
<font></font>
element = <span class="hljs-string">'q'</span><font></font>
print_list([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])<font></font>
print(element) </code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And we get:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-number">1</span><font></font>
<span class="hljs-number">2</span><font></font>
<span class="hljs-number">3</span><font></font>
q</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here the variable </font></font><code>element</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inside the function and the variable with the same name outside it are two different variables, their values ​​do not cross and do not interchange. </font><font style="vertical-align: inherit;">They are called the same, but refer to different objects in memory. </font><font style="vertical-align: inherit;">Moreover, a variable named element inside the function lives as long as the function is executed and no more. </font><font style="vertical-align: inherit;">But be careful in order to give local and global variables the same name, now I will show why:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">print_list</span>(<span class="hljs-params">some_list</span>):</span><font></font>
    <span class="hljs-keyword">for</span> element <span class="hljs-keyword">in</span> sudden_list:<font></font>
        print(element) <font></font>
<font></font>
sudden_list = [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]<font></font>
print_list([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Result:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-number">0</span><font></font>
<span class="hljs-number">0</span><font></font>
<span class="hljs-number">0</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Please note that the interpreter did not indicate errors to us. And all because it </font></font><code> sudden_list</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is in the global scope, that is, from the inside of the function </font></font><code>print_list</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">we can access it, because from the inside you can see what is happening outside. For the reason of such mechanics of work, try to name local variables inside the function differently from what you call variables in the global scope. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is important to talk about constants here. There is no difference to the Python interpreter what you call a variable, so the code above would be better rewritten as follows:</font></font><br>
<br>
<pre><code class="python hljs">SUDDEN_LIST = [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">print_list</span>(<span class="hljs-params">some_list</span>):</span><font></font>
    <span class="hljs-keyword">for</span> element <span class="hljs-keyword">in</span> SUDDEN_LIST:<font></font>
        print(element) <font></font>
<font></font>
print_list([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]) </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now everything is in place. </font><font style="vertical-align: inherit;">The thing is, in Python you cannot somehow strictly define a constant as an object that should not be modified. </font><font style="vertical-align: inherit;">So the way you use the value of a variable whose name is written in capital letters remains only on your conscience. </font><font style="vertical-align: inherit;">Another question is that in this way the recorded variable will make it clear to whoever reads your code that the variable will not change anywhere. </font><font style="vertical-align: inherit;">Or at least it shouldn't.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Global scope</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Python has a keyword </font></font><code>global</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that allows you to change the value of a global variable from within a function. </font><font style="vertical-align: inherit;">It is written before the variable name, which will be considered global inside the function. </font><font style="vertical-align: inherit;">As you can see from the example, now the value of the variable is </font></font><code>candy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">increasing, and note that we do not pass it as an argument to the function </font></font><code>get_candy()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
 <br>
<pre><code class="python hljs">candy = <span class="hljs-number">5</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_candy</span>():</span><font></font>
    <span class="hljs-keyword">global</span> candy <font></font>
    candy += <span class="hljs-number">1</span><font></font>
    print(<span class="hljs-string">'  {} .'</span>.format(candy))<font></font>
    <font></font>
get_candy()<font></font>
get_candy()<font></font>
print(candy)</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a result, we get:</font></font><br>
<br>
<pre><code class="python hljs"><font></font>
	  <span class="hljs-number">6</span> .<font></font>
  <span class="hljs-number">7</span> .<font></font>
<span class="hljs-number">7</span><font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, changing the value of a global variable from within the function is not the best practice, and it is better not to do so, because it does not contribute to code readability. </font><font style="vertical-align: inherit;">The smaller what happens inside the function will depend on the global scope, the better. </font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Life hack</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : In order not to suffer from the naming of variables, you can put the main program code into a function </font></font><code>main()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, then all the variables that will be declared inside this function will remain local and will not spoil the global scope, increasing the likelihood of an error.</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nonlocal scope</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This concept appeared in Python 3 along with the keyword </font></font><code>nonlocal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">The logic of his writing is about the same as that of </font></font><code>global</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">However, </font></font><code>nonlocal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">there is a feature. </font></font><code>Nonlocal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is most often used in nested functions when we want to make the interpreter understand that for a nested function a certain variable is not local, but it is not global in the general sense.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_candy</span>():</span><font></font>
    candy = <span class="hljs-number">5</span><font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">increment_candy</span>():</span> <font></font>
        <span class="hljs-keyword">nonlocal</span> candy<font></font>
        candy += <span class="hljs-number">1</span><font></font>
        <span class="hljs-keyword">return</span> candy<font></font>
    <span class="hljs-keyword">return</span> increment_candy<font></font>
    <font></font>
result = get_candy()()<font></font>
print(<span class="hljs-string">' {} .'</span>.format(result))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Result:</font></font><br>
<br>
<pre><code class="python hljs"> <span class="hljs-number">6</span> .</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How useful it is for you to decide for yourself. </font><font style="vertical-align: inherit;">You can find more examples </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As a conclusion, several rules can be formulated:</font></font></b><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">From within the function are visible variables that have been defined both inside and outside it. </font><font style="vertical-align: inherit;">Variables defined internally are local and externally global.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Outside of functions, no variables defined inside them are visible.</font></font></li>
<li>     ,          <code>global</code>.</li>
<li> <i> </i>    nonlocal    ,      ,       .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
That's all, I hope this material was useful to you, and it shed at least a little light on how the scope works in Python. </font><font style="vertical-align: inherit;">Having dealt with scopes, you will make another ours on the way to creating beautiful and readable code. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I also want to invite everyone to a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">free webinar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from OTUS, where we </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">will study a tool such as type annotation in Python: discuss the reasons why many people underestimate it, consider a number of examples from military practice when type annotation could save or save the situation. </font><font style="vertical-align: inherit;">Let's talk about how and when to implement type checking on your projects</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en487938/index.html">Introducing effector-dom using the example task list</a></li>
<li><a href="../en487940/index.html">Reproducible computing in R. How to separate code and data?</a></li>
<li><a href="../en487944/index.html">Machine learning in the energy sector, or not only everyone can watch tomorrow</a></li>
<li><a href="../en487948/index.html">Two-factor authentication in OpenVPN with Telegram bot</a></li>
<li><a href="../en487950/index.html">How the power engineer studied neural networks and the review of the free course “Udacity: Intro to TensorFlow for Deep Learning”</a></li>
<li><a href="../en487954/index.html">How I abandoned the game after four years of development</a></li>
<li><a href="../en487956/index.html">Just about primes (fast incremental method for calculating primes)</a></li>
<li><a href="../en487958/index.html">Seven DevOps Transformation Archetypes</a></li>
<li><a href="../en487962/index.html">We work with two-dimensional graphics in JavaScript</a></li>
<li><a href="../en487964/index.html">Life after death, or non-gaming incarnation of consoles</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>