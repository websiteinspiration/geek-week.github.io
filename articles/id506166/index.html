<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ’ ğŸ§˜ğŸ» ğŸº Mengkonfigurasi jaringan saraf untuk mendeteksi objek yang diperlukan ğŸ¤— ğŸ’ ğŸ‘¨ğŸ¿â€ğŸ¤â€ğŸ‘¨ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Jaringan saraf adalah algoritma matematika yang kompleks yang membantu memecahkan berbagai masalah. Sebelum digunakan, mereka harus diatur dan dilatih...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Mengkonfigurasi jaringan saraf untuk mendeteksi objek yang diperlukan</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/506166/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/8f/2g/g2/8f2gg2qg7j-d7tzt-iykqfgc0qo.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jaringan saraf adalah algoritma matematika yang kompleks yang membantu memecahkan berbagai masalah. Sebelum digunakan, mereka harus diatur dan dilatih. Pelatihan jaringan saraf cukup lama dan proses komputasi mahal. Namun, ada alat yang melaluinya kita dapat menyederhanakan masalah ini. Hari ini kita akan mempertimbangkan proses pelatihan ulang jaringan saraf untuk mendeteksi objek tertentu dalam suatu gambar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai contoh, kita akan menggunakan algoritma YOLOv3 untuk mendeteksi objek. Anda dapat menemukan bahan tambahan pada artikel di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">halaman github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Contoh instalasi dan konfigurasi dilakukan pada Windows 10.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama-tama, kita perlu mengunduh atau mengkloning materi yang diperlukan untuk melatih kembali jaringan saraf untuk jenis objek tertentu dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">halaman github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ini </font><font style="vertical-align: inherit;">. Untuk menghindari masalah dengan akses atau izin, lebih baik menempatkan materi di direktori akun Anda, misalnya: C: \ Users \ user_name \ Documents \ NN \. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Buka folder yolov3-master, panggil terminal (baris perintah) dan jalankan perintah pip install -U -r requirement.txt. Ketika perintah dijalankan, beberapa paket tidak diinstal, karena dalam repositori pip untuk windows, paket dengan nama ini tidak ada. Agar instalasi berhasil, di requirement.txt kita perlu mengomentari beberapa paket ("obor&gt; = 1,5" dan "pycocotools"). Kemudian instal pytorch dengan perintah berikut:</font></font><a name="habracut"></a><br>
<br>
<pre><code class="python hljs">pip install torch==<span class="hljs-number">1.5</span><span class="hljs-number">.0</span> torchvision==<span class="hljs-number">0.6</span><span class="hljs-number">.0</span> -f https://download.pytorch.org/whl/torch_stable.html</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Paket pycocotools tidak diperlukan dalam kasus kami. Anda juga perlu mengunduh dan menginstal </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">alat CUDA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sehingga perhitungan Anda dilakukan pada kartu video, yang kadang-kadang meningkatkan kecepatan pelatihan ulang.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Setelah instalasi berhasil diselesaikan, kita dapat mulai menyiapkan data. Agar algoritme berfungsi lebih baik, foto untuk pelatihan harus diambil dari bahan yang akan digunakan pemrosesan. Misalnya, perlu untuk memproses materi video dari kamera pengintai yang dipasang di ruangan tempat objek berada pada sudut yang besar. Dalam situasi seperti itu, akan sangat sulit untuk melatih algoritma untuk mendeteksi objek yang sangat berbeda dari gambar di Internet di mana jaringan saraf dilatih. Dengan demikian, sampel pelatihan dikompilasi baik dari tangkapan layar menggunakan bahan video, atau menggunakan pengambilan gambar manual dengan kamera. Ukuran sampel pelatihan bisa sangat bervariasi, semuanya tergantung pada sifat tugas. Dalam contoh ini, kumpulan data terdiri dari 46 gambar, yang menggambarkan tiga jenis objek (pena, pensil, spidol).Pemotretan dilakukan dengan latar belakang meja dan lembar A4.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. Langkah selanjutnya adalah menandai objek pada gambar. </font><font style="vertical-align: inherit;">Namun, sebelum memulai markup, perlu untuk meningkatkan sampel pelatihan menggunakan beberapa metode augmentasi. </font><font style="vertical-align: inherit;">Ini penting untuk meningkatkan kemampuan jaringan saraf untuk mengenali objek dalam berbagai variasi. </font><font style="vertical-align: inherit;">Beberapa contoh augmentasi dapat ditemukan di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">notebook</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ini </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Setelah menyelesaikan augmentasi, kami menggabungkan gambar asli dengan hasil augmentasi ke dalam satu folder (penting bahwa gambar harus terletak di root folder yolov3_master, misalnya: C: \ Users \ user_name \ Documents \ NN \ yolov3_master \ images \). </font><font style="vertical-align: inherit;">Selanjutnya, menggunakan program labelImg, kita menandai objek, secara berurutan melakukan langkah-langkah berikut:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z5/kt/dd/z5ktddwmvl-ulta3vsbva2macvs.png"><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pilih folder dengan gambar (... \ yolov3_master \ images \);</font></font></li>
<li>    .       labels,       (â€¦.\yolov3_master\labels\);</li>
<li>   c PascalVOC  YOLO;</li>
<li>    ;</li>
<li>   ,     ;</li>
<li>       (Pen, Pencil, Marker),            ;</li>
<li>;</li>
<li> ;</li>
<li>       4 â€“ 8.</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Akibatnya, dokumen teks dengan nama gambar muncul di folder label, yang berisi label kelas dan empat koordinat - nilai dinormalisasi x, y, w, h, yang menggambarkan lokasi persegi panjang untuk setiap objek dalam gambar (1 adalah nomor baris dalam editor Notepad ++ dan tidak berlaku untuk isi dokumen): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7c/t8/ws/7ct8wsuqhzfhzkupfd1ntjyc3j0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4. Selanjutnya, kita perlu membagi sampel yang sudah disiapkan menjadi pelatihan dan yang diuji. Dalam hal ini, perlu untuk membuat 2 dokumen teks (train_112.txt dan test_24.txt), di mana jalur lokasi lengkap untuk setiap gambar akan ditunjukkan. Contoh membuat dokumen dapat ditemukan di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">buku catatan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5. Agar objek yang diinginkan diberi nama, Anda harus membuat file dengan ekstensi .names, misalnya objects.names, di mana nama-nama tersebut terdaftar dalam urutan yang sama seperti yang ditunjukkan dalam kelas.txt dalam folder label. Itu terlihat seperti ini: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ex/0h/g1/ex0hg17zt5nnqgyxn-qoeasf9ak.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya, Anda perlu membuat file dengan ekstensi .data, misalnya conf.data, yang menunjukkan jumlah kelas (dalam contoh ini 3), file dengan nama objek, dan juga file dengan lokasi gambar untuk pelatihan dan sampel uji: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/i-/e8/z6/i-e8z6pmganhasy40yick2wjhx8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
File objek. nama, conf.data, dan file-file selanjutnya harus ditempatkan di direktori berikut: yolov3_master \ data \, setelah sebelumnya menghapus semua file dari itu.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6. Untuk pelatihan ulang, Anda harus mengonfigurasi file konfigurasi, untuk ini dari folder (... \ yolov3_master \ cfg) salin file yolov3-spp.cfg ke folder (... \ yolov3_master \ data). Selanjutnya, Anda perlu mengedit garis (636.643 - 722.729 - 809.816) untuk masing-masing dari tiga lapisan: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gn/ef/w5/gnefw5t095nq8jgbxkopwlmh1um.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di mana, filter = (5 + n) * 3 dan kelas = n. n adalah jumlah kelas (dalam contoh ini 3). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7. Selanjutnya, Anda perlu mengunduh bobot untuk file konfigurasi yang dikonfigurasi. Untuk melakukan ini, </font><font style="vertical-align: inherit;">unduh file yolov3-spp.pt </font><font style="vertical-align: inherit;">dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">halaman</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan letakkan di (... \ yolov3_master \ data). Sebagai contoh, algoritma yolov3-spp digunakan. Namun, ada beberapa variasi algoritma, misalnya, yolov3-tiny, yang merupakan versi ringan dari yolov3-spp. Versi ringan kurang akurat, tetapi kecepatan pemrosesan material jauh lebih tinggi.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8. Kami melanjutkan langsung ke pelatihan ulang algoritma untuk jenis objek Anda. Untuk melakukan ini, di folder ... \ yolov3_master \ jalankan baris perintah dan masukkan perintah berikut:</font></font><br>
<br>
<pre><code class="python hljs">python train.py --cfg data/yolov3-spp.cfg --data data/conf.data --weights data/yolov3-spp.pt --nosave</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah menjalankan perintah, kesalahan dari sifat berikut dapat terjadi: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/or/bg/hk/orbghkbzcmnaktnvp6fhpsnlwgy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mengatasi masalah ini, perlu mengomentari baris dalam file utils.py di folder utils: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/y3/k1/51/y3k151rlmya3guveav5c8o2xk8i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di badan fungsi check_git_status, kami mengomentari semua baris kecuali cetak, di mana kami akan melewati baris apa pun, misalnya, â€œssâ€. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kesalahan dari jenis berikut ini juga dapat muncul: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/0v/t7/1w/0vt71wd0snopl_cvxl17tyyl0gu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kesalahan ini menunjukkan bahwa tidak ada cukup memori kartu video untuk membuat grafik komputasi. Salah satu cara untuk mengatasi masalah ini adalah mengurangi ukuran bets selama pelatihan. Untuk melakukan ini, dalam file (... \ yolov3_master \ train.py) Anda perlu mengubah parameter batch_size, defaultnya adalah 16, ubah ke nilai yang lebih rendah (8 atau 4) kelipatan 4: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/r3/gk/yy/r3gkyy0ua0bfoyae5dmduxn3qtg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda juga dapat meneruskan nilai ini secara eksplisit, menggunakan nilai parameter selama inisialisasi:</font></font><br>
<br>
<pre><code class="python hljs">python train.py --cfg data/yolov3-spp.cfg --data data/conf.data --weights data/yolov3-spp.pt --batch-size <span class="hljs-number">4</span> --nosave</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam contoh di atas, kami menentukan file konfigurasi, file dengan informasi tentang set pelatihan, bobot, dan opsi simpan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parameter --nosave menunjukkan bahwa hanya file final dengan skala yang akan disimpan. Anda juga dapat mengatur mode simpan di file train.py, misalnya, jika Anda ingin menyimpan bobot setiap 400 zaman:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/s3/di/ax/s3diaxobwljgntbmhpnj3lxzoda.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Penting juga untuk menentukan parameter --epochs, jumlah era tergantung pada jenis objek, ukuran sampel pelatihan, dan faktor lainnya. Dalam contoh ini, awalnya ada 46 gambar, menggunakan metode augmentasi set data meningkat menjadi 136, di antaranya 112 adalah sampel pelatihan, 24 adalah sampel uji. Perhitungan dilakukan pada kartu grafis GTX 1060 6 GB. Upaya pertama dilakukan selama 300 era, pelatihan memakan waktu sekitar 2,5 jam. Terungkap akurasi algoritma yang sangat buruk. Upaya kedua dilakukan selama 1200 era, pelatihan memakan waktu ~ 12 jam. Setelah selesai pelatihan, bobot akan disimpan dalam folder (... \ yolov3_master \ weights \) â€‹â€‹- file last.pt. Untuk memeriksa operabilitas algoritma, Anda harus menjalankan perintah berikut:</font></font><br>
<br>
<pre><code class="python hljs">python detect.py --weights weights/last.pt --cfg data/yolov3-spp.cfg --names data/objects.names</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebelum menjalankan perintah, Anda harus menempatkan gambar untuk diproses oleh algoritma di folder (... \ yolov3_master \ data \ samples \). </font><font style="vertical-align: inherit;">Hasilnya akan muncul di folder (... \ yolov3_master \ output \). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nw/vo/bd/nwvobdpaqfbon5cnxlog7hebkgq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan demikian, pelatihan ulang jaringan saraf selesai dilakukan, yang mampu menentukan 80 kelas objek untuk 3 jenis objek baru yang tidak termasuk dalam daftar ini. </font><font style="vertical-align: inherit;">Untuk objek marker, algoritme tidak sepenuhnya akurat, kepercayaan kurang dari 0,5. </font><font style="vertical-align: inherit;">Salah satu alasannya mungkin karena ukuran sampel pelatihan yang kecil </font><font style="vertical-align: inherit;">dalam contoh ini, gambar dengan spidol adalah 26%, sisanya adalah pena dan pensil.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id506148/index.html">Ilmu persepsi warna mengubah hubungan kita dengan layar</a></li>
<li><a href="../id506150/index.html">Hit the SETI: komputasi sukarela untuk skeptis, optimis, dan crunchers canggih</a></li>
<li><a href="../id506152/index.html">Mengumpulkan metrik dari kelas "asing" menggunakan jmx dan javaassist sebagai javaagent</a></li>
<li><a href="../id506158/index.html">useSWR adalah perpustakaan React favorit saya yang baru</a></li>
<li><a href="../id506164/index.html">#nodesigndev: desain oleh tangan pengembang</a></li>
<li><a href="../id506168/index.html">Panduan hebat untuk Google Trends: cara membaca semua statistik ini dan mempelajari cara menangkap tren</a></li>
<li><a href="../id506170/index.html">Tipe data abstrak. Bagian 1: Data (Tipe Data)</a></li>
<li><a href="../id506176/index.html">Ikhtisar Pemindai Creaform 3D</a></li>
<li><a href="../id506178/index.html">Tren Mengubah Masa Depan Pengujian Perangkat Lunak: Opini Ahli</a></li>
<li><a href="../id506180/index.html">Cara memilih daya yang tepat untuk UPS Anda. Kami menganalisis contoh Eaton</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>