<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛱️ 💆🏼 👴 Aplikasi Slack Sederhana untuk Menerbitkan Konten dari Google Sheets 🎣 🍸 🏇</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kami senang mencoba hal-hal baru, dan karenanya sering membagikan tautan ke informasi menarik dari dunia TI dan pemrograman dengan rekan-rekan kami. K...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Aplikasi Slack Sederhana untuk Menerbitkan Konten dari Google Sheets</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/489468/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami senang mencoba hal-hal baru, dan karenanya sering membagikan tautan ke informasi menarik dari dunia TI dan pemrograman dengan rekan-rekan kami. Kami adalah pengguna lama slack dan untuk tautan semacam itu kami memiliki saluran pendidikan terpisah di mana setiap orang dapat menemukan sesuatu yang menarik untuk diri mereka sendiri. Tetapi karena kita adalah orang biasa, secara berkala dalam panasnya pekerjaan kita lupa bahwa kita perlu membagikan tautan ini, dan aktivitas di saluran tersebut memudar, meskipun banyak dari kita memiliki sesuatu untuk dibagikan.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami menghadapi tugas menarik untuk mengembangkan "bot" yang dapat secara otomatis mengambil informasi yang telah dikumpulkan sebelumnya dan membagikan tautan ke sana secara berkala. </font><font style="vertical-align: inherit;">Kami mencari solusi yang sudah jadi di Internet, dan sekarang telah muncul </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sebagai integrasi zapier dan slack</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gb/zc/el/gbzcelbfefmw2trwii1temk6f2a.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun, kami tidak menemukan integrasi seperti itu sebelumnya dan memutuskan untuk menulis sepeda kecil kami sendiri. </font><font style="vertical-align: inherit;">Di bawah ini kami akan menjelaskan bagaimana tepatnya kami melakukannya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketika memikirkan masalah ini, solusi berikut muncul di benak saya: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode Javascript yang menerima informasi tentang tautan berguna yang relevan dari tabel google dan mengirimkannya ke Slack. </font><font style="vertical-align: inherit;">Memanggil skrip dari item pertama di jadwal menggunakan cron. </font><font style="vertical-align: inherit;">Mari kita mulai.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mendapatkan token untuk Slack.</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semuanya sederhana di sini dan telah berulang kali dijelaskan dalam artikel lain, jadi saya hanya akan memberikan deskripsi singkat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada dua opsi: buat aplikasi Slack Anda sendiri atau gunakan legacy token, opsi pertama sedikit lebih rumit, tetapi direkomendasikan oleh Slack, yang kedua lebih sederhana dan sangat cocok untuk kebutuhan kita, karena kesederhanaannya kita akan memilihnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami membuka </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tautan untuk membuat token baru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan membuat token baru untuk ruang kerja yang diinginkan (jangan lupa menyalinnya, token itu dikeluarkan sekali). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bu/fw/bq/bufwbqnmxbfoliu35xk_lky8gtm.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di masa mendatang, ketika menerapkan kode yang berinteraksi dengan Slack API dan Google Sheets, kami akan dapat menggunakan token ini untuk tujuan yang dimaksud. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang Anda perlu mendapatkan token untuk Google Sheets. Pertama, buka </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Node.js Quickstart untuk Google Sheets</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan aktifkan Google Sheets API. </font><font style="vertical-align: inherit;">Kemudian kita menyalin kode index.js dari contoh dan menjalankannya, melalui proses otorisasi dan mendapatkan kredensial dalam file, yang berguna untuk digunakan dengan skrip kami.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementasi skrip</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang saatnya untuk mulai mengembangkan skrip untuk mempublikasikan pesan dari Google Sheets ke Slack. </font><font style="vertical-align: inherit;">Kode skrip lengkap dapat ditemukan dengan mengklik </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tautan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama-tama, kita akan menganalisis bagian dari kode yang mengirim pesan ke saluran slack. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini terjadi dengan memanggil Slack REST API.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> post = <span class="hljs-keyword">async</span> (text, channel = <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">CHANNEL</span> <span class="hljs-attr">ID</span>&gt;</span>) =&gt; {
  const uri = `https://slack.com/api/chat.postMessage?token=${SLACK_AUTH_TOKEN}&amp;channel=${channel}&amp;text=${text}`;
  const result = await fetch(encodeURI(uri), {
    headers: {
      'Content-Type': 'application/json',
    },
    method: 'POST',
    body: JSON.stringify({
      channel,
      text,
      as_user: true
    })
  });

  await result.json();
};
</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk otorisasi di Google API, dua fungsi digunakan (otorisasi, getNewToken), kode yang diambil dari Node.js Quickstart, kami tidak akan membahasnya secara rinci. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Blok kode berikutnya yang menarik adalah mendapatkan informasi untuk dikirim dari Google spreadsheet, ini dilakukan dengan menggunakan fungsi berikut:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> getMessageAndPost = <span class="hljs-keyword">async</span> (auth, spreadsheetId = <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ID</span>  <span class="hljs-attr">Google</span> &gt;</span>) =&gt; {
  const sheets = google.sheets({ version: 'v4', auth });
  sheets.spreadsheets.values.get({
    spreadsheetId,
    range: 'Sheet1!A1:B999',
  }, async (err, res) =&gt; {
    if (err) return console.log('The API returned an error: ' + err);
    const rows = res.data.values;
    if (rows.length) {
      // Print columns A and E, which correspond to indices 0 and 4.
      const ix = rows.findIndex(r =&gt; !r[1]);
      await post(rows[ix][0]);
      sheets.spreadsheets.values.update({
        spreadsheetId: '18VzilQTEDGXBnaH1f_k-uAfa8Mb470gx32Phir6xQT4',
        range: `Sheet1!B${ix + 1}`,
        valueInputOption: 'RAW',
        requestBody: {
          range: `Sheet1!B${ix + 1}`,
          values: [['x']]
        }

      })
    } else {
      console.log('No data found.');
    }
  });
};</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tabel di mana skrip berinteraksi memiliki bentuk berikut: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ty/lr/1r/tylr1rijbae8u53q8qvuwbls5te.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan demikian, untuk di sebelah setiap tautan setelah mengirim pesan ke Slack, skrip menempatkan "x". Jadi, untuk menemukan pesan yang ingin Anda kirim, Anda harus memilih baris pertama, yang belum memiliki "x", ambil pesan, kirim dan tandai baris yang dipilih. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skrip yang baru saja kami bongkar cukup sederhana dan telah mengkonfirmasi kinerjanya selama beberapa tahun di tim kami. Kami hanya perlu menyebarkan skrip ini ke server dan menikmati menggunakannya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk ini, di perusahaan kami, kami menggunakan VPS Ubuntu yang biasa di Digital Ocean (bahkan yang berdaya rendah sekalipun). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama-tama, Anda perlu mengkonfigurasi lingkungan untuk mengeksekusi kode javascript, untuk ini Anda perlu menginstal node.js (</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">panduan instalasi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah itu, konfigurasikan tugas cron untuk memanggil skrip sesuai jadwal:</font></font><br>
<br>
<pre><code class="plaintext hljs">crontab -e<font></font>
<font></font>
#### <font></font>
<font></font>
24 14 * * 1-5 cd /root/google-sheets-to-slack &amp;&amp; node post.js<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan menggunakan pengaturan ini, skrip kami dari folder / root / akan dipanggil setiap hari dari Senin hingga Jumat pukul 14:24. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Penyiapan sudah selesai, tetapi pembaca yang penuh perhatian harus memperhatikan beberapa kekurangan dalam skrip, misalnya, jika ada kesalahan saat memanggil skrip, kita tidak akan pernah mengetahuinya, karena itu akan "diam-diam jatuh" dan itu saja. </font><font style="vertical-align: inherit;">Untuk mengatasi masalah ini, Anda dapat menambahkan penanganan kesalahan dan output dari hasil panggilan skrip ke Google spreadsheet atau file log yang sama. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain itu, alih-alih mengirim pesan pada waktu yang tetap, Anda dapat mengirimnya dengan penundaan acak, sehingga pesan kami lebih seperti pesan dari pengguna "langsung".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gagasan lain yang menarik dari salah satu kolega kami adalah membuat tabel kedua dari mana pesan akan dikirim secara eksklusif pada hari Jumat dan akan lebih menghibur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secara umum, kami melihat banyak sekali ide untuk penyempurnaan dan kami akan secara bertahap mengimplementasikannya, tetapi dalam bentuk yang ada skrip ini keluar cukup bermanfaat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contoh tabel yang dapat digunakan tersedia di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terima kasih telah membaca dan menikmati menggunakan.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id489444/index.html">Ubah alam menjadi hiasan dengan pemindaian 3D</a></li>
<li><a href="../id489452/index.html">Tugas-tugas Microsoft JavaScript</a></li>
<li><a href="../id489456/index.html">Rekomendasi setelah penunjukan ahli bedah gigi</a></li>
<li><a href="../id489460/index.html">UV dua jari</a></li>
<li><a href="../id489464/index.html">"Aku akan kembali!": Bagaimana bahasa Inggris Arnold Schwarzenegger telah berubah lebih dari 50 tahun di AS</a></li>
<li><a href="../id489470/index.html">Potensi kompetitif simulasi seperti Besiege</a></li>
<li><a href="../id489472/index.html">Arsip web: substitusi impor</a></li>
<li><a href="../id489474/index.html">Cara mengompresi model fastText 100 kali</a></li>
<li><a href="../id489476/index.html">Kotak centang styling dan tombol radio menggunakan CSS3</a></li>
<li><a href="../id489482/index.html">Apa yang perlu Anda ketahui jika Anda ingin memanggil fungsi Go dari assembler</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>