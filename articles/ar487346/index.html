<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚝 🧗🏾 👩🏼‍✈️ حالات استخدام أدوات تحليل الشذوذ في الشبكة: كشف التسرب 🚠 📺 🚵🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="في أحد الأحداث ، تبع ذلك مناقشة مثيرة للاهتمام حول فائدة حلول NTA (تحليل حركة مرور الشبكة) ، والتي ، باستخدام البنية التحتية لشبكة القياس عن بعد Netfl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>حالات استخدام أدوات تحليل الشذوذ في الشبكة: كشف التسرب</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/cisco/blog/487346/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">في أحد الأحداث ، تبع ذلك مناقشة مثيرة للاهتمام حول فائدة حلول NTA (تحليل حركة مرور الشبكة) ، والتي ، باستخدام البنية التحتية لشبكة القياس عن بعد Netflow (أو بروتوكولات التدفق الأخرى) ، تجعل من الممكن اكتشاف مجموعة واسعة من الهجمات. جادل معارضوي أنه عند تحليل الرؤوس والمعلومات ذات الصلة (ولا تحلل NTA نص حزمة البيانات ، على عكس أنظمة الكشف عن الهجمات الكلاسيكية ، IDS) ، لا يمكنك رؤية الكثير. في هذه المقالة سأحاول دحض هذا الرأي وجعل المحادثة أكثر جوهرية ، سأعطي بعض الأمثلة الحقيقية عندما تساعد NTA بالفعل في تحديد مختلف الشذوذ والتهديدات المفقودة في المحيط أو حتى بعد المحيط. وسأبدأ بالتهديد الذي جاء أولاً في تصنيف التهديدات في العام الماضي ، وأعتقد أنه سيبقى كذلك هذا العام.سوف يتعلق الأمر بتسريبات المعلومات والقدرة على اكتشافها عبر القياس عن بعد للشبكة.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لن أفكر في الوضع بأيدي أعوج من المسؤولين الذين تركوا الإنترنت يبحثون عن مرونة غير محمية أو MongoDB. دعونا نتحدث عن الإجراءات المستهدفة من المهاجمين ، كما كان الحال مع القصة المشهورة لمكاتب ائتمان Equifax. دعني أذكرك أنه في هذه الحالة ، اخترق المهاجمون أولاً الثغرة الأمنية التي لم يتم إصلاحها لبوابة الويب العامة ، ثم لخوادم قاعدة البيانات الداخلية. وبقيت دون أن يلاحظها أحد منذ عدة أشهر ، وتمكنوا من سرقة البيانات على 146 مليون عميل لمكتب الائتمان. هل يمكن تحديد مثل هذا الحادث باستخدام حلول منع فقدان البيانات؟ على الأرجح لا ، لأن أجهزة DLP الكلاسيكية ليست مصممة خصيصًا لمهمة مراقبة حركة المرور من قواعد البيانات باستخدام بروتوكولات محددة ، وحتى في حالة تشفير حركة المرور هذه.لكن حل فئة NTA يمكن بسهولة اكتشاف مثل هذه التسريبات من خلال تجاوز قيمة عتبة معينة لكمية المعلومات التي تم تنزيلها من قاعدة البيانات. بعد ذلك ، سأوضح كيف تم تكوين كل هذا واكتشافه باستخدام حل Cisco Stealthwatch Enterprise.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لذا ، فإن أول شيء يتعين علينا القيام به هو فهم مكان وجود خوادم قاعدة البيانات الخاصة بنا في الشبكة ، وتحديد عناوينها وتجميعها. في Cisco Stealthwatch ، يمكن تنفيذ مهمة الجرد إما يدويًا أو باستخدام مصنف خاص يقوم بتحليل حركة المرور ، ووفقًا للبروتوكولات المستخدمة وسلوك العقدة ، يسمح لك بإسنادها إلى فئة أو أخرى. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ri/n5/uy/rin5uykkickqn7znft9qa0ulllu.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بعد حصولنا على معلومات حول جميع خوادم قواعد البيانات ، نبدأ في التحقيق لمعرفة ما إذا كنا نسرب كميات كبيرة من البيانات من مجموعة العقد المطلوبة. نرى أنه في حالتنا ، فإن قواعد البيانات تتواصل بنشاط مع خوادم DHCP ووحدات تحكم المجال.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lb/xq/1z/lbxq1znvwtgzs01n4quxfwtgjli.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
غالبًا ما يقوم المهاجمون بالتحكم في أي من عقد الشبكة ويستخدمونها كجسر عبور لتطوير هجومهم. على مستوى حركة مرور الشبكة ، يبدو الأمر وكأنه شذوذ - أصبح فحص الشبكة من هذه العقدة أكثر تواتراً ، أو يتم التقاط البيانات من مشاركة الملف ، أو التفاعل مع أي خوادم. لذلك ، تتمثل مهمتنا التالية في معرفة من تتواصل قواعد بياناتنا بالضبط. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wb/er/0b/wber0bo8wqxtkswej7n7vmoffc8.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في مجموعة خوادم DHCP ، اتضح أن هذه عقدة مع العنوان 10.201.0.15 ، التفاعل الذي يمثل حوالي 50 ٪ من جميع حركة المرور من خوادم قاعدة البيانات. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yz/yb/vb/yzybvbnmgicokharg8oxu57lxwm.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
السؤال المنطقي التالي الذي نطرحه على أنفسنا كجزء من التحقيق هو: "وما هذه العقدة مثل 10.201.0.15؟ مع من يتفاعل؟ كم مرة؟ ما البروتوكولات؟ "</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mt/-s/ac/mt-sacge5hjgo2jwerw7omqwmlk.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
اتضح أن العقدة التي تهمنا تتواصل مع قطاعات وعقد مختلفة من شبكتنا (وهذا ليس مفاجئًا ، لأنه خادم DHCP) ، لكن السؤال يتسبب في الكثير من التفاعل مع خادم المحطة الطرفية بالعنوان 10.201.0.23. هل هذا طبيعي؟ من الواضح أن هناك نوعًا من الشذوذ. لا يمكن لخادم DHCP التواصل بنشاط مع خادم طرفي - 5610 دفق و 23.5 جيجابايت من البيانات. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4i/mk/jm/4imkjmqkv1eumztrmdyb88etx3c.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ويتم هذا التفاعل من خلال NFS. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vl/2a/wo/vl2awoxjk2kijyg494rvz8bqsr4.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
نتخذ الخطوة التالية ونحاول أن نفهم مع من يتفاعل الخادم الطرفي لدينا؟ اتضح أن لديه اتصالات نشطة للغاية مع العالم الخارجي - مع عقد في الولايات المتحدة الأمريكية وبريطانيا وكندا والدنمارك والإمارات العربية المتحدة وقطر وسويسرا ، إلخ.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/uw/yr/3s/uwyr3shmwntm1clarsxud2xfcgq.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
كان الشك بسبب حقيقة تفاعل P2P مع بورتوريكو ، والتي شكلت 90 ٪ من جميع حركة المرور. علاوة على ذلك ، أرسل خادم طرفي لدينا أكثر من 17 غيغابايت من البيانات إلى بورتوريكو عبر المنفذ 53 ، المرتبط ببروتوكول DNS. هل يمكنك أن تتخيل أن لديك مثل هذا الحجم من البيانات المرسلة عبر DNS؟ وأذكرك أنه وفقًا لأبحاث Cisco ، تستخدم 92٪ من البرامج الضارة DNS لإخفاء نشاطها (تنزيل التحديثات ، وتلقي الأوامر ، وتفريغ البيانات). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/f1/mm/5b/f1mm5b4rmsqx5butgpw-mlsmk0e.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وإذا لم يكن بروتوكول DNS DNS مفتوحًا فقط ، ولكن لم يتم فحصه ، فعندئذ لدينا فجوة كبيرة في محيطنا. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yt/_4/dj/yt_4djyxlui4rzkyvsko1zsejlu.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بمجرد أن تسببت العقدة 10.201.0.23 في مثل هذه الشكوك ، دعنا نرى من لا يزال يتحدث إليه؟</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zh/ya/7r/zhya7r8umwppjkxvidzpmpca9zy.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يتبادل "المشتبه فيه" نصف حركة المرور مع العقدة 10.201.3.18 ، التي يتم وضعها في مجموعة من محطات العمل لموظفي قسم المبيعات والتسويق. إلى أي مدى تعتبر هذه هي الطريقة التي تستخدمها مؤسستنا للخادم الطرفي "للتواصل" مع كمبيوتر البائع أو المسوق؟</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pu/vq/nf/puvqnfekb1fdkqjenprrlsesxpi.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لذا ، أجرينا تحقيقاً واكتشفنا الصورة التالية. تم "سكب" البيانات من خادم قاعدة البيانات على خادم DHCP مع نقلها لاحقًا عبر NFS إلى خادم طرفي داخل شبكتنا ، ثم إلى عناوين خارجية في بورتوريكو باستخدام بروتوكول DNS. هذا انتهاك واضح للسياسات الأمنية. في الوقت نفسه ، تفاعل خادم المحطة الطرفية أيضًا مع إحدى محطات العمل داخل الشبكة. ما سبب هذا الحادث؟ حساب مسروق؟ الجهاز المصاب؟ نحن لا نعلم. سيتطلب هذا استمرارًا للتحقيق ، والذي كان قائمًا على حل فئة NTA ، والذي يسمح بتحليل الحالات الشاذة لحركة مرور الشبكة.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ge/wt/vo/gewtvo6-5k-41fdkkxaozhlep7q.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
والآن نحن مهتمون بما سنفعله مع الانتهاكات المحددة للسياسة الأمنية؟ يمكنك إجراء تحليل منتظم وفقًا للمخطط أعلاه ، أو يمكنك تكوين سياسة NTA بحيث تشير فورًا عند اكتشاف انتهاكات مماثلة. يتم ذلك إما من خلال القائمة العامة المقابلة ، أو لكل اتصال يتم اكتشافه أثناء التحقيق. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cc/rp/qa/ccrpqaqizyxou5zjqqfw36hsl4i.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إليك ما ستبدو عليه قاعدة الكشف عن التفاعل ، ومصدرها خادم قاعدة البيانات ، والوجهة هي أي عقد خارجية ، بالإضافة إلى أي عقد داخلية ، باستثناء خوادم الويب.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hu/xy/ah/huxyah2skmz8jpc7d3dhtxtl3xe.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إذا تم الكشف عن مثل هذا الحدث ، يقوم نظام تحليل حركة مرور الشبكة على الفور بإنشاء إشارة إنذار بالمراسلة ، ويرسلها إلى الإعدادات إلى SIEM ، حسب وسائل الاتصال ، أو يمكنه حتى منع المخالفة المكتشفة تلقائيًا (تقوم Cisco Stealthwatch بذلك عن طريق التفاعل مع Cisco ISE ) </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lj/ii/rn/ljiirng2huuf6qzjxg-kiagufcu.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تذكر أنه عندما ذكرت الحالة مع Equifax ، ذكرت أن المهاجمين استخدموا قناة مشفرة لتفريغ البيانات. بالنسبة إلى ميزة منع فقدان البيانات (DLP) ، تصبح حركة المرور هذه مهمة غير قابلة للحل ، ولكن بالنسبة لحلول فئة NTA ، فإنها لا تقوم بذلك - فهي تتتبع أي حركة مرور زائدة أو تفاعل غير مصرح به بين العقد ، بغض النظر عن التشفير.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/u2/qg/qg/u2qgqgkkrsk_etuu7nav-k9hndg.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تم عرض حالة واحدة فقط أعلاه (في المواد التالية سننظر في أمثلة أخرى لاستخدام NTA لأغراض تتعلق بأمن المعلومات) ، ولكن في الواقع ، تسمح لك الحلول الحديثة لفئة تحليل حركة مرور الشبكة بإنشاء قواعد مرنة للغاية مع مراعاة ليس فقط المعلمات الأساسية لرأس حزمة IP: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/15/ya/uk/15yaukzbimtm-o-yf41wnibz2ik.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ولكن أيضًا إجراء تحليل أعمق ، حتى ربط الحادث باسم المستخدم من Active Directory ، والبحث عن الملفات الضارة عن طريق التجزئة (على سبيل المثال ، التي تم الحصول عليها كمؤشر تسوية من SOSOPKA ، FinCERT ، Cisco Threat Grid ، إلخ) ، إلخ.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dc/oe/55/dcoe55wr_luv_kvpjjrqwapc5jc.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
من السهل تنفيذها. على سبيل المثال ، هذه هي الطريقة التي تبدو بها القاعدة المعتادة للكشف عن جميع أنواع التفاعل بين خوادم قواعد البيانات والعقد الخارجية باستخدام أي بروتوكول خلال الثلاثين يومًا الماضية. نرى أن قواعد البيانات الخاصة بنا "تم توصيلها" بالعقد الخارجية لقطاع DBMS باستخدام بروتوكولات DNS و SMB والمنفذ 8088. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hn/70/nh/hn70nhlbp10lmjmgbkjj_8_bs8i.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بالإضافة إلى النموذج الجدولي لتقديم نتائج التحقيقات أو عمليات البحث ، يمكننا أيضًا تصورها. بالنسبة لسيناريونا ، قد يبدو جزء من مخطط تدفق الشبكة على النحو التالي: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zs/yv/jf/zsyvjfgvrptgxwgv0eefnyz5pju.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ومن نفس الخريطة يمكننا إدارة السياسات - حظر الاتصالات أو أتمتة عملية إنشاء قواعد مراقبة لتدفقات الاهتمام بالنسبة لنا.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ix/tj/rk/ixtjrkszqelbtsgpwdmdxdluubm.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
فيما يلي مثال مثير للاهتمام وحيوي لاستخدام أدوات مراقبة Netflow (وبروتوكولات التدفق الأخرى) للأمن السيبراني. </font><font style="vertical-align: inherit;">في الملاحظات التالية ، أخطط لإظهار كيف يمكنك استخدام NTA لاكتشاف التعليمات البرمجية الضارة (على سبيل المثال ، Shamoon) ، والخوادم الضارة (على سبيل المثال ، حملة DNSpionage) ، وبرامج الوصول عن بعد (RAT) ، وتجاوز وكلاء الشركة ، وما إلى ذلك.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar487346/">https://habr.com/ru/post/ar487346/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar487332/index.html">اختبار المصابيح Ergolux رخيصة</a></li>
<li><a href="../ar487334/index.html">كيف يحسن "البعيد" التعاون</a></li>
<li><a href="../ar487336/index.html">الوحدة - تمكين Multidex أو طرق كثيرة جدًا</a></li>
<li><a href="../ar487340/index.html">كما فعلنا المصمم التالي لروبوتات الدردشة. الجزء الأول</a></li>
<li><a href="../ar487342/index.html">الدرس # 2 - لقاءات و أحداث</a></li>
<li><a href="../ar487348/index.html">ترتيب المهام ذات الأولوية - تطبيق IL TEMPO</a></li>
<li><a href="../ar487356/index.html">هل ستتغير؟ فكر مرة اخرى</a></li>
<li><a href="../ar487358/index.html">BERT و ELMO and Co. في الصور (كيف وصل التدريب على النقل إلى البرمجة اللغوية العصبية)</a></li>
<li><a href="../ar487360/index.html">لا يضمن إخفاء هوية البيانات عدم الكشف عن هويتك بالكامل</a></li>
<li><a href="../ar487362/index.html">Angular 9 متاح الآن - وصل Ivy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>