<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕳️ 🔍 🌘 リレーショナルDBMSの時系列データ。TimescaleDBおよびPipelineDB for PostgreSQLの拡張機能 ⏪ 🆘 👩‍🏭</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="時系列データまたは時系列は、時間とともに変化するデータです。通貨の見積もり、トランスポートの動きのテレメトリー、サーバーアクセスの統計、またはCPUの負荷は時系列データです。それらを保存するには、特定のツール（一時データベース）が必要です。 InfluxDBやClickHouseなど、数十のツールが...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>リレーショナルDBMSの時系列データ。TimescaleDBおよびPipelineDB for PostgreSQLの拡張機能</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/464303/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">時系列データまたは時系列は、時間とともに変化するデータです。通貨の見積もり、トランスポートの動きのテレメトリー、サーバーアクセスの統計、またはCPUの負荷は時系列データです。それらを保存するには、特定のツール（一時データベース）が必要です。 InfluxDBやClickHouseなど、数十のツールがあります。しかし、最高の時系列ストレージソリューションでさえ不利な点があります。すべての時系列ストレージは低レベルであり、時系列データにのみ適しています。実行して現在のスタックに注入することは、費用がかかり、面倒です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sx/9x/bz/sx9xbzv26lix6lh-frspdsopknw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、PostgreSQLスタックがある場合は、InfluxDBと他のすべての一時データベースを忘れることができます。</font><font style="vertical-align: inherit;">TimescaleDBとPipelineDBの2つの拡張機能をインストールし、時系列データをPostgreSQLエコシステムに直接保存、処理、分析します。</font><font style="vertical-align: inherit;">サードパーティソリューションの導入なし、一時ストレージの欠点なし、実行時の問題なし。</font><font style="vertical-align: inherit;">これらの拡張機能とは何か、その利点と機能は何か、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ivan Muratov（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ビナコット</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;-First Monitoring Companyの開発部門の責任者。</font></font><br>
<a name="habracut"></a><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3WkNp7mllv0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">時系列データまたは時系列とは何ですか？</font></font></h2><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これは、彼の人生のさまざまな時点で収集されたプロセスに関するデータです。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、車の位置：速度、座標、方向、サーバー上のリソースの使用、CPUの負荷、RAMの使用量、空きディスク容量などのデータ。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
時系列にはいくつかの機能があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">固定ストラップ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">すべての時系列レコードには、値が記録されたタイムスタンプのフィールドがあります。</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シリーズのレベルと呼ばれるプロセスの特性</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：速度、座標、負荷データ。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ほとんどの場合、このようなデータ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は追加専用モードで機能します</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">つまり、新しいデータが古いデータを置き換えることはありません。</font><font style="vertical-align: inherit;">古いデータのみが削除されます。</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エントリは互いに個別に考慮されません</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">データは、時間枠、間隔、または期間に対して集合的にのみ使用されます。</font></font><br>
</li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">人気のストレージソリューション</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私が</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">db-engines.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">取得した</font></a><font style="vertical-align: inherit;">グラフは</font><font style="vertical-align: inherit;">、過去2年間のさまざまなストレージモデルの人気を示しています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/w2/wf/_u/w2wf_uryfor_djey8enzmrskywo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
主要な位置は、第2に、時系列のストレージで占められています-グラフデータベース、次に-Key-Valueおよびリレーショナルデータベース。</font><font style="vertical-align: inherit;">専門リポジトリの人気は、ビッグデータ、ソーシャルネットワーク、IoT、高負荷インフラストラクチャの監視などの情報技術の統合における集中的な成長に関連しています。</font><font style="vertical-align: inherit;">有用なビジネスデータに加えて、ログやメトリックでさえ大量のリソースを消費します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">時系列データの一般的なストレージソリューション</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
グラフは、時系列データを格納するための特別なソリューションを示しています。</font><font style="vertical-align: inherit;">スケールは対数です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ny/bz/6_/nybz6_-_3ce7t0y7xre1oxkbks8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
安定したリーダーInfluxDB。</font><font style="vertical-align: inherit;">時系列データに出くわしたすべての人がこの製品について聞いています。</font><font style="vertical-align: inherit;">しかし、グラフはTimescaleDBが10倍に増加していることを示しています。リレーショナルDBMSの拡張機能が、もともと時系列で開発された製品の中で、太陽の下で戦っています。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PostgreSQLは優れたデータベースであるだけでなく、特殊なソリューションを開発するための拡張可能なプラットフォームでもあります。</font></font></blockquote><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Postgres、Postgis、およびTimescaleDB</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First Monitoring Companyは、衛星を使用して車両の動きを監視しています。 20,000台の車両を追跡し、2年間の移動データを保存しています。合計で、10 TBの現在のテレメトリデータがあります。平均して、各車両は運転中に1分あたり5つのテレメトリレコードを送信します。データは、ナビゲーション機器を介してテレマティックサーバーに送信されます。 1秒あたり500のナビゲーションパケットを受信します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しばらく前に、インフラストラクチャをグローバルにアップグレードし、モノリスからマイクロサービスに移行することを決定しました。新しいシステムをWaliotと呼び、すでに生産されています-全車両の90％がそれに転送されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インフラストラクチャには多くの変更がありましたが、中央のリンクは変更されていません。これはPostgreSQLデータベースです。</font><font style="vertical-align: inherit;">現在、バージョン10に取り組んでおり、11への移行の準備をしています。PostgreSQLに加えて、スタックでは、地理空間計算にPostGISを使用し、TimescaleDBを使用して、時系列データの大規模な配列を格納します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">なぜPostgreSQL？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このデータ型の</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ClickHouse</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">専用ソリューション</font><font style="vertical-align: inherit;">
ではなく、リレーショナルデータベースを使用して時系列を保存しようとしているのはなぜ&nbsp; </font><font style="vertical-align: inherit;">ですか？</font><font style="vertical-align: inherit;">蓄積された専門知識とPostgreSQLでの作業の印象を背景に、未知のソリューションを主ストレージとして使用したくないからです。</font></font><br>
 <br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいソリューションへの切り替えはリスクです。 </font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
時系列データを格納および処理するための多くの特殊なソリューションがあります。文書化は必ずしも十分ではなく、ソリューションの選択の幅が広いとは限りません。以前の解決策では問題があったため、各新製品の開発者はすべてを最初から作成したいと考えています。何が嫌だったのかを正確に理解するには、情報を探し、分析して比較する必要があります。さまざまな</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トップス</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">評価</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">比較は</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">何かを試す動機よりも怖いです。自分ですべてのソリューションを試すには、多くの時間を費やす必要があります。数か月間、1つのソリューションだけを適応させる余裕はありません。これは難しい作業であり、費やされた時間は決して報われることはありません。したがって、PostgreSQLの拡張機能を選択しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Waliotインフラストラクチャの開発段階では、InfluxDBを主要なテレメトリリポジトリと見なしました。しかし、TimescaleDBに出会い、テストしたところ、選択についての質問はありませんでした。 TimescaleDB拡張機能を備えたPostgreSQLでは、同じPostGISまたはPipelineDBストレージで他の拡張機能を使用できます。データを取り出し、変換し、分析を実行して、ネットワーク経由で転送する必要はありません。すべてが1台のサーバーまたはクラスター化システムにあります。データをドラッグする必要はありません。すべての計算は同じレベルで実行されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最近、</font><font style="vertical-align: inherit;">postgresmenアカウントの作者である</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nikolay Samokhvalov </font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">がリンクを公開しました</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ストリーミングデータ処理のためのSQLの使用に関する興味深い記事へ。記事の著者6人のうち5人は、さまざまなApache製品の開発に携わっており、ストリーム処理に取り組んでいます。したがって、この記事では、ConfluentのApache Spark、Apache Flink、Apache Beam、Apache Calcite、およびKSQLについて言及しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、記事自体は興味深いものではありませんが、&nbsp; </font><font style="vertical-align: inherit;">それが議論されている</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hacker Newsに関するトピック</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。トピックの作成者は、この記事に基づいて、PostgreSQL 11に基づいてほぼすべてのアイデアを実装したと書いています。水平スケーリングとシャーディングにはCitusDB拡張を使用し、ストリームコンピューティングとマテリアライズドビューにはPipelineDB、時系列データの格納とセクションにはTimescaleDBを使用しました。また、いくつかの外部データラッパーを使用しています。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PostgreSQLとその拡張機能のクレイジーな組み合わせにより、PostgreSQLは単なるDBMSではなくプラットフォームであることが再度確認されました。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、プラグイン可能なストレージが配信されるとき...うーん！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
皮肉なことに、ソリューションを調査したところ</font><font style="vertical-align: inherit;">&nbsp;、TimescaleDBチームの開発である</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Outfluxが</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">見つかりました</font><font style="vertical-align: inherit;">。彼らは4月1日に発表しました。</font><font style="vertical-align: inherit;">彼女は何をしていると思いますか？</font><font style="vertical-align: inherit;">これは、1つのコマンドでInfluxDBからTimescaleDBに移行するためのユーティリティです...</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Postgresの誇大宣伝！</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
誇大広告の力を過小評価しないでください！</font><font style="vertical-align: inherit;">「開発は誇大宣伝によって推進されている」と冗談を言うことがよくあります。それは、チューニングやインフラストラクチャコンポーネントに対する私たちの認識に影響を与えるためです。</font><font style="vertical-align: inherit;">で&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HighLoad ++、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我々は、PostgreSQLをたくさん話し合い、ClickHouse、Tarantool -これらは、誇大広告の開発です。</font><font style="vertical-align: inherit;">お客様の好みやインフラストラクチャのソリューションの選択に影響を与えないとは言わないでください...もちろん、これは主な要因ではありませんが、影響はありますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私はPostgreSQLを5年間使用しています。</font><font style="vertical-align: inherit;">私はこのソリューションが好きです。</font><font style="vertical-align: inherit;">彼は私の仕事のほとんどすべてを強打で解決します。</font><font style="vertical-align: inherit;">このベースに問題が発生するたびに、曲がった手が原因でした。</font><font style="vertical-align: inherit;">したがって、選択は事前に決定されました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TimescaleDBとPipelineDB</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TimescaleDBとPipelineDBの拡張機能に移りましょう。彼らのクリエイターは拡張機能について何と言っていますか？</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TimescaleDBは、</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">迅速な挿入と複雑なクエリのために最適化され</font><b><font style="vertical-align: inherit;">た</font></b><font style="vertical-align: inherit;">オープンソースの</font><b><font style="vertical-align: inherit;">時系列データベース</font></b><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PipelineDB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;は、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">時系列データ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に対して継続的なSQLクエリを実行するように設計された高性能な拡張機能です</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
時系列データでの作業に加えて、同様のストーリーがあります。 Timescaleは2015年に、Pipelineは2013年に設立されました。最初の実用バージョンは、それぞれ2017年と2015年に登場しました。チームが最小限の機能をリリースするのに2年かかりました。両方の拡張機能の製品版リリースは昨年1月に行われ、1週間の違いがありました。どうやら、お互い急いで。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GitHubにはたくさんのスターとフォークがありますが、これらはいつものように単一のコミットではありません。これがオープンソースの仕組みです。何もする必要はありません。しかし、多くの星がある&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TimescaleDBが持っている</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">よりも多くの&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PipelineDBを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、より一層のPostgreSQL自体より。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
拡張機能は似ているように見えますが、位置が異なります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TimescaleDB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、毎秒数百万のレコードを挿入し、数千億の行と数十テラバイトのデータを格納したと主張しています。拡張機能は、InfluxDB、Cassandra、MongoDB、またはバニラPostgreSQLよりも高速です。ストリーミングレプリケーションおよびバックアップツールをサポートします。 TimescaleDBは拡張機能であり、PostgreSQLのフォークではありません。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pipelinedb</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ストリーミング計算の結果のみを保存します。計算のために生データを保存する必要はありません。</font><font style="vertical-align: inherit;">拡張機能は、ドメインドメインのコンテキストで計算するための従来のテーブルと組み合わせて、リアルタイムデータストリームを介した継続的な集約が可能です。</font><font style="vertical-align: inherit;">PipelineDBはフォークではなく拡張機能ですが、当初はフォークでした。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Timescaledb</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、拡張機能について詳しく説明します。</font><font style="vertical-align: inherit;">TimescaleDBから始めましょう。</font><font style="vertical-align: inherit;">私は彼とほぼ2年間働いています。</font><font style="vertical-align: inherit;">それをリリースバージョンの前にプロダクションにドラッグしました。</font><font style="vertical-align: inherit;">それを適用する方法の例を見てみましょう。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インフラストラクチャメトリックのストレージ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">Dockerコンテナーのリソース消費メトリック、メトリックのコミット時間、コンテナー識別子、リソース消費フィールド（空きメモリなど）があります。</font><font style="vertical-align: inherit;">10秒間の平均空きメモリウィンドウですべてのコンテナの統計情報を表示する必要があります。</font><font style="vertical-align: inherit;">表示されるクエリはこの問題を解決し、TimescaleDBはインフラストラクチャメトリックのリポジトリとして使用できます。</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> time_bucket(’<span class="hljs-number">10</span> <span class="hljs-keyword">seconds</span>’, <span class="hljs-built_in">time</span>) <span class="hljs-keyword">AS</span>&nbsp;<span class="hljs-keyword">period</span>,<font></font>
container_id,<font></font>
<span class="hljs-keyword">avg</span>(free_mem)
<span class="hljs-keyword">FROM</span> metrics
<span class="hljs-keyword">WHERE</span> <span class="hljs-built_in">time</span> &lt; <span class="hljs-keyword">now</span>() - <span class="hljs-built_in">interval</span> ’<span class="hljs-number">10</span> <span class="hljs-keyword">minutes</span>’
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span>&nbsp;<span class="hljs-keyword">period</span>, container_id
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span>&nbsp;<span class="hljs-keyword">period</span> <span class="hljs-keyword">DESC</span>, container_id;</code></pre><br>
<pre><code class="plaintext hljs">period                 | container_id | avg<font></font>
-----------------------+--------------+---<font></font>
2019-06-24 12:01:00+00 | 16           | 72202<font></font>
2019-06-24 12:01:00+00 | 73           | 837725<font></font>
2019-06-24 12:01:00+00 | 96           | 412237<font></font>
2019-06-24 12:00:50+00 | 16           | 1173393<font></font>
2019-06-24 12:00:50+00 | 73           | 90104<font></font>
2019-06-24 12:00:50+00 | 96           | 784596</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">計算用</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">クラスノダールを発ったトラックの数と総トン数を日数で計算する必要があります。</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> time_bucket(’<span class="hljs-number">1</span> <span class="hljs-keyword">day</span>’, <span class="hljs-built_in">time</span>) <span class="hljs-keyword">AS</span>&nbsp;<span class="hljs-keyword">day</span>,
<span class="hljs-keyword">count</span>(*) <span class="hljs-keyword">AS</span>&nbsp;trucks_exiting,
<span class="hljs-keyword">sum</span>(weight)&nbsp;/ <span class="hljs-number">1000</span>&nbsp;<span class="hljs-keyword">AS</span> tonnage
<span class="hljs-keyword">FROM</span> vehicles
<span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> cities&nbsp;<span class="hljs-keyword">ON</span> cities.name = ’Krasnodar’
<span class="hljs-keyword">WHERE</span> ST_Within(last_location, ST_Polygon(cities.geom, <span class="hljs-number">4326</span>))
<span class="hljs-keyword">AND</span> <span class="hljs-keyword">NOT</span> ST_Within(current_location, ST_Polygon(cities.geom, <span class="hljs-number">4326</span>))
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span>&nbsp;<span class="hljs-keyword">day</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span>&nbsp;<span class="hljs-keyword">day</span> <span class="hljs-keyword">DESC</span>
<span class="hljs-keyword">LIMIT</span> <span class="hljs-number">3</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、PostGISエクステンションの関数を使用して、単に市内を移動するのではなく、市内を離れた交通機関を計算します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通貨レートの監視</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">3番目の例は、暗号通貨に関するものです。</font><font style="vertical-align: inherit;">リクエストにより、過去2週間のビットコインと米ドルに対するイーサリアムの価格の変化を表示できます。</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> time_bucket(’<span class="hljs-number">14</span> <span class="hljs-keyword">days</span>’, c.time) <span class="hljs-keyword">AS</span>&nbsp;<span class="hljs-keyword">period</span>,
<span class="hljs-keyword">last</span>(c.closing_price, c.time) <span class="hljs-keyword">AS</span>&nbsp;closing_price_btc,
<span class="hljs-keyword">last</span>(c.closing_price, c.time) * <span class="hljs-keyword">last</span>(b.closing_price, c.time)<font></font>
filter (<span class="hljs-keyword">WHERE</span> b.currency_code = ’USD’) <span class="hljs-keyword">AS</span>&nbsp;closing_price_usd
<span class="hljs-keyword">FROM</span> crypto_prices c
<span class="hljs-keyword">JOIN</span> btc_prices b
<span class="hljs-keyword">ON</span>&nbsp;time_bucket(’<span class="hljs-number">1</span> <span class="hljs-keyword">day</span>’, c.time) = time_bucket(’<span class="hljs-number">1</span> <span class="hljs-keyword">day</span>’, b.time)
<span class="hljs-keyword">WHERE</span> c.currency_code = ’ETH’
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span>&nbsp;<span class="hljs-keyword">period</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span>&nbsp;<span class="hljs-keyword">period</span> <span class="hljs-keyword">DESC</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、SQLでもまったく同じで、便利です。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TimescaleDBの何がすばらしいのですか？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
組み込みのテーブル分割ツールを使用しないのはなぜですか？そして、なぜテーブルを壊すのが面倒なのですか？明白な答えは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、そのようなデータベースへの挿入速度</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。このグラフは、セクショニングのないバニラPostgreSQL 10の通常のテーブルとTimescaleDBハイパーテーブルの間の1秒あたりの行数の挿入率の実際の測定値を示しています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gq/ln/xd/gqlnxdxeupbqkf_i-wdeihs0zlq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このベンチマークは、1台のマシンで10億行を書き込み、インフラストラクチャからメトリックを収集するシナリオをシミュレートします。レコードには、時間、インフラストラクチャコンポーネントの識別子、および10個のメトリックが含まれています。ベンチマークは、8コア、28ギガバイトのRAM、およびネットワークSSDドライブを搭載したAzure VMで実行されました。挿入は、1万レコードのバッチで実行されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようなPostgreSQLのパフォーマンスの低下はどこから発生しますか？挿入するときに、テーブルインデックスも更新する必要があるためです。キャッシュに収まらない場合は、ディスクのロードを開始します。データを挿入するセクションのインデックスがRAMに配置されている場合、パーティション分割によってこの問題が解決されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のグラフを見てみましょう。これは、PostgreSQL 10に組み込まれている宣言型パーティション分割システムとTimescaleDBハイパーテーブルを比較しています。横軸はセクション数。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kd/dz/xd/kddzxdttzspi9peoiriem7sipms.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TimescaleDBでは、セクションの増加に伴うパフォーマンスの低下はごくわずかです。拡張機能の開発者は、単一のPostgreSQLインスタンスで10,000セクションで問題なく動作していると主張しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PostgreSQLでは、ネイティブ実装が3,000を超えると大幅に低下します。一般に、PostgreSQLの宣言型パーティション分割は大きな前進ですが、負荷の少ないテーブルでのみ機能します。</font><font style="vertical-align: inherit;">たとえば、メトリックほど集中的ではないシステムに入る商品、顧客、およびその他のドメインエンティティの場合。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PostgreSQLの11および12バージョンでは、ネイティブのパーティション分割サポートが表示され、新しいバージョンで時系列データの比較テストを実行できます。</font><font style="vertical-align: inherit;">しかし、TimescaleDBの方が優れているように思えます。</font><font style="vertical-align: inherit;">TimescaleDBのすべてのベンチマークは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Githubに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あり、試してみる</font><font style="vertical-align: inherit;">ことができます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主な特徴</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
拡張機能に既に関心をお持ちであることを願っています。 TimescaleDBの主な機能を見て、この感覚を統合してみましょう。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハイパーテーブルによるパーティション化</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 TimescaleDBでは、create_hypertable（）関数が適用されたテーブルに対して「ハイパーテーブル」という用語を使用します。その後、テーブルは継承されたすべてのセクション（チャンク）の親になります。親テーブル自体にはデータは含まれませんが、新しいセクションを自動的に作成するときのすべてのクエリとテンプレートのエントリポイントになります。すべてのセクションは、データのメインスキームではなく、特別なスキームに格納されます。データスキーマにこれらのセクションの何千も表示されないため、これは便利です。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">拡張機能は、スケジューラとクエリ実行プログラムに統合されています</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">TimescaleDBは、PostgreSQLの特別なフックを通じて、ハイパーテーブルにいつアクセスするかを理解します。</font><font style="vertical-align: inherit;">TimescaleDBはクエリを分析し、SQL呼び出し自体で指定された条件に基づいて、必要なセクションのみにクエリをリダイレクトします。</font><font style="vertical-align: inherit;">これにより、大量のデータの抽出中にセクションを使用して作業を並列化できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
P </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">asshirenieはSQLに制限を課しません</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ユニオン、集計、ウィンドウ関数、CTE、および追加のインデックスを自由に使用できます。</font><font style="vertical-align: inherit;">組み込みのパーティショニングシステムの制限のリストを見たなら、これであなたは喜ぶはずです。</font><font style="vertical-align: inherit;">時系列データに固有の</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">追加の便利な機能</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「Time_bucket」-健康な人の「date_trun」。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヒストグラム-補間または最新の既知の値を使用して、欠落した間隔を埋めます。</font></font><br>
</li>
<li>background worker’s&nbsp;— ,     :   , .<br>
</li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TimescaleDBを使用すると、強力なPostgreSQLエコシステムを維持できます</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。この拡張機能はPostgreSQLを破壊しないため、すべての高可用性ソリューション、バックアップシステム、監視ツールは引き続き機能します。 TimescaleDBは、Grafana、Periscope、Prometheus、Telegraf、Zabbix、Kubernetes、Kafka、Seeq、JackDBの友達です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
では&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grafana</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すでにデータソースとしてネイティブサポートTimescaleDBを構築しました。 Grafanaは、PostscreSQLにTimescaleDBがあることをすぐに理解します。ダッシュボード上のGrafanaの要求ビルダーは、「time_bucket」、「first」、「last」などの追加のTimescaleDB関数を理解します。巨大なクエリなしでこれらの時系列関数を使用して、リレーショナルデータベースから直接グラフを作成できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
で、&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロメテウス</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アダプターを実装して、そこからデータをマージし、TimescaleDBを信頼性の高いデータウェアハウスとして使用できるようにしました。</font><font style="vertical-align: inherit;">アダプターを使用して、Prometheusに何年もデータを保存しないようにします。</font><b><font style="vertical-align: inherit;">Telegrafプラグイン</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
もあり</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このソリューションでは、Prometheusを完全に削除できます。</font><font style="vertical-align: inherit;">インフラストラクチャデータは直ちにTimescaleDBに転送され、Telegrafを通じて読み取られます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライセンスとニュース</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
少し前に、同社は新しいライセンスモデルに切り替えました。</font><font style="vertical-align: inherit;">ほとんどのコードは、Apache 2.0ライセンスの下で開かれています。</font><font style="vertical-align: inherit;">ごく一部は無料で使用できますが、TSLに基づいてライセンスされます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
商用ライセンス付きのEnterpriseバージョンがあります。</font><font style="vertical-align: inherit;">心配しないでください、エンタープライズ版のすべての利点ではありません。</font><font style="vertical-align: inherit;">基本的には、不要なチャンクの自動削除などの自動化があり、単純な「cron」などで実行できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現在、同社は積極的にクラスターソリューションに取り組んでいます。</font><font style="vertical-align: inherit;">おそらくそれはエンタープライズ版に分類されるでしょう。</font><font style="vertical-align: inherit;">投資家がお金を使い果たす前に市場に参入することを望んでいるスタートアップのためのクラウドバージョンもあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ニュースから：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">過去1年半で100万ダウンロード。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3100万ドルの投資。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IoTソリューションに関するMS Azureとの積極的なコラボレーション。</font></font><br>
</li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要約する</font></font></h3><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TimescaleDBは時系列データを格納するように設計されています。</font><font style="vertical-align: inherit;">これは、PostgreSQLのネイティブのものと比較して最小限の制限を持つ強力なパーティショニングシステムです。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
残念ながら、拡張機能にはまだマルチノードバージョンがありません。</font><font style="vertical-align: inherit;">マルチマスターまたはシャードが必要な場合は、たとえばCitusDBをいじる必要があります。</font><font style="vertical-align: inherit;">論理レプリケーションが必要な場合は、問題が発生します。</font><font style="vertical-align: inherit;">しかし、それは常に彼女と一緒に痛いです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pipelinedb</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、2番目の拡張機能について説明します。残念ながら、私たちは戦闘でそれを適切にテストすることができませんでした。現在、それは私たちのシステムでの適応の段階を経ています。確かに、私が最後に話し合う1つの問題があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前のケースと同様に、実際の例から始めます。拡張機能の利点とそれを使用する動機を理解するのは簡単です。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">統計収集</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 Webサイトへのアクセスに関する統計を収集するとします。最も人気のあるページの分析、ユニークユーザーの数、リソースの遅延についてのアイデアが必要です。これはすべてリアルタイムで更新する必要があります。しかし、毎回データテーブルを操作してクエリを作成したり、テーブルの上のビューを更新したりする必要はありません。</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> CONTINUOUS <span class="hljs-keyword">VIEW</span> v&nbsp;<span class="hljs-keyword">AS</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">url</span>::<span class="hljs-built_in">text</span>,
<span class="hljs-keyword">count</span>(*) <span class="hljs-keyword">AS</span>&nbsp;total_count,
<span class="hljs-keyword">count</span>(<span class="hljs-keyword">DISTINCT</span> cookie::<span class="hljs-built_in">text</span>) <span class="hljs-keyword">AS</span>&nbsp;uniques,
<span class="hljs-keyword">percentile_cont</span>(<span class="hljs-number">0.99</span>)
<span class="hljs-keyword">WITHIN</span> <span class="hljs-keyword">GROUP</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span>&nbsp;latency::<span class="hljs-built_in">integer</span>) <span class="hljs-keyword">AS</span>&nbsp;p99_latency
<span class="hljs-keyword">FROM</span> page_views
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span>&nbsp;<span class="hljs-keyword">url</span>;</code></pre><br>
<pre><code class="plaintext hljs">url        | total_count | uniques | p99_latency<font></font>
-----------+-------------+---------+------------<font></font>
some/url/0 | 633         | 51      | 178<font></font>
some/url/1 | 688         | 37      | 139<font></font>
some/url/2 | 508         | 88      | 121<font></font>
some/url/3 | 848         | 36      | 59<font></font>
some/url/4 | 126         | 64      | 159</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ストリーミング処理とPipelineDB拡張機能が役に立ちます。拡張機能は、抽象化「CONTINUES VIEW」を追加します。ロシア語版では、これは「継続的なプレゼンテーション」のように聞こえるかもしれません。このビューは、訪問を記録したテーブルに挿入されると自動的に更新されますが、事前に既に記録されている読み取りはなく、新しいデータのみに基づいています。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データストリーム</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 PipelineDBは新しいビュータイプだけに限定されません。 A / Bテストを実施し、新しいビジネスソリューションの有効性に関するリアルタイム分析を収集するとします。ただし、ユーザーのアクション自体に関するデータは保存しません。結果にのみ関心があります-コンバージョンが最も多いグループです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ストリーミングコンピューティングで生データを直接保存しないようにするには、次のような抽象化が必要です。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ストリーム-データストリーム</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 PipelineDBにはこの機能が導入されています。通常のテーブルのようにストリームを作成できます。内部的には、ZeroMQキューに基づく「FOREIGN TABLE」となり、拡張機能が目に見えない形で使用しています。データはZeroMQ内部キューに入り、継続的なビューの更新をトリガーします。</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> STREAM ab_event_stream (
<span class="hljs-keyword">name</span> <span class="hljs-built_in">text</span>,<font></font>
ab_group <span class="hljs-built_in">text</span>,<font></font>
event_type <span class="hljs-built_in">varchar</span>(<span class="hljs-number">1</span>),<font></font>
cookie <span class="hljs-built_in">varchar</span>(<span class="hljs-number">32</span>)<font></font>
);<font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> CONTINUOUS <span class="hljs-keyword">VIEW</span> ab_test_monitor <span class="hljs-keyword">AS</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">name</span>,<font></font>
ab_group,<font></font>
<span class="hljs-keyword">sum</span>(<span class="hljs-keyword">CASE</span> WHENevent_type = ’v’ <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span>&nbsp;<span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span>&nbsp;<span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span>&nbsp;view_count,
<span class="hljs-keyword">sum</span>(<span class="hljs-keyword">CASE</span> WHENevent_type = ’c’ <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span>&nbsp;<span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span>&nbsp;<span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span>&nbsp;conversion_count,
<span class="hljs-keyword">count</span>(<span class="hljs-keyword">DISTINCT</span> cookie) <span class="hljs-keyword">AS</span>&nbsp;uniques
<span class="hljs-keyword">FROM</span> ab_event_stream
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span>&nbsp;<span class="hljs-keyword">name</span>, ab_group;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、以前に作成したストリームからのデータに基づいて「CONTINUOUS VIEW」を作成します。データがストリームに到着すると、このデータに基づいてビューが更新されます。その後、データは単に破棄され、どこにも保存されず、ディスク領域を占有しません。これにより、ほぼ無制限の量のデータに分析を構築し、それらをPipelineDBデータストリームにロードして、継続的なビューから計算結果を読み取ることができます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フロー計算</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。データストリームと継続的なプレゼンテーションを作成したら、ストリームコンピューティングを使用できます。こんな感じです。</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> ab_event_stream (<span class="hljs-keyword">name</span>, ab_group, event_type, cookie)
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">round</span>(random() * <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span>&nbsp;<span class="hljs-keyword">name</span>,
<span class="hljs-keyword">round</span>(random() * <span class="hljs-number">4</span>) <span class="hljs-keyword">AS</span>&nbsp;ab_group,<font></font>
(<span class="hljs-keyword">CASE</span> WHENrandom() &gt; <span class="hljs-number">0.4</span>&nbsp;<span class="hljs-keyword">THEN</span> ’v’ <span class="hljs-keyword">ELSE</span> ’c’ <span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span>&nbsp;event_type,
<span class="hljs-keyword">md5</span>(random()::<span class="hljs-built_in">text</span>) <span class="hljs-keyword">AS</span>&nbsp;cookie
<span class="hljs-keyword">FROM</span> generate_series(<span class="hljs-number">0</span>, <span class="hljs-number">100000</span>);<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span> ab_group,<font></font>
uniques<font></font>
<span class="hljs-keyword">FROM</span> ab_test_monitor;<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span> ab_group,<font></font>
view_count * <span class="hljs-number">100</span>&nbsp;/ (conversion_count + view_count) <span class="hljs-keyword">AS</span>&nbsp;conversion_rate
<span class="hljs-keyword">FROM</span> ab_test_monitor;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初の「SELECT」は、グループ「ab」とユニークビジターの数を示します。</font><font style="vertical-align: inherit;">2番目-グループ間の比率を示します-変換。</font><font style="vertical-align: inherit;">これは、リレーショナルデータベースの5つのSQL呼び出しに対するすべてのA / Bテストです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ビューは動的に更新されます。</font><font style="vertical-align: inherit;">データ配列全体の処理を待つことはできませんが、すでに処理された中間結果を読み取ることができます。</font><font style="vertical-align: inherit;">ビューは通常のPostgreSQLと同じ方法で読み取られます。</font><font style="vertical-align: inherit;">ビューをテーブルや他のビューと組み合わせることもできます。</font><font style="vertical-align: inherit;">制限はありません。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トポロジー</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kafkaがテレメトリを受信し、KafkaのトピックがこのデータをPostgreSQLに送信して、さらに集計します。たとえば、通常のテーブルと組み合わせて、データをストリームにリダイレクトします。さらに、彼は対応する継続的なプレゼンテーションの更新を引き起こします。これから、データベースクライアントは既に完成したデータを読み取ることができます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0e/4p/zb/0e4pzbehsh35td5tdiillcaq82m.jpeg"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PostgreSQL内のPipelineDBコンポーネントのトポロジの例。この図は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Derek Nelson </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">によるプレゼンテーション</font></a><font style="vertical-align: inherit;">から借用したもの&nbsp; </font><font style="vertical-align: inherit;">です。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ストリームとビューに加えて、拡張機能は「変換」の抽象化、つまりコンバーターまたはミューテーターも提供します。このビューですが、着信データストリームを変更された出力に変換することを目的としています。これらのミューテーターを使用すると、データの表示を変更したり、フィルターしたりできます。ミューテーターからは、すべてCONTINUOUS VIEWビューに分類されます。既に商売についてのお問い合わせは承っております。関数型プログラミングに精通している人なら誰でも、その考えを理解するはずです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PipelineDBでは、ビューにトリガーを掛けて、「アラート」などのアクションを実行できます。これらのすべての計算では、生データを自分で保存することはありません。これらはテラバイトになる可能性があり、100ギガバイトのディスクを持つサーバーに順次アップロードします。結局のところ、私たちは計算結果にのみ関心があります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主な特徴</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PipelineDB拡張機能は、TimescaleDBよりも学習が困難です。</font><font style="vertical-align: inherit;">TimescaleDBでは、テーブルを作成し、それがハイパーテーブルであることを伝え、拡張機能が提供するいくつかの追加機能を使用して人生を楽しんでいます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PipelineDBは、リレーショナルデータベースでのストリーミングコンピューティングの問題を解決します</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ストリーミングデータ処理のタスクは、統合と使用の点で、パーティショニングよりも複雑です。</font><font style="vertical-align: inherit;">ただし、誰もが膨大なデータと数十億行を持っているわけではありません。</font><font style="vertical-align: inherit;">PipelineDBがあるとインフラストラクチャが複雑になるのはなぜですか？</font><font style="vertical-align: inherit;">この拡張機能は、ストリーム処理のためのビュー、ストリーム、コンバーター、および集約の独自の実装を提供します。</font><font style="vertical-align: inherit;">また</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、クエリプランナーに統合され、クエリエグゼキュータ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、リレーショナルデータベースにストリームコンピューティングの概念を実装できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TimescaleDBと同様に、PipelineDB拡張機能</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はPostgreSQLにSQLの制限を課しません</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。いくつかの機能があります。たとえば、2つのストリームを結合することはできませんが、これは必須ではありません。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">確率的データ構造とアルゴリズムのサポート</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。拡張では、SQLでSELECT DISTINCTにBloom Filter、COUNT（DISTINCT）にHyperLogLog、percentile_count（）にT-Digestを直接使用します。これにより生産性が向上します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生態系</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。拡張機能を使用すると、通常の高可用性ソリューション、監視ツール、およびPostgreSQLでおなじみのその他すべてを操作できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ストリーミングコンピューティングの詳細を考えると、PipelineDBは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apache Kafkaと統合されています</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Amazon Kinesisを使用すると、リアルタイム分析サービスを利用できます。</font><font style="vertical-align: inherit;">PipelineDBはもはやフォークではなく拡張なので、残りの動物園との統合もそのまま使用できます。</font><font style="vertical-align: inherit;">必見ですが、私たちは理想的な世界に住んでいるわけではなく、すべてを確認する価値があります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライセンスとニュース</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのコードはApache 2.0でライセンスされています。さまざまなシューティングギャラリーのサポートの有料サブスクリプションと、商用ライセンスのあるクラスターバージョンがあります。 PipelineDBに基づいて、同社はストライド分析サービスを提供しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
拡張機能について話し始める前に、「しかし」は1つあると言いました。彼について話す時が来ました。 2019年5月1日、PipelineDBチームは、Confluentに加わったことを発表しました。これは、SQL構文を使用してデータをKafkaにストリーミングするためのエンジンであるKSQLを開発している会社です。現在、ポッドキャストDebriefingの共同創設者であるVictor Gamovがそこで働いています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これから何が続きますか？</font><font style="vertical-align: inherit;">PipelineDBがバージョン1.0.0でフリーズしました。</font><font style="vertical-align: inherit;">重大なバグを修正することに加えて、何も計画されていません。</font><font style="vertical-align: inherit;">買収により、KafkaとPostgreSQLのUber統合が期待されます。</font><font style="vertical-align: inherit;">おそらく、プラグイン可能なストレージに基づくConfluentが、何かクールなことをするでしょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何をすべきか？</font><font style="vertical-align: inherit;">TimescaleDBに移動します。</font><font style="vertical-align: inherit;">最新バージョンでは、ブラックジャックを使用して「CONTINUOUS VIEW」を作成しました。</font><font style="vertical-align: inherit;">もちろん、今では機能はPipelineDBほどクールではありませんが、時間の問題です。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要約する</font></font></h3><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PipelineDBは、高性能ストリーミングデータ処理用に設計されています。</font><font style="vertical-align: inherit;">データ自体を保存せずに、大規模なデータセットに対して計算を実行できます。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PipelineDBでは、ストリームでPostgreSQLにデータのストリームを送信するとき、それらを仮想と見なします。</font><font style="vertical-align: inherit;">データは保存されませんが、集計、計算、破棄されます。</font><font style="vertical-align: inherit;">200ギガバイトのサーバーを作成し、ストリームを介してテラバイトのデータを追い出すことができます。</font><font style="vertical-align: inherit;">結果は得られますが、データ自体は破棄されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何らかの理由でTimescaleDBの「CONTINUOUS VIEW」が十分でない場合は、PipelineDBを試してください。</font><font style="vertical-align: inherit;">これは、Apacheライセンスに基づくオープンソースプロジェクトです。</font><font style="vertical-align: inherit;">それはもはや積極的に開発されていませんが、どこにも行きません。</font><font style="vertical-align: inherit;">しかし、状況は変わる可能性があります。Confluentはまだ拡張計画について書いていません。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TimescaleDBとPipelineDBの使用</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PostgreSQLと2つの拡張機能</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用すると、時系列データの大規模な配列を保存および処理できます</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">あなたは多くのアプリケーションを考えることができます。</font><font style="vertical-align: inherit;">私の主題領域からの例-車両監視を見てみましょう。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mx/_k/ru/mx_krumolcfgrlfrraktizshhem.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ナビゲーション機器は、テレメトリーの記録をサーバーに継続的に送信します。</font><font style="vertical-align: inherit;">さまざまなテキストおよびバイナリプロトコルを共通の形式に解析し、特別なトピックでデータをKafkaに送信します。</font><font style="vertical-align: inherit;">そこから、PostgreSQL内のテレメトリデータストリームへのPipelineDBとの統合を行います。</font><font style="vertical-align: inherit;">このストリームは、車両の現在の状態と全体的なフリート分析のビューを更新し、トリガーに基づいて、TimescaleDBハイパーテーブルにテレメトリレコードの記録を引き起こします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
拡張機能には、3つの利点があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リアルタイム分析。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ストレージ時系列データ。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保存されるテレメトリの量を減らします。</font><font style="vertical-align: inherit;">PipelineDBミューテーターを使用して、たとえば1分ごとにデータを集計し、平均値を計算します。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Grafanaには、TimescaleDB機能のサポートが組み込まれています。</font><font style="vertical-align: inherit;">したがって、ボックスから直接、ビジネスメトリックに関するグラフを、座標によってマップ上のトラックまで構築することが可能です。</font><font style="vertical-align: inherit;">分析部門は幸せになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてを自分で「操作」する</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">には、GitHubのデモを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">見</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">て</font></a><font style="vertical-align: inherit;"> &nbsp;、最新のPostgreSQL、TimescaleDB、PipelineDBのアセンブリ内で</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dockerイメージ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を実行し</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">合計</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PostgreSQLでは、さまざまな拡張機能を組み合わせたり、独自のデータ型や関数を追加して特定の問題を解決したりできます。今回のケースでは、TimescaleDBおよびPostGIS拡張機能を使用することで、時系列データの格納と地理空間計算のニーズをほぼ完全にカバーできます。 PipelineDB拡張機能を使用すると、さまざまな分析と統計の継続的な計算を実行できます。JSONB列を使用すると、弱く構造化されたデータをリレーショナルデータベースに格納できます。オープンソースソリューションは頭で十分です-私たちは商用ソリューションを使用しません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの拡張機能は、高可用性ソリューション、バックアップシステム、監視およびログ分析ツールなど、PostgreSQLを取り巻くエコシステムに実質的に制限を課しません。</font><font style="vertical-align: inherit;">JSONB列がある場合はMongoDBは必要ありません。TimescaleDBがある場合はInfluxDBは必要ありません。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">イヴァンの話が好きで、似たようなことを共有したいですか？</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">適用</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で9月7日の前に&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HighLoad ++</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モスクワで。</font><font style="vertical-align: inherit;">プログラムは徐々に埋まっていきます。</font><font style="vertical-align: inherit;">データベースのケースに加えて、アーキテクチャ、最適化、そしてもちろん、高負荷に関するレポートがあります。</font><font style="vertical-align: inherit;">締め切りまでにレポートを提出してください。講演者の間でお待ちしています！</font></font></blockquote></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja464289/index.html">Goパッケージの書き方</a></li>
<li><a href="../ja464291/index.html">過去50年間で最も影響力のある10のプログラミング言語とその作成者</a></li>
<li><a href="../ja464293/index.html">React Reduxでフックは置き換えられますか？</a></li>
<li><a href="../ja464295/index.html">いくつかの新しいJavaScript機能の使用例</a></li>
<li><a href="../ja464299/index.html">0、0、1、0、2、0、2、2、1、6、0、5、0、2、6、5、4、0、5、3、0、3、2、9、0、 4、9、3、6、14、0、6、3、5、15、0、5、3、5 ...</a></li>
<li><a href="../ja464305/index.html">小さい、はい。Firecrackerマイクロ仮想の開梱</a></li>
<li><a href="../ja464307/index.html">Scalaでのマイクロサービスの統合テスト</a></li>
<li><a href="../ja464309/index.html">DIY呼び出しボタン。Raspberry Pi、MajorDoMo、Freeswitch、Linphonec</a></li>
<li><a href="../ja464315/index.html">土の入ったフィルム。Yandexの研究と意味による検索の簡単な歴史</a></li>
<li><a href="../ja464317/index.html">こんばんわプロジェクト</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>