<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏷️ 😽 🛀🏻 映画を推薦する方法と、評価だけに頼るべきではない理由 👤 🤸 🤳🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="映画を見ながら夜を過ごしたいが、どれを選べばよいかわからないとしましょう。 Yandexユーザーは同じ状況にいることが多いため、GoogleのチームはSearch and Airで見つけられる推奨事項を開発します。これは複雑に思われます。ユーザーの評価を取得し、5ポイントを与える可能性のある映画を見...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>映画を推薦する方法と、評価だけに頼るべきではない理由</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/497390/"><img src="https://habrastorage.org/webt/vu/_4/oo/vu_4oolbpa8pde7nsycpg5vpokq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
映画を見ながら夜を過ごしたいが、どれを選べばよいかわからないとしましょう。 Yandexユーザーは同じ状況にいることが多いため、GoogleのチームはSearch and Airで見つけられる推奨事項を開発します。これは複雑に思われます。ユーザーの評価を取得し、5ポイントを与える可能性のある映画を見つけるように車をトレーニングして、既製の映画リストを取得します。しかし、このアプローチは機能しません。どうして？それを今日お話しします。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ちょっとした歴史。 2006年に、NetflixはNetflix Prizeの機械学習コンテストを立ち上げました。突然忘れてしまった場合、同社はまだインターネットでストリーミングしていませんが、DVDで映画をレンタルしています。しかし、それでも、ユーザーに何かを推薦するためにユーザーの評価を予測することが彼女にとって重要でした。したがって、競争の本質：視聴者の評価を予測することは、Netflix推奨システムであるCinematchよりも（RMSEメトリックによると）10％優れています。これは、この種の最初の大規模大会の1つでした。関心は巨大なデータセット（1億以上の評価）と100万ドルの賞金を熱くしました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
競争は2009年に終了しました。</font><font style="vertical-align: inherit;">BellKorのPragmatic ChaosとThe Ensembleのチームは同じ結果（RMSE = 0.8567）でフィニッシュラインに到達しましたが、Ensembleは競合他社よりも20分遅れてソリューションを送信したため、2位になりました。</font><font style="vertical-align: inherit;">結果と仕事は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここにあります</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">しかし、最も興味深いことは異なります。</font><font style="vertical-align: inherit;">専門の会議で繰り返される話を信じている場合、優勝したアルゴリズムは、間もなく開始されたビデオストリーミングサービスの製品には登場しませんでした。</font><font style="vertical-align: inherit;">他の人の決定の理由についてはお話しできませんが、なぜ私たちが同じことをしたのかをお話しします。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">個人の評価</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
かなり長い間、Yandexユーザーは視聴した映画を評価できます。 KinoPoiskだけでなく、検索結果にも表示されます。時間の経過とともに、私たちは数億人の数億人の推定を蓄積してきました。ある時点で、このデータを使用して、ユーザーが映画がどれだけ欲しいかを理解できるようにすることにしました。実際、Netflix Prizeコンテストと同じ問題を解決しました。つまり、ユーザーが映画に与える評価を予測しました。当時、KinoPoiskとIMDBの評価はすでに存在し、人々の評価に基づいて構築されていました。私たちは個人的な評価を作成したので、視覚的な類似性と混乱を避けるために、パーセンテージとして別のスケールを使用することにしました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dd/tk/h7/ddtkh7i3ud_9q5lmqtvw-4ambgc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ちなみに、ポイントスケールとパーセンテージを関連付ける必要性は、別の明らかでない頭痛の種なので、簡単に説明します。</font><font style="vertical-align: inherit;">10ポイントのスケールの場合、各ポイントに10％を使用するように見えます-そしてポイントは帽子の中にあります。</font><font style="vertical-align: inherit;">しかし、違います。</font><font style="vertical-align: inherit;">その理由は心理学と習慣です。</font><font style="vertical-align: inherit;">たとえば、ユーザーの観点から見ると、8/10の評価は80％よりもはるかに優れています。</font><font style="vertical-align: inherit;">これを関連付ける方法は？</font><font style="vertical-align: inherit;">クラウドソーシングで！</font><font style="vertical-align: inherit;">そして私達はそうしました：私達はTolokでタスクを開始しました、そこで、射手は映画の期待を特定のスコアまたは個人的な評価のパーセンテージで説明しました。</font><font style="vertical-align: inherit;">このマークアップに基づいて、ユーザーの期待が維持されるように、スコアの予測をポイントからパーセントに変換する関数を選択しました。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トロクのサンプルクエスト</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/tw/fv/ux/twfvuxxkjd7rnkave0yuudmzs5q.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
映画からの期待を予測することは有用ですが、推奨を作成することも良いでしょう。</font><font style="vertical-align: inherit;">つまり、すぐにその人に良い映画のリストを見せましょう。</font><font style="vertical-align: inherit;">その時点で、多くの人は次のように考えるかもしれません。「そして、ユーザーが視聴していない映画を個人的な評価で分類しましょう。」</font><font style="vertical-align: inherit;">最初はそう思った。</font><font style="vertical-align: inherit;">しかし、それから私は二つの問題を解決しなければなりませんでした。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ツールの問題</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーが特定の映画を検索する場合（または特定のDVDをレンタルしたい場合）、サービスはこの特定の映画の評価を予測する必要があります。まさにこの問題は、RMSEメトリックが使用されたNetflix Prizeコンテストで解決されました。しかし、推奨事項は別の問題を解決します。グレードを推測する必要はありませんが、最終的に視聴される映画を見つける必要があります。そして、RMSEメトリックはこれをうまく機能させません。たとえば、評価が1ではなく2であると予測した場合のペナルティは、4ではなく5の場合とまったく同じです。ただし、システムでは、ユーザーが2に設定した映画は推奨されません。リストベースのメトリックは、Precision @ K、Recall @ K、MRR、NDCGなど、このタスクにはるかに適しています。私は仕方がありませんが、それらについてもう少し詳しく説明します（ただし、メトリックに興味がない場合は、次の段落をスキップしてください）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メトリックから始めましょう。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MRR</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（平均相互順位）。ランキングのどの位置で、テスト期間中にユーザーが操作した（たとえば、視聴した、または賞賛された）映画かを調べます。 MRRメトリックは、そのような映画のユーザー平均の逆位置です。つまり</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi><mi>R</mi><mi>R</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>u</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></munderover><mfrac><mn>1</mn><mrow><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>u</mi></msub></mrow></mfrac></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.7ex" height="4.259ex" viewBox="0 -1132.2 10204.2 1833.9" role="img" focusable="false" style="vertical-align: -1.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-4D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-52" x="1051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-52" x="1811" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-3D" x="2848" y="0"></use><g transform="translate(3626,0)"><g transform="translate(397,0)"><rect stroke="none" width="1056" height="60" x="0" y="220"></rect><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-31" x="496" y="582"></use><g transform="translate(60,-442)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-55" x="278" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-7C" x="1046" y="0"></use></g></g></g><g transform="translate(5367,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJSZ1-2211" x="0" y="0"></use><g transform="translate(1056,521)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-55" x="278" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-7C" x="1046" y="0"></use></g><g transform="translate(1056,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-3D" x="572" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-31" x="1351" y="0"></use></g></g><g transform="translate(7833,0)"><g transform="translate(286,0)"><rect stroke="none" width="1964" height="60" x="0" y="220"></rect><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-31" x="1138" y="582"></use><g transform="translate(60,-403)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-61" x="451" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-6E" x="981" y="0"></use><g transform="translate(1118,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-75" x="737" y="-213"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>R</mi><mi>R</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>U</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>u</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>U</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></munderover><mfrac><mn>1</mn><mrow><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>u</mi></msub></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-1">MRR = \frac{1}{|U|} \sum_{u=1}^{|U|} \frac{1}{rank_u}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。このようなメトリックは、RMSEとは異なり、リスト全体を評価しますが、残念ながら、最初に推測された要素のみを調べます。ただし、この欠点を取り除くためにメトリックを変更するのは簡単です。ユーザーが操作したすべてのフィルムの逆の位置の合計を計算できます。このメトリックは、平均相互ヒットランクと呼ばれます。この測定基準は、問題で推測されたすべての映画を考慮に入れます。ペイアウトの位置kは、推測された映画の場合は1 / kの重みを受け取り、別の映画の場合は0の重みを受け取ることに注意してください。多くの場合、1 / kの代わりに1 / log（k）が使用されます。これは、ユーザーがk位置までスクロールする確率と一致する可能性が高くなります。結果は、DCGメトリック（割引された累積ゲイン）です。</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>D</mi><mi>C</mi><mi>G</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>u</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></munderover><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>o</mi><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi></mrow></munderover><mfrac><mrow><mi>g</mi><mi>a</mi><mi>i</mi><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>o</mi><mi>s</mi></mrow></msub></mrow><mrow><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>,</mo><mi>log</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="37.927ex" height="4.384ex" viewBox="0 -1186 16329.6 1887.7" role="img" focusable="false" style="vertical-align: -1.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-43" x="828" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-47" x="1589" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-3D" x="2653" y="0"></use><g transform="translate(3431,0)"><g transform="translate(397,0)"><rect stroke="none" width="1056" height="60" x="0" y="220"></rect><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-31" x="496" y="582"></use><g transform="translate(60,-442)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-55" x="278" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-7C" x="1046" y="0"></use></g></g></g><g transform="translate(5172,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJSZ1-2211" x="0" y="0"></use><g transform="translate(1056,521)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-55" x="278" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-7C" x="1046" y="0"></use></g><g transform="translate(1056,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-3D" x="572" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-31" x="1351" y="0"></use></g></g><g transform="translate(7805,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJSZ1-2211" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-4E" x="1494" y="675"></use><g transform="translate(1056,-287)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-6F" x="503" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-73" x="989" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-3D" x="1458" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-31" x="2237" y="0"></use></g></g><g transform="translate(10897,0)"><g transform="translate(286,0)"><rect stroke="none" width="5025" height="60" x="0" y="220"></rect><g transform="translate(1421,614)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-67" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-61" x="480" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-69" x="1010" y="0"></use><g transform="translate(958,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-6E" x="0" y="0"></use><g transform="translate(424,-107)"><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-6F" x="503" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-73" x="989" y="0"></use></g></g></g><g transform="translate(60,-442)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-6D"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-61" x="833" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-78" x="1334" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-28" x="1862" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-31" x="2252" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-2C" x="2752" y="0"></use><g transform="translate(2143,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-6C"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-6F" x="278" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-67" x="779" y="0"></use></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-28" x="4310" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-70" x="4700" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-6F" x="5203" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMATHI-73" x="5689" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-29" x="6158" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhg47AFhUBVsKK8NWJ_1-ipEruQeug#MJMAIN-29" x="6548" y="0"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi><mi>C</mi><mi>G</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>U</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>u</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>U</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></munderover><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>o</mi><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi></mrow></munderover><mfrac><mrow><mi>g</mi><mi>a</mi><mi>i</mi><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>o</mi><mi>s</mi></mrow></msub></mrow><mrow><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-2">DCG = \frac{1}{|U|} \sum_{u=1}^{|U|} \sum_{pos=1}^{N} \frac{gain_{pos}}{\max(1, \log(pos))}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">しかし、指標に対するさまざまなユーザーの貢献度は異なります。私たちがすべての映画を推測した人にとっては、何も推測しなかった人にとっては。</font><font style="vertical-align: inherit;">したがって、原則として、このメトリックは正規化されます。</font><font style="vertical-align: inherit;">各ユーザーのDCGをそのユーザーに最適なDCGに分割します。</font><font style="vertical-align: inherit;">結果のメトリックは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NDCG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（正規化された割引累積ゲイン）</font><font style="vertical-align: inherit;">と呼ばれ</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">ランキングの質を評価するために広く使用されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、各タスクには独自のメトリックがあります。</font><font style="vertical-align: inherit;">しかし、次の問題はそれほど明白ではありません。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">選択の問題</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
説明するのは難しいですが、やってみます。人々が</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">普段</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">見</font><font style="vertical-align: inherit;">ている映画ではなく、高い評価を与えていることが</font><font style="vertical-align: inherit;">わかります。珍しい映画の傑作、クラシック、アートハウスが最高の評価を得ていますが、これは仕事の後の夕方に人々を止めることはありません。これに加えて、Yandexのユーザーは、彼らがかつてどこかで見たすべての映画を評価しなかった。そして、最高の評価のみに焦点を合わせると、論理的に見える推奨の映画フィードを取得するリスクが発生し、ユーザーはその品質さえ認識できるかもしれませんが、最終的には何も見なくなります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、これは、個人的な評価で評価し、過去の私の見方について何も知らなかった場合、私の映画フィードは次のようになります。素晴らしい映画。しかし、今日はそれらを確認したくありません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/5y/gz/ot/5ygzotyougvrodtwyb_nlbp03va.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
評価が散らばっていて、評価の高い映画が不足している状況では、評価だけでなく価値を見ることもできます。それでは、評価ではなく、推奨される映画の視聴を予測するように車をトレーニングします。ユーザーがこれを望んでいるので、それは論理的に見えるでしょう。何がうまくいかないのでしょうか？問題は、テープがフィルムで満たされることです。各フィルムは、夕方の簡単な娯楽に非常に適していますが、個人的な評価は低くなります。もちろん、ユーザーはテープに「傑作」がないという事実に注意を払います。つまり、推奨の信頼性が損なわれるため、他の方法では見られるものを見ることはありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、両極端のバランスが必要であることがわかりました。表示の可能性と人による推奨の知覚の両方が考慮されるように、マシンをトレーニングする必要があります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">推奨事項の仕組み</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのシステムは検索の一部であるため、非常に迅速に推奨を作成する必要があります。サービスの応答時間は100ミリ秒未満である必要があります。</font><font style="vertical-align: inherit;">そのため、データの準備段階では、できるだけ多くの負荷の高い操作をオフラインで実行するようにしています。</font><font style="vertical-align: inherit;">レコメンデーションシステムのすべての映画とユーザーは、オブジェクトキー、カウンター、埋め込み（つまり、特定のスペースのベクトル）を含むプロファイル（アカウントと混同しないことが重要です）によって表されます。</font><font style="vertical-align: inherit;">映画のプロファイルはYTで毎日作成され（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「Yt」</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">読みます</font></a><font style="vertical-align: inherit;">）、リクエストに応答するマシンのRAMにロードされます。</font><font style="vertical-align: inherit;">しかし、ユーザーに関しては、すべてが少し複雑です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
毎日、YTでメインユーザープロファイルを作成し、それをYandexストアに送信します。そこから数十ミリ秒でプロファイルを取得できます。しかし、人が積極的にビデオを見て評価すると、データはすぐに古くなります。推奨事項が遅れ始めるのはよくありません。したがって、ユーザーイベントのストリームを読み取り、プロファイルの動的な部分を形成します。人がリクエストを入力すると、リポジトリからのプロファイルを動的プロファイルと組み合わせて単一のプロファイルを取得します。これにより、数秒で現実に遅れることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはオフラインで（つまり、事前に）行われ、今では直接ランタイムに移動します。ここでは、推奨システムは2つのステップで構成されています。映画のデータベース全体のランキングが長すぎるため、最初のステップでは数百の候補を選択するだけです。つまり、視聴者にとって興味のある映画を見つけます。これには、人気のある絵と一部の埋め込みでユーザーに近い絵の両方が含まれます。最近傍をすばやく見つけるためのアルゴリズムはいくつかあります。HNSW（階層型ナビゲート可能小世界）を使用します。これにより、数ミリ秒でユーザーに最も近い映画が見つかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目のステップでは、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">CatBoost</font></a><font style="vertical-align: inherit;">を使用して、映画、ユーザー、ユーザーと映画のペア、および候補のランク付けによって機能（要素とも呼ばれることもあります）を抽出します</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">思い出させてください。私たちはすでにビューだけでなく、推奨事項の他の品質特性にも焦点を当てる必要があることを認識していたため、ランク付けのために、さまざまなターゲット用にトレーニングされたいくつかのCatBoostモデルの組み合わせになりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
候補を見つけるには、いくつかの行列分解からの埋め込みを使用します。評価を予測するALSのクラシックバージョンから、SVD ++に基づくより複雑なバリエーションまで。</font><font style="vertical-align: inherit;">ランキングの機能として、単純なユーザーイベントカウンターとフィルムの両方、さまざまなイベントのCTR、およびより複雑な事前トレーニング済みモデルが使用されます。</font><font style="vertical-align: inherit;">たとえば、ALS予測も機能として機能します。</font><font style="vertical-align: inherit;">最も有用なモデルの1つは、Recommender DSSMニューラルネットワークです。これについては、もう少し後で説明します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">推奨DSSM</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DSSMは2タワーのニューラルネットワークです。各タワーは独自の埋め込みを構築し、埋め込み間のコサイン距離が考慮されます。この数値がネットワーク出力です。つまり、ネットワークは、左右の塔にあるオブジェクトの近接性を評価することを学習します。同様のニューラルネットワークは、たとえば、</font><font style="vertical-align: inherit;">クエリに関連するドキュメントを見つけるために</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Web検索</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で使用され</font><font style="vertical-align: inherit;">ます。検索タスクでは、一方のタワーにリクエストが送信され、もう一方のタワーにドキュメントが送信されます。私たちのネットワークでは、リクエストの役割はユーザーが担当し、映画はドキュメントとして機能します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
映画の塔は、映画に関するデータに基づいて埋め込みを構築します。これは、タイトル、説明、ジャンル、国、俳優などです。ネットワークのこの部分は、検索の部分と非常に似ています。ただし、視聴者には彼のストーリーを使用したいと思います。これを行うには、イベントの瞬間からのフェードイン時間を使用して、ストーリーからの映画の埋め込みを集計します。次に、埋め込み全体に加えて、ネットワークのいくつかのレイヤーを適用し、結果としてサイズ400の埋め込みを取得します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lt/3k/v0/lt3kv0xtsbzqiyxq_333j3sgkua.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
埋め込み時にユーザーの履歴全体をすぐに考慮すると、トレーニングが大幅に遅くなります。</font><font style="vertical-align: inherit;">したがって、私たちはトリックに行き、ネットワークを2段階で学習します。</font><font style="vertical-align: inherit;">まず、より簡単なInnerDSSMについて学びます。</font><font style="vertical-align: inherit;">入り口では、イベントのタイプ（ビュー、評価など）に分割せずに、ユーザーの履歴から最後の50のイベントのみを受け取ります。</font><font style="vertical-align: inherit;">次に、結果のInnerDSSMをユーザーの履歴全体で再トレーニングしますが、イベントタイプに分類します。</font><font style="vertical-align: inherit;">したがって、実行時に使用されるOuterDSSMを取得します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
額にランタイムネットワークを使用するには、非常に多くのコンピューティングリソースが必要です。</font><font style="vertical-align: inherit;">したがって、映画タワーからの埋め込みをデータベースに保存し、ユーザーの履歴に応じた埋め込みをほぼリアルタイムで更新します。</font><font style="vertical-align: inherit;">したがって、リクエストの処理中に、OuterDSSMのほんの一部を適用してコサインを計算するだけでよく、これにはそれほど時間はかかりません。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現在、私たちの推奨事項は、検索（たとえば、リクエスト</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[見るもの]による</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）、Yandex.Airサービスで</font><font style="vertical-align: inherit;">すでに利用可能で</font><font style="vertical-align: inherit;">あり、このテクノロジーの適応バージョンがYandex.Stationsでも使用されています。</font><font style="vertical-align: inherit;">しかし、これは私たちがリラックスできるという意味ではありません。</font><font style="vertical-align: inherit;">私たちは常に新しいモデルをトレーニングし、ますます多くのデータを適用し、トレーニングへの新しいアプローチと新しい品質指標を試します。</font><font style="vertical-align: inherit;">私の意見では、地域が古ければ古いほど、開発が難しくなります。</font><font style="vertical-align: inherit;">しかし、これは専門家の主な関心事です。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja497376/index.html">鼻が成長しないように赤い頬をどうするか</a></li>
<li><a href="../ja497382/index.html">パンデミック時のアジャイルチームの8つの困難：「Ndagwurugwu nke anya mmiri」、ụjọ、oke iwe、agọnar、COVID-19</a></li>
<li><a href="../ja497384/index.html">リモートモードでサーバーへの安全なアクセスを確立する方法</a></li>
<li><a href="../ja497386/index.html">VKフェローシップフェローは、遠隔学習、規律、社会化の未来について語ります</a></li>
<li><a href="../ja497388/index.html">ゼロから100万番目のシューティングゲーム：インディーデベロッパーの道</a></li>
<li><a href="../ja497392/index.html">学生からソフトウェアエンジニアに成長するには？</a></li>
<li><a href="../ja497394/index.html">4月にコンピュータサイエンスコースが無料で利用できる10のリソース</a></li>
<li><a href="../ja497396/index.html">同僚：味方でも味方でもない、どうやって？</a></li>
<li><a href="../ja497398/index.html">AMD EPYC Rome 7x32サーバープロセッサ-シングルコアのパフォーマンスを記録</a></li>
<li><a href="../ja497402/index.html">Pythonプログラミング言語を作成するには？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>