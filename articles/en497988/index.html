<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📭 🌖 ⏩ React Application Performance Profiling 🤙🏾 🧑🏿‍🤝‍🧑🏻 👲🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today we’ll talk about measuring the performance of rendering React components using the React Profiler API. We will also evaluate interactions with t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>React Application Performance Profiling</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/497988/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Today we’ll talk about measuring the performance of rendering React components using the React Profiler API. </font><font style="vertical-align: inherit;">We will also evaluate interactions with the component using the new experimental Interaction Tracing API. </font><font style="vertical-align: inherit;">In addition, we will use the User Timing API to take our own measurements. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will use the React Movies Queue application as a platform for experiments.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5ef/452/51a/5ef45251ae6a761a3fec98e14c4eefa1.jpg"></div></a><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">React Movies Queue App</font></font></font></i><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">React Profiler API</font></font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The React Profiler API is</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> designed to measure rendering performance and helps identify application performance bottlenecks.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> React, { Fragment, unstable_Profiler <span class="hljs-keyword">as</span> Profiler} <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The component </font></font><code>Profiler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">accepts a callback </font></font><code>onRender</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">as a property. </font><font style="vertical-align: inherit;">It is called every time a component in the profiled tree commits an update.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> Movies = <span class="hljs-function">(<span class="hljs-params">{ movies, addToQueue }</span>) =&gt;</span> (<font></font>
&nbsp;&nbsp;&lt;Fragment&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Profiler id="Movies" onRender={callback}&gt;<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let’s, for test purposes, try to measure the time required to render parts of a component </font></font><code>Movies</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Here is how it looks.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/10a/9d0/3ec/10a9d03ece4b7636876ab9b72998dea1.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The React Movies Queue app and Movies research using the React developer</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
callback tools</font></font><code>onRender</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">accept parameters that describe what is being rendered and the time it takes to render. </font><font style="vertical-align: inherit;">This includes the following:</font></font><br>
<br>
<ul>
<li><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Property </font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">from the component tree </font></font><code>Profiler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for which the change was committed.</font></font></li>
<li><code>phase</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: or </font></font><code>mount</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(if the tree was mounted), or </font></font><code>update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(if the tree was re-rendered).</font></font></li>
<li><code>actualDuration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: The time taken to render a fixed update.</font></font></li>
<li><code>baseDuration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Estimated time to render the entire subtree without caching.</font></font></li>
<li><code>startTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: The time React started rendering this update.</font></font></li>
<li><code>commitTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: the time when React committed this update.</font></font></li>
<li><code>interactions</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Many “interactions” for this update.</font></font></li>
</ul><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> callback = <span class="hljs-function">(<span class="hljs-params">id, phase, actualTime, baseTime, startTime, commitTime</span>) =&gt;</span> {
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${id}</span>'s <span class="hljs-subst">${phase}</span> phase:`</span>);
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Actual time: <span class="hljs-subst">${actualTime}</span>`</span>);
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Base time: <span class="hljs-subst">${baseTime}</span>`</span>);
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Start time: <span class="hljs-subst">${startTime}</span>`</span>);
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Commit time: <span class="hljs-subst">${commitTime}</span>`</span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We’ll load the page and go to the Chrome Developer Tools console. </font><font style="vertical-align: inherit;">There we should see the following.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cc8/baf/9c9/cc8baf9c9500419f587874bae69acf96.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Profiling results in the developer tools</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
We can also open the React developer tools, go to the bookmark</font></font><code>Profiler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and visualize information about the time of component rendering. </font><font style="vertical-align: inherit;">Below is a visualization of this time in the form of a flame graph.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c56/138/d61/c56138d6154866df33b45014966aa2cb.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Working with profiling results in React Developer Tools</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
I also like to use the view mode here</font></font><code>Ranked</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which provides an ordered view of the data. </font><font style="vertical-align: inherit;">As a result, the components that take the most time to render are at the top of the list.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/224/324/1b6/2243241b6de115dbbd7c0a94270d3868.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Viewing profiling results in Ranked mode.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In addition, you can use several components to take measurements in different parts of the application</font></font><code>Profiler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> React, { Fragment, unstable_Profiler <span class="hljs-keyword">as</span> Profiler} <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;<font></font>
<font></font>
render(<font></font>
&nbsp;&nbsp;<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">Profiler</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"Header"</span> <span class="hljs-attr">onRender</span>=<span class="hljs-string">{callback}</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">Header</span> {<span class="hljs-attr">...props</span>} /&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">Profiler</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">Profiler</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"Movies"</span> <span class="hljs-attr">onRender</span>=<span class="hljs-string">{callback}</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">Movies</span> {<span class="hljs-attr">...props</span>} /&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">Profiler</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">App</span>&gt;</span></span><font></font>
);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And how to analyze user interactions with components?</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interaction Tracing API</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It would be nice to be able to track user interactions with the application interface (like clicks on items). </font><font style="vertical-align: inherit;">This will allow you to find answers to interesting questions like this: "How long did it take to update the DOM after clicking on this button?". </font><font style="vertical-align: inherit;">Fortunately, React has experimental support for analyzing user interactions with the application using the Interaction Tracing API from the new </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scheduler</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> package </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">You can read the documentation on it </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Information about the interactions between the user and the application is provided with descriptions (for example, “The user clicked on the Add to Cart button”) and time stamps. </font><font style="vertical-align: inherit;">In addition, when setting up analysis of interactions, callbacks are used in which actions corresponding to one or another interaction are performed. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In our application there is a button </font></font><code>Add Movie To Queue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">on which the icon is displayed </font></font><code>+</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">It serves to add movies to the viewing queue.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6f7/75c/af2/6f775caf25ad484e73ae70354752b879.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Button for adding a movie to the viewing queue</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Here is an example of code that monitors status updates for this user interaction with the application:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { unstable_Profiler <span class="hljs-keyword">as</span> Profiler } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> { render } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-dom"</span>;
<span class="hljs-keyword">import</span> { unstable_trace <span class="hljs-keyword">as</span> trace } <span class="hljs-keyword">from</span> <span class="hljs-string">"scheduler/tracing"</span>;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{<font></font>
&nbsp;&nbsp;addMovieButtonClick = <span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span> {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;trace(<span class="hljs-string">"Add To Movies Queue click"</span>, performance.now(), () =&gt; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">this</span>.setState({ <span class="hljs-attr">itemAddedToQueue</span>: <span class="hljs-literal">true</span> });<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;});<font></font>
&nbsp;&nbsp;};<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We can record information about this interaction and learn about its duration by contacting the React developer tools.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d93/fc1/ea0/d93fc1ea00661d926e2f9a183b32ebb7.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analysis of user interaction with an application element</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Using the Interaction Tracing API, you can also collect information about the first component rendering:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { unstable_trace <span class="hljs-keyword">as</span> trace } <span class="hljs-keyword">from</span> <span class="hljs-string">"scheduler/tracing"</span>;<font></font>
<font></font>
trace(<span class="hljs-string">"initial render"</span>, performance.now(), () =&gt; {<font></font>
&nbsp;&nbsp;&nbsp;ReactDom.render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>, <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"app"</span>));<font></font>
});<font></font>
</code></pre><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b3c/4ab/310/b3c4ab310fd105fc83697e4a7b5a61fb.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analysis of the first rendering of the component</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
The author of the API gives other</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> examples of</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> its use. </font><font style="vertical-align: inherit;">For example, illustrating the profiling of asynchronous tasks.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puppeteer</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For automation of testing user interaction with application elements, the use of </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puppeteer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> may seem interesting </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">This is a Node.js library that provides access to a high-level API designed to control a Chrome browser without a user interface using the DevTools protocol. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When using Puppeteer, the developer is provided with helper </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">methods</font></font></a> <code>tracing.start()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><code>tracing.stop()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">designed to collect DevTools performance indicators. </font><font style="vertical-align: inherit;">Below is an example of using these mechanisms to collect data about what happens when you click on the button of interest to us.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> puppeteer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'puppeteer'</span>);<font></font>
<font></font>
<span class="hljs-function">(<span class="hljs-params"><span class="hljs-keyword">async</span> (</span>) =&gt;</span> {
&nbsp;&nbsp;<span class="hljs-keyword">const</span> browser = <span class="hljs-keyword">await</span> puppeteer.launch();
&nbsp;&nbsp;<span class="hljs-keyword">const</span> page = <span class="hljs-keyword">await</span> browser.newPage();
&nbsp;&nbsp;<span class="hljs-keyword">const</span> navigationPromise = page.waitForNavigation();
&nbsp;&nbsp;<span class="hljs-keyword">await</span> page.goto(<span class="hljs-string">'https://react-movies-queue.glitch.me/'</span>)
&nbsp;&nbsp;<span class="hljs-keyword">await</span> page.setViewport({ <span class="hljs-attr">width</span>: <span class="hljs-number">1276</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">689</span> });
&nbsp;&nbsp;<span class="hljs-keyword">await</span> navigationPromise;<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-keyword">const</span> addMovieToQueueBtn = <span class="hljs-string">'li:nth-child(3) &gt; .card &gt; .card__info &gt; div &gt; .button'</span>;
&nbsp;&nbsp;<span class="hljs-keyword">await</span> page.waitForSelector(addMovieToQueueBtn);<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-comment">//  ...</span>
&nbsp;&nbsp;<span class="hljs-keyword">await</span> page.tracing.start({ <span class="hljs-attr">path</span>: <span class="hljs-string">'profile.json'</span> });
&nbsp;&nbsp;<span class="hljs-comment">//   </span>
&nbsp;&nbsp;<span class="hljs-keyword">await</span> page.click(addMovieToQueueBtn);
&nbsp;&nbsp;<span class="hljs-comment">//  </span>
&nbsp;&nbsp;<span class="hljs-keyword">await</span> page.tracing.stop();<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-keyword">await</span> browser.close();<font></font>
})()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now, having loaded the file </font></font><code>profile.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">into the </font></font><code>Performance</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">developer’s toolbar, we can see what function calls were triggered by the click of a button.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3ed/42f/623/3ed42f62350db7d110d4ba53c80973b6.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analysis of the consequences of clicking the button</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
If you are interested in the topic of analysis of component performance - take a look at</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> this</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> material.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">User Timing API</font></font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The User Timing API</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> allows the developer to create custom performance metrics using highly accurate time stamps. </font><font style="vertical-align: inherit;">The method </font></font><code>window.performance.mark()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">creates a timestamp to which the name is assigned. </font><font style="vertical-align: inherit;">The method </font></font><code>window.performance.measure()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allows you to find out the time elapsed between two measurements.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">//     </span>
performance.mark(<span class="hljs-string">'Movies:updateStart'</span>);
<span class="hljs-comment">//  </span><font></font>
<font></font>
<span class="hljs-comment">//     </span>
performance.mark(<span class="hljs-string">'Movies:updateEnd'</span>);<font></font>
<font></font>
<span class="hljs-comment">//        </span>
performance.measure(<span class="hljs-string">'moviesRender'</span>, <span class="hljs-string">'Movies:updateStart'</span>, <span class="hljs-string">'Movies:updateEnd'</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When profiling a React application using the </font></font><code>Performance</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chrome Developer Tools </font><font style="vertical-align: inherit;">tab </font><font style="vertical-align: inherit;">, you can find a section </font></font><code>Timing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filled with temporary metrics regarding React components. </font><font style="vertical-align: inherit;">React, during rendering, can publish this information using the User Timing API.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ed0/f07/ebb/ed0f07ebb5939839c088bc5d56e4b330.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Performance tab of the Chrome developer tools</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Note that the User Timings APIs are removed from the React DEV assemblies, replacing it with the React Profiler API, which provides more accurate timestamps. </font><font style="vertical-align: inherit;">Perhaps in the future support for this API will be returned by doing it for those browsers that support the User Timing Level 3 specification.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On the Internet, you may find React sites that use the User Timing API to determine their own metrics. </font><font style="vertical-align: inherit;">This includes, for example, the Reddit</font></font><code>Time to first post title visible</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">metric and the Spotify metric</font></font><code>Time to playback ready</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/18a/28a/c19/18a28ac19bf3b14050cde0731cf09e71.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Special metrics used on React sites</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Metrics created by the User Timing API</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> are</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> conveniently</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"> displayed</font></a><font style="vertical-align: inherit;"> in the</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lighthouse</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> panel of the</font><font style="vertical-align: inherit;">Chrome developer tools.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9b1/b97/961/9b1b979616527fd88511ecbadcd0a260.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Metrics in the Lighthouse panel</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
For example, the latest versions of</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Next.js </font></font></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">include</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> custom metrics and mechanisms for measuring many different events. </font><font style="vertical-align: inherit;">Including the following:</font></font><br>
<br>
<ul>
<li><code>Next.js-hydration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: time required to bring pre-rendered markup to working condition.</font></font></li>
<li><code>Next.js-nav-to-render</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: The time from the start of navigation to the start of rendering.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All these measurements are displayed in the area </font></font><code>Timings</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/248/8c5/ee9/2488c5ee9d6bd6ccf9da8e6c36436c26.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analysis of Next.js Metrics</font></font></font></i><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Developer Tools and Lighthouse</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I remind you that Lighthouse and the </font></font><code>Performance</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chrome Developer Toolbar can be used to deeply analyze the loading process and the performance of React applications. </font><font style="vertical-align: inherit;">Here you can find metrics that particularly affect the perception of pages by users.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ce2/5c7/2ee/ce25c72eedd5c79edd5dbc1a42685b10.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Analysis of page performance </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Those working with React might like the fact that they will have new metrics at their disposal - like the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Total Blocking Time</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (TBT) </font><font style="vertical-align: inherit;">metric </font><font style="vertical-align: inherit;">, which gives information about how long the page is in non-interactive mode until the moment when it can reliably work in interactive mode ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Time to Interactive</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Here are the TBT indicators (“before” and “after”) for an application that employs experimental competitive mode, the use of which helps the application to adapt to the features of the environment in which it is running.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9b7/074/96d/9b707496d500da0883027da3a571a030.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modify TBT</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
These tools are useful in analyzing application performance bottlenecks, such as</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tasks</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that take a long time to complete, delaying the application’s online transition. </font><font style="vertical-align: inherit;">For example, this may relate to an analysis of the application’s reaction speed to button presses.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/98b/3ac/803/98b3ac8031d84cdfb9765fde2f399a70.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analysis of the</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Lighthouse</font><i><font color="#999999"><font style="vertical-align: inherit;"> application</font></font></i><font style="vertical-align: inherit;"> , in addition, gives React developers a lot of specific tips on a lot of issues. </font><font style="vertical-align: inherit;">Below is the analysis result in</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lighthouse 6.0</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Here, the</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Remove unused JavaScript</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> section is opened</font><font style="vertical-align: inherit;">, which reports on unused JavaScript code that is loaded into the application, which can be imported using</font></font><code>React.lazy()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1e3/9b2/f3a/1e39b2f3a323a74744ee16e68550c6c2.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyzing an application in Lighthouse</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Applications are always useful to test on hardware, which is most likely available to its end users. </font><font style="vertical-align: inherit;">I often rely on</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Webpagetest</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> RUM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CrUX</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> data</font><font style="vertical-align: inherit;">in such matters</font><font style="vertical-align: inherit;">, which allow me to get more complete information about application performance. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dear readers! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How do you research the performance of your React applications?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/iq/fi/b4/iqfib45pgphfrxv--zfemt0qnmw.jpeg"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en497968/index.html">Web Developer Resources: APIs and UI Elements</a></li>
<li><a href="../en497980/index.html">How much water has leaked? We solve the problem by a moonwalk on Haskell</a></li>
<li><a href="../en497982/index.html">Functional and process approach to management. How and what to manage?</a></li>
<li><a href="../en497984/index.html">Migrating from reCAPTCHA to hCaptcha in Cloudflare</a></li>
<li><a href="../en497986/index.html">Monitoring all memory used by a webpage: performance.measureMemory ()</a></li>
<li><a href="../en497990/index.html">PostgreSQL: Development of extensions (functions) in C language</a></li>
<li><a href="../en497994/index.html">Language mechanics escape analysis</a></li>
<li><a href="../en497996/index.html">You do not want to strengthen immunity. Or the extremes of the human body</a></li>
<li><a href="../en498000/index.html">Things I would like to know before developing my own game</a></li>
<li><a href="../en498002/index.html">Pocket Guide to the Z3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>