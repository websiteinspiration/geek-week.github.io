<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌠 💞 🧙 L'histoire de la façon dont j'ai automatisé l'appartement en utilisant Node-RED. Partie II 🆘 🙆🏼 📁</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La suite tant attendue du post sur l'automatisation de l'appartement . Dans cette partie, je parlerai de l'éclairage, d'un système multimédia et de ca...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>L'histoire de la façon dont j'ai automatisé l'appartement en utilisant Node-RED. Partie II</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tinkoff/blog/489774/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">suite</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tant attendue </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">du post sur l'automatisation de l'appartement</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dans cette partie, je parlerai de l'éclairage, d'un système multimédia et de capteurs de sécurité.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/89/pw/1w/89pw1w8yo0rpgru9rx1cckulooc.png"><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Éclairage</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour contrôler l'éclairage, plusieurs composants sont utilisés:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rideaux motorisés;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">éclairage dimmable.</font></font></li>
</ul><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Éclat</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La lumière dans les chambres est divisée en deux zones. </font><font style="vertical-align: inherit;">J'utilise des lampes LED dimmables ikeev. </font><font style="vertical-align: inherit;">J'utilise trois modules de contrôle: </font></font><br>
<img src="https://habrastorage.org/webt/4h/94/fp/4h94fp3qxcxmwpmqqi2kmeecuuo.jpeg" alt="Gradateur intégré FIBARO Dimmer 2"><br>
<font color="#909090"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Built-in gradateur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIBARO Dimmer 2</font></font></a></font><br>
<br>
<img src="https://habrastorage.org/webt/7n/tn/sh/7ntnshtkobrl2nsbrlijuj5ujre.jpeg" alt="Double relais intégré FIBARO Double Switch 2x1.5kW"><br>
<font color="#909090"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> intégré à </font><font style="vertical-align: inherit;">double relais </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIBARO Double 2x1.5kW de commutation</font></font></a></font><br>
<br>
<img src="https://habrastorage.org/webt/av/ju/nz/avjunzs_vw57crfbzkqcrlsc-sa.jpeg" alt="Relais intégré FIBARO Single Switch 2.5kW"><br>
<font color="#909090"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Relais intégré </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIBARO Commutateur unique 2.5kW</font></font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dimmer peut choisir automatiquement un procédé de gradation (sur les bords d' </font><font style="vertical-align: inherit;">attaque et de </font><font style="vertical-align: inherit;">fuite de la phase) et calibrage de minimum et maximum de </font><font style="vertical-align: inherit;">luminosité. </font><font style="vertical-align: inherit;">Étant donné que j'avais un système à trois fils à l'avance pour toutes les prises, je n'ai pas eu à utiliser de dérivation. </font><font style="vertical-align: inherit;">Les lampes LED ne scintillent pas et ne s'allument pas en l'absence de tension. </font><font style="vertical-align: inherit;">Pour les modules dimmables, j'utilise des commutateurs de sonnerie afin que vous puissiez régler la luminosité. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9v/f7/dl/9vf7dlpauw3strd9emtimu-ct7w.png" alt="     "><br>
<font color="#909090"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schéma de câblage du gradateur à trois fils</font></font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici comment ça fonctionne:</font></font><br>
<br>
<ul>
<li>  -    ,       (     ).</li>
<li>      -    ,          —    .         .      ,      .</li>
<li>      ,   ,   .        —   .</li>
<li>   ,         .    ,    1% .</li>
<li>      ,    15   .</li>
<li>    ,   .</li>
</ul><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/yj/wi/w2/yjwiw2pdfhu75m12gjyckm77l4e.png" alt="  "></a><br>
<font color="#909090">  </font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/ll/46/nj/ll46nj_cya6jsqp5psnpvs1mzbc.png" alt="  "></a><br>
<font color="#909090">  </font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/dl/9h/jp/dl9hjpmwyo23zbxv7drmykp9sfm.png" alt="  "></a><br>
<font color="#909090">  </font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/kg/cl/md/kgclmdshmkmuagjrnidhbh40mhu.png" alt="  "></a><br>
<font color="#909090">  </font><br>
<br>
<h3></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme je l'ai écrit plus tôt, toutes les fenêtres de mon appartement donnent sur une avenue animée avec des lumières vives. Pour résoudre le problème de la lumière vive des lampes la nuit ou en été du soleil brillant, j'utilise des volets roulants motorisés. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au début, je voulais acheter des kits prêts à l'emploi, mais les prix étaient très élevés et je n'aimais pas le schéma de couleurs. Cette idée a dû être abandonnée et assembler plusieurs ensembles par eux-mêmes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur les moteurs 220 V, le choix était restreint: le Somfy français ou le Dooya chinois. Somfy est plus silencieux, mais aussi plus cher, le choix s'est donc porté sur les moteurs Dooya DM35S. Je les ai commandés avec des attaches sur le "Aliexpress". Le moteur possède deux interrupteurs de fin de course qui règlent la position maximale et minimale. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qj/yw/06/qjyw064wkqndni2rppwdvzzkdz0.jpeg" alt="  "><br>
<font color="#909090"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moteur avec supports</font></font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le problème suivant était le tuyau pour enrouler les rideaux. Selon les règles de l'e-mail, vous pouvez envoyer un colis ne dépassant pas 180 cm, et l'une des fenêtres que j'ai a plus de 2 mètres. Sur le marché de la construction le plus proche, j'ai trouvé un tuyau en aluminium du diamètre souhaité - 50 mm. Après avoir installé les moteurs dans les tuyaux, il reste à trouver des rideaux occultants. J'ai commandé le tissu dans mes tailles à "Aliexpress" après avoir convenu avec le vendeur qu'il m'enverrait uniquement le tissu, sans mécanismes. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5j/cy/pm/5jcypmbghomntcc_bolirecpmya.jpeg" alt="  "><br>
<font color="#909090"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le rideau fixe assemblé Les</font></font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
rideaux sont commandés à l' </font><font style="vertical-align: inherit;">aide du </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rouleau FIBARO obturateur 2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> module de commande de store Z-Wave. </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">Persienne </font></a></font><br>
<br>
<img src="https://habrastorage.org/webt/p-/yn/u2/p-ynu2giqo5wktxhwyb3h7onz0u.jpeg" alt="  "><br>
<font color="#909090"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">module de commande</font></font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le module est intégré dans la prise. Pour de tels modules, il est conseillé de poser immédiatement des douilles profondes pour pousser le module, les fils et l'interrupteur. Le module a suffisamment de paramètres, y compris la réponse aux alarmes, le calcul de la consommation d'énergie, l'étalonnage avec des interrupteurs de fin de course. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ow/bc/ub/owbcubpc-6tca4tltprsmlj8s74.jpeg" alt=" "><br>
<font color="#909090"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interrupteur assemblé Des</font></font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
rideaux sont installés dans chaque pièce et dans la cuisine. Vous pouvez contrôler les rideaux soit par les commutateurs situés à côté d'eux, soit en utilisant une interface ou un script. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les rideaux s'abaissent automatiquement lorsque le crépuscule s'installe et que les lumières s'allument dans la rue. Ils augmentent en fonction de l'heure programmée pour chaque chambre en semaine et le week-end. S'il fait sombre à l'extérieur, la lumière commence à s'allumer en douceur dans la pièce où le rideau est baissé.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les jours ouvrés et les week-ends sont calculés selon le calendrier de production téléchargé. </font><font style="vertical-align: inherit;">Vous pouvez reconfigurer l'heure le lendemain pour chaque pièce à l'aide de la commande télégramme. </font><font style="vertical-align: inherit;">Avant de plier les rideaux en fonction du «réveil», un message de télégramme arrive avec la possibilité de confirmer, d'annuler et de reprogrammer pendant 30 minutes. </font><font style="vertical-align: inherit;">Si l'action ne suit pas, les rideaux se replient automatiquement. </font><font style="vertical-align: inherit;">Les jours de beau temps, les rideaux règlent automatiquement leur position en fonction de l'éclairage de la pièce et de l'heure, et vérifient également si la lumière est allumée ou non. </font><font style="vertical-align: inherit;">Dès réception de la commande «Vacances», tous les rideaux de toutes les pièces sont baissés. </font><font color="#909090"><font style="vertical-align: inherit;">Rideau de </font></font><font color="#909090"><font style="vertical-align: inherit;">gestion Scénario de </font></font><font color="#909090"><font style="vertical-align: inherit;">gestion rideau Scénario</font></font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/-w/j0/na/-wj0na6ajgmspxvn9ul-vfxesri.png" alt="  "></a><br>
<font color="#909090"><font style="vertical-align: inherit;"></font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/vj/1h/6z/vj1h6z5-dl53n-44smy6edp89iq.png" alt="  "></a><br>
<font color="#909090"><font style="vertical-align: inherit;"></font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/dsvjkFMLkcQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<font color="#909090"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple de travail</font></font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Système multimédia</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai de nombreux appareils multimédias avec différentes télécommandes dans le salon, et je voulais les contrôler avec un seul bouton. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur Internet, j'ai trouvé des codes IR séparés pour allumer et éteindre l'amplificateur, le téléviseur et le séparateur HDMI. À l'aide du </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">script</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Python </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">pronto_broadlink,</font></a><font style="vertical-align: inherit;"> ils ont été transcodés en base64, puis convertis en un tableau d'octets et écrits dans la base de code IR. Par conséquent, il n'est plus nécessaire de savoir maintenant dans quel état se trouve l'appareil: vous pouvez simplement renvoyer le signal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Étant donné que mon amplificateur est assez ancien et ne sait pas comment traiter une image 4K via HDMI, j'ai acheté un séparateur HDMI. Il vous permet de diviser le signal vidéo et audio en deux HDMI séparés: l'un d'eux est connecté à l'amplificateur, le second au téléviseur. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yd/u_/4y/ydu_4yehplzjy-aqnc_lohuxbwo.jpeg" alt="   "><br>
<font color="#909090"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amplificateur et autres appareils</font></font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour le moment, j'ai deux sources audio et vidéo: un ordinateur de bureau et un serveur. Depuis l'interface, vous pouvez allumer tous les appareils pour la lecture avec un seul bouton, dans un seul cas, la réception du signal sera configurée sur le répartiteur du serveur et dans le second - de l'ordinateur. À l'avenir, il est prévu de connecter les consoles de jeux au répartiteur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si tout le monde quitte la maison, tous les appareils multimédias sont éteints. </font><font color="#909090"><font style="vertical-align: inherit;">Scène de contrôle des médias</font></font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/6e/li/w3/6eliw3ospeig-4jdz0vzibq3scq.png" alt="  "></a><br>
<font color="#909090"><font style="vertical-align: inherit;"></font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le système de présence fonctionne sur 6 détecteurs de mouvement et un détecteur d'ouverture de porte avant. </font><font style="vertical-align: inherit;">Si, après l'ouverture et la fermeture de la porte, aucun capteur de présence ne s'est déclenché, un message sera envoyé à Telegram à un certain intervalle avec confirmation. </font><font style="vertical-align: inherit;">Si aucune action n'est entreprise dans les deux minutes ou si le bouton «Ok» est enfoncé, le système passe en mode «Hors domicile». </font><font style="vertical-align: inherit;">Si un mouvement se produit à ce moment, la commande est annulée et le message est supprimé. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai essayé d'utiliser BLE, mais dans mon cas, cela ne fonctionnait pas très stable et dépendait fortement de l'émetteur du téléphone. </font><font color="#909090"><font style="vertical-align: inherit;">Détection automatique de présence</font></font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/r_/if/x8/r_ifx8nmt01pioisfqkdalu35x8.png" alt="  "></a><br>
<font color="#909090"><font style="vertical-align: inherit;"></font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Capteurs de sécurité</font></font></h3><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Des</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
dispositifs de verrouillage </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">Gidrolock</font></a><font style="vertical-align: inherit;"> sont installés sur les conduites d'eau </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Lorsque le fil de commande est court-circuité en phase, l'actionneur ferme le robinet; lorsqu'il est déconnecté, il s'ouvre. </font><font style="vertical-align: inherit;">Les deux variateurs sont connectés à un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relais</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> intégré </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">Philio à</font></a><font style="vertical-align: inherit;"> contact sec. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ys/tx/3i/ystx3iuuvzjpm_yso_wthzk_g5u.jpeg" alt=" Gidrolock"><br>
<font color="#909090"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'entraînement du</font></font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
relais </font><font color="#909090"><font style="vertical-align: inherit;">Gidrolock est</font></font><font style="vertical-align: inherit;"> contrôlé par des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">capteurs NEO Coolcam</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Z-Wave </font><font style="vertical-align: inherit;">situés dans les zones de fuites potentielles. </font><font style="vertical-align: inherit;">Tous les capteurs sont directement associés au relais, de sorte que l'eau s'arrête sans la participation du contrôleur. </font><font style="vertical-align: inherit;">Pour empêcher le robinet de devenir aigre, toutes les deux semaines la nuit, il s'ouvre et se ferme automatiquement. </font><font color="#909090"><font style="vertical-align: inherit;">Diagramme d'automatisation de lecteur</font></font><font style="vertical-align: inherit;"> 
lorsque </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">Philio fume un capteur</font></a></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/d6/oi/wi/d6oiwiu4axhpwaizc46i4ongyeq.png" alt="  "></a><br>
<font color="#909090"><font style="vertical-align: inherit;"></font></font><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la ventilation est coupée pour ne pas gonfler le feu. </font><font style="vertical-align: inherit;">En même temps, un message est envoyé à la discussion par télégramme et le capteur grince de façon dégoûtante.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autres capteurs et appareils</font></font></h4><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Capteur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6 en 1 Multisensor Aeotec Multisensor 6</font></font></a></li>
<li><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">Capteur d'</font></a><font style="vertical-align: inherit;"> ouverture </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NEO Coolcam</font></font></a></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autoriser le serveur</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce module est une implémentation simple d'un service d'autorisation. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe deux méthodes http: l'une vérifiera si la demande provient du réseau interne et si oui, elle autorisera l'utilisateur en lui délivrant un jeton JWT. </font><font style="vertical-align: inherit;">Le jeton JWT est chiffré à l'aide de RSA 256, la clé privée doit être enregistrée dans le fichier à côté de lui. </font><font style="vertical-align: inherit;">Si la demande ne provient pas du réseau interne, l'utilisateur sera redirigé vers la page de connexion, où il devra saisir le login et le mot de passe et se connecter. </font><font style="vertical-align: inherit;">Comme la séparation en utilisateurs n'est pas supposée, le fichier de connexion et le mot de passe sous forme cryptée (SHA 512) sont à proximité dans le fichier de configuration.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serveur MQTT</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le serveur MQTT est implémenté à l'aide du composant </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aedes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le serveur monte sur deux ports: interne, pour la communication avec le serveur, sans autorisation, et externe, qui implémente WebSocket. </font><font style="vertical-align: inherit;">Tous les clients frontaux se connectent via un socket et passent l'authentification lors de l'autorisation, en s'abonnant à la rubrique et en publiant n'importe quel message. </font><font style="vertical-align: inherit;">Le jeton JWT reçu du serveur d'autorisation arrive et est validé à l'aide de la clé publique. </font><font style="vertical-align: inherit;">Pour les demandes du serveur, la validation n'a pas lieu.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Noeuds personnalisés-Noeuds RED</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de l'écriture de l'automatisation, il était nécessaire d'implémenter un nœud supplémentaire et deux pour finaliser. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai dû modifier </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">node-red-contrib-openzwave</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , car ma demande de tirage n'a été acceptée qu'après 7 mois, mais maintenant vous pouvez utiliser la bibliothèque à partir de npm. Le raffinement consistait à lancer un événement de suppression de nœud. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kh/r4/nu/khr4nu0e2xikiinmz6wcxkslhea.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le nœud MQTT a également été finalisé. En fait, le principal raffinement en est l'extraction de l'ID du client connecté et sa réécriture lorsqu'il est envoyé dans la file d'attente. Ici, vous pouvez vous en tirer avec la fonctionnalité de sous-flux. Il était également censé transférer toutes les données à l'entrée du nœud MQTT, mais ce n'était pas utile.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ef/xu/mb/efxumb_9d6wk07dbzc5ippu3pec.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour contrôler les rideaux et les robinets d'eau, un nœud de planification était requis. </font><font style="vertical-align: inherit;">À l'époque, la bibliothèque était trop riche en fonctionnalités et ne prenait pas en charge une implémentation simple à l'aide de CRON. </font><font style="vertical-align: inherit;">Mon implémentation est assez simple: un planning peut être pris soit à l'entrée d'un noeud soit défini en interne. </font><font style="vertical-align: inherit;">Il est possible d'annuler le planning. </font><font style="vertical-align: inherit;">Sous le capot, le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nœud-calendrier est utilisé</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qa/ku/a1/qakua12yqbuuz8gkchotr2nj4ps.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De face</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chaque composant actif de l'appartement, qui se retrouve dans l'automatisation, est un module à l'avant. </font><font style="vertical-align: inherit;">Chaque module est autonome et contient tous les composants nécessaires au rendu. </font><font style="vertical-align: inherit;">Les modules sont divisés en deux agrégations: statique et Z-Wave. </font><font style="vertical-align: inherit;">Les modules doivent implémenter une seule interface.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interface</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-keyword">export</span> interface INode {
    <span class="hljs-attr">id</span>: string;<font></font>
    type: NodeTypes;<font></font>
    name: string;<font></font>
    addWidget: ComponentClass&lt;AddProps&gt; | StatelessComponent&lt;AddProps&gt;;<font></font>
    model: INodeModelConstructor;<font></font>
    service?: INodeServiceConstructor;<font></font>
    smallComponent: ComponentClass&lt;WidgetProps&lt;any&gt;&gt; | StatelessComponent&lt;WidgetProps&lt;any&gt;&gt;;<font></font>
    bigComponent: ComponentClass&lt;WidgetProps&lt;any&gt;&gt; | StatelessComponent&lt;WidgetProps&lt;any&gt;&gt;;<font></font>
    dialogEditComponent: ComponentClass&lt;WidgetProps&lt;any&gt;&gt; | StatelessComponent&lt;WidgetProps&lt;any&gt;&gt;;<font></font>
    dialogViewComponent: ComponentClass&lt;WidgetProps&lt;any&gt;&gt; | StatelessComponent&lt;WidgetProps&lt;any&gt;&gt;;<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple d'implémentation</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Widget</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseWidget</span> <span class="hljs-title">implements</span> <span class="hljs-title">INode</span> </span>{
    <span class="hljs-attr">model</span>: INodeModelConstructor = Model;<font></font>
    manufacturerid: string = <span class="hljs-string">'0x0086'</span>;<font></font>
    producttype: string = <span class="hljs-string">'0x1a02'</span>;<font></font>
    productid: string = <span class="hljs-string">'0x0064'</span>;<font></font>
    addWidget: StatelessComponent&lt;AddProps&gt; = AddWidget;<font></font>
    service: INodeServiceConstructor = Service;<font></font>
    smallComponent: StatelessComponent&lt;WidgetProps&lt;Model&gt;&gt; = SmallComponent;<font></font>
    bigComponent: StatelessComponent&lt;WidgetProps&lt;Model&gt;&gt; = BigComponent;<font></font>
    dialogEditComponent: ComponentClass&lt;WidgetProps&lt;Model&gt;&gt; = DialogEditComponent;<font></font>
    dialogViewComponent: ComponentClass&lt;WidgetProps&lt;Model&gt;&gt; = DialogViewComponent;<font></font>
}<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Widget;</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les modules statiques - par exemple, les climatiseurs - vous devez implémenter un entrepôt de données à l'avant. </font><font style="vertical-align: inherit;">Une telle implémentation n'est pas pratique, dans le bon sens, elle doit être changée en un seul référentiel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les modules Z-Wave, j'ai organisé un référentiel commun et le suivi de toutes les modifications. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le module implémente l'affichage de deux manières:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour les "grands" écrans (tablette, ordinateur);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour les téléphones.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selon le type d'appareil, le contrôle tactile ou de la souris sera sélectionné. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'application est construite à l'aide de webpack + babel: selon les paramètres actuels, elle est assemblée pour les deux dernières versions de Firefox, Chrome, Chrome Android.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Caractéristiques des codes sources</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les sources</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
All Flow sont désactivées, afin de ne pas lancer d'erreurs dans le journal. </font><font style="vertical-align: inherit;">Le noeud de configuration pour Z-Wave est supprimé: il est bogué s'il ne trouve pas le contrôleur Z-Wave et laisse tomber le Node-RED entier. </font><font style="vertical-align: inherit;">Ça devrait ressembler a quelque chose comme ca:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/nt/up/cf/ntupcfzfm3ths5v6h6ys6-hnv2s.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour que le chargeur de calendrier de travail fonctionne, vous devez vous inscrire sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">data.gov.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y obtenir un jeton et le saisir après access_token:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/fj/rs/rh/fjrsrhnxndutit6hgfrwic9kz5c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les prévisions météorologiques sont téléchargées sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">darksky.net</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> toutes les 15 minutes. </font><font style="vertical-align: inherit;">Il a également besoin d'un jeton, vous devez vous inscrire et entrer le jeton après la prévision, aux coordonnées:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bf/ka/kz/bfkakzodfw6mpsboylfszwjdurw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour envoyer des notifications de télégramme, vous devez obtenir votre bot, le saisir dans le nœud de configuration du télégramme et écrire l'ID de chat si nécessaire. </font><font style="vertical-align: inherit;">Dans le cas de mon Flow, c'est un sous-flux: les </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mm/gm/xu/mmgmxuevhgbi_i8gosfkcm5tuow.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sources sont divisées en avant et en arrière. </font><font style="vertical-align: inherit;">Dans la partie arrière se trouve:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autoriser le serveur.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serveur MQTT.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modules Node-RED personnalisés.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Flux exportés dans un seul fichier, qui peuvent être téléchargés sur votre propre compte ou sur une instance distincte pour les tests.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un projet pour Node-RED, dans lequel vous devez installer les modules puis charger uniquement le Flow exporté (les modules sont déjà dans le projet).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sauvegarde Mongo-base.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez trouver des informations d'installation plus détaillées dans le fichier readme </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">du référentiel github</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Des plans</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est prévu d'utiliser le microphone d'un smartphone ou d'une tablette murale pour la commande vocale. </font><font style="vertical-align: inherit;">Je prévois de déployer mon système open-source sur un serveur basé sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CMU Sphinx</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je prévois également d'assembler un module de prise et de transmission des relevés des compteurs de plomberie et d'électricité. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il convient également d'envisager l'utilisation de statistiques cumulées pour divers paramètres afin d'optimiser l'automatisation.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À l'heure actuelle, j'ai réalisé une automatisation presque complète de la maison selon mes besoins - pour maintenir un climat et un éclairage confortables dans la maison. En raison d'une certaine automatisation, il a été possible de réduire la consommation d'électricité (environ 1 500 ₽ en hiver par rapport au même équipement sans automatisation), tant du côté des éléments chauffants que du côté éclairage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien sûr, il y a encore des bugs dans les algorithmes, mais je les rattraperai un jour, au moins je vais dans cette direction. Le système fonctionne de manière stable, je ne vois aucun frein, malgré la très faible vitesse du protocole Z-Wave.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien sûr, le système ne se paiera pas au détriment des économies, il s'agit plus d'une question de confort. </font><font style="vertical-align: inherit;">Une telle automatisation est très humide en termes de petites choses comme la fermeture et l'ouverture des rideaux, le contrôle de la lumière. </font><font style="vertical-align: inherit;">Lorsque vous êtes dans un appartement ordinaire, vous oubliez parfois d’allumer ou d’éteindre les lumières et vous n’ouvrez pas les rideaux du tout. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ajuste rarement le système de climatisation avec mes mains, mais parfois vous devez allumer ou éteindre le climatiseur ou régler la température de la batterie. </font><font style="vertical-align: inherit;">En général, je suis satisfait du système qui en résulte: il laisse moins de temps à consacrer aux ajustements. </font><font style="vertical-align: inherit;">En cas de panne du contrôleur, toutes les fonctionnalités resteront en place (seule l'automatisation tombera). </font><font style="vertical-align: inherit;">La fonctionnalité de la coupure d'eau sera également préservée. </font><font style="vertical-align: inherit;">Si je décide de vendre l'appartement, je supprimerai facilement toute l'automatisation. </font><font style="vertical-align: inherit;">Ou laissez-le en place, mais vendez plus.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr489762/index.html">Un exemple simple d'analyse et d'analyse de données pour World of Tanks</a></li>
<li><a href="../fr489764/index.html">"The Destination a beaucoup de formes ..." ou nous automatisons le contrôle d'une ampoule à l'aide de CANNY 3 Tiny et d'une photorésistance</a></li>
<li><a href="../fr489768/index.html">Comment π combine des blocs en collision et un algorithme de recherche quantique</a></li>
<li><a href="../fr489770/index.html">Vidéo de MinskJS mitap: mon rapport sur les extensions de navigateur</a></li>
<li><a href="../fr489772/index.html">Hackathon à Simferopol, Yandex. Dialogues et lois de la technologie chat-bot</a></li>
<li><a href="../fr489776/index.html">The Ember Times - Numéro 136</a></li>
<li><a href="../fr489778/index.html">Anciens et nouveaux CSS. Histoire de la conception Web</a></li>
<li><a href="../fr489782/index.html">FizzBuzz 2.0: Questions pragmatiques pour les programmeurs</a></li>
<li><a href="../fr489784/index.html">27 février - début du projet pour les étudiants de NX Bootcamp à Novossibirsk</a></li>
<li><a href="../fr489786/index.html">Chaud, tube et très dangereux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>