<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçæ üë©üèª‚Äç‚úàÔ∏è ‚ôâÔ∏è Save time, nerves and man hours ü¶á ü§† üñêüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Our projects are usually regional, and customers, usually ministries. But, in addition to the public sector, private organizations also use our system...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Save time, nerves and man hours</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/barsgroup/blog/495942/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Our projects are usually regional, and customers, usually ministries. </font><font style="vertical-align: inherit;">But, in addition to the public sector, private organizations also use our systems. </font><font style="vertical-align: inherit;">There are practically no problems with them. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, the main projects are regional, and sometimes there are problems with them. </font><font style="vertical-align: inherit;">For example, with performance, when in regions from 20k our precious users are in the period of rolling out new functionality to product servers. </font><font style="vertical-align: inherit;">It‚Äôs a pain ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
My name is Ruslan and I am involved in escorting the BARS Group information systems and </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">developing a killer bot for brutal serial DBAs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Fasting is not for the faint of heart - many letters and pictures.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_2/kf/av/_2kfavets7hbt3nwzvy_bd9mqos.jpeg"><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ awr</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Some of our applications run on Oracle DBMS. There are projects on the PostgreSQL DBMS. Oracle has a wonderful thing - collecting statistics on the load on the DBMS, which highlights the existing problems and even gives recommendations for elimination - Automatic Workload Repository (AWR). At one point (namely, at the time of pain), the developers constantly asked to collect </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWR reports for performance analysis</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . We honestly went to the DBMS server, collected reports, dragged them to us and sent them for analysis to production. Once after the 5th it began to strain ... after the 10th - to cause irritation ...</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One day, one of my colleagues expressed the idea that everything that is done more than once should be automated. Until the moment of annoyance, to be honest, I did not think about it and tried to automate everything that can be automated, but often it was not in demand and was more research than applied. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And then I thought: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúAdmins are not needed to generate a report ...‚Äù</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . After all, to collect a report is to execute the sql script @ $ ORACLE_HOME / rdbms / admin / awrrpt.sql and pick up the report from the server to ourselves ... Oh yes, we don‚Äôt let the development go on sale.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then I googled the necessary information, created a function from the article on a test basis, pulled the script and a miracle - the report was collected and it can be saved locally. Created functions where AWR reports were often needed, told developers how to use it. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Around this time, in my spare time, after talking with @BotFather, I created a Telegram bot for myself, just for fun. I screwed up a simple functional there - to show the current time, exchange rates, weather, taught him to send compliments to my wife (then a girl) on a schedule. Perhaps at that time sending compliments was the most sought-after functionality of my bot, my wife appreciated.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So. The developers write to us in Telegram, we send a report to them in Telegram ... But what if they write not to us, but to the bot? Indeed, it will be better for everyone, the report will be received faster, and most importantly, by us. So the idea of ‚Äã‚Äãthe first sought-after functionality was born for my bot. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I started implementation. I did it, as I managed, in PHP (actually our application is in PHP, I understand it more than Python). The encoder is so-so from me, so I won‚Äôt show my code :) The </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bot lives in our corporate network, it has access to certain projects, including target databases. In order not to bother with the parameters in the command or the menu, I screwed this functionality to a group chat with monitoring notifications. So the bot immediately knows which database to collect the report on. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Having received a command of the form </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ awr N</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, where N is the number of full hours for which a report is needed (by default - 1 hour), even for a week, if the database does not restart, the bot immediately starts working, collects the report, publishes it as a web page and right there (almost right there) gives a link to a much-needed report. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We follow the link and here it is, the AWR report: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ki/yr/tk/kiyrtktigm4qjsumovp2vl4roa0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As expected, the developers coped with this report generation, someone even thanked. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Having appreciated the convenience of the team, project managers from other regions wanted the same, because they most of all </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get luli from the customer who</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> worry about the performance and availability of the systems. Added a bot to other chats. They still use it, and I'm glad about it.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Later, colleagues from CIT wrote about how we collect reports, they also wanted to. </font><font style="vertical-align: inherit;">I did not add them to our chats, I created a separate chat with the generation of reports on a schedule and on request.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ pgBadger</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We have other applications in PHP in conjunction with PostgreSQL. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implemented the collection of the pgBadger report for those in need on the same principle - in group chats. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At first they used it, but then they stopped. </font><font style="vertical-align: inherit;">Functional cut out as unnecessary.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ duty</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In our department there are night shifts and, accordingly, there is a schedule. </font><font style="vertical-align: inherit;">It is in google tables. </font><font style="vertical-align: inherit;">It‚Äôs not always convenient to look for a link, open a schedule, look for yourself ... One of the former colleagues also played with his Telegram bot and introduced into the chat of our department </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">notifications about the start of a shift on duty for employees of the department.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The bot parses the schedule, determines the attendant by the current date and, according to the schedule or by request, reports who is on duty today. </font><font style="vertical-align: inherit;">It turned out great, comfortable. </font><font style="vertical-align: inherit;">True, I did not really like the message format. </font><font style="vertical-align: inherit;">Also, for employees of another department (for example, Business Center ‚ÄúMedicine‚Äù), information on duty in other areas is not really needed, but you need to know who is on duty in ‚ÄúMedicine‚Äù in case of problems. </font><font style="vertical-align: inherit;">I decided to ‚Äúborrow‚Äù the functionality, but to change what I did not like. </font><font style="vertical-align: inherit;">I made a message format convenient for myself and for others, removing redundant information.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ tnls</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After the ‚Äúpen test‚Äù of automation through the Telegram bot, many different ideas appeared, but I wanted to do the strictly necessary things. I decided to keep </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">statistics on appeals.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> To access the projects of our customers, we have implemented the so-called ‚Äúhop server‚Äù or the forwarding server. VPN connections are raised on it, then through ssh, application ports, databases and other auxiliary probes are forwarded to our local network for convenience of access to the projects of our employees, without troubles with VPN connections. It‚Äôs enough to set up a VPN connection to our corporate network.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The statistics of calls suggested that often, after the fall of one of the tunnels (in case of network problems, by timeout, for example), they are turning to restore access to the project. </font><font style="vertical-align: inherit;">In most cases, just restarting the connection is enough and everything becomes fine. </font><font style="vertical-align: inherit;">Let‚Äôs do it yourself. </font><font style="vertical-align: inherit;">Here is the command: </font></font><br>
<img src="https://habrastorage.org/webt/pq/th/ad/pqthadwkyi0tegqd7tn2qzrpxws.png"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚ÄúFall through‚Äù to the desired menu item, select your project, wait a minute and everyone is happy and satisfied ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When a command is received, by a slight movement of </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bytes and bits, the bot connects to the forwarding server, knowing in advance which forwarding needs to be restarted, and does his job - restores connection to the project. </font><font style="vertical-align: inherit;">I wrote instructions to solve such issues on my own. </font><font style="vertical-align: inherit;">And we were contacted only if the provided tool does not work ...</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ ecp_to_pem</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Further statistics showed that it is often necessary to convert the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Crypto Pro digital signature to the pem format</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Base64</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) for various integrations, and we have a lot of them. Task: you take the container, copy it to a Windows computer with the P12FromGostCSP utility installed (by the way, paid), convert it to pfx, and convert pfx using OpenSSL (with support for GOST encryption) to pem. Not very convenient, but I want it at the click of a finger. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Google again came to the rescue. Found the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utility of some kind person</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Collected, as written in README - earned. He taught the bot to work with the utility and got almost instant conversion.</font></font><br>
<img src="https://habrastorage.org/webt/aq/qo/yu/aqqoyu8qmwsrjbske46acai6bie.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By the time of the final implementation, an order was issued to switch to a new encryption format - gost-2012. </font><font style="vertical-align: inherit;">As far as I remember, the utility at that moment worked only with the old GOST (2001), maybe it was generally another similar utility of another good person, I don‚Äôt remember exactly. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After the transition to the new GOST, the bot‚Äôs functionality was removed for security reasons. </font><font style="vertical-align: inherit;">Implemented it in a docker container.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dockerfile, suddenly who needs:</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">FROM ubuntu:16.04                                                                                                                                                                        <font></font>
RUN apt update &amp;&amp; apt -y install git sudo wget unzip gcc g++ make &amp;&amp; \                       <font></font>
   cd /srv/ &amp;&amp; git clone https://github.com/kov-serg/get-cpcert.git &amp;&amp; \                    <font></font>
   cd get-cpcert &amp;&amp; chmod +x *.sh &amp;&amp; ./prepare.sh &amp;&amp; ./build.sh &amp;&amp; \                        <font></font>
   mkdir -p /srv/{in,out} &amp;&amp; \                                                              <font></font>
   echo '#!/bin/bash' &gt; /srv/getpem.sh &amp;&amp; \                                                 <font></font>
   echo 'cd /srv/get-cpcert' &gt;&gt; /srv/getpem.sh &amp;&amp; \                                         <font></font>
   echo './get-cpcert /srv/in/$CONT.000 $PASS &gt; /srv/out/$CONT.pem' &gt;&gt; /srv/getpem.sh &amp;&amp; \  <font></font>
   chmod +x /srv/getpem.sh                                                                  ENTRYPOINT /srv/getpem.sh</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To convert, you need to place the source container (a directory of the form xxx.000) in the / srv / in directory, and pick up the finished pem in / srv / out. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To convert:</font></font><br>
<br>
<pre><code class="plaintext hljs"> docker run -t -i -e CONT='&lt;   ( ".000")&gt;' -e PASS='&lt;  &gt;' -v /srv/in:/srv/in -v /srv/out:/srv/out --name ecptopem &lt;  &gt;/med/ecptopem:latest </code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ emstop and / emstart</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Once, our company got a very cool Oracle DBA, with more experience in DBMS administration and development. And it didn‚Äôt happen right away with an ssh-connection to the DBMS servers: either it doesn‚Äôt know where to connect and how, then the accesses are not clearly described, it‚Äôs impossible to forward something to itself. Well, we are happy to help, talked about how to connect, and forwarded Enterprise Manager for it. But with ssh it still didn‚Äôt work out. One of the colleagues explained it simply: DBA thoroughbred :) We decided if we need to tighten something on the server, we will do it ourselves.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
EM crashes under heavy load, and restarting it ... you need to connect via ssh and restart through the terminal. </font><font style="vertical-align: inherit;">‚ÄúAdmins know this well,‚Äù our new colleague decided. </font><font style="vertical-align: inherit;">Large loads on the DBMS are not uncommon with us, requests for restarting EM are also frequent. </font><font style="vertical-align: inherit;">Further the same scenario: tension, irritation and search for a solution to the problem. </font><font style="vertical-align: inherit;">So in the same group chats appeared the command: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ emstop and / emstart.</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/kk/yd/8j/kkyd8jikdyflvrkkoqvyens8dym.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ kill</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the case of strong competition at the base, and this sometimes happens, you need to quickly unload the database. </font><font style="vertical-align: inherit;">The fastest way is to kill the problem process ... To do this, connect via ssh, kill -9 ... The bot will help! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jb/8q/cs/jb8qcsft8ce6jp5e7rijqtvcjti.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alexey appreciated the team and gave it an affectionate name - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúKilyalka‚Äù</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or a gun. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Once, after seeing how Alex is trying and suffering, each time entering / kill xxx for each of the processes, I decided to add ‚Äúmultilateralism‚Äù to our gun: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5d/sc/kh/5dsckh_3qe5lhmvhop1pmxkt1hk.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">That's better! </font><font style="vertical-align: inherit;">Everything for you, Alex, just work, dear! </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturally, access to such an important command was limited </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">by user_id - "protection against the fool."</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Seeing how Lesha cleverly nailed processes on the database server, several people tried to enter a command with a random process number, but you can‚Äôt deceive my smart bot, he immediately refused.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ alertlog </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Well, just in case, I made a command: </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ alertlog &lt;number of lines&gt;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - get the specified number of lines alertlog'a The </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bot pulls alertlog and sends it to our service, such as pastebin, called pyste, and sends a link to the paste to the request chat.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ checks</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then came a request to </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">monitor the real performance of our application.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Until now, technical support for the project has been collecting this data by hand. Not a deal! Our valiant testers have developed test cases for this. The resulting test log is not very convenient to read, an inexperienced user will understand for a long time and not the fact that he will highlight the necessary information. And we don‚Äôt like to do with our hands what we can do not with our hands ... A new task for the bot! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/--/u6/1l/--u61ld0yk0fljkwuerjn3g8zsa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The / checks command displays a straightforward and unambiguous menu, this time our guys learned how to use this command without instructions! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When you select the desired item, instead of the menu, a notification appears about the start of the test so that impatient users do not run our test 100500 times:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j7/xv/sv/j7xvsv_byo8gdw7y3qweig15msq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depending on the selected menu item, a specific test is launched from our network, namely from the machine where the bot lives (jmeter is pre-configured there, the necessary tests are placed ...) or immediately from the data center (from the prepared machine next to the application), so that when testing eliminate network delays, well, or minimize them. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After completing the test and receiving the log, the bot parses it and displays the result in a ‚Äúhuman-readable‚Äù form:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7w/xp/s8/7wxps8jupg80bbq_uuywyz1-gag.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Metrics collection</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The functionality has ‚Äúentered‚Äù and the project managers who wish have received such a function for their regions. And one compassionate Project Manager said: ‚ÄúI want to have statistics on time!‚Äù Someone from CIT told her that it would be convenient to monitor all this in Zabbix. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zabbix, so Zabbix ...</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Thought it was necessary to prepare for the need to duplicate the solution ... I designed the idea in a docker container. In the container, according to the schedule (every 10 minutes), jmeter is launched, adds the log in a specific place, php parses it and displays the necessary data in the form of a web page. Zabbix uses the web.page.get key to get this page, regularly selects the necessary data for certain dependent elements and builds a graph.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oq/aq/cd/oqaqcdqj2mjodianmnwmrucyix8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It seems that it turned out not bad. </font><font style="vertical-align: inherit;">Observing the graph, we, firstly, see the approximate speed of the application, and if peaks are detected on the graph, we know roughly where the ‚Äúplug‚Äù is. </font><font style="vertical-align: inherit;">Everything is simple. </font><font style="vertical-align: inherit;">So far it has turned out to be in demand only for one region, but I am ready to disseminate it for those who wish.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Application development</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Statistics on tasks of the same type not so long ago threw up ideas for simplifying and facilitating work. On some projects, on application servers, there is a need to install the key containers of Crypto Pro, there are many of them, and the digital signature will expire over time. Sometimes 2 tasks ‚Äúflies‚Äù per day. But I considered using the bot for these purposes unsafe and decided that I would do the functionality directly in the application. Naturally with authorization and access control. If you have the necessary privileges, an additional menu item will be available for working with digital signatures, installation, removal, viewing information, etc. ... At the moment, the functionality is under development. As it turned out, this is not very difficult, you need to read the instructions a bit, look at code examples, ask more experienced colleagues in development, and there you go.In the process of research, ideas appeared for adding to the application. I will not build Napoleonic plans - there is development, let everyone do their own thing. But for now, it's interesting - I do it myself.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plans</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As I said, many different ideas were born for using our bot and not only - in general, let‚Äôs say, ideas for ‚Äúautomation points‚Äù, many of them were forgotten, because I did not have time to write them down. </font><font style="vertical-align: inherit;">Now I try to write down everything that comes to mind, and I recommend that others do the same. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But Alex does not forget to throw his Wishlist. </font><font style="vertical-align: inherit;">Of the latter: </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ kill_sql SQL_ID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - kill all sessions with such an SQL_ID query </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ kill_block</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - kill the root blocking session </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ show_em</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - show a performance picture EM </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trick, wants to DBA stitch from the phone =) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
That's how we work for the good of the Motherland! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And how do you save yourself from routine and uninteresting tasks?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I hope the reading turned out to be interesting, and maybe even useful to someone, and I did not manage to tire the reader ... Good luck to all of us.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en495924/index.html">Why is it so damn difficult to build a good COVID-19 distribution model?</a></li>
<li><a href="../en495926/index.html">We are writing firmware for TI cc2530 on Z-Stack 3.0 for Zigbee Sonoff BASICZBR3 relay with ds18b20 sensor</a></li>
<li><a href="../en495932/index.html">What is the hidden meaning of the authors in the SCRUM Guide. Part 1. About the process</a></li>
<li><a href="../en495934/index.html">DataGovernance in the home</a></li>
<li><a href="../en495938/index.html">A selection of articles on machine learning: cases, guides and studies for March 2020</a></li>
<li><a href="../en495944/index.html">Updated TOP50 (rating of CIS supercomputers): dynamics and trends</a></li>
<li><a href="../en495946/index.html">Norbert Wiener: the distracted father of cybernetics</a></li>
<li><a href="../en495948/index.html">Rust Embedded. Development for Cortex-M3 processors using the STM32F103C8T6 (Black Pill) debug board</a></li>
<li><a href="../en495954/index.html">How has Cisco been operating in remote access mode and an absent perimeter for 20 years?</a></li>
<li><a href="../en495956/index.html">Gotta go fast. Optimizing IMAP email content requests</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>