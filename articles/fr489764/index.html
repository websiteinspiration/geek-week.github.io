<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😤 🛃 👨‍👧‍👦 "The Destination a beaucoup de formes ..." ou nous automatisons le contrôle d'une ampoule à l'aide de CANNY 3 Tiny et d'une photorésistance 🛀🏻 🏳️ 🛀🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans le dernier article sur Habr, je vous ai expliqué comment j'avais reçu le petit contrôleur Canny3 en cadeau. Nous avons «clignoté» la LED, appuyé ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>"The Destination a beaucoup de formes ..." ou nous automatisons le contrôle d'une ampoule à l'aide de CANNY 3 Tiny et d'une photorésistance</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/489764/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dernier article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur Habr, je vous ai expliqué comment j'avais reçu le petit contrôleur Canny3 en cadeau. Nous avons «clignoté» la LED, appuyé sur un bouton. Sur ce, en principe, il a été possible de terminer les expériences. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, depuis quelques semaines, j'écoute des livres audio sur The </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Witcher</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font><font style="vertical-align: inherit;">je suis </font><font style="vertical-align: inherit;">donc devenu beaucoup plus sérieux à propos de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Destination</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Selon les informations indiquées sur le site Internet du constructeur, la famille de contrôleurs CANNY est principalement destinée à l'automatisation de divers systèmes automobiles et équipements spéciaux.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le problème est que personne ne me laissera fouiner dans une vraie voiture avec mes «mains d'or», et en général j'ai peur des voitures. </font><font style="vertical-align: inherit;">Par conséquent, j'ai dû acheter une petite lampe de voiture et une photorésistance spécialement pour cet article. </font><font style="vertical-align: inherit;">Ce que vous ne ferez pas pour ne pas irriter le Destin. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aujourd'hui, nous allons connecter le contrôleur et la lampe de voiture à une alimentation 12V, envoyer un message au port COM, automatiser l'inclusion de la lampe en fonction de la lumière et essayer le contrôleur PWM haute fréquence. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Croyez-vous également au pouvoir de Destination? </font><font style="vertical-align: inherit;">Alors vous êtes les bienvenus sous chat.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yt/kd/tj/ytkdtjul2i1qbdrqllt278lszck.png"><br>
<a name="habracut"></a><br>
<br>
<a name="I"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Partie I: Introduction</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partie I: Introduction </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partie II: Composants et précautions </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partie III: Comment écrire des données sur le port COM </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partie IV: Connecter et programmer la lampe automatique et la photorésistance </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partie V: Essayer de réduire la luminosité de la lampe à l'aide de PWM </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partie VI: Conclusion</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Au tout début de l'article, je vous rappelle Je n'ai pas beaucoup d'expérience en électronique DIY. </font><font style="vertical-align: inherit;">Il y a plusieurs années, j'ai essayé CraftDuino - le clone Arduino domestique. </font><font style="vertical-align: inherit;">Et à part ces "métiers" qu'il a fait pour moi</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drzugrik</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c'est en fait mon expérience dans l'électronique DIY est limitée. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apparemment, connaissant mon amour pour les développements domestiques, j'ai décidé de donner Canny 3.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Même dans le processus de préparation du dernier article, j'ai été surpris que le contrôleur puisse être alimenté non seulement à partir de 5V, mais aussi à partir de 12V, tandis que la tension aux sorties sera la même que sur et le courant maximum par canal peut atteindre 100 mA. Cela m'a semblé intéressant, car mon ancien CraftDuino ne pouvait pas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par de simples calculs utilisant la formule</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo>=</mo><mi>U</mi><mo>&amp;#x2217;</mo><mi>I</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.993ex" height="2.009ex" viewBox="0 -755.5 4302.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMAIN-3D" x="1029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMATHI-55" x="2085" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMAIN-2217" x="3075" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMATHI-49" x="3798" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo>=</mo><mi>U</mi><mo>∗</mo><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">P=U*I</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> j'ai réalisé que la puissance maximale par sortie de contrôleur serait d'environ 1,2 watts. Il a été décidé de prendre une lampe avec une réserve de marche, au cas où. Le choix s'est porté sur une ampoule LED 0,9 W.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, je ne voulais toujours pas brûler mon cadeau du Nouvel An sans gloire, et avant de le connecter, j'ai décidé de demander aux développeurs si j'avais tout compris correctement.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À ma grande surprise, ils m'ont non seulement répondu, mais ont également suggéré que si vous combinez plusieurs sorties, la puissance augmenterait proportionnellement. </font><font style="vertical-align: inherit;">Après cela, il a été décidé d'acheter quelque chose de plus puissant que la lampe et le choix s'est porté sur le ventilateur de voiture, qui est inséré dans l'allume-cigare. </font><font style="vertical-align: inherit;">Cependant, afin de ne pas faire de «vinaigrette» à partir de l'article, j'ai décidé de reporter les manipulations avec le ventilateur automobile jusqu'à la prochaine fois.</font></font><br>
<br>
<a name="II"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Partie II: Équipement et précautions </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, au début des expériences, j'avais ce qui suit:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dispositif de charge et de lancement "Orion Vympel-55". </font><font style="vertical-align: inherit;">Je l'avais déjà et, heureusement, il peut non seulement charger les batteries, mais aussi être une source d'alimentation dans une large gamme (dont 12 V);</font></font><br>
<br>
<img src="https://habrastorage.org/webt/uj/fi/_i/ujfi_iwx1hku88fcb2trgbdhvqu.jpeg"><br>
<br>
</li>
<li>  «Skyway H3. SH3-9SMD-5050 W».         ,     ,            ;<br>
<br>
<img src="https://habrastorage.org/webt/zw/vm/yi/zwvmyih0_5t0grxn5elq4j1zvfe.jpeg"><br>
<br>
     ,      ,     100 .        <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi><mo>=</mo><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>U</mi><mo>=</mo><mn>0.9</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mn>12</mn><mo>=</mo><mn>0</mn><mo>,</mo><mn>075</mn><mi>A</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.044ex" height="2.634ex" viewBox="0 -809.3 12504.8 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMATHI-49" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMAIN-3D" x="782" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMATHI-50" x="1838" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMAIN-2F" x="2590" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMATHI-55" x="3090" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMAIN-3D" x="4135" y="0"></use><g transform="translate(5192,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMAIN-39" x="779" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMAIN-2F" x="6471" y="0"></use><g transform="translate(6972,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMAIN-32" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMAIN-3D" x="8250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMAIN-30" x="9307" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMAIN-2C" x="9807" y="0"></use><g transform="translate(10252,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMAIN-37" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMAIN-35" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhh0jdgBCIvj6W7QiPXCEUj3WonVog#MJMATHI-41" x="11754" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi><mo>=</mo><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>U</mi><mo>=</mo><mn>0.9</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>12</mn><mo>=</mo><mn>0</mn><mo>,</mo><mn>075</mn><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">I=P/U=0.9/12=0,075A</script>.<br>
      .     -   .<br>
<br>
<img src="https://habrastorage.org/webt/gl/fw/qv/glfwqvsyuybaay2nr5bdftlk2n8.png"><br>
<br>
</li>
<li> -765.     ,       . <br>
<br>
<img src="https://habrastorage.org/webt/h9/zq/gq/h9zqgqgqp4vfwhhoreh_qxmo5aa.png"></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh bien, bien sûr, j'avais: un contrôleur, une planche à pain, des fils, des crocodiles, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans un article précédent sur Canny 3, j'ai vraiment fait l'éloge du contrôleur, mais il s'est avéré qu'il y a une mouche dans la pommade. La dernière fois, je n'ai pas utilisé le faisceau de câbles fourni avec le kit, mais cette fois, je ne pouvais pas m'en passer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme j'utilise très mal un fer à souder, je voulais réduire son utilisation au minimum vital. Par conséquent, à la fin, j'ai rassemblé tous les circuits sur des connexions détachables. J'ai utilisé des fils spéciaux (papa-papa, maman-maman, maman-papa), des planches à pain et des pinces à crocodile.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et si les développeurs du contrôleur ne sont pas à blâmer pour le fait que dans le processus de dénudage du câble, j'ai eu quelques coupures, alors les moments où toute ma structure est tombée au sol en raison du fait que j'ai accroché le harnais "en bois", en partie sur leur conscience. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'une part, un garrot est une bonne chose. Pour installer le contrôleur à l'intérieur de la voiture, le faisceau de câbles, je pense, est juste. Les fils qui s'y trouvent sont toronnés et s'ils sont bien torsadés, alors ils s'insèrent complètement dans les connecteurs «mère», mes fils «planche à pain». D'un autre côté, comme il n'est pas pratique de faire des expériences avec le câble avec la planche à pain, même une belle photo avec le contrôleur tourné en plein visage était difficile à faire à cause des «fils de chêne». </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai dit un peu plus haut que je ne voulais pas utiliser de fer à souder, mais au moins une fois ils devraient s'armer.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de mesurer le signal de la photorésistance, nous devons «l'insérer» dans le convertisseur analogique-numérique (ADC) du contrôleur. </font><font style="vertical-align: inherit;">Mais le fait est que, contrairement, par exemple, à mon ancien Craftduino. </font><font style="vertical-align: inherit;">Dans le cas de Canny, il s'est avéré nécessaire de mettre un pull. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au début, je n'ai pas lu attentivement la documentation et pensais que les sorties 5 et 6 du contrôleur sont les sorties A5 et A6. </font><font style="vertical-align: inherit;">J'ai même écrit un programme et essayé pendant longtemps de faire des lectures. </font><font style="vertical-align: inherit;">Naturellement, je n'ai pas réussi car par défaut, sans préparation préalable, les canaux n ° 5 et 6 fonctionnent comme une entrée discrète normale. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir lu la documentation du contrôleur sur un "esprit neuf", j'ai réalisé que je dois encore souder. </font><font style="vertical-align: inherit;">Vous n'avez aucune idée de la façon dont j'avais peur de «tout foutre».</font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La dernière fois que j'ai essayé de souder quelque chose dans le circuit que j'ai fait pour moi </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drzugrik</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, J'ai réussi à remplir tous les condensateurs avec de la soudure près du lieu de soudure. </font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette fois, le processus de soudage était simple. </font><font style="vertical-align: inherit;">Il suffisait de mettre très soigneusement une goutte de soudure sur la piste. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À quoi ressemble mon cavalier de soudure peut être vu sur la photo ci-dessous:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/pv/r9/vd/pvr9vdryjakzmbjalenhh6wrn9a.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je n'ai connecté que la 6ème sortie au canal A6, je n'ai pas osé souder le cinquième canal, afin de ne pas accidentellement remplir les deux cavaliers avec de la soudure. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En théorie, il était possible de se passer d'un fer à souder en connectant le trou et la borne n ° 6 avec un fil. </font><font style="vertical-align: inherit;">Mais ce serait terriblement gênant. </font></font></i> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La photo ci-dessous montre la connexion de la broche n ° 5 et de la broche ADC n ° A5 avec un fil de papa à papa: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qu/l6/hb/qul6hbndz9lv1jwj8rq-m34sipe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
la dernière chose à laquelle vous devez faire attention avant de vous mettre au travail. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attention!</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ne répétez pas un à un, ce que je décrirai plus loin sur le texte. </font><font style="vertical-align: inherit;">Ne soyez pas paresseux pour remplacer les connexions enfichables par de la soudure, prenez des fils plus épais, lisez la documentation. </font><font style="vertical-align: inherit;">Je ne suis pas un expert en la matière, j'ai donc tout rassemblé "du mieux que je pouvais". </font><font style="vertical-align: inherit;">Je vous conseille également de surveiller attentivement les risques d'incendie et de ne pas laisser l'équipement sans surveillance. </font><font style="vertical-align: inherit;">J'ai réussi à sentir quelques fils qui couvaient plusieurs fois. </font><font style="vertical-align: inherit;">Eh bien, même dans l'alimentation, il y avait une protection contre les courts-circuits (je l'ai également arrangé). </font><font style="vertical-align: inherit;">Par conséquent, soyez prudent. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N'oubliez pas non plus qu'en dépit du fait que les tensions et les courants sont faibles, toucher les parties sous tension sous tension peut être douloureux </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(surtout si vous les piquez avec une partie du corps blessée)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<a name="III"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Partie III: Comment écrire des données sur le port COM</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin d'étalonner en quelque sorte notre capteur de lumière ambiante, nous devons comprendre quelles valeurs il envoie au contrôleur en fonction du niveau de lumière. Pour ce faire, nous devons sortir les données de l'ADC vers le moniteur. Lorsque je travaillais avec Arduino et ses clones pour résoudre de tels problèmes, j'ai utilisé un moniteur de port COM. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le cas de Canny 3 Tiny, le processus de lecture des données à partir d'un port COM virtuel n'est pas beaucoup plus compliqué que pour Arduino. Mais il y a une différence clé. L'environnement de développement CannyLab ne possède pas son propre moniteur de port COM. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai utilisé </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hterm</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> car il est multiplateforme, léger et ne nécessite pas d'installation. Mais vous pouvez en utiliser d'autres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je dirai encore plus, rien ne nous empêchera d'utiliser le moniteur de port COM Arduino IDE.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout a fonctionné sur la base de mon système Windows 10 et je n'ai pas eu à installer séparément les pilotes pour le port COM virtuel. Mais juste au cas où, je dirais que le pilote semble être intégré à l'environnement de développement CannyLab (il se trouve dans le dossier drv \ canny3tiny_vcp). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de ne pas expliquer davantage le fonctionnement des blocs de graphiques associés à l'envoi de données au port COM virtuel USB, je vais donner un exemple simple. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aujourd'hui, en séance d'entraînement, nous enverrons le message «HABR» à l'aide du contrôleur. Vous devez d'abord télécharger l'IDE CannyLab. Il peut être facilement trouvé sur le site officiel du développeur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Soit dit en passant, j'ai utilisé CannyLab v 1.42, mais je pense que dans les versions précédentes, il n'y aura aucun problème avec les performances des diagrammes.</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le processus d'écriture d'un logiciel sur le nouveau contrôleur et les principes de base de l'utilisation de Cannylab I sont décrits dans le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chapitre 3 du dernier article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Créez un nouveau graphique, sélectionnez Canny 3 tiny dans la boîte de dialogue. Et nous transférons des blocs, des constantes et des registres dans le diagramme, comme dans la capture d'écran ci-dessous. Bien sûr, il n'est pas nécessaire de transférer les étiquettes de texte, rien ne dépend d'eux lors de l'exécution du diagramme. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rz/st/g9/rzstg9zmltxsf2ekndo4orydcnu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous n'avez pas envie de déplacer des blocs vous-même, vous pouvez télécharger les diagrammes de cet article à l'aide de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub.</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Il convient de noter que l'envoi d'un message au port COM fonctionne un peu étrange et que vous devez écrire des lettres dans une paire de caractères dans un miroir, mais vous pouvez vous y habituer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je vais vous expliquer en partie. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le bloc </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Parameter Setting"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous définissons les paramètres du pilote USB VCP. Tout d'abord, activez le mode de transfert sur le port COM virtuel, puis définissez la longueur du message transmis. Dans notre cas - 6 caractères, y compris le saut de ligne. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le bloc </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Message Text",</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous écrivons le texte du message en constantes (n'oubliez pas de passer en mode "chr") et transférons ces constantes dans les registres de pilotes correspondants. Encore une fois, j'attire votre attention sur le fait que nous écrivons le message dans l'ordre inverse, à la fois dans les paires de symboles elles-mêmes et dans les registres des pilotes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dernier bloc </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Transfert de messages"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Envoie avec une fréquence spécifiée notre message au port COM. Pour cela, nous utilisons un bloc PWM. Ne le confondez pas avec le RF PWM, que nous utiliserons lors de la connexion de la lampe. Dans ce cas, le bloc génère la moitié du temps «0» et la seconde moitié «1». Vous pouvez "jouer" avec la taille de la période et remplir pour augmenter ou diminuer la fréquence d'envoi des messages. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La connexion d'une LED verte à ce bloc PWM est nécessaire afin de vérifier le fonctionnement du contrôleur. Si tout est en ordre, la LED clignote avec la fréquence d'envoi d'un message. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment écrire un programme sur le contrôleur, je l'ai déjà dit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans un précédent article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Cependant, au cours du temps passé, j'ai appris un autre truc cool.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque nous connectons le contrôleur à l'ordinateur, il entre en mode d'enregistrement de programme. Auparavant, afin de passer en mode d'exécution, j'ai retiré le contrôleur de l'ordinateur et y ai bloqué le chargement USB. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'est avéré qu'il existe un moyen plus simple. Après avoir connecté le contrôleur au port USB de l'ordinateur et cliqué sur le bouton </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Connecter"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans CannyLab </font><font style="vertical-align: inherit;">, allez dans le </font><font style="vertical-align: inherit;">menu </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Périphérique"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et sélectionnez </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Exécuter"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/b-/dt/bv/b-dtbvog9sirji-opbj-ehor-hm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le contrôleur commence à exécuter le programme enregistré, en étant alimenté par le port USB. Après cela, le contrôleur sera également disponible sur le moniteur du port COM. Certes, pour revenir au mode d'enregistrement de programme, le contrôleur devra être retiré et réinséré dans le port USB de l'ordinateur.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et voici notre «HABR» dans le moniteur de port COM Hterm. </font><font style="vertical-align: inherit;">Faites attention à la vitesse de transfert des données et aux autres paramètres. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ls/lh/yu/lslhyucpy7cxrmexfqnn3l5swgi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et voici le moniteur du port COM Arduino IDE: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ab/zd/vl/abzdvlqwpn6jaw0q0uuzx06ltzo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La photo montre comment le contrôleur fonctionne après avoir enregistré le diagramme: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qv/4n/zu/qv4nzuowx6saogj5xskvkn7dt3w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
la LED rouge signale que l'alimentation est reçue via le port USB de l'ordinateur et le vert "clignote" au rythme des messages transmis via le port COM USB virtuel.</font></font><br>
<br>
<a name="IV"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partie IV: Nous connectons et programmons une lampe de voiture et une photorésistance.</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour commencer, nous considérerons l'option la plus simple. Connectez simplement la lampe à la borne n ° 1 du contrôleur et la photorésistance à la borne n ° 6 (ADC). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout est assez simple, mais juste au cas où, j'ai dessiné un diagramme: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sv/un/pm/svunpmu3hc-n4agrotbzy2rquea.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais ici, ça a l'air en direct: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ap/az/z8/apazz8ybxdpnfnaxf9y3c-daabc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"-" et "+" de la source d'alimentation que nous connectons aux bornes correspondantes de Canny 3 minuscule, la broche n ° 1 est connectée au boîtier de la lampe, et la "queue" de la lampe avec un plus sur la planche à pain de la planche à pain. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec une photorésistance aussi, tout est simple. De plus, nous apportons la planche à pain du bus à la planche à pain, et le moins va à la broche n ° 6 du contrôleur, que nous avons précédemment connectée avec le cavalier à l'ADC. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'ai déjà écrit ci-dessus que toute ma structure est tombée à quelques reprises de la table. Par conséquent, plus loin sur les photos, il peut y avoir de légères différences en termes de couleurs des conducteurs et des points de leur entrée dans la planche à pain.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons maintenant écrire un programme. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/n1/7s/l8/n17sl8exoem1_jl54mqgb-bapeg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considérez le nouveau jour que nous bloquons. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Commençons par le bloc </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">«Obtenir la valeur de l'ADC et la convertir en suites»</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce bloc, nous traduisons les valeurs que l'ADC (0 à 1023) peut nous donner en éclairage (lux). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous devons faire une mesure de l'éclairage lorsqu'il fait clair et une mesure dans des conditions plus sombres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conséquence, dans la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">«valeur de»,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> j'ai enregistré la lecture ADC minimale «0», et dans le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">«résultat de» la</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> valeur zéro du niveau d'éclairage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">«valeur à»,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> j'ai enregistré les lectures ADC = 20, et l'éclairage correspondant égal à 300 lux, je suis entré dans le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">«résultat à»</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je n'ai pas de description détaillée des paramètres de la photorésistance, mais je soupçonne qu'elle n'a pas une caractéristique complètement linéaire, mais cela nous suffit maintenant. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vérifiez à l'avance comment le diagramme est exécuté dans le simulateur. Plus en détail sur le travail dans le simulateur CannyLab que j'ai écrit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici ce que je me suis retrouvé avec: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mp/yw/no/mpywnolxlvzxyaqqkeyy3oh2m-u.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imaginez que la photorésistance a passé une valeur de 10 à l'ADC Le bloc </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Affichage (MAP)"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">il s'agit d'une mise à l'échelle essentiellement linéaire. Dix est exactement la moitié de l'échelle de notre échelle, ce qui signifie que la sortie sera la moitié de la plage 0 - 300, à savoir 150. C'est en dessous du niveau spécifié de 300 lux. Par conséquent, un est envoyé au registre de canal n ° 1 (sortie n ° 1) et la lampe s'allumera . Mais il ne s'allumera pas immédiatement, mais uniquement s'il fait sombre pendant au moins une seconde (1000 millisecondes). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour comprendre quel message nous recevrons dans le port COM, j'ai changé l'affichage des valeurs dans le simulateur au format hexadécimal. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mq/nr/rk/mqnrrkxyzudcput-yez77oke13a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considérez le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"registre de configuration de message VCP D1: D0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , la valeur 3130 y entre. Comme nous nous en souvenons, il s'agit d'une paire de caractères, dont chaque partie représente un code de caractère hexadécimal. Il s'avère que 31h est le code de caractère "1" en ASCII, 30 est le code zéro en ASCII.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">registre d'installation des messages "VCP D3: D2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , nous aurons en conséquence les caractères" 0 "et" 5 ". Nous collectons les valeurs des paires de caractères dans l'ordre de D0 à D3 nous obtenons: "0", "1", "5", "0". Nous avons donc obtenu notre 0150 lux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais comme on dit "pas un seul simulateur ...". Voyons ce qui se passe dans la pratique. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mesure sous la lumière du lustre et la lumière naturelle (éclairage combiné): Les </font></font><br>
<br>
<img src="https://habrastorage.org/webt/of/ze/ps/ofzepsndi0bepg1hwoxzursk7my.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lectures du posemètre d'usine et de notre fait maison coïncident presque parfaitement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mesure à la lumière du jour: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/w_/kz/aq/w_kzaqulbnhvr-pq2tsdcy7pqu8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
extrêmement pire.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela est probablement dû à la non-linéarité des caractéristiques de la photorésistance, et aussi parce que nous avons fixé la limite d'échelle inférieure à zéro, mais nous ne compliquerons pas le diagramme afin d'augmenter la précision de mesure; pour notre exemple, l'essentiel était de comprendre le principe général d'obtention des valeurs d'éclairage. </font><font style="vertical-align: inherit;">Et l'augmentation de la précision peut être retardée jusqu'à la mise en œuvre de ces projets dans la voiture ou à la maison. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous vérifions le fonctionnement du circuit, fermons le capteur avec un doigt, puis retirons le doigt. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4f/nh/qd/4fnhqd-jpxmvsbj5wtvwnokgybg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et maintenant, il y a une option quand il fait juste noir dans la pièce: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5r/d7/lc/5rd7lcy5_cdx339o6z6c39r3y5i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
la lampe est allumée. </font><font style="vertical-align: inherit;">Tout fonctionne comme il se doit.</font></font><br>
<br>
<a name="V"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Partie V: essayer de réduire la luminosité de la lampe en utilisant PWM</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compliquons un peu le schéma en modifiant la luminosité de la lampe. Pour ce faire, nous avons besoin d'un PWM haute fréquence (RF PWM), dans Canny 3 tiny il est implémenté aux sorties n ° 3 et n ° 4. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai décidé d'utiliser la sortie n ° 4. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le schéma de connexion restera pratiquement inchangé. Simplement, au lieu de la sortie n ° 1, nous connectons la sortie n ° 4 à la lampe </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qp/bg/b-/qpbgb-a7whds1vugbizqoyr3its.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
. Toute la différence est qu'au lieu d'un fil blanc, le cadre est maintenant bleu. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2t/z3/nl/2tz3nldjplnly2tzmo7ttrb0he0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le diagramme n'a pas non plus beaucoup changé. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/or/fx/wl/orfxwlbv1adspw_c0fv2ouenqhy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je ne peindrai pas le diagramme en détail. Les principaux changements dans la configuration de la sortie 4, que nous utilisons pour PWM. Dans cette section, nous devons définir le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Registre des paramètres de remplissage"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">il prend des valeurs de 2 à 255 microsecondes, j'ai décidé de ne pas le risquer et j'ai choisi 254. A noter qu'il est installé pour deux canaux à la fois (n ° 3 et n ° 4). Ensuite, nous écrivons "1" dans le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"registre d'activation de canal PWM n ° 4"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , incluant ainsi le PWM de notre ampoule. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le bloc </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Allumer la lampe en mode PWM (avec faible luminosité)", la</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nouveauté pour nous est seulement </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"S'inscrire pour régler le canal de remplissage n ° 4, μs"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nous y inscrirons la valeur "10", à condition que le niveau d'éclairage au-dessus du capteur photo soit inférieur à 250 lux, en dans la seconde. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La photo ci-dessous montre que la lampe s'allume, mais elle brille faiblement.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/om/pp/_t/ompp_teo-f76yagfthj5qylheus.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous voulez que la lampe brille plus, il vous suffit de changer la valeur de la constante «10» en un nombre plus grand. Par exemple, vous pouvez prendre le nombre 127, dans notre cas, c'est la moitié du temps qu'il faut pour remplir la période RF PWM, ce qui signifie environ la moitié de la luminosité de la lampe. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lx/ni/3t/lxni3tbt3zw1y6lyqthoqqufc1w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il convient de noter que le RF PWM avec cette lampe fonctionne de manière assez notable. Voici trois photos: sur la première, nous fixons la </font><font style="vertical-align: inherit;">valeur </font><font style="vertical-align: inherit;">dans le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Registre pour remplir le canal numéro 4"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> à 10 μs, sur la seconde - 110 μs, à droite - 210 μs. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ud/os/_w/udos_wpczlgn2m1naf4nc5053da.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En principe, la lampe automatique de notre exemple, si je comprends bien, est utilisée dans les signaux de position et parfois dans les feux de brouillard des voitures.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je pense que si nous affinons le schéma et le schéma, il serait possible de mettre en œuvre l'inclusion du rétro-éclairage en basse lumière sur les machines plus anciennes. </font><font style="vertical-align: inherit;">Certes, vous devez tenir compte de l'effet de l'éclairage artificiel la nuit. </font><font style="vertical-align: inherit;">Alors que sur les routes, dans les tunnels et depuis les phares des voitures venant en sens inverse, la lampe ne s'est pas éteinte. </font><font style="vertical-align: inherit;">Ou il serait possible de contrôler la lampe dans l'habitacle afin que, par exemple, les lampes des portes du Zhiguli ou du Niva ne s'allument pas toujours à l'ouverture.</font></font><br>
<br>
<a name="VI"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Partie VI: Conclusion </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En écrivant cet article, j'ai ressenti un fort sentiment de nostalgie. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pendant mes études à l'institut, mon ami et camarade de classe Seryoga avait une berline de marque VAZ 2107 bleu chic. Ce qu'il n'a juste pas fait avec lui: il attachera une sorte de tuyau (pour augmenter le boost), installera un ventilateur dans l'habitacle pour qu'il s'allume par un bouton séparé, puis il fera démarrer la voiture en appuyant sur un bouton (uniquement avec la clé tournée) allumage). En général, il n'a tout simplement pas «réglé» son «hirondelle». De nombreuses années se sont écoulées depuis lors, mon ami est passé à une voiture plus solide, mais j'ai peur d'imaginer ce qu'il ferait de son Zhiguli s'il obtenait ce contrôleur il y a 10 ans.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Grâce à cet article, je me suis également souvenu de ma destination. Après tout, j'ai étudié pendant de nombreuses années en tant qu'ingénieur en automatisation, mais je n'ai pas travaillé un jour uniquement dans ma spécialité. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'avère que c'est tellement cool de plonger dans le monde du bricolage. Dans le processus d'assemblage des circuits plus d'une fois «coincé» en allumant / éteignant l'ampoule et la LED avec un bouton. C'est une sensation agréable lorsque quelque chose fonctionne comme prévu. Je me suis également fait une idée que la programmation d'un contrôleur à l'aide de diagrammes est une tâche plus méditative que l'écriture de code dans l'IDE Arduino. Une perception complètement différente du programme. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En écrivant cet article, je me suis commandé une version de Canny 3 tiny sans faisceau de câbles. Maintenant, je vais prendre un peu de repos et écrire un article sur l'installation de ce contrôleur dans une planche à pain, et à lui seul, nous analyserons quelques autres exemples d'automatisation d'éclairage avec son aide.</font></font><br>
<br>
<i>   ,  ,    . </i><br>
<br>
<i>UPD:<br>
,       ,            :</i><br>
<br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">«, ,  –  !»       CANNY 3 tiny</a>.<br>
</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">«  ...»         (CANNY  Arduino)  Raspberry PI</a>.<br>
</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">« ?»     bluetooth      Xamarin (Android)</a>.<br>
</li>
</ol></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr489754/index.html">20 systèmes de gestion de projet, aperçu de 100 puces</a></li>
<li><a href="../fr489756/index.html">Créer un effet crayon en SVG</a></li>
<li><a href="../fr489758/index.html">Angulaire: un exemple d'utilisation de NGRX</a></li>
<li><a href="../fr489760/index.html">Conscience et existence. Mécanique quantique sans paradoxes</a></li>
<li><a href="../fr489762/index.html">Un exemple simple d'analyse et d'analyse de données pour World of Tanks</a></li>
<li><a href="../fr489768/index.html">Comment π combine des blocs en collision et un algorithme de recherche quantique</a></li>
<li><a href="../fr489770/index.html">Vidéo de MinskJS mitap: mon rapport sur les extensions de navigateur</a></li>
<li><a href="../fr489772/index.html">Hackathon à Simferopol, Yandex. Dialogues et lois de la technologie chat-bot</a></li>
<li><a href="../fr489774/index.html">L'histoire de la façon dont j'ai automatisé l'appartement en utilisant Node-RED. Partie II</a></li>
<li><a href="../fr489776/index.html">The Ember Times - Numéro 136</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>