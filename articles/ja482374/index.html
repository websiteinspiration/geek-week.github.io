<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍⚕️ 🙆🏻 🍴 Entity Component Systemテンプレートを使用して、LibGDXでゲームを開発します ⏳ 😰 💞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="こんにちはハブル！私の名前はAndrey Shiloです。FINCHの Android開発者です。今日は、最も簡単なゲームを書くときにもしてはならないミスと、エンティティコンポーネントシステム（ECS）のアーキテクチャアプローチが優れている理由について説明します。
 
 初めてはいつもつらいです
 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Entity Component Systemテンプレートを使用して、LibGDXでゲームを開発します</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482374/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こんにちはハブル！</font><font style="vertical-align: inherit;">私の名前はAndrey Shiloです</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。FINCHの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Android開発者</font><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">今日は、最も簡単なゲームを書くときにもしてはならないミスと、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エンティティコンポーネントシステム</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ECS）の</font><font style="vertical-align: inherit;">アーキテクチャアプローチが</font><font style="vertical-align: inherit;">優れている</font><font style="vertical-align: inherit;">理由について説明し</font><font style="vertical-align: inherit;">ます。</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">初めてはいつもつらいです</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
大規模なメディアの開催のための楽しいプロジェクトが1つあります。これは非標準的なソーシャルです。投稿、コメント、いいね！、動画を含むネットワーク。かつて、彼らは私たちに仕事を与えました-プロモーションとしてゲームの仕組みを紹介することです。ゲームはシンプルなミニレースのように見え、左/右をタップすると、車が左/右のレーンに移動しました。したがって、障害物を避けてゴールまで到達しなければならないブースターを集めると、全体として、プレーヤーには3つのライフがありました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ゲームはもちろん、アプリケーション内の別の画面に実装されることになっていました。</font><font style="vertical-align: inherit;">Kotilnでゲームをコーディングし、デスクトップでデバッグして、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Javaアプリケーション</font></a><font style="vertical-align: inherit;">としてゲームを起動できるため</font><font style="vertical-align: inherit;">、エンジンとして</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LibGDXを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">無条件に選択し</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ました</font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">同時に、アプリケーションに実装できる他のエンジンを知っている人はいませんでした（ご存知の場合は、共有してください）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ゲームは次のようになります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/le/xy/z0/lexyz0syrcyj6czcecctxnw0kh8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
元のTKによるゲームはシンプルに見えたため、アーキテクチャアプローチについては詳しく説明しませんでした。</font><font style="vertical-align: inherit;">さらに、プロモーション自体はすぐに成功します-平均して、1つの共有には1か月半かかります。</font><font style="vertical-align: inherit;">したがって、後で、誰かがそのようなことを繰り返したい場合は、ゲームコードは単に切り取られ、次の同様のプロモーションまで必要ありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のすべての要因と最愛のマネージャーから、アーキテクチャのないゲームメカニックを作成するように強く勧められました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果のゲームの説明</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほとんどのコードはクラスでコンパイルされました：MyGdxGame：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Game</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、GameScreen：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Screen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">およびTrafficGame：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Actor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MyGdxGame-ゲームの開始時のエントリポイントです。ここでは、パラメーターは文字列の形式でコンストラクターに転送されます。 GameScreenとゲームパラメータもここで作成され、このクラスに渡されますが、形式は異なります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GameScreen-ゲームTrafficGameのアクターを作成し、シーンに追加し、すでに述べたパラメーターを彼に渡します。また、画面上のユーザークリックを「リッスン」し、アクターTrafficGameの対応するメソッドを呼び出します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TrafficGame-ゲームのすべての動きが行われるシーンの主要な俳優：レンダリングと作業のロジック。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">scene2dを</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
使用し</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ますが</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アクターの入れ子のツリーを構築することが可能になりますが、これは最良のアーキテクチャソリューションではありません。</font><font style="vertical-align: inherit;">ただし、（LibGDXで）UI / UXゲームを実装するには、scene2dが優れたオプションです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの場合、TrafficGameには、混合インスタンスの膨大なコレクションと、大きな</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">when</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">構造を</font><font style="vertical-align: inherit;">持つメソッドで許可されたあらゆる種類の動作フラグがあり</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">例：</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-keyword">var</span> isGameActive: <span class="hljs-built_in">Boolean</span> = <span class="hljs-literal">true</span>
   <span class="hljs-keyword">set</span>(value) {<font></font>
       backgroundActor?.isGameActive = value<font></font>
       boostersMap.values.filterNotNull().forEach { it.isGameActive = value }<font></font>
       obstaclesMap.values.filterNotNull().forEach { it.isGameActive = value }<font></font>
       finishActor.isGameActive = value<font></font>
       field = value<font></font>
   }<font></font>
<font></font>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> backgroundActoolbarActor
<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> pauseButtonActor: PauseButtonActor
<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> finishActor: FinishActor<font></font>
<font></font>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> isQuizWon = falser: BackgroundActor? = <span class="hljs-literal">null</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> playerCarActor: PlayerCarActor
<span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> toolbarActor: To<font></font>
<font></font>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> pointsTime = <span class="hljs-number">0f</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> totalTimeElapsed = <span class="hljs-number">0</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> timeToFinishTheGame = <span class="hljs-number">50</span><font></font>
<font></font>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> lastQuizBoosterTime = <span class="hljs-number">0.0f</span><font></font>
<font></font>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> lastBoosterTime = <span class="hljs-number">0.0f</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> boostersMap = hashMapOf&lt;<span class="hljs-built_in">Long</span>?, BoosterActor?&gt;()
<span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> boosterSpawnedCount = <span class="hljs-number">0</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> totalBoostersEatenCount = <span class="hljs-number">0</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> boosterLimit = <span class="hljs-number">20</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> lastBoosterYPos = <span class="hljs-number">0.0f</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> toGenerateBooster = <span class="hljs-literal">false</span><font></font>
<font></font>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> lastObstacleTime = <span class="hljs-number">0.0f</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> obstaclesMap = hashMapOf&lt;<span class="hljs-built_in">Long</span>?, ObstacleActor?&gt;()
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当然、そのように書くべきではありません。</font><font style="vertical-align: inherit;">しかし、弁護のために、私はそれがそう起こったと言います：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あなたは今すぐ始める必要があります、そして私たちは後でデザインの最終的なTKを表示します。</font><font style="vertical-align: inherit;">クラシック</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すでによく知られているアーキテクチャ（MVP / MVC / MVVMなど）は、純粋にユーザーインターフェイス用に設計されているため、ゲームではすべてがリアルタイムで発生するため、ゲームプロセスの実装には適していません。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初はゲームは単純に見えましたが、実際には、ゲームの作成中に浮かび上がる膨大な数のニュアンスを考慮すると、多くのコードが必要でした。</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/8e/cg/sn/8ecgsncl5hmmhmzw8unltjyqgh0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のすべての困難に加えて、継承には別の一般的な問題があります。</font><font style="vertical-align: inherit;">たとえばプラットフォーマーなど、ゲームをより困難にすると、「再利用されたコードをゲームのオブジェクト間でどのように分配するか？」という疑問が生じます。</font><font style="vertical-align: inherit;">最も一般的に選択されるオプションは継承です。この場合、再利用可能なコードが親クラスに配置されます。</font><font style="vertical-align: inherit;">しかし、この解決策は、継承ツリーに適合しない条件が発生した場合に多くの問題を引き起こします。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xg/tw/_6/xgtw_64w3v31if0kfnwoy9yemlg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常、これらの問題は、継承ツリーの構造をゼロから書き直すことで解決する（まあ、今回はそれがより良いでしょう）か、松葉杖で親クラスを壊します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/af/8-/4o/af8-4ovkeruwatlo--agakilupm.gif"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ECSがすべてです</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まったく異なるストーリーが、2つ目のプロモーションゲームです。彼女は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ゆるい鳥の</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ようでした</font><font style="vertical-align: inherit;">が、違いはあります。キャラクターは音声で操作され、天井と床は障害物ではありませんでした。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ゲームプロセスの例、および比較のためのゆるい鳥の再生プロセス：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/9k/sv/ao/9ksvaojzedwbnyd0nm602f2n90e.gif"><br>
<img src="https://habrastorage.org/webt/gr/sq/3t/grsq3twwn7aorv6utrvdvgnwldw.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
わかりやすくするために、例では、ゲームの舞台裏を見るためにカメラを取り外しています。床と天井は正方形のブロックであり、端に到達すると、最初に再配置され、後ろから来る特定のパターンに従って障害が生成されます。ゲームのデザインはお客様が選んだものなので、驚かないでください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私はモバイルデバイス向けのゲームの開発が好きで、営業時間外は実験のために、ゲームパターンやゲーム開発に関連するその他すべてを探索します。私は本を​​読んだ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ゲームデザインのパターン</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。ただし、ECSに出会うまでは、ゲームプレイロジックの真のアーキテクチャが何であるかを理解していませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エンティティコンポーネントシステム-ゲーム開発で最も頻繁に使用されるデザインパターン。パターンの主なアイデアは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">継承で</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">なく構成</font></a><font style="vertical-align: inherit;">です。コンポジションを使用すると、ゲームオブジェクトにさまざまなメカニズムを混在させることができます。これにより、将来は、たとえば、作成されたコンストラクタを介して、オブジェクトプロパティの設定をゲームデザイナに委任できます。私はこのパターンにすでに慣れているので、2番目のゲームに適用することにしました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パターンのコンポーネントを検討してください：</font></font><br>
<br>
<ul>
<li><i>Component</i> —   <b>  </b>    ,     .          . , , ,   ..  ..           .<br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">VelocityComponent</span>: <span class="hljs-type">Component {</span></span>
    <span class="hljs-keyword">val</span> velocity = Vector2()<font></font>
}</code></pre></li>
<li><i>Entity</i> —  : //    .      : UltraMegaSuperman: GameUnit,   <b> </b>   Component.        UltraMegaSuperman       . <br>
        : <br>
<br>
<ul>
<li>TextureComponent — ,    </li>
<li>TransformComponent —     </li>
<li>VelocityComponent —      </li>
<li>HeroControllerComponent —      </li>
<li>ImmortalityTimeComponent —    </li>
<li>DynamicComponent —        </li>
<li>BodyComponent —   2d  ,    </li>
</ul></li>
<li><i>System</i> —        .   <b>    Entity / Component</b>,      .       . <br>
<br>
    :    ,     ,  ,        .      :<br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">processEntity</span><span class="hljs-params">(entity: <span class="hljs-type">Entity</span>, deltaTime: <span class="hljs-type">Float</span>)</span></span> {<font></font>
   entity.getComponent(VelocityComponent::<span class="hljs-keyword">class</span>.java)<font></font>
       .velocity<font></font>
       .add(<span class="hljs-number">0f</span>, -GRAVITY * deltaTime)<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各システムの特殊化によって、処理する必要があるエンティティの要件が決まります。</font><font style="vertical-align: inherit;">つまり、上記の例では、このエンティティを処理できるように、エンティティにVelocityComponentおよびDynamicComponentの速度コンポーネントが必要です。そうでない場合、このエンティティはシステムにとって興味深いものではないため、他のエンティティと同様です。</font><font style="vertical-align: inherit;">たとえば、テクスチャを描画するには、TextureComponentテクスチャとは何か、TransformComponentを描画する場所を知っている必要があります。</font><font style="vertical-align: inherit;">各システムの要件を決定するために、ファミリーはコンポーネントのクラスが示されるコンストラクターで記述されます。</font></font><br>
<br>
<pre><code class="kotlin hljs">Family.all(TransformComponent::<span class="hljs-keyword">class</span>.java, TextureComponent::<span class="hljs-keyword">class</span>.java).<span class="hljs-keyword">get</span>()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、システム内の処理エンティティの順序は、コンパレーターによって調整できます。</font><font style="vertical-align: inherit;">さらに、エンジン内のシステムの実行順序も優先度の値によって決まります。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エンジンは3つのコンポーネントを組み合わせます。</font><font style="vertical-align: inherit;">ゲーム内のすべてのシステムとすべてのエンティティが含まれています。</font><font style="vertical-align: inherit;">ゲームの開始時に、ゲームに必要なすべてのシステム</font></font><br>
<br>
<pre><code class="kotlin hljs">engine.apply {<font></font>
   addSystem(ControlSystem())<font></font>
   addSystem(GravitySystem())<font></font>
   addSystem(renderingSystem)<font></font>
   addSystem(MovementSystem())<font></font>
   addSystem(EnemyGeneratorSystem())<font></font>
}</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">開始エンティティと同様にエンジンに追加され、</font></font><br>
<pre><code class="kotlin hljs"><span class="hljs-keyword">val</span> hero: Entity = engine.createEntity()<font></font>
engine.addEntity(hero)</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PooledEngine :: createEntity-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エンティティ</font><font style="vertical-align: inherit;">はゲーム中に作成されるため、メモリをポイ捨てしないように</font><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プール</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">からエンティティオブジェクトを取得</font><font style="vertical-align: inherit;">します。</font><font style="vertical-align: inherit;">必要に応じて、オブジェクトのプールから取得され、削除されると元に戻されます。</font><font style="vertical-align: inherit;">コンポーネントについても同様です。</font><font style="vertical-align: inherit;">プールからコンポーネントを受け取るとき、このコンポーネントの以前の使用に関する情報が含まれている可能性があるため、すべてのフィールドを初期化する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パターンの主要部分間の関係を以下に示します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gk/tj/ak/gktjakst_gxpnuikd_bbgpnfv2a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エンジンには、システムのコレクションとエンティティのコレクションが含まれています。</font><font style="vertical-align: inherit;">各システムはエンジンからエンティティのコレクションへのリンクを受け取ります。これは、システムの要件に応じた一般的なコレクションからの選択です。エンティティとコンポーネントが変更されると、ゲーム中に更新されます。</font><font style="vertical-align: inherit;">各エンティティには、ゲーム内でそれを定義するコンポーネントのコレクションが含まれています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ゲームサイクルは次のように構成されています。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LibGDX </font><font style="vertical-align: inherit;">の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「ゲームサイクル」</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パターンの実装を使用</font><font style="vertical-align: inherit;">して、updateメソッドで、タイムステップごとに増分を取得します-deltaTime。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次に、時間をエンジンに渡します。</font><font style="vertical-align: inherit;">そして、次に、システムでサイクルを繰り返し、それらをdeltaTimeに分散します。</font></font><pre><code class="kotlin hljs"><span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> until systems.size()) {
   <span class="hljs-keyword">val</span> system = systems[i]
   <span class="hljs-keyword">if</span> (system.checkProcessing()) {<font></font>
       system.update(deltaTime)<font></font>
   }<font></font>
}</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deltaTimeを受信するシステムは、エンティティ全体をソートし、deltaTimeを考慮して変更をエンティティに適用します。</font></font><pre><code class="kotlin hljs"><span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> until entities.size()) {<font></font>
   processEntity(entities[i], deltaTime)<font></font>
}</code></pre></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはゲームのあらゆる手段で発生します。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ECSの利点</font></font></h2><br>
<ol>
<li><b>   </b>.          ,           ,              . <br>
<br>
,    «».  -        — «».      ,    .      ,     .<br>
<br>
                   —       ,        .    ,      TheTank      : , , ,  ,    ..       .<br>
</li>
<li>,       <b> </b>,           . <br>
<br>
 .        ,      ~2     ,       ,    ,     . <br>
<br>
        «             ».  ,       —           .</li>
<li>  <b> </b>.           ,     .</li>
<li> ,  <b>  </b>,      .                    .    ,            .</li>
</ol><br>
<br>
<h2>ECS    gamedev</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unity、Epic、Crytekなどの大企業は、このテンプレートをフレームワークで使用して、開発者に大量の機能を備えたツールを提供しています。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Overwatchでのゲームプレイロジックの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実装方法に関するレポートをご覧になることをお勧めします</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">。</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
理解を深めるために、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">githubで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小さな</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">例</font></a><font style="vertical-align: inherit;">を作成しました</font><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご清聴ありがとうございました！</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">また、トピックについて：</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ゲームの実装と例</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ECSとall-all-all</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ECSの基本</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンポーネントとエンティティシステム</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja482362/index.html">ほぼ無政府状態：Fidonetの簡単な歴史、インターネット経由での勝利を気にしないプロジェクト</a></li>
<li><a href="../ja482364/index.html">あなたが[たぶん] Javaについて知らなかったこと</a></li>
<li><a href="../ja482366/index.html">ロボットカーの専門家はテスラオートパイロットについてどう思いますか</a></li>
<li><a href="../ja482370/index.html">nodejs：プロセスマネージャーとES6モジュール</a></li>
<li><a href="../ja482372/index.html">Hyper-VでArch Linuxゲストの拡張セッションモードを有効にする</a></li>
<li><a href="../ja482378/index.html">ワコムの簡単な歴史：グラフィックタブレットテクノロジーが電子リーダーにどのように登場したか</a></li>
<li><a href="../ja482382/index.html">翻訳の4つの原則、またはどのようにして男性は機械翻訳者に屈服しないでしょうか？</a></li>
<li><a href="../ja482384/index.html">私の未実現プロジェクト。200 MikroTikルーターのネットワーク</a></li>
<li><a href="../ja482390/index.html">Ember.jsチュートリアルのチュートリアル。スーパーレンタルアプリ。パート1.2</a></li>
<li><a href="../ja482392/index.html">GoのELFトリック</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>