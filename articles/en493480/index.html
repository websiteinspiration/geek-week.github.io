<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêã ‚õîÔ∏è üíÉüèΩ Architecture for beginners or why you do not need to insert a flag in the sword man ü¶É ü§∑üèø ü•£</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Annotation:
 
 

1. An example of the implementation of new functionality in the class by adding a "flag".
2. Effects.
3. Alternative approach and com...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Architecture for beginners or why you do not need to insert a flag in the sword man</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/493480/"><img src="https://habrastorage.org/webt/9s/96/tv/9s96tvz6feehvgoiz_gmwdoktl8.png"><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Annotation:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An example of the implementation of new functionality in the class by adding a "flag".</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Effects.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alternative approach and comparison of results.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to avoid the situation: ‚ÄúArchitectural overkill‚Äù?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The moment when the time comes to change everything.</font></font></li>
</ol></blockquote><br>
<a name="habracut"></a><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Before you begin, a couple of notes:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is a story about software architecture - in the sense that Uncle Bob uses. </font><font style="vertical-align: inherit;">Yes, that one.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">All characters, their names and code in the article are fictitious, any coincidences with reality are random.</font></font></li>
</ul></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suppose I am an ordinary programmer-programmer on a project. </font><font style="vertical-align: inherit;">The project is a game in which a single Hero (aka Hero) goes along a perfectly horizontal line from left to right. </font><font style="vertical-align: inherit;">Monsters interfere with this wonderful journey. </font><font style="vertical-align: inherit;">At the user's command, the Hero famously cuts them </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with a sword</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> into the cabbage and does not blow into the mustache. </font><font style="vertical-align: inherit;">The project already has 100K lines, and ‚Äúyou need more </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lines of</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> features!‚Äù </font><font style="vertical-align: inherit;">Let's look at our Hero:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hero</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">//   1</span><font></font>
    }<font></font>
    <span class="hljs-comment">//   </span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suppose also that my personal team lead, Vasily, can also go on vacation. </font><font style="vertical-align: inherit;">Suddenly. </font><font style="vertical-align: inherit;">Who would have thought? </font><font style="vertical-align: inherit;">Further, the situation develops as standard: an Owl flies in and urgently needs, right yesterday, to make it possible to choose before the start of the game: play for the Hero with a club or with a sword. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It must be very fast. </font><font style="vertical-align: inherit;">And yes, of course, he himself was a programmer for more than years than I can walk, so he knows that the task is for five minutes. </font><font style="vertical-align: inherit;">But so be it, estimate for 2 hours. </font><font style="vertical-align: inherit;">You just need to add a checkbox and if-chik. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note: if-chik in the value @! ^% $ # @ ^% &amp; @! 11 $ its # $% @ ^% &amp;! @ !!! </font><font style="vertical-align: inherit;">in &amp;! ^% # $ ^%! 1 if-chic! </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
My thoughts: ‚ÄúHa! </font><font style="vertical-align: inherit;">Two hours! </font><font style="vertical-align: inherit;">Done! ‚Äù:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hero</span> </span>{
    <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">WeaponTypes</span> </span>{
        <span class="hljs-keyword">case</span> sword:
        <span class="hljs-keyword">case</span> club:<font></font>
    }<font></font>
	<font></font>
    <span class="hljs-keyword">var</span> weaponType: <span class="hljs-type">WeaponTypes?</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> weaponType = weaponType <span class="hljs-keyword">else</span> {
            <span class="hljs-built_in">assertionFailure</span>()
            <span class="hljs-keyword">return</span>	<font></font>
        }<font></font>
        <span class="hljs-comment">//  : switch  Swift  if- -    !</span>
        <span class="hljs-keyword">switch</span> (weaponType) {
            <span class="hljs-keyword">case</span> .sword: <span class="hljs-comment">//     </span>
            <span class="hljs-keyword">case</span> .club:  <span class="hljs-comment">//     </span><font></font>
        }<font></font>
    }<font></font>
    <span class="hljs-comment">//  </span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you found out in my decision, then, alas: I have two news for you:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As if good: we both deliver. </font><font style="vertical-align: inherit;">We deliver - from the word deliver value or from the word funny (through tears) code.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And the bad one: without Vasily, the kapets project.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So what happened? </font><font style="vertical-align: inherit;">It would seem so far nothing. </font><font style="vertical-align: inherit;">But let's see what happens next (while we are doing everything we can to keep Vasily on vacation). </font><font style="vertical-align: inherit;">And then there will be this: the QA department will pay attention to the weight of our Hero. </font><font style="vertical-align: inherit;">And no, this is not because the Hero has to go on a diet, but here's why:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
    <span class="hljs-keyword">return</span> meatbagWeight + pantsWeight + helmetWeight + swordWeight<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I forgot to fix the weight calculation. </font><font style="vertical-align: inherit;">Well, you think, mistake, with whom does not happen ?! </font><font style="vertical-align: inherit;">Slap-bloop, fuck-tibidoch, ready:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
    <span class="hljs-comment">//   guard let weaponType</span>
    <span class="hljs-keyword">let</span> weightWithoutWeapon = meatbagWeight + pantsWeight + helmetWeight
    <span class="hljs-keyword">switch</span> (weaponType) {
        <span class="hljs-keyword">case</span> .sword: <span class="hljs-keyword">return</span> weightWithoutWeapon + swordWeight
        <span class="hljs-keyword">case</span> .club:  <span class="hljs-keyword">return</span> weightWithoutWeapon + clubWeight<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But quickly fixed it! </font><font style="vertical-align: inherit;">The hero is now jumping, taking into account the weight, but. </font><font style="vertical-align: inherit;">Result-oriented work! </font><font style="vertical-align: inherit;">This is not for you to look at navels, architectural astronauts. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Well, really, then he corrected a little more. </font><font style="vertical-align: inherit;">In the spell list, I had to do this:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {
    <span class="hljs-comment">//   guard let weaponType </span>
    <span class="hljs-comment">// ,   let spellsWithoutWeapon: [Spells]</span>
    <span class="hljs-keyword">switch</span> (weaponType) {
        <span class="hljs-keyword">case</span> .sword:
            <span class="hljs-comment">//  let swordSpells: [Spells]</span>
            <span class="hljs-keyword">return</span> spellsWithoutWeapon + swordSpells
	<span class="hljs-keyword">case</span> .club:
            <span class="hljs-comment">//  let clubSpells: [Spells]</span>
            <span class="hljs-keyword">return</span> spellsWithoutWeapon + clubSpells<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And then Petya came and broke everything. </font><font style="vertical-align: inherit;">Well, the truth is, we have such a june on the project. </font><font style="vertical-align: inherit;">Inattentive. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
He just needed to add the concept of ‚ÄúWeapon Level‚Äù to the formula for calculating the strength of the blow and the weight of the Hero. </font><font style="vertical-align: inherit;">And Petya missed one of four cases. </font><font style="vertical-align: inherit;">But nothing! </font><font style="vertical-align: inherit;">I corrected everything:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">//guard let weaponType</span>
    <span class="hljs-keyword">switch</span> (weaponType) {
        <span class="hljs-keyword">case</span> .sword: <span class="hljs-comment">//        weaponGrade</span>
        <span class="hljs-keyword">case</span> .club:  <span class="hljs-comment">//        weaponGrade</span><font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
    <span class="hljs-comment">// guard let weaponType</span>
    <span class="hljs-keyword">let</span> weightWithoutWeapon = meatbagWeight + pantsWeight + helmetWeight
    <span class="hljs-keyword">switch</span> (weaponType) {
        <span class="hljs-keyword">case</span> .sword: <span class="hljs-keyword">return</span> weightWithoutWeapon + swordWeight / grade
	<span class="hljs-keyword">case</span> .club:  <span class="hljs-keyword">return</span> weightWithoutWeapon + pow(clubWeight, <span class="hljs-number">1</span> / grade)<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {
    <span class="hljs-comment">//     , ! </span>
    <span class="hljs-comment">// ,     .    ,    ,   .   !</span>
}</code></pre><br>
<img src="https://habrastorage.org/webt/aw/ev/fo/awevfo6jjlysv_8l9wq-dl9npkw.png" height="80" width="80" align="right"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Needless to say, when (suddenly!) It was necessary to add a bow / update formulas, again there were forgotten cases, bugs and that was all. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What went wrong? </font><font style="vertical-align: inherit;">Where was I wrong, and what (except for the mates) did Vasily say when he returned from vacation? </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here you can not read the story further, but, for example, think about the eternal, about architecture. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And with those who still decided to read, we continue. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, let's look at the classics:</font></font><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Premature optimization is the root of all evil!</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And ... uh ... that's not it. </font><font style="vertical-align: inherit;">Here's the thing: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In OOP languages ‚Äã‚Äã(like Swift, for example), there are three main ways to extend the capabilities of a class:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The first way is ‚Äúnaive‚Äù. </font><font style="vertical-align: inherit;">We just saw him. </font><font style="vertical-align: inherit;">Adding a checkbox. </font><font style="vertical-align: inherit;">Adding Responsibility. </font><font style="vertical-align: inherit;">Swelling class.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The second way is inheritance. </font><font style="vertical-align: inherit;">Everyone knows a powerful mechanism for reusing code. </font><font style="vertical-align: inherit;">One could, for example:</font></font><br>
 <ul>
<li><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To inherit the new Hero with the Bow and Hero from Dubina from the Hero (who is holding a sword, but this is not reflected in the name of the Hero class now). </font><font style="vertical-align: inherit;">And then in the heirs, override the changed methods. </font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This path is very bad (just trust me).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Make the base class (or protocol) a Hero, and remove all the features associated with a particular type of weapon as heirs </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
: Hero with a </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sword: Hero, </font><font style="vertical-align: inherit;">Hero with a </font><font style="vertical-align: inherit;">bow: Hero, Hero with </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dubina: Hero. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is better, but the names of these classes themselves look at us somehow displeased, fiercely and at the same time sad and perplexed. </font><font style="vertical-align: inherit;">If they don‚Äôt look at someone like that, then I‚Äôll try to write another article, where in addition to the boring masculine Hero they will be ...</font></font><img src="https://habrastorage.org/webt/7i/7w/l7/7i7wl7kxg1ol1mmtplsfv-h7i4w.png" height="80" width="80"></li>
</ul></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The third way is the separation of responsibility through dependency injection. </font><font style="vertical-align: inherit;">It can be a dependency closed by a protocol or a closure (as if closed by a signature), whatever. </font><font style="vertical-align: inherit;">The main thing is that the implementation of new responsibilities should leave the main class.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How can this look in our case? </font><font style="vertical-align: inherit;">For example, like this (decision from Vasily):</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hero</span> </span>{
    <span class="hljs-keyword">let</span> weapon: <span class="hljs-type">Weapon</span> <span class="hljs-comment">//   , ..    </span><font></font>
<font></font>
    <span class="hljs-keyword">init</span> (<span class="hljs-number">_</span> weapon: <span class="hljs-type">Weapon</span>) { <span class="hljs-comment">//     </span>
        <span class="hljs-keyword">self</span>.weapon = weapon<font></font>
    }<font></font>
	<font></font>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {<font></font>
        weapon.strike()<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
        <span class="hljs-keyword">return</span> meatbagWeight + pantsWeight + helmetWeight + weapon.weight<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {
        <span class="hljs-comment">//   </span>
        <span class="hljs-keyword">return</span> spellsWithoutWeapon + weapon.spells<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What do you need to be so? </font><font style="vertical-align: inherit;">Ninjutsu - protocol:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">protocol</span> <span class="hljs-title">Weapon</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span>
    <span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {<span class="hljs-keyword">get</span>}
    <span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {<span class="hljs-keyword">get</span>}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Protocol implementation example:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sword</span>: <span class="hljs-title">Weapon</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// ,     Hero  switch   .sword</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
        <span class="hljs-comment">// ,     Hero  switch   .sword</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {
        <span class="hljs-comment">// ,     Hero  switch   .sword</span><font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Similarly, Sword classes are written for: Club, Bow, Pike, etc. </font><font style="vertical-align: inherit;">‚ÄúIt is easy to see‚Äù (c) that in the new architecture all the code that relates to each particular type of weapon is grouped in the corresponding class, and is not spread according to the Hero along with other types of weapons. </font><font style="vertical-align: inherit;">This makes it easier to read and understand the Hero and any particular weapon. </font><font style="vertical-align: inherit;">Plus, due to the requirements of the imposed protocol, it is much easier to track all the methods that need to be implemented when adding a new type of weapon or when adding a new feature to a weapon (for example, a weapon may have a price calculation method). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here you can see that dependency injection has complicated the creation of Hero class objects. </font><font style="vertical-align: inherit;">What used to be done as simply:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">let</span> lastHero = <span class="hljs-type">Hero</span>()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now it has turned into a set of instructions that will be duplicated wherever it is necessary to create a Hero. </font><font style="vertical-align: inherit;">However, Vasily took care of this:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HeroFactory</span> </span>{
    <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">makeSwordsman</span><span class="hljs-params">()</span></span> -&gt; <span class="hljs-type">Hero</span> { <span class="hljs-comment">// ,  static -  </span>
        <span class="hljs-keyword">let</span> weapon = <span class="hljs-type">Sword</span>(<span class="hljs-comment">/*  */</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-type">Hero</span>(weapon)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">makeClubman</span><span class="hljs-params">()</span></span> -&gt; <span class="hljs-type">Hero</span> {
        <span class="hljs-keyword">let</span> weapon = <span class="hljs-type">Club</span>(<span class="hljs-comment">/*  */</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-type">Hero</span>(weapon)<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is clear that Vasily had to sweat in order to scatter the pile that was </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">piled up</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> designed by Petya (and I). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Of course, looking at the last solution, the following thought may arise:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ok, it turned out, norms. </font><font style="vertical-align: inherit;">It‚Äôs convenient to read and expand, but are all these factories / protocols / dependencies a bunch of overheads? </font><font style="vertical-align: inherit;">A code that does not give anything in terms of features, but exists only to organize the code. </font><font style="vertical-align: inherit;">"Code for organizing the code", mgm. </font><font style="vertical-align: inherit;">Is it really necessary to fence this garden always and everywhere?</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An honest answer to the first question would be:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yes, this is an overhead for features that business loves so much. </font></font><br>
</blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And to the question ‚Äúwhen?‚Äù </font><font style="vertical-align: inherit;">answers section:</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The philosophy of the sword-man or ‚Äúwhen did you have to rule?‚Äù</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the beginning was a sword man. </font><font style="vertical-align: inherit;">In the sense system of the old code, this was quite normal. </font><font style="vertical-align: inherit;">As long as there was one Hero and one weapon, there was no need to distinguish between them - all the same, there was nothing else for the hero. </font><font style="vertical-align: inherit;">And the monolithic code confirmed this fact with its text. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Swordman - it doesn't even sound so bad. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And what did the first ‚Äúnaive" edits lead to? </font><font style="vertical-align: inherit;">What did the addition of the if-chik lead to? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adding an if-chic led to ... a mutant! </font><font style="vertical-align: inherit;">Mutant, i.e. </font><font style="vertical-align: inherit;">mutable object that can mutate between a ‚Äúhuman‚Äù and ‚Äúhuman Dubin‚Äù. </font><font style="vertical-align: inherit;">At the same time, if you make a little mistake in the implementation of the mutant, then the state of ‚Äúhuman-medullin‚Äù arises. </font><font style="vertical-align: inherit;">Do not do like this! </font><font style="vertical-align: inherit;">There is no need for ‚Äúhuman Dubin‚Äù at all. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is necessary:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Man + addiction to the sword (need for a sword);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Man + addiction to a club (need for a club).</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Not every addiction is evil! </font><font style="vertical-align: inherit;">This addiction to alcohol is evil, and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">protocol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is good. </font><font style="vertical-align: inherit;">Yes, even dependence on the object is better than ‚Äúhuman Dubin‚Äù! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When did the mutation happen? </font><font style="vertical-align: inherit;">The transformation into a mutant occurred when the flag was added: the monolithic code remained monolithic, but when the flag was changed (mutated), the behavior of the same object began to change significantly. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vasily would single out two stages of mutation:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adding a flag and the very first ‚Äúif‚Äù (or ‚Äúswitch‚Äù, or other branching mechanism) to the flag. </font><font style="vertical-align: inherit;">The situation is threatening, but bearable: the hero is poured with radioactive waste, but he overcomes it.</font></font></li>
<li>     ¬´if¬ª   ,     . .    ‚Äî   . ,    -  - .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thus, in the situation considered, in order to prevent the occurrence of technical debt, it makes sense to build the architecture before passing through the first stage, in the worst case, to the second. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What exactly did Vasily do to treat a mutant? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
From a technical point of view - used injection dependency closed protocol. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
From philosophical - shared responsibility. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All the features of the work of the class, which can be interchanged with each other (which means they are alternative to each other), were removed from the Hero depending. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A new, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">alternative</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> functionality - the implementation of the work of the sword, the implementation of the work of the club - upon its appearance became different from each other and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is different</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from the rest as before</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no alternative</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hero code. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So already in the "naive" code</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> something</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> new</font><font style="vertical-align: inherit;">appeared</font><i><font style="vertical-align: inherit;"> that was</font></i><font style="vertical-align: inherit;"> different in its alternative behavior from the uncontested part of the Hero. </font><font style="vertical-align: inherit;">So in the ‚Äúnaive" code there appeared an implicit description of new</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> business entities</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : a sword and a club</font><font style="vertical-align: inherit;">, spread out according to the Hero</font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">In order to make it convenient to operate with new</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> business entities</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , it became necessary to distinguish them as separate</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> code entities</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with their own</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> names</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">So there was a division of responsibility. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS TL; DR;</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">See the flag?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Be a man, damn it! </font><font style="vertical-align: inherit;">Erase it!</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Addiction injection</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Profit! 11</font></font></li>
</ol></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en493458/index.html">Free your Android - Alaverdi</a></li>
<li><a href="../en493462/index.html">Ultrasonic bath. Part 2</a></li>
<li><a href="../en493468/index.html">Do not be afraid to breathe deeply</a></li>
<li><a href="../en493470/index.html">Scientists Find New Minor Planets Outside Neptune</a></li>
<li><a href="../en493478/index.html">Hack The Box - Walkthrough Forest. AS-REP Roasting, DCSync and Pass-The-Hash Attacks</a></li>
<li><a href="../en493482/index.html">Meet the cybernetic turtle, the predecessor of Roomba</a></li>
<li><a href="../en493484/index.html">Your C # is already ‚Äúfunctional,‚Äù just let it.</a></li>
<li><a href="../en493486/index.html">The most interesting automotive startups 2019-2020</a></li>
<li><a href="../en493488/index.html">Unity + git = friendship: part 1 gentleman's set</a></li>
<li><a href="../en493496/index.html">ReactJS. Warning: Can't perform a React state update on an unmounted component. This is a no-op, but it indicates a memo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>