<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👋🏽 ✋ 🍫 智能家居：在家庭助理中创建水电图表 👨🏻‍🔧 🖐🏿 🔁</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="我想知道每次我收到水电账单时，我的家人真的在消耗那么多钱吗？好吧，是的，浴室有加热地板和锅炉，但它们不会经常st动。我们似乎还可以节水（尽管我们也喜欢在浴室溅水）。几年前，我已经将水表和电表连接到了智能家居，但这还停留在这一点上。直到现在，人们才开始对消费进行分析，而实际上，这篇文章就是关于这一点的...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>智能家居：在家庭助理中创建水电图表</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/492314/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/wj/lf/i3/wjlfi38qar57vvhqgpwuzdalerw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我想知道每次我收到水电账单时，我的家人真的在消耗那么多钱吗？好吧，是的，浴室有加热地板和锅炉，但它们不会经常st动。我们似乎还可以节水（尽管我们也喜欢在浴室溅水）。几年前，我已经</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将水表</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">电表</font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">连接</font></a><font style="vertical-align: inherit;">到了智能家居，但这还停留在这一点上。直到现在，人们才开始对消费进行分析，而实际上，这篇文章就是关于这一点的。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我最近将Home Assistant用作智能家居系统。原因之一就是有机会组织大量数据的收集，并有可能方便地构建各种图形。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
本文中描述的信息不是新的，所有这些使用不同调味料的东西已经在Internet上进行了描述。</font><font style="vertical-align: inherit;">但是每篇文章通常只描述一个方法或一个方面。</font><font style="vertical-align: inherit;">我必须比较所有这些方法，然后自己选择最合适的方法。</font><font style="vertical-align: inherit;">本文仍未提供有关数据收集的全面信息，但这只是我的摘要。</font><font style="vertical-align: inherit;">因此，欢迎提出建设性的批评和建议。</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">问题的提法</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，今天的练习的目标是获得漂亮的水和电消耗图表：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每小时2天</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每天2周</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（可选）每周和每月</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这是我们面临的一些困难：</font></font><br>
<br>
<ul>
<li>  ,  ,  .         . <br>
<br>
  ,     ,     .  home assistant,  ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">mini-graph-card</a>,     :<br>
<br>
<ul>
<li>        (     ,         )</li>
<li>       (   ,      )</li>
</ul></li>
<li> ,  home assistant        SQLite <s>( , ,    MySQL  Postgres)</s>,        . , ,               json   <br>
<br>
<pre><code class="json hljs">{<span class="hljs-attr">"entity_id"</span>: <span class="hljs-string">"sensor.water_cold_hourly"</span>, <span class="hljs-attr">"old_state"</span>: {<span class="hljs-attr">"entity_id"</span>: <span class="hljs-string">"sensor.water_cold_hourly"</span>, <span class="hljs-attr">"state"</span>: <span class="hljs-string">"3"</span>, <span class="hljs-attr">"attributes"</span>: {<span class="hljs-attr">"source"</span>: <span class="hljs-string">"sensor.water_meter_cold"</span>, <span class="hljs-attr">"status"</span>: <span class="hljs-string">"collecting"</span>, <span class="hljs-attr">"last_period"</span>: <span class="hljs-string">"29"</span>, <span class="hljs-attr">"last_reset"</span>: <span class="hljs-string">"2020-02-23T21:00:00.022246+02:00"</span>, <span class="hljs-attr">"meter_period"</span>: <span class="hljs-string">"hourly"</span>, <span class="hljs-attr">"unit_of_measurement"</span>: <span class="hljs-string">"l"</span>, <span class="hljs-attr">"friendly_name"</span>: <span class="hljs-string">"water_cold_hourly"</span>, <span class="hljs-attr">"icon"</span>: <span class="hljs-string">"mdi:counter"</span>}, <span class="hljs-attr">"last_changed"</span>: <span class="hljs-string">"2020-02-23T19:05:06.897604+00:00"</span>, <span class="hljs-attr">"last_updated"</span>: <span class="hljs-string">"2020-02-23T19:05:06.897604+00:00"</span>, <span class="hljs-attr">"context"</span>: {<span class="hljs-attr">"id"</span>: <span class="hljs-string">"aafc8ca305ba4e49ad4c97f0eddd8893"</span>, <span class="hljs-attr">"parent_id"</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">"user_id"</span>: <span class="hljs-literal">null</span>}}, <span class="hljs-attr">"new_state"</span>: {<span class="hljs-attr">"entity_id"</span>: <span class="hljs-string">"sensor.water_cold_hourly"</span>, <span class="hljs-attr">"state"</span>: <span class="hljs-string">"4"</span>, <span class="hljs-attr">"attributes"</span>: {<span class="hljs-attr">"source"</span>: <span class="hljs-string">"sensor.water_meter_cold"</span>, <span class="hljs-attr">"status"</span>: <span class="hljs-string">"collecting"</span>, <span class="hljs-attr">"last_period"</span>: <span class="hljs-string">"29"</span>, <span class="hljs-attr">"last_reset"</span>: <span class="hljs-string">"2020-02-23T21:00:00.022246+02:00"</span>, <span class="hljs-attr">"meter_period"</span>: <span class="hljs-string">"hourly"</span>, <span class="hljs-attr">"unit_of_measurement"</span>: <span class="hljs-string">"l"</span>, <span class="hljs-attr">"friendly_name"</span>: <span class="hljs-string">"water_cold_hourly"</span>, <span class="hljs-attr">"icon"</span>: <span class="hljs-string">"mdi:counter"</span>}, <span class="hljs-attr">"last_changed"</span>: <span class="hljs-string">"2020-02-23T19:11:11.251545+00:00"</span>, <span class="hljs-attr">"last_updated"</span>: <span class="hljs-string">"2020-02-23T19:11:11.251545+00:00"</span>, <span class="hljs-attr">"context"</span>: {<span class="hljs-attr">"id"</span>: <span class="hljs-string">"0de64b8af6f14bb9a419dcf3b200ef56"</span>, <span class="hljs-attr">"parent_id"</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">"user_id"</span>: <span class="hljs-literal">null</span>}}}</code></pre><br>
     (    ,    ),         .      SDM220      10-15 ,         8.      ,      . ..         100-200  .      ,      (    home assistant  raspberry PI),            .</li>
<li>  ,      .           <s> </s>   .           (RS232/RS485/Modbus/Zigbee)   .<br>
<br>
         (    ),      X -  .            .         ,        . , ,        home assistant,          ,             (  home assistant).</li>
</ul><br>
<h2> 1</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
首先，让我们看看现成的家庭助手。衡量一段时间内的消耗是一项非常需要的功能。当然，它是很久以前以专用组件（utility_meter）的形式实现的。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该组件的本质是它在内部启动变量current_accumulated_value并在指定的时间段（小时/周/月）后将其重置。组件本身监视传入的变量（某种传感器的值），订阅值本身的更改-您仅获得最终结果。在配置文件的仅几行中描述了该内容。</font></font><br>
<br>
<pre><code class="python hljs">utility_meter:<font></font>
  water_cold_hour_um:<font></font>
    source: sensor.water_meter_cold<font></font>
    cycle: hourly<font></font>
  water_cold_day_um:<font></font>
    source: sensor.water_meter_cold<font></font>
    cycle: daily<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这里sensor.water_meter_cold是计数器的当前值（以升为单位），我可以</font><font style="vertical-align: inherit;">通过mqtt </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">直接从一块铁中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">获得。该设计创建了两个新的传感器water_cold_hour_um和water_cold_day_um，它们累积每小时和每天的读数，并在一段时间后将其重置。这是一个半小时的电池图表。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/le/u3/fk/leu3fkbgddojjis_lmcawt6gcv4.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lovelace-UI的每小时和每天的图表代码如下所示：</font></font><br>
<br>
<pre><code class="python hljs">      - type: history-graph<font></font>
        title: <span class="hljs-string">'Hourly water consumption using vars'</span>
        hours_to_show: <span class="hljs-number">48</span><font></font>
        entities:<font></font>
          - sensor.water_hour<font></font>
<font></font>
      - type: history-graph<font></font>
        title: <span class="hljs-string">'Daily water consumption using vars'</span>
        hours_to_show: <span class="hljs-number">360</span><font></font>
        entities:<font></font>
          - sensor.water_day<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
实际上，这种方法的问题在于该算法。如前所述，对于每个输入值（当前每升读数），数据库中都会生成1kb的记录。每个公用事业仪表还生成一个新值，该新值也累加到数据库中。如果我想收集每小时/每天/每周/每月的读数，并为几个上升管，再加上一堆电表，这将是很多数据。好吧，更确切地说，没有太多数据，但是由于家庭助理会向数据库中写入大量不必要的信息，因此数据库的大小将突飞猛进。恐怕甚至无法估计每周和每月图表的基础规模。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
另外，仅电表不能解决该任务。</font><font style="vertical-align: inherit;">电度表给出的值图是一个单调递增的函数，每小时重置为0。</font><font style="vertical-align: inherit;">我们需要一个用户友好的消耗量图表，其间该时期吃了多少公升。</font><font style="vertical-align: inherit;">标准的历史记录图形组件不知道如何执行此操作，但是外部迷你图形卡组件可以为我们提供帮助。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这是lovelace-UI的卡代码：</font></font><br>
<br>
<pre><code class="python hljs">      - aggregate_func: max<font></font>
        entities:<font></font>
          - color: var(--primary-color)<font></font>
            entity: sensor.water_cold_hour_um<font></font>
        group_by: hour<font></font>
        hours_to_show: <span class="hljs-number">48</span>
        name: <span class="hljs-string">"Hourly water consumption aggregated by utility meter"</span>
        points_per_hour: <span class="hljs-number">1</span><font></font>
        show:<font></font>
          graph: bar<font></font>
        type: <span class="hljs-string">'custom:mini-graph-card'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
除了传感器名称，图形类型，颜色（我不喜欢标准橙色）之类的标准设置外，还要注意以下3个设置：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">group_by：小时-将在小时开始时将列对齐的方式生成图表</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">points_per_hour：每小时1个酒吧</font></font></li>
<li>  , aggregate_func: max —       .         </li>
</ul><br>
<img src="https://habrastorage.org/webt/yj/du/c7/yjduc7nhxnq18qvcityd_ul91y0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不要注意左侧的许多列-如果没有数据，这是组件的标准行为。而且没有数据-就在本文中，我只是在几个小时前才打开公用仪表数据收集（稍后再告诉您我当前的方法）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这张照片中，我想表明有时数据显示甚至可以正常工作，并且条形图确实反映了正确的值。但这还不是全部。出于某种原因，从上午11点到12点间隔的选定列出于某种原因显示了19升，尽管在同期的暴牙图表上，我们发现同一传感器的消耗量为62升。虫子或手歪了。但是我不明白为什么右边的数据会中断-那里的消耗是正常的，这在暴牙的时间表上也可以看到。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常，我没有设法获得这种方法的可信度-图形几乎总是显示出某种异端。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
相同的日期传感器代码。</font></font><br>
<br>
<pre><code class="python hljs">      - aggregate_func: max<font></font>
        entities:<font></font>
          - color: var(--primary-color)<font></font>
            entity: sensor.water_cold_day_um<font></font>
        group_by: interval<font></font>
        hours_to_show: <span class="hljs-number">360</span>
        name: <span class="hljs-string">"Daily water consumption aggregated by utility meter"</span>
        points_per_hour: <span class="hljs-number">0.0416666666</span><font></font>
        show:<font></font>
          graph: bar<font></font>
        type: <span class="hljs-string">'custom:mini-graph-card'</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
请注意，group_by参数设置为interval，而points_per_hour参数控制一切。</font><font style="vertical-align: inherit;">这是该组件的另一个问题-points_per_hour在一个小时或更短的时间内就可以很好地在图表上工作，但是在很大的间隔内令人讨厌。</font><font style="vertical-align: inherit;">因此，要在一天内获得一列，我必须输入值1/24 = 0.04166666。</font><font style="vertical-align: inherit;">我不是在谈论每周和每月图表。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法2</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
只是弄清楚了家庭助理，我在这里看到了这个视频：</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/-0HrYFCRH0M" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一个朋友从几种类型的小米商店收集消费数据。他的任务要简单一些-仅显示今天，昨天和一个月的消费价值。不需要时间表。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们撇开关于瞬时功率值的手动积分的讨论-我已经写了这种方法的``准确性''。目前尚不清楚他为什么不使用已由同一商店收集的累计消耗值。我认为，整合到铁片中会更好。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从视频中我们想到了手动计算该期间的消费的想法。农民只计算今天和昨天的价值，但我们会走得更远并尝试绘制图表。在我的情况下，所提出的方法的实质如下。</font></font><br>
<br>
<ul>
<li>  ___,      </li>
<li>     (   )          .         —    ,         . </li>
<li>  “”  ___     .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
所有这些都可以</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">家庭助理本人来完成。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您将不得不编写比先前方法更多的代码。</font><font style="vertical-align: inherit;">首先，让我们获取这些非常“变量”。</font><font style="vertical-align: inherit;">开箱即用，我们没有“变量”实体，但是您可以使用mqtt经纪人的服务。</font><font style="vertical-align: inherit;">我们将在那里发送带有retain = true标志的值-这将把值保存在经纪人内部，您甚至可以在家庭助理重启时随时将其取出。</font><font style="vertical-align: inherit;">我马上进行了小时和小时计数器。</font></font><br>
<br>
<pre><code class="python hljs">- platform: mqtt<font></font>
  state_topic: <span class="hljs-string">"test/water/hour"</span><font></font>
  name: water_hour<font></font>
  unit_of_measurement: l<font></font>
<font></font>
- platform: mqtt<font></font>
  state_topic: <span class="hljs-string">"test/water/hour_begin"</span><font></font>
  name: water_hour_begin<font></font>
  unit_of_measurement: l<font></font>
<font></font>
- platform: mqtt<font></font>
  state_topic: <span class="hljs-string">"test/water/day"</span><font></font>
  name: water_day<font></font>
  unit_of_measurement: l<font></font>
<font></font>
- platform: mqtt<font></font>
  state_topic: <span class="hljs-string">"test/water/day_begin"</span><font></font>
  name: water_day_begin<font></font>
  unit_of_measurement: l</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一切魔术都发生在自动化中，自动化分别在每小时和每个晚上运行。</font></font><br>
<br>
<pre><code class="python hljs">- id: water_new_hour<font></font>
  alias: water_new_hour<font></font>
  initial_state: true<font></font>
  trigger:<font></font>
    - platform: time_pattern<font></font>
      minutes: <span class="hljs-number">0</span><font></font>
  action:<font></font>
    - service: mqtt.publish<font></font>
      data:<font></font>
        topic: <span class="hljs-string">"test/water/hour"</span><font></font>
        payload_template: &gt;<font></font>
          {{ (states.sensor.water_meter_cold.state|int) - (states.sensor.water_hour_begin.state|int) }}<font></font>
        retain: true<font></font>
    - service: mqtt.publish<font></font>
      data:<font></font>
        topic: <span class="hljs-string">"test/water/hour_begin"</span><font></font>
        payload_template: &gt;<font></font>
          {{ states.sensor.water_meter_cold.state }}<font></font>
        retain: true<font></font>
<font></font>
- id: water_new_day<font></font>
  alias: water_new_day<font></font>
  initial_state: true<font></font>
  trigger:<font></font>
    - platform: time<font></font>
      at: <span class="hljs-string">"00:00:00"</span><font></font>
  action:<font></font>
    - service: mqtt.publish<font></font>
      data:<font></font>
        topic: <span class="hljs-string">"test/water/day"</span><font></font>
        payload_template: &gt;<font></font>
          {{ (states.sensor.water_meter_cold.state|int) - (states.sensor.water_day_begin.state|int) }}<font></font>
        retain: true<font></font>
    - service: mqtt.publish<font></font>
      data:<font></font>
        topic: <span class="hljs-string">"test/water/day_begin"</span><font></font>
        payload_template: &gt;<font></font>
          {{ states.sensor.water_meter_cold.state }}<font></font>
        retain: true</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
两种自动化都执行2个动作：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">间隔的值计算为开始值和结束值之间的差</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新下一个间隔的基值</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这种情况下，可以通过通常的历史图表来解决该图形：</font></font><br>
<br>
<pre><code class="python hljs">      - type: history-graph<font></font>
        title: <span class="hljs-string">'Hourly water consumption using vars'</span>
        hours_to_show: <span class="hljs-number">48</span><font></font>
        entities:<font></font>
          - sensor.water_hour<font></font>
<font></font>
      - type: history-graph<font></font>
        title: <span class="hljs-string">'Daily water consumption using vars'</span>
        hours_to_show: <span class="hljs-number">360</span><font></font>
        entities:<font></font>
          - sensor.water_day</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
看起来像这样：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rp/nn/ah/rpnnahsspezbcydtjmhlu6kb53w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
原则上，这已经是您所需要的。</font><font style="vertical-align: inherit;">此方法的优点是每个间隔一次生成一次数据。</font><font style="vertical-align: inherit;">那些。</font><font style="vertical-align: inherit;">每小时图表每天只有24个条目。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不幸的是，这仍然不能解决不断增长的基础的普遍问题。</font><font style="vertical-align: inherit;">如果我需要每月的消费计划，则必须存储至少一年的数据。</font><font style="vertical-align: inherit;">而且由于家庭助理仅提供一个设置来存储整个数据库的持续时间，因此这意味着系统中的所有数据都必须存储整整一年。</font><font style="vertical-align: inherit;">例如，一年我消耗200立方米的水，这意味着数据库中有200,000条记录。</font><font style="vertical-align: inherit;">而且，如果考虑其他传感器，该数字将完全变得不雅。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法3</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
幸运的是，聪明人已经通过编写InfluxDB数据库解决了这个问题。该数据库经过专门优化，用于存储基于时间的数据，是存储不同传感器的值的理想选择。该系统还提供了一种类似于SQL的查询语言，使您可以从数据库中选择值，然后以各种方式对其进行汇总。最后，可以在不同的时间存储不同的数据。例如，频繁变化的读数（例如温度或湿度）只能存储几周，而每天的用水量读数则可以存储一年。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
除了InfluxDB，聪明人还发明了Grafana，这是一个基于InfluxDB数据的图表系统。</font><font style="vertical-align: inherit;">Grafana可以绘制不同类型的图，对其进行详细自定义，最重要的是，这些图可以“粘在” lovelace-UI家庭助理上。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">在这里</font></a><font style="vertical-align: inherit;">和</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">这里</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
获取灵感</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">文章详细介绍了将InfluxDB和Grafana安装和连接到家庭助理的过程。</font><font style="vertical-align: inherit;">我将专注于解决我的特定问题。</font><font style="vertical-align: inherit;">
因此，首先，让我们开始在influxDB中添加计数器值。</font><font style="vertical-align: inherit;">一个家庭助理配置的一部分（在此示例中，我不仅可以享受冷水乐趣，还可以享受热水的乐趣）：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">influxdb:<font></font>
  host: localhost<font></font>
  max_retries: <span class="hljs-number">3</span><font></font>
  default_measurement: state<font></font>
  database: homeassistant<font></font>
  include:<font></font>
    entities:<font></font>
      - sensor.water_meter_hot<font></font>
      - sensor.water_meter_cold</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
关闭将相同数据保存到家庭助理的内部数据库的操作，以免再次膨胀它：</font></font><br>
<br>
<pre><code class="python hljs">recorder:<font></font>
  purge_keep_days: <span class="hljs-number">10</span>
  purge_interval: <span class="hljs-number">1</span><font></font>
  exclude:<font></font>
    entities:<font></font>
      - sensor.water_meter_hot<font></font>
      - sensor.water_meter_cold</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，我们进入InfluxDB控制台并设置数据库。特别是，您需要配置此数据或该数据将存储多长时间。这是由所谓的保留策略-这类似于主数据库内部的数据库，每个内部数据库都有其自己的设置。默认情况下，所有数据都存储在名为autogen的保留策略中，该数据将存储一周。我希望每小时的数据可以存储一个月，每周的数据可以存储一年，而每月的数据绝对不能删除。创建适当的保留政策</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">RETENTION</span> <span class="hljs-keyword">POLICY</span> <span class="hljs-string">"month"</span> <span class="hljs-keyword">ON</span> <span class="hljs-string">"homeassistant"</span> <span class="hljs-keyword">DURATION</span> <span class="hljs-number">30</span>d <span class="hljs-keyword">REPLICATION</span> <span class="hljs-number">1</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">RETENTION</span> <span class="hljs-keyword">POLICY</span> <span class="hljs-string">"year"</span> <span class="hljs-keyword">ON</span> <span class="hljs-string">"homeassistant"</span> <span class="hljs-keyword">DURATION</span> <span class="hljs-number">52</span>w <span class="hljs-keyword">REPLICATION</span> <span class="hljs-number">1</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">RETENTION</span> <span class="hljs-keyword">POLICY</span> <span class="hljs-string">"infinite"</span> <span class="hljs-keyword">ON</span> <span class="hljs-string">"homeassistant"</span> <span class="hljs-keyword">DURATION</span> INF <span class="hljs-keyword">REPLICATION</span> <span class="hljs-number">1</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，实际上，主要技巧是使用连续查询进行数据聚合。</font><font style="vertical-align: inherit;">这是一种自动以指​​定的时间间隔启动查询，汇总此查询的数据并将结果添加到新值的机制。</font><font style="vertical-align: inherit;">让我们看一个示例（出于可读性考虑，我写在一栏中，但实际上我必须在一行中输入此命令）</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> CONTINUOUS <span class="hljs-keyword">QUERY</span> cq_water_hourly <span class="hljs-keyword">ON</span> homeassistant 
<span class="hljs-keyword">BEGIN</span> 
  <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">max</span>(<span class="hljs-keyword">value</span>) <span class="hljs-keyword">AS</span> <span class="hljs-keyword">value</span> 
  <span class="hljs-keyword">INTO</span> homeassistant.month.water_meter_hour 
  <span class="hljs-keyword">FROM</span> homeassistant.autogen.l 
  <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">time</span>(<span class="hljs-number">1</span>h), entity_id fill(previous) 
<span class="hljs-keyword">END</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该命令：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在homeassantant数据库中创建一个名为cq_water_cold_hourly的连续查询</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该请求将每小时执行一次（时间（1h））</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该请求将从测量结果中获取所有数据“ a homeassistant.autogen.l（升）”，包括冷热水的读数</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">汇总的数据将按entity_id分组，这将为冷水和热水创建单独的值。</font></font></li>
<li>               ,      max(value) </li>
<li>     homeassistant.month.water_meter_hour,  month   retention policy     .               entity_id     value</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在晚上或没有人在家时，没有水消耗，因此在homeassistant.autogen.l中也没有新条目。为了避免在常规查询中遗漏值，您可以使用fill（上一个）。这将迫使InfluxDB使用过去的小时值。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不幸的是，连续查询有一个特殊性：填充（上一个）技巧不起作用，并且根本不会创建记录。而且，这是已经</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">讨论了一年多的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一些不可克服的问题</font><font style="vertical-align: inherit;">。稍后我们将处理此问题，并在连续查询中填充（上一个）为-它不会干扰。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们检查发生了什么（当然，您需要等待几个小时）：</font></font><br>
<br>
<pre><code class="python hljs">&gt; select * <span class="hljs-keyword">from</span> homeassistant.month.water_meter_hour group by entity_id<font></font>
...<font></font>
name: water_meter_hour<font></font>
tags: entity_id=water_meter_cold<font></font>
time                 value<font></font>
----                 -----<font></font>
...<font></font>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T01:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">370511</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T02:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">370513</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T05:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">370527</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T06:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">370605</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T07:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">370635</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T08:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">370699</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T09:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">370761</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T10:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">370767</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T11:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">370810</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T12:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">370818</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T13:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">370827</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T14:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">370849</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T15:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">370921</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
请注意，数据库中的值存储在UTC中，因此在此列表中它们相差3小时-InfluxDB输出中上午7点的值对应于上图中上午10点的值。</font><font style="vertical-align: inherit;">另外请注意，早上2点到5点之间根本没有记录-这与连续查询的功能相同。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如您所见，聚合值也是一个单调递增的序列，只有记录的频率较低-每小时一次。</font><font style="vertical-align: inherit;">但这不是问题-我们可以编写另一个查询，该查询将为图表生成正确的数据。</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">difference</span>(<span class="hljs-keyword">max</span>(<span class="hljs-keyword">value</span>)) 
<span class="hljs-keyword">FROM</span> homeassistant.month.water_meter_hour 
<span class="hljs-keyword">WHERE</span> entity_id=<span class="hljs-string">'water_meter_cold'</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">time</span> &gt;= <span class="hljs-keyword">now</span>() <span class="hljs-number">-24</span>h 
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">time</span>(<span class="hljs-number">1</span>h), entity_id <font></font>
fill(previous)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我将解密：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从homeassistant.month.water_meter_hour数据库中，我们提取最后一天的实体_id ='water_meter_cold'的数据（时间&gt; =现在（）-24h）。 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正如我在序列homeassistant.month.water_meter_hour中提到的那样，某些条目可能会丢失。</font><font style="vertical-align: inherit;">我们将通过使用GROUP BY time（1h）运行查询来重新生成此数据。</font><font style="vertical-align: inherit;">此时间填充（上一个）将根据需要工作，生成丢失的数据（该函数将使用上一个值）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此请求中最重要的是差异函数，它将计算每小时标记之间的差异。</font><font style="vertical-align: inherit;">就其本身而言，它不起作用，并且需要聚合函数。</font><font style="vertical-align: inherit;">使其成为之前使用的max（）。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
执行的结果看起来像这样</font></font><br>
<br>
<pre><code class="python hljs">name: water_meter_hour<font></font>
tags: entity_id=water_meter_cold<font></font>
time                 difference<font></font>
----                 ----------<font></font>
...<font></font>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T02:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">2</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T03:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">0</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T04:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">0</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T05:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">14</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T06:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">78</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T07:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">30</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T08:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">64</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T09:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">62</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T10:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">6</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T11:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">43</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T12:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">8</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T13:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">9</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T14:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">22</span>
<span class="hljs-number">2020</span><span class="hljs-number">-03</span><span class="hljs-number">-08</span>T15:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>Z <span class="hljs-number">72</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从凌晨2点到5点（UTC）没有消费。</font><font style="vertical-align: inherit;">不过，由于填充（上一个查询），查询将返回相同的消耗值，并且差值函数将从其自身中减去该值，并在输出处获得0，这实际上是必需的。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
剩下的唯一事情就是建立时间表。</font><font style="vertical-align: inherit;">为此，打开Grafana，打开一些现有的（或创建一个新的）仪表板，创建一个新的面板。</font><font style="vertical-align: inherit;">图表设置将如下所示。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ux/q0/c8/uxq0c834j1eq4h7ey4qazk4cc7q.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我将在一张图表上显示冷热水数据。</font><font style="vertical-align: inherit;">该请求与我上面描述的完全相同。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
显示参数设置如下。</font><font style="vertical-align: inherit;">我将有一个带线的图形，该图形会经过楼梯。</font><font style="vertical-align: inherit;">我将在下面解释Stack参数。</font><font style="vertical-align: inherit;">下面还有几个显示选项，但它们并不是那么有趣。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bi/rd/5x/bird5xpaysckqtigczjerbp5mti.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要将收到的时间表添加到家庭助理，您需要：</font></font><br>
<br>
<ul>
<li>    . -         </li>
<li>     ,    share</li>
<li>      embed</li>
<li>  current time range —       URL </li>
<li>  .     light</li>
<li>  URL    lovelace-UI</li>
</ul><br>
<pre><code class="python hljs">      - type: iframe<font></font>
        id: graf_water_hourly<font></font>
        url: <span class="hljs-string">"http://192.168.10.200:3000/d-solo/rZARemQWk/water?orgId=1&amp;panelId=2&amp;from=now-2d&amp;to=now&amp;theme=light"</span>
</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
请注意，时间范围（最近2天）是在此处设置的，而不是在仪表板设置中设置的。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该图看起来像这样。最近两天我没有使用过热水，因此只绘制了一张冷水图。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ms/e7/hk/mse7hkckiwjjm_b5ppli9dakd2c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我没有为自己决定最喜欢的时间表，阶梯线或真实杠铃。因此，我将仅以列为单位简单地给出每日消费图表的示例。以与上述相同的方式构建请求。显示参数如下：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ns/se/jt/nssejtoburugxcldedjuj0cvywm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该图</font><font style="vertical-align: inherit;">如下所示：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zd/yl/hj/zdylhjfnrdonlnkezr3n4dlwdwm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
关于Stack参数。在此图中，一列冷水绘制在一列热水的顶部。总高度对应于该时期内冷热水的总消耗量。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
显示的所有图形都是动态的。您可以将鼠标悬停在一个兴趣点上，并查看特定点的详细信息和价值。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不幸的是，两汤匙的焦油不能做到。在条形图上（与带有阶梯线的图相反），条形图的中间不是在一天中，而是在00:00。那些。该列的左半部分代替前一天绘制。因此，周六和周日的图表比蓝色区域稍微靠左绘制。直到我弄清楚如何赢得比赛。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
另一个问题是无法按月间隔正确工作。</font><font style="vertical-align: inherit;">事实是小时/天/周的时长是固定的，但是月份的时长每次都不同。</font><font style="vertical-align: inherit;">InfluxDB只能定期运行。</font><font style="vertical-align: inherit;">到目前为止，我的大脑足以设置30天的固定间隔。</font><font style="vertical-align: inherit;">是的，图表在一年中会浮动一点，并且各列将与月份不完全对应。</font><font style="vertical-align: inherit;">但是由于这东西只是作为显示设备对我来说很有趣，所以我可以接受。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我看到至少两个解决方案：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">按月时间表评分，并限制为每周。</font><font style="vertical-align: inherit;">一年中有52个每周酒吧看起来不错</font></font></li>
<li>     №2,       .     .          —    .</li>
</ul><br>
<br>
<h2></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我不知道为什么，但是我正在研究这类图表。他们表明生活如火如荼，一切都在变化。昨天很多，今天还不够，明天还会有其他事情。它仍然需要与家庭合作解决消费问题。但是即使有目前的胃口，付款中只有一个庞大而难以理解的数字已经变成了相当清晰的消费情况。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
尽管有近20年的程序员职业生涯，但我实际上并未与数据库相交。因此，外部数据库的安装似乎非常深刻且难以理解。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前面提到的文章</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改变了一切</font><font style="vertical-align: inherit;">-事实证明，只需单击几下即可拧紧合适的工具，而使用专门的工具，制图的任务将变得更加容易。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在标题中，我提到了用电量。</font><font style="vertical-align: inherit;">不幸的是，目前我无法提供任何图表。</font><font style="vertical-align: inherit;">通过Modbus访问时，一个SDM120计数器已失效，而另一个则存在故障。</font><font style="vertical-align: inherit;">但是，这不会影响本文的主题-图形的构建方式与水相同。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在本文中，我列举了自己尝试的方法。</font><font style="vertical-align: inherit;">当然，还有其他一些我不知道的组织数据收集和可视化的方法。</font><font style="vertical-align: inherit;">在评论中告诉我，这对我来说非常有趣。</font><font style="vertical-align: inherit;">我将为建设性的批评和新想法感到高兴。</font><font style="vertical-align: inherit;">我希望介绍的材料也能对某人有所帮助。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN492298/index.html">多边形另一个世界：IBM PC</a></li>
<li><a href="../zh-CN492302/index.html">用于测试人员的带有智能手机的智能支架-ITMO大学加速器的启动项目</a></li>
<li><a href="../zh-CN492306/index.html">CES上的激光雷达</a></li>
<li><a href="../zh-CN492308/index.html">神经元及其建模</a></li>
<li><a href="../zh-CN492312/index.html">卡夫卡的Avro序列化</a></li>
<li><a href="../zh-CN492318/index.html">冠状病毒如何影响IT行业</a></li>
<li><a href="../zh-CN492320/index.html">Covid-19，您和您的社会在数据科学方面</a></li>
<li><a href="../zh-CN492322/index.html">Raspberry Pi + Fedora（aarch64）= Wi-Fi热点（或戴着蓝帽子的树莓路由器）</a></li>
<li><a href="../zh-CN492324/index.html">我们将讨论EARN IT Act-美国的一项新法案，可能会导致禁止E2E加密</a></li>
<li><a href="../zh-CN492326/index.html">分析2020年欧洲电视网参与者的YouTube视频的受欢迎程度</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>