<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üàπ üöñ üìº Qu'est-ce que Windows PowerShell et que mange-t-il? Partie 3: passer des param√®tres aux scripts et aux fonctions, cr√©er des applets de commande üéÖüèø üßóüèª üé•</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La deuxi√®me partie de la s√©rie a couvert les bases du langage de programmation PowerShell, mais maintenant il vaut la peine de comprendre comment util...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Qu'est-ce que Windows PowerShell et que mange-t-il? Partie 3: passer des param√®tres aux scripts et aux fonctions, cr√©er des applets de commande</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/493366/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/-b/i_/73/-bi_73lwdxmnzvtveeghrwvtqay.png"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deuxi√®me partie de la s√©rie a</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> couvert les bases du langage de programmation PowerShell, mais maintenant il vaut la peine de comprendre comment utiliser le code √©crit dessus pour des t√¢ches administratives. </font><font style="vertical-align: inherit;">La fa√ßon la plus √©vidente de le faire est d'ex√©cuter le script. </font><font style="vertical-align: inherit;">En plus de cela, il est possible de cr√©er vos propres applets de commande.</font></font><a name="habracut"></a><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Table des mati√®res:</font></font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Param√®tres positionnels </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bloc Param () </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attributs de param√®tres suppl√©mentaires </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Passage de param√®tres via le pipeline </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Structure du corps de la fonction </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attribut [CmdletBinding ()] et fonctions avanc√©es </font></font></a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scripting modules et cr√©ation d'applets de commande</font></font></a><br>
<br>
<a name="section1"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Param√®tres positionnels</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les scripts et les </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fonctions,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vous pouvez passer des param√®tres positionnels (arguments) dont les valeurs sont √©crites dans la variable int√©gr√©e $ args. </font><font style="vertical-align: inherit;">Ce </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tableau</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> unidimensionnel </font><font style="vertical-align: inherit;">ne n√©cessite pas de d√©claration pr√©alable et sa port√©e est limit√©e √† un script ou une fonction. </font><font style="vertical-align: inherit;">Par exemple, ex√©cutez le script le plus simple:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">" :"</span> <span class="hljs-variable">$args</span>.count
<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">":"</span> <span class="hljs-variable">$args</span></code></pre><br>
<br>
<img src="https://habrastorage.org/webt/pv/ba/n8/pvban8oufym9ppbwb0jkgp_rwfq.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les fonctions, les param√®tres positionnels sont utilis√©s de la m√™me mani√®re:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Print-Args</span></span> {
    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">" :"</span> <span class="hljs-variable">$args</span>.count
    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">" 0:"</span> <span class="hljs-variable">$args</span>[<span class="hljs-number">0</span>]
    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">" 1:"</span> <span class="hljs-variable">$args</span>[<span class="hljs-number">1</span>] <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Print-Args "Zero" "One" </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veuillez noter que lorsque vous appelez Print-Args, nous ne mettons pas de virgule entre les param√®tres: ce n'est pas un tableau qui est transmis √† la fonction, mais des valeurs individuelles qui sont √©crites dans le tableau unidimensionnel $ args - sa port√©e est limit√©e par le corps de la fonction. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tf/ur/o7/tfuro78h2bg7vhs405ymxd7ks-o.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La m√©thode d√©crite ci-dessus vous permet de passer n'importe quel nombre de param√®tres √† un script ou une fonction, mais lors de l'appel, vous devez suivre l'ordre de leur s√©quence, et vous ne pouvez y acc√©der que par l'index du tableau - ce n'est pas toujours pratique.</font></font><br>
<br>
<a name="section2"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bloc de param√®tres ()</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les scripts et les fonctions, il est beaucoup plus pratique d'utiliser des param√®tres nomm√©s. </font><font style="vertical-align: inherit;">Dans un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article pr√©c√©dent,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous avons parl√© d'une fa√ßon de les d√©crire:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span> <span class="hljs-params">(<span class="hljs-variable">$arg0</span>, ..., <span class="hljs-variable">$argN</span>)</span></span><font></font>
{<font></font>
       <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une syntaxe similaire est famili√®re aux d√©veloppeurs, mais lorsqu'une fonction est appel√©e, les param√®tres (le cas √©ch√©ant) sont s√©par√©s par des espaces et ne sont pas plac√©s entre parenth√®ses - une certaine dissonance appara√Æt. C'est la sp√©cificit√© des langages shell: pour travailler avec le shell en mode interactif, les espaces entre les valeurs sont beaucoup plus pratiques. L' </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">appel test ($ value0) est</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √©galement correct, mais le param√®tre dans ce cas est l'expression enti√®re entre parenth√®ses, c'est-√†-dire </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">($ value0)</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> au lieu de </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ value0</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Passer de cette mani√®re plusieurs param√®tres ne fonctionnera pas. √Ä la suite de l'appel de </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">test ($ value0, $ value1), la</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fonction n'en recevra qu'un - un tableau de deux √©l√©ments avec les valeurs </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ value0</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ value1</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Microsoft Corporation recommande d'utiliser le bloc Param () - cette syntaxe est plus universelle et vous permet de sp√©cifier non seulement des arguments de fonction, mais √©galement des param√®tres de script:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span> (
    <span class="hljs-variable">$arg0</span>, <span class="hljs-variable">$arg1</span><font></font>
)<font></font>
<font></font>
<span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$arg0</span> <span class="hljs-variable">$arg1</span></code></pre><br>
<br>
<img src="https://habrastorage.org/webt/3o/yl/zy/3oylzy5_ukl893oyfcu54fejeaq.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le corps de la fonction, cela ressemble √† ceci:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span></span> {
     <span class="hljs-keyword">param</span> (
           <span class="hljs-variable">$arg0</span>, <span class="hljs-variable">$arg1</span><font></font>
     )<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si la liste d'arguments de la fonction est petite, le bloc Param () ne fera qu'encombrer la conception, mais dans de nombreux cas, il rend le code plus lisible et est, entre autres, un √©l√©ment d'un bon style de programmation.</font></font><br>
<br>
<a name="section3"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attributs de param√®tres suppl√©mentaires</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la description des arguments de fonction ou des param√®tres de script, leurs attributs suppl√©mentaires peuvent √™tre d√©finis. </font><font style="vertical-align: inherit;">L'exemple le plus simple est une installation forc√©e du type:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>([<span class="hljs-built_in">int</span>]<span class="hljs-variable">$arg0</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ou</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span> <span class="hljs-params">([int]<span class="hljs-variable">$arg0</span>)</span></span> {<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus de la conversion de type, vous pouvez utiliser l'attribut [parameter ()]:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Argument1</span>=<span class="hljs-type">value1</span>, <span class="hljs-type">Argument2</span>=<span class="hljs-type">value2</span>)]
    <span class="hljs-variable">$ParameterName</span>
)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec son aide, il est facile de rendre le param√®tre obligatoire. </font><font style="vertical-align: inherit;">Faites attention √† l'utilisation simultan√©e de plusieurs attributs - dans ce cas, ils se succ√®dent:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>([<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)][<span class="hljs-built_in">int</span>]<span class="hljs-variable">$arg0</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ou</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span> <span class="hljs-params">([parameter(Mandatory=<span class="hljs-variable">$true</span>)</span>][<span class="hljs-title">int</span>]$<span class="hljs-title">arg0</span>)</span> { <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ou</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span></span> {
          <span class="hljs-keyword">parameter</span>([<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)][<span class="hljs-built_in">int</span>]<span class="hljs-variable">$arg0</span>)<font></font>
}</code></pre><br>
<br>
<img src="https://habrastorage.org/webt/km/2j/7a/km2j7agackddylgawcafzzho-fq.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La position permet de sp√©cifier l'ordre du param√®tre (par d√©faut, il correspond √† l'ordre de la d√©claration):</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
                    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>, <span class="hljs-type">Position</span>=<span class="hljs-number">0</span>)]<font></font>
                    [<span class="hljs-built_in">int</span>]
                    <span class="hljs-variable">$arg0</span>,<font></font>
<font></font>
                    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Position</span>=<span class="hljs-number">1</span>)]<font></font>
                    [<span class="hljs-built_in">string</span>]
                    <span class="hljs-variable">$arg1</span>,<font></font>
<font></font>
                    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Position</span>=<span class="hljs-number">2</span>)]<font></font>
                    [<span class="hljs-built_in">array</span>]
                    <span class="hljs-variable">$arg2</span>
)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'attribut [Parameter ()] contient d'autres arguments, dont une liste compl√®te est disponible </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sur le site Web de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Microsoft. </font><font style="vertical-align: inherit;">D'autres attributs y sont d√©crits, √† l'aide desquels vous pouvez valider les valeurs transmises, les v√©rifier √† l'aide d'expressions r√©guli√®res, etc. </font><font style="vertical-align: inherit;">En voici quelques-uns: </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[Alias ‚Äã‚Äã()]</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d√©finit un alias pour le param√®tre:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-type">alias</span>(<span class="hljs-string">"ARG"</span>,<span class="hljs-string">"ArgumentName"</span>)]<font></font>
    [<span class="hljs-built_in">string</span>[]]
    <span class="hljs-variable">$arg0</span>
)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'op√©rateur de conversion [cha√Æne []] signifie que la valeur du param√®tre est un tableau de cha√Ænes. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[AllowNull ()]</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> autorise $ null comme param√®tre obligatoire:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-type">AllowNull</span>()]<font></font>
    [<span class="hljs-built_in">string</span>]
    <span class="hljs-variable">$arg0</span>
)</code></pre><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[AllowEmptyString ()]</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> autorise une cha√Æne vide comme param√®tre requis:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-type">AllowEmptyString</span>()]<font></font>
    [<span class="hljs-built_in">string</span>]
    <span class="hljs-variable">$arg0</span>
)</code></pre><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[AllowEmptyCollection ()]</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> autorise un tableau vide comme param√®tre requis:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-type">AllowEmptyCollection</span>()]<font></font>
    [<span class="hljs-built_in">string</span>[]]
    <span class="hljs-variable">$arg0</span>
)</code></pre><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Validation de [ValidatePattern ()] √† l'</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aide d'une expression r√©guli√®re:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-type">ValidatePattern</span>(<span class="hljs-string">"[0-9][0-9][0-9][0-9]"</span>)]<font></font>
    [<span class="hljs-built_in">string</span>[]]
    <span class="hljs-variable">$arg0</span>
)</code></pre><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ValidateLength ()]</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> v√©rifie la longueur d'un param√®tre de cha√Æne:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-type">ValidateLength</span>(<span class="hljs-number">1</span>,<span class="hljs-number">10</span>)]<font></font>
    [<span class="hljs-built_in">string</span>]
    <span class="hljs-variable">$arg0</span>
)</code></pre><br>
<a name="section4"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Passer des param√®tres dans le pipeline</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">premier article de la</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> s√©rie, nous avons parl√© de la possibilit√© de transf√©rer des donn√©es vers des applets de commande via un pipeline. </font><font style="vertical-align: inherit;">Dans PowerShell, les applets de commande et les fonctions renvoient des objets ou des tableaux d'objets (r√©sultats des instructions) et les re√ßoivent √©galement en entr√©e. </font><font style="vertical-align: inherit;">Pour voir cela, nous pr√©parons l'une des applets de commande √† l'aide de Get-Help:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Help</span> <span class="hljs-built_in">Stop-Process</span> <span class="hljs-literal">-Parameter</span> Name</code></pre><br>
<br>
<img src="https://habrastorage.org/webt/ci/fg/4_/cifg4_8pquaf9x684dyznzxff0m.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gr√¢ce au pipeline, vous pouvez accepter des valeurs de param√®tre pour lesquelles les attributs correspondants sont d√©finis (ByValue et / ou ByPropertyName). </font><font style="vertical-align: inherit;">Dans le premier cas, le param√®tre sera mis en correspondance avec un objet re√ßu via le pipeline, √† condition que son type corresponde √† celui attendu. </font><font style="vertical-align: inherit;">Dans le deuxi√®me param√®tre, la valeur sera la propri√©t√© de l'objet entrant dont le nom correspond au nom ou √† l'alias de ce param√®tre. </font><font style="vertical-align: inherit;">Pour d√©finir les attributs, utilisez [parameter ()] avec les arguments bool√©ens ValueFromPipeline et ValueFromPipelineByPropertyName, dont la valeur par d√©faut est $ false:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>,
    <span class="hljs-type">ValueFromPipeline</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-built_in">string</span>[]]
    <span class="hljs-variable">$Name</span>
)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ou</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>,
    <span class="hljs-type">ValueFromPipelineByPropertyName</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-built_in">string</span>[]]
    <span class="hljs-variable">$Name</span>
)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ValueFromPipelineByPropertyName est g√©n√©ralement utilis√© si n√©cessaire pour passer plusieurs param√®tres afin qu'il n'y ait pas de confusion, et l'argument peut √™tre utilis√© simultan√©ment avec ValueFromPipeline: </font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>,
    <span class="hljs-type">ValueFromPipeline</span>=<span class="hljs-variable">$true</span>,
    <span class="hljs-type">ValueFromPipelineByPropertyName</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-built_in">string</span>[]]
    <span class="hljs-variable">$Name</span><font></font>
)<font></font>
<font></font>
<span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$Name</span></code></pre><br>
<br>
<img src="https://habrastorage.org/webt/ym/i4/go/ymi4gowjn0tz4dpkgzdl5wjxztu.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, les scripts peuvent √©galement recevoir des param√®tres via le pipeline, mais n√©anmoins, l'application pratique des attributs d√©crits ci-dessus est plus probable pour </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">les fonctions avanc√©es</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui seront discut√©es ci-dessous.</font></font><br>
<br>
<a name="section5"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Structure du corps de la fonction</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans PowerShell, une fonction peut inclure trois blocs de code facultatifs entre crochets d'instruction - Begin, Process et End. </font><font style="vertical-align: inherit;">Cela ressemble √† ceci:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span></span><font></font>
{<font></font>
   <span class="hljs-keyword">param</span>()
   <span class="hljs-keyword">begin</span> {}
   <span class="hljs-keyword">process</span> {}
   <span class="hljs-keyword">end</span> {}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le bloc Begin est le premier √† √™tre ex√©cut√© une fois, et si les param√®tres sont pass√©s √† la fonction via le pipeline, le code s'ex√©cutera avant l'arriv√©e du premier objet pour le traitement. Dans ce cas, les variables $ _ et $ PSItem du bloc Begin ne contiendront pas de valeurs. Si la fonction est appel√©e √† l'aide de param√®tres sp√©cifi√©s explicitement, ils seront disponibles dans le bloc Begin, car il n'est pas n√©cessaire d'attendre la r√©ception d'objets du pipeline. Ensuite, le bloc Process est ex√©cut√©: si les param√®tres sont pass√©s par le pipeline, il sera lanc√© un par un pour chaque objet. Dans le cas de param√®tres explicitement sp√©cifi√©s, le bloc Process ne d√©marre qu'une seule fois. La fonction se termine en ex√©cutant le bloc Fin une fois. √âvidemment, l'utilisation de ces constructions n'est justifi√©e que si la fonction peut recevoir des objets du pipeline:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span></span><font></font>
{<font></font>
<font></font>
    <span class="hljs-keyword">param</span>(<font></font>
        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">ValueFromPipeline</span>)]<font></font>
        [<span class="hljs-built_in">string</span>[]]
        <span class="hljs-variable">$Param1</span>,<font></font>
<font></font>
        [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$Param2</span><font></font>
    )<font></font>
<font></font>
    <span class="hljs-keyword">begin</span><font></font>
    {<font></font>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">" Begin"</span>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"       ( pipeline):"</span> <span class="hljs-variable">$Param1</span>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"       ( ):"</span> <span class="hljs-variable">$Param2</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">process</span> {
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">" Process"</span>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"       ( pipeline):"</span> <span class="hljs-variable">$Param1</span>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"       ( ):"</span> <span class="hljs-variable">$Param2</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">end</span><font></font>
    {<font></font>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">" End"</span>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"       ( pipeline):"</span> <span class="hljs-variable">$Param1</span>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"       ( ):"</span> <span class="hljs-variable">$Param2</span><font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬´un¬ª, ¬´deux¬ª, ¬´trois¬ª | </font><font style="vertical-align: inherit;">test -Param2 'quatre'</font></font><br>
<br>
<img src="https://habrastorage.org/webt/aa/k5/fa/aak5fa8wzzrqxrzp4ixi-cybabw.png" alt="image"><br>
<br>
<a name="section6"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[CmdletBinding ()] Attribut et fonctions avanc√©es</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour cr√©er des fonctions ¬´avanc√©es¬ª (et des scripts √† proprement parler), vous pouvez utiliser l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">attribut</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">CmdletBinding ()</font></a><font style="vertical-align: inherit;"> ]. </font><font style="vertical-align: inherit;">En particulier, il vous permet de d√©finir des fonctions avanc√©es avec les capacit√©s des applets de commande binaires compil√©es dans Visual Studio, qui sont des classes de classes .NET Core. </font><font style="vertical-align: inherit;">Puisque cet attribut est utilis√© principalement dans les fonctions, nous nous arr√™terons sur elles:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> &lt;<span class="hljs-title">Name</span>&gt;</span><font></font>
{<font></font>
    [<span class="hljs-type">CmdletBinding</span>(<span class="hljs-type">ConfirmImpact</span>=&lt;<span class="hljs-built_in">String</span>&gt;,
    <span class="hljs-type">DefaultParameterSetName</span>=&lt;<span class="hljs-built_in">String</span>&gt;,
    <span class="hljs-type">HelpURI</span>=&lt;<span class="hljs-type">URI</span>&gt;,
    <span class="hljs-type">SupportsPaging</span>=&lt;<span class="hljs-built_in">Bool</span><span class="hljs-type">ean</span>&gt;,
    <span class="hljs-type">SupportsShouldProcess</span>=&lt;<span class="hljs-built_in">Bool</span><span class="hljs-type">ean</span>&gt;,
    <span class="hljs-type">PositionalBinding</span>=&lt;<span class="hljs-built_in">Bool</span><span class="hljs-type">ean</span>&gt;)]<font></font>
<font></font>
    <span class="hljs-keyword">Param</span> ()<font></font>
<font></font>
    <span class="hljs-keyword">Begin</span>{}
    <span class="hljs-keyword">Process</span>{}
    <span class="hljs-keyword">End</span>{}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, [CmdletBinding ()] initialise une nouvelle instance de la classe </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CmdletBindingAttribute</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en appelant un constructeur auquel des arguments facultatifs peuvent √™tre pass√©s. Leur description d√©taill√©e se trouve </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sur le site Web de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Microsoft. L'attribut CmdletBinding vous permet de contr√¥ler des fonctionnalit√©s suppl√©mentaires de la fonction avanc√©e: ajouter la prise en charge de -Confirm et -WhatIf (via SupportsShouldProcess), -Force, -Verbose et -Debug, ainsi que d√©sactiver la liaison de param√®tres positionnels, etc. Nous analyserons ensuite l'utilisation de param√®tres sp√©ciaux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le param√®tre </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-Force est</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilis√© pour supprimer les demandes pour diverses op√©rations; </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-Et qu'est-ce qui se passerait si</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√©cessaire pour √©muler le lancement et afficher des informations sur les cons√©quences de l'ex√©cution d'une fonction (commande) sans ce param√®tre. Couramment utilis√© si une fonction peut effectuer des actions destructrices. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Remove-Item C: \ Windows \ notepad.exe -WhatIf </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ag/b9/cl/agb9cl6mbsaxqvrmwwl_fj1xjrm.png" alt="image"><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-Confirm</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√©cessite une confirmation et est √©galement utilis√© si la fonction peut effectuer des actions destructrices.</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Delete-File</span></span> {<font></font>
[<span class="hljs-type">CmdletBinding</span>(
    <span class="hljs-type">ConfirmImpact</span> = <span class="hljs-string">'High'</span>,
    <span class="hljs-type">SupportsShouldProcess</span> = <span class="hljs-variable">$true</span><font></font>
)]<font></font>
    <span class="hljs-keyword">param</span>(<font></font>
        [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$File</span>,<font></font>
        [<span class="hljs-type">switch</span>]<span class="hljs-variable">$Force</span><font></font>
    )<font></font>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$Force</span> <span class="hljs-operator">-or</span> <span class="hljs-variable">$PSCmdlet</span>.ShouldProcess(<span class="hljs-variable">$File</span>,<span class="hljs-string">"Delete file"</span>)) {
        <span class="hljs-built_in">Remove-Item</span> <span class="hljs-variable">$File</span><font></font>
    }<font></font>
}</code></pre><br>
<br>
<img src="https://habrastorage.org/webt/la/ie/oq/laieoqimwhyv-dtm_l5m0yp6xay.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour traiter -WhatIf et / ou -Confirm, la m√©thode ShouldProcess (SupportsShouldProcess = $ true) est appel√©e, ce qui invite ou √©mule l'ex√©cution de la commande. Pour impl√©menter le traitement -Force, nous le mettons d'abord dans la condition IF. Tout d'abord, l'expression √† gauche de l'op√©rateur -or est v√©rifi√©e, et si elle est vraie, le test s'arr√™te - la m√©thode ShouldProcess ne sera pas appel√©e. De plus, dans l'attribut [CmdletBinding ()], nous avons sp√©cifi√© l'argument ConfirmImpact, qui d√©termine le niveau d'influence du code sur le syst√®me et inclut le gestionnaire de param√®tres -Confirm. Cet argument peut prendre les valeurs suivantes: </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aucune</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou non sp√©cifi√©e - les messages de confirmation ne seront pas affich√©s, m√™me si le param√®tre -Confirm est pass√©. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Faible</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - la fonction affecte l√©g√®rement le syst√®me et ne cr√©e pas de risques importants de perte de donn√©es.</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moyen</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - exposition moyenne avec peu de </font><font style="vertical-align: inherit;">risque de perte de donn√©es √† la suite d'actions destructrices. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âlev√©</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - le code cr√©e un risque √©lev√© de perte de donn√©es suite √† des actions destructrices. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par d√©faut, pour une session PowerShell, le niveau d'exposition est consid√©r√© comme √©lev√©. La valeur actuelle est stock√©e dans la variable $ ConfirmPreference, et si le code a le m√™me ou un plus haut impact sur le syst√®me, une demande de confirmation sera toujours affich√©e. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Options </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-Verbose</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-Debug</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√©cessaire pour afficher les informations de d√©bogage. </font><font style="vertical-align: inherit;">Leur utilisation est consid√©r√©e comme un bon style de programmation (oubliez Write-Host, ce n'est pas n√©cessaire dans les fonctions avanc√©es). </font><font style="vertical-align: inherit;">Le premier param√®tre affiche des informations sur la progression et le second - des informations de d√©bogage d√©taill√©es. </font><font style="vertical-align: inherit;">Il permet √©galement de passer √† l'ex√©cution de code √©tape par √©tape. </font><font style="vertical-align: inherit;">Le comportement de -Verbose et -Debug est d√©fini comme suit:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Get-Something</span></span> {
<span class="hljs-function">[<span class="hljs-type">CmdletBinding</span>()]</span>
    <span class="hljs-keyword">param</span>()
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$PSBoundParameters</span>.Verbose) {<span class="hljs-variable">$VerbosePreference</span> = <span class="hljs-string">"Continue"</span>}
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$PSBoundParameters</span>.Debug) {<span class="hljs-variable">$DebugPreference</span> = <span class="hljs-string">"Continue"</span>}
    <span class="hljs-built_in">Write-Verbose</span> <span class="hljs-string">"Type some verbose information"</span>
    <span class="hljs-built_in">Write-Debug</span> <span class="hljs-string">"Type some debug information"</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour travailler avec des param√®tres sp√©ciaux, nous avons utilis√© la variable $ PSBoundParameters. </font><font style="vertical-align: inherit;">Par d√©faut, les valeurs de $ VerbosePreference et $ DebugPreference sont √©gales √† 'SilentlyContinue', par cons√©quent, m√™me si les param√®tres correspondants sont sp√©cifi√©s, les informations de d√©bogage ne seront pas affich√©es - elles doivent √™tre transf√©r√©es √† l'√©tat 'Continue'.</font></font><br>
<br>
<a name="section7"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modules de script et cr√©ation d'applet de commande</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Commen√ßons par cr√©er nos propres applets de commande. En fait, ce sont des fonctions avanc√©es qui sont d√©crites dans le soi-disant </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">modules de script</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - fichiers texte avec l'extension .psm1. Ils sont stock√©s dans des r√©pertoires d√©finis dans la variable d'environnement PSModulePath. Vous pouvez afficher leurs chemins d'acc√®s √† l'aide de la commande suivante: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Get-ChildItem Env: \ PSModulePath | Format-Table -AutoSize </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'ensemble standard ressemble √† ceci: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C: \ Users \% UserName% \ Documents \ WindowsPowerShell \ Modules </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C: \ Program Files \ WindowsPowerShell \ Modules </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C: \ Windows \ System32 \ WindowsPowerShell \ v1.0 \ Modules</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir cr√©√© le fichier ModuleName.psm1 avec la fonction Delete-File √©tendue de la section pr√©c√©dente, vous devez l'enregistrer, par exemple, dans] C: \ Users \% UserName% \ Documents \ WindowsPowerShell \ Modules \ ModuleName. Veuillez noter que le module de script doit √™tre stock√© dans un sous-r√©pertoire s√©par√©, dont le nom co√Øncide avec le nom de base (sans extension) du fichier .psm1. Apr√®s avoir ex√©cut√© la commande </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Import-Module ModuleName</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , la fonction Delete-File sera disponible pour l'utilisateur, et puisqu'elle est avanc√©e, du point de vue pratique, il s'agit de la m√™me applet de commande. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9j/5d/fw/9j5dfwsxqzf3jeznbl_em53lnpi.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet article, nous avons examin√© suffisamment en d√©tail le passage des param√®tres aux fonctions et aux scripts. La prochaine partie de la s√©rie se concentrera sur la programmation orient√©e objet. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partie 1: Windows PowerShell Essentials</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> 2:     Windows PowerShell</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> 4:   ,  <br>
</a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr493348/index.html">Rendre "udalenka" g√©nial √† nouveau: comment transf√©rer toute l'entreprise au travail √† distance en 4 √©tapes</a></li>
<li><a href="../fr493352/index.html">Diffusez vos vid√©os sur YouTube 24h / 24</a></li>
<li><a href="../fr493356/index.html">Video @Databases Meetup: s√©curit√© du SGBD, Tarantool dans l'IoT, Greenplum pour l'analyse de Big Data</a></li>
<li><a href="../fr493360/index.html">Deux doigts d'Algol</a></li>
<li><a href="../fr493362/index.html">Support technique "sur les valises". Comment nous travaillons √† distance sans nerfs inutiles et obtenons √† distance les services dont nous avons besoin</a></li>
<li><a href="../fr493374/index.html">Coronavirus - conseils pratiques et un peu de th√©orie</a></li>
<li><a href="../fr493376/index.html">The Big Initiative Theory - Exp√©rience russe dans la transformation num√©rique des entreprises industrielles</a></li>
<li><a href="../fr493378/index.html">Steam vous a: comment la distribution num√©rique retire nos jeux</a></li>
<li><a href="../fr493380/index.html">Julia et l'informatique quantique</a></li>
<li><a href="../fr493382/index.html">Mises √† jour du concepteur Windows Forms .NET Core</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>