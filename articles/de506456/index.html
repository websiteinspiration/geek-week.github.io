<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨ğŸ¿â€ğŸ¨ ğŸ“š ğŸ› Wir empfangen und analysieren das Funksignal des Zahlungsterminals mit SDR ğŸ‘¨ğŸ¿â€ğŸ”¬ ğŸ¤½ğŸ½ ğŸ¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo Habr. 
 
 Vor kurzem hatte ich die MÃ¶glichkeit, ein Zahlungsterminal mit der MÃ¶glichkeit der kontaktlosen Zahlung zu testen. Nun, da die Zahlung...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Wir empfangen und analysieren das Funksignal des Zahlungsterminals mit SDR</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/506456/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hallo Habr. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vor kurzem hatte ich die MÃ¶glichkeit, ein Zahlungsterminal mit der MÃ¶glichkeit der kontaktlosen Zahlung zu testen. </font><font style="vertical-align: inherit;">Nun, da die Zahlung kontaktlos ist, wird das Signal per Funk gesendet, und natÃ¼rlich konnte ich die Versuchung nicht aufgeben, mit dem SDR-EmpfÃ¤nger zu prÃ¼fen, welche Art von Daten wÃ¤hrend der Zahlung gesendet und empfangen werden. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/of/lx/nc/oflxncgb4c_qvhq6ptvxadvfyf8.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foto (c) Verifone</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
FÃ¼r diejenigen, die daran interessiert sind, wie dies funktioniert, einige Details unter dem Schnitt.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es sollte sofort angemerkt werden, dass ich keine offizielle Beschreibung des Protokolls fÃ¼r den Austausch eines Terminals mit einer Karte habe. Solche Daten werden normalerweise nur an Partnerunternehmen nach Unterzeichnung der NDA verteilt, aber niemand verbietet uns, die Sendung anzuhÃ¶ren und irgendwelche Annahmen zu treffen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also lasst uns anfangen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Signalspektrum</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beginnen wir mit der einfachsten Sache: Starten Sie den EmpfÃ¤nger, schalten Sie das Terminal ein, zahlen Sie und sehen Sie, was gerade ausgestrahlt wird. </font><font style="vertical-align: inherit;">Die Suche nach dem Signal erweist sich als elementar, bei einer Frequenz von 13,56 MHz ist ein groÃŸer Peak sichtbar: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wo/-h/l7/wo-hl75zr6ratqupuvl9ohw8wsg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Signalpegel ist nicht Ã¼berraschend, da er fÃ¼r die induktive Kommunikation mit einer Karte ohne eigene Stromquelle ausreichen sollte. </font><font style="vertical-align: inherit;">Wie Google vorschlÃ¤gt, ist 13,56 MHz die Standardfrequenz fÃ¼r RFID-GerÃ¤te. </font><font style="vertical-align: inherit;">Die Symmetrie des Signals legt die mÃ¶gliche Verwendung der AM-Modulation nahe. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem das Signal gefunden wurde, ist es einfach, es genauer zu betrachten und die verschiedenen Zahlungsphasen zu sehen: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/p8/c-/cp/p8c-cpgkrxw7rq-uhs4jt0ms_hi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Betrachten Sie sie genauer.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Leerlaufmodus</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Modus gibt das Terminal nichts aus, nur das Logo der Bank oder des GeschÃ¤fts wird auf dem Bildschirm angezeigt.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Zahlungsanforderung und Warten auf die Karte</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Kassierer veranlasst eine Zahlung fÃ¼r einen bestimmten Betrag. </font><font style="vertical-align: inherit;">Zu diesem Zeitpunkt wechselt das Terminal in den Standby-Zahlungsmodus. </font><font style="vertical-align: inherit;">Die Zahlung per Karte kann entweder mit einem Magnetstreifen oder durch Einlegen einer Karte oder mit der fÃ¼r uns interessanten kontaktlosen Methode erfolgen. </font><font style="vertical-align: inherit;">Um festzustellen, wann die Karte zum Terminal gebracht wurde, wird alle 0,12 Sekunden eine Anfrage gesendet. </font><font style="vertical-align: inherit;">Kurze Pakete in Form vertikaler Linien im Spektrum sehen in vergrÃ¶ÃŸerter Form folgendermaÃŸen aus: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hl/bc/yv/hlbcyvjnx9wrtvr2d1n5bedlvdi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist deutlich zu sehen, dass sich die Daten wiederholen. </font><font style="vertical-align: inherit;">Der Datenblock ("per Auge", 24 oder 32 Bit) enthÃ¤lt hÃ¶chstwahrscheinlich eine Bitmaske, die die von diesem LesegerÃ¤t unterstÃ¼tzten Kartenformate enthÃ¤lt. </font><font style="vertical-align: inherit;">Zumindest auf andere Karten (z. B. Transport) reagiert der Leser nicht.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Datenaustausch mit der Karte</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn eine Karte erkannt wird, sendet der Controller als Antwort ihre Daten - wahrscheinlich die Kartennummer und die Serviceinformationen. </font><font style="vertical-align: inherit;">In der Karte selbst befindet sich kein Netzteil, daher ist die Reaktion sehr schwach. </font><font style="vertical-align: inherit;">Wie Sie sehen kÃ¶nnen, sendet die Karte fÃ¼r jede Terminalanforderung eine Antwort. Das â€FunkgerÃ¤tâ€œ zwischen ihnen ist ziemlich aktiv: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ms/vq/cs/msvqcsmzk4qkowdclpxauf9melg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das von der Karte empfangene erhÃ¶hte Signal sieht ungefÃ¤hr so â€‹â€‹aus:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vt/t4/lf/vtt4lfrsq2vh9glkdfwcxcxses8.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. KartenÃ¼berprÃ¼fung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn die Kartendaten empfangen werden, Ã¼berprÃ¼ft das Terminal wahrscheinlich die VerschlÃ¼sselungsschlÃ¼ssel auf der Karte. Der Vorgang dauert ca. 0,6 Sekunden. </font><font style="vertical-align: inherit;">Das RFID-Modul ist derzeit deaktiviert. </font><font style="vertical-align: inherit;">MÃ¶glicherweise fordert das Terminal den Kartenstatus online an.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Auszahlung der ausstehenden Karte</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In dem Moment, in dem das Terminal alle Daten gelesen und die Karte Ã¼berprÃ¼ft hat, wird auf dem Bildschirm die Meldung "Karte entfernen" angezeigt. Alle 5 ms Ã¼berprÃ¼ft das Terminal, ob die Karte vorhanden ist: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bi/vl/wp/bivlwp5c5uhb-etgpva3gfc0tfg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir sehen dieselben Meldungen, die Antwort der Karte ist ebenfalls sichtbar. </font><font style="vertical-align: inherit;">In einer vergrÃ¶ÃŸerten Ansicht kÃ¶nnen Sie den Moment anzeigen, in dem die Karte nicht mehr reagiert: Die </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jd/rj/bh/jdrjbhqexfxncf0z3k5743rw8zq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Antwort von der Karte selbst ist Ã¼brigens recht einfach und kurz, â€per Augeâ€œ, nicht mehr als 24 Bit: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/n_/b_/l_/n_b_l_8-zlnpokvhf98w0cpq5va.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier endet der Funkaustausch, und mit allen empfangenen Daten sendet das Terminal eine Zahlungsaufforderung an Krug. </font><font style="vertical-align: inherit;">Eine Antwort kommt von der Bank, und wenn die Zahlung erfolgreich ist, erhalten wir unsere Waren.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie sehen kÃ¶nnen, ist auf binÃ¤rer Ebene alles recht einfach. Das RFID-Protokoll verwendet konventionelle Amplitudenmodulation, keine Raketenwissenschaft. Aber natÃ¼rlich wird die Hauptarbeit auf logischer Ebene ausgefÃ¼hrt. Das ÃœberprÃ¼fen der Karte und das AusfÃ¼hren einer Zahlung ist ein ziemlich komplizierter Prozess, der auch die VerschlÃ¼sselung umfasst. FÃ¼r diejenigen, die das Thema genauer untersuchen mÃ¶chten, finden Sie nÃ¼tzliche Kommentare der Benutzer </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rizorko</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lil_Toady</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , in denen Sie Links zu Standards finden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SchlieÃŸlich kÃ¶nnen Sie die Frage beantworten, an der wahrscheinlich viele interessiert sind: Ist es mÃ¶glich, in groÃŸer Entfernung verdeckt Geld von der Karte eines anderen abzuheben? Nach der Analyse des Funksignals kÃ¶nnen wir sagen, dass dies sehr unwahrscheinlich ist. Erstens verfÃ¼gt die Karte selbst nicht Ã¼ber ein eingebautes Netzteil - damit der Prozessor funktioniert, sollte die FeldstÃ¤rke </font><i><font style="vertical-align: inherit;">recht</font></i><font style="vertical-align: inherit;"> hoch sein</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">groÃŸ. Der normale Leseabstand der Karte betrÃ¤gt 2-3 cm. Um sie auf mindestens 100 cm zu erhÃ¶hen, sollte die FeldstÃ¤rke im dritten Grad grÃ¶ÃŸer sein als dieser Unterschied. Der zweite Punkt empfÃ¤ngt eine Antwort von der Karte - ihr Signal ist sehr schwach und es ist auch nicht einfach, es aus groÃŸer Entfernung zu empfangen (und vergessen Sie nicht, dass die WellenlÃ¤nge mit einer Frequenz von 13 MHz etwa 20 Meter betrÃ¤gt und kurze Antennen bei solchen WellenlÃ¤ngen ineffizient sind). Vergessen Sie nicht die organisatorischen Aspekte - jedes Zahlungsterminal ist mit dem Bankkonto einer juristischen Person verknÃ¼pft. Wenn Beschwerden Ã¼ber die Belastung von Geldern vorliegen, kann dieses Konto einfach gesperrt werden. Das Terminal selbst hat Ã¼brigens eine eindeutige ID, und wenn es stÃ¤ndig an verschiedene Konten gebunden ist, ist dies ebenfalls verdÃ¤chtig. Obwohl theoretisch ein Fernlesen von RFID mÃ¶glich sein kann,Nach zu urteilen</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In diesem Artikel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gab es keine wirklichen FÃ¤lle solcher RÃ¼cknahmen. </font><font style="vertical-align: inherit;">Und schlieÃŸlich ist die Grenze fÃ¼r kontaktlose Zahlungen sehr gering, sodass der â€Gewinnâ€œ wahrscheinlich nicht dem Risiko und den Kosten der AusrÃ¼stung entspricht.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de506442/index.html">Tick â€‹â€‹Tuck</a></li>
<li><a href="../de506444/index.html">ZukÃ¼nftige Herausforderungen</a></li>
<li><a href="../de506450/index.html">Erfahrung in der Verwendung der Rutoken-Technologie zur Registrierung und Autorisierung von Benutzern im System (Teil 1)</a></li>
<li><a href="../de506452/index.html">So schÃ¼tzen Sie Ihre Ã¶ffentliche Website mit ESNI</a></li>
<li><a href="../de506454/index.html">FÃ¼r was ein Bim-Manager 100.000 bekommt und wie man einer wird</a></li>
<li><a href="../de506460/index.html">Unterschiede des mÃ¤nnlichen zum weiblichen Gehirn: Frauen codieren besser?</a></li>
<li><a href="../de506462/index.html">Pushpools und Tachers - wie ich alles getestet habe, was ich gefunden habe</a></li>
<li><a href="../de506472/index.html">Unternehmensschutz fÃ¼r Internetunternehmer: Wo soll ein Unternehmen und ein Konto erÃ¶ffnet werden, wonach muss gesucht werden?</a></li>
<li><a href="../de506478/index.html">Installieren und Konfigurieren von RTKRCV (RTKLIB) unter Windows 10 mithilfe von WSL</a></li>
<li><a href="../de506480/index.html">2008 vs 2020: Wie sich das Anlegerverhalten wÃ¤hrend der Krise verÃ¤ndert</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>