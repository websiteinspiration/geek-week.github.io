<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ£ ğŸ¶ ğŸ’” ä»å³æ—¶é€šè®¯å·¥å…·å¿«é€Ÿè½¬ç§»-QIWI Android Wallet ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ğŸ‘‡ğŸ» âœ‹ğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ä½ å¥½ï¼
 
 æˆ‘å«Alexï¼Œæˆ‘æ˜¯QIWIçš„å¼€å‘äººå‘˜ã€‚
 
 TL; DR
 
 å¦‚ä½•ç›´æ¥ä»Messengerè½¬ç§»è‡³ä»˜æ¬¾è¡¨æ ¼ï¼š
 
 

1. åœ¨æ¸…å•ä¸­ï¼Œæˆ‘ä»¬æŠŠä¸€ä¸ªç©ºçš„æ´»åŠ¨Ã‡ intent-filter ç±»å‹ACTION_VIEWï¼Œå¹¶ ACTION_DIALä¸è¯¥è®¡åˆ’â€œç”µè¯â€ã€‚
2. åœ¨æ´»åŠ¨ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ä»å³æ—¶é€šè®¯å·¥å…·å¿«é€Ÿè½¬ç§»-QIWI Android Wallet</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/qiwi/blog/500516/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½ å¥½ï¼</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘å«Alexï¼Œæˆ‘æ˜¯QIWIçš„å¼€å‘äººå‘˜ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TL; DR</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
å¦‚ä½•ç›´æ¥ä»Messengerè½¬ç§»è‡³ä»˜æ¬¾è¡¨æ ¼ï¼š</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ¸…å•ä¸­ï¼Œæˆ‘ä»¬æŠŠä¸€ä¸ªç©ºçš„æ´»åŠ¨Ã‡ </font></font><code>intent-filter </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font></font><code>ACTION_VIEW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå¹¶</font></font><code> ACTION_DIAL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸è¯¥è®¡åˆ’â€œç”µè¯â€ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ´»åŠ¨ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ç°æœ‰çš„æ·±å±‚é“¾æ¥è½¬ä¸ºä»˜æ¬¾è¡¨æ ¼ï¼Œå¹¶ä½¿ç”¨åŸå§‹æ•°æ®è¿›è¡Œäº†å……å®</font></font><code> intent- â€œtel:XXXXXâ€</code></li>
</ol><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/8k/j_/il/8kj_ilpgmgyxhelzbnj0nmo8wim.jpeg"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ©æ¶¦</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šé€šè¿‡å•å‡»ä½¿è€…ä¸­çªå‡ºæ˜¾ç¤ºçš„ç”µè¯å·ç ï¼Œä¸€ä¸ªäººå°†è¿›å…¥è½¬ç§»è¡¨å•ï¼Œå…¶ä¸­åŒ…å«è½¬ç§»æ¥æ”¶è€…çš„å®Œæ•´å­—æ®µã€‚</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¥–åŠ±</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šæˆ‘å°†å‘Šè¯‰æ‚¨å¯ç”¨æ­¤åŠŸèƒ½çš„ç¾è§‚ç¨‹åº¦ï¼Œè€Œåˆæ— æ³•åœ¨è¿è¡Œæ—¶æ›´æ”¹æ¸…å•ä¸­çš„æ„å›¾è¿‡æ»¤å™¨åˆ—è¡¨ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åšä»€ä¹ˆçš„ï¼Ÿ</font></font></h2><br>
<a name="habracut"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡è®¾æŸäººæœ‰ä¸ºé›†ä½“ç”Ÿæ—¥ç¤¼ç‰©æ±‡æ¬¾çš„ä»»åŠ¡ã€‚æ¥æ”¶æ–¹å¯ä»¥é€‰æ‹©æ–¹ä¾¿çš„è½¬å¸é€‰é¡¹ï¼šè½¬å¸åˆ°å¡ï¼Œç”µå­é’±åŒ…ï¼Œç›´æ¥è½¬å¸åˆ°å¸æˆ·æˆ–å…¶ä»–ã€‚æä¾›ç¿»è¯‘æœåŠ¡çš„è®¸å¤šå…¬å¸éƒ½æ¥å—ç”µè¯å·ç ä½œä¸ºè¾…åŠ©æˆ–ä¸»è¦ç”¨æˆ·æ ‡è¯†ç¬¦ã€‚ä¸ºäº†é¿å…é”™è¯¯çš„è½¬ç§»ï¼Œæ”¶ä»¶äººå¯ä»¥é€šè¿‡çŸ­ä¿¡ï¼ˆç”µå­é‚®ä»¶ï¼Œå³æ—¶é€šè®¯å·¥å…·æˆ–SMSï¼‰ä¼ è¾¾ä»–çš„ç”µè¯å·ç ã€‚è¯¥æ¶ˆæ¯è¿˜æŒ‡ç¤ºå¿…è¦çš„ç¿»è¯‘ç³»ç»Ÿã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å…¸å‹çš„ç”¨æˆ·è·¯å¾„æ˜¯ä»Messengerä¸Šå¤åˆ¶ç”µè¯å·ç ï¼Œç„¶åå°†å…¶ç²˜è´´åˆ°åº”ç”¨ç¨‹åºä¸­è¿›è¡Œç¿»è¯‘ã€‚</font><font style="vertical-align: inherit;">è¿™ç§æ–¹å¼æ¶‰åŠåœ¨åº”ç”¨ç¨‹åºä¹‹é—´è¿›è¡Œåˆ‡æ¢ï¼Œå¯èƒ½ä¼šè®¿é—®æ¡Œé¢ï¼Œç”šè‡³åœ¨ç¿»è¯‘æœåŠ¡æä¾›å•†çš„å·²å®‰è£…åº”ç”¨ç¨‹åºä¹‹é—´è¿›è¡Œæœç´¢ã€‚</font><font style="vertical-align: inherit;">æ˜¯å¦å¯ä»¥é€šè¿‡å‡å°‘æ­¥éª¤æ•°æ¥ç¼©çŸ­æ­¤è·¯å¾„ï¼Ÿ</font><font style="vertical-align: inherit;">æœ‰ä¸€ä¸ªé€‰æ‹©ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç†è®º</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ™ºèƒ½æ‰‹æœºä¸­çš„è®¸å¤šå³æ—¶é€šè®¯ç¨‹åºéƒ½èƒ½è¯†åˆ«ç”µè¯å·ç ï¼Œå¹¶ä»¥è¶…é“¾æ¥çš„å½¢å¼çªå‡ºæ˜¾ç¤ºå®ƒä»¬ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæœ‰ä¸€ä¸ªåº”ç”¨ç¨‹åºå¯ä»¥åœ¨ä»»ä½•å¸¦æœ‰GSMæ¨¡å—çš„ç§»åŠ¨è®¾å¤‡ä¸Šå¤„ç†è¿™ç§é“¾æ¥ã€‚é€šå¸¸å°†å…¶ç§°ä¸ºâ€œç”µè¯â€ã€‚åœ¨Androidä¸­ï¼ŒAndroidManifestä¸­å£°æ˜äº†èƒ½å¤Ÿå¤„ç†å…±äº«ç”µè¯å·ç çš„åŠŸèƒ½ã€‚åº”ç”¨ç¤ºä¾‹ï¼šâ€œç”µè¯â€ï¼ŒViberï¼ŒSkypeã€‚å¦‚æœæ‹¦æˆªè¿™äº›äº‹ä»¶ï¼Œåˆ™å¯ä»¥ç«‹å³ä¸ºç”¨æˆ·æä¾›å¸¦æœ‰ç”µè¯å·ç çš„å¯èƒ½æ“ä½œåˆ—è¡¨ã€‚åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œè¿™å°†æ˜¯é€šè¿‡QIWIç”µå­é’±åŒ…æä¾›çš„è½¬ç§»ä¼˜æƒ ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬æ„Ÿå…´è¶£çš„äº‹ä»¶ä¸ç±»å‹</font></font><code>Intent.ACTION_VIEW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font></font><code>Intent.ACTION_DIAL,</code><code> Intent.ACTION_CALL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ç”µè¯æ–¹æ¡ˆã€‚äº‹ä»¶</font></font><code>Intent.ACTION_CALL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®ƒå¯¹Androidå®‰å…¨ç­–ç•¥æœ‰é™åˆ¶ï¼Œå¹¶ä¸”å…¶åˆå§‹åŒ–éœ€è¦ç”¨æˆ·ä»Marshmallowå«ä»¥ä¸‹ç‰ˆæœ¬å¼€å§‹çš„æƒé™ã€‚æ ¹æ®æˆ‘ä»¬çš„ç ”ç©¶ä¿¡ä½¿ä½¿ç”¨æ›´ä¸€èˆ¬çš„</font></font><code>Intent.ACTION_VIEW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font></font><code>Intent.ACTION_DIAL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ‰å‡ ç§ä¸“é—¨ç”¨äºç´§æ€¥ç”µè¯çš„ç±»ä¼¼ç±»å‹ï¼Œä½†è¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬çš„æƒ…å†µã€‚æ„å‘ä¸»ä½“çš„æ ¼å¼ä¸ºâ€œ telï¼š12345678â€ã€‚æ— æ³•å¤„ç†è¿™ç§æ„å›¾</font></font><code>android.content.UriMatcher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå› ä¸ºæ­¤å¤„ç¼ºå°‘ä¸»æœºã€‚å¤„ç†æ­¤ç±»Uriçš„æœ€ç®€å•æ–¹æ³•æ˜¯è¯¢é—®</font></font><code>schemeSpecificPart </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶æ£€æŸ¥å®ƒæ˜¯å¦ä¸ºæœ‰æ•ˆçš„ç”µè¯å·ç ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ„å‘è¿‡æ»¤å™¨åˆ—è¡¨å¿…é¡»åœ¨AndroidManifestä¸­æŒ‡å®šï¼Œåœ¨åº”ç”¨ç¨‹åºæ‰§è¡ŒæœŸé—´æ— æ³•æ›´æ”¹å®ƒã€‚å¦‚ä½•è¿œç¨‹ç¦ç”¨æ­¤åŠŸèƒ½ï¼Ÿç¬¬ä¸€ç§é€‰æ‹©æ˜¯åœ¨æ‰“å¼€â€œæ´»åŠ¨â€æ—¶æ‹’ç»ç”¨æˆ·çš„è¯·æ±‚-å¸¦æœ‰æ¶ˆæ¯æˆ–ä»…å…³é—­åº”ç”¨ç¨‹åºã€‚ä»æˆ‘ä»¬çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ä¸æ˜¯æœ€ä½³çš„UXï¼Œå› ä¸ºæˆ‘ä»¬ä¼šä¸­æ–­ä¸­é—´çš„ç”¨æˆ·æµç¨‹ã€‚å¦‚æœåŠŸèƒ½è¢«ç¦ç”¨ï¼Œæœ€å¥½ä¸è¦è®©ä»»ä½•äººé€‰æ‹©æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚åœ¨è¿è¡Œæ—¶ä½¿ç”¨intent-filteråˆ—è¡¨ç¦ç”¨ç»„ä»¶ä¼šæ›´å®¹æ˜“ï¼Œè¿™ä¸ä¼šç»™ç”¨æˆ·ç³»ç»Ÿç•Œé¢ä¸­çš„ä»»ä½•è™šå‡æ‰¿è¯ºã€‚ä½¿ç”¨PackageManageræ—¶ï¼Œè¯·æ³¨æ„æ£€æŸ¥ç»„ä»¶æ˜¯å¦åŒ…å«ä¸æ˜¯å¾ˆå¯é ã€‚æœ€å¥½åœ¨</font></font><code>enabled </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ä¾èµ–äºç»„ä»¶å½“å‰çŠ¶æ€çš„æƒ…å†µä¸‹ä½¿ç”¨å€¼</font><font style="vertical-align: inherit;">æ¥</font><font style="vertical-align: inherit;">å¼ºåˆ¶å…¶</font><font style="vertical-align: inherit;">æ ‡å¿—</font></font><code>COMPONENT_ENABLED_STATE_ENABLED </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><code>COMPONENT_ENABLED_STATE_DISABLED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ä¿å­˜é€šè¿‡PackageManagerè¿›è¡Œçš„æ›´æ”¹ï¼Œç›´åˆ°ä»è®¾å¤‡ä¸Šå¸è½½åº”ç”¨ç¨‹åºä¸ºæ­¢ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®è·µ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†ç¦ç”¨è¯¥åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªAndroidç»„ä»¶å°†å…¶ç¦ç”¨ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªç©ºçš„Activityï¼Œæˆ‘ä»¬å°†è¿™æ ·åšã€‚</font><font style="vertical-align: inherit;">å¦‚æœæ‚¨å†³å®šå°†Serviceä¸ä¸€ç»„ç±»ä¼¼çš„æ„å›¾è¿‡æ»¤å™¨ä¸€èµ·ä½¿ç”¨ï¼Œè¯·æŸ¥çœ‹GoogleæŒ‡å—ï¼Œå…¶ä¸­æ˜ç¡®æŒ‡å‡º</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">â€œè¯·å‹¿ä¸ºæ‚¨çš„æœåŠ¡å£°æ˜æ„å›¾è¿‡æ»¤å™¨â€</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">è¯·æ³¨æ„ï¼Œé»˜è®¤æƒ…å†µä¸‹è¯¥ç»„ä»¶å¤„äºç¦ç”¨çŠ¶æ€ï¼š</font></font><code>android:enabled="false"</code><br>
<br>
<pre><code class="javascript hljs">  &lt;activity
            <span class="hljs-attr">android</span>:name=<span class="hljs-string">".messengerP2P.view.MessengerP2PActivity"</span>
            <span class="hljs-attr">android</span>:configChanges=<span class="hljs-string">"orientation"</span>
            <span class="hljs-attr">android</span>:label=<span class="hljs-string">"@string/title_activity_messenger_p2_p"</span>
            <span class="hljs-attr">android</span>:enabled=<span class="hljs-string">"false"</span>
            <span class="hljs-attr">android</span>:screenOrientation=<span class="hljs-string">"portrait"</span>&gt;<font></font>
            &lt;!-- Open shared telephone number <span class="hljs-keyword">as</span> dial application --&gt;
            <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">intent-filter</span>

                <span class="hljs-attr">android:label</span>=<span class="hljs-string">"@string/title_activity_messenger_p2_p"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.action.VIEW"</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.action.DIAL"</span> /&gt;</span>

                <span class="hljs-tag">&lt;<span class="hljs-name">category</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.category.DEFAULT"</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">data</span> <span class="hljs-attr">android:scheme</span>=<span class="hljs-string">"tel"</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">intent-filter</span>&gt;</span></span>
        &lt;/activity&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ´»åŠ¨æœ¬èº«åªæ˜¯é€šè¿‡ç°æœ‰çš„é“¾æ¥é“¾æ¥é‡å®šå‘åˆ°ä»˜æ¬¾å½¢å¼ã€‚</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MessengerP2PActivity</span> : <span class="hljs-title">Activity</span>() </span>{<font></font>
<font></font>
    override fun onCreate(savedInstanceState: Bundle?) {<font></font>
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        <span class="hljs-keyword">var</span> phoneNumberFromDial: <span class="hljs-built_in">String</span>? = intent?.data?.schemeSpecificPart<font></font>
        phoneNumberFromDial?.let {<font></font>
            <span class="hljs-keyword">if</span> (ru.mw.utils.Utils<font></font>
                    .isPhoneNumber(phoneNumberFromDial)) {<font></font>
                val phoneNumberFromDialLink = PaymentActivity.getUriForProviderId(<font></font>
                        resources.getInteger(R.integer.providerIdQiwiWallet).toLong(), <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>)<font></font>
                    .buildUpon()<font></font>
                    .appendQueryParameter(PaymentActivity.QUERY_PARAM_ACCOUNT, phoneNumberFromDial)<font></font>
                startActivity(<font></font>
                    Intent(Intent.ACTION_VIEW, phoneNumberFromDialLink.build()))<font></font>
            }<font></font>
        }<font></font>
        finish()<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
androidï¼šenabledæ ‡å¿—å¯ä»¥ç”±æ­¤å¸®åŠ©å™¨ç±»æ§åˆ¶ã€‚</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> android.content.ComponentName
<span class="hljs-keyword">import</span> android.content.Context
<span class="hljs-keyword">import</span> android.content.pm.PackageManager<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MessengerP2PUtils</span> </span>{<font></font>
<font></font>
    companion object {<font></font>
        private <span class="hljs-keyword">const</span> val componentName = <span class="hljs-string">"ru.mw.messengerP2P.view.MessengerP2PActivity"</span><font></font>
<font></font>
        private fun switchMessengerP2P(enabled: <span class="hljs-built_in">Boolean</span> = <span class="hljs-literal">true</span>, <span class="hljs-attr">packageName</span>: <span class="hljs-built_in">String</span>, <span class="hljs-attr">packageManager</span>: PackageManager) {<font></font>
            val compName = ComponentName(packageName, componentName)<font></font>
            packageManager.setComponentEnabledSetting(<font></font>
                compName,<font></font>
                when (enabled) {<font></font>
                    <span class="hljs-literal">true</span> -&gt; PackageManager.COMPONENT_ENABLED_STATE_ENABLED
                    <span class="hljs-keyword">else</span> -&gt; PackageManager.COMPONENT_ENABLED_STATE_DISABLED<font></font>
                },<font></font>
                PackageManager.DONT_KILL_APP)<font></font>
        }<font></font>
<font></font>
        fun enableMessengerP2P(applicationContext: Context) {<font></font>
            val packageName = applicationContext.packageName<font></font>
            val packageManager = applicationContext.packageManager<font></font>
            switchMessengerP2P(enabled = <span class="hljs-literal">true</span>, packageName = packageName, packageManager = packageManager);<font></font>
        }<font></font>
<font></font>
        fun disableMessengerP2P(applicationContext: Context) {<font></font>
            val packageName = applicationContext.packageName<font></font>
            val packageManager = applicationContext.packageManager<font></font>
            switchMessengerP2P(enabled = <span class="hljs-literal">false</span>, packageName = packageName, packageManager = packageManager);<font></font>
        }<font></font>
<font></font>
        fun isMessengerP2PEnabled(packageName: <span class="hljs-built_in">String</span>, <span class="hljs-attr">packageManager</span>: PackageManager): <span class="hljs-built_in">Boolean</span> {<font></font>
            val state = packageManager.getComponentEnabledSetting(ComponentName(packageName, componentName))<font></font>
            <span class="hljs-keyword">return</span> state == PackageManager.COMPONENT_ENABLED_STATE_ENABLED || state == PackageManager.COMPONENT_ENABLED_STATE_DEFAULT<font></font>
        }<font></font>
<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™é‡Œä¸ä½¿ç”¨â€œ isMessengerP2PEnabledâ€æ–¹æ³•æ¥æ£€æŸ¥ç»„ä»¶çš„å½“å‰çŠ¶æ€ï¼Œå› ä¸ºåœ¨æµ‹è¯•è¿‡ç¨‹ä¸­å®ƒäº§ç”Ÿäº†ä¸å¯é çš„ç»“æœã€‚å¦‚æœå†³å®šä½¿ç”¨å®ƒï¼Œè¯·åœ¨å¼‚æ­¥ä¸šåŠ¡é€»è¾‘çš„æ¡ä»¶ä¸‹ä»¥åŠä¸‹è½½åº”ç”¨ç¨‹åºæ—¶ä»”ç»†æ£€æŸ¥å…¶æ“ä½œã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ›´æ”¹æ ‡å¿—å€¼çš„æ—¶é—´</font></font><code>enabled </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸æ˜¯å¾ˆé‡è¦ï¼Œæˆ‘ä»¬é€‰æ‹©åŠŸèƒ½æ ‡å¿—é…ç½®å®Œå…¨åŠ è½½çš„æ—¶åˆ»ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› æ­¤ï¼Œå½“æ‚¨åœ¨Messengerä¸Šå•å‡»ç”µè¯å·ç æ—¶ï¼Œä¼šå‡ºç°ä¸€ä¸ªç³»ç»Ÿé€‰æ‹©å¯¹è¯æ¡†ï¼Œæ‚¨éœ€è¦å‘ç”¨æˆ·æä¾›æœ‰å…³å¦‚ä½•å–æ¶ˆæ„å›¾çš„é»˜è®¤è®¾ç½®çš„è¯´æ˜-â€œ telï¼šXXXXXâ€ã€‚ä¾‹å¦‚ï¼šâ€œå¦‚æœä»…å½“æ‚¨å•å‡»ä¸€ä¸ªå·ç æ—¶æ‰å¯ä»¥æ‹¨æ‰“ç”µè¯ï¼Œè¯·è½¬åˆ°æ™ºèƒ½æ‰‹æœºè®¾ç½®â†’åœ¨åº”ç”¨ç¨‹åºåˆ—è¡¨ä¸­é€‰æ‹©ç”µè¯â†’å°†è®¾ç½®é‡ç½®ä¸ºâ€œé»˜è®¤æƒ…å†µä¸‹æ‰“å¼€â€ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/pu/jd/ak/pujdakr-lmquupnkjgmt5urzrng.png" width="400"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæ‚¨åœ¨æ—…é€”ä¸­ç¦ç”¨è¯¥ç»„ä»¶ï¼Œåˆ™åœ¨å‘ç”¨æˆ·æ˜¾ç¤ºæ­¤ç³»ç»Ÿå¯¹è¯æ¡†æ—¶ï¼Œä¸ä¼šå‘ç”Ÿä»»ä½•ä¸è‰¯æƒ…å†µã€‚</font><font style="vertical-align: inherit;">ç›¸åº”çš„é¡¹ç›®å°†ç«‹å³ä»åˆ—è¡¨ä¸­æ¶ˆå¤±ï¼Œåœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­ä¸ºâ€œè½¬å¸â€ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœç”¨æˆ·é»˜è®¤æƒ…å†µä¸‹é€šè¿‡æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå¤„ç†é“¾æ¥ï¼Œåˆ™ä¼šå‡ºç°æœ‰è¶£çš„è¡Œä¸ºã€‚</font><font style="vertical-align: inherit;">ä¸ºæ­¤ï¼Œåªéœ€æ‹¨å‡ºâ€œè®°ä½é€‰æ‹©â€æˆ–â€œå§‹ç»ˆâ€é¡¹å³å¯ã€‚</font><font style="vertical-align: inherit;">å¦‚æœç¦ç”¨è¯¥ç»„ä»¶ï¼Œåˆ™å°†ä¸ºç”¨æˆ·æä¾›ä½¿ç”¨å“ªä¸ªåº”ç”¨ç¨‹åºçš„é€‰æ‹©ï¼Œå¹¶ä¸”åœ¨ç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶å°†æ²¡æœ‰â€œè®°ä½é€‰æ‹©â€é¡¹ã€‚</font><font style="vertical-align: inherit;">å¯ç”¨åŠŸèƒ½åï¼Œå°†æ¢å¤æ•´ä¸ªæµç¨‹ï¼Œå°†ç”¨æˆ·ç›´æ¥è½¬ç§»åˆ°åº”ç”¨ç¨‹åºã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»“è®º</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™ä¸ªåŠŸèƒ½çš„æƒ³æ³•å¾ˆä¹…ä»¥å‰å°±å‡ºç°äº†ï¼ŒåŸå§‹ç¥¨è¯æ˜¯åœ¨2017å¹´åˆ›å»ºçš„ã€‚</font><font style="vertical-align: inherit;">å³ä½¿åˆ°ç°åœ¨ï¼Œè¿™ä¸ªæƒ³æ³•ä¹Ÿæ²¡æœ‰å¤±å»æ„ä¹‰ï¼Œæˆ‘æ‰¾ä¸åˆ°å…·æœ‰ç±»ä¼¼åŠŸèƒ½çš„é“¶è¡Œåº”ç”¨ç¨‹åºã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬äº4æœˆ29æ—¥å‘å¸ƒäº†â€œæ¥è‡ªMessengerçš„ä¼ è¾“â€ï¼Œç¬¬ä¸€å¤©å°±æœ‰è¿‘8,000ä¸ªå”¯ä¸€ç”¨æˆ·åˆ©ç”¨äº†è¿™äº›ä¼ è¾“ã€‚</font><font style="vertical-align: inherit;">å¦‚æœåœ¨ä¸ä¹…çš„å°†æ¥ä¸šåŠ¡æŒ‡æ ‡èƒ½å¤Ÿä½¿æˆ‘ä»¬æ»¡æ„ï¼Œæˆ‘ä»¬å°†è¿›ä¸€æ­¥å¼€å‘æ­¤åŠŸèƒ½ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨å¦‚ä½•çœ‹å¾…ï¼Œè¿˜æœ‰æ›´å¤šæœ‰è¶£çš„Androidæ„å›¾å’Œå¹³åœ°ç­‰å¾…ç€ä»–ä»¬çš„ä¸šåŠ¡åº”ç”¨ç¨‹åºï¼Ÿ</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN500504/index.html">SREå¯è§‚å¯Ÿæ€§ï¼šå‘½åç©ºé—´å’Œåº¦é‡æ ‡å‡†ç»“æ„</a></li>
<li><a href="../zh-CN500506/index.html">ä½¿ç”¨è¾¹ç•Œä¸Šä¸‹æ–‡ç”»å¸ƒè®¾è®¡è¾¹ç•Œä¸Šä¸‹æ–‡ï¼šç ”è®¨ä¼šé£Ÿè°±</a></li>
<li><a href="../zh-CN500508/index.html">æ²™å‘ä¸“å®¶æ¯”èµ›</a></li>
<li><a href="../zh-CN500510/index.html">å®‰å…¨å‘¨19ï¼šå¯¹RDPçš„æš´åŠ›æ”»å‡»</a></li>
<li><a href="../zh-CN500512/index.html">Snom D785 IPç”µè¯è¯„è®º</a></li>
<li><a href="../zh-CN500518/index.html">åœ¨å…¬å¸ä¸­å¼•å…¥Scrumçš„è¿­ä»£</a></li>
<li><a href="../zh-CN500520/index.html">å¦‚ä½•ä½¿æ‚¨çš„åº”ç”¨ç¨‹åºåœ¨ä¸–ç•ŒèŒƒå›´å†…ä½¿ç”¨ï¼šCEO Wachangaçš„10æ¡æç¤º</a></li>
<li><a href="../zh-CN500528/index.html">å…³äºæ²¡æœ‰å®è·µ/å®é™…çš„â€œå®è·µâ€ /â€œå®è·µâ€çš„ç¿»è¯‘</a></li>
<li><a href="../zh-CN500530/index.html">ç”»å¸ƒAPIå¤‡æ³¨</a></li>
<li><a href="../zh-CN500538/index.html">æ’­å®¢Rusbaseï¼ŒMedusaå’ŒKinoPoisk</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>