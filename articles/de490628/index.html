<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔍 🧔 🚇 Was tun, wenn CSS das Parsen von Seiten blockiert? 👎🏽 🥇 ♻️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kürzlich habe ich eine Prüfung eines Standorts durchgeführt und preload/polyfillbin auf ein Muster gestoßen , das ich bereits bei mehreren Kunden gese...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Was tun, wenn CSS das Parsen von Seiten blockiert?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/490628/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kürzlich habe ich eine Prüfung eines Standorts durchgeführt und </font></font><code>preload/polyfill</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bin </font><font style="vertical-align: inherit;">auf ein Muster gestoßen </font><font style="vertical-align: inherit;">, das ich bereits bei mehreren Kunden gesehen habe. </font><font style="vertical-align: inherit;">Die Verwendung dieses zuvor beliebten Musters wird heute nicht empfohlen. </font><font style="vertical-align: inherit;">Es ist jedoch nützlich, dies zu berücksichtigen, um die Bedeutung einer sorgfältigen Verwendung des Mechanismus zum Vorladen von Materialien durch Webbrowser zu veranschaulichen. </font><font style="vertical-align: inherit;">Es ist auch interessant, weil Sie damit ein reales Beispiel dafür zeigen können, wie sich die Reihenfolge der Elemente in einem Dokument auf die Leistung auswirken kann (dies wird in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diesem</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wunderbaren Artikel von Harry Roberts behandelt). </font><font style="vertical-align: inherit;">
Das Material, dessen Übersetzung wir heute veröffentlichen, widmet sich der Analyse von Situationen, in denen ein unsachgemäßer und vorzeitiger Umgang mit CSS-Ressourcen die Leistung von Webseiten beeinträchtigt.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/j9/ku/dh/j9kudhouixuhlvhywk7misjih8w.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Über loadCSS</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich bin ein großer Fan der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Filament Group</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - sie veröffentlichen unglaublich viele großartige Projekte. Darüber hinaus erstellen sie ständig unschätzbare Tools und teilen diese, um das Web zu verbessern. Eines dieser Tools ist </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">loadCSS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , das lange Zeit </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">genau</font></a><font style="vertical-align: inherit;"> das Tool war, das ich jedem zum Laden unkritischer CSS-Ressourcen empfohlen habe. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obwohl sich dies jetzt geändert hat (und die Filament Group einen ausgezeichneten </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artikel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> darüber veröffentlicht hat, was ihre Mitarbeiter heutzutage bevorzugen), sehe ich bei der Prüfung von Websites häufig, wie sie </font></font><code>loadCSS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diese in der Produktion verwenden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eines der Muster, auf die ich gestoßen bin, ist das Muster</font></font><code>preload/polyfill</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Bei diesem Ansatz werden alle Dateien mit Stilen im Preload-Modus geladen (das Attribut der </font></font><code>rel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entsprechenden Links wird auf gesetzt </font></font><code>preload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font><font style="vertical-align: inherit;">Wenden Sie danach, wenn sie einsatzbereit sind, ihre Ereignisse </font></font><code>onload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">an, um sie mit der Seite zu verbinden.</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;link rel=<span class="hljs-string">"preload"</span> href=<span class="hljs-string">"path/to/mystylesheet.css"</span> <span class="hljs-keyword">as</span>=<span class="hljs-string">"style"</span> onload=<span class="hljs-string">"this.rel='stylesheet'"</span>&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">noscript</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"path/to/mystylesheet.css"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">noscript</span>&gt;</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da nicht alle Browser das Design unterstützen, </font></font><code>&lt;a href="https://caniuse.com/#feat=link-rel-preload"&gt;&lt;link rel="preload"&gt;&lt;/a&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bietet das Projekt </font></font><code>loadCSS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entwicklern eine praktische Polyfüllung, die der Seite nach der Beschreibung der relevanten Links hinzugefügt wird:</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;link rel=<span class="hljs-string">"preload"</span> href=<span class="hljs-string">"path/to/mystylesheet.css"</span> <span class="hljs-keyword">as</span>=<span class="hljs-string">"style"</span> onload=<span class="hljs-string">"this.rel='stylesheet'"</span>&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">noscript</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"path/to/mystylesheet.css"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">noscript</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-comment">/*! loadCSS rel=preload polyfill. [c]2017 Filament Group, Inc. MIT License */</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{ ... }());
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span></code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Störung der Netzwerkprioritäten</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich war noch nie ein begeisterter Fan dieses Musters. </font><font style="vertical-align: inherit;">Das Vorladen ist ein unhöfliches Werkzeug. </font><font style="vertical-align: inherit;">Materialien, die über Attributlinks heruntergeladen wurden, </font></font><code>rel="preload"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kämpfen erfolgreich mit anderen Materialien um Netzwerkressourcen. </font><font style="vertical-align: inherit;">Bei der Verwendung wird </font></font><code>preload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">davon ausgegangen, dass Stylesheets, die asynchron geladen werden, weil sie bei der Ausgabe einer Seite keine entscheidende Rolle spielen, von Browsern eine sehr hohe Priorität erhalten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das folgende Bild aus WebPageTest zeigt dieses Problem sehr gut. </font><font style="vertical-align: inherit;">In den Zeilen 3-6 sehen Sie das asynchrone Laden von CSS-Dateien anhand eines Musters </font></font><code>preload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Obwohl Entwickler diese Dateien für nicht so wichtig halten, dass das Herunterladen das Rendern blockieren würde, sollten Sie sie verwenden</font></font><code>preload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bedeutet, dass sie geladen werden, bevor der Browser die verbleibenden Ressourcen erhält.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8f9/07f/75a/8f907f75ae91cafe98091b00c2e7750e.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSS-Dateien, die beim Laden das Preload-Muster verwenden, kommen früher als andere Ressourcen im Browser an, obwohl es sich nicht um Ressourcen handelt, die für das anfängliche Rendern einer Seite von entscheidender Bedeutung sind</font></font></font></i><br>
 <br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTML-Parser-Sperre</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die mit der Priorität des Ladens von Ressourcen verbundenen Probleme reichen bereits aus, um die Verwendung des Musters in den meisten Situationen zu vermeiden </font></font><code>preload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">In diesem Fall wird die Situation jedoch durch das Vorhandensein eines anderen Stylesheets verschärft, das auf die übliche Weise geladen wird.</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;link rel=<span class="hljs-string">"stylesheet"</span> href=<span class="hljs-string">"path/to/main.css"</span> /&gt;<font></font>
&lt;link rel="preload" href="path/to/mystylesheet.css" as="style" onload="this.rel='stylesheet'"&gt;<font></font>
&lt;noscript&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;link rel="stylesheet" href="path/to/mystylesheet.css"&gt;<font></font>
&lt;/noscript&gt;<font></font>
&lt;script&gt;<font></font>
/*! loadCSS rel=preload polyfill. [c]2017 Filament Group, Inc. MIT License */<font></font>
(function(){ ... }());<font></font>
&lt;/script&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt die gleichen Probleme bei der Verwendung </font></font><code>preload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die dazu führen, dass nicht die wichtigsten Dateien eine hohe Priorität erhalten. Genauso wichtig und vielleicht weniger offensichtlich ist jedoch, welche Auswirkungen dies auf die Fähigkeit des Browsers hat, die Seite zu analysieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auch hier hat dies bereits </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">geschrieben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im Detail </font><font style="vertical-align: inherit;">, so empfehle ich, besser zu </font><font style="vertical-align: inherit;">verstehen , </font><font style="vertical-align: inherit;">dass das </font><font style="vertical-align: inherit;">Material , </font><font style="vertical-align: inherit;">um zu </font><font style="vertical-align: inherit;">lesen , </font><font style="vertical-align: inherit;">was geschieht. Hier werde ich kurz darauf eingehen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Regel blockiert das Laden von Stilen das Rendern von Seiten. Der Browser muss Stile abfragen und analysieren, um die Seite anzeigen zu können. Dies hindert den Browser jedoch nicht daran, den Rest des HTML-Codes zu analysieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skripte blockieren dagegen den Parser, wenn sie nicht als </font></font><code>defer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder </font><font style="vertical-align: inherit;">markiert sind </font></font><code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da der Browser davon ausgehen muss, dass das Skript entweder den Inhalt der Seite selbst oder die darauf angewendeten Stile manipuliert, muss er vorsichtig sein, wann dieses Skript ausgeführt wird. </font><font style="vertical-align: inherit;">Wenn der Browser weiß, dass CSS-Code geladen wird, wartet er auf das Eintreffen dieses CSS-Codes und führt anschließend das Skript aus. </font><font style="vertical-align: inherit;">Und da der Browser das Dokument erst dann weiter analysieren kann, wenn das Skript ausgeführt wird, bedeutet dies, dass die Stile nicht mehr nur das Rendern blockieren. </font><font style="vertical-align: inherit;">Sie verhindern, dass der Browser HTML analysiert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieses Verhalten gilt sowohl für externe als auch für in die Seite eingebettete Skripte. </font><font style="vertical-align: inherit;">Wenn CSS geladen wird, werden Inline-Skripte erst ausgeführt, wenn dieses CSS im Browser eintrifft.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Problemstudie</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der verständlichste Weg, um dieses Problem zu visualisieren, ist die Verwendung der Chrome-Entwicklertools (mir gefällt das Niveau, auf das diese Tools angewachsen sind). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unter den Chrome-Tools gibt es eine Registerkarte, </font></font><code>Performance</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit der Sie das Seitenladeprofil aufzeichnen können. Ich empfehle, die Netzwerkverbindung künstlich zu verlangsamen, damit sich das Problem besser manifestiert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Fall habe ich mit dem Fast 3G-Netzwerk-Setup getestet. Wenn Sie sich genau ansehen, was mit dem Hauptthread passiert, können Sie verstehen, dass die Anforderung zum Laden der CSS-Datei ganz am Anfang der HTML-Analyse erfolgt (ca. 1,7 Sekunden, nachdem die Seite geladen wurde).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/40b/881/a00/40b881a0060365bcbb5e4944b6784a2d.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein kleines Rechteck unter dem HTML-Analyseblock stellt eine Anforderung zum Empfangen einer CSS-Datei dar.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Während des nächsten Zeitraums, der ungefähr eine Sekunde beträgt, ist der Hauptthread inaktiv. </font><font style="vertical-align: inherit;">Hier sehen Sie kleine Aktivitätsinseln. </font><font style="vertical-align: inherit;">Dies ist ein Auslösen von Ereignissen, die den Abschluss des Ladens von Stilen anzeigen, und das Senden von Ressourcen anderer Anforderungen durch den Vorlademechanismus. </font><font style="vertical-align: inherit;">Der Browser hört jedoch vollständig auf, HTML zu analysieren.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/059/fca/6f1/059fca6f1820ca9a3b841140ab912d4e.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie sich das Gesamtbild ansehen, stellt sich heraus, dass der Hauptthread nach dem Start des CSS-Ladevorgangs länger als 1,1 Sekunden inaktiv ist. Nach</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
2,8 Sekunden wird der Stil geladen und vom Browser verarbeitet. </font><font style="vertical-align: inherit;">Erst dann sehen wir die Verarbeitung des eingebauten Skripts, und danach kehrt der Browser schließlich zur HTML-Analyse zurück.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/65a/a96/da2/65aa96da21d2e1ac6db4116ad54a8f80.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSS kommt in ungefähr 2,8 Sekunden an. Danach sehen wir, dass der Browser weiterhin HTML analysiert</font></font></font></i><br>
 <br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firefox ist eine schöne Ausnahme</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das obige Verhalten ist für Chrome, Edge und Safari üblich. </font><font style="vertical-align: inherit;">Firefox ist eine schöne Ausnahme von der Liste der beliebtesten Browser. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alle anderen Browser unterbrechen die HTML-Analyse, verwenden jedoch einen proaktiven Parser (ein Mittel zum Vorladen von Materialien), um den Code für Links zu externen Ressourcen anzuzeigen und Anforderungen zum Laden dieser Ressourcen zu erfüllen. </font><font style="vertical-align: inherit;">Firefox geht jedoch noch </font><font style="vertical-align: inherit;">einen Schritt weiter in dieser Angelegenheit: es spekulativ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">baut</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> einen DOM - </font><font style="vertical-align: inherit;">Baum, auch wenn es das Skript erwartet auszuführen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sofern das Skript das DOM nicht manipuliert, was dazu führt, dass die Ergebnisse der spekulativen Analyse verworfen werden müssen, kann Firefox diesen Ansatz nutzen. Wenn der Browser den spekulativ erstellten DOM-Baum löschen muss, bedeutet dies natürlich, dass er beim Erstellen dieses Baums nichts Nützliches getan hat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist ein interessanter Ansatz. Ich war furchtbar neugierig zu wissen, wie effektiv es ist. Jetzt gibt es jedoch keine Informationen dazu im Firefox Performance Profiler. Dort können Sie nicht herausfinden, ob der spekulative Parser funktioniert hat, ob die von ihm geleistete Arbeit wiederholt werden muss und ob sich dies noch auf die Leistung auswirkt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe mit denen gesprochen, die für die Firefox-Entwicklertools verantwortlich sind, und ich kann sagen, dass sie interessante Ideen haben, wie solche Informationen in Zukunft im Profiler dargestellt werden können. </font><font style="vertical-align: inherit;">Ich hoffe sie haben Erfolg.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lösung</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Fall des Clients, den ich ganz am Anfang erwähnte, sah der erste Schritt zur Lösung dieses Problems äußerst einfach aus: Entfernen Sie das Muster </font></font><code>preload/polyfill</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Das Vorladen von unkritischem CSS ist sinnlos. </font><font style="vertical-align: inherit;">Hier müssen Sie zur Verwendung </font></font><code>rel="preload"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eines Attributs </font><font style="vertical-align: inherit;">anstelle </font><font style="vertical-align: inherit;">eines Attributs </font><font style="vertical-align: inherit;">wechseln </font></font><code>media="print"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Genau das empfehlen die Experten der Filament Group. </font><font style="vertical-align: inherit;">Dieser Ansatz ermöglicht es Ihnen außerdem, die Polyfüllung vollständig zu entfernen.</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;link rel=<span class="hljs-string">"stylesheet"</span> href=<span class="hljs-string">"/path/to/my.css"</span> media=<span class="hljs-string">"print"</span> onload=<span class="hljs-string">"this.media='all'"</span>&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies bringt uns bereits in eine bessere Position: Jetzt sind die Netzwerkprioritäten viel besser auf die tatsächliche Bedeutung der Downloads abgestimmt. Und wir werden auch das eingebaute Skript los. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Fall befindet sich im Dokumentenkopf unterhalb der Zeile, die die Anforderung zum Laden von CSS initiiert, noch ein weiteres integriertes Skript. Wenn Sie dieses Skript so verschieben, dass es sich vor der Zeile befindet, in der das CSS geladen wird, wird die Parser-Sperre aufgehoben. Wenn Sie die Seite erneut mit den Chrome Developer Tools analysieren, ist der Unterschied völlig offensichtlich.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d16/c64/170/d16c64170a5ae365154626fc77eea21f.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bevor Änderungen am Seitencode vorgenommen wurden, hielt der HTML-Parser in Zeile 1939 an, nachdem er auf ein integriertes Skript gestoßen war, und blieb etwa eine Sekunde hier. Nach der Optimierung konnte er auf Zeile 5281 zugreifen.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Früher wurde der Parser in Zeile 1939 angehalten und auf das Laden von CSS gewartet. Jetzt erreicht er Zeile 5281. Dort befindet sich am Ende der Seite ein weiteres integriertes Skript, das den Parser erneut stoppt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist eine schnelle Lösung für das Problem. Dies ist nicht die Option, die die endgültige Lösung des Problems darstellt. Das Ändern der Reihenfolge der Elemente und das Entfernen des Musters</font></font><code>preload/polyfill</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ist nur der erste Schritt. Sie können dieses Problem am besten lösen, indem Sie kritischen CSS-Code in eine Seite einbetten, anstatt ihn aus einer externen Datei zu laden. Muster</font></font><code>preload/polyfill</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entwickelt, um zusätzlich zu Inline-CSS verwendet zu werden. </font><font style="vertical-align: inherit;">Auf diese Weise können wir die mit Skripten verbundenen Probleme vollständig ignorieren und sicherstellen, dass der Browser nach Ausführung der ersten Anforderung über alle zum Rendern der Seite erforderlichen Stile verfügt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Moment sollte jedoch beachtet werden, dass wir eine gute Leistungssteigerung erzielen können, indem wir sehr kleine Änderungen am Projekt in Bezug auf die Art und Weise, wie Stile geladen werden, und die Reihenfolge der Elemente im DOM vornehmen.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusammenfassung</font></font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie ein </font></font><code>loadCSS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Muster verwenden </font></font><code>preload/polyfill</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, wechseln </font><font style="vertical-align: inherit;">Sie zum </font><font style="vertical-align: inherit;">Muster </font><font style="vertical-align: inherit;">zum Laden von Stilen </font></font><code>print</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie externe Stile haben, die auf die übliche Weise geladen werden (dh reguläre Links zu Dateien dieser Stile verwenden), verschieben Sie alle integrierten Skripts, die über die Links verschoben werden können, um Stile zu laden.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Betten Sie kritische Stile in die Seite ein, um den schnellstmöglichen Start des Renderns zu gewährleisten.</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liebe Leser! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Haben Sie Probleme beim Verlangsamen des Renderns von Seiten aufgrund von CSS festgestellt? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RUVDS gratuliert allen IT-Profis am 8. März! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Jahr haben wir beschlossen, keine Tulpen zu verschenken und keine Auswahl an Geek-Geschenken zu treffen. </font><font style="vertical-align: inherit;">Wir sind einen anderen Weg gegangen und haben die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IT-Seite</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;">Frauen erstellt</font></b></a><font style="vertical-align: inherit;"> , um die Präsenz von IT-Spezialistinnen zu zeigen.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de490618/index.html">Goroutine-Stapelpuffer</a></li>
<li><a href="../de490620/index.html">Wenn ich die Worte "Wiederherstellung des neuronalen Netzwerks" höre, klettere ich, um Backups zu überprüfen</a></li>
<li><a href="../de490622/index.html">Bekämpfung von Speicherlecks in Webanwendungen</a></li>
<li><a href="../de490624/index.html">Funktionsrichtlinien-HTTP-Header- und Webbrowser-Steuerung</a></li>
<li><a href="../de490626/index.html">Eine vollständige Anleitung zu Daten- * HTML-Attributen</a></li>
<li><a href="../de490630/index.html">Laden von NumPy-Arrays von der Festplatte: Vergleich von memmap () und Zarr / HDF5</a></li>
<li><a href="../de490634/index.html">Digitale Veranstaltungen in Moskau vom 2. bis 8. März</a></li>
<li><a href="../de490636/index.html">Digitale Events in St. Petersburg vom 2. bis 8. März</a></li>
<li><a href="../de490640/index.html">Überladen in C ++. Teil III. Überladen neuer / Löschanweisungen</a></li>
<li><a href="../de490642/index.html">Plugin zur Überwachung von K8s-Anwendungen DevOpsProdigy KubeGraf v1.3.0: neue Version und neue Funktionen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>