<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïõ üë®üèº‚Äçüî¨ üç° Installing Firebird 3 on Modern Linux Versions: CentOS8 and Ubuntu 19 üèôÔ∏è ü§òüèΩ üíê</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article, we describe the minimum set of steps required to optimally install Firebird version 3.0 on new Linux distributions. For examples, Cen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Installing Firebird 3 on Modern Linux Versions: CentOS8 and Ubuntu 19</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/491094/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In this article, we describe the minimum set of steps required to optimally install Firebird version 3.0 on new Linux distributions. </font><font style="vertical-align: inherit;">For examples, CentOS 8 and Ubuntu 19 were selected. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For the "delivery" of the Firebird distribution to the target system, in this guide, the option to download the tar.gz archive from the link from the project‚Äôs official website ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">firebirdsql.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) was </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">selected</font></a><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For the most impatient - immediately into battle:</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quick installation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Edit the file </font></font><code>/etc/sysctl.conf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">by adding the line:</font></font><br>
<br>
<pre><code class="plaintext hljs">vm.max_map_count = 256000
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Save the file and apply the setting:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo sysctl -p /etc/sysctl.conf
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Further instructions differ for CentOS 8 and Ubuntu 19, but they </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">also </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indicate the link from the official Firebird project website for downloading the distribution package and the directory into which the distribution package will be unpacked during the boot process. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Currently (March 2020) Firebird 3.0.5 release is relevant ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here is a link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to the 64-bit version). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CentOS 8</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo yum -y install epel-release<font></font>
sudo yum -y makecache<font></font>
sudo yum -y install libicu libtommath tar<font></font>
ln -s libncurses.so.5 \<font></font>
/usr/lib64/libncurses.so.5<font></font>
ln -s libtommath.so.1 \<font></font>
/usr/lib64/libtommath.so.0<font></font>
curl -L |tar -zxC /tmp<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ubuntu 19</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo apt-get -y install libncurses5 libtommath1<font></font>
ln -s libtommath.so.1 \<font></font>
/usr/lib/x86_64-linux-gnu/libtommath.so.0<font></font>
wget -O- |tar -zxC /tmp<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Actually installing the Firebird DBMS:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd /tmp/<font></font>
sudo ./install.sh<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you want to better understand what these actions are for, read on. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Main part </font></font></strong><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Small preamble</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
It is assumed that the OS is already installed in the minimum version and access to public repositories or to their local copies is configured. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is assumed that the reader has basic knowledge of Linux and the Firebird DBMS. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Planning It is</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
recommended to allocate separate sections for temporary files ( </font></font><code>/tmp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), database files, and local backups </font><font style="vertical-align: inherit;">on the DBMS server </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Temporary include lock files, sort files, ‚Äúmaterialization‚Äù files of global temporary tables (GTTs) and monitoring tables. Sort files and global temporary tables are located in </font></font><code>/tmp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mon $ table files and lock files are located in </font></font><code>/tmp/firebird</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sort files are ‚Äúdeleted‚Äù ( </font></font><code>unlink</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) immediately after creation, therefore they cannot be ‚Äúseen‚Äù in the directory listing - only in the list of process handles (marked as </font></font><code>deleted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">):</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo ls -lhF /proc/`pgrep firebird`/fd
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the pseudo- </font></font><code>/proc/‚Ä¶/fd/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">directory listing, symlinks are displayed, and the actual information about the file is given by:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo stat -L /proc/`pgrep firebird`/fd/
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
where </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is the descriptor (descriptor) of the file of interest. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instead of calling " </font></font><code>pgrep -</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">", you can immediately substitute the identifier of the process of interest. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Temporary files can be very large, therefore it is </font></font><code>/tmp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recommended to allocate at least 20-30 GB for. Keep in mind that the size of sorting files depends only on the amount of data that is explicitly or implicitly sorted in the request and a single user can ‚Äúcreate‚Äù gigabytes of temporary files. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The section for database files should contain all database files. plus at least a copy of the largest database file. It should take into account the growth of database files in the future for several years in advance.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The local backups section must contain at least one backup archive of all the bases plus the backup of the largest base. </font><font style="vertical-align: inherit;">It is advisable that this section also has a place to restore the largest base. </font><font style="vertical-align: inherit;">It should take into account the growth of backups and backup archives in the future for several years ahead. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preliminary preparation</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Firebird 3.0 DBMS server dynamically allocates and frees up system memory, which can lead to fragmentation. </font><font style="vertical-align: inherit;">For example, after a large number of users disconnect from the super server at one time, errors may occur with new connections. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Memory fragmentation is controlled by the system parameter </font></font><code>vm.max_map_count</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, by default - 64K. </font><font style="vertical-align: inherit;">It is recommended to increase its value four times:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo sysctl vm.max_map_count=256000
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To set the new value when the system reboots, add the </font></font><code>/etc/sysctl.conf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">line </font><font style="vertical-align: inherit;">to the file </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">vm.max_map_count = 256000
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is advisable to make a comment so that the reason for changing this parameter is understood. You can first edit the file, and then apply the settings saved in it:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo sysctl -p /etc/sysctl.conf
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installing the required packages </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Firebird 3.0 Linux DBMS executables depend on the ncurses ( </font></font><code>libncurses.so.5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), ICU (no version bindings, and no output </font></font><code>ldd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) libraries and tommath ( </font></font><code>libtommath.so.0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">libraries </font><font style="vertical-align: inherit;">. To download and unpack the assembly archive, utilities are required </font></font><code>gzip</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>tar</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>curl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or </font></font><code>wget</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Version of the ICU, </font></font><code>gzip</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>tar</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>curl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ </font></font><code>wget</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- are insignificant. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Work with packages depends on the system and on the package manager used in the system, therefore, we will consider them one by one. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CentOS 8</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
CentOS 8 uses the new package manager - </font></font><code>dnf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and it is "transparently" called on command </font></font><code>yum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Since there is no difference between them for our purposes, there will be examples </font></font><code>yum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Updating the metadata cache:</font></font><code>sudo yum makecache</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The libtomath package is located in a separate E (xtra) P (ackages for) E (nterprise) L (inux) repositories, so we check that it is already connected:</font></font><br>
<br>
<pre><code class="plaintext hljs">yum -C repolist
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The "only from the cache" ( </font></font><code>-C</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or </font></font><code>--cache-only</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">option is </font><font style="vertical-align: inherit;">used to eliminate unnecessary checks and downloads, speeding up yum. </font><font style="vertical-align: inherit;">If there is no epel repository in the list, install it and update the metadata cache:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo yum install epel-release &amp;&amp;<font></font>
sudo yum makecache<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We confirm the requests, if necessary, checking the values ‚Äã‚Äãof pgp-keys with those already known from a trusted source. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you have problems downloading repository meta-information from https resources, then edit the file </font></font><code>/etc/yum.repos.d/epel.repo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, replacing it </font></font><code>https://</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with </font></font><code>http://</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and repeat the cache update command. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Check the status of the necessary packages (the command is folded, in the output example, the 32-bit package is filtered):</font></font><br>
<br>
<pre><code class="plaintext hljs">yum -C list \<font></font>
ncurses libicu libtommath \<font></font>
gzip tar curl wget |<font></font>
grep -v i686<font></font>
Installed Packages<font></font>
curl.x86_64 7.61.1-11.el8 @anaconda<font></font>
gzip.x86_64 1.9-9.el8 @anaconda<font></font>
ncurses.x86_64 6.1-7.20180224.el8 @anaconda<font></font>
Available Packages<font></font>
libicu.x86_64 60.3-1.el8 BaseOS<font></font>
libtommath.x86_64 1.1.0-1.el8 epel<font></font>
tar.x86_64 2:1.30-4.el8 BaseOS<font></font>
wget.x86_64 1.19.5-8.el8_1.1 AppStream<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We see that </font></font><code>curl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>gzip</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>ncurses</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">are located in the pseudo-repository of the installer ( </font></font><code>anaconda</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), and </font></font><code>tar</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- is excluded from the minimum installation of the system. </font><font style="vertical-align: inherit;">Major versions </font></font><code>libncurses</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>libtommath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">more than required: 6 and 1 instead of 5 and 0, respectively. </font><font style="vertical-align: inherit;">If the same package is installed and available, an update has been released for it. </font><font style="vertical-align: inherit;">Install the missing packages:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo yum install \<font></font>
libicu libtommath tar<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ubuntu 19 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Utilities are designed for package management </font></font><code>apt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>apt‚Äëget</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>apt‚Äëcache</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">The first is designed for interactive work, and the last two - for use in scripts. </font><font style="vertical-align: inherit;">Package names are slightly different and include a version. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We check the status of the necessary packages (the command is complex, the output example is reduced and 32-bit packets are filtered out):</font></font><br>
<br>
<pre><code class="plaintext hljs">apt list libncurses? libicu?? libtommath? \<font></font>
gzip tar curl wget |<font></font>
grep -v i386<font></font>
curl 7.65.3-1<font></font>
gzip 1.10-0 [upgradable‚Ä¶]<font></font>
libicu63 63.2-2 [installed]<font></font>
libncurses5 6.1<font></font>
libncurses6 6.1 [installed,automatic]<font></font>
libtommath1 1.1.0<font></font>
tar 1.30 [installed]<font></font>
wget 1.20.3 [installed]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Packages for which </font></font><code>installed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ </font></font><code>upgradable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- are installed </font><font style="vertical-align: inherit;">in square brackets </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Available, but not installed </font></font><code>ncurses5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, instead of </font></font><code>curl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">installed </font></font><code>wget</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Install the missing packages:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo apt‚Äëget install \<font></font>
libncurses5 libtommath1<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Creating symlinks </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since </font></font><code>libtommath.so.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">they are </font></font><code>libncurses.so.6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">backward compatible with </font></font><code>libtommath.so.0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>libncurses.so.5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, it is enough for Firebird to create symlinks to existing versions of libraries. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We find </font></font><code>libtommath.so.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><code>libncurses.so.?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">located in the same directory):</font></font><br>
<br>
<pre><code class="plaintext hljs">find /usr -name libtommath.so.1
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CentOS:</font></font><br>
<br>
<pre><code class="plaintext hljs">/usr/lib64/libtommath.so.1
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ubuntu:</font></font><br>
<br>
<pre><code class="plaintext hljs">/usr/lib/x86_64-linux-gnu/libtommath.so.1
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Create symlinks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CentOS:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo ln -s libtommath.so.1 \<font></font>
/usr/lib64/libtommath.so.0<font></font>
sudo ln -s libncurses.so.6 \<font></font>
/usr/lib64/libncurses.so.5<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ubuntu:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo ln -s libtommath.so.1 \<font></font>
/usr/lib/x86_64-linux-gnu/libtommath.so.0<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Check the result (the command is folded, output examples are shortened):</font></font><br>
<br>
<pre><code class="plaintext hljs">ls -lhF \<font></font>
$(dirname `find /usr -name libtommath.so.1`) |<font></font>
grep "lib\(ncurses\|tommath\)\.so\."<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CentOS:</font></font><br>
<br>
<pre><code class="plaintext hljs">libncurses.so.5 -&gt; libncurses.so.6*<font></font>
libncurses.so.6 -&gt; libncurses.so.6.1*<font></font>
libncurses.so.6.1*<font></font>
libtommath.so.0 -&gt; libtommath.so.1*<font></font>
libtommath.so.1 -&gt; libtommath.so.1.1.0*<font></font>
libtommath.so.1.1.0*<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ubuntu:</font></font><br>
<br>
<pre><code class="plaintext hljs">libncurses.so.5 -&gt; libncurses.so.5.9<font></font>
libncurses.so.5.9<font></font>
libncurses.so.6 -&gt; libncurses.so.6.1<font></font>
libncurses.so.6.1<font></font>
libtommath.so.0 -&gt; libtommath.so.1<font></font>
libtommath.so.1 -&gt; libtommath.so.1.1.0<font></font>
libtommath.so.1.1.0<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Downloading the Firebird DBMS distribution kit. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The official website of the Firebird project (firebirdsql.org) publishes links to distributions of the ‚Äúofficial‚Äù releases (releases) and ‚Äúdaily‚Äù assemblies (snapshot build). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Official Linux releases are available as archives (tar.gz) and deb / rpm packages, and builds are available as archives only. </font><font style="vertical-align: inherit;">We will look at the ‚Äúgeneric installer‚Äù (generic installer from tar.gz). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The assembly archive needs to be downloaded and unpacked, but we will combine both of these processes. </font><font style="vertical-align: inherit;">Unpacking is done in </font></font><code>/tmp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, the URL indicates a link to the downloadable archive. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
curl:</font></font><br>
<br>
<pre><code class="plaintext hljs">curl -L URL | tar -zxC /tmp
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
wget:</font></font><br>
<br>
<pre><code class="plaintext hljs">wget -O‚Äì URL | tar -zxC /tmp
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By default, it </font></font><code>curl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sends the loaded data to standard output, but does not handle redirects and we add " </font></font><code>‚ÄëL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">", but </font></font><code>wget</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, on the contrary: it processes redirects, but writes data to a file and we put " </font></font><code>‚ÄëO‚Äë</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">". For </font></font><code>tar</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indicate the use of the </font></font><code>gzip</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filter and the directory into which the unpacking will be performed. Upon completion of the process will be kind of directory </font></font><code>Firebird‚Äë3.0.5.33220‚Äë0.amd64</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with three files: </font></font><code>install.sh</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>buildroot.tar.gz</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>manifest.txt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installing Firebird</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
During the preliminary preparation, we adjusted the value of the system parameter </font></font><code>vm.max_map_count</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, checked the availability and installed the ICU, ncurses and tommath libraries. We made sure that the versions of ncurses and tommath ( </font></font><code>libncures.so.5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>libtommath.so.0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) were </font><font style="vertical-align: inherit;">correct </font><font style="vertical-align: inherit;">and created the necessary symlinks.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Actually installation is very simple. </font><font style="vertical-align: inherit;">We go to the directory where the archive of the Firebird distribution kit was unpacked, check and, if necessary, set the ‚Äúexecutable‚Äù flag for the script </font></font><code>install.sh</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">chmod +x install.sh
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
run the installation script:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo ./install.sh
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
by pressing the Enter key we confirm the beginning of the installation, and upon receipt of the request - enter the sysdba password. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The installation script automatically launches a </font></font><code>systemd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unit </font></font><code>firebird-superserver</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(the default Firebird 3.0 architecture). </font><font style="vertical-align: inherit;">The Firebird service will work with the default parameters for the super server: a page cache of 2048 pages (per base), a sorting buffer of 64 MB (shared) and connecting only third-version clients. </font><font style="vertical-align: inherit;">View options </font></font><code>firebird.conf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">grep -v ^# firebird.conf | grep -v ^$
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Please note that new values ‚Äã‚Äãfrom </font></font><code>firebird.conf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">will only be activated after the Firebird service is restarted. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When selecting parameter values, it should be taken into account that there are three main ‚Äúconsumers‚Äù: page cache (for the database), sorting buffer (shared), and memory allocated by the server for client connections. You can only manage the first two - the amount of memory for client connections depends on the number and text of cached requests, their plans, and the database objects involved in the requests. The memory evaluation of client connections is done only empirically and can change when client applications and / or database objects change. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For a super server on hosts with a small amount of memory (up to 12-16 GB), you should not allocate more than a third to a quarter of the total RAM for the page cache and sort buffer.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If the number of databases is not fixed and can change, the total memory of the page cache should be divided by the maximum number of databases that can be on the server. The size of the page cache is set in pages and it must be separately converted to bytes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To switch to the classic architecture, you must at least explicitly specify </font></font><code>ServerMode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in </font></font><code>firebird.conf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, reduce the page cache in the same place (no more than 2K), reduce the sort buffer (the total allowable amount of all sorts, divided by the maximum number of connections), disable and stop the unit </font></font><code>firebird-superserver</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, enable and run unit </font></font><code>firebird-classic.socket</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using the superclassics architecture in Firebird 3.0 does not make much sense: ‚Äúreliability‚Äù - like a superserver, has the same general sorting buffer. </font><font style="vertical-align: inherit;">There is no general page cache and the ‚Äúloss‚Äù to synchronize different connections between themselves is the same as that of a classic. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It should be remembered that in Firebird 3.0 some of the parameters (page cache, lock file sizes, hash tables, and some others) can be set </font></font><code>databases.conf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">individually for each database. </font><font style="vertical-align: inherit;">For a superserver it is useful, for example, to set a small value </font></font><code>DefaultDbCachePages</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in </font></font><code>firebird.conf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and set individual page caches to the necessary databases in </font></font><code>databases.conf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ask questions about the article in the comments, or write letters to our support address </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">support@ibase.ru.</font></font></b></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en491084/index.html">saneex.c: try / catch / finally based on setjmp / longjmp (C99) faster than standard C ++ exceptions ¬π</a></li>
<li><a href="../en491086/index.html">Webix JavaScript library through the eyes of a beginner. Part 6. Server interaction</a></li>
<li><a href="../en491088/index.html">GitHub: New Open Source Library for OSINT</a></li>
<li><a href="../en491090/index.html">Convert text documents to xml in C #</a></li>
<li><a href="../en491092/index.html">How Crash Bandicoot Hacked Playstation</a></li>
<li><a href="../en491100/index.html">On Wanhao 5S, they printed a doll with a height of a person</a></li>
<li><a href="../en491102/index.html">How to develop a service when there are tough competitors around</a></li>
<li><a href="../en491104/index.html">How I found a hardware glitch on my Lenovo MiiX 2 10 tablet</a></li>
<li><a href="../en491106/index.html">Why may you need semi-synchronous replication?</a></li>
<li><a href="../en491108/index.html">Organizing deployments to many k8s environments using helmfile</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>