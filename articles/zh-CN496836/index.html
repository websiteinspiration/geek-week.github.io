<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ’…ğŸ¾ ğŸ‘¨ğŸ½â€ğŸ¤â€ğŸ‘¨ğŸ¼ â° QSerializerï¼šç®€å•JSON / XMLåºåˆ—åŒ–çš„è§£å†³æ–¹æ¡ˆ ğŸ‘¨ğŸ½â€ğŸš’ ğŸ¤ğŸ¿ ğŸŒ´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å“ˆHaï¼
 
 æˆ‘ä»¥æŸç§æ–¹å¼è¯æ˜ç»“æœä¸å…¬å¹³-ä½¿ç”¨Javaï¼ŒCï¼ƒï¼ŒGoï¼ŒPythonç­‰ã€‚æœ‰ä¸€äº›åº“å¯ä»¥å°†å¯¹è±¡æ•°æ®èˆ’é€‚åœ°åºåˆ—åŒ–ä¸ºç°åœ¨æµè¡Œçš„JSONå’ŒXMLï¼Œä½†æ˜¯åœ¨C ++ä¸­ï¼Œå®ƒä»¬è¦ä¹ˆå¿˜è®°äº†ï¼Œè¦ä¹ˆä¸æƒ³è¦ï¼Œæˆ–è€…æ ¹æœ¬ä¸éœ€è¦å®ƒï¼Œæˆ–è€…å®ƒä»¬éƒ½å¾ˆå¤æ‚ï¼Œæˆ–è€…å¯èƒ½å…¨éƒ¨åœ¨ä¸€èµ·ã€‚å› æ­¤ï¼Œæˆ‘å†³å®šä¿®å¤æ­¤é—®é¢˜ã€‚
 
 æ‰€æœ‰ç»†èŠ‚ç…§å¸¸åˆ‡å‰²...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>QSerializerï¼šç®€å•JSON / XMLåºåˆ—åŒ–çš„è§£å†³æ–¹æ¡ˆ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/496836/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å“ˆHaï¼</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¥æŸç§æ–¹å¼è¯æ˜ç»“æœä¸å…¬å¹³-ä½¿ç”¨Javaï¼ŒCï¼ƒï¼ŒGoï¼ŒPythonç­‰ã€‚</font><font style="vertical-align: inherit;">æœ‰ä¸€äº›åº“å¯ä»¥å°†å¯¹è±¡æ•°æ®èˆ’é€‚åœ°åºåˆ—åŒ–ä¸ºç°åœ¨æµè¡Œçš„JSONå’ŒXMLï¼Œä½†æ˜¯åœ¨C ++ä¸­ï¼Œå®ƒä»¬è¦ä¹ˆå¿˜è®°äº†ï¼Œè¦ä¹ˆä¸æƒ³è¦ï¼Œæˆ–è€…æ ¹æœ¬ä¸éœ€è¦å®ƒï¼Œæˆ–è€…å®ƒä»¬éƒ½å¾ˆå¤æ‚ï¼Œæˆ–è€…å¯èƒ½å…¨éƒ¨åœ¨ä¸€èµ·ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œæˆ‘å†³å®šä¿®å¤æ­¤é—®é¢˜ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‰€æœ‰ç»†èŠ‚ç…§å¸¸åˆ‡å‰²ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j9/cp/vw/j9cpvwvjh9gfvhqxigysyx7m78c.png" alt="å›¾ç‰‡"><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">èƒŒæ™¯</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘å†æ¬¡å†³å®šæ‰¿æ‹…ä¸‹ä¸€ä¸ªå® ç‰©é¡¹ç›®ï¼Œå…¶å®è´¨æ˜¯å®¢æˆ·ç«¯-æœåŠ¡å™¨äº¤æ¢ï¼Œè€Œè®¸å¤šæœåŠ¡å™¨ä¸­æœ€å–œæ¬¢çš„æœåŠ¡å™¨æ˜¯RaspberryPiã€‚é™¤å…¶ä»–äº‹é¡¹å¤–ï¼Œæˆ‘å¯¹åˆ›å»ºâ€œä¿å­˜ç‚¹â€çš„é—®é¢˜å¾ˆæ„Ÿå…´è¶£-å› æ­¤ï¼Œæˆ‘å¯ä»¥åœ¨åŸå‹æ¡†æ¶å†…å°½å¯èƒ½ç®€å•åœ°ä¿å­˜å¯¹è±¡çŠ¶æ€ï¼Œç„¶åé€€å‡ºå¹¶åœ¨ä¸‹æ¬¡å¯åŠ¨æ—¶æ¢å¤ã€‚ç”±äºæˆ‘å¯¹Pythonä¸åˆç†çš„æ•Œå¯¹æ€åº¦ä»¥åŠå¯¹Qtçš„çƒ­æƒ…æ€åº¦ï¼Œæˆ‘é€‰æ‹©äº†Qtï¼†C ++ã€‚ç¼–å†™ç”¨äºè§£æJSONçš„ç±»å’Œæ„å¤§åˆ©é¢æ¡å‡½æ•°ä»ç„¶æ˜¯ä¸€ç§ä¹è¶£ï¼Œæˆ‘éœ€è¦ä¸€äº›é€šç”¨ä¸”åŒæ—¶æ˜“äºè§£å†³é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚ â€œæˆ‘ä»¬å¿…é¡»å¼„æ¸…æ¥šï¼Œâ€æˆ‘å‘Šè¯‰è‡ªå·±ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¦–å…ˆï¼Œå…³äºæ¡æ¬¾ï¼š</font></font><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åºåˆ—åŒ–æ˜¯å°†æ•°æ®ç»“æ„è½¬æ¢ä¸ºä½åºåˆ—çš„è¿‡ç¨‹ã€‚</font><font style="vertical-align: inherit;">åºåˆ—åŒ–æ“ä½œçš„åè¿‡ç¨‹æ˜¯ååºåˆ—åŒ–ï¼ˆç»“æ„åŒ–ï¼‰æ“ä½œ-ä»ä½åºåˆ—æ¢å¤æ•°æ®ç»“æ„çš„åˆå§‹çŠ¶æ€ã€‚</font></font><br>
</blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Goæœ‰ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„â€œæœ¬æœºâ€ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¼–ç / json</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŒ…</font><font style="vertical-align: inherit;">ï¼Œå®ƒå…è®¸ä½¿ç”¨Marshalæ–¹æ³•å¯¹å¯¹è±¡è¿›è¡Œå®Œæ•´çš„åºåˆ—åŒ–ï¼Œå¹¶ä½¿ç”¨Unmarshalè¿›è¡Œåå‘ç»“æ„åŒ–ï¼ˆç”±äºè¿™ä¸ªåº“ï¼Œæˆ‘å¯¹ç¼–ç»„çš„æ¦‚å¿µä¸€æ— æ‰€çŸ¥ï¼Œä½†</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desine sperare quihic intras</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ ã€‚</font><font style="vertical-align: inherit;">éµå¾ªè¯¥è½¯ä»¶åŒ…çš„æ¦‚å¿µï¼Œæˆ‘æ‰¾åˆ°äº†å¦ä¸€ä¸ªJavaçš„åº“</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-GSON</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œç»“æœè¯æ˜è¿™æ˜¯ä¸€ä¸ªéå¸¸ä»¤äººæ„‰æ‚¦çš„äº§å“ï¼Œä½¿ç”¨å®ƒæ˜¯ä¸€ç§ä¹è¶£ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘è€ƒè™‘äº†æˆ‘å¯¹è¿™äº›åº“çš„å–œæ¬¢ï¼Œå¹¶å¾—å‡ºç»“è®ºï¼Œè¿™å°±æ˜¯å®ƒä»¬çš„æ˜“ç”¨æ€§ã€‚çµæ´»çš„åŠŸèƒ½å’Œä¸€æ¬¡è°ƒç”¨ï¼Œå¯¹äºJSONåºåˆ—åŒ–æ¥è¯´ï¼Œè°ƒç”¨toJsonæ–¹æ³•å¹¶å°†å¯åºåˆ—åŒ–çš„å¯¹è±¡ä¼ é€’ç»™å®ƒå°±è¶³å¤Ÿäº†ã€‚ä½†æ˜¯ï¼Œå°±å…¶æœ¬èº«è€Œè¨€ï¼ŒC ++é»˜è®¤æƒ…å†µä¸‹ä¸å…·å¤‡é€‚å½“çš„å…ƒå¯¹è±¡åŠŸèƒ½ï¼Œä»¥æä¾›æœ‰å…³ç±»çš„å­—æ®µçš„è¶³å¤Ÿä¿¡æ¯ï¼Œä¾‹å¦‚åœ¨Javaï¼ˆClassName.classï¼‰ä¸­é‚£æ ·ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘åªå–œæ¬¢QTå¹³å°ä¸Šçš„</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QJson</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œä½†æ˜¯æˆ‘å¯¹ä¸Šè¿°åº“äº§ç”Ÿçš„æ˜“ç”¨æ€§çš„ç†è§£ä»ç„¶ä¸å¤ªåˆé€‚ã€‚å› æ­¤è¯¥é¡¹ç›®å‡ºç°äº†ï¼Œå°†åœ¨è¿™é‡Œè®¨è®ºã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°å…è´£å£°æ˜ï¼š</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™ç§æœºåˆ¶å°†æ— æ³•ä¸ºæ‚¨è§£å†³æ•°æ®è§£é‡Šçš„é—®é¢˜ã€‚</font><font style="vertical-align: inherit;">æ‚¨ä»å®ƒä»¬èº«ä¸Šæ‰€èƒ½è·å¾—çš„å°±æ˜¯å°†æ•°æ®è½¬æ¢ä¸ºæ›´æ–¹ä¾¿çš„å½¢å¼ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QSerializeré¡¹ç›®ç»“æ„</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯ä»¥åœ¨GitHubä¸ŠæŸ¥çœ‹é¡¹ç›®å’Œç¤ºä¾‹ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é“¾æ¥åˆ°å­˜å‚¨åº“</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚</font><font style="vertical-align: inherit;">æ­¤å¤„ä¹Ÿæä¾›äº†è¯¦ç»†çš„å®‰è£…è¯´æ˜ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¢„è®¡ä¼šå‘ç”Ÿå»ºç­‘è‡ªæ€ï¼Œæˆ‘å°†ä¿ç•™è¿™ä¸æ˜¯æœ€ç»ˆç‰ˆæœ¬ã€‚</font><font style="vertical-align: inherit;">å°½ç®¡é—å¼ƒäº†çŸ³å¤´ï¼Œä½†å·¥ä½œä»å°†ç»§ç»­è¿›è¡Œï¼Œä½†å·²å®ç°äº†æ„¿æœ›ã€‚</font></font><br>
<img src="https://habrastorage.org/webt/lg/rp/op/lgrpopckj4waexmewif_u2zngf4.png" alt="QSerializeråº“çš„ä¸€èˆ¬ç»“æ„ä¾èµ–æ€§"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¥é¡¹ç›®çš„ä¸»è¦ç›®æ ‡æ˜¯ä½¿ä½¿ç”¨C ++ä¸­ç”¨æˆ·å–œæ¬¢çš„æ•°æ®æ ¼å¼è¿›è¡Œåºåˆ—åŒ–å˜å¾—å¯è®¿é—®å’ŒåŸºæœ¬ã€‚</font><font style="vertical-align: inherit;">äº§å“è´¨é‡å¼€å‘å’Œç»´æŠ¤çš„å…³é”®æ˜¯å…¶ä½“ç³»ç»“æ„ã€‚</font><font style="vertical-align: inherit;">æˆ‘å¹¶ä¸æ’é™¤æœ¬æ–‡çš„è¯„è®ºä¸­å¯èƒ½ä¼šå‡ºç°å…¶ä»–å®ç°æ–¹å¼ï¼Œå› æ­¤æˆ‘ç•™äº†ä¸€ç‚¹â€œåˆ›é€ åŠ›â€ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæ›´æ”¹å®ç°ï¼Œåˆ™å¯ä»¥æ·»åŠ PropertyKeeperæ¥å£çš„æ–°å®ç°ï¼Œä¹Ÿå¯ä»¥æ›´æ”¹å·¥å‚æ–¹æ³•ï¼Œä»è€Œä¸å¿…åœ¨QSerializerå‡½æ•°ä¸­è¿›è¡Œä»»ä½•æ›´æ”¹ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç°åœºç”³æŠ¥</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨Qtä¸­æ”¶é›†å…ƒå¯¹è±¡ä¿¡æ¯çš„ä¸€ç§æ–¹æ³•æ˜¯åœ¨Qtæœ¬èº«çš„å…ƒå¯¹è±¡ç³»ç»Ÿä¸­å¯¹å…¶è¿›è¡Œæè¿°ã€‚</font><font style="vertical-align: inherit;">ä¹Ÿè®¸è¿™æ˜¯æœ€ç®€å•çš„æ–¹æ³•ã€‚</font></font><abbr title="å…ƒå¯¹è±¡ç¼–è¯‘å™¨"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MOCå°†</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨ç¼–è¯‘æ—¶ç”Ÿæˆæ‰€æœ‰å¿…è¦çš„å…ƒæ•°æ®ã€‚</font><font style="vertical-align: inherit;">æ‚¨å¯ä»¥åœ¨æè¿°çš„å¯¹è±¡ä¸Šè°ƒç”¨metaObjectæ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†è¿”å›æˆ‘ä»¬å¿…é¡»ä½¿ç”¨çš„QMetaObjectç±»çš„å®ä¾‹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦å£°æ˜è¦åºåˆ—åŒ–çš„å­—æ®µï¼Œæ‚¨éœ€è¦ä»QObjectç»§æ‰¿è¯¥ç±»ï¼Œå¹¶åœ¨å…¶ä¸­åŒ…å«</font></font><font color="#FF1493"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q_OBJECT</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®</font><font style="vertical-align: inherit;">ï¼Œä»¥ä¾¿å‘MOCæ˜ç¡®è¯´æ˜å°†ç±»ç±»å‹é™å®šä¸ºQObjectçš„åŸºç±»ã€‚</font><font color="#FF1493"><font style="vertical-align: inherit;">Q_PROPERTY</font></font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
å®</font><font style="vertical-align: inherit;">æè¿°äº†è¯¥ç±»çš„æˆå‘˜ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å°†è°ƒç”¨</font><font color="#FF1493"><font style="vertical-align: inherit;">Q_PROPERTYä¸­</font></font><font style="vertical-align: inherit;">æè¿°çš„</font><font style="vertical-align: inherit;">propertyå±æ€§ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæ²¡æœ‰å°†USERæ ‡å¿—è®¾ç½®ä¸ºtrueï¼ŒQSerializerå°†å¿½ç•¥å±æ€§ã€‚</font></font><font color="#FF1493"><font style="vertical-align: inherit;"></font></font><font style="vertical-align: inherit;"></font><font color="#FF1493"><font style="vertical-align: inherit;"></font></font><font style="vertical-align: inherit;"></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºä»€ä¹ˆUSERæ ‡è®°</font></font></b>
                        <div class="spoiler_text">     , ,  QML.        . ,   <font color="#FF1493">Q_PROPERTY</font>  QML   QSerializer     .<br>
</div>
                    </div><br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> :</span> <span class="hljs-keyword">public</span> QObject<font></font>
{<font></font>
Q_OBJECT<font></font>
<span class="hljs-comment">// Define data members to be serialized</span>
Q_PROPERTY(QString name MEMBER name USER <span class="hljs-literal">true</span>)<font></font>
Q_PROPERTY(<span class="hljs-keyword">int</span> age MEMBER age USER <span class="hljs-literal">true</span>)<font></font>
Q_PROPERTY(QString email MEMBER email USER <span class="hljs-literal">true</span>)<font></font>
Q_PROPERTY(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;QString&gt; phone MEMBER phone USER <span class="hljs-literal">true</span>)<font></font>
Q_PROPERTY(<span class="hljs-keyword">bool</span> vacation MEMBER vacation USER <span class="hljs-literal">true</span>)
<span class="hljs-keyword">public</span>:
  <span class="hljs-comment">// Make base constructor</span><font></font>
  User() { }<font></font>
 <font></font>
  QString name;<font></font>
  <span class="hljs-keyword">int</span> age{<span class="hljs-number">0</span>};<font></font>
  QString email;<font></font>
  <span class="hljs-keyword">bool</span> vacation{<span class="hljs-literal">false</span>};
  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;QString&gt; phone; <font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦åœ¨Qtå…ƒå¯¹è±¡ç³»ç»Ÿä¸­å£°æ˜éæ ‡å‡†ç”¨æˆ·ç±»å‹ï¼Œæˆ‘å»ºè®®ä½¿ç”¨</font></font><font color="#FF1493"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QS_REGISTER</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®</font><font style="vertical-align: inherit;">ï¼Œè¯¥</font><font style="vertical-align: inherit;">å®</font><font style="vertical-align: inherit;">åœ¨qserializer.hä¸­å®šä¹‰ã€‚</font></font><font color="#FF1493"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QS_REGISTER</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿æ³¨å†Œç±»å‹å˜é‡çš„è¿‡ç¨‹è‡ªåŠ¨åŒ–ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œå¯ä»¥ä½¿ç”¨ç»å…¸çš„æ–¹æ³•é€šè¿‡qRegisterMetaType &lt; </font></font><font color="#FF1493"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt;ï¼ˆï¼‰</font><font style="vertical-align: inherit;">æ³¨å†Œç±»å‹</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å¯¹äºå…ƒå¯¹è±¡ç³»ç»Ÿï¼Œç±»ç±»å‹ï¼ˆ</font></font><font color="#FF1493"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰å’Œç±»æŒ‡é’ˆï¼ˆ</font></font><font color="#FF1493"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> *ï¼‰æ˜¯å®Œå…¨ä¸åŒçš„ç±»å‹ï¼›å®ƒä»¬åœ¨å¸¸è§„ç±»å‹åˆ—è¡¨ä¸­å°†å…·æœ‰ä¸åŒçš„æ ‡è¯†ç¬¦ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> QS_METATYPE(Type) qRegisterMetaType<span class="hljs-meta-string">&lt;Type&gt;(#Type) ;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> QS_REGISTER(Type)       \
QS_METATYPE(Type)               \
QS_METATYPE(Type*)              \
QS_METATYPE(std::vector<span class="hljs-meta-string">&lt;Type*&gt;) \</span></span>
QS_METATYPE(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;Type&gt;)  \
</code></pre><br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span>;</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
<span class="hljs-comment">// define user-type in Qt meta-object system</span><font></font>
QS_REGISTER(User)<font></font>
...<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QSerializerå‘½åç©ºé—´</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»UMLå›¾è¡¨ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒQSerializeråŒ…å«è®¸å¤šç”¨äºåºåˆ—åŒ–å’Œç»“æ„åŒ–çš„åŠŸèƒ½ã€‚</font><font style="vertical-align: inherit;">åç§°ç©ºé—´ä»æ¦‚å¿µä¸Šåæ˜ äº†QSerializerçš„å£°æ˜æœ¬è´¨ã€‚</font><font style="vertical-align: inherit;">å¯ä»¥é€šè¿‡QSerializerçš„åç§°è®¿é—®åµŒå…¥å¼åŠŸèƒ½ï¼Œè€Œæ— éœ€åœ¨ä»£ç ä¸­çš„ä»»ä½•ä½ç½®åˆ›å»ºå¯¹è±¡ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½¿ç”¨åŸºäºä¸Šè¿°Userç±»çš„å¯¹è±¡æ„å»ºJSONçš„ç¤ºä¾‹ï¼Œæ‚¨ä»…éœ€è¦è°ƒç”¨QSerializer :: toJsonæ–¹æ³•ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">User u;<font></font>
u.name = <span class="hljs-string">"Mike"</span>;<font></font>
u.age = <span class="hljs-number">25</span>;<font></font>
u.email = <span class="hljs-string">"example@exmail.com"</span>;<font></font>
u.phone.push_back(<span class="hljs-string">"+12345678989"</span>);<font></font>
u.phone.push_back(<span class="hljs-string">"+98765432121"</span>);<font></font>
u.vacation = <span class="hljs-literal">true</span>;<font></font>
QJsonObject json = QSerializer::toJson(&amp;u);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™æ˜¯ç”Ÿæˆçš„JSONï¼š</font></font><br>
<br>
<pre><code class="json hljs">{
    <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Mike"</span>,
    <span class="hljs-attr">"age"</span>: <span class="hljs-number">25</span>,
    <span class="hljs-attr">"email"</span>: <span class="hljs-string">"example@exmail.com"</span>,
    <span class="hljs-attr">"phone"</span>: [
        <span class="hljs-string">"+12345678989"</span>,
        <span class="hljs-string">"+98765432121"</span><font></font>
    ],<font></font>
    <span class="hljs-attr">"vacation"</span>: <span class="hljs-literal">true</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ‰ä¸¤ç§æ„é€ å¯¹è±¡çš„æ–¹æ³•ï¼š</font></font><br>
<br>
<ul>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœéœ€è¦ä¿®æ”¹å¯¹è±¡</font></font></b>
                        <div class="spoiler_text"><pre><code class="cpp hljs">User u;<font></font>
QJsonObject userJson;<font></font>
QSerializer::fromJson(&amp;u, userJson);</code></pre></div>
                    </div></li>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœæ‚¨éœ€è¦è·å–æ–°å¯¹è±¡</font></font></b>
                        <div class="spoiler_text"><pre><code class="cpp hljs">QJsonObject userJson;<font></font>
User * u = QSerializer::fromJson&lt;User&gt;(userJson);</code></pre></div>
                    </div></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">example</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–‡ä»¶å¤¹ä¸­å¯ä»¥çœ‹åˆ°æ›´å¤šç¤ºä¾‹å’Œè¾“å‡º</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®ˆæŠ¤è€…</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†ç»„ç»‡æ–¹ä¾¿çš„å†™å…¥å’Œè¯»å–å·²å£°æ˜çš„å±æ€§ï¼ŒQSerializerä½¿ç”¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keepers</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»</font><font style="vertical-align: inherit;">ï¼Œæ¯ä¸ª</font><font style="vertical-align: inherit;">ç±»</font><font style="vertical-align: inherit;">éƒ½å­˜å‚¨ä¸€ä¸ªæŒ‡å‘å¯¹è±¡ï¼ˆQObjectåä»£ï¼‰çš„æŒ‡é’ˆåŠå…¶QMetaPropertyä¹‹ä¸€ã€‚</font><font style="vertical-align: inherit;">QMetaPropertyæœ¬èº«æ²¡æœ‰ç‰¹åˆ«çš„ä»·å€¼ï¼Œå®é™…ä¸Šï¼Œå®ƒåªæ˜¯ä¸ºMOCå£°æ˜çš„å…·æœ‰æè¿°å±æ€§ç±»çš„å¯¹è±¡ã€‚</font><font style="vertical-align: inherit;">è¦è¿›è¡Œè¯»å†™ï¼Œæ‚¨éœ€è¦ä¸€ä¸ªæè¿°è¯¥å±æ€§çš„ç±»çš„ç‰¹å®šå¯¹è±¡-è¿™æ˜¯è¦è®°ä½çš„ä¸»è¦å†…å®¹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åºåˆ—åŒ–è¿‡ç¨‹ä¸­çš„æ¯ä¸ªå¯åºåˆ—åŒ–å­—æ®µéƒ½ä¼ é€’ç»™ç›¸åº”ç±»å‹çš„ä¿ç®¡äººã€‚</font><font style="vertical-align: inherit;">éœ€è¦Keeperå°è£…åºåˆ—åŒ–å’Œç»“æ„åŒ–åŠŸèƒ½ï¼Œä»¥å®ç°é’ˆå¯¹ç‰¹å®šç±»å‹æè¿°æ•°æ®çš„ç‰¹å®šå®ç°ã€‚</font><font style="vertical-align: inherit;">æˆ‘é‡ç‚¹ä»‹ç»äº†4ç§ç±»å‹ï¼š</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QMetaSimpleKeeper-å…·æœ‰åŸå§‹æ•°æ®ç±»å‹çš„å±æ€§å®ˆæŠ¤è€…</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QMetaArrayKeeper-å…·æœ‰åŸå§‹æ•°æ®æ•°ç»„çš„å±æ€§å®ˆå«</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QMetaObjectKeeper-åµŒå¥—å¯¹è±¡çš„å®ˆæŠ¤è€…</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QMetaObjectArrayKeeper-åµŒå¥—å¯¹è±¡æ•°ç»„çš„å®ˆæŠ¤è€… </font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/dw/ao/0d/dwao0de8yeaqdcdb5zfkbuoof-k.png" alt="æ•°æ®æµ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åŸå§‹æ•°æ®ä¿ç®¡äººçš„æ ¸å¿ƒæ˜¯ä¿¡æ¯ä»JSON / XMLåˆ°QVariantçš„è½¬æ¢ï¼Œåä¹‹äº¦ç„¶ï¼Œå› ä¸ºQMetaPropertyé»˜è®¤æƒ…å†µä¸‹ä¸QVariantä¸€èµ·ä½¿ç”¨ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">QMetaProperty prop;<font></font>
QObject * linkedObj;<font></font>
...<font></font>
<span class="hljs-function"><span class="hljs-built_in">std</span>::pair&lt;QString, QJsonValue&gt; <span class="hljs-title">QMetaSimpleKeeper::toJson</span><span class="hljs-params">()</span>
</span>{<font></font>
    QJsonValue result = QJsonValue::fromVariant(prop.read(linkedObj));<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">std</span>::make_pair(QString(prop.name()), result);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">QMetaSimpleKeeper::fromJson</span><span class="hljs-params">(<span class="hljs-keyword">const</span> QJsonValue &amp;val)</span>
</span>{<font></font>
    prop.write(linkedObj, QVariant(val));<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯¹è±¡ä¿æŒå™¨åŸºäºä»JSON / XMLåˆ°ä¸€ç³»åˆ—å…¶ä»–ä¿æŒå™¨çš„ä¿¡æ¯ä¼ è¾“ï¼Œåä¹‹äº¦ç„¶ã€‚</font><font style="vertical-align: inherit;">è¿™æ ·çš„ä¿ç®¡äººå°†å…¶å±æ€§ä½œä¸ºå•ç‹¬çš„å¯¹è±¡æ¥å·¥ä½œï¼Œä¹Ÿå¯ä»¥æœ‰è‡ªå·±çš„ä¿ç®¡äººï¼Œå…¶ä»»åŠ¡æ˜¯ä»å±æ€§å¯¹è±¡ä¸­æ”¶é›†åºåˆ—åŒ–çš„æ•°æ®ï¼Œå¹¶æ ¹æ®å¯ç”¨æ•°æ®æ¥æ„é€ å±æ€§å¯¹è±¡ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">QMetaProperty prop;<font></font>
QObject * linkedObj;<font></font>
...<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">QMetaObjectKeeper::fromJson</span><span class="hljs-params">(<span class="hljs-keyword">const</span> QJsonValue &amp;json)</span>
</span>{<font></font>
    ...<font></font>
    QSerializer::fromJson(linkedObj, json.toObject());<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-built_in">std</span>::pair&lt;QString, QJsonValue&gt; <span class="hljs-title">QMetaObjectKeeper::toJson</span><span class="hljs-params">()</span>
</span>{<font></font>
    QJsonObject result = QSerializer::toJson(linkedObj);;<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">std</span>::make_pair(prop.name(),QJsonValue(result));<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Keeperå®ç°PropertyKeeperæ¥å£ï¼Œä»è¯¥æ¥å£ç»§æ‰¿Keeperçš„åŸºæœ¬æŠ½è±¡ç±»ã€‚</font><font style="vertical-align: inherit;">è¿™ä½¿æ‚¨å¯ä»¥ä»ä¸Šåˆ°ä¸‹ä¾æ¬¡è§£æå’Œç¼–å†™XMLæˆ–JSONæ ¼å¼çš„æ–‡æ¡£ï¼Œåªéœ€å‘ä¸‹æµè§ˆæ‰€æè¿°çš„å­˜å‚¨å±æ€§ï¼Œå¹¶åœ¨è¿›å…¥æ‰€æè¿°çš„å±æ€§ä¸­çš„åµŒå…¥å¼å¯¹è±¡ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰æ—¶å°±æ›´æ·±å…¥ï¼Œè€Œæ— éœ€æ·±å…¥äº†è§£å®ç°çš„ç»†èŠ‚ã€‚</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PropertyKeeperç•Œé¢</font></font></b>
                        <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PropertyKeeper</span>
{</span>
<span class="hljs-keyword">public</span>:
    <span class="hljs-keyword">virtual</span> ~PropertyKeeper() = <span class="hljs-keyword">default</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-built_in">std</span>::pair&lt;QString, QJsonValue&gt; <span class="hljs-title">toJson</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">fromJson</span><span class="hljs-params">(<span class="hljs-keyword">const</span> QJsonValue&amp;)</span> </span>= <span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-built_in">std</span>::pair&lt;QString, QDomNode&gt; <span class="hljs-title">toXml</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">fromXml</span><span class="hljs-params">(<span class="hljs-keyword">const</span> QDomNode &amp;)</span> </span>= <span class="hljs-number">0</span>;<font></font>
};<font></font>
</code></pre></div>
                    </div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®ˆæŠ¤å·¥å‚</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç”±äºæ‰€æœ‰ä¿ç®¡äººéƒ½å®ç°ä¸€ä¸ªæ¥å£ï¼Œå› æ­¤æ‰€æœ‰å®ç°éƒ½éšè—åœ¨æ–¹ä¾¿çš„å±å¹•åé¢ï¼Œè€ŒKeepersFactoryå·¥å‚æä¾›äº†è¿™äº›å®ç°ä¸­çš„ä¸€ç»„ã€‚</font><font style="vertical-align: inherit;">ä»è½¬ç§»åˆ°å·¥å‚çš„å¯¹è±¡ä¸­ï¼Œæ‚¨å¯ä»¥é€šè¿‡å…¶QMetaObjectè·å–æ‰€æœ‰å·²å£°æ˜å±æ€§çš„åˆ—è¡¨ï¼Œå¹¶ä»¥æ­¤ä¸ºåŸºç¡€ç¡®å®šä¿ç®¡äººçš„ç±»å‹ã€‚</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KeepersFactoryå·¥å‚å®æ–½</font></font></b>
                        <div class="spoiler_text"><pre><code class="cpp hljs">    <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-keyword">simple_t</span> =<font></font>
    {<font></font>
        qMetaTypeId&lt;<span class="hljs-keyword">int</span>&gt;(),<font></font>
        qMetaTypeId&lt;<span class="hljs-keyword">bool</span>&gt;(),<font></font>
        qMetaTypeId&lt;<span class="hljs-keyword">double</span>&gt;(),<font></font>
        qMetaTypeId&lt;QString&gt;(),<font></font>
    };<font></font>
<font></font>
    <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-keyword">array_of_simple_t</span> =<font></font>
    {<font></font>
        qMetaTypeId&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&gt;(),<font></font>
        qMetaTypeId&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">bool</span>&gt;&gt;(),<font></font>
        qMetaTypeId&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">double</span>&gt;&gt;(),<font></font>
        qMetaTypeId&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;QString&gt;&gt;(),<font></font>
    };<font></font>
...<font></font>
<span class="hljs-function">PropertyKeeper *<span class="hljs-title">KeepersFactory::getMetaKeeper</span><span class="hljs-params">(QObject *obj, QMetaProperty prop)</span>
</span>{
    <span class="hljs-keyword">int</span> t_id = QMetaType::type(prop.typeName());
    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">std</span>::find(<span class="hljs-keyword">simple_t</span>.begin(), <span class="hljs-keyword">simple_t</span>.end(), t_id) != <span class="hljs-keyword">simple_t</span>.end())
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> QMetaSimpleKeeper(obj,prop);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">std</span>::find(<span class="hljs-keyword">array_of_simple_t</span>.begin(),<span class="hljs-keyword">array_of_simple_t</span>.end(), t_id) != <span class="hljs-keyword">array_of_simple_t</span>.end())<font></font>
    {<font></font>
        <span class="hljs-keyword">if</span>( t_id == qMetaTypeId&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&gt;())
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> QMetaArrayKeeper&lt;<span class="hljs-keyword">int</span>&gt;(obj, prop);<font></font>
<font></font>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(t_id == qMetaTypeId&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;QString&gt;&gt;())
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> QMetaArrayKeeper&lt;QString&gt;(obj, prop);<font></font>
<font></font>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(t_id == qMetaTypeId&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">double</span>&gt;&gt;())
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> QMetaArrayKeeper&lt;<span class="hljs-keyword">double</span>&gt;(obj, prop);<font></font>
<font></font>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(t_id == qMetaTypeId&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">bool</span>&gt;&gt;())
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> QMetaArrayKeeper&lt;<span class="hljs-keyword">bool</span>&gt;(obj, prop);<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
        QObject * castobj = qvariant_cast&lt;QObject *&gt;(prop.read(obj));<font></font>
        <span class="hljs-keyword">if</span>(castobj)
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> QMetaObjectKeeper(castobj,prop);
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (QString(prop.typeName()).contains(<span class="hljs-string">"std::vector&lt;"</span>))<font></font>
        {<font></font>
            QString t = QString(prop.typeName()).remove(<span class="hljs-string">"std::vector&lt;"</span>).remove(<span class="hljs-string">"&gt;"</span>);
            <span class="hljs-keyword">int</span> idOfElement = QMetaType::type(t.toStdString().c_str());
            <span class="hljs-keyword">if</span>(QMetaType::typeFlags(idOfElement).testFlag(QMetaType::PointerToQObject))
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> QMetaObjectArrayKeeper(obj, prop);<font></font>
        }<font></font>
    }<font></font>
    <span class="hljs-keyword">throw</span> QSException(UnsupportedPropertyType);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;PropertyKeeper *&gt; <span class="hljs-title">KeepersFactory::getMetaKeepers</span><span class="hljs-params">(QObject *obj)</span>
</span>{
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;PropertyKeeper*&gt; keepers;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; obj-&gt;metaObject()-&gt;propertyCount(); i++)<font></font>
    {<font></font>
        <span class="hljs-keyword">if</span>(obj-&gt;metaObject()-&gt;property(i).isUser(obj))<font></font>
            keepers.push_back(getMetaKeeper(obj, obj-&gt;metaObject()-&gt;property(i)));<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> keepers;<font></font>
}<font></font>
...<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¿æŠ¤å·¥å‚çš„ä¸€é¡¹å…³é”®åŠŸèƒ½æ˜¯èƒ½å¤Ÿä¸ºå¯¹è±¡æä¾›å®Œæ•´çš„ä¸€ç³»åˆ—ä¿æŠ¤ï¼Œå¹¶ä¸”æ‚¨å¯ä»¥é€šè¿‡ä½¿ç”¨ç±»å‹æ ‡è¯†ç¬¦ç¼–è¾‘å¸¸é‡é›†åˆæ¥æ‰©å±•å—æ”¯æŒçš„åŸå§‹ç±»å‹çš„åˆ—è¡¨ã€‚</font><font style="vertical-align: inherit;">æ¯ä¸ªç³»åˆ—çš„å®ˆæŠ¤è€…éƒ½æ˜¯ä¸€ç§é’ˆå¯¹å¯¹è±¡å±æ€§çš„æ˜ å°„ã€‚</font><font style="vertical-align: inherit;">é”€æ¯KeepersFactoryå¯¹è±¡æ—¶ï¼Œå°†é‡Šæ”¾ä¸ºè¯¥å¯¹è±¡æä¾›çš„ä¸€ç³»åˆ—Keeperåˆ†é…çš„å†…å­˜ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å±€é™æ€§ä¸è¡Œä¸º</font></font></h2><div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æƒ…å†µ</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¡Œä¸º</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°è¯•åºåˆ—åŒ–å…¶ç±»å‹æœªä»QObjectç»§æ‰¿çš„å¯¹è±¡</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¼–è¯‘é”™è¯¯</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°è¯•åºåˆ—åŒ–/ç»“æ„åŒ–æ—¶æœªå£°æ˜çš„ç±»å‹</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QSException :: UnsupportedPropertyTypeå¼‚å¸¸</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°è¯•åºåˆ—åŒ–/æ„é€ å…·æœ‰ä¸simple_tå’Œarray_of_simple_té›†åˆä¸­æ‰€è¿°ä¸åŒçš„åŸå§‹ç±»å‹çš„å¯¹è±¡ã€‚</font></font></td>
<td> QSException::UnsupportedPropertyType.    ,     â€”     ,   </td>
</tr>
<tr>
<td> JSON/XML   </td>
<td>  </td>
</tr>
<tr>
<td>   propertyes,    JSON/XML</td>
<td> propertyes .       â€”  propertyes          </td>
</tr>
<tr>
<td>      JSON  property </td>
<td> QSException</td>
</tr>
</tbody></table></div><br>
<h2> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘è®¤ä¸ºï¼Œè¯¥é¡¹ç›®å€¼å¾—ï¼Œå› ä¸ºæœ¬æ–‡æ˜¯å†™çš„ã€‚</font><font style="vertical-align: inherit;">å¯¹äºæˆ‘è‡ªå·±ï¼Œæˆ‘å¾—å‡ºç»“è®ºï¼Œæ²¡æœ‰é€šç”¨è§£å†³æ–¹æ¡ˆï¼Œæ‚¨æ€»æ˜¯å¿…é¡»ç‰ºç‰²ä¸€äº›ä¸œè¥¿ã€‚</font><font style="vertical-align: inherit;">é€šè¿‡åœ¨ä½¿ç”¨ï¼ŒåŠŸèƒ½æ–¹é¢å¼€å‘çµæ´»çš„æ–¹æ³•ï¼Œæ‚¨å°†ä¸§å¤±ç®€å•æ€§ï¼Œåä¹‹äº¦ç„¶ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä¸æ•¦ä¿ƒæ‚¨ä½¿ç”¨QSerializerï¼Œæˆ‘çš„ç›®æ ‡æ˜¯æˆ‘è‡ªå·±ä½œä¸ºç¨‹åºå‘˜çš„å¼€å‘ã€‚</font><font style="vertical-align: inherit;">å½“ç„¶ï¼Œæˆ‘ä¹Ÿè¿½æ±‚å¸®åŠ©ä»–äººçš„ç›®æ ‡ï¼Œä½†é¦–å…ˆæ˜¯è·å¾—ä¹è¶£ã€‚</font><font style="vertical-align: inherit;">è¦ä¹è§‚ï¼‰</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN496824/index.html">æ‚¨çš„åŒ—æ¬§å·¥ä½œç¯å¢ƒ</a></li>
<li><a href="../zh-CN496826/index.html">120 + fpsæ—¶æœ‰æ•°ç™¾ä¸‡ä¸ªç²¾çµ</a></li>
<li><a href="../zh-CN496828/index.html">åœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°æœ‰è¶£çš„è‡ªç”±èŒä¸šè€…ï¼Ÿï¼ˆå‰§é€ï¼šä¸æ˜¯Upworkï¼‰</a></li>
<li><a href="../zh-CN496830/index.html">ä»€ä¹ˆæ˜¯ç´§æ€¥äº¤æµï¼Œä¸ºä»€ä¹ˆéœ€è¦çŸ¥é“</a></li>
<li><a href="../zh-CN496832/index.html">æ‘„å½±ä¹‹æ—…ï¼šITMOæ–°ç‰©ç†ç ”ç©¶æ‰€çš„æ··åˆçº³ç±³å…‰å­å­¦å’Œå…‰ç”µå­å­¦å®éªŒå®¤æ­£åœ¨åšä»€ä¹ˆ</a></li>
<li><a href="../zh-CN496838/index.html">Slackä½¿ç”¨çš„é¡¹ç›®éƒ¨ç½²æ–¹æ³•</a></li>
<li><a href="../zh-CN496840/index.html">é©¬æ–¯å…‹è®¤ä¸ºï¼Œ1.2ä¸‡é¢—å«æ˜Ÿä¸ä¼šå¹²æ‰°å¤©æ–‡å­¦å®¶ã€‚ä»–çš„æ„è§ä¸æ¨¡å‹ä¸ç¬¦</a></li>
<li><a href="../zh-CN496842/index.html">å…·æœ‰åŸºæœ¬Pythonå·¥å…·çš„ç®€å•æµè¡Œæ¨¡å‹</a></li>
<li><a href="../zh-CN496846/index.html">å †æ ˆå’ŒæŒ‡é’ˆçš„è¯­è¨€æœºåˆ¶</a></li>
<li><a href="../zh-CN496848/index.html">ï¼ƒ340ç§»åŠ¨å¼€å‘äººå‘˜çš„æœ‰è¶£ææ–™æ‘˜è¦ï¼ˆ4æœˆ6æ—¥è‡³12æ—¥ï¼‰</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>