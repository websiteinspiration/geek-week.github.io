<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶ã üìó ü§±üèº BLE sob o microsc√≥pio (ATT GATT ...) üë®üèæ‚Äçü§ù‚Äçüë®üèº üî∑ üë≥üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="BLE sob o microsc√≥pio (ATT GATT ...) Parte 1, vis√£o geral
 
 J√° faz um bom tempo que a primeira especifica√ß√£o do Bluetooth 4.0 foi lan√ßada. E embora o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>BLE sob o microsc√≥pio (ATT GATT ...)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/505078/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/jc/9m/ea/jc9meakt15qji8lrruuauk5z_fw.png" alt="imagem"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLE sob o microsc√≥pio (ATT GATT ...)</font></font></h2> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parte 1, vis√£o geral</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
J√° faz um bom tempo que a primeira especifica√ß√£o do Bluetooth 4.0 foi lan√ßada. </font><font style="vertical-align: inherit;">E embora o t√≥pico BLE seja muito interessante, ele ainda afasta muitos desenvolvedores por causa de sua complexidade. </font><font style="vertical-align: inherit;">Nos meus artigos anteriores, observei principalmente o n√≠vel mais baixo da camada de link e da camada f√≠sica. </font><font style="vertical-align: inherit;">Isso nos permitiu n√£o abordar conceitos t√£o complexos e confusos como o ATT (Protocolo de Atributos) e o GATT (Perfil Geral de Atributos). </font><font style="vertical-align: inherit;">No entanto, sem ter para entend√™-los, √© imposs√≠vel desenvolver dispositivos compat√≠veis. </font><font style="vertical-align: inherit;">Hoje eu gostaria de compartilhar esse conhecimento com voc√™. </font><font style="vertical-align: inherit;">No meu artigo, utilizarei uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cartilha</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do site n√≥rdico. </font><font style="vertical-align: inherit;">Ent√£o vamos come√ßar.</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por que tudo √© t√£o dif√≠cil?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na minha opini√£o, ficou imediatamente claro que o gerenciamento de dispositivos via smartphones √© um t√≥pico muito promissor e duradouro. Portanto, eles decidiram estrutur√°-lo imediatamente e ao m√°ximo. Para que os fabricantes de v√°rios gadgets n√£o apresentem seus pr√≥prios protocolos, que ser√£o incompat√≠veis. Da√≠ a complexidade. J√° no primeiro est√°gio, eles tentaram espremer tudo o que era poss√≠vel no protocolo BLE. E n√£o importa se √© √∫til ou n√£o. Al√©m disso, eles previram a possibilidade de expandir a lista de dispositivos para o futuro.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos dar uma olhada na imagem em que o diagrama do protocolo BLE √© desenhado. Consiste em v√°rias camadas. A camada f√≠sica mais baixa (PHY) √© respons√°vel pelo canal de r√°dio do dispositivo. A camada de link (LL) cont√©m toda a sequ√™ncia de bytes na mensagem transmitida. Em artigos anteriores, n√≥s o estudamos. A Host Controller Interface (HCI) √© um protocolo para troca entre camadas ou chips BLE se o Controller e o Host forem implementados em chips diferentes. O Protocolo de adapta√ß√£o e controle de link l√≥gico (L2CAP) √© respons√°vel pela forma√ß√£o de pacotes, dividindo por quadros, controle de erros e montagem de pacotes. A criptografia de pacote √© de responsabilidade do Security Manager Protocol (SMP). Um perfil de acesso compartilhado (GAP) √© respons√°vel pela comunica√ß√£o inicial entre dispositivos para determinar quem √© quem. Tamb√©m inclui digitaliza√ß√£o e publicidade.Neste artigo, focarei nas duas partes restantes do protocolo - GATT e ATT. O GATT √© um complemento para o ATT, portanto, eles s√£o altamente interligados.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/51/qi/ms/51qimsv8ccop7bncjcrllcc7tcg.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para simplificar a hist√≥ria, gostaria de recorrer a uma analogia. Eu a ouvi em algum lugar e gostaria de apoiar. Imagine um dispositivo BLE como uma estante com v√°rias prateleiras. Cada prateleira √© um assunto separado. Por exemplo, temos prateleiras com fic√ß√£o, matem√°tica, enciclop√©dias. Em cada prateleira h√° livros com um t√≥pico especificado. E, em alguns livros, existem at√© marcadores de papel com anota√ß√µes. Al√©m disso, temos um pequeno cat√°logo em papel de todos os livros. Se voc√™ se lembra das bibliotecas escolares, esta √© uma caixa estreita com cart√µes de papel. Com essa analogia, o gabinete √© o perfil do nosso dispositivo. Prateleiras s√£o servi√ßos, livros s√£o recursos e um diret√≥rio √© uma tabela de atributos. Os marcadores nos livros s√£o descritores, que tamb√©m discutirei mais adiante, com mais detalhes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todo mundo que desenvolveu o dispositivo sabe que muitos projetos t√™m partes semelhantes de c√≥digo. O fato √© que muitos dispositivos t√™m funcionalidade semelhante. Por exemplo, se os dispositivos estiverem funcionando com baterias, o problema de carregar e controlar o n√≠vel ser√° o mesmo. O mesmo vale para sensores. Na verdade, a abordagem de programa√ß√£o orientada a objetos </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"fornece a capacidade de criar objetos que combinam propriedades e comportamentos em uma uni√£o independente, que pode ser reutilizada"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Na minha opini√£o, no BLE foi feita uma tentativa de abordagem semelhante. O Bluetooth Special Interest Group (SIG) desenvolveu perfis. Dispositivos de fabricantes diferentes com os mesmos perfis devem funcionar um com o outro sem dificuldade. Os perfis, por sua vez, consistem em servi√ßos e servi√ßos de caracter√≠sticas, complementados por descritores. Em geral, pode ser assim: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yv/7v/w-/yv7vw-vhvlnavelyabkxtwe8p0e.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, considere o perfil do perfil do monitor de frequ√™ncia card√≠aca (pulseira de fitness). √â composto por dois servi√ßos e v√°rias caracter√≠sticas. A partir disso, a hierarquia do perfil fica clara imediatamente. A caracter√≠stica do ponto de verifica√ß√£o redefine a contagem total de calorias para zero. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. O servi√ßo de frequ√™ncia card√≠aca inclui tr√™s caracter√≠sticas (0x180D): </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;a) Caracter√≠stica obrigat√≥ria da frequ√™ncia card√≠aca (0x2A37)</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;b) Caracter√≠stica opcional da posi√ß√£o do sensor corporal (0x2A38) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;c) Caracter√≠stica condicional do ponto de refer√™ncia da freq√º√™ncia card√≠aca (0x2A39) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Servi√ßo da bateria (0x180F): </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;a) Caracter√≠stica obrigat√≥ria do n√≠vel da bateria (0x2A19)</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uuid</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para nos referirmos inequivocamente aos elementos do perfil (servi√ßos, caracter√≠sticas e descritores), precisamos numer√°-los de alguma forma. Para esse fim, √© introduzido um conceito como Universally Unique ID (UUID) ou Universal Unique Identifier. Entre par√™nteses de cada linha, apenas UUID √© especificado. E h√° um recurso. Para o UUID, decidimos usar um comprimento de c√≥digo de 16 e 128 bits. Porque voc√™ pergunta? No protocolo BLE, tudo est√° sujeito √† conserva√ß√£o de energia. Portanto, a dimens√£o de 16 bits √© bastante razo√°vel. √â improv√°vel que mais de 65 mil sejam criados em um futuro pr√≥ximo. servi√ßos e recursos exclusivos. No momento, tudo o que eles j√° podiam ter sido contados (lembre-se de onde veio - ‚Äúele tamb√©m contou voc√™‚Äù :-)) Elementos numerados de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perfis</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">servi√ßos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caracter√≠sticas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">descritores</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> voc√™ pode olhar para os links. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, acho que todos se lembram da hist√≥ria com 4 bytes de endere√ßo IP na Internet. No come√ßo, eles acharam que era o suficiente, mas agora ainda n√£o vamos para o endere√ßo de 6 bytes. Para n√£o repetir esse erro e dar espa√ßo √†s m√£os l√∫dicas dos fabricantes caseiros, a SIG decidiu imediatamente introduzir tamb√©m UUIDs de 128 bits. Isso pessoalmente me lembra a banda de 433 MHz n√£o licenciada, que foi entregue a todos os tipos de Kulibin do canal de r√°dio. No nosso caso, um identificador de servi√ßos e caracter√≠sticas de 128 bits foi distribu√≠do. Isso significa que n√≥s, para nossos servi√ßos e dispositivos, podemos usar quase qualquer valor de 128 bits. De qualquer forma, a probabilidade de obter o mesmo UUID tende a zero.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De fato, UUIDs curtos de 16 bits t√™m sua extens√£o at√© valores de 128 bits. </font><font style="vertical-align: inherit;">Na especifica√ß√£o, essa extens√£o √© chamada de Bluetooth Base UUID e possui o valor 00000000-0000-1000-8000-00805F9B34FB. </font><font style="vertical-align: inherit;">Se, por exemplo, o atributo UUID de 16 bits tiver o valor 0x1234, o UUID de 128 bits equivalente ter√° o valor 00001234-0000-1000-8000-00805F9B34FB. </font><font style="vertical-align: inherit;">E at√© a f√≥rmula correspondente √© fornecida: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;128_bit_value = 16_bit_value * 2 ^ 96 + Bluetooth_Base_UUID </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√£o sei de onde veio esse n√∫mero m√°gico. </font><font style="vertical-align: inherit;">Se algum dos leitores souber, deixe-os escrever nos coment√°rios. </font><font style="vertical-align: inherit;">Quanto √† inven√ß√£o de UUIDs de 128 bits, em princ√≠pio, voc√™ pode usar um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gerador</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> especial </font><font style="vertical-align: inherit;">que far√° isso por voc√™.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ATT GATT ...</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Na verdade, a divers√£o come√ßa. Lembro que o ATT √© baseado em um relacionamento cliente-servidor. Agora estamos considerando o dispositivo do servidor. Ele cont√©m informa√ß√µes como valores do sensor, status do interruptor de luz, dados de localiza√ß√£o etc. Agora que todos os "participantes em nosso desfile" est√£o numerados, devemos de alguma forma coloc√°-los na mem√≥ria do dispositivo. Para fazer isso, n√≥s os colocamos em uma tabela chamada tabela de atributos. Lembre-se disso bem. Este √© o cora√ß√£o do BLE. Vamos consider√°-lo no futuro. Agora, chamaremos cada linha de atributo. Essa tabela est√° no fundo da pilha e, como regra, n√£o temos acesso direto a ela. Inicializamos e voltamos a ele, mas o que acontece l√° dentro est√° escondido atr√°s de sete selos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considere a figura da especifica√ß√£o, mas antes disso, quero chamar imediatamente a aten√ß√£o para a confus√£o frequente em termos, nomeadamente nos descritores. O papel do descritor √© complementar a descri√ß√£o da caracter√≠stica. Quando √© necess√°rio expandir seus recursos, eles usam descritores. Eles tamb√©m s√£o atributos e, da mesma maneira, juntamente com servi√ßos e caracter√≠sticas, est√£o localizados na tabela de atributos. Vamos analis√°-los em detalhes na segunda parte do artigo. No entanto, √†s vezes os descritores s√£o chamados de n√∫mero da linha na tabela de atributos. Isso deve ser lembrado. Para n√£o ficarmos confusos, usaremos o termo "ponteiro de atributo" para esses fins. </font></font><br>
<img src="https://habrastorage.org/webt/a5/rl/lk/a5rllkmo7i3doe3ripvpjd2ztwy.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, um atributo √© um valor discreto que possui as seguintes propriedades associadas: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Identificador de Atributo √© o √≠ndice da tabela correspondente ao atributo</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Tipo de Atributo √© o UUID que descreve seu tipo. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. Valor do Atributo √© os dados indexados pelo ponteiro do atributo. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4. Permiss√µes de Atributo fazem parte do atributo, permiss√µes que n√£o podem ser lido ou escrito usando o protocolo de atributo </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como entender tudo isso? O ponteiro de atributo √©, relativamente falando, seu n√∫mero em nossa tabela.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ele permite que o cliente se refira a um atributo em solicita√ß√µes de leitura ou grava√ß√£o. Podemos numerar nossas linhas (atributos) de 0x0001 a 0xFFFF. Em nossa associa√ß√£o com uma estante de livros, esse √© o n√∫mero do cart√£o no cat√°logo de pap√©is. Da mesma forma, como no cat√°logo da biblioteca, os cart√µes s√£o organizados em ordem crescente. O n√∫mero de cada linha subseq√ºente deve ser maior que o anterior. Como na biblioteca, algumas cartas √†s vezes s√£o perdidas, ent√£o n√≥s temos - pode haver falhas na numera√ß√£o das linhas. Isso √© permitido. O principal √© que eles continuam aumentando. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O tipo de atributo determina o que √© esse atributo. Por analogia com a linguagem C, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
onde existem vari√°veis ‚Äã‚Äãe cadeias num√©ricas booleanas, ent√£o aqui. Pelo tipo de atributo que reconhecemos</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
com o que estamos lidando e como continuar trabalhando com esse atributo. Abaixo, examinamos alguns tipos espec√≠ficos de atributos. Por exemplo, "declara√ß√£o de servi√ßo" (0x2800), "declara√ß√£o de caracter√≠stica" (0x2803), "declara√ß√£o de descritor" (0x2902). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O valor do atributo √© realmente o seu valor, desculpe pela tautologia. Se o tipo de atributo for uma sequ√™ncia, o valor do atributo poder√° ser, por exemplo, o slogan "Hello World !!!". Se o tipo de atributo for uma "declara√ß√£o de servi√ßo", seu valor ser√° o pr√≥prio servi√ßo. E, √†s vezes, s√£o informa√ß√µes sobre onde encontrar outros atributos e suas propriedades. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As permiss√µes de atributo permitem que o servidor entenda se o acesso de leitura ou grava√ß√£o √© permitido.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Observe que essas permiss√µes se aplicam apenas ao valor do atributo, e n√£o ao pr√≥prio campo ponteiro, tipo e permiss√µes. </font><font style="vertical-align: inherit;">Essa. </font><font style="vertical-align: inherit;">se a grava√ß√£o de atributo for permitida, podemos alterar, por exemplo, a linha "Hello World !!!" </font><font style="vertical-align: inherit;">na linha "bom dia". </font><font style="vertical-align: inherit;">Mas n√£o podemos proibir a grava√ß√£o de uma nova linha ou alterar o tipo de atributo e designar a linha como "declara√ß√£o de servi√ßo". </font><font style="vertical-align: inherit;">Quando um cliente acessa o servidor, ele solicita seus atributos. </font><font style="vertical-align: inherit;">Isso permite que o cliente descubra o que o servidor pode fornecer. </font><font style="vertical-align: inherit;">Embora n√£o seja necess√°rio ler e escrever valores.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Com o que se parece</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O conceito do GATT √© agrupar atributos em uma tabela de atributos em uma ordem muito espec√≠fica e l√≥gica. Vamos dar uma olhada no perfil da frequ√™ncia card√≠aca abaixo. A coluna mais √† esquerda desta tabela √© opcional. Ele simplesmente descreve para n√≥s o que √© essa linha (atributo). Todas as outras colunas j√° nos s√£o familiares.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/6k/vt/4l/6kvt4lzc9h6ll9kwdu9g6qps22c.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No topo de cada grupo, sempre temos um atributo de an√∫ncio de servi√ßo. Seu tipo √© sempre 0x2800 e o ponteiro depende de quantos atributos j√° est√£o presentes na tabela. Suas permiss√µes s√£o sempre somente leitura, sem nenhuma autentica√ß√£o ou autoriza√ß√£o. Falaremos sobre esses conceitos um pouco mais tarde. Um valor √© outro UUID que determina que tipo de servi√ßo √©. Na tabela, o valor √© 0x180D, definido pelo Bluetooth SIG como um servi√ßo de frequ√™ncia card√≠aca.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s o an√∫ncio do servi√ßo, o an√∫ncio da caracter√≠stica. No formul√°rio, √© semelhante a uma declara√ß√£o de servi√ßo. Seu UUID √© sempre 0x2803 e as permiss√µes tamb√©m s√£o sempre somente leitura, sem nenhuma autentica√ß√£o ou autoriza√ß√£o. Vamos dar uma olhada no campo Valor do atributo, que inclui alguns dados. Ele sempre cont√©m um ponteiro, um UUID e um conjunto de propriedades. Esses tr√™s elementos descrevem a declara√ß√£o subsequente do valor da caracter√≠stica. O ponteiro indica naturalmente o local da declara√ß√£o do valor da caracter√≠stica na tabela de atributos. O UUID descreve que tipo de informa√ß√£o ou valor podemos esperar. Por exemplo, o valor da temperatura, o estado do interruptor de luz ou algum outro valor arbitr√°rio. E, finalmente, propriedades que descrevem como voc√™ pode interagir com um valor caracter√≠stico.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui estamos esperando por outra armadilha. Est√° associado a permiss√µes de atributo e propriedades de caracter√≠sticas. Vejamos a imagem das propriedades do campo de bit da especifica√ß√£o. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ko/co/5y/koco5ykz3gqkfwww1k48ssxvjug.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como voc√™ pode ver, tamb√©m existem campos aqui que fornecem recursos de leitura e grava√ß√£o. Voc√™ pode se perguntar por que temos permiss√µes de leitura / grava√ß√£o para o atributo e propriedades de </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
leitura / grava√ß√£o para o valor da caracter√≠stica? Eles n√£o deveriam ser sempre os mesmos? O fato √© que as propriedades para o valor da caracter√≠stica, de fato, s√£o apenas recomenda√ß√µes para o cliente, usadas nas camadas GATT e de aplicativo. Essas s√£o apenas dicas sobre o que um cliente pode esperar de um atributo de an√∫ncio de recurso. Vamos lidar com isso com mais detalhes. Quais tipos de permiss√µes o atributo possui? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Permiss√µes de acesso:</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp; - leitura </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp; - escrita </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp; - leitura e escrita </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Permiss√£o de autentica√ß√£o: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp; - autentica√ß√£o √© necess√°ria </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp; - autentica√ß√£o n√£o √© necess√°ria </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. Permiss√£o de autoriza√ß√£o: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp; - autoriza√ß√£o √© necess√°ria </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp; - autoriza√ß√£o n√£o √© necess√°ria</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A principal diferen√ßa entre a resolu√ß√£o de atributos e as propriedades das caracter√≠sticas √© que as primeiras se relacionam com servidores e as segundas com clientes. </font><font style="vertical-align: inherit;">O servidor pode ter permiss√£o para ler o valor da caracter√≠stica, mas ao mesmo tempo h√° um requisito de autentica√ß√£o ou autoriza√ß√£o. </font><font style="vertical-align: inherit;">Portanto, quando o cliente solicita propriedades da caracter√≠stica, obtemos que a leitura √© permitida. </font><font style="vertical-align: inherit;">Mas quando tentamos ler, obtemos um erro. </font><font style="vertical-align: inherit;">Portanto, podemos falar com seguran√ßa sobre a prioridade das permiss√µes sobre as propriedades. </font><font style="vertical-align: inherit;">N√£o podemos obter conhecimento sobre as permiss√µes do atributo no lado do cliente.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descritor</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De volta √† nossa mesa. Depois de declarar um valor de caracter√≠stica, s√£o poss√≠veis as seguintes declara√ß√µes de atributo: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Nova declara√ß√£o de uma caracter√≠stica (pode haver muitas caracter√≠sticas em um servi√ßo) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Nova declara√ß√£o de servi√ßo (pode haver muitas delas em uma tabela) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. Declara√ß√£o de um descritor</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No caso de uma caracter√≠stica que mede a freq√º√™ncia card√≠aca, em nossa tabela, a declara√ß√£o do valor da caracter√≠stica √© acompanhada pela declara√ß√£o de um descritor. Um descritor √© um atributo com informa√ß√µes adicionais sobre a caracter√≠stica. Existem v√°rios tipos de descritores. Falaremos sobre eles em detalhes na segunda parte deste artigo. Agora, tocaremos apenas no CCCD (Client Characteristic Configuration Descriptor). Tem um UUID de 0x2902. Usando esse descritor, o cliente pode ativar a indica√ß√£o ou notifica√ß√£o no servidor. A diferen√ßa entre eles √© pequena, mas ainda existe. A notifica√ß√£o n√£o requer confirma√ß√£o de recebimento pelo cliente. A indica√ß√£o exige isso, embora ocorra no n√≠vel do GATT, n√£o atingindo o n√≠vel do aplicativo. Por que voc√™ pergunta? Infelizmente, eu n√£o sei.S√≥ posso dizer que os especialistas n√≥rdicos recomendam o uso de notifica√ß√µes. Al√©m disso, a verifica√ß√£o de integridade de pacotes (usando CRC) ocorre nos dois casos.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclus√£o</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No final do artigo, eu gostaria de dizer isso. </font><font style="vertical-align: inherit;">A √∫ltima tabela √© um pouco confusa. </font><font style="vertical-align: inherit;">No entanto, decidi porque √© dado no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artigo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> em que confio. </font><font style="vertical-align: inherit;">Na segunda parte do meu artigo, pretendo me aprofundar na especifica√ß√£o do BlueTooth 4.0. </font><font style="vertical-align: inherit;">Estamos aguardando esquemas e desenhos mais corretos. </font><font style="vertical-align: inherit;">Na terceira parte, gostaria de analisar o log obtido com a ajuda do programa Wireshark de um dos dispositivos e ver "ao vivo" toda a teoria que estamos estudando. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Funcion√°rio do grupo de empresas </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Caesar Satellite</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Pecherskikh Vladimir</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt505052/index.html">Teste r√°pido de Motionia.js e Consoleimg.js</a></li>
<li><a href="../pt505060/index.html">Inserir array numpy no banco de dados MySQL via Python</a></li>
<li><a href="../pt505064/index.html">Mikrotik split-dns: eles fizeram isso</a></li>
<li><a href="../pt505070/index.html">Masturba√ß√£o intelectual sobre boa escrita</a></li>
<li><a href="../pt505074/index.html">Hospedagem e servidores dedicados: responda a perguntas. Parte 2. Por que uma Internet t√£o cara no data center?</a></li>
<li><a href="../pt505080/index.html">Mutex no mundo do c√≥digo ass√≠ncrono</a></li>
<li><a href="../pt505090/index.html">Sobre a tradu√ß√£o das palavras "√∫til" / "uso" sem uso / √∫til</a></li>
<li><a href="../pt505092/index.html">Como consegui um emprego na Microsoft</a></li>
<li><a href="../pt505098/index.html">Revis√£o do telefone IP Snom D717</a></li>
<li><a href="../pt505104/index.html">Como desenvolvemos um servi√ßo que entrou nos 5 maiores sites de farm√°cias do mundo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>