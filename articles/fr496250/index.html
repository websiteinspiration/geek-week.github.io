<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèø üë® üë®üèæ‚Äçüé§ Comment un code √©trange cache-t-il les erreurs? Analyse TensorFlow.NET üë©üèæ‚ÄçüöÄ üëÇüèø üëêüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'analyse statique est un outil extr√™mement utile pour tout d√©veloppeur, car elle aide √† trouver dans le temps non seulement des erreurs, mais aussi d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Comment un code √©trange cache-t-il les erreurs? Analyse TensorFlow.NET</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/496250/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/765/bb4/d84/765bb4d84187d986358a301bbeed082f.png" alt="TensorFlow.NET et PVS-Studio"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'analyse statique est un outil extr√™mement utile pour tout d√©veloppeur, car elle aide √† trouver dans le temps non seulement des erreurs, mais aussi des morceaux de code suspects et √©tranges qui peuvent d√©router les programmeurs qui devraient travailler avec lui √† l'avenir. Cette id√©e sera d√©montr√©e par une analyse du projet TensorFlow.NET open C #, qui est en cours de d√©veloppement pour fonctionner avec la populaire biblioth√®que d'apprentissage automatique TensorFlow.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je m'appelle Nikita Lipilin. </font><font style="vertical-align: inherit;">Il y a quelque temps, j'ai rejoint le d√©partement des programmeurs C # de PVS-Studio. </font><font style="vertical-align: inherit;">Traditionnellement, tous les nouveaux venus dans l'√©quipe √©crivent des articles qui discutent des r√©sultats de la v√©rification de divers projets ouverts √† l'aide de l'analyseur statique PVS-Studio. </font><font style="vertical-align: inherit;">Ces articles aident les nouveaux employ√©s √† mieux conna√Ætre le produit et offrent en m√™me temps des avantages suppl√©mentaires en termes de vulgarisation de la m√©thodologie d'analyse statique. </font><font style="vertical-align: inherit;">Je vous propose de vous familiariser avec mes premiers travaux sur le th√®me de l'analyse des projets ouverts.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">introduction</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La vari√©t√© des erreurs possibles dans le code du programme est incroyable. Certains d'entre eux se r√©v√®lent imm√©diatement, lors d'un examen de surface de l'application cr√©√©e, d'autres peuvent √™tre difficiles √† remarquer m√™me lors d'une r√©vision de code par une √©quipe de d√©veloppeurs exp√©riment√©s. Cependant, il arrive √©galement que, en raison d'une inattention ou d'une autre raison, le programmeur √©crive parfois du code simplement √©trange et illogique, qui, n√©anmoins, semble (semble) remplir avec succ√®s sa fonction. Mais seulement plus loin, en revenant √† ce qui a √©t√© √©crit, ou lorsque d'autres √©tudient ce code, des questions commencent √† se poser auxquelles il est impossible de r√©pondre.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La refactorisation de l'ancien code peut se transformer en probl√®mes, surtout si d'autres parties du programme en d√©pendent, donc quand vous trouvez m√™me des constructions franchement incurv√©es, le ‚Ä≥ √ßa marche? Ne le touchez pas! ‚Ä≥. Par la suite, cela rend difficile l'√©tude de la source et, par cons√©quent, il devient difficile d'√©tendre les capacit√©s disponibles. La base de code est obstru√©e, il est probable que certains probl√®mes internes petits et invisibles, mais potentiellement tr√®s d√©sagr√©ables, ne soient pas r√©solus √† temps.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä un moment donn√©, les cons√©quences de cette erreur se feront sentir, mais sa recherche prendra beaucoup de temps, car les soup√ßons du d√©veloppeur tomberont sur un grand nombre de fragments de code √©tranges qui n'ont pas √©t√© refactoris√©s en m√™me temps. Il en r√©sulte que divers probl√®mes et bizarreries dans un fragment particulier doivent √™tre corrig√©s imm√©diatement apr√®s son √©criture. Dans le cas o√π il y a des raisons raisonnables de tout laisser tel quel (par exemple, si le code est √©crit comme une sorte de blanc "pour plus tard"), un tel fragment doit √™tre accompagn√© d'un commentaire explicatif.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il convient √©galement de noter que, quelles que soient les qualifications du d√©veloppeur, certains moments probl√©matiques et simplement infructueux peuvent lui √©chapper, et parfois une "solution temporaire" peut √™tre appliqu√©e √† un endroit, qui sera bient√¥t oubli√©e et deviendra "permanente". Par la suite, l'analyse d'un tel code (tr√®s probablement, un autre d√©veloppeur sera impliqu√© dans cela) demandera beaucoup d'efforts. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans de tels cas, la r√©vision du code peut aider. Cependant, si la t√¢che est assez s√©rieuse, cette option n√©cessitera beaucoup de temps. De plus, lorsqu'il y a beaucoup de petites erreurs ou lacunes, l'inspecteur risque de ne pas remarquer d'erreurs de haut niveau derri√®re elles. La v√©rification du code devient une routine fastidieuse, et progressivement l'efficacit√© de l'examen diminue.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De toute √©vidence, les t√¢ches de routine seront beaucoup mieux transf√©r√©es de la personne √† l'ordinateur. Cette approche est utilis√©e dans de nombreux domaines de la modernit√©. L'automatisation de divers processus est la cl√© de la prosp√©rit√©. Qu'est-ce que l'automatisation dans le contexte de ce sujet? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un assistant fiable pour r√©soudre le probl√®me de l'√©criture d'un code de travail raisonnable et stable est l'analyse statique. Chaque fois avant d'envoyer les r√©sultats de leurs activit√©s √† la revue, le programmeur pourra effectuer une v√©rification automatis√©e et ne pas surcharger les autres d√©veloppeurs (et lui-m√™me) de travail inutile. Le code ne sera envoy√© pour v√©rification qu'apr√®s avoir pris en compte tous les avertissements de l'analyseur: des erreurs ont √©t√© corrig√©es et des moments √©tranges ont √©t√© r√©√©crits ou du moins expliqu√©s par un commentaire.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien s√ªr, la n√©cessit√© de revoir le code ne dispara√Æt pas, mais l'analyse statique compl√®te et simplifie consid√©rablement sa mise en ≈ìuvre. </font><font style="vertical-align: inherit;">Une partie suffisamment importante des erreurs sera corrig√©e gr√¢ce √† l'analyseur, et les moments √©tranges ne seront certainement pas oubli√©s et marqu√©s en cons√©quence. </font><font style="vertical-align: inherit;">En cons√©quence, avec une r√©vision du code, il sera possible de se concentrer sur la v√©rification de l'exactitude de la mise en ≈ìuvre d'interactions logiques complexes et de trouver des probl√®mes sous-jacents qui, malheureusement, ne peuvent pas √™tre d√©tect√©s par l'analyseur (jusqu'√† pr√©sent).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TensorFlow.NET</font></font></h2><br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d02/39d/72d/d0239d72ded7154a696d5c975a0555d1.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cet article est inspir√© du projet TensorFlow.NET. Il repr√©sente la mise en ≈ìuvre de la capacit√© de travailler avec les fonctionnalit√©s de la biblioth√®que d'apprentissage machine TensorFlow populaire via le code C # (d'ailleurs, nous l'avons √©galement </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">test√©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Cette id√©e semblait assez int√©ressante, car au moment de la r√©daction, travailler avec la biblioth√®que n'est disponible qu'en Python, Java et Go. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le code source disponible sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est constamment mis √† jour et maintenant son volume est un peu plus de cent mille lignes. Apr√®s une √©tude superficielle, il y avait un d√©sir de proc√©der √† une v√©rification en utilisant une analyse statique. PVS-Studio a √©t√© utilis√© comme un outil sp√©cifique, qui a prouv√© son efficacit√© dans un assez grand nombre de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">projets diff√©rents</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/261/70b/247/26170b247e9b81a3643bd5682b7d5203.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour TensorFlow.NET, l'analyseur a affich√© un certain nombre d'alertes: 39 niveaux √©lev√©s, 227 niveaux moyens et 154 niveaux bas (vous pouvez lire les niveaux d'avertissement </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans la sous-section ¬´Niveaux d'avertissement et ensembles de r√®gles de diagnostic¬ª). Une analyse d√©taill√©e de chacun d'eux rendrait cet article gigantesque, donc seuls ceux qui me paraissent les plus int√©ressants sont d√©crits ci-dessous. Il convient √©galement de noter que certains des probl√®mes rencontr√©s sont rencontr√©s plusieurs fois dans le projet, et l'analyse de chacun de ces morceaux de code d√©passe le cadre de cet article.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le projet se donne une t√¢che assez s√©rieuse et, malheureusement, l'apparition de divers types de fragments de code √©tranges est in√©vitable. </font><font style="vertical-align: inherit;">Dans cet article, je vais essayer de montrer que l'utilisation de l'analyse statique peut grandement simplifier le travail des programmeurs, en pointant les zones susceptibles de poser des questions. </font><font style="vertical-align: inherit;">Pas toujours un avertissement indique une erreur, mais assez souvent il indique un code qui pourrait poser des questions √† une personne. </font><font style="vertical-align: inherit;">En cons√©quence, la probabilit√© qu'un code √©trange soit remani√© ou, en tout cas, comment√© en cons√©quence est consid√©rablement augment√©e.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragments qui ont attir√© l'attention lors de l'√©tude du rapport de l'analyseur</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, un assez grand nombre d'avertissements d'analyseur pour ce projet peuvent √™tre appel√©s non pas tant d'erreurs, mais plut√¥t de code √©trange. Lors de l'affichage des lignes pour lesquelles un avertissement est √©mis, au moins la perplexit√© survient. Bien s√ªr, certains des exemples ci-dessous sont probablement des "solutions temporaires", mais ils ne donnent aucun commentaire sur ce probl√®me, ce qui signifie que quelqu'un qui travaillera avec ce code √† l'avenir aura des questions, recherchant des r√©ponses auxquelles prendra du temps suppl√©mentaire.</font></font><br>
<br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/263/3fc/e7c/2633fce7cba470cd8a0c16e6751b3513.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le m√™me temps, certains avertissements indiquent un code qui n'est √©videmment pas seulement √©trange, mais tout simplement faux. </font><font style="vertical-align: inherit;">C'est le principal danger d'un "code √©trange" - il est extr√™mement difficile de remarquer une v√©ritable erreur si vous voyez ici et l√† des solutions incompr√©hensibles et que vous vous habituez progressivement au fait que le code semble incorrect.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visite de collection sophistiqu√©e</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> _RemoveDefaultAttrs(....)<font></font>
{<font></font>
  <span class="hljs-keyword">var</span> producer_op_dict = <span class="hljs-keyword">new</span> Dictionary&lt;<span class="hljs-keyword">string</span>, OpDef&gt;();<font></font>
  producer_op_list.Op.Select(op =&gt;<font></font>
  {<font></font>
    producer_op_dict[op.Name] = op;<font></font>
    <span class="hljs-keyword">return</span> op;<font></font>
  }).ToArray();           <font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avertissement de l'analyseur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3010</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La valeur de retour de la fonction 'ToArray' doit √™tre utilis√©e. importer.cs 218 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'analyseur consid√®re </font><font style="vertical-align: inherit;">√† ce stade </font><font style="vertical-align: inherit;">l'appel √† </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Toray</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comme suspect, car la valeur renvoy√©e par cette fonction n'est pas affect√©e √† une variable. Cependant, un tel code n'est pas une erreur. Cette construction est utilis√©e pour remplir le dictionnaire </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">producteur_op_dict</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec des </font><font style="vertical-align: inherit;">valeurs correspondant aux √©l√©ments de la liste </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">producteur_op_list.Op</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Un appel √† </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToArray est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√©cessaire pour que la fonction pass√©e en argument √† la m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> soit </font><font style="vertical-align: inherit;">appel√©e pour tous les √©l√©ments de la collection.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä mon avis, le code ne semble pas le meilleur. </font><font style="vertical-align: inherit;">Remplir le dictionnaire n'est pas √©vident et certains d√©veloppeurs peuvent vouloir supprimer l'appel ¬´inutile¬ª de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToArray</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Il serait beaucoup plus simple et plus compr√©hensible d'utiliser la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">boucle foreach</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ici </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">var</span> producer_op_dict = <span class="hljs-keyword">new</span> Dictionary&lt;<span class="hljs-keyword">string</span>, OpDef&gt;();<font></font>
<font></font>
<span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> op <span class="hljs-keyword">in</span> producer_op_list.Op)<font></font>
{<font></font>
  producer_op_dict[op.Name] = op;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce cas, le code semble aussi simple que possible. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre moment similaire ressemble √† ceci:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> GraphDef <span class="hljs-title">convert_variables_to_constants</span>(<span class="hljs-params">....</span>)</span><font></font>
{<font></font>
  ....<font></font>
  inference_graph.Node.Select(x =&gt; map_name_to_node[x.Name] = x).ToArray();<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avertissement de l'analyseur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3010</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La valeur de retour de la fonction 'ToArray' doit √™tre utilis√©e. </font><font style="vertical-align: inherit;">graph_util_impl.cs 48 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La seule diff√©rence est qu'un tel enregistrement semble plus concis, mais seule la tentation de supprimer l'appel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToArray</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ici ne dispara√Æt pas, et il ne semble toujours pas √©vident.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solution temporaire</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> GraphDef <span class="hljs-title">convert_variables_to_constants</span>(<span class="hljs-params">....</span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">var</span> source_op_name = get_input_name(node);
  <span class="hljs-keyword">while</span>(map_name_to_node[source_op_name].Op == <span class="hljs-string">"Identity"</span>)<font></font>
  {<font></font>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException);<font></font>
    ....<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avertissement de l'analyseur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3020</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Un ¬´lancer¬ª inconditionnel dans une boucle. graph_util_impl.cs 73 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le projet consid√©r√©, l'approche suivante est souvent utilis√©e: si un comportement doit √™tre impl√©ment√© ult√©rieurement, une </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exception NotImplementedException est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lev√©e √† l'endroit appropri√© </font><font style="vertical-align: inherit;">. Il est clair pourquoi l'analyseur met en garde contre une erreur possible dans cette pi√®ce: utiliser </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">while</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> au lieu de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ne semble pas vraiment trop raisonnable. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce n'est pas le seul avertissement qui appara√Æt en raison de l'utilisation de solutions temporaires. Par exemple, il existe une m√©thode:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor[] _SoftmaxCrossEntropyWithLogitsGrad(<font></font>
  Operation op, Tensor[] grads<font></font>
)<font></font>
{<font></font>
  <span class="hljs-keyword">var</span> grad_loss = grads[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">var</span> grad_grad = grads[<span class="hljs-number">1</span>];
  <span class="hljs-keyword">var</span> softmax_grad = op.outputs[<span class="hljs-number">1</span>];
  <span class="hljs-keyword">var</span> grad = _BroadcastMul(grad_loss, softmax_grad);<font></font>
<font></font>
  <span class="hljs-keyword">var</span> logits = op.inputs[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">if</span>(grad_grad != <span class="hljs-literal">null</span> &amp;&amp; !IsZero(grad_grad)) <span class="hljs-comment">// &lt;=</span><font></font>
  {<font></font>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException(<span class="hljs-string">"_SoftmaxCrossEntropyWithLogitsGrad"</span>);<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Tensor[] <font></font>
  {<font></font>
    grad,<font></font>
    _BroadcastMul(grad_loss, -nn_ops.log_softmax(logits))<font></font>
  };<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avertissement de l'analyseur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : l' </font><font style="vertical-align: inherit;">expression </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3022</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ¬´grad_grad! = Null &amp;&amp;! IsZero (grad_grad)¬ª est toujours fausse. </font><font style="vertical-align: inherit;">nn_grad.cs 93 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, une </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exception NotImplementedException ("_ SoftmaxCrossEntropyWithLogitsGrad")</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ne sera jamais lev√©e, car ce code est tout simplement inaccessible. </font><font style="vertical-align: inherit;">Pour d√©m√™ler la raison, vous devez vous rendre dans le code de la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IsZero</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">IsZero</span>(<span class="hljs-params">Tensor g</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">new</span> <span class="hljs-keyword">string</span>[] { <span class="hljs-string">"ZerosLike"</span>, <span class="hljs-string">"Zeros"</span> }.Contains(g.op.type))
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
<font></font>
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException(<span class="hljs-string">"IsZero"</span>);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La m√©thode retourne </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou l√®ve une exception. </font><font style="vertical-align: inherit;">Ce code n'est pas une erreur - √©videmment, l'impl√©mentation ici est laiss√©e pour plus tard. </font><font style="vertical-align: inherit;">L'essentiel est que "alors" soit vraiment arriv√©. </font><font style="vertical-align: inherit;">Eh bien, il s'est av√©r√© tr√®s bien que PVS-Studio ne vous laissera pas oublier qu'il y a une telle imperfection ici :)</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Est-ce que Tenseur est Tenseur?</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Tensor[] _ExtractInputShapes(Tensor[] inputs)<font></font>
{<font></font>
  <span class="hljs-keyword">var</span> sizes = <span class="hljs-keyword">new</span> Tensor[inputs.Length];
  <span class="hljs-keyword">bool</span> fully_known = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; inputs.Length; i++)<font></font>
  {<font></font>
    <span class="hljs-keyword">var</span> x = inputs[i];<font></font>
<font></font>
    <span class="hljs-keyword">var</span> input_shape = array_ops.shape(x);
    <span class="hljs-keyword">if</span> (!(input_shape <span class="hljs-keyword">is</span> Tensor) || input_shape.op.type != <span class="hljs-string">"Const"</span>)<font></font>
    {<font></font>
      fully_known = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">break</span>;<font></font>
    }<font></font>
<font></font>
    sizes[i] = input_shape;<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avertissement de l'analyseur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3051</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Une v√©rification de type excessive. </font><font style="vertical-align: inherit;">L'objet est d√©j√† de type 'Tenseur'. </font><font style="vertical-align: inherit;">array_grad.cs 154 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le type de retour de la m√©thode de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forme</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tensor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Donc, la valeur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">input_shape est Tensor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> check </font><font style="vertical-align: inherit;">semble au moins bizarre. </font><font style="vertical-align: inherit;">Peut-√™tre, une fois que la m√©thode a renvoy√© une valeur d'un type diff√©rent et que la v√©rification a eu un sens, mais il est √©galement possible qu'au lieu de Tensor, la condition sp√©cifie une sorte d'h√©ritier de cette classe. </font><font style="vertical-align: inherit;">D'une mani√®re ou d'une autre, le d√©veloppeur doit pr√™ter attention √† ce fragment.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V√©rification approfondie</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor[] _BaseFusedBatchNormGrad(....)<font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (data_format == <span class="hljs-string">"NCHW"</span>) <span class="hljs-comment">// &lt;=</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException(<span class="hljs-string">""</span>);<font></font>
<font></font>
  <span class="hljs-keyword">var</span> results = grad_fun(<span class="hljs-keyword">new</span> FusedBatchNormParams<font></font>
  {<font></font>
    YBackprop = grad_y,<font></font>
    X = x,<font></font>
    Scale = scale,<font></font>
    ReserveSpace1 = pop_mean,<font></font>
    ReserveSpace2 = pop_var,<font></font>
    ReserveSpace3 = version == <span class="hljs-number">2</span> ? op.outputs[<span class="hljs-number">5</span>] : <span class="hljs-literal">null</span>,<font></font>
    Epsilon = epsilon,<font></font>
    DataFormat = data_format,<font></font>
    IsTraining = is_training<font></font>
  });<font></font>
<font></font>
  <span class="hljs-keyword">var</span> (dx, dscale, doffset) = (results[<span class="hljs-number">0</span>], results[<span class="hljs-number">1</span>], results[<span class="hljs-number">2</span>]);
  <span class="hljs-keyword">if</span> (data_format == <span class="hljs-string">"NCHW"</span>) <span class="hljs-comment">// &lt;=</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException(<span class="hljs-string">""</span>);<font></font>
<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avertissements de l'analyseur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3021</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il existe deux instructions 'if' avec des expressions conditionnelles identiques. </font><font style="vertical-align: inherit;">La premi√®re instruction ¬´if¬ª contient la m√©thode return. </font><font style="vertical-align: inherit;">Cela signifie que la deuxi√®me instruction ¬´if¬ª est insens√©e nn_grad.cs 230</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3022 L'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> expression 'data_format == "NCHW"' est toujours fausse. </font><font style="vertical-align: inherit;">nn_grad.cs 247</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contrairement √† certains des exemples pr√©c√©dents, il y a clairement un probl√®me avec le code. </font><font style="vertical-align: inherit;">La deuxi√®me v√©rification n'a aucun sens, car si la condition est vraie, l'ex√©cution du programme ne l'atteindra pas du tout. </font><font style="vertical-align: inherit;">Peut-√™tre que certaines fautes de frappe sont autoris√©es ici, ou l'une des v√©rifications est g√©n√©ralement superflue.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'illusion du choix</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> Tensor <span class="hljs-title">Activate</span>(<span class="hljs-params">Tensor x, <span class="hljs-keyword">string</span> name = <span class="hljs-literal">null</span></span>)</span><font></font>
{<font></font>
  ....<font></font>
  Tensor negative_part;<font></font>
  <span class="hljs-keyword">if</span> (Math.Abs(_threshold) &gt; <span class="hljs-number">0.000001f</span>)<font></font>
  {<font></font>
    negative_part = gen_ops.relu(-x + _threshold);<font></font>
  } <span class="hljs-keyword">else</span><font></font>
  {<font></font>
    negative_part = gen_ops.relu(-x + _threshold);<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avertissement de l'analyseur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3004</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> L' </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">instruction</font></a><font style="vertical-align: inherit;"> 'then' est √©quivalente √† l'instruction 'else'. gen_nn_ops.activations.cs 156 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une d√©monstration plut√¥t amusante de l'efficacit√© de l'utilisation de l'analyse statique dans le d√©veloppement. Il est difficile de trouver une raison raisonnable pour laquelle le d√©veloppeur a √©crit ce code particulier - tr√®s probablement, il s'agit d'une erreur de copier-coller typique (bien que cela, bien s√ªr, puisse √™tre un autre "pour plus tard"). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe d'autres fragments d'un plan similaire, par exemple:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Operation _GroupControlDeps(
  <span class="hljs-keyword">string</span> dev, Operation[] deps, <span class="hljs-keyword">string</span> name = <span class="hljs-literal">null</span><font></font>
)<font></font>
{<font></font>
  <span class="hljs-keyword">return</span> tf_with(ops.control_dependencies(deps), ctl =&gt;<font></font>
  {<font></font>
    <span class="hljs-keyword">if</span> (dev == <span class="hljs-literal">null</span>)<font></font>
    {<font></font>
      <span class="hljs-keyword">return</span> gen_control_flow_ops.no_op(name);<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
      <span class="hljs-keyword">return</span> gen_control_flow_ops.no_op(name);<font></font>
    }<font></font>
  });<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avertissement de l'analyseur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3004</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> L' </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">instruction</font></a><font style="vertical-align: inherit;"> 'then' est √©quivalente √† l'instruction 'else'. </font><font style="vertical-align: inherit;">control_flow_ops.cs 135 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peut-√™tre une fois que la v√©rification avait du sens, mais au fil du temps elle a disparu, ou d'autres changements suppl√©mentaires sont pr√©vus √† l'avenir. </font><font style="vertical-align: inherit;">Cependant, ni l'une ni l'autre option ne semble √™tre une justification suffisante pour laisser quelque chose de similaire dans le code, sans expliquer cette bizarrerie en aucune fa√ßon. </font><font style="vertical-align: inherit;">Avec une probabilit√© √©lev√©e, une erreur de copier-coller a √©t√© faite exactement de la m√™me mani√®re.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ch√®que tardif</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor[] <span class="hljs-title">Input</span>(<span class="hljs-params"><span class="hljs-keyword">int</span>[] batch_shape = <span class="hljs-literal">null</span>,
  TF_DataType dtype = TF_DataType.DtInvalid,
  <span class="hljs-keyword">string</span> name = <span class="hljs-literal">null</span>,
  <span class="hljs-keyword">bool</span> sparse = <span class="hljs-literal">false</span>,
  Tensor tensor = <span class="hljs-literal">null</span></span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">var</span> batch_size = batch_shape[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">var</span> shape = batch_shape.Skip(<span class="hljs-number">1</span>).ToArray(); <span class="hljs-comment">// &lt;=</span><font></font>
<font></font>
  InputLayer input_layer = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">if</span> (batch_shape != <span class="hljs-literal">null</span>)                   <span class="hljs-comment">// &lt;=</span><font></font>
    ....<font></font>
  <span class="hljs-keyword">else</span><font></font>
    ....<font></font>
<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avertissement de l'analyseur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> L'objet 'batch_shape' a √©t√© utilis√© avant d'√™tre v√©rifi√© par rapport √† null. </font><font style="vertical-align: inherit;">V√©rifiez les lignes: 39, 42. keras.layers.cs 39 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une erreur classique et plut√¥t dangereuse de l'utilisation potentielle d'une variable, qui n'est un lien vers nulle part. </font><font style="vertical-align: inherit;">Dans ce cas, le code implique explicitement la possibilit√© que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">batch_shape</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> soit </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - cela ressort clairement √† la fois de la liste des arguments et de la v√©rification ult√©rieure de la m√™me variable. </font><font style="vertical-align: inherit;">Ainsi, l'analyseur indique ici une erreur claire.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un autre "pour plus tard"?</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MnistDataSet</span>(<span class="hljs-params">
  NDArray images, NDArray labels, Type dataType, <span class="hljs-keyword">bool</span> reshape // &lt;=
</span>)</span> <font></font>
{<font></font>
  EpochsCompleted = <span class="hljs-number">0</span>;<font></font>
  IndexInEpoch = <span class="hljs-number">0</span>;<font></font>
<font></font>
  NumOfExamples = images.shape[<span class="hljs-number">0</span>];<font></font>
<font></font>
  images = images.reshape(<font></font>
    images.shape[<span class="hljs-number">0</span>], images.shape[<span class="hljs-number">1</span>] * images.shape[<span class="hljs-number">2</span>]<font></font>
  );<font></font>
  images = images.astype(dataType);<font></font>
  <span class="hljs-comment">// for debug np.multiply performance</span>
  <span class="hljs-keyword">var</span> sw = <span class="hljs-keyword">new</span> Stopwatch();<font></font>
  sw.Start();<font></font>
  images = np.multiply(images, <span class="hljs-number">1.0f</span> / <span class="hljs-number">255.0f</span>);<font></font>
  sw.Stop();<font></font>
  Console.WriteLine(<span class="hljs-string">$"<span class="hljs-subst">{sw.ElapsedMilliseconds}</span>ms"</span>);<font></font>
  Data = images;<font></font>
<font></font>
  labels = labels.astype(dataType);<font></font>
  Labels = labels;<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avertissement de l'analyseur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : le </font><font style="vertical-align: inherit;">param√®tre de constructeur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3117</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'remodeler' n'est pas utilis√©. </font><font style="vertical-align: inherit;">MnistDataSet.cs 15 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme certaines autres bizarreries, cela est probablement d√ª au fait que la fonctionnalit√© est loin d'√™tre compl√®tement impl√©ment√©e et il est fort possible que le param√®tre de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remodelage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> soit utilis√© d'une mani√®re ou d'une autre dans ce constructeur √† l'avenir. </font><font style="vertical-align: inherit;">Mais pour le moment, il semble qu'il soit jet√© ici comme √ßa. </font><font style="vertical-align: inherit;">Si cela est vraiment fait "pour plus tard", alors il serait sage de le marquer avec un commentaire. </font><font style="vertical-align: inherit;">Sinon, il s'av√®re que le code qui construit l'objet devra lancer un param√®tre suppl√©mentaire dans le constructeur, et il est fort possible qu'il serait plus pratique de ne pas le faire.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©r√©f√©rence nulle possible insaisissable</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor[] _GatherV2Grad(Operation op, Tensor[] grads)<font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span>((<span class="hljs-keyword">int</span>)axis_static == <span class="hljs-number">0</span>)<font></font>
  {<font></font>
    <span class="hljs-keyword">var</span> params_tail_shape = params_shape.slice(<span class="hljs-keyword">new</span> NumSharp.Slice(start:<span class="hljs-number">1</span>));
    <span class="hljs-keyword">var</span> values_shape = array_ops.concat(
      <span class="hljs-keyword">new</span>[] { indices_size, params_tail_shape }, <span class="hljs-number">0</span><font></font>
    );<font></font>
    <span class="hljs-keyword">var</span> values = array_ops.reshape(grad, values_shape);<font></font>
    indices = array_ops.reshape(indices, indices_size);<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Tensor[]<font></font>
    {<font></font>
      <span class="hljs-keyword">new</span> IndexedSlices(values, indices, params_shape), <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-literal">null</span>,
      <span class="hljs-literal">null</span><font></font>
    };<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avertissement de l'analyseur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3146 D√©r√©f√©rence</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nulle possible du 1er argument 'valeurs' √† l'int√©rieur de la m√©thode. Le '_outputs.FirstOrDefault ()' peut retourner la valeur nulle par d√©faut. array_grad.cs 199 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour comprendre le probl√®me, vous devez d'abord vous tourner vers le </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">code</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> constructeur </font><i><font style="vertical-align: inherit;">indexedSlices</font></i><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">IndexedSlices</span>(<span class="hljs-params">
  Tensor values, Tensor indices, Tensor dense_shape = <span class="hljs-literal">null</span>
</span>)</span><font></font>
{<font></font>
  _values = values;<font></font>
  _indices = indices;<font></font>
  _dense_shape = dense_shape;<font></font>
<font></font>
  _values.Tag = <span class="hljs-keyword">this</span>; <span class="hljs-comment">// &lt;=</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âvidemment, passer </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √† ce constructeur l√®vera une exception. Cependant, pourquoi l'analyseur consid√®re-t-il que la variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">values</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> peut contenir </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVS-Studio utilise la technique d'analyse de flux de donn√©es, qui vous permet de trouver les ensembles de valeurs possibles de variables dans diff√©rentes parties du code. Un avertissement vous indique que null dans la variable sp√©cifi√©e peut √™tre renvoy√© avec la ligne suivante: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_outputs.FirstOrDefault ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Cependant, en regardant le code ci-dessus, vous pouvez constater que la valeur de la variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">values</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est </font><font style="vertical-align: inherit;">obtenue en appelant </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">array_ops.reshape (grad, values_shape)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Alors d'o√π vient </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_outputs.FirstOrDefault ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le fait est que lors de l'analyse du flux de donn√©es, non seulement la fonction actuelle est prise en compte, mais aussi toutes appel√©es; </font><font style="vertical-align: inherit;">PVS-Studio obtient des informations sur l'ensemble des valeurs possibles de n'importe quelle variable n'importe o√π. </font><font style="vertical-align: inherit;">Ainsi, un avertissement signifie que l'impl√©mentation de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">array_ops.reshape (grad, values_shape)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contient un appel √† </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_outputs.FirstOrDefault ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dont le r√©sultat est finalement renvoy√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour v√©rifier cela, acc√©dez √† l'impl√©mentation de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remodelage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor reshape&lt;T1, T2&gt;(T1 tensor, T2 shape, <span class="hljs-keyword">string</span> name = <span class="hljs-literal">null</span>)<font></font>
            =&gt; gen_array_ops.reshape(tensor, shape, <span class="hljs-literal">null</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, allez √† la m√©thode de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remodelage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> appel√©e √† l'int√©rieur:</font></font><br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor reshape&lt;T1, T2&gt;(T1 tensor, T2 shape, <span class="hljs-keyword">string</span> name = <span class="hljs-literal">null</span>)<font></font>
{<font></font>
  <span class="hljs-keyword">var</span> _op = _op_def_lib._apply_op_helper(
    <span class="hljs-string">"Reshape"</span>, name, <span class="hljs-keyword">new</span> { tensor, shape }<font></font>
  );<font></font>
  <span class="hljs-keyword">return</span> _op.output;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_apply_op_helper</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> renvoie un objet de la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Operation</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qui contient la propri√©t√© de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sortie</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . C'est √† r√©ception de sa valeur que le code d√©crit dans l'avertissement est appel√©:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> Tensor output =&gt; _outputs.FirstOrDefault();</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le tenseur</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est, bien s√ªr, un type de r√©f√©rence, donc la valeur par d√©faut pour lui sera </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulle</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">De tout cela, on peut voir que PVS-Studio analyse m√©ticuleusement la structure logique du code, p√©n√©trant profond√©ment dans la structure des appels. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'analyseur a termin√© son travail, indiquant un endroit potentiellement probl√©matique. </font><font style="vertical-align: inherit;">Le programmeur doit v√©rifier si une situation peut survenir lorsque des √©l√©ments dans </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_outputs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sont absents. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, l'analyse statique obligera au moins le d√©veloppeur √† pr√™ter attention au fragment suspect afin d'√©valuer si l'erreur peut r√©ellement s'y produire. </font><font style="vertical-align: inherit;">Avec cette approche, le nombre d'erreurs qui passent inaper√ßu sera rapidement r√©duit.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attente peu fiable?</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> (LoopVar&lt;TItem&gt;, Tensor[]) _BuildLoop&lt;TItem&gt;(<font></font>
  ....<font></font>
) <span class="hljs-keyword">where</span> ....<font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-comment">// Finds the closest enclosing non-None control pivot.</span>
  <span class="hljs-keyword">var</span> outer_context = _outer_context;
  <span class="hljs-keyword">object</span> control_pivot = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">while</span> (outer_context != <span class="hljs-literal">null</span> &amp;&amp; control_pivot == <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;=</span><font></font>
  {<font></font>
<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">if</span> (control_pivot != <span class="hljs-literal">null</span>)<font></font>
  {<font></font>
<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avertissement de l'analyseur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3032 L'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> attente de cette expression n'est pas fiable, car le compilateur peut optimiser certaines des variables. </font><font style="vertical-align: inherit;">Utilisez des variables volatiles ou des primitives de synchronisation pour √©viter cela. </font><font style="vertical-align: inherit;">WhileContext.cs 212 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'analyseur indique qu'une telle impl√©mentation de l'attente peut √™tre optimis√©e par le compilateur, mais je doute qu'ils aient vraiment essay√© d'impl√©menter l'attente ici - tr√®s probablement, le code n'a tout simplement pas √©t√© ajout√© et il sera d√©velopp√© √† l'avenir. </font><font style="vertical-align: inherit;">Il peut √™tre utile de lancer une </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exception NotImplementedException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , √©tant donn√© que cette pratique est utilis√©e ailleurs dans le projet. </font><font style="vertical-align: inherit;">D'une mani√®re ou d'une autre, je pense que certains commentaires explicatifs ne feraient √©videmment pas de mal.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Briser les fronti√®res</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">TensorShape</span>(<span class="hljs-params"><span class="hljs-keyword">int</span>[][] dims</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span>(dims.Length == <span class="hljs-number">1</span>)<font></font>
  {<font></font>
    <span class="hljs-keyword">switch</span> (dims[<span class="hljs-number">0</span>].Length)<font></font>
    {<font></font>
      <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>: shape = <span class="hljs-keyword">new</span> Shape(<span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">0</span>]); <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: shape = Shape.Vector((<span class="hljs-keyword">int</span>)dims[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]); <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: shape = Shape.Matrix(dims[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>], dims[<span class="hljs-number">1</span>][<span class="hljs-number">2</span>]); <span class="hljs-keyword">break</span>; <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-keyword">default</span>: shape = <span class="hljs-keyword">new</span> Shape(dims[<span class="hljs-number">0</span>]); <span class="hljs-keyword">break</span>;<font></font>
    }<font></font>
  }<font></font>
  <span class="hljs-keyword">else</span><font></font>
  {<font></font>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException(<span class="hljs-string">"TensorShape int[][] dims"</span>);<font></font>
  }<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avertissement de l'analyseur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3106 L'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> index est peut-√™tre hors limite. L'index ¬´1¬ª pointe au-del√† de la limite ¬´dims¬ª. TensorShape.cs 107 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parmi les extraits de code √©tranges que j'ai vus, il y avait une vraie erreur, qui est tr√®s difficile √† remarquer. Le fragment suivant est erron√© ici: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dims [1] [2]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Obtenir un √©l√©ment avec l'index 1 √† partir d'un tableau d'un √©l√©ment est √©videmment une erreur. Dans le m√™me temps, si vous changez le fragment en </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dims [0] [2]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , une autre erreur appara√Æt - obtenir l'√©l√©ment avec l'index 2 du tableau </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dims [0]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dont la longueur dans ce cas est la branche 2. Ainsi, ce probl√®me s'est av√©r√© √™tre comme avec un "double fond".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans tous les cas, ce fragment de code doit √™tre √©tudi√© et corrig√© par le d√©veloppeur. </font><font style="vertical-align: inherit;">√Ä mon avis, cet exemple est une excellente illustration des performances de l'analyse de flux de donn√©es dans PVS-Studio.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Olepatka?</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> _init_from_args(<span class="hljs-keyword">object</span> initial_value = <span class="hljs-literal">null</span>, ....) <span class="hljs-comment">// &lt;=</span><font></font>
{<font></font>
  <span class="hljs-keyword">var</span> init_from_fn = initial_value.GetType().Name == <span class="hljs-string">"Func`1"</span>; <span class="hljs-comment">// &lt;=</span><font></font>
  ....<font></font>
  tf_with(...., scope =&gt;<font></font>
  {<font></font>
    ....<font></font>
    tf_with(...., <span class="hljs-keyword">delegate</span><font></font>
    {<font></font>
      initial_value = ops.convert_to_tensor(  <span class="hljs-comment">// &lt;=</span>
        init_from_fn ? (initial_value <span class="hljs-keyword">as</span> Func&lt;Tensor&gt;)():initial_value,<font></font>
        name: <span class="hljs-string">"initial_value"</span>,<font></font>
        dtype: dtype<font></font>
      );<font></font>
    });<font></font>
    _shape = shape ?? (initial_value <span class="hljs-keyword">as</span> Tensor).TensorShape;<font></font>
    _initial_value = initial_value <span class="hljs-keyword">as</span> Tensor; <span class="hljs-comment">// &lt;=</span><font></font>
    ....<font></font>
    _dtype = _initial_value.dtype.as_base_dtype(); <span class="hljs-comment">// &lt;=</span><font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_in_graph_mode)<font></font>
    {<font></font>
      ....<font></font>
<font></font>
      <span class="hljs-keyword">if</span> (initial_value != <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;=</span><font></font>
      {<font></font>
        ....<font></font>
      }<font></font>
<font></font>
      ....<font></font>
    }<font></font>
<font></font>
    ....<font></font>
  });<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour comprendre le code ci-dessus, il vaut √©galement la peine d'introduire l'impl√©mentation de la fonction tf_with:</font></font><br>
<br>
<pre><code class="cs hljs">[<span class="hljs-meta">DebuggerStepThrough</span>] <span class="hljs-comment">// with "Just My Code" enabled this lets the </span>
[<span class="hljs-meta">DebuggerNonUserCode()</span>]  <span class="hljs-comment">//debugger break at the origin of the exception</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> tf_with&lt;T&gt;(<font></font>
  T py, Action&lt;T&gt; action<font></font>
) <span class="hljs-keyword">where</span> T : ITensorFlowObject<font></font>
{<font></font>
  <span class="hljs-keyword">try</span><font></font>
  {<font></font>
    py.__enter__();<font></font>
    action(py);<font></font>
  }<font></font>
  <span class="hljs-keyword">finally</span><font></font>
  {<font></font>
    py.__exit__();<font></font>
    py.Dispose();<font></font>
  }<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avertissement de l'analyseur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : V3019 Il est possible qu'une variable incorrecte soit compar√©e √† null apr√®s la conversion de type √† l'aide du mot cl√© 'as'. V√©rifiez les variables 'initial_value', '_initial_value'. ResourceVariable.cs 137 </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_init_from_args</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est une fonction assez volumineuse, donc de nombreux fragments ont √©t√© omis. Vous pouvez le voir compl√®tement en cliquant sur le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lien</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Bien que l'avertissement au d√©but ne m'ait pas sembl√© vraiment s√©rieux, apr√®s avoir √©tudi√©, j'ai r√©alis√© que quelque chose n'allait vraiment pas avec le code. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, il convient de noter que la m√©thode peut √™tre appel√©e sans passer de param√®tres et par d√©faut, elle </font><font style="vertical-align: inherit;">sera </font><i><font style="vertical-align: inherit;">nulle</font></i><font style="vertical-align: inherit;"> dans </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">initial_value</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dans ce cas, une exception sera lev√©e sur la premi√®re ligne. </font><font style="vertical-align: inherit;">
Deuxi√®mement, la v√©rification</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valeur_initiale</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √† l'in√©galit√© </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulle</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> semble √©trange: si la valeur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">initiale est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vraiment devenue </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulle</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> apr√®s avoir appel√© </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ops.convert_to_tensor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , alors </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_initial_value</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> serait </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulle</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ce qui signifie que l'appel de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_initial_value.dtype.as_base_dtype () d√©clencherait</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √©galement une exception. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Analyzer indique que vous devrez peut-√™tre v√©rifier que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_initial_value</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais comme indiqu√© ci-dessus, la r√©f√©rence √† cette variable a lieu avant ce test, donc cette option serait √©galement incorrecte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette petite erreur serait-elle remarqu√©e dans une fonction aussi g√©ante sans PVS-Studio? </font><font style="vertical-align: inherit;">J'en doute beaucoup.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans un projet avec de nombreux exemples de code √©trange, de nombreux probl√®mes peuvent √™tre cach√©s. Le programmeur, habitu√© √† voir l'incompr√©hensible, cesse de remarquer des erreurs en m√™me temps. Les cons√©quences peuvent √™tre tr√®s tristes. En effet, parmi les avertissements de l'analyseur, il y en a aussi de faux, cependant, dans la plupart des cas, les avertissements indiquent au moins des fragments de code qui peuvent poser des questions lorsqu'ils sont vus par une personne. Dans le cas o√π le code √©trange est √©crit intentionnellement, cela vaut la peine de laisser des explications afin que le fragment soit clair pour le d√©veloppeur qui travaillera avec ce code √† l'avenir (m√™me si cela signifie laisser des commentaires pour lui-m√™me).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En m√™me temps, les outils d'analyse statique, tels que PVS-Studio, peuvent √™tre d'une grande aide pour trouver les erreurs et les bizarreries potentielles afin qu'elles soient visibles et non oubli√©es, et toutes les solutions temporaires sont ensuite affin√©es et transform√©es en un travail propre, structur√© et stable le code.</font></font><br>
<br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a></p><div style="text-align:center;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/eb2/f9c/3bb/eb2f9c3bb5f32f39239298d36431961c.png"></a></div><p></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous souhaitez partager cet article avec un public anglophone, veuillez utiliser le lien vers la traduction: Nikita Lipilin. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment un code √©trange masque-t-il les erreurs? </font><font style="vertical-align: inherit;">Analyse TensorFlow.NET</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr496234/index.html">La principale raison pour laquelle pas Linux</a></li>
<li><a href="../fr496238/index.html">Vingt-huit √©tapes pour survivre et r√©ussir dans une crise</a></li>
<li><a href="../fr496240/index.html">D√©couverte de produit 101 pour chef de produit</a></li>
<li><a href="../fr496242/index.html">Le cyberpunk est d√©j√† l√†: les √©coliers √©tudient √† Minecraft et les √©l√®ves passent des tests physiques dans CS: GO</a></li>
<li><a href="../fr496248/index.html">D√©fis, t√™tes chauves et vin. Comment nous, HFLabs, supportons l'auto-isolement</a></li>
<li><a href="../fr496252/index.html">Avion de centrage √† d√©calage a√©rodynamique</a></li>
<li><a href="../fr496254/index.html">Comment Rostelecom a redirig√© par erreur le trafic vers Google, AWS, Cloudflare, etc.</a></li>
<li><a href="../fr496256/index.html">Apprentissage automatique sur R: techniques expertes pour l'analyse pr√©dictive</a></li>
<li><a href="../fr496258/index.html">Holivar en ligne: un nouveau format pour l'√©change d'exp√©riences. Ce samedi</a></li>
<li><a href="../fr496260/index.html">Conseils de cybers√©curit√© pour travailler √† domicile</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>