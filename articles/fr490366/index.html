<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçæ üë©üèæ‚Äçüè≠ üî± Dois-je stocker des polices Google sur mon serveur? üï∫üèæ üÜë üí™üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Au cours des derni√®res semaines, par co√Øncidence au travail et dans des projets tiers, j'ai beaucoup appris sur les polices Web, ainsi que sur Google ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Dois-je stocker des polices Google sur mon serveur?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vdsina/blog/490366/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Au cours des derni√®res semaines, par co√Øncidence au travail et dans des projets tiers, j'ai beaucoup appris sur les polices Web, ainsi que sur Google Fonts en particulier. Gr√¢ce √† cela, je peux donner une r√©ponse plus d√©taill√©e √† une question qui me paraissait simple dans le pass√©: devriez-vous stocker des polices Google sur votre serveur?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Objectivement parlant, j'avoue que les polices ne sont pas mon fort. Je pr√©f√®re une approche plus pratique et ne me concentre pas sur le design (regardez ce site et assurez-vous qu'il l'est) et avant cela je ne ressentais pas le besoin d'utiliser des polices non standard. Bien s√ªr, ils ont l'air un peu plus agr√©ables et ¬´marquent¬ª le texte. Mais pour le texte principal, cela n'a gu√®re de sens. Je n'ai jamais √©valu√© l'article (ou li√© √† son contenu diff√©remment), simplement parce qu'une belle police a √©t√© utilis√©e pour le soumettre. Cependant, j'√©tais pleinement conscient de l'impact n√©gatif des polices suppl√©mentaires sur les performances et la vitesse de chargement des pages, alors je suis peut-√™tre biais√© √† cause de cela.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, beaucoup peuvent √™tre en d√©saccord avec moi, et les polices, qu'elles soient importantes pour moi personnellement ou non, sont r√©guli√®rement utilis√©es par de nombreux autres d√©veloppeurs, et souvent elles n'ont tout simplement pas le choix. </font><font style="vertical-align: inherit;">Voyons ce qui peut √™tre fait pour ne pas perdre en vitesse sur le site, et laissons les designers heureux.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auto-h√©berg√© vs ressources externes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a quelques ann√©es, il √©tait normal d'utiliser CDN pour connecter des ressources partag√©es (par exemple, jQuery avec </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">code.jquery.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://almanac."><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oui, ils l'utilisent encore beaucoup</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Pour clarifier, par CDN ici, je veux dire charger des ressources √† partir du domaine de quelqu'un d'autre, pas de votre propre CDN. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La raison en √©tait que les navigateurs √©taient cens√©s limiter le nombre de connexions √† chaque domaine (g√©n√©ralement √† 6 connexions), donc l'utilisation d'un autre domaine vous a donn√© 6 autres connexions. Cela pouvait √™tre vrai dans le pass√© (en particulier lorsque la restriction √©tait &lt;6 domaines) et avant que le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.tunetheweb.com/security/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTPS ne</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> devienne la norme, ce </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui augmentait consid√©rablement</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> les </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">co√ªts de</font></a><font style="vertical-align: inherit;"> connexion. De plus, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.tunetheweb.com/performance/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTP / 2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b√©n√©ficie en fait de l'utilisation d'une connexion (surtout!), donc l'utilisation d'autres domaines est souvent une perte de performances plut√¥t qu'une acquisition. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une autre fa√ßon d'y parvenir √©tait de diviser le domaine principal avec un ou plusieurs sous-domaines techniques (par exemple, assets.example.com), et dans ce cas, les polices n'apparaissent pas √† nouveau sur votre domaine principal, d'o√π votre page Web est charg√©e. N√©anmoins, cette m√©thode a les m√™mes probl√®mes de connexion, donc cela ne peut pas √™tre appel√© un gain de performances, m√™me si c'√©tait le cas auparavant. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre avantage d'un CDN public √©tait la forte probabilit√© que les visiteurs aient d√©j√† cette version de jQuery conditionnelle dans le cache. Mais, encore une fois, je suis convaincu que c'est trop. Il y a tellement de biblioth√®ques et leurs versions, et</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.speedshop.co/2015/11/05/page-weight-doesnt-matter.html&amp;usg=ALkJrhjlim2ny3sVNqDRmmBgyPDW2dHH2Q#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le cache du navigateur est plus petit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qu'il n'y para√Æt, une telle correspondance est donc tr√®s peu probable. De plus, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Safari utilise un cache HTTP unique</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour chaque domaine visit√©, pour des raisons de confidentialit√© (cache √† double cl√©), et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chrome introduira √©galement cette fonction prochainement</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ainsi, il n'y a plus rien √† discuter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce sujet se transforme en une conversation sur l'impact des CDN tiers sur la confidentialit√©. Vous ne savez pas comment et pourquoi ils suivent vos utilisateurs, ce qui ne peut pas arriver avec une solution auto-h√©berg√©e. Et les r√©centes innovations de la loi obligent de nombreux sites √† r√©pertorier explicitement tous les cookies utilis√©s sur le site. Ce n'est pas la t√¢che la plus simple lors de l'utilisation de CDN tiers.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depuis longtemps, je suis convaincu que les CDN tiers ou m√™me le partage de vos propres domaines sont tr√®s loin du gain de performance promis. Trop souvent, vous pouvez trouver des sites o√π le domaine principal ne distribue que index.html, puis </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perdre beaucoup de temps √† configurer de nouvelles connexions</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sans parler des implications de s√©curit√© du t√©l√©chargement de ressources √† partir de sites tiers. Oui, il y a le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SRI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais cela peut </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://nooshu.github.io/blog/2019/12/17/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">causer des probl√®mes inattendus</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et honn√™tement, je ne vois pas l'int√©r√™t. S'il s'agit d'une ressource statique (o√π vous pouvez utiliser SRI), puis stockez-la localement, et si elle n'est pas statique (car le contenu peut changer), vous ne pouvez pas utiliser SRI.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, l'utilisation de ressources provenant de sources tierces menace de devenir un point de d√©faillance unique (SPOF) et de d√©sactiver votre site. </font><font style="vertical-align: inherit;">Cela s'est </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">produit plus d'une fois</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et bien qu'il puisse sembler peu probable que les polices Google tombent, elles peuvent √™tre bloqu√©es par les mandataires de l'entreprise ou par </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">des pays entiers</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En g√©n√©ral, de plus en plus de gens conseillent </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de garder leurs ressources statiques √† la maison</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , id√©alement sur le domaine √† partir duquel vous distribuez des pages Web. </font><font style="vertical-align: inherit;">Les polices sont des ressources statiques, donc la m√™me chose s'applique √† elles, non? </font><font style="vertical-align: inherit;">Eh bien, il s'av√®re que tout n'est pas si simple, car les polices ont leurs propres particularit√©s et techniques d'optimisation, ce qui peut rendre le stockage local un peu plus compliqu√© ...</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Fonts et leur fonctionnement</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Fonts</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est une ressource g√©niale si vous aimez les polices. 977 polices gratuites que tout le monde peut utiliser gratuitement. Les polices commerciales sont souvent ridiculement ch√®res et g√©n√©ralement sous licence plut√¥t que vendues, c'est-√†-dire que les frais sont factur√©s en fonction du nombre attendu de pages vues. Par cons√©quent, avoir autant de polices gratuites et si faciles √† utiliser dans une collection est tr√®s utile. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais ce n'est pas tout. Google Fonts, comme de nombreux fournisseurs de ressources pour les sites (voir l'exemple jQuery ci-dessus), fournit des CDN et stocke des polices que tout le monde peut utiliser directement √† partir de ses serveurs. Cela signifie que vous pouvez commencer √† utiliser des polices en ajoutant simplement une ligne de code sur votre site pour charger la feuille de style:</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.googleapis.com/css?family=Lato&amp;display=swap"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez √©galement ajouter plus de propri√©t√©s et de polices sur une seule ligne pour charger plusieurs polices et variantes de chacune d'entre elles:</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.googleapis.com/css?family=Lato:400,400i,700,700i,900%7CPoppins:300,400,700,900&amp;display=swap"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'inconv√©nient est une baisse des performances (l'avantage est √©galement dans les performances, mais ce n'est pas si √©vident, nous y arriverons). </font><font style="vertical-align: inherit;">Le probl√®me est que votre site (par exemple </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.example.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) charge une feuille de style √† partir de fonts.googleapis.com, qui renvoie du CSS avec des r√®gles de police. </font><font style="vertical-align: inherit;">Voici la source du lien dans l'exemple ci-dessus:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-comment">/* latin-ext */</span>
<span class="hljs-keyword">@font-face</span> {
  <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Lato'</span>;
  <span class="hljs-attribute">font-style</span>: normal;
  <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">400</span>;
  <span class="hljs-attribute">font-display</span>: swap;
  <span class="hljs-attribute">src</span>: <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato Regular'</span>), <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato-Regular'</span>), <span class="hljs-built_in">url</span>(https://fonts.gstatic.com/s/lato/v16/S6uyw4BMUTPHjxAwXiWtFCfQ7A.woff2) <span class="hljs-built_in">format</span>(<span class="hljs-string">'woff2'</span>);
  <span class="hljs-attribute">unicode-range</span>: U+<span class="hljs-number">0100</span>-<span class="hljs-number">024</span>F, U+<span class="hljs-number">0259</span>, U+<span class="hljs-number">1</span>E00-<span class="hljs-number">1</span>EFF, U+<span class="hljs-number">2020</span>, U+<span class="hljs-number">20</span>A0-<span class="hljs-number">20</span>AB, U+<span class="hljs-number">20</span>AD-<span class="hljs-number">20</span>CF, U+<span class="hljs-number">2113</span>, U+<span class="hljs-number">2</span>C60-<span class="hljs-number">2</span>C7F, U+A720-A7FF;<font></font>
}<font></font>
<span class="hljs-comment">/* latin */</span>
<span class="hljs-keyword">@font-face</span> {
  <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Lato'</span>;
  <span class="hljs-attribute">font-style</span>: normal;
  <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">400</span>;
  <span class="hljs-attribute">font-display</span>: swap;
  <span class="hljs-attribute">src</span>: <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato Regular'</span>), <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato-Regular'</span>), <span class="hljs-built_in">url</span>(https://fonts.gstatic.com/s/lato/v16/S6uyw4BMUTPHjx4wXiWtFCc.woff2) <span class="hljs-built_in">format</span>(<span class="hljs-string">'woff2'</span>);
  <span class="hljs-attribute">unicode-range</span>: U+<span class="hljs-number">0000</span>-<span class="hljs-number">00</span>FF, U+<span class="hljs-number">0131</span>, U+<span class="hljs-number">0152</span>-<span class="hljs-number">0153</span>, U+<span class="hljs-number">02</span>BB-<span class="hljs-number">02</span>BC, U+<span class="hljs-number">02</span>C6, U+<span class="hljs-number">02</span>DA, U+<span class="hljs-number">02</span>DC, U+<span class="hljs-number">2000</span>-<span class="hljs-number">206</span>F, U+<span class="hljs-number">2074</span>, U+<span class="hljs-number">20</span>AC, U+<span class="hljs-number">2122</span>, U+<span class="hljs-number">2191</span>, U+<span class="hljs-number">2193</span>, U+<span class="hljs-number">2212</span>, U+<span class="hljs-number">2215</span>, U+FEFF, U+FFFD;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous parlerons de ce que certains de ces param√®tres signifient plus tard (et aussi de la raison pour laquelle il existe deux r√®gles de police), mais pour l'instant cela signifie que vous pouvez utiliser cette police dans vos styles comme ceci:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-selector-tag">body</span> {
    <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Lato'</span>, sans-serif;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, vous devez maintenant vous connecter √† fonts.googleapis.com, t√©l√©charger CSS, puis vous connecter √† fonts.gstatic.com et t√©l√©charger les polices elles-m√™mes (pourquoi Google ne peut pas h√©berger √† la fois CSS et les polices sur le m√™me domaine - je ne comprends vraiment pas!). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les polices sont souvent d√©tect√©es par le navigateur avec un retard lors du chargement de la page (apr√®s tout, vous devez charger CSS pour trouver des liens vers celles-ci). Mais les polices Google sont d√©couvertes encore plus tard, car CSS doit √™tre t√©l√©charg√© √† partir d' </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un autre</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> domaine, puis les polices du troisi√®me domaine et, comme je l'ai mentionn√©, l'√©tablissement d'une connexion HTTPS n'est pas non plus instantan√©. Cela peut √™tre vu dans le diagramme en cascade ci-dessous g√©n√©r√© par </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebPageTest</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (notez que tous les tests ont √©t√© ex√©cut√©s avec Chrome - 3GSlow):</font></font><br>
<br>
<img src="https://habrastorage.org/webt/94/si/uk/94siukfgpsuc3y8vvcenns7d8rm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La ligne 1 montre que le HTML est charg√© en premier. </font><font style="vertical-align: inherit;">Ensuite, d√®s qu'il est t√©l√©charg√© et lu en moins de 2 secondes, le navigateur d√©tecte la n√©cessit√© de charger le CSS Google Fonts et le charge √† la ligne 4. Il faut une seconde pour √©tablir une connexion, puis un fichier est t√©l√©charg√© pendant 3,5 secondes. </font><font style="vertical-align: inherit;">Enfin, le navigateur a d√©couvert l'existence de notre police et la charge sur la ligne 6, apr√®s avoir perdu encore 1 ¬º de seconde sur le chemin de la connexion avec fonts.gstatic.com. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, l'utilisation de cette police de Google Fonts nous co√ªte trois secondes enti√®res de productivit√© √† partir du moment o√π le HTML est disponible, sans tenir compte du temps de t√©l√©chargement de la police elle-m√™me!</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acc√©l√©rer les polices Google en pr√©chargeant les ressources </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez att√©nuer ce terrible impact sur les performances lors du chargement de CSS et de polices de deux domaines diff√©rents. Le premier domaine (pour CSS) doit √™tre situ√© plus pr√®s du d√©but du fichier index.html afin que le navigateur le lise d√®s que possible, mais le second est toujours masqu√©. Cependant, nous savons √† quoi ressemblera ce domaine (fonts.gstatic.com), nous pouvons donc ouvrir la connexion √† l'avance afin de gagner du temps sur la deuxi√®me connexion plus tard:</font></font><br>
<br>
<pre><code class="xml hljs">
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.gstatic.com"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"preconnect"</span> <span class="hljs-attr">crossorigin</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.googleapis.com/css?family=Lato&amp;display=swap"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors du nouveau test, nous voyons l'image suivante: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/0-/ab/1r/0-ab1rf2caybdrxaloc5xrs6d0k.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, nous voyons que la connexion sur la ligne 5 est ouverte √† l'avance, avant de charger CSS. Nous gagnons donc plus d'une seconde (t√©l√©chargement de polices en 4 secondes, pas 5.25), car nous avons r√©ussi √† √©viter de perdre du temps lors de la connexion et les polices sont t√©l√©charg√©es imm√©diatement apr√®s la lecture des CSS Google Fonts. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pourriez penser que vous pouvez continuer et pr√©charger la police enti√®re, au lieu d'√™tre content de ne rejoindre que le domaine, mais Google Fonts appelle les polices des hachages uniques. Dans l'exemple ci-dessus, la police t√©l√©charg√©e s'appelle S6uyw4BMUTPHjx4wXg.woff2, pas lato.woff2, donc le pr√©chargement n'est pas possible sauf si vous voulez que votre site plante un jour lorsque Google d√©cide soudainement de changer ce hachage.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans tous les cas, si vous utilisez Google Fonts et n'avez pas l'intention de faire autre chose apr√®s avoir lu cette note, ajoutez au moins une connexion pr√©liminaire au domaine, si ce n'est pas d√©j√† fait. Ce n'est qu'une ligne de code et cela devrait am√©liorer consid√©rablement les performances de votre page. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, Google Fonts donne une commande similaire dans les en-t√™tes HTTP lors du rendu CSS:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1g/7n/lg/1g7nlg8c-qteofu6cr1t3eep2bi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais dans de nombreux cas, cela n'aidera pas beaucoup, car au moment o√π vous recevez les en-t√™tes de r√©ponse HTTP du serveur avec CSS, le navigateur sait d√©j√† que vous souhaitez vous connecter √† ce domaine pour t√©l√©charger des polices. </font><font style="vertical-align: inherit;">Il est donc pr√©f√©rable pour vous de le sp√©cifier dans le code HTML afin que la pr√©charge fonctionne plus t√¥t (peu importe qu'elle soit dupliqu√©e de cette mani√®re, la deuxi√®me tentative sera simplement ignor√©e). </font><font style="vertical-align: inherit;">Cependant, si votre page est toujours en cours de traitement au moment de la r√©ception des en-t√™tes du serveur CSS de Google Fonts et que le DOM n'est pas pr√™t (c'est peut-√™tre un signe de trop de JavaScript sur votre page?), Cela peut aider √† am√©liorer les performances lorsqu'il devient finalement clair quelle police √† t√©l√©charger.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Affichage des polices: √©change</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le code de font-face ci-dessus, vous pouvez voir la police-display: swap; line. Il s'agit d'une instruction relativement nouvelle. Il peut √™tre ajout√© √† la d√©claration de police et il indiquera au navigateur d'utiliser d'abord la solution de repli, c'est-√†-dire la police syst√®me (sans-serif dans cet exemple), puis la remplacer par la police r√©elle apr√®s l'avoir t√©l√©charg√©e. De cette fa√ßon, vous pouvez √©viter les retards dans le chargement du contenu lorsque la police n'a pas encore √©t√© charg√©e et √©galement am√©liorer les performances.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oui, cela conduit √† une √©pid√©mie de texte sans style (FOUT) - les m√™mes ¬´sauts¬ª de contenu pendant le chargement de la page, mais certaines personnes ne l'aiment pas (mon avis est d'accord, le contenu est plus important que le style, mais le texte sautant √† travers la page est ennuyeux, cependant cela peut √™tre att√©nu√© en modifiant la police de rechange). Une alternative est le texte flash invisible (FOIT). Dans ce cas, le texte est masqu√© jusqu'√† ce que la police apparaisse, ce qui retarde √©videmment le t√©l√©chargement et peut causer d'autres probl√®mes </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si du texte se charge, mais d'autres pas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> !</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans tous les cas, avant l'introduction de l'affichage des polices: swap, diff√©rents navigateurs traitaient cela diff√©remment - certains, comme IE et Edge, utilisaient FOUT, d'autres utilisaient FOIT, et ils avaient des temps diff√©rents avant d'attendre que les polices attendent. Pour cette raison, si la police ne se chargeait pas, votre contenu pourrait rester invisible pendant longtemps. L'introduction de font-display: swap a permis aux d√©veloppeurs de sites Web de d√©cider par eux-m√™mes comment cela se produirait. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La plupart des navigateurs prennent en charge l'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> affichage de police: swap, √† l'exception d'IE et Edge, mais comme mentionn√© ci-dessus, ils l'utilisent par d√©faut de toute fa√ßon. Les polices Google </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prennent √©galement en charge</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diverses options d'affichage des polices et offrent l'affichage des polices: permuter par d√©faut.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, une autre astuce si vous utilisez les polices Google est de v√©rifier que vous avez le param√®tre &amp; display = swap dans l'URL, et si ce n'est pas le cas (il n'a √©t√© pris en charge que r√©cemment), ajoutez-le: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, remplacez ceci:</font></font><br>
<br>
<pre><code class="xml hljs">
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.gstatic.com"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"preconnect"</span> <span class="hljs-attr">crossorigin</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.googleapis.com/css?family=Lato"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur ce:</font></font><br>
<br>
<pre><code class="xml hljs">
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.gstatic.com"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"preconnect"</span> <span class="hljs-attr">crossorigin</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.googleapis.com/css?family=Lato&amp;display=swap"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez √©galement </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sp√©cifier l'une des autres valeurs d'affichage de police</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , par exemple </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">facultative</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , si vous le souhaitez. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malheureusement, cela ne r√©sout que la moiti√© du probl√®me. </font><font style="vertical-align: inherit;">Cette instruction est en CSS, qui renvoie les polices Google, elle n'est donc utile qu'apr√®s avoir t√©l√©charg√© le fichier CSS. </font><font style="vertical-align: inherit;">Ainsi, cela aide √† faire face au retard lors du chargement des polices elles-m√™mes, mais cela n'aide pas pendant que vous attendez le chargement de ce CSS. </font><font style="vertical-align: inherit;">C'est donc une bonne am√©lioration (au moins pour ceux qui pr√©f√®rent FOUT), mais toujours pas la solution dans son ensemble.</font></font><br>
<br>
<h2>  Google Fonts</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aid√© √† cr√©er Web Almanac</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (un aper√ßu fantastique de l'√©tat d'Internet - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://almanac."><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">voyez par</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vous-m√™me si vous ne l'avez pas encore vu) et le lent t√©l√©chargement des polices Google sur notre site m'a √©nerv√© et je voulais le r√©parer. Surtout FOUT avec affichage de police: √©change. Je me demandais si nous pouvions r√©duire l'impact de cela, et la solution locale semblait stocker des fichiers localement, √©ventuellement en utilisant le pr√©chargement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons d√©j√† utilis√© les techniques ci-dessus (pr√©chargement et affichage des polices: swap;), mais, bien s√ªr, il serait pr√©f√©rable de s'√©loigner de la connexion CSS de l'ext√©rieur. Nous savons ce qu'il y aura dans ce CSS. Alors, choisissez en toute confiance auto-h√©berg√©? C'est l√† que √ßa devient int√©ressant ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai trouv√© un script pratique sur GitHub ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Font Download</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), ce qui m'a aid√© √† t√©l√©charger toutes les diff√©rentes options de police (car il y en avait beaucoup, jusqu'√† 9 selon la page), puis √† copier le CSS, qu'il affichait dans notre feuille de style principale, et √† t√©l√©charger les polices sur le serveur. Il existe d' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">autres outils en ligne</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qui font de m√™me. Tout semblait fonctionner, et nous nous sommes d√©barrass√©s du chargement CSS ennuyeux et de la n√©cessit√© de travailler avec deux domaines. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, en y regardant de plus pr√®s, j'ai remarqu√© que les polices √©taient plus grandes:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1w/hk/fs/1whkfsun5mb15p76jzen2eft4wk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, il y a eu une augmentation significative de la taille (jusqu'√† 74% suppl√©mentaires pour certains d'entre eux!) Par rapport aux polices Google t√©l√©charg√©es (√† droite) et aux polices plac√©es localement (√† gauche). Au d√©but, je pensais que cela √©tait d√ª √† mon serveur Web local, par exemple, en raison de la d√©sactivation de la compression. Mais les polices WOFF2 sont servies sans compression par le serveur Web - ou du moins il devrait l'√™tre - puisque le format inclut la compression Brotli. De plus, la capture d'√©cran ci-dessus montre les octets t√©l√©charg√©s (noirs en haut), ainsi que les octets non compress√©s (l√©g√®rement plus l√©gers en bas) pour chaque colonne (ils sont assez similaires dans les deux colonnes, car les polices sont vraiment envoy√©es sans compression par le serveur Web, mais les octets t√©l√©charg√©s incluent des en-t√™tes HTTP , donc ils sont un peu plus grands), et il y avait des diff√©rences dans les octets compress√©s et non compress√©s, donc ce n'est pas la question.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La comparaison des r√®gles de police de caract√®res obtenues √† l'aide de l'outil avec celles d'origine a r√©v√©l√© une diff√©rence: de </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Google Fonts:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-comment">/* latin-ext */</span>
<span class="hljs-keyword">@font-face</span> {
    <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Lato'</span>;
    <span class="hljs-attribute">font-style</span>: normal;
    <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">400</span>;
    <span class="hljs-attribute">font-display</span>: swap;
    <span class="hljs-attribute">src</span>: <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato Regular'</span>), <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato-Regular'</span>), <span class="hljs-built_in">url</span>(https://fonts.gstatic.com/s/lato/v16/S6uyw4BMUTPHjxAwXiWtFCfQ7A.woff2) <span class="hljs-built_in">format</span>(<span class="hljs-string">'woff2'</span>);
    <span class="hljs-attribute">unicode-range</span>: U+<span class="hljs-number">0100</span>-<span class="hljs-number">024</span>F, U+<span class="hljs-number">0259</span>, U+<span class="hljs-number">1</span>E00-<span class="hljs-number">1</span>EFF, U+<span class="hljs-number">2020</span>, U+<span class="hljs-number">20</span>A0-<span class="hljs-number">20</span>AB, U+<span class="hljs-number">20</span>AD-<span class="hljs-number">20</span>CF, U+<span class="hljs-number">2113</span>, U+<span class="hljs-number">2</span>C60-<span class="hljs-number">2</span>C7F, U+A720-A7FF;<font></font>
}<font></font>
<span class="hljs-comment">/* latin */</span>
<span class="hljs-keyword">@font-face</span> {
    <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Lato'</span>;
    <span class="hljs-attribute">font-style</span>: normal;
    <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">400</span>;
    <span class="hljs-attribute">font-display</span>: swap;
    <span class="hljs-attribute">src</span>: <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato Regular'</span>), <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato-Regular'</span>), <span class="hljs-built_in">url</span>(https://fonts.gstatic.com/s/lato/v16/S6uyw4BMUTPHjx4wXiWtFCc.woff2) <span class="hljs-built_in">format</span>(<span class="hljs-string">'woff2'</span>);
    <span class="hljs-attribute">unicode-range</span>: U+<span class="hljs-number">0000</span>-<span class="hljs-number">00</span>FF, U+<span class="hljs-number">0131</span>, U+<span class="hljs-number">0152</span>-<span class="hljs-number">0153</span>, U+<span class="hljs-number">02</span>BB-<span class="hljs-number">02</span>BC, U+<span class="hljs-number">02</span>C6, U+<span class="hljs-number">02</span>DA, U+<span class="hljs-number">02</span>DC, U+<span class="hljs-number">2000</span>-<span class="hljs-number">206</span>F, U+<span class="hljs-number">2074</span>, U+<span class="hljs-number">20</span>AC, U+<span class="hljs-number">2122</span>, U+<span class="hljs-number">2191</span>, U+<span class="hljs-number">2193</span>, U+<span class="hljs-number">2212</span>, U+<span class="hljs-number">2215</span>, U+FEFF, U+FFFD;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depuis l'outil de t√©l√©chargement:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-keyword">@font-face</span> {
    <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Lato'</span>;
    <span class="hljs-attribute">font-style</span>: normal;
    <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">400</span>;
    <span class="hljs-attribute">src</span>:
        <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato Regular'</span>),
        <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato-Regular'</span>),
        <span class="hljs-comment">/* from https://fonts.gstatic.com/s/lato/v16/S6uyw4BMUTPHjx4wXg.woff2 */</span>
        <span class="hljs-built_in">url</span>(<span class="hljs-string">'Lato_400.woff2'</span>) <span class="hljs-built_in">format</span>(<span class="hljs-string">'woff2'</span>),
        <span class="hljs-comment">/* from https://fonts.gstatic.com/s/lato/v16/S6uyw4BMUTPHjx4wWA.woff */</span>
        <span class="hljs-built_in">url</span>(<span class="hljs-string">'Lato_400.woff'</span>) <span class="hljs-built_in">format</span>(<span class="hljs-string">'woff'</span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La premi√®re diff√©rence est que nous avons perdu la police d'affichage: swap line, mais cela peut √™tre corrig√© sans probl√®me. </font><font style="vertical-align: inherit;">Beaucoup plus int√©ressant est le fait que Google Fonts distribue deux polices - et inclut diff√©rentes plages Unicode. </font><font style="vertical-align: inherit;">Cela est d√ª au sous-ensemble de polices et r√©duit les fichiers de polices.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sous-ensemble de polices</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le sous-ensemble de polices est la suppression des caract√®res que vous n'allez pas utiliser pour r√©duire la taille du fichier de police. En r√®gle g√©n√©rale, la plupart des occidentaux n'utilisent que des caract√®res latins, et t√©l√©charger une police avec tous les caract√®res que vous n'utiliserez probablement pas est irrationnel. J'en avais entendu parler auparavant, mais je n'ai jamais pens√© √† quel point cela pouvait √™tre important! Google Fonts affiche automatiquement une police avec un ensemble de caract√®res latins et, si possible, connecte une deuxi√®me police pour les caract√®res latins √©tendus (par exemple, ƒÄ), qui ne sera t√©l√©charg√©e que si n√©cessaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, vous pouvez √©galement demander une police sp√©ciale qui ne contient que les caract√®res dont vous avez besoin avec le param√®tre text: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://fonts.googleapis.com/css?family=Lato&amp;text=ABC</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä en juger par d'autres observations, l'outil de chargement de polices que j'ai utilis√© prend apparemment en charge le sous-ensemble de polices, mais uniquement pour l'ensemble de la ¬´langue¬ª (latin ou latin √©tendu), et il combine les deux sous-ensembles de caract√®res dans un seul fichier. </font><font style="vertical-align: inherit;">√Ä la fin, je suis retourn√© √† l'utilisation de ce que mon navigateur utilisait et j'ai cess√© d'utiliser cet outil. </font><font style="vertical-align: inherit;">Cela a donn√© des tailles de fichier similaires (avec une l√©g√®re diff√©rence en raison des en-t√™tes HTTP dans mon environnement de d√©veloppement), mais j'ai rapidement constat√© qu'il ne s'agissait pas uniquement d'un sous-ensemble de polices.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Fonts distribue intelligemment les polices</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les polices Google ne rendent pas toujours le m√™me CSS et cela </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√©pend de l'agent utilisateur utilis√©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Par exemple, pour Internet Explorer 11, il envoie les informations suivantes:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-keyword">@font-face</span> {
    <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Lato'</span>;
    <span class="hljs-attribute">font-style</span>: normal;
    <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">400</span>;
    <span class="hljs-attribute">font-display</span>: swap;
    <span class="hljs-attribute">src</span>: <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato Regular'</span>), <span class="hljs-built_in">local</span>(<span class="hljs-string">'Lato-Regular'</span>), <span class="hljs-built_in">url</span>(https://fonts.gstatic.com/s/lato/v16/S6uyw4BMUTPHjx4wWA.woff) <span class="hljs-built_in">format</span>(<span class="hljs-string">'woff'</span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, vous pouvez voir qu'il ne fournit que le format WOFF, car IE 11 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne prend pas en charge WOFF2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et pour la m√™me raison, la plage unicode n'est pas sp√©cifi√©e. Il donne font-display: swap (comme je l'ai soulign√© dans l'URL pour CSS), bien que le navigateur ne le supporte pas, mais cela ne nuit pas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce n'est pas seulement le fabricant et la version du navigateur. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conseil de police</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inclut des instructions suppl√©mentaires dans le fichier de police, qui sont ensuite utilis√©es pour fournir le meilleur affichage de la police - en particulier sur les √©crans √† faible r√©solution ou pour les tr√®s petites tailles. L'affichage des polices est utilis√© sur Windows, mais pas sur MacOS, donc selon le syst√®me d'exploitation avec lequel vous travaillez lors de la r√©ception des polices Google, √† l'aide d'un navigateur (m√™me si vous utilisez Chrome sur chaque plate-forme), vous pouvez obtenir des fichiers de polices avec affichage ou sans lui. Si vous t√©l√©chargez la version Windows et l'utilisez vous-m√™me, les utilisateurs de MacOS souffriront en fait de la n√©cessit√© de traiter de gros fichiers de polices remplis d'indices inutilis√©s, et si vous faites le contraire, vous risquez de faire en sorte que les utilisateurs de Windows souffrent d'un affichage des polices pire, sans indication de police.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque j'ai utilis√© Google Fonts et que j'ai t√©l√©charg√© des polices pour une utilisation locale, je l'ai fait sur mon Mac, j'ai donc obtenu des fichiers plus petits. </font><font style="vertical-align: inherit;">Lorsque j'ai utilis√© l'outil, j'ai obtenu des polices compl√®tes, avec des indices. </font><font style="vertical-align: inherit;">C'√©tait donc une autre raison de la grande diff√©rence de taille! </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'indice de police est-il toujours pertinent</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, car les √©crans haute d√©finition sont devenus plus courants - c'est une bonne question, et de nombreuses polices sont initialement livr√©es sans allusion, car il faut beaucoup de temps pour les cr√©er. </font><font style="vertical-align: inherit;">Lorsqu'il est pr√©sent - il peut augmenter consid√©rablement la taille de la police. </font><font style="vertical-align: inherit;">Dans le cas de Lato, la taille est doubl√©e. </font><font style="vertical-align: inherit;">Cela vaut-il la charge de travail suppl√©mentaire que vous rencontrerez en abandonnant les polices Google et en localisant les polices localement? </font><font style="vertical-align: inherit;">C'est une autre d√©cision que vous devez prendre pour vous-m√™me.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, Google Fonts CDN est pris en charge par un script intelligent qui donne les polices les plus appropri√©es, les optimisant pour maintenir des performances maximales. En passant au stockage local des polices, vous devrez configurer tout cela vous-m√™me, et vous risquez de perdre l'affichage correct de vos polices dans certains navigateurs si vous ne le faites pas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour Web Almanac, nous avons examin√© les statistiques sur les navigateurs des visiteurs et d√©cid√© de ne prendre en charge que WOFF2, et d'utiliser √©galement des versions de MacOS sans allusion, car elles p√®sent deux fois moins. Ce CSS simplifi√© (d'autant plus que la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plage unicode est</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> prise en charge par tous les navigateurs qui </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prennent en charge WOFF2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), et les utilisateurs d'IE 11 et d'autres anciens navigateurs voient par d√©faut sans-serif, ce qui ne semble pas tr√®s bon, mais √† notre avis, les polices sont une am√©lioration progressive, et m√™me sans elles, le site est encore plus qu'utilisable. En outre, les anciens navigateurs peuvent m√™me b√©n√©ficier de l'utilisation des polices par d√©faut du syst√®me, car ils sont susceptibles d'√™tre utilis√©s sur des machines plus anciennes et de faible puissance. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez √©galement </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apporter d'autres ajustements aux polices que</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vous utilisez si vous le souhaitez (v√©rifiez d'abord les licences!), Mais la copie des polices Google par d√©faut utilis√©es dans Chrome sur MacOS est probablement suffisante pour la plupart d'entre nous si vous souhaitez prendre en charge uniquement les navigateurs WOFF2 sans allusion. .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√©anmoins, si nous nous installions sur Google Fonts, nous aurions alors WOFF (et m√™me des formats plus anciens) et des indices si n√©cessaire, sans avoir besoin d'une configuration approfondie de substitution de la police correcte en fonction du navigateur. </font><font style="vertical-align: inherit;">Ainsi, l'utilisation de Google Fonts pour les polices pr√©sente toujours certains avantages, et en choisissant le stockage local, vous les refusez. </font><font style="vertical-align: inherit;">Cela s'applique √©galement √† </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">toute am√©lioration future des polices Google</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Am√©liorations futures des polices</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depuis que je me suis plong√© dans le sujet des polices et j'ai averti que vous pourriez perdre tous les avantages futurs de Google Fonts en allant au stockage local, je veux m'√©loigner un peu du sujet principal et parler d'autres choses int√©ressantes que j'ai d√©couvertes. </font><font style="vertical-align: inherit;">Quels sont les grands changements √† venir dans le monde des polices? </font><font style="vertical-align: inherit;">Eh bien, il y a deux changements qui sont actuellement en cours de discussion et qui peuvent affecter les polices √† l'avenir (et peuvent donc √™tre pris en charge par Google Fonts, √©ventuellement par d√©faut si vous choisissez d'utiliser ce service): les polices variables et l'enrichissement progressif des polices .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Polices variables</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les polices variables</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vous permettent d'utiliser diff√©rents styles de police sans avoir √† t√©l√©charger des fichiers individuels. J'ai mentionn√© plus t√¥t que Web Almanac utilise jusqu'√† 9 fichiers de polices diff√©rents, mais en r√©alit√© il ne s'agit que de 2 polices. La raison est simple - le site utilise √©galement des versions en gras, en italique, en gras et m√™me plus fines de l'un ou des deux. De nombreuses variantes de la m√™me police peuvent sembler inappropri√©es et vous pourriez penser que le navigateur lui-m√™me fera face √† la t√¢che de changer l'√©paisseur du texte ou d'√©crire en italique. Oui c'est possible. Mais chaque navigateur le fait un peu diff√©remment, et les r√©sultats </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peuvent √™tre radicalement diff√©rents</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , donc beaucoup les appellent des ¬´polices artificielles¬ª.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La seule fa√ßon de garantir le m√™me affichage est d'utiliser une ¬´vraie police¬ª sp√©cifiquement pour chaque style dont vous avez besoin. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les polices variables </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">standardisent l'affichage de diverses variantes de police</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et le besoin de fichiers suppl√©mentaires dispara√Æt. Th√©oriquement, nous pourrions remplacer ces 9 polices par 2 lorsque leurs versions de polices variables seront disponibles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela ouvre une tonne de possibilit√©s d'utilisation des polices sur Internet. Bien qu'il me semble que les 9 options pour les deux polices sont trop, en r√©alit√© ce n'est pas trop, tandis que les polices variables permettraient des variations infinies. Sur les appareils mobiles, vous pouvez d√©finir une √©paisseur l√©g√®rement diff√©rente pour le "gras" que sur les ordinateurs de bureau et les tablettes. Polices variables avec </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quelques instructions CSS simples</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">permettre cela sans le co√ªt des ressources pour t√©l√©charger une police suppl√©mentaire. R√©cemment √† </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DotCSS, </font></font></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jason Pamental a</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> parl√© des polices variables et a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">montr√©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comment obtenir une page magnifiquement con√ßue avec ce qui semble √™tre beaucoup de polices diff√©rentes - le tout en utilisant un seul fichier! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'utilisation de polices variables </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">signifie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √©galement le </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">chargement de toutes les variantes de polices en m√™me temps</font></a><font style="vertical-align: inherit;"> , √©vitant la confusion caus√©e par les probl√®mes mentionn√©s pr√©c√©demment. Cela entra√Æne √©galement moins de redessins de la mise en page: sans polices variables, la page </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sera redessin√©e par le</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> navigateur encore et encore √† mesure que chaque variante de police se charge. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les polices variables ont un bon support</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans les navigateurs modernes, mais leur inconv√©nient est la grande taille, car le stockage de diff√©rentes variantes de police n√©cessite plus d'espace, comme c'est le cas avec l'indication de police. </font><font style="vertical-align: inherit;">Cela d√©pend de la police, mais g√©n√©ralement ils sont deux fois plus grands apr√®s compression, donc pour justifier leur utilisation, vous devez avoir besoin d'au moins deux styles. </font><font style="vertical-align: inherit;">M√™me ainsi, il serait pr√©f√©rable de pr√©f√©rer un fichier plus petit qui est t√©l√©charg√© pour afficher le texte critique, plut√¥t qu'un fichier plus grand pour afficher tout le texte. </font><font style="vertical-align: inherit;">Et encore une fois, l'utilisation de font-display: swap peut-elle √™tre une solution moins probl√©matique? </font><font style="vertical-align: inherit;">C'est √† chaque propri√©taire de site d'en d√©cider!</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enrichissement progressif des polices</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'enrichissement progressif des polices</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , en substance, prend le sous-ensemble √† un nouveau niveau et vous permet de t√©l√©charger des d√©finitions de caract√®res suppl√©mentaires selon les besoins sous la forme d'un flux d'informations suppl√©mentaires qui compl√®te la police actuellement charg√©e, mais n'ajoute pas de d√©finition suppl√©mentaire. Cela peut sembler un petit avantage pour nous occidentaux, mais pour d'autres langues - en particulier en Extr√™me-Orient - les fichiers de polices peuvent √™tre tr√®s massifs (par exemple, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 Mo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), en raison du grand nombre de caract√®res dans ces langues. Pour cette raison, les polices Web sont moins couramment utilis√©es dans ces pays et l'enrichissement progressif des polices peut avoir un effet positif sur la situation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'enrichissement progressif des polices, si je comprends bien, est √† un stade beaucoup plus pr√©coce que les polices variables, mais il existe</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√©mo en ligne</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dans tous les cas, il s'agit d'un autre changement potentiellement int√©ressant li√© aux polices.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Fonts continuera-t-il de s'am√©liorer?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âtant donn√© le fonctionnement de Google Fonts, il est facile d'imaginer qu'il puisse continuer de cro√Ætre avec de nouvelles am√©liorations, telles que celles d√©crites dans cet article (ou bien d'autres!), Rien qu'en changeant le CSS que vous donnez. Et il peut le faire judicieusement. Par exemple, d√©terminer si votre navigateur prend en charge les nouvelles technologies (comme il le fait maintenant avec le format de police - WOFF ou WOFF2), ou d'autres mani√®res. Par exemple, si vous demandez plus de deux polices et donnez une police variable moins gourmande en ressources, vous pouvez automatiser et cr√©er un lien vers le m√™me fichier de polices dans plusieurs annonces de type police, et si vous ne demandez qu'une seule option, faites r√©f√©rence √† une plus l√©g√®re, police traditionnelle. Sons farfelus? </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ils l'ont d√©j√† fait avec une police.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Oswald)! Honn√™tement, je ne sais pas si la m√™me chose est possible avec l'enrichissement progressif des polices, car je ne comprends pas bien le principe de son travail, mais ce sera int√©ressant √† voir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, il convient de mentionner que l'utilisation de Google Fonts, lors de la mise √† jour des polices, par exemple, pour ajouter de nouveaux jeux de caract√®res ou corriger des erreurs dans les glyphes, vous obtenez automatiquement de nouvelles polices. Avec le stockage local, cela ne fonctionnera pas - du moins pas sans intervention d'une seule main. Peut-√™tre pourriez-vous regarder dans le sens des demandes de proxy via votre domaine et prendre ainsi le meilleur des deux options, mais cela sera tr√®s probablement plus lent et n√©cessitera une configuration et une gestion suppl√©mentaires.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'un autre c√¥t√©, le stockage local offre une stabilit√©, car certaines mises √† jour peuvent affecter votre conception, par exemple, si un titre sur une ligne commence √† s'√©tirer √† deux en raison d'un changement de police. </font><font style="vertical-align: inherit;">Il y a une cat√©gorie de gens qui sont tr√®s en col√®re √† cause de cela</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avantages du stockage des polices locales</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons donc discut√© de nombreuses th√©ories, et bien qu'il y ait des avantages potentiels √©vidents du stockage local, il y a aussi des difficult√©s √† consid√©rer, et donc l'utilisation de Google Fonts pr√©sente √©galement des avantages √©vidents. Alors, l'auto-h√©bergement en vaut-il la peine? Cela d√©pend des commodit√©s r√©elles dans une situation particuli√®re. Si la diff√©rence de performances est insignifiante, il peut √™tre utile de continuer √† utiliser les polices Google, si elles sont importantes, respectivement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour Web Almanac, nous avons r√©cemment </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://github.com/HTTPArchive/almanac."><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s√©lectionn√© le stockage local de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Google Fonts, et les tests ont montr√© des changements spectaculaires:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oa/xy/ha/oaxyhappghsnk9rj-l4qoicboki.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'image inf√©rieure contient des polices locales sur notre serveur de test, et vous pouvez voir que le temps de t√©l√©chargement a √©t√© divis√© par deux - de 6 √† 3 secondes! Apr√®s une analyse plus approfondie, j'ai vu que la productivit√© augmentait encore plus (3 ‚Öì secondes d'√©conomies)! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce qui n'est pas si √©vident (mais ce que nous verrons plus tard) - √† ce stade, les polices ne sont pas enti√®rement charg√©es sur aucune des images - avec le stockage local, cela prend 7,5 secondes et 10,5 secondes lors de l'utilisation de Google Fonts. Cependant, les polices utilis√©es sont assez similaires aux polices standard, et il n'y a pas de sauts notables dans la mise en page. Cela peut √™tre vu dans le diagramme ci-dessous:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ai/zw/vu/aizwvu3sstjfwd68gd7gzhez4im.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le diagramme montre que la page avec stockage local (en rouge) est presque compl√®tement charg√©e en 2,4 secondes, puis est mise √† jour plusieurs fois au fur et √† mesure du chargement des images, apr√®s quoi les polices sont √©galement affich√©es. Oui, je voudrais que tout soit encore plus fluide, mais il est toujours impossible d'optimiser certains co√ªts de t√©l√©chargement de polices.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La raison pour laquelle les am√©liorations sont vraiment tangibles est due √† une chose que je n'ai pas prise en compte au d√©but: le rendu des blocs CSS. Donc, s'il existe un lien vers Google Fonts CSS, le navigateur ne retarde pas seulement l'affichage du texte - il retarde l'affichage de tout le contenu de la page! La police est une am√©lioration progressive, nous pouvons donc afficher en toute s√©curit√© le reste de la page, et m√™me le texte lui-m√™me (avec les polices standard / de secours), mais pas le navigateur - il voit juste qu'il y a du CSS et essaie de le charger, reportant le t√©l√©chargement le reste de la page. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il n'y a pas de chargement asynchrone pour CSS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- mais peut-√™tre devrait-il en √™tre ainsi? N√©anmoins, nous risquons qu'en cas de probl√®me de connexion √† Google Fonts, l'int√©gralit√© de votre site soit inaccessible jusqu'√† ce que le navigateur cesse de traiter le lien! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/v6/3_/oo/v63_oow5ktzvixadg7tpirrthcs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le tableau de comparaison ci-dessus, la ligne verte verticale Start Render se produit d√®s 6 secondes - car elle doit attendre que Google Fonts CSS se charge sur la ligne 12, passant la moiti√© du temps √† se connecter au domaine et l'autre moiti√© √† se charger. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comparez cela avec la version locale: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/x6/hm/4c/x6hm4c_omalxhr4ogx_5pueneci.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, nous pouvons commencer le rendu d√®s que le CSS du site est charg√© et trait√© en 2,5 secondes. En effet, il n'y a pas de retard dans la connexion au domaine Google Fonts.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les deux cas, nous voyons que le d√©but du rendu se produit avant le chargement des polices, et gr√¢ce √† la magie de font-display: swap, le texte est toujours visible. Par cons√©quent, au moins lors de l'utilisation de font-display: swap, il serait pr√©f√©rable que les polices Google ne soient pas charg√©es √† l'aide du rendu de blocage CSS, mais, par exemple, charg√©es via JavaScript asynchrone, qui ins√®re les polices CSS dans la page uniquement apr√®s comment ils sont t√©l√©charg√©s. Si le processus √©tait impl√©ment√© de cette mani√®re, les retards de rendu ne se produiraient pas, cependant, il y a toujours des retards de connexion et une longue attente pour que le texte s'affiche correctement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UPD: J'ai cr√©√© un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">probl√®me sur GitHub Google Fonts</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec une suggestion pour ajouter un moyen de t√©l√©charger Google Fonts sans bloquer le rendu - votez si vous le souhaitez aussi!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zach Leatherman pr√©conise cette approche pour </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©duire le nombre de redessins</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et montre que cela est √©galement possible avec JavaScript seul, sans avoir besoin d'un fichier CSS. </font><font style="vertical-align: inherit;">Ensuite, cela montre d'autres avantages de la gestion de vos polices avec JavaScript, par exemple, vous pouvez refuser de t√©l√©charger des polices du tout si le site est ouvert √† partir d'un r√©seau lent (√† l'aide de l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API d'informations r√©seau</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), ou si l'utilisateur a activ√© les param√®tres </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Save-Data</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prefers-Reduced-Motion</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Fonctionnalit√©s int√©ressantes!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pr√©chargement des polices</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fois que vous vous serez √©loign√© des URL hach√©es de Google, vous pourrez pr√©charger la police pour am√©liorer encore les performances. Cependant, cette option pr√©sente des d√©fauts potentiels, comme Andy Davies l'a expliqu√© dans l'article </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preloading Fonts and the Puzzle of Priorities</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Fondamentalement, en pr√©chargeant les polices et en les d√©pla√ßant dans l'ordre de priorit√©, vous r√©duisez implicitement la priorit√© des autres t√©l√©chargements critiques (par exemple, CSS), et en raison d'une erreur dans Chrome, les polices </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peuvent m√™me</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d√©passer certaines d'entre elles.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, le pr√©chargement lorsque la police ne sera pas utilis√©e entra√Ænera une charge excessive inutile - par exemple, si la version locale existe et peut √™tre utilis√©e en priorit√©, ou si le navigateur ne prend pas en charge ce format de police (bien que tous les navigateurs prenant en charge le pr√©chargement prennent √©galement en charge WOFF2 ) Parall√®lement √† la recommandation d'utiliser le pr√©chargement, Google </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vous en avertit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> clairement </font><font style="vertical-align: inherit;">, et il est agr√©able de voir qu'ils y pr√™tent attention.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous utilisez la fonction font-display: swap, le besoin de pr√©charge peut ne pas √™tre aussi fort. </font><font style="vertical-align: inherit;">Bien que dans ce cas, vous pouvez toujours gagner du temps en t√©l√©chargeant le nombre minimum requis de polices et en √©vitant ainsi FOUT et redessiner. </font><font style="vertical-align: inherit;">Pour le moment, nous n'utilisons pas le pr√©chargement dans Web Almanac et avant de commencer, nous avons besoin de quelques tests suppl√©mentaires, mais pour l'instant je suis satisfait de ce qui est.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
R√©pondre √† une question dans le titre de l'article: oui, √ßa vaut le coup, car le gain de performances est important. </font><font style="vertical-align: inherit;">Bien s√ªr, vos r√©sultats peuvent varier, car tout d√©pend du site particulier, alors testez, testez et testez √† nouveau. </font><font style="vertical-align: inherit;">Mais, je pense, c'est toujours la meilleure option, en termes de performances, pour la plupart des sites.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, Google Fonts n'est pas seulement un r√©f√©rentiel de centaines de polices gratuites - c'est √©galement un m√©canisme de livraison intelligent qui utilise bon nombre des derni√®res techniques d'optimisation pour rendre les polices les plus appropri√©es avec un effort minimal de la part du propri√©taire du site. En passant √† l'auto-h√©berg√©, id√©alement, vous devez r√©impl√©menter de nombreuses am√©liorations utiles, telles que l'affichage de la police: √©change, suppression des indices de police (au moins pour certains navigateurs), ou sinon, vous ne pouvez que nuire aux performances des plus lourds fichiers de polices.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce n'est pas une t√¢che facile (et Google Fonts le fait pour vous, oui). Mais comme l'utilisation du format WOFF2 est d√©sormais la seule option r√©aliste et que les navigateurs prennent bien en charge la plupart des techniques d'optimisation, tout est devenu beaucoup plus facile qu'auparavant. N√©anmoins, cela vaut la peine d'avoir des connaissances sur les polices Web avant de tout configurer (j'esp√®re que ce message a aid√© √† cela!), Et en m√™me temps, gardez un ≈ìil sur les nouveaux changements dans le monde des polices, car il y aura sans aucun doute de nouvelles am√©liorations. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh bien, peut-√™tre √©tions-nous trop soucieux d'optimisation et avec le stockage local, nous pouvons nous permettre d'utiliser la police compl√®te, sans sous-ensemble et avec des indices? Sur le site Web de Google Fonts, vous pouvez t√©l√©charger n'importe quelle police et c'est relativement simple, bien qu'il soit √©trange que l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">archive n'inclue pas les formats WOFF et WOFF2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lors de l'utilisation de cette m√©thode de chargement, qui est compl√®tement incompr√©hensible pour moi! </font><font style="vertical-align: inherit;">Cependant, si vous √™tes vraiment int√©ress√© √† am√©liorer les performances (et vous devriez √™tre int√©ress√©!), Alors vous devriez essayer de faire la bonne chose. </font><font style="vertical-align: inherit;">Cet article montre seulement que c'est un peu plus compliqu√© que de simplement t√©l√©charger et placer des polices sur votre site, comme je m'y attendais toujours. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wow, quelque chose de texte s'est av√©r√© plus long que pr√©vu! </font><font style="vertical-align: inherit;">Mais j'esp√®re que vous √©tiez aussi int√©ress√© par la compr√©hension du sujet que vous l'√™tes et que vous avez maintenant quelques nouvelles id√©es pour acc√©l√©rer le t√©l√©chargement des polices sur votre site. </font><font style="vertical-align: inherit;">Je vous recommande fortement de suivre </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jason</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zach</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur Twitter pour en savoir plus sur les polices et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andy</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour en savoir plus sur la vitesse globale des applications Web.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/9fa/cf4/a34/9facf4a348ef01048b4eb5e16ae66daa.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr490354/index.html">Renforcer la culture de la s√©curit√© de l'information dans les soci√©t√©s fintech</a></li>
<li><a href="../fr490356/index.html">Pr√©sentation de Kubernetes CCM (Cloud Controller Manager) pour Yandex.Cloud</a></li>
<li><a href="../fr490358/index.html">Un programmeur moderne doit-il √™tre capable de cr√©er des algorithmes?</a></li>
<li><a href="../fr490362/index.html">Kubernetes dans l'esprit du piratage: notre chemin vers les microservices et un mod√®le pr√™t √† l'emploi pour la mise en ≈ìuvre</a></li>
<li><a href="../fr490364/index.html">Les centres de donn√©es consomment beaucoup d'√©lectricit√©, mais ne menacent pas encore le climat</a></li>
<li><a href="../fr490372/index.html">Entretien chez Dodo Pizza</a></li>
<li><a href="../fr490376/index.html">Pluriel</a></li>
<li><a href="../fr490378/index.html">IPv6 - un monde merveilleux qui m√©rite une transition rapide vers lui</a></li>
<li><a href="../fr490380/index.html">Ach√®vement retard√© du pod lorsqu'il est supprim√©</a></li>
<li><a href="../fr490382/index.html">Contenu FunCorp iOS Meetup # 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>