<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕔 🕣 ☂️ お風呂の例にXiaomiを備えたスマートホーム ⤴️ 👩🏻‍🍳 🦓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="インターネットには、スマートホームの構築に関するレビューやビデオがたくさんあります。これはすべて、組織、つまり一般的には多くのオタクにとって非常に高価で厄介であるという意見があります。しかし、進歩は止まりません。デバイスはより安価になり、より機能的になり、設計とインストールは非常に簡単になっています...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>お風呂の例にXiaomiを備えたスマートホーム</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/plesk/blog/482554/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターネットには、スマートホームの構築に関するレビューやビデオがたくさんあります。</font><font style="vertical-align: inherit;">これはすべて、組織、つまり一般的には多くのオタクにとって非常に高価で厄介であるという意見があります。</font><font style="vertical-align: inherit;">しかし、進歩は止まりません。</font><font style="vertical-align: inherit;">デバイスはより安価になり、より機能的になり、設計とインストールは非常に簡単になっています。</font><font style="vertical-align: inherit;">ただし、一般的に、レビューは1〜2つの使用例に焦点を当てており、ほとんどニュアンスをカバーせず、全体像を作成することもありません。</font><font style="vertical-align: inherit;">したがって、この記事では、完成したプロジェクトを確認し、Xiaomiデバイスを使用してスマートハウスを構築する際に遭遇する使用シナリオと落とし穴を、例として浴場を使用して説明します。</font><font style="vertical-align: inherit;">わずかなバリエーションで説明されているアイデアは、アパートの自動化に適用できます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/9h/lb/tj/9hlbtjf6rdghf--lzwsq-5bysk8.jpeg" alt="画像" width="400" height="400"></div><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">背景またはこれがすべて必要な理由</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
手始めに、コンテキストを明確にするための小さな背景。 2018年秋の初めに風呂の仕上げが完了し、営業を開始しました。浴場は、一年中暖房と給水を行う自立した資本の建物です。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ns/wd/o5/nswdo5svyprgue1sgxhojmb83kk.jpeg" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
明らかな理由で、誰も常に浴場に住んでいるわけではなく、施設の状態を管理していません。風呂場への訪問もあまり頻繁ではありません。したがって、「スマート」バスを作成することについての考えは、プロジェクトの最初から存在していました。まず、安全のために（火災、洪水、アクセス制御）。たとえば、路上で-35度の暖房をオフにすると（私はノボシビルスクに住んでいます）、非常に危険な状況です。しかし、本館とは異なり、風呂の自動化プロジェクトを最初から考えず、適切な場所に追加の配線をしていませんでした。一方、浴場ではインターネットにアクセスし、他の2棟の建物の外観はビデオ監視されている（目視で状況を把握できる）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2019年11月の出張から帰ってきた夕方、浴場に行って玄関を開けてみたところショックでした。</font><font style="vertical-align: inherit;">WiFiポイントのLEDが暗闇から点滅し、水の流れが足元に流れました。</font><font style="vertical-align: inherit;">つまり、電気は止まりませんでしたが、洪水が発生しました。</font><font style="vertical-align: inherit;">バス内の水は、独自の井戸、水中ポンプ、およびプロセスを制御する自動化を使用して構成されています。</font><font style="vertical-align: inherit;">後で判明したように、トイレのインターチェンジの付属品の1つが破損し、すべての部屋が浸水しました。</font><font style="vertical-align: inherit;">なぜ自動化が気の毒になり、それでもオフになったのかはわかりませんでしたが、彼女はなんとか15 cmの水を30の正方形に送り込みました。</font><font style="vertical-align: inherit;">路上ではその日は-14度でした。</font><font style="vertical-align: inherit;">暖かい床は対処し、室温を適切なレベルに保ち続けましたが、湿度は100％になりました。</font><font style="vertical-align: inherit;">スマートホームの組織についてさらに先延ばしにすることは不可能でした-あなたはそれを始める必要があります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">設備の選択</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メインハウスの建設中に、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eldes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デバイスの</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">操作</font></a><font style="vertical-align: inherit;">経験</font><font style="vertical-align: inherit;">がありました（対応する配線が作成されました）。自動化の一部は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Raspberry PIで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行われ</font><font style="vertical-align: inherit;">ます。もう1つの部分は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xiaomi Aqaraデバイスです</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 Raspberry PIのオプションは私にとって最も魅力的で、当初は浴場として考えられていました。しかし、残念ながら、それはかなり多くの組織の努力を必要とします。これはまだプラグアンドプレイデバイスではありません。ハードウェアを使用した演習から始まり、独自のニーズに合わせたソフトウェアの作成で終了します。特定の理由で</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MajorDoMo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">合わなかった。 Raspberry PI、ZigBeeアダプター（Xiaomiワイヤレスセンサーを使用するため）、およびApple HomeKitを横断する必要があります（現時点ではApple HomeKitインターフェイスはあまり満足していません）。時間はあまりなく（状況を繰り返したくありませんでした）、目的のポイントごとに配線がなかったため、Xiaomiデバイスですべてを行うことにしました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この状況での主なデバイスはハブです。 Xiaomiの場合、ハブにはXiaomi Mi Smart Home Gateway 2とXiaomi Aqara Gatewayの2つのオプションがあります。後者は約2倍高価で、地元の市場により適し、デバイスをApple HomeKitに統合することができます。ただし、Aqara Homeアプリケーションをインストールして「ロシア」リージョンを選択すると、これらの行を記述した時点では、13の異なるデバイス（スイッチ、ソケット、センサー）しか使用できません。 Xiaomi Homeアプリケーションをインストールする場合は、「中国本土」リージョンを選択すると、何百ものデバイスが接続に使用できるようになります。ただし、「中国本土」リージョンを選択した場合、ヨーロッパのコンセントを接続することはできず、その逆も同様です。 Aqara Homeアプリケーションの一部として「中国本土」地域を選択しても、Xiaomi Homeに存在する同じ地域のデバイスの完全性は提供されません。非互換性を恐れて、ハブXiaomi Mi Smart Home Gateway 2に立ち寄ることにしました。価格は約2000 pです。ちなみに、ハブ自体はランプとして機能します-これはインストール中に考慮することができます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/vs/ul/kx/vsulkxlnghjjindbwwmxw9aemxq.jpeg" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別の興味深い質問は、これがどのくらいの期間機能するかです。</font><font style="vertical-align: inherit;">センサーとバッテリーについても問題ではなく、クラウド内の同期とデータストレージについてです。</font><font style="vertical-align: inherit;">アカウントは現在無料です。</font><font style="vertical-align: inherit;">すべての情報はXiaomiサーバーに保存されます。</font><font style="vertical-align: inherit;">明日、ロシアのユーザーが「中国本土」の地域にデータを保存しないように決定した場合、またはRoskomnadzorが何らかの理由でサーバーを禁止した場合、スマートハウス全体がカボチャに変わるリスクがあります。</font><font style="vertical-align: inherit;">この場合、センサーは残り、ハブはRaspberri PI + ZigBeeアダプターに置き換えられることを自分で決めました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">漏れの制御と防止</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初の最も重要な自動化シナリオは、発生した問題の自然な継続でした-リークの間、給水、つまりポンプをオフにし、問題に関する通知を電話に送信する必要があります。 2つの潜在的に危険なリークがありました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このシナリオのハブに加えて、2つの漏れセンサーとスマートな壁取り付けソケットが必要でした。漏れセンサーの価格は約1400 rです。スマートコンセントの価格は約1700 pです。漏れセンサーは自律型で、バッテリーで動作します。メーカーは、1つのバッテリーで2年間十分であると主張しています。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bt/d3/q2/btd3q2gftpvfsf_drdszmsisfwm.jpeg" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スマートコンセントの設置は少し複雑でした。中国のコンセントには四角いソケットが必要で、通常の店では販売されていません（注文は可能です）。四角い穴をあけることは今でも楽しみです。さらに、ヨーロッパのプラグ用のコンセントもありますが、良い方法ではアダプターが必要です。地元市場向けのAqaraバージョンでは、壁に取り付けられたコンセントが現在欠落しており、「中国本土」地域につながります。または、通常のコンセントをインストールし、Xiaomiのプラグをスマートコンセントに差し込むこともできますが、これには2つの追加アダプターが必要になります。別の選択肢はリレーです。しかし、私は壁に取り付けられたコンセントに落ち着きました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/qe/rg/pg/qergpgrjkaqqosy5xr2pqc_hli8.jpeg" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Xiaomi Homeアプリケーションで、ソケットとセンサーが追加されました。</font><font style="vertical-align: inherit;">次に、「漏れが発生した場合」のシナリオが2つのアクションに対して規定されています。コンセントをオフにしてアラートを送信します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/p7/pj/ub/p7pjubzhpjzb6tt_aoxrdd20_fs.jpeg" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初の漏れセンサーは、ポンプの横（そして実際にはハブの横）に設置されました。</font><font style="vertical-align: inherit;">テストのために、水を小さなプレートに注ぎ、センサーをその中に下げました。</font><font style="vertical-align: inherit;">可能な限り現実に近づけるために、センサーの設置場所で直接すべてのアクションを実行しました。</font><font style="vertical-align: inherit;">テストは成功しました：ソケットがオフになり、通知が電話に届き、ハブが緊急モードで点滅しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目の漏れ検知器は、パイプのインターチェンジの隣のトイレに設置する予定でした。</font><font style="vertical-align: inherit;">しかし、その設置により、ニュアンスが生じました-距離はわずかでしたが、ハブはセンサーを見ませんでした。</font><font style="vertical-align: inherit;">その理由は、施設の構成です。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ce/33/gb/ce33gbivdrkzwq2f4t-vghi69ki.jpeg" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ハブの設置場所（リラクゼーションルーム）と第2漏水センサー（トイレ）の設置場所の間に蒸気室がありました。最高の伝統では、スチームルームは箔で円に縫い付けられており、信号の通過に問題を引き起こしています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
製造元は、デバイスがメッシュネットワークを形成できる、つまり、あるデバイスが別のデバイスを介してハブにデータを送信できると主張しています。どこかで、ネットワークに接続されたデバイス（バッテリーではなく）のみがメッシュネットワークでそのようなトランスミッターとして機能できるという情報に出くわしました。しかし、私は、トイレの隅に温度センサーを設置して、漏れセンサーからの信号が消えなくなるようにするだけで十分でした。たぶんこれは偶然かもしれません。天井の下の洗面所のさらに先に、街路灯を制御するためのリレーが取り付けられていたからです（おそらくそれはメッシュネットワークの送信機として機能します）。ただし、トイレの漏れセンサーからの信号が失われる問題は解決されました。さらに、中央のセンサーをクリックして、デバイスとハブの接続を確認できます。すべてが大丈夫なら、純粋な中国語では、対応する情報がハブから聞こえます（Aqaraハブの場合、コミュニケーションは快適な英語になります）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
シャットダウンを確認してから、マシンを使用して電気をオンにすると、スマートソケットがオフ状態になることがわかりました。</font><font style="vertical-align: inherit;">電気が出現したときにオン状態になるように、対応する設定があります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7m/mp/rv/7mmprvrfrwirqrveigp5hk5rbna.jpeg" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
部屋の洪水の追加の兆候は、湿度が最大100％増加したことです。</font><font style="vertical-align: inherit;">この症状の制御について-次のセクション。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">煙と温度の制御</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
浴場は火災の危険がある部屋なので、次のシナリオは火災の兆候を識別することでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このシナリオでは、2つの温度（および湿度）センサーと煙センサーが必要でした。温度センサーの価格は約1000rです。煙探知機の費用は約2000 pです。ローカル地域のAqaraバージョンでは、煙探知器は現在ありません。これにより、再び「中国本土」地域につながります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
煙探知器は洗面所の廊下の天井に取り付けられていました（実際にはストーブと蒸気室の出口からそれほど遠くない）。次に、Xiaomi Homeアプリケーションでデバイスが追加され、「煙が検出された場合」のシナリオが作成され、続いて電話に通知が送信されました。テストは暖炉のマッチによって行われました。センサーはテストを正常に完了しました。ハブがアラームで点滅し、さらに警報音が鳴りました。センサー自体も非常に卑劣で大きなビープ音を鳴らし、問題について警告しました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zg/ej/jg/zgejjg01wv9ayueq8tzptcumzs8.jpeg" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
火災の別の兆候は、温度の上昇です。温度を監視するために、2つのセンサーが設置されました。1つはトイレにあり、もう1つは洗面所にあります。次に、アプリケーションでは、対応する電話への通知を伴うシナリオが「設定よりも高い温度の場合」が構成されました。現時点では、リラクゼーションルームのしきい値を30度に設定しています（夏には、おそらく再構成する必要があります）。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/nq/0w/pj/nq0wpjrfwe3nsl6hfpnjxwsuzhq.jpeg" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、シナリオは、18度のしきい値と電話へのアラートを使用して「気温が設定より低い場合」に設定されました。</font><font style="vertical-align: inherit;">なんらかの理由で暖房が停止した場合は、できるだけ早くお知らせください。</font><font style="vertical-align: inherit;">同様に、「湿度が上昇した場合」のシナリオは、70％のしきい値、電話へのアラート、および給水ポンプのシャットダウンを備えた両方のセンサーに対して作成されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
温度および湿度センサーの快適なボーナスのうち、履歴チャートはアプリケーションで利用できます。</font><font style="vertical-align: inherit;">たとえば、目的の目的でバスが使用された瞬間（下のグラフの温度ピーク）を確認したり、現在の温度が異常かどうかを比較したりできます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/cf/tb/av/cftbaviejmlpp8nndfwizm6un60.jpeg" alt="画像"></div><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">換気制御</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
敷地内の強制抽出物はスチームルームで整理されます。手順を完了した後、部屋を換気することをお勧めします。換気はキースイッチでオンになり、換気自体は30分以上必要でしたが、浴場での集まりは夜の1〜2時間で終わることが多いです。すべてを事前に行うことは常に可能であるとは限りません。最後に30分間座って、スチームルームが換気されるまで待つことは、すでに眠りたいので、平均以下の楽しみです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このシナリオでは、Xiaomiのゼロスイッチと壁取り付けのキースイッチが必要でした。この問題の価格は約1900 pです。スイッチは、地元市場向けのAqaraバージョンで入手できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の場合、従来のスイッチをスマートなスイッチに置き換えることはできません。電力線が必要です。</font><font style="vertical-align: inherit;">そのため、機会があったので、スイッチの取付穴までゼロ線を伸ばす必要がありました。</font><font style="vertical-align: inherit;">ゼロラインのないスイッチの場合、設置が簡単になります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/q0/k2/p-/q0k2p-qvozvt_zk3e-i407jprhk.jpeg" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インストール後、スマートスイッチがデバイスとしてアプリケーションに追加され、そのパフォーマンスがテストされました。</font><font style="vertical-align: inherit;">スイッチの設定にはタイマーがあり、オフにする時間を設定できます。</font><font style="vertical-align: inherit;">つまり、お風呂を出る前に、さらに30分の換気のためにスリープタイマーが設定され、安全にスリープ状態に入ることができます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/9e/4c/5g/9e4c5gckmsp0dsiekxkbvhk5imk.jpeg" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロセスを自動化するための別のオプションがあります。</font><font style="vertical-align: inherit;">入浴の手順が完了すると、換気に加えて、スチームルームのドアが完全に開きます。</font><font style="vertical-align: inherit;">これにより、温度センサーが設置されている洗面所の温度が上昇します。</font><font style="vertical-align: inherit;">このセンサーの測定値に基づいて、換気のオン/オフシナリオを作成できます。</font><font style="vertical-align: inherit;">ただし、このオプションはまだ実行していません。</font><font style="vertical-align: inherit;">さらに、スチームルームのドアオープンセンサーを試すこともできます。</font><font style="vertical-align: inherit;">でもドアはガラス製でスチームルームも120度あるので、すぐ死ぬか落ちるのではないかと思います。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">街路灯制御</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自動化したかったもう1つのタスクは、ベランダの街灯を制御することでした。典型的なシナリオの1つ：建物から遠くなくて、外が暗くなったときにベランダのライトをオンにします。お風呂は施錠されており、街路灯スイッチは屋内にあります。私は鍵を追いかけてドアを開け、照明をつけなければなりませんでした。ライトをオフにするには、同様の手順が必要でした。定期的に発生した別のシナリオ：メインハウスにいるときにベランダのライトをオンまたはオフにします。浴場を離れるとき、ベランダの照明を消すのを忘れて、家にいるときに窓の外を見たり監視カメラを見たりすることがよくありました。この瞬間、抵抗はすでになくなっているので、光は一晩中燃え続けました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/cc/tg/ex/cctgexbilx-hsr-tomjp9cs0gl8.jpeg" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアイデアを実装するために、2チャンネルリレーが購入されました。この問題の価格は約2000 pです。ローカル市場向けのAqaraバージョンのリレーは現在欠落しています。ただし、キースイッチに置き換えることもできます（これを配電ボックスにインストールするのがより面倒なプロセスであることは明らかです）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当初はリレーをキースイッチの後ろに取り付けるつもりでしたが、電力線を正しい場所に引くことは非常に問題が多いことがわかりました（ここでも、リレーには電力が必要です）。理想的な場所は、電源ライン、スイッチからのライン、および街灯からのラインが集まるジャンクションボックスです。それは誤った天井の下にあり、いくつかの裏張りレールの解体につながりました。この点をあらかじめ考えておくことをお勧めします。ただし、インストールは正常に完了しました。接続図は、ソケットとスイッチよりもはるかに複雑です（私の場合、4本の3線ワイヤとリレー自体の8つの端子）。心に留めて混乱させないために、実装する前に紙に図を描いた。次に、すべてを確認するために試用インストールを行いました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bz/n5/gd/bzn5gdba_obeh-ja73lxl2fdvjc.jpeg" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デバイスがアプリケーションに接続され、テスト段階が開始されました。街路灯は、既存のキースイッチとしてオン/オフを切り替え、アプリケーションを使用することになっていた。通りには2つのライトがあります。1つは左側にあり、もう1つは右側にあります。リレーには2つのチャネルがありますが、個別にオンにすることは意味がありませんでした。一方、アプリケーションに2回クリックするだけでそれらを順番に含めたくありませんでした。したがって、制御は単一のリレーチャネルで行われました。奇妙な偶然により、このオプションは正常に機能しませんでした-スティッキングがどちらか一方の位置で発生しました。日光が終わり、天井裏にライニングを組み立てたかったので、もう実験の時間はありませんでした。したがって、両方のチャネルでライトを並行してキャッチしただけで、すべてが思い通りに機能しました。ために、物理スイッチとソフトウェアスイッチをパススルーとして機能させるために、リレー設定でインターロックオプションをオンにしました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オン/オフタイマーライトを配置することも可能です。</font><font style="vertical-align: inherit;">しかし、このシナリオはまだ興味がありませんでした。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アクセス制御</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もう一つの奇妙な瞬間は、通りのドアの開放を制御することでした。</font><font style="vertical-align: inherit;">まず、誰かがこのドアを通常または完全に閉め忘れたことを特定して通知すること。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このシナリオでは、窓/ドア開閉センサーが必要でした。</font><font style="vertical-align: inherit;">この問題の価格は約1000 pです。</font><font style="vertical-align: inherit;">ローカル市場向けにAqaraが作成したセンサーがあります（エッジの丸みが少ない）。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/pb/fy/id/pbfyidivjmpgggpxrwxowgeq-h8.jpeg" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インストールは非常に簡単です-センサーは両面テープにマウントされています。取り付ける前に、アプリケーションにセンサーを接続して、操作が発生する距離を確認することをお勧めします。指示は最大20 mmのギャップについて書いていますが、穏やかに言えば、これは真実ではありません-センサーと応答磁石はほぼ同じ高さに取り付けられる必要があります。本館では、同様のセンサーがガレージのドアに設置されています。ガイドとカラーの間に幅1 cmのシーリングガムがあり、この距離では、センサーは「開いた」位置を示し、応答磁石を増やす必要がありました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいデバイスがアプリケーションに追加された後、自動化に進むことができます。 「ドアが1分以上開いている場合」のシナリオを電話への通知で構成します。英語のローカライズでは、約1分のフレーズの一部は表示されませんが、応答のしきい値はそれだけです。 AqaraセンサーおよびAqara Homeアプリケーションでは、他のトリガー間隔を構成できます。残念ながら、これはXiaomi Homeアプリケーション内ではまだ実行できません。しかし、実際には1分の間隔で十分であることが示されています-誤検知はなく、すべての陽性がケースにありました。センサーでログを確認することもできます。このセンサーも例外ではありません。たとえば、浴場に来たとき（その日に最初のドアが開いたとき）と浴場に行ったとき（最後のドアが閉まっているとき）をログで判断して、部屋での合計滞在時間を見積もることができます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wk/uv/ry/wkuvryxsyoah4u-7dwoj0yct9a4.jpeg" alt="画像"></div><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">運用上の印象</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
全体的な運用経験は純粋にポジティブです。</font><font style="vertical-align: inherit;">もちろん、多少の微妙な違いはありますが、自動化の主な目標は達成されています。</font><font style="vertical-align: inherit;">まず、これは心理的な落ち着きであり、テスト結果で確認されています。</font><font style="vertical-align: inherit;">快適性も重要です-街路照明のリモートコントロール、排気フードが得られ、追加のナイトランプが登場しました。</font><font style="vertical-align: inherit;">休暇に出かけた後、あなたは覚えて、遠隔で水を止めることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のすべてのデバイスの概算のコスト（特定の店舗を参照しない）を以下に示します。</font><font style="vertical-align: inherit;">AliExpressで注文すると、価格はより小さな方向で異なります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/i9/ij/pf/i9ijpffhxd2i-jaq00ieo58eupo.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
機器のセットを選択するときは、互換性を考慮する必要があります（この機器がどの地域で製造され、どのファミリに属しているか）。アプリケーションのフレームワーク内では、たとえば、煙探知器イベント（「中国本土」地域の場合）によってヨーロッパ地域のコンセントを制御するシナリオを作成することはできません。エキゾチックなタイプの煙探知器が必要ない場合は、地元の市場向けのAqaraデバイスを検討することをお勧めします。最終的に、リレーは、たとえば2キースイッチに置き換えることができます。 Xiaomiデバイスを販売する多くの店は、それらを灰色でインポートしているようです（これらのデバイスは中国地域向けに設計されています）。しかし、たとえば、Svyaznoy、私たちの市場向けに設計された幸運なデバイス。同じコンセントの互換性に加えて、英語とロシア語の説明書も含まれています。以下は、2つの同一のセンサーの写真です。しかし、さまざまな地域の場合（内部中国語-左側、外部ヨーロッパ-右側）：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/uw/ph/x_/uwphx_titz3r1-hhwlduqxmzlwg.jpeg" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーションを介した制御の応答性は常に良いとは限りません。たとえば、ライトをオンにするのではなく、何度も何度も「リクエストが失敗した」という精神でエラーが発生する場合があります。実験的に特定された処理-アプリケーションをメモリからアンロードして再起動する-は、次の試行で回答を待つよりも早くこの問題を解決します。また、センサーのステータスの更新に顕著な遅延（最大20〜30秒）が発生する場合があります。このとき、電源オン/オフボタンを再度押すのではなく、ステータスが更新されるのを待つことをお勧めします。一部の状況でアプリケーションを起動すると、デバイスのリストではなく空のリストが表示されることがあります。パニックする必要はありません-通常、数秒以内に現れます。電話での通知はローカライズされておらず、イベント自体の適切な名前付けが役立ちます。さらに、アプリケーションの作成者は定期的にプッシュ通知チャネルを広告に使用します（これも中国語です）。もちろん、これは好きではありませんが、選択肢はあまりありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事が、スマートホームを構築するための多くのXiaomiデバイスの機能と、それらの実用的なアプリケーションのシナリオについて理解を深めるのに役立つことを願っています。</font><font style="vertical-align: inherit;">ご不明な点がありましたら、訂正や追加がありましたら、コメント欄でお話しさせていただきます。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja482544/index.html">スタートアップチームに「0」を設定する-最小規模の段階的な手順</a></li>
<li><a href="../ja482546/index.html">VK Tech：Git開発年</a></li>
<li><a href="../ja482548/index.html">Security Week 52 + 1：非標準の今年のトップ3ニュース</a></li>
<li><a href="../ja482550/index.html">神秘的なLyXプログラム。パート2</a></li>
<li><a href="../ja482552/index.html">例として簡単なアプリケーションを使用したSpring Securityでの登録と承認</a></li>
<li><a href="../ja482556/index.html">草が「より環境に優しく」、AKGがdinostaticヘッドフォンを生産した頃</a></li>
<li><a href="../ja482558/index.html">科学者は最初に人間の細胞で眠っているヘルペスウイルスを殺しました</a></li>
<li><a href="../ja482560/index.html">簡単な文章の書き方</a></li>
<li><a href="../ja482562/index.html">パソコンは10年前に死ぬはずだった：代わりに何が起こったのか</a></li>
<li><a href="../ja482564/index.html">すべての物語がサイエンスフィクションのスタイルで書かれている場合</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>