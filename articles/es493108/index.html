<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§Ωüèæ üõ∂ üà¥ Cloudflare selecciona procesadores AMD para servidores perimetrales de d√©cima generaci√≥n üòå üïµüèΩ üéÉ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="M√°s de mil millones de direcciones IP √∫nicas pasan a trav√©s de la red Cloudflare diariamente; Atiende a m√°s de 11 millones de solicitudes HTTP por seg...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Cloudflare selecciona procesadores AMD para servidores perimetrales de d√©cima generaci√≥n</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/493108/"><img src="https://habrastorage.org/getpro/habr/post_images/536/952/a76/536952a764f14e82b44b8765e9c63737.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
M√°s de mil millones de direcciones IP √∫nicas pasan a trav√©s de la red Cloudflare diariamente; Atiende a m√°s de 11 millones de solicitudes HTTP por segundo; Se encuentra a una distancia de no m√°s de 100 ms del 95% de la poblaci√≥n de Internet. Nuestra red abarca 200 ciudades en m√°s de 90 pa√≠ses, y nuestro equipo de ingenier√≠a ha construido una infraestructura extremadamente r√°pida y confiable. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estamos muy orgullosos de nuestro trabajo y estamos comprometidos a ayudar a hacer que Internet sea mejor y m√°s seguro. Los ingenieros de Cloudflare, cuyo trabajo est√° relacionado con el hardware, conocen bien los servidores y sus componentes para comprender y elegir el mejor equipo para maximizar su eficiencia.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nuestra pila de software maneja la inform√°tica de alta carga y depende mucho de la velocidad de la CPU, por lo que nuestros ingenieros tienen que optimizar constantemente la eficiencia y la fiabilidad de Cloudflare en todos los niveles de la pila. </font><font style="vertical-align: inherit;">En el lado del servidor, la forma m√°s f√°cil es aumentar la potencia inform√°tica agregando n√∫cleos de CPU. </font><font style="vertical-align: inherit;">Cuantos m√°s n√∫cleos pueda caber en un servidor, m√°s podr√° procesar datos. </font><font style="vertical-align: inherit;">Esto es importante para nosotros, ya que la diversidad de nuestros productos y clientes crece con el tiempo, y el crecimiento de las solicitudes requiere servidores para aumentar la productividad. </font><font style="vertical-align: inherit;">Para aumentar su productividad, necesit√°bamos aumentar la densidad de los n√∫cleos, y esto es precisamente lo que hemos logrado. </font><font style="vertical-align: inherit;">A continuaci√≥n, proporcionamos detalles de los datos del procesador para los servidores que hemos estado implementando desde 2015, incluida la cantidad de n√∫cleos:</font></font><br>
<a name="habracut"></a><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">---</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gen 6</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gen 7</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gen 8</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gen 9</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comienzo de trabajo</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2015</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2016</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2017</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2018</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPC</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel Xeon E5-2630 v3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel Xeon E5-2630 v4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel Xeon Silver 4116</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel Xeon Platinum 6162</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√∫cleos f√≠sicos</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 8</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 10</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 12</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 24</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TDP</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 85W</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 85W</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 85W</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 150W</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TDP por n√∫cleo</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.65W</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.50W</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.08W</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.25W</font></font></td>
</tr>
</tbody></table></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En 2018, dimos un gran salto en el n√∫mero total de n√∫cleos por servidor con la novena generaci√≥n. </font><font style="vertical-align: inherit;">El impacto ambiental se redujo en un 33% en comparaci√≥n con la octava generaci√≥n, lo que nos dio la oportunidad de aumentar el volumen y la potencia inform√°tica por rack. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> requisitos de dise√±o de </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Thermal Design Power</font></a><font style="vertical-align: inherit;"> (TDP) </font><font style="vertical-align: inherit;">se </font><font style="vertical-align: inherit;">mencionan para enfatizar que nuestra eficiencia energ√©tica tambi√©n ha crecido con el tiempo. </font><font style="vertical-align: inherit;">Este indicador es importante para nosotros: en primer lugar, queremos emitir menos carbono a la atm√≥sfera; </font><font style="vertical-align: inherit;">En segundo lugar, queremos aprovechar al m√°ximo la energ√≠a de los centros de datos. </font><font style="vertical-align: inherit;">Pero sabemos por lo que tenemos que luchar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nuestra principal m√©trica definitoria es la cantidad de solicitudes por vatio. Podemos aumentar el n√∫mero de solicitudes por segundo agregando n√∫cleos, pero debemos mantener nuestro presupuesto de energ√≠a. Estamos limitados por la infraestructura de energ√≠a de los centros de datos, que, junto con nuestros m√≥dulos de distribuci√≥n de energ√≠a seleccionados, nos da un cierto l√≠mite superior para cada rack de servidores. Agregar servidores a un rack aumenta el consumo de energ√≠a. Los costos operativos aumentar√°n dram√°ticamente si vamos m√°s all√° del l√≠mite de energ√≠a de un bastidor y tenemos que agregar nuevos bastidores. Necesitamos aumentar la potencia inform√°tica, permaneciendo en el mismo rango de energ√≠a, lo que aumentar√° el n√∫mero de solicitudes por vatio, nuestra m√©trica clave.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como habr√°s adivinado, estudiamos cuidadosamente el consumo de energ√≠a en la etapa de dise√±o. </font><font style="vertical-align: inherit;">La tabla anterior muestra que no deber√≠amos perder el tiempo implementando m√°s CPUs que consumen mucha energ√≠a, si el TDP por n√∫cleo es mayor que la generaci√≥n actual; esto afectar√° negativamente a nuestra m√©trica, la cantidad de solicitudes por vatio. </font><font style="vertical-align: inherit;">Examinamos cuidadosamente los sistemas listos para operar para nuestra Generaci√≥n X en el mercado y tomamos una decisi√≥n. </font><font style="vertical-align: inherit;">Nos estamos mudando de nuestro circuito con 48 n√∫cleos Intel Xeon Platinum 6162 y dos z√≥calos a un AMD EPYC 7642 de 48 n√∫cleos con un z√≥calo.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/d3c/162/8f5/d3c1628f5dfb45681f0fb25abce76b3e.jpg"><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">---</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AMD</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPC</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xeon Platinum 6162</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPYC 7642</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microarquitectura</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Skylake" </font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "Zen 2"</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nombre clave</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Skylake SP"</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Roma" </font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proceso tecnol√≥gico</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">14nm</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7nm</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√∫cleos</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 24</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">48</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Frecuencia</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.9 GHz</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2,4 GHz</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L3 cach√© / socket</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">24 x 1.375MiB</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16 x 16MiB</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memoria / socket</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6 canales, hasta DDR4-2400</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8 canales, hasta DDR4-3200</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TDP</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 150W</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">225W</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PCIe / socket</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">48 carriles</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">128 carriles</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ES UN</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x86-64</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x86-64</font></font></td>
</tr>
</tbody></table></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A partir de las especificaciones, est√° claro que el chip de AMD nos permitir√° dejar el mismo n√∫mero de n√∫cleos, reduciendo TDP. </font><font style="vertical-align: inherit;">En la novena generaci√≥n, el TDP por n√∫cleo fue de 6.25 vatios, y en la X generaci√≥n ser√° de 4.69 vatios. </font><font style="vertical-align: inherit;">Una disminuci√≥n del 25%. </font><font style="vertical-align: inherit;">Debido al aumento en la frecuencia y, posiblemente, a un circuito m√°s simple con un solo z√≥calo, podemos suponer que el chip AMD demostrar√° ser mejor en los negocios. </font><font style="vertical-align: inherit;">Mientras llevamos a cabo varias pruebas y simulaciones para comprender cu√°nto mejor funcionar√° AMD.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mientras tanto, observamos que TDP es una m√©trica simplificada de las especificaciones del fabricante, que utilizamos en las primeras etapas del dise√±o del servidor y la selecci√≥n de la CPU. </font><font style="vertical-align: inherit;">Una b√∫squeda r√°pida en Google demuestra que AMD e Intel tienen diferentes enfoques para la definici√≥n de TDP, por lo que esta especificaci√≥n no es confiable. </font><font style="vertical-align: inherit;">El consumo de energ√≠a real de la CPU y, lo que es m√°s importante, el consumo de energ√≠a del servidor, es lo que realmente utilizamos al tomar la decisi√≥n final.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preparaci√≥n del ecosistema</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al comienzo de nuestro viaje para elegir el pr√≥ximo procesador, estudiamos una gran variedad de CPU de diferentes fabricantes que se adaptaban bien a nuestra pila de software y servicios (escritos en C, LuaJIT y Go). Ya hemos descrito en detalle un conjunto de herramientas para medir la velocidad </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en un art√≠culo en nuestro blog</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En este caso, utilizamos el mismo conjunto: nos permite evaluar la efectividad de la CPU en un tiempo razonable, despu√©s de lo cual nuestros ingenieros pueden comenzar a adaptar nuestros programas a un procesador espec√≠fico. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Probamos varios procesadores con un n√∫mero diverso de n√∫cleos, z√≥calos y frecuencias. Como estamos describiendo por qu√© nos decidimos por el AMD EPYC 7642 en este art√≠culo, todos los gr√°ficos en este blog se centran en c√≥mo funcionan los procesadores AMD en comparaci√≥n con el Intel Xeon Platinum 6162 de</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nuestra novena generaci√≥n</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los resultados corresponden a mediciones del funcionamiento de un servidor con cada variante de procesador, es decir, con dos procesadores de 24 n√∫cleos de Intel, o con un procesador de 48 n√∫cleos de AMD (servidor para Intel con dos sockets y servidor para AMD EPYC con uno). </font><font style="vertical-align: inherit;">En el BIOS, establecemos los par√°metros correspondientes a los servidores en funcionamiento. </font><font style="vertical-align: inherit;">Estos son 3.03 GHz para AMD y 2.5 GHz para Intel. </font><font style="vertical-align: inherit;">Simplificando mucho, esperamos que con la misma cantidad de n√∫cleos AMD muestre resultados un 21% mejores que Intel.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Criptograf√≠a</font></font></h2><br>
<img src="https://habrastorage.org/getpro/habr/post_images/eb4/843/287/eb484328713741f6688d81c15a9c5920.png"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/598/82b/416/59882b416feabd9eea86ea9d99d1e1df.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parece prometedor para AMD. </font><font style="vertical-align: inherit;">Funciona un 18% mejor en criptograf√≠a de clave p√∫blica. </font><font style="vertical-align: inherit;">Con una clave sim√©trica, pierde para las opciones de cifrado AES-128-GCM, pero en general se muestra comparable.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compresi√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En los servidores perimetrales, comprimimos una gran cantidad de datos para ahorrar ancho de banda y aumentar la velocidad de entrega de contenido. </font><font style="vertical-align: inherit;">Pasamos datos a trav√©s de las bibliotecas zlib y brotli C. </font><font style="vertical-align: inherit;">Todas las pruebas se realizaron en el archivo HTML blog.cloudflare.com en la memoria. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/fdc/bf7/ae1/fdcbf7ae1109d02a45b2ca40fe353376.png"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/ccc/427/983/ccc427983ceb85dbf63bab614850692f.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AMD gan√≥ un promedio de 29% al usar gzip. </font><font style="vertical-align: inherit;">En el caso de brotli, los resultados son a√∫n mejores en pruebas con calidad 7, que utilizamos para la compresi√≥n din√°mica. </font><font style="vertical-align: inherit;">Se produce una fuerte ca√≠da en la prueba de brotli-9; atribuimos esto al hecho de que Brotli consume mucha memoria y desborda el cach√©. </font><font style="vertical-align: inherit;">Sin embargo, AMD gana por un amplio margen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Muchos de nuestros servicios est√°n escritos en Go. </font><font style="vertical-align: inherit;">En los siguientes gr√°ficos, verificamos nuevamente las tasas de criptograf√≠a y compresi√≥n en Go con RegExp en l√≠neas de 32 KB utilizando la biblioteca de cadenas.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ir criptograf√≠a</font></font></h3><br>
<img src="https://habrastorage.org/getpro/habr/post_images/78a/ab0/495/78aab0495309cefee6f30bac835ee961.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ir a la compresi√≥n</font></font></h3><br>
<img src="https://habrastorage.org/getpro/habr/post_images/f99/2cb/95d/f992cb95d4913a2d19808d4bd15b5b54.png"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/850/e7c/f55/850e7cf5586f693dd14d62f70510f681.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ir regexp</font></font></h3><br>
<img src="https://habrastorage.org/getpro/habr/post_images/b58/798/6cb/b587986cbab94ca7087364a949f09aa4.png"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/444/e76/f72/444e76f72c1ec2e93c4cae0c5bd386f2.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ir cuerdas</font></font></h3><br>
<img src="https://habrastorage.org/getpro/habr/post_images/3e9/984/19a/3e998419adb450f598e0f3d82de01aa1.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AMD muestra los mejores resultados en todas las pruebas con Go, excepto el signo ECDSA P256, donde tiene un 38% de retraso, lo cual es extra√±o, teniendo en cuenta que mostr√≥ 24% mejores resultados en C. </font><font style="vertical-align: inherit;">Vale la pena descubrir qu√© est√° pasando all√≠. </font><font style="vertical-align: inherit;">Pero en general, AMD no gana mucho, pero a√∫n muestra los mejores resultados.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Luajit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A menudo usamos LuaJIT en la pila. </font><font style="vertical-align: inherit;">Este es el pegamento que contiene todas las partes de Cloudflare. </font><font style="vertical-align: inherit;">Y nos alegra que AMD haya ganado aqu√≠. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En general, las pruebas muestran que EPYC 7642 funciona mejor que dos Xeon Platinum 6162. AMD pierde en un par de pruebas, por ejemplo, AES-128-GCM y Go OpenSSL ECDSA-P256 Sign, sin embargo, gana en todas las dem√°s, en promedio en un 25% .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simulaci√≥n de carga de trabajo</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de nuestras pruebas r√°pidas, ejecutamos el servidor a trav√©s de otro conjunto de simulaciones en las que la carga sint√©tica se aplica a la pila de software del borde. Aqu√≠ simulamos una carga de trabajo de scripts con varios tipos de consultas que se pueden encontrar en el trabajo real. Las solicitudes var√≠an en t√©rminos de volumen de datos, protocolos HTTP o HTTPS, WAF, fuentes de trabajadores y otros de una variedad de variables. A continuaci√≥n se muestra una comparaci√≥n del rendimiento de las dos CPU para los tipos de solicitudes que encontramos con mayor frecuencia.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/594/dbb/4cf/594dbb4cf570a1c22ff666d592884ef7.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los resultados del diagrama se miden mediante los indicadores b√°sicos de la novena generaci√≥n de m√°quinas con procesadores Intel, normalizados a un valor de 1.0 a lo largo del eje x. </font><font style="vertical-align: inherit;">Por ejemplo, tomando solicitudes simples de 10 KiB a trav√©s de HTTPS, podemos ver que AMD es 1.5 veces mejor que Intel en t√©rminos de la cantidad de solicitudes por segundo. </font><font style="vertical-align: inherit;">En promedio, AMD tuvo un rendimiento 34% mejor para las pruebas dadas que Intel. </font><font style="vertical-align: inherit;">Teniendo en cuenta que TDP para un solo AMD EPYC 7642 es igual a 225 W, y para dos procesadores Intel - 300 W, ¬°resulta que en t√©rminos de "solicitudes por vatio" AMD muestra resultados 2 veces mejores que Intel!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este punto, est√°bamos claramente inclinados hacia la opci√≥n de un solo socket para AMD EPYC 7642 como nuestras futuras CPU para la Generaci√≥n X. Est√°bamos muy interesados ‚Äã‚Äãen saber c√≥mo se comportan los servidores AMD EPYC en el trabajo real, e inmediatamente enviamos varios servidores a algunos de centros de datos.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trabajo de verdad</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lo primero, por supuesto, fue preparar el servidor para trabajar en condiciones reales. </font><font style="vertical-align: inherit;">Todas las m√°quinas de nuestra flota funcionan con los mismos procesos y servicios, lo que hace que sea una gran oportunidad para comparar correctamente el rendimiento. </font><font style="vertical-align: inherit;">Como en la mayor√≠a de los centros de datos, tenemos implementadas varias generaciones de servidores, y ensamblamos nuestros servidores en grupos para que cada clase contenga servidores de aproximadamente la misma generaci√≥n. </font><font style="vertical-align: inherit;">En algunos casos, esto puede resultar en curvas de utilizaci√≥n que var√≠an entre grupos. </font><font style="vertical-align: inherit;">Pero no con nosotros. </font><font style="vertical-align: inherit;">Nuestros ingenieros han optimizado la utilizaci√≥n de la CPU para todas las generaciones para que, independientemente de si la CPU tiene 8 n√∫cleos en una m√°quina en particular o 24, el uso de la CPU no suele ser diferente del resto.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/9b9/ea2/a9b/9b9ea2a9b8b70ad4e6e8f3b4e72200a3.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El gr√°fico ilustra nuestro comentario sobre la similitud de utilizaci√≥n: no existe una diferencia significativa entre el uso de CPU AMD en servidores Gen X y el uso de procesadores Intel en servidores Gen 9. Esto significa que tanto los servidores de prueba como los servidores centrales se cargan por igual. Multa. Esto es exactamente lo que logramos en el trabajo de nuestros servidores, y necesitamos esto para una comparaci√≥n honesta. Los dos gr√°ficos a continuaci√≥n muestran el n√∫mero de solicitudes procesadas por un n√∫cleo de CPU y todos los n√∫cleos a nivel de servidor. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/075/8a6/91c/0758a691c0287281bd4c70bc1625d631.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consultas al </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/0a2/c5d/206/0a2c5d206c83c98cc06b910118a03a17.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">servidor Consultas al servidor</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se puede ver que, en promedio, AMD procesa un 23% m√°s de solicitudes. ¬°No est√° mal! A menudo escribimos en nuestro blog sobre formas de aumentar el rendimiento de Gen 9. Y aqu√≠ tenemos la misma cantidad de n√∫cleos, pero AMD est√° haciendo m√°s trabajo con menos energ√≠a. Inmediatamente a partir de las especificaciones para el n√∫mero de n√∫cleos y TDP, se puede ver que AMD produce m√°s velocidad con mayor eficiencia energ√©tica. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero, como ya mencionamos, TDP no es una especificaci√≥n est√°ndar, y no es la misma para todos los fabricantes, as√≠ que veamos el uso real de la energ√≠a. Al medir el consumo de energ√≠a del servidor en paralelo con el n√∫mero de solicitudes por segundo, obtuvimos el siguiente gr√°fico:</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/eac/f1a/a0f/eacf1aa0fcbee9f35c376bf52a7f37d1.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por el n√∫mero de solicitudes por segundo gastadas por vatio, el servidor Gen X en procesadores AMD es un 28% m√°s eficiente. Uno podr√≠a haber esperado m√°s, dado que el TDP de AMD es un 25% m√°s bajo, sin embargo, debe recordarse que el TDP es una caracter√≠stica ambigua. Vimos que el consumo de energ√≠a real de AMD casi coincide con el TDP indicado a una frecuencia muy superior a la base; Intel no tiene eso. Esta es otra raz√≥n por la cual TDP no es una estimaci√≥n confiable del consumo de energ√≠a. Las CPU Intel en nuestros servidores Gen 9 est√°n integradas en el sistema multicode, mientras que las CPU AMD funcionan en servidores est√°ndar de factor de forma 1U. Esto no habla a favor de AMD, ya que los servidores multinodo deber√≠an proporcionar una mayor densidad con menos consumo de energ√≠a por nodo, sin embargo, AMD a√∫n super√≥ a Intel en t√©rminos de consumo de energ√≠a por nodo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la mayor√≠a de las comparaciones en especificaciones, simulaciones de prueba y rendimiento del mundo real, la configuraci√≥n 1P AMD EPYC 7642 demostr√≥ ser significativamente mejor que la 2P Intel Xeon 6162. En algunas condiciones, AMD puede funcionar un 36% mejor, y creemos que al optimizar el hardware y los programas, podemos lograr tal mejora de forma continua. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Resulta que AMD gan√≥. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gr√°ficos adicionales muestran el retraso promedio y el retraso de p99 en la operaci√≥n NGINX durante 24 horas. </font><font style="vertical-align: inherit;">En promedio, los procesos de AMD se ejecutaron un 25% m√°s r√°pido. </font><font style="vertical-align: inherit;">En p99, funciona 20-50% m√°s r√°pido dependiendo de la hora del d√≠a.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los ingenieros de hardware y rendimiento de Cloudflare realizan una gran cantidad de pruebas e investigaciones para seleccionar la mejor configuraci√≥n de servidor para nuestros clientes. Nos gusta trabajar aqu√≠ porque podemos resolver tareas tan grandiosas y tambi√©n ayudarlo a resolver sus problemas con servicios como la computaci√≥n de borde sin servidor y una variedad de soluciones a problemas de seguridad, en particular, Magic Transit, Argo Tunnel y protecci√≥n DDoS . Todos los servidores en la red Cloudflare est√°n configurados para una operaci√≥n confiable, y siempre estamos tratando de hacer que cada pr√≥xima generaci√≥n de servidores sea mejor que la anterior. Creemos que AMD EPYC 7642 es la respuesta a la pregunta sobre la elecci√≥n de procesadores para Gen X.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usando el servicio Cloudflare Workers, los desarrolladores implementan sus aplicaciones en nuestra red, expandi√©ndose por todo el mundo. Estamos orgullosos de ofrecer a nuestros clientes la oportunidad de concentrarse en escribir c√≥digo mientras trabajamos en seguridad y confiabilidad en la nube. Y hoy nos complace a√∫n m√°s anunciar que su trabajo se implementar√° en nuestros servidores de generaci√≥n Gen X que ejecutan procesadores AMD EPYC de segunda generaci√≥n. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/7de/304/54d/7de30454d5b87e7a32fceda1e3f7ca49.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Procesadores EPYC 7642, con el nombre en c√≥digo "Roma" [Roma]</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Utilizando el EPYC 7642 de AMD, pudimos aumentar nuestra velocidad y facilitar la expansi√≥n de la red a nuevas ciudades. Roma no se construy√≥ en un d√≠a, pero pronto estar√° m√°s cerca de muchos de ustedes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En los √∫ltimos a√±os, hemos experimentado con muchos chips x86 de Intel y AMD, as√≠ como con procesadores de ARM. </font><font style="vertical-align: inherit;">Esperamos que en el futuro, estos fabricantes de CPU trabajen junto con nosotros para que juntos podamos construir una Internet mejorada.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es493096/index.html">Agregue un tema oscuro en iOS</a></li>
<li><a href="../es493098/index.html">Implemente el cl√∫ster de equilibrio de carga VPN ASA</a></li>
<li><a href="../es493100/index.html">C√≥mo encontrar formas f√°ciles ayuda a las startups a lograr un crecimiento agresivo</a></li>
<li><a href="../es493102/index.html">Tendencias de automatizaci√≥n global: desarrollo de RPA</a></li>
<li><a href="../es493106/index.html">¬øCu√°nto hay de nuevo en la Docena del Diablo?</a></li>
<li><a href="../es493110/index.html">C√≥mo delegar en el trabajo remoto: una gu√≠a para el liderazgo del equipo y m√°s</a></li>
<li><a href="../es493112/index.html">C√≥mo comenzar un nuevo negocio en 6 meses en lugar de 3 a√±os</a></li>
<li><a href="../es493114/index.html">C√≥mo el ingeniero de datos observ√≥ los datos</a></li>
<li><a href="../es493116/index.html">"¬°M√°s interactividad!" o ¬øC√≥mo fue TeamLead Conf 2020?</a></li>
<li><a href="../es493118/index.html">Descripci√≥n general de la extensi√≥n de etiquetado de memoria (Armv8.5-A)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>