<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëµüèΩ üç∏ üï¥üèª Examination of the type system for checking the correctness of music üîö üîÅ ü•Ö</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today, much is said about the presentation of music using programming languages, since on the one hand it is an interesting task for engineers, and on...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Examination of the type system for checking the correctness of music</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/nix/blog/490010/"><img src="https://habrastorage.org/webt/ge/ng/6l/geng6lj6ji51qdtlif1kb8izjnm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Today, much is said about the presentation of music using programming languages, since on the one hand it is an interesting task for engineers, and on the other it is part of the task of universal description of music. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What does it look like? For many languages, music programming environments have been created. The most popular are </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TidalCycles</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for Haskell and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sonic Pi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for Ruby on the Raspberry Pi. There is also a tool using </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the Leipzig composer library</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Since it is written in Clojure, it lacks type checking.</font></font><br>
<br>
<pre><code class="plaintext hljs">(def row-row-row-your-boat<font></font>
  (phrase [3/3 3/3 2/3 1/3 3/3]<font></font>
          [  0   0   0   1   2]))<font></font>
<font></font>
-&gt;&gt; row-row-row-your-boat<font></font>
  (canon (simple 4))<font></font>
  (where :pitch (comp C major))<font></font>
  (where :time (bpm 90))<font></font>
  play)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The duration and pitch of sounds are represented as integers and literal coefficients, which is not very convenient. When it comes to music transformation, programming can be a great help. Say, in the above example, the key is set to the key of C major and the tempo is 90 beats per minute.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When programmers see music code, they most often ask whether it is possible to prevent fake execution using a type system. Fair question. If music can be represented as code, can errors in writing music be considered programming errors? And if so, why not improve the process of writing music using the techniques we use to write programs? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In particular, there is an obvious analogy between errors that the type system can prevent and common cases of musical inaccuracy. If your programming language is able to check whether you passed a string to a function that expects to get a number, then it can check that you do not use f-sharp in a passage written in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C major</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, the key of which there are no signs of alteration. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this article, we will find out what makes music correct and how it can be represented using a type system.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prescriptivism</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Theorists have been arguing for centuries about what makes music right. </font><font style="vertical-align: inherit;">Most often, they operate within the framework of musical prescriptivism: evaluating music for compliance with some set of rules. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can describe the dominant methodology for the formation of rules:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Learning the canon</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Definition of patterns</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formulating them as a set of rules</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then it can be argued that:</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Music that does not comply with these rules is incorrect.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, the composition rule states that it is not allowed to make a jump to a large septima from to to s in the melody. This approach has led to numerous valuable findings. Classical music has extremely interesting patterns, and a generalization of our observations as a set of rules helps in discussing the phenomenon of music. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition, following the rules is useful when mastering musical instruments. It‚Äôs good when teachers correct children who practice playing the violin in C major, but go astray. There are situations in which it is useful to adhere to the definitions of correct and incorrect music. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, this approach has two main disadvantages.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First, the rules arising from this process are highly dependent on what the theorist considers canon. The bias of the dataset leads to the bias of the conclusions, and Western classical music does not reflect the entire musical experience of mankind. Creating rules based on the music of Bach and Mozart can be fun, but they won't tell you too much about music in general. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The situation is complicated when you realize that musical genres are often strongly associated with certain cultures and ethnic groups, and that prioritizing certain types of music you thereby unwittingly prioritize certain types of people. For example, in the academic theory of music, much attention is paid to the study of classical European traditions and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relatively little to music originating in the diasporas of immigrants from Africa</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: blues, jazz, rock and roll and hip hop. If we evaluate the correctness of music through the traditional theory, this may lead to a culturological version of the problem when </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">face recognition algorithms worked better with Caucasians than with Negroids.</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
The second big drawback of creating rules by identifying and generalizing patterns is that in this way we will always focus on the past. And music excites most when it breaks the rules. Before </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jimmy Page used the distortion effect</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , engineers considered clipping the signal during amplification as a defect. And although the revealed patterns help to understand modern music, however, they are completely unsuitable for evaluating future music.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A good type system for music should avoid both described traps of prescriptivism. </font><font style="vertical-align: inherit;">It should not be based on unacceptable or subjective criteria for correct music. </font><font style="vertical-align: inherit;">At the same time, trying to </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">make erroneous states unrepresentable</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the type system should not interfere with the appearance of new states.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descriptivism</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An alternative to prescriptivism is descriptivism. </font><font style="vertical-align: inherit;">If in the first case musical patterns are considered as binding rules, then in the second they are considered as patterns that are formed in the course of practice. </font><font style="vertical-align: inherit;">A descriptive approach to the study of musical rules looks like this:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exploring the body of music</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Identify trends</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We formulate them in the form of a model</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It can be argued that:</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Music deviating from the model is unusual.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To do this, we need a good model of musical structures that can describe the ordinary or the unusual, rather than the right or the wrong. </font><font style="vertical-align: inherit;">David Huron, in his book </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sweet Anticipation,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> offers a descriptive theory that can be reduced to three key aspects:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Music is graded through statistical training</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You are pleased with the correct forecast</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Novelty doesn't let you get bored</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In our previous prescriptivistic example, jumping from a note to C is considered a mistake. </font><font style="vertical-align: inherit;">And according to the theory of Huron, this will be very unusual. </font><font style="vertical-align: inherit;">Those who have listened to Western music a lot will find out that when they hear a note to, the next note will most often be another note, or a note one step higher or lower in sound. </font><font style="vertical-align: inherit;">Jumping up to the B will surprise the audience, and they may take this negatively.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One of the curious consequences of Huron's theory is that writing music is not an exercise in maximizing or minimizing fiction. Music balances on the border between order and chaos, and the location of the listeners depends on the ability of the musician to balance the shock of novelty with the satisfaction of receiving the expected. If you really want to check the correctness of the composition, you will have to make sure that it does not go too far from accepted traditions, but also does not observe them too strictly.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The following are data from a statistical analysis of melodic trends. Darker colors indicate more likely results. Select a line with one of the notes and find on it a cell with a note that is more likely to follow your choice - the intersection highlighted in dark with the column of another note. For example, in this dataset in 33.53% of cases after the note re comes the note to.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d5f/958/cf0/d5f958cf07219b7f4d092ab67b2e9529.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
These data are taken from the book of Huron, they are the result of the analysis of more than 250,000 tone pairs from Germanic folk songs in major. Another array of data, say hip-hop or rock and roll, will demonstrate different probabilities. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All these probabilities can be equivalently represented as entropy bits: a probability of 50% corresponds to one bit, a probability of 25% to two bits, etc. To avoid dividing by zero, we assume that for transitions that never occur in the dataset, the probability is 1/100 000. Now the darker color shows transitions that are more expensive in terms of entropy - that is, less likely. For example, for re after equals 6 bits of entropy, that is, it has a probability of 1/64.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a3f/ae7/419/a3fae7419ea6c759ee7ff137cc6810db.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Representation in the form of entropy helps us to combine surprise from a series of notes in which each transition from one sound to another is an entropy counter, with surprise from the whole melody as the sum of transitions.</font></font><br>
<br>
<pre><code class="plaintext hljs"> -&gt;  -&gt;  -&gt;  = 2,20 + 2,71 + 5,94 = 10,85 <font></font>
 -&gt;  -&gt;  -&gt;  = 2,48 + 7,43 + 5,94 = 15,85 <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is very similar to the hidden </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Markov model</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , but instead of generating strings of notes, we use weighted probabilities to estimate the likelihood of a melody. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You may have noticed that the transition from note to C is only 2.48 bits, although at first glance this contradicts the fact that the transition from C to C was described above as very unusual. </font><font style="vertical-align: inherit;">Most often, unusual transitions are approximately 10 bits of entropy. </font><font style="vertical-align: inherit;">The reason for the discrepancy is that the Huron data does not distinguish between a jump of six notes from to to si (very unusual) and a transition to one note from to to a lower si (a fairly common situation). </font><font style="vertical-align: inherit;">If the data allows us to separate these two cases, then the model will show that the chain of do-si-mi-fa will sound even more unconventional than before-re-mi-fa.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Typed notes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ideally, a type system helps programmers make the right decisions and eliminates the possibility of errors. </font><font style="vertical-align: inherit;">A good musical analogy is solfeggio. </font><font style="vertical-align: inherit;">If you do not have a musical education, then you could get acquainted with solfeggio on the song </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Do-Re-Mi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from the musical </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The Sound of Music</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Each note of an octave has its own name, and any note outside the tonality of the name does not have:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To (lowest note from this set)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Re</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mi</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Salt</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To (now an octave higher)</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This system allows musicians to adhere to the correct notes, it sets a mini-language that prohibits playing notes outside the selected key. </font><font style="vertical-align: inherit;">There are infinitely many frequencies between d and re, but they are not reproduced within the solfeggio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This can be easily represented in the code as algebraic type data:</font></font><br>
<br>
<pre><code class="plaintext hljs">data Solfege = Do | Re | Mi | Fa | So | La | Ti
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now you can define musical functions that do not allow notes outside the keys. For example, this function repeats one note </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> times:</font></font><br>
<br>
<pre><code class="plaintext hljs">repeat : Nat -&gt; Solfege -&gt; List Solfege<font></font>
repeat 0 s = [s]<font></font>
repeat n s = s :: repeat (n - 1) s<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
With this definition, triple repetition of a note re is an expression that will be easily understood in the musical field. </font><font style="vertical-align: inherit;">A three-fold repetition of a sharp sharp is a type check error, because the sharp sharp is not a type value </font></font><code>Solfege</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This gives us a certain type of safety. </font><font style="vertical-align: inherit;">Our system allows us to avoid the wrong notes, but it still does not protect against incorrect </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">combinations of</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> notes. </font><font style="vertical-align: inherit;">If we played in C major, we would not play F sharp, but we could play C, then jump to a large septima on a B note, which is forbidden by (traditional) composition rules. </font><font style="vertical-align: inherit;">Such contextual type checking is possible, but requires a more complex approach.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Typed Transitions</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mezzo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Haskell library </font><font style="vertical-align: inherit;">uses related types to verify musical correctness. </font><font style="vertical-align: inherit;">The description says that this is a "very strict test for music", the library can check for compliance with various rules of composition, and not just tonality. </font><font style="vertical-align: inherit;">In Mezzo, the following code is compiled because the pre-re-mi-fa melody consists of the allowed intervals:</font></font><br>
<br>
<pre><code class="plaintext hljs">comp = defScore $ start $ melody :| c :| d :| e :| f :&gt;&gt; g
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But if we break the rule prohibiting jumping from to to si, then Mezzo will not compile such a code:</font></font><br>
<br>
<pre><code class="plaintext hljs">comp = defScore $ start $ melody :| c :| b :| e :| f :&gt;&gt; g
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It‚Äôs great that Mezzo will even point out a problem:</font></font><br>
<br>
<pre><code class="plaintext hljs">Major sevenths are not permitted in melody: C and B<font></font>
In the first argument of ‚Äò(:|)‚Äô, namely ‚Äòmelody :| c :| b‚Äô<font></font>
In the first argument of ‚Äò(:|)‚Äô, namely ‚Äòmelody :| c :| b :| e‚Äô<font></font>
In the first argument of ‚Äò(:&gt;&gt;)‚Äô, namely<font></font>
    ‚Äòmelody :| c :| b :| e :| f_‚Äô<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It may seem that the dream of presenting incorrect music as type errors has come true. </font><font style="vertical-align: inherit;">But sometimes awkward situations arise. </font><font style="vertical-align: inherit;">When the author of the library encoded Chopin's prelude, it turned out that on several occasions the composer did not follow the traditional rules:</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The work was transcribed almost entirely, but sometimes it was necessary to skip a few notes because they created the forbidden intervals indicated by Mezzo.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You may ask, who undertook to ban it? </font><font style="vertical-align: inherit;">If Chopin is not allowed to talk about what is permissible in Western music and what is not, then who then? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The problem is that although Mezzo is able to take context into account, type estimation remains a binary choice task. </font><font style="vertical-align: inherit;">Either all the notes are correct and the work is compiled, whether one of the notes is knocked out and the work is not compiled. </font><font style="vertical-align: inherit;">And despite the fact that Mezzo allows you to choose composition rules, the decision to apply or not apply the rule is global. </font><font style="vertical-align: inherit;">If you disable the rule because some musical decision violates the usual agreement, then you will cancel the check of other parts of the work.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Typed entropy</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One way to break or circumvent musical typing rules is to model the transitions between notes in terms of similarity on Huron‚Äôs advice. </font><font style="vertical-align: inherit;">Instead of declaring a particular transition right or wrong, you can calculate the amount of entropy that reflects the audience‚Äôs surprise at the pairing combinations of notes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The following code is written in the dependent typed functional language </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Idris</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">In the code, it is checked that the melody corresponding to the rules starts with to and ends with salt and that the path between these notes generates 8-16 bits of entropy. </font><font style="vertical-align: inherit;">First you need to determine the type </font></font><code>Melody</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that reflects our representation of the melody with a certain similarity or magnitude of entropy. </font><font style="vertical-align: inherit;">This type has three constructors:</font></font><br>
<br>
<ul>
<li><code>Pure</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Reflects the creation of a melody from a single note, with an upper and lower entropy level equal to zero.</font></font></li>
<li><code>(&gt;&gt;=)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: takes two melodies and adds up their entropy boundaries with the cost of switching from a note at the end of the first melody to a note to at the end of the second.</font></font></li>
<li><code>Relax</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: takes a melody and expands its boundaries of entropy.</font></font></li>
</ul><br>
<pre><code class="plaintext hljs">data Melody : (Solfege, Solfege) -&gt; (Nat, Nat) -&gt; Type where<font></font>
<font></font>
  Pure  : x -&gt; Melody (x, x) (0, 0)<font></font>
<font></font>
  (&gt;&gt;=) : Melody (w, x) (low, high) -&gt;<font></font>
          (() -&gt; Melody (y, z) (low2, high2)) -&gt;<font></font>
          Melody (w, z) (cost x y + low + low2, cost x y + high + high2)<font></font>
<font></font>
  Relax : Melody (x, y) (low + dl, high) -&gt;<font></font>
          Melody (x, y) (low, high + dh)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This type definition is more complicated, but thanks to it, Idris can compose a melody using notation </font></font><code>do</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and the compiler will track the boundaries of entropy for us. </font><font style="vertical-align: inherit;">Here's the relevant tune with the low cost of all transitions:</font></font><br>
<br>
<pre><code class="plaintext hljs">conventional : Melody (Do, So) (8, 16)<font></font>
conventional = Relax $ do<font></font>
  Pure Do<font></font>
  Pure Re<font></font>
  Pure Mi<font></font>
  Pure Fa<font></font>
  Pure So<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The following tune does not comply with the rules, because it jumps to a large septima. </font><font style="vertical-align: inherit;">In Mezzo, it will either be prohibited, or you will have to completely disable the rule. </font><font style="vertical-align: inherit;">Here we just expanded the boundaries of the complexity of the melody so that it fit into the range of 8-24 bits of entropy:</font></font><br>
<br>
<pre><code class="plaintext hljs">unconventional : Melody (Do, So) (8, 24)<font></font>
unconventional = Relax $ do<font></font>
  Pure Do<font></font>
  Pure Ti<font></font>
  Pure Mi<font></font>
  Pure Fa<font></font>
  Pure So<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If instead </font></font><code>Melody (Do, So) (8, 24)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">we would assign a type not conforming to the rules of the melody </font></font><code>Melody (Do, So) (8, 16)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, then it would not compile! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The novelty of the approach is that it allows you to understand when the music becomes too boring. If the entropy of the melody does not reach the lower limit, a type error is generated. So if you assign a type to a melody that complies with the rules, </font></font><code>Melody (Do, So) (16, 24)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">then it will not be compiled either, because its entropy does not reach the lower limit. This inspires us with faith in the Huron theory, according to which it will be too hard for people to listen to music that is too unusual or unpredictable.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In a degenerate case, transitions between notes inside a key do not increase entropy, and transitions outside a key give an arbitrarily large increase in entropy. </font><font style="vertical-align: inherit;">Then it is advisable to revert to a binary evaluation, in which each note will be considered permitted or prohibited, without any intermediate statuses.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Important but difficult to verify</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Checking types in music is difficult because it is difficult to determine the correctness of the music. If we cannot mathematically accurately model the definition of musical correctness, then we cannot transfer it to the type system. Even if we can authentically formalize our understanding, we will need to make an effort and apply a powerful type system so that the compiler can adequately evaluate the melody. However, this is possible with some definition and a few simplifying assumptions. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Is this just curiosity? Maybe. It is unlikely that the music industry will soon adopt a type system to prevent compositional errors. But if the study of computing in the field of music will help us to evaluate differently what plays such an important role in the life of almost all of us, then this alone justifies all efforts.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perhaps no less important is the fact that music is only one of the areas where correctness is important, but difficult to verify. </font><font style="vertical-align: inherit;">The more actively the social and cultural sphere is automated with the help of programming, the more often situations arise in which it is difficult to evaluate the answer, which is crucial for people. </font><font style="vertical-align: inherit;">Take the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">use of a computer program that decides how long to imprison</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The correctness of the sentences imposed depends on complex trade-offs between costs and probabilities, and if we cannot track the logic of decision-making by the system, then how can we evaluate the fairness of the result? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Every time we automate opaque decision-making processes, we need to ask ourselves: ‚ÄúHow do we know that the system is working correctly?‚Äù</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en489992/index.html">Correct pod shutdown in Kubernetes cluster</a></li>
<li><a href="../en489994/index.html">Kubernetes tips & tricks: graceful shutdown runtime features in NGINX and PHP-FPM</a></li>
<li><a href="../en489998/index.html">11. Fortinet Getting Started v6.0. Licensing</a></li>
<li><a href="../en490002/index.html">How to GraphQL on Kotlin and Micronaut and create a single access point to the API of several microservices</a></li>
<li><a href="../en490006/index.html">Educational program for technical specifications</a></li>
<li><a href="../en490012/index.html">Alert-s and Error-s of storage, how to deal with them?</a></li>
<li><a href="../en490014/index.html">JavaScript tree shaking, like a pro</a></li>
<li><a href="../en490018/index.html">How to design mobile applications for one hand</a></li>
<li><a href="../en490020/index.html">Translation into English in IT sphere by the example of PVS-Studio</a></li>
<li><a href="../en490026/index.html">How we Elasticsearch put things in order: data sharing, cleaning, backups</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>