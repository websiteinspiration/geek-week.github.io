<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïã üñ®Ô∏è üñïüèæ Pure PHP architecture. How to measure and control it? üöµüèΩ üßë ü•á</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foreword
 As you already understood from the name, here I‚Äôm going to talk about the most ‚Äúhigh‚Äù - Pure architecture. And the impetus for the developme...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Pure PHP architecture. How to measure and control it?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/504590/"><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foreword</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you already understood from the name, here I‚Äôm going to talk about the most ‚Äúhigh‚Äù - Pure architecture. And the impetus for the development of this whole story was the book of Robert Martin ‚ÄúPure architecture‚Äù. If I haven‚Äôt read it yet, I dare to recommend it! The author reveals many important topics, actively shares his rich life experience (from a professional field, of course) and the conclusions made on its basis, occasionally weaves into chapters of the story how masterfully shit-headed (and not only, of course) our fathers and grandfathers back in the 60s, 70s, 80s and even the dashing 90s, like grains of grain, everyone's favorite principles of SOLID and their analogues in the world of components were collected, and what they learned over the past half century. In the process of reading the book, the development line of the software development industry is well traced, typical problems that boys had to deal with,and methods for solving them.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Do not think, retelling the summary of the book is not the purpose of this post. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, we will talk about ideas that prompted me to develop one tool (I will determine the degree of its usefulness to you, and I will be waiting for feedback, suggestions and constructive criticism with great interest). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It seems to me that the article will be useful to everyone. Those who are already familiar with the book will be able to refresh some of its moments in their memory, or simply skip the first part and immediately begin to familiarize themselves with the tool. Those who have not read the book before may perhaps find something new for themselves in the first part.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For convenience, the article is divided into 2 parts. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the first I will talk about the key ideas that generated in my head the desire to automate this whole thing, are we programmers or who in the end? </font><font style="vertical-align: inherit;">Here I will quote a lot from the author, as well as actively insert extracts and illustrations from different chapters of the book. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The second part, almost entirely, will be devoted to describing the tool that has appeared, revealing its capabilities and step-by-step guidance. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you consider yourself to be a category of people taking everything too close to your heart, I advise you to start reading from the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Afterword</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Content</font></font></b>
                        <div class="spoiler_text"><ul>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Part one</font></font></a><br>
 <ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is software architecture?</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is the purpose of architecture?</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Where do many projects start?</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Two values ‚Äã‚Äãof software products</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why did you come up with SOLID and why is it not enough alone?</font></font></a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connectivity of components and its determining principles</font></font></a><br>
 <ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">REP: Reuse / Release Equivalence Principle</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CCP: Common Closure Principle</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CRP: Common Reuse Principle</font></font></a></li>
</ul><br>
 </li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">     </a><br>
 <ul>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">ADP: Acyclic Dependencies Principle</a><br>
 <ul>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">   </a><br>
 <ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">1. DIP (  )</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">2.   </a></li>
</ul><br>
 </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  ,    </a></li>
</ul><br>
 </li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">SDP: Stable Dependencies Principle</a><br>
 <ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">    ?</a></li>
</ul><br>
 </li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">SAP: Stable Abstractions Principle</a><br>
 <ul>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">    ?</a><br>
 </li>
</ul><br>
 </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">     ?</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">   </a></li>
</ul><br>
 </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  (. )</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="></a></li>
</ul><br>
 </li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> </a><br>
 <ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">   </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">   .   .</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> PHP Clean Architecture</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">    </a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  </a><br>
 <ul>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">1.    </a><br>
 <ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  A/I ,   </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">     </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">    </a></li>
</ul><br>
 </li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">2.    </a><br>
 <ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  </a></li>
</ul><br>
 </li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">3.     </a><br>
 <ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">   / </a></li>
</ul><br>
 </li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> </a><br>
 <ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  -    </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> - D   </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">Public/Private Class  PHP</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">   ADP  SDP</a></li>
</ul><br>
 </li>
</ul><br>
 </li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">   CI/CD</a><br>
 <ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> </a></li>
</ul><br>
 </li>
</ul><br>
 </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="></a></li>
</ul><br>
</div>
                    </div><a name="1"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Part 1</font></font></h2><a name="2"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is software architecture?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alas, the author of the book does not give a single definition. </font><font style="vertical-align: inherit;">There are a large number of different formulations, and all of them are correct in their own way. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, we can go from the other side ..</font></font><a name="3"></a><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is the purpose of architecture?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There is only one answer: </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The goal of software architecture is to reduce the human labor required to create and maintain a system. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A little introductory ..</font></font><a name="4"></a><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Where do many projects start?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚ÄúWe will be able to restore order later, we would only enter the market!‚Äù </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a result, order has not been restored, because the pressure of competition in the market never wanes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚ÄúThe biggest lie many developers believe is that dirty code will help them quickly enter the market, but in reality it will slow down their movement in the long run. </font><font style="vertical-align: inherit;">Developers who believe in this lie show Hare‚Äôs arrogance, believing that in the future they will be able to move from creating disorder to restoring order, but they make a simple mistake. </font><font style="vertical-align: inherit;">The fact is that the creation of disorder is always slower than the steady observance of cleanliness, regardless of the chosen time scale. "</font></font><a name="5"></a><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Two values ‚Äã‚Äãof software products</font></font></h4><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Behavior (something urgent but not always important)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Architecture (something important, but not always urgent)</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Many often drown in the first, and completely neglect the second. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Type: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúWhy waste time thoroughly thinking over architecture, the main thing is that it works correctly!‚Äù</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But they miss one important point: ‚ÄúIf a properly working program does not allow the possibility of changing it, it will stop working correctly when the requirements change, and they will not be able to make it work correctly. That is, the program will become useless. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If the program does not work correctly, but is easily amenable to change, they will be able to make it work correctly and maintain its performance as requirements change. That is, the program will always remain useful. ‚Äù </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I liked this statement:</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúIf you think good architecture is expensive, try poor architecture.‚Äù</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Brian Foote and Joseph Yoder) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It turns out that </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">it is important</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to pay due attention to code cleanliness and architecture in general from the very first lines. But, if everything is relatively clear with the purity of the code (sniff out all sorts of bad smells in the code, and correct it, besides the tools are full of smart IDEs, static analyzers, and other undoubtedly important rubbish), then with architecture it‚Äôs not quite so (at least least me).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How can you control something that is so vague that it is difficult even to be defined by a single wording that it has a very versatile view and every second, damn it, shit sees it and tries to interpret it in its own way, if you are not Vanga‚Äôs grandson, didn‚Äôt win the show ‚ÄúIntuition ‚ÄùAnd are not particularly sensitive fifth point? </font><font style="vertical-align: inherit;">Then the author of the book throws up a couple of valuable thoughts for thought ... Let's sort it out.</font></font><a name="6"></a><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why did you come up with SOLID and why is it not enough alone?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We all probably know the principles of SOLID. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Their goal</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is to create mid-level software structures that:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tolerant of change;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">simple and understandable;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">form the basis for components that can be used in many software systems.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But: ‚ÄúJust like good bricks can make an unusable wall, so well-designed components of the average level can create an unusable system.‚Äù </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Therefore, in the world of components, there are analogues of SOLID principles, as well as high-level principles for creating architectures. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I will touch on these topics very superficially, more details can be found in the book. </font><font style="vertical-align: inherit;">Let's go!</font></font><a name="7"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connectivity of components and its determining principles</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚ÄúTo which component does this or that class belong? </font><font style="vertical-align: inherit;">This important decision must be made in accordance with established software development principles. </font><font style="vertical-align: inherit;">Unfortunately, such decisions are of a special nature and are taken almost exclusively on the basis of context. ‚Äù</font></font><a name="8"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">REP: </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reuse / Release Equivalence Principle - The principle of equivalence of reuse and releases.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In terms of architecture and design, this principle means that the classes and modules that make up a component must belong to a connected group. A component cannot simply include a random mixture of classes and modules; There should be some theme or goal common to all modules. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Classes and modules combined into a component must be released together.</font></font><a name="9"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CCP: </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Common Closure Principle - the principle of consistent change.</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
This is the principle of SRP (single responsibility) rephrased for components. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Classes that change for the same reasons and at the same time should be included in one component. Different components should include classes that change at different times and for various reasons.</font></font><a name="10"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CRP: </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Common Reuse Principle - The principle of shared reuse.</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
This principle is similar to ISP (interface segregation). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Do not force component users to depend on what they do not need. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The principle indicates that classes that are not closely related should not be included in one component. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚ÄúPerhaps you have already noticed that the three principles of connected components come into conflict with each other. The principles of reuse equivalence (REP) and consistent change (CCP) are inclusive: both strive to make the components as large as possible. The Reuse Principle (CRP) is exceptional, striving to make components as small as possible. The task of a good architect is to resolve this contradiction. ‚Äù</font></font><br>
<br>
<img src="https://habrastorage.org/webt/to/sk/yl/toskylulwgshxendjozwzjf9sly.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚ÄúIn the past, we looked at connectivity easier than the principles of reuse equivalence (REP), consistent change (CCP), and shared reuse (CRP) suggest. Once we thought that connectivity is just an attribute, that a module performs one and only one function. However, the three principles of component connectivity describe a much more complex variety. When choosing classes for inclusion in components, you must consider the opposing forces associated with ease of reuse and development. Finding a balance of these forces based on the needs of the application is not an easy task. In addition, the balance is almost always constantly shifted. That is, the partition considered successful today may be unsuccessful after a year. Consequently,the composition of the components will almost certainly change over time and the focus of the project will shift from ease of development to ease of reuse. ‚Äù</font></font><a name="11"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Component Compatibility</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚ÄúThe following three principles define the rules for the relationship between components. </font><font style="vertical-align: inherit;">And again, we are faced with contradictions between ease of development and logical organization. </font><font style="vertical-align: inherit;">The forces affecting the architecture of the component structure are technical, political, and volatile. ‚Äù</font></font><a name="12"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ADP: </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acyclic Dependencies Principle - the principle of acyclicity of dependencies. </font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Loops in the component dependency graph are not allowed! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/r0/od/sf/r0odsfch_htpxpurtonelpiy-em.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
From whatever component displayed on the graph, you start moving along the arrows indicating the direction of the dependency, you will not be able to return to the original point. </font><font style="vertical-align: inherit;">This is an acyclic oriented graph (DAG - Directed Acyclic Graph). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ib/wg/d8/ibwgd8xnihw0qilpi7i32rvaxkk.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this image, we have a dependency leading to the appearance of a cycle. </font><font style="vertical-align: inherit;">The resulting cyclic dependence can always be broken.</font></font><a name="13"></a><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Methods for breaking cyclic dependencies</font></font></h4><a name="14"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. By applying DIP (dependency inversion principle)</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oy/dp/8b/oydp8bixvzlwccqadsmdnrqqtdi.png" alt="image"><a name="15"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Introduction of the new component </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2e/51/ty/2e51tyj9bfrfimyiqxgzrqqc6ds.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚ÄúThe second solution involves the dependence of the structure of the components on changing requirements. </font><font style="vertical-align: inherit;">Indeed, as the application grows, the structure of component dependencies grows and changes. </font><font style="vertical-align: inherit;">Therefore, it must constantly be checked for cycles. </font><font style="vertical-align: inherit;">When cycles form, they need to be broken in one way or another. </font><font style="vertical-align: inherit;">Sometimes for this it is necessary to create new components, which makes the structure of dependencies grow. ‚Äù</font></font><a name="16"></a><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Top-down design, or rather its impracticability</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚ÄúComponent structure cannot be designed from top to bottom. This conclusion is not immediately reached as soon as they begin to design the system, but this inevitably happens with the growth and change of the system. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considering a large block diagram, such as the structure of component dependencies, we believe that the components must somehow represent the functions of the system. But in reality, this is not an indispensable attribute of component dependency diagrams.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In fact, the dependency diagrams of the components weakly reflect the functions of the application. To a greater extent, they are a reflection of the convenience of assembly and maintenance of the application. This is the main reason why they are not designed at the beginning of project development. During this period, there is no software that needs to be collected and maintained, so there is no need to draw up a build and maintenance map. But with the advent of an increasing number of modules in the early stages of implementation and design, the need to manage dependencies increases ... In addition, there is a desire to limit the impact of changes as much as possible, so we begin to pay attention to the principles of single responsibility (SRP) and coordinated change (CCP) and combine the classes, which will probably change together.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One of the main tasks of such a dependency structure is isolation of variability. We do not need components that often change for the smallest reasons and affect other components that would otherwise be completely stable. For example, cosmetic changes to the GUI should not affect business rules. Adding and modifying reports should not affect high-level policies. Consequently, a component dependency graph is created and created by architects to protect stable and valuable components from the influence of volatile components.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As the application develops, we begin to worry about creating reusable items. At this stage, the principle of shared reuse (CRP) begins to influence the composition of the components. Finally, with the advent of loops, we begin to apply the principle of dependency acyclicity (ADP), as a result, the dependency graph of components begins to change and grow. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An attempt to design the dependency structure of components earlier than any classes is likely to fail. At this stage, we know almost nothing about the reconciliation of changes, we don‚Äôt imagine which elements can be used repeatedly, and we will almost certainly create components that form cyclic dependencies. Therefore, the structure of component dependencies should grow and develop along with the logical design of the system ‚Äù</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hey, are you still here? </font><font style="vertical-align: inherit;">Man, this is important, you need to say hello to this at least in order to enter the meaning of the next part, there will be a raw tutorial on using tulza.</font></font><a name="17"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SDP: </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stable Dependencies Principle - the principle of stable dependencies. </font></font></i> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dependencies should be directed towards stability! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚ÄúWhat is meant by‚Äú sustainability ‚Äù? </font><font style="vertical-align: inherit;">Imagine a coin standing on an edge. </font><font style="vertical-align: inherit;">Is her position stable? </font><font style="vertical-align: inherit;">Most likely you will answer ‚Äúno‚Äù. </font><font style="vertical-align: inherit;">However, if you protect it from vibration and wind blows, it can remain in this position for an arbitrarily long time. </font><font style="vertical-align: inherit;">That is, sustainability is not directly related to the frequency of changes. </font><font style="vertical-align: inherit;">The coin does not change, but hardly anyone will say that, standing on the edge, it is in a stable position.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The explanatory dictionary says that sustainability is ‚Äúthe ability to maintain one‚Äôs condition under external influences‚Äù. Sustainability is related to the amount of work that needs to be done to change state. On the one hand, a coin standing on an edge is in an unstable state because it takes a tiny amount of effort to knock it over. On the other hand, the table is in a very stable condition, because it requires much more substantial effort to tip it.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What does all this have to do with software? </font><font style="vertical-align: inherit;">There are many factors that complicate a component‚Äôs change, such as its size, complexity, and clarity. </font><font style="vertical-align: inherit;">But we will leave aside all these factors and focus on something else. </font><font style="vertical-align: inherit;">There is one surefire way to make a software component difficult to change by creating many other components that depend on it. </font><font style="vertical-align: inherit;">A component with many incoming dependencies is very stable, because reconciling changes with all the dependent components requires considerable effort. "</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rp/pr/x8/rpprx8mwmw7dhsnchmfpiybhy_q.png" alt="image"><br>
<br>
<img src="https://habrastorage.org/webt/sk/1b/gz/sk1bgzciqhgtwbbf32tnhhp6nig.png" alt="image"><a name="18"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to evaluate the stability of the component? </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The author suggests calculating the number of its incoming and outgoing dependencies and on their basis calculate the measure of its stability.</font></font><br>
<br>
<ul>
<li><b>Fan-in ( ):</b>   .        ,      .</li>
<li><b>Fan-out ( ):</b>   .        ,      .</li>
<li><b>I:</b> : <i><b>I = Fan-out √∑ (Fan-in + Fan-out)</b></i>.       [0, 1]. I = 0    , I = 1 ‚Äì  .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, this principle says that the metric of the I component should be more than the metrics of the I components that depend on it. That is, the metrics I should decrease in the direction of dependence. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is important to note that if all components of the system are as stable as possible, such a system will not be possible to change. Therefore, not all components must be stable. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Man, don‚Äôt fall asleep, I'm near. Just a bit left!</font></font><a name="19"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SAP: </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stable Abstractions Principle - the principle of stability of abstractions.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The stability of a component is proportional to its abstractness. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚ÄúSome parts of software systems should change very rarely. These pieces represent high-level architectural and other important decisions. No one wants such decisions to be volatile. Therefore, software encapsulating high-level rules must reside in stable components (I = 0). Volatile (I = 1) should contain only mutable code - a code that could be easily and quickly changed.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But if you place high-level rules in stable components, this will complicate the change in the source code that implements them. This can make the whole architecture inflexible. How to make a component with maximum stability (I = 0) so flexible that it remains stable during changes? The answer lies in the principle of openness / closure (OCP). This principle says that it is possible and necessary to create classes that are flexible enough so that they can be inherited (extended) without change. Which classes comply with this principle? Abstract.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SAP (the principle of the stability of abstractions) establishes a connection between stability and abstractness. On the one hand, he says that a stable component must also be abstract so that its stability does not impede expansion, and on the other hand, he says that an unstable component must be concrete, because the instability makes it easy to change its code. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
That is, a stable component should consist of interfaces and abstract classes so that it can be easily extended. The resilient components available for expansion are flexible enough to not overly restrict the architecture.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The principles of stability of abstractions (SAP) and stable dependencies (SDP) together correspond to the principle of dependency inversion (DIP) for components. This is true because the SDP principle requires that dependencies be directed towards sustainability, and the SAP principle states that sustainability implies abstractness. That is, dependencies should be directed towards abstractness. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, the DIP principle is formulated for classes, and in the case of classes there are no midtones. The class is either abstract or not. The principles of SDP and SAP apply to components and allow a situation where a component is partially abstract or partially stable. ‚Äù</font></font><a name="20"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to measure the abstractness of a component? </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here, too, everything is very simple. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The value of the measure of abstract component is determined by the ratio of the number of its interfaces and abstract classes to the total number of classes.</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nc: the</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> number of classes in the component.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Na: the</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> number of abstract classes and interfaces in the component.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> abstract. </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A = Na √∑ Nc</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The value of the metric A varies in the range from 0 to 1. 0 means the complete absence of abstract elements in the component, and 1 means that the component contains nothing but abstract classes and interfaces. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dependence between I and A</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
If you plot on the graph (Y - abstraction, X - instability) ‚Äúgood‚Äù components of both types: abstract stable and concrete unstable, we get this: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/o9/ti/uu/o9tiuuubqfxevrke6rmxoi8xvt4.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But, because the components have different degrees of abstractness and stability, far from all fall into these 2 points (0, 1) or (1, 0), and since it is impossible to require that all components be in them, we must assume that on the graph A / I there are some points that determine the optimal positions for the components.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This set can be derived by defining areas where the components should not be located ‚Äî in other words, defining exclusion zones.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1d/q0/6u/1dq06uddhrif323kzrg2ymdlgwa.png" alt="image"><a name="21"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pain Zone</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Consider the components located near the point (0, 0). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
They are very stable and specific. Such components are undesirable since are too tough. They cannot be expanded, because they are not abstract and it is very difficult to change because of their great stability. The more we change the component that enters the pain zone, the more pain it brings. This is due to the complexity of its change. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Correctly designed components usually should not be near the point (0, 0). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, in reality, there are software entities that fall into this zone. For example, the database schema, it is as specific as possible and many dependencies stretch towards it. This is one of the reasons why database schema changes are usually associated with great pain.</font></font><a name="22"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Useless Zone</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Consider the components located near the point (1, 1). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Such components are also undesirable, because they are as abstract as possible and have no input dependencies. They are simply useless. Often these are abstract classes that have never been implemented.</font></font><a name="23"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to avoid getting into exclusion zones?</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Place components close to or on the main sequence. Such components are not ‚Äútoo abstract‚Äù for their stability and not ‚Äútoo unstable‚Äù for their abstractness. They are not useless and do not cause much pain. Other components depend on them to the extent of their abstractness, and they themselves depend on others to the extent of specificity. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The most desirable positions for the components are the endpoints of the main sequence. However, in large systems there will always be several components that are not sufficiently abstract and not stable enough. Such components have excellent characteristics when located on or near the main sequence.</font></font><a name="24"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The distance to the main sequence</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Since it is desirable that the component is located on or near the main sequence, it is possible to determine a metric expressing the distance of the component from the ideal.</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> distance. </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D = | A + I ‚Äì 1 | </font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">This metric takes values ‚Äã‚Äãfrom the range [0, 1]. </font><font style="vertical-align: inherit;">A value of 0 indicates that the component is directly on the main sequence. </font><font style="vertical-align: inherit;">A value of 1 indicates that the component is located at the maximum distance from the main sequence.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By adopting this metric, you can explore the entire design in proximity to the main sequence. </font><font style="vertical-align: inherit;">The metric D can be calculated for any component. </font><font style="vertical-align: inherit;">Any component with a metric value D far from zero requires revision and restructuring.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gw/3n/a0/gw3na07fmc40y8-r72hoqro8wrq.png" alt="image"><a name="25"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion of the author (Robert Martin)</font></font></h3> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚ÄúThe dependency management metrics described in this chapter help you quantify the consistency of the dependency structure and design abstraction with what I call a‚Äú good ‚Äùdesign. Experience shows that there are good dependencies, there are bad ones. This assessment reflects this experience. However, metrics are not the ultimate truth; these are just measurements based on an arbitrary standard. These metrics are imperfect - at best, but I hope you find them useful. ‚Äù</font></font><a name="26"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Man, I'm glad if you're still with me. </font><font style="vertical-align: inherit;">That's all with the first part. </font><font style="vertical-align: inherit;">Although there are still a lot of topics, and the author‚Äôs detailed thoughts remained unaffected. </font><font style="vertical-align: inherit;">Still, the main purpose of my article is not to retell the book, otherwise you would definitely be more pleased to read the original. </font><font style="vertical-align: inherit;">I, hike, and so already specifically went too far with the amount of content, but I will be bastard, I tried not to inflate as I could. </font><font style="vertical-align: inherit;">Round!</font></font><a name="27"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Second day. </font><font style="vertical-align: inherit;">Umm, i.e. </font><font style="vertical-align: inherit;">Part 2</font></font></h2><a name="28"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introduction</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What have I been rubbing about there for so long? ‚ÄúAh, yes ... We are like architects, or we really want to be them, right?‚Äù </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What do we have? - Some kind of miserable projection, or maybe a monstrous system, PROJECT, his mother, well, or finally there isn‚Äôt any nifig yet, but we just rub our hands, look at the calendar and figure out how well we will have to talk. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are no us, I work alone! Or maybe we, with a sidekick, in the garage, were going to fill in a new Apple, why not? Well, either we are a army and we are all part of a hefty company, we are working hard, like the blacks of the poor at home (that is, African-Americans, of course, you understand), or maybe we‚Äôre kicking quietly so that we don‚Äôt get fired. For a fat salary with a bonus, cookies and a view from Moscow city or for bare enthusiasm, for an idea and a stake in a startup that naturally gets a hell when it takes off.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In fact, it doesn‚Äôt matter. </font><font style="vertical-align: inherit;">What‚Äôs important is this: all of us, in the end, simply want our brainchild not to bend prematurely, well, at least before our departure, and there are all chances for that. </font><font style="vertical-align: inherit;">Yes, yes ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And what to do now, you ask? </font><font style="vertical-align: inherit;">So, if you don‚Äôt have a big brother in the office, then bro can‚Äôt do without a third eye.</font></font><a name="29"></a><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Summary of the first part</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the last part of the article, we talked a </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bit</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> about metrics that enable architects </font><s><font style="vertical-align: inherit;">to measure their</font></s><font style="vertical-align: inherit;"> numbers in figures to reflect the degree of quality of the architecture of their system. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - abstraction of component </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - instability of component </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - distance to the main sequence on the graph </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A / I </font></font></b><font style="vertical-align: inherit;"><s><font style="vertical-align: inherit;">Erogenous zones of</font></s><font style="vertical-align: inherit;"> the </font><i><font style="vertical-align: inherit;">pain</font></i><font style="vertical-align: inherit;"> and </font><i><font style="vertical-align: inherit;">futility</font></i><font style="vertical-align: inherit;"> zones were </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
revealed </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">
We came to the conclusion that, ideally, </font><b><font style="vertical-align: inherit;">A</font></b><font style="vertical-align: inherit;"> should increase and decrease in proportion to a decrease and, accordingly, an increase in </font><b><font style="vertical-align: inherit;">I</font></b></font><s><font style="vertical-align: inherit;"></font></s><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Well-designed components should be on or at least close to the main sequence, i.e. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> should be as close to zero as possible, and the dependencies between the components should be acyclic and directed towards stability. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I also hope everyone understands that some components may know about many others, while others should not know anything. Just like in the slave states before the arrival of the good uncle Abraham, only on the contrary, there Negroes (in the sense of African-Americans) were not allowed nichrome (in terms of knowledge, and not only), in our case the most important components of the system should have a minimum of knowledge, they should be self-sufficient and abstract from different details. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So what about the third eye? </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PHP Clean Architecture</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- a tool that appeared as a result of reading a book, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">thanks to Uncle Bob</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Robert Martin) for valuable thoughts, and crazy desire to visualize the whole thing, for the convenience of analysis, and automate, for the possibility of including various checks in CI / CD (similar to PHPStan, Phan and others, only to identify precisely architectural problems).</font></font><a name="30"></a><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tool and test project. </font><font style="vertical-align: inherit;">Introduction to the topic</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fuf, everything seems to be like a theory ... Now you can even </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get your hands dirty</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for details. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And so to me now do not have about abstract horses in a vacuum to rub, and you have the end of the reading was less reason to call me mudiloy, because of which you </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fucked</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> spent so much time, I had </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prosrat</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> spend a little of his, and to prepare a demo project, which, sobstna, we are now going to do hara-kiri. For the ‚Äúsuper gifted‚Äù dudes who will undoubtedly be and want to hang out in comments, regarding its details, I emphasize - </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is </font><u><font style="vertical-align: inherit;">a DEMO project</font></u><font style="vertical-align: inherit;"> .</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I chopped it up in about half a day, roughly speaking, on my girlfriend‚Äôs knee. After all, I can‚Äôt take and drain to the general public the details of the combat projects that I have to work with ... The guys in the wreck will not understand, they will show me, but do I need it? Well, if you are a simple lad, not one of the ‚Äúparticularly outstanding ones,‚Äù then I‚Äôm a lousy for such a long introduction, I just had to take the risks and reduce the potential threat of breeding in the comments of the bazaars about nothing. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, the project itself lies here </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/Chetkov/php-clean-architecture-example-project</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the future, he could become a full-fledged online store. I‚Äôm certainly a fierce perfectionist, but you need to be a </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">complete nonsense</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sun-eater and long-liver, besides suffering from insomnia, in order to spend so much time on the ‚Äúexperimental rabbit‚Äù and fashion candy from it. As you understand, this project will </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">never</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> be brought to its logical conclusion </font><font style="vertical-align: inherit;">, however, like all the others, even combat projects. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Although it‚Äôs not so bad. At the moment it has: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">user, product and order</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , as well as scenarios: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">user registration, password change, adding a product and booking an order</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The project is more or less working, you can clone it yourself and run scripts from the sandbox folder, although in fact, I could not even do this, because for the analysis of architecture operability from the project is not required.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the future, I will throw up links to specific commits in order to immediately fix the technical points described in the article. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Initial state</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
. I suppose that you already managed to get acquainted with the structure. </font><font style="vertical-align: inherit;">So we can move on.</font></font><a name="31"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We </font><font style="vertical-align: inherit;">include </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PHP Clean Architecture</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<pre><code class="bash hljs">composer require v.chetkov/php-clean-architecture:0.0.3</code></pre><a name="32"></a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We create and configure the configuration file</font></font></a><a name="33"></a><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visualization for analysis</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We execute in the console (in the project root):</font></font><br>
<br>
<pre><code class="bash hljs">vendor/bin/phpca-build-reports</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><pre><code class="bash hljs">vendor/bin/phpca-build-reports /path/to/phpca-config.php</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And in response we get:</font></font><br>
<br>
<pre><code class="bash hljs">Report: /path/to/reports-dir/index.html</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The report consists of 3 screens:</font></font><a name="34"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. General system information</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/pu/fx/qr/pufxqrtzh84_faltmuyavha60na.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
This screen displays:</font></font><a name="35"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The same </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A / I</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> graph showing the dispersion of the components:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/om/ef/ba/omefbattpqlmig8toha6fkaiebo.png" alt="image"><a name="36"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Graph showing the remoteness of components from the main sequence:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1o/wc/c4/1owcc49v0-3xpt2ty6tlake7iu4.png" alt="image"><a name="37"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And a graph showing the relationships between the components: The </font></font><br>
<br>
<img src="https://habrastorage.org/webt/i-/g5/gu/i-g5guwpecojz4hflw0v52pfsau.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
arrows indicate the direction of the dependencies, and the numbers on them indicate the strength of the connection. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Because modern IDEs provide an easy way to refactor (they themselves find and fix all the areas where the method or class is explicitly called, for example, when renaming or transferring to another namespace), I took the number of elements of the dependency module used by the dependent module for communication strength. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example: the elements of the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">services</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> module </font><font style="vertical-align: inherit;">know about 12 elements of the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">model</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> module </font><font style="vertical-align: inherit;">, and the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">infrastructure</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> elements </font><font style="vertical-align: inherit;">know about 1 element of </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">services</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By the way, what is </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* undefined *</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? </font><font style="vertical-align: inherit;">Bro, the expected question. </font><font style="vertical-align: inherit;">This is a module created automatically for all elements that, during the system analysis, could not be attributed to any of the known ones (i.e. those listed in the configuration file). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If, however, you correct the config in this way: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cm/2i/e7/cm2ie7i06bwj3ygr6qur5hwsrqq.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then in the process of analyzing the system, packets connected via composer will also be taken into account (they themselves will not be scanned, but the picture will become much more complete). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By the way, in </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vendor_path</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> you need to specify the path to the vendor directory, and in </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">excluded</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> paths to the directories of packages that we want to exclude (for example, if we describe a package in the main config of modules for scanning). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After enabling </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vendor_based_modules</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> the graph has changed, although we did not change the config of the modules themselves</font></font><br>
<br>
<img src="https://habrastorage.org/webt/-k/ll/vn/-kllvnfj6fdxmxzofi3wnya1gkg.png" alt="image"><a name="38"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Detailed information about the component</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/t2/ha/tp/t2hatp-gycfkeb2ytwctj4gdgvs.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Here we also see:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Graph of interconnections</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , but not of the entire system, but only of the components involved</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A / I chart</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> showing only the current component</font></font><a name="39"></a></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Key</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> module </font><b><font style="vertical-align: inherit;">features</font></b></font><br>
<br>
<img src="https://habrastorage.org/webt/op/ma/rd/opmardxolzmxvfkk-qeefl43tba.png" alt="image"></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
and</font></font><a name="40"></a><br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Outbound dependency graph</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> showing the number and list of files in the current module, depending on the files of other modules.</font></font></li>
<li><img src="https://habrastorage.org/webt/tn/95/el/tn95elws4c7m-7umkpep_wgfcvo.png" alt="image"></li>
</ul><a name="41"></a><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">graph of incoming dependencies</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , showing the number and list of files in other modules, depending on the current module.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kc/f_/hf/kcf_hfe1kqsm1emfwvzfqrpwfp4.png" alt="image"></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The last 2 graphs, in my opinion, are especially interesting, because </font><font style="vertical-align: inherit;">it is easy to find unwanted dependencies on them, but more on that later.</font></font><a name="42"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Detailed information about the component element</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/hl/mn/am/hlmnamudgfqzimh7ec9qscm56pc.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Here you can see:</font></font><a name="43"></a><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Main characteristics of</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> the element, such as </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">type abstraction, instability, primitive,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and to </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">which component belongs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the access modifier</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚ÄúChe, a class access modifier in PHP?‚Äù </font><font style="vertical-align: inherit;">- you say, drilling a hole in the temple area with your finger, right? </font><font style="vertical-align: inherit;">Take your time, I know that there are no private classes in the heat, but it would be cool if they were? </font><font style="vertical-align: inherit;">In general, more about that later.</font></font><a name="44"></a><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dependency graph</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which reflects the interaction of the element under consideration with other elements of the system</font></font></li>
</ul><a name="45"></a><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tablets with outgoing and incoming dependencies</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/w4/ay/lf/w4aylfkiqu9jxs4ik8ils0asgpw.png" alt="image"></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
With the description of the screens finished, go to the configs to pick and poke how it can be configured.</font></font><a name="46"></a><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration options</font></font></h4><a name="47"></a><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Limiting the maximum allowable distance to the main sequence (for all components)</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
First, let's try to set all the components to the maximum allowable distance to the main sequence. It would be foolish to think that they all will lie on the main diagonal, because the world is not perfect, so let's be realistic. I do </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.3</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/ky/cg/l7/kycgl7xitjnerrvsaw-duklidfy.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Restart the report generation command and immediately see the violation on the main page. The </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">model</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> component </font><font style="vertical-align: inherit;">exceeds the allowed distance by </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.192</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/nq/1l/nk/nq1lnkttwkz2ukpybccin99sarg.png" alt="image"><a name="48"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Limiting the maximum allowed distance to the main sequence (to a specific component)</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
It's great, but let's assume that it is the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">model</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> component that </font><font style="vertical-align: inherit;">can violate this restriction. Different things happen ... After all, we often already have not ideal systems that we have to work with, support them and improve. Anyone understands that no one will be able to quickly reduce this distance, even probably with a god (I hope he will forgive me). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In my opinion, the main thing is to fix the current state, work towards improvements and control the situation so as not to aggravate. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Again, go to the config, and set </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">max_allowable_distance</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , only for a specific module. I fix on its current value </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.492</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/cz/nh/3y/cznh3ykeuoalp65gflqjxg0tlag.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ZBS, now everything is normal again. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-z/pq/2u/-zpq2um__xoxqtdyqy2sw81xa0m.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But if, with some ** ka Vasya, he smokes something again and gets worse - </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chop off his hands!</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> A CI / CD that includes running the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">phpca-check</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> command </font><font style="vertical-align: inherit;">(we'll talk about it later) scolds him, maybe even a foul language, and of course it will highlight errors.</font></font><a name="49"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Component Dependency Control</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
What else would be nice to have in our arsenal to deal with poor architecture? Of course, dependency control. Who can know about whom, or vice versa should not know. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What do you think, can the very central part of the system, let‚Äôs say </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">domain</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , so that it‚Äôs completely possible for DDDowski to know something about some </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">smelly</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> infrastructure? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Of course YES, for some it‚Äôs, directly, an attribute of success (well, I'm talking about those who render HTML mixed with business logic). But finally, like be, I should not ... I certainly xs, but all sorts of different clever guys in books say that this is not patsansky. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then let's stir up like this ... Everything is in the same place, in the config of restrictions for </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">model</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/t9/d-/vq/t9d-vqmz0wzxd9axkfmlise2e1y.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hmm ... So far, all the rules, because</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">model</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> about </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">infrastructure</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> really doesn‚Äôt know anything ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Well then let's have fun ... Stupidity is certainly rare, but I didn‚Äôt come up with anything better. Krch, at the time of creating the user we will ‚Äúsend‚Äù SMS, and at the time of creating the order ‚Äúsend‚Äù email (s). And to do this through specific implementations of notifiers that lie in the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">infrastructure</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/Chetkov/php-clean-architecture-example-project/commit/6bad365176b30999035967319a9c07fae69fabf9</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Now we look into the report ... As we can see, the graphs on different pages of the report highlight this connection as illegitimate. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Home. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/k1/ti/e_/k1tie_5t4puunp-vo9cemwfgcu8.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Component Report. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xw/r1/qv/xwr1qvfggdbhblauxmfekjbfnfs.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On the graphs of ‚Äúoutgoing dependencies‚Äù </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">model</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and ‚Äúinbound dependencies‚Äù</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">infrastructure</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , we immediately see elements that violate the introduced rule </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yx/lq/fm/yxlqfmhtpyx81pdmjjjggzered0.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the tables of ‚Äúoutgoing dependencies‚Äù of </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">model</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> elements </font><font style="vertical-align: inherit;">and ‚Äúinbound dependencies‚Äù of </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">infrastructure</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> elements </font><font style="vertical-align: inherit;">, similarly. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PHPCAEP \ Model \ User \ User </font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/_k/ka/du/_kkadurra4ab9onv9kazkypmr8s.png" alt="image"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PHPCAEP \ Infrastructure \ Notification \ Sms \ SmsNotifier</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/vw/ho/es/vwhoestwzf3m41hr5sbux7n5shs.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
As well as on the graph of element relationships. I think in the future to get rid of it altogether, because it is not very informative (especially for actively used classes, because of the length of the name of the nodes + their huge number) </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tn/10/wn/tn10wnmnrwjup2vvdfzzghfhwyw.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Similar actions can be done with the allowed_dependencies </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">config</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lh/8t/ki/lh8tkinfuyuzmfe-f4i2giq2p54.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The result will be completely opposite. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is possible to compose a config indicating for the module and </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forbidden</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allowed</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (if there is a desire, we will discuss in more detail in the comments). It </font><font style="vertical-align: inherit;">is not yet possible to </font><font style="vertical-align: inherit;">specify one component both in </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forbidden</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allowed</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ... There were thoughts to introduce a config to indicate priority, but so far I have not done this and am not sure what I will do. It all depends on your feedback. Maybe all this is wasted?</font></font><a name="50"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Public / Private Class in PHP</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Okay, we learned how to narrow and control the range of knowledge of components. Already not bad. What's next? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And then another problem. The enemy does not sleep, although in most cases this enemy, we ourselves are, or our sidekicks at the office. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It happens after all, you met a girl, talked, found out something about her, maybe even courted, but damn it, it doesn't work out for you. We are friends and all that ... She can kiss you when she meets you, she can listen and support you with a kind word, but she </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">doesn‚Äôt give you</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> anything to </font><s><font style="vertical-align: inherit;">kill</font></s><font style="vertical-align: inherit;"> . So what am I talking about ... Ah, here ... It's all about accessibility. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But in the code, constantly ... Connect a new package, not a day has passed, but it is already being used, but straight </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to all places</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">from all sides. Half of your code base is already tied to its various classes. In short, he has a very intimate connection with the rest. Maybe in some situations this is the norm, but not in all, right? </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You: </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúEverything is good, it is shy. How to solve the problem? ‚Äù </font></font></i><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Me: </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúLeave only classes allowed for interaction, and restrict access to the rest.‚Äù </font></font></i><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You: </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúBut in PHP there are no access modifiers for classes.‚Äù </font></font></i><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Me: </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúI agree, but there is a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PHP Clean Architecture</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .‚Äù</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
An example will now be again from drug addicts, but what to do. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In real projects, of course, the cases are full of cases, but they can bring a bottle for draining the information and ask them to sit down. That's why you have to compose.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's assume that in the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">model</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , for some reason, there are only 2 classes that others are allowed to know about ... User and Order, all the rest should be hidden. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qy/e9/4x/qye94xgk0qilcsun6t2b7xcyjfa.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What do we have now? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Count on the main. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5p/jh/89/5pjh89hoarwanv9cg5s4bnxftqa.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can immediately see which components need to be reviewed. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We climb to see what is wrong with </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">infrastructure</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6e/os/a7/6eosa7uzvggaixprcwujm6zo7iw.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On the graph of ‚Äúoutgoing dependencies‚Äù we see elements that violate the rule: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ce/cv/kh/cecvkhbffs9w0zoedu5h19-bqde.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On the element information page, similarly. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7b/08/-x/7b08-x0k64pug5ab97xzjeweggc.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will get exactly the opposite result if we specify </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">private_elements</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the config </font><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ea/bi/z7/eabiz7uuzgdvoer2hlcgrbquya4.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, we forbid everyone to know about Fio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now on the main </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1w/be/xw/1wbexwzh6qyeud-klfzf6ixd4uu.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
page </font><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">On the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">services</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> component information page </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rq/k4/qt/rqk4qtsjvdt320d0nhm9mpgmv9c.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And on the element information page </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PHPCAEP \ Model \ User \ Fio</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yp/z1/fb/ypz1fbiu9tvqqawxcyxe7lj1rbk.png" alt="image"><a name="51"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Monitoring violations of the principles of ADP and SDP</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Still, perhaps, we need to highlight the possibility of including checks:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for violations of the ADP principle, i.e. </font><font style="vertical-align: inherit;">for the existence of cyclic dependencies in the graph ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">check_acyclic_dependencies_principle</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and for violations of the SDP principle, i.e. </font><font style="vertical-align: inherit;">for dependencies directed from more stable modules to less stable ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">check_stable_dependencies_principle</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/wv/q-/4e/wvq-4e6g7ecklhsoiwhveftlvgm.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But this only works in </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">phpca-check</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> so far </font><font style="vertical-align: inherit;">and is not displayed in the report. </font><font style="vertical-align: inherit;">In the future, I think I will correct it.</font></font><a name="52"></a><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Automatic control in CI / CD</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All this time I talked about the first part - visualization. </font><font style="vertical-align: inherit;">And the analysis that can be carried out on its basis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The time has </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">come</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to make our </font><s><font style="vertical-align: inherit;">friends govnokodera</font></s><font style="vertical-align: inherit;"> honorable colleagues suffer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We launch in the console (in the project root):</font></font><br>
<br>
<pre><code class="bash hljs">vendor/bin/phpca-check</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
or </font></font><br>
<br>
<pre><code class="bash hljs">vendor/bin/phpca-check /path/to/phpca-config.php</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is assumed that running this command will be added to the CI / CD process of your project. </font><font style="vertical-align: inherit;">In this case, the error will block further assembly. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The script terminates with an error and throws something like this: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gw/fk/yi/gwfkyinqrff76x6_ywh99mkzja0.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I give the tooth, the list will be much longer in a real project.</font></font><a name="53"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debriefing</font></font></b><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Violation of the principle of acyclicity of dependencies (ADP)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Similarly, but the cycle is a little shorter</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">model</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> elements </font><font style="vertical-align: inherit;">(listed) depend on </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">infrastructure</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which is not allowed by the config</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ADP violation again</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Another loop and ADP violation</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SDP violation because </font><font style="vertical-align: inherit;">a more sustainable </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">model</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> depends on a less sustainable </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">infrastructure</font></font></b></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Again cyclic dependence, be it wrong</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">services</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> element </font><font style="vertical-align: inherit;">(listed) depends on non-public Fio</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Approximately this result we have thanks to our efforts </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and diligent govnokoding</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now let's turn everything in the ass. </font><font style="vertical-align: inherit;">Well, i.e. </font><font style="vertical-align: inherit;">not quite everything, I leave the configs naturally. </font><font style="vertical-align: inherit;">I rule only the code. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For starters, it makes sense to fix files that violate the rules for following dependencies. </font><font style="vertical-align: inherit;">In this project, most of the cycles will probably go away by itself, but in real ones, definitely have to tinker longer (although this depends on the degree of neglect of the system and the settings of the config).</font></font><a name="54"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Troubleshooting</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
I removed a previously invented addiction. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/Chetkov/php-clean-architecture-example-project/commit/f6bbbff1313bb4a22dfb6061f347ef007ba3b422f</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Restart </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vendor / bin / phpca-check</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/h8/4f/ww/h84fwwfjzezdnpbb4pfo9bafbso.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Well, there‚Äôs only a config to edit, because </font><font style="vertical-align: inherit;">an example was really invented by a drug addict. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dd/ak/t5/ddakt51werp2dhetkwxra8ejyn0.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Again </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vendor / bin / phpca-check</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/pb/k7/tw/pbk7twux3ah-6novxv9adktsw4m.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
And the CI / CD went on! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
That's all.</font></font><a name="55"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Afterword</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Catch a fifth if you read it to the end, if not, sniff your foot on the road (anyway, you didn‚Äôt see this). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But seriously, thank you for your time, it doesn‚Äôt matter if you merged in the middle or read it, delved into each line and analyzed every screen or flipped through both parts diagonally. </font><font style="vertical-align: inherit;">Thanks anyway. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I apologize again if something was wrong. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perhaps, my manner of presentation might seem to someone too imposing or disrespectful, I just wanted to slightly dilute the article and in no way did I want to offend anyone. </font><font style="vertical-align: inherit;">I think without this, it would have turned out to be too dry and difficult to read. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I‚Äôm really interested to know your opinion and if you have any thoughts, ideas, suggestions or objections, let's discuss in comments.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Clean code and flexible architecture for you!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en504572/index.html">Speak like Winston Churchill: who needs to sell their soul to communicate in English SO</a></li>
<li><a href="../en504576/index.html">How home audio developed - from song nights to the first mechanical players</a></li>
<li><a href="../en504578/index.html">How Americans Become Millionaires: FIRE Principles</a></li>
<li><a href="../en504582/index.html">HackTheBox. Walkthrough Resolute. Password spraying. From DnsAdmin to SYSTEM</a></li>
<li><a href="../en504586/index.html">ES2020 innovations that I really like</a></li>
<li><a href="../en504592/index.html">PuppetConf 2016. Kubernetes for system administrators. Part 3</a></li>
<li><a href="../en504598/index.html">Database of primes up to one hundred billion on the knee</a></li>
<li><a href="../en504600/index.html">What awaits the airline after the crisis: Warren Buffett's opinion</a></li>
<li><a href="../en504602/index.html">Telemetr√≠a ‚Üí voltage free metrics</a></li>
<li><a href="../en504604/index.html">What is happening in the video services market today?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>