<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👲🏾 🎹 😄 機械学習：どこから始めればよいか、どのように最初のモデルを構築するか 📗 🚢 📪</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="機械学習の最初のタスクとして、たとえば住宅のコストの予測など、明確で単純なものを取り上げます。準備ができたデータセットは、kaggleのWebサイトにあります。トレーニングの最初のステップでは、多数の変数を含むデータセットを使用しないでください。たとえば、「住宅価格：高度な回帰手法」は80の変数と高...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>機械学習：どこから始めればよいか、どのように最初のモデルを構築するか</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/505516/"><img src="https://habrastorage.org/webt/cn/mg/fr/cnmgfrvs-ej5ldlqz9cmmdjdcrk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
機械学習の最初のタスクとして、たとえば住宅のコストの予測など、明確で単純なものを取り上げます。準備ができたデータセットは、kaggleのWebサイトにあります。トレーニングの最初のステップでは、多数の変数を含むデータセットを使用しないでください。たとえば、「住宅価格：高度な回帰手法」は80の変数と高度な回帰で構成されます。21のパラメーターを持つ「アメリカのキング郡の住宅販売」で停止します。データをダウンロードし、提供された説明を分析します。利用可能日、価格、寝室数、浴室数、総面積と居住面積、床数、眺望評価、海の景色、概況の評価、グレード（建設と設計の評価）、地上レベルの上下、建設年、最後の年修理、市外局番、座標（経度と緯度）、15人の隣人の家の面積に関するデータ。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、タスクを選択し、解決する準備が整いました。ソリューションには、データ分析とモデル構築の2つの段階が含まれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1.データを操作します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
余談ですが、データ分析の重要性に個別に注意してみましょう。現在、多かれ少なかれ人気のあるすべてのアルゴリズムはすでにライブラリの形式で記述されており、モデルの直接構築は数行のコードに削減されます。たとえば、pythonのsklearnからのk最近傍点：</font></font><a name="habracut"></a><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn .neighbors <span class="hljs-keyword">import</span> KNeighborsClassifier<font></font>
clf_KNN = KNeighborsClassifier()       <span class="hljs-comment"># </span>
clf_KNN.fit(X_train, Y_train)          <span class="hljs-comment"># </span>
Y_KNN = clf_KNN.predict(X_test)        <span class="hljs-comment">#    </span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果を取得するコードは4行だけです。それで、難しさは何ですか？難しいのは、まさにX_train-モデルの入力に供給されるデータを取得することです。モデリングにおけるよく知られた原則「ガベージイン」=「ガベージイン」（英語のガベージイン-ガベージアウト（GIGO））は、100％以上機能し、機械学習の問題に対する得られたソリューションの品質は、データの操作に大きく依存します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして今、戦いに！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データ分析にはパンダを使用し、「目で」理解および評価するには、海からの単純なグラフを使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ライブラリをインポートし、データを読み取り、データ配列からいくつかのレコードを導出し、それらのデータ型と省略を調べます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードとアウト</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns<font></font>
df = pd.read_csv(<span class="hljs-string">'…/train.csv'</span>)<font></font>
df.head(<span class="hljs-number">5</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/1q/cy/og/1qcyogx0fmdgtibrhx1l2b5mdty.png"><br>
<br>
<pre><code class="python hljs">df.info()</code></pre><br>
<pre><code class="plaintext hljs">RangeIndex: 21613 entries, 0 to 21612<font></font>
Data columns (total 21 columns):<font></font>
id 21613 non-null int64<font></font>
date 21613 non-null object<font></font>
price 21613 non-null float64<font></font>
bedrooms 21613 non-null int64<font></font>
bathrooms 21613 non-null float64<font></font>
sqft_living 21613 non-null int64<font></font>
sqft_lot 21613 non-null int64<font></font>
floors 21613 non-null float64<font></font>
waterfront 21613 non-null int64<font></font>
view 21613 non-null int64<font></font>
condition 21613 non-null int64<font></font>
grade 21613 non-null int64<font></font>
sqft_above 21613 non-null int64<font></font>
sqft_basement 21613 non-null int64<font></font>
yr_built 21613 non-null int64<font></font>
yr_renovated 21613 non-null int64<font></font>
zipcode 21613 non-null int64<font></font>
lat 21613 non-null float64<font></font>
long 21613 non-null float64<font></font>
sqft_living15 21613 non-null int64<font></font>
sqft_lot15 21613 non-null int64<font></font>
dtypes: float64(5), int64(15), object(1)<font></font>
memory usage: 3.5+ MB</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データ配列は、データにギャップのない21613レコードで構成され、テキストフィールドの日付が1つだけ含まれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各標識をより詳細に処理し、最も単純なものから始めます-機械学習と地理的情報の正しい変換だけを知っているので、ID（有用な情報を含まない）、郵便番号（家のあるエリアのコード）、および座標（緯度と経度）を捨てますデータは初心者の専門家にはあまりにも具体的です。</font></font><br>
<br>
<pre><code class="python hljs">df=df.drop([<span class="hljs-string">'id'</span>,<span class="hljs-string">'zipcode'</span>,<span class="hljs-string">'lat'</span>,<span class="hljs-string">'long'</span>], axis=<span class="hljs-number">1</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
発表の日付を見てください。日付形式はYYYYMMDDTT000000に設定されており、一般的にはデータセットから削除することもできますが、建設年（yr_built）と最終修理年（yr_renovated）のフィールドがあり、年形式（YYYY）で指定されているため、あまりわかりません。アナウンスの日付を使用すると、減算によって年を年齢に変換できます（アナウンスの年-建設の年/修理の年）。一部の住宅では修理年が0であることに注意してください。これは建物の修理がないことを意味し、修理年のゼロを建設年に置き換えます。最初に、修理年が建設年よりも短い場合にデータに誤ったレコードが含まれていないことを確認します。</font></font><br>
<br>
<pre><code class="python hljs">df[(df[<span class="hljs-string">'yr_renovated'</span>]&lt;df[<span class="hljs-string">'yr_built'</span>])&amp;df[<span class="hljs-string">'yr_renovated'</span>]!=<span class="hljs-number">0</span>]</code></pre><br>
<img src="https://habrastorage.org/webt/l7/wo/ii/l7woii1rk3buxzexbab2i4uokmq.png"><br>
<br>
<pre><code class="python hljs">df.loc[df[<span class="hljs-string">'yr_renovated'</span>]==<span class="hljs-number">0</span>, [<span class="hljs-string">'yr_renovated'</span>]]=df[<span class="hljs-string">'yr_built'</span>]<font></font>
df[<span class="hljs-string">'yr_built'</span>]=df[<span class="hljs-string">'date'</span>].str[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>].astype(int)-df[<span class="hljs-string">'yr_built'</span>]<font></font>
df[<span class="hljs-string">'yr_renovated'</span>]=df[<span class="hljs-string">'date'</span>].str[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>].astype(int)-df[<span class="hljs-string">'yr_renovated'</span>]<font></font>
df=df.drop(<span class="hljs-string">'date'</span>, axis=<span class="hljs-number">1</span>)<font></font>
df.head(<span class="hljs-number">5</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/4z/za/uw/4zzauwyidq18e0lq_8x5-up5e88.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のパラメーターで価格を分析し、「ボックスプロット」を使用します。口ひげボックスは、1次元の確率分布、より簡単にはデータの集中度を示すシンプルで便利なグラフです。中央値（中央の線）、上と下の四分位数（ボックスの側面）、統計的に有意なサンプルのエッジ（「口ひげ」）と外れ値（「口ひげ」の後ろのポイント）を描画します。正規分布図（右）からもわかりやすいです。グラフを使用すると、ほとんどのデータが配置されている場所（50％がボックス内にある）、それらの対称性（ボックスの片側への中央オフセットおよび/または「口ひげ」の長さ）、および分散の程度-分散（ボックスサイズ、口ひげサイズとポイント数-）をすばやく評価できます。排出量）。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bi/bh/uw/bibhuwyeeexpszcl7sahfpdo8le.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
配列全体でこの特性のみの分布を構築することは可能ですが、2つの軸を使用するほうが有益です。たとえば、価格と寝室の数。これにより、標識間の接続の存在も示されます。</font></font><br>
<br>
<pre><code class="python hljs">sns.boxplot(y=<span class="hljs-string">'price'</span>, data=df)			<span class="hljs-comment"># price</span>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'bedrooms'</span>, data=df)	<span class="hljs-comment">#price &amp; bedrooms</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
値段と寝室数：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/za/oh/ta/zaohtajsfsedoz8lagkzjto-oa0.png"><br>
<br>
<img src="https://habrastorage.org/webt/fn/em/4g/fnem4gwwbubwzkrhi25i4ly3j4k.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
グラフは、価格と寝室の極端な値の存在をすぐに示しています（33の寝室がある家を想像してください！J）。価格ターゲットにそのような値（または外れ値とも呼ばれます）が存在すると、アルゴリズムが最小化しようとする大きなエラーが発生するため、モデルの再トレーニングにつながることがよくあります。グラフは、過半数（計算された場合-93.22％）が0-1mlnの範囲にあり、2mlnを超えている-198個の値（0.92％）しかないことを示しています。データセットの1％をほとんど苦痛なく取り除くことができるため、217レコードの単純な表示を呼び出し、以前に価格でソートしたので、1 965 000の希望の価格マークが表示され、この価格より高いものはすべて削除されます。</font></font><br>
<br>
<pre><code class="python hljs">df.sort_values (by=<span class="hljs-string">'price'</span>, ascending=<span class="hljs-literal">False</span>).head(<span class="hljs-number">217</span>) <font></font>
df=df[df[<span class="hljs-string">'price'</span>]&lt;=<span class="hljs-number">1965000</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
寝室の看板を少し考えてみましょう。</font><font style="vertical-align: inherit;">寝室が0の13の家と、33の寝室のある家の奇妙な記録が表示されます。</font><font style="vertical-align: inherit;">私たちは価格と同じようにして、ベッドルーム（およびバスルーム）からゼロを削除します。</font></font><br>
<br>
<pre><code class="python hljs">df=df[(df[<span class="hljs-string">'bedrooms'</span>]!=<span class="hljs-number">0</span>)&amp;(df[<span class="hljs-string">'bathrooms'</span>]!=<span class="hljs-number">0</span>)]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
33ベッドルームの家について-価格を考慮して、これはタイプミスであり、ベッドルームは実際には3であると想定できます。この家のリビングエリア（1620）と3ベッドルームハウスの平均リビングエリア（1798.2）を比較してみましょう。したがって、この値を3に変更して、前の箱ひげ図をもう一度作成します。</font></font><br>
<br>
<pre><code class="python hljs">df.loc[df[<span class="hljs-string">'bedrooms'</span>]==<span class="hljs-number">33</span>,[<span class="hljs-string">'bedrooms'</span>]]=<span class="hljs-number">3</span> 
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'bedrooms'</span>, data=df)</code></pre><br>
<img src="https://habrastorage.org/webt/qi/wd/fs/qiwdfscthapolbucfyjqy-uoggc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まあ、はるかに良い。</font><font style="vertical-align: inherit;">同様に、寝室はバスルームを見ます。</font><font style="vertical-align: inherit;">ゼロ値を削​​除しました。フィールドには他の極値はありません：</font></font><br>
<br>
<pre><code class="python hljs">sns.boxplot(y=<span class="hljs-string">'bathrooms'</span>, x=<span class="hljs-string">'bedrooms'</span>, data=df)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sqft_living、floors、waterfront、view、condition、grade、sqft_living15の各フィールドでも、すべての値が多かれ少なかれ実在しているため、触れません。</font></font><br>
<br>
<pre><code class="python hljs">plt.rcParams[<span class="hljs-string">'figure.figsize'</span>]=<span class="hljs-number">2</span>,<span class="hljs-number">3</span> 			<span class="hljs-comment"># </span>
sns.boxplot(y=<span class="hljs-string">'sqft_living'</span>, data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'floors'</span>,color=<span class="hljs-string">'#2ecc71'</span>, data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'sqft_living15'</span>,color=<span class="hljs-string">'#9b59b6'</span>, data=df) <font></font>
plt.rcParams[<span class="hljs-string">'figure.figsize'</span>]=<span class="hljs-number">4</span>,<span class="hljs-number">4</span>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'waterfront'</span>, data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'view'</span> , data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'condition'</span> , data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'grade'</span> , data=df)</code></pre><br>
<img src="https://habrastorage.org/webt/oq/uw/h8/oquwh8x-cln4tbaz9xrzqyk9szs.png"><br>
<br>
<img src="https://habrastorage.org/webt/yl/ns/bz/ylnsbzq_kx2dtvrvjy8iytxudve.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、sqft_lotとsqft_lot15では、何かを考え出す必要があります。値が大きいため、対数は非常に適しています。</font></font><br>
<br>
<pre><code class="python hljs">df[<span class="hljs-string">'sqft_lot'</span>]=np.log(df[<span class="hljs-string">'sqft_lot'</span>])<font></font>
df[<span class="hljs-string">'sqft_lot15'</span>]=np.log(df[<span class="hljs-string">'sqft_lot15'</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sqft_lot before and after：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yr/up/g2/yrupg24jwmfsptci9hf8uaq6wmu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sqft_aboveとsqft_basementはsqft_livingのコンポーネントなので、ここでは触れません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、予備分析で終わり、相関関係のヒートマップを確認します。</font></font><br>
<br>
<pre><code class="python hljs">sns.heatmap(df.corr(),  cmap = <span class="hljs-string">'viridis'</span>,annot = <span class="hljs-literal">True</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/ny/yi/uq/nyyiuqa9zbilc9l6gqzljfe35xu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
相関マップを調べたところ、属性が互いに強く相関している場合があることがわかりました。そのため、相関が高い属性の一部を削除します-sqft_lot15（leave sqft_lot）、yr_built（leave yr_renovated）、sqft_above（sqft_living）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これでデータの操作が完了し、モデルの作成に進みます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2.モデリング</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このパートでは、線形回帰と決定木という2つのモデルを構築します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
必要なモデルはすべてsklearnライブラリに含まれています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、ターゲット変数を残りのトレーニングデータから分離し、サンプルをトレーニング（70％）とテスト（30％、モデルがどのように機能するかを確認する）に分割します。</font></font><br>
<br>
<pre><code class="python hljs">Y=df[<span class="hljs-string">'price'</span>]<font></font>
X=df.drop (<span class="hljs-string">'price'</span>,axis=<span class="hljs-number">1</span>) 
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<font></font>
X_train, X_test, Y_train, Y_test  = train_test_split(X, Y, test_size = <span class="hljs-number">0.3</span>, shuffle = <span class="hljs-literal">True</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、sklearnからモデルを評価するために、mean_absolute_error（平均絶対誤差）、mean_squared_error（標準偏差）、r2_score（決定係数）の3つのメトリックをアップロードします。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> mean_absolute_error, mean_squared_error, r2_score</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
線形回帰から始めましょう：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LinearRegression<font></font>
LR = LinearRegression() 				<span class="hljs-comment"># </span>
LR.fit(X_train, Y_train)				<span class="hljs-comment"># </span>
Y_LR = LR.predict(X_test)				<span class="hljs-comment">#       </span>
<span class="hljs-keyword">print</span> (<span class="hljs-string">'MAE:'</span>, round (mean_absolute_error(Y_test, Y_LR),<span class="hljs-number">3</span>))		<span class="hljs-comment">#</span>
<span class="hljs-keyword">print</span> (<span class="hljs-string">'√MSE:'</span>, round (mean_squared_error(Y_test, Y_LR)**(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>),<span class="hljs-number">3</span>))
<span class="hljs-keyword">print</span> (<span class="hljs-string">'R2_score:'</span>, round (r2_score(Y_test, Y_LR),<span class="hljs-number">3</span>))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MAE：124477.452√MSE175205.645 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
R2_score </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
：0.627決定</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
木：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.tree <span class="hljs-keyword">import</span> DecisionTreeRegressor<font></font>
TR = DecisionTreeRegressor()				<span class="hljs-comment"># </span>
TR.fit(X_train, Y_train)				<span class="hljs-comment"># </span>
Y_TR=TR.predict(X_test)  				<span class="hljs-comment">#   </span>
<span class="hljs-keyword">print</span> (<span class="hljs-string">'MAE:'</span>, round (mean_absolute_error(Y_test, Y_TR),<span class="hljs-number">3</span>))		<span class="hljs-comment">#</span>
<span class="hljs-keyword">print</span> (<span class="hljs-string">'√MSE:'</span>, round (mean_squared_error(Y_test, Y_TR)**(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>),<span class="hljs-number">3</span>))
<span class="hljs-keyword">print</span> (<span class="hljs-string">'R2_score:'</span>, round (r2_score(Y_test, Y_TR),<span class="hljs-number">3</span>))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MAE：151734.906√MSE220856.721 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
R2_score </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
：0.407 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メトリックに基づいて、線形回帰が最良の結果を示したと結論付けることができるため、それを選択する方がより論理的です。ただし、モデルエラーが何で構成されているか、モデルが再トレーニングされているかどうかなどについては質問していません。モデルパラメーターでツリーの深さを制限していなかったため、DecisionTreeRegressorの結果が悪化したのは再トレーニングであった可能性が高いです。これは、短いサイクルで木の深さをソートすることで簡単に確認できます。</font></font><br>
<br>
<pre><code class="python hljs">dep,score=[],[]
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>,<span class="hljs-number">16</span>):<font></font>
    TR = DecisionTreeRegressor(max_depth=i)<font></font>
    TR.fit(X_train, Y_train)<font></font>
    Y_TR=TR.predict(X_test)<font></font>
    dep.append(i)<font></font>
    score.append(mean_squared_error(Y_test, Y_TR)**(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>))	<span class="hljs-comment">#  √MSE</span>
		plt.rcParams[<span class="hljs-string">'figure.figsize'</span>]=<span class="hljs-number">6</span>,<span class="hljs-number">3</span>
		plt.plot(dep, score)</code></pre><br>
<img src="https://habrastorage.org/webt/ar/fn/yt/arfnytm068lhpknk_ifnpshupgq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
明らかに、最良の指標はmax_depth = 7であり、メトリック（MAE：124861.441、√MSE175322.737、R2_score：0.626）を見ると、このような制限のあるモデルは品質の線形回帰に似ていることが明らかになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コスト予測のモデルで最も重要な属性を評価することもできます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/x1/qx/qw/x1qxqwlhqbfotpp45hhyr4nz0uc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
グラフに基づいて、グレードが最もコストに影響することは明らかです-不動産会社による住宅の一般的な主観的評価（ところで、評価の能力を示します:-)））、 2位は家の面積であり、3位-最後の修理の年です。指標は、ベッドルーム、バスルーム、フロアの数を考慮し、モデルは予測にとって重要ではないと考えました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果をよりよく理解するために、平均誤差を％で計算します-線形回帰によると、平均誤差は27.5％です。つまり、家のコストを予測するとき、モデルは4分の1より少し多くの誤差を生じます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果を改善できますか？</font><font style="vertical-align: inherit;">はい、もちろん、現在の段階では、基本的なソリューションしか受け取っていません。比較の開始点は、より洗練された方法またはより複雑なデータ処理を使用して作成できる、より良いまたはより悪いモデルになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
再トレーニングの問題についてはほんの少し触れただけで、モデルエラーやモデル作成の他の多くの側面が何で構成されるかについては触れませんでした。</font><font style="vertical-align: inherit;">原則として、これらの質問に答えて最適なソリューションを見つけるために、モデル検証のさまざまな方法が使用されますが、これについては次の記事で説明します。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja505498/index.html">Windowsの初期化されていないスタックメモリの問題を解決する方法</a></li>
<li><a href="../ja505502/index.html">カスタマーサービスのオムニチャネル：何を探し、すべてを正しく行うには？</a></li>
<li><a href="../ja505506/index.html">彼は噛まない：産業用ロボットを労働者にとって安全にする方法</a></li>
<li><a href="../ja505508/index.html">無人技術だけでなく、自動車産業の未来</a></li>
<li><a href="../ja505510/index.html">Python SDKによるCheck Point APIの合理化</a></li>
<li><a href="../ja505522/index.html">オンラインゲームでの収益化：他人の経験を自分のニーズに利用する方法</a></li>
<li><a href="../ja505528/index.html">Wi-Fi 6で最も重要なこと。いいえ、真剣に</a></li>
<li><a href="../ja505530/index.html">Googleがプロセッサを製造し、AMDがクアルコムを破壊する準備をしています</a></li>
<li><a href="../ja505532/index.html">ゲーム開発に関する電報チャネル：パート2</a></li>
<li><a href="../ja505536/index.html">コールトラッキングの調理方法：シアンの経験</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>