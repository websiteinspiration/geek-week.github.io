<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✋🏻 🙍🏻 🌗 機械学習アルゴリズムのブリッツテスト：データセットをscikit-learnライブラリにフィードします 🛬 🐁 ☺️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="世界中のウェブには、さまざまな問題を解決するために最も人気があり、最も使用されている機械学習アルゴリズムに関する記事が毎日補充されています。さらに、これらの記事の基礎は、場所によって少し形が変わっており、データ研究者間をさまよっています。さらに、これらすべての作業は、一般に受け入れられ、疑う余地のな...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>機械学習アルゴリズムのブリッツテスト：データセットをscikit-learnライブラリにフィードします</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/475552/"><img src="https://habrastorage.org/getpro/habr/post_images/7d1/0a1/6c9/7d10a16c9f50f8289a4b30eb53ffc661.jpg" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
世界中のウェブには、さまざまな問題を解決するために最も人気があり、最も使用されている機械学習アルゴリズムに関する記事が毎日補充されています。</font><font style="vertical-align: inherit;">さらに、これらの記事の基礎は、場所によって少し形が変わっており、データ研究者間をさまよっています。</font><font style="vertical-align: inherit;">さらに、これらすべての作業は、一般に受け入れられ、疑う余地のない仮説によって統一されています。1つまたは別の機械学習アルゴリズムの適用は、利用可能なデータのサイズと性質、および手元のタスクによって異なります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これに加えて、特に主張したデータ研究者は、経験を共有して、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「評価方法の選択は、データに部分的に依存し、あなたの意見では、モデルは何に適しているかに依存するはずです」（「データサイエンス：初心者向けの内部情報。 R言語を含む、Cathy O'Neill、Rachel Shutt）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
言い換えると、統計/データ研究者は、対象分野だけでなく幅広い幅広い知識も持っている必要があり</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><i><font style="vertical-align: inherit;">「データ研究者は、数学、統計学、コンピュータエンジニアリング、機械学習、視覚化、データ交換の手段...」</font></i><font style="vertical-align: inherit;">（同じ本から）。上記の領域の知識を頭に完全にロードすることによってのみ、機械学習に取り組み、示された問題の解決策を見つけることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私にとって、この始まりは、データサイエンスに関する通常の1.5キログラムの本、または機械的学習の分野の初心者に、そしてたまたま偶然に続く、「価値のない」2階建ての公式、記号、および波及を伴う科学的なホラーストーリーの記事に非常に適しています。この方向に興味があり、「必要な知識」に悩まされていない、経験の浅い読者。さらに、10の最も人気のある機械学習アルゴリズム（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たとえば</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">に関する同じ記事の第10ラウンド</font><font style="vertical-align: inherit;">は、課された効果を強化するだけです。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">habr'eについても</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「質問への回答：「使用する機械学習アルゴリズムは？」「常に次のように聞こえます：」状況に応じて。</font><font style="vertical-align: inherit;">アルゴリズムの選択は、データの量、質、および性質によって異なります。</font><font style="vertical-align: inherit;">結果の管理方法によって異なります。</font><font style="vertical-align: inherit;">それは、それを実装するコンピューターの命令がアルゴリズムからどのように作成されたか、そしてどれだけの時間を持っているかに依存します。</font><font style="vertical-align: inherit;">最も経験豊富なデータアナリストでさえ、試してみるまで、どのアルゴリズムが優れているかはわかりません。」</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
間違いなく、このすべての知識と忍耐力と関心は、機械学習の理解への道だけでなく、他の多くの分野でも良い結果を達成するために必要かつ有用です。</font><font style="vertical-align: inherit;">さらに、それらは機械学習アルゴリズム（以下-アルゴリズム）が1ダースにはほど遠いという理解を促進します。</font><font style="vertical-align: inherit;">しかし、これは後になって、独立した研究が行われました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の目標は、実用的でアクセスしやすい観点から、最もよく使用されるアルゴリズムを読者に紹介することです。 （私は決してプログラマーではなく、数学者でもないという事実（聖なる聖なる！）物語への関心を強調する必要があります。工学教育と10年間の「主題の成長」における経験（ある種の魔法の数） ）-彼らが言うように、そして私のすべてのこと、私が機械学習に真剣に取り組んだすべての荷物。石油業界での経験のおかげで、人工ニューラルネットワークと機械学習アルゴリズムを使用するためのアイデアがすぐに見つかりました（読む-必要だったデータセット。それは、「プログラム」の入力にデータを正しく送信するためにデータをツイストツイストする方法と、実際にはどのアルゴリズムを選択するかを学習すること、そして悪循環に陥ることにとどまりました。私の道は厄介で面白かったです-「銃弾が私の頭の上で口笛を吹いた」（映画「冒険の冒険」より）-それでも私はなんとかメモを取ることができました、そして興味が示された場合は将来的に他のメッセージを公開します。）</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのため、一方では「機械加工」にアプローチすることを提案します。既存のデータセット（例では、データセットが読み込まれ、簡単にトレーニングできます）を一度に多くのアルゴリズムにフィードし、結果に応じてどちらに注意するかを決定します。その後の注意深い研究と結果を高める最適なパラメータの選択。また、この方法の主な値は、上述の結果は、あなたのデータセットが価値があるかの質問に答えるということです：</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「問題を解くことで起動し、最適化するための何かを持っていることを確認する」</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（もいくつかからそれから、しつこい統計は彼に「敬意」を払って行きました、良いアドバイスです！）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それはどのように作られますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アルゴリズムを使用して解決される問題の大部分は、分類（分類）および回帰分析（予測分析）の問題に関連していることが知られています。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分類の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下では、</font><font style="vertical-align: inherit;">学習結果に基づいて、データセットの観測単位（インスタンス）を特定のカテゴリ（クラス）に着実に区別することが理解されています。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回帰分析</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、変数間の関係を評価するための一連の統計的方法とプロセスです[ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">統計：教科書/ Ed。教授。氏。エフィモヴァ。 -M。：INFRA-M、2002</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]。回帰分析の目的は、入力変数の値[ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ] </font><font style="vertical-align: inherit;">から連続出力変数の値を評価することです</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
回帰分析では、予測モデリングと予測という2つの異なる方法を自由に使用できるという事実を省略します。時系列（時系列データ）がある場合、定常性（不変性）の影響を受ける明示的な傾向に基づく回帰モデルを使用して、予測を実行できることに注意してください。時系列のレベルの形成の条件が変化する場合、つまり非定常プロセスが観察されない場合は、予測モデリング次第です。特にMLを完全に習得することを目的として、この記事を英語で読むことをお勧めします：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンク</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これについて議論があれば参加させていただきます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事の例では時系列は使用されないため、用語</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">予測</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">予測分析</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">として理解されてい</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
分類と予測の問題を解決するには、全範囲のアルゴリズムが適しています。そのうちのいくつかは後で検討します。便宜上、後続のテキストは2つの部分に分けられます。最初の部分では最も一般的な分類アルゴリズムを検討し、2番目の部分では回帰分析アルゴリズムを取り上げます。各パーツについて</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、scikit-learnライブラリ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（v0.21.3）</font><font style="vertical-align: inherit;">からロードされた「おもちゃ」のデータセット</font><font style="vertical-align: inherit;">：</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数字データセット（分類）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ボストンハウスプライスデータセット（回帰）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、および各scikit-learnライブラリアルゴリズムへのリンクが表示されます自己検査と、おそらく、研究のために。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのコード例は</font><font style="vertical-align: inherit;">、Python 3.7.3の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IDE Spyder</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3.3.3 </font><font style="vertical-align: inherit;">コンソール</font><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">実行され</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分類の問題</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、データ分類の問題を解決するために使用する必要なモジュールと関数をインポートします。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#     </span>
<span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_digits
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LogisticRegression
<span class="hljs-keyword">from</span> sklearn.discriminant_analysis <span class="hljs-keyword">import</span> LinearDiscriminantAnalysis
<span class="hljs-keyword">from</span> sklearn.neighbors <span class="hljs-keyword">import</span> KNeighborsClassifier
<span class="hljs-keyword">from</span> sklearn.tree <span class="hljs-keyword">import</span> DecisionTreeClassifier
<span class="hljs-keyword">from</span> sklearn.naive_bayes <span class="hljs-keyword">import</span> GaussianNB
<span class="hljs-keyword">from</span> sklearn.svm <span class="hljs-keyword">import</span> LinearSVC
<span class="hljs-keyword">from</span> sklearn.svm <span class="hljs-keyword">import</span> SVC
<span class="hljs-keyword">from</span> sklearn.neural_network <span class="hljs-keyword">import</span> MLPClassifier
<span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> BaggingClassifier
<span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> RandomForestClassifier
<span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> ExtraTreesClassifier
<span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> AdaBoostClassifier
<span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> GradientBoostingClassifier
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> KFold
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> cross_val_score
<span class="hljs-keyword">from</span> sklearn.pipeline <span class="hljs-keyword">import</span> Pipeline
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> StandardScaler
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> MinMaxScaler
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> Normalizer
<span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> pyplot</code></pre><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モジュール「sklearn.datasets」</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
から直接データセット「数字」</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">をロードし</font></a><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#   </span>
dataset = load_digits()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IDEスパイダーは次のように、（少なくとも私にとっては）機械学習の学習のすべての回で便利です便利なツール「変数マネージャ」、提供して</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">他の「トリック」</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファイル名を指定して実行コードを。 「変数マネージャー」コンソールで、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データセット</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数をクリックします</font><font style="vertical-align: inherit;">。次のディクショナリが表示されます。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/f9f/362/64a/f9f36264a8a368644793b6f4ed7ad045.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データセット</font><font style="vertical-align: inherit;">の</font><font style="vertical-align: inherit;">説明は次のとおりです</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/887/659/b2b/887659b2bc79bfd532c30d6ddee8aa5e.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。この例では、 'images'キーは必要ないため</font><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">変数</font><font style="vertical-align: inherit;">'data'を</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に割り当て</font><font style="vertical-align: inherit;">ます</font><i><font style="vertical-align: inherit;">。X</font></i><font style="vertical-align: inherit;">は、属性のセット、64列に1797行</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ターゲットに</font><i><font style="vertical-align: inherit;">Yを</font></i><font style="vertical-align: inherit;">持つ多次元NumPy配列です。</font><font style="vertical-align: inherit;">'、各行にマーカーがある多次元NumPy配列。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#   </span>
<span class="hljs-comment"># dataset = load_digits()</span><font></font>
X = dataset.data<font></font>
Y = dataset.target</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、データセットをトレーニング部分とテスト部分に分割し、アルゴリズムを評価するためのパラメーターを構成し（交差検証[ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">two</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]を使用）、パラメーター 'scoring' [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]で</font><font style="vertical-align: inherit;">メトリック 'accuracy'を定義します</font><font style="vertical-align: inherit;">。精度は、オブジェクトの総数に対する、正しく分類されたオブジェクトの割合です。結果が1に近いほど、[ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンク</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ] </font><font style="vertical-align: inherit;">が優れてい</font><font style="vertical-align: inherit;">ます。さらに、1冊の本では、0.95（または95％）以上の結果が優れていると見なされています。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#        </span>
test_size = <span class="hljs-number">0.2</span>
seed = <span class="hljs-number">7</span><font></font>
X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=test_size, random_state=seed)<font></font>
<span class="hljs-comment">#    </span>
num_folds = <span class="hljs-number">10</span>
n_estimators = <span class="hljs-number">100</span>
scoring = <span class="hljs-string">'accuracy'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
変数</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X_train</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y_train</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">をトレーニング目的で</font><i><font style="vertical-align: inherit;">使用</font></i><font style="vertical-align: inherit;">し、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X_test</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y_test</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を予測値の開発に使用します。この場合、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y_test</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数</font><i><font style="vertical-align: inherit;">は</font></i><font style="vertical-align: inherit;">予測の計算に参加し</font><i><font style="vertical-align: inherit;">ませ</font></i><font style="vertical-align: inherit;">ん。以下に示す各アルゴリズムで同じスコアメソッドを使用して、精度メトリックを使用して正解を計算します。これにより、アルゴリズムがタスクにどのように対処するかを判断できます。私は主張しません、私たちの側では、正しい答えで車を促さないのは人間の卑劣ですが、他にどのようにその性能をチェックするのですか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下は、データセットに供給するアルゴリズムのリストです。</font><font style="vertical-align: inherit;">計算結果に基づいて、どのアルゴリズム（どのアルゴリズム）が最大の効率を示すかを結論付けます。</font><font style="vertical-align: inherit;">この方法は、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「機械学習アルゴリズムの</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">電撃検証</font><b><font style="vertical-align: inherit;">」</font></b><font style="vertical-align: inherit;">（以下、電撃検証）</font><font style="vertical-align: inherit;">と呼ばれることもあります</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
情報出力の便宜上、各アルゴリズムの横に略語を付しています。</font><font style="vertical-align: inherit;">各アルゴリズムの設定は、同等の条件を提供するために、いくつかの点を除いて、デフォルト（デフォルト）で受け入れられることに注意してください。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">線形アルゴリズム：</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -ロジスティック回帰* / </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロジスティック回帰</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ 'LR'）</font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*「回帰」という言葉は紛らわしい場合があります。</font><font style="vertical-align: inherit;">ただし、「ロジスティック回帰」は分類アルゴリズムであることを忘れないでください</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
 - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">線形判別分析</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（LDA）</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非線形アルゴリズム：</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -k最近傍（分類）/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">K近傍分類子</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ 'KNN'）の方法</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">決定木分類子</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ 'CART'）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">単純ベイズ分類子</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ 'NB'）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -線形サポートベクトル法（分類）/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">線形サポートベクター分類</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ 'LSVC'）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">サポートベクター</font></a><font style="vertical-align: inherit;">法（分類）/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cサポートベクター分類</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ 'SVC'）</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">人工ニューラルネットワークアルゴリズム：</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多層パーセプトロン</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">多層パーセプトロン</font></a><font style="vertical-align: inherit;">（ 'MLP'）</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アンサンブルアルゴリズム：</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -バギング（分類）/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バギング分類子</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ 'BG'）（バギング=ブートストラップ集計）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -ランダムフォレスト（分類）/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ランダムフォレスト分類子</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ 'RF'）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -追加ツリー（分類）/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">追加ツリー分類子</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ 'ET'）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -AdaBoost（分類）/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AdaBoost Classifier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ 'AB'）（AdaBoost = Adaptive Boosting）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -勾配ブースティング（分類）/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gradient Boosting Classifier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ 'GB'）</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、「モデル」のリストには次のモデルが含まれます。</font></font><br>
<br>
<pre><code class="python hljs">models = []<font></font>
models.append((<span class="hljs-string">'LR'</span>, LogisticRegression()))<font></font>
models.append((<span class="hljs-string">'LDA'</span>, LinearDiscriminantAnalysis()))<font></font>
models.append((<span class="hljs-string">'KNN'</span>, KNeighborsClassifier()))<font></font>
models.append((<span class="hljs-string">'CART'</span>, DecisionTreeClassifier()))<font></font>
models.append((<span class="hljs-string">'NB'</span>, GaussianNB()))<font></font>
models.append((<span class="hljs-string">'LSVC'</span>, LinearSVC()))<font></font>
models.append((<span class="hljs-string">'SVC'</span>, SVC()))<font></font>
models.append((<span class="hljs-string">'MLP'</span>, MLPClassifier()))<font></font>
models.append((<span class="hljs-string">'BG'</span>, BaggingClassifier(n_estimators=n_estimators)))<font></font>
models.append((<span class="hljs-string">'RF'</span>, RandomForestClassifier(n_estimators=n_estimators)))<font></font>
models.append((<span class="hljs-string">'ET'</span>, ExtraTreesClassifier(n_estimators=n_estimators)))<font></font>
models.append((<span class="hljs-string">'AB'</span>, AdaBoostClassifier(n_estimators=n_estimators, algorithm=<span class="hljs-string">'SAMME'</span>)))<font></font>
models.append((<span class="hljs-string">'GB'</span>, GradientBoostingClassifier(n_estimators=n_estimators)))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すでに述べたように、各アルゴリズムの有効性は交差検証を使用して評価されます。</font><font style="vertical-align: inherit;">その結果、次の情報を含むメッセージが表示されます（msg-メッセージの省略形）：省略形のモデル名、トレーニングデータの10回の相互検証の平均スコア（メトリック '精度'）、標準偏差は括弧内に表示されます、およびテストデータの「精度」メトリックの値。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#     </span><font></font>
scores = []<font></font>
names = []<font></font>
results = []<font></font>
predictions = []<font></font>
msg_row = []<font></font>
<span class="hljs-keyword">for</span> name, model <span class="hljs-keyword">in</span> models:<font></font>
    kfold = KFold(n_splits=num_folds, random_state=seed)<font></font>
    cv_results = cross_val_score(model, X_train, Y_train, cv=kfold, scoring=scoring)<font></font>
    names.append(name)<font></font>
    results.append(cv_results)<font></font>
    m_fit = model.fit(X_train, Y_train)<font></font>
    m_predict = model.predict(X_test)<font></font>
    predictions.append(m_predict)<font></font>
    m_score = model.score(X_test, Y_test)<font></font>
    scores.append(m_score)<font></font>
    msg = <span class="hljs-string">"%s: train = %.3f (%.3f) / test = %.3f"</span> % (name, cv_results.mean(), cv_results.std(), m_score)<font></font>
    msg_row.append(msg)<font></font>
    print(msg)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードを実行すると、次の結果が得られます。</font></font><br>
<br>
<pre><code class="python hljs">LR: train = <span class="hljs-number">0.957</span> (<span class="hljs-number">0.014</span>) / test = <span class="hljs-number">0.948</span>
LDA: train = <span class="hljs-number">0.951</span> (<span class="hljs-number">0.014</span>) / test = <span class="hljs-number">0.946</span>
KNN: train = <span class="hljs-number">0.985</span> (<span class="hljs-number">0.013</span>) / test = <span class="hljs-number">0.981</span>
CART: train = <span class="hljs-number">0.843</span> (<span class="hljs-number">0.033</span>) / test = <span class="hljs-number">0.830</span>
NB: train = <span class="hljs-number">0.819</span> (<span class="hljs-number">0.048</span>) / test = <span class="hljs-number">0.806</span>
LSVC: train = <span class="hljs-number">0.942</span> (<span class="hljs-number">0.017</span>) / test = <span class="hljs-number">0.928</span>
SVC: train = <span class="hljs-number">0.343</span> (<span class="hljs-number">0.079</span>) / test = <span class="hljs-number">0.342</span>
MLP: train = <span class="hljs-number">0.972</span> (<span class="hljs-number">0.012</span>) / test = <span class="hljs-number">0.961</span>
BG: train = <span class="hljs-number">0.952</span> (<span class="hljs-number">0.021</span>) / test = <span class="hljs-number">0.941</span>
RF: train = <span class="hljs-number">0.968</span> (<span class="hljs-number">0.017</span>) / test = <span class="hljs-number">0.965</span>
ET: train = <span class="hljs-number">0.980</span> (<span class="hljs-number">0.010</span>) / test = <span class="hljs-number">0.975</span>
AB: train = <span class="hljs-number">0.827</span> (<span class="hljs-number">0.049</span>) / test = <span class="hljs-number">0.823</span>
GB: train = <span class="hljs-number">0.964</span> (<span class="hljs-number">0.013</span>) / test = <span class="hljs-number">0.968</span></code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スパンチャート</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「口ひげのある箱」</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）（箱ひげ図またはプロット、箱ひげ図）：</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/e3e/301/4c9/e3e3014c9931e3af6b7ea01eda90a0d0.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「生」データのブリッツテストの結果、最も効率的なテストデータが「KNN」アルゴリズム（k-最近傍）、 'ET'（追加ツリー）、 'GB'（勾配 'ブースティング'）、 'RF'（ランダムフォレスト）、 'MLP'（多層パーセプトロン）：</font></font><br>
<br>
<pre><code class="python hljs">KNN: train = <span class="hljs-number">0.985</span> (<span class="hljs-number">0.013</span>) / test = <span class="hljs-number">0.981</span>
ET: train = <span class="hljs-number">0.980</span> (<span class="hljs-number">0.010</span>) / test = <span class="hljs-number">0.975</span>
GB: train = <span class="hljs-number">0.964</span> (<span class="hljs-number">0.013</span>) / test = <span class="hljs-number">0.968</span>
RF: train = <span class="hljs-number">0.968</span> (<span class="hljs-number">0.017</span>) / test = <span class="hljs-number">0.965</span>
MLP: train = <span class="hljs-number">0.972</span> (<span class="hljs-number">0.012</span>) / test = <span class="hljs-number">0.961</span>
LR: train = <span class="hljs-number">0.957</span> (<span class="hljs-number">0.014</span>) / test = <span class="hljs-number">0.948</span>
LDA: train = <span class="hljs-number">0.951</span> (<span class="hljs-number">0.014</span>) / test = <span class="hljs-number">0.946</span>
BG: train = <span class="hljs-number">0.952</span> (<span class="hljs-number">0.021</span>) / test = <span class="hljs-number">0.941</span>
LSVC: train = <span class="hljs-number">0.942</span> (<span class="hljs-number">0.017</span>) / test = <span class="hljs-number">0.928</span>
CART: train = <span class="hljs-number">0.843</span> (<span class="hljs-number">0.033</span>) / test = <span class="hljs-number">0.830</span>
AB: train = <span class="hljs-number">0.827</span> (<span class="hljs-number">0.049</span>) / test = <span class="hljs-number">0.823</span>
NB: train = <span class="hljs-number">0.819</span> (<span class="hljs-number">0.048</span>) / test = <span class="hljs-number">0.806</span>
SVC: train = <span class="hljs-number">0.343</span> (<span class="hljs-number">0.079</span>) / test = <span class="hljs-number">0.342</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、多くのアルゴリズムは、提供されるデータについて非常にうるさいです。したがって、必要なステップの1つは、いわゆる予備データの準備（データの前処理[ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンク</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]）です</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
が、アルゴリズムが予備処理なしで最良の結果を示すことがあります。したがって、次の推奨事項：ブリッツテストに元のデータセットのいくつかの変換を含め、計算を実行した後、結果を比較して問題全体の本質を把握します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
予備的なデータ準備の最も一般的に使用される方法は次のとおりです</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">標準化。</font></font><br>
</a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スケーリング</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（デフォルトの範囲は[0、1]です）; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正規化</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの操作とその後の評価は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パイプライン</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ツールを使用して自動化し、コンベヤに配置できます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ソースデータを標準化したコードスニペットは次のとおりです。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># -     </span>
<span class="hljs-comment">#    ( StandardScaler)</span><font></font>
pipelines = []<font></font>
pipelines.append((<span class="hljs-string">'SS_LR'</span>, Pipeline([(<span class="hljs-string">'Scaler'</span>, StandardScaler()), (<span class="hljs-string">'LR'</span>, LogisticRegression())])))<font></font>
pipelines.append((<span class="hljs-string">'SS_LDA'</span>, Pipeline([(<span class="hljs-string">'Scaler'</span>, StandardScaler()), (<span class="hljs-string">'LDA'</span>, LinearDiscriminantAnalysis())])))<font></font>
pipelines.append((<span class="hljs-string">'SS_KNN'</span>, Pipeline([(<span class="hljs-string">'Scaler'</span>, StandardScaler()), (<span class="hljs-string">'KNN'</span>, KNeighborsClassifier())])))<font></font>
pipelines.append((<span class="hljs-string">'SS_CART'</span>, Pipeline([(<span class="hljs-string">'Scaler'</span>, StandardScaler()), (<span class="hljs-string">'CART'</span>, DecisionTreeClassifier())])))<font></font>
pipelines.append((<span class="hljs-string">'SS_NB'</span>, Pipeline([(<span class="hljs-string">'Scaler'</span>, StandardScaler()), (<span class="hljs-string">'NB'</span>, GaussianNB())])))<font></font>
pipelines.append((<span class="hljs-string">'SS_LSVC'</span>, Pipeline([(<span class="hljs-string">'Scaler'</span>, StandardScaler()), (<span class="hljs-string">'LSVC'</span>, LinearSVC())])))<font></font>
pipelines.append((<span class="hljs-string">'SS_SVC'</span>, Pipeline([(<span class="hljs-string">'Scaler'</span>, StandardScaler()), (<span class="hljs-string">'SVC'</span>, SVC())])))<font></font>
pipelines.append((<span class="hljs-string">'SS_MLP'</span>, Pipeline([(<span class="hljs-string">'Scaler'</span>, StandardScaler()), (<span class="hljs-string">'MLP'</span>, MLPClassifier())])))<font></font>
pipelines.append((<span class="hljs-string">'SS_BG'</span>, Pipeline([(<span class="hljs-string">'Scaler'</span>, StandardScaler()), (<span class="hljs-string">'BG'</span>, BaggingClassifier(n_estimators=n_estimators))])))<font></font>
pipelines.append((<span class="hljs-string">'SS_RF'</span>, Pipeline([(<span class="hljs-string">'Scaler'</span>, StandardScaler()), (<span class="hljs-string">'RF'</span>, RandomForestClassifier(n_estimators=n_estimators))])))                                                                                                                                                        <font></font>
pipelines.append((<span class="hljs-string">'SS_ET'</span>, Pipeline([(<span class="hljs-string">'Scaler'</span>, StandardScaler()), (<span class="hljs-string">'ET'</span>, ExtraTreesClassifier(n_estimators=n_estimators))])))<font></font>
pipelines.append((<span class="hljs-string">'SS_AB'</span>, Pipeline([(<span class="hljs-string">'Scaler'</span>, StandardScaler()), (<span class="hljs-string">'AB'</span>, AdaBoostClassifier(n_estimators=n_estimators, algorithm=<span class="hljs-string">'SAMME'</span>))])))<font></font>
pipelines.append((<span class="hljs-string">'SS_GB'</span>, Pipeline([(<span class="hljs-string">'Scaler'</span>, StandardScaler()), (<span class="hljs-string">'GB'</span>, GradientBoostingClassifier(n_estimators=n_estimators))])))
<span class="hljs-comment">#     </span><font></font>
scores_SS = []<font></font>
names_SS = []<font></font>
results_SS = []<font></font>
predictions_SS = []<font></font>
msg_SS = []<font></font>
<span class="hljs-keyword">for</span> name, model <span class="hljs-keyword">in</span> pipelines:<font></font>
    kfold = KFold(n_splits=num_folds, random_state=seed)<font></font>
    cv_results = cross_val_score(model, X_train, Y_train, cv=kfold)<font></font>
    names_SS.append(name)<font></font>
    results_SS.append(cv_results)<font></font>
    m_fit = model.fit(X_train, Y_train)<font></font>
    m_predict = model.predict(X_test)<font></font>
    predictions_SS.append(m_predict)<font></font>
    m_score = model.score(X_test, Y_test)<font></font>
    scores_SS.append(m_score)<font></font>
    msg = <span class="hljs-string">"%s: train = %.3f (%.3f) / test = %.3f"</span> % (name, cv_results.mean(), cv_results.std(), m_score)<font></font>
    msg_SS.append(msg)<font></font>
    print(msg)<font></font>
<span class="hljs-comment">#    (StandardScaler)</span><font></font>
fig = pyplot.figure()<font></font>
fig.suptitle(<span class="hljs-string">'     . '</span>)<font></font>
ax = fig.add_subplot(<span class="hljs-number">111</span>)<font></font>
red_square = dict(markerfacecolor=<span class="hljs-string">'r'</span>, marker=<span class="hljs-string">'s'</span>)<font></font>
pyplot.boxplot(results_SS, flierprops=red_square)<font></font>
ax.set_xticklabels(names_SS, rotation=<span class="hljs-number">45</span>)<font></font>
pyplot.show()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
名前をリストするために '_SS'（StandardScalerの略）が追加されていることに注意してください。</font><font style="vertical-align: inherit;">これは、結果が積み重ならないようにするため、および変換が実行された後に「変数マネージャー」を使用して結果を簡単に表示するために行われます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードスニペットを実行すると、次の結果が生成されます。</font></font><br>
<br>
<pre><code class="python hljs">SS_LR: train = <span class="hljs-number">0.958</span> (<span class="hljs-number">0.015</span>) / test = <span class="hljs-number">0.949</span>
SS_LDA: train = <span class="hljs-number">0.951</span> (<span class="hljs-number">0.014</span>) / test = <span class="hljs-number">0.946</span>
SS_KNN: train = <span class="hljs-number">0.968</span> (<span class="hljs-number">0.023</span>) / test = <span class="hljs-number">0.970</span>
SS_CART: train = <span class="hljs-number">0.853</span> (<span class="hljs-number">0.036</span>) / test = <span class="hljs-number">0.835</span>
SS_NB: train = <span class="hljs-number">0.756</span> (<span class="hljs-number">0.046</span>) / test = <span class="hljs-number">0.751</span>
SS_LSVC: train = <span class="hljs-number">0.945</span> (<span class="hljs-number">0.018</span>) / test = <span class="hljs-number">0.941</span>
SS_SVC: train = <span class="hljs-number">0.976</span> (<span class="hljs-number">0.015</span>) / test = <span class="hljs-number">0.990</span>
SS_MLP: train = <span class="hljs-number">0.976</span> (<span class="hljs-number">0.012</span>) / test = <span class="hljs-number">0.973</span>
SS_BG: train = <span class="hljs-number">0.947</span> (<span class="hljs-number">0.018</span>) / test = <span class="hljs-number">0.948</span>
SS_RF: train = <span class="hljs-number">0.973</span> (<span class="hljs-number">0.016</span>) / test = <span class="hljs-number">0.970</span>
SS_ET: train = <span class="hljs-number">0.980</span> (<span class="hljs-number">0.012</span>) / test = <span class="hljs-number">0.975</span>
SS_AB: train = <span class="hljs-number">0.827</span> (<span class="hljs-number">0.049</span>) / test = <span class="hljs-number">0.823</span>
SS_GB: train = <span class="hljs-number">0.964</span> (<span class="hljs-number">0.013</span>) / test = <span class="hljs-number">0.968</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Moustache Box（StandardScaler）：</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/8f7/a0d/bf7/8f7a0dbf718cfdd7b061ffd43a7bed8e.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
標準化されたデータの計算結果に基づいて、次のアルゴリズムがリーダーになりました。</font></font><br>
<br>
<pre><code class="python hljs">SS_SVC: train = <span class="hljs-number">0.976</span> (<span class="hljs-number">0.015</span>) / test = <span class="hljs-number">0.990</span>
SS_ET: train = <span class="hljs-number">0.980</span> (<span class="hljs-number">0.012</span>) / test = <span class="hljs-number">0.975</span>
SS_MLP: train = <span class="hljs-number">0.976</span> (<span class="hljs-number">0.012</span>) / test = <span class="hljs-number">0.973</span>
SS_KNN: train = <span class="hljs-number">0.968</span> (<span class="hljs-number">0.023</span>) / test = <span class="hljs-number">0.970</span>
SS_RF: train = <span class="hljs-number">0.973</span> (<span class="hljs-number">0.016</span>) / test = <span class="hljs-number">0.970</span>
SS_GB: train = <span class="hljs-number">0.964</span> (<span class="hljs-number">0.013</span>) / test = <span class="hljs-number">0.968</span>
SS_LR: train = <span class="hljs-number">0.958</span> (<span class="hljs-number">0.015</span>) / test = <span class="hljs-number">0.949</span>
SS_BG: train = <span class="hljs-number">0.947</span> (<span class="hljs-number">0.018</span>) / test = <span class="hljs-number">0.948</span>
SS_LDA: train = <span class="hljs-number">0.951</span> (<span class="hljs-number">0.014</span>) / test = <span class="hljs-number">0.946</span>
SS_LSVC: train = <span class="hljs-number">0.945</span> (<span class="hljs-number">0.018</span>) / test = <span class="hljs-number">0.941</span>
SS_CART: train = <span class="hljs-number">0.853</span> (<span class="hljs-number">0.036</span>) / test = <span class="hljs-number">0.835</span>
SS_AB: train = <span class="hljs-number">0.827</span> (<span class="hljs-number">0.049</span>) / test = <span class="hljs-number">0.823</span>
SS_NB: train = <span class="hljs-number">0.756</span> (<span class="hljs-number">0.046</span>) / test = <span class="hljs-number">0.751</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
彼らが言うように、ぼろきれから富みまで：標準化されたデータを供給されるサポートベクター法（「SVC」）が残りを行い、優れた結果を示した。</font><font style="vertical-align: inherit;">「手動」チェック中に、変数</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y_test</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font><i><font style="vertical-align: inherit;">predicts_SS </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[6]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の値を比較すると</font><font style="vertical-align: inherit;">、アルゴリズムは少数の値しか噛みませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のコードは、MinMaxScaler（スケーリング）およびNormalizer（正規化）関数に対して実行されます。</font><font style="vertical-align: inherit;">記事では完全なコードは示しません。</font><font style="vertical-align: inherit;">私のGitHubリポジトリからダウンロードできます：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンク</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しばらくぶら下がって、「教育目的のみ」で自分を笑うことを忘れないでください！</font><font style="vertical-align: inherit;">:) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、コード全体を実行した後、次の結果が得られます。</font></font><br>
<br>
<pre><code class="python hljs">LR: train = <span class="hljs-number">0.957</span> (<span class="hljs-number">0.014</span>) / test = <span class="hljs-number">0.948</span>
LDA: train = <span class="hljs-number">0.951</span> (<span class="hljs-number">0.014</span>) / test = <span class="hljs-number">0.946</span>
KNN: train = <span class="hljs-number">0.985</span> (<span class="hljs-number">0.013</span>) / test = <span class="hljs-number">0.981</span>
CART: train = <span class="hljs-number">0.843</span> (<span class="hljs-number">0.033</span>) / test = <span class="hljs-number">0.830</span>
NB: train = <span class="hljs-number">0.819</span> (<span class="hljs-number">0.048</span>) / test = <span class="hljs-number">0.806</span>
LSVC: train = <span class="hljs-number">0.942</span> (<span class="hljs-number">0.017</span>) / test = <span class="hljs-number">0.928</span>
SVC: train = <span class="hljs-number">0.343</span> (<span class="hljs-number">0.079</span>) / test = <span class="hljs-number">0.342</span>
MLP: train = <span class="hljs-number">0.972</span> (<span class="hljs-number">0.012</span>) / test = <span class="hljs-number">0.961</span>
BG: train = <span class="hljs-number">0.952</span> (<span class="hljs-number">0.021</span>) / test = <span class="hljs-number">0.941</span>
RF: train = <span class="hljs-number">0.968</span> (<span class="hljs-number">0.017</span>) / test = <span class="hljs-number">0.965</span>
ET: train = <span class="hljs-number">0.980</span> (<span class="hljs-number">0.010</span>) / test = <span class="hljs-number">0.975</span>
AB: train = <span class="hljs-number">0.827</span> (<span class="hljs-number">0.049</span>) / test = <span class="hljs-number">0.823</span>
GB: train = <span class="hljs-number">0.964</span> (<span class="hljs-number">0.013</span>) / test = <span class="hljs-number">0.968</span>
SS_LR: train = <span class="hljs-number">0.958</span> (<span class="hljs-number">0.015</span>) / test = <span class="hljs-number">0.949</span>
SS_LDA: train = <span class="hljs-number">0.951</span> (<span class="hljs-number">0.014</span>) / test = <span class="hljs-number">0.946</span>
SS_KNN: train = <span class="hljs-number">0.968</span> (<span class="hljs-number">0.023</span>) / test = <span class="hljs-number">0.970</span>
SS_CART: train = <span class="hljs-number">0.853</span> (<span class="hljs-number">0.036</span>) / test = <span class="hljs-number">0.835</span>
SS_NB: train = <span class="hljs-number">0.756</span> (<span class="hljs-number">0.046</span>) / test = <span class="hljs-number">0.751</span>
SS_LSVC: train = <span class="hljs-number">0.945</span> (<span class="hljs-number">0.018</span>) / test = <span class="hljs-number">0.941</span>
SS_SVC: train = <span class="hljs-number">0.976</span> (<span class="hljs-number">0.015</span>) / test = <span class="hljs-number">0.990</span>
SS_MLP: train = <span class="hljs-number">0.976</span> (<span class="hljs-number">0.012</span>) / test = <span class="hljs-number">0.973</span>
SS_BG: train = <span class="hljs-number">0.947</span> (<span class="hljs-number">0.018</span>) / test = <span class="hljs-number">0.948</span>
SS_RF: train = <span class="hljs-number">0.973</span> (<span class="hljs-number">0.016</span>) / test = <span class="hljs-number">0.970</span>
SS_ET: train = <span class="hljs-number">0.980</span> (<span class="hljs-number">0.012</span>) / test = <span class="hljs-number">0.975</span>
SS_AB: train = <span class="hljs-number">0.827</span> (<span class="hljs-number">0.049</span>) / test = <span class="hljs-number">0.823</span>
SS_GB: train = <span class="hljs-number">0.964</span> (<span class="hljs-number">0.013</span>) / test = <span class="hljs-number">0.968</span>
MMS_LR: train = <span class="hljs-number">0.961</span> (<span class="hljs-number">0.013</span>) / test = <span class="hljs-number">0.953</span>
MMS_LDA: train = <span class="hljs-number">0.951</span> (<span class="hljs-number">0.014</span>) / test = <span class="hljs-number">0.946</span>
MMS_KNN: train = <span class="hljs-number">0.985</span> (<span class="hljs-number">0.013</span>) / test = <span class="hljs-number">0.981</span>
MMS_CART: train = <span class="hljs-number">0.850</span> (<span class="hljs-number">0.027</span>) / test = <span class="hljs-number">0.840</span>
MMS_NB: train = <span class="hljs-number">0.796</span> (<span class="hljs-number">0.045</span>) / test = <span class="hljs-number">0.786</span>
MMS_LSVC: train = <span class="hljs-number">0.964</span> (<span class="hljs-number">0.012</span>) / test = <span class="hljs-number">0.958</span>
MMS_SVC: train = <span class="hljs-number">0.963</span> (<span class="hljs-number">0.016</span>) / test = <span class="hljs-number">0.956</span>
MMS_MLP: train = <span class="hljs-number">0.972</span> (<span class="hljs-number">0.011</span>) / test = <span class="hljs-number">0.963</span>
MMS_BG: train = <span class="hljs-number">0.948</span> (<span class="hljs-number">0.024</span>) / test = <span class="hljs-number">0.946</span>
MMS_RF: train = <span class="hljs-number">0.973</span> (<span class="hljs-number">0.014</span>) / test = <span class="hljs-number">0.968</span>
MMS_ET: train = <span class="hljs-number">0.983</span> (<span class="hljs-number">0.010</span>) / test = <span class="hljs-number">0.981</span>
MMS_AB: train = <span class="hljs-number">0.827</span> (<span class="hljs-number">0.049</span>) / test = <span class="hljs-number">0.823</span>
MMS_GB: train = <span class="hljs-number">0.963</span> (<span class="hljs-number">0.013</span>) / test = <span class="hljs-number">0.968</span>
N_LR: train = <span class="hljs-number">0.938</span> (<span class="hljs-number">0.020</span>) / test = <span class="hljs-number">0.919</span>
N_LDA: train = <span class="hljs-number">0.952</span> (<span class="hljs-number">0.013</span>) / test = <span class="hljs-number">0.949</span>
N_KNN: train = <span class="hljs-number">0.981</span> (<span class="hljs-number">0.012</span>) / test = <span class="hljs-number">0.985</span>
N_CART: train = <span class="hljs-number">0.834</span> (<span class="hljs-number">0.028</span>) / test = <span class="hljs-number">0.825</span>
N_NB: train = <span class="hljs-number">0.825</span> (<span class="hljs-number">0.043</span>) / test = <span class="hljs-number">0.805</span>
N_LSVC: train = <span class="hljs-number">0.960</span> (<span class="hljs-number">0.014</span>) / test = <span class="hljs-number">0.953</span>
N_SVC: train = <span class="hljs-number">0.551</span> (<span class="hljs-number">0.053</span>) / test = <span class="hljs-number">0.586</span>
N_MLP: train = <span class="hljs-number">0.963</span> (<span class="hljs-number">0.018</span>) / test = <span class="hljs-number">0.946</span>
N_BG: train = <span class="hljs-number">0.949</span> (<span class="hljs-number">0.016</span>) / test = <span class="hljs-number">0.938</span>
N_RF: train = <span class="hljs-number">0.973</span> (<span class="hljs-number">0.015</span>) / test = <span class="hljs-number">0.970</span>
N_ET: train = <span class="hljs-number">0.982</span> (<span class="hljs-number">0.012</span>) / test = <span class="hljs-number">0.980</span>
N_AB: train = <span class="hljs-number">0.825</span> (<span class="hljs-number">0.040</span>) / test = <span class="hljs-number">0.820</span>
N_GB: train = <span class="hljs-number">0.953</span> (<span class="hljs-number">0.022</span>) / test = <span class="hljs-number">0.956</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「トップ5」の結果：</font></font><br>
<br>
<pre><code class="python hljs">SS_SVC: train = <span class="hljs-number">0.976</span> (<span class="hljs-number">0.015</span>) / test = <span class="hljs-number">0.990</span>
N_KNN: train = <span class="hljs-number">0.981</span> (<span class="hljs-number">0.012</span>) / test = <span class="hljs-number">0.985</span>
KNN: train = <span class="hljs-number">0.985</span> (<span class="hljs-number">0.013</span>) / test = <span class="hljs-number">0.981</span>
MMS_KNN: train = <span class="hljs-number">0.985</span> (<span class="hljs-number">0.013</span>) / test = <span class="hljs-number">0.981</span>
MMS_ET: train = <span class="hljs-number">0.983</span> (<span class="hljs-number">0.010</span>) / test = <span class="hljs-number">0.981</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、「数字」データセットの分類問題を解決するための機械学習アルゴリズムのブリッツテストの結果によると、最も適切な機械学習アルゴリズムは、k最近傍（ 'KNN'）法、サポートベクトル法（ 'SVC'）およびエクストラツリーです。 （ 'ET'）。</font><font style="vertical-align: inherit;">これらのアルゴリズムは、計算の効率を高めることを目的とした結果のさらなる開発に、より注意を払う必要があります。</font><font style="vertical-align: inherit;">彼らが言うように、すべてが解決可能です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、この上げられたノートで、スムーズに第2部に進みます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">予測問題</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは親指に移動します：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#     </span>
<span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_boston
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LinearRegression
<span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> Ridge
<span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> Lasso
<span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> ElasticNet
<span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LarsCV
<span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> BayesianRidge
<span class="hljs-keyword">from</span> sklearn.neighbors <span class="hljs-keyword">import</span> KNeighborsRegressor
<span class="hljs-keyword">from</span> sklearn.tree <span class="hljs-keyword">import</span> DecisionTreeRegressor
<span class="hljs-keyword">from</span> sklearn.svm <span class="hljs-keyword">import</span> LinearSVR
<span class="hljs-keyword">from</span> sklearn.svm <span class="hljs-keyword">import</span> SVR
<span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> AdaBoostRegressor
<span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> BaggingRegressor
<span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> ExtraTreesRegressor
<span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> GradientBoostingRegressor
<span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> RandomForestRegressor
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> KFold
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> cross_val_score
<span class="hljs-keyword">from</span> sklearn.pipeline <span class="hljs-keyword">import</span> Pipeline
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> StandardScaler
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> Normalizer
<span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> pyplot<font></font>
<font></font>
<span class="hljs-comment">#   </span>
dataset = load_boston()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードを実行して辞書を処理します。</font><font style="vertical-align: inherit;">説明とキーは次のとおりです。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/1e2/80f/4e2/1e280f4e239b31bae42274ab21c42d29.png" alt="画像"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/24a/448/05a/24a44805af40951d544ef8cc6637c52a.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
変数</font><font style="vertical-align: inherit;">'data'を</font><font style="vertical-align: inherit;">変数</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に割り当て</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">変数</font><i><font style="vertical-align: inherit;">X</font></i><font style="vertical-align: inherit;">は、属性のセットを持つ多次元NumPy配列で、行数506行13列です。変数</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -'target'、各行にマーカーがある多次元NumPy配列です。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#   </span>
<span class="hljs-comment">#dataset = load_boston()</span><font></font>
X = dataset.data<font></font>
Y = dataset.target</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データセットをトレーニング部分とテスト部分に分割し、アルゴリズムを評価するためのパラメーターを構成します。</font><font style="vertical-align: inherit;">パラメータ 'scoring'で、回帰分析</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">従来の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">メトリック 'r2'の</font></a><font style="vertical-align: inherit;"> 1つを設定し</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#   </span><font></font>
dataset = load_boston()<font></font>
X = dataset.data<font></font>
Y = dataset.target<font></font>
<span class="hljs-comment">#        </span>
test_size = <span class="hljs-number">0.2</span>
seed = <span class="hljs-number">7</span><font></font>
X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=test_size, random_state=seed)<font></font>
<span class="hljs-comment">#    </span>
num_folds = <span class="hljs-number">10</span>
n_iter = <span class="hljs-number">1000</span>
n_estimators = <span class="hljs-number">100</span>
scoring = <span class="hljs-string">'r2'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
R2-決定係数-これは、問題のモデル（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンク</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">によって説明される従属変数の分散の割合です</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「定数を持つモデルの決定係数は、0から1までの値を取ります。係数が1に近いほど、依存性が強くなります。回帰モデルを評価する場合、これはモデルをデータと一致させると解釈されます。許容可能なモデルの場合、決定係数は少なくとも50％（この場合、多重相関係数はモジュロ70％を超える）であると想定されます。決定係数が80％を超えるモデルは非常に良いと見なすことができます（相関係数は90％を超えます）。決定係数が1に等しいということは、説明された変数が検討中のモデルによって正確に記述されていることを意味します」</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（同上）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
予測の問題を解決するために、次のアルゴリズムを使用します。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">線形アルゴリズム：</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -線形回帰/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">線形回帰</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ 'LR'）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -リッジ回帰（リッジ回帰）/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リッジ回帰</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ 'R'）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -投げ縄回帰（英語のLASSO-最小絶対収縮および選択演算子）/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">投げ縄回帰</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ 'L '）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -回帰法 "フレキシブルネットワーク»/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エラスティックネット回帰</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（' ELN '）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -最小角度/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最小角度回帰</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（LARS）（' LARS '）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -ベイジリッジ回帰/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベイジリッジ回帰</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（' BR '）</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非線形アルゴリズム：</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -k-nearest neighbor method（regression）/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k-nearest neighbors </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">regressor</font></a><font style="vertical-align: inherit;">（ ' </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">KNR</font></a><font style="vertical-align: inherit;"> '）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -木の回帰/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Decision Tree Regressor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ 'DTR'）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -線形サポートベクトル（回帰）/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">線形サポートベクターマシン-回帰</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> /（ ' LSVR '）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サポートベクター</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド（回帰）/ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">イプシロンサポートベクター回帰</font></a><font style="vertical-align: inherit;">（' SVR '）</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アンサンブルアルゴリズム：</font></font></h4><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-AdaBoost</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
 （回帰）/ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">AdaBoost Regressor</font></a><font style="vertical-align: inherit;">（ 'ABR'）（AdaBoost = Adaptive Boosting）</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">-Bagging</font></a><font style="vertical-align: inherit;">（</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 regression）/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagging Regressor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ 'BR'）（Bagging = Bootstrap aggregating）</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">-Extra</font></a></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
 trees（regression）/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Extra Trees Regressor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ 'ETR'）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -勾配ブースティング（回帰）/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">勾配ブースティングリグレッサ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ 'GBR'）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -ランダムフォレスト（回帰）/ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ランダムフォレスト分類子</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ 'RFR'）</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、「モデル」のリストには次のモデルが含まれます。</font></font><br>
<br>
<pre><code class="python hljs">models = []<font></font>
models.append((<span class="hljs-string">'LR'</span>, LinearRegression()))<font></font>
models.append((<span class="hljs-string">'R'</span>, Ridge()))<font></font>
models.append((<span class="hljs-string">'L'</span>, Lasso()))<font></font>
models.append((<span class="hljs-string">'ELN'</span>, ElasticNet()))<font></font>
models.append((<span class="hljs-string">'LARS'</span>, Lars()))<font></font>
models.append((<span class="hljs-string">'BR'</span>, BayesianRidge(n_iter=n_iter)))<font></font>
models.append((<span class="hljs-string">'KNR'</span>, KNeighborsRegressor()))<font></font>
models.append((<span class="hljs-string">'DTR'</span>, DecisionTreeRegressor()))<font></font>
models.append((<span class="hljs-string">'LSVR'</span>, LinearSVR()))<font></font>
models.append((<span class="hljs-string">'SVR'</span>, SVR()))<font></font>
models.append((<span class="hljs-string">'ABR'</span>, AdaBoostRegressor(n_estimators=n_estimators)))<font></font>
models.append((<span class="hljs-string">'BR'</span>, BaggingRegressor(n_estimators=n_estimators)))<font></font>
models.append((<span class="hljs-string">'ETR'</span>, ExtraTreesRegressor(n_estimators=n_estimators)))<font></font>
models.append((<span class="hljs-string">'GBR'</span>, GradientBoostingRegressor(n_estimators=n_estimators)))<font></font>
models.append((<span class="hljs-string">'RFR'</span>, RandomForestRegressor(n_estimators=n_estimators)))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
分類と同様に、各アルゴリズムの有効性の評価は交差検証を使用して行われます。</font><font style="vertical-align: inherit;">表示されるメッセージには、次の情報が含まれます。略称の形式でのモデルの名前、トレーニングデータの10倍交差検定の平均スコア（メトリック 'r2'）、標準偏差、およびテストデータの決定係数r2は、括弧内に表示されます。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#     </span><font></font>
scores = []<font></font>
names = []<font></font>
results = []<font></font>
predictions = []<font></font>
msg_row = []<font></font>
<span class="hljs-keyword">for</span> name, model <span class="hljs-keyword">in</span> models:<font></font>
    kfold = KFold(n_splits=num_folds, random_state=seed)<font></font>
    cv_results = cross_val_score(model, X_train, Y_train, cv=kfold, scoring=scoring)<font></font>
    names.append(name)<font></font>
    results.append(cv_results)<font></font>
    m_fit = model.fit(X_train, Y_train)<font></font>
    m_predict = model.predict(X_test)<font></font>
    predictions.append(m_predict)<font></font>
    m_score = model.score(X_test, Y_test)<font></font>
    scores.append(m_score)<font></font>
    msg = <span class="hljs-string">"%s: train = %.3f (%.3f) / test = %.3f"</span> % (name, cv_results.mean(), cv_results.std(), m_score)<font></font>
    msg_row.append(msg)<font></font>
    print(msg)<font></font>
<span class="hljs-comment">#   («  »)</span><font></font>
fig = pyplot.figure()<font></font>
fig.suptitle(<span class="hljs-string">'   '</span>)<font></font>
ax = fig.add_subplot(<span class="hljs-number">111</span>)<font></font>
red_square = dict(markerfacecolor=<span class="hljs-string">'r'</span>, marker=<span class="hljs-string">'s'</span>)<font></font>
pyplot.boxplot(results, flierprops=red_square)<font></font>
ax.set_xticklabels(names, rotation=<span class="hljs-number">45</span>)<font></font>
pyplot.show()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードを実行すると、次の結果が得られます。</font></font><br>
<br>
<pre><code class="python hljs">LR: train = <span class="hljs-number">0.746</span> (<span class="hljs-number">0.068</span>) / test = <span class="hljs-number">0.579</span>
R: train = <span class="hljs-number">0.744</span> (<span class="hljs-number">0.067</span>) / test = <span class="hljs-number">0.570</span>
L: train = <span class="hljs-number">0.689</span> (<span class="hljs-number">0.070</span>) / test = <span class="hljs-number">0.641</span>
ELN: train = <span class="hljs-number">0.677</span> (<span class="hljs-number">0.074</span>) / test = <span class="hljs-number">0.662</span>
LARS: train = <span class="hljs-number">0.744</span> (<span class="hljs-number">0.069</span>) / test = <span class="hljs-number">0.579</span>
BR: train = <span class="hljs-number">0.739</span> (<span class="hljs-number">0.069</span>) / test = <span class="hljs-number">0.571</span>
KNR: train = <span class="hljs-number">0.434</span> (<span class="hljs-number">0.288</span>) / test = <span class="hljs-number">0.538</span>
DTR: train = <span class="hljs-number">0.671</span> (<span class="hljs-number">0.145</span>) / test = <span class="hljs-number">0.637</span>
LSVR: train = <span class="hljs-number">0.550</span> (<span class="hljs-number">0.144</span>) / test = <span class="hljs-number">0.459</span>
SVR: train = <span class="hljs-number">-0.012</span> (<span class="hljs-number">0.048</span>) / test = <span class="hljs-number">-0.003</span>
ABR: train = <span class="hljs-number">0.810</span> (<span class="hljs-number">0.078</span>) / test = <span class="hljs-number">0.763</span>
BR: train = <span class="hljs-number">0.854</span> (<span class="hljs-number">0.064</span>) / test = <span class="hljs-number">0.805</span>
ETR: train = <span class="hljs-number">0.889</span> (<span class="hljs-number">0.047</span>) / test = <span class="hljs-number">0.836</span>
GBR: train = <span class="hljs-number">0.878</span> (<span class="hljs-number">0.042</span>) / test = <span class="hljs-number">0.863</span>
RFR: train = <span class="hljs-number">0.852</span> (<span class="hljs-number">0.068</span>) / test = <span class="hljs-number">0.819</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スパンチャート：</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/2a7/140/96c/2a714096c35498ccddc267298f502a6a.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
明白なリーダーは、アンサンブルメソッド 'GBR'（勾配 'ブースティング'）、 'ETR'（エクストラツリー）、 'RFR'（ランダムフォレスト）および 'BR'（ 'バギング'）です。</font></font><br>
<br>
<pre><code class="python hljs">GBR: train = <span class="hljs-number">0.878</span> (<span class="hljs-number">0.042</span>) / test = <span class="hljs-number">0.863</span>
ETR: train = <span class="hljs-number">0.889</span> (<span class="hljs-number">0.047</span>) / test = <span class="hljs-number">0.836</span>
RFR: train = <span class="hljs-number">0.852</span> (<span class="hljs-number">0.068</span>) / test = <span class="hljs-number">0.819</span>
BR: train = <span class="hljs-number">0.854</span> (<span class="hljs-number">0.064</span>) / test = <span class="hljs-number">0.805</span>
ABR: train = <span class="hljs-number">0.810</span> (<span class="hljs-number">0.078</span>) / test = <span class="hljs-number">0.763</span>
ELN: train = <span class="hljs-number">0.677</span> (<span class="hljs-number">0.074</span>) / test = <span class="hljs-number">0.662</span>
L: train = <span class="hljs-number">0.689</span> (<span class="hljs-number">0.070</span>) / test = <span class="hljs-number">0.641</span>
DTR: train = <span class="hljs-number">0.671</span> (<span class="hljs-number">0.145</span>) / test = <span class="hljs-number">0.637</span>
LR: train = <span class="hljs-number">0.746</span> (<span class="hljs-number">0.068</span>) / test = <span class="hljs-number">0.579</span>
LARS: train = <span class="hljs-number">0.744</span> (<span class="hljs-number">0.069</span>) / test = <span class="hljs-number">0.579</span>
BR: train = <span class="hljs-number">0.739</span> (<span class="hljs-number">0.069</span>) / test = <span class="hljs-number">0.571</span>
R: train = <span class="hljs-number">0.744</span> (<span class="hljs-number">0.067</span>) / test = <span class="hljs-number">0.570</span>
KNR: train = <span class="hljs-number">0.434</span> (<span class="hljs-number">0.288</span>) / test = <span class="hljs-number">0.538</span>
LSVR: train = <span class="hljs-number">0.550</span> (<span class="hljs-number">0.144</span>) / test = <span class="hljs-number">0.459</span>
SVR: train = <span class="hljs-number">-0.012</span> (<span class="hljs-number">0.048</span>) / test = <span class="hljs-number">-0.003</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「アバスト」、「ロスハラ」のようなものは遅れています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
おそらく、3人のリーダーが標準化と正規化を組み合わせています。</font><font style="vertical-align: inherit;">残りのコードを実行して調べてみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果は次のとおりです。</font></font><br>
<br>
<pre><code class="python hljs">SS_LR: train = <span class="hljs-number">0.746</span> (<span class="hljs-number">0.068</span>) / test = <span class="hljs-number">0.579</span>
SS_R: train = <span class="hljs-number">0.746</span> (<span class="hljs-number">0.068</span>) / test = <span class="hljs-number">0.578</span>
SS_L: train = <span class="hljs-number">0.678</span> (<span class="hljs-number">0.054</span>) / test = <span class="hljs-number">0.510</span>
SS_ELN: train = <span class="hljs-number">0.665</span> (<span class="hljs-number">0.060</span>) / test = <span class="hljs-number">0.513</span>
SS_LARS: train = <span class="hljs-number">0.744</span> (<span class="hljs-number">0.069</span>) / test = <span class="hljs-number">0.579</span>
SS_BR: train = <span class="hljs-number">0.746</span> (<span class="hljs-number">0.066</span>) / test = <span class="hljs-number">0.576</span>
SS_KNR: train = <span class="hljs-number">0.763</span> (<span class="hljs-number">0.098</span>) / test = <span class="hljs-number">0.739</span>
SS_DTR: train = <span class="hljs-number">0.610</span> (<span class="hljs-number">0.242</span>) / test = <span class="hljs-number">0.629</span>
SS_LSVR: train = <span class="hljs-number">0.727</span> (<span class="hljs-number">0.091</span>) / test = <span class="hljs-number">0.482</span>
SS_SVR: train = <span class="hljs-number">0.653</span> (<span class="hljs-number">0.126</span>) / test = <span class="hljs-number">0.610</span>
SS_ABR: train = <span class="hljs-number">0.811</span> (<span class="hljs-number">0.076</span>) / test = <span class="hljs-number">0.819</span>
SS_BR: train = <span class="hljs-number">0.853</span> (<span class="hljs-number">0.074</span>) / test = <span class="hljs-number">0.813</span>
SS_ETR: train = <span class="hljs-number">0.887</span> (<span class="hljs-number">0.048</span>) / test = <span class="hljs-number">0.846</span>
SS_GBR: train = <span class="hljs-number">0.878</span> (<span class="hljs-number">0.038</span>) / test = <span class="hljs-number">0.860</span>
SS_RFR: train = <span class="hljs-number">0.851</span> (<span class="hljs-number">0.071</span>) / test = <span class="hljs-number">0.818</span>
N_LR: train = <span class="hljs-number">0.751</span> (<span class="hljs-number">0.099</span>) / test = <span class="hljs-number">0.576</span>
N_R: train = <span class="hljs-number">0.287</span> (<span class="hljs-number">0.126</span>) / test = <span class="hljs-number">0.271</span>
N_L: train = <span class="hljs-number">-0.030</span> (<span class="hljs-number">0.032</span>) / test = <span class="hljs-number">-0.000</span>
N_ELN: train = <span class="hljs-number">-0.007</span> (<span class="hljs-number">0.030</span>) / test = <span class="hljs-number">0.023</span>
N_LARS: train = <span class="hljs-number">0.751</span> (<span class="hljs-number">0.099</span>) / test = <span class="hljs-number">0.576</span>
N_BR: train = <span class="hljs-number">0.744</span> (<span class="hljs-number">0.100</span>) / test = <span class="hljs-number">0.589</span>
N_KNR: train = <span class="hljs-number">0.485</span> (<span class="hljs-number">0.192</span>) / test = <span class="hljs-number">0.504</span>
N_DTR: train = <span class="hljs-number">0.729</span> (<span class="hljs-number">0.080</span>) / test = <span class="hljs-number">0.765</span>
N_LSVR: train = <span class="hljs-number">0.182</span> (<span class="hljs-number">0.108</span>) / test = <span class="hljs-number">0.136</span>
N_SVR: train = <span class="hljs-number">0.086</span> (<span class="hljs-number">0.076</span>) / test = <span class="hljs-number">0.084</span>
N_ABR: train = <span class="hljs-number">0.795</span> (<span class="hljs-number">0.053</span>) / test = <span class="hljs-number">0.752</span>
N_BR: train = <span class="hljs-number">0.854</span> (<span class="hljs-number">0.054</span>) / test = <span class="hljs-number">0.827</span>
N_ETR: train = <span class="hljs-number">0.877</span> (<span class="hljs-number">0.048</span>) / test = <span class="hljs-number">0.850</span>
N_GBR: train = <span class="hljs-number">0.852</span> (<span class="hljs-number">0.063</span>) / test = <span class="hljs-number">0.872</span>
N_RFR: train = <span class="hljs-number">0.852</span> (<span class="hljs-number">0.051</span>) / test = <span class="hljs-number">0.801</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、アンサンブルメソッドはまだ誰よりも優れています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「トップ5」には次の結果が含まれます。</font></font><br>
<br>
<pre><code class="python hljs">N_GBR: train = <span class="hljs-number">0.852</span> (<span class="hljs-number">0.063</span>) / test = <span class="hljs-number">0.872</span>
GBR: train = <span class="hljs-number">0.878</span> (<span class="hljs-number">0.042</span>) / test = <span class="hljs-number">0.863</span>
SS_GBR: train = <span class="hljs-number">0.878</span> (<span class="hljs-number">0.038</span>) / test = <span class="hljs-number">0.860</span>
N_ETR: train = <span class="hljs-number">0.877</span> (<span class="hljs-number">0.048</span>) / test = <span class="hljs-number">0.850</span>
SS_ETR: train = <span class="hljs-number">0.887</span> (<span class="hljs-number">0.048</span>) / test = <span class="hljs-number">0.846</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果を比較するグラフを表示します</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/8b1/9a0/cc6/8b19a0cc6379c2337c9082eedd415585.jpg" alt="画像"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。Y検定</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が標準です。</font><font style="vertical-align: inherit;">図に示されている5つの選択された結果は、破線で示されています。</font><font style="vertical-align: inherit;">すべてのピークが正確に繰り返されたか、またはある程度再現されたことがわかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トップ5に含まれるアルゴリズムの参照値と予測値の手動比較の短い抜粋：</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/711/0a7/2de/7110a72de1daa81209ecaee33542dfef.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、「ボストンハウスプライス」データセットの予測の問題を解決するための機械学習アルゴリズムの電撃テストの結果によると、勾配「ブースティング」（「GBR」が最も適切なアルゴリズムです） '）と追加のツリー（' ETR '）。</font><font style="vertical-align: inherit;">これらのアルゴリズムは、結果をさらに発展させ、予測の効果を高めるために、より注意を払う必要があります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あとがき</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
機械学習アルゴリズムのクイックチェックにより、最初の近似で、分類と回帰分析（予測）の問題を解決するための最も効果的なアルゴリズムを特定できます。これは、「数字」データセットを処理し、インスタンスを10クラスに見事に並べ替え、「ボストンハウスプライス」データセットを使って、依存関係を見つけ出し、従属変数の「変動する」予測を「驚くほど」並べ替えることで確信しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、独自のデータセットまたはGitHubを含むさまざまなリポジトリで掘り下げることができるデータセットでこのメソッドを試すこともできます。例：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ターゲットに適したデータセットを取得し、ブリッツテストのチームでその上にアルゴリズムの群を設定します。そして、そこに誰の見解があるかが明らかになります：フィールドの一人は戦士ではありません。 :)</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結論として。この記事の基礎は機械学習の分野の新しいプロジェクトごとに新しい同僚と共有する情報であるため、コメント、質問、提案に感謝します。それぞれに機械学習と人工ニューラルネットワークに関する独自の専門分野があり、その多くは単に「どこかで聞いた」ので、複雑で多面的で、ついに難攻不落について話すことが重要です（これはANNと機械学習全般についてです）。 :)、シンプルで理解しやすい言語;鍋を焼くのは神ではないことを示します。そして、興味があれば、ダース以上のアルゴリズムを「利用」することができます。 :) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS記事の終わりまでに、私はすでに自分自身を予測し始めたので、最初の図のチートシートをどこで入手したかについて次の質問をします。すべてが同じサイトscikit-learn.org（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「正しい見積もりを選択する」</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンク</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">そして、赤面したサモデキンの形の人工知能の擬人化は、私の幸せな子供時代の記憶の波からそうです。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja475542/index.html">2013年以降のメールマーケティングの変化：4つの主な傾向と現在の統計</a></li>
<li><a href="../ja475544/index.html">製品、サービスなどのカタログ</a></li>
<li><a href="../ja475546/index.html">中毒性の症候群IT</a></li>
<li><a href="../ja475548/index.html">不均衡とキューのない退屈なマッチメイキング：実用的なガイド</a></li>
<li><a href="../ja475550/index.html">オープンタイプの部屋のための音響システム</a></li>
<li><a href="../ja475554/index.html">時間を節約するユーザーインターフェイス設計手法</a></li>
<li><a href="../ja475556/index.html">ミュンヘンへの移転。アマゾンのScalorsアマゾンの夢の仕事へのパス</a></li>
<li><a href="../ja475558/index.html">IT辞書とは？どこ？どこ？パート1</a></li>
<li><a href="../ja475560/index.html">KotlinConf 2019ライブ：12月5〜6日にライブ観戦</a></li>
<li><a href="../ja475562/index.html">UnityのMVCとスクリプト可能なオブジェクト。パート1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>