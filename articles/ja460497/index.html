<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤖 💎 🧝🏾 マルコフ連鎖によるモンテカルロ法の直感的な使用 👩🏻‍✈️ 🦍 👧🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="易しいですか？私は試した
 データ開発のディレクターであり、NetologyのData Scienceの講師であるDomKlikで働いているAlexey Kuzminは、Rahul Agarwal による記事を、モンテカルロ法がマルコフチェーンと連携して大きな状態空間の問題を解決する方法について翻訳...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>マルコフ連鎖によるモンテカルロ法の直感的な使用</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/netologyru/blog/460497/"><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">易しいですか？</font><font style="vertical-align: inherit;">私は試した</font></font></h4><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ開発のディレクターであり、Netologyの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data Scienceの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">講師であるDomKlikで働いているAlexey Kuzminは、</font><font style="vertical-align: inherit;">Rahul Agarwal </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">による記事を、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モンテカルロ法がマルコフチェーンと連携して大きな状態空間の問題を解決する方法について</font><font style="vertical-align: inherit;">翻訳しまし</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">た</font></a><font style="vertical-align: inherit;">。</font></font></i><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データサイエンスに携わる誰もが、少なくとも一度は、マルコフチェーン（MCMC）を使用したモンテカルロ法について聞いたことがあります。</font><font style="vertical-align: inherit;">ベイジアン統計を研究するとき、時には預言者のようなツールを扱うとき、このトピックに触れます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、MCMCは理解するのが難しいです。</font><font style="vertical-align: inherit;">これらの方法について読むたびに、MCMCの本質が数学的ノイズの深い層に隠されていることに気づき、このノイズの背後を理解するのは困難です。</font><font style="vertical-align: inherit;">この概念を理解するのに何時間も費やさなければなりませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、マルコフ連鎖を使用したモンテカルロ法を説明する試みが利用できるので、それらが何に使用されるかが明らかになります。</font><font style="vertical-align: inherit;">次の投稿では、これらのメソッドを使用するいくつかの方法に焦点を当てます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それでは始めましょう。</font><font style="vertical-align: inherit;">MCMCは、モンテカルロチェーンとマルコフチェーンの2つの用語で構成されます。</font><font style="vertical-align: inherit;">それぞれについてお話しましょう。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モンテカルロ</font></font></h2><br>
<img src="https://habrastorage.org/webt/i8/wx/2n/i8wx2nylvemkcfvwp7rxvznjfa0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最も単純な用語では</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、モンテカルロ法</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は単純なシミュレーションとして定義できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モンテカルロメソッドは、モナコのモンテカルロカジノからその名前を得ました。</font><font style="vertical-align: inherit;">多くのカードゲームでは、ディーラーに勝つ確率を知る必要があります。</font><font style="vertical-align: inherit;">この確率の計算は、数学的に複雑な場合や、解決が難しい場合があります。</font><font style="vertical-align: inherit;">しかし、コンピュータシミュレーションを実行してゲーム全体を何度もプレイし、確率を勝利数をプレイしたゲーム数で割ったものと見なすことができます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モンテカルロ法について知っておくべきことはこれだけです。</font><font style="vertical-align: inherit;">はい、それは単なる派手な名前の単純なモデリング手法です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マルコフ連鎖</font></font></h2><br>
<img src="https://habrastorage.org/webt/7r/my/np/7rmynpvle1yn4xk5tuwqdvkd7mo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MCMCという用語は2つの部分で構成されるため、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マルコフチェーンとは</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">何かを理解する必要</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">があり</font></a><font style="vertical-align: inherit;">ます。しかし、マルコフ連鎖に移る前に、マルコフ特性について少し話しましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
M-可能な状態のシステムがあり、ある状態から別の状態に移動するとします。まだ何も混乱させないでください。このようなシステムの具体的な例は、暑さから寒さ、穏やかな気候に変わります。もう1つの例は株式市場で、弱気から強気で停滞した状態に移行しています。</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マルコフ特性</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">、特定の瞬間に</font><font style="vertical-align: inherit;">状態X </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n&nbsp; </font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">である特定の</font><font style="vertical-align: inherit;">プロセスについて</font><font style="vertical-align: inherit;">、確率X </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n + 1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= k（kはプロセスが移動できるM状態のいずれか）は、この状態が現時点で何であるかにのみ依存します。</font><font style="vertical-align: inherit;">どのようにして現在の状態に達したかは問題ではありません。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数学的言語では、これを次の式の形式で書くことができます</font></font><br>
<img src="https://habrastorage.org/webt/tw/kq/se/twkqseq2tra2alhiqdyfuyswnla.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。明確にするために、「強気」になるために市場が受け入れた一連の条件を気にする必要はありません。</font><font style="vertical-align: inherit;">次の状態が「弱気」になる確率は、市場が現在「強気」の状態にあるという事実によってのみ決定されます。</font><font style="vertical-align: inherit;">また、実際には意味があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Markovプロパティを持つプロセスは、Markovプロセスと呼ばれます。</font><font style="vertical-align: inherit;">マルコフ連鎖が重要なのはなぜですか？</font><font style="vertical-align: inherit;">その定常的な分布のため。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定常分布とは何ですか？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下の例で計算して定常分布を説明してみます。以下に示すように、株式市場のマルコフプロセスがあるとします。</font></font><br>
<img src="https://habrastorage.org/webt/1k/o-/bb/1ko-bbb9hzmv8j9o_an1ocvyurs.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
状態X </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">からX </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">への遷移の確率を決定する遷移確率行列があり</font><font style="vertical-align: inherit;">ます。</font></font><br>
<img src="https://habrastorage.org/webt/or/u7/jp/oru7jpnpioj12jbrcw7t4o6sk94.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
遷移確率の行列、Q </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与えられた遷移確率の行列Qでは、現在の状態が「ブル」= 0.9の場合、次の状態が「ブル」になる確率。現在の状態が「強気」の場合、次の状態が「弱気」になる確率= 0.075。等。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さて、特定の状態から始めましょう。私たちの状態は、ベクトル[ブル、クマ、停滞]によって設定されます。 「弱気」状態から始めると、ベクトルは次のようになります：[0,1,0]。現在の状態ベクトルに遷移確率行列を乗算することにより、次の状態の確率分布を計算できます。</font></font><br>
<img src="https://habrastorage.org/webt/or/jy/85/orjy85onzacwcu2wlgftmugzygk.png"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">確率は合計で1になることに注意してください。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
次の状態の分布は、式によって求めることができます</font></font><br>
<img src="https://habrastorage.org/webt/ge/wk/fu/gewkfuf7xziuajc2ox7tn9blfcm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。最終的に、状態が安定する定常状態に到達します。</font></font><br>
<img src="https://habrastorage.org/webt/iy/5y/65/iy5y65fxgxo4foqpe3fpq2hs-dq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記の遷移確率行列Qの場合、定常分布sは次のようになります。</font></font><br>
<img src="https://habrastorage.org/webt/ae/ut/_8/aeut_8m8wsypenpgkig3onnzwdc.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のコードを使用して定常分布を取得できます。</font></font><br>
<br>
<pre><code class="python hljs">Q = <font></font>
np.matrix([[<span class="hljs-number">0.9</span>,<span class="hljs-number">0.075</span>,<span class="hljs-number">0.025</span>],[<span class="hljs-number">0.15</span>,<span class="hljs-number">0.8</span>,<span class="hljs-number">0.05</span>],[<span class="hljs-number">0.25</span>,<span class="hljs-number">0.25</span>,<span class="hljs-number">0.5</span>]])<font></font>
init_s = np.matrix([[<span class="hljs-number">0</span>, <span class="hljs-number">1</span> , <span class="hljs-number">0</span>]])<font></font>
epsilon =<span class="hljs-number">1</span>
<span class="hljs-keyword">while</span> epsilon&gt;<span class="hljs-number">10e-9</span>:<font></font>
&nbsp;&nbsp;&nbsp;next_s = np.dot(init_s,Q)<font></font>
&nbsp;&nbsp;&nbsp;epsilon = np.sqrt(np.sum(np.square(next_s - init_s)))<font></font>
&nbsp;&nbsp;&nbsp;init_s = next_s<font></font>
print(init_s)<font></font>
------------------------------------------------------------------<font></font>
matrix([[<span class="hljs-number">0.62499998</span>, <span class="hljs-number">0.31250002</span>, <span class="hljs-number">0.0625</span>&nbsp; &nbsp; ]])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他の状態から始めることもできます—同じ定常分布を実現します。これを確認したい場合は、コードの初期状態を変更してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、定常分布がなぜそれほど重要であるかという質問に答えることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
定常分布は、システムがランダムに特定の状態にある確率を決定するために使用できるため、重要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例では、市場の62.5％が「強気」の状態、31.25％が「弱気」の状態、6.25％が停滞していると言えます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
直感的に、これはチェーンをランダムにさまよっているように見えます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/i3/e6/xt/i3e6xtqko2iip-janj6dvfbnv4q.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ランダムウォーク</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現在の状態を考慮して、特定の時点で次の状態を選択し、次の状態の確率分布を観察します。</font><font style="vertical-align: inherit;">これらのノードの確率に基づいて、他のノードよりも頻繁にいくつかのノードにアクセスできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それが、Googleがインターネットの黎明期に検索問題を解決した方法です。</font><font style="vertical-align: inherit;">問題は、ページの重要度に応じてページを並べ替えることでした。</font><font style="vertical-align: inherit;">GoogleはPagerankアルゴリズムを使用して問題を解決しました。</font><font style="vertical-align: inherit;">Google Pagerankアルゴリズムは、状態をページと見なし、定常分布におけるページの確率をその相対的重要性と見なす必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、MCMCメソッドの検討に直接移ります。&nbsp;</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マルコフ連鎖（MCMC）でのモンテカルロ法とは</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MCMCとは何かをお答えする前に、1つ質問させてください。ベータ分布について知っています。その確率密度関数を知っています。しかし、この分布からサンプルを取得できますか？これを行う方法を考え出すことができますか？</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ks/ai/wd/ksaiwdv7lomes7g55ihqbhxushs.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
考えてみてください... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MCMCは、確率分布から選択する機会を与えます。これは、事後分布から選択する必要がある場合に特に重要です。</font></font><br>
<img src="https://habrastorage.org/webt/12/kn/-5/12kn-58z9ub6t2ft1lctptwix28.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図はベイジアン定理を示しています</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、事後分布から標本を作成する必要があります。しかし、正規化定数（エビデンス）と共に事後成分を計算するのは簡単ですか？ほとんどの場合、それらは尤度と事前確率の積の形で見つけることができます。ただし、正規化定数（p（D））は計算できません。どうして？詳しく見てみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hが3つの値のみを取るとすると、</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
p（D）= p（H = H1）.p（D | H = H1）+ p（H = H2）.p（D | H = H2）+ p（H = H3 ）.p（D | H = H3）</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、p（D）は簡単に計算できます。しかし、Hの値が連続的である場合はどうでしょうか。特にHが無限大の値をとる場合、これを簡単に計算することは可能でしょうか？このためには、複雑な積分を解く必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
事後分布からランダムに選択する必要がありますが、p（D）を定数と見なしたいとします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ウィキペディア</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は書いています</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マルコフチェーンを使用したモンテカルロ法は、マルコフチェーンの構築に基づいて確率分布からサンプリングするアルゴリズムのクラスであり、定常分布として望ましい形式を持っています。一連のステップの後のチェーンの状態は、目的の分布からの選択として使用されます。サンプリング品質は、ステップ数が増えると向上します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例を見てみましょう。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベータ分布の</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サンプルが必要だとしましょう</font><font style="vertical-align: inherit;">。その密度：</font></font><br>
<img src="https://habrastorage.org/webt/ag/xh/wj/agxhwjqglfhcz2bl88eu3ov84ja.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cは正規化定数です。実際、これはαとβの関数ですが、ベータ分布のサンプルには必要ないことを示したいので、定数として扱います。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ベータ分布の問題は、ほとんど解決できないものではないにしても、本当に難しいものです。実際には、より複雑な分布関数を使用する必要があり、正規化定数がわからない場合があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MCMCメソッドは、一様分布（比較的単純）から選択できる場合、定常分布としてベータ分布を持つマルコフ連鎖を作成できるアルゴリズムを提供することにより、生活を容易にします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ランダムな状態から始めて、いくつかのアルゴリズムに基づいて次の状態に数回進むと、最終的にベータ分布が定常分布であるマルコフ連鎖が作成されます。</font><font style="vertical-align: inherit;">そして、私たちが長い間見つけた状態は、ベータ分布のサンプルとして使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのMCMCアルゴリズムの1つは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Metropolis-Hastingsアルゴリズムです。</font></font></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Metropolis-Hastingsアルゴリズム</font></font></h2><br>
<img src="https://habrastorage.org/webt/qq/oj/89/qqoj89il8-rsyd3xo-sqawnrug0.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">直感：</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それで、目的は何ですか？</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">直感的に、各場所で費やす時間量がその場所での表面の高さに比例するように、表面の一部（マルコフチェーン）に沿って歩きたいと思います（目的の場所から選択する確率密度）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、100メートルの高さの丘の頂上では、隣接する50メートルの丘の2倍の時間を費やしたいとします。サーフェス上のポイントの絶対的な高さがわからない場合でも、これを実行できるのは良いことです。知っておく必要があるのは、相対的な高さだけです。たとえば、丘Aの頂上が丘Bの頂上より2倍高い場合、AではBの2倍の時間を費やしたいとします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しい場所を提案するためのより複雑なスキームとその採用のルールがありますが、主な考え方は次のとおりです。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しい「推奨」場所を選択します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この場所が現在の場所と比較してどのくらい高いか、または低いかを確認します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">場所の高さに比例する確率で、その場所に留まるか、新しい場所に移動する。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MCMCの目的は、任意のポイントで正確な高さを知る必要なく（Cを知る必要がない）確率分布から選択することです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「さまよう」プロセスが正しく設定されている場合は、この時間（費やされた時間と分布の高さの間）の比例が達成されていることを確認できます</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アルゴリズム：</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、タスクをより正式な用語で定義して説明します。</font><font style="vertical-align: inherit;">s =（s1、s2、...、sM）を目的の定常分布とします。</font><font style="vertical-align: inherit;">このような定常分布を持つマルコフ連鎖を作成したいと考えています。</font><font style="vertical-align: inherit;">遷移行列Pを持つM状態の任意のマルコフ連鎖から始めます。そのため、pijは状態iからjへの遷移の確率を表します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
直感的に、マルコフチェーンをローミングする方法はわかっていますが、マルコフチェーンには必要な定常分布がありません。</font><font style="vertical-align: inherit;">このチェーンには、定常的な分布があります（これは必要ありません）。</font><font style="vertical-align: inherit;">私たちの目標は、マルコフチェーンのあちこちをさまよう方法を変更して、チェーンが望ましい定常分布を持つようにすることです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これをする：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ランダムな初期状態iから始めます。</font></font></li>
<li>     ,      i-    P.</li>
<li> ,    ,   : aij = min (sj.pji / si.pij, 1).</li>
<li>  ,        aij.   ,  ,      ,  —  ,      .<br>
</li>
<li>  .<br>
</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多数のテストの後、このチェーンは収束し、定常分布sになります。</font><font style="vertical-align: inherit;">次に、チェーンの状態を任意の分布のサンプルとして使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ベータ分布をサンプリングするためにこれを行うと、確率密度を使用する必要があるのは、意思決定の確率を検索するときだけです。</font><font style="vertical-align: inherit;">これを行うには、sjをsiで割ります（つまり、正規化定数Cはキャンセルされます）。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベータ選択</font></font></h3><br>
<img src="https://habrastorage.org/webt/h9/ac/zw/h9aczwarm4hfwm0pya3hai-rg2e.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、ベータ分布からのサンプリングの問題に移りましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ベータ分布は[0,1]の連続分布であり、[0,1]に無限の値を持つことができます。</font><font style="vertical-align: inherit;">[0,1]に無限状態がある任意のマルコフ連鎖Pに、pij = pji =行列内のすべての要素となる遷移行列Pがあるとします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
後で説明するように、行列Pは必要ありませんが、問題の説明を、提案したアルゴリズムにできるだけ近づけたいと思います。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（0,1）の一様分布から取得したランダムな初期状態iから始めます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">遷移行列Pのi番目の行の遷移確率を調べることにより、新しい想定状態をランダムに選択します。想定状態jとして別の状態Unif（0,1）を選択するとします。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">決定を行う確率と呼ばれる測定値を計算します。</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/lp/jo/-0/lpjo-0phzn3o8zl83oniptticmu.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは次のように単純化されます：</font></font><br>
<img src="https://habrastorage.org/webt/4c/he/pi/4chepi6_1om84fk52t8jquzpmku.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pji = pijなので、どこに</font></font><br>
<img src="https://habrastorage.org/webt/pm/qc/y2/pmqcy2hanok1y-mnhbxk49dqbve.png"><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コインを投げます。</font><font style="vertical-align: inherit;">確率でaijが落ちます。</font><font style="vertical-align: inherit;">ワシが落ちた場合、あなたは申し出を受け入れるべきです、すなわち、次の州に移ります。</font><font style="vertical-align: inherit;">それ以外の場合は、オファーを拒否する、つまり同じ状態を維持する価値があります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テストを何度も繰り返します。</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コード：</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
理論から実践に移る時です。</font><font style="vertical-align: inherit;">Pythonでベータサンプルを記述しましょう。</font></font><br>
<br>
<pre><code class="python hljs">impo<font></font>
rt<font></font>
rand<font></font>
om<font></font>
 <font></font>
 <font></font>
<span class="hljs-comment"># Lets define our Beta Function to generate s for any particular state. We don't care for the normalizing constant here.</span><font></font>
 <font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">beta_s</span>(<span class="hljs-params">w,a,b</span>):</span><font></font>
 <font></font>
	<span class="hljs-keyword">return</span> w**(a<span class="hljs-number">-1</span>)*(<span class="hljs-number">1</span>-w)**(b<span class="hljs-number">-1</span>)<font></font>
 <font></font>
 <font></font>
 <font></font>
 <font></font>
<span class="hljs-comment"># This Function returns True if the coin with probability P of heads comes heads when flipped.</span><font></font>
 <font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">random_coin</span>(<span class="hljs-params">p</span>):</span><font></font>
 <font></font>
	unif = random.uniform(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)<font></font>
 <font></font>
	<span class="hljs-keyword">if</span> unif&gt;=p:<font></font>
 <font></font>
    	<span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><font></font>
 <font></font>
	<span class="hljs-keyword">else</span>:<font></font>
 <font></font>
    	<span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><font></font>
 <font></font>
 <font></font>
 <font></font>
 <font></font>
<span class="hljs-comment"># This Function runs the MCMC chain for Beta Distribution.</span><font></font>
 <font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">beta_mcmc</span>(<span class="hljs-params">N_hops,a,b</span>):</span><font></font>
 <font></font>
	states = []<font></font>
 <font></font>
	cur = random.uniform(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)<font></font>
 <font></font>
	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,N_hops):<font></font>
 <font></font>
    	states.append(cur)<font></font>
 <font></font>
    	next = random.uniform(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)<font></font>
 <font></font>
    	ap = min(beta_s(next,a,b)/beta_s(cur,a,b),<span class="hljs-number">1</span>) <span class="hljs-comment"># Calculate the acceptance probability</span><font></font>
 <font></font>
    	<span class="hljs-keyword">if</span> random_coin(ap):<font></font>
 <font></font>
        	cur = next<font></font>
 <font></font>
	<span class="hljs-keyword">return</span> states[<span class="hljs-number">-1000</span>:] <span class="hljs-comment"># Returns the last 100 states of the chain</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果を実際のベータ分布と比較します。&nbsp;</font></font><br>
<br>
<pre><code class="python hljs">impo<font></font>
rt<font></font>
num<font></font>
py<font></font>
<span class="hljs-keyword">as</span><font></font>
np<font></font>
 <font></font>
 <font></font>
<span class="hljs-keyword">import</span> pylab <span class="hljs-keyword">as</span> pl<font></font>
 <font></font>
<span class="hljs-keyword">import</span> scipy.special <span class="hljs-keyword">as</span> ss<font></font>
 <font></font>
%matplotlib inline<font></font>
 <font></font>
pl.rcParams[<span class="hljs-string">'figure.figsize'</span>] = (<span class="hljs-number">17.0</span>, <span class="hljs-number">4.0</span>)<font></font>
 <font></font>
 <font></font>
 <font></font>
 <font></font>
<span class="hljs-comment"># Actual Beta PDF.</span><font></font>
 <font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">beta</span>(<span class="hljs-params">a, b, i</span>):</span><font></font>
 <font></font>
	e1 = ss.gamma(a + b)<font></font>
 <font></font>
	e2 = ss.gamma(a)<font></font>
 <font></font>
	e3 = ss.gamma(b)<font></font>
 <font></font>
	e4 = i ** (a - <span class="hljs-number">1</span>)<font></font>
 <font></font>
	e5 = (<span class="hljs-number">1</span> - i) ** (b - <span class="hljs-number">1</span>)<font></font>
 <font></font>
	<span class="hljs-keyword">return</span> (e1/(e2*e3)) * e4 * e5<font></font>
 <font></font>
 <font></font>
 <font></font>
 <font></font>
<span class="hljs-comment"># Create a function to plot Actual Beta PDF with the Beta Sampled from MCMC Chain.</span><font></font>
 <font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">plot_beta</span>(<span class="hljs-params">a, b</span>):</span><font></font>
 <font></font>
	Ly = []<font></font>
 <font></font>
	Lx = []<font></font>
 <font></font>
	i_list = np.mgrid[<span class="hljs-number">0</span>:<span class="hljs-number">1</span>:<span class="hljs-number">100j</span>]<font></font>
 <font></font>
	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> i_list:<font></font>
 <font></font>
    	Lx.append(i)<font></font>
 <font></font>
        Ly.append(beta(a, b, i))<font></font>
 <font></font>
    pl.plot(Lx, Ly, label=<span class="hljs-string">"Real Distribution: a="</span>+str(a)+<span class="hljs-string">", b="</span>+str(b))<font></font>
 <font></font>
    pl.hist(beta_mcmc(<span class="hljs-number">100000</span>,a,b),normed=<span class="hljs-literal">True</span>,bins =<span class="hljs-number">25</span>, histtype=<span class="hljs-string">'step'</span>,label=<span class="hljs-string">"Simulated_MCMC: a="</span>+str(a)+<span class="hljs-string">", b="</span>+str(b))<font></font>
 <font></font>
	pl.legend()<font></font>
 <font></font>
	pl.show()<font></font>
 <font></font>
	<font></font>
 <font></font>
plot_beta(<span class="hljs-number">0.1</span>, <span class="hljs-number">0.1</span>)<font></font>
 <font></font>
plot_beta(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<font></font>
 <font></font>
plot_beta(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
</code></pre><br>
<br>
<img src="https://habrastorage.org/webt/6z/b_/zb/6zb_zbywfexkiagddl4lpusmcko.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、値はベータ分布と非常によく似ています。</font><font style="vertical-align: inherit;">このように、MCMCネットワークが。定常状態に達した</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のコードでは、我々はベータサンプラーを作成したが、同じ概念が、我々は選択をしたいから、他のディストリビューションにも適用されます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">調査結果</font></font></h2><br>
<img src="https://habrastorage.org/webt/5f/oh/h5/5fohh5w_hsavzw3yvbryxewnnkw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それは素晴らしい投稿でした。</font><font style="vertical-align: inherit;">最後までお読みいただきありがとうございます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
本質的に、MCMCのメソッドは複雑になる可能性がありますが、それらは優れた柔軟性を提供します。</font><font style="vertical-align: inherit;">MCMCによる選択を使用して、任意の分布関数から選択できます。</font><font style="vertical-align: inherit;">通常、これらの方法は事後分布からサンプリングするために使用されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、MCMCを使用して、大きな状態空間の問題を解決することもできます。</font><font style="vertical-align: inherit;">たとえば、バックパックの問題や解読のために。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次の</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">投稿</font><font style="vertical-align: inherit;">で、より興味深い例を提供しようと思います</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">アップデートのために保管してください。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">編集者から</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オンラインコース« </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データを操作するためのPython</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オンラインコース「</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機械学習</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オンラインコース「</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BIG DATA fromゼロ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」</font></font></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja460485/index.html">オンライントーナメントが「来週のフィニッシュ」を思いとどまらせる方法</a></li>
<li><a href="../ja460489/index.html">BCPの開発におけるTOP 11の間違い</a></li>
<li><a href="../ja460491/index.html">Arduinoの温度および湿度センサーと送信およびプロット（パート1）</a></li>
<li><a href="../ja460493/index.html">80年代のPC用キラーアプリ：VisiCalcとWordStar</a></li>
<li><a href="../ja460495/index.html">コンテナーからパイプライン：OpenShift Container Platform 4のデフォルトがCRI-Oになりました</a></li>
<li><a href="../ja460499/index.html">ダイクストラ賞の3人の受賞者：Hydra 2019とSPTDC 2019はどうでしたか</a></li>
<li><a href="../ja460501/index.html">BuildBotを使用した継続的インテグレーションの実装例</a></li>
<li><a href="../ja460503/index.html">Raspberry PI 3 B +のワイヤレス構成</a></li>
<li><a href="../ja460505/index.html">3つの十字架を魅了する、またはプロジェクトが予定どおりに完了するのが難しい理由</a></li>
<li><a href="../ja460507/index.html">XENと自動車の将来：オープンソースハイパーバイザーが商用自動車ソリューションの競合相手になる方法</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>