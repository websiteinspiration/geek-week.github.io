<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüëß‚Äçüë¶ ‚ò¢Ô∏è ü§ö Managing Arduino Over the Internet with a PC - Beginner Experience üòØ üë®üèø‚Äçüè´ üë©üèª‚Äçüöí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello everyone. In this article I‚Äôll talk about how I managed to implement Arduino control over the Internet using an Internet-connected PC. In genera...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Managing Arduino Over the Internet with a PC - Beginner Experience</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/491616/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hello everyone. </font><font style="vertical-align: inherit;">In this article I‚Äôll talk about how I managed to implement Arduino control over the Internet using an Internet-connected PC. </font><font style="vertical-align: inherit;">In general, this method can be used for any microcontroller, for example, PIC. </font><font style="vertical-align: inherit;">The method is pretty oak, there is much to modernize and there are many more advanced schemes, but in the simplest case this is enough.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instead of joining</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I would like to say right away that in this article I will not go very deep into the intricacies of programming, it is assumed that the reader has at least minimal basics. </font><font style="vertical-align: inherit;">I‚Äôll tell you in general how resources were used and about interesting points. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Prerequisites for the creation of this method I had during the creation of my electric car: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zhmyak here! </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I must say right away that it was created more and more out of sports interest than for serious practical work, but nevertheless it works and can be useful to someone.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is the whole system built on and how is it implemented in hardware</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The working scheme is as follows: from the server we read the file in which the data is stored using the program running on the PC / laptop. This program via USB sends data to the controller. The controller receives data and performs actions on them. The scheme with the server is attractive in that you can control the scheme without an application, simply by going to the site from any smartphone / tablet / pc / laptop anywhere in the world where there is access to the Internet. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS. About the server side is described below.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In this article I will control the Arduino MEGA 2560 (the Chinese counterpart), but behind the scenes the circuit worked smoothly with the PIC16F877A, the only thing I had to use was the USB-TTL adapter: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yd/zx/7m/ydzx7myngxgoecwxi6t1gkzxtc4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It‚Äôs clear that the PIC program is slightly different from the Arduino program, due to different types of MK, but the principle is the same:</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We receive data through the COM port, compare them with the internal table of commands and perform the corresponding action. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The scheme initially seemed very simple to me, but there was one BUT - there was no program that would read the file on the Internet and send data to the COM port. Accordingly, I had to write such a program.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The program was written on VB6. To read the file from the server, the VB6 component is used: Microsoft Internet Transfer Control 6.0. With its help, a text file on the server is simply read into a string variable. After reading this line, it is sent to the COM port using the VB6 component: Microsoft Comm Control 6.0. The whole process of reading a file and sending a line is read in a loop using a timer. The timer interval can be changed in the program config, or directly during operation. In addition, you can select the mode of operation of the port, its number, the mode of operation of the Internet connection and a link to the readable file. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I would like to make a remark that with large file sizes and small gaps, the program freezes, but continues to work. My program's buffer size is 512 bytes. Given that my MK has less buffer, this is enough.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An important point. </font><font style="vertical-align: inherit;">A program in MK cannot parse data, it can read only which character was transmitted to the input via the serial port. </font><font style="vertical-align: inherit;">Without errors, I managed to accept the Latin alphabet (26 characters AZ and 10 digits 0-9). </font><font style="vertical-align: inherit;">A total of 36 teams, if the algorithm is finalized and data parsing is introduced into the MK, then any data can be transferred. </font><font style="vertical-align: inherit;">There is also the possibility of ‚Äúdoping‚Äù software for two-way data exchange.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Server selection and server side</font></font></h2><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For the server side, any server with PHP support</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , even if running on a personal PC, would only have a static IP, but I personally use a rented Jino. </font><font style="vertical-align: inherit;">The server part in my example consists of two files: HTML pages with a form with ON / OFF buttons for an LED and a PHP script that changes the contents of a TXT file from which a program running on a PC reads data.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Software</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HTML code </font><font style="vertical-align: inherit;">Form with 2 buttons, on / off LED on the board:</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span> <span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>  
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"work.php"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"post"</span>&gt;</span><font></font>
:<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"sv"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"On"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"sv"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Off"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>    
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>    
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PHP code, here we write the command A to the file, if the LED should be on, and B if it should go out:</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span>
$cm = fopen(<span class="hljs-string">"command.txt"</span>, <span class="hljs-string">"w"</span>);
<span class="hljs-keyword">switch</span> ($_POST[<span class="hljs-string">'sv'</span>]) {
<span class="hljs-keyword">case</span> <span class="hljs-string">"On"</span>:<font></font>
fwrite($cm,<span class="hljs-string">"a"</span>);    
    <span class="hljs-keyword">break</span>;   
<span class="hljs-keyword">case</span> <span class="hljs-string">"Off"</span>:<font></font>
fwrite($cm,<span class="hljs-string">"b"</span>);    
    <span class="hljs-keyword">break</span>;  <font></font>
}<font></font>
fclose($cm); <font></font>
<span class="hljs-meta">?&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now the actual code for Arduino:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">int</span> val; <span class="hljs-comment">//      </span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{<font></font>
Serial.begin(<span class="hljs-number">9600</span>); <span class="hljs-comment">//   </span>
pinMode(<span class="hljs-number">13</span>, OUTPUT); <span class="hljs-comment">//   13  </span><font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{
<span class="hljs-comment">// ,   - </span>
<span class="hljs-keyword">if</span> (Serial.available()) {<font></font>
val = Serial.read(); <span class="hljs-comment">//  val   </span>
<span class="hljs-keyword">if</span> (val == <span class="hljs-string">'a'</span>) {digitalWrite(<span class="hljs-number">13</span>, HIGH);} <span class="hljs-comment">//  a  </span>
<span class="hljs-keyword">if</span> (val == <span class="hljs-string">'b'</span>) {digitalWrite(<span class="hljs-number">13</span>, LOW);} <span class="hljs-comment">//  b  </span><font></font>
}}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The program itself for reading information on the server with forwarding to the COM port and its source code are in the archive at the link: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yandex-Disk The</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> program is compiled into several versions of the code, there may be some differences in operation, but it should not be. </font><font style="vertical-align: inherit;">At the first start of the EXE file, a help file and a config file are generated. </font><font style="vertical-align: inherit;">Data from this file is read when the program starts, if it exists. </font><font style="vertical-align: inherit;">If the file does not exist (for example, at the first start of the program), then the config-file is created with default values.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Work results</font></font></h2><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/in_3FCOodP4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instead of a conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this example, I implemented a simple ‚Äúoak‚Äù algorithm that works. </font><font style="vertical-align: inherit;">There is of course where to develop further, but nevertheless, 36 teams can already be sent in this form. </font><font style="vertical-align: inherit;">If you implement parsing of incoming data in the microcontroller, then you can transfer any data. </font><font style="vertical-align: inherit;">For my tasks 36 teams will be enough with the head, and besides, this is the experience of a beginner :)</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en491606/index.html">How to make a start menu and minimap</a></li>
<li><a href="../en491608/index.html">Animation Tips from Cuphead and God of War</a></li>
<li><a href="../en491610/index.html">Declarative data filtering at the front. Js / ts</a></li>
<li><a href="../en491612/index.html">Comparison of the dynamics of quotes of two stocks in python using the example of preferred and ordinary shares of Sberbank</a></li>
<li><a href="../en491614/index.html">Why Masterhost was doomed: an inside look</a></li>
<li><a href="../en491618/index.html">Why do ethnic and programming languages ‚Äã‚Äãdie out, and how do they help save them on social networks</a></li>
<li><a href="../en491620/index.html">What makes Cypress great for automation beginners?</a></li>
<li><a href="../en491622/index.html">Predict financial crises with Python</a></li>
<li><a href="../en491624/index.html">Creating an Outline Effect in Unity Universal Render Pipeline</a></li>
<li><a href="../en491628/index.html">Spelunky as an example of good game design</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>