<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöé ü§òüèº üë©üèº‚Äçüç≥ Zero, one, two, Freddy will pick you up üò¥ üîÆ ‚è≠Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Here is a continuation of a series of articles that can be entitled "horrors for programmers." This time we will talk about a typical typo pattern ass...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Zero, one, two, Freddy will pick you up</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/488332/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7df/971/1f1/7df9711f1099158d4c7b159f6a5502d5.png" alt="Picture 1"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here is a continuation of a series of articles that can be entitled "horrors for programmers." </font><font style="vertical-align: inherit;">This time we will talk about a typical typo pattern associated with the use of the numbers 0, 1, 2. It doesn‚Äôt matter if you write in C, C ++, C # or Java. </font><font style="vertical-align: inherit;">If you use constants 0, 1, 2, or if these numbers are contained in variable names, then, most likely, Freddy will visit you at night. </font><font style="vertical-align: inherit;">Read and do not say later that you were not warned.</font></font><br>
<a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introduction</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I continue a series of articles devoted to noticed patterns in how people make mistakes. </font><font style="vertical-align: inherit;">Previous publications:</font></font><ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Last line effect</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The most dangerous function in the world of C / C ++</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Evil lives in comparison functions</font></font></a></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This time the pattern was noticed not by me, but by my colleague Svyatoslav Razmyslov. He noted that he constantly </font><font style="vertical-align: inherit;">described </font><font style="vertical-align: inherit;">in his </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">articles</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> problems in which variables containing numbers 1 and 2 appear in his name. Svyatoslav suggested that I study this topic in more detail and it really turned out to be very fruitful. It turned out that our </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection of errors</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contains a large number of code fragments that are incorrect due to the fact that people get confused in the indices 0, 1, 2 or in the names of variables containing such numbers. A new interesting regularity is revealed, which will be discussed below. I am grateful to Svyatoslav for the prompt to investigate this topic and dedicate this article to him.</font></font><br>
<br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cfe/8e3/4c6/cfe8e34c69c04ef441c656ac32cdbbde.png" alt="Figure 14"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Svyatoslav Razmyslov, manager, attentive </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">bug </font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">catcher</font></font></a> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and just a talented person.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
What is the purpose of this article? Show how easy we all make mistakes and typos. If programmers are warned, they will be more attentive in the process of code reviews, focusing on the ill-fated 0, 1, 2. Also, programmers will be better able to feel the value of static code analyzers that help to notice such errors. It's not about PVS-Studio advertising (although it is also :). Until now, many programmers find static analysis superfluous, preferring to concentrate on their own accuracy and code reviews. Unfortunately, trying to write code without errors is good, but not enough. This article will once again demonstrate this clearly.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No one is immune from such errors. </font><font style="vertical-align: inherit;">Below you will see epic bloopers in even such well-known projects as Qt, Clang, Hive, LibreOffice, Linux Kernel, .NET Compiler Platform, XNU kernel, Mozilla Firefox. </font><font style="vertical-align: inherit;">And these are not some exotic rare errors, but the most frequent ones. </font><font style="vertical-align: inherit;">Not convinced? </font><font style="vertical-align: inherit;">Then let's get started! </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúChatter is worthless! </font><font style="vertical-align: inherit;">Show me the bugs! ‚Äù </font></font></i><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬© modified quote by Linus Torvalds.</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Typos in constants when indexing arrays</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a rule, in our articles we give warnings with the help of which errors are found. </font><font style="vertical-align: inherit;">This time I will omit these warnings, as without them the error will be easily noticeable and understandable. </font><font style="vertical-align: inherit;">However, although these errors are immediately evident in a short piece of code, they know how to hide in the code of projects. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's start with the mistakes when there is confusion with the numeric literals used to index arrays. </font><font style="vertical-align: inherit;">Despite the banality of these errors, there are many of them and they are not revealed in the laboratory work of students. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XNU kernel project, C language</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">uint32_t</span>
<span class="hljs-title">gss_krb5_3des_unwrap_mbuf</span><span class="hljs-params">(....)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">for</span> (cflag = <span class="hljs-number">1</span>; cflag &gt;= <span class="hljs-number">0</span>; cflag--) {<font></font>
    *minor = gss_krb5_3des_token_get(<font></font>
       ctx, &amp;itoken, wrap, &amp;hash, &amp;offset, &amp;length, reverse);<font></font>
    <span class="hljs-keyword">if</span> (*minor == <span class="hljs-number">0</span>)
      <span class="hljs-keyword">break</span>;<font></font>
    wrap.Seal_Alg[<span class="hljs-number">0</span>] = <span class="hljs-number">0xff</span>;<font></font>
    wrap.Seal_Alg[<span class="hljs-number">0</span>] = <span class="hljs-number">0xff</span>;<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The line was copied, but forgot to correct the index. </font><font style="vertical-align: inherit;">As I understand it, it should be written here:</font></font><br>
<pre><code class="cpp hljs">wrap.Seal_Alg[<span class="hljs-number">0</span>] = <span class="hljs-number">0xff</span>;<font></font>
wrap.Seal_Alg[<span class="hljs-number">1</span>] = <span class="hljs-number">0xff</span>;</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LibreOffice Project, C ++</font></font></b><br>
<pre><code class="cpp hljs">Sequence&lt; OUString &gt; FirebirdDriver::<font></font>
  getSupportedServiceNames_Static() <span class="hljs-keyword">throw</span> (RuntimeException)<font></font>
{<font></font>
  Sequence&lt; OUString &gt; aSNS( <span class="hljs-number">2</span> );<font></font>
  aSNS[<span class="hljs-number">0</span>] = <span class="hljs-string">"com.sun.star.sdbc.Driver"</span>;<font></font>
  aSNS[<span class="hljs-number">0</span>] = <span class="hljs-string">"com.sun.star.sdbcx.Driver"</span>;
  <span class="hljs-keyword">return</span> aSNS;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As in the previous case, the line was copied, but forgot to fix 0 by 1. Only the string literal was corrected. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One may ask a philosophical question, how can one make such a mistake in a four-line function? </font><font style="vertical-align: inherit;">All is possible. </font><font style="vertical-align: inherit;">Here it is, programming. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quake-III-Arena Project, C language</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">VL_FindAdjacentSurface</span><span class="hljs-params">(....)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">fabs</span>(dir[<span class="hljs-number">0</span>]) &gt; test-&gt;radius ||
      <span class="hljs-built_in">fabs</span>(dir[<span class="hljs-number">1</span>]) &gt; test-&gt;radius ||
      <span class="hljs-built_in">fabs</span>(dir[<span class="hljs-number">1</span>]) &gt; test-&gt;radius)<font></font>
  {<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the copied line, they forgot to replace </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dir [1]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dir [2]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">As a result, the value along the Z axis is not controlled. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCOLLADA Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">short2</span>
{</span>
  <span class="hljs-keyword">short</span> values[<span class="hljs-number">2</span>];<font></font>
  short2(<span class="hljs-keyword">short</span> s1, <span class="hljs-keyword">short</span> s2)<font></font>
  {<font></font>
    values[<span class="hljs-number">0</span>] = s1;<font></font>
    values[<span class="hljs-number">2</span>] = s2;<font></font>
  }<font></font>
  ....<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yes, even in such a short constructor, you can manage to go beyond the boundary of an array when it is initialized.</font></font><br>
<br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/557/e77/ddb/557e77ddb32df5ca3554597d92ffcb49.png" alt="Figure 8"></div><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Godot Engine Project, C ++</font></font></b><br>
<pre><code class="cpp hljs">Array PhysicsDirectSpaceState::_cast_motion(....)<font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-function">Array <span class="hljs-title">ret</span><span class="hljs-params">(<span class="hljs-literal">true</span>)</span></span>;<font></font>
  ret.resize(<span class="hljs-number">2</span>);<font></font>
  ret[<span class="hljs-number">0</span>]=closest_safe;<font></font>
  ret[<span class="hljs-number">0</span>]=closest_unsafe;
  <span class="hljs-keyword">return</span> ret;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No comment required. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Asterisk project, C language</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">sip_threadinfo_destructor</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *obj)</span>
</span>{
  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sip_threadinfo</span> *<span class="hljs-title">th</span> = <span class="hljs-title">obj</span>;</span>
  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">tcptls_packet</span> *<span class="hljs-title">packet</span>;</span><font></font>
<font></font>
  <span class="hljs-keyword">if</span> (th-&gt;alert_pipe[<span class="hljs-number">1</span>] &gt; <span class="hljs-number">-1</span>) {            <span class="hljs-comment">// &lt;=</span>
    close(th-&gt;alert_pipe[<span class="hljs-number">0</span>]);<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (th-&gt;alert_pipe[<span class="hljs-number">1</span>] &gt; <span class="hljs-number">-1</span>) {<font></font>
    close(th-&gt;alert_pipe[<span class="hljs-number">1</span>]);<font></font>
  }<font></font>
  th-&gt;alert_pipe[<span class="hljs-number">0</span>] = th-&gt;alert_pipe[<span class="hljs-number">1</span>] = <span class="hljs-number">-1</span>;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When writing the same type of blocks, the error, as a rule, is located in the underlying one. </font><font style="vertical-align: inherit;">Prior to this, all the cases considered were just that. </font><font style="vertical-align: inherit;">Here the typo is in an unusual place, namely, in the first block. </font><font style="vertical-align: inherit;">Why it happened is hard to say. </font><font style="vertical-align: inherit;">I have no choice but to bring a picture of a unicorn shrugging:</font></font><br>
<br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/071/1f3/dd7/0711f3dd70bf461e3105765a0862ea30.png" alt="Figure 9"></div><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Open CASCADE Technology Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Prepend</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Standard_Integer theIndex)</span>
</span>{
  <span class="hljs-keyword">if</span> (myIndex[<span class="hljs-number">1</span>] &gt;= <span class="hljs-number">0</span>)<font></font>
    Standard_OutOfRange::Raise (<span class="hljs-string">"BRepMesh_PairOfIndex...."</span>);<font></font>
<font></font>
  myIndex[<span class="hljs-number">1</span>] = myIndex[<span class="hljs-number">0</span>];<font></font>
  myIndex[<span class="hljs-number">1</span>] = theIndex;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Two times in the same cell of the array, different values ‚Äã‚Äãare copied. </font><font style="vertical-align: inherit;">An obvious error, but how to fix it was not clear to me, since the project code is not familiar to me. </font><font style="vertical-align: inherit;">So I just looked at how the developers corrected the code after our team pointed out this error to them. </font><font style="vertical-align: inherit;">The correct option:</font></font><br>
<pre><code class="cpp hljs">myIndex[<span class="hljs-number">1</span>] = myIndex[<span class="hljs-number">0</span>];<font></font>
myIndex[<span class="hljs-number">0</span>] = theIndex;</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trans-Proteomic Pipeline Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ASAPRatio_getProDataStrct</span><span class="hljs-params">(proDataStrct *data,
                               <span class="hljs-keyword">char</span> **pepBofFiles)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (data-&gt;indx == <span class="hljs-number">-1</span>) {<font></font>
    data-&gt;ratio[<span class="hljs-number">0</span>] = <span class="hljs-number">-2.</span>;<font></font>
    data-&gt;ratio[<span class="hljs-number">0</span>] = <span class="hljs-number">0.</span>;             <span class="hljs-comment">// &lt;=</span>
    data-&gt;inv_ratio[<span class="hljs-number">0</span>] = <span class="hljs-number">-2.</span>;<font></font>
    data-&gt;inv_ratio[<span class="hljs-number">1</span>] = <span class="hljs-number">0.</span>;
    <span class="hljs-keyword">return</span>;<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I worry that research packages contain such errors. </font><font style="vertical-align: inherit;">Trans-Proteomic Pipeline is designed to solve problems in the field of biology. </font><font style="vertical-align: inherit;">This can be decided and "investigated." </font><font style="vertical-align: inherit;">This package generally find a lot of interesting things: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">check in 2012</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">check 2013</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Perhaps you can again try to look at this project. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ITK project, C ++ language</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
We are faced with another project for conducting research in the field of medicine: Medicine Insight Segmentation and Registration Toolkit (ITK). </font><font style="vertical-align: inherit;">The project is different, but the mistakes are the same.</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">template</span>&lt; <span class="hljs-keyword">typename</span> TCoordRepType &gt;
<span class="hljs-keyword">void</span><font></font>
VoronoiDiagram2D&lt; TCoordRepType &gt;::SetOrigin(PointType vorsize)<font></font>
{<font></font>
  m_VoronoiBoundaryOrigin[<span class="hljs-number">0</span>] = vorsize[<span class="hljs-number">0</span>];<font></font>
  m_VoronoiBoundaryOrigin[<span class="hljs-number">0</span>] = vorsize[<span class="hljs-number">1</span>];<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ITK Project, C ++</font></font></b><br>
<br>
<pre><code class="cpp hljs">
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">itkPointSetToSpatialObjectDemonsRegistrationTest</span><span class="hljs-params">(....)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-comment">// Set its position</span><font></font>
  EllipseType::TransformType::OffsetType offset;<font></font>
  offset[<span class="hljs-number">0</span>]=<span class="hljs-number">50</span>;<font></font>
  offset[<span class="hljs-number">1</span>]=<span class="hljs-number">50</span>;<font></font>
  offset[<span class="hljs-number">1</span>]=<span class="hljs-number">50</span>;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Clean Copy-Paste. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReactOS Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function">HPALETTE <span class="hljs-title">CardWindow::CreateCardPalette</span><span class="hljs-params">()</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-comment">//include button text colours</span>
  cols[<span class="hljs-number">0</span>] = RGB(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<font></font>
  cols[<span class="hljs-number">1</span>] = RGB(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>);<font></font>
<font></font>
  <span class="hljs-comment">//include the base background colour</span>
  cols[<span class="hljs-number">1</span>] = crBackgnd;<font></font>
<font></font>
  <span class="hljs-comment">//include the standard button colours...</span>
  cols[<span class="hljs-number">3</span>] = CardButton::GetHighlight(crBackgnd);<font></font>
  cols[<span class="hljs-number">4</span>] = CardButton::GetShadow(crBackgnd);<font></font>
  cols[<span class="hljs-number">5</span>] = CardButton::GetFace(crBackgnd);<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Most likely, the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">crBackgnd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> constant </font><font style="vertical-align: inherit;">should be written to the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cols</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cell </font><i><font style="vertical-align: inherit;">[2]</font></i><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Coin3D Project, C ++</font></font></b><br>
<pre><code class="cpp hljs">SoVRMLInline::GLRender(SoGLRenderAction * action)<font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> ((size[<span class="hljs-number">0</span>] &gt;= <span class="hljs-number">0.0f</span> &amp;&amp; size[<span class="hljs-number">1</span>] &gt;= <span class="hljs-number">0.0f</span> &amp;&amp; size[<span class="hljs-number">1</span>] &gt;= <span class="hljs-number">0.0f</span>) &amp;&amp;<font></font>
      ((vis == ALWAYS) ||<font></font>
       (vis == UNTIL_LOADED &amp;&amp; child == <span class="hljs-literal">NULL</span>))) {<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The element of the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">size [1]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> array is double checked </font><font style="vertical-align: inherit;">, and the element of </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">size [2] is</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> not checked. </font><font style="vertical-align: inherit;">This is how strange artifacts appear on images. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCV Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">Jpeg2KDecoder::readHeader</span><span class="hljs-params">()</span>
</span>{<font></font>
  ....<font></font>
  cmptlut[<span class="hljs-number">0</span>] = ....<font></font>
  cmptlut[<span class="hljs-number">1</span>] = ....<font></font>
  cmptlut[<span class="hljs-number">2</span>] = ....
  <span class="hljs-keyword">if</span>( cmptlut[<span class="hljs-number">0</span>] &lt; <span class="hljs-number">0</span> || cmptlut[<span class="hljs-number">1</span>] &lt; <span class="hljs-number">0</span> || cmptlut[<span class="hljs-number">0</span>] &lt; <span class="hljs-number">0</span> )<font></font>
    result = <span class="hljs-literal">false</span>;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is directly felt that the expression </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cmptlut [0] &lt;0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> was duplicated twice by copying, but corrected zero in only one place. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visualization Toolkit (VTK) Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">vtkImageStencilRaster::PrepareForNewData</span><span class="hljs-params">(....)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (allocateExtent &amp;&amp;<font></font>
      allocateExtent[<span class="hljs-number">1</span>] &gt;= allocateExtent[<span class="hljs-number">1</span>])<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hereinafter, I will not comment on many such errors. </font><font style="vertical-align: inherit;">What is there to comment on? </font><font style="vertical-align: inherit;">The main thing when looking at such code fragments is to feel that although the error is simple, this does not mean that it will be noticed by the programmer. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visualization Toolkit (VTK) Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">template</span> &lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">iterT</span>&gt;
<span class="hljs-title">void</span> <span class="hljs-title">vtkDataSetAttributesCopyValues</span>(....)
{</span><font></font>
  ....<font></font>
  inZPtr +=<font></font>
    (outExt[<span class="hljs-number">0</span>] - outExt[<span class="hljs-number">0</span>])*inIncs[<span class="hljs-number">0</span>] * data_type_size +<font></font>
    (outExt[<span class="hljs-number">2</span>] - outExt[<span class="hljs-number">2</span>])*inIncs[<span class="hljs-number">1</span>] * data_type_size +<font></font>
    (outExt[<span class="hljs-number">4</span>] - outExt[<span class="hljs-number">4</span>])*inIncs[<span class="hljs-number">2</span>] * data_type_size;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here, the programmer was clearly in a hurry to write code faster. </font><font style="vertical-align: inherit;">It is difficult to explain in another way how he made a mistake three times. </font><font style="vertical-align: inherit;">Elements of the array are subtracted from themselves. </font><font style="vertical-align: inherit;">The result is that this code is equivalent:</font></font><br>
<pre><code class="cpp hljs">inZPtr +=<font></font>
  (<span class="hljs-number">0</span>)*inIncs[<span class="hljs-number">0</span>] * data_type_size +<font></font>
  (<span class="hljs-number">0</span>)*inIncs[<span class="hljs-number">1</span>] * data_type_size +<font></font>
  (<span class="hljs-number">0</span>)*inIncs[<span class="hljs-number">2</span>] * data_type_size;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, this code can be reduced even further:</font></font><br>
<pre><code class="cpp hljs">inZPtr += <span class="hljs-number">0</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sumptuously. </font><font style="vertical-align: inherit;">There is a long, serious looking expression in the code that, in fact, does nothing. </font><font style="vertical-align: inherit;">I love such cases. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visualization Toolkit (VTK) project, C ++ language</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
A similar case of hasty writing code.</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">vtkPiecewiseControlPointsItem::SetControlPoint</span><span class="hljs-params">(
  vtkIdType index, <span class="hljs-keyword">double</span>* newPos)</span>
</span>{
  <span class="hljs-keyword">double</span> oldPos[<span class="hljs-number">4</span>];
  <span class="hljs-keyword">this</span>-&gt;PiecewiseFunction-&gt;GetNodeValue(index, oldPos);
  <span class="hljs-keyword">if</span> (newPos[<span class="hljs-number">0</span>] != oldPos[<span class="hljs-number">0</span>] || newPos[<span class="hljs-number">1</span>] != oldPos[<span class="hljs-number">1</span>] ||<font></font>
      newPos[<span class="hljs-number">2</span>] != oldPos[<span class="hljs-number">2</span>] || newPos[<span class="hljs-number">2</span>] != oldPos[<span class="hljs-number">2</span>])<font></font>
    {<font></font>
      <span class="hljs-keyword">this</span>-&gt;PiecewiseFunction-&gt;SetNodeValue(index, newPos);<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The comparison </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">newPos [2]! = OldPos [2] is</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> repeated twice </font><font style="vertical-align: inherit;">. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ADAPTIVE Communication Environment (ACE) Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">URL_Base::strip_scheme</span> <span class="hljs-params">(ACE_CString&amp; url_string)</span>
</span>{<font></font>
  ....<font></font>
  ACE_CString::size_type pos = url_string.find (<span class="hljs-string">':'</span>);
  <span class="hljs-keyword">if</span> (pos &gt; <span class="hljs-number">0</span> &amp;&amp;<font></font>
      url_string[pos+<span class="hljs-number">1</span>] == <span class="hljs-string">'/'</span> &amp;&amp;<font></font>
      url_string[pos+<span class="hljs-number">1</span>] == <span class="hljs-string">'/'</span>)<font></font>
  {<font></font>
    ....<font></font>
    <span class="hljs-comment">// skip '&lt;protocol&gt;://'</span>
    url_string = url_string.substr (pos+<span class="hljs-number">3</span>);<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The condition must verify that two slashes after the colon are encountered. </font><font style="vertical-align: inherit;">In other words, the substring ": //" is searched. </font><font style="vertical-align: inherit;">Due to a typo, the check is "blind" and is ready to count any character as a second slash. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IPP Samples Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">MeBase::MakeVlcTableDecision</span><span class="hljs-params">()</span>
</span>{<font></font>
  ....<font></font>
  Ipp32s BestMV =<font></font>
    IPP_MIN(IPP_MIN(m_cur.MvRate[<span class="hljs-number">0</span>],m_cur.MvRate[<span class="hljs-number">1</span>]),<font></font>
                    IPP_MIN(m_cur.MvRate[<span class="hljs-number">2</span>],m_cur.MvRate[<span class="hljs-number">3</span>]));<font></font>
  Ipp32s BestAC =<font></font>
    IPP_MIN(IPP_MIN(m_cur.AcRate[<span class="hljs-number">0</span>],m_cur.AcRate[<span class="hljs-number">1</span>]),<font></font>
                    IPP_MIN(m_cur.AcRate[<span class="hljs-number">2</span>],m_cur.AcRate[<span class="hljs-number">2</span>]));<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A typo lies here, in the arguments passed to the macro:</font></font><br>
<pre><code class="cpp hljs">IPP_MIN(m_cur.AcRate[<span class="hljs-number">2</span>],m_cur.AcRate[<span class="hljs-number">2</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It turns out that a minimum of two identical values ‚Äã‚Äãis selected. </font><font style="vertical-align: inherit;">In fact, it should be written:</font></font><br>
<pre><code class="cpp hljs">IPP_MIN(m_cur.AcRate[<span class="hljs-number">2</span>],m_cur.AcRate[<span class="hljs-number">3</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By the way, this code can demonstrate the usefulness of the standard library. </font><font style="vertical-align: inherit;">If you write like this:</font></font><br>
<pre><code class="cpp hljs">Ipp32s BestMV = <span class="hljs-built_in">std</span>::min_element(begin(m_cur.MvRate), end(m_cur.MvRate));<font></font>
Ipp32s BestAC = <span class="hljs-built_in">std</span>::min_element(begin(m_cur.AcRate), end(m_cur.AcRate));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
That code will become shorter and less prone to errors. </font><font style="vertical-align: inherit;">Actually, the less the same type of code, the more likely it will be written correctly. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Project Audacity, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function">sampleCount <span class="hljs-title">VoiceKey::OnBackward</span> <span class="hljs-params">(....)</span> </span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">int</span> atrend = sgn(buffer[samplesleft - <span class="hljs-number">2</span>]-<font></font>
                   buffer[samplesleft - <span class="hljs-number">1</span>]);
  <span class="hljs-keyword">int</span> ztrend = sgn(buffer[samplesleft - WindowSizeInt<span class="hljs-number">-2</span>]-<font></font>
                   buffer[samplesleft - WindowSizeInt<span class="hljs-number">-2</span>]);<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The correct expression is:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">int</span> ztrend = sgn(buffer[samplesleft - WindowSizeInt<span class="hljs-number">-2</span>]-<font></font>
                 buffer[samplesleft - WindowSizeInt<span class="hljs-number">-1</span>]);</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PDFium project, C ++ language</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sycc420_to_rgb</span><span class="hljs-params">(<span class="hljs-keyword">opj_image_t</span>* img)</span> </span>{<font></font>
  ....<font></font>
  opj_image_data_free(img-&gt;comps[<span class="hljs-number">0</span>].data);<font></font>
  opj_image_data_free(img-&gt;comps[<span class="hljs-number">1</span>].data);<font></font>
  opj_image_data_free(img-&gt;comps[<span class="hljs-number">2</span>].data);<font></font>
  img-&gt;comps[<span class="hljs-number">0</span>].data = d0;<font></font>
  img-&gt;comps[<span class="hljs-number">1</span>].data = d1;<font></font>
  img-&gt;comps[<span class="hljs-number">2</span>].data = d2;<font></font>
  img-&gt;comps[<span class="hljs-number">1</span>].w = yw;                 <span class="hljs-comment">// 1</span>
  img-&gt;comps[<span class="hljs-number">1</span>].h = yh;                 <span class="hljs-comment">// 1</span>
  img-&gt;comps[<span class="hljs-number">2</span>].w = yw;                 <span class="hljs-comment">// 1</span>
  img-&gt;comps[<span class="hljs-number">2</span>].h = yh;                 <span class="hljs-comment">// 1</span>
  img-&gt;comps[<span class="hljs-number">1</span>].w = yw;                 <span class="hljs-comment">// 2</span>
  img-&gt;comps[<span class="hljs-number">1</span>].h = yh;                 <span class="hljs-comment">// 2</span>
  img-&gt;comps[<span class="hljs-number">2</span>].w = yw;                 <span class="hljs-comment">// 2</span>
  img-&gt;comps[<span class="hljs-number">2</span>].h = yh;                 <span class="hljs-comment">// 2</span>
  img-&gt;comps[<span class="hljs-number">1</span>].dx = img-&gt;comps[<span class="hljs-number">0</span>].dx;<font></font>
  img-&gt;comps[<span class="hljs-number">2</span>].dx = img-&gt;comps[<span class="hljs-number">0</span>].dx;<font></font>
  img-&gt;comps[<span class="hljs-number">1</span>].dy = img-&gt;comps[<span class="hljs-number">0</span>].dy;<font></font>
  img-&gt;comps[<span class="hljs-number">2</span>].dy = img-&gt;comps[<span class="hljs-number">0</span>].dy;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A series of actions to initialize the structure are duplicated. Those lines marked with comment </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">// 2</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> can be deleted, and nothing will change. I doubted whether to include this piece of code in the article. This is not quite a mistake, and not quite with the indices. However, this extra code most likely appeared precisely because the programmer got confused in all these class members and indices 1, 2. So, I think this piece of code is suitable for demonstrating how easy it is to get confused in numbers. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CMake project, C</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
The code discussed below was not written by the CMake developers, but was borrowed. Judging by the comment at the beginning of the file, the </font><i><font style="vertical-align: inherit;">utf8_encode</font></i><font style="vertical-align: inherit;"> function</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It was written by Tim Kientzle back in 2007. Since then, this function has been wandering from project to project, and there are a lot of them. </font><font style="vertical-align: inherit;">I did not study the issue of the original source, since this is not the point now. </font><font style="vertical-align: inherit;">Since this code is in the CMake project, then the error applies to CMake.</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">char</span> *
<span class="hljs-title">utf8_encode</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">wchar_t</span> *wval)</span>
</span>{<font></font>
  ....<font></font>
  p[<span class="hljs-number">0</span>] = <span class="hljs-number">0xfc</span> | ((wc &gt;&gt; <span class="hljs-number">30</span>) &amp; <span class="hljs-number">0x01</span>);<font></font>
  p[<span class="hljs-number">1</span>] = <span class="hljs-number">0x80</span> | ((wc &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0x3f</span>);<font></font>
  p[<span class="hljs-number">1</span>] = <span class="hljs-number">0x80</span> | ((wc &gt;&gt; <span class="hljs-number">18</span>) &amp; <span class="hljs-number">0x3f</span>);<font></font>
  p[<span class="hljs-number">2</span>] = <span class="hljs-number">0x80</span> | ((wc &gt;&gt; <span class="hljs-number">12</span>) &amp; <span class="hljs-number">0x3f</span>);<font></font>
  p[<span class="hljs-number">3</span>] = <span class="hljs-number">0x80</span> | ((wc &gt;&gt; <span class="hljs-number">6</span>) &amp; <span class="hljs-number">0x3f</span>);<font></font>
  p[<span class="hljs-number">4</span>] = <span class="hljs-number">0x80</span> | (wc &amp; <span class="hljs-number">0x3f</span>);<font></font>
  p += <span class="hljs-number">6</span>;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you can see, there is some kind of confusion with the indexes. </font><font style="vertical-align: inherit;">Twice there is a record in the array element </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p [1]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">If you study the code in the neighborhood, it becomes clear that the correct code should be like this:</font></font><br>
<pre><code class="cpp hljs">p[<span class="hljs-number">0</span>] = <span class="hljs-number">0xfc</span> | ((wc &gt;&gt; <span class="hljs-number">30</span>) &amp; <span class="hljs-number">0x01</span>);<font></font>
p[<span class="hljs-number">1</span>] = <span class="hljs-number">0x80</span> | ((wc &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0x3f</span>);<font></font>
p[<span class="hljs-number">2</span>] = <span class="hljs-number">0x80</span> | ((wc &gt;&gt; <span class="hljs-number">18</span>) &amp; <span class="hljs-number">0x3f</span>);<font></font>
p[<span class="hljs-number">3</span>] = <span class="hljs-number">0x80</span> | ((wc &gt;&gt; <span class="hljs-number">12</span>) &amp; <span class="hljs-number">0x3f</span>);<font></font>
p[<span class="hljs-number">4</span>] = <span class="hljs-number">0x80</span> | ((wc &gt;&gt; <span class="hljs-number">6</span>) &amp; <span class="hljs-number">0x3f</span>);<font></font>
p[<span class="hljs-number">5</span>] = <span class="hljs-number">0x80</span> | (wc &amp; <span class="hljs-number">0x3f</span>);<font></font>
p += <span class="hljs-number">6</span>;</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Please note that all errors discussed in this chapter are related to C or C ++ code. </font><font style="vertical-align: inherit;">No C # or Java Code! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is very interesting, I did not expect this. </font><font style="vertical-align: inherit;">In my opinion, the typos considered do not depend on the language. </font><font style="vertical-align: inherit;">And in the following chapters, errors in code in other languages ‚Äã‚Äãwill indeed appear. </font><font style="vertical-align: inherit;">I think this is just a coincidence. </font><font style="vertical-align: inherit;">The PVS-Studio analyzer started much later to support C # / Java languages ‚Äã‚Äãcompared to C / C ++, and we simply did not manage to accumulate the corresponding error examples in the database. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, the observation is still interesting. </font><font style="vertical-align: inherit;">Apparently, C and C ++ programmers like to use numbers 0, 1 and 2 more when working with arrays :).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Misspellings in names</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This will be the largest section. </font><font style="vertical-align: inherit;">It's very easy for people to get confused by names like </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a2</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">It seems like you can get confused here? </font><font style="vertical-align: inherit;">Can. </font><font style="vertical-align: inherit;">Easy. </font><font style="vertical-align: inherit;">And now the reader will be able to verify this. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hive Project, Java</font></font></b><br>
<pre><code class="java hljs"><span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;ServiceInstance&gt; <span class="hljs-title">getAllInstancesOrdered</span><span class="hljs-params">()</span> </span>{<font></font>
  List&lt;ServiceInstance&gt; list = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();<font></font>
  list.addAll(instances.values());<font></font>
  Collections.sort(list, <span class="hljs-keyword">new</span> Comparator&lt;ServiceInstance&gt;() {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">compare</span><span class="hljs-params">(ServiceInstance o1, ServiceInstance o2)</span> </span>{
      <span class="hljs-keyword">return</span> o2.getWorkerIdentity().compareTo(o2.getWorkerIdentity());<font></font>
    }<font></font>
  });<font></font>
  <span class="hljs-keyword">return</span> list;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The compare function </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">compare</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> takes two objects: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o2</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">But due to a typo, only </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o2 is</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> used further </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Interestingly, thanks to Copy-Paste, this error migrated to another function:</font></font><br>
<pre><code class="cpp hljs">@<span class="hljs-function">Override
<span class="hljs-keyword">public</span> List&lt;ServiceInstance&gt; <span class="hljs-title">getAllInstancesOrdered</span><span class="hljs-params">()</span> </span>{<font></font>
  List&lt;ServiceInstance&gt; <span class="hljs-built_in">list</span> = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();<font></font>
  readLock.lock();<font></font>
  <span class="hljs-keyword">try</span> {
    <span class="hljs-built_in">list</span>.addAll(instances.values());<font></font>
  } finally {<font></font>
    readLock.unlock();<font></font>
  }<font></font>
  Collections.sort(<span class="hljs-built_in">list</span>, <span class="hljs-keyword">new</span> Comparator&lt;ServiceInstance&gt;() {<font></font>
    @Override<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> compare(ServiceInstance o1, ServiceInstance o2) {
      <span class="hljs-keyword">return</span> o2.getWorkerIdentity().compareTo(o2.getWorkerIdentity());<font></font>
    }<font></font>
  });<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">list</span>;<font></font>
}</code></pre><br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/776/52c/06b/77652c06b1550ac7ad80935716930f97.png" alt="Figure 10"></div><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Infer.NET project, C # language</font></font></b><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">MergeParallelTransitions</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">double</span>.IsInfinity(transition1.Weight.Value) &amp;&amp;    
      <span class="hljs-keyword">double</span>.IsInfinity(transition1.Weight.Value))<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Doom 3 Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function">uint <span class="hljs-title">AltOp::fixedLength</span><span class="hljs-params">()</span>
</span>{<font></font>
  uint l1 = exp1-&gt;fixedLength();<font></font>
  uint l2 = exp1-&gt;fixedLength();<font></font>
<font></font>
  <span class="hljs-keyword">if</span> (l1 != l2 || l1 == ~<span class="hljs-number">0u</span>)
    <span class="hljs-keyword">return</span> ~<span class="hljs-number">0</span>;<font></font>
<font></font>
  <span class="hljs-keyword">return</span> l1;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If someone did not immediately notice a typo, then you need to look at the line where the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l2</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> variable is initialized </font><font style="vertical-align: inherit;">. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Should</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> use </font><i><font style="vertical-align: inherit;">exp2</font></i><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Source Engine SDK Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">GetFPSColor</span><span class="hljs-params">( <span class="hljs-keyword">int</span> nFps, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> ucColor[<span class="hljs-number">3</span>] )</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">int</span> nFPSThreshold1 = <span class="hljs-number">20</span>;
  <span class="hljs-keyword">int</span> nFPSThreshold2 = <span class="hljs-number">15</span>;<font></font>
<font></font>
  <span class="hljs-keyword">if</span> (IsPC() &amp;&amp;<font></font>
      g_pMaterialSystemHardwareConfig-&gt;GetDXSupportLevel() &gt;= <span class="hljs-number">95</span>)<font></font>
  {<font></font>
    nFPSThreshold1 = <span class="hljs-number">60</span>;<font></font>
    nFPSThreshold1 = <span class="hljs-number">50</span>;<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Correctly:</font></font><br>
<pre><code class="cpp hljs">nFPSThreshold1 = <span class="hljs-number">60</span>;<font></font>
nFPSThreshold2 = <span class="hljs-number">50</span>;</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linux Kernel project, C language</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
By the way, typos can be not only in variable names, but also in macro names. </font><font style="vertical-align: inherit;">Now there will be several such examples.</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">private_ioctl</span><span class="hljs-params">(struct vnt_private *pDevice, struct ifreq *rq)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (sStartAPCmd.byBasicRate &amp; BIT3) {<font></font>
    pMgmt-&gt;abyIBSSSuppRates[<span class="hljs-number">2</span>] |= BIT7;<font></font>
    pMgmt-&gt;abyIBSSSuppRates[<span class="hljs-number">3</span>] |= BIT7;<font></font>
    pMgmt-&gt;abyIBSSSuppRates[<span class="hljs-number">4</span>] |= BIT7;<font></font>
    pMgmt-&gt;abyIBSSSuppRates[<span class="hljs-number">5</span>] |= BIT7;<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sStartAPCmd.byBasicRate &amp; BIT2) {<font></font>
    pMgmt-&gt;abyIBSSSuppRates[<span class="hljs-number">2</span>] |= BIT7;<font></font>
    pMgmt-&gt;abyIBSSSuppRates[<span class="hljs-number">3</span>] |= BIT7;<font></font>
    pMgmt-&gt;abyIBSSSuppRates[<span class="hljs-number">4</span>] |= BIT7;<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sStartAPCmd.byBasicRate &amp; BIT1) {  <span class="hljs-comment">// &lt;=</span>
    pMgmt-&gt;abyIBSSSuppRates[<span class="hljs-number">2</span>] |= BIT7;<font></font>
    pMgmt-&gt;abyIBSSSuppRates[<span class="hljs-number">3</span>] |= BIT7;<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sStartAPCmd.byBasicRate &amp; BIT1) {  <span class="hljs-comment">// &lt;=</span>
    pMgmt-&gt;abyIBSSSuppRates[<span class="hljs-number">2</span>] |= BIT7;<font></font>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">/* default 1,2M */</span>
    pMgmt-&gt;abyIBSSSuppRates[<span class="hljs-number">2</span>] |= BIT7;<font></font>
    pMgmt-&gt;abyIBSSSuppRates[<span class="hljs-number">3</span>] |= BIT7;<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you can see, a mask called </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BIT1 is</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> used twice </font><font style="vertical-align: inherit;">, which makes the second check pointless. </font><font style="vertical-align: inherit;">The body of the second commented conditional statement will never be executed. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CMaNGOS Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">AttackedBy</span><span class="hljs-params">(Unit* pAttacker)</span> <span class="hljs-keyword">override</span>
</span>{<font></font>
  ....<font></font>
  DoScriptText(urand(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) ?<font></font>
               SAY_BELNISTRASZ_AGGRO_1 :<font></font>
               SAY_BELNISTRASZ_AGGRO_1,<font></font>
               m_creature, pAttacker);<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Random behavior was planned in the game, but the same constant </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SAY_BELNISTRASZ_AGGRO_1 is</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> always selected </font><font style="vertical-align: inherit;">. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vangers Project: One For The Road, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* <span class="hljs-title">iGetJoyBtnNameText</span><span class="hljs-params">(<span class="hljs-keyword">int</span> vkey,<span class="hljs-keyword">int</span> lang)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (vkey &gt;= VK_STICK_SWITCH_1 &amp;&amp; vkey &lt;= VK_STICK_SWITCH_9)<font></font>
  {<font></font>
     ret = (lang)<font></font>
      ? iJoystickStickSwitch2[vkey - VK_STICK_SWITCH_1]<font></font>
      : iJoystickStickSwitch2[vkey - VK_STICK_SWITCH_1];<font></font>
    <span class="hljs-keyword">return</span> ret;<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Judging by the code written next to it, the correct option should be like this:</font></font><br>
<pre><code class="cpp hljs">ret = (lang)<font></font>
  ? iJoystickStickSwitch2[vkey - VK_STICK_SWITCH_1]<font></font>
  : iJoystickStickSwitch1[vkey - VK_STICK_SWITCH_1];</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RT-Thread Project, C language</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">uint8_t</span> <span class="hljs-title">can_receive_message_length</span><span class="hljs-params">(<span class="hljs-keyword">uint32_t</span> can_periph,
                                   <span class="hljs-keyword">uint8_t</span> fifo_number)</span>
</span>{
  <span class="hljs-keyword">uint8_t</span> val = <span class="hljs-number">0U</span>;<font></font>
<font></font>
  <span class="hljs-keyword">if</span>(CAN_FIFO0 == fifo_number){<font></font>
    val = (<span class="hljs-keyword">uint8_t</span>)(CAN_RFIFO0(can_periph) &amp; CAN_RFIFO_RFL0_MASK);<font></font>
  }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(CAN_FIFO0 == fifo_number){<font></font>
    val = (<span class="hljs-keyword">uint8_t</span>)(CAN_RFIFO1(can_periph) &amp; CAN_RFIFO_RFL0_MASK);<font></font>
  }<span class="hljs-keyword">else</span>{
    <span class="hljs-comment">/* illegal parameter */</span><font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> val;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RT-Thread is an open-source, real-time operating system for embedded devices. </font><font style="vertical-align: inherit;">Here we see the confusion between FIFO 0 and FIFO 1. And somewhere, someone will encounter a buggy device.</font></font><br>
<br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2e9/3e3/3a9/2e93e33a9dd36ed4bd3049a66d1e6ad5.png" alt="Figure 11"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The error is here:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">if</span>      (CAN_FIFO0 == fifo_number){<font></font>
....<font></font>
}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(CAN_FIFO0 == fifo_number){</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The second check always gives false. </font><font style="vertical-align: inherit;">Correctly:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">if</span>      (CAN_FIFO0 == fifo_number){<font></font>
....<font></font>
}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(CAN_FIFO1 == fifo_number){</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hive Project, Java</font></font></b><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span>
<span class="hljs-title">generateDateTimeArithmeticIntervalYearMonth</span><span class="hljs-params">(String[] tdesc)</span> <span class="hljs-keyword">throws</span> Exception </span>{<font></font>
  String operatorName = tdesc[<span class="hljs-number">1</span>];<font></font>
  String operatorSymbol = tdesc[<span class="hljs-number">2</span>];<font></font>
  String operandType1 = tdesc[<span class="hljs-number">3</span>];<font></font>
  String colOrScalar1 = tdesc[<span class="hljs-number">4</span>];<font></font>
  String operandType2 = tdesc[<span class="hljs-number">5</span>];<font></font>
  String colOrScalar2 = tdesc[<span class="hljs-number">6</span>];<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (colOrScalar1.equals(<span class="hljs-string">"Col"</span>) &amp;&amp; colOrScalar1.equals(<span class="hljs-string">"Column"</span>)) {<font></font>
    ....<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (colOrScalar1.equals(<span class="hljs-string">"Col"</span>) &amp;&amp; colOrScalar1.equals(<span class="hljs-string">"Scalar"</span>)) {<font></font>
    ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The PVS-Studio analyzer immediately indicates 2 errors:</font></font><ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A string stored in </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">colOrScalar1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cannot equal both Col and Column strings;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The string stored in </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">colOrScalar1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cannot equal the Col and Scalar strings at the same time.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There is clearly confusion about variable names. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shareaza project, C ++ language</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">CDownloadWithSources::MergeMetadata</span><span class="hljs-params">(<span class="hljs-keyword">const</span> CXMLElement* pXML)</span>
</span>{
  <span class="hljs-function">CQuickLock <span class="hljs-title">pLock</span><span class="hljs-params">( Transfers.m_pSection )</span></span>;<font></font>
<font></font>
  CXMLAttribute* pAttr1 =<font></font>
    m_pXML-&gt;GetAttribute(CXMLAttribute::schemaName);<font></font>
  CXMLAttribute* pAttr2 =<font></font>
    pXML-&gt;GetAttribute(CXMLAttribute::schemaName);<font></font>
<font></font>
  <span class="hljs-keyword">if</span> (pAttr1 &amp;&amp; pAttr2 &amp;&amp;<font></font>
      !pAttr1-&gt;GetValue().CompareNoCase(pAttr1-&gt;GetValue()))<font></font>
    ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Correctly:</font></font><br>
<pre><code class="cpp hljs">pAttr1-&gt;GetValue().CompareNoCase(pAttr2-&gt;GetValue())</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Let's take a short pause. There is a fear that looking through a mountain of banal mistakes, we will forget why we are doing this. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The task is not to laugh at someone else's code. All this is not a reason to poke your finger and say: "Ha ha, well, you have to." This reason to think! </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The publications of</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> our team are designed to show that none of us is immune from mistakes. Errors described in the article appear in the code much more often than you might expect. It is also important that the probability of getting lost in 0, 1, 2 is almost independent of the qualifications of the programmer.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is useful to realize that people tend to make mistakes. </font><font style="vertical-align: inherit;">Without this, you cannot take the next step in improving the quality and reliability of the code. </font><font style="vertical-align: inherit;">Understanding that we are all mistaken, people begin to try to identify errors at the earliest stages, using coding standards, code reviews, unit tests, static and dynamic analyzers. </font><font style="vertical-align: inherit;">It is very good. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Why are things so understandable written? </font><font style="vertical-align: inherit;">Unfortunately, communicating with a large number of developers, we are forced to state that it is not always so clear to everyone. </font><font style="vertical-align: inherit;">Many have too high self-esteem and they simply do not allow the thought that they are capable of making simple mistakes. </font><font style="vertical-align: inherit;">It is sad. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you are a team leader / manager, then I invite you to familiarize yourself with this </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">note</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> at the same time </font><font style="vertical-align: inherit;">. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qt Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function">AtomicComparator::ComparisonResult
<span class="hljs-title">IntegerComparator::compare</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Item &amp;o1,
                           <span class="hljs-keyword">const</span> AtomicComparator::Operator,
                           <span class="hljs-keyword">const</span> Item &amp;o2)</span> <span class="hljs-keyword">const</span>
</span>{
  <span class="hljs-keyword">const</span> Numeric *<span class="hljs-keyword">const</span> num1 = o1.as&lt;Numeric&gt;();
  <span class="hljs-keyword">const</span> Numeric *<span class="hljs-keyword">const</span> num2 = o1.as&lt;Numeric&gt;();<font></font>
<font></font>
  <span class="hljs-keyword">if</span>(num1-&gt;isSigned() || num2-&gt;isSigned())<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Correctly:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">const</span> Numeric *<span class="hljs-keyword">const</span> num2 = o2.as&lt;Numeric&gt;();</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Android project, C ++ language</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">isAudioPlaybackRateEqual</span><span class="hljs-params">(
  <span class="hljs-keyword">const</span> AudioPlaybackRate &amp;pr1,
  <span class="hljs-keyword">const</span> AudioPlaybackRate &amp;pr2)</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">fabs</span>(pr1.mSpeed - pr2.mSpeed) &lt;<font></font>
             AUDIO_TIMESTRETCH_SPEED_MIN_DELTA &amp;&amp;<font></font>
           <span class="hljs-built_in">fabs</span>(pr1.mPitch - pr2.mPitch) &lt;<font></font>
             AUDIO_TIMESTRETCH_PITCH_MIN_DELTA &amp;&amp;<font></font>
           pr2.mStretchMode == pr2.mStretchMode &amp;&amp;<font></font>
           pr2.mFallbackMode == pr2.mFallbackMode;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Two typos at once, due to which the variables </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pr2.mStretchMode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pr2.mFallbackMode are</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> compared with themselves. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Boost Project, C ++</font></font></b><br>
<pre><code class="cpp hljs">point3D <span class="hljs-keyword">operator</span>/(<span class="hljs-keyword">const</span> point3D &amp;p1, <span class="hljs-keyword">const</span> point3D &amp;p2)<font></font>
{<font></font>
  <span class="hljs-keyword">return</span> point3D(p1.x/p2.x, p1.y/p2.y, p1.z/p1.z);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At the very end, they sealed up and divided the variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p1.z</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> itself. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clang Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">haveSameType</span><span class="hljs-params">(QualType Ty1, QualType Ty2)</span> </span>{
  <span class="hljs-keyword">return</span> (Context.getCanonicalType(Ty1) ==<font></font>
          Context.getCanonicalType(Ty2) ||<font></font>
          (Ty2-&gt;isIntegerType() &amp;&amp;<font></font>
           Ty2-&gt;isIntegerType()));<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yes, yes, PVS-Studio analyzer finds similar errors in compilers. </font><font style="vertical-align: inherit;">Correctly:</font></font><br>
<pre><code class="cpp hljs">(Ty1-&gt;isIntegerType() &amp;&amp;<font></font>
 Ty2-&gt;isIntegerType())</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clang Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function">Instruction *<span class="hljs-title">InstCombiner::visitXor</span><span class="hljs-params">(BinaryOperator &amp;I)</span> </span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (Op0I &amp;&amp; Op1I &amp;&amp; Op0I-&gt;isShift() &amp;&amp;<font></font>
      Op0I-&gt;getOpcode() == Op1I-&gt;getOpcode() &amp;&amp;<font></font>
      Op0I-&gt;getOperand(<span class="hljs-number">1</span>) == Op1I-&gt;getOperand(<span class="hljs-number">1</span>) &amp;&amp;<font></font>
      (Op1I-&gt;hasOneUse() || Op1I-&gt;hasOneUse())) {<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Correctly:</font></font><br>
<pre><code class="cpp hljs">(Op0I-&gt;hasOneUse() || Op1I-&gt;hasOneUse())</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qt Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">qCompare</span><span class="hljs-params">(QImage <span class="hljs-keyword">const</span> &amp;t1, QImage <span class="hljs-keyword">const</span> &amp;t2, ....)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (t1.width() != t2.width() || t2.height() != t2.height()) {<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NCBI Genome Workbench Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">s_PCRPrimerSetLess</span><span class="hljs-params">(<span class="hljs-keyword">const</span> CPCRPrimerSet&amp; s1, <span class="hljs-keyword">const</span> CPCRPrimerSet&amp; s2)</span>
</span>{
  <span class="hljs-keyword">if</span> (!s1.IsSet() &amp;&amp; s1.IsSet()) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (s1.IsSet() &amp;&amp; !s2.IsSet()) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!s1.IsSet() &amp;&amp; !s2.IsSet()) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (s1.Get().size() &lt; s2.Get().size()) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (s1.Get().size() &gt; s2.Get().size()) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
  .....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Error in the very first check. </font><font style="vertical-align: inherit;">It should be written:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">if</span> (!s1.IsSet() &amp;&amp; s2.IsSet()) {</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NCBI Genome Workbench Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function">CRef&lt;CSeq_align&gt; <span class="hljs-title">CNWAligner::Run</span><span class="hljs-params">(CScope &amp;scope, <span class="hljs-keyword">const</span> CSeq_loc &amp;loc1,
                                 <span class="hljs-keyword">const</span> CSeq_loc &amp;loc2, <span class="hljs-keyword">bool</span> trim_end_gaps)</span>
</span>{
  <span class="hljs-keyword">if</span> ((!loc1.IsInt() &amp;&amp; !loc1.IsWhole()) ||<font></font>
      (!loc1.IsInt() &amp;&amp; !loc1.IsWhole()))<font></font>
  {<font></font>
    NCBI_THROW(CException, eUnknown,<font></font>
               <span class="hljs-string">"Only whole and interval locations supported"</span>);<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first line of the condition was propagated, but then the programmer hastened and forgot to replace </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">loc1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">loc2</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FlashDevelop Project, C #</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SetPrices</span><span class="hljs-params">(....)</span>
</span>{<font></font>
  UInt32 a0 = _choice.GetPrice0();<font></font>
  UInt32 a1 = _choice.GetPrice1();<font></font>
  UInt32 b0 = a1 + _choice2.GetPrice0();   <span class="hljs-comment">// &lt;=</span><font></font>
  UInt32 b1 = a1 + _choice2.GetPrice1();<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FreeCAD Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">insEdgeVec</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">map</span>&lt;<span class="hljs-keyword">int</span>,<span class="hljs-built_in">std</span>::<span class="hljs-built_in">set</span>&lt;<span class="hljs-keyword">int</span>&gt; &gt; &amp;<span class="hljs-built_in">map</span>,
                       <span class="hljs-keyword">int</span> n1, <span class="hljs-keyword">int</span> n2)</span>
</span>{
  <span class="hljs-keyword">if</span>(n1&lt;n2)
    <span class="hljs-built_in">map</span>[n2].insert(n1);
  <span class="hljs-keyword">else</span>
    <span class="hljs-built_in">map</span>[n2].insert(n1);<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Regardless of the condition, the same action is performed. </font><font style="vertical-align: inherit;">It would seem such a simple case. </font><font style="vertical-align: inherit;">How could you copy a line and not fix it? </font><font style="vertical-align: inherit;">Can. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LibreOffice Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SVX_DLLPUBLIC</span> <span class="hljs-title">SdrMarkView</span> :</span> <span class="hljs-keyword">public</span> SdrSnapView<font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-function"><span class="hljs-keyword">const</span> Point&amp; <span class="hljs-title">GetRef1</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> maRef1; }
  <span class="hljs-function"><span class="hljs-keyword">const</span> Point&amp; <span class="hljs-title">GetRef2</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> maRef1; }<font></font>
  ....<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Classical Copy-Paste error. </font><font style="vertical-align: inherit;">Correctly:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">const</span> Point&amp; <span class="hljs-title">GetRef2</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ <span class="hljs-keyword">return</span> maRef2; }</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LibreOffice Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">CmpAttr</span><span class="hljs-params">(
  <span class="hljs-keyword">const</span> SfxPoolItem&amp; rItem1, <span class="hljs-keyword">const</span> SfxPoolItem&amp; rItem2)</span>
</span>{<font></font>
  ....<font></font>
  ::boost::optional&lt;sal_uInt16&gt; oNumOffset1 =<font></font>
        <span class="hljs-keyword">static_cast</span>&lt;<span class="hljs-keyword">const</span> SwFmtPageDesc&amp;&gt;(rItem1).GetNumOffset();<font></font>
  ::boost::optional&lt;sal_uInt16&gt; oNumOffset2 =<font></font>
        <span class="hljs-keyword">static_cast</span>&lt;<span class="hljs-keyword">const</span> SwFmtPageDesc&amp;&gt;(rItem1).GetNumOffset();<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And one more classic Copy-Paste error :). </font><font style="vertical-align: inherit;">In one place 1 to 2 corrected, and in another they forgot. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LibreOffice Project, C ++</font></font></b><br>
<pre><code class="cpp hljs">XMLTransformerOOoEventMap_Impl::XMLTransformerOOoEventMap_Impl(<font></font>
        XMLTransformerEventMapEntry *pInit,<font></font>
        XMLTransformerEventMapEntry *pInit2 )<font></font>
{<font></font>
  <span class="hljs-keyword">if</span>( pInit )<font></font>
    AddMap( pInit );<font></font>
  <span class="hljs-keyword">if</span>( pInit )<font></font>
    AddMap( pInit2 );<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There is no mistake in replacing 1 with 2, but just did not add 2 to the second condition.</font></font><br>
<br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bc2/b45/1ab/bc2b451ab103e2657fff7f29a31c3920.png" alt="Figure 12"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You may be a little tired. </font><font style="vertical-align: inherit;">Therefore, I propose to make tea or coffee, and we will continue our acquaintance with the world of numbers 0, 1 and 2. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geant4 software project, C ++ language</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">G4VTwistSurface::GetBoundaryLimit</span><span class="hljs-params">(G4int areacode,
                                       G4double limit[])</span> <span class="hljs-keyword">const</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (areacode &amp; sC0Min1Max) {<font></font>
     limit[<span class="hljs-number">0</span>] = fAxisMin[<span class="hljs-number">0</span>];<font></font>
     limit[<span class="hljs-number">1</span>] = fAxisMin[<span class="hljs-number">1</span>];<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (areacode &amp; sC0Max1Min) {<font></font>
     limit[<span class="hljs-number">0</span>] = fAxisMax[<span class="hljs-number">0</span>];<font></font>
     limit[<span class="hljs-number">1</span>] = fAxisMin[<span class="hljs-number">1</span>];<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (areacode &amp; sC0Max1Max) {<font></font>
     limit[<span class="hljs-number">0</span>] = fAxisMax[<span class="hljs-number">0</span>];<font></font>
     limit[<span class="hljs-number">1</span>] = fAxisMax[<span class="hljs-number">1</span>];<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (areacode &amp; sC0Min1Max) {<font></font>
     limit[<span class="hljs-number">0</span>] = fAxisMin[<span class="hljs-number">0</span>];<font></font>
     limit[<span class="hljs-number">1</span>] = fAxisMax[<span class="hljs-number">1</span>];<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I hope you took the advice and rested. </font><font style="vertical-align: inherit;">Ready to find an error in this code? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Congratulations to readers who have noticed a mistake. </font><font style="vertical-align: inherit;">You are great! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Those who are too lazy to search, I also understand those. </font><font style="vertical-align: inherit;">The review of such a code is very tedious and there is a desire to somehow quickly go check something more interesting. </font><font style="vertical-align: inherit;">This is where static analyzers help a lot because they don‚Äôt get tired. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The error is that these two checks are the same:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">if</span>        (areacode &amp; sC0Min1Max) {<font></font>
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (areacode &amp; sC0Min1Max) {</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you study the code, it becomes clear that the very first check is erroneous. </font><font style="vertical-align: inherit;">Correctly:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">if</span>        (areacode &amp; sC0Min1Min) {<font></font>
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (areacode &amp; sC0Max1Min) {<font></font>
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (areacode &amp; sC0Max1Max) {<font></font>
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (areacode &amp; sC0Min1Max) {</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CryEngine V Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">bool</span>
<span class="hljs-title">CompareRotation</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Quat&amp; q1, <span class="hljs-keyword">const</span> Quat&amp; q2, <span class="hljs-keyword">float</span> epsilon)</span>
</span>{
  <span class="hljs-keyword">return</span> (fabs_tpl(q1.v.x - q2.v.x) &lt;= epsilon)<font></font>
      &amp;&amp; (fabs_tpl(q1.v.y - q2.v.y) &lt;= epsilon)<font></font>
      &amp;&amp; (fabs_tpl(q2.v.z - q2.v.z) &lt;= epsilon) <span class="hljs-comment">// &lt;=</span><font></font>
      &amp;&amp; (fabs_tpl(q1.w - q2.w) &lt;= epsilon);<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TortoiseGit Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">CGitStatusListCtrl::OnContextMenuList</span><span class="hljs-params">(....)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span>( (!<span class="hljs-keyword">this</span>-&gt;m_Rev1.IsEmpty()) ||<font></font>
      (!<span class="hljs-keyword">this</span>-&gt;m_Rev1.IsEmpty()) )<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geant4 software project, C ++ language</font></font></b><br>
<pre><code class="cpp hljs">G4double G4MesonAbsorption::<font></font>
GetTimeToAbsorption(<span class="hljs-keyword">const</span> G4KineticTrack&amp; trk1,
                    <span class="hljs-keyword">const</span> G4KineticTrack&amp; trk2)<font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span>(( trk1.GetDefinition() == G4Neutron::Neutron() ||<font></font>
       trk1.GetDefinition() == G4Neutron::Neutron() ) &amp;&amp;<font></font>
       sqrtS&gt;<span class="hljs-number">1.91</span>*GeV &amp;&amp; pi*distance&gt;maxChargedCrossSection)
    <span class="hljs-keyword">return</span> time;<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MonoDevelop Project, C #</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">MembersMatch</span><span class="hljs-params">(ISymbol member1, ISymbol member2)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (member1.DeclaredAccessibility !=<font></font>
      member1.DeclaredAccessibility<font></font>
   || member1.IsStatic != member1.IsStatic)<font></font>
  {<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you can see, while the code fragments go without explanation. </font><font style="vertical-align: inherit;">Actually, there is nothing to explain here. </font><font style="vertical-align: inherit;">You can only sigh. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dolphin Emulator Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">IRBuilder::maskedValueIsZero</span><span class="hljs-params">(InstLoc Op1, InstLoc Op2)</span> <span class="hljs-keyword">const</span>
</span>{
  <span class="hljs-keyword">return</span> (~ComputeKnownZeroBits(Op1) &amp;<font></font>
          ~ComputeKnownZeroBits(Op1)) == <span class="hljs-number">0</span>;<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RunAsAdmin Explorer Shim Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">IsLuidsEqual</span><span class="hljs-params">(LUID luid1, LUID luid2)</span>
</span>{
  <span class="hljs-keyword">return</span> (luid1.LowPart == luid2.LowPart) &amp;&amp;<font></font>
         (luid2.HighPart == luid2.HighPart);<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IT ++ project, C ++ language</font></font></b><br>
<pre><code class="cpp hljs">Gold::Gold(<span class="hljs-keyword">const</span> ivec &amp;mseq1_connections,
           <span class="hljs-keyword">const</span> ivec &amp;mseq2_connections)<font></font>
{<font></font>
  ....<font></font>
  it_assert(mseq1.get_length() == mseq1.get_length(),<font></font>
            <span class="hljs-string">"Gold::Gold(): dimension mismatch"</span>);<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QuantLib Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function">Distribution <span class="hljs-title">ManipulateDistribution::convolve</span><span class="hljs-params">(
  <span class="hljs-keyword">const</span> Distribution&amp; d1, <span class="hljs-keyword">const</span> Distribution&amp; d2)</span> </span>{<font></font>
  ....<font></font>
  QL_REQUIRE (d1.xmin_ == <span class="hljs-number">0.0</span> &amp;&amp; d1.xmin_ == <span class="hljs-number">0.0</span>,
              <span class="hljs-string">"distributions offset larger than 0"</span>);<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Samba Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">samu_correct</span><span class="hljs-params">(struct samu *s1, struct samu *s2)</span>
</span>{<font></font>
  ....<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (s1_len != s1_len) {<font></font>
    DEBUG(<span class="hljs-number">0</span>, (<span class="hljs-string">"Password history not written correctly, "</span>
              <span class="hljs-string">"lengths differ, want %d, got %d\n"</span>,<font></font>
          s1_len, s2_len));<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mozilla Firefox Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> PRBool <span class="hljs-title">IsZPositionLEQ</span><span class="hljs-params">(nsDisplayItem* aItem1,
                             nsDisplayItem* aItem2,
                             <span class="hljs-keyword">void</span>* aClosure)</span> </span>{
  <span class="hljs-keyword">if</span> (!aItem1-&gt;GetUnderlyingFrame()-&gt;Preserves3D() ||<font></font>
      !aItem1-&gt;GetUnderlyingFrame()-&gt;Preserves3D()) {<font></font>
    <span class="hljs-keyword">return</span> IsContentLEQ(aItem1, aItem2, aClosure);<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Haiku Operation System Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">trans_double_path::reset</span><span class="hljs-params">()</span>
</span>{<font></font>
  m_src_vertices1.remove_all();<font></font>
  m_src_vertices2.remove_all();<font></font>
  m_kindex1 = <span class="hljs-number">0.0</span>;               <span class="hljs-comment">// &lt;=</span>
  m_kindex1 = <span class="hljs-number">0.0</span>;               <span class="hljs-comment">// &lt;=</span><font></font>
  m_status1 = initial;<font></font>
  m_status2 = initial;<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The Qt project, C ++</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ok, now let's get a little more complicated. </font><font style="vertical-align: inherit;">For fun, try to find the error here:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> ShiftResult <span class="hljs-title">shift</span><span class="hljs-params">(....)</span>
</span>{<font></font>
  ....<font></font>
  qreal l = (orig-&gt;x1 - orig-&gt;x2)*(orig-&gt;x1 - orig-&gt;x2) +<font></font>
            (orig-&gt;y1 - orig-&gt;y2)*(orig-&gt;y1 - orig-&gt;y1) *<font></font>
            (orig-&gt;x3 - orig-&gt;x4)*(orig-&gt;x3 - orig-&gt;x4) +<font></font>
            (orig-&gt;y3 - orig-&gt;y4)*(orig-&gt;y3 - orig-&gt;y4);<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A picture, so as not to see the answer immediately, and had the opportunity to think.</font></font><br>
<br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b5c/960/461/b5c960461e9ffce998cee4e1380b08f7.png" alt="Figure 13"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
That's right, instead of </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">orig-&gt; y1 - orig-&gt; y1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> should be written </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">orig-&gt; y1 - orig-&gt; y2</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.NET Compiler Platform Project, C # Language</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">IndexerMemberRace</span><span class="hljs-params">()</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">20</span>; i++)<font></font>
  {<font></font>
    ....<font></font>
    <span class="hljs-keyword">if</span> (i % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>)<font></font>
    {<font></font>
      thread1.Start();<font></font>
      thread2.Start();<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
      thread1.Start();<font></font>
      thread2.Start();<font></font>
    }<font></font>
    ....<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Interesting case. </font><font style="vertical-align: inherit;">For testing purposes, you need to run threads in a different order. </font><font style="vertical-align: inherit;">However, due to a typo, the threads always start the same way, as a result of which the test checks less than it should. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Correctly:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">if</span> (i % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>)<font></font>
{<font></font>
  thread1.Start();<font></font>
  thread2.Start();<font></font>
}<font></font>
<span class="hljs-keyword">else</span><font></font>
{<font></font>
  thread2.Start();<font></font>
  thread1.Start();<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Samba Project, C language</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">compare_procids</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">void</span> *p1, <span class="hljs-keyword">const</span> <span class="hljs-keyword">void</span> *p2)</span>
</span>{
  <span class="hljs-keyword">const</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">server_id</span> *<span class="hljs-title">i1</span> = (<span class="hljs-title">struct</span> <span class="hljs-title">server_id</span> *)<span class="hljs-title">p1</span>;</span>
  <span class="hljs-keyword">const</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">server_id</span> *<span class="hljs-title">i2</span> = (<span class="hljs-title">struct</span> <span class="hljs-title">server_id</span> *)<span class="hljs-title">p2</span>;</span><font></font>
<font></font>
  <span class="hljs-keyword">if</span> (i1-&gt;pid &lt; i2-&gt;pid) <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
  <span class="hljs-keyword">if</span> (i2-&gt;pid &gt; i2-&gt;pid) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The comparison function will never return 1, since the condition </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i2-&gt; pid&gt; i2-&gt; pid</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> does not make sense. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturally, this is an ordinary typo, and in fact it should be written:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">if</span> (i1-&gt;pid &gt; i2-&gt;pid) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ChakraCore Project, C ++</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
The last case in this chapter. </font><font style="vertical-align: inherit;">Hooray!</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">Lowerer::GenerateFastBrSrEq</span><span class="hljs-params">(....,
                                 IR::RegOpnd * srcReg1,
                                 IR::RegOpnd * srcReg2,
                                 ....)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (srcReg1 &amp;&amp; (srcReg1-&gt;m_sym-&gt;m_isStrConst))<font></font>
  ....<font></font>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (srcReg1 &amp;&amp; (srcReg1-&gt;m_sym-&gt;m_isStrConst))<font></font>
  ....<font></font>
}</code></pre><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Other errors</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now let's talk about less numerous error patterns associated with the use of numbers 0, 1, 2.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Typos in conditions where the constant 0/1/2 is explicitly used</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ROOT Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function">Int_t <span class="hljs-title">TProofMonSenderML::SendSummary</span><span class="hljs-params">(TList *recs, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *id)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (fSummaryVrs == <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">if</span> ((dsn = recs-&gt;FindObject(<span class="hljs-string">"dataset"</span>))) recs-&gt;Remove(dsn);<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (fSummaryVrs == <span class="hljs-number">0</span>) {<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It's weird comparing </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fSummaryVrs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to 0. </font><font style="vertical-align: inherit;">twice </font><font style="vertical-align: inherit;">. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.NET CoreCLR project, C #</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PutIA64Imm22</span><span class="hljs-params">(UINT64 * pBundle, UINT32 slot, INT32 imm22)</span>
</span>{
  <span class="hljs-keyword">if</span> (slot == <span class="hljs-number">0</span>)             <span class="hljs-comment">// &lt;=</span><font></font>
  {<font></font>
    ....<font></font>
  }<font></font>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (slot == <span class="hljs-number">1</span>)<font></font>
  {<font></font>
    ....<font></font>
  }<font></font>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (slot == <span class="hljs-number">0</span>)        <span class="hljs-comment">// &lt;=</span><font></font>
  {<font></font>
    .... <font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FFmpeg Project, C language</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">imc_decode_block</span><span class="hljs-params">(....)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (stream_format_code &amp; <span class="hljs-number">0x1</span>)<font></font>
    imc_decode_level_coefficients_raw(....);<font></font>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (stream_format_code &amp; <span class="hljs-number">0x1</span>)<font></font>
    imc_read_level_coeffs_raw(....);<font></font>
  ....<font></font>
}</code></pre><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zip / Name</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Earlier we considered cases when the index or name is incorrect. </font><font style="vertical-align: inherit;">And here is a situation where you won‚Äôt immediately tell how to classify the error. </font><font style="vertical-align: inherit;">This example could be attributed to both one and the other chapter. </font><font style="vertical-align: inherit;">Therefore, I decided to bring it separately. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mesa 3D Graphics Library Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">bool</span>
<span class="hljs-title">ir_algebraic_visitor::reassociate_constant</span><span class="hljs-params">(....)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (ir1-&gt;operands[<span class="hljs-number">0</span>]-&gt;type-&gt;is_matrix() ||<font></font>
      ir1-&gt;operands[<span class="hljs-number">0</span>]-&gt;type-&gt;is_matrix() ||<font></font>
      ir2-&gt;operands[<span class="hljs-number">1</span>]-&gt;type-&gt;is_matrix() ||<font></font>
      ir2-&gt;operands[<span class="hljs-number">1</span>]-&gt;type-&gt;is_matrix())
   <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This code can be fixed like this:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">if</span> (ir1-&gt;operands[<span class="hljs-number">0</span>]-&gt;type-&gt;is_matrix() ||<font></font>
    ir1-&gt;operands[<span class="hljs-number">1</span>]-&gt;type-&gt;is_matrix() ||<font></font>
    ir2-&gt;operands[<span class="hljs-number">0</span>]-&gt;type-&gt;is_matrix() ||<font></font>
    ir2-&gt;operands[<span class="hljs-number">1</span>]-&gt;type-&gt;is_matrix())</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And you can fix it like this:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">if</span> (ir1-&gt;operands[<span class="hljs-number">0</span>]-&gt;type-&gt;is_matrix() ||<font></font>
    ir2-&gt;operands[<span class="hljs-number">0</span>]-&gt;type-&gt;is_matrix() ||<font></font>
    ir1-&gt;operands[<span class="hljs-number">1</span>]-&gt;type-&gt;is_matrix() ||<font></font>
    ir2-&gt;operands[<span class="hljs-number">1</span>]-&gt;type-&gt;is_matrix())</code></pre><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Extra 0</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sometimes 0 is redundant and harmful. </font><font style="vertical-align: inherit;">Because of it, the number can turn into octal where it is not needed. </font><font style="vertical-align: inherit;">Or spoil the format string. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The errors mentioned are not suitable for this article, but I think that it is worth mentioning them. </font><font style="vertical-align: inherit;">I will not give a code with these errors in the article, but if interested, you can look at them here:</font></font><ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V536</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Be advised that the utilized constant value is represented by an octal form, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">examples</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V638</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> A terminal null is present inside a string. </font><font style="vertical-align: inherit;">The '\ 0xNN' characters were encountered. </font><font style="vertical-align: inherit;">Probably meant: '\ xNN', </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">examples</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Forgot to write +1</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Haiku Operation System Project, C ++</font></font></b><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">int</span>
UserlandFS::KernelEmu::new_path(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *path, <span class="hljs-keyword">char</span> **copy)<font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-comment">// append a dot, if desired</span>
  <span class="hljs-keyword">if</span> (appendDot) {<font></font>
    copiedPath[len] = <span class="hljs-string">'.'</span>;<font></font>
    copiedPath[len] = <span class="hljs-string">'\0'</span>;<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The correct option:</font></font><br>
<pre><code class="cpp hljs">copiedPath[len] = <span class="hljs-string">'.'</span>;<font></font>
copiedPath[len + <span class="hljs-number">1</span>] = <span class="hljs-string">'\0'</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Note. </font><font style="vertical-align: inherit;">The situation when they forgot to add a unit is not at all rare. </font><font style="vertical-align: inherit;">I remember exactly that more than once I met such cases. </font><font style="vertical-align: inherit;">However, when I wanted to type similar examples for the article, I found only this example. </font><font style="vertical-align: inherit;">I'm sorry that I can not scare you with these errors more. </font><font style="vertical-align: inherit;">I apologize.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formatting Errors (C #)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Most often, functions for constructing strings operate with a small number of arguments. </font><font style="vertical-align: inherit;">So it turns out that most often errors are associated with the use of {0}, {1} or {2}. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Azure PowerShell Project, C #</font></font></b><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ProcessRecordInternal</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.ShouldProcess(<span class="hljs-keyword">this</span>.Name,
    <span class="hljs-keyword">string</span>.Format(<span class="hljs-string">"Creating Log Alert Rule '{0}' in resource group {0}"</span>,
      <span class="hljs-keyword">this</span>.Name, <span class="hljs-keyword">this</span>.ResourceGroupName)))<font></font>
  {<font></font>
    ....<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sealed up and wrote {0} twice. </font><font style="vertical-align: inherit;">As a result, the name </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this.Name</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will be inserted into the string twice </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">But the name </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this.ResourceGroupName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will not get into the created string. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mono Project, C #</font></font></b><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ReadEntropy</span> (<span class="hljs-params"></span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> (reader.IsEmptyElement)
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> XmlException (<font></font>
      String.Format (<span class="hljs-string">"WS-Trust Entropy element is empty.{2}"</span>,<font></font>
                      LineInfo ()));<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is generally strange. </font><font style="vertical-align: inherit;">You need to insert what is not. </font><font style="vertical-align: inherit;">Most likely, this code underwent unsuccessful refactoring and turned out to be broken. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xenko Project, C #</font></font></b><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-title">ToString</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> format,
                                IFormatProvider formatProvider</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> (format == <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">return</span> ToString(formatProvider);<font></font>
<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">string</span>.Format(<font></font>
                      formatProvider,<font></font>
                      <span class="hljs-string">"Red:{1} Green:{2} Blue:{3}"</span>,<font></font>
                      R.ToString(format, formatProvider),<font></font>
                      G.ToString(format, formatProvider),<font></font>
                      B.ToString(format, formatProvider));<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The programmer forgot that numbering starts with {0}, not {1}. </font><font style="vertical-align: inherit;">The correct code is:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">return</span> <span class="hljs-built_in">string</span>.Format(<font></font>
                    formatProvider,<font></font>
                    <span class="hljs-string">"Red:{0} Green:{1} Blue:{2}"</span>,<font></font>
                    R.ToString(format, formatProvider),<font></font>
                    G.ToString(format, formatProvider),<font></font>
                    B.ToString(format, formatProvider));</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.NET Compiler Platform Project, C #</font></font></b><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DumpAttributes</span>(<span class="hljs-params">Symbol s</span>)</span><font></font>
{<font></font>
  ....<font></font>
  Console.WriteLine(<span class="hljs-string">"{0} {1} {2}"</span>, pa.ToString());<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Arguments are clearly not enough.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusions and recommendations</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I had to demonstrate so many examples to show that typos related to 0, 1, and 2 deserve special attention. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If I simply said: ‚ÄúIt is easy to confuse o1 and o2‚Äù, you would agree, but not attach to it the meaning that you attach now, after reading or at least scrolling through the article. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now you are warned, and that‚Äôs good. Forewarned is forearmed. Now you will be more attentive to code reviews and pay extra attention to variables, in the names of which you will see 0, 1, 2. It is </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
difficult to give some recommendations on how the code is designed to avoid such errors. As you have seen, errors are found even in such simple code, where there is nothing to issue.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Therefore, I will not urge you to avoid 0, 1, 2 and give variables long names. If instead of numbers you start to write First / Second / Left / Right and so on, the temptation to copy the name or expression will be even greater. Perhaps such a recommendation will ultimately not reduce, but increase the number of errors. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nevertheless, when you write a lot of the same type of code, the recommendation of "tabular code design" is still relevant. Tabular formatting does not guarantee the absence of typos, but makes them easier and faster to notice. See chapter N13 in the mini-book " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The Main Question of Programming, Refactoring, and All That</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ." </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There is one more good news. All errors discussed in this article were found using the </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">PVS-Studio</font></a><font style="vertical-align: inherit;"> static code analyzer.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Accordingly, introducing static analysis tools into the development process, you can identify many typos at an early stage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thank you for the attention. </font><font style="vertical-align: inherit;">I hope you were interested and scared. </font><font style="vertical-align: inherit;">I wish you a reliable code and less error with 0, 1, 2, so that Freddy does not come to you.</font></font><br>
<br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="></a></p><div style="text-align:center;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/898/3b6/5a7/8983b65a74adb29a2113eba12fbec3f1.png"></a></div><p></p><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you want to share this article with an English-speaking audience, then please use the link to the translation: Andrey Karpov. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zero, one, two, Freddy's coming for you</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en488320/index.html">Deadlock Empire - a game for developers</a></li>
<li><a href="../en488322/index.html">Gestures</a></li>
<li><a href="../en488324/index.html">Console ghost. Panasonic M2</a></li>
<li><a href="../en488326/index.html">Love or dismissal</a></li>
<li><a href="../en488330/index.html">English with George Karlin: we analyze the ingenious stand-up about phraseological units</a></li>
<li><a href="../en488336/index.html">Tips for Using the Wave Function Collapse Algorithm</a></li>
<li><a href="../en488338/index.html">Google Internships: Zurich, London, and Silicon Valley</a></li>
<li><a href="../en488340/index.html">Profession: Backend Developer</a></li>
<li><a href="../en488342/index.html">Random Forest, the method of principal components and optimization of hyperparameters: an example of solving the classification problem in Python</a></li>
<li><a href="../en488346/index.html">Installing or-tools with SCIP and GLPK in a Python 3.7 virtual environment on Linux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>