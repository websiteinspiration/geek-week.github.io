<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§” â›©ï¸ ğŸ”“ Kotlin + Spring Boot + Vue.jsï¼ˆã‚¢ãƒ‰ã‚ªãƒ³ï¼‰ä¸Šã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ğŸŒ„ ğŸ’½ â°</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ã“ã‚“ã«ã¡ã¯ã€Habrã®è¦ªæ„›ãªã‚‹ä½æ°‘ï¼
 
 åå‰ãŒç¤ºã™ã‚ˆã†ã«ã€ã“ã®è¨˜äº‹ã¯Kotlin + Spring Boot + Vue.jsã§ä»¥å‰ã«ä½œæˆã•ã‚ŒãŸWebã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«è¿½åŠ ã•ã‚Œã‚‹ã‚‚ã®ã§ã™ã€‚
 
 è©±ã‚’å§‹ã‚ã‚‹å‰ã«ã€å‰å›ã®è¨˜äº‹ã§ã‚³ãƒ¡ãƒ³ãƒˆã—ã¦ãã‚ŒãŸçš†ã•ã‚“ã«æ„Ÿè¬ã—ã¾ã™ã€‚
 
 ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
 

- CI...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Kotlin + Spring Boot + Vue.jsï¼ˆã‚¢ãƒ‰ã‚ªãƒ³ï¼‰ä¸Šã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482222/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã‚“ã«ã¡ã¯ã€Habrã®è¦ªæ„›ãªã‚‹ä½æ°‘ï¼</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åå‰ãŒç¤ºã™ã‚ˆã†ã«ã€ã“ã®è¨˜äº‹ã¯</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kotlin + Spring Boot + Vue.js</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§</font><font style="vertical-align: inherit;">ä»¥å‰ã«ä½œæˆã•ã‚ŒãŸ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«</font></a><font style="vertical-align: inherit;">è¿½åŠ ã•ã‚Œã‚‹</font><font style="vertical-align: inherit;">ã‚‚ã®ã§ã™ã€‚</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è©±ã‚’å§‹ã‚ã‚‹å‰ã«ã€å‰å›ã®è¨˜äº‹ã§ã‚³ãƒ¡ãƒ³ãƒˆã—ã¦ãã‚ŒãŸçš†ã•ã‚“ã«æ„Ÿè¬ã—ã¾ã™ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</font></font></h3><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CI / CDã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆHerokuï¼‰</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒœãƒƒãƒˆä¿è­·ï¼ˆreCAPTCHAï¼‰</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¡ãƒ¼ãƒ«é€ä¿¡</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gradleã®ç§»è¡Œ</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’Cookieã«ä¿å­˜ã™ã‚‹</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¡ãƒ¼ãƒ«ç™»éŒ²ç¢ºèª</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å½¹ç«‹ã¤ãƒªãƒ³ã‚¯</font></font></a></li>
</ul><br>
<a name="cicd"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CI / CDã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆHerokuï¼‰</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¾‹ã¨ã—ã¦ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Heroku</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¯ãƒ©ã‚¦ãƒ‰PaaSãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½¿ç”¨ã—ãŸç¶™ç¶šçš„ãªçµ±åˆã¨é…ä¿¡ã®å®Ÿè£…ã‚’æ¤œè¨ã—ã¦ãã ã•ã„</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãšã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã®ãƒªãƒã‚¸ãƒˆãƒªã«é…ç½®ã™ã‚‹å¿…è¦ãŒã‚ã‚Š</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ã¾ã™</font></a><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ãƒªãƒã‚¸ãƒˆãƒªã«ä½™åˆ†ãªã‚‚ã®ãŒãªã„ã‚ˆã†ã«ã€</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.gitignore</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¬¡ã®å†…å®¹ã‚’ãŠå‹§ã‚ã—ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.gitignore</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">*.class<font></font>
<font></font>
# Help #<font></font>
backend/*.md<font></font>
<font></font>
# Package Files #<font></font>
*.jar<font></font>
*.war<font></font>
*.ear<font></font>
<font></font>
# Eclipse #<font></font>
.settings<font></font>
.project<font></font>
.classpath<font></font>
.studio<font></font>
target<font></font>
<font></font>
# NetBeans #<font></font>
backend/nbproject/private/<font></font>
backend/nbbuild/<font></font>
backend/dist/<font></font>
backend/nbdist/<font></font>
backend/.nb-gradle/<font></font>
backend/build/<font></font>
<font></font>
# Apple # <font></font>
.DS_Store<font></font>
<font></font>
# Intellij #<font></font>
.idea<font></font>
*.iml<font></font>
*.log<font></font>
<font></font>
# logback<font></font>
logback.out.xml<font></font>
<font></font>
backend/src/main/resources/public/<font></font>
backend/target<font></font>
backend/.mvn<font></font>
backend/mvnw<font></font>
frontend/dist/<font></font>
frontend/node/<font></font>
frontend/node_modules/<font></font>
frontend/npm-debug.log<font></font>
frontend/target<font></font>
<font></font>
!.mvn/wrapper/maven-wrapper.jar<font></font>
</code></pre><br>
</div></div><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é‡è¦ï¼š</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚ãªãŸã¯Herokuã®ã§ä½œæ¥­ã‚’é–‹å§‹ã™ã‚‹å‰ã«ã€ã¨å‘¼ã°ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Procfileã‚’</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆæ‹¡å¼µå­ãªã—ï¼‰</font><font style="vertical-align: inherit;">ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«</font><font style="vertical-align: inherit;">ãƒ©ã‚¤ãƒ³ã‚’æŒã¤ï¼š</font></font><br>
<code>web: java -Dserver.port=$PORT -jar backend/target/backend-0.0.1-SNAPSHOT.jar</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã©ã“</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰-0.0.1-SNAPSHOT.jarã«ã¯ã€</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çµ„ã¿ç«‹ã¦ã‚‰ã‚Œã‚‹JARãƒ•ã‚¡ã‚¤ãƒ«ã®åå‰ã§ã™ã€‚</font><font style="vertical-align: inherit;">ãã—ã¦ã€å¿…ãš</font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒŸãƒƒãƒˆã—ã¦ãƒ—ãƒƒã‚·ãƒ¥ã—ã¦ãã ã•ã„</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ³¨ï¼š</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> travis.yamlãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«è¿½åŠ ã—ã¦ã€Herokuã§ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ“ãƒ«ãƒ‰ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ã®æ™‚é–“ã‚’çŸ­ç¸®ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">travis.yaml</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">language: java<font></font>
jdk:<font></font>
- oraclejdk8<font></font>
script: mvn clean install jacoco:report coveralls:report<font></font>
cache:<font></font>
     directories:<font></font>
     - node_modules </code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ï¼š</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ1 </font></font></b><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Herokuã«</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç™»éŒ²ã—</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–°ã—ã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–°ã—ã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/u3/ml/bx/u3mlbx0w2ho3uezsrl75nyse2m4.png"><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Herokuã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€PostreSQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãªã©ã®è¿½åŠ ãƒªã‚½ãƒ¼ã‚¹ã‚’ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«æ¥ç¶šã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã‚’è¡Œã†ã«ã¯ã€æ¬¡ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³-&gt;ãƒªã‚½ãƒ¼ã‚¹-&gt;ã‚¢ãƒ‰ã‚ªãƒ³-&gt; Heroku Postgres</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Heroku Postgres</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/k5/l8/ht/k5l8htgji3kaxmqyznbdqhyeuki.png"><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ—ãƒ©ãƒ³ã‚’é¸æŠï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¨ˆç”»ã®é¸æŠ</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/id/jv/vd/idjvvdwyyk9ou_wbes00mxvfdac.png"><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ5</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã‚Œã§ã€æ¥ç¶šã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã‚’ç¢ºèªã§ãã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¥ç¶šã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/l2/mx/mf/l2mxmf3itjef2-1lpiwmltrtadq.png"><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ6</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è³‡æ ¼æƒ…å ±ã‚’ç¢ºèªã—ã¾ã™ã€‚ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã™ã‚‹ãŸã‚ã«å¿…è¦ã§ã™ã€‚</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¨­å®š-&gt;è³‡æ ¼æƒ…å ±ã®è¡¨ç¤º</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è³‡æ ¼æƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/gh/xl/v9/ghxlv99r9m2mgrr6ceemgpn-hjg.png"><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ7</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¾ã™ï¼š</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³-&gt;è¨­å®š-&gt;æ§‹æˆ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¤‰æ•°ã‚’è¡¨ç¤º</font><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç’°å¢ƒå¤‰æ•°</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/xr/uj/q8/xrujq8lynqi6kqoqtqiklpwbaxu.png"><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ8</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¥ç¶šã®ç’°å¢ƒå¤‰æ•°ã‚’æ¬¡ã®å½¢å¼ã§è¨­å®šã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">SPRING_DATASOURCE_URL = jdbc:postgresql://&lt;i&gt;hostname:port&lt;/i&gt;/&lt;i&gt;db_name&lt;/i&gt;<font></font>
SPRING_DATASOURCE_USERNAME = &lt;i&gt;username&lt;/i&gt;<font></font>
SPRING_DATASOURCE_PASSWORD = &lt;i&gt;password&lt;/i&gt;<font></font>
</code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãã‚Œã¯ã©ã®ã‚ˆã†ã«è¦‹ãˆã¾ã™ã‹</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/me/jr/ne/mejrnecja54rgwchq6peumbc6w0.png"><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ9</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«å¿…è¦ãªã™ã¹ã¦ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ10</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> application.propertiesãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€ãã‚Œãã‚Œæ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application.properties</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">spring.datasource.url=${SPRING_DATASOURCE_URL}<font></font>
spring.datasource.username=${SPRING_DATASOURCE_USERNAME}<font></font>
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD}<font></font>
<font></font>
spring.jpa.generate-ddl=true<font></font>
spring.jpa.properties.hibernate.temp.use_jdbc_metadata_defaults = false<font></font>
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQL9Dialect<font></font>
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true <font></font>
</code></pre><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ11 </font></font></b><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–°ã—ã„ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½œæˆã™ã‚‹- </font><i><font style="vertical-align: inherit;">æ–°ã—ã„ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’ä½œæˆã—ã¾ã™</font></i><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–°ã—ã„ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’ä½œæˆã™ã‚‹</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/dh/sg/wb/dhsgwbhgaz9arzl4lgwkdoykeda.png"><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ12</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-GitHub</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ[ </font><i><font style="vertical-align: inherit;">GitHubã«</font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¥ç¶š</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]ã‚’ã‚¯ãƒªãƒƒã‚¯</font><font style="vertical-align: inherit;">ã—ã€æ–°ã—ã„ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®æŒ‡ç¤ºã«å¾“ã„ã¾ã™ï¼‰ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ13</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è‡ªå‹•å±•é–‹ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ã™ã‚‹-è‡ªå‹•å±•é–‹ã‚’</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ‰åŠ¹ã«ã™ã‚‹</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’æœ‰åŠ¹ã«ã™ã‚‹</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/8e/fb/ui/8efbuinhnr0y1j7eggqkhbjae2s.png"><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ14</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰‹å‹•å±•é–‹- </font><font style="vertical-align: inherit;">æœ€åˆã®å±•é–‹ã®</font><font style="vertical-align: inherit;">[ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å±•é–‹ãƒ–ãƒ©ãƒ³ãƒ]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’</font><font style="vertical-align: inherit;">ã‚¯ãƒªãƒƒã‚¯ã—</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ–ãƒ©ã‚¦ã‚¶ã®å³å´ã«ã€ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã®å‡ºåŠ›ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰‹å‹•å±•é–‹</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/7i/5m/tz/7i5mtzam___vhonxjbtuogrg-ay.png"><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ15</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ“ãƒ«ãƒ‰ãŒæˆåŠŸã—ãŸå¾Œã§</font><font style="vertical-align: inherit;">[ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¡¨ç¤º]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’</font><font style="vertical-align: inherit;">ã‚¯ãƒªãƒƒã‚¯</font><font style="vertical-align: inherit;">ã—ã¦ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚ŒãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹ãã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¦‹ã‚‹</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/cp/p-/fr/cpp-frnkeudluh4bm1ir-f4oi10.png"><br>
</div></div><br>
<a name="recaptcha"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒœãƒƒãƒˆä¿è­·ï¼ˆreCAPTCHAï¼‰</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§reCAPTCHAæ¤œè¨¼ã‚’æœ‰åŠ¹ã«ã™ã‚‹æœ€åˆã®ã‚¹ãƒ†ãƒƒãƒ—ã¯</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€Googleç®¡ç†ãƒ‘ãƒãƒ«</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§æ–°ã—ã„reCAPTCHã‚’ä½œæˆã™ã‚‹ã“ã¨</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ã§ã™</font></a><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ãã“ã§æ–°ã—ã„ã‚µã‚¤ãƒˆã‚’ä½œæˆã—ï¼ˆæ–°ã—ã„ã‚µã‚¤ãƒˆã®è¿½åŠ /ä½œæˆï¼‰ã€æ¬¡ã®è¨­å®šã‚’è¡Œã„ã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReCAPTCHAè¨­å®š</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/xi/eh/rp/xiehrpgngjvxqvd1dq-4wp5gfqc.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‰ãƒ¡ã‚¤ãƒ³]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚»ã‚¯ã‚·ãƒ§ãƒ³</font><font style="vertical-align: inherit;">ã§ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒå­˜åœ¨ã™ã‚‹ã‚¢ãƒ‰ãƒ¬ã‚¹ã«åŠ ãˆã¦ã€</font></font><code>localhost</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‡ãƒãƒƒã‚°ä¸­ã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãƒ­ã‚°ã‚¤ãƒ³ã§ããªã„ã¨ã„ã†å½¢ã§ãƒˆãƒ©ãƒ–ãƒ«ã‚’å›é¿ã™ã‚‹ã“ã¨ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰</font></font></b><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">ã‚µã‚¤ãƒˆã‚­ãƒ¼</font></i><font style="vertical-align: inherit;">ã¨</font><i><font style="vertical-align: inherit;">ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚­ãƒ¼ã‚’</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ä¿å­˜ã—</font><i><font style="vertical-align: inherit;">ã¾ã™</font></i><font style="vertical-align: inherit;"> ...</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚µã‚¤ãƒˆã‚­ãƒ¼/ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚­ãƒ¼</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/hs/re/-t/hsre-ttxpgbhgau9q4fsvtdqxq0.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...æ¬¡ã«ã€ãã‚Œã‚‰ã‚’ç’°å¢ƒå¤‰æ•°ã«å‰²ã‚Šå½“ã¦ã€æ¬¡ã«å¤‰æ•°åã‚’æ–°ã—ã„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application.properties</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«å‰²ã‚Šå½“ã¦ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">google.recaptcha.key.site=${GOOGLE_RECAPTCHA_KEY_SITE}<font></font>
google.recaptcha.key.secret=${GOOGLE_RECAPTCHA_KEY_SECRET}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒGoogleã«é€ä¿¡ã™ã‚‹Google reCAPTCHAãƒˆãƒ¼ã‚¯ãƒ³ã®å´ã§æ¤œè¨¼ã™ã‚‹ãŸã‚ã«</font><font style="vertical-align: inherit;">
ã€</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pom.xmlã«</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–°ã—ã„ä¾å­˜é–¢ä¿‚ã‚’è¿½åŠ </font><font style="vertical-align: inherit;">ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.mashape.unirest<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>unirest-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.4.9<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€åŒã˜reCAPTCHAãƒˆãƒ¼ã‚¯ãƒ³ã«æ–‡å­—åˆ—ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ ã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ‰¿èªã¨ç™»éŒ²ã«ä½¿ç”¨ã™ã‚‹ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’æ›´æ–°ã—ã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LoginUser.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">import</span> com.fasterxml.jackson.<span class="hljs-keyword">annotation</span>.JsonProperty
<span class="hljs-keyword">import</span> java.io.Serializable<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoginUser</span> : <span class="hljs-type">Serializable {</span></span><font></font>
<font></font>
   <span class="hljs-meta">@JsonProperty(<span class="hljs-meta-string">"username"</span>)</span>
   <span class="hljs-keyword">var</span> username: String? = <span class="hljs-literal">null</span><font></font>
<font></font>
   <span class="hljs-meta">@JsonProperty(<span class="hljs-meta-string">"password"</span>)</span>
   <span class="hljs-keyword">var</span> password: String? = <span class="hljs-literal">null</span><font></font>
<font></font>
   <span class="hljs-meta">@JsonProperty(<span class="hljs-meta-string">"recapctha_token"</span>)</span>
   <span class="hljs-keyword">var</span> recaptchaToken: String? = <span class="hljs-literal">null</span><font></font>
<font></font>
   <span class="hljs-keyword">constructor</span>() {}<font></font>
<font></font>
   <span class="hljs-keyword">constructor</span>(username: String, password: String, recaptchaToken: String) {
       <span class="hljs-keyword">this</span>.username = username
       <span class="hljs-keyword">this</span>.password = password
       <span class="hljs-keyword">this</span>.recaptchaToken = recaptchaToken<font></font>
   }<font></font>
<font></font>
   <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {<font></font>
<font></font>
       <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> serialVersionUID = -<span class="hljs-number">1764970284520387975L</span><font></font>
   }<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewUser.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">import</span> com.fasterxml.jackson.<span class="hljs-keyword">annotation</span>.JsonProperty
<span class="hljs-keyword">import</span> java.io.Serializable<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NewUser</span> : <span class="hljs-type">Serializable {</span></span><font></font>
<font></font>
   <span class="hljs-meta">@JsonProperty(<span class="hljs-meta-string">"username"</span>)</span>
   <span class="hljs-keyword">var</span> username: String? = <span class="hljs-literal">null</span><font></font>
<font></font>
   <span class="hljs-meta">@JsonProperty(<span class="hljs-meta-string">"firstName"</span>)</span>
   <span class="hljs-keyword">var</span> firstName: String? = <span class="hljs-literal">null</span><font></font>
<font></font>
   <span class="hljs-meta">@JsonProperty(<span class="hljs-meta-string">"lastName"</span>)</span>
   <span class="hljs-keyword">var</span> lastName: String? = <span class="hljs-literal">null</span><font></font>
<font></font>
   <span class="hljs-meta">@JsonProperty(<span class="hljs-meta-string">"email"</span>)</span>
   <span class="hljs-keyword">var</span> email: String? = <span class="hljs-literal">null</span><font></font>
<font></font>
   <span class="hljs-meta">@JsonProperty(<span class="hljs-meta-string">"password"</span>)</span>
   <span class="hljs-keyword">var</span> password: String? = <span class="hljs-literal">null</span><font></font>
<font></font>
   <span class="hljs-meta">@JsonProperty(<span class="hljs-meta-string">"recapctha_token"</span>)</span>
   <span class="hljs-keyword">var</span> recaptchaToken: String? = <span class="hljs-literal">null</span><font></font>
<font></font>
   <span class="hljs-keyword">constructor</span>() {}<font></font>
<font></font>
   <span class="hljs-keyword">constructor</span>(username: String, firstName: String, lastName: String, email: String, password: String, recaptchaToken: String) {
       <span class="hljs-keyword">this</span>.username = username
       <span class="hljs-keyword">this</span>.firstName = firstName
       <span class="hljs-keyword">this</span>.lastName = lastName
       <span class="hljs-keyword">this</span>.email = email
       <span class="hljs-keyword">this</span>.password = password
       <span class="hljs-keyword">this</span>.recaptchaToken = recaptchaToken<font></font>
   }<font></font>
<font></font>
   <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {<font></font>
<font></font>
       <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> serialVersionUID = -<span class="hljs-number">1764970284520387975L</span><font></font>
   }<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
reCAPTCHAãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç‰¹åˆ¥ãªGoogleã‚µãƒ¼ãƒ“ã‚¹ã«ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆã™ã‚‹å°ã•ãªã‚µãƒ¼ãƒ“ã‚¹ã‚’è¿½åŠ ã—ã€ãƒˆãƒ¼ã‚¯ãƒ³ãŒæ¤œè¨¼ã«åˆæ ¼ã—ãŸã‹ã©ã†ã‹ã«å¿œã˜ã¦é€šçŸ¥ã—ã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReCaptchaService.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">import</span> org.springframework.beans.factory.<span class="hljs-keyword">annotation</span>.Value
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service
<span class="hljs-keyword">import</span> org.springframework.web.client.RestOperations
<span class="hljs-keyword">import</span> org.springframework.beans.factory.<span class="hljs-keyword">annotation</span>.Autowired
<span class="hljs-keyword">import</span> com.mashape.unirest.http.HttpResponse
<span class="hljs-keyword">import</span> com.mashape.unirest.http.JsonNode
<span class="hljs-keyword">import</span> com.mashape.unirest.http.Unirest<font></font>
<font></font>
<font></font>
<span class="hljs-meta">@Service(<span class="hljs-meta-string">"captchaService"</span>)</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReCaptchaService</span> </span>{<font></font>
<font></font>
   <span class="hljs-keyword">val</span> BASE_VERIFY_URL: String = <span class="hljs-string">"https://www.google.com/recaptcha/api/siteverify"</span><font></font>
<font></font>
   <span class="hljs-meta">@Autowired</span>
   <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> restTemplate: RestOperations? = <span class="hljs-literal">null</span><font></font>
<font></font>
   <span class="hljs-meta">@Value(<span class="hljs-meta-string">"\${google.recaptcha.key.site}"</span>)</span>
   <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> keySite: String<font></font>
<font></font>
   <span class="hljs-meta">@Value(<span class="hljs-meta-string">"\${google.recaptcha.key.secret}"</span>)</span>
   <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> keySecret: String<font></font>
<font></font>
   <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">validateCaptcha</span><span class="hljs-params">(token: <span class="hljs-type">String</span>)</span></span>: <span class="hljs-built_in">Boolean</span> {<font></font>
<font></font>
       <span class="hljs-keyword">val</span> url: String = String.format(BASE_VERIFY_URL + <span class="hljs-string">"?secret=%s&amp;response=%s"</span>, keySecret, token)<font></font>
<font></font>
       <span class="hljs-keyword">val</span> jsonResponse: HttpResponse&lt;JsonNode&gt; = Unirest.<span class="hljs-keyword">get</span>(url)<font></font>
               .header(<span class="hljs-string">"accept"</span>, <span class="hljs-string">"application/json"</span>).queryString(<span class="hljs-string">"apiKey"</span>, <span class="hljs-string">"123"</span>)<font></font>
               .asJson()<font></font>
<font></font>
       <span class="hljs-keyword">return</span> (jsonResponse.getStatus() == <span class="hljs-number">200</span>)<font></font>
   }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ãŠã‚ˆã³è¨±å¯ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã§ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AuthController.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">import</span> com.kotlinspringvue.backend.service.ReCaptchaService<font></font>
<font></font>
â€¦ <font></font>
<font></font>
<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> captchaService: ReCaptchaService<font></font>
<font></font>
â€¦ <font></font>
<font></font>
<span class="hljs-keyword">if</span> (!captchaService.validateCaptcha(loginRequest.recaptchaToken!!)) {
     <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Validation failed (ReCaptcha v2)"</span>),<font></font>
     HttpStatus.BAD_REQUEST)<font></font>
}<font></font>
<span class="hljs-keyword">else</span> [<span class="hljs-keyword">if</span>]...<font></font>
<font></font>
â€¦ <font></font>
<font></font>
<span class="hljs-keyword">if</span> (!captchaService.validateCaptcha(newUser.recaptchaToken!!)) {
     <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Validation failed (ReCaptcha v2)"</span>),<font></font>
     HttpStatus.BAD_REQUEST)<font></font>
} <span class="hljs-keyword">else</span>...
</code></pre><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
æœ€åˆã®ã‚¹ãƒ†ãƒƒãƒ—ã¯ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ä¿å­˜ã™ã‚‹ã“ã¨</font></font><code>reCAPTHA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§ã™ï¼š</font></font><br>
<br>
<pre><code class="plaintext hljs">$ npm install --save vue-recaptcha</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">index.html</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«æ¥ç¶šã—ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://www.google.com/recaptcha/api.js onload=vueRecaptchaApiLoaded&amp;render=explicit"</span> <span class="hljs-attr">async</span> <span class="hljs-attr">defer</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒšãƒ¼ã‚¸ã®ä»»æ„ã®ç©ºãã‚¹ãƒšãƒ¼ã‚¹ã«ã‚­ãƒ£ãƒ—ãƒãƒ£ã‚’è¿½åŠ ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">vue-recaptcha</span>
     <span class="hljs-attr">ref</span>=<span class="hljs-string">"recaptcha"</span>
     <span class="hljs-attr">size</span>=<span class="hljs-string">"invisible"</span>
     <span class="hljs-attr">:sitekey</span>=<span class="hljs-string">"sitekey"</span>
     @<span class="hljs-attr">verify</span>=<span class="hljs-string">"onCapthcaVerified"</span>
     @<span class="hljs-attr">expired</span>=<span class="hljs-string">"onCaptchaExpired"</span>
/&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆæ‰¿èªã¾ãŸã¯ç™»éŒ²ï¼‰ã®ãƒœã‚¿ãƒ³ã¯ã€æœ€åˆã«æ¤œè¨¼ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">b-button</span> <span class="hljs-attr">v-on:click</span>=<span class="hljs-string">"validateCaptcha"</span> <span class="hljs-attr">variant</span>=<span class="hljs-string">"primary"</span>&gt;</span>Login<span class="hljs-tag">&lt;/<span class="hljs-name">b-button</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ä¾å­˜é–¢ä¿‚ã‚’è¿½åŠ ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> VueRecaptcha <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-recaptcha'</span></code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚’</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ç·¨é›†</font><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="javascript hljs">
<span class="hljs-attr">components</span>: { VueRecaptcha },<font></font>
â€¦<font></font>
data() {<font></font>
â€¦<font></font>
<span class="hljs-attr">siteKey</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">i</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span></span><font></font>
â€¦<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦ã€æ–°ã—ã„ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚</font></font><br>
<br>
<ul>
<li><code>validateCaptcha()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨å‘¼ã³å‡ºã•ã‚Œã¾ã™</font></font></li>
<li><code>onCapthcaVerified(recaptchaToken)  onCaptchaExpired()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -ã‚­ãƒ£ãƒ—ãƒãƒ£è‡ªä½“ãŒåŸå› </font></font></li>
</ul><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–°ã—ã„æ–¹æ³•</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs"><font></font>
validateCaptcha() {<font></font>
     <span class="hljs-keyword">this</span>.$refs.recaptcha.execute()<font></font>
},<font></font>
<font></font>
onCapthcaVerified(recaptchaToken) {<font></font>
<font></font>
     AXIOS.post(<span class="hljs-string">`/auth/signin`</span>, {<span class="hljs-string">'username'</span>: <span class="hljs-keyword">this</span>.$data.username, <span class="hljs-string">'password'</span>: <span class="hljs-keyword">this</span>.$data.password, <span class="hljs-string">'recapctha_token'</span>: recaptchaToken})<font></font>
     .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
          <span class="hljs-keyword">this</span>.$store.dispatch(<span class="hljs-string">'login'</span>, {<span class="hljs-string">'token'</span>: response.data.accessToken, <span class="hljs-string">'roles'</span>: response.data.authorities, <span class="hljs-string">'username'</span>: response.data.username});
          <span class="hljs-keyword">this</span>.$router.push(<span class="hljs-string">'/home'</span>)<font></font>
     }, error =&gt; {<font></font>
          <span class="hljs-keyword">this</span>.showAlert(error.response.data.message);<font></font>
  })<font></font>
     .catch(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
     <span class="hljs-built_in">console</span>.log(e);
            <span class="hljs-keyword">this</span>.showAlert(<span class="hljs-string">'Server error. Please, report this error website owners'</span>);<font></font>
  })<font></font>
},<font></font>
onCaptchaExpired() {<font></font>
   <span class="hljs-keyword">this</span>.$refs.recaptcha.reset()<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çµæœ</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/m0/rc/w9/m0rcw9xjgqjqpgiuwdib16_mur8.png"><br>
</div></div><br>
<a name="email"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¡ãƒ¼ãƒ«é€ä¿¡</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Googleã‚„Mail.ruãªã©ã®ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒãƒ¼ã‚’ä»‹ã—ã¦ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«æ‰‹ç´™ã‚’é€ã‚‹å¯èƒ½æ€§ã‚’æ¤œè¨ã—ã¦ãã ã•ã„ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã‚Œãã‚Œã®æœ€åˆã®ã‚¹ãƒ†ãƒƒãƒ—ã¯ã€é¸æŠã•ã‚ŒãŸãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒãƒ¼ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹ã“ã¨ã§ã™ï¼ˆã¾ã ä½œæˆã•ã‚Œã¦ã„ãªã„å ´åˆï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã¯ã€</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pom.xmlã«</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¬¡ã®ä¾å­˜é–¢ä¿‚ã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¾å­˜é–¢ä¿‚</font></font></b><div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-mail<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-io<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-io<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãŸã€</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application.propertiesã«</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–°ã—ã„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Š</font><i><font style="vertical-align: inherit;">ã¾ã™</font></i><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SMTPãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">spring.mail.host=${SMTP_MAIL_HOST}<font></font>
spring.mail.port=${SMTP_MAIL_PORT}<font></font>
spring.mail.username=${SMTP_MAIL_USERNAME}<font></font>
spring.mail.password=${SMTP_MAIL_PASSWORD}<font></font>
spring.mail.properties.mail.smtp.auth=true<font></font>
spring.mail.properties.mail.smtp.starttls.enable=true<font></font>
spring.mail.properties.mail.smtp.ssl.enable=true<font></font>
spring.mail.properties.mail.smtp.connectiontimeout=5000<font></font>
spring.mail.properties.mail.smtp.timeout=5000<font></font>
spring.mail.properties.mail.smtp.writetimeout=5000<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã“ã§SMTPè¨­å®šã‚’æŒ‡å®šã§ãã¾ã™ï¼š</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mail.ru</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ã„ãã¤ã‹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®£è¨€ã™ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ä½œæˆã—ã¾ã—ã‚‡ã†ï¼š</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šå¸¸ã®ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã™ã‚‹ã«ã¯</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTMLãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã™ã‚‹ã«ã¯</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¦ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã™ã‚‹ã«ã¯</font></font></li>
</ul><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EmailService.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">package</span> com.kotlinspringvue.backend.email<font></font>
<font></font>
<span class="hljs-keyword">import</span> org.springframework.mail.SimpleMailMessage<font></font>
<font></font>
<span class="hljs-keyword">internal</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">EmailService</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendSimpleMessage</span><span class="hljs-params">(to: <span class="hljs-type">String</span>,
                          subject: <span class="hljs-type">String</span>,
                          text: <span class="hljs-type">String</span>)</span></span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendSimpleMessageUsingTemplate</span><span class="hljs-params">(to: <span class="hljs-type">String</span>,
                                       subject: <span class="hljs-type">String</span>,
                                       template: <span class="hljs-type">String</span>,
                                       params:<span class="hljs-type">MutableMap</span>&lt;<span class="hljs-type">String</span>, Any&gt;)</span></span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendHtmlMessage</span><span class="hljs-params">(to: <span class="hljs-type">String</span>,
                        subject: <span class="hljs-type">String</span>,
                        htmlMsg: <span class="hljs-type">String</span>)</span></span><font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ã“ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®å®Ÿè£…ã‚’ä½œæˆã—ã¾ã—ã‚‡ã†-é›»å­ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EmailServiceImpl.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">package</span> com.kotlinspringvue.backend.email<font></font>
<font></font>
<span class="hljs-keyword">import</span> org.springframework.beans.factory.<span class="hljs-keyword">annotation</span>.Autowired
<span class="hljs-keyword">import</span> org.springframework.beans.factory.<span class="hljs-keyword">annotation</span>.Value
<span class="hljs-keyword">import</span> org.springframework.core.io.FileSystemResource
<span class="hljs-keyword">import</span> org.springframework.mail.MailException
<span class="hljs-keyword">import</span> org.springframework.mail.SimpleMailMessage
<span class="hljs-keyword">import</span> org.springframework.mail.javamail.JavaMailSender
<span class="hljs-keyword">import</span> org.springframework.mail.javamail.MimeMessageHelper
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component
<span class="hljs-keyword">import</span> org.thymeleaf.spring5.SpringTemplateEngine
<span class="hljs-keyword">import</span> org.thymeleaf.context.Context
<span class="hljs-keyword">import</span> java.io.File
<span class="hljs-keyword">import</span> javax.mail.MessagingException
<span class="hljs-keyword">import</span> javax.mail.internet.MimeMessage
<span class="hljs-keyword">import</span> org.apache.commons.io.IOUtils
<span class="hljs-keyword">import</span> org.springframework.core.env.Environment<font></font>
<font></font>
<span class="hljs-meta">@Component</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EmailServiceImpl</span> : <span class="hljs-type">EmailService {</span></span><font></font>
<font></font>
    <span class="hljs-meta">@Value(<span class="hljs-meta-string">"\${spring.mail.username}"</span>)</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> sender: String<font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> environment: Environment<font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">var</span> emailSender: JavaMailSender? = <span class="hljs-literal">null</span><font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> templateEngine: SpringTemplateEngine<font></font>
<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendSimpleMessage</span><span class="hljs-params">(to: <span class="hljs-type">String</span>, subject: <span class="hljs-type">String</span>, text: <span class="hljs-type">String</span>)</span></span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">val</span> message = SimpleMailMessage()<font></font>
            message.setTo(to)<font></font>
            message.setFrom(sender)<font></font>
            message.setSubject(subject)<font></font>
            message.setText(text)<font></font>
<font></font>
            emailSender!!.send(message)<font></font>
        } <span class="hljs-keyword">catch</span> (exception: MailException) {<font></font>
            exception.printStackTrace()<font></font>
        }<font></font>
<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendSimpleMessageUsingTemplate</span><span class="hljs-params">(to: <span class="hljs-type">String</span>,
                                                subject: <span class="hljs-type">String</span>,
                                                template: <span class="hljs-type">String</span>,
                                                params:<span class="hljs-type">MutableMap</span>&lt;<span class="hljs-type">String</span>, Any&gt;)</span></span> {
        <span class="hljs-keyword">val</span> message = emailSender!!.createMimeMessage()
        <span class="hljs-keyword">val</span> helper = MimeMessageHelper(message, <span class="hljs-literal">true</span>, <span class="hljs-string">"utf-8"</span>)
        <span class="hljs-keyword">var</span> context: Context = Context()<font></font>
        context.setVariables(params)<font></font>
        <span class="hljs-keyword">val</span> html: String = templateEngine.process(template, context)<font></font>
<font></font>
        helper.setTo(to)<font></font>
        helper.setFrom(sender)<font></font>
        helper.setText(html, <span class="hljs-literal">true</span>)<font></font>
        helper.setSubject(subject)<font></font>
<font></font>
        emailSender!!.send(message)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendHtmlMessage</span><span class="hljs-params">(to: <span class="hljs-type">String</span>, subject: <span class="hljs-type">String</span>, htmlMsg: <span class="hljs-type">String</span>)</span></span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">val</span> message = emailSender!!.createMimeMessage()<font></font>
            message.setContent(htmlMsg, <span class="hljs-string">"text/html"</span>)<font></font>
<font></font>
            <span class="hljs-keyword">val</span> helper = MimeMessageHelper(message, <span class="hljs-literal">false</span>, <span class="hljs-string">"utf-8"</span>)<font></font>
<font></font>
            helper.setTo(to)<font></font>
            helper.setFrom(sender)<font></font>
            helper.setSubject(subject)<font></font>
<font></font>
            emailSender!!.send(message)<font></font>
        } <span class="hljs-keyword">catch</span> (exception: MailException) {<font></font>
            exception.printStackTrace()<font></font>
        }<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Springã®è‡ªå‹•è¨­å®šã•ã‚ŒãŸJavaMailSenderã‚’ä½¿ç”¨ã—ã¦ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¾ã™</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šå¸¸ã®æ‰‹ç´™ã‚’é€ã‚‹ã®ã¯éå¸¸ã«ç°¡å˜ã§ã™-æ‰‹ç´™ã®æœ¬æ–‡ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’è¿½åŠ ã—ã¦é€ä¿¡ã™ã‚‹ã ã‘ã§ã™</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTMLãƒ¡ãƒ¼ãƒ«ã¯MIMEã‚¿ã‚¤ãƒ—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã—ã¦å®šç¾©ã•ã‚Œã€ãã®å†…å®¹ã¯æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¾ã™ã€‚ </font></font><code>text/html</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTMLãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å‡¦ç†ã™ã‚‹ã«ã¯ã€Springãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’ä½¿ç”¨ã—ã¾ã™</font></font></li>
</ul><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Thymeleaf</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ç”¨ã—ã¦æ›¸ãè¾¼ã‚€ãŸã‚ã®ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">src / main / resources / templates /ã«</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é…ç½®ã—ã¦</font><font style="vertical-align: inherit;">ã¿ã¾ã—ã‚‡ã†</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">emailTemplate.html</font></font></b><div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://www.w3.org/1999/xhtml"</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">"http://www.thymeleaf.org"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Hello<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"font-family: Arial, Helvetica, sans-serif;"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Hello!<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"margin-top: 20px; margin-bottom: 30px; margin-left: 20px;"</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Hello, dear: <span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">"${addresseeName}"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">th:src</span>=<span class="hljs-string">"${signatureImage}"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"200px;"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®å¤‰æ›´è¦ç´ ï¼ˆã“ã®å ´åˆã€å—ä¿¡è€…ã®åå‰ã¨ç½²åç”¨ã®ç”»åƒã®ãƒ‘ã‚¹ï¼‰ã¯ã€ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’ä½¿ç”¨ã—ã¦å®£è¨€ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€æ‰‹ç´™ã‚’é€ã‚‹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‚’ä½œæˆã¾ãŸã¯æ›´æ–°ã—ã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BackendController.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">import</span> com.kotlinspringvue.backend.email.EmailServiceImpl
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.web.response.ResponseMessage
<span class="hljs-keyword">import</span> org.springframework.beans.factory.<span class="hljs-keyword">annotation</span>.Value
<span class="hljs-keyword">import</span> org.springframework.http.ResponseEntity
<span class="hljs-keyword">import</span> org.springframework.http.HttpStatus<font></font>
<font></font>
â€¦ <font></font>
<font></font>
<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> emailService: EmailService<font></font>
<font></font>
<span class="hljs-meta">@Value(<span class="hljs-meta-string">"\${spring.mail.username}"</span>)</span>
<span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> addressee: String<font></font>
<font></font>
â€¦ <font></font>
<font></font>
<span class="hljs-meta">@GetMapping(<span class="hljs-meta-string">"/sendSimpleEmail"</span>)</span>
<span class="hljs-meta">@PreAuthorize(<span class="hljs-meta-string">"hasRole('USER')"</span>)</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendSimpleEmail</span><span class="hljs-params">()</span></span>: ResponseEntity&lt;*&gt; {
     <span class="hljs-keyword">try</span> {<font></font>
          emailService.sendSimpleMessage(addressee, <span class="hljs-string">"Simple Email"</span>, <span class="hljs-string">"Hello! This is simple email"</span>)<font></font>
     } <span class="hljs-keyword">catch</span> (e: Exception) {
          <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Error while sending message"</span>),<font></font>
          HttpStatus.BAD_REQUEST)<font></font>
     }<font></font>
     <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Email has been sent"</span>), HttpStatus.OK)<font></font>
}<font></font>
<font></font>
<span class="hljs-meta">@GetMapping(<span class="hljs-meta-string">"/sendTemplateEmail"</span>)</span>
<span class="hljs-meta">@PreAuthorize(<span class="hljs-meta-string">"hasRole('USER')"</span>)</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendTemplateEmail</span><span class="hljs-params">()</span></span>: ResponseEntity&lt;*&gt; {
     <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">var</span> params:MutableMap&lt;String, Any&gt; = mutableMapOf()<font></font>
          params[<span class="hljs-string">"addresseeName"</span>] = addressee<font></font>
          params[<span class="hljs-string">"signatureImage"</span>] = <span class="hljs-string">"https://coderlook.com/wp-content/uploads/2019/07/spring-by-pivotal.png"</span>
          emailService.sendSimpleMessageUsingTemplate(addressee, <span class="hljs-string">"Template Email"</span>, <span class="hljs-string">"emailTemplate"</span>, params)<font></font>
     } <span class="hljs-keyword">catch</span> (e: Exception) {
          <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Error while sending message"</span>),<font></font>
          HttpStatus.BAD_REQUEST)<font></font>
     }<font></font>
     <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Email has been sent"</span>), HttpStatus.OK)<font></font>
}<font></font>
<font></font>
<span class="hljs-meta">@GetMapping(<span class="hljs-meta-string">"/sendHtmlEmail"</span>)</span>
<span class="hljs-meta">@PreAuthorize(<span class="hljs-meta-string">"hasRole('USER')"</span>)</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendHtmlEmail</span><span class="hljs-params">()</span></span>: ResponseEntity&lt;*&gt; {
     <span class="hljs-keyword">try</span> {<font></font>
          emailService.sendHtmlMessage(addressee, <span class="hljs-string">"HTML Email"</span>, <span class="hljs-string">"&lt;h1&gt;Hello!&lt;/h1&gt;&lt;p&gt;This is HTML email&lt;/p&gt;"</span>)<font></font>
     } <span class="hljs-keyword">catch</span> (e: Exception) {
          <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Error while sending message"</span>),<font></font>
          HttpStatus.BAD_REQUEST)<font></font>
     }<font></font>
     <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Email has been sent"</span>), HttpStatus.OK)<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ³¨ï¼š</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã™ã¹ã¦ãŒæ­£å¸¸ã«æ©Ÿèƒ½ã™ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ã€ã¾ãšæ‰‹ç´™ã‚’è‡ªåˆ†å®›ã«é€ä¿¡ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãŸã€ã™ã¹ã¦ãŒæ©Ÿèƒ½ã™ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ã€å˜ç´”ã«Webã‚µãƒ¼ãƒ“ã‚¹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ãƒ—ãƒ«ã™ã‚‹æ§ãˆã‚ãªWebã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’ä½œæˆã§ãã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Email.vue</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs"><font></font>
&lt;template&gt;<font></font>
   <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"email"</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">b-button</span>  <span class="hljs-attr">v-on:click</span>=<span class="hljs-string">"sendSimpleMessage"</span> <span class="hljs-attr">variant</span>=<span class="hljs-string">"primary"</span>&gt;</span>Simple Email<span class="hljs-tag">&lt;/<span class="hljs-name">b-button</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">b-button</span>  <span class="hljs-attr">v-on:click</span>=<span class="hljs-string">"sendEmailUsingTemplate"</span> <span class="hljs-attr">variant</span>=<span class="hljs-string">"primary"</span>&gt;</span>Template Email<span class="hljs-tag">&lt;/<span class="hljs-name">b-button</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">b-button</span> <span class="hljs-attr">v-on:click</span>=<span class="hljs-string">"sendHTMLEmail"</span> <span class="hljs-attr">variant</span>=<span class="hljs-string">"primary"</span>&gt;</span>HTML Email<span class="hljs-tag">&lt;/<span class="hljs-name">b-button</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span>
       <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><font></font>
&lt;/template&gt;<font></font>
<font></font>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> {AXIOS} <span class="hljs-keyword">from</span> <span class="hljs-string">'./http-common'</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
   <span class="hljs-attr">name</span>: <span class="hljs-string">'EmailPage'</span>,
   data() {
       <span class="hljs-keyword">return</span> {
           <span class="hljs-attr">counter</span>: <span class="hljs-number">0</span>,
           <span class="hljs-attr">username</span>: <span class="hljs-string">''</span>,
           <span class="hljs-attr">header</span>: {<span class="hljs-string">'Authorization'</span>: <span class="hljs-string">'Bearer '</span> + <span class="hljs-keyword">this</span>.$store.getters.getToken}
       }
   },
   <span class="hljs-attr">methods</span>: {
       sendSimpleMessage() {
           AXIOS.get(<span class="hljs-string">'/sendSimpleEmail'</span>, { <span class="hljs-attr">headers</span>: <span class="hljs-keyword">this</span>.$data.header })
           .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
               <span class="hljs-built_in">console</span>.log(response);
               alert(<span class="hljs-string">"OK"</span>);
           })
           .catch(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
               <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'ERROR: '</span> + error.response.data);
           })
       },
       sendEmailUsingTemplate() {
           AXIOS.get(<span class="hljs-string">'/sendTemplateEmail'</span>, { <span class="hljs-attr">headers</span>: <span class="hljs-keyword">this</span>.$data.header })
           .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
               <span class="hljs-built_in">console</span>.log(response);
               alert(<span class="hljs-string">"OK"</span>)
           })
           .catch(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
               <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'ERROR: '</span> + error.response.data);
           })
       },
       sendHTMLEmail() {
           AXIOS.get(<span class="hljs-string">'/sendHtmlEmail'</span>, { <span class="hljs-attr">headers</span>: <span class="hljs-keyword">this</span>.$data.header })
           .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
               <span class="hljs-built_in">console</span>.log(response);
               alert(<span class="hljs-string">"OK"</span>)
           })
           .catch(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
               <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'ERROR: '</span> + error.response.data);
           })
       }
   }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><font></font>
<font></font>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
<span class="hljs-selector-id">#email</span> {
   <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">38%</span>;
   <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">50px</span>;
}
<span class="hljs-selector-tag">button</span> {
   <span class="hljs-attribute">width</span>: <span class="hljs-number">150px</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>
</code></pre><br>
</div></div><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ³¨ï¼š</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–°ã—ã„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹å ´åˆ</font></font><code>router.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯ã€ãƒªãƒ³ã‚¯</font><font style="vertical-align: inherit;">ã‚’æ›´æ–°</font><font style="vertical-align: inherit;">ã—ã¦ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã«è¿½åŠ ã™ã‚‹</font><font style="vertical-align: inherit;">ã“ã¨ã‚’å¿˜ã‚Œãªã„ã§ãã ã•ã„</font></font><code>App.vue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<a name="gradle"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gradleã®ç§»è¡Œ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç§ã¯ã™ãã«æ˜ç¢ºã«ã—ã¾ã™ã€‚ã“ã®é …ç›®ã‚’æ”¹å–„ã¨è¦‹ãªã™ã¹ãã‹ã©ã†ã‹ã€èª°ã‚‚ãŒè‡ªåˆ†ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’æ±ºå®šã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ã“ã‚Œã‚’è¡Œã†æ–¹æ³•ã‚’æ¤œè¨ã™ã‚‹ã ã‘ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€èˆ¬çš„ã«ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mavenã‹ã‚‰Gradleã¸</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã®</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ç§»å‹•ã¯5åˆ†æœªæº€ã®</font></a><font style="vertical-align: inherit;">æ‰‹é †</font><font style="vertical-align: inherit;">ã§</font><font style="vertical-align: inherit;">ä½¿ç”¨ã§ãã¾ã™</font><font style="vertical-align: inherit;">ãŒã€æœŸå¾…</font><font style="vertical-align: inherit;">ã©ãŠã‚Š</font><font style="vertical-align: inherit;">ã®çµæœãŒå¾—ã‚‰ã‚Œã‚‹ã¨ã¯é™ã‚Šã¾ã›ã‚“ã€‚ãã‚Œã§ã‚‚æ‰‹å‹•ã§ç§»è¡Œã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚ãã‚Œã»ã©é•·ãã¯ã‹ã‹ã‚‰ãªã„ã§ã—ã‚‡ã†ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãšã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gradleã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¿…è¦ãŒã‚ã‚Šã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ä¸¡æ–¹ã®ã‚µãƒ–ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§æ¬¡ã®æ‰‹é †ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™- </font></font><code>backend</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãŠã‚ˆã³</font></font><code>fronted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mavenãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pom.xml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.mvnï¼‰ã‚’</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‰Šé™¤ã—ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚µãƒ–ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ã€gradle initã‚’å®Ÿè¡Œã—ã€è³ªå•ã«ç­”ãˆã¾ã™ã€‚</font></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”Ÿæˆã™ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¿ã‚¤ãƒ—ã‚’é¸æŠï¼š</font></font></i> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŸºæœ¬</font></font></b></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®Ÿè£…è¨€èªã‚’é¸æŠï¼š</font></font></i> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kotlin</font></font></b></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ“ãƒ«ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆDSLã‚’é¸æŠï¼š</font></font></i> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kotlin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆKotlinã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¦ã„ã‚‹ãŸã‚ï¼‰</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ3 </font></font></b><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">settings.gradle.ktsã‚’</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‰Šé™¤ã—</font><i><font style="vertical-align: inherit;">ã¾ã™</font></i><font style="vertical-align: inherit;"> -ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒ«ãƒ¼ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã®ã¿å¿…è¦ã§ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®Ÿè¡Œã—ã¾ã™</font></font><code>gradle wrapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ãƒ«ãƒ¼ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ç§»ã‚Šã¾ã—ã‚‡ã†ã€‚</font><font style="vertical-align: inherit;">ãã®ãŸã‚ã«ã¯ã€ã‚µãƒ–ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¤ã„ã¦ä¸Šè¨˜ã®ã‚¹ãƒ†ãƒƒãƒ—1ã€2ã€ãŠã‚ˆã³4ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚Š</font><u><i><font style="vertical-align: inherit;">ã¾ã™</font></i></u></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -settings.gradle.ktsã‚’å‰Šé™¤ã™ã‚‹ä»¥å¤–</font></font><i><font style="vertical-align: inherit;"></font></i></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯ã™ã¹ã¦åŒã˜</font><font style="vertical-align: inherit;">ã§ã™ã€‚</font><i><font style="vertical-align: inherit;">ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ“ãƒ«ãƒ‰æ§‹æˆã¯æ¬¡ã®</font><font style="vertical-align: inherit;">ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build.gradle.kts</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">import</span> org.jetbrains.kotlin.gradle.tasks.KotlinCompile<font></font>
<font></font>
plugins {<font></font>
    id(<span class="hljs-string">"org.springframework.boot"</span>) version <span class="hljs-string">"2.1.3.RELEASE"</span>
    id(<span class="hljs-string">"io.spring.dependency-management"</span>) version <span class="hljs-string">"1.0.8.RELEASE"</span>
    kotlin(<span class="hljs-string">"jvm"</span>) version <span class="hljs-string">"1.3.50"</span>
    kotlin(<span class="hljs-string">"plugin.spring"</span>) version <span class="hljs-string">"1.3.50"</span>
    id(<span class="hljs-string">"org.jetbrains.kotlin.plugin.jpa"</span>) version <span class="hljs-string">"1.3.50"</span><font></font>
}<font></font>
<font></font>
group = <span class="hljs-string">"com.kotlin-spring-vue"</span>
version = <span class="hljs-string">"0.0.1-SNAPSHOT"</span><font></font>
java.sourceCompatibility = JavaVersion.VERSION_1_8<font></font>
<font></font>
repositories {<font></font>
    mavenCentral()<font></font>
    maven {<font></font>
        url = uri(<span class="hljs-string">"https://plugins.gradle.org/m2/"</span>)<font></font>
    }<font></font>
}<font></font>
<font></font>
dependencies {<font></font>
    runtimeOnly(project(<span class="hljs-string">":frontend"</span>))<font></font>
    implementation(<span class="hljs-string">"org.springframework.boot:spring-boot-starter-actuator:2.1.3.RELEASE"</span>)<font></font>
    implementation(<span class="hljs-string">"org.springframework.boot:spring-boot-starter-web:2.1.3.RELEASE"</span>)<font></font>
    implementation(<span class="hljs-string">"org.springframework.boot:spring-boot-starter-data-jpa:2.1.3.RELEASE"</span>)<font></font>
    implementation(<span class="hljs-string">"org.springframework.boot:spring-boot-starter-mail:2.1.3.RELEASE"</span>)<font></font>
    implementation(<span class="hljs-string">"org.springframework.boot:spring-boot-starter-security:2.1.3.RELEASE"</span>)<font></font>
    implementation(<span class="hljs-string">"org.postgresql:postgresql:42.2.5"</span>)<font></font>
    implementation(<span class="hljs-string">"org.springframework.boot:spring-boot-starter-thymeleaf:2.1.3.RELEASE"</span>)<font></font>
    implementation(<span class="hljs-string">"commons-io:commons-io:2.4"</span>)<font></font>
    implementation(<span class="hljs-string">"io.jsonwebtoken:jjwt:0.9.0"</span>)<font></font>
    implementation(<span class="hljs-string">"io.jsonwebtoken:jjwt-api:0.10.6"</span>)<font></font>
    implementation(<span class="hljs-string">"com.mashape.unirest:unirest-java:1.4.9"</span>)<font></font>
    implementation(<span class="hljs-string">"com.fasterxml.jackson.module:jackson-module-kotlin:2.9.8"</span>)<font></font>
    runtimeOnly(<span class="hljs-string">"org.springframework.boot:spring-boot-devtools:2.1.3.RELEASE"</span>)<font></font>
    implementation(<span class="hljs-string">"org.jetbrains.kotlin:kotlin-reflect"</span>)<font></font>
    implementation(<span class="hljs-string">"org.jetbrains.kotlin:kotlin-stdlib-jdk8"</span>)<font></font>
    implementation(<span class="hljs-string">"org.jetbrains.kotlin:kotlin-noarg:1.3.50"</span>)<font></font>
    testImplementation(<span class="hljs-string">"org.springframework.boot:spring-boot-starter-test"</span>) {<font></font>
        exclude(group = <span class="hljs-string">"org.junit.vintage"</span>, module = <span class="hljs-string">"junit-vintage-engine"</span>)<font></font>
    }<font></font>
}<font></font>
<font></font>
tasks.withType&lt;KotlinCompile&gt; {<font></font>
    kotlinOptions {<font></font>
        freeCompilerArgs = listOf(<span class="hljs-string">"-Xjsr305=strict"</span>)<font></font>
        jvmTarget = <span class="hljs-string">"1.8"</span><font></font>
    }<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¿…è¦ãªã™ã¹ã¦ã®KotlinãŠã‚ˆã³Springãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ—ãƒ©ã‚°ã‚¤ãƒ³</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">org.jetbrains.kotlin.plugin.jpaã‚’</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¿˜ã‚Œãªã„ã§ãã ã•ã„</font><font style="vertical-align: inherit;">-ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¾å­˜é–¢ä¿‚ã§ã¯ã€æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™</font></font><code>runtimeOnly(project(":frontend"))</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">æœ€åˆã«</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹å¿…è¦</font><font style="vertical-align: inherit;">ãŒã‚ã‚Šã¾ã™</font></font></li>
</ul><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ“ãƒ«ãƒ‰æ§‹æˆ</font><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build.gradle.kts</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs">plugins {<font></font>
    id(<span class="hljs-string">"org.siouan.frontend"</span>) version <span class="hljs-string">"1.2.1"</span>
    id(<span class="hljs-string">"java"</span>)<font></font>
}<font></font>
<font></font>
group = <span class="hljs-string">"com.kotlin-spring-vue"</span>
version = <span class="hljs-string">"0.0.1-SNAPSHOT"</span><font></font>
<font></font>
java {<font></font>
    targetCompatibility = JavaVersion.VERSION_1_8<font></font>
}<font></font>
<font></font>
buildscript {<font></font>
    repositories {<font></font>
        mavenCentral()<font></font>
        maven {<font></font>
            url = uri(<span class="hljs-string">"https://plugins.gradle.org/m2/"</span>)<font></font>
        }<font></font>
    }<font></font>
}<font></font>
<font></font>
frontend {<font></font>
    nodeVersion.<span class="hljs-keyword">set</span>(<span class="hljs-string">"10.16.0"</span>)<font></font>
    cleanScript.<span class="hljs-keyword">set</span>(<span class="hljs-string">"run clean"</span>)<font></font>
    installScript.<span class="hljs-keyword">set</span>(<span class="hljs-string">"install"</span>)<font></font>
    assembleScript.<span class="hljs-keyword">set</span>(<span class="hljs-string">"run build"</span>)<font></font>
}<font></font>
<font></font>
tasks.named(<span class="hljs-string">"jar"</span>, Jar::<span class="hljs-class"><span class="hljs-keyword">class</span>) </span>{<font></font>
    dependsOn(<span class="hljs-string">"assembleFrontend"</span>)<font></font>
    from(<span class="hljs-string">"<span class="hljs-variable">$buildDir</span>/dist"</span>)<font></font>
    into(<span class="hljs-string">"static"</span>)<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç§ã®ä¾‹ã§ã¯ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½¿ç”¨ã—ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ“ãƒ«ãƒ‰ã—ã¦ã„ã¾ã™ </font></font><code>org.siouan.frontend</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«</font></font><code>frontend {...}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯ã€Node.jsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã€ãŠã‚ˆã³ã§æŒ‡å®šã•ã‚ŒãŸã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€ãŠã‚ˆã³ã‚¢ã‚»ãƒ³ãƒ–ãƒªã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å‘¼ã³å‡ºã™ã‚³ãƒãƒ³ãƒ‰ã‚’ç¤ºã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><code>package.json</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»Šã€ç§ãŸã¡ã¯ç§ãŸã¡ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã‚µãƒ–ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€JARãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ‘ãƒƒã‚¯ã—ã€ä¾å­˜é–¢ä¿‚ã¨ã—ã¦ãã‚Œã‚’ä½¿ç”¨ã™ã‚‹ï¼ˆ</font></font><code>runtimeOnly(project(":frontend"))</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã«</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€æˆ‘ã€…ã¯ï¼ˆã‚¿ã‚¹ã‚¯ã‚’è¨˜è¿°ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§</font></font><code>task</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€ãã®ã‚¢ã‚»ãƒ³ãƒ–ãƒªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ã‚³ãƒ”ãƒ¼ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã«</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/å…¬å…±</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãŠã‚ˆã³JARãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™</font></font></li>
</ul><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ³¨æ„ï¼š</font></font></u><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"></font><code>vue.config.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ“ãƒ«ãƒ‰ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build / distã«</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¤‰æ›´ã—ã¦</font><font style="vertical-align: inherit;">ç·¨é›†</font><font style="vertical-align: inherit;">ã—</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"></font><code>package.json</code> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ“ãƒ«ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ•ã‚¡ã‚¤ãƒ«</font></font><code>vue-cli-service build</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§æŒ‡å®šã™ã‚‹</font><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">ã¾ãŸã¯æŒ‡å®šã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ«ãƒ¼ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®settings.gradle.ktsãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ã€æ¬¡ã®ã‚³ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š...</font></font><br>
<br>
<pre><code class="kotlin hljs">rootProject.name = <span class="hljs-string">"demo"</span><font></font>
<font></font>
include(<span class="hljs-string">":frontend"</span>, <span class="hljs-string">":backend"</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ã‚µãƒ–ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åå‰ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã§ã€ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã§ãã¾ã™ã€‚</font></font><code>./gradlew build</code><br>
<br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ³¨ï¼š</font></font></u><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application.propertiesã§</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŒ‡å®šã•ã‚ŒãŸãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼</font><font style="vertical-align: inherit;">ï¼ˆä¾‹</font><font style="vertical-align: inherit;">ï¼šï¼‰ã«</font></font><code>${SPRING_DATASOURCE_URL}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯¾å¿œã™ã‚‹ç’°å¢ƒå¤‰æ•°ãŒãªã„å ´åˆã€ã‚¢ã‚»ãƒ³ãƒ–ãƒªã¯å¤±æ•—ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã‚’å›é¿</font></font><code><b>/gradlew build -x</b></code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã™ã‚‹ã«ã¯ã€ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ§‹é€ ã‚’ç¢ºèª</font><font style="vertical-align: inherit;">ã™ã‚‹ã‚’ä½¿ç”¨ã™ã‚‹</font></font><code>gradle -q projects</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">Root project 'demo'<font></font>
+--- Project ':backend'<font></font>
\--- Project ':frontend'</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€å¾Œã«ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã«ã¯ã€ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™</font></font><code>./gradlew bootRun</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.gitignore</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¬¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.gitignore</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ãƒ•ã‚¡ã‚¤ãƒ«ã«</font><font style="vertical-align: inherit;">è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Š</font><font style="vertical-align: inherit;">ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰/ãƒ“ãƒ«ãƒ‰/</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰/ãƒ“ãƒ«ãƒ‰/</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å»ºã¦ã‚‹</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.gradle</font></font></li>
</ul><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é‡è¦ï¼š</font></font></u><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">.gitignore</font></i><font style="vertical-align: inherit;">ã«ãƒ•ã‚¡ã‚¤ãƒ«</font></font><code>gradlew</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’</font><font style="vertical-align: inherit;">è¿½åŠ ã—ãªã„ã§ãã ã•ã„ã€‚ãƒ•ã‚¡ã‚¤ãƒ«</font><font style="vertical-align: inherit;">ã«</font><font style="vertical-align: inherit;">å±é™ºã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€ãƒªãƒ¢ãƒ¼ãƒˆã‚µãƒ¼ãƒãƒ¼ã§æ­£å¸¸ã«ã‚¢ã‚»ãƒ³ãƒ–ãƒªã™ã‚‹ãŸã‚ã«å¿…è¦ã§ã™ã€‚</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Herokuã§ã®å±•é–‹</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¢ãƒ—ãƒªã‚’Herokuã«å®‰å…¨ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ãŸã‚ã«å¿…è¦ãªå¤‰æ›´ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ1 Procfile</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èµ·å‹•ã™ã‚‹ãŸã‚ã®æ–°ã—ã„æ‰‹é †ã‚’Herokuã«å°‹ã­ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">web: java -Dserver.port=$PORT -jar backend/build/libs/backend-0.0.1-SNAPSHOT.jar</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ2ç’°å¢ƒå¤‰æ•°</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Herokuã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¿ã‚¤ãƒ—ï¼ˆãŸã¨ãˆã°ã€Spring Bootã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ã‚’ä½œã‚Šç›´ã—ã¦ã€é©åˆ‡ãªã‚¢ã‚»ãƒ³ãƒ–ãƒªã®æŒ‡ç¤ºã«å¾“ã†ã“ã¨ãŒã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã—ã‹ã—ã€ç§ãŸã¡ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãƒ«ãƒ¼ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼‰ã¯ã€Herokuã®Spring Bootã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚ˆã†ã«ã¯è¦‹ãˆã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">ã™ã¹ã¦ã‚’ãã®ã¾ã¾ã«ã—ã¦ãŠãã¨ã€HerokuãŒã‚¿ã‚¹ã‚¯ã®æ±ºå®šã‚’è¦æ±‚ã—ã¾ã™</font></font><code>stage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æ­£ç›´ãªã¨ã“ã‚ã€ç§ã¯ã“ã®é“ã‚’ãŸã©ã£ã¦ã„ãªã‹ã£ãŸãŸã‚ã€ã“ã®é“ã®çµ‚ç‚¹ãŒã‚ã‹ã‚Šã¾ã›ã‚“ã€‚</font></font><code>GRADLE_TASK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¤ã‚’</font><font style="vertical-align: inherit;">ä½¿ç”¨ã—ã¦å¤‰æ•°</font><font style="vertical-align: inherit;">ã‚’</font><font style="vertical-align: inherit;">å®šç¾©ã™ã‚‹ã ã‘</font><font style="vertical-align: inherit;">ã§ã™</font></font><code>build</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/5j/xz/o2/5jxzo2ukto8lyakkxajjg5rrvtg.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ3 reCAPTCHA</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ–°ã—ã„ãƒ‰ãƒ¡ã‚¤ãƒ³ã«é…ç½®ã™ã‚‹ã¨ãã¯ã€ã‚­ãƒ£ãƒ—ãƒãƒ£ã€ç’°å¢ƒå¤‰æ•°</font></font><code>GOOGLE_RECAPTCHA_KEY_SITE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ãŠã‚ˆã³</font></font><code>GOOGLE_RECAPTCHA_KEY_SECRET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚µãƒ–ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã‚µã‚¤ãƒˆã‚­ãƒ¼ã‚’æ›´æ–°ã™ã‚‹</font><font style="vertical-align: inherit;">ã“ã¨ã‚’å¿˜ã‚Œãªã„ã§ãã ã•ã„</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<a name="cookies"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’Cookieã«ä¿å­˜ã™ã‚‹</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãšã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€Œãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ä½¿ç”¨ã‚’ä¸­æ­¢ã—</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¦</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ãã ã•ã„ã€ã®</font></a><font style="vertical-align: inherit;">è¨˜äº‹</font><font style="vertical-align: inherit;">ã€ç‰¹ã«</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€Œãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãŒå®‰å…¨ã§ã¯ãªãã€æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã«ä½¿ç”¨ã™ã¹ãã§ãªã„ã€</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚»ã‚¯ã‚·ãƒ§ãƒ³</font><font style="vertical-align: inherit;">ã‚’èª­ã‚€ã“ã¨ã‚’å¼·ããŠå‹§ã‚ã—ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’ã‚ˆã‚Šå®‰å…¨ãªå ´æ‰€ã«ä¿å­˜ã™ã‚‹æ–¹æ³•ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†-ãƒ•ãƒ©ã‚°å†…ã®Cookieã€‚JavaScriptã‚’</font></font><code>httpOnly</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨ã—ãŸèª­ã¿å–ã‚Šã‚„å¤‰æ›´ã«ã¯ä½¿ç”¨ã§ããªããªã‚Šã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰JWTé–¢é€£ã®ã™ã¹ã¦ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’å‰Šé™¤ã™ã‚‹ï¼š</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ–°ã—ã„ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ¡ã‚½ãƒƒãƒ‰ã§ã¯ã€JavaScriptã§ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ã¾ã ä½¿ç”¨ã§ããªã„ãŸã‚ã€ã‚µãƒ–ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰ãƒˆãƒ¼ã‚¯ãƒ³ã¸ã®ã™ã¹ã¦ã®å‚ç…§ã‚’å®‰å…¨ã«å‰Šé™¤ã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãŸã ã—ã€ä»–ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‚ç…§ã—ãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å½¹å‰²ã¯ãã‚Œã»ã©é‡è¦ãªæƒ…å ±ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ã—ã¦ã€ã“ã®å½¹å‰²ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã«å¿œã˜ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ‰¿èªã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤æ–­ã§ãã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¹ãƒˆã‚¢/index.js</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs">
<span class="hljs-keyword">import</span> Vue <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">import</span> Vuex <span class="hljs-keyword">from</span> <span class="hljs-string">'vuex'</span>;<font></font>
<font></font>
Vue.use(Vuex);<font></font>
<font></font>
<span class="hljs-keyword">const</span> state = {
  <span class="hljs-attr">role</span>: localStorage.getItem(<span class="hljs-string">'user-role'</span>) || <span class="hljs-string">''</span>,
  <span class="hljs-attr">username</span>: localStorage.getItem(<span class="hljs-string">'user-name'</span>) || <span class="hljs-string">''</span>,
  <span class="hljs-attr">authorities</span>: localStorage.getItem(<span class="hljs-string">'authorities'</span>) || <span class="hljs-string">''</span>,<font></font>
};<font></font>
<font></font>
<span class="hljs-keyword">const</span> getters = {
  <span class="hljs-attr">isAuthenticated</span>: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (state.role != <span class="hljs-literal">null</span> &amp;&amp; state.role != <span class="hljs-string">''</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
  },<font></font>
  <span class="hljs-attr">isAdmin</span>: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (state.role === <span class="hljs-string">'admin'</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
  },<font></font>
  <span class="hljs-attr">getUsername</span>: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> state.username;<font></font>
  },<font></font>
  <span class="hljs-attr">getAuthorities</span>: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> state.authorities;<font></font>
  }<font></font>
};<font></font>
<font></font>
<span class="hljs-keyword">const</span> mutations = {
  <span class="hljs-attr">auth_login</span>: <span class="hljs-function">(<span class="hljs-params">state, user</span>) =&gt;</span> {<font></font>
    localStorage.setItem(<span class="hljs-string">'user-name'</span>, user.username);<font></font>
    localStorage.setItem(<span class="hljs-string">'user-authorities'</span>, user.roles);<font></font>
    state.username = user.username;<font></font>
    state.authorities = user.roles;<font></font>
    <span class="hljs-keyword">var</span> isUser = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> isAdmin = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; user.roles.length; i++) {
      <span class="hljs-keyword">if</span> (user.roles[i].authority === <span class="hljs-string">'ROLE_USER'</span>) {<font></font>
        isUser = <span class="hljs-literal">true</span>;<font></font>
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (user.roles[i].authority === <span class="hljs-string">'ROLE_ADMIN'</span>) {<font></font>
        isAdmin = <span class="hljs-literal">true</span>;<font></font>
      }<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (isUser) {<font></font>
      localStorage.setItem(<span class="hljs-string">'user-role'</span>, <span class="hljs-string">'user'</span>);<font></font>
      state.role = <span class="hljs-string">'user'</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (isAdmin) {<font></font>
      localStorage.setItem(<span class="hljs-string">'user-role'</span>, <span class="hljs-string">'admin'</span>);<font></font>
      state.role = <span class="hljs-string">'admin'</span>;<font></font>
    }<font></font>
  },<font></font>
  <span class="hljs-attr">auth_logout</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {<font></font>
    state.token = <span class="hljs-string">''</span>;<font></font>
    state.role = <span class="hljs-string">''</span>;<font></font>
    state.username = <span class="hljs-string">''</span>;<font></font>
    state.authorities = [];<font></font>
    localStorage.removeItem(<span class="hljs-string">'user-role'</span>);<font></font>
    localStorage.removeItem(<span class="hljs-string">'user-name'</span>);<font></font>
    localStorage.removeItem(<span class="hljs-string">'user-authorities'</span>);<font></font>
  }<font></font>
};<font></font>
<font></font>
<span class="hljs-keyword">const</span> actions = {
  <span class="hljs-attr">login</span>: <span class="hljs-function">(<span class="hljs-params">context, user</span>) =&gt;</span> {<font></font>
    context.commit(<span class="hljs-string">'auth_login'</span>, user)<font></font>
  },<font></font>
  <span class="hljs-attr">logout</span>: <span class="hljs-function">(<span class="hljs-params">context</span>) =&gt;</span> {<font></font>
    context.commit(<span class="hljs-string">'auth_logout'</span>);<font></font>
  }<font></font>
};<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> store = <span class="hljs-keyword">new</span> Vuex.Store({<font></font>
  state,<font></font>
  getters,<font></font>
  mutations,<font></font>
  actions<font></font>
});<font></font>
</code></pre><br>
</div></div> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®éš›ã¯æ³¨æ„ã—ã¦ãã ã•ã„</font></font><code>store/index.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚èªè¨¼ã¨èªè¨¼è§£é™¤ãŒæ­£ã—ãæ©Ÿèƒ½ã—ãªã„å ´åˆã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã•ã‚Œç¶šã‘ã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰¿èªã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã§ï¼ˆ</font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¿œç­”æœ¬æ–‡ã§ã¯ãªãï¼‰</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cookieã¨ã—ã¦JWTã‚’è¿”ã—</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AuthController.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-meta">@Value(<span class="hljs-meta-string">"\${ksvg.app.authCookieName}"</span>)</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> authCookieName: String<font></font>
<font></font>
<span class="hljs-meta">@Value(<span class="hljs-meta-string">"\${ksvg.app.isCookieSecure}"</span>)</span>
    <span class="hljs-keyword">var</span> isCookieSecure: <span class="hljs-built_in">Boolean</span> = <span class="hljs-literal">true</span><font></font>
<font></font>
<span class="hljs-meta">@PostMapping(<span class="hljs-meta-string">"/signin"</span>)</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">authenticateUser</span><span class="hljs-params">(<span class="hljs-meta">@Valid</span> <span class="hljs-meta">@RequestBody</span> loginRequest: <span class="hljs-type">LoginUser</span>, response: <span class="hljs-type">HttpServletResponse</span>)</span></span>: ResponseEntity&lt;*&gt; {<font></font>
<font></font>
        <span class="hljs-keyword">val</span> userCandidate: Optional &lt;User&gt; = userRepository.findByUsername(loginRequest.username!!)<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!captchaService.validateCaptcha(loginRequest.recaptchaToken!!)) {
            <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Validation failed (ReCaptcha v2)"</span>),<font></font>
                    HttpStatus.BAD_REQUEST)<font></font>
        }<font></font>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (userCandidate.isPresent) {
            <span class="hljs-keyword">val</span> user: User = userCandidate.<span class="hljs-keyword">get</span>()
            <span class="hljs-keyword">val</span> authentication = authenticationManager.authenticate(<font></font>
                    UsernamePasswordAuthenticationToken(loginRequest.username, loginRequest.password))<font></font>
            SecurityContextHolder.getContext().setAuthentication(authentication)<font></font>
            <span class="hljs-keyword">val</span> jwt: String = jwtProvider.generateJwtToken(user.username!!)<font></font>
<font></font>
            <span class="hljs-keyword">val</span> cookie: Cookie = Cookie(authCookieName, jwt)<font></font>
            cookie.maxAge = jwtProvider.jwtExpiration!!<font></font>
            cookie.secure = isCookieSecure<font></font>
            cookie.isHttpOnly = <span class="hljs-literal">true</span>
            cookie.path = <span class="hljs-string">"/"</span><font></font>
            response.addCookie(cookie)<font></font>
<font></font>
            <span class="hljs-keyword">val</span> authorities: List&lt;GrantedAuthority&gt; = user.roles!!.stream().map({ role -&gt; SimpleGrantedAuthority(role.name)}).collect(Collectors.toList&lt;GrantedAuthority&gt;())
            <span class="hljs-keyword">return</span> ResponseEntity.ok(SuccessfulSigninResponse(user.username, authorities))<font></font>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"User not found!"</span>),<font></font>
                    HttpStatus.BAD_REQUEST)<font></font>
        }<font></font>
    }<font></font>
</code></pre><br>
</div></div><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é‡è¦</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šç§ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç½®ãã“ã¨ã‚’ã—ã¦ãã ã•ã„ãƒãƒ¼ãƒˆ</font></font><code>authCookieName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¨</font></font><code>isCookieSecure</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application.properties</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -ãƒ•ãƒ©ã‚°ã«ã‚¯ãƒƒã‚­ãƒ¼ã‚’é€ä¿¡ã™ã‚‹</font></font><code>secure</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã¨ãŒã§ãã‚‹å”¯ä¸€ã®HTTPSã¯ã€localhostã¨ãƒ‡ãƒãƒƒã‚°ã«ãã‚Œã¯éå¸¸ã«å›°é›£ã«ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã—ã‹ã—ã€æœ¬ç•ªç’°å¢ƒã§ã¯ã‚‚ã¡ã‚ã‚“ã€ã“ã®ãƒ•ãƒ©ã‚°ã‚’ä»˜ã‘ãŸCookieã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãŸã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã®å¿œç­”ã¯ã€JWTã®ç‰¹åˆ¥ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãªã—ã§ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã«æ„å‘³ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ›´æ–°</font></font><code>JwtAuthTokenFilter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»¥å‰ã¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã‹ã‚‰ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã—ã¦ã„ã¾ã—ãŸãŒã€ç¾åœ¨ã¯Cookieã‹ã‚‰å–å¾—ã—ã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JwtAuthTokenFilter.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-meta">@Value(<span class="hljs-meta-string">"\${ksvg.app.authCookieName}"</span>)</span>
          <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> authCookieName: String<font></font>
<font></font>
...<font></font>
<font></font>
<span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getJwt</span><span class="hljs-params">(request: <span class="hljs-type">HttpServletRequest</span>)</span></span>: String? {
     <span class="hljs-keyword">for</span> (cookie <span class="hljs-keyword">in</span> request.cookies) {
          <span class="hljs-keyword">if</span> (cookie.name == authCookieName) {
               <span class="hljs-keyword">return</span> cookie.value<font></font>
          }<font></font>
     }<font></font>
     <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span><font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ4 </font></font></b><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CORSã‚’</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ‰åŠ¹</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã«ã™ã‚‹ä»¥å‰ã®è¨˜äº‹ã§ã“ã®è³ªå•ã‚’é™ã‹ã«ã‚¹ã‚­ãƒƒãƒ—ã§ãã‚‹å ´åˆã€ä»Šåº¦ã¯ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å´ã§CORSã‚’æœ‰åŠ¹ã«ã™ã‚‹å¿…è¦ãªã—ã«JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿è­·ã™ã‚‹ã®ã¯ãŠã‹ã—ã„ã§ã—ã‚‡ã†ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã‚’ç·¨é›†ã—ã¦ä¿®æ­£ã§ãã¾ã™</font></font><code>WebSecurityConfig.kt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebSecurityConfig.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-meta">@Bean</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">corsConfigurationSource</span><span class="hljs-params">()</span></span>: CorsConfigurationSource {
     <span class="hljs-keyword">val</span> configuration = CorsConfiguration()<font></font>
     configuration.allowedOrigins = Arrays.asList(<span class="hljs-string">"http://localhost:8080"</span>, <span class="hljs-string">"http://localhost:8081"</span>, <span class="hljs-string">"https://kotlin-spring-vue-gradle-demo.herokuapp.com"</span>)<font></font>
     configuration.allowedHeaders = Arrays.asList(<span class="hljs-string">"*"</span>)<font></font>
     configuration.allowedMethods = Arrays.asList(<span class="hljs-string">"GET"</span>, <span class="hljs-string">"POST"</span>, <span class="hljs-string">"PUT"</span>, <span class="hljs-string">"DELETE"</span>, <span class="hljs-string">"OPTIONS"</span>)<font></font>
     configuration.allowCredentials = <span class="hljs-literal">true</span>
     configuration.maxAge = <span class="hljs-number">3600</span>
     <span class="hljs-keyword">val</span> source = UrlBasedCorsConfigurationSource()<font></font>
     source.registerCorsConfiguration(<span class="hljs-string">"/**"</span>, configuration)
     <span class="hljs-keyword">return</span> source<font></font>
}<font></font>
<font></font>
<span class="hljs-meta">@Throws(Exception::class)</span>
<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">configure</span><span class="hljs-params">(http: <span class="hljs-type">HttpSecurity</span>)</span></span> {<font></font>
     http<font></font>
          .cors().and()<font></font>
          .csrf().disable().authorizeRequests()<font></font>
          .antMatchers(<span class="hljs-string">"/**"</span>).permitAll()<font></font>
          .anyRequest().authenticated()<font></font>
          .and()<font></font>
          .exceptionHandling().authenticationEntryPoint(unauthorizedHandler).and()<font></font>
          .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS)<font></font>
<font></font>
     http.addFilterBefore(authenticationJwtTokenFilter(), UsernamePasswordAuthenticationFilter::<span class="hljs-keyword">class</span>.java)<font></font>
     http.headers().cacheControl().disable()<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦ä»Šã€ã‚ãªãŸ</font></font><code>@CrossOrigin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã‹ã‚‰</font><font style="vertical-align: inherit;">ã™ã¹ã¦ã®æ³¨é‡ˆ</font><font style="vertical-align: inherit;">ã‚’</font><font style="vertical-align: inherit;">å–ã‚Šé™¤ãã“ã¨ãŒã§ãã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é‡è¦ï¼š</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã«</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€</font><i><font style="vertical-align: inherit;">AllowCredentials</font></i><font style="vertical-align: inherit;">ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</font><i><font style="vertical-align: inherit;">ãŒ</font></i><font style="vertical-align: inherit;">å¿…è¦ã§ã™ã€‚</font><font style="vertical-align: inherit;">è©³ç´°ã«ã¤ã„ã¦ã¯ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã¡ã‚‰ã‚’ã”è¦§ãã ã•ã„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ5</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å´ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ›´æ–°ï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http-commons.js</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs">
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> AXIOS = axios.create({
     <span class="hljs-attr">baseURL</span>: <span class="hljs-string">`/api`</span>,
     <span class="hljs-attr">headers</span>: {
          <span class="hljs-string">'Access-Control-Allow-Origin'</span>: [<span class="hljs-string">'http://localhost:8080'</span>, <span class="hljs-string">'http://localhost:8081'</span>, <span class="hljs-string">'https://kotlin-spring-vue-gradle-demo.herokuapp.com'</span>],
          <span class="hljs-string">'Access-Control-Allow-Methods'</span>: <span class="hljs-string">'GET,POST,DELETE,PUT,OPTIONS'</span>,
          <span class="hljs-string">'Access-Control-Allow-Headers'</span>: <span class="hljs-string">'*'</span>,
          <span class="hljs-string">'Access-Control-Allow-Credentials'</span>: <span class="hljs-literal">true</span><font></font>
     }<font></font>
})<font></font>
</code></pre><br>
</div></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°åˆ‡æ‰‹</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¨±å¯ãƒªã‚¹ãƒˆã«ãªã„ãƒ›ã‚¹ãƒˆã‹ã‚‰ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã¿ã¾ã—ã‚‡ã†</font></font><code>WebSecurityConfig.kt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã‚’è¡Œã†ã«</font></font><code>8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯ã€ãŸã¨ãˆã°</font><font style="vertical-align: inherit;">ãƒãƒ¼ãƒˆ</font><font style="vertical-align: inherit;">ã§</font><font style="vertical-align: inherit;">ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—</font><font style="vertical-align: inherit;">ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’ã‚ªãƒ³ã«ã—ã¦</font></font><code>8082</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ãƒ­ã‚°ã‚¤ãƒ³ã‚’è©¦ã¿ã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çµæœ</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/sw/ce/hk/swcehkifaph10nqjveh17sv1w88.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CORSãƒãƒªã‚·ãƒ¼ã«ã‚ˆã£ã¦æ‹’å¦ã•ã‚ŒãŸæ‰¿èªãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ãƒ•ãƒ©ã‚°CookieãŒä¸€èˆ¬çš„ã«ã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã™ã‚‹ã‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†</font></font><code>httpOnly</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã‚’è¡Œã†ã«ã¯ã€ãŸã¨ãˆã°ã€ã‚µã‚¤ãƒˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://kotlinlang.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã«ç§»å‹•ã—ã¦ã€ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§å®Ÿè¡Œã—</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ã¾ã™</font></a><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">document</span>.cookie </code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çµæœ</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/4o/s7/ct/4os7ctztsejgbzclio8ci8nloky.png"><br>
</div></div><br><font style="vertical-align: inherit;"></font><code>httpOnly</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã®ã‚µã‚¤ãƒˆã«é–¢é€£ã™ã‚‹</font><font style="vertical-align: inherit;">
é</font><font style="vertical-align: inherit;">Cookie </font><font style="vertical-align: inherit;">ãŒã‚³ãƒ³ã‚½ãƒ¼ãƒ«</font><font style="vertical-align: inherit;">ã«</font><font style="vertical-align: inherit;">è¡¨ç¤ºã•ã‚Œã€</font><font style="vertical-align: inherit;">JavaScriptã‚’ä»‹ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ç§»å‹•ã—ã€</font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ãŒJWTã§</font><font style="vertical-align: inherit;">Cookie </font><font style="vertical-align: inherit;">ã‚’</font><font style="vertical-align: inherit;">ä¿å­˜ã™ã‚‹</font><font style="vertical-align: inherit;">ã‚ˆã†ã«ï¼‰ã€åŒã˜ã“ã¨ã‚’ç¹°ã‚Šè¿”ã—ã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çµæœ</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/fh/_b/zh/fh_bzh9ytv6rf_xn40fjf3c83ag.png"><br>
</div></div><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ³¨ï¼š</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿å­˜ã™ã‚‹ã“ã®æ–¹æ³•ã¯ã€ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã‚Šã‚‚ä¿¡é ¼æ€§ãŒé«˜ããªã‚Šã¾ã™ãŒã€ä¸‡èƒ½ã§ã¯ãªã„ã“ã¨ã‚’ç†è§£ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<a name="confirmation"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¡ãƒ¼ãƒ«ç™»éŒ²ç¢ºèª</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ç°¡å˜ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã™ã¹ã¦ã®æ–°ã—ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¤ã„ã¦</font></font><code>isEnabled</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</font><font style="vertical-align: inherit;">ã®å±æ€§</font><font style="vertical-align: inherit;">ã¯</font></font><code>false</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–‡å­—åˆ—ãƒˆãƒ¼ã‚¯ãƒ³ã¯ã€ç™»éŒ²ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã®ã‚­ãƒ¼ã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹ä»»æ„ã®æ–‡å­—ã‹ã‚‰ç”Ÿæˆã•ã‚Œã¾ã™</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒˆãƒ¼ã‚¯ãƒ³ã¯ãƒªãƒ³ã‚¯ã®ä¸€éƒ¨ã¨ã—ã¦ãƒ¡ãƒ¼ãƒ«ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é€ä¿¡ã•ã‚Œã¾ã™</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã®å±æ€§</font></font><code>isEnabled</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯</font><font style="vertical-align: inherit;">ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¨­å®šã•ã‚ŒãŸæœŸé–“ãƒªãƒ³ã‚¯ã‚’ãŸã©ã£ãŸå ´åˆ</font><font style="vertical-align: inherit;">ã«</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trueã«</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¨­å®šã•ã‚Œ</font><i><font style="vertical-align: inherit;">ã¾ã™</font></i><font style="vertical-align: inherit;">ã€‚</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’ã•ã‚‰ã«è©³ã—ãæ¤œè¨ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç™»éŒ²ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ ¼ç´ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå¿…è¦ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> public.verification_token<font></font>
(<font></font>
     <span class="hljs-keyword">id</span> <span class="hljs-built_in">serial</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
     token <span class="hljs-built_in">character</span> <span class="hljs-built_in">varying</span>,<font></font>
     expiry_date <span class="hljs-built_in">timestamp</span> <span class="hljs-keyword">without</span> <span class="hljs-built_in">time</span> zone,<font></font>
     user_id <span class="hljs-built_in">integer</span>,<font></font>
     PRIMARY <span class="hljs-keyword">KEY</span> (<span class="hljs-keyword">id</span>)<font></font>
);<font></font>
<font></font>
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> public.verification_token
<span class="hljs-keyword">ADD</span> <span class="hljs-keyword">CONSTRAINT</span> verification_token_users_fk <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (user_id)
<span class="hljs-keyword">REFERENCES</span> public.users (<span class="hljs-keyword">id</span>) <span class="hljs-keyword">MATCH</span> SIMPLE
<span class="hljs-keyword">ON</span> <span class="hljs-keyword">UPDATE</span> <span class="hljs-keyword">CASCADE</span>
<span class="hljs-keyword">ON</span> <span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">CASCADE</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦ã€ãã‚Œã«å¿œã˜ã¦ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒŠãƒ«ãƒãƒƒãƒ”ãƒ³ã‚°ã®æ–°ã—ã„ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£...ï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VerificationToken.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">package</span> com.kotlinspringvue.backend.jpa<font></font>
<font></font>
<span class="hljs-keyword">import</span> java.sql.*
<span class="hljs-keyword">import</span> javax.persistence.*
<span class="hljs-keyword">import</span> java.util.Calendar<font></font>
<font></font>
<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = <span class="hljs-meta-string">"verification_token"</span>)</span>
<span class="hljs-keyword">data</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">VerificationToken</span></span>(<font></font>
<font></font>
        <span class="hljs-meta">@Id</span>
        <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.AUTO)</span>
        <span class="hljs-keyword">val</span> id: <span class="hljs-built_in">Long</span>? = <span class="hljs-number">0</span>,<font></font>
<font></font>
        <span class="hljs-meta">@Column(name = <span class="hljs-meta-string">"token"</span>)</span>
        <span class="hljs-keyword">var</span> token: String? = <span class="hljs-literal">null</span>,<font></font>
<font></font>
        <span class="hljs-meta">@Column(name = <span class="hljs-meta-string">"expiry_date"</span>)</span>
        <span class="hljs-keyword">val</span> expiryDate: Date,<font></font>
<font></font>
        <span class="hljs-meta">@OneToOne(targetEntity = User::class, fetch = FetchType.EAGER, cascade = [CascadeType.PERSIST])</span>
        <span class="hljs-meta">@JoinColumn(nullable = false, name = <span class="hljs-meta-string">"user_id"</span>)</span>
        <span class="hljs-keyword">val</span> user: User<font></font>
) {<font></font>
    <span class="hljs-keyword">constructor</span>(token: String?, user: User) : <span class="hljs-keyword">this</span>(<span class="hljs-number">0</span>, token, calculateExpiryDate(<span class="hljs-number">1440</span>), user)<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">calculateExpiryDate</span><span class="hljs-params">(expiryTimeInMinutes: <span class="hljs-type">Int</span>)</span></span>: Date {
    <span class="hljs-keyword">val</span> cal = Calendar.getInstance()<font></font>
    cal.time = Timestamp(cal.time.time)<font></font>
    cal.add(Calendar.MINUTE, expiryTimeInMinutes)<font></font>
    <span class="hljs-keyword">return</span> Date(cal.time.time)<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...ãã—ã¦ãƒªãƒã‚¸ãƒˆãƒªï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VerificationTokenRepository.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">package</span> com.kotlinspringvue.backend.repository<font></font>
<font></font>
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.jpa.VerificationToken
<span class="hljs-keyword">import</span> org.springframework.<span class="hljs-keyword">data</span>.jpa.repository.JpaRepository
<span class="hljs-keyword">import</span> java.util.*<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">VerificationTokenRepository</span> : <span class="hljs-type">JpaRepository</span>&lt;<span class="hljs-type">VerificationToken, Long</span>&gt; </span>{
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">findByToken</span><span class="hljs-params">(token: <span class="hljs-type">String</span>)</span></span>: Optional&lt;VerificationToken&gt;<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†ã®ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã‚’å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™-ä½œæˆã€æ¤œè¨¼ã€ãŠã‚ˆã³é›»å­ãƒ¡ãƒ¼ãƒ«ã«ã‚ˆã‚‹é€ä¿¡ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã‚’è¡Œã†ã«ã¯</font></font><code>UserDetailsServiceImpl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä½œæˆãŠã‚ˆã³æ¤œè¨¼ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã—</font><font style="vertical-align: inherit;">ã¦å¤‰æ›´</font><font style="vertical-align: inherit;">ã—ã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserDetailsSâ€‹â€‹erviceImpl.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">createVerificationTokenForUser</span><span class="hljs-params">(token: <span class="hljs-type">String</span>, user: <span class="hljs-type">User</span>)</span></span> {<font></font>
     tokenRepository.save(VerificationToken(token, user))<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">validateVerificationToken</span><span class="hljs-params">(token: <span class="hljs-type">String</span>)</span></span>: String {
     <span class="hljs-keyword">val</span> verificationToken: Optional&lt;VerificationToken&gt; = tokenRepository.findByToken(token)<font></font>
<font></font>
     <span class="hljs-keyword">if</span> (verificationToken.isPresent) {
          <span class="hljs-keyword">val</span> user: User = verificationToken.<span class="hljs-keyword">get</span>().user
          <span class="hljs-keyword">val</span> cal: Calendar = Calendar.getInstance()
          <span class="hljs-keyword">if</span> ((verificationToken.<span class="hljs-keyword">get</span>().expiryDate.time - cal.time.time) &lt;= <span class="hljs-number">0</span>) {<font></font>
               tokenRepository.delete(verificationToken.<span class="hljs-keyword">get</span>())
               <span class="hljs-keyword">return</span> TOKEN_EXPIRED<font></font>
          }<font></font>
<font></font>
          user.enabled = <span class="hljs-literal">true</span>
          tokenRepository.delete(verificationToken.<span class="hljs-keyword">get</span>())<font></font>
          userRepository.save(user)<font></font>
          <span class="hljs-keyword">return</span> TOKEN_VALID<font></font>
     } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">return</span> TOKEN_INVALID<font></font>
     }<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ç¢ºèªãƒªãƒ³ã‚¯ã‚’å«ã‚€ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã—ã¾ã™</font></font><code>EmailServiceImpl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EmailServiceImpl.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs">    <span class="hljs-meta">@Value(<span class="hljs-meta-string">"\${host.url}"</span>)</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> hostUrl: String<font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> userDetailsService: UserDetailsServiceImpl<font></font>
<font></font>
...<font></font>
<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendRegistrationConfirmationEmail</span><span class="hljs-params">(user: <span class="hljs-type">User</span>)</span></span> {
        <span class="hljs-keyword">val</span> token = UUID.randomUUID().toString()<font></font>
        userDetailsService.createVerificationTokenForUser(token, user)<font></font>
        <span class="hljs-keyword">val</span> link = <span class="hljs-string">"<span class="hljs-variable">$hostUrl</span>/?token=<span class="hljs-variable">$token</span>&amp;confirmRegistration=true"</span>
        <span class="hljs-keyword">val</span> msg = <span class="hljs-string">"&lt;p&gt;Please, follow the link to complete your registration:&lt;/p&gt;&lt;p&gt;&lt;a href=\"<span class="hljs-variable">$link</span>\"&gt;<span class="hljs-variable">$link</span>&lt;/a&gt;&lt;/p&gt;"</span>
        user.email?.let{sendHtmlMessage(user.email!!, <span class="hljs-string">"KSVG APP: Registration Confirmation"</span>, msg)}<font></font>
    }<font></font>
</code></pre><br>
</div></div><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ³¨æ„ï¼š</font></font></u><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ›ã‚¹ãƒˆURLã‚’</font><i><font style="vertical-align: inherit;">application.propertiesã«</font></i><font style="vertical-align: inherit;">ä¿å­˜ã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ã™</font></font></i></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã®ãƒªãƒ³ã‚¯ã§ã¯</font><font style="vertical-align: inherit;">ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¦ã„ã‚‹ã‚¢ãƒ‰ãƒ¬ã‚¹ã«</font><font style="vertical-align: inherit;">2ã¤ã®GETãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ï¼ˆ</font></font><code>token</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãŠã‚ˆã³</font></font><code>confirmRegistration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font><font style="vertical-align: inherit;">ã‚’æ¸¡ã—ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å¾Œã§ãã®ç†ç”±ã‚’èª¬æ˜ã—ã¾ã™ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç™»éŒ²ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‚’æ¬¡ã®ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ã€‚</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã™ã¹ã¦ã®æ–°ã—ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ</font></font><code>false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®</font><font style="vertical-align: inherit;">å€¤</font><font style="vertical-align: inherit;">ã‚’</font><font style="vertical-align: inherit;">è¨­å®šã—ã¾ã™</font></font><code>isEnabled</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–°ã—ã„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã—ãŸå¾Œã€ç™»éŒ²ã‚’ç¢ºèªã™ã‚‹ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¾ã™</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ¥ã®ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‚’ä½œæˆã™ã‚‹</font></font></li>
<li><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é‡è¦ï¼š</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">èªè¨¼æ™‚ã«ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒç¢ºèªã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚</font></font></li>
</ul><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AuthController.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">package</span> com.kotlinspringvue.backend.controller<font></font>
<font></font>
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.email.EmailService
<span class="hljs-keyword">import</span> javax.validation.Valid
<span class="hljs-keyword">import</span> java.util.*
<span class="hljs-keyword">import</span> java.util.stream.Collectors<font></font>
<font></font>
<span class="hljs-keyword">import</span> org.springframework.beans.factory.<span class="hljs-keyword">annotation</span>.Autowired
<span class="hljs-keyword">import</span> org.springframework.http.HttpStatus
<span class="hljs-keyword">import</span> org.springframework.http.ResponseEntity
<span class="hljs-keyword">import</span> org.springframework.security.authentication.AuthenticationManager
<span class="hljs-keyword">import</span> org.springframework.security.authentication.UsernamePasswordAuthenticationToken
<span class="hljs-keyword">import</span> org.springframework.security.core.context.SecurityContextHolder
<span class="hljs-keyword">import</span> org.springframework.security.crypto.password.PasswordEncoder
<span class="hljs-keyword">import</span> org.springframework.security.core.GrantedAuthority
<span class="hljs-keyword">import</span> org.springframework.security.core.authority.SimpleGrantedAuthority
<span class="hljs-keyword">import</span> org.springframework.ui.Model<font></font>
<font></font>
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.model.LoginUser
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.model.NewUser
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.web.response.SuccessfulSigninResponse
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.web.response.ResponseMessage
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.jpa.User
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.repository.UserRepository
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.repository.RoleRepository
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.jwt.JwtProvider
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.service.ReCaptchaService
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.service.UserDetailsService
<span class="hljs-keyword">import</span> org.springframework.beans.factory.<span class="hljs-keyword">annotation</span>.Value
<span class="hljs-keyword">import</span> org.springframework.context.ApplicationEventPublisher
<span class="hljs-keyword">import</span> org.springframework.web.bind.<span class="hljs-keyword">annotation</span>.*
<span class="hljs-keyword">import</span> org.springframework.web.context.request.WebRequest
<span class="hljs-keyword">import</span> java.io.UnsupportedEncodingException
<span class="hljs-keyword">import</span> javax.servlet.http.Cookie
<span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest
<span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.service.UserDetailsServiceImpl.Companion.TOKEN_VALID
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.service.UserDetailsServiceImpl.Companion.TOKEN_INVALID
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.service.UserDetailsServiceImpl.Companion.TOKEN_EXPIRED<font></font>
<font></font>
<span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping(<span class="hljs-meta-string">"/api/auth"</span>)</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AuthController</span></span>() {<font></font>
<font></font>
    <span class="hljs-meta">@Value(<span class="hljs-meta-string">"\${ksvg.app.authCookieName}"</span>)</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> authCookieName: String<font></font>
<font></font>
    <span class="hljs-meta">@Value(<span class="hljs-meta-string">"\${ksvg.app.isCookieSecure}"</span>)</span>
    <span class="hljs-keyword">var</span> isCookieSecure: <span class="hljs-built_in">Boolean</span> = <span class="hljs-literal">true</span><font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> authenticationManager: AuthenticationManager<font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> userRepository: UserRepository<font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> roleRepository: RoleRepository<font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> encoder: PasswordEncoder<font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> jwtProvider: JwtProvider<font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> captchaService: ReCaptchaService<font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> userService: UserDetailsService<font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> emailService: EmailService<font></font>
<font></font>
    <span class="hljs-meta">@PostMapping(<span class="hljs-meta-string">"/signin"</span>)</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">authenticateUser</span><span class="hljs-params">(<span class="hljs-meta">@Valid</span> <span class="hljs-meta">@RequestBody</span> loginRequest: <span class="hljs-type">LoginUser</span>, response: <span class="hljs-type">HttpServletResponse</span>)</span></span>: ResponseEntity&lt;*&gt; {<font></font>
<font></font>
        <span class="hljs-keyword">val</span> userCandidate: Optional &lt;User&gt; = userRepository.findByUsername(loginRequest.username!!)<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!captchaService.validateCaptcha(loginRequest.recaptchaToken!!)) {
            <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Validation failed (ReCaptcha v2)"</span>),<font></font>
                    HttpStatus.BAD_REQUEST)<font></font>
        }<font></font>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (userCandidate.isPresent) {
            <span class="hljs-keyword">val</span> user: User = userCandidate.<span class="hljs-keyword">get</span>()<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (!user.enabled) {
                <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Account is not verified yet! Please, follow the link in the confirmation email."</span>),<font></font>
                        HttpStatus.UNAUTHORIZED)<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">val</span> authentication = authenticationManager.authenticate(<font></font>
                    UsernamePasswordAuthenticationToken(loginRequest.username, loginRequest.password))<font></font>
            SecurityContextHolder.getContext().setAuthentication(authentication)<font></font>
            <span class="hljs-keyword">val</span> jwt: String = jwtProvider.generateJwtToken(user.username!!)<font></font>
<font></font>
            <span class="hljs-keyword">val</span> cookie: Cookie = Cookie(authCookieName, jwt)<font></font>
            cookie.maxAge = jwtProvider.jwtExpiration!!<font></font>
            cookie.secure = isCookieSecure<font></font>
            cookie.isHttpOnly = <span class="hljs-literal">true</span>
            cookie.path = <span class="hljs-string">"/"</span><font></font>
            response.addCookie(cookie)<font></font>
<font></font>
            <span class="hljs-keyword">val</span> authorities: List&lt;GrantedAuthority&gt; = user.roles!!.stream().map({ role -&gt; SimpleGrantedAuthority(role.name)}).collect(Collectors.toList&lt;GrantedAuthority&gt;())
            <span class="hljs-keyword">return</span> ResponseEntity.ok(SuccessfulSigninResponse(user.username, authorities))<font></font>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"User not found!"</span>),<font></font>
                    HttpStatus.BAD_REQUEST)<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@PostMapping(<span class="hljs-meta-string">"/signup"</span>)</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">registerUser</span><span class="hljs-params">(<span class="hljs-meta">@Valid</span> <span class="hljs-meta">@RequestBody</span> newUser: <span class="hljs-type">NewUser</span>)</span></span>: ResponseEntity&lt;*&gt; {<font></font>
<font></font>
        <span class="hljs-keyword">val</span> userCandidate: Optional &lt;User&gt; = userRepository.findByUsername(newUser.username!!)<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!captchaService.validateCaptcha(newUser.recaptchaToken!!)) {
            <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Validation failed (ReCaptcha v2)"</span>),<font></font>
                    HttpStatus.BAD_REQUEST)<font></font>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!userCandidate.isPresent) {
            <span class="hljs-keyword">if</span> (usernameExists(newUser.username!!)) {
                <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Username is already taken!"</span>),<font></font>
                        HttpStatus.BAD_REQUEST)<font></font>
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (emailExists(newUser.email!!)) {
                <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Email is already in use!"</span>),<font></font>
                        HttpStatus.BAD_REQUEST)<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// Creating user's account</span>
                <span class="hljs-keyword">val</span> user = User(
                        <span class="hljs-number">0</span>,<font></font>
                        newUser.username!!,<font></font>
                        newUser.firstName!!,<font></font>
                        newUser.lastName!!,<font></font>
                        newUser.email!!,<font></font>
                        encoder.encode(newUser.password),<font></font>
                        <span class="hljs-literal">false</span><font></font>
                )<font></font>
                user.roles = Arrays.asList(roleRepository.findByName(<span class="hljs-string">"ROLE_USER"</span>))
                <span class="hljs-keyword">val</span> registeredUser = userRepository.save(user)<font></font>
<font></font>
                emailService.sendRegistrationConfirmationEmail(registeredUser)<font></font>
            } <span class="hljs-keyword">catch</span> (e: Exception) {
                <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Server error. Please, contact site owner"</span>),<font></font>
                        HttpStatus.SERVICE_UNAVAILABLE)<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Please, follow the link in the confirmation email to complete the registration."</span>), HttpStatus.OK)<font></font>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"User already exists!"</span>),<font></font>
                    HttpStatus.BAD_REQUEST)<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@PostMapping(<span class="hljs-meta-string">"/registrationConfirm"</span>)</span>
    <span class="hljs-meta">@CrossOrigin(origins = [<span class="hljs-meta-string">"*"</span>])</span>
    <span class="hljs-meta">@Throws(UnsupportedEncodingException::class)</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">confirmRegistration</span><span class="hljs-params">(request: <span class="hljs-type">HttpServletRequest</span>, model: <span class="hljs-type">Model</span>, <span class="hljs-meta">@RequestParam(<span class="hljs-meta-string">"token"</span>)</span> token: <span class="hljs-type">String</span>)</span></span>: ResponseEntity&lt;*&gt; {<font></font>
<font></font>
        <span class="hljs-keyword">when</span>(userService.validateVerificationToken(token)) {<font></font>
            TOKEN_VALID -&gt; <span class="hljs-keyword">return</span> ResponseEntity.ok(ResponseMessage(<span class="hljs-string">"Registration confirmed"</span>))<font></font>
            TOKEN_INVALID -&gt; <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Token is invalid!"</span>), HttpStatus.BAD_REQUEST)<font></font>
            TOKEN_EXPIRED -&gt; <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Token is invalid!"</span>), HttpStatus.UNAUTHORIZED)<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Server error. Please, contact site owner"</span>), HttpStatus.SERVICE_UNAVAILABLE)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@PostMapping(<span class="hljs-meta-string">"/logout"</span>)</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">logout</span><span class="hljs-params">(response: <span class="hljs-type">HttpServletResponse</span>)</span></span>: ResponseEntity&lt;*&gt; {
        <span class="hljs-keyword">val</span> cookie: Cookie = Cookie(authCookieName, <span class="hljs-literal">null</span>)<font></font>
        cookie.maxAge = <span class="hljs-number">0</span><font></font>
        cookie.secure = isCookieSecure<font></font>
        cookie.isHttpOnly = <span class="hljs-literal">true</span>
        cookie.path = <span class="hljs-string">"/"</span><font></font>
        response.addCookie(cookie)<font></font>
<font></font>
        <span class="hljs-keyword">return</span> ResponseEntity.ok(ResponseMessage(<span class="hljs-string">"Successfully logged"</span>))<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">emailExists</span><span class="hljs-params">(email: <span class="hljs-type">String</span>)</span></span>: <span class="hljs-built_in">Boolean</span> {
        <span class="hljs-keyword">return</span> userRepository.findByUsername(email).isPresent<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">usernameExists</span><span class="hljs-params">(username: <span class="hljs-type">String</span>)</span></span>: <span class="hljs-built_in">Boolean</span> {
        <span class="hljs-keyword">return</span> userRepository.findByUsername(username).isPresent<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ä½œæ¥­ã—</font><font style="vertical-align: inherit;">ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚</font></font><code>RegistrationConfirmPage.vue</code><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ2</font></font></b><font style="vertical-align: inherit;"></font><code>router.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</font><font style="vertical-align: inherit;">ã§æ–°ã—ã„ãƒ‘ã‚¹ã‚’è¿½åŠ </font><font style="vertical-align: inherit;">ã—ã¾ã™</font></font><code>:token</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="javascript hljs"><font></font>
{<font></font>
        <span class="hljs-attr">path</span>: <span class="hljs-string">'/registration-confirm/:token'</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-string">'RegistrationConfirmPage'</span>,
        <span class="hljs-attr">component</span>: RegistrationConfirmPage<font></font>
}<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ›´æ–°</font></font><code>SignUp.vue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’æ­£å¸¸ã«é€ä¿¡ã—ãŸå¾Œã€ç™»éŒ²ã‚’å®Œäº†ã™ã‚‹ã«ã¯ãƒ¬ã‚¿ãƒ¼ã®ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã‚’é€šçŸ¥ã—ã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ4 </font></font></b> <u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é‡è¦ï¼š</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ®‹å¿µãªãŒã‚‰ã€ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ¤œè¨¼ã—ã¦æˆåŠŸã¾ãŸã¯å¤±æ•—ã‚’å ±å‘Šã™ã‚‹åˆ¥ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¸ã®å›ºå®šãƒªãƒ³ã‚¯ã‚’æä¾›ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ãƒ‘ã‚¹ãŒã™ã¹ã¦åŒã˜ãƒªãƒ³ã‚¯ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å…ƒã®ãƒšãƒ¼ã‚¸ã«ç§»å‹•ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã—ã‹ã—ã€é€ä¿¡ã•ã‚ŒãŸGETãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¦ç™»éŒ²ã‚’ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã‚’ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ä¼ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™</font></font><code>confirmRegistration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="javascript hljs">
<span class="hljs-attr">methods</span>: {<font></font>
    confirmRegistration() {<font></font>
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.$route.query.confirmRegistration === <span class="hljs-string">'true'</span> &amp;&amp; <span class="hljs-keyword">this</span>.$route.query.token != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">this</span>.$router.push({<span class="hljs-attr">name</span>: <span class="hljs-string">'RegistrationConfirmPage'</span>, <span class="hljs-attr">params</span>: { <span class="hljs-attr">token</span>: <span class="hljs-keyword">this</span>.$route.query.token}});<font></font>
      }<font></font>
    },<font></font>
<font></font>
...<font></font>
<font></font>
mounted() {<font></font>
    <span class="hljs-keyword">this</span>.confirmRegistration();<font></font>
  }<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ƒ5</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ¤œè¨¼ã—ã€æ¤œè¨¼çµæœã‚’å ±å‘Šã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RegistrationConfirmPage.vue</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs"><font></font>
&lt;template&gt;<font></font>
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"registration-confirm"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"confirm-form"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">b-card</span>
              <span class="hljs-attr">title</span>=<span class="hljs-string">"Confirmation"</span>
              <span class="hljs-attr">tag</span>=<span class="hljs-string">"article"</span>
              <span class="hljs-attr">style</span>=<span class="hljs-string">"max-width: 20rem;"</span>
              <span class="hljs-attr">class</span>=<span class="hljs-string">"mb-2"</span>
            &gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"isSuccess"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"success"</span>&gt;</span>Account is successfully verified!<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/login"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">b-button</span> <span class="hljs-attr">variant</span>=<span class="hljs-string">"primary"</span>&gt;</span>Login<span class="hljs-tag">&lt;/<span class="hljs-name">b-button</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"isError"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fail"</span>&gt;</span>Verification failed:<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ errorMessage }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">b-card</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><font></font>
&lt;/template&gt;<font></font>
<font></font>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> {AXIOS} <span class="hljs-keyword">from</span> <span class="hljs-string">'./http-common'</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'RegistrationConfirmPage'</span>,
    data() {
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">isSuccess</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">isError</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">errorMessage</span>: <span class="hljs-string">''</span>
        }
    },
    <span class="hljs-attr">methods</span>: {
        executeVerification() {
            AXIOS.post(<span class="hljs-string">`/auth/registrationConfirm`</span>, <span class="hljs-literal">null</span>, {<span class="hljs-attr">params</span>: { <span class="hljs-string">'token'</span>: <span class="hljs-keyword">this</span>.$route.params.token}})
            .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
              <span class="hljs-keyword">this</span>.isSuccess = <span class="hljs-literal">true</span>;
              <span class="hljs-built_in">console</span>.log(response);
            }, error =&gt; {
                <span class="hljs-keyword">this</span>.isError = <span class="hljs-literal">true</span>;
                <span class="hljs-keyword">this</span>.errorMessage = error.response.data.message;
            })
            .catch(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
              <span class="hljs-built_in">console</span>.log(e);
              <span class="hljs-keyword">this</span>.errorMessage = <span class="hljs-string">'Server error. Please, report this error website owners'</span>;
            })
        }
    },
    mounted() {
        <span class="hljs-keyword">this</span>.executeVerification();
    }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><font></font>
<font></font>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.confirm-form</span> {
    <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">38%</span>;
    <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">50px</span>;
}
<span class="hljs-selector-class">.success</span> {
    <span class="hljs-attribute">color</span>: green;
}
<span class="hljs-selector-class">.fail</span> {
    <span class="hljs-attribute">color</span>: red;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çµæœ</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/0n/vj/os/0nvjosmit-f6n538uae6rsvwujo.png"><br>
</div></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çµè«–ã®ä»£ã‚ã‚Šã«</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®è³‡æ–™ã®æœ€å¾Œã«ã€ä½™è«‡ã‚’è¿°ã¹ãŸã„ã¨æ€ã„ã¾ã™ã€‚ã“ã‚Œã¨ã“ã‚Œã¾ã§ã®è¨˜äº‹ã§èª¬æ˜ã—ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ¦‚å¿µãã®ã‚‚ã®ã¯ã€åŸ·ç­†æ™‚ç‚¹ã§ã¯æ–°ã—ã„ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</font><font style="vertical-align: inherit;">æœ€æ–°ã®JavaScriptãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯Angular / React / Vue.jsã‚’ä½¿ç”¨ã—ã¦ã€Spring Bootã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Œå…¨ãªã‚¹ã‚¿ãƒƒã‚¯ã‚’ã™ã°ã‚„ãä½œæˆã™ã‚‹ã‚¿ã‚¹ã‚¯ã¯ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hipsterã‚’</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¨ãƒ¬ã‚¬ãƒ³ãƒˆã«è§£æ±ºã—</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãŸã ã—ã€ã“ã®è¨˜äº‹ã§èª¬æ˜ã™ã‚‹ã‚¢ã‚¤ãƒ‡ã‚¢ã¯JHipsterã‚’ä½¿ç”¨ã—ã¦ã‚‚å®Ÿè£…ã§ãã‚‹ãŸã‚ã€ã“ã®å ´æ‰€ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸèª­è€…ãŒã“ã®è³‡æ–™ãŒæ€è€ƒã®ç³§ã¨ã—ã¦ã‚‚å½¹ç«‹ã¤ã“ã¨ã‚’é¡˜ã£ã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<a name="links"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å½¹ç«‹ã¤ãƒªãƒ³ã‚¯</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHubãƒªãƒã‚¸ãƒˆãƒªï¼ˆã€ŒMigrate to Gradleã€ã‚¹ãƒ†ãƒƒãƒ—ã¾ã§ï¼‰</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHubãƒªãƒã‚¸ãƒˆãƒªï¼ˆã€ŒMigrate to Gradleã€ã‚¹ãƒ†ãƒƒãƒ—ã®å¾Œï¼‰</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆã€ŒMigrate to Gradleã€ã‚¹ãƒ†ãƒƒãƒ—ã¾ã§ï¼‰</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆã€ŒMigration to Gradleã€ã®ã‚¹ãƒ†ãƒƒãƒ—ã®å¾Œï¼‰</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç§ãŒæ›¸ã„ãŸåŒã˜è³‡æ–™ã€è‹±èªã®ã¿</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vuejsã§Google reCaptchaã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vue.jsç”¨ã®Google ReCAPTCHAã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spring Emailã®ã‚¬ã‚¤ãƒ‰</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spring Bootã¨Thymeleafã‚’ä½¿ç”¨ã—ã¦ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã™ã‚‹</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apache Mavenã‹ã‚‰ã®ãƒ“ãƒ«ãƒ‰ã®ç§»è¡Œ</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ“ãƒ«ãƒ‰ãƒ­ã‚¸ãƒƒã‚¯ã‚’Groovyã‹ã‚‰Kotlinã«ç§»è¡Œã™ã‚‹</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gradleã‚’ä½¿ç”¨ã—ã¦Spring Bootã«Angularã‚’çµ±åˆã™ã‚‹</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Herokuã§ã®Gradleã®ä½¿ç”¨é–‹å§‹</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Herokuã§ã®Gradleã‚¢ãƒ—ãƒªã®ãƒ‡ãƒ—ãƒ­ã‚¤</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ãƒãƒ«ãƒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ“ãƒ«ãƒ‰ã®ãƒ‡ãƒ—ãƒ­ã‚¤ </font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ä½¿ç”¨ã‚’åœæ­¢ã—ã¦ãã ã•ã„</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SPAï¼ˆReactJSãŠã‚ˆã³VueJSï¼‰ã§ã®èªè¨¼ãŒæ­£ã—ã„æ–¹æ³•</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spring Boot REST APIã‚’ä¿è­·ã™ã‚‹ãŸã‚ã®JWTã‚’ä½¿ç”¨ã—ãŸã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹èªè¨¼</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç™»éŒ²-ãƒ¡ãƒ¼ãƒ«ã§æ–°ã—ã„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja482210/index.html">ãƒ†ãƒˆãƒªã‚¹ãŠã‚ˆã³ãƒªãƒãƒ¼ã‚¹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã®ãƒœãƒƒãƒˆã€‚ç¬¬2å›ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãƒãƒ£ãƒ³ãƒ”ã‚ªãƒ³ã‚·ãƒƒãƒ—ã®ãƒ¢ãƒã‚¤ãƒ«ãƒˆãƒ©ãƒƒã‚¯ã®åˆ†æ</a></li>
<li><a href="../ja482212/index.html">...ãƒãƒ¼ã‚ºã«ã¤ã„ã¦è©±ã—ã¾ã™ã‹ï¼Ÿ</a></li>
<li><a href="../ja482216/index.html">å°‚é–€ã®ç²¾ç¥ç§‘åŒ»ãƒã‚­ã‚·ãƒ ãƒãƒªãƒ¤ãƒ“ãƒ³ï¼ˆdpmmaxï¼‰ã‹ã‚‰ã†ã¤ç—…ã¸ã®23ã®å¿œç­”</a></li>
<li><a href="../ja482218/index.html">12æœˆ27æ—¥ã®Javaãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆ</a></li>
<li><a href="../ja482220/index.html">ã‚¢ãƒ«ã‚³ãƒãƒ¼ã‚«ãƒ¼ã«ã‚ˆã‚‹ãƒ­ãƒ¼ã‚«ãƒªã‚¼ãƒ¼ã‚·ãƒ§ãƒ³</a></li>
<li><a href="../ja482224/index.html">ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãŒå°ã•ãªãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆ</a></li>
<li><a href="../ja482228/index.html">Cï¼ƒã§ã€Œé›»å“ã€ã‚’è¨˜è¿°ã—ã¾ã™ã€‚ãƒ‘ãƒ¼ãƒˆI.å€¤ã®è¨ˆç®—ã€å°é–¢æ•°ã€å˜ç´”åŒ–ã€ãŠã‚ˆã³ãã®ä»–ã®ã‚¬ãƒãƒ§ã‚¦</a></li>
<li><a href="../ja482230/index.html">WEBã‚µãƒ¼ãƒãƒ¼ã®æˆ¦ã„ã€‚ãƒ‘ãƒ¼ãƒˆ2-ç¾å®Ÿçš„ãªHTTPSã‚·ãƒŠãƒªã‚ªï¼š</a></li>
<li><a href="../ja482232/index.html">StackOverflowã¯ã€æ„šã‹ãªè³ªå•ã«å¯¾ã™ã‚‹å›ç­”ã®å˜ãªã‚‹ãƒªãƒã‚¸ãƒˆãƒªã§ã¯ã‚ã‚Šã¾ã›ã‚“</a></li>
<li><a href="../ja482234/index.html">PADS Professionalã§ã®ãƒ‡ã‚¸ã‚¿ãƒ«ã‹ã‚‰ã‚¢ãƒŠãƒ­ã‚°ãŠã‚ˆã³æ··åˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>