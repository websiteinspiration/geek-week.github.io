<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧔 ⛩️ 🔓 Kotlin + Spring Boot + Vue.js（アドオン）上のWebアプリケーション 🌄 💽 ⏰</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="こんにちは、Habrの親愛なる住民！
 
 名前が示すように、この記事はKotlin + Spring Boot + Vue.jsで以前に作成されたWebアプリケーションに追加されるものです。
 
 話を始める前に、前回の記事でコメントしてくれた皆さんに感謝します。
 
 コンテンツ
 

- CI...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Kotlin + Spring Boot + Vue.js（アドオン）上のWebアプリケーション</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482222/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こんにちは、Habrの親愛なる住民！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
名前が示すように、この記事は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kotlin + Spring Boot + Vue.js</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">以前に作成された</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Webアプリケーションに</font></a><font style="vertical-align: inherit;">追加される</font><font style="vertical-align: inherit;">ものです。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
話を始める前に、前回の記事でコメントしてくれた皆さんに感謝します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテンツ</font></font></h3><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CI / CDセットアップ（Heroku）</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ボット保護（reCAPTCHA）</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メール送信</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gradleの移行</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JWTトークンをCookieに保存する</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メール登録確認</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">役立つリンク</font></font></a></li>
</ul><br>
<a name="cicd"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CI / CDセットアップ（Heroku）</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例として、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Heroku</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラウドPaaSプラットフォームを使用した継続的な統合と配信の実装を検討してください</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、アプリケーションコードを</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のリポジトリに配置する必要があり</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">リポジトリに余分なものがないように、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.gitignore</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルの次の内容をお勧めします</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.gitignore</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">*.class<font></font>
<font></font>
# Help #<font></font>
backend/*.md<font></font>
<font></font>
# Package Files #<font></font>
*.jar<font></font>
*.war<font></font>
*.ear<font></font>
<font></font>
# Eclipse #<font></font>
.settings<font></font>
.project<font></font>
.classpath<font></font>
.studio<font></font>
target<font></font>
<font></font>
# NetBeans #<font></font>
backend/nbproject/private/<font></font>
backend/nbbuild/<font></font>
backend/dist/<font></font>
backend/nbdist/<font></font>
backend/.nb-gradle/<font></font>
backend/build/<font></font>
<font></font>
# Apple # <font></font>
.DS_Store<font></font>
<font></font>
# Intellij #<font></font>
.idea<font></font>
*.iml<font></font>
*.log<font></font>
<font></font>
# logback<font></font>
logback.out.xml<font></font>
<font></font>
backend/src/main/resources/public/<font></font>
backend/target<font></font>
backend/.mvn<font></font>
backend/mvnw<font></font>
frontend/dist/<font></font>
frontend/node/<font></font>
frontend/node_modules/<font></font>
frontend/npm-debug.log<font></font>
frontend/target<font></font>
<font></font>
!.mvn/wrapper/maven-wrapper.jar<font></font>
</code></pre><br>
</div></div><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要：</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あなたはHerokuので作業を開始する前に、と呼ばれるファイルを追加</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Procfileを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（拡張子なし）</font><font style="vertical-align: inherit;">ルートディレクトリに</font><font style="vertical-align: inherit;">ラインを持つ：</font></font><br>
<code>web: java -Dserver.port=$PORT -jar backend/target/backend-0.0.1-SNAPSHOT.jar</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">どこ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バックエンド-0.0.1-SNAPSHOT.jarには、</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">組み立てられるJARファイルの名前です。</font><font style="vertical-align: inherit;">そして、必ず</font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コミットしてプッシュしてください</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> travis.yamlファイルをルートディレクトリに追加して、Herokuでのアプリケーションのビルドとデプロイの時間を短縮することもできます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">travis.yaml</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">language: java<font></font>
jdk:<font></font>
- oraclejdk8<font></font>
script: mvn clean install jacoco:report coveralls:report<font></font>
cache:<font></font>
     directories:<font></font>
     - node_modules </code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に：</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃1 </font></font></b><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Herokuに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">登録し</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいアプリケーションを作成します。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいアプリケーションを作成する</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/u3/ml/bx/u3mlbx0w2ho3uezsrl75nyse2m4.png"><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Herokuを使用すると、PostreSQLデータベースなどの追加リソースをアプリケーションに接続できます。</font><font style="vertical-align: inherit;">これを行うには、次のようにします。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーション-&gt;リソース-&gt;アドオン-&gt; Heroku Postgres</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Heroku Postgres</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/k5/l8/ht/k5l8htgji3kaxmqyznbdqhyeuki.png"><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プランを選択：</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">計画の選択</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/id/jv/vd/idjvvdwyyk9ou_wbes00mxvfdac.png"><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃5</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これで、接続されたリソースを確認できます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接続されたリソース</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/l2/mx/mf/l2mxmf3itjef2-1lpiwmltrtadq.png"><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃6</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">資格情報を確認します。環境変数を設定するために必要です。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">設定-&gt;資格情報の表示</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">資格情報を表示する</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/gh/xl/v9/ghxlv99r9m2mgrr6ceemgpn-hjg.png"><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃7</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">環境変数を設定します：</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーション-&gt;設定-&gt;構成</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数を表示</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">環境変数</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/xr/uj/q8/xrujq8lynqi6kqoqtqiklpwbaxu.png"><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃8</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接続の環境変数を次の形式で設定します。</font></font><br>
<br>
<pre><code class="plaintext hljs">SPRING_DATASOURCE_URL = jdbc:postgresql://&lt;i&gt;hostname:port&lt;/i&gt;/&lt;i&gt;db_name&lt;/i&gt;<font></font>
SPRING_DATASOURCE_USERNAME = &lt;i&gt;username&lt;/i&gt;<font></font>
SPRING_DATASOURCE_PASSWORD = &lt;i&gt;password&lt;/i&gt;<font></font>
</code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それはどのように見えますか</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/me/jr/ne/mejrnecja54rgwchq6peumbc6w0.png"><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃9</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいデータベースに必要なすべてのテーブルを作成します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃10</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> application.propertiesファイルは、それぞれ次のようになります。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application.properties</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">spring.datasource.url=${SPRING_DATASOURCE_URL}<font></font>
spring.datasource.username=${SPRING_DATASOURCE_USERNAME}<font></font>
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD}<font></font>
<font></font>
spring.jpa.generate-ddl=true<font></font>
spring.jpa.properties.hibernate.temp.use_jdbc_metadata_defaults = false<font></font>
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQL9Dialect<font></font>
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true <font></font>
</code></pre><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃11 </font></font></b><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいパイプラインを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作成する- </font><i><font style="vertical-align: inherit;">新しいパイプラインを作成します</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいパイプラインを作成する</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/dh/sg/wb/dhsgwbhgaz9arzl4lgwkdoykeda.png"><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃12</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デプロイ方法</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-GitHub</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（[ </font><i><font style="vertical-align: inherit;">GitHubに</font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接続</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]をクリック</font><font style="vertical-align: inherit;">し、新しいウィンドウの指示に従います）。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃13</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自動展開をアクティブにする-自動展開を</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有効にする</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自動デプロイを有効にする</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/8e/fb/ui/8efbuinhnr0y1j7eggqkhbjae2s.png"><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃14</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">手動展開- </font><font style="vertical-align: inherit;">最初の展開の</font><font style="vertical-align: inherit;">[ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">展開ブランチ]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">クリックし</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">ブラウザの右側に、コマンドラインの出力が表示されます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">手動展開</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/7i/5m/tz/7i5mtzam___vhonxjbtuogrg-ay.png"><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃15</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ビルドが成功した後で</font><font style="vertical-align: inherit;">[ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">クリック</font><font style="vertical-align: inherit;">して、デプロイされたアプリケーションを開きます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">見る</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/cp/p-/fr/cpp-frnkeudluh4bm1ir-f4oi10.png"><br>
</div></div><br>
<a name="recaptcha"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ボット保護（reCAPTCHA）</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーションでreCAPTCHA検証を有効にする最初のステップは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Google管理パネル</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で新しいreCAPTCHを作成すること</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">です</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">そこで新しいサイトを作成し（新しいサイトの追加/作成）、次の設定を行います。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReCAPTCHA設定</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/xi/eh/rp/xiehrpgngjvxqvd1dq-4wp5gfqc.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドメイン]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セクション</font><font style="vertical-align: inherit;">では、アプリケーションが存在するアドレスに加えて、</font></font><code>localhost</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デバッグ中にアプリケーションにログインできないという形でトラブルを回避することを指定する必要があります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バックエンド</font></font></b><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">サイトキー</font></i><font style="vertical-align: inherit;">と</font><i><font style="vertical-align: inherit;">シークレットキーを</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
保存し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;"> ...</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイトキー/シークレットキー</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/hs/re/-t/hsre-ttxpgbhgau9q4fsvtdqxq0.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...次に、それらを環境変数に割り当て、次に変数名を新しい</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application.properties</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロパティに割り当てます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="plaintext hljs">google.recaptcha.key.site=${GOOGLE_RECAPTCHA_KEY_SITE}<font></font>
google.recaptcha.key.secret=${GOOGLE_RECAPTCHA_KEY_SECRET}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クライアントがGoogleに送信するGoogle reCAPTCHAトークンの側で検証するために</font><font style="vertical-align: inherit;">
、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pom.xmlに</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しい依存関係を追加</font><font style="vertical-align: inherit;">します。</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.mashape.unirest<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>unirest-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.4.9<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、同じreCAPTCHAトークンに文字列フィールドを追加して、ユーザーの承認と登録に使用するエンティティを更新します。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LoginUser.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">import</span> com.fasterxml.jackson.<span class="hljs-keyword">annotation</span>.JsonProperty
<span class="hljs-keyword">import</span> java.io.Serializable<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoginUser</span> : <span class="hljs-type">Serializable {</span></span><font></font>
<font></font>
   <span class="hljs-meta">@JsonProperty(<span class="hljs-meta-string">"username"</span>)</span>
   <span class="hljs-keyword">var</span> username: String? = <span class="hljs-literal">null</span><font></font>
<font></font>
   <span class="hljs-meta">@JsonProperty(<span class="hljs-meta-string">"password"</span>)</span>
   <span class="hljs-keyword">var</span> password: String? = <span class="hljs-literal">null</span><font></font>
<font></font>
   <span class="hljs-meta">@JsonProperty(<span class="hljs-meta-string">"recapctha_token"</span>)</span>
   <span class="hljs-keyword">var</span> recaptchaToken: String? = <span class="hljs-literal">null</span><font></font>
<font></font>
   <span class="hljs-keyword">constructor</span>() {}<font></font>
<font></font>
   <span class="hljs-keyword">constructor</span>(username: String, password: String, recaptchaToken: String) {
       <span class="hljs-keyword">this</span>.username = username
       <span class="hljs-keyword">this</span>.password = password
       <span class="hljs-keyword">this</span>.recaptchaToken = recaptchaToken<font></font>
   }<font></font>
<font></font>
   <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {<font></font>
<font></font>
       <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> serialVersionUID = -<span class="hljs-number">1764970284520387975L</span><font></font>
   }<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewUser.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">import</span> com.fasterxml.jackson.<span class="hljs-keyword">annotation</span>.JsonProperty
<span class="hljs-keyword">import</span> java.io.Serializable<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NewUser</span> : <span class="hljs-type">Serializable {</span></span><font></font>
<font></font>
   <span class="hljs-meta">@JsonProperty(<span class="hljs-meta-string">"username"</span>)</span>
   <span class="hljs-keyword">var</span> username: String? = <span class="hljs-literal">null</span><font></font>
<font></font>
   <span class="hljs-meta">@JsonProperty(<span class="hljs-meta-string">"firstName"</span>)</span>
   <span class="hljs-keyword">var</span> firstName: String? = <span class="hljs-literal">null</span><font></font>
<font></font>
   <span class="hljs-meta">@JsonProperty(<span class="hljs-meta-string">"lastName"</span>)</span>
   <span class="hljs-keyword">var</span> lastName: String? = <span class="hljs-literal">null</span><font></font>
<font></font>
   <span class="hljs-meta">@JsonProperty(<span class="hljs-meta-string">"email"</span>)</span>
   <span class="hljs-keyword">var</span> email: String? = <span class="hljs-literal">null</span><font></font>
<font></font>
   <span class="hljs-meta">@JsonProperty(<span class="hljs-meta-string">"password"</span>)</span>
   <span class="hljs-keyword">var</span> password: String? = <span class="hljs-literal">null</span><font></font>
<font></font>
   <span class="hljs-meta">@JsonProperty(<span class="hljs-meta-string">"recapctha_token"</span>)</span>
   <span class="hljs-keyword">var</span> recaptchaToken: String? = <span class="hljs-literal">null</span><font></font>
<font></font>
   <span class="hljs-keyword">constructor</span>() {}<font></font>
<font></font>
   <span class="hljs-keyword">constructor</span>(username: String, firstName: String, lastName: String, email: String, password: String, recaptchaToken: String) {
       <span class="hljs-keyword">this</span>.username = username
       <span class="hljs-keyword">this</span>.firstName = firstName
       <span class="hljs-keyword">this</span>.lastName = lastName
       <span class="hljs-keyword">this</span>.email = email
       <span class="hljs-keyword">this</span>.password = password
       <span class="hljs-keyword">this</span>.recaptchaToken = recaptchaToken<font></font>
   }<font></font>
<font></font>
   <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {<font></font>
<font></font>
       <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> serialVersionUID = -<span class="hljs-number">1764970284520387975L</span><font></font>
   }<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
reCAPTCHAトークンを特別なGoogleサービスにブロードキャストする小さなサービスを追加し、トークンが検証に合格したかどうかに応じて通知します。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReCaptchaService.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">import</span> org.springframework.beans.factory.<span class="hljs-keyword">annotation</span>.Value
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service
<span class="hljs-keyword">import</span> org.springframework.web.client.RestOperations
<span class="hljs-keyword">import</span> org.springframework.beans.factory.<span class="hljs-keyword">annotation</span>.Autowired
<span class="hljs-keyword">import</span> com.mashape.unirest.http.HttpResponse
<span class="hljs-keyword">import</span> com.mashape.unirest.http.JsonNode
<span class="hljs-keyword">import</span> com.mashape.unirest.http.Unirest<font></font>
<font></font>
<font></font>
<span class="hljs-meta">@Service(<span class="hljs-meta-string">"captchaService"</span>)</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReCaptchaService</span> </span>{<font></font>
<font></font>
   <span class="hljs-keyword">val</span> BASE_VERIFY_URL: String = <span class="hljs-string">"https://www.google.com/recaptcha/api/siteverify"</span><font></font>
<font></font>
   <span class="hljs-meta">@Autowired</span>
   <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> restTemplate: RestOperations? = <span class="hljs-literal">null</span><font></font>
<font></font>
   <span class="hljs-meta">@Value(<span class="hljs-meta-string">"\${google.recaptcha.key.site}"</span>)</span>
   <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> keySite: String<font></font>
<font></font>
   <span class="hljs-meta">@Value(<span class="hljs-meta-string">"\${google.recaptcha.key.secret}"</span>)</span>
   <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> keySecret: String<font></font>
<font></font>
   <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">validateCaptcha</span><span class="hljs-params">(token: <span class="hljs-type">String</span>)</span></span>: <span class="hljs-built_in">Boolean</span> {<font></font>
<font></font>
       <span class="hljs-keyword">val</span> url: String = String.format(BASE_VERIFY_URL + <span class="hljs-string">"?secret=%s&amp;response=%s"</span>, keySecret, token)<font></font>
<font></font>
       <span class="hljs-keyword">val</span> jsonResponse: HttpResponse&lt;JsonNode&gt; = Unirest.<span class="hljs-keyword">get</span>(url)<font></font>
               .header(<span class="hljs-string">"accept"</span>, <span class="hljs-string">"application/json"</span>).queryString(<span class="hljs-string">"apiKey"</span>, <span class="hljs-string">"123"</span>)<font></font>
               .asJson()<font></font>
<font></font>
       <span class="hljs-keyword">return</span> (jsonResponse.getStatus() == <span class="hljs-number">200</span>)<font></font>
   }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このサービスは、ユーザー登録および許可コントローラーで使用する必要があります。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AuthController.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">import</span> com.kotlinspringvue.backend.service.ReCaptchaService<font></font>
<font></font>
… <font></font>
<font></font>
<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> captchaService: ReCaptchaService<font></font>
<font></font>
… <font></font>
<font></font>
<span class="hljs-keyword">if</span> (!captchaService.validateCaptcha(loginRequest.recaptchaToken!!)) {
     <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Validation failed (ReCaptcha v2)"</span>),<font></font>
     HttpStatus.BAD_REQUEST)<font></font>
}<font></font>
<span class="hljs-keyword">else</span> [<span class="hljs-keyword">if</span>]...<font></font>
<font></font>
… <font></font>
<font></font>
<span class="hljs-keyword">if</span> (!captchaService.validateCaptcha(newUser.recaptchaToken!!)) {
     <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Validation failed (ReCaptcha v2)"</span>),<font></font>
     HttpStatus.BAD_REQUEST)<font></font>
} <span class="hljs-keyword">else</span>...
</code></pre><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フロントエンド</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
最初のステップは、パッケージをインストールして保存すること</font></font><code>reCAPTHA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です：</font></font><br>
<br>
<pre><code class="plaintext hljs">$ npm install --save vue-recaptcha</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">index.html</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のスクリプトに接続します</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://www.google.com/recaptcha/api.js onload=vueRecaptchaApiLoaded&amp;render=explicit"</span> <span class="hljs-attr">async</span> <span class="hljs-attr">defer</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ページの任意の空きスペースにキャプチャを追加します。</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">vue-recaptcha</span>
     <span class="hljs-attr">ref</span>=<span class="hljs-string">"recaptcha"</span>
     <span class="hljs-attr">size</span>=<span class="hljs-string">"invisible"</span>
     <span class="hljs-attr">:sitekey</span>=<span class="hljs-string">"sitekey"</span>
     @<span class="hljs-attr">verify</span>=<span class="hljs-string">"onCapthcaVerified"</span>
     @<span class="hljs-attr">expired</span>=<span class="hljs-string">"onCaptchaExpired"</span>
/&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、ターゲットアクション（承認または登録）のボタンは、最初に検証メソッドを呼び出します。</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">b-button</span> <span class="hljs-attr">v-on:click</span>=<span class="hljs-string">"validateCaptcha"</span> <span class="hljs-attr">variant</span>=<span class="hljs-string">"primary"</span>&gt;</span>Login<span class="hljs-tag">&lt;/<span class="hljs-name">b-button</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンポーネントに依存関係を追加します。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> VueRecaptcha <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-recaptcha'</span></code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エクスポートのデフォルトを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
編集</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="javascript hljs">
<span class="hljs-attr">components</span>: { VueRecaptcha },<font></font>
…<font></font>
data() {<font></font>
…<font></font>
<span class="hljs-attr">siteKey</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">i</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span></span><font></font>
…<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、新しいメソッドを追加します。</font></font><br>
<br>
<ul>
<li><code>validateCaptcha()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -ボタンをクリックすると呼び出されます</font></font></li>
<li><code>onCapthcaVerified(recaptchaToken)  onCaptchaExpired()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -キャプチャ自体が原因</font></font></li>
</ul><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しい方法</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs"><font></font>
validateCaptcha() {<font></font>
     <span class="hljs-keyword">this</span>.$refs.recaptcha.execute()<font></font>
},<font></font>
<font></font>
onCapthcaVerified(recaptchaToken) {<font></font>
<font></font>
     AXIOS.post(<span class="hljs-string">`/auth/signin`</span>, {<span class="hljs-string">'username'</span>: <span class="hljs-keyword">this</span>.$data.username, <span class="hljs-string">'password'</span>: <span class="hljs-keyword">this</span>.$data.password, <span class="hljs-string">'recapctha_token'</span>: recaptchaToken})<font></font>
     .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
          <span class="hljs-keyword">this</span>.$store.dispatch(<span class="hljs-string">'login'</span>, {<span class="hljs-string">'token'</span>: response.data.accessToken, <span class="hljs-string">'roles'</span>: response.data.authorities, <span class="hljs-string">'username'</span>: response.data.username});
          <span class="hljs-keyword">this</span>.$router.push(<span class="hljs-string">'/home'</span>)<font></font>
     }, error =&gt; {<font></font>
          <span class="hljs-keyword">this</span>.showAlert(error.response.data.message);<font></font>
  })<font></font>
     .catch(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
     <span class="hljs-built_in">console</span>.log(e);
            <span class="hljs-keyword">this</span>.showAlert(<span class="hljs-string">'Server error. Please, report this error website owners'</span>);<font></font>
  })<font></font>
},<font></font>
onCaptchaExpired() {<font></font>
   <span class="hljs-keyword">this</span>.$refs.recaptcha.reset()<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/m0/rc/w9/m0rcw9xjgqjqpgiuwdib16_mur8.png"><br>
</div></div><br>
<a name="email"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メール送信</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GoogleやMail.ruなどのパブリックメールサーバーを介してアプリケーションに手紙を送る可能性を検討してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それぞれの最初のステップは、選択されたメールサーバーにアカウントを作成することです（まだ作成されていない場合）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のステップでは、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pom.xmlに</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次の依存関係を追加する必要があります</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">依存関係</font></font></b><div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-mail<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-io<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-io<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application.propertiesに</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいプロパティを追加する必要があり</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SMTPプロパティ</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">spring.mail.host=${SMTP_MAIL_HOST}<font></font>
spring.mail.port=${SMTP_MAIL_PORT}<font></font>
spring.mail.username=${SMTP_MAIL_USERNAME}<font></font>
spring.mail.password=${SMTP_MAIL_PASSWORD}<font></font>
spring.mail.properties.mail.smtp.auth=true<font></font>
spring.mail.properties.mail.smtp.starttls.enable=true<font></font>
spring.mail.properties.mail.smtp.ssl.enable=true<font></font>
spring.mail.properties.mail.smtp.connectiontimeout=5000<font></font>
spring.mail.properties.mail.smtp.timeout=5000<font></font>
spring.mail.properties.mail.smtp.writetimeout=5000<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでSMTP設定を指定できます：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mail.ru</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
いくつかのメソッドを宣言するインターフェースを作成しましょう：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常のテキストメッセージを送信するには</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTMLメールを送信するには</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テンプレートを使用してメールを送信するには</font></font></li>
</ul><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EmailService.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">package</span> com.kotlinspringvue.backend.email<font></font>
<font></font>
<span class="hljs-keyword">import</span> org.springframework.mail.SimpleMailMessage<font></font>
<font></font>
<span class="hljs-keyword">internal</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">EmailService</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendSimpleMessage</span><span class="hljs-params">(to: <span class="hljs-type">String</span>,
                          subject: <span class="hljs-type">String</span>,
                          text: <span class="hljs-type">String</span>)</span></span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendSimpleMessageUsingTemplate</span><span class="hljs-params">(to: <span class="hljs-type">String</span>,
                                       subject: <span class="hljs-type">String</span>,
                                       template: <span class="hljs-type">String</span>,
                                       params:<span class="hljs-type">MutableMap</span>&lt;<span class="hljs-type">String</span>, Any&gt;)</span></span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendHtmlMessage</span><span class="hljs-params">(to: <span class="hljs-type">String</span>,
                        subject: <span class="hljs-type">String</span>,
                        htmlMsg: <span class="hljs-type">String</span>)</span></span><font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、このインターフェースの実装を作成しましょう-電子メールを送信するサービス：</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EmailServiceImpl.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">package</span> com.kotlinspringvue.backend.email<font></font>
<font></font>
<span class="hljs-keyword">import</span> org.springframework.beans.factory.<span class="hljs-keyword">annotation</span>.Autowired
<span class="hljs-keyword">import</span> org.springframework.beans.factory.<span class="hljs-keyword">annotation</span>.Value
<span class="hljs-keyword">import</span> org.springframework.core.io.FileSystemResource
<span class="hljs-keyword">import</span> org.springframework.mail.MailException
<span class="hljs-keyword">import</span> org.springframework.mail.SimpleMailMessage
<span class="hljs-keyword">import</span> org.springframework.mail.javamail.JavaMailSender
<span class="hljs-keyword">import</span> org.springframework.mail.javamail.MimeMessageHelper
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component
<span class="hljs-keyword">import</span> org.thymeleaf.spring5.SpringTemplateEngine
<span class="hljs-keyword">import</span> org.thymeleaf.context.Context
<span class="hljs-keyword">import</span> java.io.File
<span class="hljs-keyword">import</span> javax.mail.MessagingException
<span class="hljs-keyword">import</span> javax.mail.internet.MimeMessage
<span class="hljs-keyword">import</span> org.apache.commons.io.IOUtils
<span class="hljs-keyword">import</span> org.springframework.core.env.Environment<font></font>
<font></font>
<span class="hljs-meta">@Component</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EmailServiceImpl</span> : <span class="hljs-type">EmailService {</span></span><font></font>
<font></font>
    <span class="hljs-meta">@Value(<span class="hljs-meta-string">"\${spring.mail.username}"</span>)</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> sender: String<font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> environment: Environment<font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">var</span> emailSender: JavaMailSender? = <span class="hljs-literal">null</span><font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> templateEngine: SpringTemplateEngine<font></font>
<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendSimpleMessage</span><span class="hljs-params">(to: <span class="hljs-type">String</span>, subject: <span class="hljs-type">String</span>, text: <span class="hljs-type">String</span>)</span></span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">val</span> message = SimpleMailMessage()<font></font>
            message.setTo(to)<font></font>
            message.setFrom(sender)<font></font>
            message.setSubject(subject)<font></font>
            message.setText(text)<font></font>
<font></font>
            emailSender!!.send(message)<font></font>
        } <span class="hljs-keyword">catch</span> (exception: MailException) {<font></font>
            exception.printStackTrace()<font></font>
        }<font></font>
<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendSimpleMessageUsingTemplate</span><span class="hljs-params">(to: <span class="hljs-type">String</span>,
                                                subject: <span class="hljs-type">String</span>,
                                                template: <span class="hljs-type">String</span>,
                                                params:<span class="hljs-type">MutableMap</span>&lt;<span class="hljs-type">String</span>, Any&gt;)</span></span> {
        <span class="hljs-keyword">val</span> message = emailSender!!.createMimeMessage()
        <span class="hljs-keyword">val</span> helper = MimeMessageHelper(message, <span class="hljs-literal">true</span>, <span class="hljs-string">"utf-8"</span>)
        <span class="hljs-keyword">var</span> context: Context = Context()<font></font>
        context.setVariables(params)<font></font>
        <span class="hljs-keyword">val</span> html: String = templateEngine.process(template, context)<font></font>
<font></font>
        helper.setTo(to)<font></font>
        helper.setFrom(sender)<font></font>
        helper.setText(html, <span class="hljs-literal">true</span>)<font></font>
        helper.setSubject(subject)<font></font>
<font></font>
        emailSender!!.send(message)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendHtmlMessage</span><span class="hljs-params">(to: <span class="hljs-type">String</span>, subject: <span class="hljs-type">String</span>, htmlMsg: <span class="hljs-type">String</span>)</span></span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">val</span> message = emailSender!!.createMimeMessage()<font></font>
            message.setContent(htmlMsg, <span class="hljs-string">"text/html"</span>)<font></font>
<font></font>
            <span class="hljs-keyword">val</span> helper = MimeMessageHelper(message, <span class="hljs-literal">false</span>, <span class="hljs-string">"utf-8"</span>)<font></font>
<font></font>
            helper.setTo(to)<font></font>
            helper.setFrom(sender)<font></font>
            helper.setSubject(subject)<font></font>
<font></font>
            emailSender!!.send(message)<font></font>
        } <span class="hljs-keyword">catch</span> (exception: MailException) {<font></font>
            exception.printStackTrace()<font></font>
        }<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Springの自動設定されたJavaMailSenderを使用してメールを送信します</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常の手紙を送るのは非常に簡単です-手紙の本文にテキストを追加して送信するだけです</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTMLメールはMIMEタイプメッセージとして定義され、その内容は次のように定義されます。 </font></font><code>text/html</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTMLメッセージテンプレートを処理するには、Springテンプレートエンジンを使用します</font></font></li>
</ul><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Thymeleaf</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
フレームワークを使用して書き込むためのシンプルなテンプレートを</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">src / main / resources / templates /に</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置して</font><font style="vertical-align: inherit;">みましょう</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">emailTemplate.html</font></font></b><div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://www.w3.org/1999/xhtml"</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">"http://www.thymeleaf.org"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Hello<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"font-family: Arial, Helvetica, sans-serif;"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Hello!<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"margin-top: 20px; margin-bottom: 30px; margin-left: 20px;"</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Hello, dear: <span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">"${addresseeName}"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">th:src</span>=<span class="hljs-string">"${signatureImage}"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"200px;"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テンプレートの変更要素（この場合、受信者の名前と署名用の画像のパス）は、プレースホルダーを使用して宣言されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、手紙を送るコントローラーを作成または更新します。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BackendController.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">import</span> com.kotlinspringvue.backend.email.EmailServiceImpl
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.web.response.ResponseMessage
<span class="hljs-keyword">import</span> org.springframework.beans.factory.<span class="hljs-keyword">annotation</span>.Value
<span class="hljs-keyword">import</span> org.springframework.http.ResponseEntity
<span class="hljs-keyword">import</span> org.springframework.http.HttpStatus<font></font>
<font></font>
… <font></font>
<font></font>
<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> emailService: EmailService<font></font>
<font></font>
<span class="hljs-meta">@Value(<span class="hljs-meta-string">"\${spring.mail.username}"</span>)</span>
<span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> addressee: String<font></font>
<font></font>
… <font></font>
<font></font>
<span class="hljs-meta">@GetMapping(<span class="hljs-meta-string">"/sendSimpleEmail"</span>)</span>
<span class="hljs-meta">@PreAuthorize(<span class="hljs-meta-string">"hasRole('USER')"</span>)</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendSimpleEmail</span><span class="hljs-params">()</span></span>: ResponseEntity&lt;*&gt; {
     <span class="hljs-keyword">try</span> {<font></font>
          emailService.sendSimpleMessage(addressee, <span class="hljs-string">"Simple Email"</span>, <span class="hljs-string">"Hello! This is simple email"</span>)<font></font>
     } <span class="hljs-keyword">catch</span> (e: Exception) {
          <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Error while sending message"</span>),<font></font>
          HttpStatus.BAD_REQUEST)<font></font>
     }<font></font>
     <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Email has been sent"</span>), HttpStatus.OK)<font></font>
}<font></font>
<font></font>
<span class="hljs-meta">@GetMapping(<span class="hljs-meta-string">"/sendTemplateEmail"</span>)</span>
<span class="hljs-meta">@PreAuthorize(<span class="hljs-meta-string">"hasRole('USER')"</span>)</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendTemplateEmail</span><span class="hljs-params">()</span></span>: ResponseEntity&lt;*&gt; {
     <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">var</span> params:MutableMap&lt;String, Any&gt; = mutableMapOf()<font></font>
          params[<span class="hljs-string">"addresseeName"</span>] = addressee<font></font>
          params[<span class="hljs-string">"signatureImage"</span>] = <span class="hljs-string">"https://coderlook.com/wp-content/uploads/2019/07/spring-by-pivotal.png"</span>
          emailService.sendSimpleMessageUsingTemplate(addressee, <span class="hljs-string">"Template Email"</span>, <span class="hljs-string">"emailTemplate"</span>, params)<font></font>
     } <span class="hljs-keyword">catch</span> (e: Exception) {
          <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Error while sending message"</span>),<font></font>
          HttpStatus.BAD_REQUEST)<font></font>
     }<font></font>
     <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Email has been sent"</span>), HttpStatus.OK)<font></font>
}<font></font>
<font></font>
<span class="hljs-meta">@GetMapping(<span class="hljs-meta-string">"/sendHtmlEmail"</span>)</span>
<span class="hljs-meta">@PreAuthorize(<span class="hljs-meta-string">"hasRole('USER')"</span>)</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendHtmlEmail</span><span class="hljs-params">()</span></span>: ResponseEntity&lt;*&gt; {
     <span class="hljs-keyword">try</span> {<font></font>
          emailService.sendHtmlMessage(addressee, <span class="hljs-string">"HTML Email"</span>, <span class="hljs-string">"&lt;h1&gt;Hello!&lt;/h1&gt;&lt;p&gt;This is HTML email&lt;/p&gt;"</span>)<font></font>
     } <span class="hljs-keyword">catch</span> (e: Exception) {
          <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Error while sending message"</span>),<font></font>
          HttpStatus.BAD_REQUEST)<font></font>
     }<font></font>
     <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Email has been sent"</span>), HttpStatus.OK)<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべてが正常に機能することを確認するために、まず手紙を自分宛に送信します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、すべてが機能することを確認するために、単純にWebサービスメソッドをプルする控えめなWebインターフェイスを作成できます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Email.vue</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs"><font></font>
&lt;template&gt;<font></font>
   <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"email"</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">b-button</span>  <span class="hljs-attr">v-on:click</span>=<span class="hljs-string">"sendSimpleMessage"</span> <span class="hljs-attr">variant</span>=<span class="hljs-string">"primary"</span>&gt;</span>Simple Email<span class="hljs-tag">&lt;/<span class="hljs-name">b-button</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">b-button</span>  <span class="hljs-attr">v-on:click</span>=<span class="hljs-string">"sendEmailUsingTemplate"</span> <span class="hljs-attr">variant</span>=<span class="hljs-string">"primary"</span>&gt;</span>Template Email<span class="hljs-tag">&lt;/<span class="hljs-name">b-button</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">b-button</span> <span class="hljs-attr">v-on:click</span>=<span class="hljs-string">"sendHTMLEmail"</span> <span class="hljs-attr">variant</span>=<span class="hljs-string">"primary"</span>&gt;</span>HTML Email<span class="hljs-tag">&lt;/<span class="hljs-name">b-button</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span>
       <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><font></font>
&lt;/template&gt;<font></font>
<font></font>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> {AXIOS} <span class="hljs-keyword">from</span> <span class="hljs-string">'./http-common'</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
   <span class="hljs-attr">name</span>: <span class="hljs-string">'EmailPage'</span>,
   data() {
       <span class="hljs-keyword">return</span> {
           <span class="hljs-attr">counter</span>: <span class="hljs-number">0</span>,
           <span class="hljs-attr">username</span>: <span class="hljs-string">''</span>,
           <span class="hljs-attr">header</span>: {<span class="hljs-string">'Authorization'</span>: <span class="hljs-string">'Bearer '</span> + <span class="hljs-keyword">this</span>.$store.getters.getToken}
       }
   },
   <span class="hljs-attr">methods</span>: {
       sendSimpleMessage() {
           AXIOS.get(<span class="hljs-string">'/sendSimpleEmail'</span>, { <span class="hljs-attr">headers</span>: <span class="hljs-keyword">this</span>.$data.header })
           .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
               <span class="hljs-built_in">console</span>.log(response);
               alert(<span class="hljs-string">"OK"</span>);
           })
           .catch(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
               <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'ERROR: '</span> + error.response.data);
           })
       },
       sendEmailUsingTemplate() {
           AXIOS.get(<span class="hljs-string">'/sendTemplateEmail'</span>, { <span class="hljs-attr">headers</span>: <span class="hljs-keyword">this</span>.$data.header })
           .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
               <span class="hljs-built_in">console</span>.log(response);
               alert(<span class="hljs-string">"OK"</span>)
           })
           .catch(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
               <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'ERROR: '</span> + error.response.data);
           })
       },
       sendHTMLEmail() {
           AXIOS.get(<span class="hljs-string">'/sendHtmlEmail'</span>, { <span class="hljs-attr">headers</span>: <span class="hljs-keyword">this</span>.$data.header })
           .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
               <span class="hljs-built_in">console</span>.log(response);
               alert(<span class="hljs-string">"OK"</span>)
           })
           .catch(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
               <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'ERROR: '</span> + error.response.data);
           })
       }
   }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><font></font>
<font></font>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
<span class="hljs-selector-id">#email</span> {
   <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">38%</span>;
   <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">50px</span>;
}
<span class="hljs-selector-tag">button</span> {
   <span class="hljs-attribute">width</span>: <span class="hljs-number">150px</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>
</code></pre><br>
</div></div><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいコンポーネントを作成する場合</font></font><code>router.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、リンク</font><font style="vertical-align: inherit;">を更新</font><font style="vertical-align: inherit;">してナビゲーションバーに追加する</font><font style="vertical-align: inherit;">ことを忘れないでください</font></font><code>App.vue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a name="gradle"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gradleの移行</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私はすぐに明確にします。この項目を改善と見なすべきかどうか、誰もが自分のプロジェクトを決定できるようにします。これを行う方法を検討するだけです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般的に、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MavenからGradleへ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">移動は5分未満の</font></a><font style="vertical-align: inherit;">手順</font><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">使用できます</font><font style="vertical-align: inherit;">が、期待</font><font style="vertical-align: inherit;">どおり</font><font style="vertical-align: inherit;">の結果が得られるとは限りません。それでも手動で移行することをお勧めします。それほど長くはかからないでしょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gradleをインストールする</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必要があります</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、両方のサブプロジェクトで次の手順を実行する必要があります- </font></font><code>backend</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><code>fronted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mavenファイル（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pom.xml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.mvn）を</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">削除します</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブプロジェクトディレクトリで、gradle initを実行し、質問に答えます。</font></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生成するプロジェクトのタイプを選択：</font></font></i> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基本</font></font></b></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実装言語を選択：</font></font></i> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kotlin</font></font></b></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ビルドスクリプトDSLを選択：</font></font></i> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kotlin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（Kotlinでプロジェクトを作成しているため）</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃3 </font></font></b><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">settings.gradle.ktsを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">削除し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;"> -このファイルはルートプロジェクトにのみ必要です。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実行します</font></font><code>gradle wrapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、ルートプロジェクトに移りましょう。</font><font style="vertical-align: inherit;">そのためには、サブプロジェクトについて上記のステップ1、2、および4を実行する必要があり</font><u><i><font style="vertical-align: inherit;">ます</font></i></u></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -settings.gradle.ktsを削除する以外</font></font><i><font style="vertical-align: inherit;"></font></i></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はすべて同じ</font><font style="vertical-align: inherit;">です。</font><i><font style="vertical-align: inherit;">バックエンド</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
プロジェクトのビルド構成は次の</font><font style="vertical-align: inherit;">ようになります。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build.gradle.kts</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">import</span> org.jetbrains.kotlin.gradle.tasks.KotlinCompile<font></font>
<font></font>
plugins {<font></font>
    id(<span class="hljs-string">"org.springframework.boot"</span>) version <span class="hljs-string">"2.1.3.RELEASE"</span>
    id(<span class="hljs-string">"io.spring.dependency-management"</span>) version <span class="hljs-string">"1.0.8.RELEASE"</span>
    kotlin(<span class="hljs-string">"jvm"</span>) version <span class="hljs-string">"1.3.50"</span>
    kotlin(<span class="hljs-string">"plugin.spring"</span>) version <span class="hljs-string">"1.3.50"</span>
    id(<span class="hljs-string">"org.jetbrains.kotlin.plugin.jpa"</span>) version <span class="hljs-string">"1.3.50"</span><font></font>
}<font></font>
<font></font>
group = <span class="hljs-string">"com.kotlin-spring-vue"</span>
version = <span class="hljs-string">"0.0.1-SNAPSHOT"</span><font></font>
java.sourceCompatibility = JavaVersion.VERSION_1_8<font></font>
<font></font>
repositories {<font></font>
    mavenCentral()<font></font>
    maven {<font></font>
        url = uri(<span class="hljs-string">"https://plugins.gradle.org/m2/"</span>)<font></font>
    }<font></font>
}<font></font>
<font></font>
dependencies {<font></font>
    runtimeOnly(project(<span class="hljs-string">":frontend"</span>))<font></font>
    implementation(<span class="hljs-string">"org.springframework.boot:spring-boot-starter-actuator:2.1.3.RELEASE"</span>)<font></font>
    implementation(<span class="hljs-string">"org.springframework.boot:spring-boot-starter-web:2.1.3.RELEASE"</span>)<font></font>
    implementation(<span class="hljs-string">"org.springframework.boot:spring-boot-starter-data-jpa:2.1.3.RELEASE"</span>)<font></font>
    implementation(<span class="hljs-string">"org.springframework.boot:spring-boot-starter-mail:2.1.3.RELEASE"</span>)<font></font>
    implementation(<span class="hljs-string">"org.springframework.boot:spring-boot-starter-security:2.1.3.RELEASE"</span>)<font></font>
    implementation(<span class="hljs-string">"org.postgresql:postgresql:42.2.5"</span>)<font></font>
    implementation(<span class="hljs-string">"org.springframework.boot:spring-boot-starter-thymeleaf:2.1.3.RELEASE"</span>)<font></font>
    implementation(<span class="hljs-string">"commons-io:commons-io:2.4"</span>)<font></font>
    implementation(<span class="hljs-string">"io.jsonwebtoken:jjwt:0.9.0"</span>)<font></font>
    implementation(<span class="hljs-string">"io.jsonwebtoken:jjwt-api:0.10.6"</span>)<font></font>
    implementation(<span class="hljs-string">"com.mashape.unirest:unirest-java:1.4.9"</span>)<font></font>
    implementation(<span class="hljs-string">"com.fasterxml.jackson.module:jackson-module-kotlin:2.9.8"</span>)<font></font>
    runtimeOnly(<span class="hljs-string">"org.springframework.boot:spring-boot-devtools:2.1.3.RELEASE"</span>)<font></font>
    implementation(<span class="hljs-string">"org.jetbrains.kotlin:kotlin-reflect"</span>)<font></font>
    implementation(<span class="hljs-string">"org.jetbrains.kotlin:kotlin-stdlib-jdk8"</span>)<font></font>
    implementation(<span class="hljs-string">"org.jetbrains.kotlin:kotlin-noarg:1.3.50"</span>)<font></font>
    testImplementation(<span class="hljs-string">"org.springframework.boot:spring-boot-starter-test"</span>) {<font></font>
        exclude(group = <span class="hljs-string">"org.junit.vintage"</span>, module = <span class="hljs-string">"junit-vintage-engine"</span>)<font></font>
    }<font></font>
}<font></font>
<font></font>
tasks.withType&lt;KotlinCompile&gt; {<font></font>
    kotlinOptions {<font></font>
        freeCompilerArgs = listOf(<span class="hljs-string">"-Xjsr305=strict"</span>)<font></font>
        jvmTarget = <span class="hljs-string">"1.8"</span><font></font>
    }<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必要なすべてのKotlinおよびSpringプラグインを指定する必要があります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プラグイン</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">org.jetbrains.kotlin.plugin.jpaを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">忘れないでください</font><font style="vertical-align: inherit;">-データベースに接続する必要があります</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">依存関係では、指定する必要があります</font></font><code>runtimeOnly(project(":frontend"))</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">最初に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フロントエンド</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクトをビルドする必要</font><font style="vertical-align: inherit;">があります</font></font></li>
</ul><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フロントエンド</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
プロジェクトのビルド構成</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build.gradle.kts</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs">plugins {<font></font>
    id(<span class="hljs-string">"org.siouan.frontend"</span>) version <span class="hljs-string">"1.2.1"</span>
    id(<span class="hljs-string">"java"</span>)<font></font>
}<font></font>
<font></font>
group = <span class="hljs-string">"com.kotlin-spring-vue"</span>
version = <span class="hljs-string">"0.0.1-SNAPSHOT"</span><font></font>
<font></font>
java {<font></font>
    targetCompatibility = JavaVersion.VERSION_1_8<font></font>
}<font></font>
<font></font>
buildscript {<font></font>
    repositories {<font></font>
        mavenCentral()<font></font>
        maven {<font></font>
            url = uri(<span class="hljs-string">"https://plugins.gradle.org/m2/"</span>)<font></font>
        }<font></font>
    }<font></font>
}<font></font>
<font></font>
frontend {<font></font>
    nodeVersion.<span class="hljs-keyword">set</span>(<span class="hljs-string">"10.16.0"</span>)<font></font>
    cleanScript.<span class="hljs-keyword">set</span>(<span class="hljs-string">"run clean"</span>)<font></font>
    installScript.<span class="hljs-keyword">set</span>(<span class="hljs-string">"install"</span>)<font></font>
    assembleScript.<span class="hljs-keyword">set</span>(<span class="hljs-string">"run build"</span>)<font></font>
}<font></font>
<font></font>
tasks.named(<span class="hljs-string">"jar"</span>, Jar::<span class="hljs-class"><span class="hljs-keyword">class</span>) </span>{<font></font>
    dependsOn(<span class="hljs-string">"assembleFrontend"</span>)<font></font>
    from(<span class="hljs-string">"<span class="hljs-variable">$buildDir</span>/dist"</span>)<font></font>
    into(<span class="hljs-string">"static"</span>)<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私の例では、プラグインを使用してプロジェクトをビルドしています </font></font><code>org.siouan.frontend</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セクションに</font></font><code>frontend {...}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、Node.jsのバージョン、およびで指定されたクリーニング、インストール、およびアセンブリスクリプトを呼び出すコマンドを示す必要があります。</font></font><code>package.json</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">今、私たちは私たちのフロントエンドのサブプロジェクトは、JARファイルにパックし、依存関係としてそれを使用する（</font></font><code>runtimeOnly(project(":frontend"))</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バックエンド</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）、我々は（タスクを記述する必要があるので</font></font><code>task</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）、そのアセンブリディレクトリからコピーしたファイルをに</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/公共</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">およびJARファイルを作成します</font></font></li>
</ul><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意：</font></font></u><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"></font><code>vue.config.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ビルドディレクトリを</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build / distに</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変更して</font><font style="vertical-align: inherit;">編集</font><font style="vertical-align: inherit;">し</font><font style="vertical-align: inherit;">ます。</font></font></li>
<li><font style="vertical-align: inherit;"></font><code>package.json</code> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ビルドスクリプト</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font></font><code>vue-cli-service build</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で指定する</font><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">または指定されていることを確認する</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ルートプロジェクトのsettings.gradle.ktsファイルには、次のコードが含まれている必要があります：...</font></font><br>
<br>
<pre><code class="kotlin hljs">rootProject.name = <span class="hljs-string">"demo"</span><font></font>
<font></font>
include(<span class="hljs-string">":frontend"</span>, <span class="hljs-string">":backend"</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...はプロジェクトとサブプロジェクトの名前です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、コマンドを実行してプロジェクトをアセンブルできます。</font></font><code>./gradlew build</code><br>
<br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></u><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application.propertiesで</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定されたプレースホルダー</font><font style="vertical-align: inherit;">（例</font><font style="vertical-align: inherit;">：）に</font></font><code>${SPRING_DATASOURCE_URL}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">対応する環境変数がない場合、アセンブリは失敗します。</font><font style="vertical-align: inherit;">これを回避</font></font><code><b>/gradlew build -x</b></code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
するには、コマンドを使用してプロジェクトの構造を確認</font><font style="vertical-align: inherit;">するを使用する</font></font><code>gradle -q projects</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必要があります。結果は次のようになります。</font></font><br>
<br>
<pre><code class="plaintext hljs">Root project 'demo'<font></font>
+--- Project ':backend'<font></font>
\--- Project ':frontend'</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に、アプリケーションを実行するには、を実行する必要があります</font></font><code>./gradlew bootRun</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.gitignore</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次のファイルとフォルダーを</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.gitignore</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ファイルに</font><font style="vertical-align: inherit;">追加する必要があり</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バックエンド/ビルド/</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フロントエンド/ビルド/</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">建てる</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.gradle</font></font></li>
</ul><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要：</font></font></u><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">.gitignore</font></i><font style="vertical-align: inherit;">にファイル</font></font><code>gradlew</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">追加しないでください。ファイル</font><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">危険はありませんが、リモートサーバーで正常にアセンブリするために必要です。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Herokuでの展開</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリをHerokuに安全にデプロイするために必要な変更を見てみましょう。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃1 Procfile</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
アプリケーションを起動するための新しい手順をHerokuに尋ねる必要があります。</font></font><br>
<br>
<pre><code class="plaintext hljs">web: java -Dserver.port=$PORT -jar backend/build/libs/backend-0.0.1-SNAPSHOT.jar</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃2環境変数</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Herokuは、アプリケーションのタイプ（たとえば、Spring Bootアプリケーション）を作り直して、適切なアセンブリの指示に従うことができます。</font><font style="vertical-align: inherit;">しかし、私たちのアプリケーション（ルートプロジェクト）は、HerokuのSpring Bootアプリケーションのようには見えません。</font><font style="vertical-align: inherit;">すべてをそのままにしておくと、Herokuがタスクの決定を要求します</font></font><code>stage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">正直なところ、私はこの道をたどっていなかったため、この道の終点がわかりません。</font></font><code>GRADLE_TASK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">値を</font><font style="vertical-align: inherit;">使用して変数</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">定義するだけ</font><font style="vertical-align: inherit;">です</font></font><code>build</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/5j/xz/o2/5jxzo2ukto8lyakkxajjg5rrvtg.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃3 reCAPTCHA</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
アプリケーションを新しいドメインに配置するときは、キャプチャ、環境変数</font></font><code>GOOGLE_RECAPTCHA_KEY_SITE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、および</font></font><code>GOOGLE_RECAPTCHA_KEY_SECRET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブプロジェクトフロントエンドのサイトキーを更新する</font><font style="vertical-align: inherit;">ことを忘れないでください</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a name="cookies"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JWTトークンをCookieに保存する</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「ローカルストレージの使用を中止し</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">て</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ください」の</font></a><font style="vertical-align: inherit;">記事</font><font style="vertical-align: inherit;">、特に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「ローカルストレージが安全ではなく、機密データの保存に使用すべきでない」</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セクション</font><font style="vertical-align: inherit;">を読むことを強くお勧めします</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JWTトークンをより安全な場所に保存する方法を見てみましょう-フラグ内のCookie。JavaScriptを</font></font><code>httpOnly</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用した読み取りや変更には使用できなくなります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フロントエンドからJWT関連のすべてのロジックを削除する：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいストレージメソッドでは、JavaScriptでトークンをまだ使用できないため、サブプロジェクトからトークンへのすべての参照を安全に削除できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、他のデータを参照しないユーザーの役割はそれほど重要な情報ではありません。ローカルストレージに保存して、この役割が定義されているかどうかに応じて、ユーザーが承認されているかどうかを判断できます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ストア/index.js</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs">
<span class="hljs-keyword">import</span> Vue <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">import</span> Vuex <span class="hljs-keyword">from</span> <span class="hljs-string">'vuex'</span>;<font></font>
<font></font>
Vue.use(Vuex);<font></font>
<font></font>
<span class="hljs-keyword">const</span> state = {
  <span class="hljs-attr">role</span>: localStorage.getItem(<span class="hljs-string">'user-role'</span>) || <span class="hljs-string">''</span>,
  <span class="hljs-attr">username</span>: localStorage.getItem(<span class="hljs-string">'user-name'</span>) || <span class="hljs-string">''</span>,
  <span class="hljs-attr">authorities</span>: localStorage.getItem(<span class="hljs-string">'authorities'</span>) || <span class="hljs-string">''</span>,<font></font>
};<font></font>
<font></font>
<span class="hljs-keyword">const</span> getters = {
  <span class="hljs-attr">isAuthenticated</span>: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (state.role != <span class="hljs-literal">null</span> &amp;&amp; state.role != <span class="hljs-string">''</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
  },<font></font>
  <span class="hljs-attr">isAdmin</span>: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (state.role === <span class="hljs-string">'admin'</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
  },<font></font>
  <span class="hljs-attr">getUsername</span>: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> state.username;<font></font>
  },<font></font>
  <span class="hljs-attr">getAuthorities</span>: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> state.authorities;<font></font>
  }<font></font>
};<font></font>
<font></font>
<span class="hljs-keyword">const</span> mutations = {
  <span class="hljs-attr">auth_login</span>: <span class="hljs-function">(<span class="hljs-params">state, user</span>) =&gt;</span> {<font></font>
    localStorage.setItem(<span class="hljs-string">'user-name'</span>, user.username);<font></font>
    localStorage.setItem(<span class="hljs-string">'user-authorities'</span>, user.roles);<font></font>
    state.username = user.username;<font></font>
    state.authorities = user.roles;<font></font>
    <span class="hljs-keyword">var</span> isUser = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> isAdmin = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; user.roles.length; i++) {
      <span class="hljs-keyword">if</span> (user.roles[i].authority === <span class="hljs-string">'ROLE_USER'</span>) {<font></font>
        isUser = <span class="hljs-literal">true</span>;<font></font>
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (user.roles[i].authority === <span class="hljs-string">'ROLE_ADMIN'</span>) {<font></font>
        isAdmin = <span class="hljs-literal">true</span>;<font></font>
      }<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (isUser) {<font></font>
      localStorage.setItem(<span class="hljs-string">'user-role'</span>, <span class="hljs-string">'user'</span>);<font></font>
      state.role = <span class="hljs-string">'user'</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (isAdmin) {<font></font>
      localStorage.setItem(<span class="hljs-string">'user-role'</span>, <span class="hljs-string">'admin'</span>);<font></font>
      state.role = <span class="hljs-string">'admin'</span>;<font></font>
    }<font></font>
  },<font></font>
  <span class="hljs-attr">auth_logout</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {<font></font>
    state.token = <span class="hljs-string">''</span>;<font></font>
    state.role = <span class="hljs-string">''</span>;<font></font>
    state.username = <span class="hljs-string">''</span>;<font></font>
    state.authorities = [];<font></font>
    localStorage.removeItem(<span class="hljs-string">'user-role'</span>);<font></font>
    localStorage.removeItem(<span class="hljs-string">'user-name'</span>);<font></font>
    localStorage.removeItem(<span class="hljs-string">'user-authorities'</span>);<font></font>
  }<font></font>
};<font></font>
<font></font>
<span class="hljs-keyword">const</span> actions = {
  <span class="hljs-attr">login</span>: <span class="hljs-function">(<span class="hljs-params">context, user</span>) =&gt;</span> {<font></font>
    context.commit(<span class="hljs-string">'auth_login'</span>, user)<font></font>
  },<font></font>
  <span class="hljs-attr">logout</span>: <span class="hljs-function">(<span class="hljs-params">context</span>) =&gt;</span> {<font></font>
    context.commit(<span class="hljs-string">'auth_logout'</span>);<font></font>
  }<font></font>
};<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> store = <span class="hljs-keyword">new</span> Vuex.Store({<font></font>
  state,<font></font>
  getters,<font></font>
  mutations,<font></font>
  actions<font></font>
});<font></font>
</code></pre><br>
</div></div> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リファクタリングの際は注意してください</font></font><code>store/index.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。認証と認証解除が正しく機能しない場合、エラーメッセージがコンソールに表示され続けます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">承認コントローラーで（</font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">応答本文ではなく）</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CookieとしてJWTを返し</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AuthController.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-meta">@Value(<span class="hljs-meta-string">"\${ksvg.app.authCookieName}"</span>)</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> authCookieName: String<font></font>
<font></font>
<span class="hljs-meta">@Value(<span class="hljs-meta-string">"\${ksvg.app.isCookieSecure}"</span>)</span>
    <span class="hljs-keyword">var</span> isCookieSecure: <span class="hljs-built_in">Boolean</span> = <span class="hljs-literal">true</span><font></font>
<font></font>
<span class="hljs-meta">@PostMapping(<span class="hljs-meta-string">"/signin"</span>)</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">authenticateUser</span><span class="hljs-params">(<span class="hljs-meta">@Valid</span> <span class="hljs-meta">@RequestBody</span> loginRequest: <span class="hljs-type">LoginUser</span>, response: <span class="hljs-type">HttpServletResponse</span>)</span></span>: ResponseEntity&lt;*&gt; {<font></font>
<font></font>
        <span class="hljs-keyword">val</span> userCandidate: Optional &lt;User&gt; = userRepository.findByUsername(loginRequest.username!!)<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!captchaService.validateCaptcha(loginRequest.recaptchaToken!!)) {
            <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Validation failed (ReCaptcha v2)"</span>),<font></font>
                    HttpStatus.BAD_REQUEST)<font></font>
        }<font></font>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (userCandidate.isPresent) {
            <span class="hljs-keyword">val</span> user: User = userCandidate.<span class="hljs-keyword">get</span>()
            <span class="hljs-keyword">val</span> authentication = authenticationManager.authenticate(<font></font>
                    UsernamePasswordAuthenticationToken(loginRequest.username, loginRequest.password))<font></font>
            SecurityContextHolder.getContext().setAuthentication(authentication)<font></font>
            <span class="hljs-keyword">val</span> jwt: String = jwtProvider.generateJwtToken(user.username!!)<font></font>
<font></font>
            <span class="hljs-keyword">val</span> cookie: Cookie = Cookie(authCookieName, jwt)<font></font>
            cookie.maxAge = jwtProvider.jwtExpiration!!<font></font>
            cookie.secure = isCookieSecure<font></font>
            cookie.isHttpOnly = <span class="hljs-literal">true</span>
            cookie.path = <span class="hljs-string">"/"</span><font></font>
            response.addCookie(cookie)<font></font>
<font></font>
            <span class="hljs-keyword">val</span> authorities: List&lt;GrantedAuthority&gt; = user.roles!!.stream().map({ role -&gt; SimpleGrantedAuthority(role.name)}).collect(Collectors.toList&lt;GrantedAuthority&gt;())
            <span class="hljs-keyword">return</span> ResponseEntity.ok(SuccessfulSigninResponse(user.username, authorities))<font></font>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"User not found!"</span>),<font></font>
                    HttpStatus.BAD_REQUEST)<font></font>
        }<font></font>
    }<font></font>
</code></pre><br>
</div></div><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：私はオプションを置くことをしてくださいノート</font></font><code>authCookieName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>isCookieSecure</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application.properties</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -フラグにクッキーを送信する</font></font><code>secure</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ことができる唯一のHTTPSは、localhostとデバッグにそれは非常に困難にします。</font><font style="vertical-align: inherit;">しかし、本番環境ではもちろん、このフラグを付けたCookieを使用することをお勧めします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、コントローラの応答は、JWTの特別なフィールドなしでエンティティを使用することに意味があります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新</font></font><code>JwtAuthTokenFilter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前はリクエストヘッダーからトークンを取得していましたが、現在はCookieから取得しています。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JwtAuthTokenFilter.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-meta">@Value(<span class="hljs-meta-string">"\${ksvg.app.authCookieName}"</span>)</span>
          <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> authCookieName: String<font></font>
<font></font>
...<font></font>
<font></font>
<span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getJwt</span><span class="hljs-params">(request: <span class="hljs-type">HttpServletRequest</span>)</span></span>: String? {
     <span class="hljs-keyword">for</span> (cookie <span class="hljs-keyword">in</span> request.cookies) {
          <span class="hljs-keyword">if</span> (cookie.name == authCookieName) {
               <span class="hljs-keyword">return</span> cookie.value<font></font>
          }<font></font>
     }<font></font>
     <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span><font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃4 </font></font></b><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CORSを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有効</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
にする以前の記事でこの質問を静かにスキップできる場合、今度はバックエンド側でCORSを有効にする必要なしにJWTトークンを保護するのはおかしいでしょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを編集して修正できます</font></font><code>WebSecurityConfig.kt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebSecurityConfig.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-meta">@Bean</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">corsConfigurationSource</span><span class="hljs-params">()</span></span>: CorsConfigurationSource {
     <span class="hljs-keyword">val</span> configuration = CorsConfiguration()<font></font>
     configuration.allowedOrigins = Arrays.asList(<span class="hljs-string">"http://localhost:8080"</span>, <span class="hljs-string">"http://localhost:8081"</span>, <span class="hljs-string">"https://kotlin-spring-vue-gradle-demo.herokuapp.com"</span>)<font></font>
     configuration.allowedHeaders = Arrays.asList(<span class="hljs-string">"*"</span>)<font></font>
     configuration.allowedMethods = Arrays.asList(<span class="hljs-string">"GET"</span>, <span class="hljs-string">"POST"</span>, <span class="hljs-string">"PUT"</span>, <span class="hljs-string">"DELETE"</span>, <span class="hljs-string">"OPTIONS"</span>)<font></font>
     configuration.allowCredentials = <span class="hljs-literal">true</span>
     configuration.maxAge = <span class="hljs-number">3600</span>
     <span class="hljs-keyword">val</span> source = UrlBasedCorsConfigurationSource()<font></font>
     source.registerCorsConfiguration(<span class="hljs-string">"/**"</span>, configuration)
     <span class="hljs-keyword">return</span> source<font></font>
}<font></font>
<font></font>
<span class="hljs-meta">@Throws(Exception::class)</span>
<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">configure</span><span class="hljs-params">(http: <span class="hljs-type">HttpSecurity</span>)</span></span> {<font></font>
     http<font></font>
          .cors().and()<font></font>
          .csrf().disable().authorizeRequests()<font></font>
          .antMatchers(<span class="hljs-string">"/**"</span>).permitAll()<font></font>
          .anyRequest().authenticated()<font></font>
          .and()<font></font>
          .exceptionHandling().authenticationEntryPoint(unauthorizedHandler).and()<font></font>
          .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS)<font></font>
<font></font>
     http.addFilterBefore(authenticationJwtTokenFilter(), UsernamePasswordAuthenticationFilter::<span class="hljs-keyword">class</span>.java)<font></font>
     http.headers().cacheControl().disable()<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして今、あなた</font></font><code>@CrossOrigin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はコントローラから</font><font style="vertical-align: inherit;">すべての注釈</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">取り除くことができます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要：</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フロントエンドからリクエストを送信するに</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font><i><font style="vertical-align: inherit;">AllowCredentials</font></i><font style="vertical-align: inherit;">パラメータ</font><i><font style="vertical-align: inherit;">が</font></i><font style="vertical-align: inherit;">必要です。</font><font style="vertical-align: inherit;">詳細については、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こちらをご覧ください</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃5</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フロントエンド側のヘッダーの更新：</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http-commons.js</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs">
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> AXIOS = axios.create({
     <span class="hljs-attr">baseURL</span>: <span class="hljs-string">`/api`</span>,
     <span class="hljs-attr">headers</span>: {
          <span class="hljs-string">'Access-Control-Allow-Origin'</span>: [<span class="hljs-string">'http://localhost:8080'</span>, <span class="hljs-string">'http://localhost:8081'</span>, <span class="hljs-string">'https://kotlin-spring-vue-gradle-demo.herokuapp.com'</span>],
          <span class="hljs-string">'Access-Control-Allow-Methods'</span>: <span class="hljs-string">'GET,POST,DELETE,PUT,OPTIONS'</span>,
          <span class="hljs-string">'Access-Control-Allow-Headers'</span>: <span class="hljs-string">'*'</span>,
          <span class="hljs-string">'Access-Control-Allow-Credentials'</span>: <span class="hljs-literal">true</span><font></font>
     }<font></font>
})<font></font>
</code></pre><br>
</div></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小切手</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
許可リストにないホストからログインして、アプリケーションにログインしてみましょう</font></font><code>WebSecurityConfig.kt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これを行うに</font></font><code>8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、たとえば</font><font style="vertical-align: inherit;">ポート</font><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">バックエンドを実行し</font><font style="vertical-align: inherit;">、フロントエンドをオンにして</font></font><code>8082</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ログインを試みます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/sw/ce/hk/swcehkifaph10nqjveh17sv1w88.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CORSポリシーによって拒否された承認リクエスト。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、フラグCookieが一般的にどのように機能するかを見てみましょう</font></font><code>httpOnly</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これを行うには、たとえば、サイト</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://kotlinlang.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に移動して、ブラウザコンソールで実行し</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">document</span>.cookie </code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/4o/s7/ct/4os7ctztsejgbzclio8ci8nloky.png"><br>
</div></div><br><font style="vertical-align: inherit;"></font><code>httpOnly</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このサイトに関連する</font><font style="vertical-align: inherit;">
非</font><font style="vertical-align: inherit;">Cookie </font><font style="vertical-align: inherit;">がコンソール</font><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">表示され、</font><font style="vertical-align: inherit;">JavaScriptを介してアクセスできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、アプリケーションに移動し、</font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ログインして</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ブラウザーがJWTで</font><font style="vertical-align: inherit;">Cookie </font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">保存する</font><font style="vertical-align: inherit;">ように）、同じことを繰り返します。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/fh/_b/zh/fh_bzh9ytv6rf_xn40fjf3c83ag.png"><br>
</div></div><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> JWTトークンを保存するこの方法は、ローカルストレージを使用するよりも信頼性が高くなりますが、万能ではないことを理解しておく必要があります。</font></font><br>
<br>
<a name="confirmation"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メール登録確認</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このタスクを実行するための簡単なアルゴリズムは次のとおりです。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべての新しいユーザーについて</font></font><code>isEnabled</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、データベース</font><font style="vertical-align: inherit;">の属性</font><font style="vertical-align: inherit;">は</font></font><code>false</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字列トークンは、登録を確認するためのキーとして機能する任意の文字から生成されます</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トークンはリンクの一部としてメールでユーザーに送信されます</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この属性</font></font><code>isEnabled</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">、ユーザーが設定された期間リンクをたどった場合</font><font style="vertical-align: inherit;">に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trueに</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">設定され</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、このプロセスをさらに詳しく検討します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
登録を確認するためのトークンを格納するテーブルが必要です。</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> public.verification_token<font></font>
(<font></font>
     <span class="hljs-keyword">id</span> <span class="hljs-built_in">serial</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
     token <span class="hljs-built_in">character</span> <span class="hljs-built_in">varying</span>,<font></font>
     expiry_date <span class="hljs-built_in">timestamp</span> <span class="hljs-keyword">without</span> <span class="hljs-built_in">time</span> zone,<font></font>
     user_id <span class="hljs-built_in">integer</span>,<font></font>
     PRIMARY <span class="hljs-keyword">KEY</span> (<span class="hljs-keyword">id</span>)<font></font>
);<font></font>
<font></font>
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> public.verification_token
<span class="hljs-keyword">ADD</span> <span class="hljs-keyword">CONSTRAINT</span> verification_token_users_fk <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (user_id)
<span class="hljs-keyword">REFERENCES</span> public.users (<span class="hljs-keyword">id</span>) <span class="hljs-keyword">MATCH</span> SIMPLE
<span class="hljs-keyword">ON</span> <span class="hljs-keyword">UPDATE</span> <span class="hljs-keyword">CASCADE</span>
<span class="hljs-keyword">ON</span> <span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">CASCADE</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、それに応じて、オブジェクトリレーショナルマッピングの新しいエンティティ...：</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VerificationToken.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">package</span> com.kotlinspringvue.backend.jpa<font></font>
<font></font>
<span class="hljs-keyword">import</span> java.sql.*
<span class="hljs-keyword">import</span> javax.persistence.*
<span class="hljs-keyword">import</span> java.util.Calendar<font></font>
<font></font>
<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = <span class="hljs-meta-string">"verification_token"</span>)</span>
<span class="hljs-keyword">data</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">VerificationToken</span></span>(<font></font>
<font></font>
        <span class="hljs-meta">@Id</span>
        <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.AUTO)</span>
        <span class="hljs-keyword">val</span> id: <span class="hljs-built_in">Long</span>? = <span class="hljs-number">0</span>,<font></font>
<font></font>
        <span class="hljs-meta">@Column(name = <span class="hljs-meta-string">"token"</span>)</span>
        <span class="hljs-keyword">var</span> token: String? = <span class="hljs-literal">null</span>,<font></font>
<font></font>
        <span class="hljs-meta">@Column(name = <span class="hljs-meta-string">"expiry_date"</span>)</span>
        <span class="hljs-keyword">val</span> expiryDate: Date,<font></font>
<font></font>
        <span class="hljs-meta">@OneToOne(targetEntity = User::class, fetch = FetchType.EAGER, cascade = [CascadeType.PERSIST])</span>
        <span class="hljs-meta">@JoinColumn(nullable = false, name = <span class="hljs-meta-string">"user_id"</span>)</span>
        <span class="hljs-keyword">val</span> user: User<font></font>
) {<font></font>
    <span class="hljs-keyword">constructor</span>(token: String?, user: User) : <span class="hljs-keyword">this</span>(<span class="hljs-number">0</span>, token, calculateExpiryDate(<span class="hljs-number">1440</span>), user)<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">calculateExpiryDate</span><span class="hljs-params">(expiryTimeInMinutes: <span class="hljs-type">Int</span>)</span></span>: Date {
    <span class="hljs-keyword">val</span> cal = Calendar.getInstance()<font></font>
    cal.time = Timestamp(cal.time.time)<font></font>
    cal.add(Calendar.MINUTE, expiryTimeInMinutes)<font></font>
    <span class="hljs-keyword">return</span> Date(cal.time.time)<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...そしてリポジトリ：</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VerificationTokenRepository.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">package</span> com.kotlinspringvue.backend.repository<font></font>
<font></font>
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.jpa.VerificationToken
<span class="hljs-keyword">import</span> org.springframework.<span class="hljs-keyword">data</span>.jpa.repository.JpaRepository
<span class="hljs-keyword">import</span> java.util.*<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">VerificationTokenRepository</span> : <span class="hljs-type">JpaRepository</span>&lt;<span class="hljs-type">VerificationToken, Long</span>&gt; </span>{
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">findByToken</span><span class="hljs-params">(token: <span class="hljs-type">String</span>)</span></span>: Optional&lt;VerificationToken&gt;<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、トークン管理のためのツールを実装する必要があります-作成、検証、および電子メールによる送信。</font><font style="vertical-align: inherit;">これを行うには</font></font><code>UserDetailsServiceImpl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、トークンを作成および検証するメソッドを追加し</font><font style="vertical-align: inherit;">て変更</font><font style="vertical-align: inherit;">します。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserDetailsS​​erviceImpl.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">createVerificationTokenForUser</span><span class="hljs-params">(token: <span class="hljs-type">String</span>, user: <span class="hljs-type">User</span>)</span></span> {<font></font>
     tokenRepository.save(VerificationToken(token, user))<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">validateVerificationToken</span><span class="hljs-params">(token: <span class="hljs-type">String</span>)</span></span>: String {
     <span class="hljs-keyword">val</span> verificationToken: Optional&lt;VerificationToken&gt; = tokenRepository.findByToken(token)<font></font>
<font></font>
     <span class="hljs-keyword">if</span> (verificationToken.isPresent) {
          <span class="hljs-keyword">val</span> user: User = verificationToken.<span class="hljs-keyword">get</span>().user
          <span class="hljs-keyword">val</span> cal: Calendar = Calendar.getInstance()
          <span class="hljs-keyword">if</span> ((verificationToken.<span class="hljs-keyword">get</span>().expiryDate.time - cal.time.time) &lt;= <span class="hljs-number">0</span>) {<font></font>
               tokenRepository.delete(verificationToken.<span class="hljs-keyword">get</span>())
               <span class="hljs-keyword">return</span> TOKEN_EXPIRED<font></font>
          }<font></font>
<font></font>
          user.enabled = <span class="hljs-literal">true</span>
          tokenRepository.delete(verificationToken.<span class="hljs-keyword">get</span>())<font></font>
          userRepository.save(user)<font></font>
          <span class="hljs-keyword">return</span> TOKEN_VALID<font></font>
     } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">return</span> TOKEN_INVALID<font></font>
     }<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、確認リンクを含むメールを送信するメソッドを追加します</font></font><code>EmailServiceImpl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EmailServiceImpl.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs">    <span class="hljs-meta">@Value(<span class="hljs-meta-string">"\${host.url}"</span>)</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> hostUrl: String<font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> userDetailsService: UserDetailsServiceImpl<font></font>
<font></font>
...<font></font>
<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendRegistrationConfirmationEmail</span><span class="hljs-params">(user: <span class="hljs-type">User</span>)</span></span> {
        <span class="hljs-keyword">val</span> token = UUID.randomUUID().toString()<font></font>
        userDetailsService.createVerificationTokenForUser(token, user)<font></font>
        <span class="hljs-keyword">val</span> link = <span class="hljs-string">"<span class="hljs-variable">$hostUrl</span>/?token=<span class="hljs-variable">$token</span>&amp;confirmRegistration=true"</span>
        <span class="hljs-keyword">val</span> msg = <span class="hljs-string">"&lt;p&gt;Please, follow the link to complete your registration:&lt;/p&gt;&lt;p&gt;&lt;a href=\"<span class="hljs-variable">$link</span>\"&gt;<span class="hljs-variable">$link</span>&lt;/a&gt;&lt;/p&gt;"</span>
        user.email?.let{sendHtmlMessage(user.email!!, <span class="hljs-string">"KSVG APP: Registration Confirmation"</span>, msg)}<font></font>
    }<font></font>
</code></pre><br>
</div></div><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意：</font></font></u><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ホストURLを</font><i><font style="vertical-align: inherit;">application.propertiesに</font></i><font style="vertical-align: inherit;">保存することをお勧めし</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></i></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このリンクでは</font><font style="vertical-align: inherit;">、アプリケーションがデプロイされているアドレスに</font><font style="vertical-align: inherit;">2つのGETパラメーター（</font></font><code>token</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><code>confirmRegistration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">を渡します</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">後でその理由を説明します。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
登録コントローラーを次のように変更します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべての新しいユーザーが</font></font><code>false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィールドの</font><font style="vertical-align: inherit;">値</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">設定します</font></font><code>isEnabled</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいアカウントを作成した後、登録を確認するメールを送信します</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">別のトークン検証コントローラーを作成する</font></font></li>
<li><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要：</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">認証時に、アカウントが確認されているかどうかを確認します。</font></font></li>
</ul><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AuthController.kt</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">package</span> com.kotlinspringvue.backend.controller<font></font>
<font></font>
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.email.EmailService
<span class="hljs-keyword">import</span> javax.validation.Valid
<span class="hljs-keyword">import</span> java.util.*
<span class="hljs-keyword">import</span> java.util.stream.Collectors<font></font>
<font></font>
<span class="hljs-keyword">import</span> org.springframework.beans.factory.<span class="hljs-keyword">annotation</span>.Autowired
<span class="hljs-keyword">import</span> org.springframework.http.HttpStatus
<span class="hljs-keyword">import</span> org.springframework.http.ResponseEntity
<span class="hljs-keyword">import</span> org.springframework.security.authentication.AuthenticationManager
<span class="hljs-keyword">import</span> org.springframework.security.authentication.UsernamePasswordAuthenticationToken
<span class="hljs-keyword">import</span> org.springframework.security.core.context.SecurityContextHolder
<span class="hljs-keyword">import</span> org.springframework.security.crypto.password.PasswordEncoder
<span class="hljs-keyword">import</span> org.springframework.security.core.GrantedAuthority
<span class="hljs-keyword">import</span> org.springframework.security.core.authority.SimpleGrantedAuthority
<span class="hljs-keyword">import</span> org.springframework.ui.Model<font></font>
<font></font>
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.model.LoginUser
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.model.NewUser
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.web.response.SuccessfulSigninResponse
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.web.response.ResponseMessage
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.jpa.User
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.repository.UserRepository
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.repository.RoleRepository
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.jwt.JwtProvider
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.service.ReCaptchaService
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.service.UserDetailsService
<span class="hljs-keyword">import</span> org.springframework.beans.factory.<span class="hljs-keyword">annotation</span>.Value
<span class="hljs-keyword">import</span> org.springframework.context.ApplicationEventPublisher
<span class="hljs-keyword">import</span> org.springframework.web.bind.<span class="hljs-keyword">annotation</span>.*
<span class="hljs-keyword">import</span> org.springframework.web.context.request.WebRequest
<span class="hljs-keyword">import</span> java.io.UnsupportedEncodingException
<span class="hljs-keyword">import</span> javax.servlet.http.Cookie
<span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest
<span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.service.UserDetailsServiceImpl.Companion.TOKEN_VALID
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.service.UserDetailsServiceImpl.Companion.TOKEN_INVALID
<span class="hljs-keyword">import</span> com.kotlinspringvue.backend.service.UserDetailsServiceImpl.Companion.TOKEN_EXPIRED<font></font>
<font></font>
<span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping(<span class="hljs-meta-string">"/api/auth"</span>)</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AuthController</span></span>() {<font></font>
<font></font>
    <span class="hljs-meta">@Value(<span class="hljs-meta-string">"\${ksvg.app.authCookieName}"</span>)</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> authCookieName: String<font></font>
<font></font>
    <span class="hljs-meta">@Value(<span class="hljs-meta-string">"\${ksvg.app.isCookieSecure}"</span>)</span>
    <span class="hljs-keyword">var</span> isCookieSecure: <span class="hljs-built_in">Boolean</span> = <span class="hljs-literal">true</span><font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> authenticationManager: AuthenticationManager<font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> userRepository: UserRepository<font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> roleRepository: RoleRepository<font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> encoder: PasswordEncoder<font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> jwtProvider: JwtProvider<font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> captchaService: ReCaptchaService<font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> userService: UserDetailsService<font></font>
<font></font>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> emailService: EmailService<font></font>
<font></font>
    <span class="hljs-meta">@PostMapping(<span class="hljs-meta-string">"/signin"</span>)</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">authenticateUser</span><span class="hljs-params">(<span class="hljs-meta">@Valid</span> <span class="hljs-meta">@RequestBody</span> loginRequest: <span class="hljs-type">LoginUser</span>, response: <span class="hljs-type">HttpServletResponse</span>)</span></span>: ResponseEntity&lt;*&gt; {<font></font>
<font></font>
        <span class="hljs-keyword">val</span> userCandidate: Optional &lt;User&gt; = userRepository.findByUsername(loginRequest.username!!)<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!captchaService.validateCaptcha(loginRequest.recaptchaToken!!)) {
            <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Validation failed (ReCaptcha v2)"</span>),<font></font>
                    HttpStatus.BAD_REQUEST)<font></font>
        }<font></font>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (userCandidate.isPresent) {
            <span class="hljs-keyword">val</span> user: User = userCandidate.<span class="hljs-keyword">get</span>()<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (!user.enabled) {
                <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Account is not verified yet! Please, follow the link in the confirmation email."</span>),<font></font>
                        HttpStatus.UNAUTHORIZED)<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">val</span> authentication = authenticationManager.authenticate(<font></font>
                    UsernamePasswordAuthenticationToken(loginRequest.username, loginRequest.password))<font></font>
            SecurityContextHolder.getContext().setAuthentication(authentication)<font></font>
            <span class="hljs-keyword">val</span> jwt: String = jwtProvider.generateJwtToken(user.username!!)<font></font>
<font></font>
            <span class="hljs-keyword">val</span> cookie: Cookie = Cookie(authCookieName, jwt)<font></font>
            cookie.maxAge = jwtProvider.jwtExpiration!!<font></font>
            cookie.secure = isCookieSecure<font></font>
            cookie.isHttpOnly = <span class="hljs-literal">true</span>
            cookie.path = <span class="hljs-string">"/"</span><font></font>
            response.addCookie(cookie)<font></font>
<font></font>
            <span class="hljs-keyword">val</span> authorities: List&lt;GrantedAuthority&gt; = user.roles!!.stream().map({ role -&gt; SimpleGrantedAuthority(role.name)}).collect(Collectors.toList&lt;GrantedAuthority&gt;())
            <span class="hljs-keyword">return</span> ResponseEntity.ok(SuccessfulSigninResponse(user.username, authorities))<font></font>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"User not found!"</span>),<font></font>
                    HttpStatus.BAD_REQUEST)<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@PostMapping(<span class="hljs-meta-string">"/signup"</span>)</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">registerUser</span><span class="hljs-params">(<span class="hljs-meta">@Valid</span> <span class="hljs-meta">@RequestBody</span> newUser: <span class="hljs-type">NewUser</span>)</span></span>: ResponseEntity&lt;*&gt; {<font></font>
<font></font>
        <span class="hljs-keyword">val</span> userCandidate: Optional &lt;User&gt; = userRepository.findByUsername(newUser.username!!)<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!captchaService.validateCaptcha(newUser.recaptchaToken!!)) {
            <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Validation failed (ReCaptcha v2)"</span>),<font></font>
                    HttpStatus.BAD_REQUEST)<font></font>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!userCandidate.isPresent) {
            <span class="hljs-keyword">if</span> (usernameExists(newUser.username!!)) {
                <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Username is already taken!"</span>),<font></font>
                        HttpStatus.BAD_REQUEST)<font></font>
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (emailExists(newUser.email!!)) {
                <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Email is already in use!"</span>),<font></font>
                        HttpStatus.BAD_REQUEST)<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// Creating user's account</span>
                <span class="hljs-keyword">val</span> user = User(
                        <span class="hljs-number">0</span>,<font></font>
                        newUser.username!!,<font></font>
                        newUser.firstName!!,<font></font>
                        newUser.lastName!!,<font></font>
                        newUser.email!!,<font></font>
                        encoder.encode(newUser.password),<font></font>
                        <span class="hljs-literal">false</span><font></font>
                )<font></font>
                user.roles = Arrays.asList(roleRepository.findByName(<span class="hljs-string">"ROLE_USER"</span>))
                <span class="hljs-keyword">val</span> registeredUser = userRepository.save(user)<font></font>
<font></font>
                emailService.sendRegistrationConfirmationEmail(registeredUser)<font></font>
            } <span class="hljs-keyword">catch</span> (e: Exception) {
                <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Server error. Please, contact site owner"</span>),<font></font>
                        HttpStatus.SERVICE_UNAVAILABLE)<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Please, follow the link in the confirmation email to complete the registration."</span>), HttpStatus.OK)<font></font>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"User already exists!"</span>),<font></font>
                    HttpStatus.BAD_REQUEST)<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@PostMapping(<span class="hljs-meta-string">"/registrationConfirm"</span>)</span>
    <span class="hljs-meta">@CrossOrigin(origins = [<span class="hljs-meta-string">"*"</span>])</span>
    <span class="hljs-meta">@Throws(UnsupportedEncodingException::class)</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">confirmRegistration</span><span class="hljs-params">(request: <span class="hljs-type">HttpServletRequest</span>, model: <span class="hljs-type">Model</span>, <span class="hljs-meta">@RequestParam(<span class="hljs-meta-string">"token"</span>)</span> token: <span class="hljs-type">String</span>)</span></span>: ResponseEntity&lt;*&gt; {<font></font>
<font></font>
        <span class="hljs-keyword">when</span>(userService.validateVerificationToken(token)) {<font></font>
            TOKEN_VALID -&gt; <span class="hljs-keyword">return</span> ResponseEntity.ok(ResponseMessage(<span class="hljs-string">"Registration confirmed"</span>))<font></font>
            TOKEN_INVALID -&gt; <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Token is invalid!"</span>), HttpStatus.BAD_REQUEST)<font></font>
            TOKEN_EXPIRED -&gt; <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Token is invalid!"</span>), HttpStatus.UNAUTHORIZED)<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> ResponseEntity(ResponseMessage(<span class="hljs-string">"Server error. Please, contact site owner"</span>), HttpStatus.SERVICE_UNAVAILABLE)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@PostMapping(<span class="hljs-meta-string">"/logout"</span>)</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">logout</span><span class="hljs-params">(response: <span class="hljs-type">HttpServletResponse</span>)</span></span>: ResponseEntity&lt;*&gt; {
        <span class="hljs-keyword">val</span> cookie: Cookie = Cookie(authCookieName, <span class="hljs-literal">null</span>)<font></font>
        cookie.maxAge = <span class="hljs-number">0</span><font></font>
        cookie.secure = isCookieSecure<font></font>
        cookie.isHttpOnly = <span class="hljs-literal">true</span>
        cookie.path = <span class="hljs-string">"/"</span><font></font>
        response.addCookie(cookie)<font></font>
<font></font>
        <span class="hljs-keyword">return</span> ResponseEntity.ok(ResponseMessage(<span class="hljs-string">"Successfully logged"</span>))<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">emailExists</span><span class="hljs-params">(email: <span class="hljs-type">String</span>)</span></span>: <span class="hljs-built_in">Boolean</span> {
        <span class="hljs-keyword">return</span> userRepository.findByUsername(email).isPresent<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">usernameExists</span><span class="hljs-params">(username: <span class="hljs-type">String</span>)</span></span>: <span class="hljs-built_in">Boolean</span> {
        <span class="hljs-keyword">return</span> userRepository.findByUsername(username).isPresent<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、フロントエンドで作業し</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンポーネントを作成します。</font></font><code>RegistrationConfirmPage.vue</code><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃2</font></font></b><font style="vertical-align: inherit;"></font><code>router.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメータ</font><font style="vertical-align: inherit;">で新しいパスを追加</font><font style="vertical-align: inherit;">します</font></font><code>:token</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="javascript hljs"><font></font>
{<font></font>
        <span class="hljs-attr">path</span>: <span class="hljs-string">'/registration-confirm/:token'</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-string">'RegistrationConfirmPage'</span>,
        <span class="hljs-attr">component</span>: RegistrationConfirmPage<font></font>
}<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新</font></font><code>SignUp.vue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-フォームからデータを正常に送信した後、登録を完了するにはレターのリンクをクリックする必要があることを通知します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃4 </font></font></b> <u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要：</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">残念ながら、トークンを検証して成功または失敗を報告する別のコンポーネントへの固定リンクを提供することはできません。</font><font style="vertical-align: inherit;">スラッシュパスがすべて同じリンクは、アプリケーションの元のページに移動します。</font><font style="vertical-align: inherit;">しかし、送信されたGETパラメータを使用して登録を確認する必要があることをアプリケーションに伝えることができます</font></font><code>confirmRegistration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="javascript hljs">
<span class="hljs-attr">methods</span>: {<font></font>
    confirmRegistration() {<font></font>
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.$route.query.confirmRegistration === <span class="hljs-string">'true'</span> &amp;&amp; <span class="hljs-keyword">this</span>.$route.query.token != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">this</span>.$router.push({<span class="hljs-attr">name</span>: <span class="hljs-string">'RegistrationConfirmPage'</span>, <span class="hljs-attr">params</span>: { <span class="hljs-attr">token</span>: <span class="hljs-keyword">this</span>.$route.query.token}});<font></font>
      }<font></font>
    },<font></font>
<font></font>
...<font></font>
<font></font>
mounted() {<font></font>
    <span class="hljs-keyword">this</span>.confirmRegistration();<font></font>
  }<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃5</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トークンを検証し、検証結果を報告するコンポーネントを作成します。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RegistrationConfirmPage.vue</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs"><font></font>
&lt;template&gt;<font></font>
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"registration-confirm"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"confirm-form"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">b-card</span>
              <span class="hljs-attr">title</span>=<span class="hljs-string">"Confirmation"</span>
              <span class="hljs-attr">tag</span>=<span class="hljs-string">"article"</span>
              <span class="hljs-attr">style</span>=<span class="hljs-string">"max-width: 20rem;"</span>
              <span class="hljs-attr">class</span>=<span class="hljs-string">"mb-2"</span>
            &gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"isSuccess"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"success"</span>&gt;</span>Account is successfully verified!<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/login"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">b-button</span> <span class="hljs-attr">variant</span>=<span class="hljs-string">"primary"</span>&gt;</span>Login<span class="hljs-tag">&lt;/<span class="hljs-name">b-button</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"isError"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fail"</span>&gt;</span>Verification failed:<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ errorMessage }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">b-card</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><font></font>
&lt;/template&gt;<font></font>
<font></font>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> {AXIOS} <span class="hljs-keyword">from</span> <span class="hljs-string">'./http-common'</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'RegistrationConfirmPage'</span>,
    data() {
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">isSuccess</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">isError</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">errorMessage</span>: <span class="hljs-string">''</span>
        }
    },
    <span class="hljs-attr">methods</span>: {
        executeVerification() {
            AXIOS.post(<span class="hljs-string">`/auth/registrationConfirm`</span>, <span class="hljs-literal">null</span>, {<span class="hljs-attr">params</span>: { <span class="hljs-string">'token'</span>: <span class="hljs-keyword">this</span>.$route.params.token}})
            .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
              <span class="hljs-keyword">this</span>.isSuccess = <span class="hljs-literal">true</span>;
              <span class="hljs-built_in">console</span>.log(response);
            }, error =&gt; {
                <span class="hljs-keyword">this</span>.isError = <span class="hljs-literal">true</span>;
                <span class="hljs-keyword">this</span>.errorMessage = error.response.data.message;
            })
            .catch(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
              <span class="hljs-built_in">console</span>.log(e);
              <span class="hljs-keyword">this</span>.errorMessage = <span class="hljs-string">'Server error. Please, report this error website owners'</span>;
            })
        }
    },
    mounted() {
        <span class="hljs-keyword">this</span>.executeVerification();
    }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><font></font>
<font></font>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.confirm-form</span> {
    <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">38%</span>;
    <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">50px</span>;
}
<span class="hljs-selector-class">.success</span> {
    <span class="hljs-attribute">color</span>: green;
}
<span class="hljs-selector-class">.fail</span> {
    <span class="hljs-attribute">color</span>: red;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/0n/vj/os/0nvjosmit-f6n538uae6rsvwujo.png"><br>
</div></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論の代わりに</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この資料の最後に、余談を述べたいと思います。これとこれまでの記事で説明したアプリケーションの概念そのものは、執筆時点では新しいものではありませんでした。</font><font style="vertical-align: inherit;">最新のJavaScriptフレームワークAngular / React / Vue.jsを使用して、Spring Bootでアプリケーションの完全なスタックをすばやく作成するタスクは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hipsterを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エレガントに解決し</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、この記事で説明するアイデアはJHipsterを使用しても実装できるため、この場所にアクセスした読者がこの資料が思考の糧としても役立つことを願っています。</font></font><br>
<br>
<a name="links"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">役立つリンク</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHubリポジトリ（「Migrate to Gradle」ステップまで）</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHubリポジトリ（「Migrate to Gradle」ステップの後）</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーション（「Migrate to Gradle」ステップまで）</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーション（「Migration to Gradle」のステップの後）</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私が書いた同じ資料、英語のみ</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VuejsでGoogle reCaptchaを使用する方法</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vue.js用のGoogle ReCAPTCHAコンポーネント</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spring Emailのガイド</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spring BootとThymeleafを使用してメールを送信する</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apache Mavenからのビルドの移行</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ビルドロジックをGroovyからKotlinに移行する</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gradleを使用してSpring BootにAngularを統合する</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HerokuでのGradleの使用開始</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HerokuでのGradleアプリのデプロイ</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> マルチプロジェクトビルドのデプロイ </font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ローカルストレージの使用を停止してください</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SPA（ReactJSおよびVueJS）での認証が正しい方法</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spring Boot REST APIを保護するためのJWTを使用したステートレス認証</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">登録-メールで新しいアカウントをアクティブ化</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja482210/index.html">テトリスおよびリバースエンジニアリングアニメーション用のボット。第2回プログラミングチャンピオンシップのモバイルトラックの分析</a></li>
<li><a href="../ja482212/index.html">...チーズについて話しますか？</a></li>
<li><a href="../ja482216/index.html">専門の精神科医マキシムマリヤビン（dpmmax）からうつ病への23の応答</a></li>
<li><a href="../ja482218/index.html">12月27日のJavaダイジェスト</a></li>
<li><a href="../ja482220/index.html">アルコマーカーによるローカリゼーション</a></li>
<li><a href="../ja482224/index.html">デザイナーが小さなプログラマーである必要がある場合</a></li>
<li><a href="../ja482228/index.html">C＃で「電卓」を記述します。パートI.値の計算、導関数、単純化、およびその他のガチョウ</a></li>
<li><a href="../ja482230/index.html">WEBサーバーの戦い。パート2-現実的なHTTPSシナリオ：</a></li>
<li><a href="../ja482232/index.html">StackOverflowは、愚かな質問に対する回答の単なるリポジトリではありません</a></li>
<li><a href="../ja482234/index.html">PADS Professionalでのデジタルからアナログおよび混合モデリング</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>