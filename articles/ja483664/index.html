<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤µğŸ½ ğŸ‘µ ğŸ¤± TensorFlowã®Kerasæ©Ÿèƒ½API ğŸ’• â‡ï¸ ğŸ”</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kerasã«ã¯ã€ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§ã‚ã‚‹SequentialãŠã‚ˆã³Functionalã‚’è¿…é€Ÿã«æ§‹ç¯‰ã™ã‚‹ãŸã‚ã®2ã¤ã®APIãŒã‚ã‚Šã¾ã™ã€‚å‰è€…ã§ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®é †æ¬¡ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ã¿ã‚’æ§‹ç¯‰ã§ãã‚‹å ´åˆã¯ã€Functional APIã‚’ä½¿ç”¨ã—ã¦ã€ä»»æ„ã®æœ‰å‘éå¾ªç’°ã‚°ãƒ©ãƒ•ã®å½¢å¼ã§ãƒ‹ãƒ¥ãƒ¼ãƒ©...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>TensorFlowã®Kerasæ©Ÿèƒ½API</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483664/"><img src="https://habrastorage.org/webt/w1/zr/n8/w1zrn8ydafoxahso_ig7vx1stfg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kerasã«ã¯ã€ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§ã‚ã‚‹SequentialãŠã‚ˆã³Functionalã‚’è¿…é€Ÿã«æ§‹ç¯‰ã™ã‚‹ãŸã‚ã®2ã¤ã®APIãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">å‰è€…ã§ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®é †æ¬¡ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ã¿ã‚’æ§‹ç¯‰ã§ãã‚‹å ´åˆã¯ã€Functional APIã‚’ä½¿ç”¨ã—ã¦ã€ä»»æ„ã®æœ‰å‘éå¾ªç’°ã‚°ãƒ©ãƒ•ã®å½¢å¼ã§ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’å®šç¾©ã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€è¤‡é›‘ãªãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹æ©Ÿä¼šãŒå¤§å¹…ã«å¢—ãˆã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®è¨˜äº‹ã¯ã€TensorFlowã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã®æ©Ÿèƒ½APIæ©Ÿèƒ½ã‚¬ã‚¤ãƒ‰ã‚’ç¿»è¨³ã—ãŸã‚‚ã®ã§ã™ã€‚</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‰æ›¸ã</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é–¢æ•°å‹APIã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«APIã‚ˆã‚Šã‚‚æŸ”è»Ÿã«ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã§ãã¾ã™ã€‚ã“ã‚Œã¯ã€éç·šå½¢ãƒˆãƒãƒ­ã‚¸ã®ãƒ¢ãƒ‡ãƒ«ã€å…±é€šã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’æŒã¤ãƒ¢ãƒ‡ãƒ«ã€è¤‡æ•°ã®å…¥åŠ›ã¾ãŸã¯å‡ºåŠ›ã‚’æŒã¤ãƒ¢ãƒ‡ãƒ«ã‚’å‡¦ç†ã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ¢ãƒ‡ãƒ«ã¯é€šå¸¸ã€å±¤ã®æœ‰å‘éå¾ªç’°ã‚°ãƒ©ãƒ•ï¼ˆDAGï¼‰ã§ã‚ã‚‹ã¨ã„ã†äº‹å®Ÿã«åŸºã¥ã„ã¦ã„</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æ©Ÿèƒ½APIã¯ã€</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å±¤ã®ã‚°ãƒ©ãƒ•</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’</font><b><font style="vertical-align: inherit;">ä½œæˆã™ã‚‹</font></b><font style="vertical-align: inherit;">ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã®ã‚»ãƒƒãƒˆã§ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã®ãƒ¢ãƒ‡ãƒ«ã‚’è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ï¼š</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆå…¥åŠ›ï¼š784æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«ï¼‰</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 â†§ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[é«˜å¯†åº¦å±¤ï¼ˆ64è¦ç´ ã€reluã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 â†§ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[é«˜å¯†åº¦å±¤ï¼ˆ64è¦ç´ ã€reluã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 â†§ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[é«˜å¯†åº¦å±¤ï¼ˆ10è¦ç´ ã€</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 softmax </font><font style="vertical-align: inherit;">ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰] </font><font style="vertical-align: inherit;">â†§ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ï¼ˆå‡ºåŠ›ï¼šç¢ºç‡åˆ†å¸ƒ10ã‚¯ãƒ©ã‚¹ï¼‰</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã‚Œã¯3ã¤ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å˜ç´”ãªã‚°ãƒ©ãƒ•ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Functional APIã‚’ä½¿ç”¨ã—ã¦ã“ã®ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹ã«ã¯ã€ã¾ãšå…¥åŠ›ãƒãƒ¼ãƒ‰ã‚’ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> tensorflow <span class="hljs-keyword">import</span> keras<font></font>
<font></font>
inputs = keras.Input(shape=(<span class="hljs-number">784</span>,))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã“ã§ã¯ã€ãƒ‡ãƒ¼ã‚¿ã®æ¬¡å…ƒã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚784æ¬¡å…ƒã®ãƒ™ã‚¯ãƒˆãƒ«ã§ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ‡ãƒ¼ã‚¿ã®é‡ã¯å¸¸ã«çœç•¥ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚å„è¦ç´ ã®æ¬¡å…ƒã®ã¿ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ç”»åƒç”¨ã®ç”»åƒã‚µã‚¤ã‚º `ï¼ˆ32ã€32ã€3ï¼‰`ã‚’å…¥åŠ›ã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">img_inputs = keras.Input(shape=(<span class="hljs-number">32</span>, <span class="hljs-number">32</span>, <span class="hljs-number">3</span>))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿”ã•ã‚Œã‚‹ã‚‚ã®ã«ã¯</font></font><code>inputs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ãƒ¢ãƒ‡ãƒ«ã«è»¢é€ã™ã‚‹äºˆå®šã®ãƒ‡ãƒ¼ã‚¿ã®ã‚µã‚¤ã‚ºã¨ã‚¿ã‚¤ãƒ—ã«é–¢ã™ã‚‹æƒ…å ±</font><font style="vertical-align: inherit;">ãŒ</font><font style="vertical-align: inherit;">å«ã¾ã‚Œã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">inputs.shape</code></pre><br>
<pre><code class="python hljs">TensorShape([<span class="hljs-literal">None</span>, <span class="hljs-number">784</span>])</code></pre><br>
<pre><code class="python hljs">inputs.dtype</code></pre><br>
<pre><code class="python hljs">tf.float32</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’å‘¼ã³å‡ºã—ã¦ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚°ãƒ©ãƒ•ã«æ–°ã—ã„ãƒãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¾ã™</font></font><code>inputs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> tensorflow.keras <span class="hljs-keyword">import</span> layers<font></font>
<font></font>
dense = layers.Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">'relu'</span>)<font></font>
x = dense(inputs)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã€Œãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å‘¼ã³å‡ºã—ã€ã¯ã€ã€Œå…¥åŠ›ã€ã‹ã‚‰ä½œæˆã—ãŸãƒ¬ã‚¤ãƒ¤ãƒ¼ã«çŸ¢å°ã‚’æãã®ã¨åŒã˜ã§ã™ã€‚</font><font style="vertical-align: inherit;">å…¥åŠ›ã‚’</font></font><code>dense</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«</font><font style="vertical-align: inherit;">ã€Œæ¸¡ã™ã€</font><font style="vertical-align: inherit;">ã¨ã€ã‚’å—ã‘å–ã‚Š</font></font><code>x</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚°ãƒ©ãƒ•ã«ã„ãã¤ã‹ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’è¿½åŠ ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br>
<pre><code class="python hljs">x = layers.Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">'relu'</span>)(x)<font></font>
outputs = layers.Dense(<span class="hljs-number">10</span>, activation=<span class="hljs-string">'softmax'</span>)(x)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œ</font></font><code>Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚°ãƒ©ãƒ•ã§å…¥åŠ›ã¨å‡ºåŠ›ã‚’æŒ‡å®šã—ã¦</font><font style="vertical-align: inherit;">ä½œæˆã§ãã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="python hljs">model = keras.Model(inputs=inputs, outputs=outputs)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¢ãƒ‡ãƒ«ã‚’æ±ºå®šã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹å…¨ä½“ã‚’ã‚‚ã†ä¸€åº¦è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br>
<pre><code class="python hljs">inputs = keras.Input(shape=(<span class="hljs-number">784</span>,), name=<span class="hljs-string">'img'</span>)<font></font>
x = layers.Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">'relu'</span>)(inputs)<font></font>
x = layers.Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">'relu'</span>)(x)<font></font>
outputs = layers.Dense(<span class="hljs-number">10</span>, activation=<span class="hljs-string">'softmax'</span>)(x)<font></font>
<font></font>
model = keras.Model(inputs=inputs, outputs=outputs, name=<span class="hljs-string">'mnist_model'</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¢ãƒ‡ãƒ«ã®è¦ç´„ãŒã©ã®ã‚ˆã†ã«ãªã‚‹ã‹è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br>
<pre><code class="python hljs">model.summary()</code></pre><br>
<pre><code class="python hljs">Model: <span class="hljs-string">"mnist_model"</span><font></font>
_________________________________________________________________<font></font>
Layer (type)                 Output Shape              Param <span class="hljs-comment">#   </span><font></font>
=================================================================<font></font>
img (InputLayer)             [(<span class="hljs-literal">None</span>, <span class="hljs-number">784</span>)]             <span class="hljs-number">0</span>         <font></font>
_________________________________________________________________<font></font>
dense_3 (Dense)              (<span class="hljs-literal">None</span>, <span class="hljs-number">64</span>)                <span class="hljs-number">50240</span>     <font></font>
_________________________________________________________________<font></font>
dense_4 (Dense)              (<span class="hljs-literal">None</span>, <span class="hljs-number">64</span>)                <span class="hljs-number">4160</span>      <font></font>
_________________________________________________________________<font></font>
dense_5 (Dense)              (<span class="hljs-literal">None</span>, <span class="hljs-number">10</span>)                <span class="hljs-number">650</span>       <font></font>
=================================================================<font></font>
Total params: <span class="hljs-number">55</span>,<span class="hljs-number">050</span>
Trainable params: <span class="hljs-number">55</span>,<span class="hljs-number">050</span>
Non-trainable params: <span class="hljs-number">0</span>
_________________________________________________________________</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¢ãƒ‡ãƒ«ã‚’ã‚°ãƒ©ãƒ•ã¨ã—ã¦æãã“ã¨ã‚‚ã§ãã¾ã™ï¼š</font></font><br>
<br>
<pre><code class="python hljs">keras.utils.plot_model(model, <span class="hljs-string">'my_first_model.png'</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/oq/4o/vl/oq4ovlxewr3hxczaldchmbeyfua.png" alt="ç”»åƒ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã€æ§‹ç¯‰ã•ã‚ŒãŸã‚°ãƒ©ãƒ•ä¸Šã®å„ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å…¥åŠ›ã¨å‡ºåŠ›ã®æ¬¡å…ƒã‚’å°ãå‡ºã—ã¾ã™ï¼š</font></font><br>
<br>
<pre><code class="python hljs">keras.utils.plot_model(model, <span class="hljs-string">'my_first_model_with_shape_info.png'</span>, show_shapes=<span class="hljs-literal">True</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/fn/rm/hc/fnrmhcqknnsjdcgmqp9w6dpong8.png" alt="ç”»åƒ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ç”»åƒã¨ç§ãŸã¡ãŒæ›¸ã„ãŸã‚³ãƒ¼ãƒ‰ã¯åŒã˜ã§ã™ã€‚</font><font style="vertical-align: inherit;">ã‚³ãƒ¼ãƒ‰ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯ã€ãƒã‚¤ãƒ³ãƒ‰çŸ¢å°ã¯å˜ã«å‘¼ã³å‡ºã—æ“ä½œã«ç½®ãæ›ãˆã‚‰ã‚Œã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã€Œãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚°ãƒ©ãƒ•ã€ã¯ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ¢ãƒ‡ãƒ«ã®éå¸¸ã«ç›´æ„Ÿçš„ãªãƒ¡ãƒ³ã‚¿ãƒ«ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã‚ã‚Šã€Functional APIã¯ã“ã®ãƒ¡ãƒ³ã‚¿ãƒ«ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å¯†æ¥ã«åæ˜ ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã™ã‚‹æ–¹æ³•ã§ã™ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã€è©•ä¾¡ã€çµè«–</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ãƒ¢ãƒ‡ãƒ«ã¨åŒæ§˜ã«ã€Functional APIã‚’ä½¿ç”¨ã—ã¦æ§‹ç¯‰ã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã€è©•ä¾¡ã€ãŠã‚ˆã³æ¨è«–ä½œæ¥­ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°¡å˜ãªãƒ‡ãƒ¢ã‚’æ¤œè¨ã—ã¦ãã ã•ã„ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã“ã§ã€MNISTç”»åƒãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’èª­ã¿è¾¼ã¿ã€ãƒ™ã‚¯ã‚¿ãƒ¼ã«å¤‰æ›ã—ã€ãƒ‡ãƒ¼ã‚¿ã§ãƒ¢ãƒ‡ãƒ«ã‚’ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã—ï¼ˆãƒ†ã‚¹ãƒˆã‚µãƒ³ãƒ—ãƒ«ã®ä½œæ¥­å“è³ªã‚’ç›£è¦–ã—ãªãŒã‚‰ï¼‰ã€æœ€å¾Œã«ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§ãƒ¢ãƒ‡ãƒ«ã‚’è©•ä¾¡ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">(x_train, y_train), (x_test, y_test) = keras.datasets.mnist.load_data()<font></font>
x_train = x_train.reshape(<span class="hljs-number">60000</span>, <span class="hljs-number">784</span>).astype(<span class="hljs-string">'float32'</span>) / <span class="hljs-number">255</span>
x_test = x_test.reshape(<span class="hljs-number">10000</span>, <span class="hljs-number">784</span>).astype(<span class="hljs-string">'float32'</span>) / <span class="hljs-number">255</span><font></font>
<font></font>
model.compile(loss=<span class="hljs-string">'sparse_categorical_crossentropy'</span>,<font></font>
              optimizer=keras.optimizers.RMSprop(),<font></font>
              metrics=[<span class="hljs-string">'accuracy'</span>])<font></font>
history = model.fit(x_train, y_train,<font></font>
                    batch_size=<span class="hljs-number">64</span>,<font></font>
                    epochs=<span class="hljs-number">5</span>,<font></font>
                    validation_split=<span class="hljs-number">0.2</span>)<font></font>
test_scores = model.evaluate(x_test, y_test, verbose=<span class="hljs-number">2</span>)<font></font>
print(<span class="hljs-string">'Test loss:'</span>, test_scores[<span class="hljs-number">0</span>])<font></font>
print(<span class="hljs-string">'Test accuracy:'</span>, test_scores[<span class="hljs-number">1</span>]) </code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¿å­˜ã¨ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é–¢æ•°å‹APIã‚’ä½¿ç”¨ã—ã¦æ§‹ç¯‰ã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«ã®ä¿å­˜ã¨ã‚·ãƒªã‚¢ãƒ«åŒ–ã¯ã€ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ãƒ¢ãƒ‡ãƒ«ã®å ´åˆã¨ã¾ã£ãŸãåŒã˜ã‚ˆã†ã«æ©Ÿèƒ½ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ©Ÿèƒ½ãƒ¢ãƒ‡ãƒ«ã‚’ä¿å­˜ã™ã‚‹æ¨™æº–çš„ãªæ–¹æ³•ã¯ã€</font></font><code>model.save(</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font><font style="vertical-align: inherit;">ã‚’å‘¼ã³å‡ºã™</font><font style="vertical-align: inherit;">ã“ã¨ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¢ãƒ‡ãƒ«å…¨ä½“ã‚’1ã¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ãŸã‚³ãƒ¼ãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªããªã£ãŸå ´åˆã§ã‚‚ã€å¾Œã§ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰åŒã˜ãƒ¢ãƒ‡ãƒ«ã‚’å¾©å…ƒã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«å«ã¾ã‚Œã‚‹ã‚‚ã®ï¼š</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¢ãƒ‡ãƒ«ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¢ãƒ‡ãƒ«ã®é‡ã¿ã®å€¤ï¼ˆãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ä¸­ã«å–å¾—ã•ã‚ŒãŸï¼‰</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¢ãƒ‡ãƒ«ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°æ§‹æˆï¼ˆæ¸¡ã—ãŸã‚‚ã®</font></font><code>compile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚ªãƒ—ãƒ†ã‚£ãƒã‚¤ã‚¶ãƒ¼ã¨ãã®æ¡ä»¶ï¼ˆã‚ã‚‹å ´åˆï¼‰ï¼ˆã“ã‚Œã«ã‚ˆã‚Šã€ä¸­æ–­ã—ãŸã¨ã“ã‚ã‹ã‚‰ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’å†é–‹ã§ãã¾ã™ï¼‰</font></font></li>
</ul><br>
<pre><code class="python hljs">
model.save(<span class="hljs-string">'path_to_my_model.h5'</span>)
<span class="hljs-keyword">del</span> model
<span class="hljs-comment"># Recreate the exact same model purely from the file:</span>
model = keras.models.load_model(<span class="hljs-string">'path_to_my_model.h5'</span>)
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŒã˜ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚°ãƒ©ãƒ•ã‚’ä½¿ç”¨ã—ã¦è¤‡æ•°ã®ãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾©ã™ã‚‹</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é–¢æ•°å‹APIã§ã¯ã€ãƒ¢ãƒ‡ãƒ«ã¯å±¤ã‚°ãƒ©ãƒ•ã§å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã¨å‡ºåŠ›ãƒ‡ãƒ¼ã‚¿ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ä½œæˆã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã¤ã¾ã‚Šã€å˜ä¸€ã®å±¤ã‚°ãƒ©ãƒ•ã‚’ä½¿ç”¨ã—ã¦è¤‡æ•°ã®ãƒ¢ãƒ‡ãƒ«ã‚’ç”Ÿæˆã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»¥ä¸‹ã®ä¾‹ã§ã¯ã€åŒã˜ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¹ã‚¿ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦2ã¤ã®ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">å…¥åŠ›ç”»åƒã‚’16æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«ã«å¤‰æ›</font><font style="vertical-align: inherit;">ã™ã‚‹</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¢ãƒ‡ãƒ«</font></font><code> (encoder)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¨ã€</font></font><code> (autoencoder) </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ç”¨ã®</font><font style="vertical-align: inherit;">ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ãƒ¢ãƒ‡ãƒ«</font><font style="vertical-align: inherit;">ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">encoder_input = keras.Input(shape=(<span class="hljs-number">28</span>, <span class="hljs-number">28</span>, <span class="hljs-number">1</span>), name=<span class="hljs-string">'img'</span>)<font></font>
x = layers.Conv2D(<span class="hljs-number">16</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>)(encoder_input)<font></font>
x = layers.Conv2D(<span class="hljs-number">32</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>)(x)<font></font>
x = layers.MaxPooling2D(<span class="hljs-number">3</span>)(x)<font></font>
x = layers.Conv2D(<span class="hljs-number">32</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>)(x)<font></font>
x = layers.Conv2D(<span class="hljs-number">16</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>)(x)<font></font>
encoder_output = layers.GlobalMaxPooling2D()(x)<font></font>
<font></font>
encoder = keras.Model(encoder_input, encoder_output, name=<span class="hljs-string">'encoder'</span>)<font></font>
encoder.summary()<font></font>
<font></font>
x = layers.Reshape((<span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>))(encoder_output)<font></font>
x = layers.Conv2DTranspose(<span class="hljs-number">16</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>)(x)<font></font>
x = layers.Conv2DTranspose(<span class="hljs-number">32</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>)(x)<font></font>
x = layers.UpSampling2D(<span class="hljs-number">3</span>)(x)<font></font>
x = layers.Conv2DTranspose(<span class="hljs-number">16</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>)(x)<font></font>
decoder_output = layers.Conv2DTranspose(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>)(x)<font></font>
<font></font>
autoencoder = keras.Model(encoder_input, decoder_output, name=<span class="hljs-string">'autoencoder'</span>)<font></font>
autoencoder.summary()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ‡ã‚³ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨å³å¯†ã«å¯¾ç§°ã«ã—ã¦ã€å‡ºåŠ›ãƒ‡ãƒ¼ã‚¿ã®æ¬¡å…ƒã‚’å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã¨åŒã˜ã«ã™ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„</font></font><code>(28, 28, 1)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ãƒ¬ã‚¤ãƒ¤ãƒ¼</font></font><code>Conv2D</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯</font><font style="vertical-align: inherit;">ãƒ¬ã‚¤ãƒ¤ãƒ¼</font><font style="vertical-align: inherit;">ã®</font><font style="vertical-align: inherit;">é€†ã§ã‚ã‚Šã€</font><font style="vertical-align: inherit;">ãƒ¬ã‚¤ãƒ¤ãƒ¼</font></font><code>Conv2DTranspose</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯ãƒ¬ã‚¤ãƒ¤ãƒ¼</font></font><code>MaxPooling2D</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã®</font><font style="vertical-align: inherit;">é€†ã«ãªã‚Š</font></font><code>UpSampling2D</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¢ãƒ‡ãƒ«ã¯ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã—ã¦å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»»æ„ã®ãƒ¢ãƒ‡ãƒ«ã‚’ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§ã‚ã‚‹</font></font><code>Input</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‹ã®</font><font style="vertical-align: inherit;">ã‚ˆã†ã«</font><font style="vertical-align: inherit;">ä½¿ç”¨ã—ã€åˆ¥ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å‡ºåŠ›</font><font style="vertical-align: inherit;">ä¸Š</font><font style="vertical-align: inherit;">ã¾ãŸã¯å‡ºåŠ›ã§</font><font style="vertical-align: inherit;">å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¢ãƒ‡ãƒ«ã‚’å‘¼ã³å‡ºã™ã“ã¨ã«ã‚ˆã‚Šã€ãã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’å†åˆ©ç”¨ã™ã‚‹ã ã‘ã§ãªãã€ãã®é‡ã¿ã‚‚å†åˆ©ç”¨ã™ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚</font><font style="vertical-align: inherit;">å®Ÿéš›ã«è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font><font style="vertical-align: inherit;">æ¬¡ã«ã€è‡ªå‹•ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ãƒ¼ã®ä¾‹ã‚’ã‚‚ã†1ã¤ç¤ºã—ã¾ã™ã€‚ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ãƒ¼ãƒ¢ãƒ‡ãƒ«ã€ãƒ‡ã‚³ãƒ¼ãƒ€ãƒ¼ãƒ¢ãƒ‡ãƒ«ãŒä½œæˆã•ã‚Œã€ãã‚Œã‚‰ãŒ2ã¤ã®å‘¼ã³å‡ºã—ã§æ¥ç¶šã•ã‚Œã¦è‡ªå‹•ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ãƒ¼ãƒ¢ãƒ‡ãƒ«ãŒå–å¾—ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">encoder_input = keras.Input(shape=(<span class="hljs-number">28</span>, <span class="hljs-number">28</span>, <span class="hljs-number">1</span>), name=<span class="hljs-string">'original_img'</span>)<font></font>
x = layers.Conv2D(<span class="hljs-number">16</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>)(encoder_input)<font></font>
x = layers.Conv2D(<span class="hljs-number">32</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>)(x)<font></font>
x = layers.MaxPooling2D(<span class="hljs-number">3</span>)(x)<font></font>
x = layers.Conv2D(<span class="hljs-number">32</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>)(x)<font></font>
x = layers.Conv2D(<span class="hljs-number">16</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>)(x)<font></font>
encoder_output = layers.GlobalMaxPooling2D()(x)<font></font>
<font></font>
encoder = keras.Model(encoder_input, encoder_output, name=<span class="hljs-string">'encoder'</span>)<font></font>
encoder.summary()<font></font>
<font></font>
decoder_input = keras.Input(shape=(<span class="hljs-number">16</span>,), name=<span class="hljs-string">'encoded_img'</span>)<font></font>
x = layers.Reshape((<span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>))(decoder_input)<font></font>
x = layers.Conv2DTranspose(<span class="hljs-number">16</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>)(x)<font></font>
x = layers.Conv2DTranspose(<span class="hljs-number">32</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>)(x)<font></font>
x = layers.UpSampling2D(<span class="hljs-number">3</span>)(x)<font></font>
x = layers.Conv2DTranspose(<span class="hljs-number">16</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>)(x)<font></font>
decoder_output = layers.Conv2DTranspose(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>)(x)<font></font>
<font></font>
decoder = keras.Model(decoder_input, decoder_output, name=<span class="hljs-string">'decoder'</span>)<font></font>
decoder.summary()<font></font>
<font></font>
autoencoder_input = keras.Input(shape=(<span class="hljs-number">28</span>, <span class="hljs-number">28</span>, <span class="hljs-number">1</span>), name=<span class="hljs-string">'img'</span>)<font></font>
encoded_img = encoder(autoencoder_input)<font></font>
decoded_img = decoder(encoded_img)<font></font>
autoencoder = keras.Model(autoencoder_input, decoded_img, name=<span class="hljs-string">'autoencoder'</span>)<font></font>
autoencoder.summary()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã”è¦§ã®ã¨ãŠã‚Šã€ãƒ¢ãƒ‡ãƒ«ã¯ãƒã‚¹ãƒˆã§ãã¾ã™ã€‚ãƒ¢ãƒ‡ãƒ«ã¯ã‚µãƒ–ãƒ¢ãƒ‡ãƒ«ã‚’å«ã‚€ã“ã¨ãŒã§ãã¾ã™ï¼ˆãƒ¢ãƒ‡ãƒ«ã¯ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨è¦‹ãªã™ã“ã¨ãŒã§ãã‚‹ãŸã‚ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒ¢ãƒ‡ãƒ«ã®ä¸€èˆ¬çš„ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã¯</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ensmbling</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¾‹ã¨ã—ã¦ã€ãƒ¢ãƒ‡ãƒ«ã®ã‚»ãƒƒãƒˆã‚’ã€äºˆæ¸¬ã‚’å¹³å‡åŒ–ã™ã‚‹1ã¤ã®ãƒ¢ãƒ‡ãƒ«ã«çµ„ã¿åˆã‚ã›ã‚‹æ–¹æ³•ã‚’æ¬¡ã«ç¤ºã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_model</span>():</span>
  inputs = keras.Input(shape=(<span class="hljs-number">128</span>,))<font></font>
  outputs = layers.Dense(<span class="hljs-number">1</span>, activation=<span class="hljs-string">'sigmoid'</span>)(inputs)
  <span class="hljs-keyword">return</span> keras.Model(inputs, outputs)<font></font>
<font></font>
model1 = get_model()<font></font>
model2 = get_model()<font></font>
model3 = get_model()<font></font>
<font></font>
inputs = keras.Input(shape=(<span class="hljs-number">128</span>,))<font></font>
y1 = model1(inputs)<font></font>
y2 = model2(inputs)<font></font>
y3 = model3(inputs)<font></font>
outputs = layers.average([y1, y2, y3])<font></font>
ensemble_model = keras.Model(inputs=inputs, outputs=outputs)</code></pre><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¤‡é›‘ãªã‚°ãƒ©ãƒ•ãƒˆãƒãƒ­ã‚¸ã®æ“ä½œ</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¤‡æ•°ã®å…¥åŠ›ã¨å‡ºåŠ›ã‚’å‚™ãˆãŸãƒ¢ãƒ‡ãƒ«</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ©Ÿèƒ½APIã¯ã€è¤‡æ•°ã®å…¥åŠ›ã¨å‡ºåŠ›ã®æ“ä½œã‚’ç°¡ç´ åŒ–ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«APIã§ã¯å®Ÿè¡Œã§ãã¾ã›ã‚“ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã¯ç°¡å˜ãªä¾‹ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¡§å®¢ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å„ªå…ˆé †ä½ã§ãƒ©ãƒ³ã‚¯ä»˜ã‘ã—ã¦é©åˆ‡ãªéƒ¨é–€ã«é€ä¿¡ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½œæˆã™ã‚‹ã¨ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¢ãƒ‡ãƒ«ã«ã¯3ã¤ã®å…¥åŠ›ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ï¼‰</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ï¼‰</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¿½åŠ ã—ãŸã‚¿ã‚°ï¼ˆã‚«ãƒ†ã‚´ãƒªå…¥åŠ›ï¼‰</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¢ãƒ‡ãƒ«ã«ã¯2ã¤ã®å‡ºåŠ›ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0ã‹ã‚‰1ã¾ã§ã®å„ªå…ˆé †ä½ã‚¹ã‚³ã‚¢ï¼ˆã‚¹ã‚«ãƒ©ãƒ¼Så­—å‹å‡ºåŠ›ï¼‰</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å‡¦ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚‹éƒ¨é–€ï¼ˆå¤šãã®éƒ¨é–€ã«é–¢ã™ã‚‹softmaxå‡ºåŠ›ï¼‰</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Functional APIã‚’ä½¿ç”¨ã—ã¦ã€æ•°è¡Œã§ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br>
<pre><code class="python hljs">num_tags = <span class="hljs-number">12</span>  <span class="hljs-comment">#    </span>
num_words = <span class="hljs-number">10000</span>  <span class="hljs-comment">#        </span>
num_departments = <span class="hljs-number">4</span>  <span class="hljs-comment">#    </span><font></font>
<font></font>
title_input = keras.Input(shape=(<span class="hljs-literal">None</span>,), name=<span class="hljs-string">'title'</span>)  <span class="hljs-comment">#     </span>
body_input = keras.Input(shape=(<span class="hljs-literal">None</span>,), name=<span class="hljs-string">'body'</span>)  <span class="hljs-comment">#     </span>
tags_input = keras.Input(shape=(num_tags,), name=<span class="hljs-string">'tags'</span>)  <span class="hljs-comment">#    `num_tags`</span><font></font>
<font></font>
<span class="hljs-comment">#      64- </span>
title_features = layers.Embedding(num_words, <span class="hljs-number">64</span>)(title_input)
<span class="hljs-comment">#      64- </span>
body_features = layers.Embedding(num_words, <span class="hljs-number">64</span>)(body_input)<font></font>
<font></font>
<span class="hljs-comment">#        128- </span>
title_features = layers.LSTM(<span class="hljs-number">128</span>)(title_features)
<span class="hljs-comment">#        32- </span>
body_features = layers.LSTM(<span class="hljs-number">32</span>)(body_features)<font></font>
<font></font>
<span class="hljs-comment">#         </span><font></font>
x = layers.concatenate([title_features, body_features, tags_input])<font></font>
<font></font>
<span class="hljs-comment">#        </span>
priority_pred = layers.Dense(<span class="hljs-number">1</span>, activation=<span class="hljs-string">'sigmoid'</span>, name=<span class="hljs-string">'priority'</span>)(x)
<span class="hljs-comment">#      </span>
department_pred = layers.Dense(num_departments, activation=<span class="hljs-string">'softmax'</span>, name=<span class="hljs-string">'department'</span>)(x)<font></font>
<font></font>
<span class="hljs-comment">#   ,    </span><font></font>
model = keras.Model(inputs=[title_input, body_input, tags_input],<font></font>
                    outputs=[priority_pred, department_pred])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¢ãƒ‡ãƒ«ã‚°ãƒ©ãƒ•ã‚’æãã¾ã—ã‚‡ã†ï¼š</font></font><br>
<br>
<pre><code class="python hljs">keras.utils.plot_model(model, <span class="hljs-string">'multi_input_and_output_model.png'</span>, show_shapes=<span class="hljs-literal">True</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/gc/hk/uw/gchkuwc_zgefnaf4tx0ercck8bc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ãƒ¢ãƒ‡ãƒ«ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ã¨ãã€å„å‡ºåŠ›ã«ç•°ãªã‚‹æå¤±é–¢æ•°ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å„æå¤±é–¢æ•°ã«ç•°ãªã‚‹é‡ã¿ã‚’å‰²ã‚Šå½“ã¦ã¦ã€å­¦ç¿’æå¤±é–¢æ•°å…¨ä½“ã¸ã®å¯„ä¸ã‚’å¤‰ãˆã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">model.compile(optimizer=keras.optimizers.RMSprop(<span class="hljs-number">1e-3</span>),<font></font>
              loss=[<span class="hljs-string">'binary_crossentropy'</span>, <span class="hljs-string">'categorical_crossentropy'</span>],<font></font>
              loss_weights=[<span class="hljs-number">1.</span>, <span class="hljs-number">0.2</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‡ºåŠ›ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«åå‰ã‚’ä»˜ã‘ãŸã®ã§ã€æå¤±é–¢æ•°ã‚‚æŒ‡å®šã§ãã¾ã™ã€‚</font></font><br>
 <br>
<pre><code class="python hljs">model.compile(optimizer=keras.optimizers.RMSprop(<span class="hljs-number">1e-3</span>),<font></font>
              loss={<span class="hljs-string">'priority'</span>: <span class="hljs-string">'binary_crossentropy'</span>,
                    <span class="hljs-string">'department'</span>: <span class="hljs-string">'categorical_crossentropy'</span>},<font></font>
              loss_weights=[<span class="hljs-number">1.</span>, <span class="hljs-number">0.2</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã¨ãƒ©ãƒ™ãƒ«ã®Numpyé…åˆ—ã®ãƒªã‚¹ãƒˆã‚’æ¸¡ã™ã“ã¨ã«ã‚ˆã‚Šã€ãƒ¢ãƒ‡ãƒ«ã‚’ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<font></font>
<font></font>
<span class="hljs-comment"># Dummy input data</span>
title_data = np.random.randint(num_words, size=(<span class="hljs-number">1280</span>, <span class="hljs-number">10</span>))<font></font>
body_data = np.random.randint(num_words, size=(<span class="hljs-number">1280</span>, <span class="hljs-number">100</span>))<font></font>
tags_data = np.random.randint(<span class="hljs-number">2</span>, size=(<span class="hljs-number">1280</span>, num_tags)).astype(<span class="hljs-string">'float32'</span>)
<span class="hljs-comment"># Dummy target data</span>
priority_targets = np.random.random(size=(<span class="hljs-number">1280</span>, <span class="hljs-number">1</span>))<font></font>
dept_targets = np.random.randint(<span class="hljs-number">2</span>, size=(<span class="hljs-number">1280</span>, num_departments))<font></font>
<font></font>
model.fit({<span class="hljs-string">'title'</span>: title_data, <span class="hljs-string">'body'</span>: body_data, <span class="hljs-string">'tags'</span>: tags_data},<font></font>
          {<span class="hljs-string">'priority'</span>: priority_targets, <span class="hljs-string">'department'</span>: dept_targets},<font></font>
          epochs=<span class="hljs-number">2</span>,<font></font>
          batch_size=<span class="hljs-number">32</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</font></font><code>Dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§</font><font style="vertical-align: inherit;">fitã‚’å‘¼ã³å‡ºã™ã¨</font><font style="vertical-align: inherit;">ã€ãªã©ã®ãƒªã‚¹ãƒˆã®ã‚¿ãƒ—ãƒ«</font></font><code>([title_data, body_data, tags_data], [priority_targets, dept_targets])</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ã¾ãŸã¯è¾æ›¸ã®ã‚¿ãƒ—ãƒ«</font><font style="vertical-align: inherit;">ãŒè¿”ã•ã‚Œ</font></font><code>({'title': title_data, 'body': body_data, 'tags': tags_data}, {'priority': priority_targets, 'department': dept_targets})</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Resnetãƒ¢ãƒ‡ãƒ«ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¤‡æ•°ã®å…¥åŠ›ã¨å‡ºåŠ›ã‚’æŒã¤ãƒ¢ãƒ‡ãƒ«ã«åŠ ãˆã¦ã€Functional APIã¯ã€éç·šå½¢æ¥ç¶šã€ã¤ã¾ã‚Šãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒç›´åˆ—ã«æ¥ç¶šã•ã‚Œã¦ã„ãªã„ãƒ¢ãƒ‡ãƒ«ã®ãƒˆãƒãƒ­ã‚¸ã®æ“ä½œã‚’ç°¡ç´ åŒ–ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®ã‚ˆã†ãªãƒ¢ãƒ‡ãƒ«ã¯ã€ï¼ˆåå‰ãŒç¤ºã™ã‚ˆã†ã«ï¼‰ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«APIã‚’ä½¿ç”¨ã—ã¦å®Ÿè£…ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã›ã‚“ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã®ä¸€èˆ¬çš„ãªä½¿ç”¨ä¾‹ã¯ã€æ®‹ä½™æ¥ç¶šã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã‚’å®Ÿè¨¼ã™ã‚‹ãŸã‚ã«ã€CIFAR10ã®ResNetãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br>
<pre><code class="python hljs">inputs = keras.Input(shape=(<span class="hljs-number">32</span>, <span class="hljs-number">32</span>, <span class="hljs-number">3</span>), name=<span class="hljs-string">'img'</span>)<font></font>
x = layers.Conv2D(<span class="hljs-number">32</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>)(inputs)<font></font>
x = layers.Conv2D(<span class="hljs-number">64</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>)(x)<font></font>
block_1_output = layers.MaxPooling2D(<span class="hljs-number">3</span>)(x)<font></font>
<font></font>
x = layers.Conv2D(<span class="hljs-number">64</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>, padding=<span class="hljs-string">'same'</span>)(block_1_output)<font></font>
x = layers.Conv2D(<span class="hljs-number">64</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>, padding=<span class="hljs-string">'same'</span>)(x)<font></font>
block_2_output = layers.add([x, block_1_output])<font></font>
<font></font>
x = layers.Conv2D(<span class="hljs-number">64</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>, padding=<span class="hljs-string">'same'</span>)(block_2_output)<font></font>
x = layers.Conv2D(<span class="hljs-number">64</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>, padding=<span class="hljs-string">'same'</span>)(x)<font></font>
block_3_output = layers.add([x, block_2_output])<font></font>
<font></font>
x = layers.Conv2D(<span class="hljs-number">64</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>)(block_3_output)<font></font>
x = layers.GlobalAveragePooling2D()(x)<font></font>
x = layers.Dense(<span class="hljs-number">256</span>, activation=<span class="hljs-string">'relu'</span>)(x)<font></font>
x = layers.Dropout(<span class="hljs-number">0.5</span>)(x)<font></font>
outputs = layers.Dense(<span class="hljs-number">10</span>, activation=<span class="hljs-string">'softmax'</span>)(x)<font></font>
<font></font>
model = keras.Model(inputs, outputs, name=<span class="hljs-string">'toy_resnet'</span>)<font></font>
model.summary()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¢ãƒ‡ãƒ«ã‚°ãƒ©ãƒ•ã‚’æãã¾ã—ã‚‡ã†ï¼š</font></font><br>
<br>
<pre><code class="python hljs">keras.utils.plot_model(model, <span class="hljs-string">'mini_resnet.png'</span>, show_shapes=<span class="hljs-literal">True</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/qj/vi/bk/qjvibkpx9zrbp09rcfhj_drtlzc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦å½¼å¥³ã«æ•™ãˆã‚‹ï¼š</font></font><br>
<br>
<pre><code class="python hljs">(x_train, y_train), (x_test, y_test) = keras.datasets.cifar10.load_data()<font></font>
x_train = x_train.astype(<span class="hljs-string">'float32'</span>) / <span class="hljs-number">255.</span>
x_test = x_test.astype(<span class="hljs-string">'float32'</span>) / <span class="hljs-number">255.</span>
y_train = keras.utils.to_categorical(y_train, <span class="hljs-number">10</span>)<font></font>
y_test = keras.utils.to_categorical(y_test, <span class="hljs-number">10</span>)<font></font>
<font></font>
model.compile(optimizer=keras.optimizers.RMSprop(<span class="hljs-number">1e-3</span>),<font></font>
              loss=<span class="hljs-string">'categorical_crossentropy'</span>,<font></font>
              metrics=[<span class="hljs-string">'acc'</span>])<font></font>
model.fit(x_train, y_train,<font></font>
          batch_size=<span class="hljs-number">64</span>,<font></font>
          epochs=<span class="hljs-number">1</span>,<font></font>
          validation_split=<span class="hljs-number">0.2</span>)</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¬ã‚¤ãƒ¤ãƒ¼å…±æœ‰</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é–¢æ•°å‹APIã®ã‚‚ã†1ã¤ã®å„ªã‚ŒãŸä½¿ç”¨æ³•ã¯ã€ä¸€èˆ¬çš„ãªãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã§ã™ã€‚å…±é€šãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ã€åŒã˜ãƒ¢ãƒ‡ãƒ«ã§å†åˆ©ç”¨ã•ã‚Œã‚‹ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ã™ã€‚ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚°ãƒ©ãƒ•ã®è¤‡æ•°ã®ãƒ‘ã‚¹ã«é–¢é€£ã™ã‚‹ãƒ•ã‚£ãƒ¼ãƒãƒ£ã‚’èª¿æŸ»ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å…±é€šã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ã€åŒã˜ã‚¹ãƒšãƒ¼ã‚¹ã‹ã‚‰ï¼ˆãŸã¨ãˆã°ã€åŒã˜è¾æ›¸ã‚’æŒã¤2ã¤ã®ç•°ãªã‚‹ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰ï¼‰å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹ãŸã‚ã«ã‚ˆãä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ã€ã“ã‚Œã‚‰ã®ç•°ãªã‚‹ãƒ‡ãƒ¼ã‚¿é–“ã§æƒ…å ±ã‚’äº¤æ›ã—ã€å°‘ãªã„ãƒ‡ãƒ¼ã‚¿ã§ãã®ã‚ˆã†ãªãƒ¢ãƒ‡ãƒ«ã‚’ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã§ã™ã€‚ç‰¹å®šã®å˜èªãŒå…¥åŠ›ã®1ã¤ã«ç¾ã‚ŒãŸå ´åˆã€ã“ã‚Œã«ã‚ˆã‚Šã€ä¸€èˆ¬ãƒ¬ãƒ™ãƒ«ã‚’é€šéã™ã‚‹ã™ã¹ã¦ã®å…¥åŠ›ã§ã®å‡¦ç†ãŒå®¹æ˜“ã«ãªã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ©Ÿèƒ½APIã§ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®åŒã˜ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æ•°å›å‘¼ã³å‡ºã™ã ã‘ã§ã™ã€‚</font><font style="vertical-align: inherit;">ãŸã¨ãˆã°ã€ã“ã“ã§</font></font><code>Embedding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯2ã¤ã®ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ã§</font><font style="vertical-align: inherit;">ãƒ¬ã‚¤ãƒ¤ãƒ¼</font><font style="vertical-align: inherit;">ãŒå…±æœ‰ã•ã‚Œã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#   1000    128- </span>
shared_embedding = layers.Embedding(<span class="hljs-number">1000</span>, <span class="hljs-number">128</span>)<font></font>
<font></font>
<span class="hljs-comment">#    </span>
text_input_a = keras.Input(shape=(<span class="hljs-literal">None</span>,), dtype=<span class="hljs-string">'int32'</span>)<font></font>
<font></font>
<span class="hljs-comment">#    </span>
text_input_b = keras.Input(shape=(<span class="hljs-literal">None</span>,), dtype=<span class="hljs-string">'int32'</span>)<font></font>
<font></font>
<span class="hljs-comment">#          </span><font></font>
encoded_input_a = shared_embedding(text_input_a)<font></font>
encoded_input_b = shared_embedding(text_input_b)</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚°ãƒ©ãƒ•å†…ã®ãƒãƒ¼ãƒ‰ã®å–å¾—ã¨å†åˆ©ç”¨ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Functional APIã§æ“ä½œã™ã‚‹ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚°ãƒ©ãƒ•ã¯é™çš„ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã‚ã‚‹ãŸã‚ã€ãã‚Œã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ç¢ºèªã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€ãŸã¨ãˆã°ç”»åƒã®å½¢å¼ã§æ©Ÿèƒ½ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹æ–¹æ³•ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãŸã€ä¸­é–“å±¤ï¼ˆã‚°ãƒ©ãƒ•ã®ã€Œãƒãƒ¼ãƒ‰ã€ï¼‰ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã€ä»–ã®å ´æ‰€ã§ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€ãŸã¨ãˆã°ã€ç‰¹æ€§ã®æŠ½å‡ºã«éå¸¸ã«å½¹ç«‹ã¡ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¾‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€ImageNetã§äº‹å‰ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã•ã‚ŒãŸã‚¹ã‚±ãƒ¼ãƒ«ã‚’å‚™ãˆãŸVGG19ãƒ¢ãƒ‡ãƒ«ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> tensorflow.keras.applications <span class="hljs-keyword">import</span> VGG19<font></font>
<font></font>
vgg19 = VGG19()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦ã€ã“ã‚Œã‚‰ã¯ã€ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’ã‚¯ã‚¨ãƒªã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦å–å¾—ã•ã‚Œã‚‹ä¸­é–“ãƒ¢ãƒ‡ãƒ«ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">features_list = [layer.output <span class="hljs-keyword">for</span> layer <span class="hljs-keyword">in</span> vgg19.layers]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã‚‰ã®æ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ã¦ã€ä¸­é–“ãƒ¬ãƒ™ãƒ«ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ã‚·ãƒ§ãƒ³å€¤ã‚’è¿”ã™æ–°ã—ã„æ©Ÿèƒ½æŠ½å‡ºãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã§ãã¾ã™-ã™ã¹ã¦3è¡Œã§å®Ÿè¡Œã§ãã¾ã™</font></font><br>
 <br>
<pre><code class="python hljs">feat_extraction_model = keras.Model(inputs=vgg19.input, outputs=features_list)<font></font>
<font></font>
img = np.random.random((<span class="hljs-number">1</span>, <span class="hljs-number">224</span>, <span class="hljs-number">224</span>, <span class="hljs-number">3</span>)).astype(<span class="hljs-string">'float32'</span>)<font></font>
extracted_features = feat_extraction_model(img)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã¯ã€ä»–ã®å ´åˆã¨åŒæ§˜ã«ã€ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ã‚¹ã‚¿ã‚¤ãƒ«ã®è»¢é€ã‚’å®Ÿè£…ã™ã‚‹å ´åˆã«ä¾¿åˆ©ã§ã™ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚«ã‚¹ã‚¿ãƒ ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä½œæˆã—ã¦APIã‚’æ‹¡å¼µã™ã‚‹</font></font></h2><br>
<code>tf.keras</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹…åºƒã„çµ„ã¿è¾¼ã¿ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚ ï¼šã“ã“ã§ã¯ã„ãã¤ã‹ã®ä¾‹ã§ã‚ã‚Šã€</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚³ãƒ³ãƒœãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã¯ï¼š</font></font><code>Conv1D</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€</font></font><code>Conv2D</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€</font></font><code>Conv3D</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€</font></font><code>Conv2DTranspose</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,,ãªã©</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ—ãƒ¼ãƒ«ï¼š</font></font><code>MaxPooling1D</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€</font></font><code>MaxPooling2D</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€</font></font><code>MaxPooling3D</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€</font></font><code>AveragePooling1D</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,,ãªã©</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¬ã‚¤ãƒ¤ãƒ¼RNNï¼š ã€</font><font style="vertical-align: inherit;">ã€</font></font><code>GRU</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> </font><font style="vertical-align: inherit;">,,ãªã©</font><font style="vertical-align: inherit;">ã€</font><font style="vertical-align: inherit;">ã€</font><font style="vertical-align: inherit;">,,ç­‰</font><font style="vertical-align: inherit;">
å¿…è¦ãªã‚‚ã®ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ã€ç‹¬è‡ªã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä½œæˆã™ã‚‹ã“ã¨ã§ã€APIã‚’ç°¡å˜ã«æ‹¡å¼µã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">
ã™ã¹ã¦ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ã€ã‚¯ãƒ©ã‚¹</font><font style="vertical-align: inherit;">ã‚’</font><font style="vertical-align: inherit;">ã‚µãƒ–ã‚¯ãƒ©ã‚¹åŒ–ã—ã¦</font><font style="vertical-align: inherit;">å®Ÿè£…ã—ã¾ã™</font><font style="vertical-align: inherit;">ã€‚ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«ã‚ˆã£ã¦å®Ÿè¡Œã•ã‚Œã‚‹è¨ˆç®—ã‚’æ±ºå®š</font><font style="vertical-align: inherit;">
ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ã‚¦ã‚§ã‚¤ãƒˆã‚’ä½œæˆ</font><font style="vertical-align: inherit;">
ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰</font><font style="vertical-align: inherit;">ï¼ˆã“ã‚Œã¯å˜ãªã‚‹ã‚¹ã‚¿ã‚¤ãƒ«ã®è¦å‰‡ã§ã™ã€‚ã‚¦ã‚§ã‚¤ãƒˆã¯ã§ä½œæˆã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™</font><font style="vertical-align: inherit;">ï¼‰ã€‚</font><font style="vertical-align: inherit;">
ç°¡å˜ãª</font><font style="vertical-align: inherit;">ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®</font><font style="vertical-align: inherit;">å®Ÿè£…ã¯</font><font style="vertical-align: inherit;">æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚</font></font><code>LSTM</code><font style="vertical-align: inherit;"></font><code>ConvLSTM2D</code><font style="vertical-align: inherit;"></font><br>
<code>BatchNormalization</code><font style="vertical-align: inherit;"></font><code>Dropout</code><font style="vertical-align: inherit;"></font><code>Embedding</code><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><code>Layer</code><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><code>call</code><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><code>build</code><font style="vertical-align: inherit;"></font><code>__init__</code><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><code>Dense</code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomDense</span>(<span class="hljs-params">layers.Layer</span>):</span><font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, units=<span class="hljs-number">32</span></span>):</span><font></font>
    super(CustomDense, self).__init__()<font></font>
    self.units = units<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build</span>(<span class="hljs-params">self, input_shape</span>):</span>
    self.w = self.add_weight(shape=(input_shape[<span class="hljs-number">-1</span>], self.units),<font></font>
                             initializer=<span class="hljs-string">'random_normal'</span>,<font></font>
                             trainable=<span class="hljs-literal">True</span>)<font></font>
    self.b = self.add_weight(shape=(self.units,),<font></font>
                             initializer=<span class="hljs-string">'random_normal'</span>,<font></font>
                             trainable=<span class="hljs-literal">True</span>)<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call</span>(<span class="hljs-params">self, inputs</span>):</span>
    <span class="hljs-keyword">return</span> tf.matmul(inputs, self.w) + self.b<font></font>
<font></font>
inputs = keras.Input((<span class="hljs-number">4</span>,))<font></font>
outputs = CustomDense(<span class="hljs-number">10</span>)(inputs)<font></font>
<font></font>
model = keras.Model(inputs, outputs)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚«ã‚¹ã‚¿ãƒ ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§ã‚·ãƒªã‚¢ãƒ«åŒ–ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</font></font><code>get_config</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å ´åˆã¯ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãƒ¼å¼•æ•°ã‚’è¿”ã™</font><font style="vertical-align: inherit;">ãƒ¡ã‚½ãƒƒãƒ‰ã‚‚å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚Š</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomDense</span>(<span class="hljs-params">layers.Layer</span>):</span><font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, units=<span class="hljs-number">32</span></span>):</span><font></font>
    super(CustomDense, self).__init__()<font></font>
    self.units = units<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build</span>(<span class="hljs-params">self, input_shape</span>):</span>
    self.w = self.add_weight(shape=(input_shape[<span class="hljs-number">-1</span>], self.units),<font></font>
                             initializer=<span class="hljs-string">'random_normal'</span>,<font></font>
                             trainable=<span class="hljs-literal">True</span>)<font></font>
    self.b = self.add_weight(shape=(self.units,),<font></font>
                             initializer=<span class="hljs-string">'random_normal'</span>,<font></font>
                             trainable=<span class="hljs-literal">True</span>)<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call</span>(<span class="hljs-params">self, inputs</span>):</span>
    <span class="hljs-keyword">return</span> tf.matmul(inputs, self.w) + self.b<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_config</span>(<span class="hljs-params">self</span>):</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'units'</span>: self.units}<font></font>
<font></font>
<font></font>
inputs = keras.Input((<span class="hljs-number">4</span>,))<font></font>
outputs = CustomDense(<span class="hljs-number">10</span>)(inputs)<font></font>
<font></font>
model = keras.Model(inputs, outputs)<font></font>
config = model.get_config()<font></font>
<font></font>
new_model = keras.Model.from_config(<font></font>
    config, custom_objects={<span class="hljs-string">'CustomDense'</span>: CustomDense})</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã€</font></font><code>from_config (cls, config)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ§‹æˆãƒ‡ã‚£ã‚¯ã‚·ãƒ§ãƒŠãƒªã‚’æŒ‡å®šã—ã¦ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®å†ä½œæˆã‚’æ‹…å½“</font><font style="vertical-align: inherit;">ã™ã‚‹ã‚¯ãƒ©ã‚¹ãƒ¡ã‚½ãƒƒãƒ‰</font><font style="vertical-align: inherit;">ã‚’</font><font style="vertical-align: inherit;">å®Ÿè£…ã™ã‚‹ã“ã¨ã‚‚ã§ã</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®å®Ÿè£…</font></font><code>from_config</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">from_config</span>(<span class="hljs-params">cls, config</span>):</span>
  <span class="hljs-keyword">return</span> cls(**config)</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é–¢æ•°å‹APIã‚’ä½¿ç”¨ã™ã‚‹å ´åˆ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Functional APIã‚’ä½¿ç”¨ã—ã¦æ–°ã—ã„ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆ</font></font><code>Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã™ã‚‹ã‹ã€ç›´æ¥</font><font style="vertical-align: inherit;">ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã™ã‚‹ã»ã†ãŒã‚ˆã„å ´åˆã‚’åˆ¤æ–­ã™ã‚‹ã«ã¯ã©ã†ã™ã‚Œã°ã‚ˆã„</font><font style="vertical-align: inherit;">ã§ã™ã‹ï¼Ÿ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€èˆ¬ã«ã€Functional APIã¯ã‚ˆã‚Šé«˜ãƒ¬ãƒ™ãƒ«ã§ä½¿ã„ã‚„ã™ã„ã‚‚ã®ã§ã‚ã‚Šã€ã‚µãƒ–ã‚¯ãƒ©ã‚¹åŒ–ã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«ã§ã¯ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„å¤šæ•°ã®é–¢æ•°ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãŸã ã—ã€ãƒ¢ãƒ‡ãƒ«ã‚’ã‚µãƒ–ã‚¯ãƒ©ã‚¹åŒ–ã™ã‚‹ã¨ã€å±¤ã®æœ‰å‘éå¾ªç’°ã‚°ãƒ©ãƒ•ã¨ã—ã¦ç°¡å˜ã«èª¬æ˜ã§ããªã„ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã™ã‚‹ã¨ãã«å¤§ããªæŸ”è»Ÿæ€§ãŒå¾—ã‚‰ã‚Œã¾ã™ï¼ˆãŸã¨ãˆã°ã€Functional APIã§Tree-RNNã‚’å®Ÿè£…ã§ããªã„ãŸã‚ã€ç›´æ¥ã‚µãƒ–ã‚¯ãƒ©ã‚¹åŒ–ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™</font></font><code>Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ©Ÿèƒ½APIã®é•·æ‰€ï¼š</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»¥ä¸‹ã«ç¤ºã™ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ã™ã¹ã¦ã€ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ãƒ¢ãƒ‡ãƒ«ï¼ˆãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã‚‚ã‚ã‚Šã¾ã™ï¼‰ã«å½“ã¦ã¯ã¾ã‚Šã¾ã™ãŒã€ã‚µãƒ–ã‚¯ãƒ©ã‚¹ãƒ¢ãƒ‡ãƒ«ï¼ˆãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã¯ãªãPythonã‚³ãƒ¼ãƒ‰ã§ã™ï¼‰ã«ã‚‚å½“ã¦ã¯ã¾ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Functional APIã¯ã€ã‚ˆã‚ŠçŸ­ã„ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—ã¾ã™ã€‚</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã„ã„ãˆ</font></font><code>super(MyClass, self).__init__(...)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ã„ã„ãˆ</font></font><code>def call(self, ...):</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ãªã© </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¯”è¼ƒï¼š</font></font><br>
<br>
<pre><code class="python hljs">inputs = keras.Input(shape=(<span class="hljs-number">32</span>,))<font></font>
x = layers.Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">'relu'</span>)(inputs)<font></font>
outputs = layers.Dense(<span class="hljs-number">10</span>)(x)<font></font>
mlp = keras.Model(inputs, outputs)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚µãƒ–ã‚¯ãƒ©ã‚¹åŒ–ã•ã‚ŒãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®å ´åˆï¼š</font></font><br>
 <br>
<pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MLP</span>(<span class="hljs-params">keras.Model</span>):</span><font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, **kwargs</span>):</span><font></font>
    super(MLP, self).__init__(**kwargs)<font></font>
    self.dense_1 = layers.Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">'relu'</span>)<font></font>
    self.dense_2 = layers.Dense(<span class="hljs-number">10</span>)<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call</span>(<span class="hljs-params">self, inputs</span>):</span><font></font>
    x = self.dense_1(inputs)<font></font>
    <span class="hljs-keyword">return</span> self.dense_2(x)<font></font>
<font></font>
<span class="hljs-comment">#   .</span><font></font>
mlp = MLP()<font></font>
<span class="hljs-comment">#    .</span>
<span class="hljs-comment">#            .</span>
_ = mlp(tf.zeros((<span class="hljs-number">1</span>, <span class="hljs-number">32</span>))) </code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½œæˆæ™‚ã«ãƒ¢ãƒ‡ãƒ«ãŒæ¤œè¨¼ã•ã‚Œã¾ã™ã€‚</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é–¢æ•°å‹APIã§ã¯ã€å…¥åŠ›ä»•æ§˜ï¼ˆå½¢çŠ¶ã¨dtypeï¼‰ãŒäº‹å‰ã«ï¼ˆ `Input`ã‚’ä»‹ã—ã¦ï¼‰ä½œæˆã•ã‚Œã€ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’å‘¼ã³å‡ºã™ãŸã³ã«ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯æ¸¡ã•ã‚ŒãŸä»•æ§˜ãŒæƒ³å®šã¨ä¸€è‡´ã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚ãã†ã§ãªã„å ´åˆã€æœ‰ç”¨ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã«ã‚ˆã‚Šã€Functional APIã‚’ä½¿ç”¨ã—ã¦ä½œæˆã—ãŸãƒ¢ãƒ‡ãƒ«ãŒç¢ºå®Ÿã«èµ·å‹•ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã™ã¹ã¦ã®ãƒ‡ãƒãƒƒã‚°ï¼ˆåæŸãƒ‡ãƒãƒƒã‚°ã«é–¢é€£ã—ãªã„ï¼‰ã¯ã€å®Ÿè¡Œæ™‚ã§ã¯ãªãã€ãƒ¢ãƒ‡ãƒ«æ§‹ç¯‰ä¸­ã«é™çš„ã«ç™ºç”Ÿã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã§ã®å‹ãƒã‚§ãƒƒã‚¯ã«ä¼¼ã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ©Ÿèƒ½ãƒ¢ãƒ‡ãƒ«ã¯ã‚°ãƒ©ãƒ•ã‚£ã‚«ãƒ«ã«è¡¨ç¾ã§ãã€ãƒ†ã‚¹ãƒˆã‚‚å¯èƒ½ã§ã™ã€‚</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‰ã®ä¾‹ã§è¦‹ãŸã‚ˆã†ã«ã€ãƒ¢ãƒ‡ãƒ«ã‚’ã‚°ãƒ©ãƒ•ã®å½¢ã§æç”»ã§ãã€ãŸã¨ãˆã°ã€ã‚°ãƒ©ãƒ•ã®ä¸­é–“ãƒãƒ¼ãƒ‰ã«ç°¡å˜ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã€ä¸­é–“å±¤ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ã‚’æŠ½å‡ºã—ã¦å†åˆ©ç”¨ã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">features_list = [layer.output for layer in vgg19.layers]<font></font>
feat_extraction_model = keras.Model(inputs=vgg19.input, outputs=features_list)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ©Ÿèƒ½ãƒ¢ãƒ‡ãƒ«ã¯ã‚³ãƒ¼ãƒ‰ã®ä¸€éƒ¨ã¨ã„ã†ã‚ˆã‚Šãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã‚ã‚‹ãŸã‚ã€å®‰å…¨ã«ã‚·ãƒªã‚¢ãƒ«åŒ–ã§ãã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã›ãšã«ã¾ã£ãŸãåŒã˜ãƒ¢ãƒ‡ãƒ«ã‚’å†ä½œæˆã§ãã‚‹å˜ä¸€ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜ã§ãã¾ã™ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ©Ÿèƒ½çš„ãªAPIã®å¼±ç‚¹</font></font></h3><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‹•çš„ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ©Ÿèƒ½APIã¯ã€ãƒ¢ãƒ‡ãƒ«ã‚’DAGãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã—ã¦å‡¦ç†ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯ã»ã¨ã‚“ã©ã®ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«å½“ã¦ã¯ã¾ã‚Šã¾ã™ãŒã€ã™ã¹ã¦ã®äººã«å½“ã¦ã¯ã¾ã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãŸã¨ãˆã°ã€å†å¸°ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚„ãƒ„ãƒªãƒ¼RNNã¯ã“ã®å‰æã‚’æº€ãŸã—ã¦ã„ãªã„ãŸã‚ã€Functional APIã«å®Ÿè£…ã§ãã¾ã›ã‚“ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å ´åˆã«ã‚ˆã£ã¦ã¯ã€ã™ã¹ã¦ã‚’æœ€åˆã‹ã‚‰ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é«˜åº¦ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’ä½œæˆã™ã‚‹ã¨ãã¯ã€ã€ŒDAGãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å®šç¾©ã€ã‚’è¶…ãˆã¦ä½•ã‹ã‚’å®Ÿè¡Œã—ãŸã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ãŸã¨ãˆã°ã€ãƒ¢ãƒ‡ãƒ«ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ã„ãã¤ã‹ã®ã‚«ã‚¹ã‚¿ãƒ ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãŠã‚ˆã³å‡ºåŠ›ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã«ã¯ã‚µãƒ–ã‚¯ãƒ©ã‚¹åŒ–ãŒå¿…è¦ã§ã™ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã•ã¾ã–ã¾ãªAPIã‚¹ã‚¿ã‚¤ãƒ«ã®çµ„ã¿åˆã‚ã›</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é–¢æ•°å‹APIã¨ãƒ¢ãƒ‡ãƒ«ã®ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã®ã©ã¡ã‚‰ã‚’é¸æŠã™ã‚‹ã‹ã¯ã€ãƒ¢ãƒ‡ãƒ«ã®1ã¤ã®ã‚«ãƒ†ã‚´ãƒªã«é™å®šã™ã‚‹ãƒã‚¤ãƒŠãƒªã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ãªã„ã“ã¨ã«æ³¨æ„ã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚</font><font style="vertical-align: inherit;">tf.keras APIã®ã™ã¹ã¦ã®ãƒ¢ãƒ‡ãƒ«ã¯ã€ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ãƒ¢ãƒ‡ãƒ«ã€æ©Ÿèƒ½ãƒ¢ãƒ‡ãƒ«ã€ã¾ãŸã¯ã‚µãƒ–ã‚¯ãƒ©ã‚¹åŒ–ã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«/ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ã‚¼ãƒ­ã‹ã‚‰ä½œæˆã—ãŸã‚‚ã®ã§ã‚ã£ã¦ã‚‚ã€ç›¸äº’ã«å¯¾è©±ã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚µãƒ–ã‚¯ãƒ©ã‚¹åŒ–ã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«/ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ä¸€éƒ¨ã¨ã—ã¦ã€ã„ã¤ã§ã‚‚æ©Ÿèƒ½ãƒ¢ãƒ‡ãƒ«ã¾ãŸã¯ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">units = <span class="hljs-number">32</span>
timesteps = <span class="hljs-number">10</span>
input_dim = <span class="hljs-number">5</span><font></font>
<font></font>
<span class="hljs-comment"># Define a Functional model</span>
inputs = keras.Input((<span class="hljs-literal">None</span>, units))<font></font>
x = layers.GlobalAveragePooling1D()(inputs)<font></font>
outputs = layers.Dense(<span class="hljs-number">1</span>, activation=<span class="hljs-string">'sigmoid'</span>)(x)<font></font>
model = keras.Model(inputs, outputs)<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomRNN</span>(<span class="hljs-params">layers.Layer</span>):</span><font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><font></font>
    super(CustomRNN, self).__init__()<font></font>
    self.units = units<font></font>
    self.projection_1 = layers.Dense(units=units, activation=<span class="hljs-string">'tanh'</span>)<font></font>
    self.projection_2 = layers.Dense(units=units, activation=<span class="hljs-string">'tanh'</span>)
    <span class="hljs-comment"># Our previously-defined Functional model</span><font></font>
    self.classifier = model<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call</span>(<span class="hljs-params">self, inputs</span>):</span><font></font>
    outputs = []<font></font>
    state = tf.zeros(shape=(inputs.shape[<span class="hljs-number">0</span>], self.units))
    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> range(inputs.shape[<span class="hljs-number">1</span>]):<font></font>
      x = inputs[:, t, :]<font></font>
      h = self.projection_1(x)<font></font>
      y = h + self.projection_2(state)<font></font>
      state = y<font></font>
      outputs.append(y)<font></font>
    features = tf.stack(outputs, axis=<span class="hljs-number">1</span>)<font></font>
    print(features.shape)<font></font>
    <span class="hljs-keyword">return</span> self.classifier(features)<font></font>
<font></font>
rnn_model = CustomRNN()<font></font>
_ = rnn_model(tf.zeros((<span class="hljs-number">1</span>, timesteps, input_dim)))
 </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é€†ã«ã€</font></font><code>call</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¬¡ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã„ãšã‚Œã‹ã«ä¸€è‡´</font><font style="vertical-align: inherit;">ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ã™ã‚‹å ´åˆã¯ã€Functional APIã§ã‚µãƒ–ã‚¯ãƒ©ã‚¹åŒ–ã•ã‚ŒãŸãƒ¬ã‚¤ãƒ¤ãƒ¼ã¾ãŸã¯ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã§ãã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<code>call(self, inputs, **kwargs)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã“</font></font><code>inputs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§ã€ã¯ãƒ†ãƒ³ã‚½ãƒ«ã¾ãŸã¯ãƒã‚¹ãƒˆã•ã‚ŒãŸãƒ†ãƒ³ã‚½ãƒ«æ§‹é€ ï¼ˆãŸã¨ãˆã°ã€ãƒ†ãƒ³ã‚½ãƒ«ã®ãƒªã‚¹ãƒˆï¼‰ã€ãŠã‚ˆã³</font></font><code>**kwargs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯éãƒ†ãƒ³ã‚½ãƒ«å¼•æ•°ï¼ˆå…¥åŠ›ã§ã¯ãªã„ï¼‰ã§ã™ã€‚ ã€‚</font></font><br>
<code>call(self, inputs, training=None, **kwargs)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">where </font></font><code>training</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼ã€å­¦ç¿’ã€å‡ºåŠ›ãŒã©ã®ãƒ¢ãƒ¼ãƒ‰ã§å‹•ä½œã™ã‚‹ã‹ã‚’ç¤ºã™ãƒ–ãƒ¼ãƒ«å€¤ã§ã™ã€‚</font></font><br>
<code>call(self, inputs, mask=None, **kwargs)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã“</font></font><code>mask</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§ã€ãƒ–ãƒ¼ãƒ«ãƒã‚¹ã‚¯ãƒ†ãƒ³ã‚½ãƒ«ã§ã™ï¼ˆãŸã¨ãˆã°ã€RNNã«å½¹ç«‹ã¡ã¾ã™ï¼‰ã€‚</font></font><br>
<code>call(self, inputs, training=None, mask=None, **kwargs)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ã‚‚ã¡ã‚ã‚“ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å‹•ä½œã‚’åŒæ™‚ã«å®šç¾©ã™ã‚‹ä¸¡æ–¹ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’æŒã¤ã“ã¨ãŒã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã•ã‚‰ã«ã€ã‚«ã‚¹ã‚¿ãƒ ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¾ãŸã¯ãƒ¢ãƒ‡ãƒ«ã« `get_config`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ã™ã‚‹å ´åˆã€ãã‚Œã‚’ä½¿ç”¨ã—ã¦ä½œæˆã™ã‚‹æ©Ÿèƒ½ãƒ¢ãƒ‡ãƒ«ã¯ã‚·ãƒªã‚¢ãƒ«åŒ–å¯èƒ½ã§ã‚ã‚Šã€è¤‡è£½ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»¥ä¸‹ã¯ã€ã‚¼ãƒ­ã‹ã‚‰ä½œæˆã•ã‚ŒãŸã‚«ã‚¹ã‚¿ãƒ RNNã‚’ä½¿ç”¨ã™ã‚‹å°ã•ãªä¾‹ã§ã™æ©Ÿèƒ½ãƒ¢ãƒ‡ãƒ«ï¼š</font></font><br>
<br>
<pre><code class="python hljs">units = <span class="hljs-number">32</span>
timesteps = <span class="hljs-number">10</span>
input_dim = <span class="hljs-number">5</span>
batch_size = <span class="hljs-number">16</span><font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomRNN</span>(<span class="hljs-params">layers.Layer</span>):</span><font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><font></font>
    super(CustomRNN, self).__init__()<font></font>
    self.units = units<font></font>
    self.projection_1 = layers.Dense(units=units, activation=<span class="hljs-string">'tanh'</span>)<font></font>
    self.projection_2 = layers.Dense(units=units, activation=<span class="hljs-string">'tanh'</span>)<font></font>
    self.classifier = layers.Dense(<span class="hljs-number">1</span>, activation=<span class="hljs-string">'sigmoid'</span>)<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call</span>(<span class="hljs-params">self, inputs</span>):</span><font></font>
    outputs = []<font></font>
    state = tf.zeros(shape=(inputs.shape[<span class="hljs-number">0</span>], self.units))
    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> range(inputs.shape[<span class="hljs-number">1</span>]):<font></font>
      x = inputs[:, t, :]<font></font>
      h = self.projection_1(x)<font></font>
      y = h + self.projection_2(state)<font></font>
      state = y<font></font>
      outputs.append(y)<font></font>
    features = tf.stack(outputs, axis=<span class="hljs-number">1</span>)
    <span class="hljs-keyword">return</span> self.classifier(features)<font></font>
<font></font>
<span class="hljs-comment">#          </span>
<span class="hljs-comment">#  `batch_shape`,     `CustomRNN`  </span>
<span class="hljs-comment">#    (     `state`).</span><font></font>
inputs = keras.Input(batch_shape=(batch_size, timesteps, input_dim))<font></font>
x = layers.Conv1D(<span class="hljs-number">32</span>, <span class="hljs-number">3</span>)(inputs)<font></font>
outputs = CustomRNN()(x)<font></font>
<font></font>
model = keras.Model(inputs, outputs)<font></font>
<font></font>
rnn_model = CustomRNN()<font></font>
_ = rnn_model(tf.zeros((<span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">5</span>)))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã§ã€Functional APIã‚¬ã‚¤ãƒ‰ã¯çµ‚äº†ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã§ã€ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã®å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã‚»ãƒƒãƒˆãŒæ‰‹ã«å…¥ã‚Šã¾ã—ãŸã€‚</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¤œè¨¼å¾Œã€ç¿»è¨³ã¯Tensorflow.orgã«ã‚‚è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">Tensorflow.orgã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒ­ã‚·ã‚¢èªã¸ã®ç¿»è¨³ã«å‚åŠ ã—ãŸã„å ´åˆã¯ã€å€‹äººã¾ãŸã¯ã‚³ãƒ¡ãƒ³ãƒˆã§ã”é€£çµ¡ãã ã•ã„ã€‚</font><font style="vertical-align: inherit;">ä¿®æ­£ã‚„ã‚³ãƒ¡ãƒ³ãƒˆã¯ã‚ã‚ŠãŒãŸã„ã§ã™ã€‚</font><font style="vertical-align: inherit;">ä¾‹ã¨ã—ã¦ã€æœ‰å‘éå¾ªç’°ã‚°ãƒ©ãƒ•ã§ã‚‚ã‚ã‚‹GoogLeNetãƒ¢ãƒ‡ãƒ«ã®ç”»åƒã‚’ä½¿ç”¨ã—ã¾ã—ãŸã€‚</font></font></i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja483652/index.html">å¯èƒ½ã§ã‚ã‚Œã°ç§ã«å˜˜ã‚’ã¤ãï¼šç¤¾ä¼šæŠ€è¡“çš„ãƒšãƒ³ãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½ã™ã‚‹æ©Ÿèƒ½</a></li>
<li><a href="../ja483654/index.html">é›†ä¼šã§ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¯1å¯¾1ã§ã€ãªãœã†ã¾ãã„ã‹ãªã„ã®ã‹ã€ã©ã†ã‚„ã£ã¦ãã‚Œã‚’ä¿®æ­£ã—ã‚ˆã†ã¨ã™ã‚‹ã®ã‹ï¼Ÿ</a></li>
<li><a href="../ja483656/index.html">å°å£²ã§ã®Tableauã§ã™ã‹ï¼Ÿ</a></li>
<li><a href="../ja483660/index.html">ã‚¤ãƒ³ãƒ•ãƒ©ç®¡ç†ç”¨ã®é›»å ±ãƒœãƒƒãƒˆ</a></li>
<li><a href="../ja483662/index.html">Cisco Threat Responseã¨Cisco Stealthwatch Enterpriseã®çµ±åˆ</a></li>
<li><a href="../ja483666/index.html">Volodyaã¨ã‚ªã‚¾ãƒ³ç™ºç”Ÿå™¨ã«ã¤ã„ã¦</a></li>
<li><a href="../ja483668/index.html">å…ˆé€±ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ä¸–ç•Œã‹ã‚‰ã®æ–°é®®ãªé£Ÿæã®ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆNo. 397ï¼ˆ2020å¹´1æœˆ6æ—¥ã€œ12æ—¥ï¼‰</a></li>
<li><a href="../ja483670/index.html">MACã‚¢ãƒ‰ãƒ¬ã‚¹ã«ã¤ã„ã¦çŸ¥ã‚ŠãŸã„ã™ã¹ã¦</a></li>
<li><a href="../ja483674/index.html">ãƒã‚¤ãƒŠãƒªãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ä»•çµ„ã¿ã¨ã€2020å¹´ã«æ™®åŠã™ã‚‹ç†ç”±</a></li>
<li><a href="../ja483676/index.html">ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ã®ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°åˆ†æã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…ã®æœ‰åŠ¹æ€§ã¨ã‚³ã‚¹ãƒˆã®è©•ä¾¡</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>