<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⬜️ 👘 🕑 Offre à Londres en une journée: comment l'obtenir et quoi faire après un déménagement 🚕 🏇🏽 🤹🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr! 
 
 Nous avons de grands projets pour 2020. Nous avons l'intention de développer activement Badoo et Bumble, nous élargissons donc séri...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Offre à Londres en une journée: comment l'obtenir et quoi faire après un déménagement</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/badoo/blog/487914/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonjour, Habr! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons de grands projets pour 2020. Nous avons l'intention de développer activement Badoo et Bumble, nous élargissons donc sérieusement l'équipe technique. Et aujourd'hui, nous annonçons l'embauche massive de développeurs PHP dans notre bureau de Londres.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En 2017, nous avons essayé un nouveau format de recherche - événement d'embauche: nous amenons des développeurs sympas à Moscou, réalisons des entretiens en une journée et faisons immédiatement une offre aux candidats appropriés. Bien entendu, toutes les dépenses pour un voyage dans la capitale sont engagées. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le format a bien fonctionné, et nous avons à nouveau de nombreux postes ouverts, nous annonçons donc un nouvel événement d'embauche PHP.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les règles sont les mêmes: afficher un résultat de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">test</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> élevé </font><font style="vertical-align: inherit;">avant le 1er mars, passer avec succès l'entretien le 21 ou 22 mars à Moscou - et recevoir le même jour une offre au bureau de Badoo à Londres.&nbsp;</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD: le test est terminé, merci à tous les participants! </font><font style="vertical-align: inherit;">Nous avons déjà notifié les finalistes et averti que les dates de l'entretien sont reportées sine die pour le confort et la sécurité des candidats. </font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/ms/iu/2b/msiu2bgffxdkk5nkvcxak2v77ns.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sous la coupe, je vais vous dire:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en savoir plus sur le test;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans quels projets nous sommes engagés: optimisation de photos, streaming vidéo, apprentissage automatique pour les lettres, transition vers de nouvelles versions de PHP et bien plus encore.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous êtes un shnik PHP et que vous souhaitez déménager à Londres, bienvenue chez kat!</font></font><br>
<br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment réussir le test</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le test</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comprend cinq tâches. Exactement 90 minutes sont allouées à la décision: cela ne fonctionnera pas pour retarder ou interrompre le processus. Avant de commencer, assurez-vous d'avoir suffisamment de temps.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans trois tâches, vous devez écrire du code / des requêtes SQL, et dans les deux autres, nous nous attendons à voir des réponses détaillées aux questions. Test publié sur HackerRank. Nous vous recommandons de vous entraîner sur les tâches de test de la plateforme afin de vous familiariser avec l'interface.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les décisions sont prises jusqu'au 2020-03-01 23:59:59 UTC. Sur la base des résultats du test, nous sélectionnerons environ 60 candidats que nous inviterons à Moscou pour un entretien.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La société prend en charge toutes les dépenses liées à un voyage à Moscou, ainsi que les dépenses liées au déménagement à Londres. </font><font style="vertical-align: inherit;">Nous aidons à obtenir des visas de travail pour les membres de la famille de notre nouveau collègue, payons le vol, louons une maison pour la durée de la recherche, payons une prime en espèces pour le déménagement et aidons à améliorer l'anglais. </font><font style="vertical-align: inherit;">Vous pouvez vous familiariser avec l'équipe dès le stade de l'entretien: les développeurs eux-mêmes conduisent des entretiens lors de la location.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce que fait l'équipe de développement du serveur&nbsp;</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous sommes responsables du backend des services de rencontres Badoo et Bumble. </font><font style="vertical-align: inherit;">En plus de balayer vers la gauche et la droite pour trouver un partenaire, les applications ont le streaming vidéo, le chat avec des messages audio, la recherche de personnes à proximité, l'intégration avec les services de paiement et bien plus encore. </font><font style="vertical-align: inherit;">Une interface relativement simple cache beaucoup de logique en PHP et Go (et cela devient de plus en plus).&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre équipe compte plus de 40 personnes. </font><font style="vertical-align: inherit;">Le travail peut être divisé en deux grandes parties:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nouvelles fonctionnalités dans les applications,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">projets techniques - amélioration des outils, optimisation, travail avec dette technique.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je vais parler des projets les plus intéressants que nous avons mis en œuvre au cours des deux dernières années.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chips fraîches dans le produit</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le marché des applications de rencontres est dynamique et compétitif, notre objectif principal est donc le développement du produit: il doit rester intéressant et sûr pour les utilisateurs.&nbsp;</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'ai appris à cacher des photos trop «personnelles»</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Certains utilisateurs envoient des photos de chat à caractère érotique, même si l'interlocuteur n'a pas demandé de tels cadeaux.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La tâche que nous devions résoudre était d'enseigner à l'application à distinguer les photos «privées» (18+) des photos ordinaires et à les montrer discutées dans le chat, permettant au destinataire de décider lui-même s'il voulait les voir dans leur intégralité.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En collaboration avec l'équipe R&amp;D, nous avons créé un service on Go avec un réseau de neurones qui peut reconnaître des photos "privées". </font><font style="vertical-align: inherit;">Si la probabilité que la photo soit érotique soit supérieure au seuil défini, un indicateur spécial est placé dans le message et le client gère cette situation en conséquence: affiche un talon flou demandant si le destinataire veut voir ce qu'il y a à l'intérieur.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous exécutons toutes les tâches à travers des tests A / B, et couvrons également soigneusement les points clés de la nouvelle fonctionnalité avec des statistiques. </font><font style="vertical-align: inherit;">Ainsi, nous avons découvert qu'environ 200 000 photos par jour sont envoyées par jour et que - souvent, ces photos sont toujours vues et ne se plaignent pas de l'expéditeur.&nbsp;&nbsp;</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajout de messages de chat audio et vidéo</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au cours des deux dernières années, nous avons élaboré des fonctionnalités pour les messagers avancés et donné aux utilisateurs la possibilité d'échanger des messages multimédias. </font><font style="vertical-align: inherit;">L'implémentation de cette option côté serveur a été assez simple grâce à l'architecture flexible de l'API mobile et de son propre CDN. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la conception de messages multimédias dans le chat, nous avons transféré le téléchargement de fichiers de l'API client-serveur principale vers les services HTTP distincts situés à l'intérieur du CDN. </font><font style="vertical-align: inherit;">Nous utilisons un référentiel unique, donc du point de vue de la prise en charge du code, cette solution n'a posé aucun problème. </font><font style="vertical-align: inherit;">Mais cela a permis d'utiliser des outils optimisés pour la nature de la charge:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'API mobile (protocole binaire) est aiguisée par l'échange de commandes courtes et au pic passe par elle-même plus de 100 000 requêtes par seconde;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CDN est réglé pour fonctionner avec le multimédia et est capable de fournir 200 000 photos par seconde (nous avons </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parlé des</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> optimisations CDN en détail </font><font style="vertical-align: inherit;">lors de la conférence Uptime day).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Du point de vue de CDN, le type de fichier téléchargé n'a pas beaucoup d'importance, et nous avions déjà une conversion vidéo. </font><font style="vertical-align: inherit;">Nous n'avons pu traiter correctement que les nouveaux types (audio et vidéo) dans le protocole de l'API mobile.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Appris comment construire des modèles ML sans R&amp;D</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En 2018, nous avons créé notre propre framework pour automatiser la formation des modèles sur nos données. Désormais, tout développeur dorsal peut créer indépendamment un modèle adapté à son application, sans attirer de collègues de la R&amp;D.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce cadre est capable de collecter des centaines de métriques, à la fois universelles (sexe, âge, activité dans l'application), et spécifiques, significatives pour chaque modèle spécifique. Les algorithmes de construction des modèles ML sont configurés de manière flexible et les graphiques des résultats sont disponibles pour des analyses «prêtes à l'emploi». En sortie, le framework fournit un modèle de travail qui répond assez rapidement (dans un délai de 10 à 100 ms) afin qu'il puisse être appelé directement depuis PHP dans les requêtes des utilisateurs sans sacrifier l'UX.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'année dernière, nous avons intégré le cadre dans différentes parties de notre application: les systèmes anti-spam, l'évaluation de l'application et quelques autres. </font><font style="vertical-align: inherit;">Mail ML est l'une des applications les plus réussies: le modèle prédit la probabilité d'un clic sur le lien dans l'e-mail pour un utilisateur spécifique. </font><font style="vertical-align: inherit;">Le modèle apprend des données des autres utilisateurs, similaires au destinataire de l'e-mail avec des attributs «importants», et «l'importance» est calculée automatiquement par le framework. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir évalué les résultats, nous avons cessé d'envoyer des e-mails avec le moins de chances de cliquer sur les liens. </font><font style="vertical-align: inherit;">Pour cette raison, nous:&nbsp;</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fidélité accrue des utilisateurs, ce qui a permis d'améliorer les mesures d'activité du service: les gens n'aiment pas les lettres «désespérées»;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">augmentation du taux de boîte de réception dans les expéditeurs clés: services de messagerie comme les expéditeurs avec un CTR élevé.</font></font></li>
</ul><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Streaming vidéo lancé</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous recherchons toujours de nouvelles opportunités de développement. Lorsque le streaming vidéo a commencé à prendre de l'ampleur, nous avons décidé de l'intégrer dans notre application. Il n'a pas été facile de prédire le succès du projet, afin de réduire les coûts, nous n'avons pas plongé tête baissée dans le développement de notre solution, mais avons trouvé une entreprise qui fournissait à la plateforme et au SDK les fonctionnalités dont nous avions besoin.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous étions tenus de créer une logique de fonctionnalités, une interaction client-serveur, de mettre en œuvre des options pour l'envoi et le paiement de cadeaux, de fournir une modération rapide du contenu (à la fois le flux vidéo et les commentaires) et de tout couvrir avec des mesures. </font><font style="vertical-align: inherit;">Nous avons réuni une équipe interfonctionnelle de différents départements et divisions: développement client, développement serveur, facturation, plateforme, back office, analyse BI, conception et gestion de produit. </font><font style="vertical-align: inherit;">Tous se sont installés dans un seul bureau - et le travail a commencé à bouillir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons déterminé la fonctionnalité de la première version (MVP) - et un mois plus tard, nous avons lancé une fonctionnalité dans un pays après l'autre. </font><font style="vertical-align: inherit;">Pendant plusieurs semaines, nous l'avons déployé dans différents pays, et aujourd'hui le streaming vidéo est disponible partout.&nbsp;</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diffuser des messages utilisateurs sur l'Arbat</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'était une promotion très inhabituelle: tout le mois d'octobre, les utilisateurs de Badoo ont envoyé des messages à un immense panneau d'affichage vidéo situé sur Novy Arbat à Moscou. En un mois, 23 000 messages nous ont été envoyés, dont 12 000 ont été modérés avec succès et ont frappé l'écran. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un panneau d'affichage est une telle télévision intelligente avec un navigateur et notre client JavaScript à l'intérieur. Des publicités de cinq minutes ont été montrées à l'écran, dans chacune desquelles trois minutes nous ont été accordées.&nbsp; </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qu/3q/0g/qu3q0gzmqjtfrrb0y_dh73ddqpm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien sûr, tous les utilisateurs voulaient voir le message envoyé à l'écran de leurs propres yeux. Pour rendre cela possible, nous avons dû répondre à la question lorsque chacun des messages y apparaît.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous devons informer l'utilisateur du délai d'affichage après la modération. Techniquement, à ce stade, le message est tombé dans notre calendrier interne avec une heure de début claire pour le spectacle et une durée calculée dynamiquement: de 30 secondes à cinq minutes (selon le nombre d'expéditeurs).&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La difficulté était que le fournisseur, pour sa part, ne fournissait pas la possibilité de contrôler et de suivre l'heure de la publicité, il était donc nécessaire de synchroniser astucieusement notre calendrier avec le calendrier du fournisseur, de surveiller et d'ajuster en permanence si nécessaire. Cela nous a aidés que nous avons remarqué (la journalisation est notre tout!) Que quelques dizaines de secondes avant la prochaine vidéo, la smart TV recharge la page. Il était impossible de se concentrer sur cette heure, mais là-dessus, on pouvait remarquer des changements d'horaire, qui atteignaient parfois 15 à 30 secondes. Nous avons mis en place le suivi des équipes de notre côté et au moment de l'opération nous avons commencé à demander l'heure du spectacle le plus proche au prestataire.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le processus de mise en place de ce système, notre ingénieur, qui travaillait dans un café en face du panneau d'affichage, a mangé une quantité impressionnante de croissants et a bu beaucoup de tasses de café, mais grâce à lui, la diffusion des messages des utilisateurs s'est bien déroulée et il n'y a eu aucun incident grave.&nbsp;</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Projets techniques</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malgré le volume important de travail d'épicerie, nous consacrons beaucoup de temps aux projets techniques. </font><font style="vertical-align: inherit;">La plupart d'entre eux concernent la performance de nos applications, ainsi que le développement et l'amélioration des outils internes.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liveprof Open Source Project</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons depuis longtemps la possibilité d'activer XHProf en production pour une demande spécifique, mais ce n'est pas toujours suffisant. Les demandes sont différentes, mais pour un travail systématique sur les performances, je veux voir la situation dans son ensemble pour toutes les demandes. Par conséquent, une telle idée est née: lancer automatiquement XHProf sur une petite partie des requêtes et agréger les résultats. C'est ainsi que le projet </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liveprof est apparu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que nous avons mis en libre accès. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le processus de traitement de la demande, il existe une logique qui, en fonction des probabilités et de la méthode API, décide de démarrer XHProf. Les résultats de profilage sont écrits sur le disque, puis livrés à un serveur distinct, où ils sont placés sous forme brute dans MySQL.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fois par jour, un script est exécuté qui regroupe les résultats pour chaque marque, plate-forme et méthode API. </font><font style="vertical-align: inherit;">Ainsi, nous pouvons voir les résultats du profilage pour des demandes spécifiques de Badoo iOS (à la fois sous la forme d'un arbre et sous la forme d'un graphique de flamme), nous pouvons voir quel pourcentage du cluster il faut pour appeler une fonction individuelle (par exemple, combien coûte la collecte d'une URL pour une photo), et récemment ajouté la sortie de ces informations directement à PhpStorm.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Migration vers PHP 7.4</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les nouvelles versions de PHP sont satisfaites de l'amélioration des performances. Au cours des deux dernières transitions (de 7,0 à 7,2 et de 7,2 à 7,4), notre service était responsable. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La transition</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> commence bien avant la sortie officielle. Tout d'abord, nous exécutons manuellement les tests avec la nouvelle version et ... nous sommes confrontés à un grand nombre de problèmes. Certains d'entre eux sont facilement résolus, tandis que d'autres nécessitent un certain temps.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque la plupart des problèmes ont été résolus, nous passons à la nouvelle version dans l'environnement de développement, pendant un certain temps, nous surveillons les journaux d'erreurs et collectons les commentaires des développeurs et des ingénieurs d'assurance qualité. Au moment de la sortie officielle de la version stable, nous sommes prêts à tester en production: nous l'exécutons d'abord sur une machine et l'étalons progressivement sur les autres.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais une fois la nouvelle version distribuée sur tous les serveurs, la transition ne s'arrête pas: nous continuons à vérifier la syntaxe avec les deux versions de PHP (nouvelle et précédente). </font><font style="vertical-align: inherit;">Ainsi, nous sommes convaincus que les développeurs n'ont pas commencé à utiliser la nouvelle syntaxe et que nous pouvons basculer vers l'ancienne version à tout moment si des problèmes inattendus surviennent dans la nouvelle. </font><font style="vertical-align: inherit;">Par exemple, avant les vacances du Nouvel An, nous avons découvert un petit problème avec une fuite de mémoire en PHP 7.4, décidé de ne pas le risquer et retourné à la version précédente avant les vacances. </font><font style="vertical-align: inherit;">Après les vacances, après avoir réglé le problème, nous avons de nouveau déployé la version 7.4 et nous l'utilisons toujours.&nbsp;</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Accédez à l'agrégation des demandes</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec la mise à jour PHP, notre lutte pour les performances ne s'arrête pas là. Nous avons un framework puissant qui fait beaucoup de travail au début: de l'initialisation aux différents contrôles requis pour chaque requête.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons décidé de mener une expérience simple. Nous avons sélectionné une partie des commandes pour lesquelles la réponse du serveur n'est pas critique (par exemple, l'envoi de statistiques à partir du client ou le choix de l'option «Non» dans le jeu de balayage), et avons écrit un service sur Go qui accepte ces demandes, les enregistre, puis les envoie au serveur dans un paquet ( pour chaque utilisateur). Ainsi, nous pouvons très facilement économiser sur l'initialisation de l'application sans réécrire le code principal.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'expérience s'est avérée réussie: selon nos estimations, nous pouvons économiser quelques pour cent du CPU (qui dans notre cas est plus de dix serveurs) sans réécrire le code principal, mais au prix de compliquer le fonctionnement et la logique du travail. </font><font style="vertical-align: inherit;">Pour compléter le tableau, nous avons décidé d'attendre les résultats d'expériences avec la précharge PHP 7.4 et RoadRunner afin de choisir la solution optimale en fonction du ratio de gains et de la complexité de mise en œuvre.&nbsp;</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Optimisation photo</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'activité des utilisateurs dépend directement de certains projets techniques. Par exemple, plus nous montrons des photos rapidement, plus les gens glissent activement, plus il y a de correspondances, plus de nouvelles paires se forment, etc.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En octobre 2018, l'une de nos marques, Bumble, a décidé de pénétrer le marché indien. Comme nous ne savions rien de la vitesse de l'Internet local, nous avons décidé de mener une série d'expériences sur la qualité et la taille des photographies. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous lançons toutes les expériences techniques sous tests A / B. Cela vous permet de voir non seulement la différence dans le comportement et l'activité des différents groupes, mais aussi des statistiques sur le fonctionnement de l'application sur le client, ventilées par options. Nous voulions du temps pour télécharger des images et du temps pour le décodage et l'affichage.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Infrastructure, en plus des serveurs de stockage, nous allouons un cluster de caches photo - ce sont les serveurs qui stockent les images les plus couramment utilisées. Étant donné qu'il existe un grand nombre de smartphones avec différents écrans dans le monde, nous stockons des photos dans plusieurs tailles de base et les convertissons à la volée à la taille et au format demandés par le client.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La tâche que nous voulions résoudre était de choisir le format optimal (JPEG, WebP, PJPEG), la taille et la qualité d'image. En théorie, le format WebP devrait être le meilleur, mais c'est le plus cher en termes de conversion à la volée: au lieu d'économiser du trafic, vous devez acheter plus de serveurs de cache photo. Parallèlement à cela, nous avons décidé de tester comment les CDN dans la région contribueront à améliorer l'expérience utilisateur.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plusieurs de nos ingénieurs y ont été envoyés pour lancer un projet en Inde. Nous avions donc non seulement des chiffres secs, mais aussi des personnes qui pouvaient tester l'application sur différents opérateurs sur place, comparer son travail avec le travail d'autres applications, etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les résultats des expériences nous ont permis de choisir les meilleures options pour la qualité et la taille des photographies. </font><font style="vertical-align: inherit;">Par exemple, nous avons vu que la logique de préchargement des photos sur le client joue un rôle important dans l'activité de l'utilisateur. </font><font style="vertical-align: inherit;">Et malgré le fait que les photos dans WebP se téléchargent plus rapidement, l'effet positif n'était perceptible que dans les navigateurs mobiles. </font><font style="vertical-align: inherit;">La même histoire avec CDN: nous avons testé trois services CDN externes et, malgré l'accélération de la livraison de contenu, nous n'avons vu aucun changement positif dans l'activité. </font><font style="vertical-align: inherit;">En conséquence, nous avons activé WebP pour les navigateurs mobiles et économisé de l'énergie, laissant tous les autres clients au format JPEG.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Propre streaming vidéo</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme je l'ai mentionné ci-dessus, la première version du streaming vidéo a été lancée à l'aide d'un service externe. L'expérience a été considérée comme réussie - et nous avons commencé à préparer le logiciel et l'infrastructure pour le lancement dans nos centres de données.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec l'aide d'un transcodeur prêt à l'emploi (pour extraire le flux vidéo de l'utilisateur) et de serveurs Edge (pour distribuer le flux à l'utilisateur), nous avons dû assembler un système similaire à une solution en boîte externe. Et, bien sûr, beaucoup de choses devaient être finalisées avec un «fichier» sur le pouce. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, initialement chaque serveur Edge connecté à chaque serveur transcodeur, ce qui compliquait la mise à l'échelle et augmentait le trafic interne. Nous avons écrit l'équilibrage des clients de manière à ce que les clients d'un flux accèdent au moins de serveurs Edge, en tenant compte de la popularité de chaque flux particulier.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre exemple, quand nous avons dû être rapides d'esprit, est la logique de changer la qualité du flux dans WebRTC: en raison du fait que nous utilisons deux options de qualité, l'algorithme standard a été démoli et il n'a fonctionné que pour diminuer le débit binaire. </font><font style="vertical-align: inherit;">J'ai dû aller plus loin et éditer l'algorithme utilisé dans la bibliothèque WebRTC. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, la signalisation WebRTC, par défaut, a transmis trop d'informations sur les hôtes du réseau au client. </font><font style="vertical-align: inherit;">La solution était un serveur proxy sur Go, qui ne donne au client que ce qu'il a besoin de savoir, et recueille en outre de nombreuses informations utiles sur les clients connectés.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Du début de la recherche à sa mise en œuvre complète, le projet a duré plus de six mois, mais nous avons ainsi pu réduire considérablement les coûts en abandonnant les services externes.&nbsp;</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Optimisation des performances</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce n'est pas un projet ponctuel pour notre équipe - c'est un domaine important auquel nous accordons également beaucoup d'attention. Notre cluster principal servant les demandes d'applications se compose de centaines de serveurs, et il est donc rentable pour nous d'investir du temps dans le travail d'optimisation de l'application: chaque pourcentage gagné nous coûte plusieurs serveurs physiques.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous surveillons en permanence la charge totale sur notre cluster et la charge pour chaque appel d'API spécifique. Si un certain seuil est dépassé, nous commençons à rechercher et à optimiser les goulots d'étranglement. Plus l'excédent est important, plus les gens s'impliquent. Cette approche est pleinement justifiée: au cours des deux dernières années, le taux de croissance du cluster a été la moitié du taux de croissance de l'audience de nos services.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous partageons activement les connaissances acquises lors des travaux d'optimisation lors des conférences et réunions. </font><font style="vertical-align: inherit;">Plus de détails sur nos projets et études peuvent être trouvés dans les articles et rapports de Pasha Murzakov:&nbsp;</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">« </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Performances PHP: planification, profilage, optimisation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> »</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lutter contre un modèle de partage rien: préchargement PHP 7.4, RoadRunner et autres</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">« </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment 200 lignes sur Go nous ont aidés à libérer 15 serveurs</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> »</font></font></li>
</ul><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contrôle sur le code ancien et inutilisé</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons un développement assez intensif, et le rythme de lancement des tâches et des expériences de produits augmente également à mesure que la société se développe. </font><font style="vertical-align: inherit;">Dans de telles conditions, la base de code devient plus complexe et moins contrôlée. </font><font style="vertical-align: inherit;">La situation est exacerbée par plusieurs plates-formes et utilisateurs disposant d'anciennes versions d'applications et de systèmes d'exploitation.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous essayons de garder notre base de code «propre» afin de maintenir un rythme de travail élevé:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">créer automatiquement des tâches pour supprimer le code après la fin de l'expérience produit;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">suivi automatisé des anciennes versions des applications et des systèmes d'exploitation et des branches de code qui y sont utilisées;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Outils introduits pour rechercher automatiquement le code inutilisé.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez en savoir plus sur nos résultats lors du </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Meetup PHP Badoo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui se tiendra ce samedi 15 février.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien sûr, ce ne sont pas tous les projets dont je veux parler. Au cours des deux dernières années, nous avons lutté contre les spammeurs et les snappers, scié notre plug-in pour PhpStorm, testé divers référentiels KV (et choisi Aerospike), expérimenté beaucoup, partagé des connaissances dans des articles, lors de conférences et pas seulement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais si vous décidez que nous travaillons uniquement, ce n'est pas le cas. Chaque équipe a son propre budget de consolidation d'équipe. Nos collègues ont visité Amsterdam, Édimbourg, Prague et d'autres villes. Et l'année dernière, nous avons organisé une réunion générale du département en Croatie: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/z0/th/tz/z0thtz68shyqbfbn_lgjojxdzru.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et nous savons aussi comment faire des photoshop.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sur le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">déménagement à Londres et le bureau de Soho</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous l'avons déjà dit, nous ne nous attarderons donc pas sur les détails de cet article - montrez simplement quelques photos.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sb/ul/em/sbulemvjxw8ipp50njicr4epm6m.png"><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grande photo</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/vn/eh/yi/vnehyidqkpljpndkvqnsqkxtlhu.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/a3/vb/rk/a3vbrkj0avtmfek7j7p9kreezfo.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/7h/le/ya/7hleyaxbrafxfip4hyq9rpevowg.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/lt/h8/jw/lth8jww4mra-4adg9_tay4istm4.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/hy/ub/0n/hyub0ngeapscepq0jibotaexl6u.jpeg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'événement d'embauche est le moyen le plus simple et le plus rapide de rejoindre notre équipe. </font><font style="vertical-align: inherit;">Nous acceptons les réponses au </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">test</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> jusqu'au 1er mars inclus. </font><font style="vertical-align: inherit;">Ensuite, nous prendrons une semaine pour analyser les résultats et appeler ceux qui ont fait face aux tâches.&nbsp;</font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous souhaitez travailler pour nous à Londres, mais ne voulez pas passer le test, il existe une autre option: il suffit de répondre aux offres d'emploi sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">notre site Web</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , cette opportunité est toujours disponible. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous avez des questions, n'hésitez pas à les poser dans les commentaires ou à m'envoyer des messages privés.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bonne chance</font></font></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr487902/index.html">D'incendie en incendie: électrolyte à l'état solide réfractaire pour batteries lithium-ion</a></li>
<li><a href="../fr487906/index.html">Le livre "Réseaux informatiques. Principes, technologies, protocoles: édition anniversaire »</a></li>
<li><a href="../fr487908/index.html">Le début de la guerre des processus technologiques: 5 nm et 3 nm</a></li>
<li><a href="../fr487910/index.html">Lois naturelles et mathématiques élégantes: problèmes et solutions</a></li>
<li><a href="../fr487912/index.html">9 conseils pour accélérer le processus d'embauche en 2020</a></li>
<li><a href="../fr487916/index.html">L'histoire de l'audio compact: comment les bobines miniatures ont migré dans un facteur de forme de cassette</a></li>
<li><a href="../fr487920/index.html">Surcharge en C ++. Partie I. Fonctions et modèles de surcharge</a></li>
<li><a href="../fr487922/index.html">Apprendre à déployer des microservices. Partie 1. Spring Boot et Docker</a></li>
<li><a href="../fr487924/index.html">Kim Dotcom: Caught, la personne la plus recherchée en ligne. 3e partie</a></li>
<li><a href="../fr487926/index.html">En quête d'éducation physique</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>