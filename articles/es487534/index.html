<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚇 👂 🍢 etcd 3.4.3: investigación de seguridad y confiabilidad de almacenamiento 👳 👧🏻 🧜🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nota perev. : El contenido de este artículo no es del todo típico de nuestro blog. Sin embargo, como mucha gente sabe, etcd se encuentra en el corazón...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>etcd 3.4.3: investigación de seguridad y confiabilidad de almacenamiento</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/487534/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota perev.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : El contenido de este artículo no es del todo típico de nuestro blog. Sin embargo, como mucha gente sabe, etcd se encuentra en el corazón de Kubernetes, por lo que este estudio, realizado por un consultor independiente en el campo de la confiabilidad, resultó ser interesante entre los ingenieros que operan este sistema. Además, es interesante en el contexto de cómo los proyectos de código abierto que ya han demostrado su eficacia en la producción se están mejorando incluso a un nivel tan "bajo".</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/xd/av/d3/xdavd35rjqklgnrnd-0wulkpayo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
La</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bóveda de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> valor-clave (KV),</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"> etc.</font></a><font style="vertical-align: inherit;"> es una base de datos distribuida basada en el algoritmo de consenso Raft. En un análisis</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> realizado en 2014</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , encontramos que etcd 0.4.1 se vio afectado por las llamadas lecturas obsoletas por defecto</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(lea las operaciones que devuelven un valor antiguo e irrelevante debido a un retraso en la sincronización - aprox. transl.)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Decidimos volver a etcd (esta vez, a la versión 3.4.3) para evaluar nuevamente en detalle su potencial en el campo de la confiabilidad y la seguridad.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hemos encontrado que la operación con pares de "clave-valor" estrictamente serializable y que los procesos del observador </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(relojes)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> entregados a cada cambio en la clave de orden. </font><font style="vertical-align: inherit;">Sin embargo, los </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bloqueos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en etcd son fundamentalmente inseguros, y los riesgos asociados con ellos se ven exacerbados por un error, como resultado de lo cual no se verifica la relevancia del </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arrendamiento</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> después de esperar el bloqueo. </font><font style="vertical-align: inherit;">Puede leer el comentario de los desarrolladores de etcd en nuestro informe </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en el blog del proyecto</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El estudio fue patrocinado por la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloud Native Computing Foundation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (CNCF), parte de The Linux Foundation. </font><font style="vertical-align: inherit;">Se llevó a cabo en pleno cumplimiento de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">las políticas éticas de Jepsen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Antecedentes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El repositorio de Etc KV es un sistema distribuido diseñado para ser utilizado como base para la coordinación. Al igual que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zookeeper</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consul</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , etcd almacena pequeñas cantidades de estados raramente actualizados ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">por defecto, hasta 8 GB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) en forma de un mapa de valores clave y proporciona </font><font style="vertical-align: inherit;">lecturas, escrituras y microtransacciones </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estrictamente serializables en</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> todo el almacén de datos, así como primitivas de coordinación como </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bloqueos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , seguimiento </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(relojes)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y selección de líderes. Muchos sistemas distribuidos, como </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kubernetes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenStack</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , usan etcd para almacenar metadatos de clúster, coordinar vistas coordinadas de datos, elegir un líder, etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En 2014, ya realizamos una evaluación de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">etcd 0.4.1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Luego descubrimos que, por defecto, es propenso a lecturas obsoletas debido a la optimización. Si bien el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trabajo sobre los principios de Raft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> discute la necesidad de dividir las operaciones de lectura en subprocesos y pasarlos a través de un sistema de consenso para garantizar la viabilidad, etcd lee en cualquier líder local sin verificar un estado más actual en el líder más nuevo. El equipo de desarrollo de etcd implementó el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indicador de quórum opcional</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y en la API de la versión 3.0 de etcd </font><font style="vertical-align: inherit;">, la </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">linealización</font></a><font style="vertical-align: inherit;"> para todas las operaciones, excepto las operaciones de seguimiento, </font><font style="vertical-align: inherit;">apareció </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de forma predeterminada</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">
La API etcd 3.0 se concentra en un mapa plano KV donde las claves y los valores son opacos</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opacos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> conjuntos de bytes. Usando consultas de rango, puede simular claves jerárquicas. Los usuarios pueden leer, escribir y eliminar claves, así como monitorear el flujo de actualizaciones para una sola clave o rango de claves. El kit de herramientas etcd se complementa con arrendamientos (objetos variables con una vida útil limitada, que se mantienen en estado activo mediante solicitudes de latidos del cliente), bloqueos (objetos con nombre dedicados vinculados a arrendamientos) y la elección de líderes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la versión 3.0, etcd ofrece una </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">API transaccional</font></a><font style="vertical-align: inherit;"> limitada</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para operaciones atómicas con muchas claves. </font><font style="vertical-align: inherit;">En este modelo, una transacción es una expresión condicional con un predicado, una rama verdadera y una rama falsa. </font><font style="vertical-align: inherit;">Un predicado puede ser una conjunción de varias comparaciones clave: igualdad o diversas desigualdades, de acuerdo con las versiones de una clave, revisión global, etc., o el valor clave actual. </font><font style="vertical-align: inherit;">Las ramas verdaderas y falsas pueden incluir múltiples operaciones de lectura y escritura; </font><font style="vertical-align: inherit;">todos ellos se aplican atómicamente dependiendo del resultado de la estimación de predicados.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.1 Garantías de consistencia en la documentación</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A partir de octubre de 2019, la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentación de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> etcd </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">para la API</font></a><font style="vertical-align: inherit;"> establece que "todas las llamadas a la API demuestran coherencia constante, la forma más sólida de garantía de coherencia disponible en los sistemas distribuidos". Esto no es así: la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">consistencia constante es</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> estrictamente más débil que la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linealización</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, y la linealización es definitivamente alcanzable en sistemas distribuidos. Además, la documentación establece que "durante la operación de lectura, etcd no garantiza la transferencia del valor [más reciente (medido por el reloj externo después de la finalización de la consulta)] disponible en cualquier representante del clúster" Esta también es una afirmación demasiado conservadora: si etcd proporciona linealización, las operaciones de lectura siempre están asociadas con el estado comprometido más reciente en orden de linealización. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La documentación también afirma que etcd garantiza el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aislamiento serializable</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: todas las operaciones (incluso las que afectan a varias teclas) se realizan en un orden general. Los autores describen el aislamiento serializable como "el nivel de aislamiento más fuerte disponible en sistemas distribuidos". Esto (dependiendo de lo que quiere decir con el "nivel de aislamiento") tampoco es cierto; la serialización estricta es más fuerte que la simple serialización, mientras que la primera también se puede lograr en sistemas distribuidos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La documentación dice que todas las operaciones (excepto el seguimiento) en etcd son linealizables por defecto. En este caso, la linealización se define como la consistencia con relojes globales débilmente sincronizados. Cabe señalar que dicha definición no solo es incompatible con la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">definición de linealización</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Herlihy &amp; Wing, pero también implica una violación de la causalidad: los nodos con horas de atención intentarán leer los resultados de las operaciones que ni siquiera han comenzado. Suponemos que etcd todavía no es una máquina del tiempo, y dado que se basa en el algoritmo Raft, se debe aplicar la definición generalmente aceptada de linealización. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dado que las operaciones de KV en etcd son serializables y linealizables, creemos que, de hecho, etcd proporciona </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">una serialización estricta</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> por defecto </font><font style="vertical-align: inherit;">. Esto tiene sentido, ya que todas las teclas, etcd están en una sola máquina de estado, y Raft proporciona un pedido completo de todas las operaciones en esta máquina de estado. De hecho, todo el conjunto de datos etcd es un único objeto linealizable. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bandera opcional </font></font><code>serializable</code> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">baja</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El nivel de operaciones de lectura de consistencia serializable estricta a regular, que permite la lectura de un estado comprometido desactualizado. </font><font style="vertical-align: inherit;">Tenga en cuenta que la bandera </font></font><code>serializable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no afecta la serialización de la historia; </font><font style="vertical-align: inherit;">Las operaciones de KV, etc. son serializables en todos los casos.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Prueba de desarrollo</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para crear </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un conjunto de pruebas,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilizamos la </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">biblioteca Jepsen</font></a><font style="vertical-align: inherit;"> adecuada</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Se analizó la versión, etcd 3.4.3 (la última a partir de octubre de 19), trabajando en clústeres de Debian Stretch que constan de 5 nodos. Hemos implementado una serie de fallas en estos grupos, incluyendo particiones de red, aislando nodos individuales, dividiendo el grupo en una mayoría y una minoría, así como particiones no transitivas con una mayoría superpuesta. Ellos "cayeron" y suspendieron subconjuntos aleatorios de nodos, y también desactivaron deliberadamente a los líderes. Se introdujeron distorsiones temporales de hasta varios cientos de segundos, tanto a intervalos de varios segundos como a milisegundos ("parpadeo" rápido). Dado que etcd admite el cambio dinámico de la cantidad de componentes, agregamos y eliminamos nodos al azar durante las pruebas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las cargas de prueba incluyeron registros, conjuntos y pruebas transaccionales para verificar operaciones en KV, así como cargas especializadas para cerraduras y relojes.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.1 Registros</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para evaluar la confiabilidad de etcd durante las operaciones KV, se desarrolló una </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prueba de registro</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> durante la cual se realizaron operaciones aleatorias de lectura, escritura, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comparación y configuración</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en las teclas de la unidad. </font><font style="vertical-align: inherit;">Los resultados se </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">evaluaron</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilizando la </font><font style="vertical-align: inherit;">herramienta de linealización de </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">Knossos</font></a><font style="vertical-align: inherit;"> utilizando el modelo de registro de comparación / instalación y la información de versión.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.2 Conjuntos</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para cuantificar las lecturas obsoletas, se desarrolló una </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prueba</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que utilizaba una transacción de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comparar y establecer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para leer un conjunto de enteros de una sola clave y luego agregar un valor a este conjunto. </font><font style="vertical-align: inherit;">Durante la prueba, también realizamos una lectura paralela de todo el conjunto. </font><font style="vertical-align: inherit;">Después de completar la prueba, los resultados se analizaron para detectar casos en los que el elemento, que se sabía que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estaba</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> presente en el conjunto, estaba ausente en los resultados de lectura. </font><font style="vertical-align: inherit;">Estos casos se usaron para cuantificar las lecturas obsoletas y las actualizaciones perdidas.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.3 Anexar prueba</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para verificar la serialización estricta, se desarrolló una </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prueba de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adición durante la cual las transacciones se leían en paralelo y se agregaban valores a las listas que constaban de conjuntos únicos de enteros. Cada lista se almacenó en una clave etcd, y se hicieron adiciones dentro de cada transacción, leyendo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cada clave que necesitaba ser cambiada</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en una transacción, y luego </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estas claves se escribieron y las lecturas se realizaron</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en la segunda transacción, que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estaba protegida</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para asegurarse de que no haya cambiado ninguna clave grabada desde la primera lectura. </font><font style="vertical-align: inherit;">Al final de la prueba, trazamos la relación entre las transacciones en función de la prioridad en tiempo real y la relación de las operaciones de lectura y adición. </font><font style="vertical-align: inherit;">La verificación de este gráfico en busca de bucles permitió determinar si las operaciones eran estrictamente serializables. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si bien etcd evita que las transacciones escriban la misma clave varias veces, puede crear transacciones con hasta un registro por clave. </font><font style="vertical-align: inherit;">También nos aseguramos de que las operaciones de lectura dentro de la misma transacción reflejaran operaciones de escritura anteriores de la misma transacción.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.4 cerraduras</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como servicio de coordinación, etcd promete </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">soporte integrado para bloqueo distribuido</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Investigamos estas cerraduras de dos maneras. Al principio, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> generaron </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">solicitudes aleatorias de bloqueo y desbloqueo</font></a><font style="vertical-align: inherit;"> , recibiendo un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contrato de arrendamiento para cada bloqueo y dejándolo abierto</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilizando el cliente incorporado, </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">etc.</font></a><font style="vertical-align: inherit;"> en el cliente Java </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code> keepalive</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hasta su </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lanzamiento</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Probamos los resultados con Knossos para ver si forman una implementación linealizada del servicio de bloqueo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para una prueba más práctica (y para cuantificar la frecuencia de fallas de bloqueo), utilizamos bloqueos y etcd para organizar </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la exclusión mutua al realizar actualizaciones en el conjunto en memoria</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y busqué actualizaciones perdidas en este conjunto. </font><font style="vertical-align: inherit;">Esta prueba nos permitió confirmar directamente si los sistemas que usan etcd como mutex pueden actualizar de manera segura el estado interno. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La tercera versión de la prueba de bloqueo involucró </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">guardias en la clave de arrendamiento</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para modificar el conjunto almacenado en etcd.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.5 Seguimiento</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para verificar que los relojes proporcionan información sobre cada actualización de clave, se creó una clave como parte de la prueba y se </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">asignaron ciegamente</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> valores enteros únicos. </font><font style="vertical-align: inherit;">Mientras tanto, los clientes compartieron </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esta clave</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> durante varios segundos a la vez. </font><font style="vertical-align: inherit;">Cada vez después del inicio del reloj, el cliente comenzó con la revisión en la que se había detenido la última vez. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al final de este proceso, nos </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aseguramos de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que cada cliente observara la misma secuencia de cambios clave.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Resultados</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.1 Seguimiento desde la 0ª revisión</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al rastrear una clave, los clientes pueden especificar una </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">revisión inicial</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que es "una revisión opcional con la que se inicia el rastreo (inclusive)". Si el usuario desea ver cada operación con una determinada clave, puede especificar la primera revisión de etcd. ¿Qué es esta auditoría? </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El modelo de datos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">glosario</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no proporcionan una respuesta a esta pregunta; las revisiones se describen como contadores de 64 bits que aumentan monotónicamente, pero no está claro si etcd comienza desde 0 o 1. Es razonable suponer que la cuenta regresiva es desde cero (por si acaso). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por desgracia, esto está mal. Al solicitar la revisión número 0, etcd comienza a transmitir actualizaciones, comenzando con la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">revisión actual en el servidor más una</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, pero no con el primero. </font><font style="vertical-align: inherit;">La solicitud de la primera revisión da todos los cambios. </font><font style="vertical-align: inherit;">Este comportamiento </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> está </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">documentado en ninguna parte</font></a><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Creemos que, en la práctica, es poco probable que esta sutileza provoque problemas en la producción, ya que la mayoría de los clústeres no persisten en la primera revisión. </font><font style="vertical-align: inherit;">Además, etcd comprime la historia de todos modos con el tiempo, por lo que en aplicaciones del mundo real, lo más probable, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en cualquier caso,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no requiere leer todas las versiones, comenzando con la primera revisión. </font><font style="vertical-align: inherit;">Tal comportamiento está justificado, pero no dañaría la descripción correspondiente en la documentación.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.2 Cerraduras míticas</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La documentación de la API para los bloqueos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> establece que una clave bloqueada "se puede usar junto con las transacciones para garantizar que las actualizaciones en etc. se produzcan solo cuando el bloqueo sea de su propiedad". Es extraño, pero no proporciona ninguna garantía para las cerraduras en sí mismas y su propósito no se explica. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sin embargo, en otros materiales, los mantenedores, etc., aún comparten información sobre el uso de cerraduras. Por ejemplo, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el anuncio de lanzamiento de etcd 3.2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> describe una aplicación </font></font><code>etcdctl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para bloquear cambios en el intercambio de archivos en un disco. Además, en un problema en GitHub con una pregunta sobre el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propósito específico de los bloqueos,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> uno de los desarrolladores de etcd respondió lo siguiente:</font></font><br>
<br>
<blockquote>     etcd  ,   (  )        ,     (        etcd), - :<br>
<br>
<ol>
<li>    etcd;</li>
<li>  - ( ,     etcd);</li>
<li>    .</li>
</ol></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solo se da un ejemplo de este tipo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>  etcdctl</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: se usó una cerradura para proteger al equipo </font></font><code>put</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, pero no vinculó la clave de la cerradura a la actualización. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por desgracia, esto no es seguro porque permite que varios clientes mantengan simultáneamente el mismo bloqueo. El problema se ve agravado por la suspensión de procesos, bloqueos de red o particiones, sin embargo, también puede ocurrir en grupos completamente sanos sin fallas externas. Por ejemplo, en esta </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ejecución de prueba, el</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> proceso número 3 establece con éxito el bloqueo, y el proceso 1 obtiene el mismo bloqueo en paralelo incluso antes de que el proceso 3 tenga la oportunidad de eliminarlo:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ko/hy/lz/kohylznbfb8bh5a2m1l88kysrg4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La violación de mutex fue más notable en los contratos de arrendamiento con TTL cortos: los TTL de 1, 2 y 3 segundos no pudieron proporcionar una exclusión mutua después de solo unos minutos de prueba (incluso en grupos sanos). Las suspensiones de proceso y las particiones de red provocaron problemas aún más rápido. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En una de nuestras variantes de prueba de bloqueo, se utilizaron mutexes etcd para proteger las actualizaciones conjuntas de un conjunto de enteros (como sugiere la documentación, etcd). Cada actualización lee el valor de muestra actual en memoria y, después de aproximadamente un segundo, vuelve a escribir esta colección con la adición de un elemento único. Con arrendamientos con un TTL de dos segundos, cinco procesos paralelos y una pausa de proceso cada cinco segundos, pudimos causar una pérdida constante de aproximadamente el 18% de las actualizaciones confirmadas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este problema fue exacerbado por el mecanismo de bloqueo interno en etcd. Si el cliente esperó a que el otro cliente lo desbloqueara, perdió su contrato de arrendamiento y, después de eso, se liberó el bloqueo, el servidor </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no verificó dos veces el contrato</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">arrendamiento</font></a><font style="vertical-align: inherit;"> para asegurarse de que todavía es válido antes de informarle al cliente que el bloqueo ahora está detrás de él. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La inclusión de una verificación de arrendamiento adicional, así como la selección de TTL más largos y el establecimiento cuidadoso de los </font><font style="vertical-align: inherit;">tiempos </font><font style="vertical-align: inherit;">de </font><font style="vertical-align: inherit;">espera </font><font style="vertical-align: inherit;">de las </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elecciones</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , reducirán la frecuencia de este problema. Sin embargo, las violaciones de mutex no se pueden eliminar por completo, ya que los bloqueos distribuidos son fundamentalmente inseguros en los sistemas asincrónicos. El Dr. Martin Kleppmann describe convincentemente esto en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">su artículo.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sobre cerraduras distribuidas. Según él, los servicios de bloqueo deben sacrificar la corrección para mantener la viabilidad en los sistemas asíncronos: si el proceso falla mientras se controla el bloqueo, el servicio de bloqueo necesita alguna forma de forzar el desbloqueo. Sin embargo, si el proceso en realidad no cayó, sino que simplemente se ejecuta lentamente o no está disponible temporalmente, desbloquearlo puede llevar a que se mantenga en varios lugares al mismo tiempo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero incluso si el servicio de bloqueo distribuido usa, por ejemplo, algún tipo de detector de falla mágica y puede garantizar la exclusión mutua, en el caso de algún recurso no local, su uso seguirá siendo inseguro. Suponga que el proceso A envía un mensaje a la base de datos D mientras mantiene un bloqueo. Después de eso, el proceso A se bloquea y el proceso B recibe un bloqueo y también envía un mensaje a la base D. El problema es que un mensaje del proceso A (debido a la asincronía) puede aparecer después de un mensaje del proceso B, violando la excepción mutua que se suponía que debía proporcionar el bloqueo. . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para evitar este problema, es necesario confiar en el hecho de que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el propio sistema de almacenamiento</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> admitirá la corrección de las transacciones o, si el servicio de bloqueo proporciona dicho mecanismo, utilice</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Token de </font><font style="vertical-align: inherit;">" </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cercado"</font></font></i><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que se incluirá en todas las operaciones realizadas por el titular de la cerradura. Asegurará que no se produzcan operaciones repentinas del titular de la cerradura anterior entre las operaciones del propietario de la cerradura actual. Por ejemplo, en </font><font style="vertical-align: inherit;">el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">servicio de bloqueo Chubby</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de Google </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">,</font></a><font style="vertical-align: inherit;"> estos tokens se llaman </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">secuenciadores</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En etcd, puede usar la revisión de la clave de bloqueo como un token de bloqueo ordenado globalmente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Además, las teclas de bloqueo en etcd se pueden usar para proteger las actualizaciones transaccionales en el propio etcd. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verificación de la versión de la clave de bloqueo como parte de la transacción</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, los usuarios pueden evitar una transacción si el bloqueo ya no se mantiene (es decir, la versión de la clave de bloqueo es mayor que cero). </font><font style="vertical-align: inherit;">En nuestras pruebas, este enfoque nos permitió aislar con éxito las operaciones de lectura-modificación-escritura en las que la escritura era la única transacción protegida por bloqueo. </font><font style="vertical-align: inherit;">Este enfoque proporciona un aislamiento similar a los tokens de barrera, pero (como los tokens de barrera) no garantiza la atomicidad: un proceso puede bloquearse o perder un mutex durante una actualización que consta de muchas operaciones, dejando a etcd en un estado lógicamente inconsistente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los resultados del trabajo en los temas del proyecto:</font></font><br>
<ul>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los relojes que comienzan en la revisión 0 comienzan más tarde</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , no se ha decidido;</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los bloqueos regresan después de bloquear sin verificar la propiedad</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - en el maestro;</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las cerraduras no están documentadas como inseguras</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , no resueltas.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Discusión</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En nuestras pruebas, etc. 3.4.3 estuvo a la altura de las expectativas con respecto a las operaciones de KV: observamos una consistencia estrictamente serializable de lectura, escritura e incluso transacciones de múltiples claves, a pesar de la suspensión de procesos, bloqueos, manipulación del reloj y la red, así como un cambio en el número de miembros del clúster . </font><font style="vertical-align: inherit;">El comportamiento estrictamente serializable se implementó por defecto en las operaciones KV; </font><font style="vertical-align: inherit;">El rendimiento de las lecturas con el </font></font><code>serializable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conjunto de </font><font style="vertical-align: inherit;">indicadores </font><font style="vertical-align: inherit;">condujo a la aparición de lecturas obsoletas (como se describe en la documentación). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El monitor </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(relojes)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> funciona correctamente, al menos en las teclas individuales. </font><font style="vertical-align: inherit;">Hasta que la compresión del historial destruyó los datos antiguos, el reloj emitió con éxito cada actualización clave.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sin embargo, resultó que los bloqueos en etcd (como todos los bloqueos distribuidos) no proporcionan exclusión mutua. Diferentes procesos pueden mantener la cerradura al mismo tiempo, incluso en clústeres saludables con relojes perfectamente sincronizados. La documentación con la API de bloqueo no decía nada al respecto, y los ejemplos de bloqueos presentados no eran seguros. Sin embargo, algunos de los problemas con los bloqueos tuvieron que desaparecer después del lanzamiento de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">este parche</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado de nuestra colaboración, el equipo de etcd realizó varias modificaciones a la documentación (ya han aparecido en GitHub y se publicarán en futuras versiones del sitio web del proyecto). La página API de garantías de GitHub ahora establece que, por defecto, etcd es </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estrictamente serializable</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y se ha eliminado la afirmación de que serial y serializable son los niveles más fuertes de consistencia disponibles en los sistemas distribuidos. Con respecto a las revisiones, ahora se indica que el inicio debe ser </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desde la unidad (1)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , aunque la documentación de la API </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">todavía no dice</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que un intento de comenzar desde la 0ª revisión dará como resultado "eventos de salida que ocurrieron después de la revisión actual más 1" en lugar del esperado "despacho de todos los eventos". La documentación de los problemas de seguridad de la cerradura está </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en desarrollo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Algunos cambios en la documentación, como describir el comportamiento especial de etcd al intentar leer, comenzando con una revisión cero, aún requieren atención.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como de costumbre, enfatizamos que Jepsen prefiere un enfoque experimental para la verificación de seguridad: podemos confirmar la presencia de errores, pero no su ausencia. </font><font style="vertical-align: inherit;">Se están haciendo esfuerzos considerables para encontrar problemas, pero no podemos probar la corrección general de etcd.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.1 Recomendaciones</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si usa bloqueos en etcd, piense si los necesita por seguridad o simplemente para aumentar el rendimiento limitando probabilísticamente la concurrencia. Los bloqueos Etcd se pueden usar para aumentar el rendimiento, pero usarlos por motivos de seguridad puede ser arriesgado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En particular, si usa el bloqueo etcd para proteger un recurso compartido como un archivo, base de datos o servicio, este recurso debería garantizar la seguridad </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sin</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bloqueo. Una forma de lograr esto es usar una </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ficha de bombardeo monótono</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Puede ser, por ejemplo, una revisión de etcd asociada con la clave de bloqueo retenida actual. El recurso compartido debe garantizar que una vez que el cliente haya utilizado el token</font></font><code>y</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para realizar alguna operación, cualquier operación con un token </font></font><code>x &lt; y</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">será rechazada. Este enfoque no garantiza la atomicidad, pero sí garantiza que las operaciones dentro del marco de bloqueo se realicen en orden y no de forma intermitente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sospechamos que es poco probable que los usuarios comunes encuentren este problema. Pero si todavía </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">confía</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en leer todos los cambios de etcd, comenzando con la primera revisión, recuerde que necesita pasar 1, no 0. como parámetro. Nuestros experimentos muestran que una revisión cero en este caso significa "revisión actual", no "Lo más temprano".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Finalmente, los bloqueos y etcd (como todos los bloqueos distribuidos) engañan a los usuarios: pueden querer usarlos como bloqueos normales, pero se sorprenderán mucho cuando se den cuenta de que estos bloqueos no proporcionan exclusión mutua. </font><font style="vertical-align: inherit;">La documentación de la API, las publicaciones de blog, los problemas en GitHub no dicen nada sobre este riesgo. </font><font style="vertical-align: inherit;">Recomendamos que incluya información en la documentación de etcd que los bloqueos no proporcionan exclusión mutua y proporcione ejemplos de uso de tokens de barrera para actualizar el estado de los recursos compartidos en lugar de ejemplos que podrían conducir a la pérdida de actualizaciones.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.2 Planes adicionales</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El proyecto etcd se ha considerado estable durante varios años: el algoritmo Raft basado en él ha funcionado bien, la API para operaciones KV es simple y directa. Aunque algunas características adicionales han recibido recientemente una nueva API, su semántica es relativamente simple. Creemos que ya hemos estudiado suficientes comandos básicos como </font></font><code>get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>put</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, transacciones, bloqueo y seguimiento. Sin embargo, hay otras pruebas que deben realizarse. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por el momento, no hemos realizado una evaluación suficientemente detallada de las </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eliminaciones.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Puede haber casos límite asociados con versiones y revisiones, cuando los objetos se crean y eliminan constantemente. En futuras pruebas, pretendemos someter las operaciones de eliminación a un estudio más cuidadoso. Tampoco probamos las consultas de rango ni las operaciones de seguimiento con varias claves, aunque sospechamos que su semántica es similar a las operaciones con claves únicas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En las pruebas, utilizamos la suspensión de procesos, bloqueos, manipulaciones con el reloj, la red se dividió y la composición del clúster cambió; Entre bastidores había problemas como daños en el disco y otras </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fallas bizantinas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a nivel de un nodo. Estas oportunidades pueden explorarse en futuras investigaciones. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El trabajo fue apoyado por la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloud Native Computing Foundation.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, parte de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The Linux Foundation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y cumple con </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">las políticas éticas de Jepsen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Queremos agradecer al equipo de etcd por su ayuda, y a los siguientes representantes en particular: Chris Aniszczyk, Gyuho Lee, Xiang Li, Hitoshi Mitake, Jingyi Hu y Brandon Philips.</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PD del traductor</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lea también en nuestro blog:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TiKV - base de datos distribuida de valores clave para la nube nativa</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ";</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zetcd de CoreOS: Reemplazando ZooKeeper con ... almacenamiento, etcd</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ";</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KeyDB como un reemplazo [potencial] para Redis</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ";</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bases de datos y Kubernetes (revisión e informe de video)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ".</font></font></li>
</ul></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es487516/index.html">Técnicas de caza y tácticas de atacantes que usan archivos Prefetch</a></li>
<li><a href="../es487518/index.html">Productos radiactivos. Espectrómetro de rayos gamma. Parte 2</a></li>
<li><a href="../es487522/index.html">Hacemos volar la terminal (parte 1)</a></li>
<li><a href="../es487524/index.html">¿Por qué necesita un hackathon de inicio de hardware?</a></li>
<li><a href="../es487528/index.html">Изменения в пользовательском соглашении и политике конфиденциальности на сервисах Хабра</a></li>
<li><a href="../es487538/index.html">¡.NET Interactive ya está aquí! El | Vista previa de Cuadernos .NET 2</a></li>
<li><a href="../es487540/index.html">HighLoad ++, Anastasia Tsymbalyuk, Stanislav Tselovalnikov (Sberbank): cómo nos convertimos en MDA</a></li>
<li><a href="../es487542/index.html">PRESENTE: cifrado en bloque ultraligero (traducción del PRESENTE original: un cifrado en bloque ultraligero)</a></li>
<li><a href="../es487544/index.html">Documentación .NET: Novedades para enero</a></li>
<li><a href="../es487548/index.html">Nuevo experimento: llamar a los servicios .NET gRPC desde un navegador con gRPC-Web</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>