<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèø üçÑ üë®üèº‚Äç‚öñÔ∏è Acesso remoto a VMs com GPU usando Citrix üîû üåÄ üå∂Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este guia detalha as etapas que voc√™ deve executar para se preparar para o acesso remoto a √°reas de trabalho virtuais usando a tecnologia oferecida pe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Acesso remoto a VMs com GPU usando Citrix</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497818/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este guia detalha as etapas que voc√™ deve executar para se preparar para o acesso remoto a √°reas de trabalho virtuais usando a tecnologia oferecida pela Citrix. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ser√° √∫til para aqueles que se familiarizaram recentemente com a tecnologia de virtualiza√ß√£o de desktop, pois √© uma cole√ß√£o de comandos √∫teis montados em ~ 10 manuais, muitos dos quais est√£o dispon√≠veis nos sites Citrix, Nvidia, Microsoft, ap√≥s autoriza√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta implementa√ß√£o cont√©m as etapas para preparar o acesso remoto a m√°quinas virtuais (VMs) com os aceleradores gr√°ficos Nvidia Tesla M60 e o sistema operacional Centos 7.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o, vamos come√ßar.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preparando um Hipervisor para Hospedar M√°quinas Virtuais</font></font></h2><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como baixar e instalar o XenServer 7.4? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como adicionar o XenServer ao Citrix XenCenter? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como baixar e instalar o driver Nvidia? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como mudar o modo Nvidia Tesla M60? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como montar o armazenamento?</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XenServer 7.4</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O link para download do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XenServer 7.4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est√° dispon√≠vel ap√≥s autoriza√ß√£o no site da </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/eb/p2/kr/ebp2kr2edt_ktpzrhsimmkaofbi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos instalar o XenServer.iso em um servidor com 4x NVIDIA Tesla M60 de maneira regular. No meu caso, o iso √© montado via IPMI. Para servidores Dell, o BMC √© gerenciado atrav√©s do IDRAC. As etapas de instala√ß√£o s√£o quase id√™nticas √† instala√ß√£o de sistemas operacionais semelhantes ao Linux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O endere√ßo da minha GPU do XenServer c √© 192.168.1.100 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instale o XenCenter.msi no computador local a partir do qual gerenciaremos hipervisores e m√°quinas virtuais. Adicione um servidor com uma GPU e um XenServer clicando na guia "Servidor" e depois em "Adicionar". Digite o nome de usu√°rio e a senha raiz especificados durante a instala√ß√£o do XenServer.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yy/qv/qw/yyqvqwxcbnxhwkj0ho3brs1lqom.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No XenCenter, depois de clicar no nome do hipervisor adicionado, a guia Console estar√° dispon√≠vel. </font><font style="vertical-align: inherit;">No menu, selecione ‚ÄúConfigura√ß√£o de servi√ßo remoto‚Äù e ative a autoriza√ß√£o SSH - ‚ÄúAtivar / desativar o shell remoto‚Äù.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Driver Nvidia</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Darei liberdade √†s emo√ß√µes e direi que durante todo o tempo em que trabalhei com vGPU, nunca </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">visitei o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> site </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">nvid.nvidia.com</font></a><font style="vertical-align: inherit;"> na primeira tentativa. </font><font style="vertical-align: inherit;">Se a autoriza√ß√£o n√£o funcionar, recomendo o Internet Explorer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fa√ßa o download do zip do vGPU, bem como do utilit√°rio GPUMode Change: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NVIDIA-GRID-XenServer-7.4-390.72-390.75-391.81.zip </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NVIDIA-gpumodeswitch-2020-01.zip </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sj/ia/ny/sjianylmppn9as35nnxtrwj-bhw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seguimos as vers√µes. </font><font style="vertical-align: inherit;">O nome do arquivo baixado mostra a vers√£o dos drivers NVIDIA adequados que podem ser instalados em m√°quinas virtuais no futuro. </font><font style="vertical-align: inherit;">No meu caso, √© 390,72. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jogue zip-s no XenServer e descompacte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mude o modo GPU e instale o driver vGPU</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">cd</span> NVIDIA-gpumodeswitch-2020-01<font></font>
$ gpumodeswitch --listgpumodes<font></font>
$ gpumodeswitch --gpumode graphics<font></font>
$ <span class="hljs-built_in">cd</span> ../NVIDIA-GRID-XenServer-7.4-390.72-390.75-391.81<font></font>
$ yum install NVIDIA-vGPU-xenserver-7.4-390.72.x86_64.rpm<font></font>
$ reboot</code></pre><br>
<img src="https://habrastorage.org/webt/qg/0m/lx/qg0mlxigfdyfvxvfpoijuh-sisa.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Montar armazenamento</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configure um diret√≥rio compartilhado usando o NFS em qualquer computador na rede.</font></font><br>
<br>
<pre><code class="bash hljs">$ yum install epel-release<font></font>
$ yum install nfs-utils libnfs-utils<font></font>
$ systemctl <span class="hljs-built_in">enable</span> rpcbind<font></font>
$ systemctl <span class="hljs-built_in">enable</span> nfs-server<font></font>
$ systemctl <span class="hljs-built_in">enable</span> nfs-lock<font></font>
$ systemctl <span class="hljs-built_in">enable</span> nfs-idmap<font></font>
$ systemctl start rpcbind<font></font>
$ systemctl start nfs-server<font></font>
$ systemctl start nfs-lock<font></font>
$ systemctl start nfs-idmap<font></font>
$ firewall-cmd --permanent --zone=public --add-service=nfs<font></font>
$ firewall-cmd --permanent --zone=public --add-service=mountd<font></font>
$ firewall-cmd --permanent --zone=public --add-service=rpc-bind<font></font>
$ firewall-cmd --reload<font></font>
$ mkdir -p /nfs/store1<font></font>
$ chmod -R 777 /nfs/store1<font></font>
$ touch /nfs/store1/forcheck<font></font>
$ cat /etc/exports<font></font>
  ...<font></font>
  /nfs/store1 192.168.1.0/24(rw,async,crossmnt,no_root_squash,no_all_squash,no_subtree_check)<font></font>
$ systemctl restart nfs-server</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No XenCenter, selecione XenServer e selecione "New SR" na guia "Storage". </font><font style="vertical-align: inherit;">Especifique o tipo de armazenamento - NFS ISO. </font><font style="vertical-align: inherit;">O caminho deve apontar para o diret√≥rio compartilhado do NFS.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imagem mestre Citrix baseada em Centos 7</font></font></h2><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como criar uma m√°quina virtual com o Centos 7? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como preparar uma m√°quina virtual para criar um diret√≥rio?</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A imagem do Centos 7</font></font></h3><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usando o XenCenter, criaremos uma m√°quina virtual com uma GPU. </font><font style="vertical-align: inherit;">Na guia "VM", clique em "Nova VM". </font></font><br>
<br>
<img src="https://habrastorage.org/webt/et/fs/9g/etfs9g7biwgmswos8eazlinr_ba.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selecionamos os par√¢metros necess√°rios: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Modelo da VM - Outras m√≠dias de instala√ß√£o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nome - Modelo </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instala√ß√£o da biblioteca ISO - Centos 7 ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">download</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), selecione no armazenamento ISO NFS montado. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√∫mero de vCPUs - 4 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Topologia - 1 soquete com 4 n√∫cleos por soquete </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mem√≥ria - </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tipo de GPU de </font><font style="vertical-align: inherit;">30 Gb </font><font style="vertical-align: inherit;">- GRID M60-4Q </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Use este disco virtual - </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rede de </font><font style="vertical-align: inherit;">80 Gb </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s a cria√ß√£o, a m√°quina virtual aparecer√° na lista vertical √† esquerda. </font><font style="vertical-align: inherit;">Clique nele e v√° para a aba "Console". </font><font style="vertical-align: inherit;">Vamos aguardar o instalador do Centos 7 carregar e concluir as etapas necess√°rias para instalar o SO com o shell GNOME.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prepara√ß√£o da imagem</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Levei muito tempo para preparar a imagem com o Centos 7. </font><font style="vertical-align: inherit;">Isso resultou em um conjunto de scripts que facilitam a configura√ß√£o inicial do Linux e permitem criar um cat√°logo de m√°quinas virtuais usando o Citrix Machine Creation Services (MCS). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O servidor DHCP instalado no ws-ad atribuiu o endere√ßo IP 192.168.1.129 √† nova m√°quina virtual. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A seguir est√£o as configura√ß√µes b√°sicas.</font></font><br>
<br>
<pre><code class="bash hljs">$ hostnamectl <span class="hljs-built_in">set</span>-hostname template<font></font>
$ yum install -y epel-release<font></font>
$ yum install -y lsb mc gcc<font></font>
$ firewall-cmd --permanent --zone=dmz --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=external --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=home --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=home --remove-service=mdns<font></font>
$ firewall-cmd --permanent --zone=home --remove-service=samba-client<font></font>
$ firewall-cmd --permanent --zone=home --remove-service=dhcpv6-client<font></font>
$ firewall-cmd --permanent --zone=internal --remove-service=dhcpv6-client<font></font>
$ firewall-cmd --permanent --zone=internal --remove-service=samba-client<font></font>
$ firewall-cmd --permanent --zone=internal --remove-service=mdns<font></font>
$ firewall-cmd --permanent --zone=internal --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=public --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=public --remove-service=dhcpv6-client<font></font>
$ firewall-cmd --permanent --zone=work --remove-service=dhcpv6-client<font></font>
$ firewall-cmd --permanent --zone=work --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=public --add-service=ssh<font></font>
$ firewall-cmd --complete-reload</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No XenCenter, na guia "Console", monte guest-tools.iso na unidade de DVD da m√°quina virtual e instale o XenTools for Linux.</font></font><br>
<br>
<pre><code class="bash hljs">$ mount /dev/cdrom /mnt<font></font>
$ /mnt/Linux/install.sh<font></font>
$ reboot</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao configurar o XenServer, usamos o arquivo NVIDIA-GRID-XenServer-7.4-390.72-390.75-391.81.zip baixado do site da NVIDIA, que, al√©m do driver da NVIDIA para o XenServer, cont√©m o driver da NVIDIA necess√°rio para os clientes vGPU. </font><font style="vertical-align: inherit;">Fa√ßa o download e instale-o na VM.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat /etc/default/grub<font></font>
  GRUB_TIMEOUT=5<font></font>
  GRUB_DISTRIBUTOR=<span class="hljs-string">"<span class="hljs-subst">$(sed 's, release .*$,,g' /etc/system-release)</span>"</span><font></font>
  GRUB_DEFAULT=saved<font></font>
  GRUB_DISABLE_SUBMENU=<span class="hljs-literal">true</span>
  GRUB_TERMINAL_OUTPUT=<span class="hljs-string">"console"</span>
  GRUB_CMDLINE_LINUX=<span class="hljs-string">"rhgb quiet modprobe.blacklist=nouveau"</span>
  GRUB_DISABLE_RECOVERY=<span class="hljs-string">"true"</span><font></font>
$ grub2-mkconfig -o /boot/grub2/grub.cfg<font></font>
$ wget http://vault.centos.org/7.6.1810/os/x86_64/Packages/kernel-devel-3.10.0-957.el7.x86_64.rpm<font></font>
$ yum install kernel-devel-3.10.0-957.el7.x86_64.rpm<font></font>
$ reboot<font></font>
$ init 3<font></font>
$ NVIDIA-GRID-XenServer-7.4-390.72-390.75-391.81/NVIDIA-Linux-x86_64-390.75-grid.run<font></font>
$ cat /etc/nvidia/gridd.conf<font></font>
  ServerAddress=192.168.1.111<font></font>
  ServerPort=7070<font></font>
  FeatureType=1<font></font>
$ reboot</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fa√ßa o download do Linux Virtual Delivery Agent 1811 (VDA) para Centos 7. O link de download do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linux VDA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est√° dispon√≠vel ap√≥s autoriza√ß√£o no site da </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="bash hljs">$ yum install -y LinuxVDA-1811.el7_x.rpm<font></font>
$ cat /var/xdl/mcs/mcs.conf<font></font>
  <span class="hljs-comment">#!/bin/bash</span><font></font>
  dns1=192.168.1.110<font></font>
  NTP_SERVER=some.ntp.ru<font></font>
  AD_INTEGRATION=winbind<font></font>
  SUPPORT_DDC_AS_CNAME=N<font></font>
  VDA_PORT=80<font></font>
  REGISTER_SERVICE=Y<font></font>
  ADD_FIREWALL_RULES=Y<font></font>
  HDX_3D_PRO=Y<font></font>
  VDI_MODE=Y<font></font>
  SITE_NAME=domain.ru<font></font>
  LDAP_LIST=ws-ad.domain.ru<font></font>
  SEARCH_BASE=DC=domain,DC=ru<font></font>
  START_SERVICE=Y<font></font>
$ /opt/Citrix/VDA/sbin/deploymcs.sh<font></font>
$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"exclude=kernel* xorg*"</span> &gt;&gt; /etc/yum.conf</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No Citrix Studio, crie o grupo Machine Catalog and Delivery. </font><font style="vertical-align: inherit;">Antes disso, voc√™ deve instalar e configurar o Windows Server.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows Server com controlador de dom√≠nio</font></font></h2><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como baixar e instalar o Windows Server 2016? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como instalar componentes do Windows Server? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como configurar o Active Directory, DHCP e DNS?</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servidor Windows 2016</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como uma m√°quina virtual (VM) com Windows Server n√£o precisa de uma GPU, usaremos um servidor sem uma GPU como um hypervisor. Por analogia com a descri√ß√£o acima, instale outro XenServer para hospedar m√°quinas virtuais do sistema. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois disso, crie uma m√°quina virtual para Windows Server com Active Directory. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baixe o Windows Server 2016 no site da </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microsoft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . √â melhor seguir o link usando o Internet Explorer. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9t/u3/br/9tu3brk0d6qqy6k6drtf7gd2sig.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usando o XenCenter, criaremos uma m√°quina virtual. Na guia "VM", clique em "Nova VM". </font></font><br>
<br>
<img src="https://habrastorage.org/webt/im/ea/yf/imeayf3rgvlrpaq4kqer_ofoei0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selecionamos os par√¢metros necess√°rios: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Modelo da VM - Windows Server 2016 (64 bits) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nome - ws-ad.domain.ru </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instale da biblioteca ISO - WindowsServer2016.iso, selecione no armazenamento ISO NFS montado. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√∫mero de vCPUs - 4</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Topologia - 1 soquete com 4 n√∫cleos por soquete </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mem√≥ria - </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tipo de GPU de </font><font style="vertical-align: inherit;">20 Gb </font><font style="vertical-align: inherit;">- nenhum </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Use este disco virtual - </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rede de </font><font style="vertical-align: inherit;">100 Gb </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s a cria√ß√£o, a m√°quina virtual aparecer√° na lista vertical √† esquerda. Clique nele e v√° para a aba "Console". Aguarde o instalador do Windows Server carregar e conclua as etapas necess√°rias para instalar o sistema operacional. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instale na VM do XenTools. Clique com o bot√£o direito do mouse em VM e, em seguida, em "Instalar Citrix VM Tools ...". Depois disso, a imagem que voc√™ precisa para executar e instalar o XenTools ser√° montada. No final da instala√ß√£o, ser√° necess√°ria uma reinicializa√ß√£o da VM. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configure o adaptador de rede: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Endere√ßo IP - 192.168.1.110 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
M√°scara - 255.255.255.0 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gateway - 192.168.1.1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DNS1 - 8.8.8.8 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DNS2 - 8.8.4.4</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se o Windows Server n√£o estiver ativado, ative. </font><font style="vertical-align: inherit;">A chave pode ser tirada no mesmo local em que a imagem foi baixada.</font></font><br>
<br>
<pre><code class="bash hljs">[PowerShell]$ slmgr -ipk xxxxx-xxxxx-xxxxx-xxxxx-xxxxx</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configure o nome do computador. </font><font style="vertical-align: inherit;">No meu caso, isso √© ws-ad.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instala√ß√£o de componentes</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No gerenciador do servidor, selecione "Adicionar fun√ß√µes e recursos". </font><font style="vertical-align: inherit;">Observe a instala√ß√£o do servidor DHCP, servidor DNC e servi√ßos de dom√≠nio do Active Directory. </font><font style="vertical-align: inherit;">Marque a caixa "Recarregar automaticamente".</font></font><br>
<br>
<img src="https://habrastorage.org/webt/r2/5c/mk/r25cmkhjpon52zta-7ysbpffyig.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurar Diret√≥rio Ativo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s reiniciar a VM, clique em "Elevar este servidor ao n√≠vel do controlador de dom√≠nio" e adicione uma nova floresta domain.ru.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configura√ß√£o do servidor DHCP</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No painel superior do gerenciador do servidor, clique no ponto de exclama√ß√£o para salvar as altera√ß√µes ao instalar o servidor DHCP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos seguir para as configura√ß√µes do servidor DHCP. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wf/t6/pg/wft6pgjw4_lxdcvqa0rkphy4hhe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Crie uma nova √°rea 192.168.1.120-130. </font><font style="vertical-align: inherit;">N√≥s n√£o mudamos o resto. </font><font style="vertical-align: inherit;">Selecione ‚ÄúDefinir configura√ß√µes do DHCP agora‚Äù e insira o endere√ßo IP ws-ad (192.168.1.110) como gateway e DNS, que ser√° especificado nas configura√ß√µes dos adaptadores de rede das m√°quinas virtuais no diret√≥rio</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configura√ß√£o do servidor DNS</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos seguir para as configura√ß√µes do servidor DNS. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sg/pc/kc/sgpckcwrrfz4z-6jy5pf0ibbnbo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos criar uma nova zona de visualiza√ß√£o direta - zona prim√°ria, para todos os servidores DNS no dom√≠nio domain.ru. </font><font style="vertical-align: inherit;">N√£o mude mais nada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Crie uma nova zona de pesquisa inversa selecionando as mesmas op√ß√µes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nas propriedades do servidor DNS, na guia "Avan√ßado", marque a caixa de sele√ß√£o "Desativar recurs√£o".</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Crie um usu√°rio de teste</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos para o "Centro Administrativo do Active Directory" </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tp/4s/si/tp4ssidqmpefwnpa1excc5oexii.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na se√ß√£o "Usu√°rios" √† direita, clique em "Criar". </font><font style="vertical-align: inherit;">Digite um nome, por exemplo, teste e clique em OK abaixo. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/b-/vd/pm/b-vdpmjw8osh9g0tor-ab0jl4sg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos selecionar o usu√°rio criado e selecionar "Redefinir senha" no menu vertical √† direita. </font><font style="vertical-align: inherit;">Deixe a marca de sele√ß√£o "Exigir altera√ß√£o de senha na pr√≥xima vez que fizer logon no sistema".</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows Server com Citrix Delivery Controller</font></font></h2><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como baixar e instalar o Windows Server 2016? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como baixar e instalar o Citrix Delivery Controller? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como instalar e configurar o Citrix License Manager? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como instalar e configurar o NVIDIA License Manager?</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servidor Windows 2016</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como uma m√°quina virtual (VM) com Windows Server n√£o precisa de uma GPU, usaremos um servidor sem uma GPU como um hypervisor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baixe o Windows Server 2016 no site da </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microsoft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . √â melhor seguir o link usando o Internet Explorer. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9t/u3/br/9tu3brk0d6qqy6k6drtf7gd2sig.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usando o XenCenter, criaremos uma m√°quina virtual. Na guia "VM", clique em "Nova VM". </font></font><br>
<br>
<img src="https://habrastorage.org/webt/im/ea/yf/imeayf3rgvlrpaq4kqer_ofoei0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selecione os par√¢metros necess√°rios: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Modelo da VM - </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nome do </font><font style="vertical-align: inherit;">Windows Server 2016 (64 bits) </font><font style="vertical-align: inherit;">- ws-dc </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instale a partir da biblioteca ISO - WindowsServer2016.iso, selecione no armazenamento ISO NFS montado. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√∫mero de vCPUs - 4 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Topologia - 1 soquete com 4 n√∫cleos por soquete </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mem√≥ria - </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tipo de GPU de </font><font style="vertical-align: inherit;">20 Gb </font><font style="vertical-align: inherit;">- nenhum </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Use este disco virtual - </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rede de </font><font style="vertical-align: inherit;">100 Gb</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s a cria√ß√£o, a m√°quina virtual aparecer√° na lista vertical √† esquerda. Clique nele e v√° para a aba "Console". Vamos aguardar o instalador do Windows Server carregar e concluir as etapas necess√°rias para instalar o sistema operacional. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instale na VM do XenTools. Clique com o bot√£o direito do mouse em VM e, em seguida, em "Instalar Citrix VM Tools ...". Depois disso, a imagem que voc√™ precisa para executar e instalar o XenTools ser√° montada. No final da instala√ß√£o, ser√° necess√°ria uma reinicializa√ß√£o da VM. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configure o adaptador de rede: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Endere√ßo IP - 192.168.1.111 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
M√°scara - 255.255.255.0 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gateway - 192.168.1.1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DNS1 - 8.8.8.8 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DNS2 - 8.8.4.4 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se o Windows Server n√£o estiver ativado, n√≥s o ativaremos. A chave pode ser tirada no mesmo local em que a imagem foi baixada.</font></font><br>
<br>
<pre><code class="bash hljs">[PowerShell]$ slmgr -ipk xxxxx-xxxxx-xxxxx-xxxxx-xxxxx</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configure o nome do computador. </font><font style="vertical-align: inherit;">No meu caso, isso √© ws-dc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adicione a VM ao dom√≠nio domen.ru, reinicie e fa√ßa login na conta de administrador do dom√≠nio DOMEN \ Administrator.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controlador de entrega Citrix</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fa√ßa o download do Citrix Virtual Apps and Desktops 1811 em ws-dc.domain.com. </font><font style="vertical-align: inherit;">O link de download do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix Virtual Apps and Desktops</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est√° dispon√≠vel ap√≥s o login no site da </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ik/wy/--/ikwy--onnx7q_qlpdy8jjrn9_qi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Monte o iso baixado e execute. </font><font style="vertical-align: inherit;">Escolha Citrix Virtual Apps and Desktops 7. </font><font style="vertical-align: inherit;">Em seguida, clique em "Introdu√ß√£o". </font><font style="vertical-align: inherit;">Uma reinicializa√ß√£o pode ser necess√°ria. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/po/-l/x5/po-lx5nd34-fuw7gibvgajcg42w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No meu caso, basta selecionar os seguintes componentes para instala√ß√£o: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Delivery Controller </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Studio </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
License Server </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
StoreFront </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√£o altere mais nada e clique em "Instalar". </font><font style="vertical-align: inherit;">Uma reinicializa√ß√£o ser√° necess√°ria mais de uma vez, ap√≥s o que a instala√ß√£o continuar√°. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim que a instala√ß√£o estiver conclu√≠da, o Citrix Studio, o ambiente de gerenciamento de fazenda Citrix, ser√° iniciado.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tp/4q/_x/tp4q_xeo9tdviobu4zaannj-vfk.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configura√ß√£o do site Citrix</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Escolha a primeira se√ß√£o da configura√ß√£o de tr√™s sites. </font><font style="vertical-align: inherit;">Ao definir, especifique o Nome do Site - dom√≠nio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na se√ß√£o ‚ÄúConex√£o‚Äù, especificamos os dados para conectar o hipervisor √† GPU: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Endere√ßo da conex√£o - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">192.168.1.100</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nome do usu√°rio - raiz </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Senha - sua senha Senha </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nome da conex√£o - m60 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gerenciamento de armazenamento - Use armazenamento local para o hipervisor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nome para esses recursos - m60. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selecione redes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selecione um tipo e grupo de GPU - GRID M60-4Q.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajustando cat√°logos de m√°quinas Citrix</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao configurar a segunda se√ß√£o - Cat√°logos de m√°quinas, selecione SO de sess√£o √∫nica (SO de √°rea de trabalho). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imagem mestra - selecionaremos a imagem preparada da m√°quina virtual e a vers√£o do Citrix Virtual Apps and Desktops - 1811. Selecionaremos o </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
n√∫mero de m√°quinas virtuais no diret√≥rio, por exemplo 4. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Indicaremos o esquema pelo qual as m√°quinas virtuais ser√£o nomeadas; no meu caso, essa √© a √°rea de trabalho ##. </font><font style="vertical-align: inherit;">Nesse caso, ser√£o criadas 4 VMs com os nomes desktop01-04. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nome do cat√°logo de m√°quinas - m60. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Descri√ß√£o do cat√°logo de m√°quinas - m60. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s criar o Cat√°logo de M√°quinas com quatro VMs, elas podem ser encontradas na lista vertical do XenCenter, √† esquerda.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix Delivery Group</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A terceira se√ß√£o come√ßa selecionando o n√∫mero de VMs √†s quais o acesso deve ser concedido. </font><font style="vertical-align: inherit;">Vou indicar todos os quatro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na se√ß√£o "√Åreas de trabalho", clique em "Adicionar" para adicionar o grupo de VMs ao qual forneceremos acesso. </font><font style="vertical-align: inherit;">Nome de exibi√ß√£o - m60. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nome do grupo de entrega - m60. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s configurar as tr√™s se√ß√µes principais, a janela principal do Citrix Studio ser√° semelhante a esta</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kb/s3/up/kbs3up5h_utcj8db_caznbwgo_i.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gerenciador de licen√ßas Citrix</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fa√ßa o download do arquivo de licen√ßa atrav√©s da sua conta pessoal no site da </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na lista vertical √† esquerda, selecione Todas as ferramentas de licenciamento (herdadas). V√° para a aba "Ativar e alocar licen√ßas". Selecione licen√ßas Citrix VDA e clique em Continuar. Especifique o nome do nosso Delivery Controllera - ws-dc.domain.ru e o n√∫mero de licen√ßas - 4. Clique em "Continuar". Fa√ßa o download do arquivo de licen√ßa gerado para ws-dc.domain.ru. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-f/6o/tg/-f6otgoimp8n0qh_xdcrfvf5hew.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na lista vertical esquerda do Citrix Studio, selecione a se√ß√£o "Licenciamento". Na lista vertical direita, clique em "Console de Gerenciamento de Licen√ßas". Na janela do navegador que √© aberta, insira os dados para autoriza√ß√£o do usu√°rio do dom√≠nio DOMEN \ Administrator. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No Citrix Licensing Manager, v√° para a guia "Instalar licen√ßa". Para adicionar um arquivo de licen√ßa, selecione "Usar arquivo de licen√ßa baixado".</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bo/sy/rz/bosyrz3sj4ysmjs0vlwfhcp36ki.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A instala√ß√£o dos componentes Citrix envolve o uso de v√°rias m√°quinas virtuais, um componente - uma VM. </font><font style="vertical-align: inherit;">No meu caso, todos os servi√ßos do sistema Citrix operam na mesma VM. </font><font style="vertical-align: inherit;">A esse respeito, noto um bug, cuja corre√ß√£o foi especialmente dif√≠cil para mim. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se ap√≥s a reinicializa√ß√£o do ws-dc houver problemas de natureza diferente, recomendamos que voc√™ verifique primeiro os servi√ßos em execu√ß√£o. </font><font style="vertical-align: inherit;">Aqui est√° uma lista de servi√ßos Citrix que devem iniciar automaticamente ap√≥s a reinicializa√ß√£o da VM:</font></font><br>
<br>
<pre><code class="plaintext hljs">SQL Server (SQLEXPRESS)<font></font>
Citrix Configuration Service<font></font>
Citrix Delegated Administration Service<font></font>
Citrix Analytics<font></font>
Citrix Broker Service<font></font>
Citrix Configuration Logging Service<font></font>
Citrix AD Identity Service<font></font>
Citrix Host Service<font></font>
Citrix App Library<font></font>
Citrix Machine Creation Service<font></font>
Citrix Monitor Service<font></font>
Citrix Storefront Service<font></font>
Citrix Trust Service<font></font>
Citrix Environment Test Service<font></font>
Citrix Orchestration Service<font></font>
FlexNet License Server -nvidia</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encontrei um problema que ocorre ao instalar v√°rios servi√ßos Citrix em uma √∫nica VM. </font><font style="vertical-align: inherit;">Ap√≥s uma reinicializa√ß√£o, nem todos os servi√ßos s√£o iniciados. </font><font style="vertical-align: inherit;">Um por um para lan√ßar toda a cadeia foi pregui√ßa. </font><font style="vertical-align: inherit;">A solu√ß√£o foi pesquisada no Google, ent√£o eu a trago para c√° - dois par√¢metros devem ser alterados no registro:</font></font><br>
<br>
<pre><code class="bash hljs">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control<font></font>
Name : ServicesPipeTimeout<font></font>
Value :240000<font></font>
<font></font>
Name : WaitToKillServiceTimeout<font></font>
Value : 20000</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gerenciador de licen√ßas Nvidia</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fa√ßa o download do NVIDIA License Manager para Windows atrav√©s da sua conta pessoal em </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nvid.nvidia.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . √â melhor passar pelo Internet Explorer. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/au/hb/ih/auhbihphsv81hapm3cpgpxjbcmi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instale-o no ws-dc. Para fazer isso, primeiro voc√™ precisa instalar o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JAVA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e incluir a vari√°vel de ambiente JAVA_HOME. Depois disso, voc√™ pode executar o setup.exe para instalar o NVIDIA License Manager. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nv/bd/wu/nvbdwuyf4xtx-fsqqpa2qwzunke.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos criar um servidor, gerar e baixar o arquivo de licen√ßa em sua conta pessoal no site </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nvid.nvidia.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Vamos transferir o arquivo de licen√ßa para ws-dc. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/r-/ui/zb/r-uizbl706_p1w35j27fk0lv2wu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usando um navegador, </font><font style="vertical-align: inherit;">efetuamos </font><font style="vertical-align: inherit;">login na interface da web do gerenciador de licen√ßas da NVIDIA, dispon√≠vel em </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localhost</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 8080 / licserver e adicionamos um arquivo de licen√ßa. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vi/ut/oc/viutocj16sitn-q_diao-oehmfa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As sess√µes ativas usando vGPU podem ser visualizadas na se√ß√£o Clientes Licenciados.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acesso remoto ao cat√°logo de m√°quinas Citrix</font></font></h2><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como instalar o Citrix Receiver? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como se conectar a uma √°rea de trabalho virtual? </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No computador de trabalho, abra um navegador, no meu caso, √© o Chrome e v√° para o endere√ßo da interface da web do Citrix StoreWeb</font></font><br>
<br>
<pre><code class="bash hljs">http://192.168.1.111/Citrix/StoreWeb</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se o Citrix Recever ainda n√£o estiver instalado, clique em "Discover Receiver". </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ri/iv/nh/riivnhuygym-oivw0iaq0hghr_g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lemos cuidadosamente o contrato de licen√ßa, </font><font style="vertical-align: inherit;">baixamos </font><font style="vertical-align: inherit;">e instalamos o Citrix Receiver. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/r3/9b/cd/r39bcddyu-e57s9tpk6gj-o19vg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s a instala√ß√£o, volte ao navegador e clique em "Continue". Em </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ia/vw/dg/iavwdgrxnyukfifcb03b0gvbyf4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
seguida, uma notifica√ß√£o √© aberta no navegador Chrome, clique em "Abrir aplicativo Citrix Receiver Launcher" e, em seguida, "Detectar novamente" ou "J√° instalado". </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7o/hs/bx/7ohsbxmdogzv7tvdwji5xwa1xam.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para a primeira conex√£o, usaremos os dados do teste do usu√°rio de teste. </font><font style="vertical-align: inherit;">Mude a senha tempor√°ria para uma permanente. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/as/9k/l0/as9kl0vlibg4fmhts2rjgrsupvw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s a autoriza√ß√£o, v√° para a guia "Aplicativos" e selecione o </font></font><br>
<br>
<img src="https://habrastorage.org/webt/j9/fb/md/j9fbmdbevvo42-2su76ifsaisnk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
diret√≥rio </font><font style="vertical-align: inherit;">"M60" </font><font style="vertical-align: inherit;">Fa√ßa o download do arquivo proposto com a extens√£o .ica. </font><font style="vertical-align: inherit;">Ap√≥s clicar duas vezes nele, uma janela √© aberta no Desktop Veiwer com o Centos 7</font></font><br>
<br>
<img src="https://habrastorage.org/webt/n2/70/3p/n2703pzygelapwl6ixj7n5wcgfm.png"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt497808/index.html">3D fa√ßa voc√™ mesmo. Parte 2: √© tridimensional</a></li>
<li><a href="../pt497810/index.html">PVS Studio.VS. An√°lise estat√≠stica do GCC 10. Mini-teste independente</a></li>
<li><a href="../pt497812/index.html">Cientistas do MIT est√£o desenvolvendo um dispositivo que permitir√° controlar pelo menos parcialmente seus sonhos</a></li>
<li><a href="../pt497814/index.html">Cinco est√°gios de aceita√ß√£o do inevit√°vel, ou Como desenvolvemos um programa para cria√ß√£o de perfil automatizado</a></li>
<li><a href="../pt497816/index.html">A Russian Railways me envia os bilhetes de outra pessoa</a></li>
<li><a href="../pt497820/index.html">Regulariza√ß√£o estat√≠stica de problemas inversos incorretos para eles. Turchin (parte 1)</a></li>
<li><a href="../pt497822/index.html">Homem garrafa</a></li>
<li><a href="../pt497826/index.html">Como capturar rapidamente o mundo ou gerenciar uma rede de computadores Windows usando o OPSI</a></li>
<li><a href="../pt497828/index.html">2 em 1: criptografia com prote√ß√£o de seguran√ßa</a></li>
<li><a href="../pt497830/index.html">Grava√ß√µes OWASP Moscow 2020/1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>