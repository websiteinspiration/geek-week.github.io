<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙇 🏖️ ⛹🏾 Jelajahi bug iOS dengan Hopper 😯 🎮 ☃️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo! Nama saya Alexander Nikishin, saya sedang mengembangkan aplikasi iOS di Badoo. Dalam artikel itu, saya akan berbicara tentang bagaimana kami men...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Jelajahi bug iOS dengan Hopper</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/badoo/blog/504084/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Halo! Nama saya Alexander Nikishin, saya sedang mengembangkan aplikasi iOS di Badoo. Dalam artikel itu, saya akan berbicara tentang bagaimana kami menyelidiki bug di UIKit, yang tidak ingin diperbaiki Apple selama enam bulan. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tm/mh/ea/tmmheaww_pwtz36zltfmiyqgadu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semuanya dimulai pada Agustus 2019 dengan versi beta pertama dari iOS 13. Kemudian kami pertama kali menemui masalah. Dalam aplikasi Badoo dan Bumble, kami terus berupaya meningkatkan antarmuka dan, misalnya, kami mencoba mengoptimalkan proses pendaftaran yang membosankan dan tidak dicintai sebanyak mungkin. Tooltip prediktif sistematis di atas keyboard adalah cara terbaik untuk mengurangi jumlah klik pengguna saat memasukkan data. Namun, dalam versi baru iOS, kami terkejut menemukan bahwa permintaan untuk memasukkan nomor telepon hilang.</font></font><br>
<a name="habracut"></a><br>
<img src="https://habrastorage.org/webt/qh/qe/tp/qhqetpwinu9_mvbd5gms1dyrvu0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketika versi GM keluar, kami menyadari bahwa masalahnya tidak diperbaiki. Tampaknya bagi kami bahwa bug yang sangat jelas tidak dapat dilewatkan oleh tes regresi, yang mungkin dimiliki Apple di gudang persenjataannya, dan kami mulai menunggu koreksi dalam paket pembaruan besar pertama. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengembang lain berharap untuk</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ini </font><font style="vertical-align: inherit;">. Namun, dengan merilis versi 13.1, tidak ada yang berubah, dan kami tidak punya pilihan selain membuka radar, yang kami lakukan pada awal Oktober. Waktu berlalu, iOS 13.2 dan 13.3 keluar, dan bug itu tetap tidak diperbaiki. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada bulan Februari, tim pendaftaran kami mendapat waktu luang dari mengerjakan backlog, dan saya memutuskan untuk menyelidiki masalah ini sedikit lebih dalam.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebelum Anda mulai menggali, Anda harus mencari cara untuk melakukannya. Karena petunjuk terus bekerja pada beberapa jenis keyboard, pemikiran pertama adalah mempelajari hierarki pandangannya di berbagai versi iOS. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mv/sw/px/mvswpxpjqpsfjh2bqdcn1vlz8sk.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iOS 12 vs iOS 13</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Segera menjadi jelas bahwa Apple di iOS 13 refactored implementasi keyboard dan menyorot petunjuk di pengontrol terpisah ( </font></font><code>UIPredictionViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). Jelas, kecenderungan modularisasi dan dekomposisi juga telah mencapainya (omong-omong, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artyom Loenko</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> baru-baru ini </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">berbicara</font></a><font style="vertical-align: inherit;"> tentang pengalaman kami dalam aplikasi mereka </font><font style="vertical-align: inherit;">). Kemungkinan besar, karena ini, ada regresi fungsi. Lingkaran pencarian mulai menyempit.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya pikir sebagian besar pengembang iOS tahu bahwa mudah untuk menemukan antarmuka kelas sistem pribadi di domain publik: cukup masukkan satu permintaan di mesin pencari. Dalam studi tentang </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">antarmuka kelas</font></font></a> <code>UIPredictionViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di mata menangkap salah satu metodenya: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ex/vt/ry/exvtrycfpe8qra7wrgux5khrqka.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tampaknya ada petunjuk, yang cukup mudah untuk diperiksa, menggunakan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fungsi implementasi spoofing</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> alat lama yang baik </font><font style="vertical-align: inherit;">(Swizzling). Kami akan menggunakannya sehingga fungsi yang "dicurigai" selalu mengembalikan nilai sebenarnya:</font></font><br>
<br>
<pre><code class="objectivec hljs">+(<span class="hljs-keyword">void</span>)swizzleIsVisibleForInputDelegate {<font></font>
    SEL targetSelector = sel_getUid(<span class="hljs-string">"isVisibleForInputDelegate:inputViews:"</span>);<font></font>
    Class targetClass = <span class="hljs-built_in">NSClassFromString</span>(@”<span class="hljs-built_in">UIPredictionViewController</span>”);
    <span class="hljs-keyword">if</span> (targetClass == <span class="hljs-literal">nil</span>) {
        <span class="hljs-keyword">return</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (![targetClass instancesRespondToSelector:targetSelector]) {
        <span class="hljs-keyword">return</span>;<font></font>
    }<font></font>
<font></font>
    Method method = class_getInstanceMethod(targetClass, targetSelector);<font></font>
    <span class="hljs-keyword">if</span> (method == <span class="hljs-literal">NULL</span>) {
        <span class="hljs-keyword">return</span>;<font></font>
    }<font></font>
<font></font>
    IMP originalImplementation = method_getImplementation(method);<font></font>
    IMP newImp = imp_implementationWithBlock(^<span class="hljs-built_in">BOOL</span>(<span class="hljs-keyword">id</span> me, <span class="hljs-keyword">id</span> delegate, <span class="hljs-keyword">id</span> views) {
        <span class="hljs-comment">//   ,        . </span>
        <span class="hljs-built_in">BOOL</span> result = ((<span class="hljs-keyword">bool</span> (*)(<span class="hljs-keyword">id</span>,SEL,<span class="hljs-keyword">id</span>,<span class="hljs-keyword">id</span>))originalImplementation)(me, targetSelector, delegate, views);
        <span class="hljs-keyword">if</span> ([delegate isKindOfClass:[<span class="hljs-built_in">UITextField</span> <span class="hljs-keyword">class</span>]] &amp;&amp; [delegate keyboardType] == <span class="hljs-built_in">UIKeyboardTypePhonePad</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">YES</span>;<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> result;<font></font>
    });<font></font>
<font></font>
    method_setImplementation(method, newImp);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mulai ulang proyek uji, saya menemukan bahwa permintaan telepon kembali ke iOS 13 dan bekerja "dalam mode normal". Hal ini dapat mengakhiri penyelidikan dan mungkin bahkan dengan sangat hati-hati menggunakan solusi pedoman Apple yang berbahaya dan terlarang ini dalam perakitan rilis dengan kemampuan untuk mengaktifkan / menonaktifkan dari jarak jauh untuk beberapa pengguna (untuk opsi manajemen fitur jarak jauh, Anda dapat melihat </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rekaman laporan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> rekan saya Katerina Trofimenko). Namun demikian, saya tidak pernah berhenti bertanya-tanya mengapa fungsi ini kembali salah ketika menggunakan jenis telepon keyboard.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk sampai pada kebenaran, kita membutuhkan kode sumber fungsi. Jelas, Apple tidak mendistribusikan kode komponen iOS ke kanan dan kiri, jadi tidak mungkin untuk google itu. Hanya ada satu cara yang tersisa - rekayasa terbalik untuk mendekompilasi kode biner. Sebelumnya, saya telah mendengar tentang produk seperti </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hopper</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> beberapa kali dan membaca beberapa artikel tentang penggunaannya untuk menggali lebih dalam di bawah kap perpustakaan sistem, tetapi saya tidak pernah menggunakannya sendiri. Dan segera saya terkejut: ternyata untuk bermain-main dan mempelajari alat-alatnya, bahkan tidak perlu membeli versi lengkap. Versi demo mencakup sesi kerja 30 menit tanpa akhir tanpa kemampuan untuk menyimpan indeks dan membuat perubahan pada file biner, yang berarti itu adalah platform yang sangat baik untuk eksperimen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semuanya sama</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diterbitkan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> antarmuka pribadi, Anda dapat mengetahui apa yang </font></font><code>UIPredictionViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">merupakan bagian dari kerangka kerja UIKitCore. Yang tersisa hanyalah menemukannya dan mengunggahnya ke Hopper. File framework biner terletak di kedalaman Xcode. Di sini, misalnya, adalah path lengkap ke UIKitCore yang kita butuhkan:</font></font><br>
<br>
<pre><code class="plaintext hljs">/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Library/Developer/CoreSimulator/Profiles/Runtimes/iOS.simruntime/Contents/Resources/RuntimeRoot/System/Library/PrivateFrameworks/UIKitCore.framework/UIKitCore</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami membuat file seret-dan-jatuhkan di Hopper, mengkonfirmasi tindakan dalam dialog sistem dan menunggu pengindeksan selesai (dalam kasus kerangka besar seperti UIKit, ini bisa memakan waktu dari empat hingga enam menit). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Antarmuka program ini cukup sederhana, saya hanya akan mencatat elemen kunci yang diperlukan untuk penelitian saya. </font><font style="vertical-align: inherit;">Di panel kiri antarmuka Anda dapat menemukan baris pencarian melalui mana kode navigasikan. </font><font style="vertical-align: inherit;">Dengan mencari nama kelas yang kami minati, kami dengan cepat mendapatkan fungsi yang sedang dipelajari, kode assemblernya terbuka di jendela utama. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gi/qf/94/giqf94bvzg42e1zspxys3880gy4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di bilah tugas atas ada tombol untuk beralih mode tampilan kode. </font><font style="vertical-align: inherit;">Dari kiri ke kanan:</font></font><br>
<br>
<img width="200" src="https://habrastorage.org/webt/ho/i-/ig/hoi-igmtwupaitvjpqolbwckmya.png"><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mode ASM - kode assembler;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mode CFG - kode assembler dalam bentuk diagram blok (pohon), tempat potongan kode digabungkan menjadi blok, dan transisi ditampilkan sebagai cabang;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mode pseudo-code - kode pseudo yang dihasilkan (kita akan membicarakan lebih lanjut di bawah ini);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mode hex adalah representasi hexadecimal dari file biner, atau abracadabra, yang tidak banyak membantu kami dalam penelitian kami.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang Anda perlu mencari tahu apa yang terjadi di dalam fungsi. </font><font style="vertical-align: inherit;">Tubuhnya cukup panjang, jadi hanya guru ASM, yang aku tidak bisa menyebut diriku, dapat memahami logika dengan melihat kode assembler. </font><font style="vertical-align: inherit;">Untuk melakukan ini, mode kode semu akan membantu, di mana Hopper menyederhanakan operasi perakitan sebanyak mungkin, mengganti nama fungsi nyata di mana mungkin dan menggunakan nama register seperti variabel. </font><font style="vertical-align: inherit;">Kelihatannya seperti ini: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ph/0w/cy/ph0wcy7eq21kozwiapjtw3mihuu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetap hanya untuk pergi melalui logika fungsi dan memahami cabang mana yang kita masuki. </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">Symbolic Breakpoints</font></a><font style="vertical-align: inherit;"> membantu saya dengan ini.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, yang dapat diinstal pada panggilan sistem, secara bersamaan mencetak semua variabel yang diperlukan dan hasil panggilan fungsi ke konsol Xcode. Dengan menggunakan cara sederhana ini, saya menemukan bahwa pelaksanaan fungsi terganggu oleh keluar awal karena fakta bahwa salah satu kondisi tidak berfungsi dalam contoh kode blok. Mari kita cari tahu apa yang terjadi di sini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sedikit konteks: di rbx register sedikit lebih tinggi dalam kode (yang saya hilangkan untuk kesederhanaan) adalah tautan ke objek yang mengimplementasikan protokol </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">UITextInputTraits_Private</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(ini adalah versi lanjutan dari protokol publik </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">UITextInputTraits</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, kondisi pertama adalah untuk memverifikasi bahwa prompt tidak disembunyikan oleh konfigurasi kolom input. Dalam debug, Anda dapat melihat bahwa ia menjalankan: properti</font></font><code>hidePrediction</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mengembalikan salah. Kondisi kedua adalah memverifikasi bahwa keyboard tidak dalam mode "split" (di iPad Anda, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tarik tombol kanan bawah ke atas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , hanya 2-3% pengguna yang tahu tentang hal ini). Dengan ini juga, semuanya beres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berpindah. Pada tahap selanjutnya, manipulasi dengan permulaan </font></font><code>keyboardType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, yang mengisyaratkan kepada kita bahwa kebenaran ada di suatu tempat di dekatnya. Pertama kali diperiksa bahwa yang sekarang </font></font><code>keyboardType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kurang dari atau sama dengan 0xb (atau 11 dalam format desimal). Jika kita membuka deklarasi dalam Xcode </font></font><code>UIKeyboardType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, kita akan melihat bahwa ada 13 jenis keyboard, dan salah satunya (</font></font><code>UIKeyboardTypeAlphabet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) sudah usang dan dideklarasikan sebagai referensi ke tipe lain. Yaitu, ada 12 jenis dalam enum: jika Anda mulai dari 0, yang terakhir akan memiliki nilai sama dengan 11. Dengan kata lain, kode memvalidasi nilai dalam bentuk pemeriksaan melimpah, dan sekali lagi, berhasil lulus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lebih jauh kita melihat kondisi yang sangat aneh </font></font><code>if (!COND)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan untuk waktu yang lama saya tidak dapat memahami apa yang diperiksa, mengingat bahwa variabel COND tidak dideklarasikan di tempat lain dalam kode. Selain itu, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symbolic Breakpoints</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> saya </font><font style="vertical-align: inherit;">menunjukkan bahwa justru kegagalan untuk memenuhi kondisi ini yang menyebabkan keluar awal dari fungsi. Dan di sini kita tidak punya pilihan selain kembali ke mode ASM dan mempelajari bagian kode ini dalam bentuk assembler.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk menemukan kondisi ini dalam daftar ASM, Anda dapat menggunakan opsi "Tidak ada duplikasi kode", yang akan menunjukkan kode semu tidak dalam bentuk kode sumber dengan kondisi if-else, tetapi dalam bentuk blok kode unik dan transisi dalam bentuk goto. Dalam hal ini, kita akan melihat posisi awal dari blok-blok ini dalam file biner dan menggunakan pointer ini untuk mencari dalam mode ASM. Jadi saya menemukan bahwa blok yang kami minati terletak di fe79f4: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yu/ev/wk/yuevwkuqmhpb5ht5ds2l3mgiz1w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kembali ke mode ASM, kami dapat dengan mudah menemukan blok ini: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/g1/0e/u4/g10eu4epacglmci1utx7gpue_ii.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami sampai pada bagian yang paling sulit, di mana kami akan mengurai tiga baris kode assembler.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya mengenali baris pertama dari ingatan saya (terima kasih kepada pelajaran assembler di MIET asli saya, akhirnya saatnya telah datang dalam hidup saya ketika pendidikan tinggi berguna!). Semuanya cukup sederhana di sini: konstanta 0x930 (100100110000 dalam format biner) ditempatkan di register ecx. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada baris kedua, kita melihat instruksi bt dieksekusi pada </font></font><code>exc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font><font style="vertical-align: inherit;">register </font></font><code>eax</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Nilai yang sudah kita ketahui, nilai yang kedua dapat dilihat pada screenshot sebelumnya: </font></font><code>rax = [rbx keyboardType]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ini berisi jenis keyboard saat ini. </font></font><code>rax</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ini adalah register seluruh 64-bit, </font></font><code>eax</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ini adalah bagian 32-bit. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan data yang diputuskan, itu masih untuk memahami logika tim. Google mengarahkan kita ke </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deskripsi ini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<blockquote>Selects the bit in a bit string (specified with the first operand, called the bit base) at the bit-position designated by the bit offset operand (second operand) and stores the value of the bit in the CF flag.</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instruksi mengekstrak sedikit dari operan pertama (konstan 0x930) pada posisi yang ditentukan oleh operan kedua (tipe keyboard), dan menempatkannya dalam CF ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">membawa bendera</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Artinya, sebagai hasilnya, CF akan berisi 0 atau 1, tergantung pada jenis keyboard. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami melanjutkan ke operasi terakhir </font></font><code>jb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ia memiliki </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deskripsi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> berikut </font><font style="vertical-align: inherit;">: </font></font><br>
<br>
<code>Jump short if below (CF=1)</code> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mudah untuk menebak bahwa ada transisi ke fungsi (keluar awal) jika CF adalah 1. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada titik ini, teka-teki mulai bertambah. Kami memiliki bit mask 100100110000 (ini berisi 12 bit sesuai dengan jumlah jenis keyboard yang tersedia), dan itu menentukan kondisi untuk keluar awal. Sekarang, jika kita memeriksa ketersediaan petunjuk untuk semua jenis keyboard dalam urutan menaik </font></font><code>rawValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, semuanya akan ada di tempatnya.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yj/gm/xw/yjgmxwjm7pes1dooauar9gksqxm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di iOS 12, kami tidak akan menemukan logika seperti itu - petunjuk di sana berfungsi untuk semua jenis keyboard. Saya menduga bahwa di iOS 13, Apple memutuskan untuk menonaktifkan petunjuk untuk papan ketik digital, yang pada prinsipnya dapat dimengerti: Saya tidak dapat membuat skenario di mana sistem perlu meminta angka. Rupanya, secara tidak sengaja, "tangan panas" juga mengenai </font></font><code>UIKeyboardTypePhonePad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, yang sangat mirip dengan tombol numerik biasa. Pada saat yang sama </font></font><code>UIKeyboardTypeNamePhonePad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, menggabungkan keyboard QWERTY untuk mencari kontak telepon dan tombol digital dinonaktifkan yang sama persis, ia terus menunjukkan petunjuk.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yang mengejutkan saya, bekerja dengan Hopper ternyata sangat menyenangkan dan menghibur, untuk waktu yang lama saya tidak mendapatkan banyak penggemar. </font><font style="vertical-align: inherit;">Saya berbagi temuan dengan insinyur Apple dalam laporan bug saya, dan statusnya berubah dari waktu ke waktu menjadi "Perbaikan potensial yang diidentifikasi - Untuk pembaruan OS di masa mendatang". </font><font style="vertical-align: inherit;">Saya harap perbaikan ini akan menjangkau pengguna di pembaruan mendatang. </font><font style="vertical-align: inherit;">Pada saat yang sama, Hopper dapat digunakan tidak hanya untuk menemukan penyebab bug Anda atau Apple, tetapi juga untuk mendeteksi perbaikan Apple untuk </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">program pihak ketiga</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id504070/index.html">Mahasiswa pascasarjana menyelesaikan masalah topologi setengah abad yang lalu</a></li>
<li><a href="../id504072/index.html">Perjanjian pengguna yang ideal: cara meminimalkan risiko bagi pengembang</a></li>
<li><a href="../id504074/index.html">Glass Nightmare: Membersihkan Warisan Nuklir Perang Dingin Hanford</a></li>
<li><a href="../id504080/index.html">Bagaimana Apple dan Karyawan Google Membantu Petugas Kesehatan Melacak Coronavirus Bersama</a></li>
<li><a href="../id504082/index.html">Apa yang akan kita lakukan dengan 1,2 GHz tambahan?</a></li>
<li><a href="../id504086/index.html">Simulator sistem komputer - apakah mereka terlihat seperti kenyataan</a></li>
<li><a href="../id504088/index.html">Pencatatan Windows Lanjut. Mencari mimikatz</a></li>
<li><a href="../id504092/index.html">Pertama-tama lihat catatan dan tuple JavaScript</a></li>
<li><a href="../id504096/index.html">Cara Pemula yang Optimal untuk C ++ / Qt</a></li>
<li><a href="../id504098/index.html">Dipfake video satu bingkai</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>