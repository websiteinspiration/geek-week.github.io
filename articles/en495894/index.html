<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèª üÜö üíé Javascript Performance Measurement üó®Ô∏è üèπ üë§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Measuring the time it takes to execute a function is a good way of proving that one implementation of a mechanism is more productive than another. Thi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Javascript Performance Measurement</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/495894/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Measuring the time it takes to execute a function is a good way of proving that one implementation of a mechanism is more productive than another. This allows you to make sure that the performance of the function has not suffered after some changes made to the code. It also helps to look for application performance bottlenecks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If a web project has high performance, this contributes to its positive perception by users. And if users liked working with the resource, they have the property of returning. For example, in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The study showed that 88% of online customers are less likely to return to resources that they encounter with any inconvenience. These inconveniences may well be caused by performance issues. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
That‚Äôs why web development tools are important tools to help you find performance bottlenecks and measure the results of improvements made to your code. Such tools are especially relevant in JavaScript development. It‚Äôs important to know that every line of JavaScript code can potentially block the DOM, as JavaScript is a single-threaded language. </font><font style="vertical-align: inherit;">
In this article I will talk about how to measure the performance of functions, and what to do with the measurement results.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/by/of/jl/byofjlhqvkjueyjzh-cyymte_qg.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you think that some calculations are too heavy to perform in the main thread, then you might decide to move them to a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">service worker</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or web worker.</font></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Performance.now () method</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Performance</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface </font><font style="vertical-align: inherit;">gives access to a value of type </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DOMHighResTimeStamp</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> through a method </font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">This method returns a timestamp indicating the time in milliseconds that has elapsed since the document began to exist. </font><font style="vertical-align: inherit;">Moreover, the accuracy of this indicator is about 5 microseconds (fractions of a millisecond). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order to measure the performance of a code fragment using the method </font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, you need to perform two time measurements, save the results of these measurements in variables, and then subtract the results of the first from the results of the second measurement:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> t0 = performance.now();
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; array.length; i++)&nbsp;<font></font>
{<font></font>
&nbsp;&nbsp;<span class="hljs-comment">// - </span><font></font>
}<font></font>
<span class="hljs-keyword">const</span> t1 = performance.now();
<span class="hljs-built_in">console</span>.log(t1 - t0, <span class="hljs-string">'milliseconds'</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Chrome, after executing this code, you can get something like this:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-number">0.6350000001020817</span> <span class="hljs-string">"milliseconds"</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Firefox, like this:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-number">1</span> milliseconds
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you can see, the measurement results obtained in different browsers are very different. </font><font style="vertical-align: inherit;">The fact is that in Firefox 60, the accuracy of the results returned by the Performance API is reduced. </font><font style="vertical-align: inherit;">We will talk more about this. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The Performance interface has much more capabilities than just returning a certain timestamp. </font><font style="vertical-align: inherit;">These include measuring various aspects of performance represented by such extensions of this interface as the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Performance Timeline</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> API </font><font style="vertical-align: inherit;">, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Navigation Timing</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">User Timing</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Resource Timing</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here is the</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> material to find out more about these APIs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In our case, we are talking about measuring the performance of functions, so we have enough opportunities that the method gives</font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Date.now () and performance.now ()</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here you may have the thought that you can use the method to measure performance </font></font><code>Date.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">This is indeed possible, but this approach has drawbacks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The method </font></font><code>Date.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">returns the time in milliseconds that has elapsed since the Unix era (1970-01-01T00: 00: 00Z) and depends on the system clock. </font><font style="vertical-align: inherit;">This means not only that this method is not as accurate as </font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, but that it, in contrast </font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, returns values ‚Äã‚Äãthat, under certain conditions, can be based on incorrect clock indicators. </font><font style="vertical-align: inherit;">Here's what Rich Gentlekor, a programmer related to the WebKit engine, says: ‚ÄúPerhaps programmers are less likely to think that readings returned when accessing</font></font><code>Date</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">based on system time, it is absolutely impossible to call ideal for monitoring real applications. </font><font style="vertical-align: inherit;">Most systems have a daemon that regularly synchronizes time. </font><font style="vertical-align: inherit;">Adjusting the system clock for a few milliseconds every 15-20 minutes is a common thing. </font><font style="vertical-align: inherit;">With such a frequency, clock settings of about 1% of the 10-second intervals will be inaccurate. ‚Äù</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Console.time () method</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Time measurement using this API is extremely simple. </font><font style="vertical-align: inherit;">Enough, before the code whose performance you need to evaluate, call the method </font></font><code>console.time()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and after this code - the method </font></font><code>console.timeEnd()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">In this case, one and the other methods need to pass the same string argument. </font><font style="vertical-align: inherit;">On one page, up to 10,000 such timers can be used simultaneously. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The accuracy of time measurements made using this API is the same as using the Performance API, but the accuracy that will be achieved in each specific situation depends on the browser.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">console</span>.time(<span class="hljs-string">'test'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; array.length; i++) {
&nbsp;&nbsp;<span class="hljs-comment">// - </span><font></font>
}<font></font>
<span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'test'</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After executing such code, the system will automatically output information about elapsed time to the console. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Chrome, it will look something like this:</font></font><br>
<br>
<pre><code class="javascript hljs">test: <span class="hljs-number">0.766845703125</span>ms
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Firefox, like this:</font></font><br>
<br>
<pre><code class="javascript hljs">test: <span class="hljs-number">2</span>ms - timer ended
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In fact, everything here is very similar to what we saw while working with </font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The strength of the method </font></font><code>console.time()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is its ease of use. </font><font style="vertical-align: inherit;">Namely, we are talking about the fact that its application does not require the declaration of auxiliary variables and finding the difference between the indicators recorded in them.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reduced time accuracy</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you, using the tools described above, measured the performance of your code in different browsers, then you could pay attention to the fact that the measurement results may vary. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The reason for this is that browsers are trying to protect users from </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">time-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> based attacks </font><font style="vertical-align: inherit;">and from browser identification mechanisms ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Browser Fingerprinting</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">If the results of the time measurement turn out to be too accurate, this can give attackers the opportunity, for example, to identify users. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Firefox 60, as already mentioned, the accuracy of time measurement results is </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reduced</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">This is done by setting the property </font></font><code>privacy.reduceTimerPrecision</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">value to 2 ms.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Something to keep in mind when testing performance</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now you have tools at your disposal to measure the performance of JavaScript functions. </font><font style="vertical-align: inherit;">But before you get down to business, you need to consider some of the features that we will talk about now.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñç Divide and conquer</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suppose that, filtering some data, you paid attention to the slow operation of the application. But you don't know exactly where the performance bottleneck is. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instead of speculating on which part of the code is slow, it would be better to find out using the above methods. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order to see the general picture of what is happening, you first need to use </font></font><code>console.time()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>console.timeEnd()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">evaluate the performance of a code block, which, presumably, has a bad effect on performance. Then you need to look at the speed of the individual parts of this block. If one of them looks noticeably slower than the others, you need to pay special attention to it and how to analyze it.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The less code there is between calls to methods that measure time, the lower the likelihood that something that is not relevant to the problem situation will be measured.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñçTake into account the features of the behavior of functions at different input values</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In real applications, the data received at the input of a particular function can be very different. </font><font style="vertical-align: inherit;">If you measure the performance of a function that was passed a randomly selected data set, this will not provide any valuable information that can clarify what is happening. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Functions when researching performance need to be called with input data that resembles real ones as much as possible.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñç Run functions many times</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suppose you have a function that iterates over an array. </font><font style="vertical-align: inherit;">She performs some calculations using each element of the array, and after that returns a new array with the results of the calculations. </font><font style="vertical-align: inherit;">Thinking about optimizing this function, you want to know what works faster in your situation - a loop </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or a regular loop </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here are two options for this feature:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">testForEach</span>(<span class="hljs-params">x</span>) </span>{
&nbsp;&nbsp;<span class="hljs-built_in">console</span>.time(<span class="hljs-string">'test-forEach'</span>);
&nbsp;&nbsp;<span class="hljs-keyword">const</span> res = [];<font></font>
&nbsp;&nbsp;x.forEach(<span class="hljs-function">(<span class="hljs-params">value, index</span>) =&gt;</span> {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;res.push(value / <span class="hljs-number">1.2</span> * <span class="hljs-number">0.1</span>);<font></font>
&nbsp;&nbsp;});<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'test-forEach'</span>)
&nbsp;&nbsp;<span class="hljs-keyword">return</span> res;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">testFor</span>(<span class="hljs-params">x</span>) </span>{
&nbsp;&nbsp;<span class="hljs-built_in">console</span>.time(<span class="hljs-string">'test-for'</span>);
&nbsp;&nbsp;<span class="hljs-keyword">const</span> res = [];
&nbsp;&nbsp;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; x.length; i ++) {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;res.push(x[i] / <span class="hljs-number">1.2</span> * <span class="hljs-number">0.1</span>);<font></font>
&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'test-for'</span>)
&nbsp;&nbsp;<span class="hljs-keyword">return</span> res;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Test the functions:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> x = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">100000</span>).fill(<span class="hljs-built_in">Math</span>.random());<font></font>
testForEach(x);<font></font>
testFor(x);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After running the code, we get the following results:</font></font><br>
<br>
<pre><code class="javascript hljs">test-forEach: <span class="hljs-number">27</span>ms - timer ended<font></font>
test-<span class="hljs-keyword">for</span>: <span class="hljs-number">3</span>ms - timer ended
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The cycle seemed to </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">be much slower than the cycle </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">After all, the test results indicate exactly this? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In fact, after a single test it‚Äôs too early to draw such conclusions. </font><font style="vertical-align: inherit;">Let's try to call the functions twice:</font></font><br>
<br>
<pre><code class="javascript hljs">testForEach(x);<font></font>
testForEach(x);<font></font>
testFor(x);<font></font>
testFor(x);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We get the following:</font></font><br>
<br>
<pre><code class="javascript hljs">test-forEach: <span class="hljs-number">13</span>ms - timer ended<font></font>
test-forEach: <span class="hljs-number">2</span>ms - timer ended<font></font>
test-<span class="hljs-keyword">for</span>: <span class="hljs-number">1</span>ms - timer ended<font></font>
test-<span class="hljs-keyword">for</span>: <span class="hljs-number">3</span>ms - timer ended
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It turns out that the function in which it is used </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, called the second time, is as fast as the one in which it is used </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">But, given the fact that the first </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">function calls, the function works much slower, it may still not be worth using.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñçTest performance in different browsers</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The above tests were performed in Firefox. </font><font style="vertical-align: inherit;">But what if you execute them in Chrome? </font><font style="vertical-align: inherit;">The results will be completely different:</font></font><br>
<br>
<pre><code class="javascript hljs">test-forEach: <span class="hljs-number">6.156005859375</span>ms<font></font>
test-forEach: <span class="hljs-number">8.01416015625</span>ms<font></font>
test-<span class="hljs-keyword">for</span>: <span class="hljs-number">4.371337890625</span>ms<font></font>
test-<span class="hljs-keyword">for</span>: <span class="hljs-number">4.31298828125</span>ms
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The fact is that the Chrome and Firefox browsers are based on different JavaScript engines that implement different performance optimizations. </font><font style="vertical-align: inherit;">It is very useful to know about these differences. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this case, Firefox has better optimization </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with similar input. </font><font style="vertical-align: inherit;">And the cycle </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is faster than </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in both Chrome and Firefox. </font><font style="vertical-align: inherit;">As a result, it is probably better to dwell on the variant of function c </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is a good example, demonstrating the importance of measuring performance in different browsers. </font><font style="vertical-align: inherit;">If you evaluate the performance of some code only in Chrome, you can come to the conclusion that the cycle </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, in comparison with the cycle </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, is not so bad.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñç Apply artificial limits to system resources</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The values ‚Äã‚Äãobtained in our experiments do not look particularly large. </font><font style="vertical-align: inherit;">But be aware that computers that are used for development are usually much faster than, say, the average mobile phone that they use to browse the web. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order to put yourself in the place of a user who does not have the fastest device, use the capabilities of the browser to artificially limit system resources. </font><font style="vertical-align: inherit;">For example - to reduce processor performance. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
With this approach, 10 or 50 milliseconds can easily turn into 500.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñç Measure relative performance</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Performance measurements usually depend not only on the hardware, but also on the current processor load, and on the workload of the main thread of the JavaScript application. </font><font style="vertical-align: inherit;">Therefore, try to rely on relative indicators characterizing the change in performance, since the absolute indicators obtained when analyzing the same code fragment at different times can vary greatly.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Summary</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this article, we looked at some JavaScript APIs designed to measure performance. </font><font style="vertical-align: inherit;">We talked about how to use them to analyze real code. </font><font style="vertical-align: inherit;">I believe that in order to perform some simple measurements, it is easiest to use </font></font><code>console.time()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I have the feeling that many front-end developers do not pay enough attention to measuring the performance of their projects. </font><font style="vertical-align: inherit;">And they should constantly monitor the relevant indicators, as productivity affects the success and profitability of projects. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dear readers! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you constantly monitor the performance of your projects, please tell us how you do it.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/iq/fi/b4/iqfib45pgphfrxv--zfemt0qnmw.jpeg"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en495882/index.html">The 9 best open source finds for March 2020</a></li>
<li><a href="../en495884/index.html">Time Series Prediction Using Recurrent Neural Networks</a></li>
<li><a href="../en495888/index.html">PyCon Russia has opened CFP for future speakers. Participation Forms and Expected Topics</a></li>
<li><a href="../en495890/index.html">Configuring a Nginx / LetsEncrypt Bundle in Docker Swarm</a></li>
<li><a href="../en495892/index.html">Do you really know what arrays are?</a></li>
<li><a href="../en495896/index.html">Use-sound Package: Sound Effects in React Applications</a></li>
<li><a href="../en495898/index.html">A practical guide to dealing with memory leaks in Node.js</a></li>
<li><a href="../en495902/index.html">CAPTCHA: killing conversion</a></li>
<li><a href="../en495904/index.html">Can an epidemic be predicted?</a></li>
<li><a href="../en495908/index.html">The path to the reward</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>